"use strict";(self.webpackChunkgloomhavensecretariat=self.webpackChunkgloomhavensecretariat||[]).push([[792],{57(u,y,v){v.d(y,{VP:()=>x,gw:()=>M,h5:()=>O});class M{name="";edition="";constructor(c,E){this.name=c,this.edition=E}}class x extends M{count;constructor(c,E,R=-1){super(c,E),this.count=R}}class O extends M{type;marker;tags;constructor(c,E,R=void 0,T=void 0,B=void 0){super(c,E),this.type=R,this.marker=T,this.tags=B}equals(c){return this.edition==c.edition&&this.marker==c.marker&&this.name==c.name&&this.type==c.type}}},392(u,y,v){v.d(y,{M:()=>x,f:()=>M});class M{type;level;health;movement;attack;range;actions;immunities;special;note;constructor(V,c=0,E=0,R=0,T=0,B=0,q=[],I=[],s=[],D=""){this.type=V,this.level=c,this.health=E,this.movement=R,this.attack=T,this.range=B,this.actions=q||[],this.immunities=I||[],this.special=s||[],this.note=D}}class x{name;health=0;movement=0;attack=0;range=0;initiative=0;flying=!1;actions=void 0;immunities=void 0;special=[];deck=void 0;absolute=!1;note=""}},706(u,y,v){v.d(y,{f:()=>O,w:()=>x});var M=v(2357);class x{abilities=!0;abilityNumbers=!0;abilityReveal=!0;activeApplyConditions=!0;activeApplyConditionsAuto=[];activeApplyConditionsExcludes=[M.r5.shield];activeStandees=!0;activeSummons=!0;addAllMonsters=!1;allyAttackModifierDeck=!0;alwaysAllyAttackModifierDeck=!1;alwaysFhAdvantage=!1;alwaysFhEnhancements=!1;alwaysFhSolo=!1;alwaysGh2eImbuement=!1;alwaysHazardousTerrain=!1;alwaysLootApplyDialog=!1;alwaysLootDeck=!1;amAdvantage=!1;amAdvantageHouseRule=!1;animations=!0;animationSpeed=1;applyBuildingRewards=!0;applyConditions=!0;applyConditionsExcludes=[M.r5.shield];applyLongRest=!0;applyLoot=!0;applyLootRandomItem=!0;applyRetirement=!0;artwork=!0;autoBackup=-1;autoBackupFinish=!1;autoBackupUrl;automaticAttackModifierFullscreen=!0;automaticFirstFigure=!0;automaticGameClock=!0;automaticGameClockFocus=!1;automaticPassTime=!0;automaticStandees=!0;automaticStandeesDialog=!1;automaticTheme=!0;automaticUnlocking=!0;autoscroll=!0;barsize=1;backupHint=!0;battleGoals=!1;battleGoalsCharacter=!1;battleGoalsFh=!1;battleGoalsReminder=!0;bbAm=!0;bbChars=!0;bbStandeeLimit=!0;browserNavigation=!1;buildingEffectsVisible=!1;buildingInteractionsVisible=!1;calculate=!0;calculateAdvantageStats=!0;calculateShieldStats=!0;calculateStats=!0;calendarLocked=!1;characterAttackModifierAnimate=!0;characterAttackModifierDeck=!0;characterAttackModifierDeckActiveBottom=!1;characterAttackModifierDeckPermanent=!1;characterAttackModifierDeckPermanentActive=!1;characterCompact=!1;characterFullView=!1;characterHandSize=!1;characterIdentities=!0;characterIdentityHint=!0;characterItems=!1;characterItemsApply=!0;characterItemsPermanent=!1;characterItemsPermanentActive=!1;characterItemsPermanentEquipped=!0;characterItemsPermanentSorted=!0;characterItemsPermanentZoom=1;playerNumber=!1;characterSheet=!0;characterSheetCompact=!1;characterSheetLocked=!1;characterShieldRetaliate=!1;characterSortIndex=!1;characterTraits=!1;columns=!0;columnsForce=!1;combineInteractiveAbilities=!0;combineSummonAction=!0;damageHP=!1;damageHPToggle=!0;debugEditWorldMap=!1;debugEventCards=!1;debugRightClick=!1;disableAnimations=!1;disableArtwork=!1;disableColumns=!1;disableDragFigures=!1;disablePinchZoom=!1;disabledTurnConfirmation=!1;disableSortFigures=!1;disableStandees=!1;disableWakeLock=!1;dragFigures=!0;dragValues=!0;dragValuesHp=!0;dragValuesInitiative=!0;dragValuesLoot=!0;dragValuesXp=!0;drawRandomItem=!0;drawRandomScenario=!0;editionDataUrls=[];editions=[];eliteFirst=!0;errata=!1;excludeEditionDataUrls=[];expireConditions=!0;events=!1;eventsApply=!0;eventsDraw=!0;eventsDrawReminder=!1;feedbackErrors=!0;feedbackErrorsIgnore=[];fhChallenges=!1;fhChallengesApply=!0;fhGarden=!0;fhGhItems=!1;fhPets=!0;fhSecondEdition=!1;fhStyle=!1;fhTrials=!1;fhTrialsApply=!0;fontsize=1;gameClock=!1;gameClockMerge=!0;gh2eImbuement=!0;gh2eImbuementKeep=!1;globalFontsize=1;globalMapHighlighting=!0;fullscreen=!1;hideAbsent=!1;hideCharacterHP=!1;hideCharacterLoot=!1;hideCharacterXP=!1;hideStats=!1;hints=!0;initiativeRequired=!0;initiativeRoundConfirm=!1;interactiveAbilities=!0;keyboardShortcuts=!0;locale="en";logServerMessages=!1;lootDeck=!0;maxUndo=100;portraitMode=!0;monsters=!0;monsterAttackModifierDeck=!0;moveElements=!0;partySheet=!0;pinchZoom=!0;pressDoubleClick=!0;randomStandees=!1;removeUnusedMonster=!1;scenarioNumberInput=!1;scenarioRewards=!0;scenarioRooms=!0;scenarioRules=!0;scenarioRulesAutoapply=!1;scenarioStats=!1;serverAutoconnect=!0;serverCode;serverPassword;serverPing=0;serverPort;serverSettings=!1;serverUrl;serverWss=!1;showBossMonster=!0;showAllSections=!1;showExpandedAbilityCard=!1;showExpandedStatCard=!1;showFullAbilityCard=!1;showHiddenMonster=!1;showOnlyUnfinishedScenarios=!1;sortFigures=!0;spoilers=[];standaloneInitiativeAutomatic=!1;standees=!0;standeeShieldRetaliate=!1;standeeStats=!1;statAnimations=!1;stats=!0;summons=!0;temporaryEnhancements=!1;theme="";tooltips=!0;treasures=!0;treasuresLoot=!0;treasuresLootItem=!0;treasuresLootScenario=!0;turnConfirmation=!0;unlockEnvelopeBuildings=!0;wakeLock=!0;wrapProsperity=!1;zoom=100}const O=["animations","animationSpeed","artwork","automaticAttackModifierFullscreen","autoBackup","autoBackupFinish","autoBackupUrl","automaticGameClock","automaticTheme","autoscroll","barsize","backupHint","browserNavigation","buildingEffectsVisible","buildingInteractionsVisible","calendarLocked","characterAttackModifierAnimate","characterAttackModifierDeckActiveBottom","characterAttackModifierDeckPermanent","characterAttackModifierDeckPermanentActive","characterFullView","characterItemsPermanent","characterItemsPermanentActive","characterItemsPermanentEquipped","characterItemsPermanentSorted","characterItemsPermanentZoom","characterCompact","playerNumber","characterSheetCompact","characterSheetLocked","columns","columnsForce","damageHPToggle","debugEditWorldMap","debugEventCards","debugRightClick","disableAnimations","disableArtwork","disableColumns","disableDragFigures","disablePinchZoom","disableWakeLock","dragFigures","dragValues","dragValuesHp","dragValuesInitiative","dragValuesLoot","errata","eventsDrawReminder","fhStyle","fontsize","gameClock","globalFontsize","globalMapHighlighting","feedbackErrors","feedbackErrorsIgnore","fullscreen","hideCharacterHP","hideCharacterLoot","hideCharacterXP","hints","initiativeRoundConfirm","keyboardShortcuts","logServerMessages","pinchZoom","portraitMode","pressDoubleClick","serverAutoconnect","serverCode","serverPassword","serverPing","serverPort","serverSettings","serverUrl","serverWss","showAllSections","showBossMonster","showHiddenMonster","showOnlyUnfinishedScenarios","standaloneInitiativeAutomatic","statAnimations","theme","tooltips","wakeLock","wrapProsperity","zoom"]},740(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{H:()=>ScenarioRulesManager});var _angular_cdk_drag_drop__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(9549),src_app_ui_helper_Static__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(4670),_model_Character__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1824),_model_Entity__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3812),_model_Game__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(9765),_model_Monster__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2065),_model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(6066),_model_ObjectiveContainer__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(4933),_model_ObjectiveEntity__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(6719),_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(3219),_model_data_Condition__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(2357),_model_data_FigureError__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(4786),_model_data_MonsterStat__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(392),_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(6538),_model_data_ScenarioRule__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(3414),_GameManager__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(8317),_SettingsManager__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(1619),_model_data_Element__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(5532);class ScenarioRulesManager{game;constructor(u){this.game=u}addScenarioRules(u=!1){this.game.scenarioRules=[];const y=this.game.scenario;y&&y.rules&&y.rules.forEach((v,M)=>{(!v.alwaysApply||!_SettingsManager__WEBPACK_IMPORTED_MODULE_16__.f.settings.scenarioRulesAutoapply)&&this.addScenarioRule(y,v,M,!1,u)}),this.game.sections&&this.game.sections.forEach(v=>{v.rules&&v.rules.forEach((M,x)=>{(!M.alwaysApply||!_SettingsManager__WEBPACK_IMPORTED_MODULE_16__.f.settings.scenarioRulesAutoapply)&&this.addScenarioRule(v,M,x,!0,u)})}),this.addScenarioErrata(),this.filterDisabledScenarioRules()}addScenarioRulesAlways(){const u=this.game.scenario;u&&u.rules&&u.rules.filter(y=>this.game.round>0&&y.always||y.alwaysApply||y.alwaysApplyTurn).forEach(y=>{y.alwaysApply&&_SettingsManager__WEBPACK_IMPORTED_MODULE_16__.f.settings.scenarioRulesAutoapply&&this.scenarioRuleActive(y,u.rules.indexOf(y),!1)?this.applyRule(y,{edition:u.edition,scenario:u.index,group:u.group,index:u.rules.indexOf(y),section:!1}):this.game.discardedScenarioRules.find(v=>v.edition==u.edition&&v.scenario==u.index&&v.group==u.group&&v.index==u.rules.indexOf(y)&&!v.section)||this.addScenarioRule(u,y,u.rules.indexOf(y),!1)}),this.game.sections&&this.game.sections.forEach(y=>{y.rules&&y.rules.filter(v=>this.game.round>0&&v.always||v.alwaysApply||v.alwaysApplyTurn).forEach(v=>{v.alwaysApply&&_SettingsManager__WEBPACK_IMPORTED_MODULE_16__.f.settings.scenarioRulesAutoapply&&this.scenarioRuleActive(v,y.rules.indexOf(v),!0)?(this.applyRule(v,{edition:y.edition,scenario:y.index,group:y.group,index:y.rules.indexOf(v),section:!0}),_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenarioRules.splice(_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenarioRules.length-1,1)):this.game.discardedScenarioRules.find(M=>M.edition==y.edition&&M.scenario==y.index&&M.group==y.group&&M.index==y.rules.indexOf(v)&&M.section)||this.addScenarioRule(y,v,y.rules.indexOf(v),!0)})}),this.addScenarioErrata(),this.filterDisabledScenarioRules()}applyScenarioRulesAlways(){const u=this.game.scenario;let y=[];u&&u.rules&&y.push(...u.rules.map((v,M)=>({identifier:{edition:u.edition,scenario:u.index,group:u.group,index:M,section:!1},rule:v})).filter(v=>v.rule.alwaysApply&&this.game.appliedScenarioRules.find(M=>M.edition==v.identifier.edition&&M.scenario==v.identifier.scenario&&M.group==v.identifier.group&&M.index==v.identifier.index&&M.section==v.identifier.section))),this.game.sections&&this.game.sections.forEach(v=>{v.rules&&y.push(...v.rules.map((M,x)=>({identifier:{edition:v.edition,scenario:v.index,group:v.group,index:x,section:!0},rule:M})).filter(M=>M.rule.alwaysApply&&this.game.appliedScenarioRules.find(x=>x.edition==M.identifier.edition&&x.scenario==M.identifier.scenario&&x.group==M.identifier.group&&x.index==M.identifier.index&&x.section==M.identifier.section)))}),y.forEach(v=>{this.scenarioRuleActive(v.rule,v.identifier.index,v.identifier.section)&&this.applyRule(v.rule,v.identifier)})}applyScenarioRulesTurn(u,y=!1){const v=this.game.scenario;let M=[];v&&v.rules&&M.push(...v.rules.map((x,O)=>({identifier:{edition:v.edition,scenario:v.index,group:v.group,index:O,section:!1},rule:x})).filter(x=>x.rule.alwaysApplyTurn&&(!y&&"turn"==x.rule.alwaysApplyTurn||y&&"after"==x.rule.alwaysApplyTurn)&&this.game.appliedScenarioRules.find(O=>O.edition==x.identifier.edition&&O.scenario==x.identifier.scenario&&O.group==x.identifier.group&&O.index==x.identifier.index&&O.section==x.identifier.section))),this.game.sections&&this.game.sections.forEach(x=>{x.rules&&M.push(...x.rules.map((O,V)=>({identifier:{edition:x.edition,scenario:x.index,group:x.group,index:V,section:!0},rule:O})).filter(O=>O.rule.alwaysApplyTurn&&(!y&&"turn"==O.rule.alwaysApplyTurn||y&&"after"==O.rule.alwaysApplyTurn)&&this.game.appliedScenarioRules.find(V=>V.edition==O.identifier.edition&&V.scenario==O.identifier.scenario&&V.group==O.identifier.group&&V.index==O.identifier.index&&V.section==O.identifier.section)))}),M.forEach(x=>{this.applyRule(x.rule,x.identifier,[u])})}addScenarioErrata(){const u=this.game.scenario;u&&u.errata&&u.errata.split("|").forEach((y,v)=>{this.addScenarioRule(u,this.createErrataRule(u.edition,y),-1-v,!1)}),this.game.sections&&this.game.sections.forEach(y=>{y&&y.errata&&y.errata.split("|").forEach((v,M)=>{this.addScenarioRule(y,this.createErrataRule(y.edition,v),-1-M,!1)})})}createErrataRule(u,y){let v=new _model_data_ScenarioRule__WEBPACK_IMPORTED_MODULE_14__.lS("true");return v.always=!0,v.once=!0,v.note="%errata%:&nbsp;%data.custom."+u+".errata."+y+"%",v}filterDisabledScenarioRules(){this.game.scenarioRules=this.game.scenarioRules.filter((u,y,v)=>!v.find(M=>M.rule.disableRules&&M.rule.disableRules.some(x=>x.edition==u.identifier.edition&&x.group==u.identifier.group&&(x.index==u.identifier.index||-1==x.index)&&x.scenario==u.identifier.scenario&&x.section==u.identifier.section)))}scenarioRuleActive(rule,index,section,initial=!1){let round=rule.round||"false",active=!1;for(;round.includes("R");)round=round.replace("R",""+(rule.start?this.game.round+1:this.game.round));for(;round.includes("C");)round=round.replace("C",""+_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.characterManager.characterCount());try{active=eval(round)&&(rule.always||this.game.state==_model_Game__WEBPACK_IMPORTED_MODULE_4__.mk.next||rule.start&&initial)}catch(u){console.warn("Cannot apply scenario rule: '"+rule.round+"'","index: "+index,u),active=!1}if(active){if(rule.figures&&rule.figures.filter(u=>"present"==u.type||"dead"==u.type).length>0&&rule.figures.filter(u=>"present"==u.type||"dead"==u.type).forEach(u=>{const y=this.presentEntitiesByFigureRule(u,rule),v=u.value?(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(u.value.split(":")[0]):"present"==u.type?1:0;active=active&&v>=0&&("present"==u.type?y.length>=v:y.length<=v),u.identifier&&(u.identifier.marker||u.identifier.tags&&u.identifier.tags.length>0)&&!_SettingsManager__WEBPACK_IMPORTED_MODULE_16__.f.settings.automaticStandees&&(active=!1)}),active&&rule.figures&&rule.figures.filter(u=>"killed"==u.type).length>0&&rule.figures.filter(u=>"killed"==u.type).forEach(u=>{if(u.identifier){const y=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityCounters(u.identifier);if(active=active&&y.length>0,active)if("all"==u.value)y.forEach(v=>{active=active&&v&&v.total>0&&v.killed>=v.total||!1});else{const v=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(u.value||0);let M=0;y.forEach(x=>{M+=x.killed}),active=active&&M>0&&M>=v||!1}}else active=!1}),active&&rule.figures&&rule.figures.filter(u=>"initiative"==u.type).length>0&&rule.figures.filter(u=>"initiative"==u.type).forEach(figureRule=>{if(figureRule.identifier){const figures=this.figuresByFigureRule(figureRule,rule);active=active&&figures.length&&(null!=figures.find(figure=>!!figure.active&&(isNaN(+figureRule.value)?eval(figure.getInitiative()+" "+figureRule.value):figure.getInitiative()==+figureRule.value))||figures.every(figure=>!figure.active&&isNaN(+figureRule.value)&&!eval(figure.getInitiative()+" "+figureRule.value)))||!1}else active=!1}),rule.requiredRooms&&rule.requiredRooms.length&&rule.requiredRooms.forEach(u=>{active=active&&null!=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario.revealedRooms.includes(u)}),rule.requiredRules&&rule.requiredRules.length&&rule.requiredRules.forEach(u=>{active=active&&this.game.appliedScenarioRules.some(y=>u.edition==y.edition&&u.scenario==y.scenario&&u.group==y.group&&u.index==y.index&&u.section==y.section)}),rule.requiredScenarios&&rule.requiredScenarios.length&&rule.requiredScenarios.forEach(u=>{active=active&&null!=this.game.party.scenarios.find(y=>y.edition==u.edition&&y.index==u.index&&y.group==u.group)}),rule.rooms&&rule.rooms.length&&rule.rooms.every(u=>_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario.revealedRooms.includes(u))&&(active=!1),rule.treasures){let u=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.figures.filter(y=>y instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K).map(y=>y.treasures.map(v=>"number"==typeof v?v:"G")).flat();if(("number"==typeof rule.treasures||"string"==typeof rule.treasures)&&u.length<(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(rule.treasures))active=!1;else if("number"!=typeof rule.treasures&&"string"!=typeof rule.treasures){let y=0;rule.treasures.forEach(v=>{const M=u.indexOf(v);-1!=M&&(u.splice(M,1),y++)}),y<rule.treasures.length&&(active=!1)}}rule.elementTrigger&&rule.elementTrigger.length&&(active=rule.elementTrigger.every(u=>u.type==_model_data_Element__WEBPACK_IMPORTED_MODULE_17__.Hg.wild&&!!this.game.elementBoard.find(y=>y.state==u.state)||!!this.game.elementBoard.find(y=>y.type==u.type&&y.state==u.state)))}return active}addScenarioRule(u,y,v,M,x=!1){const O=this.scenarioRuleActive(y,v,M,x),V={edition:u.edition,scenario:u.index,group:u.group,index:v,section:M},c=this.game.appliedScenarioRules.find(T=>T.edition==V.edition&&T.scenario==V.scenario&&T.group==V.group&&T.index==V.index&&T.section==V.section),E=this.game.discardedScenarioRules.find(T=>T.edition==V.edition&&T.scenario==V.scenario&&T.group==V.group&&T.index==V.index&&T.section==V.section),R=this.game.scenarioRules.find(T=>T.identifier.edition==V.edition&&T.identifier.scenario==V.scenario&&T.identifier.group==V.group&&T.identifier.index==V.index&&T.identifier.section==V.section);!O||c||E||R?!O&&y.always&&(this.game.scenarioRules=this.game.scenarioRules.filter(T=>T.identifier.edition!=V.edition||T.identifier.group!=V.group||T.identifier.index!=V.index||T.identifier.scenario!=V.scenario||T.identifier.section!=V.section)):(y.spawns&&y.spawns.forEach(T=>{T.manual&&!T.count&&0!=T.count&&(T.count=1)}),y.objectiveSpawns&&y.objectiveSpawns.forEach(T=>{T.manual&&!T.count&&0!=T.count&&(T.count=1)}),this.game.scenarioRules.push({identifier:V,rule:y}))}addActiveFigureRule(u,y=!1){const v=this.game.scenario;v&&v.rules&&v.rules.filter(M=>{if(M.figures){const x=M.figures.find(O=>O.type==(y?"afterTurn":"onTurn"));return null!=x&&this.figuresByFigureRule(x,M).some(O=>O.edition==u.edition&&O.name==u.name)}return!1}).forEach(M=>{this.addScenarioRule(v,M,v.rules.indexOf(M),!1)}),this.game.sections&&this.game.sections.forEach(M=>{M.rules&&M.rules.filter(x=>{if(x.figures){const O=x.figures.find(V=>V.type==(y?"afterTurn":"onTurn"));return null!=O&&this.figuresByFigureRule(O,x).some(V=>V.edition==u.edition&&V.name==u.name)}return!1}).forEach(x=>{this.addScenarioRule(M,x,M.rules.indexOf(x),!0)})}),this.filterDisabledScenarioRules()}getScenarioForRule(u){if(u.section){const y=this.game.sections.find(v=>v.edition==u.edition&&v.group==u.group&&v.index==u.scenario&&v.rules&&v.rules.length>u.index);if(y)return{scenario:y,section:!0}}else if(this.game.scenario&&this.game.scenario.edition==u.edition&&this.game.scenario.group==u.group&&this.game.scenario.index==u.scenario&&this.game.scenario.rules&&this.game.scenario.rules.length>u.index)return{scenario:this.game.scenario,section:!1};return{scenario:void 0,section:!1}}figuresByFigureRule(figureRule,rule){const ref=figureRule.identifierRef;return"number"==typeof ref?ref>=0&&ref<rule.figures.length&&ref!=rule.figures.indexOf(figureRule)&&rule.figures.indexOf(figureRule)!=rule.figures[ref].identifierRef?this.figuresByFigureRule(rule.figures[ref],rule):(console.warn("Invalid Figure Fule Identifier Ref!",ref,rule),[]):figureRule.identifier&&(figureRule.identifier.health||figureRule.identifier.hp||figureRule.identifier.conditions&&0!=figureRule.identifier.conditions.length)?_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.figuresByIdentifier(figureRule.identifier,figureRule.scenarioEffect).filter(figure=>{if(figureRule.identifier&&figureRule.identifier.number&&figure instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&figure.entities.every(entity=>figureRule.identifier&&figureRule.identifier.number&&!eval(figureRule.identifier.number.replaceAll("N",""+entity.number))))return!1;if(figureRule.identifier&&figureRule.identifier.health){if(figure instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K){const u=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(figureRule.identifier.health.replaceAll("H",""+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(figure.maxHealth)));return figure.health<=u}if(figure instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R||figure instanceof _model_ObjectiveContainer__WEBPACK_IMPORTED_MODULE_7__.$e)return figure.entities.some(u=>{if(figureRule.identifier&&figureRule.identifier.health&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.isAlive(u)){const y=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(figureRule.identifier.health.replaceAll("H",""+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(u.maxHealth)));return u.health<=y}return!1})}if(figureRule.identifier&&figureRule.identifier.hp){if(figure instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K)return eval(figureRule.identifier.hp.replaceAll("HP",""+figure.health).replaceAll("H",""+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(figure.maxHealth)));if(figure instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R||figure instanceof _model_ObjectiveContainer__WEBPACK_IMPORTED_MODULE_7__.$e)return figure.entities.some(entity=>{if(figureRule.identifier&&figureRule.identifier.hp&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.isAlive(entity)){const expression=figureRule.identifier.hp.replaceAll("HP",""+entity.health).replaceAll("H",""+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(entity.maxHealth));return eval(expression)}return!1})}if(figureRule.identifier&&figureRule.identifier.conditions){if(figure instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K)return figureRule.identifier.conditions.every(u=>u.startsWith("!")&&!_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.hasCondition(figure,new _model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.kW(u.substring(1)))||!u.startsWith("!")&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.hasCondition(figure,new _model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.kW(u)));if(figure instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R||figure instanceof _model_ObjectiveContainer__WEBPACK_IMPORTED_MODULE_7__.$e)return figure.entities.some(u=>!!(figureRule.identifier&&figureRule.identifier.health&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.isAlive(u))&&figureRule.identifier.conditions&&figureRule.identifier.conditions.every(y=>y.startsWith("!")&&!_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.hasCondition(u,new _model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.kW(y.substring(1)))||!y.startsWith("!")&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.hasCondition(u,new _model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.kW(y))))}return!1}):_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.figuresByIdentifier(figureRule.identifier,figureRule.scenarioEffect)}entitiesByFigureRule(figureRule,rule){const ref=figureRule.identifierRef;return"number"==typeof ref?rule&&ref>=0&&ref<rule.figures.length&&ref!=rule.figures.indexOf(figureRule)&&rule.figures.indexOf(figureRule)!=rule.figures[ref].identifierRef?this.entitiesByFigureRule(rule.figures[ref],rule):(console.warn("Invalid Figure Fule Identifier Ref!",ref,rule),[]):figureRule.identifier&&(figureRule.identifier.number||figureRule.identifier.health||figureRule.identifier.hp||figureRule.identifier.conditions&&0!=figureRule.identifier.conditions.length)?_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entitiesByIdentifier(figureRule.identifier,figureRule.scenarioEffect).filter(entity=>{let filter=!0;if(figureRule.identifier&&figureRule.identifier.health&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.isAlive(entity)){const u=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(figureRule.identifier.health.replaceAll("H",""+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(entity.maxHealth)));filter=filter&&entity.health<=u}if(figureRule.identifier&&figureRule.identifier.hp&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.isAlive(entity)){const expression=figureRule.identifier.hp.replaceAll("HP",""+entity.health).replaceAll("H",""+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(entity.maxHealth));filter=filter&&eval(expression)}return figureRule.identifier&&figureRule.identifier.conditions&&(filter=filter&&figureRule.identifier.conditions.every(u=>u.startsWith("!")&&!_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.hasCondition(entity,new _model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.kW(u.substring(1)))||!u.startsWith("!")&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.hasCondition(entity,new _model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.kW(u)))),figureRule.identifier&&figureRule.identifier.number&&(filter=filter&&eval(figureRule.identifier.number.replaceAll("N",""+entity.number))),figureRule.identifier&&figureRule.identifier.marker&&(entity instanceof _model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__.I||entity instanceof _model_ObjectiveEntity__WEBPACK_IMPORTED_MODULE_8__.X)&&(filter=filter&&figureRule.identifier.marker==entity.marker),filter}):_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entitiesByIdentifier(figureRule.identifier,figureRule.scenarioEffect)}presentEntitiesByFigureRule(u,y){return this.entitiesByFigureRule(u,y).filter(v=>(_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.isAlive(v)||v instanceof _model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__.I&&v.dormant)&&(!(v instanceof _model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__.I)||!u.identifier?.marker||u.identifier&&v.marker==u.identifier.marker&&(!u.identifier.tags||0==u.identifier.tags.length||u.identifier.tags.forEach(M=>v.tags.includes(M)))))}applyRule(u,y,v=void 0){const M=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.getScenarioForRule(y).scenario,x=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.getScenarioForRule(y).section;if(M){if(u.figures&&u.figures.filter(O=>"remove"==O.type).forEach(O=>{_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.figuresByFigureRule(O,u).forEach(c=>{c instanceof _model_ObjectiveContainer__WEBPACK_IMPORTED_MODULE_7__.$e?_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.objectiveManager.removeObjective(c):c instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.monsterManager.removeMonster(c)})}),u.spawns){let O=[];u.spawns.forEach(V=>{const c=this.spawnType(V.monster);M&&(c==_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_13__.N.boss||c==_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_13__.N.elite)&&O.push(...this.applySpawnRule(M,u,V,c))}),u.spawns.forEach(V=>{const c=this.spawnType(V.monster);M&&c==_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_13__.N.normal&&O.push(...this.applySpawnRule(M,u,V,c))})}if(u.objectiveSpawns&&u.objectiveSpawns.forEach(O=>{const V={edition:M.edition,scenario:M.index,group:M.group,section:x,index:O.objective.id-1},c=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.objectiveManager.objectiveDataByObjectiveIdentifier(V);if(c&&0!=O.count){const E=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(O.count||1);let R=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.objectiveManager.addObjective(c,c.name,V);R&&O.objective.marker&&(R.marker=O.objective.marker);for(let T=0;T<E;T++){const B=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.objectiveManager.addObjectiveEntity(R);O.objective.tags&&(B.tags=O.objective.tags),(R.marker||B.tags.length>0)&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.addEntityCount(R)}}}),u.elements&&u.elements.forEach(O=>{_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.elementBoard.forEach(V=>{O&&V.type==O.type&&(V.state=O.state)})}),u.figures&&(u.figures.filter(O=>"gainCondition"==O.type||"permanentCondition"==O.type||"loseCondition"==O.type||"damage"==O.type||"heal"==O.type||"setHp"==O.type||"dormant"==O.type||"activate"==O.type||"removeEntity"==O.type).forEach(O=>{let V=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.figuresByFigureRule(O,u),c=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.entitiesByFigureRule(O,u);V.forEach(E=>{_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.entitiesAll(E).filter(T=>c.includes(T)&&(!v||v.includes(T))).forEach(T=>{switch(O.type){case"gainCondition":let B=new _model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.kW(O.value);_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.hasCondition(T,B)||_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.addCondition(T,E,B);break;case"permanentCondition":let q=new _model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.kW(O.value);_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.hasCondition(T,q,!0)||_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.addCondition(T,E,q,!0);break;case"loseCondition":let I=new _model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.kW(O.value);_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.hasCondition(T,I)&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.removeCondition(T,E,I);break;case"damage":let D,s=0;s=isNaN(+O.value)&&O.value.includes("H")?+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(O.value.replaceAll("HP",""+T.health).replaceAll("H",""+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(T.maxHealth))):+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(O.value),E instanceof _model_ObjectiveContainer__WEBPACK_IMPORTED_MODULE_7__.$e&&E.objectiveId&&(D=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.objectiveManager.objectiveDataByObjectiveIdentifier(E.objectiveId)),D&&D.trackDamage?s*=-1:s<0?s=0:s>(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(T.maxHealth)&&(s=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(T.maxHealth)),_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.changeHealth(T,E,-s,!0);break;case"heal":let p=0;p=isNaN(+O.value)&&O.value.includes("H")?+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(O.value.replaceAll("HP",""+T.health).replaceAll("H",""+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(T.maxHealth))):+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(O.value),p<0&&(p=0),T.health+=p,_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.addCondition(T,E,new _model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.kW(_model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.r5.heal,p)),_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.applyCondition(T,E,_model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.r5.heal,!0);break;case"setHp":let G=0;G=isNaN(+O.value)&&O.value.includes("H")?+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(O.value.replaceAll("HP",""+T.health).replaceAll("H",""+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(T.maxHealth))):+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(O.value),G<0?G=0:G>(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(T.maxHealth)&&(G=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(T.maxHealth)),T.health=G;break;case"dormant":T instanceof _model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__.I&&(T.dormant=!0,T.revealed=!1);break;case"activate":T instanceof _model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__.I&&(T.dormant=!1);break;case"removeEntity":T.tags.push("ignore-kill"),T instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K?_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.characterManager.removeCharacter(T):E instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&T instanceof _model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__.I?_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.monsterManager.removeMonsterEntity(E,T):E instanceof _model_ObjectiveContainer__WEBPACK_IMPORTED_MODULE_7__.$e&&T instanceof _model_ObjectiveEntity__WEBPACK_IMPORTED_MODULE_8__.X&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.objectiveManager.removeObjectiveEntity(E,T),O.identifier&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityCounters(O.identifier).forEach(H=>{H.total-=1})}})})}),u.figures.filter(O=>"toggleOff"==O.type||"toggleOn"==O.type).forEach(O=>{_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.figuresByFigureRule(O,u).forEach(c=>{c.off="toggleOff"==O.type,c instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&c.entities.forEach(E=>{E.dormant="toggleOff"==O.type})})}),u.figures.filter(O=>"transfer"==O.type||"transferEntities"==O.type).forEach(O=>{const V=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.figuresByFigureRule(O,u),c=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.entitiesByFigureRule(O,u);if(1==V.length&&V[0]instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R){const E=V[0],R=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.monsterManager.addMonsterByName(O.value,M.edition);R&&("transfer"==O.type?(O.value.includes(":")||(R.level=E.level),R.active=E.active,R.drawExtra=E.drawExtra,R.lastDraw=E.lastDraw,R.ability=E.ability,R.isAlly=E.isAlly,R.isAllied=E.isAllied,O.identifier&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityCounters(O.identifier).forEach(T=>{T.total-=E.entities.length}),R.entities=[...R.entities,...E.entities],E.entities.forEach(T=>{_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.addEntityCount(R,T)})):(O.identifier&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityCounters(O.identifier).forEach(T=>{T.total-=c.length}),R.entities=[...R.entities,...c.filter(T=>T instanceof _model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__.I).map(T=>T)],c.forEach(T=>{_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.addEntityCount(R,T)})),R.entities.forEach(T=>{const B=E.stats.find(I=>I.level==E.level&&I.type==T.type),q=R.stats.find(I=>I.level==R.level&&I.type==T.type);q?(T.stat=q,B&&T.maxHealth==(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(B.health)&&(T.maxHealth=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(q.health))):(R.errors=R.errors||[],!R.errors.find(I=>I.type==_model_data_FigureError__WEBPACK_IMPORTED_MODULE_11__.H.unknown)&&!R.errors.find(I=>I.type==_model_data_FigureError__WEBPACK_IMPORTED_MODULE_11__.H.stat)&&(console.error("Could not find '"+T.type+"' stats for monster: "+R.name+" level: "+R.level),R.errors.push(new _model_data_FigureError__WEBPACK_IMPORTED_MODULE_11__.h(_model_data_FigureError__WEBPACK_IMPORTED_MODULE_11__.H.stat,"monster",R.name,R.edition,T.type,""+R.level)))),(T.health>T.maxHealth||0==T.maxHealth&&T.health>0)&&(T.health=T.maxHealth)}),R!=E&&("transfer"==O.type?_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.monsterManager.removeMonster(E):E.entities=E.entities.filter(T=>!c.includes(T))),R.off=0==_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.monsterManager.monsterEntityCount(R),E.off=0==_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.monsterManager.monsterEntityCount(E),_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.sortFigures(R))}else if(1==V.length&&V[0]instanceof _model_ObjectiveContainer__WEBPACK_IMPORTED_MODULE_7__.$e){const E=V[0],T=M.objectives[+O.value-1];let B=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.objectiveManager.addObjective(T,void 0,{edition:M.edition,scenario:M.index,group:M.group,section:x,index:+O.value-1});B.entities=E.entities,B.entities.forEach(q=>{q.maxHealth=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(E.health),q.health>q.maxHealth&&(q.health=q.maxHealth),T&&(T.tags&&(q.tags=T.tags),T.marker&&(q.marker=T.marker))}),_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.objectiveManager.removeObjective(E)}}),u.figures.filter(O=>"amAdd"==O.type||"amRemove"==O.type).forEach(O=>{_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.figuresByFigureRule(O,u).forEach(c=>{const E=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.attackModifierManager.byFigure(c),R=O.value.split(":")[0];let T=+O.value.split(":")[1];if("amAdd"==O.type)for(let B=0;B<T;B++){if(R==_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_9__.Yn.bless&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.attackModifierManager.countUpcomingBlesses()>=10)return;if(R==_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_9__.Yn.curse&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.attackModifierManager.countUpcomingCurses(c instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&!c.isAlly&&!c.isAllied)>=10)return;if(R==_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_9__.Yn.minus1&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.attackModifierManager.countExtraMinus1()>=15)return;_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.attackModifierManager.addModifier(E,new _model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_9__.uU(R))}else{let B=E.cards.find((q,I)=>q.type==R&&I>E.current);for(;B&&T>0;)E.cards.splice(E.cards.indexOf(B),1),B=E.cards.find((q,I)=>q.type==R&&I>E.current),T--;if(T>0){let q=E.cards.find(I=>I.type==R);for(;q&&T<0;)E.cards.splice(E.cards.indexOf(q),1),q=E.cards.find(I=>I.type==R),T--}}})}),u.figures.filter(O=>"setAbility"==O.type||"drawAbility"==O.type||"discardAbilityToBottom"==O.type||"removeAbility"==O.type).forEach(O=>{_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.figuresByFigureRule(O,u).forEach(c=>{if(c instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R)if("setAbility"==O.type||"removeAbility"==O.type){const E=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.abilities(c).find(R=>isNaN(+O.value)?R.name==O.value:R.cardId==+O.value);if(E){const R=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.abilities(c).indexOf(E);-1!=R&&(c.abilities=c.abilities.filter(T=>T!=R),"setAbility"==O.type&&(c.abilities.unshift(R),c.ability=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.state==_model_Game__WEBPACK_IMPORTED_MODULE_4__.mk.draw?-1:0))}}else"drawAbility"==O.type?_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.monsterManager.drawAbility(c):"discardAbilityToBottom"==O.type&&(0,_angular_cdk_drag_drop__WEBPACK_IMPORTED_MODULE_0__.HD)(c.abilities,c.ability,0)})})),u.statEffects&&u.statEffects.forEach(O=>{const V=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.figuresByIdentifier(O.identifier);let c=0;if(O.reference&&("present"==O.reference.type||"killed"==O.reference.type)){const E=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.presentEntitiesByFigureRule(O.reference,u).length,R=O.reference.value?(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(O.reference.value.split(":")[0]):0;c="present"==O.reference.type?E+R:R-E}V.forEach(E=>{if(E instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R){let R=new _model_data_MonsterStat__WEBPACK_IMPORTED_MODULE_12__.M;R.name=O.statEffect.name,O.statEffect.health&&(R.health=(""+O.statEffect.health).replaceAll("X",""+c)),O.statEffect.movement&&(R.movement=(""+O.statEffect.movement).replaceAll("X",""+c)),O.statEffect.attack&&(R.attack=(""+O.statEffect.attack).replaceAll("X",""+c)),O.statEffect.range&&(R.range=(""+O.statEffect.range).replaceAll("X",""+c)),R.initiative=O.statEffect.initiative,R.flying=O.statEffect.flying,R.actions=O.statEffect.actions,R.special=O.statEffect.special,R.immunities=O.statEffect.immunities,R.deck=O.statEffect.deck,R.absolute=O.statEffect.absolute||!1,R.note=O.note,E.statEffect=R.absolute||R.health||R.movement||R.attack||R.range||R.initiative||R.actions&&R.actions.length||R.immunities&&R.immunities.length||R.deck||R.name||null!=R.flying?R:void 0,E.statEffect&&E.statEffect.initiative&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.sortFigures()}})}),u.randomDungeon&&u.randomDungeon.monsterCount&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario){const O=(0,src_app_ui_helper_Static__WEBPACK_IMPORTED_MODULE_1__.Z)(_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.sectionData(_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario.edition,!0).filter(V=>"randomMonsterCard"==V.group&&u.randomDungeon&&(!u.randomDungeon.monsterCards||u.randomDungeon.monsterCards.includes(V.index))&&(!_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario||!_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario.additionalSections||!_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario.additionalSections.includes(V.index))));O.length>=u.randomDungeon.monsterCount&&(_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario.additionalSections=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario.additionalSections||[],_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario.additionalSections.push(...O.slice(0,u.randomDungeon.monsterCount).map(V=>V.index)),u.randomDungeon.initial&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioManager.addSection(O[0]))}}}spawns(u){return u.spawns&&u.spawns.filter(y=>this.spawnType(y.monster))||[]}spawnType(u){let y=u.type;if(!y){const v=Math.max(2,_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.characterManager.characterCount());y=v<3?u.player2:3==v?u.player3:u.player4}return y}spawnCount(u,y){let v=y.count,M=0;if(v&&u.figures){const x=u.figures.find(O=>"present"==O.type||"dead"==O.type);if(x){const O=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.entitiesByFigureRule(x,u).filter(c=>_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.isAlive(c)&&(!(c instanceof _model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__.I)||!x.identifier?.marker||c instanceof _model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__.I&&c.marker==x.identifier?.marker)),V=x.value&&x.value.split(":").length>1?(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(x.value.split(":")[1]):0;M="present"==x.type?O.length:Math.max(0,V-O.length)}}for(;"string"==typeof v&&v.includes("F");)v=v.replace("F",""+M);return(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(v||(y.manual?0:1))}applySpawnRule(u,y,v,M){const x=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.monsterManager.addMonsterByName(v.monster.name,u.edition);let O=[];if(x)for(let V=0;V<this.spawnCount(y,v);V++){let c=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.monsterManager.spawnMonsterEntity(x,M,u.allies&&u.allies.includes(v.monster.name),u.allied&&u.allied.includes(v.monster.name),u.drawExtra&&u.drawExtra.includes(v.monster.name),v.summon);c&&(v.monster.marker&&(c.marker=v.monster.marker),v.monster.tags&&(c.tags=v.monster.tags),O.push(v.monster.name),(c.marker||c.tags.length>0)&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.addEntityCount(x,c))}return O}}},840(u,y,v){v.d(y,{Uc:()=>E,X2:()=>x,di:()=>c,iQ:()=>O,lB:()=>V,rc:()=>M});class M{type;value;valueObject;valueType;subActions;small;hidden;noDivider=!1;enhancementTypes;constructor(T,B="",q=O.fixed,I=[],s=!1,D=!1){this.type=T,this.value=B,this.valueType=q,this.subActions=I||[],this.small=s,this.hidden=D}}var x=function(R){return R.area="area",R.attack="attack",R.box="box",R.boxFhSubActions="boxFhSubActions",R.card="card",R.concatenation="concatenation",R.concatenationSpacer="concatenationSpacer",R.condition="condition",R.custom="custom",R.damage="damage",R.element="element",R.elementHalf="elementHalf",R.extra="extra",R.fly="fly",R.fontSize="fontSize",R.forceBox="forceBox",R.grant="grant",R.grid="grid",R.heal="heal",R.hint="hint",R.jump="jump",R.loot="loot",R.monsterType="monsterType",R.move="move",R.nonCalc="nonCalc",R.pierce="pierce",R.pull="pull",R.push="push",R.range="range",R.retaliate="retaliate",R.round="round",R.shield="shield",R.spawn="spawn",R.special="special",R.specialTarget="specialTarget",R.sufferDamage="sufferDamage",R.summon="summon",R.swing="swing",R.switchType="switchType",R.target="target",R.teleport="teleport",R.trigger="trigger",R}(x||{}),O=function(R){return R.plus="plus",R.minus="minus",R.add="add",R.subtract="subtract",R.fixed="fixed",R}(O||{}),V=function(R){return R.all="all",R.allCharacters="allCharacters",R.allies="allies",R.alliesAdjacent="alliesAdjacent",R.alliesAdjacentAffect="alliesAdjacentAffect",R.alliesAffect="alliesAffect",R.alliesEnemies="alliesEnemies",R.alliesRange="alliesRange",R.alliesRangeAffect="alliesRangeAffect",R.ally="ally",R.allyAdjacent="allyAdjacent",R.allyAffect="allyAffect",R.allyAffectAdjacent="allyAffectAdjacent",R.allyAffectRange="allyAffectRange",R.allyShort="allyShort",R.enemies="enemies",R.enemiesAdjacent="enemiesAdjacent",R.enemiesMovedThrough="enemiesMovedThrough",R.enemiesMovedThroughAdjacent="enemiesMovedThroughAdjacent",R.enemiesRange="enemiesRange",R.enemiesRangeAffect="enemiesRangeAffect",R.enemiesRangeAffectExact="enemiesRangeAffectExact",R.enemiesRangeExact="enemiesRangeExact",R.enemy="enemy",R.enemyAdjacent="enemyAdjacent",R.enemyAllyRange="enemyAllyRange",R.enemyOneAll="enemyOneAll",R.enemyRange="enemyRange",R.figures="figures",R.figuresAdjacent="figuresAdjacent",R.figuresRange="figuresRange",R.focusEnemyFarthest="focusEnemyFarthest",R.self="self",R.selfAllies="selfAllies",R.selfAlliesAdjacentAffect="selfAlliesAdjacentAffect",R.selfAlliesAffect="selfAlliesAffect",R.selfAlliesAffectRange="selfAlliesAffectRange",R.selfAlliesRange="selfAlliesRange",R.selfOrAlly="selfOrAlly",R.targets="targets",R}(V||{}),c=function(R){return R.experience="experience",R.flip="flip",R.flipItem="flipItem",R.loss="loss",R.lost="lost",R.minus1="minus1",R.persistent="persistent",R.recover="recover",R.refresh="refresh",R.round="round",R.shuffle="shuffle",R.slot="slot",R.slotEnd="slotEnd",R.slotEndXp="slotEndXp",R.slotStart="slotStart",R.slotStartXp="slotStartXp",R.slotXp="slotXp",R.slotXpFh="slotXpFh",R.spent="spent",R}(c||{});class E{type;value;range;additionalRange=!1;constructor(T,B,q=0){this.type=T,this.value=B,this.range=q}}},985(u,y,v){var M=v(901),x=v(7580),O=v(9552),V=v(9549),c=v(5240),E=v(496),R=v(9791),T=v(3196);var q=v(4487),I=v(9204),s=v(8317),D=v(9765),p=v(1619),G=v(6484),H=v(1824),b=v(2065),S=v(6538),A=v(3812),F=v(4670),t=v(2481),N=v(3683),K=v(2120),w=v(3219),Q=v(2357),$=v(840),Kt=v(392);let st=(()=>{class a{gameManager=s.E;settingsManager=p.f;constructor(){this.onUiChange().subscribe({next:()=>{s.E.checkEntitiesKilled(),s.E.game.levelCalculation&&s.E.levelManager.calculateScenarioLevel(),p.f.settings.scenarioRules&&(s.E.scenarioRulesManager.addScenarioRulesAlways(),s.E.scenarioRulesManager.applyScenarioRulesAlways()),s.E.roundManager.firstRound=0==s.E.game.round&&0==s.E.game.roundResets.length&&0==s.E.game.roundResetsHidden.length,s.E.buildingsManager.update(),s.E.challengesManager.update(),s.E.trialsManager.update(),s.E.enhancementsManager.update(),s.E.imbuementManager.update()}})}triggerUiChange(n=!1){this.gameManager.uiChange.next(n)}onUiChange(){return this.gameManager.uiChange.asObservable()}static \u0275fac=function(i){return new(i||a)};static \u0275prov=c.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();function Wt(a,r=void 0,n=!1){if("number"==typeof a)return n&&0==a?"-":a;if("string"==typeof a&&"0"==a)return"-";if(!a)return n?"-":"";let i=s.E.game.level;if(r&&r>0&&(i=r),p.f.settings.calculate&&(a.match(A.p5)||a.match(A.OD)))try{return(0,A.hZ)(a,i)}catch{return console.error("Could not calculate value for: ",a),a}const e=a.match(A.OD);if(e){let o=e[3],g=[];const m=o&&o.startsWith("$");return m&&(o=o.replace("$",""),o.includes(":")&&(g=[o.split(":")[1]],o=o.split(":")[0])),m?e[1]+" "+p.f.getLabel("game.custom."+o,g):e[1]}for(;a.match(pa);)a=a.replace(pa,(o,...g)=>p.f.getLabel(g[0]));return a||(n?"-":"")}let nn=(()=>{class a{el;ghsManager;value;level;empty=!1;C;L;calc;constructor(n,i){this.el=n,this.ghsManager=i,this.C=Math.max(2,s.E.characterManager.characterCount()),this.L=s.E.game.level,this.calc=p.f.settings.calculate}ngOnChanges(n){this.el.nativeElement.innerHTML=Wt(this.value,this.level,this.empty)}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{(this.calc!=p.f.settings.calculate||this.C!=Math.max(2,s.E.characterManager.characterCount())||this.L!=s.E.game.level)&&(this.C=Math.max(2,s.E.characterManager.characterCount()),this.L=s.E.game.level,this.calc=p.f.settings.calculate,this.el.nativeElement.innerHTML=Wt(this.value,this.level,this.empty))}}),this.el.nativeElement.innerHTML=Wt(this.value,this.level,this.empty)}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT),t.rXU(st))};static \u0275dir=t.FsC({type:a,selectors:[["","value-calc",""]],inputs:{value:[0,"value-calc","value"],level:"level",empty:"empty"},standalone:!1,features:[t.OA$]})}return a})();const Sn=["enhancementContainer"],_n=(a,r,n,i,e,o)=>({highlight:a,inline:r,right:n,"text-black":i,fh:e,aoe:o}),Yt=a=>({small:a}),mn=(a,r)=>({"action-interactive":a,"action-interactive-highlight":r}),bn=a=>[a],Zt=()=>[],kn=(a,r)=>({small:a,"action-element-consume":r}),Dn=(a,r)=>({consume:a,wild:r}),Rt=(a,r,n)=>({consume:a,"action-interactive":r,"action-interactive-highlight":n}),Z=(a,r)=>({"text-white":a,small:r}),vt=()=>["alliesRange:","alliesRangeAffect:","allyAffectRange:","enemiesRange:","enemiesRangeAffect:","enemyRange:"],rn=(a,r)=>({small:a,"text-white":r}),Wn=(a,r)=>[a,r],Zn=(a,r)=>({small:a,"card-concat":r}),jt=(a,r,n)=>({small:a,empty:r,first:n}),pt=(a,r,n)=>({small:a,"action-interactive":r,"action-interactive-highlight":n}),On=a=>({"ghs-svg":a}),$n=a=>({elite:a}),Gt=(a,r)=>r._trackUUID,Jn=(a,r)=>r+a;function Qn(a,r){if(1&a&&(t.j41(0,"span",2),t.nrm(1,"ghs-action-hex",23),t.k0s()),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(7,Yt,n.action.small)),t.R7$(),t.Y8G("action",n.action)("value",""+n.action.value)("size",n.hexSize)("index",n.actionIndex)("cardId",n.cardId)("character",n.character)}}function yn(a,r){if(1&a&&t.nrm(0,"img",28),2&a){const n=t.XpG(3);t.Y8G("src","./assets/images"+(n.fhStyle?"/fh":"")+"/condition/"+n.getConditionName(n.values[0])+".svg",t.B4B)}}function Ae(a,r){1&a&&t.nrm(0,"img",29)}function Ve(a,r){if(1&a&&(t.j41(0,"span",30),t.EFF(1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.JRh(n.values[1])}}function Fe(a,r){if(1&a&&t.nrm(0,"ghs-action-enhancements",31),2&a){const n=t.XpG(3);t.Y8G("action",n.origAction)("index",n.actionIndex)("character",n.character)("cardId",n.cardId)}}function Xe(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function le(a,r){if(1&a){const n=t.RV6();t.nVh(0,Xe,2,0,"span"),t.j41(1,"ghs-action",33),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(4);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(4);t.vxM(e.fhStyle&&i>0?0:-1),t.R7$(),t.Aen(e.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",e.monster)("objective",e.objective)("inline",e.inline)("right",e.right)("textBlack",e.textBlack)("hexSize",e.hexSize)("statsCalculation",e.statsCalculation)("interactiveAbilities",e.interactiveAbilities)("interactiveActions",e.interactiveActions)("index",(e.actionIndex?e.actionIndex+"-":"")+e.getOrigIndex(n))("monsterType",e.monsterType)("character",e.character)("cardId",e.cardId)}}function xn(a,r){if(1&a&&(t.j41(0,"div",32),t.Z7z(1,le,2,18,null,null,Gt),t.nI1(3,"slice"),t.nI1(4,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(4,3,t.i5U(3,0,n.subActions,n.hasAOE?1:0)))}}function En(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",3)(1,"span",24),t.bIt("singleClick",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.toggleHighlight(e))}),t.j41(2,"span",25),t.nrm(3,"span",26),t.k0s(),t.j41(4,"span",27),t.nVh(5,yn,1,1,"img",28),t.nVh(6,Ae,1,0,"img",29),t.nVh(7,Ve,2,1,"span",30),t.k0s(),t.nVh(8,Fe,1,4,"ghs-action-enhancements",31),t.k0s(),t.nVh(9,xn,5,5,"div",32),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(15,Yt,n.action.small)),t.R7$(),t.Y8G("clickBehind",!n.isInteractiveApplicableAction)("ghs-tooltip","monster.toggleAction")("delay",1)("disabled",!n.isInteractiveApplicableAction)("ngClass",t.l_i(17,mn,n.isInteractiveApplicableAction,n.highlightAction())),t.R7$(2),t.Aen(n.style),t.Y8G("ghs-label","game.condition."+n.getConditionName(n.values[0]))("ghs-label-args",n.values.length>1?t.eq3(20,bn,n.values[1]):t.lJ4(22,Zt)),t.R7$(2),t.vxM("invalid"!=n.getConditionName(n.values[0])?5:-1),t.R7$(),t.vxM("invalid"==n.getConditionName(n.values[0])?6:-1),t.R7$(),t.vxM(n.values.length>1?7:-1),t.R7$(),t.vxM(n.origAction.enhancementTypes&&n.origAction.enhancementTypes.length&&n.character&&n.cardId?8:-1),t.R7$(),t.vxM(n.subActions.length>0?9:-1)}}function ge(a,r){if(1&a&&(t.j41(0,"span",35),t.nrm(1,"img",38),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(3);t.Y8G("ngClass",t.l_i(2,Dn,i.action.valueType==i.ActionValueType.minus,"wild"==n)),t.R7$(),t.Y8G("src","./assets/images"+(i.fhStyle?"/fh":"")+"/element/"+n+".svg",t.B4B)}}function de(a,r){1&a&&(t.j41(0,"span",36),t.EFF(1,":"),t.k0s())}function he(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function _e(a,r){if(1&a){const n=t.RV6();t.nVh(0,he,2,0,"span"),t.j41(1,"ghs-action",39),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(4);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(4);t.vxM(e.fhStyle&&i>0?0:-1),t.R7$(),t.Aen(e.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",e.monster)("objective",e.objective)("relative",e.relative||e.forceRelative)("inline",e.inline)("right",e.right)("textBlack",e.textBlack)("hexSize",e.hexSize)("interactiveAbilities",e.interactiveAbilities)("interactiveActions",e.interactiveActions)("statsCalculation",e.statsCalculation)("index",(e.actionIndex?e.actionIndex+"-":"")+e.getOrigIndex(n))("monsterType",e.monsterType)("character",e.character)("cardId",e.cardId)}}function pn(a,r){if(1&a&&(t.j41(0,"div",37),t.Z7z(1,_e,2,19,null,null,Gt),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(3,0,n.subActions))}}function Be(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",4)(1,"span",34),t.bIt("singleClick",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.toggleHighlight(e))}),t.Z7z(2,ge,2,5,"span",35,Jn),t.nVh(4,de,2,0,"span",36),t.k0s(),t.nVh(5,pn,4,2,"div",37),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.l_i(8,kn,n.action.small,n.action.valueType==n.ActionValueType.minus)),t.R7$(),t.Y8G("clickBehind",!n.isInteractiveApplicableAction)("ghs-tooltip","monster.toggleAction")("delay",1)("disabled",!n.isInteractiveApplicableAction)("ngClass",t.l_i(11,mn,n.isInteractiveApplicableAction,n.highlightAction())),t.R7$(),t.Dyx(n.values),t.R7$(2),t.vxM(n.action.valueType==n.ActionValueType.minus&&n.subActions.length>0?4:-1),t.R7$(),t.vxM(n.subActions.length>0?5:-1)}}function si(a,r){1&a&&(t.j41(0,"span",36),t.EFF(1,":"),t.k0s())}function ri(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",40)(1,"span",41),t.bIt("singleClick",function(e){c.eBV(n);const o=t.XpG(3);return c.Njj(o.toggleHighlight(e))}),t.j41(2,"span",42),t.nrm(3,"img",38),t.k0s(),t.j41(4,"span",42),t.nrm(5,"img",38),t.k0s()(),t.nVh(6,si,2,0,"span",36),t.k0s()}if(2&a){const n=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.sMw(8,Rt,n.action.valueType==n.ActionValueType.minus,n.isInteractiveApplicableAction,n.highlightAction()))("clickBehind",!n.isInteractiveApplicableAction)("ghs-tooltip","monster.toggleAction")("delay",1)("disabled",!n.isInteractiveApplicableAction),t.R7$(2),t.Y8G("src","./assets/images"+(n.fhStyle?"/fh":"")+"/element/"+n.values[0]+".svg",t.B4B),t.R7$(2),t.Y8G("src","./assets/images"+(n.fhStyle?"/fh":"")+"/element/"+n.values[1]+".svg",t.B4B),t.R7$(),t.vxM(n.action.valueType==n.ActionValueType.minus?6:-1)}}function ci(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function li(a,r){if(1&a){const n=t.RV6();t.nVh(0,ci,2,0,"span"),t.j41(1,"ghs-action",39),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(4);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(4);t.vxM(e.fhStyle&&i>0?0:-1),t.R7$(),t.Aen(e.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",e.monster)("objective",e.objective)("relative",e.relative||e.forceRelative)("inline",e.inline)("right",e.right)("textBlack",e.textBlack)("hexSize",e.hexSize)("interactiveAbilities",e.interactiveAbilities)("interactiveActions",e.interactiveActions)("statsCalculation",e.statsCalculation)("index",(e.actionIndex?e.actionIndex+"-":"")+e.getOrigIndex(n))("monsterType",e.monsterType)("character",e.character)("cardId",e.cardId)}}function gi(a,r){if(1&a&&(t.j41(0,"div",37),t.Z7z(1,li,2,19,null,null,Gt),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(3,0,n.subActions))}}function _a(a,r){if(1&a&&(t.j41(0,"span",4),t.nVh(1,ri,7,12,"span",40),t.nVh(2,gi,4,2,"div",37),t.k0s()),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.l_i(3,kn,n.action.small,n.action.valueType==n.ActionValueType.minus)),t.R7$(),t.vxM(2==n.values.length?1:-1),t.R7$(),t.vxM(n.subActions.length>0?2:-1)}}function Ye(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function ma(a,r){if(1&a){const n=t.RV6();t.nVh(0,Ye,2,0,"span"),t.j41(1,"ghs-action",47),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(5);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(5);t.vxM(e.fhStyle&&i>0?0:-1),t.R7$(),t.Aen(e.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",e.monster)("objective",e.objective)("relative",e.relative)("inline",e.inline)("right",e.right)("textBlack",e.textBlack)("hexSize",e.hexSize)("interactiveAbilities",e.interactiveAbilities)("interactiveActions",e.interactiveActions)("statsCalculation",e.statsCalculation)("index",(e.actionIndex?e.actionIndex+"-":"")+e.getOrigIndex(n))("monsterType",e.getMonsterType(""+e.action.value))}}function Nt(a,r){if(1&a&&(t.j41(0,"div",46),t.Z7z(1,ma,2,17,null,null,Gt),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(4);t.R7$(),t.Dyx(t.bMT(3,0,n.subActions))}}function di(a,r){if(1&a&&(t.j41(0,"span",43)(1,"span",44),t.nrm(2,"span",45),t.EFF(3,":"),t.k0s(),t.nVh(4,Nt,4,2,"div",46),t.k0s()),2&a){const n=t.XpG(3);t.Y8G("ngClass",t.eq3(6,Yt,n.action.small)),t.R7$(),t.Y8G("ngClass","monster-type-"+n.action.value),t.R7$(),t.Aen(n.style),t.Y8G("ghs-label","monster."+n.action.value),t.R7$(2),t.vxM(n.subActions.length>0?4:-1)}}function hi(a,r){if(1&a&&t.nVh(0,di,5,8,"span",43),2&a){const n=t.XpG(2);t.vxM(n.relative||n.hasEntities(""+n.action.value)?0:-1)}}function _i(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-action",51),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(5);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(5);t.Aen(i.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",i.monster)("objective",i.objective)("inline",i.inline)("right",i.right)("textBlack",i.textBlack)("hexSize",i.hexSize)("interactiveAbilities",i.interactiveAbilities)("interactiveActions",i.interactiveActions)("relative",i.relative||i.forceRelative)("statsCalculation",i.statsCalculation)("index",(i.actionIndex?i.actionIndex+"-":"")+i.getOrigIndex(n))("monsterType",i.monsterType)("character",i.character)("cardId",i.cardId)}}function C(a,r){if(1&a&&(t.j41(0,"div",49),t.Z7z(1,_i,1,18,"ghs-action",50,Gt),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(4);t.R7$(),t.Dyx(t.bMT(3,0,n.subActions))}}function xt(a,r){if(1&a&&(t.j41(0,"span",48),t.nVh(1,C,4,2,"div",49),t.k0s()),2&a){const n=t.XpG(3);t.Y8G("ngClass",t.eq3(2,Yt,n.action.small)),t.R7$(),t.vxM(n.subActions.length>0?1:-1)}}function l(a,r){if(1&a&&t.nVh(0,xt,2,4,"span",48),2&a){const n=t.XpG(2);t.vxM(n.action.value==n.round?0:-1)}}function d(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"/"),t.k0s())}function h(a,r){if(1&a&&(t.j41(0,"span",57),t.EFF(1),t.k0s()),2&a){const n=t.XpG(4);t.R7$(),t.JRh(n.getEliteRange())}}function _(a,r){if(1&a&&(t.j41(0,"span",54)(1,"span"),t.EFF(2),t.k0s(),t.nVh(3,d,2,0,"span"),t.nVh(4,h,2,1,"span",57),t.k0s()),2&a){const n=t.XpG(3);t.Y8G("ngClass",t.eq3(4,Yt,n.action.small)),t.R7$(2),t.JRh(n.getRange()),t.R7$(),t.vxM(n.getEliteRange()&&n.getRange()!=n.getEliteRange()?3:-1),t.R7$(),t.vxM(n.getEliteRange()&&n.getRange()!=n.getEliteRange()?4:-1)}}function f(a,r){if(1&a&&t.nrm(0,"ghs-action-enhancements",55),2&a){const n=r.$implicit,i=t.XpG(3);t.Y8G("action",i.origAction)("index",i.actionIndex)("character",i.character)("cardId",i.cardId)("slot",n)}}function P(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function j(a,r){if(1&a){const n=t.RV6();t.nVh(0,P,2,0,"span"),t.j41(1,"ghs-action",51),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(4);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(4);t.vxM(e.fhStyle&&i>0?0:-1),t.R7$(),t.Aen(e.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",e.monster)("objective",e.objective)("inline",e.inline)("right",e.right)("textBlack",e.textBlack)("hexSize",e.hexSize)("interactiveAbilities",e.interactiveAbilities)("interactiveActions",e.interactiveActions)("relative",e.relative||e.forceRelative)("statsCalculation",e.statsCalculation)("index",(e.actionIndex?e.actionIndex+"-":"")+e.getOrigIndex(n))("monsterType",e.monsterType)("character",e.character)("cardId",e.cardId)}}function Y(a,r){if(1&a&&(t.j41(0,"div",56),t.Z7z(1,j,2,19,null,null,Gt),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(3,0,n.subActions))}}function U(a,r){if(1&a&&(t.j41(0,"span",5)(1,"div",52,0),t.nrm(3,"span",53),t.nVh(4,_,5,6,"span",54),t.Z7z(5,f,1,5,"ghs-action-enhancements",55,t.fX1),t.nI1(7,"ghsRange"),t.k0s(),t.nVh(8,Y,4,2,"div",56),t.k0s()),2&a){const n=t.XpG(2);t.R7$(3),t.Aen(n.style),t.Y8G("ghs-label","game.specialTarget."+n.values[0])("ghs-label-args",n.values.slice(1))("relative",n.relative||n.forceRelative)("ngClass",t.l_i(11,Z,!n.textBlack&&!n.right,n.action.small)),t.R7$(),t.vxM(t.lJ4(14,vt).includes(n.action.value+"")?4:-1),t.R7$(),t.Dyx(t.i5U(7,8,t.lJ4(15,Zt),n.character&&n.cardId&&n.origAction&&n.origAction.enhancementTypes&&n.origAction.enhancementTypes.length||0)),t.R7$(3),t.vxM(n.subActions.length>0?8:-1)}}function z(a,r){if(1&a&&t.nrm(0,"ghs-action-enhancements",55),2&a){const n=r.$implicit,i=t.XpG(4);t.Y8G("action",i.origAction)("index",i.actionIndex)("character",i.character)("cardId",i.cardId)("slot",n)}}function W(a,r){if(1&a&&(t.j41(0,"div",52,0),t.nrm(2,"span",59),t.Z7z(3,z,1,5,"ghs-action-enhancements",55,t.fX1),t.nI1(5,"ghsRange"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.Aen(n.style),t.Y8G("ghs-label",n.action.value+"")("relative",n.relative||n.forceRelative)("ngClass",t.l_i(8,rn,n.action.small,!n.textBlack&&!n.right)),t.R7$(),t.Dyx(t.i5U(5,5,t.lJ4(11,Zt),n.character&&n.cardId&&n.origAction&&n.origAction.enhancementTypes&&n.origAction.enhancementTypes.length||0))}}function nt(a,r){if(1&a&&t.nrm(0,"ghs-action-enhancements",31),2&a){const n=t.XpG(4);t.Y8G("action",n.origAction)("index",n.actionIndex)("character",n.character)("cardId",n.cardId)}}function gt(a,r){if(1&a&&(t.nrm(0,"span",59),t.nVh(1,nt,1,4,"ghs-action-enhancements",31)),2&a){const n=t.XpG(3);t.Aen(n.style),t.Y8G("ghs-label",n.action.value+"")("relative",n.relative||n.forceRelative)("ngClass",t.l_i(6,rn,n.action.small,!n.textBlack&&!n.right)),t.R7$(),t.vxM(n.origAction.enhancementTypes&&n.origAction.enhancementTypes.length&&n.character&&n.cardId?1:-1)}}function ht(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-action",51),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(4);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(4);t.Aen(i.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",i.monster)("objective",i.objective)("inline",i.inline)("right",i.right)("textBlack",i.textBlack)("hexSize",i.hexSize)("interactiveAbilities",i.interactiveAbilities)("interactiveActions",i.interactiveActions)("relative",i.relative||i.forceRelative)("statsCalculation",i.statsCalculation)("index",(i.actionIndex?i.actionIndex+"-":"")+i.getOrigIndex(n))("monsterType",i.monsterType)("character",i.character)("cardId",i.cardId)}}function kt(a,r){if(1&a&&(t.j41(0,"div",58),t.Z7z(1,ht,1,18,"ghs-action",50,Gt),t.nI1(3,"slice"),t.nI1(4,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(4,3,t.i5U(3,0,n.subActions,n.hasAOE?1:0)))}}function It(a,r){if(1&a&&(t.j41(0,"span",6),t.nVh(1,W,6,12,"div",52),t.nVh(2,gt,2,9),t.nVh(3,kt,5,5,"div",58),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.vxM(n.action.enhancementTypes&&"any"==n.action.enhancementTypes[0]?-1:1),t.R7$(),t.vxM(n.action.enhancementTypes&&"any"==n.action.enhancementTypes[0]?2:-1),t.R7$(),t.vxM(n.subActions.length>0?3:-1)}}function cn(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-action",51),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(4);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(4);t.Aen(i.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",i.monster)("objective",i.objective)("inline",i.inline)("right",i.right)("textBlack",i.textBlack)("hexSize",i.hexSize)("interactiveAbilities",i.interactiveAbilities)("interactiveActions",i.interactiveActions)("relative",!0)("statsCalculation",i.statsCalculation)("index",(i.actionIndex?i.actionIndex+"-":"")+i.getOrigIndex(n))("monsterType",i.monsterType)("character",i.character)("cardId",i.cardId)}}function un(a,r){if(1&a&&(t.j41(0,"div",58),t.Z7z(1,cn,1,18,"ghs-action",50,Gt),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(3,0,n.subActions))}}function me(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",60),t.bIt("singleClick",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.toggleHighlight(e))}),t.nrm(1,"span",59),t.nVh(2,un,4,2,"div",58),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("clickBehind",!n.isInteractiveApplicableAction)("ghs-tooltip","monster.toggleAction")("delay",1)("disabled",!n.isInteractiveApplicableAction)("ngClass",t.l_i(11,mn,n.isInteractiveApplicableAction,n.highlightAction())),t.R7$(),t.Aen(n.style),t.Y8G("ghs-label",n.action.value+"")("relative",n.relative||n.forceRelative)("ngClass",t.l_i(14,rn,n.action.small,!n.textBlack&&!n.right)),t.R7$(),t.vxM(n.subActions.length>0?2:-1)}}function zc(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-action",51),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(4);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(4);t.Aen(i.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",i.monster)("objective",i.objective)("inline",i.inline)("right",i.right)("textBlack",i.textBlack)("hexSize",i.hexSize)("interactiveAbilities",i.interactiveAbilities)("interactiveActions",i.interactiveActions)("relative",!0)("statsCalculation",i.statsCalculation)("index",(i.actionIndex?i.actionIndex+"-":"")+i.getOrigIndex(n))("monsterType",i.monsterType)("character",i.character)("cardId",i.cardId)}}function Lc(a,r){if(1&a&&(t.j41(0,"div",58),t.Z7z(1,zc,1,18,"ghs-action",50,Gt),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(3,0,n.subActions))}}function qc(a,r){if(1&a&&(t.j41(0,"span",61),t.nVh(1,Lc,4,2,"div",58),t.k0s()),2&a){const n=t.XpG(2);t.xc7("font-size",n.action.value+"%"),t.R7$(),t.vxM(n.subActions.length>0?1:-1)}}function Hc(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-action",51),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(4);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(4);t.Aen(i.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",i.monster)("objective",i.objective)("inline",i.inline)("right",i.right)("textBlack",i.textBlack)("hexSize",i.hexSize)("interactiveAbilities",i.interactiveAbilities)("interactiveActions",i.interactiveActions)("relative",i.relative||i.forceRelative)("statsCalculation",i.statsCalculation)("index",(i.actionIndex?i.actionIndex+"-":"")+i.getOrigIndex(n))("monsterType",i.monsterType)("character",i.character)("cardId",i.cardId)}}function Kc(a,r){if(1&a&&(t.j41(0,"div",58),t.Z7z(1,Hc,1,18,"ghs-action",50,Gt),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(3,0,n.subActions))}}function Wc(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",60),t.bIt("singleClick",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.toggleHighlight(e))}),t.nrm(1,"span",62),t.nVh(2,Kc,4,2,"div",58),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("clickBehind",!n.isInteractiveApplicableAction)("ghs-tooltip","monster.toggleAction")("delay",1)("disabled",!n.isInteractiveApplicableAction)("ngClass",t.l_i(12,mn,n.isInteractiveApplicableAction,n.highlightAction())),t.R7$(),t.Aen(n.style),t.Y8G("ghs-label","game.sufferDamage")("relative",n.relative||n.forceRelative)("ngClass",t.l_i(15,rn,n.action.small,!n.textBlack&&!n.right))("ghs-label-args",t.l_i(18,Wn,n.monster?"%data.monster."+n.monster.name+"%":"",n.action.value)),t.R7$(),t.vxM(n.subActions.length>0?2:-1)}}function Zc(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-action",51),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(4);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(4);t.Aen(i.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",i.monster)("objective",i.objective)("inline",i.inline)("right",i.right)("textBlack",i.textBlack)("hexSize",i.hexSize)("interactiveAbilities",i.interactiveAbilities)("interactiveActions",i.interactiveActions)("relative",i.relative||i.forceRelative)("statsCalculation",i.statsCalculation)("index",(i.actionIndex?i.actionIndex+"-":"")+i.getOrigIndex(n))("monsterType",i.monsterType)("character",i.character)("cardId",i.cardId)}}function Jc(a,r){if(1&a&&(t.j41(0,"div",58),t.Z7z(1,Zc,1,18,"ghs-action",50,Gt),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(3,0,n.subActions))}}function Qc(a,r){if(1&a&&(t.j41(0,"span",6),t.nrm(1,"span",59),t.nVh(2,Jc,4,2,"div",58),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Aen(n.style),t.Y8G("ghs-label",n.action.value+"")("relative",n.relative||n.forceRelative)("ngClass",t.l_i(6,rn,n.action.small,!n.textBlack&&!n.right)),t.R7$(),t.vxM(n.subActions.length>0?2:-1)}}function tl(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-action",51),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(4);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(4);t.Aen(i.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",i.monster)("objective",i.objective)("inline",i.inline)("right",i.right)("textBlack",i.textBlack)("hexSize",i.hexSize)("interactiveAbilities",i.interactiveAbilities)("interactiveActions",i.interactiveActions)("relative",i.relative||i.forceRelative)("statsCalculation",i.statsCalculation)("index",(i.actionIndex?i.actionIndex+"-":"")+i.getOrigIndex(n))("monsterType",i.monsterType)("character",i.character)("cardId",i.cardId)}}function nl(a,r){if(1&a&&(t.j41(0,"div",58),t.Z7z(1,tl,1,18,"ghs-action",50,Gt),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(3,0,n.subActions))}}function el(a,r){if(1&a&&(t.j41(0,"span",9),t.nVh(1,nl,4,2,"div",58),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.vxM(n.subActions.length>0?1:-1)}}function al(a,r){if(1&a&&t.nrm(0,"span",10),2&a){const n=t.XpG(2);t.Y8G("ghs-label",n.action.value+"")}}function il(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-action",51),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(4);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(4);t.Aen(e.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",e.monster)("objective",e.objective)("inline",e.inline)("right",e.right)("textBlack",e.textBlack)("hexSize",e.hexSize)("interactiveAbilities",e.interactiveAbilities)("interactiveActions",e.interactiveActions)("relative",!0)("statsCalculation",!1)("index",(e.actionIndex?e.actionIndex+"-":"")+i)("monsterType",e.monsterType)("character",e.character)("cardId",e.cardId)}}function ol(a,r){if(1&a&&(t.j41(0,"div",64),t.Z7z(1,il,1,18,"ghs-action",50,Gt),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(3,0,n.subActions))}}function sl(a,r){if(1&a&&(t.j41(0,"span",11),t.nrm(1,"span",63),t.nVh(2,ol,4,2,"div",64),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Aen(n.style),t.Y8G("ghs-label",n.action.value+"")("relative",n.relative||n.forceRelative)("ngClass",t.l_i(6,rn,n.action.small,!n.textBlack&&!n.right)),t.R7$(),t.vxM(n.subActions.length>0?2:-1)}}function rl(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-action",51),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(4);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(4);t.Aen(i.style),t.Y8G("ngClass","subaction-"+i.subActions[n+(i.hasAOE?1:0)].type)("action",i.subActions[n+(i.hasAOE?1:0)])("monster",i.monster)("objective",i.objective)("inline",i.inline)("right",i.right)("textBlack",i.textBlack)("hexSize",i.hexSize)("interactiveAbilities",i.interactiveAbilities)("interactiveActions",i.interactiveActions)("relative",i.relative||i.forceRelative)("statsCalculation",i.statsCalculation)("index",(i.actionIndex?i.actionIndex+"-":"")+i.getOrigIndex(i.subActions[n+(i.hasAOE?1:0)]))("monsterType",i.monsterType)("character",i.character)("cardId",i.cardId)}}function cl(a,r){if(1&a&&(t.Z7z(0,rl,1,18,"ghs-action",50,t.fX1),t.nI1(2,"ghsRange")),2&a){const n=t.XpG(3);t.Dyx(t.i5U(2,0,t.lJ4(3,Zt),n.subActions.length))}}function ll(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",12)(1,"ghs-action-summon",65),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s(),t.nVh(2,cl,3,4),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(17,Yt,n.action.small)),t.R7$(),t.Aen(n.style),t.Y8G("action",n.action)("right",n.right)("textBlack",n.textBlack)("monster",n.monster)("objective",n.objective)("interactiveAbilities",n.interactiveAbilities)("interactiveActions",n.interactiveActions)("index",n.actionIndex)("character",n.character)("cardId",n.cardId)("monsterType",n.monsterType)("character",n.character)("cardId",n.cardId),t.R7$(),t.vxM(n.subActions.length>0?2:-1)}}function gl(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-action",51),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(4);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(4);t.Aen(i.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",i.monster)("objective",i.objective)("inline",i.inline)("right",i.right)("textBlack",i.textBlack)("hexSize",i.hexSize)("interactiveAbilities",i.interactiveAbilities)("interactiveActions",i.interactiveActions)("relative",i.relative||i.forceRelative)("statsCalculation",i.statsCalculation)("index",(i.actionIndex?i.actionIndex+"-":"")+i.getOrigIndex(n))("monsterType",i.monsterType)("character",i.character)("cardId",i.cardId)}}function dl(a,r){if(1&a&&(t.Z7z(0,gl,1,18,"ghs-action",50,Gt),t.nI1(2,"trackUUID")),2&a){const n=t.XpG(3);t.Dyx(t.bMT(2,0,n.subActions))}}function hl(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",12)(1,"ghs-action-summon",66),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s(),t.nVh(2,dl,3,2),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(18,Yt,n.action.small)),t.R7$(),t.Aen(n.style),t.Y8G("action",n.action)("right",n.right)("textBlack",n.textBlack)("monster",n.monster)("objective",n.objective)("spawn",!0)("interactiveAbilities",n.interactiveAbilities)("interactiveActions",n.interactiveActions)("index",n.actionIndex)("character",n.character)("cardId",n.cardId)("monsterType",n.monsterType)("character",n.character)("cardId",n.cardId),t.R7$(),t.vxM(n.subActions.length>0?2:-1)}}function _l(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-action",51),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(4);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(4);t.Aen(i.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",i.monster)("objective",i.objective)("inline",i.inline)("right",i.right)("textBlack",i.textBlack)("hexSize",i.hexSize)("interactiveAbilities",i.interactiveAbilities)("interactiveActions",i.interactiveActions)("relative",i.relative||i.forceRelative)("statsCalculation",i.statsCalculation)("index",(i.actionIndex?i.actionIndex+"-":"")+i.getOrigIndex(n))("monsterType",i.monsterType)("character",i.character)("cardId",i.cardId)}}function ml(a,r){if(1&a&&(t.Z7z(0,_l,1,18,"ghs-action",50,Gt),t.nI1(2,"trackUUID")),2&a){const n=t.XpG(3);t.Dyx(t.bMT(2,0,n.subActions))}}function pl(a,r){if(1&a&&(t.j41(0,"span",13),t.nrm(1,"span",59),t.nVh(2,ml,3,2),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Aen(n.style),t.Y8G("ghs-label",n.action.value+"")("relative",n.relative||n.forceRelative)("ngClass",t.l_i(6,rn,n.action.small,!n.textBlack&&!n.right)),t.R7$(),t.vxM(n.subActions.length>0?2:-1)}}function ul(a,r){if(1&a&&t.nrm(0,"span",70),2&a){const n=t.XpG(6);t.Aen(n.style),t.Y8G("ghs-label",n.values[0])("relative",n.relative||n.forceRelative)}}function fl(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function Cl(a,r){if(1&a&&(t.j41(0,"span"),t.nVh(1,ul,1,4,"span",69),t.nVh(2,fl,2,0,"span"),t.k0s()),2&a){const n=t.XpG(5);t.R7$(),t.vxM(n.fhStyle?-1:1),t.R7$(),t.vxM(n.fhStyle?2:-1)}}function Ml(a,r){if(1&a&&(t.j41(0,"span",68),t.nVh(1,Cl,3,2,"span"),t.k0s()),2&a){const n=t.XpG(4);t.R7$(),t.vxM(n.values.length>0?1:-1)}}function vl(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-action",51),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(3);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s(),t.nVh(1,Ml,2,1,"span",68)}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.Aen(e.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",e.monster)("objective",e.objective)("inline",e.inline)("right",e.right)("textBlack",e.textBlack)("hexSize",e.hexSize)("interactiveAbilities",e.interactiveAbilities)("interactiveActions",e.interactiveActions)("relative",e.relative||e.forceRelative)("statsCalculation",e.statsCalculation)("index",(e.actionIndex?e.actionIndex+"-":"")+e.getOrigIndex(n))("monsterType",e.monsterType)("character",e.character)("cardId",e.cardId),t.R7$(),t.vxM(!e.inline&&(e.values.length>1&&+e.values[1]>0&&i<+e.values[1]-1||e.values.length<2&&i<e.subActions.length-1)&&n.type!=e.ActionType.concatenationSpacer?1:-1)}}function Ol(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function Pl(a,r){if(1&a){const n=t.RV6();t.nVh(0,Ol,2,0,"span"),t.j41(1,"ghs-action",51),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(4);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(4);t.vxM(e.fhStyle&&i>0?0:-1),t.R7$(),t.Aen(e.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",e.monster)("objective",e.objective)("inline",e.inline)("right",e.right)("textBlack",e.textBlack)("hexSize",e.hexSize)("interactiveAbilities",e.interactiveAbilities)("interactiveActions",e.interactiveActions)("relative",e.relative||e.forceRelative)("statsCalculation",e.statsCalculation)("index",(e.actionIndex?e.actionIndex+"-":"")+e.getOrigIndex(n))("monsterType",e.monsterType)("character",e.character)("cardId",e.cardId)}}function bl(a,r){if(1&a&&(t.j41(0,"div",32),t.Z7z(1,Pl,2,19,null,null,Gt),t.nI1(3,"slice"),t.nI1(4,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(4,4,t.brH(3,0,n.subActions,+n.values[1]+(n.hasAOE?1:0),n.subActions.length)))}}function kl(a,r){if(1&a&&(t.j41(0,"span",14)(1,"span",67),t.Z7z(2,vl,2,19,null,null,Gt),t.nI1(4,"slice"),t.nI1(5,"trackUUID"),t.k0s(),t.nVh(6,bl,5,6,"div",32),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.l_i(8,Zn,n.action.small,n.cardConcat)),t.R7$(),t.Dyx(t.bMT(5,6,t.brH(4,2,n.subActions,0,n.values.length>1?+n.values[1]:n.subActions.length))),t.R7$(4),t.vxM(n.values.length>1&&n.subActions.length>+n.values[1]?6:-1)}}function yl(a,r){if(1&a&&(t.j41(0,"span",72),t.EFF(1," \xa0 "),t.k0s()),2&a){const n=t.XpG(3);t.Y8G("ngClass",t.eq3(1,Yt,n.action.small))}}function xl(a,r){if(1&a&&(t.j41(0,"span",14)(1,"span",71),t.Z7z(2,yl,2,3,"span",72,t.fX1),t.nI1(4,"ghsRange"),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(2),t.Dyx(t.i5U(4,0,t.lJ4(3,Zt),n.EntityValueFunction(n.action.value)||1))}}function El(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-action",51),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(4);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(4);t.Aen(i.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",i.monster)("objective",i.objective)("inline",i.inline)("right",i.right)("textBlack",i.textBlack)("hexSize",i.hexSize)("interactiveAbilities",i.interactiveAbilities)("interactiveActions",i.interactiveActions)("relative",i.relative||i.forceRelative)("statsCalculation",i.statsCalculation)("index",(i.actionIndex?i.actionIndex+"-":"")+i.getOrigIndex(n))("monsterType",i.monsterType)("character",i.character)("cardId",i.cardId)}}function wl(a,r){if(1&a&&(t.j41(0,"span",74),t.Z7z(1,El,1,18,"ghs-action",50,Gt),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.xc7("--ghs-grid-columns",n.action.value||2),t.Y8G("ngClass",t.eq3(5,Yt,n.action.small)),t.R7$(),t.Dyx(t.bMT(3,3,n.subActions))}}function Rl(a,r){if(1&a&&(t.j41(0,"span",14),t.nVh(1,wl,4,7,"span",73),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.vxM(n.subActions.length>0?1:-1)}}function jl(a,r){if(1&a&&t.nrm(0,"span",77),2&a){const n=t.XpG(3);t.Aen(n.style),t.Y8G("ghs-label",""+n.action.value)("relative",n.relative||n.forceRelative)}}function Gl(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-action",51),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(3);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(3);t.Aen(i.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",i.monster)("objective",i.objective)("inline",i.inline)("right",i.right)("textBlack",i.textBlack)("hexSize",i.hexSize)("interactiveAbilities",i.interactiveAbilities)("interactiveActions",i.interactiveActions)("relative",i.relative||i.forceRelative)("statsCalculation",i.statsCalculation)("index",(i.actionIndex?i.actionIndex+"-":"")+i.getOrigIndex(n))("monsterType",i.monsterType)("character",i.character)("cardId",i.cardId)}}function Tl(a,r){if(1&a&&(t.j41(0,"span",15),t.nVh(1,jl,1,4,"span",75),t.j41(2,"span",76),t.Z7z(3,Gl,1,18,"ghs-action",50,Gt),t.nI1(5,"trackUUID"),t.k0s()()),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.sMw(4,jt,n.action.small,0==n.subActions.length,"0"==n.actionIndex)),t.R7$(),t.vxM(n.action.value?1:-1),t.R7$(2),t.Dyx(t.bMT(5,2,n.subActions))}}function Sl(a,r){if(1&a&&t.nrm(0,"span",77),2&a){const n=t.XpG(3);t.Aen(n.style),t.Y8G("ghs-label",""+n.action.value)("relative",n.relative||n.forceRelative)}}function Dl(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-action",51),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(3);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(3);t.Aen(i.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",i.monster)("objective",i.objective)("inline",i.inline)("right",i.right)("textBlack",i.textBlack)("hexSize",i.hexSize)("interactiveAbilities",i.interactiveAbilities)("interactiveActions",i.interactiveActions)("relative",i.relative||i.forceRelative)("statsCalculation",i.statsCalculation)("index",(i.actionIndex?i.actionIndex+"-":"")+i.getOrigIndex(n))("monsterType",i.monsterType)("character",i.character)("cardId",i.cardId)}}function $l(a,r){if(1&a&&(t.j41(0,"span",16),t.nVh(1,Sl,1,4,"span",75),t.j41(2,"span",76),t.Z7z(3,Dl,1,18,"ghs-action",50,Gt),t.nI1(5,"trackUUID"),t.k0s()()),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(4,Yt,n.action.small)),t.R7$(),t.vxM(n.action.value?1:-1),t.R7$(2),t.Dyx(t.bMT(5,2,n.subActions))}}function Il(a,r){if(1&a&&t.nrm(0,"span",77),2&a){const n=t.XpG(3);t.Aen(n.style),t.Y8G("ghs-label",""+n.action.value)("relative",n.relative||n.forceRelative)}}function Al(a,r){1&a&&(t.j41(0,"span",78)(1,"span",30),t.EFF(2,"!"),t.k0s()())}function Vl(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-action",51),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(3);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(3);t.Aen(i.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",i.monster)("objective",i.objective)("inline",i.inline)("right",i.right)("textBlack",i.textBlack)("hexSize",i.hexSize)("interactiveAbilities",i.interactiveAbilities)("interactiveActions",i.interactiveActions)("relative",i.relative||i.forceRelative)("statsCalculation",i.statsCalculation)("index",(i.actionIndex?i.actionIndex+"-":"")+i.getOrigIndex(n))("monsterType",i.monsterType)("character",i.character)("cardId",i.cardId)}}function Fl(a,r){if(1&a&&(t.j41(0,"span",17),t.nVh(1,Il,1,4,"span",75),t.nVh(2,Al,3,0,"span",78),t.j41(3,"span",76),t.Z7z(4,Vl,1,18,"ghs-action",50,Gt),t.nI1(6,"trackUUID"),t.k0s()()),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(5,Yt,n.action.small)),t.R7$(),t.vxM(n.action.value?1:-1),t.R7$(),t.vxM(n.action.value?-1:2),t.R7$(2),t.Dyx(t.bMT(6,3,n.subActions))}}function Xl(a,r){if(1&a&&t.nrm(0,"img",81),2&a){const n=t.XpG(3);t.Y8G("src","./assets/images/action/card/overlay/"+n.values[0]+".svg",t.B4B)}}function Bl(a,r){if(1&a&&t.nrm(0,"span",83),2&a){const n=t.XpG(3);t.xc7("mask-image","url('/assets/images/action/card/overlay/"+n.values[0]+".svg')")("-webkit-mask-image","url('/assets/images/action/card/overlay/"+n.values[0]+".svg')")}}function Yl(a,r){if(1&a&&(t.j41(0,"span",30),t.EFF(1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.JRh(n.values[1])}}function Ul(a,r){if(1&a&&(t.j41(0,"span",18)(1,"div",79),t.nrm(2,"img",80),t.nVh(3,Xl,1,1,"img",81),t.nVh(4,Bl,1,4,"span",82),t.nVh(5,Yl,2,1,"span",30),t.k0s()()),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(6,Yt,n.action.small)),t.R7$(),t.Y8G("ngClass",n.values[0]),t.R7$(),t.Y8G("src","./assets/images/action/card/"+n.values[0]+".svg",t.B4B),t.R7$(),t.vxM("slot"!=n.values[0]&&"slotStart"!=n.values[0]&&"slotStartXp"!=n.values[0]&&"slotXp"!=n.values[0]&&"slotXpFh"!=n.values[0]&&"slotEndXp"!=n.values[0]?3:-1),t.R7$(),t.vxM("slot"==n.values[0]||"slotStart"==n.values[0]||"slotStartXp"==n.values[0]||"slotXp"==n.values[0]||"slotXpFh"==n.values[0]||"slotEndXp"==n.values[0]?4:-1),t.R7$(),t.vxM(n.values.length>1?5:-1)}}function Nl(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",19)(1,"span",84),t.nrm(2,"span",45),t.EFF(3),t.k0s(),t.j41(4,"ghs-actions",85),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(21,Yt,n.action.small)),t.R7$(2),t.Aen(n.style),t.Y8G("ghs-label","game.action."+n.action.type),t.R7$(),t.SpI(" ",n.action.value,":"),t.R7$(),t.Aen(n.style),t.Y8G("actions",n.specialActions)("monster",n.monster)("objective",n.objective)("inline",n.inline)("right",n.right)("textBlack",n.textBlack)("hexSize",n.hexSize)("interactiveAbilities",n.interactiveAbilities)("interactiveActions",n.interactiveActions)("relative",n.relative||n.forceRelative)("statsCalculation",n.statsCalculation)("index",n.actionIndex)("character",n.character)("cardId",n.cardId)}}function zl(a,r){if(1&a&&t.nrm(0,"img",89),2&a){const n=t.XpG(4);t.Y8G("src","./assets/images"+(n.fhStyle?"/fh":"")+"/action/"+n.action.type+".svg",t.B4B)("ngClass",t.eq3(2,On,n.isGhsSvg(n.action.type)))}}function Ll(a,r){if(1&a&&t.nrm(0,"img",89),2&a){const n=t.XpG(4);t.Y8G("src","./assets/images"+(n.fhStyle?"/fh":"")+"/action/fly.svg",t.B4B)("ngClass",t.eq3(2,On,n.isGhsSvg(n.action.type)))}}function ql(a,r){if(1&a&&t.nrm(0,"span",90),2&a){const n=t.XpG(5);t.Y8G("value-calc",n.normalValue)("level",n.level)}}function Hl(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"/"),t.k0s())}function Kl(a,r){if(1&a&&t.nrm(0,"span",91),2&a){const n=t.XpG(5);t.Y8G("ngClass",t.eq3(3,$n,n.hasEntities(n.MonsterType.normal)))("value-calc",n.eliteValue)("level",n.level)}}function Wl(a,r){if(1&a&&(t.j41(0,"span"),t.nVh(1,ql,1,2,"span",90),t.nVh(2,Hl,2,0,"span"),t.nVh(3,Kl,1,5,"span",91),t.k0s()),2&a){const n=t.XpG(4);t.R7$(),t.vxM(n.hasEntities(n.MonsterType.normal)||!n.monster?1:-1),t.R7$(),t.vxM(n.hasEntities(n.MonsterType.normal)&&n.hasEntities(n.MonsterType.elite)&&n.normalValue!=n.eliteValue?2:-1),t.R7$(),t.vxM(!n.hasEntities(n.MonsterType.elite)||n.normalValue==n.eliteValue&&n.hasEntities(n.MonsterType.normal)?-1:3)}}function Zl(a,r){if(1&a&&t.nrm(0,"span",70),2&a){const n=t.XpG(5);t.Aen(n.style),t.Y8G("ghs-label",n.normalValue+"")("relative",n.relative||n.forceRelative)}}function Jl(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"/"),t.k0s())}function Ql(a,r){if(1&a&&t.nrm(0,"span",93),2&a){const n=t.XpG(5);t.Aen(n.style),t.Y8G("ngClass",t.eq3(5,$n,n.hasEntities(n.MonsterType.normal)))("ghs-label",n.eliteValue+"")("relative",n.relative||n.forceRelative)}}function tg(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"\xa0"),t.k0s())}function ng(a,r){if(1&a&&(t.j41(0,"span"),t.nVh(1,Zl,1,4,"span",69),t.nVh(2,Jl,2,0,"span"),t.nVh(3,Ql,1,7,"span",92),t.nVh(4,tg,2,0,"span"),t.k0s()),2&a){const n=t.XpG(4);t.R7$(),t.vxM(n.hasEntities(n.MonsterType.normal)||!n.monster||n.forceRelative?1:-1),t.R7$(),t.vxM(n.hasEntities(n.MonsterType.normal)&&n.hasEntities(n.MonsterType.elite)&&n.normalValue!=n.eliteValue?2:-1),t.R7$(),t.vxM(!n.hasEntities(n.MonsterType.elite)||n.normalValue==n.eliteValue&&n.hasEntities(n.MonsterType.normal)?-1:3),t.R7$(),t.vxM(n.fhStyle?-1:4)}}function eg(a,r){if(1&a&&(t.j41(0,"span",87),t.nrm(1,"span",45),t.k0s(),t.j41(2,"span",88),t.nVh(3,zl,1,4,"img",89),t.nVh(4,Ll,1,4,"img",89),t.k0s(),t.j41(5,"span",30),t.nVh(6,Wl,4,3,"span"),t.nVh(7,ng,5,4,"span"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Aen(n.style),t.Y8G("ghs-label","game.action."+n.action.type),t.R7$(2),t.vxM(n.action.type==n.ActionType.move&&n.flying?-1:3),t.R7$(),t.vxM(n.action.type==n.ActionType.move&&n.flying?4:-1),t.R7$(2),t.vxM(n.relative||n.forceRelative?-1:6),t.R7$(),t.vxM(n.relative||n.forceRelative?7:-1)}}function ag(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"/"),t.k0s())}function ig(a,r){if(1&a&&t.nrm(0,"span",94),2&a){const n=t.XpG(5);t.Y8G("value-calc",n.eliteValue)("level",n.level)}}function og(a,r){if(1&a&&(t.j41(0,"span"),t.nrm(1,"span",90),t.nVh(2,ag,2,0,"span"),t.nVh(3,ig,1,2,"span",94),t.k0s()),2&a){const n=t.XpG(4);t.R7$(),t.Y8G("value-calc",n.normalValue)("level",n.level),t.R7$(),t.vxM(n.eliteValue&&n.normalValue!=n.eliteValue?2:-1),t.R7$(),t.vxM(n.eliteValue&&n.normalValue!=n.eliteValue?3:-1)}}function sg(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1,"/"),t.nrm(2,"span",95),t.k0s()),2&a){const n=t.XpG(5);t.R7$(2),t.Aen(n.style),t.Y8G("ghs-label",n.eliteValue+"")("relative",n.relative||n.forceRelative)}}function rg(a,r){if(1&a&&(t.j41(0,"span",70),t.nVh(1,sg,3,4,"span"),t.k0s()),2&a){const n=t.XpG(4);t.Aen(n.style),t.Y8G("ghs-label",n.normalValue+"")("relative",n.relative||n.forceRelative),t.R7$(),t.vxM(n.normalValue!=n.eliteValue?1:-1)}}function cg(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"\xa0"),t.k0s())}function lg(a,r){if(1&a&&(t.j41(0,"span",87),t.nrm(1,"span",45),t.k0s()),2&a){const n=t.XpG(4);t.R7$(),t.Aen(n.style),t.Y8G("ghs-label","game.action.targets")}}function gg(a,r){if(1&a&&(t.j41(0,"span",87),t.nrm(1,"span",45),t.k0s()),2&a){const n=t.XpG(4);t.R7$(),t.Aen(n.style),t.Y8G("ghs-label","game.action."+n.action.type)}}function dg(a,r){if(1&a&&t.nrm(0,"img",89),2&a){const n=t.XpG(4);t.Y8G("src","./assets/images"+(n.fhStyle?"/fh":"")+"/action/"+n.action.type+".svg",t.B4B)("ngClass",t.eq3(2,On,n.isGhsSvg(n.action.type)))}}function hg(a,r){if(1&a&&t.nrm(0,"img",89),2&a){const n=t.XpG(4);t.Y8G("src","./assets/images"+(n.fhStyle?"/fh":"")+"/action/fly.svg",t.B4B)("ngClass",t.eq3(2,On,n.isGhsSvg(n.action.type)))}}function _g(a,r){if(1&a&&(t.j41(0,"span",30),t.EFF(1),t.nVh(2,og,4,4,"span"),t.nVh(3,rg,2,5,"span",69),t.nVh(4,cg,2,0,"span"),t.k0s(),t.nVh(5,lg,2,3,"span",87),t.nVh(6,gg,2,3,"span",87),t.nVh(7,dg,1,4,"img",89),t.nVh(8,hg,1,4,"img",89)),2&a){const n=t.XpG(3);t.R7$(),t.SpI(" ",n.action.valueType==n.ActionValueType.add?"+":"-"," "),t.R7$(),t.vxM(n.relative||n.forceRelative?-1:2),t.R7$(),t.vxM(n.relative||n.forceRelative?3:-1),t.R7$(),t.vxM(n.fhStyle?-1:4),t.R7$(),t.vxM(n.action.type==n.ActionType.target&&n.EntityValueFunction(n.action.value)>1?5:-1),t.R7$(),t.vxM(n.action.type!=n.ActionType.target||n.EntityValueFunction(n.action.value)<2?6:-1),t.R7$(),t.vxM(n.action.type==n.ActionType.move&&n.flying?-1:7),t.R7$(),t.vxM(n.action.type==n.ActionType.move&&n.flying?8:-1)}}function mg(a,r){if(1&a&&t.nrm(0,"ghs-action-enhancements",31),2&a){const n=t.XpG(3);t.Y8G("action",n.origAction)("index",n.actionIndex)("character",n.character)("cardId",n.cardId)}}function pg(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function ug(a,r){if(1&a){const n=t.RV6();t.nVh(0,pg,2,0,"span"),t.j41(1,"ghs-action",51),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(4);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(4);t.vxM(e.fhStyle&&i>0?0:-1),t.R7$(),t.Aen(e.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",e.monster)("objective",e.objective)("inline",e.inline)("right",e.right)("textBlack",e.textBlack)("hexSize",e.hexSize)("interactiveAbilities",e.interactiveAbilities)("interactiveActions",e.interactiveActions)("relative",e.relative||e.forceRelative)("statsCalculation",e.statsCalculation)("index",(e.actionIndex?e.actionIndex+"-":"")+e.getOrigIndex(n))("monsterType",e.monsterType)("character",e.character)("cardId",e.cardId)}}function fg(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-action",51),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(5);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(5);t.Aen(i.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",i.monster)("objective",i.objective)("inline",i.inline)("right",i.right)("textBlack",i.textBlack)("hexSize",i.hexSize)("interactiveAbilities",i.interactiveAbilities)("interactiveActions",i.interactiveActions)("relative",i.relative||i.forceRelative)("statsCalculation",i.statsCalculation)("index",(i.actionIndex?i.actionIndex+"-":"")+i.getOrigIndex(n))("monsterType",i.monsterType)("character",i.character)("cardId",i.cardId)}}function Cg(a,r){if(1&a&&(t.j41(0,"div",96),t.Z7z(1,fg,1,18,"ghs-action",50,Gt),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(4);t.R7$(),t.Dyx(t.bMT(3,0,n.fhExtraActions))}}function Mg(a,r){if(1&a&&(t.j41(0,"div",32),t.Z7z(1,ug,2,19,null,null,Gt),t.nI1(3,"slice"),t.nI1(4,"trackUUID"),t.k0s(),t.nVh(5,Cg,4,2,"div",96)),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(4,4,t.i5U(3,1,n.statsCalculation&&n.additionalSubActions.length>0?n.additionalSubActions:n.subActions,n.hasAOE?1:0))),t.R7$(4),t.vxM(n.fhExtraActions.length>0&&n.fhStyle?5:-1)}}function vg(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",20)(1,"span",86),t.bIt("singleClick",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.toggleHighlight(e))}),t.nVh(2,eg,8,7),t.nVh(3,_g,9,8),t.nVh(4,mg,1,4,"ghs-action-enhancements",31),t.k0s(),t.nVh(5,Mg,6,6),t.nI1(6,"slice"),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass","action-"+n.action.type),t.R7$(),t.Y8G("ngClass",t.sMw(13,pt,n.action.small,n.isInteractiveApplicableAction,n.highlightAction()))("clickBehind",!n.isInteractiveApplicableAction)("ghs-tooltip","monster.toggleAction")("delay",1)("disabled",!n.isInteractiveApplicableAction),t.R7$(),t.vxM(n.action.valueType!=n.ActionValueType.add&&n.action.valueType!=n.ActionValueType.subtract?2:-1),t.R7$(),t.vxM(n.action.valueType==n.ActionValueType.add||n.action.valueType==n.ActionValueType.subtract?3:-1),t.R7$(),t.vxM(n.origAction.enhancementTypes&&n.origAction.enhancementTypes.length&&n.character&&n.cardId?4:-1),t.R7$(),t.vxM(t.i5U(6,10,n.statsCalculation&&n.additionalSubActions.length>0?n.additionalSubActions:n.subActions,n.hasAOE?1:0).length>0?5:-1)}}function Og(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",21)(1,"ghs-action",51),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(19,Yt,n.action.small)),t.R7$(),t.Aen(n.style),t.Y8G("ngClass","subaction-area")("action",(n.statsCalculation&&n.additionalSubActions.length>0?n.additionalSubActions:n.subActions)[0])("monster",n.monster)("objective",n.objective)("inline",n.inline)("right",n.right)("textBlack",n.textBlack)("hexSize",n.hexSize)("interactiveAbilities",n.interactiveAbilities)("interactiveActions",n.interactiveActions)("relative",n.relative||n.forceRelative)("statsCalculation",n.statsCalculation)("index",(n.actionIndex?n.actionIndex+"-":"")+n.getOrigIndex((n.statsCalculation&&n.additionalSubActions.length>0?n.additionalSubActions:n.subActions)[0]))("monsterType",n.monsterType)("character",n.character)("cardId",n.cardId)}}function Pg(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-action",51),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(3);return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(3);t.Aen(i.style),t.Y8G("ngClass","subaction-"+n.type)("action",n)("monster",i.monster)("objective",i.objective)("inline",i.inline)("right",i.right)("textBlack",i.textBlack)("hexSize",i.hexSize)("interactiveAbilities",i.interactiveAbilities)("interactiveActions",i.interactiveActions)("relative",i.relative||i.forceRelative)("statsCalculation",i.statsCalculation)("index",(i.actionIndex?i.actionIndex+"-":"")+i.getOrigIndex(n))("monsterType",i.monsterType)("character",i.character)("cardId",i.cardId)}}function bg(a,r){if(1&a&&(t.j41(0,"div",22),t.Z7z(1,Pg,1,18,"ghs-action",50,Gt),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Dyx(t.bMT(3,0,n.elementActions))}}function kg(a,r){if(1&a&&(t.j41(0,"span",1),t.nVh(1,Qn,2,9,"span",2)(2,En,10,23,"span",3)(3,Be,6,14,"span",4)(4,_a,3,6,"span",4)(5,hi,1,1)(6,l,1,1)(7,U,9,16,"span",5)(8,It,4,3,"span",6)(9,me,3,17,"span",7)(10,qc,2,3,"span",8)(11,Wc,3,21,"span",7)(12,Qc,3,9,"span",6)(13,el,2,1,"span",9)(14,al,1,1,"span",10)(15,sl,3,9,"span",11)(16,ll,3,19,"span",12)(17,hl,3,20,"span",12)(18,pl,3,9,"span",13)(19,kl,7,11,"span",14)(20,xl,5,4,"span",14)(21,Rl,2,1,"span",14)(22,Tl,6,8,"span",15)(23,$l,6,6,"span",16)(24,Fl,7,7,"span",17)(25,Ul,6,8,"span",18)(26,Nl,5,23,"span",19)(27,vg,7,17,"span",20),t.nVh(28,Og,2,21,"div",21),t.nVh(29,bg,4,2,"div",22),t.k0s()),2&a){let n;const i=t.XpG();t.Y8G("ngClass",t.l4e(4,_n,i.highlight,i.inline,i.right,i.textBlack||i.right,i.fhStyle,i.hasAOE)),t.R7$(),t.vxM((n=i.action.type)===i.ActionType.area?1:n===i.ActionType.condition?2:n===i.ActionType.element?3:n===i.ActionType.elementHalf?4:n===i.ActionType.monsterType?5:n===i.ActionType.round?6:n===i.ActionType.specialTarget?7:n===i.ActionType.custom?8:n===i.ActionType.nonCalc?9:n===i.ActionType.fontSize?10:n===i.ActionType.sufferDamage?11:n===i.ActionType.switchType?12:n===i.ActionType.extra?13:n===i.ActionType.hint?14:n===i.ActionType.grant?15:n===i.ActionType.summon?16:n===i.ActionType.spawn?17:n===i.ActionType.trigger?18:n===i.ActionType.concatenation?19:n===i.ActionType.concatenationSpacer?20:n===i.ActionType.grid?21:n===i.ActionType.box?22:n===i.ActionType.boxFhSubActions?23:n===i.ActionType.forceBox?24:n===i.ActionType.card?25:n===i.ActionType.special?26:27),t.R7$(27),t.vxM(i.hasAOE?28:-1),t.R7$(),t.vxM(i.elementActions.length>0&&i.fhStyle?29:-1)}}const mi=[$.X2.attack,$.X2.damage,$.X2.fly,$.X2.heal,$.X2.jump,$.X2.loot,$.X2.move,$.X2.range,$.X2.retaliate,$.X2.shield,$.X2.target,$.X2.teleport],Io=[$.X2.concatenation,$.X2.concatenationSpacer,$.X2.box,$.X2.boxFhSubActions,$.X2.card,$.X2.forceBox,$.X2.grid,$.X2.nonCalc];let en=(()=>{class a{ghsManager;monster;monsterType;objective;origAction;relative=!1;inline=!1;textBlack=!1;right=!1;highlight=!1;interactiveAbilities=!1;interactiveActions=[];interactiveActionsChange=new t.bkB;statsCalculation=!1;hexSize;actionIndex="";style=!1;character;cardId;enhancementContainer;action;normalValue="";eliteValue="";values=[];specialActions=[];subActions=[];fhStyle=!1;flying=!1;isInteractiveApplicableAction=!1;settingsManager=p.f;EntityValueFunction=A.hZ;additionalSubActions=[];elementActions=[];fhExtraActions=[];ActionType=$.X2;ActionValueType=$.iQ;MonsterType=S.N;hasAOE=!1;cardConcat=!1;forceRelative=!1;level=0;round="";constructor(n){this.ghsManager=n}ngOnInit(){this.update(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}ngAfterViewInit(){this.enhancmenetElementReplace()}update(){if(this.fhStyle=p.f.settings.fhStyle&&!this.style||"fh"==this.style,this.action=this.origAction?JSON.parse(JSON.stringify(this.origAction)):void 0,this.action&&!this.action.subActions&&(this.action.subActions=[]),!p.f.settings.calculate&&this.action&&this.action.subActions){const n=this.action.subActions.find(i=>i.type==$.X2.nonCalc);n&&(this.action=n)}this.action&&void 0===this.action.value&&(this.action.value=""),this.action&&this.action.type==$.X2.monsterType&&(this.monsterType=this.action.value),this.updateSubActions(),this.applyChallenges(),this.forceRelative=!this.monster||!this.hasEntities(),this.monster&&!this.relative&&!this.forceRelative&&p.f.settings.calculate&&this.action&&(this.action.type==$.X2.shield||this.action.type==$.X2.retaliate)&&this.action.valueType!=$.iQ.minus&&this.action.subActions&&this.action.subActions.find(n=>n.type==$.X2.specialTarget&&!(n.value+"").startsWith("self"))&&(this.forceRelative=!0,this.action.valueType=$.iQ.plus),this.level=this.monster?this.monster.level:s.E.game.level,this.flying=!1,this.monster&&(this.flying=this.monster.flying&&(!this.monster.statEffect||"disabled"!=this.monster.statEffect.flying)||null!=this.monster.statEffect&&1==this.monster.statEffect.flying),this.action&&(this.normalValue=this.getNormalValue(),this.eliteValue=this.getEliteValue(),this.values=this.getValues(this.action,!0),this.specialActions=this.getSpecial(this.action)),this.isInteractiveApplicableAction=this.interactiveAbilities&&this.monster&&this.monster.entities.some(n=>this.origAction&&s.E.actionsManager.isInteractiveApplicableAction(n,this.origAction,this.actionIndex))||this.objective&&this.objective.entities.some(n=>this.origAction&&s.E.actionsManager.isInteractiveApplicableAction(n,this.origAction,this.actionIndex))||!1,this.enhancementContainer&&this.enhancmenetElementReplace(),this.round=s.E.game.round%2==0?"even":"odd"}hasEntities(n=void 0){return n==S.N.normal&&this.monster&&this.monster.boss?this.hasEntities(S.N.boss):this.monster&&(!this.monsterType||!n||this.monsterType==n)&&this.monster.entities.some(i=>(!n||i.type==n)&&s.E.entityManager.isAlive(i))||!1}getNormalValue(){return this.getValue(this.monster&&this.monster.boss?S.N.boss:S.N.normal)}getEliteValue(){return this.hasEntities(S.N.elite)?this.getValue(S.N.elite):this.getNormalValue()}getMonsterType(n){return n}getStat(n){return this.monster?s.E.monsterManager.getStat(this.monster,n):new Kt.f(n,s.E.game.level)}getRange(n=S.N.normal){return this.monster&&this.monster.boss&&(n=S.N.boss),Wt(this.getStat(n).range,this.monster?this.monster.level:void 0)}getEliteRange(){return this.monster&&!this.monster.entities.some(n=>n.type==S.N.elite&&s.E.entityManager.isAlive(n))?this.getRange():this.getRange(S.N.elite)}getValues(n,i=!1){return i?s.E.actionsManager.getValues(n):[...this.values]}getSpecial(n){if(this.monster&&this.monster.boss)return this.getStat(S.N.boss).special[n.value-1];{const i=this.getStat(S.N.normal).special[n.value-1],e=this.getStat(S.N.elite).special[n.value-1];return i!=e&&JSON.stringify(i)!=JSON.stringify(e)?[new $.rc($.X2.monsterType,S.N.normal,$.iQ.fixed,i),new $.rc($.X2.monsterType,S.N.elite,$.iQ.fixed,e)]:i}}getValue(n){if(!this.action)return"";if(Io.includes(this.action.type))return this.action.value;if(p.f.settings.calculate&&!this.relative&&!this.forceRelative){const i=this.getStat(n);let e=0,o=!0;switch(this.action.type){case $.X2.attack:if("number"==typeof i.attack)e=i.attack;else if(i.attack.includes("X")){if(this.action.valueType==$.iQ.plus)return i.attack+" +"+(p.f.settings.fhStyle?"":" ")+this.action.value;if(this.action.valueType==$.iQ.minus)return i.attack+" -"+(p.f.settings.fhStyle?"":" ")+this.action.value;o=!1}else try{e=(0,A.hZ)(i.attack,this.level)}catch{o=!1}i.actions&&i.actions.forEach(g=>{g.type==$.X2.attack&&(g.valueType==$.iQ.add?e+=(0,A.hZ)(g.value,this.level):g.valueType==$.iQ.subtract&&(e-=(0,A.hZ)(g.value,this.level),e<0&&(e=0)))});break;case $.X2.move:e=(0,A.hZ)(i.movement,this.level);break;case $.X2.range:e=(0,A.hZ)(i.range,this.level)}if(o&&(this.action.value||0==this.action.value)&&("number"==typeof this.action.value||this.action.value.match(A.p5)||this.action.value.match(A.OD))){if(this.action.valueType==$.iQ.plus)return e+(0,A.hZ)(this.action.value);if(this.action.valueType==$.iQ.minus)return e?e-(0,A.hZ)(this.action.value):"-"}}if(p.f.settings.calculateStats&&p.f.settings.calculateShieldStats&&!this.relative&&!this.forceRelative){const i=this.getStat(n);let e=0;if(this.action.type==$.X2.shield||this.action.type==$.X2.retaliate){if(!this.action.subActions||!this.action.subActions.find(o=>o.type==$.X2.specialTarget&&!(o.value+"").startsWith("self"))){const o=this.action.subActions&&this.action.subActions.find(m=>m.type==$.X2.range);(i.actions&&i.actions.filter(m=>this.action&&m.type==this.action.type)||[]).forEach(m=>{if(this.action&&m!=this.action){const k=m.subActions&&m.subActions.find(X=>X.type==$.X2.range);(!o&&!k||o&&k&&(0,A.hZ)(o.value,this.level)==(0,A.hZ)(k.value,this.level))&&(e=(0,A.hZ)(m.value,this.level))}})}if(e>0)return e+(0,A.hZ)(this.action.value,this.level)}}return this.action.valueType==$.iQ.plus?"+"+(p.f.settings.fhStyle?"":" ")+this.action.value:this.action.valueType==$.iQ.minus?"-"+(p.f.settings.fhStyle?"":" ")+this.action.value:p.f.settings.calculate&&((""+this.action.value).match(A.p5)||(""+this.action.value).match(A.OD))?(0,A.hZ)(this.action.value,this.level):this.action.value}getConditionName(n){return new Q.kW(n).name}updateSubActions(){if(this.action){if(this.elementActions=[],p.f.settings.fhStyle&&![$.X2.element,$.X2.elementHalf,...Io].includes(this.action.type)&&(this.action.subActions.forEach(n=>{(n.type==$.X2.element||n.type==$.X2.elementHalf)&&this.elementActions.push(n)}),this.action.subActions=this.action.subActions.filter(n=>n.type!=$.X2.element&&n.type!=$.X2.elementHalf)),this.fhExtraActions=[],p.f.settings.fhStyle&&[$.X2.boxFhSubActions,!$.X2.extra].includes(this.action.type)&&(this.action.subActions.forEach(n=>{n.type==$.X2.boxFhSubActions?this.fhExtraActions.push(n):n.type==$.X2.extra&&this.fhExtraActions.push(...n.subActions)}),this.action.subActions=this.action.subActions.filter(n=>n.type!=$.X2.boxFhSubActions&&n.type!=$.X2.extra)),this.action.subActions=this.action.subActions.filter(n=>n.type!=$.X2.nonCalc),this.additionalSubActions=JSON.parse(JSON.stringify(this.action.subActions)),this.hasAOE=this.additionalSubActions.some((n,i)=>0==i&&n.type==$.X2.area)&&(this.action.type!=$.X2.element||this.action.valueType!=$.iQ.minus),this.monster&&p.f.settings.calculateStats&&!this.relative){let n=[];const i=s.E.monsterManager.getStat(this.monster,this.monster.boss?S.N.boss:S.N.normal);let e=this.monster.boss?void 0:s.E.monsterManager.getStat(this.monster,S.N.elite);if(this.action.type==$.X2.attack&&this.action.valueType!=$.iQ.add&&this.action.valueType!=$.iQ.subtract){let m=this.additionalSubActions.find(X=>X.type==$.X2.monsterType&&X.value==S.N.normal),k=this.additionalSubActions.find(X=>X.type==$.X2.monsterType&&X.value==S.N.elite);if((i.range||e&&e.range)&&!this.action.subActions.some(X=>X.type==$.X2.range||X.type==$.X2.area&&(""+X.value).includes("active")||X.type==$.X2.specialTarget)){const X=new $.rc($.X2.range,0,$.iQ.plus);X.small=!0,i.range&&(e&&e.range||!e)?this.additionalSubActions.splice(this.hasAOE?1:0,0,X):i.range?m?m.subActions.unshift(X):(m=new $.rc($.X2.monsterType,S.N.normal,$.iQ.fixed,[X]),n.push(m)):e&&e.range&&(k?k.subActions.push(X):(k=new $.rc($.X2.monsterType,S.N.normal,$.iQ.fixed,[X]),n.push(k)))}i.actions&&this.monster.entities.some(X=>s.E.entityManager.isAlive(X)&&(X.type==S.N.normal||X.type==S.N.boss))&&i.actions.filter(X=>this.additionAttackSubAction(X)).forEach(X=>{const at=new $.rc(X.type,X.value,X.valueType,X.subActions);this.action&&!this.subActionExists(this.action.subActions,at)&&!this.subActionExists(n,at)&&(X.type!=$.X2.area||this.action.subActions.every(tt=>tt.type!=$.X2.area))&&(!e||e.actions&&this.subActionExists(e.actions,at,!1)||this.monster&&!this.monster.entities.some(tt=>s.E.entityManager.isAlive(tt)&&tt.type==S.N.elite)?(at.small=!0,n.unshift(at)):e&&(!e.actions||!this.subActionExists(e.actions,at))&&!this.subActionExists(this.action.subActions,at)&&!this.subActionExists(n,at)&&(m?this.subActionExists(m.subActions,at)||m.subActions.push(at):(m=new $.rc($.X2.monsterType,S.N.normal,$.iQ.fixed,[at]),n.push(m))))}),e&&e.actions&&this.monster.entities.some(X=>s.E.entityManager.isAlive(X)&&X.type==S.N.elite)&&e.actions.filter(X=>this.additionAttackSubAction(X)).forEach(X=>{const at=new $.rc(X.type,X.value,X.valueType,X.subActions);this.action&&(!i.actions||!this.subActionExists(i.actions,at,!1)||!this.hasEntities(S.N.normal))&&(this.monster&&!this.monster.entities.some(tt=>s.E.entityManager.isAlive(tt)&&tt.type==S.N.normal)?(at.small=!0,n.push(at)):!this.subActionExists(this.action.subActions,at)&&!this.subActionExists(n,at)&&(k?this.subActionExists(k.subActions,at)||k.subActions.push(at):(k=new $.rc($.X2.monsterType,S.N.elite,$.iQ.fixed,[at]),n.push(k))))})}n.forEach(m=>{if(this.action)if(m.type==$.X2.target)if(this.additionalSubActions.some(k=>k.type==$.X2.target||k.type==$.X2.specialTarget&&k.value!=$.lB.enemyOneAll)){if((m.valueType==$.iQ.add||m.valueType==$.iQ.fixed)&&this.additionalSubActions.some(k=>k.type==$.X2.target)&&!this.additionalSubActions.some(k=>k.type==$.X2.specialTarget)&&(""+m.value).match(A.OD)){const k=this.additionalSubActions.find(X=>X.type==$.X2.target&&X!=m);k&&(m.valueType=$.iQ.fixed,m.value=(0,A.hZ)(m.value,this.level)+(k.valueType!=$.iQ.subtract&&k.valueType!=$.iQ.minus?(0,A.hZ)(k.value,this.level):-(0,A.hZ)(k.value,this.level)),this.additionalSubActions.splice(this.additionalSubActions.indexOf(k),1,m))}}else m.valueType==$.iQ.add&&(m.valueType=$.iQ.fixed,m.value=(0,A.hZ)(m.value,this.level)+1),this.additionalSubActions.length>0&&(this.additionalSubActions[this.additionalSubActions.length-1].type==$.X2.element||this.additionalSubActions[this.additionalSubActions.length-1].type==$.X2.specialTarget&&this.additionalSubActions[this.additionalSubActions.length-1].value==$.lB.enemyOneAll)?this.additionalSubActions.splice(this.additionalSubActions.length-1,0,m):this.additionalSubActions.push(m);else if(m.type!=$.X2.range||this.additionalSubActions.some(k=>k.type==$.X2.range)){if(m.type!=$.X2.range&&!this.subActionExists(this.additionalSubActions,m))if(m.type==$.X2.area)this.additionalSubActions.splice(0,0,m),this.hasAOE=!0;else if(this.action&&m.type==$.X2.card&&this.action.subActions.find(k=>k.type==$.X2.pierce)){const k=this.action.subActions.find(X=>X.type==$.X2.pierce);k&&(k.value=(0,A.hZ)(k.value,this.level)+(0,A.hZ)(m.value,this.level))}else m.small=!0,m.type==$.X2.monsterType&&(m.small=!1,m.subActions.forEach(k=>k.small=!0)),this.additionalSubActions.length>0&&this.additionalSubActions[this.additionalSubActions.length-1].type==$.X2.element?this.additionalSubActions.splice(this.additionalSubActions.length-1,0,m):this.additionalSubActions.push(m)}else this.additionalSubActions.length>0&&this.action.subActions[this.additionalSubActions.length-1].type==$.X2.element?this.additionalSubActions.splice(this.action.subActions.length-1,0,m):this.additionalSubActions.push(m)});const o=this.additionalSubActions.find(m=>m.type==$.X2.target&&(m.valueType==$.iQ.add||m.valueType==$.iQ.subtract));if(o){let m=!1;n.forEach(k=>{if(this.action&&k.type==$.X2.monsterType&&k.subActions.find(X=>X.type==$.X2.target)){const X=k.subActions.find(at=>at.type==$.X2.target);X&&(m=!0,X.value=(0,A.hZ)(X.value,this.level)+(o.valueType==$.iQ.add?(0,A.hZ)(o.value,this.level):-(0,A.hZ)(o.value,this.level)))}}),m&&this.additionalSubActions.splice(this.additionalSubActions.indexOf(o),1)}if(this.action.type==$.X2.move&&!this.action.subActions.find(m=>m.type==$.X2.jump)){let m=new $.rc($.X2.jump,"");m.small=!0,i.actions.find(k=>k.type==$.X2.jump)?e&&!e.actions.find(k=>k.type==$.X2.jump)&&this.hasEntities(S.N.elite)?this.additionalSubActions.push(new $.rc($.X2.monsterType,S.N.normal,$.iQ.fixed,[m])):this.additionalSubActions.push(m):e&&e.actions.find(k=>k.type==$.X2.jump)&&(this.hasEntities(S.N.normal)?this.additionalSubActions.push(new $.rc($.X2.monsterType,S.N.elite,$.iQ.fixed,[m])):this.additionalSubActions.push(m))}let g=this.additionalSubActions.find(m=>(m.type==$.X2.element||m.type==$.X2.elementHalf)&&m.valueType==$.iQ.minus&&m.subActions.every(k=>this.subActionExists(n,k)));for(p.f.settings.fhStyle&&(g=this.elementActions.find(m=>(m.type==$.X2.element||m.type==$.X2.elementHalf)&&m.valueType==$.iQ.minus&&m.subActions.every(k=>this.subActionExists(n,k))));g;)p.f.settings.fhStyle?(this.elementActions.splice(this.elementActions.indexOf(g),1),g=this.elementActions.find(m=>(m.type==$.X2.element||m.type==$.X2.elementHalf)&&m.valueType==$.iQ.minus&&m.subActions.every(k=>this.subActionExists(n,k)))):(this.additionalSubActions.splice(this.additionalSubActions.indexOf(g),1),g=this.additionalSubActions.find(m=>(m.type==$.X2.element||m.type==$.X2.elementHalf)&&m.valueType==$.iQ.minus&&m.subActions.every(k=>this.subActionExists(n,k))));if(this.additionalSubActions.some((m,k,X)=>m.type==$.X2.monsterType&&k<X.length-1&&X[k+1].type==$.X2.monsterType)){const m=this.additionalSubActions.findIndex(k=>k.type==$.X2.monsterType);this.additionalSubActions.splice(m,2,new $.rc($.X2.grid,"",$.iQ.fixed,[this.additionalSubActions[m],this.additionalSubActions[m+1]]))}}this.subActions=this.action.subActions.filter(n=>!n.hidden),this.additionalSubActions=this.additionalSubActions.filter(n=>!n.hidden),this.cardConcat=this.action.type==$.X2.concatenation&&this.subActions.every(n=>n.type==$.X2.card||n.type==$.X2.concatenationSpacer)}}additionAttackSubAction(n){return!!([$.X2.condition,$.X2.target,$.X2.pierce,$.X2.pull,$.X2.push,$.X2.swing,$.X2.area].includes(n.type)||p.f.settings.calculateAdvantageStats&&n.type==$.X2.custom&&"%game.custom.advantage%"==n.value)}subActionExists(n,i,e=!0){return(!e||i.type!=$.X2.condition||!new Q.kW(i.value+"").types.includes(Q.GV.stackable))&&n.some(o=>o.type==i.type&&o.value==i.value&&(o.valueType||$.iQ.fixed)==(i.valueType||$.iQ.fixed))}applyChallenges(){this.action&&this.monster&&(s.E.challengesManager.apply&&s.E.challengesManager.isActive(1488,"fh")&&(this.action.type==$.X2.attack&&this.additionalSubActions.forEach(n=>{this.monster&&n.type==$.X2.range&&(n.value=(0,A.hZ)(n.value,this.monster.level)+(n.valueType==$.iQ.minus||n.valueType==$.iQ.subtract?-1:1))}),this.action.type==$.X2.move&&(this.action.value=(0,A.hZ)(this.action.value,this.monster.level)+(this.action.valueType==$.iQ.minus||this.action.valueType==$.iQ.subtract?-1:1))),s.E.challengesManager.apply&&s.E.challengesManager.isActive(1498,"fh")&&this.action.type==$.X2.attack&&this.additionalSubActions.find(n=>n.type==$.X2.range)&&this.additionalSubActions.push(new $.rc($.X2.push,1,$.iQ.fixed,[],!0)),s.E.challengesManager.apply&&s.E.challengesManager.isActive(1521,"fh")&&this.action.type==$.X2.move&&!this.additionalSubActions.find(n=>n.type==$.X2.jump)&&this.additionalSubActions.push(new $.rc($.X2.jump,"",$.iQ.fixed,[],!0)),s.E.challengesManager.apply&&s.E.challengesManager.isActive(1522,"fh")&&this.action.type==$.X2.attack&&!this.additionalSubActions.find(n=>n.type==$.X2.target)&&!this.additionalSubActions.find(n=>n.type==$.X2.area)&&(this.action.value=(0,A.hZ)(this.action.value,this.monster.level)-(this.action.valueType==$.iQ.minus||this.action.valueType==$.iQ.subtract?-1:1),this.additionalSubActions.push(new $.rc($.X2.target,2,$.iQ.fixed,[],!0))))}isGhsSvg(n){return mi.includes(n)}highlightAction(){return null!=this.interactiveActions.find(n=>n.index==this.actionIndex)||!1}toggleHighlight(n){if(this.isInteractiveApplicableAction){if(this.highlightAction())this.interactiveActions=this.interactiveActions.filter(i=>!i.index.startsWith(this.actionIndex));else if(this.origAction&&(this.interactiveActions.push({action:this.origAction,index:this.actionIndex}),this.origAction.subActions)){let i=[];this.monster?i=s.E.actionsManager.getAllInteractiveActions(this.monster,this.origAction.subActions,this.actionIndex):this.objective&&(i=s.E.actionsManager.getAllInteractiveActions(this.objective,this.origAction.subActions,this.actionIndex)),i.forEach(e=>{this.interactiveActions.some(o=>o.index==e.index)||this.interactiveActions.push(e)})}this.interactiveActionsChange.emit(this.interactiveActions),n.preventDefault(),n.stopPropagation()}}getOrigIndex(n){if(this.origAction&&this.origAction.subActions){const i=this.origAction.subActions.find(e=>JSON.stringify(n)==JSON.stringify(e));if(i)return this.origAction.subActions.indexOf(i)}return-1}onInteractiveActionsChange(n){this.interactiveActionsChange.emit(n)}enhancmenetElementReplace(){if(this.origAction&&this.origAction.enhancementTypes&&this.origAction.enhancementTypes.length&&this.enhancementContainer){const n=this.enhancementContainer.nativeElement.getElementsByClassName("placeholder-enhancement"),i=this.enhancementContainer.nativeElement.getElementsByTagName("ghs-action-enhancements");for(let e=0;e<i.length;e++)n[0]&&n[0].parentElement!=i[e].parentElement&&n[0].parentElement.replaceChild(i[e],n[0])}}static \u0275fac=function(i){return new(i||a)(t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-action"]],viewQuery:function(i,e){if(1&i&&t.GBs(Sn,5),2&i){let o;t.mGM(o=t.lsd())&&(e.enhancementContainer=o.first)}},inputs:{monster:"monster",monsterType:"monsterType",objective:"objective",origAction:[0,"action","origAction"],relative:"relative",inline:"inline",textBlack:"textBlack",right:"right",highlight:"highlight",interactiveAbilities:"interactiveAbilities",interactiveActions:"interactiveActions",statsCalculation:"statsCalculation",hexSize:"hexSize",actionIndex:[0,"index","actionIndex"],style:"style",character:"character",cardId:"cardId"},outputs:{interactiveActionsChange:"interactiveActionsChange"},standalone:!1,decls:1,vars:1,consts:[["enhancementContainer",""],[1,"action",3,"ngClass"],[1,"action-area",3,"ngClass"],[1,"action-condition",3,"ngClass"],[1,"action-element",3,"ngClass"],[1,"action-specialTarget"],[1,"action-custom"],["ghs-pointer-input","",1,"action-custom",3,"clickBehind","ghs-tooltip","delay","disabled","ngClass"],[1,"action-font-size",3,"font-size"],[1,"action-extra"],[1,"action-hint",3,"ghs-label"],[1,"action-grant"],[1,"action-summon",3,"ngClass"],[1,"action-trigger"],[1,"action-default"],[1,"action-box-container",3,"ngClass"],[1,"action-box-fh-subactions-container",3,"ngClass"],[1,"action-box-container-forced",3,"ngClass"],[1,"action-card",3,"ngClass"],[1,"action-default","action-special",3,"ngClass"],[1,"action-default",3,"ngClass"],[1,"aoe-value",3,"ngClass"],[1,"element-actions"],[3,"action","value","size","index","cardId","character"],["ghs-pointer-input","",1,"condition",3,"singleClick","clickBehind","ghs-tooltip","delay","disabled","ngClass"],[1,"condition-value"],[3,"ghs-label","ghs-label-args"],[1,"condition-image"],[1,"icon",3,"src"],["src","./assets/images/warning.svg",1,"icon","warning"],[1,"value"],[3,"action","index","character","cardId"],[1,"subactions"],[3,"interactiveActionsChange","ngClass","action","monster","objective","inline","right","textBlack","hexSize","statsCalculation","interactiveAbilities","interactiveActions","index","monsterType","character","cardId"],["ghs-pointer-input","",1,"elements",3,"singleClick","clickBehind","ghs-tooltip","delay","disabled","ngClass"],[1,"element",3,"ngClass"],[1,"minus"],[1,"element-subactions"],[3,"src"],[1,"element-subaction",3,"interactiveActionsChange","ngClass","action","monster","objective","relative","inline","right","textBlack","hexSize","interactiveAbilities","interactiveActions","statsCalculation","index","monsterType","character","cardId"],[1,"elements","elements-half"],["ghs-pointer-input","",1,"element-half-container",3,"singleClick","ngClass","clickBehind","ghs-tooltip","delay","disabled"],[1,"element-half"],[1,"action-monster-type",3,"ngClass"],[1,"monster-type","small",3,"ngClass"],[3,"ghs-label"],[1,"monster-type-subactions"],[3,"interactiveActionsChange","ngClass","action","monster","objective","relative","inline","right","textBlack","hexSize","interactiveAbilities","interactiveActions","statsCalculation","index","monsterType"],[1,"action-round",3,"ngClass"],[1,"round-subactions"],[3,"ngClass","action","monster","objective","inline","right","textBlack","hexSize","interactiveAbilities","interactiveActions","relative","statsCalculation","index","monsterType","character","cardId","style"],[3,"interactiveActionsChange","ngClass","action","monster","objective","inline","right","textBlack","hexSize","interactiveAbilities","interactiveActions","relative","statsCalculation","index","monsterType","character","cardId"],[1,"enhancements-container"],[1,"special-target-value",3,"ghs-label","ghs-label-args","relative","ngClass"],[3,"ngClass"],[3,"action","index","character","cardId","slot"],[1,"special-target-subactions"],[1,"elite"],[1,"custom-subactions"],[1,"custom-value",3,"ghs-label","relative","ngClass"],["ghs-pointer-input","",1,"action-custom",3,"singleClick","clickBehind","ghs-tooltip","delay","disabled","ngClass"],[1,"action-font-size"],[1,"custom-value",3,"ghs-label","relative","ngClass","ghs-label-args"],[1,"grant-value",3,"ghs-label","relative","ngClass"],[1,"grant-subactions"],[3,"interactiveActionsChange","action","right","textBlack","monster","objective","interactiveAbilities","interactiveActions","index","character","cardId","monsterType"],[3,"interactiveActionsChange","action","right","textBlack","monster","objective","spawn","interactiveAbilities","interactiveActions","index","character","cardId","monsterType"],[1,"action-concatenation",3,"ngClass"],[1,"action-concatenation-item"],[3,"ghs-label","relative","style"],[3,"ghs-label","relative"],[1,"action-concatenation-spacer"],[1,"action-concatenation-spacer-item",3,"ngClass"],[1,"action-grid",3,"--ghs-grid-columns","ngClass"],[1,"action-grid",3,"ngClass"],[1,"action-box-label",3,"ghs-label","relative","style"],[1,"action-box"],[1,"action-box-label",3,"ghs-label","relative"],[1,"action-box-label"],[1,"card-value",3,"ngClass"],[1,"ghs-svg",3,"src"],[1,"overlay",3,"src"],[1,"overlay",3,"mask-image","-webkit-mask-image"],[1,"overlay"],[1,"special-type"],[1,"special-subactions",3,"interactiveActionsChange","actions","monster","objective","inline","right","textBlack","hexSize","interactiveAbilities","interactiveActions","relative","statsCalculation","index","character","cardId"],["ghs-pointer-input","",1,"main-action",3,"singleClick","ngClass","clickBehind","ghs-tooltip","delay","disabled"],[1,"type"],[1,"action-icon"],[1,"icon",3,"src","ngClass"],[3,"value-calc","level"],[3,"ngClass","value-calc","level"],[3,"ngClass","ghs-label","relative","style"],[3,"ngClass","ghs-label","relative"],[1,"elite",3,"value-calc","level"],[1,"elite",3,"ghs-label","relative"],[1,"fh-extra-subactions"]],template:function(i,e){1&i&&t.nVh(0,kg,30,11,"span",1),2&i&&t.vxM(e.action&&e.origAction?0:-1)},styles:['.action[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap;position:relative;width:100%;color:var(--ghs-color-white);line-height:.8em}.action.aoe[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:.2em;align-items:center}@keyframes _ngcontent-%COMP%_highlight-animation{0%{background-position:0% center;-webkit-mask-position:0% center;mask-position:0% center}65%{background-position:0% center;-webkit-mask-position:0% center;mask-position:0% center}to{background-position:200% center;-webkit-mask-position:200% center;mask-position:200% center}}@keyframes _ngcontent-%COMP%_highlight-image{0%{opacity:1}50%{opacity:1}to{opacity:.5}}.action.highlight[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background-image:linear-gradient(-225deg,var(--ghs-color-white) 0%,var(--ghs-color-white) 50%,var(--ghs-color-darkgray) 75%,var(--ghs-color-white) 100%);background-position:0% center;background-clip:border-box;background-size:200% auto;background-clip:text;-webkit-background-clip:text;-webkit-text-fill-color:transparent;animation:_ngcontent-%COMP%_highlight-animation calc(var(--ghs-animation-speed) * 3s) linear infinite;animation-delay:-1.5s}.action.highlight[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_highlight-image calc(var(--ghs-animation-speed) * .3s) ease-in-out infinite;animation-delay:-1.5s}.action.highlight.right[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background-image:linear-gradient(-225deg,var(--ghs-color-black) 0%,var(--ghs-color-black) 50%,var(--ghs-color-white) 75%,var(--ghs-color-black) 100%)}.action[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .placeholder-action[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.action[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin:0 .1em .1em;height:1em;width:auto}.action[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]:not(.ghs-svg){filter:var(--ghs-filter-shadow)}.action[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .condition-value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .special-target-value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .monster-type[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .summon-value[_ngcontent-%COMP%]{filter:var(--ghs-filter-shadow)}.action[_ngcontent-%COMP%]   .type.small[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .value.small[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .condition-value.small[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .custom-value.small[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .grant-value.small[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .special-target-value.small[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .monster-type.small[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .summon-value.small[_ngcontent-%COMP%]{filter:var(--ghs-filter-shadow-thin)}.action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]{font-size:76%;line-height:76%}.action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   .condition-value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   .special-target-value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   .monster-type[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   .summon-value[_ngcontent-%COMP%]{filter:var(--ghs-filter-shadow-thin)}.action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   .placeholder-action[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow-thin)}.action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]:not(.ghs-svg){filter:var(--ghs-filter-shadow-thin)}.action[_ngcontent-%COMP%]   .action-default[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-custom[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-grant[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-summon[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-specialTarget[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-condition[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.action[_ngcontent-%COMP%]   .action-custom[_ngcontent-%COMP%]   ghs-action-enhancements[_ngcontent-%COMP%]{margin-top:.4em}.action[_ngcontent-%COMP%]   .action-default[_ngcontent-%COMP%]   .main-action[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-grant[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-condition[_ngcontent-%COMP%]{filter:drop-shadow(.01em .01em .01em var(--ghs-color-black))}.action[_ngcontent-%COMP%]   .action-monster-type[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;max-width:10em}.action[_ngcontent-%COMP%]   .action-monster-type[_ngcontent-%COMP%]   .monster-type-subactions[_ngcontent-%COMP%]{margin-left:.2em}.action[_ngcontent-%COMP%]   .action-default[_ngcontent-%COMP%]   .main-action[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-default[_ngcontent-%COMP%]   .main-action[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.action[_ngcontent-%COMP%]   .action-summon[_ngcontent-%COMP%]{width:100%}.action[_ngcontent-%COMP%]   .action-summon[_ngcontent-%COMP%]   ghs-action-summon[_ngcontent-%COMP%]{width:100%}.action[_ngcontent-%COMP%]   .action-area[_ngcontent-%COMP%]{margin-top:.3em}.action[_ngcontent-%COMP%]   .enhancements-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;filter:drop-shadow(.01em .01em .01em var(--ghs-color-black))}.action[_ngcontent-%COMP%]   ghs-action-enhancements-custom-label[_ngcontent-%COMP%]{font-size:1em;line-height:1em}.action[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%]{padding:0 .2em}.action[_ngcontent-%COMP%]   ghs-action-summon[_ngcontent-%COMP%]{padding:0 .1em}.action[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%]{position:relative;font-size:82%;line-height:82%;padding:0 .5em}.action[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%]:before, .action[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%]:after, .action[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%]:before, .action[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%]:after{content:" ";position:absolute;width:2em;height:.09em;left:-1.6em;top:50%;transform:translateY(-50%);background:linear-gradient(90deg,transparent 0%,var(--ghs-color-white) 100%)}.action[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%]:after, .action[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%]:after{left:auto;right:-1.6em;background:linear-gradient(90deg,var(--ghs-color-white) 0%,transparent 100%)}.action[_ngcontent-%COMP%]   .action-special[_ngcontent-%COMP%] > .type[_ngcontent-%COMP%]{margin-bottom:.1em}.action[_ngcontent-%COMP%]   .special-type[_ngcontent-%COMP%]{color:var(--ghs-color-red);filter:var(--ghs-filter-shadow)}.action[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.action[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .condition-image[_ngcontent-%COMP%]{position:relative;width:1em;height:1em;margin:0 .1em .1em}.action[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .condition-image[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:100%;height:auto;margin:0;filter:var(--ghs-filter-shadow-thin)}.action[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .condition-image[_ngcontent-%COMP%]   img.icon.warning[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow) var(--ghs-filter-shadow-thin)}.action[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .condition-image[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:.45em;line-height:1em;color:var(--ghs-color-white);position:absolute;top:0;left:0;display:flex;justify-content:center;align-items:flex-end;width:100%;height:100%}.action[_ngcontent-%COMP%]   .action-specialTarget[_ngcontent-%COMP%]{display:block}.action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap;margin:.15em 0}.action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value[_ngcontent-%COMP%]{position:relative;height:1.2em}.action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:relative;height:100%;width:auto;z-index:1}.action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;z-index:2}.action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-family:var(--ghs-font-title);font-size:.8em;filter:invert(1);z-index:3}.action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slot[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStart[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStartXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEnd[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXpFh[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEndXp[_ngcontent-%COMP%]{height:2em;margin:.2em .05em}.action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slot.slot[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slot.slotStart[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slot.slotStartXp[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slot.slotXp[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slot.slotXpFh[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slot.slotEndXp[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStart.slot[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStart.slotStart[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStart.slotStartXp[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStart.slotXp[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStart.slotXpFh[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStart.slotEndXp[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStartXp.slot[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStartXp.slotStart[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStartXp.slotStartXp[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStartXp.slotXp[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStartXp.slotXpFh[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStartXp.slotEndXp[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEnd.slot[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEnd.slotStart[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEnd.slotStartXp[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEnd.slotXp[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEnd.slotXpFh[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEnd.slotEndXp[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXp.slot[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXp.slotStart[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXp.slotStartXp[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXp.slotXp[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXp.slotXpFh[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXp.slotEndXp[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXpFh.slot[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXpFh.slotStart[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXpFh.slotStartXp[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXpFh.slotXp[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXpFh.slotXpFh[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXpFh.slotEndXp[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEndXp.slot[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEndXp.slotStart[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEndXp.slotStartXp[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEndXp.slotXp[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEndXp.slotXpFh[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEndXp.slotEndXp[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{background-color:var(--ghs-ability-color);-webkit-mask-position:top left;mask-position:top left;-webkit-mask-size:100% 100%;mask-size:100% 100%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat}.action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slot[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStart[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStartXp[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEnd[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXp[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXpFh[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEndXp[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);left:42%}.action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slot.slotXpFh[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slot.slotStartXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slot.slotEndXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStart.slotXpFh[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStart.slotStartXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStart.slotEndXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStartXp.slotXpFh[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStartXp.slotStartXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStartXp.slotEndXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEnd.slotXpFh[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEnd.slotStartXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEnd.slotEndXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXp.slotXpFh[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXp.slotStartXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXp.slotEndXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXpFh.slotXpFh[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXpFh.slotStartXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXpFh.slotEndXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEndXp.slotXpFh[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEndXp.slotStartXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEndXp.slotEndXp[_ngcontent-%COMP%]{height:2.2em;margin-top:0}.action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slot.slotXpFh[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slot.slotStartXp[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slot.slotEndXp[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStart.slotXpFh[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStart.slotStartXp[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStart.slotEndXp[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStartXp.slotXpFh[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStartXp.slotStartXp[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStartXp.slotEndXp[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEnd.slotXpFh[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEnd.slotStartXp[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEnd.slotEndXp[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXp.slotXpFh[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXp.slotStartXp[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXp.slotEndXp[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXpFh.slotXpFh[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXpFh.slotStartXp[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXpFh.slotEndXp[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEndXp.slotXpFh[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEndXp.slotStartXp[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEndXp.slotEndXp[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{top:17%;font-size:.6em;left:84%}.action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slot[_ngcontent-%COMP%] + .slotXpFh[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slot[_ngcontent-%COMP%] + .slotStartXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slot.slotEndXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStart[_ngcontent-%COMP%] + .slotXpFh[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStart[_ngcontent-%COMP%] + .slotStartXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStart.slotEndXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStartXp[_ngcontent-%COMP%] + .slotXpFh[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStartXp[_ngcontent-%COMP%] + .slotStartXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStartXp.slotEndXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEnd[_ngcontent-%COMP%] + .slotXpFh[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEnd[_ngcontent-%COMP%] + .slotStartXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEnd.slotEndXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXp[_ngcontent-%COMP%] + .slotXpFh[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXp[_ngcontent-%COMP%] + .slotStartXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXp.slotEndXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXpFh[_ngcontent-%COMP%] + .slotXpFh[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXpFh[_ngcontent-%COMP%] + .slotStartXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXpFh.slotEndXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEndXp[_ngcontent-%COMP%] + .slotXpFh[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEndXp[_ngcontent-%COMP%] + .slotStartXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEndXp.slotEndXp[_ngcontent-%COMP%]{margin-left:-.1em}.action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]{margin-left:.1em}.action[_ngcontent-%COMP%]   .condition-value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-bless[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-curse[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-pierce[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-pull[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-push[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-swing[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{text-transform:uppercase}.action[_ngcontent-%COMP%]   .elite[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.action[_ngcontent-%COMP%]   .action-hint[_ngcontent-%COMP%]{position:relative;min-width:60%;background:#7cd2e0;background:linear-gradient(90deg,#7cd2e0,#c1ecf5);color:var(--ghs-color-black);font-size:.7em;line-height:.9em;text-align:center;font-weight:700;margin:-.7em .5em .5em;padding:.3em;border:.1em solid rgb(39,103,124)}.action[_ngcontent-%COMP%]   .action-hint[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:.1em;border:.1em solid var(--ghs-color-white);opacity:.7}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;align-items:flex-start;margin-top:.5%}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]{display:flex;flex-wrap:unset;justify-content:center;align-items:center}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%]{position:relative;width:1.2em;height:1.2em}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%]:not(:first-child){margin-left:.3em}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]   .minus[_ngcontent-%COMP%]{font-size:1.5em}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]:not(.elements-half)   .element-half[_ngcontent-%COMP%]{position:relative;width:.6em;overflow:hidden}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]:not(.elements-half)   .element-half[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:200%}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]:not(.elements-half)   .element-half[_ngcontent-%COMP%]:nth-child(1){left:0;margin-right:-.01em}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]:not(.elements-half)   .element-half[_ngcontent-%COMP%]:nth-child(1).highlight{animation:_ngcontent-%COMP%_element-half-pulse calc(var(--ghs-animation-speed) * 1.2s) ease-in-out infinite;transform-origin:center right}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]:not(.elements-half)   .element-half[_ngcontent-%COMP%]:nth-child(1).highlight:hover{transform:scale(1)!important}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]:not(.elements-half)   .element-half[_ngcontent-%COMP%]:nth-child(2){right:0;margin-left:-.01em}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]:not(.elements-half)   .element-half[_ngcontent-%COMP%]:nth-child(2)   img[_ngcontent-%COMP%]{transform:translate(-50%)}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]:not(.elements-half)   .element-half[_ngcontent-%COMP%]:nth-child(2):before{background-position:right}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]:not(.elements-half)   .element-half[_ngcontent-%COMP%]:nth-child(2).highlight{animation:_ngcontent-%COMP%_element-half-pulse-right calc(var(--ghs-animation-speed) * 1.2s) ease-in-out infinite;transform-origin:center left}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]:not(.elements-half)   .element-half[_ngcontent-%COMP%]:nth-child(2).highlight:hover{transform:scale(1)!important}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]   .element-half-container[_ngcontent-%COMP%]{overflow:visible;width:1.2em;height:1.2em}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]   .element-half-container[_ngcontent-%COMP%]:after{filter:var(--ghs-filter-white)}@keyframes _ngcontent-%COMP%_highlight-text-pulse{0%{transform:scale(.9)}50%{transform:scale(1)}to{transform:scale(.9)}}@keyframes _ngcontent-%COMP%_element-pulse{0%{transform:scale(.8)}50%{transform:scale(1)}to{transform:scale(.8)}}@keyframes _ngcontent-%COMP%_element-half-pulse{0%{transform:scale(.8)}50%{transform:scale(1)}to{transform:scale(.8)}}@keyframes _ngcontent-%COMP%_element-half-pulse-right{0%{transform:scale(.8)}50%{transform:scale(1)}to{transform:scale(.8)}}.action[_ngcontent-%COMP%]   .action-interactive.condition[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-interactive.action-custom[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-interactive.main-action[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-interactive.elements[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-interactive.element-half-container[_ngcontent-%COMP%]   .element-half[_ngcontent-%COMP%]{cursor:zoom-in}.action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.condition[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.action-custom[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.main-action[_ngcontent-%COMP%]{cursor:zoom-out;animation:_ngcontent-%COMP%_highlight-text-pulse calc(var(--ghs-animation-speed) * 1.2s) ease-in-out infinite}.action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.condition[_ngcontent-%COMP%]:hover, .action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.action-custom[_ngcontent-%COMP%]:hover, .action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.main-action[_ngcontent-%COMP%]:hover{transform:scale(1);opacity:.8;animation:none}.action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.elements[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%]{cursor:zoom-out;animation:_ngcontent-%COMP%_element-pulse calc(var(--ghs-animation-speed) * 1.2s) ease-in-out infinite}.action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.elements[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%]:hover{animation:none;transform:scale(1)!important;z-index:5}.action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.element-half-container[_ngcontent-%COMP%]   .element-half[_ngcontent-%COMP%]{cursor:zoom-out}.action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.element-half-container[_ngcontent-%COMP%]   .element-half[_ngcontent-%COMP%]:nth-child(1){animation:_ngcontent-%COMP%_element-half-pulse calc(var(--ghs-animation-speed) * 1.2s) ease-in-out infinite;transform-origin:center right}.action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.element-half-container[_ngcontent-%COMP%]   .element-half[_ngcontent-%COMP%]:nth-child(1):hover{transform:scale(1)!important}.action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.element-half-container[_ngcontent-%COMP%]   .element-half[_ngcontent-%COMP%]:nth-child(2){animation:_ngcontent-%COMP%_element-half-pulse-right calc(var(--ghs-animation-speed) * 1.2s) ease-in-out infinite;transform-origin:center left}.action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.element-half-container[_ngcontent-%COMP%]   .element-half[_ngcontent-%COMP%]:nth-child(2):hover{transform:scale(1)!important}.action[_ngcontent-%COMP%]   ghs-action.subaction-area[_ngcontent-%COMP%]:not(:nth-of-type(1)){margin-top:.1%}.action[_ngcontent-%COMP%]   ghs-action.subaction-area[_ngcontent-%COMP%]:nth-of-type(1){flex-basis:0}.action[_ngcontent-%COMP%]   ghs-action.subaction-area[_ngcontent-%COMP%]:nth-of-type(1)   .action-area[_ngcontent-%COMP%]   ghs-action-hex[_ngcontent-%COMP%]{position:relative}.action[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]{margin-top:0}.action[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:1.2em;justify-content:center;flex:1 0 auto}.action[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%]{margin-top:0;margin-left:5%}.action[_ngcontent-%COMP%]   .custom-subactions[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .grant-subactions[_ngcontent-%COMP%]{width:100%}.action[_ngcontent-%COMP%]   .monster-type[_ngcontent-%COMP%]{text-transform:uppercase}.action[_ngcontent-%COMP%]   .monster-type.monster-type-elite[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.action[_ngcontent-%COMP%]   .monster-type.monster-type-boss[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.action[_ngcontent-%COMP%]   .action-concatenation[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center}.action[_ngcontent-%COMP%]   .action-concatenation[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]{flex-basis:auto;flex-shrink:0;max-width:100%}.action[_ngcontent-%COMP%]   .action-concatenation.card-concat[_ngcontent-%COMP%]{margin-bottom:.4em}.action[_ngcontent-%COMP%]   .action-concatenation.card-concat[_ngcontent-%COMP%]   .subaction-card[_ngcontent-%COMP%]{margin-bottom:-.4em}.action[_ngcontent-%COMP%]   .action-concatenation[_ngcontent-%COMP%]   .action-concatenation-item[_ngcontent-%COMP%]{margin:0 .15em;filter:drop-shadow(.01em .01em .01em var(--ghs-color-black))}.action[_ngcontent-%COMP%]   .action-concatenation-spacer[_ngcontent-%COMP%]{display:flex}.action[_ngcontent-%COMP%]   .action-concatenation-spacer[_ngcontent-%COMP%]   .action-concatenation-spacer-item[_ngcontent-%COMP%]{display:block;width:1em}.action[_ngcontent-%COMP%]   .action-concatenation-spacer[_ngcontent-%COMP%]   .action-concatenation-spacer-item.small[_ngcontent-%COMP%]{width:.4em}.action[_ngcontent-%COMP%]   .action-grid[_ngcontent-%COMP%]{--ghs-grid-columns: 2;display:grid;grid-template-columns:repeat(var(--ghs-grid-columns),auto);column-gap:.5em;margin:0 .5em;align-items:center}.action[_ngcontent-%COMP%]   .action-box-container[_ngcontent-%COMP%]{width:100%;position:relative;display:flex;flex-direction:column;margin-bottom:.5em}.action[_ngcontent-%COMP%]   .action-box-container[_ngcontent-%COMP%]   .action-box-label[_ngcontent-%COMP%]{color:var(--ghs-ability-color);text-align:left;padding:.3em 1em}.action[_ngcontent-%COMP%]   .action-box-container[_ngcontent-%COMP%]   .action-box[_ngcontent-%COMP%]{position:relative;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:.2em .3em}.action[_ngcontent-%COMP%]   .action-box-container[_ngcontent-%COMP%]   .action-box[_ngcontent-%COMP%]:before{content:" ";display:block;position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--ghs-color-black);opacity:.5;z-index:0}.action[_ngcontent-%COMP%]   .action-box-container.empty[_ngcontent-%COMP%]{margin-bottom:0}.action[_ngcontent-%COMP%]   .action-box-container.empty[_ngcontent-%COMP%]   .action-box[_ngcontent-%COMP%]{display:none}.action[_ngcontent-%COMP%]   .action-box-container.first[_ngcontent-%COMP%]{margin-top:-.8em}.action[_ngcontent-%COMP%]   .action-box-fh-subactions-container[_ngcontent-%COMP%]{width:100%;position:relative;display:flex;flex-direction:column;margin-bottom:.5em}.action[_ngcontent-%COMP%]   .action-box-fh-subactions-container[_ngcontent-%COMP%]   .action-box-label[_ngcontent-%COMP%]{color:var(--ghs-ability-color);text-align:left;padding:.3em 1em}.action[_ngcontent-%COMP%]   .action-box-fh-subactions-container[_ngcontent-%COMP%]   .action-box[_ngcontent-%COMP%]{position:relative;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:.2em .3em;border:.04em dashed var(--ghs-color-white);border-radius:2em/100%}.action[_ngcontent-%COMP%]   .action-box-fh-subactions-container[_ngcontent-%COMP%]   .action-box[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:-.04em;left:-.02em;height:100%;width:100%;background-color:var(--ghs-color-white);opacity:.2;border:.04em solid var(--ghs-color-white);border-radius:2em/100%;z-index:-1}.action[_ngcontent-%COMP%]   .action-box-container-forced[_ngcontent-%COMP%]{position:relative;display:flex;margin-bottom:.5em}.action[_ngcontent-%COMP%]   .action-box-container-forced[_ngcontent-%COMP%]   .action-box-label[_ngcontent-%COMP%]{position:relative;top:.1em;display:flex;flex-grow:1;justify-content:center;align-items:center;padding:.3em;border-right:.1em solid var(--ghs-ability-color)}.action[_ngcontent-%COMP%]   .action-box-container-forced[_ngcontent-%COMP%]   .action-box-label[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:1.5em}.action[_ngcontent-%COMP%]   .action-box-container-forced[_ngcontent-%COMP%]   .action-box[_ngcontent-%COMP%]{position:relative;display:flex;flex-grow:1;justify-content:flex-start;align-items:center;padding:.2em}.action[_ngcontent-%COMP%]   .action-box-container-forced[_ngcontent-%COMP%]:before{content:" ";display:block;position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--ghs-color-black);opacity:.5;z-index:0;border:.1em solid var(--ghs-ability-color);border-radius:.5em}.action[_ngcontent-%COMP%]   .special-target-value[_ngcontent-%COMP%]{display:block}.action[_ngcontent-%COMP%]   ghs-action.subaction-monsterType[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.action.inline[_ngcontent-%COMP%]{justify-content:flex-start;margin-top:0;margin-bottom:0}.action.inline[_ngcontent-%COMP%]:not(:nth-child(1)){margin-top:.1em}.action.inline[_ngcontent-%COMP%]   .action-default[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .action-custom[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .action-grant[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .action-summon[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .action-specialTarget[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .action-condition[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.action.inline[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{align-self:flex-start}.action.inline[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .condition-value[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .special-target-value[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .monster-type[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .summon-value[_ngcontent-%COMP%]{filter:none!important}.action.inline[_ngcontent-%COMP%]   .special-target-value[_ngcontent-%COMP%]{display:block}.action.inline[_ngcontent-%COMP%]   .main-action[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .condition-subactions[_ngcontent-%COMP%]{align-self:flex-start;justify-content:flex-start}.action.inline[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   ghs-action-summon[_ngcontent-%COMP%]{text-align:left;padding:0!important}.action.inline[_ngcontent-%COMP%]   .action-concatenation[_ngcontent-%COMP%]{justify-content:flex-start}.action.inline[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]{flex-basis:unset}.action.inline[_ngcontent-%COMP%]   .element-subactions.subaction-area[_ngcontent-%COMP%] ~ ghs-action[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   ghs-action.subaction-area[_ngcontent-%COMP%] ~ ghs-action[_ngcontent-%COMP%]{flex-basis:100%;flex-shrink:1;margin-left:.1%}.action.inline[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]{flex-wrap:unset}.action.inline[_ngcontent-%COMP%]   .action-custom[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .action-grant[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .action-summon[_ngcontent-%COMP%]{align-items:flex-start;flex-wrap:wrap}.action.inline[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:.7em;width:auto}.action.inline[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .action-specialTarget[_ngcontent-%COMP%]{align-items:flex-start}.action.right[_ngcontent-%COMP%], .action.right[_ngcontent-%COMP%]   .action-default[_ngcontent-%COMP%], .action.right[_ngcontent-%COMP%]   .action-custom[_ngcontent-%COMP%], .action.right[_ngcontent-%COMP%]   .action-grant[_ngcontent-%COMP%], .action.right[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%], .action.right[_ngcontent-%COMP%]   .action-specialTarget[_ngcontent-%COMP%], .action.right[_ngcontent-%COMP%]   .action-condition[_ngcontent-%COMP%], .action.right[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]{justify-content:flex-end;text-align:right}.action.right[_ngcontent-%COMP%]   .action-default[_ngcontent-%COMP%]   .main-action[_ngcontent-%COMP%]{justify-content:flex-end;text-align:right;width:100%}.action.right.inline[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%], .action.right.inline[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%], .action.right.inline[_ngcontent-%COMP%]   ghs-action-summon[_ngcontent-%COMP%]{text-align:right;width:100%}.action.right.inline[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%]{align-items:flex-end;align-self:flex-end}.action.text-black[_ngcontent-%COMP%]{color:var(--ghs-color-black);filter:none!important}.action.text-black[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .placeholder-action[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .action-default[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .action-custom[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .action-grant[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .action-specialTarget[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .action-condition[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .condition-value[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .special-target-value[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .monster-type[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .summon-value[_ngcontent-%COMP%]{filter:none!important}.action[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .monster-type-subactions[_ngcontent-%COMP%]{flex-shrink:0;display:flex;flex-direction:column;justify-content:center;align-items:center}.action[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%]   .subaction-area[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .monster-type-subactions[_ngcontent-%COMP%]   .subaction-area[_ngcontent-%COMP%]{margin-top:.3em}.action.fh[_ngcontent-%COMP%]{max-width:100%}.action.fh[_ngcontent-%COMP%]   .action-default[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-custom[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-grant[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-summon[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-specialTarget[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-condition[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]{flex-direction:row;flex-wrap:wrap}.action.fh[_ngcontent-%COMP%]   .action-custom[_ngcontent-%COMP%]   ghs-action-enhancements[_ngcontent-%COMP%]{width:100%}.action.fh[_ngcontent-%COMP%]   .action-custom[_ngcontent-%COMP%]   .enhancements-container[_ngcontent-%COMP%]   ghs-action-enhancements[_ngcontent-%COMP%]{width:auto}.action.fh[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .special-target-value[_ngcontent-%COMP%]{font-family:var(--ghs-font-text)}.action.fh[_ngcontent-%COMP%]   .main-action[_ngcontent-%COMP%]{font-size:125%;line-height:125%}.action.fh[_ngcontent-%COMP%]   .main-action.small[_ngcontent-%COMP%]{font-size:82%;line-height:82%}.action.fh[_ngcontent-%COMP%]   .main-action.small[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:.8em}.action.fh[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .condition-value[_ngcontent-%COMP%]{display:none}.action.fh[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]{flex-direction:row;align-items:center}.action.fh[_ngcontent-%COMP%]   .action-grid[_ngcontent-%COMP%]{column-gap:.1em;margin:0}.action.fh[_ngcontent-%COMP%]   .monster-type[_ngcontent-%COMP%]{text-transform:initial}.action.fh[_ngcontent-%COMP%]:not(.inline)   .condition[_ngcontent-%COMP%]   .condition-image[_ngcontent-%COMP%]{width:1.4em;height:1.4em;display:flex;justify-content:center;align-items:center}.action.fh[_ngcontent-%COMP%]:not(.inline)   .subactions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .condition-image[_ngcontent-%COMP%]{width:1.2em;height:1em;display:flex;justify-content:center;align-items:center}.action.fh[_ngcontent-%COMP%]:not(.inline)   .subactions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .condition-image[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:1.5em;height:1.5em;margin:0}.action.fh[_ngcontent-%COMP%]:not(.inline)   .subactions[_ngcontent-%COMP%]   .action-push[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]:not(.inline)   .subactions[_ngcontent-%COMP%]   .action-pull[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]:not(.inline)   .subactions[_ngcontent-%COMP%]   .action-pierce[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{width:1.7em;height:1em;justify-content:flex-start}.action.fh[_ngcontent-%COMP%]:not(.inline)   .subactions[_ngcontent-%COMP%]   .action-push[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]:not(.inline)   .subactions[_ngcontent-%COMP%]   .action-pull[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]:not(.inline)   .subactions[_ngcontent-%COMP%]   .action-pierce[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:1.5em;height:1.5em;margin:0}.action.fh[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .condition-subactions[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .monster-type-subactions[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .subaction-custom[_ngcontent-%COMP%]   .custom-subactions[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .subaction-grant[_ngcontent-%COMP%]   .grant-subactions[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .subaction-specialTarget[_ngcontent-%COMP%]   .special-target-subactions[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:row;flex-wrap:wrap;max-width:95%;padding:.1em;margin-left:.2em;width:auto}.action.fh[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .condition-subactions[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .monster-type-subactions[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .subaction-custom[_ngcontent-%COMP%]   .custom-subactions[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .subaction-grant[_ngcontent-%COMP%]   .grant-subactions[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .subaction-specialTarget[_ngcontent-%COMP%]   .special-target-subactions[_ngcontent-%COMP%]:before{content:" ";position:absolute;z-index:0;top:50%;width:100%;height:100%;transform:translateY(-50%);background-color:var(--ghs-color-white);opacity:.2;border-radius:1em/100%}.action.fh[_ngcontent-%COMP%]   .subactions.monster-type-subactions[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .condition-subactions.monster-type-subactions[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .monster-type-subactions.monster-type-subactions[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .subaction-custom[_ngcontent-%COMP%]   .custom-subactions.monster-type-subactions[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .subaction-grant[_ngcontent-%COMP%]   .grant-subactions.monster-type-subactions[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .subaction-specialTarget[_ngcontent-%COMP%]   .special-target-subactions.monster-type-subactions[_ngcontent-%COMP%]:before{display:none}.action.fh[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .condition-subactions[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .monster-type-subactions[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .subaction-custom[_ngcontent-%COMP%]   .custom-subactions[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .subaction-grant[_ngcontent-%COMP%]   .grant-subactions[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .subaction-specialTarget[_ngcontent-%COMP%]   .special-target-subactions[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]{margin:0 .1em}.action.fh.text-black[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%]:before, .action.fh.text-black[_ngcontent-%COMP%]   .condition-subactions[_ngcontent-%COMP%]:before, .action.fh.text-black[_ngcontent-%COMP%]   .monster-type-subactions[_ngcontent-%COMP%]:before, .action.fh.text-black[_ngcontent-%COMP%]   .subaction-custom[_ngcontent-%COMP%]   .custom-subactions[_ngcontent-%COMP%]:before, .action.fh.text-black[_ngcontent-%COMP%]   .subaction-grant[_ngcontent-%COMP%]   .grant-subactions[_ngcontent-%COMP%]:before, .action.fh.text-black[_ngcontent-%COMP%]   .subaction-specialTarget[_ngcontent-%COMP%]   .special-target-subactions[_ngcontent-%COMP%]:before{opacity:.5}.action.fh[_ngcontent-%COMP%]   .action-concatenation[_ngcontent-%COMP%]   .action-concatenation-item[_ngcontent-%COMP%]{margin:0}.action.fh[_ngcontent-%COMP%]   .special-type[_ngcontent-%COMP%]{flex-basis:100%;flex-shrink:0}.action.fh[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]   .minus[_ngcontent-%COMP%]{margin-left:.05em;margin-right:.2em}.action.fh[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]{max-width:80%}.action.fh[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]   .subaction-element[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]{padding:0}.action.fh[_ngcontent-%COMP%]   .element-actions[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .fh-extra-subactions[_ngcontent-%COMP%]{flex-basis:100%}.action.fh[_ngcontent-%COMP%]   .element-actions[_ngcontent-%COMP%] > .subaction-element[_ngcontent-%COMP%] > .action[_ngcontent-%COMP%] > .action-element[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .element-actions[_ngcontent-%COMP%] > .subaction-boxFhSubActions[_ngcontent-%COMP%] > .action[_ngcontent-%COMP%] > .action-box-fh-subactions-container[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .fh-extra-subactions[_ngcontent-%COMP%] > .subaction-element[_ngcontent-%COMP%] > .action[_ngcontent-%COMP%] > .action-element[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .fh-extra-subactions[_ngcontent-%COMP%] > .subaction-boxFhSubActions[_ngcontent-%COMP%] > .action[_ngcontent-%COMP%] > .action-box-fh-subactions-container[_ngcontent-%COMP%]{margin-top:.5em}.action.fh[_ngcontent-%COMP%]   .element-actions[_ngcontent-%COMP%] > .subaction-element[_ngcontent-%COMP%] > .action[_ngcontent-%COMP%] > .action-element[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .element-actions[_ngcontent-%COMP%] > .subaction-boxFhSubActions[_ngcontent-%COMP%] > .action[_ngcontent-%COMP%] > .action-box-fh-subactions-container[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .fh-extra-subactions[_ngcontent-%COMP%] > .subaction-element[_ngcontent-%COMP%] > .action[_ngcontent-%COMP%] > .action-element[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .fh-extra-subactions[_ngcontent-%COMP%] > .subaction-boxFhSubActions[_ngcontent-%COMP%] > .action[_ngcontent-%COMP%] > .action-box-fh-subactions-container[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:-.4em;left:50%;transform:translate(-50%);width:2em;height:.4em;color:radial-gradient(var(--ghs-color-white) 0%,transparent 100%);background:radial-gradient(var(--ghs-color-white) 0%,transparent 100%);background-clip:padding-box;clip-path:polygon(48% 100%,52% 100%,52% 15%,100% 15%,100% 0%,0% 0%,0% 15%,48.5% 15%);z-index:-1}.action.fh[_ngcontent-%COMP%]   .element-actions[_ngcontent-%COMP%]   .action-box-fh-subactions-container[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .fh-extra-subactions[_ngcontent-%COMP%]   .action-box-fh-subactions-container[_ngcontent-%COMP%]{flex-basis:80%}.action.fh[_ngcontent-%COMP%]   .element-actions[_ngcontent-%COMP%]   .action-box-fh-subactions-container[_ngcontent-%COMP%]   .action-box[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .element-actions[_ngcontent-%COMP%]   .action-box-fh-subactions-container[_ngcontent-%COMP%]   .action-box[_ngcontent-%COMP%]:after, .action.fh[_ngcontent-%COMP%]   .fh-extra-subactions[_ngcontent-%COMP%]   .action-box-fh-subactions-container[_ngcontent-%COMP%]   .action-box[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .fh-extra-subactions[_ngcontent-%COMP%]   .action-box-fh-subactions-container[_ngcontent-%COMP%]   .action-box[_ngcontent-%COMP%]:after{border-radius:1em}.action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;padding:.2em}.action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements.elements-half[_ngcontent-%COMP%]{width:2.5em;height:1.25em;margin-left:.3em}.action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]   .element-half-container[_ngcontent-%COMP%]{width:100%}.action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]   .element-half-container[_ngcontent-%COMP%]   .element-half[_ngcontent-%COMP%]{top:initial;height:100%}.action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]{margin-left:-.2em}.action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%]{padding:0}.action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]   .condition-subactions[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]   .monster-type-subactions[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]   .custom-subactions[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]   .grant-subactions[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]   .special-target-subactions[_ngcontent-%COMP%]{margin-left:.1em}.action.fh[_ngcontent-%COMP%]   .action-element-consume[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;z-index:1;border:.04em dashed var(--ghs-color-white);border-radius:2em/100%}.action.fh[_ngcontent-%COMP%]   .action-element-consume[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:-.04em;left:-.02em;height:100%;width:100%;background-color:var(--ghs-color-white);opacity:.2;border:.04em solid var(--ghs-color-white);border-radius:2em/100%;z-index:-1}.action.fh.inline[_ngcontent-%COMP%]{width:100%}.action.fh.inline[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%]:before{background-color:var(--ghs-color-darkgray);opacity:.3}.action.fh.inline[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%]{justify-content:center;align-self:center}']})}return a})();const pa=/\%((\w+|\s|\.|\-|\:|\,|\+|\(|\)|\||\_|\[|\]|\||\{|\}|\$|\\|\/|\%U+200B)+)\%/,te=function(a,r=[],n=!1,i=!1){const e=!i&&p.f.settings.fhStyle||"fh"==i;for(;a.match(pa);)a=a.replace(pa,(o,...g)=>{let m=g[0],k="";m.includes(":")&&(k=m.split(":")[1],m=m.split(":")[0]);let X=m.split(".");!k&&g[0].includes(":")&&(k=X[X.length-1]),k||(k="");const at=X[0],tt=X[1];let J=o,et="";if("condition"==tt||"immunity"==tt){let ot=new Q.kW(X[2]);et='<span class="condition-icon'+("immunity"==tt?" immunity":"")+'">',et+='<img  src="./assets/images/'+(e?"fh/":"")+"condition/"+ot.name+'.svg" class="icon">',!k&&ot.types.includes(Q.GV.upgrade)&&(k="X"),k&&(et+='<span class="value">'+k+"</span>"),et+="</span>",J='<span class="placeholder-condition'+(e?" fh":"")+'">'+(e?"&#8203;":p.f.getLabel("game.condition."+ot.name,[k||""]))+et+"</span>"}else if("conditionIcon"==tt||"immunityIcon"==tt){let ot=new Q.kW(X[2]);et='<span class="condition-icon'+("immunityIcon"==tt?" immunity":"")+'">',et+='<img  src="./assets/images/'+(e?"fh/":"")+"condition/"+ot.name+'.svg" class="icon">',!k&&ot.types.includes(Q.GV.upgrade)&&(k="X"),k&&(et+='<span class="value">'+k+"</span>"),et+="</span>",J='<span class="placeholder-condition">&#8203;'+et+"</span>"}else if("action"!=tt||3!=X.length||X[2].startsWith("specialTarget")||X[2].startsWith("summon")||X[2].startsWith("area"))if("actionIcon"!=tt||3!=X.length||X[2].startsWith("specialTarget")||X[2].startsWith("summon")||X[2].startsWith("area"))if("element"==tt){let ot=X[2];"consume"==ot?(et='<span class="element inline consume">',ot=X[3]):et='<span class="element inline">',et+='<img src="./assets/images/'+(e?"fh/":"")+"element/"+ot+'.svg"></span>',J=et}else if("elementHalf"==tt){let ot=!1;X[2]&&X[2].startsWith("consume")&&(ot=!0);const lt=k.split("|");J='<span class="attack-modifier-effect placeholder-element-half element-half-placeholder'+(e?" fh":"")+'"><span class="element-half-container'+(ot?" consume":"")+'"><span class="element-half"><img src="./assets/images/'+(e?"fh/":"")+"element/"+lt[0]+'.svg"></span><span class="element-half"><img src="./assets/images/'+(e?"fh/":"")+"element/"+lt[1]+'.svg"></span></span></span>'}else if("action"==tt&&X[2].startsWith("area"))J='<span class="placeholder-area">',"areaRotated"==X[2]&&(J='<span class="placeholder-area" style="transform:rotate(-90deg);">'),k.split("|").forEach(ot=>{const lt=(0,K.dy)(ot);null!=lt&&(J+='<span class="hex" style="grid-column-start : '+(2*lt.x+1+lt.y%2)+";grid-column-end:"+(2*lt.x+3+lt.y%2)+";grid-row-start:"+(lt.y+1)+";grid-row-end:"+(lt.y+1)+'"><img src="./assets/images/action/hex/'+lt.type+'.svg"></span>')}),J+="</span>";else if("initiative"==tt&&3==X.length)et='<img class="ghs-svg" src="./assets/images/initiative.svg"></span>',J='<span class="placeholder-initiative">'+X[2]+et+"</span>";else if("action"==tt&&4==X.length)et='<img  src="./assets/images/action/'+X[2]+"/"+X[3]+'.svg" class="icon ghs-svg">',J='<span class="placeholder-perk">'+et+k+"</span>";else if("game"==at&&"items"==tt&&4==X.length)et='<img  src="./assets/images/items/'+X[2]+"/"+X[3]+'.svg" class="icon ghs-svg">',J='<span class="placeholder-item-slot">'+et+k+"</span>";else if("game"==at&&"itemFh"==tt&&3==X.length)if("random"==X[2])J='<span class="placeholder-item-fh"><span class="value"><img src="./assets/images/fh/loot/random_item.svg"></span></span>';else{const ot=+X[2];J='<span class="placeholder-item-fh"><span class="value">'+(ot<100?"0":"")+(ot<10?"0":"")+ot+"</span></span>"}else if("card"==tt&&3==X.length){let ot=X[2],lt="";k&&(lt='<span class="card-value">'+k+"</span>"),et='<img class="icon ghs-svg" src="./assets/images/action/card/'+ot+'.svg">',J='<span class="placeholder-effect placeholder-card">'+et+'<img class="card-overlay" src="./assets/images/action/card/overlay/'+ot+'.svg">'+lt+"</span>"}else if("attackmodifier"==tt&&3==X.length&&"rolling"!=X[2])et='<img  src="./assets/images'+(e?"/fh":"")+"/attackmodifier/icons/"+X[2]+'.png" class="icon">',J='<span class="placeholder-attackmodifier">'+et+"</span>";else if("attackmodifier"==tt&&3==X.length&&"rolling"==X[2])et='<img  src="./assets/images/attackmodifier/rolling.svg" class="icon">',J='<span class="condition-icon">'+et+"</span>";else if("townGuardAM"==tt&&k){J='<span class="placeholder-townguard-attackmodifier">'+k+"</span>";const ot=[...w.IK,...w.qq].find(lt=>lt.id==k);if(ot){const lt=ot.effects.find(Mn=>"custom"==Mn.type&&Mn.icon);let Ct='<span class="townguard-attackmodifier"><img src="./assets/images/fh/attackmodifier/icons/'+ot.valueType+'.png" class="icon"><span class="value">'+(ot.value>=0?"+":"")+ot.value+"</span></span>";(ot.type==w.Yn.wreck||ot.type==w.Yn.success)&&(Ct='<span class="townguard-attackmodifier"><img src="./assets/images/fh/attackmodifier/icons/'+ot.type+'.png" class="icon"></span>'),J='<span class="placeholder-townguard-attackmodifier">'+(null!=lt?'<img  src="./assets/images/action/custom/'+lt.value+'.svg" class="icon">':"")+Ct+(ot.rolling?'<img  src="./assets/images/attackmodifier/rolling.svg" class="icon">':"")+"</span>"}}else if("customAction"==tt&&k)J='<span class="placeholder-custom-action"><img  src="./assets/images/action/custom/'+k+'.svg" class="icon ghs-svg"></span>';else if("experience"==tt)et='<img  src="./assets/images/experience.svg" class="icon ghs-svg">',J='<span class="placeholder-experience">'+et+(k?'<span class="value">'+k+"</span>":"")+"</span>";else if("characterIcon"==tt&&3==X.length)et='<img class="icon" src="'+s.E.characterManager.characterIcon(X[2])+'">',J='<span class="placeholder-character-icon">'+et+"</span>";else if("characterIconColored"==tt&&3==X.length)et='<img class="icon" src="'+s.E.characterManager.characterIcon(X[2])+'">',J='<span class="placeholder-character-icon-colored">'+et+"</span>";else if("characterIconColoredBg"==tt&&3==X.length){const ot=X[2];et='<img class="icon" src="'+s.E.characterManager.characterIcon(ot)+'">',J='<span class="placeholder-character-icon-colored-bg" style="background-color:'+s.E.characterManager.characterColor(ot)+'">'+et+"</span>"}else if("characterIconIdentity"==tt&&4==X.length)et='<img class="icon" src="'+s.E.characterManager.characterIdentityIcon(X[2],+X[3])+'">',J='<span class="placeholder-character-icon">'+et+"</span>";else if("characterIconIdentityColored"==tt&&4==X.length)et='<img class="icon" src="'+s.E.characterManager.characterIdentityIcon(X[2],+X[3])+'">',J='<span class="placeholder-character-icon-colored">'+et+"</span>";else if("characterIconIdentityColoredBg"==tt&&4==X.length){const ot=X[2];et='<img class="icon" src="'+s.E.characterManager.characterIdentityIcon(ot,+X[3])+'">',J='<span class="placeholder-character-icon-colored-bg" style="background-color:'+s.E.characterManager.characterColor(ot)+'">'+et+"</span>"}else if("characterToken"==tt&&X.length>=3){const ot=X[2];let lt=s.E.characterManager.characterIcon(ot),St=!1;X.length>3&&(lt="./assets/images/character/token/"+ot+"-"+X[3]+".svg",St=!0),et='<img src="'+lt+'">',J='<span class="placeholder-character-token'+(St?" additional":"")+'" style="--ghs-character-color:'+s.E.characterManager.characterColor(ot)+'">'+et+"</span>"}else if("coloredToken"==tt&&X.length>3)et='<img src="./assets/images/character/custom/'+X[3]+'.svg">',J='<span class="placeholder-character-token" style="--ghs-character-color:#'+X[2]+'">'+et+"</span>";else if("characterColored"==tt)J='<span style="color: '+s.E.characterManager.characterColor(X[2])+';">'+k+"</span>";else if("monsterType"==tt&&3==X.length){const ot=X[2];J='<span class="placeholder-monster-type '+ot+'">'+p.f.getLabel("game.monster."+ot)+"</span>"}else if("monsterType"==tt&&4==X.length)J='<span class="placeholder-monster-type '+X[2]+'">'+X[3]+"</span>";else if("mapMarker"==tt&&3==X.length)"element"==X[2]?(et='<img src="./assets/images/element/'+k+'.svg">',J='<span class="placeholder-element">'+et+"</span>"):J='<span class="map-marker">'+X[2]+"</span>";else if("objectiveMarker"==tt&&3==X.length)J='<span class="objective-marker">'+X[2]+"</span>";else if("scenarioNumber"==tt)J='<span class="scenario-number">'+k+"</span>";else if(e&&"target"==tt&&2==X.length)et='<img  src="./assets/images/fh/action/target.svg" class="icon ghs-svg">',J='<span class="placeholder-action">'+et+"</span>";else if(e||"damage"!=tt)if(e&&"damage"==tt)et='<img  src="./assets/images/fh/action/damage.svg" class="icon ghs-svg">',J='<span class="damage">&#8203;'+et+k+"</span>";else if("loot"==tt&&4==X.length)et='<img  src="./assets/images/'+X[3]+'-player.svg" class="icon">',J='<span class="placeholder-player">'+et+"</span>";else if("resource"==tt&&3==X.length)et='<img  src="./assets/images/fh/loot/'+X[2]+'.svg" class="icon ghs-svg">',J='<span class="placeholder-resource">'+et+"</span>";else if("section"==tt&&k)et='<img src="./assets/images/fh/party/section.svg" class="icon ghs-svg">',J='<span class="placeholder-section">'+et+k+"</span>";else if("gh2eFaction"==tt&&k)et='<img src="./assets/images/gh2e/faction/'+k+'.svg" class="icon ghs-svg">',J='<span class="placeholder-faction">'+et+"</span>";else if("checkmark"==tt)J='<span class="placeholder-checkmark"><img src="./assets/images/check.svg" class="icon ghs-svg"></span>';else if("prosperity"==tt)J='<span class="placeholder-prosperity"><img src="./assets/images/gh2e/prosperity.svg" class="icon ghs-svg"></span>';else if("itemSlot"==tt&&k)J='<span class="placeholder-items-slot"><img src="./assets/images/items/slots/'+k+'.svg" class="icon ghs-svg"></span>';else if("bbAm"==tt&&3==X.length)J='<span class="placeholder-bb-am"><img src="./assets/images/bb/attackmodifier/'+X[2]+'.svg" class="icon ghs-svg"></span>';else if("townGuardAm"==tt&&3==X.length&&k){const ot=X[2];let lt="";ot==w.tW.plus?lt="+":ot==w.tW.minus?lt="-":ot==w.tW.multiply&&(lt="x"),J='<span class="placeholder-town-guard-am '+X[2]+'">'+lt+k+"</span>"}else if("fhIcon"==tt&&k)et='<img src="./assets/images/fh/icons/'+k+'.svg" class="icon ghs-svg">',J='<span class="placeholder-fh-icon">'+et+"</span>";else if("gameIcon"==tt&&k)et='<img src="./assets/images/'+k+'.svg" class="icon ghs-svg">',J='<span class="placeholder-game-icon">'+et+"</span>";else if("trait"==tt)et='<img src="./assets/images/fh/character/traits/trait.svg" class="icon ghs-svg">',J='<span class="placeholder-trait">'+et+(k?p.f.getLabel("data.character.traits."+k):"")+"</span>";else if("checkbox"==tt)J='<span class="placeholder-checkbox"></span>';else if("eventCard"==tt&&k)J='<span class="placeholder-action"><img src="./assets/images/eventcards/'+k+'.svg" class="icon ghs-svg"></span>';else if("eventCheckbox"==tt&&k)J='<span class="event-checkbox">'+k+"</span>";else if("valueSign"==tt&&k)J='<span class="value-sign">'+(+k>-1?"+":"")+k+"</span>";else if("enhancement"==tt&&3==X.length)et=e&&"any"!==X[2]?'<img class="enhancement-icon" src="./assets/images/fh/character/abilities/enhancements/'+X[2]+'.svg">':'<img class="enhancement-icon" src="./assets/images/character/abilities/enhancements/circle.svg">',J='<span class="placeholder-enhancement">'+et+"</span>";else{let ot=m.split(":").splice(1).map(lt=>te(p.f.getLabel(lt),r,n));k&&(ot=[k,...ot]),ot.push(...r),J=p.f.getLabel(m.split(":")[0],ot)+et}else J='<span class="damage">'+p.f.getLabel("game.damage",[k])+"</span>";else{X.splice(0,1);const ot=mi.includes(X[X.length-1]);et='<img  src="./assets/images/'+(e?"fh/action/":"action/")+X[X.length-1]+'.svg" class="icon'+(ot?" ghs-svg":"")+'">',J='&#8203;<span class="placeholder-action">&#8203;'+et+k+"</span>"}else{X.splice(0,1);const ot=mi.includes(X[X.length-1]);et='<img  src="./assets/images/'+(e?"fh/":"")+X.join("/")+'.svg" class="icon'+(ot?" ghs-svg":"")+'">',J='&#8203;<span class="placeholder-action">'+(e?"&#8203;":p.f.getLabel(m))+et+k+"</span>"}return J});return yg(a,n)},yg=function(a,r){for(;a.match(A.OD);)a=a.replace(A.OD,(n,...i)=>{if(p.f.settings.calculate&&!r)return""+(0,A.hZ)(n);{let e=i[2],o=[];const g=e&&e.startsWith("$");return g&&(e=e.replace("$",""),e.includes(":")&&(o=[e.split(":")[1]],e=e.split(":")[0])),g?i[0]+" "+p.f.getLabel("game.custom."+e,o):i[0]}});for(;a.match(A.LK);)a=a.replace(A.LK,(n,...i)=>{let e=i[2],o=[];const g=e&&e.startsWith("$");return g&&(e=e.replace("$",""),e.includes(":")&&(o=[e.split(":")[1]],e=e.split(":")[0])),g?i[0]+" "+p.f.getLabel("game.custom."+e,o):i[0]});return a};let it=(()=>{class a{el;ghsManager;value;args=[];argLabel=!0;empty=!0;attribute="";slice=[];relative=!1;style=!1;C;L;locale;calc=!1;fhStyle=!1;ready=!1;valueChange="";constructor(n,i){this.el=n,this.ghsManager=i,n.nativeElement.classList.add("placeholder"),this.C=Math.max(2,s.E.characterManager.characterCount()),this.L=s.E.game.level,this.locale=p.f.settings.locale,this.calc=p.f.settings.calculate,this.fhStyle=p.f.settings.fhStyle}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{const n=Math.max(2,s.E.characterManager.characterCount());(!this.ready||this.locale!=p.f.settings.locale||this.C!=n||this.L!=s.E.game.level||this.fhStyle!=p.f.settings.fhStyle||this.calc!=p.f.settings.calculate||this.valueChange!=this.value)&&(this.C=n,this.L=s.E.game.level,this.locale=p.f.settings.locale,this.calc=p.f.settings.calculate,this.fhStyle=p.f.settings.fhStyle,this.valueChange=this.value,this.ready=s.E.stateManager.ready,this.apply())}}),this.apply()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}ngOnChanges(n){(n.args&&JSON.stringify(n.args.previousValue)!=JSON.stringify(n.args.currentValue)||n.value&&n.value.previousValue!=n.value.currentValue||n.style&&n.style.previousValue!=n.style.currentValue)&&this.apply()}apply(){let n=this.args.map(e=>""+e)||[];this.argLabel&&(n=n.map(e=>te(p.f.getLabel(e,[],!1,this.empty),[],this.relative,this.style)));let i="number"==typeof this.value?this.value:this.value&&te(p.f.getLabel(this.value,n,!1,this.empty),n,this.relative,this.style)||"";"string"==typeof i&&1==this.slice.length?i=i.slice(this.slice[0]):"string"==typeof i&&2==this.slice.length&&(i=i.slice(this.slice[0],this.slice[1])),this.attribute?this.el.nativeElement.setAttribute(this.attribute,i):this.el.nativeElement.innerHTML=i}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT),t.rXU(st))};static \u0275dir=t.FsC({type:a,selectors:[["","ghs-label",""]],inputs:{value:[0,"ghs-label","value"],args:[0,"ghs-label-args","args"],argLabel:[0,"ghs-label-args-replace","argLabel"],empty:[0,"ghs-label-empty","empty"],attribute:[0,"ghs-label-attribute","attribute"],slice:"slice",relative:"relative",style:"style"},standalone:!1,features:[t.OA$]})}return a})(),xg=(()=>{class a{el;value="";constructor(n){this.el=n,n.nativeElement.classList.add("placeholder")}ngOnInit(){this.value=this.el.nativeElement.textContent,this.apply()}ngOnChanges(n){this.apply()}apply(){const n=this.value&&te("%"+this.value+"%")||"";n&&(this.el.nativeElement.innerHTML=n)}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT))};static \u0275dir=t.FsC({type:a,selectors:[["","ghs-placeholder",""]],inputs:{value:[0,"ghs-placeholder","value"]},standalone:!1,features:[t.OA$]})}return a})(),Ft=(()=>{class a{autoBlur=!1;onKeyDown(n){if(p.f.settings.keyboardShortcuts&&("Enter"===n.key||" "===n.key)&&!n.shiftKey&&!n.altKey&&n.target instanceof HTMLElement){const i=n.target.getAttribute("disabled")||n.target.classList.contains("disabled")||n.target.parentElement&&(n.target.parentElement.getAttribute("disabled")||n.target.parentElement.classList.contains("disabled"));n.preventDefault(),n.stopPropagation(),i||(n.target.dispatchEvent(new Event("click",{bubbles:!0,cancelable:!0})),n.target.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0})),n.target.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0})),this.autoBlur&&n.target.blur())}}static \u0275fac=function(i){return new(i||a)};static \u0275dir=t.FsC({type:a,selectors:[["","tabclick",""]],hostAttrs:["tabindex","0","role","button"],hostBindings:function(i,e){1&i&&t.bIt("keydown",function(g){return e.onKeyDown(g)})},inputs:{autoBlur:"autoBlur"},standalone:!1})}return a})();const Eg=(a,r)=>({elite:a,boss:r}),wg=(a,r)=>({extended:a,small:r}),pi=(a,r)=>[a,r],Rg=(a,r,n,i)=>({disabled:a,existing:r,elite:n,boss:i}),jg=a=>({active:a});function Gg(a,r){if(1&a&&(t.j41(0,"div",2)(1,"div",11),t.nrm(2,"div",12),t.k0s()()),2&a){const n=t.XpG();t.R7$(2),t.xc7("background-image",n.monster.noThumbnail||!n.settingsManager.settings.artwork?"":"url("+n.gameManager.monsterManager.monsterThumbnail(n.monster)+")")}}function Tg(a,r){if(1&a&&t.nrm(0,"span",3),2&a){const n=t.XpG();t.Y8G("ghs-label",(n.monster.isAlly?"game.ally.addEntity.":"monster.addEntity.")+n.type)}}function Sg(a,r){if(1&a&&t.nrm(0,"span",5),2&a){const n=t.XpG();t.Y8G("ghs-label","monster.changeStandee")("ghs-label-args",t.l_i(2,pi,n.entity.type,n.entity.number))}}function Dg(a,r){if(1&a&&t.nrm(0,"span",5),2&a){const n=t.XpG();t.Y8G("ghs-label","monster.setStandees")("ghs-label-args",t.l_i(2,pi,n.type,n.entitiesLeft()))}}function $g(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",13),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.pickNumber(e))}),t.j41(1,"span",14),t.EFF(2),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.ziG(3,Rg,i.hasNumber(n)&&(!i.change||!i.entity),i.hasNumber(n),i.type==i.MonsterType.elite,i.type==i.MonsterType.boss)),t.R7$(),t.Y8G("ngClass",i.monster.bb?"bb-"+n:""),t.R7$(),t.JRh(n)}}function Ig(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",15),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.summon=!e.summon)}),t.nrm(1,"img",16),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(3,jg,n.summon)),t.R7$(),t.Y8G("src",t.VkB("./assets/images/summons/",n.monster.summonColor,".png"),t.B4B)}}function Ag(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",9)(1,"a",17),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleMonsterType())}),t.nrm(2,"span",5),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","monster.changeType")("ghs-label-args",t.l_i(2,pi,n.entity.type==n.MonsterType.normal?n.entity.type:n.MonsterType.elite,n.entity.type==n.MonsterType.normal?n.MonsterType.elite:n.MonsterType.normal))}}function Vg(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",10)(1,"a",17),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.close())}),t.nrm(2,"span",3),t.k0s()()}2&a&&(t.R7$(2),t.Y8G("ghs-label","monster.cancelNumberpicker"))}let ua=(()=>{class a{dialogRef;monster;type;max;range;summon=!1;MonsterType=S.N;entity;entities;automatic=!1;change=!1;settingsManager=p.f;timeout;gameManager=s.E;constructor(n,i){this.dialogRef=i,this.monster=n.monster,this.type=n.type,this.max=s.E.monsterManager.monsterStandeeMax(this.monster),this.range=n.range,this.entity=n.entity,this.entities=n.entities,this.automatic=n.automatic||!1,this.change=n.change||!1,this.entity||(this.entity=this.entities&&this.entities.find(e=>e.number<0)||void 0),this.entity&&(this.type=this.entity.type)}onKeyPress(n){if(p.f.settings.keyboardShortcuts)if(n.key in["0","1","2","3","4","5","6","7","8","9"]){if(this.timeout){clearTimeout(this.timeout),this.timeout=void 0;const i=+n.key+10,e=+n.key;i<=this.max?this.pickNumber(i):(this.pickNumber(1),this.pickNumber(e))}else"1"===n.key&&this.range.filter(i=>i>10).some(i=>!this.hasNumber(i))?this.timeout=setTimeout(()=>{this.pickNumber(+n.key),this.timeout=void 0},1e3):this.pickNumber("0"===n.key&&this.max>9?10:+n.key);n.preventDefault(),n.stopPropagation()}else"s"!==n.key||this.entity?"t"===n.key&&(this.entity&&this.toggleMonsterType(),this.type==S.N.normal?this.type=S.N.elite:this.type==S.N.elite&&(this.type=S.N.normal)):this.summon=!this.summon}ngOnInit(){this.range=Array.from(Array(this.max).keys()).map(n=>n+1)}hasEntity(){return this.monster.entities.filter(n=>s.E.entityManager.isAlive(n)&&(!p.f.settings.hideStats||n.type==this.type)).length>0}hasNumber(n){return null!=s.E.monsterManager.monsterStandeeUsed(this.monster,n)}entitiesLeft(){return this.entities&&this.entities.filter(n=>n.type==this.type&&n.number<1).length||0}randomStandee(){const n=s.E.monsterManager.monsterStandeeMax(this.monster);let i=Math.floor(Math.random()*n)+1;for(;this.monster.entities.some(e=>e.number==i);)i=Math.floor(Math.random()*n)+1;this.pickNumber(i,!0,!1)}nextStandee(){let n=1;for(;this.monster.entities.some(i=>i.number==n);)n+=1;this.pickNumber(n,!0,!0)}pickNumber(n,i=!1,e=!1){if(!(n<1||n>this.max)){if(this.hasNumber(n)||!this.type||this.change){if(this.change&&this.entity&&this.entity.number!=n){s.E.stateManager.before("updateStandee","data.monster."+this.monster.name,"monster."+this.entity.type,""+this.entity.number,""+n);let o=s.E.monsterManager.monsterStandeeUsed(this.monster,n);if(o){let g=-1;for(;s.E.monsterManager.monsterStandeeUsed(this.monster,g);)g-=1;o.number=g}this.entity.number=n,s.E.stateManager.after()}}else{let o="addStandee";i&&!e?o="addRandomStandee":i&&(o="addNextStandee"),s.E.stateManager.before(o,"data.monster."+this.monster.name,"monster."+this.type,""+n);const g=this.monster.entities.find(m=>m.number==n);if(g&&s.E.monsterManager.removeMonsterEntity(this.monster,g),this.entity)this.entity.number=n,this.entity.revealed&&(this.entity.revealed=!1),this.entity=this.entities&&(this.entities.find(m=>m.number<0&&m.type==this.type)||this.entities.find(m=>m.number<0))||void 0,this.entity&&(this.type=this.entity.type);else{const m=s.E.monsterManager.addMonsterEntity(this.monster,n,this.type,this.summon);s.E.game.state==D.mk.next&&m&&(this.monster.active=!s.E.game.figures.some(k=>k.active),this.monster.active&&(s.E.sortFigures(this.monster),m.active=!0))}s.E.stateManager.after(),(this.entities?this.monster.entities.filter(m=>m.number>0).length:s.E.entityManager.entities(this.monster).length)==s.E.monsterManager.monsterStandeeMax(this.monster)||!this.entity&&this.entities?(0,F.co)(this.dialogRef):this.entity&&this.entities&&this.monster.entities.filter(m=>m.number>0).length==s.E.monsterManager.monsterStandeeMax(this.monster)-1&&this.nextStandee()}this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0)}}toggleMonsterType(){if(this.entity&&(this.entity.type==S.N.normal||this.entity.type==S.N.elite)){const n=s.E.monsterManager.getStat(this.monster,S.N.normal),i=s.E.monsterManager.getStat(this.monster,S.N.elite);n&&i?(s.E.stateManager.before("changeMonsterType","data.monster."+this.monster.name,"monster."+this.entity.type,""+this.entity.number,this.entity.type==S.N.normal?S.N.elite:S.N.normal),this.entity.type=this.entity.type==S.N.normal?S.N.elite:S.N.normal,this.entity.maxHealth=(0,A.hZ)(this.entity.type==S.N.normal?n.health:i.health,this.monster.level),(this.entity.health>this.entity.maxHealth||this.entity.health<this.entity.maxHealth&&this.entity.health==(0,A.hZ)(this.entity.type==S.N.normal?i.health:n.health,this.monster.level))&&(this.entity.health=this.entity.maxHealth),this.monster.bb&&(this.monster.entities.every(e=>e.type==S.N.elite)?this.monster.tags.includes("bb-elite")||this.monster.tags.push("bb-elite"):this.monster.tags.includes("bb-elite")&&(this.monster.tags=this.monster.tags.filter(e=>"bb-elite"!=e))),s.E.stateManager.after()):console.warn("Missing stats!",this.monster)}}close(){(0,F.co)(this.dialogRef,!0)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-monster-numberpicker-dialog"]],hostBindings:function(i,e){1&i&&t.bIt("keydown",function(g){return e.onKeyPress(g)},t.EBC)},standalone:!1,decls:14,vars:16,consts:[[1,"title"],[1,"monster"],[1,"standee"],[3,"ghs-label"],[3,"ngClass"],[3,"ghs-label","ghs-label-args"],[1,"number-container",3,"ngClass"],["tabclick","",1,"number-button",3,"ngClass"],["tabclick","",1,"summon-button",3,"ngClass"],[1,"change-type"],[1,"cancel"],[1,"background-image-container"],[1,"background-image"],["tabclick","",1,"number-button",3,"click","ngClass"],[1,"number",3,"ngClass"],["tabclick","",1,"summon-button",3,"click","ngClass"],[1,"summon",3,"src"],["tabclick","",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"span",1),t.nVh(2,Gg,3,2,"div",2),t.nrm(3,"span",3),t.k0s(),t.j41(4,"span",4),t.nVh(5,Tg,1,1,"span",3),t.nVh(6,Sg,1,5,"span",5),t.nVh(7,Dg,1,5,"span",5),t.k0s()(),t.j41(8,"div",6),t.Z7z(9,$g,3,8,"div",7,t.fX1),t.nVh(11,Ig,2,5,"div",8),t.k0s(),t.nVh(12,Ag,3,5,"div",9),t.nVh(13,Vg,3,1,"div",10)),2&i&&(t.R7$(2),t.vxM(e.automatic?2:-1),t.R7$(),t.Y8G("ghs-label","data.monster."+e.monster.name),t.R7$(),t.Y8G("ngClass",t.l_i(10,Eg,e.type==e.MonsterType.elite,e.type==e.MonsterType.boss)),t.R7$(),t.vxM(e.change&&e.entity||e.entities&&0!=e.entities.length?-1:5),t.R7$(),t.vxM(e.change&&e.entity?6:-1),t.R7$(),t.vxM(e.entities&&e.entities.length>0?7:-1),t.R7$(),t.Y8G("ngClass",t.l_i(13,wg,4==e.max,(e.automatic||e.change||e.entities&&e.entities.length>0)&&e.max>4&&e.max<10)),t.R7$(),t.Dyx(e.range),t.R7$(2),t.vxM(e.change||e.automatic||e.entities&&0!=e.entities.length||e.monster.bb?-1:11),t.R7$(),t.vxM(e.change&&e.entity&&e.entity.type!=e.MonsterType.boss?12:-1),t.R7$(),t.vxM(e.automatic?13:-1))},dependencies:[N.YU,it,Ft],styles:[".title[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.title[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.title[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]{position:relative;display:flex;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 7.8 * var(--ghs-text-factor))}.title[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .background-image-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:25% 25% 5% 5%;border:solid calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) var(--ghs-color-gray);overflow:hidden;z-index:0}.title[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .background-image-container[_ngcontent-%COMP%]   .background-image[_ngcontent-%COMP%]{position:absolute;top:-8%;left:0;width:100%;height:150%;background-color:var(--ghs-color-darkgray);background-size:calc(var(--ghs-unit) * 9.5 * var(--ghs-text-factor)) AUTO;background-repeat:no-repeat;background-position:top center;filter:brightness(70%)}.title[_ngcontent-%COMP%]   .elite[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.title[_ngcontent-%COMP%]   .boss[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.number-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,auto);justify-items:center;align-items:center;gap:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.number-container.extended[_ngcontent-%COMP%]{grid-template-columns:repeat(5,auto)}.number-container.small[_ngcontent-%COMP%]{grid-template-columns:repeat(3,auto)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.number-container[_ngcontent-%COMP%]   .number-button.elite[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.number-container[_ngcontent-%COMP%]   .number-button.boss[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.number-container[_ngcontent-%COMP%]   .number-button.existing[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray)}.number-container[_ngcontent-%COMP%]   .number-button.disabled[_ngcontent-%COMP%]{pointer-events:none}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:not(.existing)   .number.bb-1[_ngcontent-%COMP%]{color:var(--ghs-color-bb-1)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:not(.existing)   .number.bb-2[_ngcontent-%COMP%]{color:var(--ghs-color-bb-2)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:not(.existing)   .number.bb-3[_ngcontent-%COMP%]{color:var(--ghs-color-bb-3)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:not(.existing)   .number.bb-4[_ngcontent-%COMP%]{color:var(--ghs-color-bb-4)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:not(.existing)   .number.bb-5[_ngcontent-%COMP%]{color:var(--ghs-color-bb-5)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:not(.existing)   .number.bb-6[_ngcontent-%COMP%]{color:var(--ghs-color-bb-6)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:not(.existing)   .number.bb-7[_ngcontent-%COMP%]{color:var(--ghs-color-bb-7)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:not(.existing)   .number.bb-8[_ngcontent-%COMP%]{color:var(--ghs-color-bb-8)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:not(.existing)   .number.bb-9[_ngcontent-%COMP%]{color:var(--ghs-color-bb-9)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:not(.existing)   .number.bb-10[_ngcontent-%COMP%]{color:var(--ghs-color-bb-10)}.number-container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.number-container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]   img.summon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.number-container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.number-container[_ngcontent-%COMP%]   .summon-button.active[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) / 5) var(--ghs-color-white) solid;border-radius:100%}.change-type[_ngcontent-%COMP%]{display:flex;justify-content:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.change-type[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}.change-type[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.cancel[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.cancel[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}.cancel[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}"]})}return a})();var ft=v(4933),pe=v(3018);class Ao{id;marker;name;health;escort;initiative;actions=[];allyDeck=!1;tags=[];initiativeShare;trackDamage=!1;constructor(r,n,i=!1,e=-1,o="",g=[],m=void 0){this.name=r,this.health=n,this.escort=i,this.id=e,this.marker=o,this.tags=g,this.initiative=m}}var Ue=v(2e3);let Fo=(()=>{class a{directives=[];active;behindActive;currentZoom=0;currentPinchZoom=!1;zoomDiff=-1;activePointers=new Map;constructor(){this.currentZoom=p.f.settings.zoom,window.addEventListener("pointerdown",n=>{if(this.activePointers.set(n.pointerId,n),p.f.settings.pinchZoom&&2===this.countActiveTouches()&&(this.zoomDiff=this.getTouchDistance(),this.currentPinchZoom=!0),n.isPrimary&&(this.active=this.find(n.target),this.active)){if(this.active.clickBehind&&(this.behindActive=this.find(this.active.elementRef.nativeElement.parentElement),!this.behindActive)){const i=document.elementsFromPoint(n.clientX,n.clientY);for(let e=0;e<i.length;e++){const o=i[e];if(o!=n.target&&(this.behindActive=this.directives.find(g=>o&&g.elementRef.nativeElement==o),this.behindActive))break}}this.behindActive&&this.active.clickBehind&&this.behindActive.pointerdown(n),this.active.pointerdown(n),this.active.isDragElement||(n.preventDefault(),n.stopPropagation())}}),window.addEventListener("pointermove",n=>{if(p.f.settings.pinchZoom&&this.activePointers.size>=2)return this.activePointers.set(n.pointerId,n),this.handlePinchZoom(),void(this.currentPinchZoom=!0);this.active&&n.isPrimary&&!this.active.isDragElement&&(this.active.pointermove(n),window.document.body.classList.add("dragging"),window.document.body.classList.add("no-pointer"),this.behindActive&&(this.behindActive.cancel(),this.behindActive=void 0))},{passive:!0}),window.addEventListener("pointerup",n=>{this.activePointers.delete(n.pointerId),this.active&&n.isPrimary&&(this.active.pointerup(n),this.active.isDragElement||(n.preventDefault(),n.stopPropagation()),this.active=void 0),this.behindActive&&n.isPrimary&&(this.behindActive.pointerup(n),this.behindActive=void 0),p.f.settings.pinchZoom&&this.activePointers.size<2&&this.zoomDiff>-1&&p.f.settings.zoom!=this.currentZoom&&(this.zoomDiff=-1,p.f.setZoom(this.currentZoom)),0===this.activePointers.size&&(this.currentPinchZoom=!1),window.document.body.classList.remove("dragging"),window.document.body.classList.remove("no-pointer")}),window.addEventListener("pointercancel",n=>{this.activePointers.delete(n.pointerId),this.active&&n.isPrimary&&(this.active.pointerup(n),this.behindActive&&(this.behindActive.pointerup(n),this.behindActive=void 0),!this.active.clickBehind&&!this.active.isDragElement&&(n.preventDefault(),n.stopPropagation()),this.active=void 0),window.document.body.classList.remove("dragging"),window.document.body.classList.remove("no-pointer")}),window.addEventListener("keydown",n=>{p.f.settings.keyboardShortcuts&&this.active&&"Shift"===n.key&&(this.active.fast=!0)}),window.addEventListener("keyup",n=>{p.f.settings.keyboardShortcuts&&this.active&&"Shift"===n.key&&(this.active.fast=!1)})}zoom(n){this.currentZoom+=n,document.body.style.setProperty("--ghs-factor",this.currentZoom+"");const i=+window.getComputedStyle(document.body).getPropertyValue("min-width").replace("px","");n<0&&i>=window.innerWidth&&(this.currentZoom-=n,document.body.style.setProperty("--ghs-factor",this.currentZoom+""))}countActiveTouches(){let n=0;return this.activePointers.forEach(i=>{"touch"===i.pointerType&&n++}),n}getTouchDistance(){const n=Array.from(this.activePointers.values()).filter(o=>"touch"===o.pointerType);if(n.length<2)return 0;const[i,e]=n;return Math.abs(i.clientX-e.clientX)}handlePinchZoom(){if(!p.f.settings.pinchZoom)return;const n=Array.from(this.activePointers.values()).filter(i=>"touch"===i.pointerType);if(2===n.length){const i=Math.abs(n[0].clientX-n[1].clientX);this.zoomDiff>0&&this.zoom(Math.ceil(.25*(this.zoomDiff-i))),this.zoomDiff=i}}cancel(){this.active&&(this.active.cancel(),this.active=void 0),this.behindActive&&(this.behindActive.cancel(),this.behindActive=void 0),window.document.body.classList.remove("dragging"),window.document.body.classList.remove("no-pointer")}register(n){this.directives.push(n)}unregister(n){this.directives.splice(this.directives.indexOf(n),1)}find(n){let i=n,e=this.directives.find(g=>i&&g.elementRef.nativeElement==i),o=0;for(;!e&&o<50&&i!==document.body&&i.parentElement;)i=i.parentElement,e=this.directives.find(g=>i&&g.elementRef.nativeElement==i),o++;return e}static \u0275fac=function(i){return new(i||a)};static \u0275prov=c.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})(),dt=(()=>{class a{elementRef;service;clickBehind=!1;relative=!1;screenWidth=!1;repeat=!1;disabled=!1;draggingDisabled=!1;forcePress=!1;forceDoubleClick=!1;onRelease=!1;fastShift=!1;dragMove=new t.bkB;dragEnd=new t.bkB;dragCancel=new t.bkB;singleClick=new t.bkB;doubleClick=new t.bkB;timeout=null;relativeValue=-1;value=-1;repeats=-1;down=!1;clicks=0;startX=0;startY=0;move=!1;fast=!1;fastOffset=0;lastX=0;isDragElement=!1;constructor(n,i){this.elementRef=n,this.service=i,this.value=-1,this.elementRef.nativeElement.style["touch-action"]="pan-y",this.isDragElement=n.nativeElement.hasAttribute("cdkdrag")||n.nativeElement.hasAttribute("cdkdraghandle")||n.nativeElement.classList.contains("cdk-drag")||n.nativeElement.classList.contains("cdk-drag-handle")||n.nativeElement.classList.contains("cdk-drag-preview")||n.nativeElement.classList.contains("cdk-drag-placeholder")}ngOnInit(){this.service.register(this)}ngOnDestroy(){this.service.unregister(this)}pointerdown(n){"mouse"===n.pointerType&&0!==n.button||(this.down=!0,this.startX=n.clientX,this.startY=n.clientY,this.move||!this.repeat||this.doubleClick.observed?(this.forcePress||p.f.settings.pressDoubleClick&&!this.forceDoubleClick&&this.doubleClick.observed&&!this.move&&"touch"===n.pointerType)&&(this.timeout=setTimeout(()=>{("mouse"===n.pointerType||!this.onRelease)&&this.doubleClick.emit(n),this.timeout=null,this.clicks=2},550)):(this.repeats=-1,this.repeatTimeout(n)))}pointermove(n){if(this.down){const e=n.clientY;!this.move&&Math.max(Math.abs(this.startX-n.clientX),Math.abs(this.startY-e))>7?this.panstart(n):this.move&&this.panmove(n)}}pointerup(n){this.down&&(this.down=!1,this.startX=0,this.startY=0,this.service.currentPinchZoom?(this.clicks=0,this.timeout&&(clearTimeout(this.timeout),this.timeout=null)):this.move?this.clicks=0:this.forcePress||"mouse"!==n.pointerType&&p.f.settings.pressDoubleClick&&!this.forceDoubleClick?"touch"===n.pointerType&&this.onRelease&&2==this.clicks?(this.doubleClick.emit(n),this.clicks=0):(this.clicks<2&&(!this.repeat||this.doubleClick.observed)&&this.singleClick.emit(n),this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.clicks=0):(this.clicks++,this.timeout&&(clearTimeout(this.timeout),this.timeout=null),2==this.clicks&&this.doubleClick.observed?(this.doubleClick.emit(n),this.clicks=0):this.timeout=setTimeout(()=>{this.clicks>0&&(!this.repeat||this.doubleClick.observed)&&this.singleClick.emit(n),this.clicks=0,this.timeout=null},this.doubleClick.observed?250:0)),this.panend(n))}panstart(n){!this.disabled&&!this.draggingDisabled&&p.f.settings.dragValues&&(this.dragMove.observed||this.dragEnd.observed)&&this.elementRef.nativeElement.classList.add("dragging"),this.move=!0,this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}panmove(n){if(!this.disabled&&!this.draggingDisabled&&p.f.settings.dragValues&&(this.dragMove.observed||this.dragEnd.observed)){const i=this.elementRef.nativeElement.getBoundingClientRect(),e=n.clientX;this.screenWidth?document.body.clientWidth>1200?this.value=Math.min(99,Math.max(0,e*(1200/document.body.clientWidth)/document.body.clientWidth*100)):(this.value=Math.min(99,Math.max(0,e/document.body.clientWidth*100)),this.relative&&(this.value=.4*this.value)):this.value=Math.min(99,Math.max(0,(e-i.left)/i.width*100)),this.relative&&-1==this.relativeValue&&(this.relativeValue=this.value),this.fast&&(this.fastOffset+=e-this.lastX<0?-1:1),this.value=Math.floor(this.relative?this.value-this.relativeValue:this.value)+this.fastOffset,this.lastX=e,this.dragMove.emit(this.value)}}panend(n){!this.disabled&&!this.draggingDisabled&&p.f.settings.dragValues&&(this.dragMove.observed||this.dragEnd.observed)&&(this.value>=0||this.relative)&&this.dragEnd.emit(this.value),this.reset()}cancel(){this.down=!1,this.clicks=0,this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.dragCancel.emit(this.value),this.reset()}reset(){this.repeats=-1,this.startX=-1,this.startY=-1,this.move=!1,this.value=-1,this.relativeValue=-1,this.fast=!1,this.fastOffset=0,this.elementRef.nativeElement.classList.remove("dragging")}repeatTimeout(n){this.down&&!this.move&&(this.singleClick.emit(n),-1==this.repeats?this.repeats=500:(this.repeats-=25,this.repeats<25&&(this.repeats=25)),this.timeout=setTimeout(()=>{this.repeatTimeout(n)},this.repeats))}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT),t.rXU(Fo))};static \u0275dir=t.FsC({type:a,selectors:[["ghs-pointer-input"],["","ghs-pointer-input",""]],inputs:{clickBehind:"clickBehind",relative:"relative",screenWidth:"screenWidth",repeat:"repeat",disabled:"disabled",draggingDisabled:"draggingDisabled",forcePress:"forcePress",forceDoubleClick:"forceDoubleClick",onRelease:"onRelease",fastShift:"fastShift"},outputs:{dragMove:"dragMove",dragEnd:"dragEnd",dragCancel:"dragCancel",singleClick:"singleClick",doubleClick:"doubleClick"},standalone:!1})}return a})();const zg=["ghs-setting-menu",""],fa=a=>({disabled:a}),ue=a=>({checked:a});function Lg(a,r){1&a&&t.nrm(0,"img",6)}function qg(a,r){if(1&a&&t.nrm(0,"div",5),2&a){const n=t.XpG(2);t.Y8G("ghs-label",n.additionalHint)}}function Hg(a,r){if(1&a&&(t.j41(0,"span",11),t.nrm(1,"input",12)(2,"span",5),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.Y8G("checked",!n.startsWith("!"))("ngClass",t.eq3(3,ue,!n.startsWith("!"))),t.R7$(),t.Y8G("ghs-label","settings."+n.replace("!",""))}}function Kg(a,r){if(1&a&&(t.j41(0,"div",9),t.nrm(1,"span",10),t.Z7z(2,Hg,3,5,"span",11,t.fX1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","settings.requires"),t.R7$(),t.Dyx(n.requires)}}function Wg(a,r){if(1&a&&(t.j41(0,"span",11),t.nrm(1,"input",12)(2,"span",5),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.Y8G("checked",!n.startsWith("!"))("ngClass",t.eq3(3,ue,!n.startsWith("!"))),t.R7$(),t.Y8G("ghs-label","settings."+n.replace("!",""))}}function Zg(a,r){if(1&a&&(t.j41(0,"div",9),t.nrm(1,"span",10),t.Z7z(2,Wg,3,5,"span",11,t.fX1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","settings.requiresOne"),t.R7$(),t.Dyx(n.requiresOne)}}function Jg(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",2)(1,"label",3)(2,"input",4),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.settingsManager.toggle(e.setting))}),t.k0s(),t.nrm(3,"span",5),t.k0s(),t.nVh(4,Lg,1,0,"img",6),t.j41(5,"span",7)(6,"div",8),t.nrm(7,"span",5)(8,"br"),t.nVh(9,qg,1,1,"div",5),t.nVh(10,Kg,4,1,"div",9),t.nVh(11,Zg,4,1,"div",9),t.k0s()()()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(8,fa,n.disabled||n.isDisabled)),t.R7$(),t.Y8G("checked",!n.disabled&&!n.isDisabled&&n.settingsManager.settings[n.setting]||n.checked),t.R7$(),t.Y8G("ghs-label","settings."+n.setting+(n.suffix?"."+n.suffix:"")),t.R7$(),t.vxM(n.hint?4:-1),t.R7$(3),t.Y8G("ghs-label","settings."+n.setting+(n.suffix?"."+n.suffix:"")+".hint"),t.R7$(2),t.vxM(n.additionalHint?9:-1),t.R7$(),t.vxM(n.requires.length?10:-1),t.R7$(),t.vxM(n.requiresOne.length?11:-1)}}function Qg(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",13)(1,"label",3)(2,"input",4),t.bIt("change",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.settingsManager.set(o.setting,e))}),t.k0s(),t.nrm(3,"span",5),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(3,fa,i.settingsManager.settings[i.setting]==n||i.disabled||i.isDisabled)),t.R7$(),t.Y8G("checked",i.settingsManager.settings[i.setting]==n),t.R7$(),t.Y8G("ghs-label","settings."+i.setting+(i.suffix?"."+i.suffix:"")+"."+n)}}function td(a,r){if(1&a&&t.Z7z(0,Qg,4,5,"div",13,t.fX1),2&a){const n=t.XpG();t.Dyx(n.values)}}function nd(a,r){1&a&&t.nrm(0,"img",16)}function ed(a,r){if(1&a&&t.nrm(0,"div",5),2&a){const n=t.XpG(2);t.Y8G("ghs-label",n.additionalHint)}}function ad(a,r){if(1&a&&(t.j41(0,"span",11),t.nrm(1,"span",5)(2,"span",17),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.Y8G("ghs-label","settings."+n.replace("!","")),t.R7$(),t.Y8G("ngClass",t.eq3(2,ue,!n.startsWith("!")))}}function id(a,r){if(1&a&&(t.j41(0,"div",9),t.nrm(1,"span",10),t.Z7z(2,ad,3,4,"span",11,t.fX1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","settings.requires"),t.R7$(),t.Dyx(n.requires)}}function od(a,r){if(1&a&&(t.j41(0,"span",11),t.nrm(1,"span",5)(2,"span",17),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.Y8G("ghs-label","settings."+n.replace("!","")),t.R7$(),t.Y8G("ngClass",t.eq3(2,ue,!n.startsWith("!")))}}function sd(a,r){if(1&a&&(t.j41(0,"div",9),t.nrm(1,"span",10),t.Z7z(2,od,3,4,"span",11,t.fX1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","settings.requiresOne"),t.R7$(),t.Dyx(n.requiresOne)}}function rd(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",2)(1,"label",14),t.nrm(2,"span",5),t.j41(3,"input",15,0),t.bIt("keyup",function(){return c.eBV(n),c.Njj(0)})("change",function(){c.eBV(n);const e=t.sdS(4),o=t.XpG();return c.Njj(o.settingsManager.set(o.setting,+e.value))}),t.k0s()(),t.nVh(5,nd,1,0,"img",16),t.j41(6,"div",7)(7,"div",8),t.nrm(8,"span",5)(9,"br"),t.nVh(10,ed,1,1,"div",5),t.nVh(11,id,4,1,"div",9),t.nVh(12,sd,4,1,"div",9),t.k0s()()()}if(2&a){const n=t.sdS(4),i=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(13,fa,i.disabled||i.isDisabled)),t.R7$(),t.Y8G("ghs-label","settings."+i.setting+(i.suffix?"."+i.suffix:"")),t.R7$(),t.Y8G("value",i.settingsManager.get(i.setting))("min",i.min)("max",i.max)("size",n.value.length)("ghs-label","settings."+i.setting+(i.suffix?"."+i.suffix:""))("ghs-label-attribute","placeholder"),t.R7$(2),t.vxM(i.hint?5:-1),t.R7$(3),t.Y8G("ghs-label","settings."+i.setting+(i.suffix?"."+i.suffix:"")+".hint"),t.R7$(2),t.vxM(i.additionalHint?10:-1),t.R7$(),t.vxM(i.requires.length?11:-1),t.R7$(),t.vxM(i.requiresOne.length?12:-1)}}function cd(a,r){if(1&a&&t.nrm(0,"div",5),2&a){const n=t.XpG(2);t.Y8G("ghs-label",n.additionalHint)}}function ld(a,r){if(1&a&&(t.j41(0,"span",11),t.nrm(1,"span",5)(2,"span",17),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.Y8G("ghs-label","settings."+n.replace("!","")),t.R7$(),t.Y8G("ngClass",t.eq3(2,ue,!n.startsWith("!")))}}function gd(a,r){if(1&a&&(t.j41(0,"div",9),t.nrm(1,"span",10),t.Z7z(2,ld,3,4,"span",11,t.fX1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","settings.requires"),t.R7$(),t.Dyx(n.requires)}}function dd(a,r){if(1&a&&(t.j41(0,"span",11),t.nrm(1,"span",5)(2,"span",17),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.Y8G("ghs-label","settings."+n.replace("!","")),t.R7$(),t.Y8G("ngClass",t.eq3(2,ue,!n.startsWith("!")))}}function hd(a,r){if(1&a&&(t.j41(0,"div",9),t.nrm(1,"span",10),t.Z7z(2,dd,3,4,"span",11,t.fX1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","settings.requiresOne"),t.R7$(),t.Dyx(n.requiresOne)}}function _d(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",2)(1,"label",3)(2,"span",18),t.bIt("doubleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.settingsManager.set(e.setting,e.default))}),t.k0s(),t.j41(3,"input",19,1),t.bIt("change",function(){c.eBV(n);const e=t.sdS(4),o=t.XpG();return c.Njj(o.settingsManager.set(o.setting,+e.value))})("input",function(){c.eBV(n);const e=t.sdS(4),o=t.XpG();return c.Njj(o.settingsManager.apply(o.setting,+e.value))}),t.k0s()(),t.nrm(5,"img",6),t.j41(6,"span",7)(7,"div",8),t.nrm(8,"span",5)(9,"br"),t.nVh(10,cd,1,1,"div",5),t.nVh(11,gd,4,1,"div",9),t.nVh(12,hd,4,1,"div",9),t.k0s()()()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(10,fa,n.disabled||n.isDisabled)),t.R7$(),t.Y8G("ghs-label","settings."+n.setting+(n.suffix?"."+n.suffix:"")),t.R7$(),t.Y8G("min",n.min)("step",n.step)("max",n.max)("value",n.settingsManager.get(n.setting)),t.R7$(5),t.Y8G("ghs-label","settings."+n.setting+(n.suffix?"."+n.suffix:"")+".hint"),t.R7$(2),t.vxM(n.additionalHint?10:-1),t.R7$(),t.vxM(n.requires.length?11:-1),t.R7$(),t.vxM(n.requiresOne.length?12:-1)}}const md=["ghs-setting-title-menu",""];function pd(a,r){1&a&&t.nrm(0,"img",2)}function ud(a,r){if(1&a&&(t.j41(0,"div",1),t.nVh(1,pd,1,0,"img",2),t.j41(2,"span",3),t.nrm(3,"span",4),t.k0s()()),2&a){const n=t.XpG();t.R7$(),t.vxM(n.settingsManager.settings.serverSettings?1:-1),t.R7$(2),t.Y8G("ghs-label","settings.synced")}}const Bo=':host{position:relative;z-index:9999}.hint-container .hint .text{white-space:break-spaces}.back{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back .ghs-svg{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back:hover .ghs-svg{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled{pointer-events:none}.back.disabled .ghs-svg{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container{z-index:1}.menu-container{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container .separator{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column .separator,.menu-container.two-column .span{grid-column:2 span}.menu-container .columns{display:flex}.menu-container .columns .column{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container .columns .column.no-grow{flex-grow:0}.menu-container .line{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container .line.hidden{display:none}.menu-container .line p{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container .line p a{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container .line .ghs-svg{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container .line button{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container .line .hint-container{width:100%}.menu-container .line .hint-container.inline{width:initial;margin-right:1em}.menu-container .line .input-container{flex-wrap:nowrap}.menu-container .line .input-container input,.menu-container .line .input-container select{flex-basis:0;flex-grow:1}.menu-container .line a,.menu-container .line label,.menu-container .line button{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container .line a:hover,.menu-container .line label:hover,.menu-container .line button:hover{color:var(--ghs-color-white)}.menu-container .line a img.icon,.menu-container .line label img.icon,.menu-container .line button img.icon{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container .line a img.icon.spoiler,.menu-container .line label img.icon.spoiler,.menu-container .line button img.icon.spoiler{filter:brightness(0) var(--ghs-filter-gray)}.menu-container .line a.disabled,.menu-container .line label.disabled,.menu-container .line button.disabled{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container .line a.disabled input,.menu-container .line label.disabled input,.menu-container .line button.disabled input{filter:grayscale(1)}.menu-container .line a.confirm,.menu-container .line label.confirm,.menu-container .line button.confirm{color:var(--ghs-color-yellow)}.menu-container .line a.confirm-delete,.menu-container .line label.confirm-delete,.menu-container .line button.confirm-delete{color:var(--ghs-color-red)}.menu-container .line a~input,.menu-container .line a~select,.menu-container .line label~input,.menu-container .line label~select,.menu-container .line button~input,.menu-container .line button~select{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container .line>a{text-decoration:none}.menu-container .line.state-container{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container .line.state-container .state{display:flex;flex-direction:column}.menu-container .line.state-container .state.undo{align-items:flex-start}.menu-container .line.state-container .state.undo .undo-text{display:flex;align-items:center}.menu-container .line.state-container .state.redo{align-items:flex-end}.menu-container .line.state-container .state .info{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container .line.state-container .state.disabled .info{color:var(--ghs-color-disabled)}.menu-container .line.state-container .warning{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container .line.state-container .warning img{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container .line.state-container .warning:hover{opacity:.7}.menu-container .line.state-container .undo-dialog{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container .line.state-container .undo-dialog img.ghs-svg{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container .line.state-container .undo-dialog:hover{cursor:pointer}.menu-container .line.state-container .undo-dialog:hover img.ghs-svg{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container .line.state-container .undo-dialog.disabled img.ghs-svg{filter:var(--ghs-filter-darkgray)!important}.menu-container .line.title{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container .line.title a,.menu-container .line.title label{cursor:initial;color:var(--ghs-color-disabled)}.menu-container .line.title.hide-title{border-bottom:none;margin-bottom:0}.menu-container .line.title.hide-title label{display:none}.menu-container .line.sticky{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container .line.sticky.fh{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container .line.sticky.modern{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container .disabled{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container .disabled a,.menu-container .disabled label,.menu-container .disabled input[type=checkbox],.menu-container .disabled input[type=radio]{color:var(--ghs-color-disabled)}.menu-container .disabled input[type=checkbox]:before,.menu-container .disabled input[type=radio]:before{background-color:var(--ghs-color-disabled)!important}.menu-container .denied a,.menu-container .denied label{color:var(--ghs-color-disabled)}.menu-container .objective-marker{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container .spoilers>.spoiler{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container .spoilers>.spoiler .add{display:none}.menu-container .spoilers>.spoiler:hover .name{display:none}.menu-container .spoilers>.spoiler:hover .add{display:inherit}.menu-container .spoilers>.spoiler~.spoiler{margin-top:0;border-top:none}.menu-container .input-button{display:flex;cursor:pointer}.menu-container .input-button .add-button:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container .input-button .add-button:hover:after{background-color:var(--ghs-color-white)}.menu-container .input-button .add-button.disabled{pointer-events:none;cursor:not-allowed}.menu-container .input-button .add-button.disabled:after{background-color:var(--ghs-color-disabled)}.menu-container select{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container select option{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column .span-xs{grid-column:2 span}.menu-container .columns.columns-break{flex-wrap:wrap}}\n',Yo="@media (max-width: 600px),(orientation: portrait){.menu-container.two-column{display:grid;grid-template-columns:auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column .separator,.menu-container.two-column .span{grid-column:1 span}}.line .condition-list{display:flex;align-items:center}.line .condition-list .hint-container{margin:calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.line .condition-list .hint-container .condition{cursor:pointer;width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));position:relative;display:flex}.line .condition-list .hint-container .condition.immunity{opacity:.7;filter:grayscale(.3)}.line .condition-list .hint-container .condition:hover{opacity:.6;filter:none}.line .condition-list .hint-container .condition img{width:100%;height:auto}.line .condition-list .hint-container .condition .value{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);position:absolute;bottom:0;left:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor));transform:translate(-50%)}.line .condition-list .hint-container .condition.disabled{filter:grayscale(.6);pointer-events:none}.line .condition-list .hint-container .hint-trigger{margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.line .condition-list .hint-container .hint.right{transform:translate(-50%)}.line.hidden{display:none}.menu-container .line .ghs-svg.sync-settings{height:2em;width:auto;filter:var(--ghs-filter-disabled) var(--ghs-filter-outline-thin-black)}.menu-container.connected .line .ghs-svg.sync-settings{filter:var(--ghs-filter-green) var(--ghs-filter-outline-thin-black)}\n";let fe=(()=>{class a{elementRef;ghsManager;setting;checked=!1;disabled=!1;requires=[];requiresOne=[];type="checkbox";values=[];min="";max="";step=.1;default=1;hint=!0;additionalHint="";suffix="";isDisabled=!1;settingsManager=p.f;constructor(n,i){this.elementRef=n,this.ghsManager=i}ngOnInit(){"checkbox"===this.type&&this.values.length>0&&(this.type="radio"),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.isDisabled=this.requires.length>0&&this.requires.some(n=>n.startsWith("!")?p.f.get(n.replace("!","")):!p.f.get(n))||this.requiresOne.length>0&&this.requiresOne.every(n=>n.startsWith("!")?p.f.get(n.replace("!","")):!p.f.get(n))}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["","ghs-setting-menu",""]],inputs:{setting:[0,"ghs-setting-menu","setting"],checked:"checked",disabled:"disabled",requires:"requires",requiresOne:"requiresOne",type:"type",values:"values",min:"min",max:"max",step:"step",default:"default",hint:"hint",additionalHint:"additionalHint",suffix:[0,"labelSuffix","suffix"]},standalone:!1,attrs:zg,decls:4,vars:4,consts:[["numberInput",""],["rangeInput",""],[1,"hint-container"],[3,"ngClass"],["tabclick","","type","checkbox",3,"change","checked"],[3,"ghs-label"],["src","./assets/images/hint.svg",1,"hint-trigger","ghs-svg"],[1,"hint"],[1,"text"],[1,"requires"],[1,"title",3,"ghs-label"],[1,"require"],["type","checkbox",3,"checked","ngClass"],[1,"line"],[1,"label",3,"ngClass"],["tabclick","","type","number",3,"keyup","change","value","min","max","size","ghs-label","ghs-label-attribute"],["src","./assets/images/warning.svg",1,"hint-trigger","ghs-svg"],[1,"checkbox",3,"ngClass"],["ghs-pointer-input","",3,"doubleClick","ghs-label"],["tabclick","","type","range",3,"change","input","min","step","max","value"]],template:function(i,e){1&i&&(t.nVh(0,Jg,12,10,"div",2),t.nVh(1,td,2,0),t.nVh(2,rd,13,15,"div",2),t.nVh(3,_d,13,12,"div",2)),2&i&&(t.vxM("checkbox"==e.type?0:-1),t.R7$(),t.vxM("radio"==e.type?1:-1),t.R7$(),t.vxM("number"==e.type?2:-1),t.R7$(),t.vxM("range"==e.type?3:-1))},dependencies:[N.YU,it,dt,Ft],styles:[Bo,Yo,".hint-container label{cursor:pointer;display:flex;align-items:center}.hint-container .requires{font-family:var(--ghs-normal);font-size:.9em;display:flex;flex-direction:column;margin-top:1em}.hint-container .requires .title{margin-bottom:.3em}.hint-container .requires .require{display:flex;align-items:center}.hint-container .requires .require input[type=checkbox]{width:1.5em;height:1.5em;border-width:.1em;border-style:solid;display:grid;place-content:center;margin-right:.5em}\n"],encapsulation:2})}return a})(),fd=(()=>{class a{settingsManager=p.f;setting;sync=!1;static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["","ghs-setting-title-menu",""]],inputs:{setting:[0,"ghs-setting-title-menu","setting"],sync:"sync"},standalone:!1,attrs:md,decls:3,vars:2,consts:[[3,"ghs-label"],[1,"hint-container"],["src","./assets/images/sync-settings.svg",1,"hint-trigger","ghs-svg","sync-settings"],[1,"hint"],[1,"text",3,"ghs-label"]],template:function(i,e){1&i&&(t.j41(0,"label"),t.nrm(1,"span",0),t.k0s(),t.nVh(2,ud,4,2,"div",1)),2&i&&(t.R7$(),t.Y8G("ghs-label","settings."+e.setting),t.R7$(),t.vxM(e.sync?2:-1))},dependencies:[it],styles:[Bo,Yo],encapsulation:2})}return a})();const Cd=a=>({active:a}),Md=a=>({disabled:a});function vd(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",3),t.nrm(1,"p",2),t.j41(2,"div",6)(3,"a",7),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.ignoreError())}),t.nrm(4,"span",2),t.k0s(),t.nrm(5,"div",8),t.k0s()()}2&a&&(t.R7$(),t.Y8G("ghs-label","tools.feedback.reportIssue.errorHint"),t.R7$(3),t.Y8G("ghs-label","tools.feedback.reportIssue.errorIgnore"))}function Od(a,r){if(1&a&&(t.j41(0,"option",10),t.nrm(1,"span",2),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n),t.R7$(),t.Y8G("ghs-label","tools.feedback.reportIssue.type."+n)}}function Pd(a,r){if(1&a){const n=t.RV6();t.j41(0,"textarea",17),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2);return t.DH7(o.automaticText,e)||(o.automaticText=e),c.Njj(e)}),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("disabled",!0),t.R50("ngModel",n.automaticText)}}function bd(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",4)(1,"label"),t.nrm(2,"span",2),t.k0s(),t.j41(3,"select",9),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.issueType,e)||(o.issueType=e),c.Njj(e)}),t.Z7z(4,Od,2,2,"option",10,t.fX1),t.k0s(),t.nrm(6,"p",11)(7,"p",11)(8,"label",2),t.j41(9,"textarea",9),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.issuerText,e)||(o.issuerText=e),c.Njj(e)}),t.k0s(),t.j41(10,"p",3),t.EFF(11,"Please write in English or German / Bitte in Englisch oder Deutsch verfassen!"),t.k0s(),t.nrm(12,"label",2),t.nVh(13,Pd,1,2,"textarea",12),t.j41(14,"div",13)(15,"a",14),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.downloadDataDump())}),t.nrm(16,"span",2),t.k0s(),t.j41(17,"a",15),t.nrm(18,"span",2),t.k0s()(),t.nrm(19,"p",16),t.k0s()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","tools.feedback.reportIssue.type"),t.R7$(),t.R50("ngModel",n.issueType),t.R7$(),t.Dyx(n.issueTypes),t.R7$(2),t.Y8G("ghs-label","tools.feedback.reportIssue.type."+n.issueType+".hint"),t.R7$(),t.Y8G("ghs-label","tools.feedback.reportIssue.specify"),t.R7$(),t.Y8G("ghs-label","tools.feedback.reportIssue.text"),t.R7$(),t.R50("ngModel",n.issuerText),t.R7$(3),t.Y8G("ghs-label","tools.feedback.reportIssue.automaticText"),t.R7$(),t.vxM(n.automaticText?13:-1),t.R7$(3),t.Y8G("ghs-label","tools.feedback.reportIssue.download"),t.R7$(),t.Y8G("ngClass",t.eq3(13,Md,!n.issuerText&&!n.automaticText))("href",n.issueMail(n.issueType,n.issuerText),t.B4B),t.R7$(),t.Y8G("ghs-label","tools.feedback.reportIssue.send"),t.R7$(),t.Y8G("ghs-label","tools.feedback.reportIssue.mail")}}let Uo=(()=>{class a{error;dialogRef;gameManager=s.E;issueTypes=["abilityCard","monsterStat","characterStat","artwork","software","feedback"];form="issue";issueType="abilityCard";issuerText="";automaticText="";constructor(n,i){this.error=n,this.dialogRef=i,n&&(this.automaticText=p.f.getLabel("tools.feedback.reportIssue.errorText",[n.message,n.stack||""]),this.issueTypes.push("automatic"),this.issueType="automatic")}scenarioMail(n,i,e){let o="mailto:scenario@gloomhaven-secretariat.de",g=new Ue.tB;return g.name=n,g.index=i,g.monsters=s.E.game.figures.filter(m=>m instanceof b.R).map(m=>m.name),g.allies=s.E.game.figures.filter(m=>m instanceof b.R&&m.isAlly).map(m=>m.name),g.allied=s.E.game.figures.filter(m=>m instanceof b.R&&m.isAllied).map(m=>m.name),g.drawExtra=s.E.game.figures.filter(m=>m instanceof b.R&&m.drawExtra).map(m=>m.name),g.objectives=s.E.game.figures.filter(m=>m instanceof ft.$e).map(m=>{if(m.objectiveId){const X=s.E.objectiveManager.objectiveDataByObjectiveIdentifier(m.objectiveId);if(X)return X}return new Ao(m.name,m.health,m.escort,-1,m.marker,[],m.initiative)}),g.rooms=s.E.game.scenario?.rooms||[],g.marker=s.E.game.scenario?.marker||"",g.rules=s.E.game.scenario?.rules||[],g.edition=s.E.game.scenario?.edition||s.E.currentEdition(),o+="?subject=Submit Scenario #"+g.index+" "+g.name+" ("+p.f.getLabel("data.edition."+g.edition)+")",o+="&body="+e+"%0D%0A%0D%0AJSON:%0D%0A"+JSON.stringify(g,void 0,2),o}issueMail(n,i){let e="mailto:issue@gloomhaven-secretariat.de";"feedback"==n&&(e="mailto:feedback@gloomhaven-secretariat.de"),e+="?subject=[GHS v0.145.1] "+p.f.getLabel("tools.feedback.reportIssue.type."+n+".subject"),this.automaticText&&(i+=(i?"\n\n":"")+this.automaticText);let o="edition: "+s.E.currentEdition();return s.E.game.scenario&&(o+=" #"+s.E.game.scenario.index+(s.E.game.scenario.edition!=s.E.currentEdition()?" ("+s.E.game.scenario.edition+")":"")),e+="&body="+p.f.getLabel("tools.feedback.reportIssue.type."+n+".hint")+"%0D%0A%0D%0A"+i.replaceAll("\n","%0D%0A")+"%0D%0A%0D%0A"+o,e}downloadDataDump(){return(0,I.A)(function*(){try{let n=yield G.n.datadump(),i=document.createElement("a");i.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(n))),i.setAttribute("download","ghs-data-dump.json"),document.body.appendChild(i),i.click(),document.body.removeChild(i)}catch{console.warn("Could not read datadump")}})()}ignoreError(){if(this.error){const n=this.error.message+(this.error.stack?this.error.stack.split("\n")[0]:"");p.f.settings.feedbackErrorsIgnore=p.f.settings.feedbackErrorsIgnore||[],p.f.settings.feedbackErrorsIgnore.includes(n)||(p.f.settings.feedbackErrorsIgnore.push(n),p.f.storeSettings(),(0,F.co)(this.dialogRef))}}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-feedback-dialog"]],standalone:!1,decls:7,vars:7,consts:[[1,"feedback-dialog","scroll-container"],[3,"click","ngClass"],[3,"ghs-label"],[1,"hint"],[1,"form","issue-form"],["href","https://github.com/Lurkars/gloomhavensecretariat/issues/new/choose","target","_blank"],[1,"settings"],[3,"click"],["ghs-setting-menu","feedbackErrors"],[3,"ngModelChange","ngModel"],[3,"value"],[1,"hint",3,"ghs-label"],[3,"disabled","ngModel"],[1,"buttons"],[1,"button",3,"click"],[1,"button",3,"ngClass","href"],[1,"warning",3,"ghs-label"],[3,"ngModelChange","disabled","ngModel"]],template:function(i,e){1&i&&(t.j41(0,"span",0)(1,"a",1),t.bIt("click",function(){return e.form="issue"}),t.nrm(2,"span",2),t.k0s(),t.nVh(3,vd,6,2,"div",3),t.nVh(4,bd,20,15,"div",4),t.j41(5,"a",5),t.nrm(6,"span",2),t.k0s()()),2&i&&(t.R7$(),t.Y8G("ngClass",t.eq3(5,Cd,"issue"==e.form)),t.R7$(),t.Y8G("ghs-label","tools.feedback.reportIssue"),t.R7$(),t.vxM(e.automaticText?3:-1),t.R7$(),t.vxM("issue"==e.form?4:-1),t.R7$(2),t.Y8G("ghs-label","tools.feedback.githubIssue"))},dependencies:[N.YU,E.xH,E.y7,E.me,E.wz,E.BC,E.vS,it,fe],styles:[".feedback-dialog[_ngcontent-%COMP%]{font-size:150%;display:flex;flex-direction:column;padding:.5em}.feedback-dialog[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;text-decoration:underline}.feedback-dialog[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{color:var(--ghs-color-white);font-weight:700;pointer-events:none;text-decoration:none}.feedback-dialog[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:.9em;color:var(--ghs-color-yellow)}.feedback-dialog[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;font-size:.9em;color:var(--ghs-color-gray)}.feedback-dialog[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;align-items:center;justify-items:start;column-gap:.5em;row-gap:.5em}.feedback-dialog[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-gray);display:flex}.feedback-dialog[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{grid-column:2;padding:0;margin:0;font-family:var(--ghs-font-text);font-size:.7em;color:var(--ghs-color-gray);opacity:.9}.feedback-dialog[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{grid-column:2;padding:0;margin:0;font-family:var(--ghs-font-text);font-size:.9em;color:var(--ghs-color-yellow);width:calc(var(--ghs-unit) * 65 * var(--ghs-dialog-factor))}.feedback-dialog[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 65 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 20 * var(--ghs-dialog-factor));max-width:60vw}.feedback-dialog[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{cursor:pointer;grid-column:span 2;place-self:end;padding:.3em .7em;border-radius:.5em;background-color:var(--ghs-color-darkgray);color:var(--ghs-color-white);text-decoration:none;font-family:var(--ghs-font-title)}.feedback-dialog[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{opacity:.8}.feedback-dialog[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray);opacity:.8}.feedback-dialog[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;grid-column:span 2;place-self:end}.feedback-dialog[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{margin:0 .5em}"]})}return a})(),No=(()=>{class a{settinsManager=p.f;static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-keyboard-shortcuts-dialog"]],standalone:!1,decls:353,vars:0,consts:[[1,"scroll-container"],["ghs-label","tools.keyboard"],["ghs-label","tools.keyboard.global"],["ghs-setting-menu","keyboardShortcuts",1,"line"],["ghs-label","tools.keyboard.ctrl"],["ghs-label","tools.keyboard.undo"],["ghs-label","tools.keyboard.shift"],["ghs-label","tools.keyboard.redo"],["ghs-label","tools.keyboard.esc"],["ghs-label","tools.keyboard.backspace"],["ghs-label","tools.keyboard.mainMenu"],["ghs-label","tools.keyboard.esc.fullscreen",1,"hint"],["ghs-label","tools.keyboard.zoomIn"],["ghs-label","tools.keyboard.zoomOut"],["ghs-label","tools.keyboard.zoomReset"],["ghs-label","tools.keyboard.toggleFullscreen"],["ghs-label","tools.keyboard.tab"],["ghs-label","tools.keyboard.toggelTab"],["ghs-label","tools.keyboard.round"],["ghs-label","tools.keyboard.am"],["ghs-label","tools.keyboard.amAdvantage"],["ghs-label","tools.keyboard.amDisadvantage"],["ghs-label","tools.keyboard.loot"],["ghs-label","tools.keyboard.activeCharacter.lootInc"],["ghs-label","tools.keyboard.activeCharacter.lootDec"],["ghs-label","tools.keyboard.toggleElements"],["ghs-label","tools.keyboard.toggleAbsent"],["ghs-label","tools.keyboard.select"],["ghs-label","tools.keyboard.selectNatural"],["ghs-label","tools.keyboard.difficulty"],["ghs-label","tools.keyboard.alt"],["ghs-label","tools.keyboard.activeCharacter.xpInc"],["ghs-label","tools.keyboard.activeCharacter.xpDec"],["ghs-label","tools.keyboard.events"],["ghs-label","tools.keyboard.finish"],["ghs-label","tools.keyboard.party"],["ghs-label","tools.keyboard.globalMap"],["ghs-label","tools.keyboard.scenarioChart"],["ghs-label","tools.keyboard.toggleHandSize"],["ghs-label","tools.keyboard.toggleTraits"],["ghs-label","tools.keyboard.toggleDamageHP"],["ghs-label","tools.keyboard.togglePlayerNumber"],["ghs-label","tools.keyboard.keyboard"],["ghs-label","tools.keyboard.entityMenu"],["ghs-label","tools.keyboard.entityMenu.hpInc"],["ghs-label","tools.keyboard.entityMenu.hpDec"],["ghs-label","tools.keyboard.entityMenu.toggleCondition"],["ghs-label","tools.keyboard.entityMenu.xpInc"],["ghs-label","tools.keyboard.entityMenu.xpDec"],["ghs-label","tools.keyboard.entityMenu.lootInc"],["ghs-label","tools.keyboard.entityMenu.lootDec"],["ghs-label","tools.keyboard.entityMenu.blessInc"],["ghs-label","tools.keyboard.entityMenu.blessDec"],["ghs-label","tools.keyboard.entityMenu.curseInc"],["ghs-label","tools.keyboard.entityMenu.curseDec"],["ghs-label","tools.keyboard.entityMenu.kill"],["ghs-label","tools.keyboard.entityMenu.maxHpInc"],["ghs-label","tools.keyboard.entityMenu.maxHpDec"],["ghs-label","tools.keyboard.entityMenu.characterSheet"],["ghs-label","tools.keyboard.entityMenu.toggleAbsent"],["ghs-label","tools.keyboard.mainMenu.open"],["ghs-label","tools.keyboard.enter"],["ghs-label","tools.keyboard.space"],["ghs-label","tools.keyboard.mainMenu.confirm"],["ghs-label","tools.keyboard.mainMenu.decline"],["ghs-label","tools.keyboard.mainMenu.select"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nrm(1,"h1",1)(2,"p",2)(3,"div",3),t.j41(4,"ul")(5,"li")(6,"kbd"),t.nrm(7,"span",4),t.k0s(),t.EFF(8," + "),t.j41(9,"kbd")(10,"span"),t.EFF(11,"z"),t.k0s()(),t.nrm(12,"span",5),t.k0s(),t.j41(13,"li")(14,"kbd"),t.nrm(15,"span",4),t.k0s(),t.EFF(16," + "),t.j41(17,"kbd")(18,"span"),t.EFF(19,"y"),t.k0s()(),t.EFF(20,"\xa0|\xa0"),t.j41(21,"kbd"),t.nrm(22,"span",4),t.k0s(),t.EFF(23," + "),t.j41(24,"kbd"),t.nrm(25,"span",6),t.k0s(),t.EFF(26," + "),t.j41(27,"kbd")(28,"span"),t.EFF(29,"Z"),t.k0s()(),t.nrm(30,"span",7),t.k0s(),t.j41(31,"li")(32,"kbd"),t.nrm(33,"span",8),t.k0s(),t.EFF(34,"\xa0|\xa0"),t.j41(35,"kbd"),t.nrm(36,"span",9),t.k0s(),t.nrm(37,"span",10)(38,"span",11),t.k0s(),t.j41(39,"li")(40,"kbd")(41,"span"),t.EFF(42,"\u2191"),t.k0s()(),t.EFF(43,"\xa0|\xa0"),t.j41(44,"kbd")(45,"span"),t.EFF(46,"+"),t.k0s()(),t.nrm(47,"span",12),t.k0s(),t.j41(48,"li")(49,"kbd")(50,"span"),t.EFF(51,"\u2193"),t.k0s()(),t.EFF(52,"\xa0|\xa0"),t.j41(53,"kbd")(54,"span"),t.EFF(55,"-"),t.k0s()(),t.nrm(56,"span",13),t.k0s(),t.j41(57,"li")(58,"kbd"),t.nrm(59,"span",4),t.k0s(),t.EFF(60," + "),t.j41(61,"kbd")(62,"span"),t.EFF(63,"r"),t.k0s()(),t.nrm(64,"span",14),t.k0s(),t.j41(65,"li")(66,"kbd")(67,"span"),t.EFF(68,"f"),t.k0s()(),t.nrm(69,"span",15),t.k0s(),t.j41(70,"li")(71,"kbd"),t.nrm(72,"span",16),t.k0s(),t.nrm(73,"span",17),t.k0s(),t.j41(74,"li")(75,"kbd")(76,"span"),t.EFF(77,"n"),t.k0s()(),t.nrm(78,"span",18),t.k0s(),t.j41(79,"li")(80,"kbd")(81,"span"),t.EFF(82,"m"),t.k0s()(),t.nrm(83,"span",19),t.k0s(),t.j41(84,"li")(85,"kbd")(86,"span"),t.EFF(87,"a"),t.k0s()(),t.nrm(88,"span",20),t.k0s(),t.j41(89,"li")(90,"kbd")(91,"span"),t.EFF(92,"d"),t.k0s()(),t.nrm(93,"span",21),t.k0s(),t.j41(94,"li")(95,"kbd")(96,"span"),t.EFF(97,"l"),t.k0s()(),t.nrm(98,"span",22),t.EFF(99,"\xa0|\xa0"),t.nrm(100,"span",23),t.k0s(),t.j41(101,"li")(102,"kbd"),t.nrm(103,"span",6),t.k0s(),t.EFF(104,"\xa0+\xa0"),t.j41(105,"kbd")(106,"span"),t.EFF(107,"X"),t.k0s()(),t.nrm(108,"span",24),t.k0s(),t.j41(109,"li")(110,"kbd")(111,"span"),t.EFF(112,"1"),t.k0s()(),t.EFF(113,"-"),t.j41(114,"kbd")(115,"span"),t.EFF(116,"6"),t.k0s()(),t.nrm(117,"span",25),t.k0s(),t.j41(118,"li")(119,"kbd")(120,"span"),t.EFF(121,"h"),t.k0s()(),t.nrm(122,"span",26),t.k0s(),t.j41(123,"li")(124,"kbd")(125,"span"),t.EFF(126,"s"),t.k0s()(),t.nrm(127,"span",27),t.EFF(128,"\xa0("),t.j41(129,"kbd")(130,"span"),t.EFF(131,"0"),t.k0s()(),t.EFF(132,"-"),t.j41(133,"kbd")(134,"span"),t.EFF(135,"9"),t.k0s()(),t.EFF(136,") "),t.k0s(),t.j41(137,"li")(138,"kbd")(139,"span"),t.EFF(140,"w"),t.k0s()(),t.nrm(141,"span",28),t.EFF(142,"\xa0("),t.j41(143,"kbd")(144,"span"),t.EFF(145,"0"),t.k0s()(),t.EFF(146,"-"),t.j41(147,"kbd")(148,"span"),t.EFF(149,"9"),t.k0s()(),t.EFF(150,") "),t.k0s(),t.j41(151,"li")(152,"kbd")(153,"span"),t.EFF(154,"x"),t.k0s()(),t.nrm(155,"span",29),t.k0s(),t.j41(156,"li")(157,"kbd"),t.nrm(158,"span",30),t.k0s(),t.EFF(159,"\xa0+\xa0"),t.j41(160,"kbd")(161,"span"),t.EFF(162,"x"),t.k0s()(),t.nrm(163,"span",31),t.k0s(),t.j41(164,"li")(165,"kbd"),t.nrm(166,"span",6),t.k0s(),t.EFF(167,"\xa0+\xa0"),t.j41(168,"kbd")(169,"span"),t.EFF(170,"X"),t.k0s()(),t.nrm(171,"span",32),t.k0s(),t.j41(172,"li")(173,"kbd")(174,"span"),t.EFF(175,"e"),t.k0s()(),t.nrm(176,"span",33),t.k0s(),t.j41(177,"li")(178,"kbd"),t.nrm(179,"span",6),t.k0s(),t.EFF(180," + "),t.j41(181,"kbd")(182,"span"),t.EFF(183,"f"),t.k0s()(),t.nrm(184,"span",34),t.k0s(),t.j41(185,"li")(186,"kbd")(187,"span"),t.EFF(188,"p"),t.k0s()(),t.nrm(189,"span",35),t.k0s(),t.j41(190,"li")(191,"kbd")(192,"span"),t.EFF(193,"g"),t.k0s()(),t.nrm(194,"span",36),t.k0s(),t.j41(195,"li")(196,"kbd")(197,"span"),t.EFF(198,"c"),t.k0s()(),t.nrm(199,"span",37),t.k0s(),t.j41(200,"li")(201,"kbd"),t.nrm(202,"span",6),t.k0s(),t.EFF(203,"\xa0+\xa0"),t.j41(204,"kbd")(205,"span"),t.EFF(206,"H"),t.k0s()(),t.nrm(207,"span",38),t.k0s(),t.j41(208,"li")(209,"kbd")(210,"span"),t.EFF(211,"t"),t.k0s()(),t.nrm(212,"span",39),t.k0s(),t.j41(213,"li")(214,"kbd")(215,"span"),t.EFF(216,"i"),t.k0s()(),t.nrm(217,"span",40),t.k0s(),t.j41(218,"li")(219,"kbd")(220,"span"),t.EFF(221,"#"),t.k0s()(),t.nrm(222,"span",41),t.k0s(),t.j41(223,"li")(224,"kbd")(225,"span"),t.EFF(226,"?"),t.k0s()(),t.nrm(227,"span",42),t.k0s()(),t.nrm(228,"p",43),t.j41(229,"ul")(230,"li")(231,"kbd")(232,"span"),t.EFF(233,"\u2192"),t.k0s()(),t.nrm(234,"span",44),t.k0s(),t.j41(235,"li")(236,"kbd")(237,"span"),t.EFF(238,"\u2190"),t.k0s()(),t.nrm(239,"span",45),t.k0s(),t.j41(240,"li")(241,"kbd")(242,"span"),t.EFF(243,"0"),t.k0s()(),t.EFF(244,"-"),t.j41(245,"kbd")(246,"span"),t.EFF(247,"9"),t.k0s()(),t.EFF(248,"\xa0"),t.nrm(249,"span",46),t.k0s(),t.j41(250,"li")(251,"kbd")(252,"span"),t.EFF(253,"x"),t.k0s()(),t.nrm(254,"span",47),t.k0s(),t.j41(255,"li")(256,"kbd"),t.nrm(257,"span",6),t.k0s(),t.EFF(258,"\xa0+\xa0"),t.j41(259,"kbd")(260,"span"),t.EFF(261,"X"),t.k0s()(),t.nrm(262,"span",48),t.k0s(),t.j41(263,"li")(264,"kbd")(265,"span"),t.EFF(266,"l"),t.k0s()(),t.nrm(267,"span",49),t.k0s(),t.j41(268,"li")(269,"kbd"),t.nrm(270,"span",6),t.k0s(),t.EFF(271,"\xa0+\xa0"),t.j41(272,"kbd")(273,"span"),t.EFF(274,"L"),t.k0s()(),t.nrm(275,"span",50),t.k0s(),t.j41(276,"li")(277,"kbd")(278,"span"),t.EFF(279,"b"),t.k0s()(),t.nrm(280,"span",51),t.k0s(),t.j41(281,"li")(282,"kbd"),t.nrm(283,"span",6),t.k0s(),t.EFF(284,"\xa0+\xa0"),t.j41(285,"kbd")(286,"span"),t.EFF(287,"B"),t.k0s()(),t.nrm(288,"span",52),t.k0s(),t.j41(289,"li")(290,"kbd")(291,"span"),t.EFF(292,"c"),t.k0s()(),t.nrm(293,"span",53),t.k0s(),t.j41(294,"li")(295,"kbd"),t.nrm(296,"span",6),t.k0s(),t.EFF(297,"\xa0+\xa0"),t.j41(298,"kbd")(299,"span"),t.EFF(300,"C"),t.k0s()(),t.nrm(301,"span",54),t.k0s(),t.j41(302,"li")(303,"kbd")(304,"span"),t.EFF(305,"k"),t.k0s()(),t.EFF(306,"\xa0|\xa0"),t.j41(307,"kbd")(308,"span"),t.EFF(309,"d"),t.k0s()(),t.nrm(310,"span",55),t.k0s(),t.j41(311,"li")(312,"kbd")(313,"span"),t.EFF(314,"\u2191"),t.k0s()(),t.nrm(315,"span",56),t.k0s(),t.j41(316,"li")(317,"kbd")(318,"span"),t.EFF(319,"\u2193"),t.k0s()(),t.nrm(320,"span",57),t.k0s(),t.j41(321,"li")(322,"kbd")(323,"span"),t.EFF(324,"s"),t.k0s()(),t.nrm(325,"span",58),t.k0s(),t.j41(326,"li")(327,"kbd")(328,"span"),t.EFF(329,"a"),t.k0s()(),t.nrm(330,"span",59),t.k0s()(),t.nrm(331,"p",60),t.j41(332,"ul")(333,"li")(334,"kbd"),t.nrm(335,"span",61),t.k0s(),t.EFF(336,"\xa0|\xa0"),t.j41(337,"kbd"),t.nrm(338,"span",62),t.k0s(),t.nrm(339,"span",63),t.k0s(),t.j41(340,"li")(341,"kbd"),t.nrm(342,"span",8),t.k0s(),t.EFF(343,"\xa0|\xa0"),t.j41(344,"kbd"),t.nrm(345,"span",9),t.k0s(),t.nrm(346,"span",64)(347,"span",11),t.k0s(),t.j41(348,"li")(349,"kbd")(350,"span",16),t.EFF(351,"\u21b9"),t.k0s()(),t.nrm(352,"span",65),t.k0s()()())},dependencies:[it,fe],styles:[".scroll-container[_ngcontent-%COMP%]{color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}li[_ngcontent-%COMP%]{display:flex;align-items:center}li[_ngcontent-%COMP%]   kbd[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}li[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));font-style:italic;font-size:.8em}"]})}return a})(),zo=(()=>{class a{el;active=!1;constructor(n){this.el=n}ngOnChanges(n){n.active&&n.active.currentValue&&n.active.currentValue!=n.active.previousValue&&setTimeout(()=>{this.el.nativeElement.scrollIntoView({behavior:p.f.settings.animations?"smooth":"auto",block:"center",inline:"center"})},5)}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT))};static \u0275dir=t.FsC({type:a,selectors:[["","autoscroll",""]],inputs:{active:[0,"autoscroll","active"]},standalone:!1,features:[t.OA$]})}return a})(),kd=(()=>{class a{el;ghsManager;figure;block="center";inline="center";active=!1;constructor(n,i){this.el=n,this.ghsManager=i}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{setTimeout(()=>{p.f.settings.autoscroll&&!this.active&&this.figure.active&&this.el.nativeElement.scrollIntoView({behavior:p.f.settings.animations?"smooth":"auto",block:this.block,inline:this.inline}),this.active=this.figure.active},p.f.settings.animations?300*p.f.settings.animationSpeed:5)}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT),t.rXU(st))};static \u0275dir=t.FsC({type:a,selectors:[["","figure-autoscroll",""]],inputs:{figure:[0,"figure-autoscroll","figure"],block:"block",inline:"inline"},standalone:!1})}return a})();const Lo=a=>({disabled:a}),yd=(a,r)=>({"has-undos":a,"has-redos":r}),qo=(a,r)=>({confirm:a,disabled:r}),Ca=a=>[a],Ho=(a,r)=>({disabled:a,confirm:r});function xd(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",20),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.moreRedos())}),t.nrm(1,"span",3),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","state.loadMore"))}function Ed(a,r){if(1&a&&(t.nrm(0,"span",22),t.nI1(1,"slice")),2&a){const n=t.XpG().$implicit,i=t.XpG();t.Y8G("ghs-label","state.info."+i.getRedoInfo(n)[0])("ghs-label-args",t.brH(1,3,i.getRedoInfo(n),1,i.getRedoInfo(n).length))("ghs-label-empty",!0)}}function wd(a,r){if(1&a&&(t.j41(0,"span",14),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(),t.E5c("",i.gameManager.stateManager.redos[i.gameManager.stateManager.redos.length-n-1].revision," - ",i.gameManager.stateManager.redos[i.gameManager.stateManager.redos.length-n-1].revisionOffset," - ",i.gameManager.stateManager.redos[i.gameManager.stateManager.redos.length-n-1].revision-i.gameManager.stateManager.redos[i.gameManager.stateManager.redos.length-n-1].revisionOffset)}}function Rd(a,r){if(1&a&&(t.j41(0,"span",23),t.nrm(1,"img",24)(2,"span",25),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(2),t.Y8G("ghs-label","state.missing")("ghs-label-args",t.eq3(2,Ca,i.getRedoRevision(n)-i.getRedoRevision(n-1)-1))}}function jd(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",21),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.redo(e))})("mouseleave",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.cancelConfirm())}),t.j41(1,"span",11),t.EFF(2),t.k0s(),t.nVh(3,Ed,2,7,"span",22),t.nrm(4,"span",13),t.nVh(5,wd,2,3,"span",14),t.k0s(),t.nVh(6,Rd,3,4,"span",23)}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.l_i(5,qo,i.undoConfirm=="redo-"+n,!i.gameManager.stateManager.redoPermission)),t.R7$(2),t.SpI("",i.getRedoRevision(n)+1,"."),t.R7$(),t.vxM(i.getRedoInfo(n).length>0?3:-1),t.R7$(2),t.vxM(i.gameManager.stateManager.redos[i.gameManager.stateManager.redos.length-n-1]?5:-1),t.R7$(),t.vxM(n>0&&i.getRedoRevision(n)-i.getRedoRevision(n-1)!=1?6:-1)}}function Gd(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",26),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.gameManager.stateManager.gameOffsetWarning=!1)}),t.nrm(1,"img",24)(2,"span",25),t.k0s()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","state.missing")("ghs-label-args",t.eq3(2,Ca,n.undoOffset))}}function Td(a,r){if(1&a&&(t.j41(0,"span",23),t.nrm(1,"img",24)(2,"span",25),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(2),t.Y8G("ghs-label","state.missing")("ghs-label-args",t.eq3(2,Ca,i.gameManager.game.revision-i.gameManager.game.revisionOffset-i.getUndoRevision(n)-1))}}function Sd(a,r){if(1&a&&(t.j41(0,"span",23),t.nrm(1,"img",24)(2,"span",25),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(2),t.Y8G("ghs-label","state.missing")("ghs-label-args",t.eq3(2,Ca,i.getUndoRevision(n+1)-i.getUndoRevision(n)-1))}}function Dd(a,r){if(1&a&&(t.nrm(0,"span",22),t.nI1(1,"slice")),2&a){const n=t.XpG().$implicit,i=t.XpG();t.Y8G("ghs-label","state.info."+i.getUndoInfo(n)[0])("ghs-label-args",t.brH(1,3,i.getUndoInfo(n),1,i.getUndoInfo(n).length))("ghs-label-empty",!0)}}function $d(a,r){if(1&a&&(t.j41(0,"span",14),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(),t.E5c("",i.gameManager.stateManager.undos[n].revision," - ",i.gameManager.stateManager.undos[n].revisionOffset," - ",i.gameManager.stateManager.undos[n].revision-i.gameManager.stateManager.undos[n].revisionOffset)}}function Id(a,r){if(1&a){const n=t.RV6();t.nVh(0,Td,3,4,"span",23),t.nVh(1,Sd,3,4,"span",23),t.j41(2,"span",21),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.undo(e))})("mouseleave",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.cancelConfirm())}),t.j41(3,"span",11),t.EFF(4),t.k0s(),t.nVh(5,Dd,2,7,"span",22),t.nrm(6,"span",13),t.nVh(7,$d,2,3,"span",14),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.vxM(!i.undoOffset&&n==i.undoArray.length-1&&i.gameManager.game.revision-i.gameManager.game.revisionOffset-i.getUndoRevision(n)-1?0:-1),t.R7$(),t.vxM(n<i.undoArray.length-1&&i.getUndoRevision(n+1)-i.getUndoRevision(n)!=1?1:-1),t.R7$(),t.Y8G("ngClass",t.l_i(6,qo,i.undoConfirm=="undo-"+n,!i.gameManager.stateManager.undoPermission||i.undoOffset&&i.gameManager.stateManager.gameOffsetWarning)),t.R7$(2),t.SpI("",i.getUndoRevision(n)+1,"."),t.R7$(),t.vxM(i.getUndoInfo(n).length>0?5:-1),t.R7$(2),t.vxM(i.gameManager.stateManager.undos[n]?7:-1)}}function Ad(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",27),t.bIt("inViewportAction",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.moreUndos())})("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.moreUndos())}),t.nrm(1,"span",3),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","state.loadMore"))}function Vd(a,r){1&a&&t.nrm(0,"span")}function Fd(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",28),t.bIt("mouseleave",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.confirm="")})("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.clearUndos())}),t.nrm(1,"span",3),t.EFF(2),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.l_i(3,Ho,!n.gameManager.stateManager.undoPermission,"clearUndos"==n.confirm)),t.R7$(),t.Y8G("ghs-label","state.clear.undos"),t.R7$(),t.JRh("clearUndos"==n.confirm?"!":"?")}}function Xd(a,r){1&a&&(t.j41(0,"span",4),t.EFF(1,"|"),t.k0s())}function Bd(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",28),t.bIt("mouseleave",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.confirm="")})("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.clearRedos())}),t.nrm(1,"span",3),t.EFF(2),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.l_i(3,Ho,!n.gameManager.stateManager.redoPermission,"clearRedos"==n.confirm)),t.R7$(),t.Y8G("ghs-label","state.clear.redos"),t.R7$(),t.JRh("clearRedos"==n.confirm?"!":"?")}}let Yd=(()=>{class a{dialogRef;ghsManager;gameManager=s.E;undoOffset=0;confirm="";undoArray=[];redoArray=[];undoConfirm="";constructor(n,i){this.dialogRef=n,this.ghsManager=i,this.dialogRef.overlayRef.hostElement.style.zIndex="3000",this.dialogRef.overlayRef.backdropElement&&(this.dialogRef.overlayRef.backdropElement.style.zIndex="3000")}ngOnInit(){this.undoOffset=s.E.stateManager.undos.length>0?s.E.game.revision-(s.E.game.revisionOffset||0)-this.getUndoRevision(s.E.stateManager.undos.length-1)-1:0,this.undoArray=Array.from({length:Math.min(10,s.E.stateManager.undos.length)}).map((n,i)=>s.E.stateManager.undos.length-i-1),this.redoArray=Array.from({length:Math.min(10,s.E.stateManager.redos.length)}).map((n,i)=>Math.min(10,s.E.stateManager.redos.length)-i-1),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.undoOffset=s.E.stateManager.undos.length>0?s.E.game.revision-(s.E.game.revisionOffset||0)-this.getUndoRevision(s.E.stateManager.undos.length-1)-1:0,this.undoArray=Array.from({length:Math.min(10,s.E.stateManager.undos.length)}).map((n,i)=>s.E.stateManager.undos.length-i-1),this.redoArray=Array.from({length:Math.min(10,s.E.stateManager.redos.length)}).map((n,i)=>Math.min(10,s.E.stateManager.redos.length)-i-1)}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}moreUndos(){this.undoArray.length<s.E.stateManager.undos.length&&(this.undoArray=Array.from({length:Math.min(s.E.stateManager.undos.length,this.undoArray.length+10)}).map((n,i)=>s.E.stateManager.undos.length-i-1))}moreRedos(){if(this.redoArray.length<s.E.stateManager.redos.length){const n=Math.min(s.E.stateManager.redos.length,this.redoArray.length+10);this.redoArray=Array.from({length:n}).map((i,e)=>n-e-1)}}getUndoInfo(n){let i=[];return s.E.stateManager.undos.length>0&&s.E.stateManager.undoInfos.length>=s.E.stateManager.undos.length&&n>=0&&n<s.E.stateManager.undos.length&&(i=s.E.stateManager.undoInfos[n],i&&i.length>1&&"serverSync"==i[0]?i="setInitiative"==i[1]&&i.length>3?["serverSync",p.f.getLabel("state.info."+i[1],[i[2],""])]:["serverSync",p.f.getLabel("state.info."+i[1],i.slice(2))]:i&&1==i.length&&"serverSync"==i[0]?i=["serverSync",""]:i||(i=["unknown"])),i}getRedoInfo(n){let i=[];return s.E.stateManager.redos.length>0&&s.E.stateManager.undoInfos.length>=s.E.stateManager.undos.length+s.E.stateManager.redos.length&&n>=0&&n<s.E.stateManager.redos.length&&(i=s.E.stateManager.undoInfos[s.E.stateManager.undos.length+n],i&&i.length>1&&"serverSync"==i[0]?i="setInitiative"==i[1]&&i.length>3?["serverSync",p.f.getLabel("state.info."+i[1],[i[2],""])]:["serverSync",p.f.getLabel("state.info."+i[1],i.slice(2))]:i&&1==i.length&&"serverSync"==i[0]?i=["serverSync",""]:i||(i=["unknown"])),i}getUndoRevision(n){const i=s.E.stateManager.undos;return i[n]&&i[n].revision-(i[n].revisionOffset||0)||0}getRedoRevision(n){const i=s.E.stateManager.redos,e=i.length-n-1;return i[e]&&i[e].revision-(i[e].revisionOffset||0)||0}undo(n,i=!1){i||this.undoConfirm=="undo-"+n?s.E.stateManager.fixedUndo(s.E.stateManager.undos.length-n):this.undoConfirm="undo-"+n}redo(n,i=!1){i||this.undoConfirm=="redo-"+n?s.E.stateManager.fixedRedo(n+1):this.undoConfirm="redo-"+n}cancelConfirm(){this.undoConfirm=""}clearUndos(){"clearUndos"!=this.confirm?this.confirm="clearUndos":(this.undoArray=[],this.undoOffset=0,s.E.stateManager.clearUndos())}clearRedos(){"clearRedos"!=this.confirm?this.confirm="clearRedos":(this.redoArray=[],s.E.stateManager.clearRedos())}static \u0275fac=function(i){return new(i||a)(t.rXU(O.ce),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-undo-dialog"]],standalone:!1,decls:32,vars:25,consts:[[1,"undo-dialog"],[1,"menu"],["tabclick","",1,"state","undo",3,"click","ngClass"],[3,"ghs-label"],[1,"separator"],["tabclick","",1,"state","redo",3,"click","ngClass"],[1,"container"],[1,"list","redos"],["tabclick","",1,"more"],[1,"list","current",3,"autoscroll","ngClass"],[1,"entry"],[1,"revision"],[1,"info",3,"ghs-label"],[1,"spacer"],[1,"debug"],[1,"warning","undo-offset"],[1,"list","undos"],["tabclick","","inViewport","",1,"more"],[1,"menu","clear-menu"],["tabclick","",1,"state",3,"ngClass"],["tabclick","",1,"more",3,"click"],["tabclick","",1,"entry",3,"click","mouseleave","ngClass"],[1,"info","text-white",3,"ghs-label","ghs-label-args","ghs-label-empty"],[1,"warning"],["src","./assets/images/warning.svg"],[3,"ghs-label","ghs-label-args"],[1,"warning","undo-offset",3,"click"],["tabclick","","inViewport","",1,"more",3,"inViewportAction","click"],["tabclick","",1,"state",3,"mouseleave","click","ngClass"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"a",2),t.bIt("click",function(){return e.gameManager.stateManager.undo()}),t.nrm(3,"span",3),t.k0s(),t.j41(4,"span",4),t.EFF(5,"|"),t.k0s(),t.j41(6,"a",5),t.bIt("click",function(){return e.gameManager.stateManager.redo()}),t.nrm(7,"span",3),t.k0s()(),t.j41(8,"div",6)(9,"div",7),t.nVh(10,xd,2,1,"span",8),t.Z7z(11,jd,7,8,null,null,t.fX1),t.k0s(),t.j41(13,"div",9)(14,"span",10)(15,"span",11),t.EFF(16),t.k0s(),t.nrm(17,"span",12)(18,"span",13),t.j41(19,"span",14),t.EFF(20),t.k0s()(),t.nVh(21,Gd,3,4,"span",15),t.k0s(),t.j41(22,"div",16),t.Z7z(23,Id,8,9,null,null,t.fX1),t.nVh(25,Ad,2,1,"span",17),t.k0s()(),t.nrm(26,"div",13),t.j41(27,"div",18),t.nVh(28,Vd,1,0,"span"),t.nVh(29,Fd,3,6,"a",19),t.nVh(30,Xd,2,0,"span",4),t.nVh(31,Bd,3,6,"a",19),t.k0s()()),2&i&&(t.R7$(2),t.Y8G("ngClass",t.eq3(18,Lo,!e.gameManager.stateManager.undoPermission||e.undoOffset&&e.gameManager.stateManager.gameOffsetWarning||0==e.undoArray.length)),t.R7$(),t.Y8G("ghs-label","state.undo"),t.R7$(3),t.Y8G("ngClass",t.eq3(20,Lo,!e.gameManager.stateManager.redoPermission||0==e.redoArray.length)),t.R7$(),t.Y8G("ghs-label","state.redo"),t.R7$(3),t.vxM(e.redoArray.length<e.gameManager.stateManager.redos.length?10:-1),t.R7$(),t.Dyx(e.redoArray),t.R7$(2),t.Y8G("autoscroll",!0)("ngClass",t.l_i(22,yd,e.undoArray.length>0,e.redoArray.length>0)),t.R7$(3),t.SpI("",e.gameManager.game.revision-(e.gameManager.game.revisionOffset||0)+1,"."),t.R7$(),t.Y8G("ghs-label","state.currentGame"),t.R7$(3),t.E5c("",e.gameManager.game.revision," - ",e.gameManager.game.revisionOffset," - ",e.gameManager.game.revision-e.gameManager.game.revisionOffset),t.R7$(),t.vxM(e.undoOffset&&e.gameManager.stateManager.gameOffsetWarning?21:-1),t.R7$(2),t.Dyx(e.undoArray),t.R7$(2),t.vxM(e.undoArray.length<e.gameManager.stateManager.undos.length?25:-1),t.R7$(3),t.vxM(0==e.undoArray.length?28:-1),t.R7$(),t.vxM(e.undoArray.length>0?29:-1),t.R7$(),t.vxM(e.undoArray.length>0&&e.redoArray.length>0?30:-1),t.R7$(),t.vxM(e.redoArray.length>0?31:-1))},dependencies:[N.YU,T.dQ,zo,it,Ft,N.P9],styles:[".undo-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:relative;padding:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 70);height:calc(var(--ghs-unit) * 68 * var(--ghs-dialog-factor));max-height:calc(var(--ghs-unit) * 68 * var(--ghs-dialog-factor))}.undo-dialog[_ngcontent-%COMP%]   .working[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray);animation:ghs-spinning 1.5s linear infinite;margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.undo-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:center}.undo-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{color:var(--ghs-color-disabled);margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.undo-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{cursor:pointer;font-family:var(--ghs-font-title);margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.undo-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.undo-dialog[_ngcontent-%COMP%]   .menu.clear-menu[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.undo-dialog[_ngcontent-%COMP%]   .menu.clear-menu[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));font-family:var(--ghs-font-text)}.undo-dialog[_ngcontent-%COMP%]   .menu.clear-menu[_ngcontent-%COMP%]   .state.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.undo-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{padding:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));max-height:100%;overflow:auto}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{display:flex;flex-direction:column}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;align-items:flex-end;color:var(--ghs-color-white)}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   .revision[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;text-align:right;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]:hover{filter:brightness(.5)}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .entry.confirm[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .entry.disabled[_ngcontent-%COMP%]{pointer-events:none}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   .debug[_ngcontent-%COMP%]{display:none}.undo-dialog[_ngcontent-%COMP%]   .list.current[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) 0;border-top:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid transparent;border-bottom:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid transparent}.undo-dialog[_ngcontent-%COMP%]   .list.current[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-style:italic}.undo-dialog[_ngcontent-%COMP%]   .list.current.has-undos[_ngcontent-%COMP%]{border-bottom-color:var(--ghs-color-gray)}.undo-dialog[_ngcontent-%COMP%]   .list.current.has-redos[_ngcontent-%COMP%]{border-top-color:var(--ghs-color-gray)}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--ghs-color-red)}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .warning.undo-offset[_ngcontent-%COMP%]{cursor:zoom-out}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .warning.undo-offset[_ngcontent-%COMP%]:hover{opacity:.7}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .more[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer;color:var(--ghs-color-gray)}"]})}return a})();const Ko=a=>({disabled:a}),Ud=a=>[a],Wo=a=>({denied:a}),Ce=(a,r)=>({disabled:a,denied:r}),ui=(a,r)=>r._trackUUID;function Nd(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",25),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.gameManager.stateManager.gameOffsetWarning=!1)}),t.nrm(1,"img",26)(2,"span",27),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","state.missing")("ghs-label-args",t.eq3(2,Ud,n.undoOffset))}}function zd(a,r){if(1&a&&(t.nrm(0,"span",13),t.nI1(1,"slice")),2&a){const n=t.XpG(2);t.Y8G("ghs-label","state.info."+n.undoInfo[0])("ghs-label-args",t.brH(1,3,n.undoInfo,1,n.undoInfo.length))("ghs-label-empty",!0)}}function Ld(a,r){if(1&a&&(t.nrm(0,"span",13),t.nI1(1,"slice")),2&a){const n=t.XpG(2);t.Y8G("ghs-label","state.info."+n.redoInfo[0])("ghs-label-args",t.brH(1,3,n.redoInfo,1,n.redoInfo.length))("ghs-label-empty",!0)}}function qd(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",28)(1,"a",19),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.setActive(e.SubMenu.scenario))}),t.nrm(2,"span",12),t.k0s()(),t.j41(3,"div",28)(4,"a",19),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.setActive(e.SubMenu.section))}),t.nrm(5,"span",12),t.k0s()(),t.j41(6,"div",28)(7,"a",19),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.setActive(e.SubMenu.monster_add))}),t.nrm(8,"span",12),t.k0s()(),t.j41(9,"div",28)(10,"a",19),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.setActive(e.SubMenu.monster_remove))}),t.nrm(11,"span",12),t.k0s()(),t.nrm(12,"div",17),t.j41(13,"div",28)(14,"a",19),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.setActive(e.SubMenu.character_add))}),t.nrm(15,"span",12),t.k0s()(),t.j41(16,"div",28)(17,"a",19),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.setActive(e.SubMenu.character_remove))}),t.nrm(18,"span",12),t.k0s()(),t.j41(19,"div",28)(20,"a",19),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.setActive(e.SubMenu.objective_add))}),t.nrm(21,"span",12),t.k0s()(),t.j41(22,"div",28)(23,"a",19),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.setActive(e.SubMenu.objective_remove))}),t.nrm(24,"span",12),t.k0s()(),t.nrm(25,"div",17),t.j41(26,"div",29)(27,"a",19),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.setActive(e.SubMenu.campaign))}),t.nrm(28,"span",12),t.k0s()(),t.nrm(29,"div",17)}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(17,Wo,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.scenario)),t.R7$(2),t.Y8G("ghs-label","scenario.set"),t.R7$(),t.Y8G("ngClass",t.l_i(19,Ce,!n.hasSections(),n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.scenario)),t.R7$(2),t.Y8G("ghs-label","section"),t.R7$(),t.Y8G("ngClass",t.l_i(22,Ce,n.hasAllMonster(),n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.monsters)),t.R7$(2),t.Y8G("ghs-label","monster.add"),t.R7$(),t.Y8G("ngClass",t.l_i(25,Ce,0==n.monsters().length,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.monsters)),t.R7$(2),t.Y8G("ghs-label","monster.remove"),t.R7$(2),t.Y8G("ngClass",t.l_i(28,Ce,n.characters().length>0&&n.gameManager.bbRules()&&n.settingsManager.settings.bbChars,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.characters)),t.R7$(2),t.Y8G("ghs-label","character.add"),t.R7$(),t.Y8G("ngClass",t.l_i(31,Ce,0==n.characters().length,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.characters)),t.R7$(2),t.Y8G("ghs-label","character.remove"),t.R7$(),t.Y8G("ngClass",t.eq3(34,Wo,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.characters)),t.R7$(2),t.Y8G("ghs-label","objective.add"),t.R7$(),t.Y8G("ngClass",t.l_i(36,Ce,0==n.objectives().length,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.characters)),t.R7$(2),t.Y8G("ghs-label","objective.remove"),t.R7$(4),t.Y8G("ghs-label","campaign")}}function Hd(a,r){1&a&&(t.j41(0,"span"),t.nrm(1,"span",12),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","server.menu.connected"))}function Kd(a,r){1&a&&(t.j41(0,"span"),t.nrm(1,"span",12),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","server.connecting"))}function Wd(a,r){1&a&&(t.j41(0,"span"),t.nrm(1,"span",12),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","server.menu.connect"))}function Zd(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",18)(1,"a",30),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.gameManager.stateManager.install())}),t.nrm(2,"img",31)(3,"span",12),t.k0s()()}2&a&&(t.R7$(3),t.Y8G("ghs-label","app.install"))}function Jd(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",18)(1,"a",32),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.close())}),t.nrm(2,"img",33),t.EFF(3,"\xa0 "),t.nrm(4,"span",12),t.k0s()()}2&a&&(t.R7$(),t.Y8G("routerLink","/"),t.R7$(3),t.Y8G("ghs-label","tools.backToGhs"))}function Qd(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",24)(1,"a",19),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.update())}),t.EFF(2,"<"),t.nrm(3,"span",12),t.EFF(4,"(!)>"),t.k0s()()}2&a&&(t.R7$(3),t.Y8G("ghs-label","update"))}function th(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",1)(1,"div",8),t.nVh(2,Nd,3,4,"span",9),t.j41(3,"a",10),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.gameManager.stateManager.undo())}),t.j41(4,"span",11),t.nrm(5,"span",12),t.k0s(),t.nVh(6,zd,2,7,"span",13),t.k0s(),t.j41(7,"span",14),t.bIt("click",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.openUndoDialog(e))}),t.nrm(8,"img",15),t.k0s(),t.j41(9,"a",16),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.gameManager.stateManager.redo())}),t.nrm(10,"span",12),t.nVh(11,Ld,2,7,"span",13),t.k0s()(),t.nrm(12,"div",17),t.nVh(13,qd,30,39),t.j41(14,"div",18)(15,"a",19),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.setActive(e.SubMenu.settings))}),t.nrm(16,"span",12),t.k0s()(),t.j41(17,"div",18)(18,"a",19),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.setActive(e.SubMenu.datamanagement))}),t.nrm(19,"span",12),t.k0s()(),t.nrm(20,"div",17),t.j41(21,"div",18)(22,"a",19),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.setActive(e.SubMenu.server))}),t.nVh(23,Hd,2,1,"span")(24,Kd,2,1,"span")(25,Wd,2,1,"span"),t.k0s()(),t.nrm(26,"div",17),t.j41(27,"div",18)(28,"a",19),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.setActive(e.SubMenu.about))}),t.nrm(29,"span",12),t.k0s()(),t.j41(30,"div",18)(31,"a",20),t.nrm(32,"span",12),t.k0s()(),t.nrm(33,"div",17),t.nVh(34,Zd,4,1,"div",18),t.j41(35,"div",18)(36,"a",19),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.feedbackDialog())}),t.nrm(37,"img",21),t.EFF(38,"\xa0 "),t.nrm(39,"span",12),t.k0s()(),t.j41(40,"div",18)(41,"a",22),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.keyboardShourtcutsDialog())}),t.nrm(42,"img",23),t.k0s()(),t.nVh(43,Jd,5,2,"div",18),t.nVh(44,Qd,5,1,"div",24),t.k0s()}if(2&a){let n;const i=t.XpG();t.R7$(2),t.vxM(i.undoOffset&&i.gameManager.stateManager.gameOffsetWarning?2:-1),t.R7$(),t.Y8G("ngClass",t.eq3(18,Ko,!i.gameManager.stateManager.undoPermission||i.undoOffset&&i.gameManager.stateManager.gameOffsetWarning||0==i.gameManager.stateManager.undos.length)),t.R7$(2),t.Y8G("ghs-label","state.undo"),t.R7$(),t.vxM(i.undoInfo.length>0?6:-1),t.R7$(3),t.Y8G("ngClass",t.eq3(20,Ko,!i.gameManager.stateManager.redoPermission||0==i.gameManager.stateManager.redos.length)),t.R7$(),t.Y8G("ghs-label","state.redo"),t.R7$(),t.vxM(i.redoInfo.length>0?11:-1),t.R7$(2),t.vxM(i.standalone?-1:13),t.R7$(3),t.Y8G("ghs-label","settings"),t.R7$(3),t.Y8G("ghs-label","datamanagement"),t.R7$(4),t.vxM((n=i.gameManager.stateManager.wsState())===i.WebSocket.OPEN?23:n===i.WebSocket.CONNECTING?24:25),t.R7$(6),t.Y8G("ghs-label","about"),t.R7$(3),t.Y8G("ghs-label","help"),t.R7$(2),t.vxM(i.gameManager.stateManager.installPrompt?34:-1),t.R7$(5),t.Y8G("ghs-label","tools.feedback"),t.R7$(2),t.Y8G("ghs-tooltip","tools.keyboard"),t.R7$(2),t.vxM(i.standalone?43:-1),t.R7$(),t.vxM(i.isUpdateAvailable()?44:-1)}}function nh(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-scenario-menu",34),t.bIt("close",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.close())}),t.k0s()}}function eh(a,r){1&a&&t.nrm(0,"ghs-section-menu")}function ah(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-character-menu",34),t.bIt("close",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.close())}),t.k0s()}}function ih(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-campaign-menu",34),t.bIt("close",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.close())}),t.k0s()}}function oh(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",18)(1,"a",35),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.removeCharacter(e))}),t.nrm(2,"img",36),t.j41(3,"span"),t.EFF(4),t.k0s()()()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(2),t.Y8G("src",n.iconUrl,t.B4B),t.R7$(2),t.JRh(i.gameManager.characterManager.characterName(n,!0))}}function sh(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",2)(1,"div",18)(2,"a",35),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.removeAllCharacters())}),t.EFF(3," <"),t.nrm(4,"span",12),t.EFF(5,"> "),t.k0s()(),t.Z7z(6,oh,5,2,"div",18,ui),t.nI1(8,"trackUUID"),t.k0s()}if(2&a){const n=t.XpG();t.R7$(4),t.Y8G("ghs-label","character.removeAll"),t.R7$(2),t.Dyx(t.bMT(8,1,n.characters()))}}function rh(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",3)(1,"div",18)(2,"a",35),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.addObjectiveContainer())}),t.nrm(3,"img",37)(4,"span",12),t.k0s()(),t.j41(5,"div",18)(6,"a",35),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.addObjectiveContainer(!0))}),t.nrm(7,"img",38)(8,"span",12),t.k0s()()()}2&a&&(t.R7$(4),t.Y8G("ghs-label","objective.add"),t.R7$(4),t.Y8G("ghs-label","escort.add"))}function ch(a,r){1&a&&t.nrm(0,"img",37)}function lh(a,r){1&a&&t.nrm(0,"img",38)}function gh(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.JRh(n.title)}}function dh(a,r){if(1&a&&t.nrm(0,"span",12),2&a){const n=t.XpG().$implicit;t.Y8G("ghs-label","data.objective."+n.name)}}function hh(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"("),t.k0s())}function _h(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,")"),t.k0s())}function mh(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",18)(1,"a",35),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.removeObjective(e))}),t.nVh(2,ch,1,0,"img",37),t.nVh(3,lh,1,0,"img",38),t.nVh(4,gh,2,1,"span"),t.nVh(5,dh,1,1,"span",12),t.nVh(6,hh,2,0,"span"),t.nrm(7,"span",12),t.nVh(8,_h,2,0,"span"),t.k0s()()}if(2&a){const n=r.$implicit;t.R7$(2),t.vxM(n.escort?-1:2),t.R7$(),t.vxM(n.escort?3:-1),t.R7$(),t.vxM(n.title?4:-1),t.R7$(),t.vxM(!n.title&&n.name?5:-1),t.R7$(),t.vxM(n.title||n.name?6:-1),t.R7$(),t.Y8G("ghs-label",n.escort?"escort":"objective"),t.R7$(),t.vxM(n.name?8:-1)}}function ph(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",4)(1,"div",18)(2,"a",35),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.removeAllObjectives())}),t.EFF(3," <"),t.nrm(4,"span",12),t.EFF(5,"> "),t.k0s()(),t.Z7z(6,mh,9,7,"div",18,ui),t.nI1(8,"trackUUID"),t.k0s()}if(2&a){const n=t.XpG();t.R7$(4),t.Y8G("ghs-label","objective.removeAll"),t.R7$(2),t.Dyx(t.bMT(8,1,n.objectives()))}}function uh(a,r){1&a&&t.nrm(0,"ghs-monster-menu")}function Ch(a,r){if(1&a&&(t.j41(0,"span",39),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.R7$(),t.SpI("\xa0(",i.gameManager.entityManager.entities(n).length,")")}}function Mh(a,r){if(1&a&&(t.j41(0,"span",40),t.EFF(1,"\xa0["),t.nrm(2,"span",12),t.EFF(3,"]"),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","data.edition."+i.gameManager.getEdition(n))}}function vh(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",18)(1,"a",35),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.removeMonster(e))}),t.nrm(2,"span",12),t.nVh(3,Ch,2,1,"span",39),t.nVh(4,Mh,4,1,"span",40),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","data.monster."+n.name),t.R7$(),t.vxM(i.gameManager.entityManager.entities(n).length>0?3:-1),t.R7$(),t.vxM(i.gameManager.getEdition(n)?4:-1)}}function Oh(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",18)(1,"a",35),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.removeAllMonsters(!0))}),t.EFF(2," <"),t.nrm(3,"span",12),t.EFF(4,"> "),t.k0s()()}2&a&&(t.R7$(3),t.Y8G("ghs-label","monster.removeUnused"))}function Ph(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",5)(1,"div",18)(2,"a",35),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.removeAllMonsters())}),t.EFF(3," <"),t.nrm(4,"span",12),t.EFF(5,"> "),t.k0s()(),t.Z7z(6,vh,5,3,"div",18,ui),t.nI1(8,"trackUUID"),t.nVh(9,Oh,5,1,"div",18),t.k0s()}if(2&a){const n=t.XpG();t.R7$(4),t.Y8G("ghs-label","monster.removeAll"),t.R7$(2),t.Dyx(t.bMT(8,2,n.monsters())),t.R7$(3),t.vxM(n.hasUnusedMonster()?9:-1)}}function bh(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-settings-menu",41),t.bIt("setMenu",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setActive(e))}),t.k0s()}}function kh(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-debug-menu",34),t.bIt("close",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.close())}),t.k0s()}}function yh(a,r){1&a&&t.nrm(0,"ghs-server-menu")}function xh(a,r){1&a&&t.nrm(0,"ghs-datamanagement-menu")}function Eh(a,r){1&a&&t.nrm(0,"ghs-datamanagement-menu",6),2&a&&t.Y8G("editionsOnly",!0)}function wh(a,r){1&a&&t.nrm(0,"ghs-about-menu")}function Rh(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",42),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.setActive(e.SubMenu.main))}),t.nrm(1,"img",33),t.k0s()}2&a&&t.Y8G("ghs-label","menu.backToMain")("ghs-label-attribute","title")}var In=function(a){return a.main="main",a.scenario="scenario",a.section="section",a.monster_add="monster_add",a.monster_remove="monster_remove",a.character_add="character_add",a.character_remove="character_remove",a.objective_add="objective_add",a.objective_remove="objective_remove",a.settings="settings",a.debug="debug",a.server="server",a.datamanagement="datamanagement",a.editions="editions",a.about="about",a.campaign="campaign",a}(In||{});let Zo=(()=>{class a{dialogRef;dialog;swUpdate;ghsManager;gameManager=s.E;settingsManager=p.f;GameState=D.mk;SubMenu=In;active=In.main;standalone=!1;hasSpoilers=F.KZ;isSpoiled=F.DJ;notSpoiled=F.gP;WebSocket=WebSocket;undoInfo=[];undoOffset=0;redoInfo=[];constructor(n,i,e,o,g){this.dialogRef=i,this.dialog=e,this.swUpdate=o,this.ghsManager=g,this.active=n.subMenu,this.standalone=n.standalone,this.dialogRef.overlayRef.hostElement.style.zIndex="3000",this.dialogRef.overlayRef.backdropElement&&(this.dialogRef.overlayRef.backdropElement.style.zIndex="3000")}ngOnInit(){this.updateUndoRedo(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.updateUndoRedo()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}close(){(0,F.co)(this.dialogRef)}updateUndoRedo(){const n=s.E.stateManager.undos,i=s.E.stateManager.redos,e=s.E.stateManager.undoInfos;n.length>0&&e.length>=n.length?(this.undoInfo=e[n.length-1],this.undoOffset=s.E.game.revision-(s.E.game.revisionOffset||0)-(n[n.length-1].revision-(n[n.length-1].revisionOffset||0))-1,this.undoInfo&&this.undoInfo.length>1&&"serverSync"==this.undoInfo[0]?this.undoInfo=s.E.game.state==D.mk.draw&&"setInitiative"==this.undoInfo[1]&&this.undoInfo.length>3?["serverSync",p.f.getLabel("state.info."+this.undoInfo[1],[this.undoInfo[2],""])]:["serverSync",p.f.getLabel("state.info."+this.undoInfo[1],this.undoInfo.slice(2))]:this.undoInfo&&1==this.undoInfo.length&&"serverSync"==this.undoInfo[0]?this.undoInfo=["serverSync",""]:this.undoInfo||(this.undoInfo=["unknown"])):(this.undoInfo=[],this.undoOffset=0),i.length>0&&e.length>n.length?(this.redoInfo=e[n.length],this.redoInfo&&this.redoInfo.length>1&&"serverSync"==this.redoInfo[0]?this.redoInfo="setInitiative"==this.redoInfo[1]&&this.redoInfo.length>3?["serverSync",p.f.getLabel("state.info."+this.redoInfo[1],[this.redoInfo[2],""])]:["serverSync",p.f.getLabel("state.info."+this.redoInfo[1],this.redoInfo.slice(2))]:this.redoInfo&&1==this.redoInfo.length&&"serverSync"==this.redoInfo[0]?this.redoInfo=["serverSync",""]:this.redoInfo||(this.redoInfo=["unknown"])):this.redoInfo=[]}openUndoDialog(n){this.dialog.open(Yd,{panelClass:["dialog"]}),this.close(),n.preventDefault(),n.stopPropagation()}setActive(n){this.active=n}hasSections(){return s.E.editionData.some(n=>n.edition==s.E.currentEdition()&&n.sections&&n.sections.length>0)}characters(){return s.E.game.figures.filter(n=>n instanceof H.K).map(n=>n).sort((n,i)=>{const e=s.E.characterManager.characterName(n).toLowerCase(),o=s.E.characterManager.characterName(i).toLowerCase();return e>o?1:e<o?-1:0})}objectives(){return s.E.game.figures.filter(n=>n instanceof ft.$e).map(n=>n).sort((n,i)=>{const e=(n.title?n.title:p.f.getLabel(n.name?"data.objective."+n.name:n.escort?"escort":"objective")).toLowerCase(),o=(i.title?i.title:p.f.getLabel(i.name?"data.objective."+i.name:i.escort?"escort":"objective")).toLowerCase();return e>o?1:e<o?-1:0})}monsters(){return s.E.game.figures.filter(n=>n instanceof b.R).map(n=>n).sort((n,i)=>{const e=p.f.getLabel("data.monster."+n.name).toLowerCase(),o=p.f.getLabel("data.monster."+i.name).toLowerCase();return e>o?1:e<o?-1:0})}removeCharacter(n){s.E.stateManager.before("removeChar",s.E.characterManager.characterName(n)),s.E.characterManager.removeCharacter(n),0==this.characters().length&&this.close(),s.E.stateManager.after()}removeAllCharacters(){s.E.stateManager.before("removeAllChars"),s.E.game.figures=s.E.game.figures.filter(n=>!(n instanceof H.K)),this.close(),s.E.stateManager.after()}addObjectiveContainer(n=!1){s.E.stateManager.before("addObjective"+(n?".escort":""));const i=s.E.objectiveManager.addObjective(new Ao("",n?3:7,n),n?"%escort%":"%objective%");s.E.objectiveManager.addObjectiveEntity(i),this.close(),s.E.stateManager.after()}removeObjective(n){s.E.stateManager.before("removeObjective",n.title||n.name),s.E.objectiveManager.removeObjective(n),0==this.objectives().length&&this.close(),s.E.stateManager.after()}removeAllObjectives(){s.E.stateManager.before("removeAllObjectives"),s.E.game.figures=s.E.game.figures.filter(n=>!(n instanceof ft.$e)),this.close(),s.E.stateManager.after()}removeMonster(n){s.E.stateManager.before("removeMonster","data.monster."+n.name),s.E.monsterManager.removeMonster(n),0==this.monsters().length&&this.close(),s.E.stateManager.after()}removeAllMonsters(n=!1){s.E.stateManager.before("removeAllMonster"),s.E.game.figures=s.E.game.figures.filter(i=>!(i instanceof b.R)||n&&i.entities.some(e=>s.E.entityManager.isAlive(e))),this.close(),s.E.stateManager.after()}hasAllMonster(){return s.E.monstersData().every(n=>s.E.game.figures.some(i=>i instanceof pe.f&&i.name==n.name&&i.edition==n.edition))}hasUnusedMonster(){return null!=s.E.game.figures.find(n=>n instanceof b.R&&n.entities.every(i=>!s.E.entityManager.isAlive(i)))&&null!=s.E.game.figures.find(n=>n instanceof b.R&&n.entities.some(i=>s.E.entityManager.isAlive(i)))}isUpdateAvailable(){return window.electron?window.electron.updateAvailable:s.E.stateManager.hasUpdate}update(n=!1){(this.isUpdateAvailable()||n)&&(window.electron?window.electron.quitAndInstall():this.swUpdate.isEnabled?this.swUpdate.activateUpdate().then(()=>{this.clearAndRefresh()}):this.clearAndRefresh())}clearAndRefresh(){return(0,I.A)(function*(){if("caches"in window){const n=yield caches.keys();yield Promise.all(n.map(function(){var i=(0,I.A)(function*(e){return yield caches.delete(e)});return function(e){return i.apply(this,arguments)}}()))}window.location.reload()})()}feedbackDialog(){this.dialog.open(Uo,{panelClass:["dialog"]}),this.close()}keyboardShourtcutsDialog(){this.dialog.open(No,{panelClass:["dialog"]}),this.close()}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG),t.rXU(R.EI),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-main-menu"]],standalone:!1,decls:18,vars:2,consts:[[1,"scroll-container"],[1,"menu-container","main","two-column"],[1,"menu-container","character-remove"],[1,"menu-container","objective-add"],[1,"menu-container","objective-remove"],[1,"menu-container","monster-remove"],[3,"editionsOnly"],["tabclick","",1,"back",3,"ghs-label","ghs-label-attribute"],[1,"line","state-container","span"],[1,"warning"],["tabclick","",1,"state","undo",3,"click","ngClass"],[1,"undo-text"],[3,"ghs-label"],[1,"info","text-white",3,"ghs-label","ghs-label-args","ghs-label-empty"],["tabclick","",1,"undo-dialog",3,"click"],["src","./assets/images/long-rest.svg",1,"ghs-svg"],["tabclick","",1,"state","redo",3,"click","ngClass"],[1,"separator"],[1,"line"],["tabclick","",3,"click"],["href","https://help.gloomhaven-secretariat.de","target","_blank"],["src","./assets/images/hint.svg",1,"ghs-svg"],["tabclick","",3,"click","ghs-tooltip"],["src","./assets/images/keyboard.svg",1,"ghs-svg"],[1,"line","separator"],[1,"warning",3,"click"],["src","./assets/images/warning.svg"],[3,"ghs-label","ghs-label-args"],[1,"line",3,"ngClass"],[1,"line","span"],[1,"install",3,"click"],["src","./assets/images/install.svg",1,"ghs-svg"],["tabclick","",3,"click","routerLink"],["src","./assets/images/left.svg",1,"ghs-svg"],[3,"close"],[3,"click"],[1,"icon",3,"src"],["src","./assets/images/objective/objective.svg",1,"icon"],["src","./assets/images/objective/escort.svg",1,"icon"],[1,"count"],[1,"edition"],[3,"setMenu"],["tabclick","",1,"back",3,"click","ghs-label","ghs-label-attribute"]],template:function(i,e){if(1&i&&(t.j41(0,"div",0),t.nVh(1,th,45,22,"div",1)(2,nh,1,0,"ghs-scenario-menu")(3,eh,1,0,"ghs-section-menu")(4,ah,1,0,"ghs-character-menu")(5,ih,1,0,"ghs-campaign-menu")(6,sh,9,3,"div",2)(7,rh,9,2,"div",3)(8,ph,9,3,"div",4)(9,uh,1,0,"ghs-monster-menu")(10,Ph,10,4,"div",5)(11,bh,1,0,"ghs-settings-menu")(12,kh,1,0,"ghs-debug-menu")(13,yh,1,0,"ghs-server-menu")(14,xh,1,0,"ghs-datamanagement-menu")(15,Eh,1,1,"ghs-datamanagement-menu",6)(16,wh,1,0,"ghs-about-menu"),t.k0s(),t.nVh(17,Rh,2,2,"div",7)),2&i){let o;t.R7$(),t.vxM((o=e.active)===e.SubMenu.main?1:o===e.SubMenu.scenario?2:o===e.SubMenu.section?3:o===e.SubMenu.character_add?4:o===e.SubMenu.campaign?5:o===e.SubMenu.character_remove?6:o===e.SubMenu.objective_add?7:o===e.SubMenu.objective_remove?8:o===e.SubMenu.monster_add?9:o===e.SubMenu.monster_remove?10:o===e.SubMenu.settings?11:o===e.SubMenu.debug?12:o===e.SubMenu.server?13:o===e.SubMenu.datamanagement?14:o===e.SubMenu.editions?15:o===e.SubMenu.about?16:-1),t.R7$(16),t.vxM(e.active!=e.SubMenu.main?17:-1)}},styles:['[_nghost-%COMP%]{position:relative;z-index:9999}.hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:break-spaces}.back[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled[_ngcontent-%COMP%]{pointer-events:none}.back.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container[_ngcontent-%COMP%]{z-index:1}.menu-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.no-grow[_ngcontent-%COMP%]{flex-grow:0}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container.inline[_ngcontent-%COMP%]{width:initial;margin-right:1em}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex-wrap:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-gray)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{filter:grayscale(1)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm-delete[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]{align-items:flex-start}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]   .undo-text[_ngcontent-%COMP%]{display:flex;align-items:center}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.redo[_ngcontent-%COMP%]{align-items:flex-end}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]:hover{opacity:.7}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover{cursor:pointer}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog.disabled[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)!important}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]{border-bottom:none;margin-bottom:0}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container[_ngcontent-%COMP%]   .line.sticky.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container[_ngcontent-%COMP%]   .line.sticky.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .add[_ngcontent-%COMP%]{display:inherit}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%] ~ .spoiler[_ngcontent-%COMP%]{margin-top:0;border-top:none}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]{display:flex;cursor:pointer}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]   .span-xs[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns.columns-break[_ngcontent-%COMP%]{flex-wrap:wrap}}']})}return a})(),fi=(()=>{class a{dialogRef;label;args;constructor(n,i){this.dialogRef=i,n.label||this.dialogRef.close(),this.label=n.label,this.args=n.args||[]}cancel(){(0,F.co)(this.dialogRef,!1)}confirm(){(0,F.co)(this.dialogRef,!0)}keydown(n){p.f.settings.keyboardShortcuts&&"Enter"===n.key&&(this.confirm(),n.preventDefault(),n.stopPropagation())}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-confirm-dialog"]],hostBindings:function(i,e){1&i&&t.bIt("keydown",function(g){return e.keydown(g)},t.EBC)},standalone:!1,decls:6,vars:4,consts:[[1,"confirm-dialog"],[1,"title",3,"ghs-label","ghs-label-args"],[1,"menu"],[1,"cancel",3,"click"],[3,"ghs-label"],[1,"confirm",3,"click","ghs-label"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nrm(1,"div",1),t.j41(2,"div",2)(3,"a",3),t.bIt("click",function(){return e.cancel()}),t.nrm(4,"span",4),t.k0s(),t.j41(5,"a",5),t.bIt("click",function(){return e.confirm()}),t.k0s()()()),2&i&&(t.R7$(),t.Y8G("ghs-label",e.label)("ghs-label-args",e.args),t.R7$(3),t.Y8G("ghs-label","cancel"),t.R7$(),t.Y8G("ghs-label","confirm"))},dependencies:[it],styles:[".confirm-dialog[_ngcontent-%COMP%]{position:relative;color:var(--ghs-color-white)}.confirm-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.confirm-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center}.confirm-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:2em;padding:.3em}.confirm-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.confirm-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-green)}"]})}return a})();var _t=v(8164);const jh=a=>({vertical:a});function Gh(a,r){if(1&a&&(t.nrm(0,"img",7),t.EFF(1)),2&a){const n=t.XpG();t.Y8G("src",n.character.iconUrl,t.B4B),t.R7$(),t.SpI(" ",n.gameManager.characterManager.characterName(n.character,!0)," \xa0 ")}}function Th(a,r){1&a&&t.nrm(0,"img",8)}function Sh(a,r){1&a&&(t.j41(0,"span"),t.nrm(1,"span",3),t.EFF(2,"\xa0"),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","monster"))}function Dh(a,r){1&a&&(t.j41(0,"span"),t.nrm(1,"span",3),t.EFF(2,"\xa0"),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","game.ally"))}function $h(a,r){if(1&a&&(t.nVh(0,Th,1,0,"img",8),t.nVh(1,Sh,3,1,"span"),t.nVh(2,Dh,3,1,"span")),2&a){const n=t.XpG();t.vxM("m"==n.numeration?0:-1),t.R7$(),t.vxM("m"==n.numeration?1:-1),t.R7$(),t.vxM("A"==n.numeration?2:-1)}}function Ih(a,r){1&a&&t.nrm(0,"span",3),2&a&&t.Y8G("ghs-label","game.attackModifiers")}function Ah(a,r){1&a&&t.nrm(0,"span",3),2&a&&t.Y8G("ghs-label","party.campaign.townGuardDeck")}function Vh(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.SpI("\xa0",n.numeration)}}let Ci=(()=>{class a{dialogRef;deck;character;ally;numeration="";newStyle=!1;townGuard=!1;before;after;gameManager=s.E;constructor(n,i){this.dialogRef=i,this.deck=n.deck,this.character=n.character,this.ally=n.ally,this.numeration=n.numeration,this.newStyle=n.newStyle,this.townGuard=n.townGuard,this.before=n.before,this.after=n.after}beforeAttackModifierDeck(n){this.before.emit(n)}afterAttackModifierDeck(n){this.after.emit(n)}vertical(){return window.innerWidth<800}close(){(0,F.co)(this.dialogRef)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-attackmodifier-deck-fullscreen"]],standalone:!1,decls:12,vars:16,consts:[[1,"attack-modifiers-fullscreen"],[1,"header"],[1,"title"],[3,"ghs-label"],[1,"attack-modifierdeck-container",3,"ngClass"],[3,"before","after","deck","character","ally","numeration","fullscreen","vertical","townGuard","initTimeout"],[1,"close-container",3,"click"],[1,"icon",3,"src"],["src","./assets/images/monster/enemy.png",1,"icon"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.nVh(3,Gh,2,2),t.nVh(4,$h,3,3),t.nVh(5,Ih,1,1,"span",3),t.nVh(6,Ah,1,1,"span",3),t.nVh(7,Vh,2,1,"span"),t.k0s()(),t.j41(8,"div",4)(9,"ghs-attackmodifier-deck",5),t.bIt("before",function(g){return e.beforeAttackModifierDeck(g)})("after",function(g){return e.afterAttackModifierDeck(g)}),t.k0s(),t.j41(10,"div",6),t.bIt("click",function(){return e.close()}),t.k0s()(),t.j41(11,"div",6),t.bIt("click",function(){return e.close()}),t.k0s()()),2&i&&(t.R7$(3),t.vxM(e.character?3:-1),t.R7$(),t.vxM(e.character||e.townGuard?-1:4),t.R7$(),t.vxM(e.townGuard?-1:5),t.R7$(),t.vxM(e.townGuard?6:-1),t.R7$(),t.vxM(e.character||"m"==e.numeration||"A"==e.numeration?-1:7),t.R7$(),t.Y8G("ngClass",t.eq3(14,jh,e.vertical())),t.R7$(),t.Y8G("deck",e.deck)("character",e.character)("ally",e.ally)("numeration",e.numeration)("fullscreen",!1)("vertical",e.vertical())("townGuard",e.townGuard)("initTimeout",1))},styles:[".attack-modifiers-fullscreen[_ngcontent-%COMP%]{width:100vw;height:100vh}.attack-modifiers-fullscreen[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:flex-start;align-items:center;z-index:1}.attack-modifiers-fullscreen[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));cursor:initial}.attack-modifiers-fullscreen[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 10 * var(--ghs-text-factor));width:auto;margin-right:.2em}.attack-modifiers-fullscreen[_ngcontent-%COMP%]   .attack-modifierdeck-container[_ngcontent-%COMP%]{position:relative;width:100%;height:30vw;max-height:350px;overflow-x:auto;display:flex;flex-direction:column;justify-content:flex-start;align-items:center;z-index:3}.attack-modifiers-fullscreen[_ngcontent-%COMP%]   .attack-modifierdeck-container[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{display:flex;width:99vw;max-width:800px;height:25.5vw;max-height:213px;z-index:3;margin-top:2em;margin-left:1%}.attack-modifiers-fullscreen[_ngcontent-%COMP%]   .attack-modifierdeck-container.vertical[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden;width:99vw;max-width:800px;height:100%;max-height:initial}.attack-modifiers-fullscreen[_ngcontent-%COMP%]   .attack-modifierdeck-container.vertical[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{width:98vw;margin-right:1%;height:calc(100% - var(--ghs-unit) * 10 * var(--ghs-text-factor));max-height:initial;transform:none}.attack-modifiers-fullscreen[_ngcontent-%COMP%]   .close-container[_ngcontent-%COMP%]{cursor:zoom-out;position:absolute;display:flex;width:100%;height:100%;z-index:2;top:0;left:0}"]})}return a})();var yt=v(57);let Nn=(()=>{class a{el;disabled=!1;clicked=!1;change=new t.bkB;constructor(n){this.el=n,this.el.nativeElement.classList.add("reveal")}onClick(){this.disabled?this.clicked&&(this.clicked=!1,this.el.nativeElement.classList.remove("confirm")):this.el.nativeElement.classList.contains("flipped")?(this.el.nativeElement.classList.remove("flipped"),setTimeout(()=>{this.change.emit(!1)},p.f.settings.animations?1e3*p.f.settings.animationSpeed:0)):this.clicked?(this.el.nativeElement.classList.add("flipped"),setTimeout(()=>{this.change.emit(!0)},p.f.settings.animations?1e3*p.f.settings.animationSpeed:0),this.clicked=!1,this.el.nativeElement.classList.remove("confirm")):(this.clicked=!0,this.el.nativeElement.classList.add("confirm"))}onMouseLeave(){(!this.disabled||this.clicked)&&(this.clicked=!1,this.el.nativeElement.classList.remove("confirm"))}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT))};static \u0275dir=t.FsC({type:a,selectors:[["","card-reveal",""]],hostBindings:function(i,e){1&i&&t.bIt("pointerdown",function(){return e.onClick()})("mouseleave",function(){return e.onMouseLeave()})},inputs:{disabled:"disabled"},outputs:{change:"change"},standalone:!1})}return a})(),Me=(()=>{class a{transform(n,...i){return(0,F.n1)(n,i.includes("empty"))}static \u0275fac=function(i){return new(i||a)};static \u0275pipe=t.EJ8({name:"ghsValueSign",type:a,pure:!0,standalone:!1})}return a})(),At=(()=>{class a{transform(n,i,e=!1){let o=[];for(let g=0;g<i;g++)o.push(e?i-g-1:g);return o}static \u0275fac=function(i){return new(i||a)};static \u0275pipe=t.EJ8({name:"ghsRange",type:a,pure:!0,standalone:!1})}return a})(),Jo=(()=>{class a{transform(n){return Math.floor(n)}static \u0275fac=function(i){return new(i||a)};static \u0275pipe=t.EJ8({name:"ghsFloor",type:a,pure:!0,standalone:!1})}return a})(),Fh=(()=>{class a{transform(n){return Math.ceil(n)}static \u0275fac=function(i){return new(i||a)};static \u0275pipe=t.EJ8({name:"ghsCeil",type:a,pure:!0,standalone:!1})}return a})(),Ma=(()=>{class a{transform(n){return n<0?0:n}static \u0275fac=function(i){return new(i||a)};static \u0275pipe=t.EJ8({name:"ghsMinZero",type:a,pure:!0,standalone:!1})}return a})(),Mi=(()=>{class a{transform(n,i=!1){return(0,F.T8)(n,i)}static \u0275fac=function(i){return new(i||a)};static \u0275pipe=t.EJ8({name:"ghsDurationLabel",type:a,pure:!0,standalone:!1})}return a})(),Xh=(()=>{class a{transform(n,i){return n&&0!==n.length?n.filter(e=>{if(!i||""==i)return!0;i=i.toLowerCase();let o=e.index.toLowerCase(),g=0;for(;i.startsWith("0");)g++,i=i.replace("0","");for(let m=0;m<g;m++)o.length<(i="0"+i).length&&(o="0"+o);return!!o.includes(i)||p.f.getLabel(e.name).toLowerCase().includes(i)}):[]}static \u0275fac=function(i){return new(i||a)};static \u0275pipe=t.EJ8({name:"ghsScenarioSearch",type:a,pure:!0,standalone:!1})}return a})();const Bh=(a,r,n,i,e)=>({flipped:a,selected:r,disabled:n,filtered:i,fh:e}),Yh=()=>[];function Uh(a,r){1&a&&t.nrm(0,"img",11)}function Nh(a,r){1&a&&t.nrm(0,"img",13)}function zh(a,r){if(1&a&&(t.nrm(0,"div",7),t.j41(1,"div",8),t.nrm(2,"span",9),t.k0s(),t.j41(3,"div",10),t.Z7z(4,Uh,1,0,"img",11,t.fX1),t.nI1(6,"ghsRange"),t.k0s(),t.j41(7,"div",12),t.EFF(8),t.nVh(9,Nh,1,0,"img",13),t.k0s()),2&a){const n=t.XpG();t.Y8G("ghs-label","data.battleGoals."+n.battleGoal.cardId),t.R7$(2),t.Y8G("ghs-label","data.battleGoals."+n.battleGoal.cardId+".text"),t.R7$(2),t.Dyx(t.i5U(6,4,t.lJ4(7,Yh),n.battleGoal.checks)),t.R7$(4),t.SpI(" ",n.battleGoal.cardId," "),t.R7$(),t.vxM(n.winterIcon?9:-1)}}let vi=(()=>{class a{gameManager=s.E;settingsManager=p.f;battleGoal;identifier;flipped=!1;selected=!1;disabled=!1;filtered=!1;reveal=!1;winterIcon=!1;ngOnChanges(n){n.identifier&&n.identifier.previousValue!=n.identifier.currentValue&&!this.battleGoal&&this.identifier&&(this.battleGoal=s.E.battleGoalManager.getBattleGoal(this.identifier)),this.battleGoal&&"fh"==this.battleGoal.edition&&(this.winterIcon=!0)}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-battlegoal"]],inputs:{battleGoal:"battleGoal",identifier:"identifier",flipped:"flipped",selected:"selected",disabled:"disabled",filtered:"filtered",reveal:"reveal"},standalone:!1,features:[t.OA$],decls:8,vars:12,consts:[["container",""],[1,"battlegoal-container"],["card-reveal","",1,"card","vertical","reverse","battlegoal",3,"ngClass","disabled"],[1,"card-back"],[1,"revealed"],[1,"text",3,"ghs-label"],[1,"card-front"],[1,"name",3,"ghs-label"],[1,"text"],[1,"placeholder",3,"ghs-label"],[1,"checks"],["src","./assets/images/check.svg"],[1,"card-id"],["src","./assets/images/fh/battlegoals/winter.svg"]],template:function(i,e){if(1&i&&(t.j41(0,"div",1,0)(2,"div",2)(3,"div",3)(4,"span",4),t.nrm(5,"span",5),t.k0s()(),t.j41(6,"div",6),t.nVh(7,zh,10,8),t.k0s()()()),2&i){const o=t.sdS(1);t.R7$(2),t.xc7("font-size",.072*o.offsetWidth+"px"),t.Y8G("ngClass",t.s1E(6,Bh,e.flipped,e.selected,e.disabled,e.filtered,!!e.battleGoal&&"fh"==e.battleGoal.edition))("disabled",!e.reveal),t.R7$(3),t.Y8G("ghs-label","game.cards.confirmReveal"),t.R7$(2),t.vxM(e.battleGoal?7:-1)}},dependencies:[N.YU,Nn,it,At],styles:[".battlegoal-container[_ngcontent-%COMP%]{position:relative;width:100%;padding-bottom:147%}.battlegoal[_ngcontent-%COMP%]{cursor:pointer;position:absolute;width:100%;height:100%;border:.2em solid transparent;border-radius:.5em}.battlegoal[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]{background-image:url(battle-goal-front.e7531094c588ed2e.png);background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:.5em}.battlegoal[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;top:22.5%;left:50%;width:60%;height:10%;display:flex;justify-content:center;align-items:center;transform:translate(-50%);font-family:var(--ghs-font-title);color:var(--ghs-color-black);font-size:1.5em}.battlegoal[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{position:absolute;top:30%;left:50%;width:55%;height:40%;display:flex;justify-content:center;align-items:center;text-align:center;transform:translate(-50%);font-family:var(--ghs-font-text);color:var(--ghs-color-black);font-size:1em;line-height:1em}.battlegoal[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]{position:absolute;top:70%;left:50%;width:60%;height:10%;display:flex;justify-content:center;align-items:center;transform:translate(-50%)}.battlegoal[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1.5em;width:auto;margin:0 .2em}.battlegoal[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{position:absolute;top:80%;left:50%;width:60%;height:10%;display:flex;justify-content:center;align-items:center;text-align:center;text-transform:uppercase;transform:translate(-50%);font-family:var(--ghs-font-normal);font-size:.75em;color:var(--ghs-color-white);filter:var(--ghs-filter-outline-thin)}.battlegoal[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]{background-image:url(battle-goal-back.d069b60d499428ec.png);background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:.5em}.battlegoal.confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center;text-align:center;color:var(--ghs-color-white);font-size:1.5em;filter:drop-shadow(calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) var(--ghs-color-black))}.battlegoal.confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{text-align:center}.battlegoal.disabled[_ngcontent-%COMP%]{cursor:initial}.battlegoal.selected[_ngcontent-%COMP%]{border-color:var(--ghs-color-green)}.battlegoal.filtered[_ngcontent-%COMP%]{border-color:var(--ghs-color-red)}.battlegoal.fh[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]{background-image:url(battle-goal-front-fh.9cbd213e8708b674.png)}.battlegoal.fh[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal)}.battlegoal.fh[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{color:var(--ghs-color-brown);filter:none;font-weight:700}.battlegoal.fh[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto;margin-left:.1em;filter:var(--ghs-filter-brown)}.battlegoal.fh[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]{background-image:url(battle-goal-back-fh.60856d4f807bfc05.png)}"]})}return a})();var va=v(1311);let ct=(()=>{class a{transform(n,i){return n&&0!==n.length?(n.forEach((e,o)=>this.createUUID(e,o,i)),n):[]}createUUID(n,i,e){if(n&&!n._trackUUID){const o=(0,va.A)()+"-"+i;Object.defineProperty(n,"_trackUUID",{value:o,writable:!0,enumerable:!1,configurable:!1})}e&&0!==e.length&&e.forEach(o=>{Array.isArray(n[o])&&n[o].forEach((g,m)=>this.createUUID(g,m,e))})}static \u0275fac=function(i){return new(i||a)};static \u0275pipe=t.EJ8({name:"trackUUID",type:a,pure:!0,standalone:!1})}return a})();const Qo=a=>({selected:a}),Lh=a=>[a],qh=a=>({disabled:a}),Hh=(a,r)=>r._trackUUID;function Kh(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",4)(1,"span",10),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.selectEdition(e))}),t.k0s(),t.j41(2,"span",6),t.EFF(3),t.k0s(),t.j41(4,"input",11),t.bIt("change",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.toggleEdition(e))}),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG();t.R7$(),t.Y8G("ghs-label","game.battleGoals.edition")("ghs-label-args",t.eq3(6,Lh,n))("ngClass",t.eq3(8,Qo,n==i.currentEdition)),t.R7$(2),t.SpI("(",i.gameManager.battleGoalManager.getBattleGoalsForEdition(n).length,")"),t.R7$(),t.Y8G("checked",i.gameManager.game.battleGoalEditions.includes(n)||i.gameManager.editionRules(n,!1))("disabled",i.gameManager.editionRules(n,!1))}}function Wh(a,r){1&a&&t.nrm(0,"span",8),2&a&&t.Y8G("ghs-label","game.battleGoals.setup.empty")}function Zh(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-battlegoal",12),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.toggleFilter(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("battleGoal",n)("flipped",!0)("disabled",!i.selected(n)&&!i.filtered(n)||i.selectedAlias(n))("reveal",!1)("selected",!i.selectedAlias(n)&&i.selected(n))("filtered",i.filtered(n))("ngClass",t.eq3(7,qh,i.selectedAlias(n)))}}let Oa=(()=>{class a{gameManager=s.E;currentEdition="";editions=[];battleGoals=[];constructor(){this.editions=s.E.battleGoalManager.getBattleGoalEditions(),s.E.game.edition&&s.E.battleGoalManager.getBattleGoalEditions().includes(s.E.game.edition)&&(!s.E.game.battleGoalEditions||0==s.E.game.battleGoalEditions.length||1==s.E.game.battleGoalEditions.length&&s.E.game.battleGoalEditions.includes(s.E.game.edition))&&this.selectEdition(s.E.game.edition),this.update()}selectedAlias(n){const i=s.E.game.edition;return n.alias&&(!i||n.edition!=i)&&null!=s.E.battleGoalManager.getBattleGoals(!0,!0).find(e=>n.alias&&e.edition==n.alias.edition&&e.name==n.alias.name)||i&&n.edition!=i&&null!=s.E.battleGoalManager.getBattleGoals(!0,!0).find(e=>e.edition==i&&e.alias&&n.edition==e.alias.edition&&n.name==e.alias.name)||!1}selectEdition(n=""){this.currentEdition=n,this.update()}update(){this.battleGoals=this.currentEdition?s.E.battleGoalManager.getBattleGoalsForEdition(this.currentEdition):s.E.battleGoalManager.getBattleGoals(!1,!0)}toggleEdition(n){s.E.editionRules(n,!1)||(s.E.game.battleGoalEditions=s.E.game.battleGoalEditions||[],s.E.game.filteredBattleGoals=s.E.game.filteredBattleGoals||[],s.E.stateManager.before("battleGoals.setup."+(s.E.game.battleGoalEditions.includes(n)?"removeEdition":"addEdition"),n),s.E.game.battleGoalEditions.includes(n)?(s.E.game.battleGoalEditions=s.E.game.battleGoalEditions.filter(i=>i!=n),s.E.game.filteredBattleGoals=s.E.game.filteredBattleGoals.filter(i=>i.edition!=n)):s.E.game.battleGoalEditions.push(n),s.E.stateManager.after(),this.update())}selected(n){return!this.filtered(n)&&(n.edition==s.E.game.edition||s.E.game.battleGoalEditions.includes(n.edition))}filtered(n){return null!=s.E.game.filteredBattleGoals.find(i=>i.edition==n.edition&&i.name==n.name)}toggleFilter(n){s.E.game.filteredBattleGoals=s.E.game.filteredBattleGoals||[],s.E.stateManager.before("battleGoals.setup.filter."+(this.filtered(n)?"addCard":"removeCard"),n.edition,n.name),this.filtered(n)?s.E.game.filteredBattleGoals=s.E.game.filteredBattleGoals.filter(i=>i.edition!=n.edition||i.name!=n.name):this.selected(n)&&!this.selectedAlias(n)&&s.E.game.filteredBattleGoals.push(new yt.gw(n.name,n.edition)),s.E.stateManager.after(),this.update()}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-battlegoal-setup"]],standalone:!1,decls:15,vars:9,consts:[[1,"battle-goals-setup-dialog"],[1,"scroll-container"],[1,"header",3,"ghs-label"],[1,"editions"],[1,"edition"],[1,"name",3,"click","ghs-label","ngClass"],[1,"size"],[1,"battle-goals"],[1,"warning",3,"ghs-label"],[1,"battlegoal",3,"battleGoal","flipped","disabled","reveal","selected","filtered","ngClass"],[1,"name",3,"click","ghs-label","ghs-label-args","ngClass"],["type","checkbox",3,"change","checked","disabled"],[1,"battlegoal",3,"click","battleGoal","flipped","disabled","reveal","selected","filtered","ngClass"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"div",2),t.j41(3,"div",3)(4,"div",4)(5,"span",5),t.bIt("click",function(){return e.selectEdition()}),t.k0s(),t.j41(6,"span",6),t.EFF(7),t.k0s()(),t.Z7z(8,Kh,5,10,"div",4,t.fX1),t.k0s(),t.j41(10,"div",7),t.nVh(11,Wh,1,1,"span",8),t.Z7z(12,Zh,1,9,"ghs-battlegoal",9,Hh),t.nI1(14,"trackUUID"),t.k0s()()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","game.battleGoals.setup"),t.R7$(3),t.Y8G("ghs-label","game.battleGoals.all")("ngClass",t.eq3(7,Qo,""==e.currentEdition)),t.R7$(2),t.SpI("(",e.gameManager.battleGoalManager.getBattleGoals().length,")"),t.R7$(),t.Dyx(e.editions),t.R7$(3),t.vxM(0==e.battleGoals.length?11:-1),t.R7$(),t.Dyx(t.bMT(14,5,e.battleGoals)))},dependencies:[N.YU,vi,it,ct],styles:[".battle-goals-setup-dialog[_ngcontent-%COMP%]{position:relative;width:100%}.battle-goals-setup-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.battle-goals-setup-dialog[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;flex-wrap:wrap}.battle-goals-setup-dialog[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.battle-goals-setup-dialog[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{cursor:pointer}.battle-goals-setup-dialog[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]   .name.selected[_ngcontent-%COMP%]{color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));font-weight:700}.battle-goals-setup-dialog[_ngcontent-%COMP%]   .battle-goals[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;margin:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.battle-goals-setup-dialog[_ngcontent-%COMP%]   .battle-goals[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-yellow)}.battle-goals-setup-dialog[_ngcontent-%COMP%]   .battle-goals[_ngcontent-%COMP%]   ghs-battlegoal[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 25 * var(--ghs-dialog-factor))}.battle-goals-setup-dialog[_ngcontent-%COMP%]   .battle-goals[_ngcontent-%COMP%]   ghs-battlegoal.disabled[_ngcontent-%COMP%]{opacity:.5}@media (max-width: 600px),(orientation: portrait){.battle-goals-setup-dialog[_ngcontent-%COMP%]   .battle-goals[_ngcontent-%COMP%]{flex-direction:column;align-items:center}}"]})}return a})();const Jh=(a,r)=>[a,r],Qh=a=>({disabled:a}),t_=(a,r)=>r._trackUUID;function n_(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-battlegoal",7),t.bIt("singleClick",function(){const e=c.eBV(n).$index,o=t.XpG();return c.Njj(o.select(e))})("doubleClick",function(){const e=c.eBV(n).$index,o=t.XpG();return c.Njj(o.select(e,!0))}),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG();t.Y8G("battleGoal",n)("flipped",e.gameManager.roundManager.firstRound||e.selected==i||!e.character.battleGoal||e.revealed.includes(i)||e.trial349||e.trial356&&e.battleGoals.length>3&&i<e.battleGoals.length-2||e.cardOnly)("selected",e.selected==i||e.trial349||e.trial356&&e.battleGoals.length>3&&i<e.battleGoals.length-2)("reveal",!e.cardOnly&&e.gameManager.game.round>0&&e.selected!=i&&e.character.battleGoal&&!e.revealed.includes(i))("disabled",e.character.battleGoal&&!!e.gameManager.game.scenario&&e.gameManager.game.round>0||!1)}}function e_(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",5)(1,"a",8),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.cancel())}),t.k0s(),t.j41(2,"a",9),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.accept())}),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","game.battleGoals.cancel"),t.R7$(),t.Y8G("ngClass",t.eq3(3,Qh,-1==n.selected&&!n.trial349))("ghs-label","game.battleGoals.chooseCard")}}function a_(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",12),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.drawCards())}),t.k0s()}2&a&&t.Y8G("ghs-label","game.battleGoals.drawCards")}function i_(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",12),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.drawCard())}),t.k0s()}2&a&&t.Y8G("ghs-label","game.battleGoals.drawCard")}function o_(a,r){1&a&&t.nrm(0,"p",11),2&a&&t.Y8G("ghs-label","game.battleGoals.drawUnavailable")}function s_(a,r){if(1&a&&(t.j41(0,"div",6),t.nVh(1,a_,1,1,"a",10),t.nVh(2,i_,1,1,"a",10),t.nVh(3,o_,1,1,"p",11),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.vxM(n.redrawAvailable?1:-1),t.R7$(),t.vxM(n.available?2:-1),t.R7$(),t.vxM(n.available&&n.redrawAvailable?-1:3)}}function r_(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",6)(1,"a",12),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.setup())}),t.k0s()()}2&a&&(t.R7$(),t.Y8G("ghs-label","game.battleGoals.setup"))}let Oi=(()=>{class a{dialogRef;dialog;ghsManager;gameManager=s.E;battleGoals=[];revealed=[];character;selected;available=0;redrawAvailable=0;cardOnly=!1;trial349=!1;trial356=!1;constructor(n,i,e,o){this.dialogRef=i,this.dialog=e,this.ghsManager=o,this.character=n.character,this.selected=this.character.battleGoal?0:-1,this.cardOnly=n.cardOnly,0==s.E.battleGoalManager.getBattleGoals().length?this.dialog.open(Oa,{panelClass:["dialog"]}).closed.subscribe({next:()=>{this.available=s.E.battleGoalManager.getUnrevealedBattleGoals().length,this.redrawAvailable=s.E.battleGoalManager.getUnrevealedBattleGoals(this.character).length,this.redrawAvailable>(s.E.fhRules(!0)||p.f.settings.battleGoalsFh?2:1)&&n.draw?this.drawCards():this.close()}}):n.draw?(this.available=s.E.battleGoalManager.getUnrevealedBattleGoals().length,this.redrawAvailable=s.E.battleGoalManager.getUnrevealedBattleGoals(this.character).length,this.drawCards()):this.update(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.character=s.E.game.figures.find(g=>g instanceof H.K&&g.edition==this.character.edition&&g.name==this.character.name)||this.character,this.selected=this.character.battleGoal?0:-1,this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}drawCards(){this.redrawAvailable&&(s.E.stateManager.before("battleGoals.drawCards",s.E.characterManager.characterName(this.character)),this.character.battleGoals=[],this.character.battleGoal=!1,s.E.battleGoalManager.drawBattleGoal(this.character),(!s.E.trialsManager.apply||!s.E.trialsManager.activeTrial("fh",360))&&(s.E.battleGoalManager.drawBattleGoal(this.character),(s.E.fhRules(!0)||p.f.settings.battleGoalsFh)&&s.E.battleGoalManager.drawBattleGoal(this.character)),s.E.stateManager.after()),this.update()}update(){this.available=s.E.battleGoalManager.getUnrevealedBattleGoals().length,this.redrawAvailable=s.E.battleGoalManager.getUnrevealedBattleGoals(this.character).length,this.battleGoals=this.character.battleGoals.map(n=>s.E.battleGoalManager.getBattleGoal(n)).filter(n=>n).map(n=>n),this.character.battleGoal&&!this.revealed.includes(0)&&this.revealed.push(0),this.trial349=s.E.trialsManager.apply&&s.E.trialsManager.trialsEnabled&&this.character.progress.trial&&"fh"==this.character.progress.trial.edition&&"349"==this.character.progress.trial.name||!1,this.trial356=s.E.trialsManager.apply&&s.E.trialsManager.trialsEnabled&&this.character.progress.trial&&"fh"==this.character.progress.trial.edition&&"356"==this.character.progress.trial.name||!1}drawCard(){this.available&&(s.E.stateManager.before("battleGoals.drawCard",s.E.characterManager.characterName(this.character)),s.E.battleGoalManager.drawBattleGoal(this.character,this.trial356),s.E.stateManager.after()),this.update()}select(n,i=!1){!this.cardOnly&&(i||!this.character.battleGoal||s.E.roundManager.firstRound)&&!this.trial349&&(this.revealed.includes(n)||this.revealed.push(n),-1!=this.selected&&!this.revealed.includes(this.selected)&&this.revealed.push(this.selected),this.selected=this.selected==n?-1:n)}setup(){this.dialog.open(Oa,{panelClass:["dialog"]}).closed.subscribe({next:()=>{s.E.battleGoalManager.getBattleGoals().length<(s.E.fhRules(!0)||p.f.settings.battleGoalsFh?3:2)?this.close():this.update()}})}accept(){((-1!=this.selected||this.trial349)&&!this.character.battleGoal||0!=this.selected&&this.character.battleGoal)&&(s.E.stateManager.before("battleGoals."+(-1!=this.selected||this.trial349?"select":"deselect"),s.E.characterManager.characterName(this.character)),this.trial349?this.character.battleGoal=!0:-1!=this.selected?(this.character.battleGoal=!0,(0,V.HD)(this.character.battleGoals,this.selected,0)):this.character.battleGoal=!1,s.E.stateManager.after()),this.close()}cancel(){this.selected=this.character.battleGoal?0:-1,this.close()}close(){(0,F.co)(this.dialogRef)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-character-battlegoals"]],standalone:!1,decls:10,vars:10,consts:[[1,"battle-goals-dialog"],[1,"scroll-container"],[1,"header",3,"ghs-label","ghs-label-args"],[1,"battle-goals"],["ghs-pointer-input","",3,"battleGoal","flipped","selected","reveal","disabled"],[1,"menu"],[1,"menu","small"],["ghs-pointer-input","",3,"singleClick","doubleClick","battleGoal","flipped","selected","reveal","disabled"],[1,"cancel",3,"click","ghs-label"],[1,"accept",3,"click","ngClass","ghs-label"],[3,"ghs-label"],[1,"empty-hint",3,"ghs-label"],[3,"click","ghs-label"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"div",2),t.j41(3,"div",3),t.Z7z(4,n_,1,5,"ghs-battlegoal",4,t_),t.nI1(6,"trackUUID"),t.k0s(),t.nVh(7,e_,3,5,"div",5),t.nVh(8,s_,4,3,"div",6),t.nVh(9,r_,2,1,"div",6),t.k0s()()),2&i&&(t.R7$(2),t.Y8G("ghs-label",e.character.battleGoal?"game.battleGoals.chosen":"game.battleGoals.choose")("ghs-label-args",t.l_i(7,Jh,e.character.name,e.gameManager.characterManager.characterName(e.character))),t.R7$(2),t.Dyx(t.bMT(6,5,e.battleGoals)),t.R7$(3),t.vxM(e.character.battleGoal&&0==e.selected?-1:7),t.R7$(),t.vxM(e.cardOnly?-1:8),t.R7$(),t.vxM(e.cardOnly?-1:9))},dependencies:[N.YU,vi,it,dt,ct],styles:[".battle-goals-dialog[_ngcontent-%COMP%]{position:relative}.battle-goals-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{text-align:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.battle-goals-dialog[_ngcontent-%COMP%]   .battle-goals[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;margin:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.battle-goals-dialog[_ngcontent-%COMP%]   .battle-goals[_ngcontent-%COMP%]   ghs-battlegoal[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 27 * var(--ghs-dialog-factor))}@media (max-width: 600px),(orientation: portrait){.battle-goals-dialog[_ngcontent-%COMP%]   .battle-goals[_ngcontent-%COMP%]{flex-direction:column;align-items:center}}.battle-goals-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor)) 0;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly;align-items:center}.battle-goals-dialog[_ngcontent-%COMP%]   .menu.small[_ngcontent-%COMP%]{justify-content:center;margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor)) 0;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.7 * var(--ghs-dialog-factor))}.battle-goals-dialog[_ngcontent-%COMP%]   .menu.small[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{min-width:auto}.battle-goals-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;min-width:33%;display:flex;justify-content:center;margin:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.battle-goals-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.battle-goals-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.accept[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.battle-goals-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.battle-goals-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-darkgray)}.battle-goals-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .empty-hint[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}"]})}return a})();var Dt=v(6066),ln=v(6719),c_=v(9168),qt=v(2200);const l_=a=>({hint:a});let g_=(()=>{class a{value="";args=[];argLabel=!0;style=!1;relative=!1;size;hint=!1;static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-tooltip"]],inputs:{value:"value",args:[0,"ghs-label-args","args"],argLabel:[0,"ghs-label-args-replace","argLabel"],style:"style",relative:"relative",size:"size",hint:"hint"},standalone:!1,decls:2,vars:11,consts:[[3,"ngClass"],[1,"placeholder","text-white",3,"ghs-label","ghs-label-args","ghs-label-args-replace","relative"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nrm(1,"span",1),t.k0s()),2&i&&(t.HbH(e.size),t.Y8G("ngClass",t.eq3(9,l_,e.hint)),t.R7$(),t.Aen(e.style),t.Y8G("ghs-label",e.value)("ghs-label-args",e.args)("ghs-label-args-replace",e.argLabel)("relative",e.relative))},dependencies:[N.YU,it],styles:['[_nghost-%COMP%]{display:block;z-index:3000}div[_ngcontent-%COMP%]{position:relative;font-size:calc(var(--ghs-unit) * 2.2 * var(--ghs-text-factor));font-weight:200;margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor)) calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));padding:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor)) calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));max-width:calc(var(--ghs-unit) * 50 * var(--ghs-text-factor))}div[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:0;background-color:var(--ghs-color-darkgray);border-radius:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));opacity:.9;z-index:0}div[_ngcontent-%COMP%]   .placeholder[_ngcontent-%COMP%]{z-index:1}div.hint[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray);border-radius:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));background-color:var(--ghs-color-black)}div.small[_ngcontent-%COMP%]{font-weight:100;font-size:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor)) calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));padding:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor)) calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}div.large[_ngcontent-%COMP%]{font-weight:400;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor)) calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));padding:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor)) calc(var(--ghs-unit) * 4 * var(--ghs-text-factor))}'],changeDetection:0})}return a})(),Mt=(()=>{class a{overlay;overlayPositionBuilder;elementRef;value="";args=[];argLabel=!0;style=!1;relative=!1;size;hint=!1;toggable=!0;originX;originY;overlayX;overlayY;offsetX=0;offsetY=0;delay=0;disabled=!1;overlayRef;timeout;constructor(n,i,e){this.overlay=n,this.overlayPositionBuilder=i,this.elementRef=e}ngOnInit(){const n=this.overlayPositionBuilder.flexibleConnectedTo(this.elementRef).withPositions([{originX:this.originX||"start",originY:this.originY||"bottom",overlayX:this.overlayX||(this.hint?"center":"start"),overlayY:this.overlayY||"top",offsetX:this.offsetX,offsetY:this.offsetY}]);this.overlayRef=this.overlay.create({positionStrategy:n}),this.overlayRef.hostElement.style.zIndex="3000",this.timeout=null}show(){!this.disabled&&(p.f.settings.tooltips||!this.toggable)&&this.value&&!this.overlayRef.hasAttached()&&!this.timeout&&(this.timeout=setTimeout(()=>{const n=this.overlayRef.attach(new c_.A8(g_));n.instance.value=this.value,n.instance.args=this.args.map(i=>""+i),n.instance.argLabel=this.argLabel,n.instance.style=this.style,n.instance.relative=this.relative,n.instance.size=this.size,n.instance.hint=this.hint},this.delay||!this.hint&&500||1))}hide(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.overlayRef.hasAttached()&&this.overlayRef.detach()}ngOnDestroy(){this.hide(),this.overlayRef.dispose()}static \u0275fac=function(i){return new(i||a)(t.rXU(qt.hJ),t.rXU(qt.lF),t.rXU(t.aKT))};static \u0275dir=t.FsC({type:a,selectors:[["","ghs-tooltip",""]],hostBindings:function(i,e){1&i&&t.bIt("mouseover",function(){return e.show()})("mouseleave",function(){return e.hide()})},inputs:{value:[0,"ghs-tooltip","value"],args:[0,"ghs-label-args","args"],argLabel:[0,"ghs-label-args-replace","argLabel"],style:"style",relative:"relative",size:"size",hint:"hint",toggable:"toggable",originX:"originX",originY:"originY",overlayX:"overlayX",overlayY:"overlayY",offsetX:"offsetX",offsetY:"offsetY",delay:"delay",disabled:"disabled"},standalone:!1})}return a})();const d_=a=>({fh:a}),ts=a=>({disabled:a}),h_=(a,r)=>({active:a,immunity:r}),__=a=>({stack:a}),ns=a=>({active:a}),m_=(a,r)=>r._trackUUID;function p_(a,r){if(1&a){const n=t.RV6();t.j41(0,"img",10),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.dec(e))}),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(1,ts,i.getValue(n)<=1))}}function u_(a,r){if(1&a&&(t.j41(0,"span",6),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(2,__,n.types.includes(i.ConditionType.stack))),t.R7$(),t.JRh(i.getValue(n))}}function f_(a,r){1&a&&t.nrm(0,"span",7)}function C_(a,r){if(1&a){const n=t.RV6();t.j41(0,"img",11),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.inc(e))}),t.k0s()}}function M_(a,r){1&a&&t.nrm(0,"div",9)}function v_(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",2),t.nVh(1,p_,1,3,"img",3),t.j41(2,"span",4),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.toggleCondition(e))}),t.nrm(3,"img",5),t.nVh(4,u_,2,4,"span",6),t.k0s(),t.nVh(5,f_,1,0,"span",7),t.nVh(6,C_,1,0,"img",8),t.k0s(),t.nVh(7,M_,1,0,"div",9)}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG();t.Y8G("ngClass",t.eq3(13,ts,!e.hasCondition(n)&&(!e.immunityEnabled&&e.isImmune(n.name)&&!e.permanentEnabled&&!e.isPermanent(n.name)||e.isImmune(n.name,!0)))),t.R7$(),t.vxM(n.types.includes(e.ConditionType.stack)||n.types.includes(e.ConditionType.upgrade)?1:-1),t.R7$(),t.Y8G("ghs-tooltip","game.condition."+n.name+".hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom")("ngClass",t.l_i(15,h_,!e.immunityEnabled&&e.hasCondition(n)||e.immunityEnabled&&e.immunities.includes(n.name),e.isImmune(n.name))),t.R7$(),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+n.name+".svg",t.B4B),t.R7$(),t.vxM(n.types.includes(e.ConditionType.stack)||n.types.includes(e.ConditionType.upgrade)?4:-1),t.R7$(),t.vxM(e.isPermanent(n.name)?5:-1),t.R7$(),t.vxM(n.types.includes(e.ConditionType.stack)||n.types.includes(e.ConditionType.upgrade)?6:-1),t.R7$(),t.vxM(e.conditionSeparator.includes(i)?7:-1)}}function O_(a,r){if(1&a){const n=t.RV6();t.nrm(0,"div",9),t.j41(1,"a",12)(2,"span",13),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.togglePermanentEnabled())}),t.nrm(3,"img",14),t.k0s()(),t.j41(4,"a",12)(5,"span",13),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleImmunityEnabled())}),t.nrm(6,"img",5),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("ngClass",t.eq3(13,ns,n.permanentEnabled))("ghs-tooltip","game.condition.permanent.hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("ngClass",t.eq3(15,ns,n.immunityEnabled))("ghs-tooltip","game.condition.immune.hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom"),t.R7$(),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh/condition/immune.svg":"/condition/immunity.svg"),t.B4B)}}let Pa=(()=>{class a{ghsManager;entityConditions;immunities;entity;entities;figure;type;columns=3;empower=!1;enfeeble=!1;onChange=new t.bkB;gameManager=s.E;settingsManager=p.f;ConditionType=Q.GV;conditions=[];conditionSeparator=[];monsterType=!1;permanentEnabled=!1;immunityEnabled=!1;timeout;numberStore=0;constructor(n){this.ghsManager=n}ngOnInit(){if(this.initializeConditions(),this.entities){const n=this.entities.map(i=>i instanceof Dt.I&&i.type).filter((i,e,o)=>i&&o.indexOf(i)==e);1==n.length&&(this.monsterType=n[0])}this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.initializeConditions()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}onKeyPress(n){if(p.f.settings.keyboardShortcuts&&n.key in["0","1","2","3","4","5","6","7","8","9"]){const i=+n.key;this.timeout?(clearTimeout(this.timeout),this.numberStore=10*this.numberStore+i,this.selectCondition()):i>0&&10*i<=this.conditions.length+3?(this.numberStore=i,this.timeout=setTimeout(()=>{this.selectCondition()},1e3)):(this.numberStore=0==i?10:i,this.selectCondition()),n.preventDefault(),n.stopPropagation()}}selectCondition(){const n=this.numberStore;if(!(this.figure instanceof ft.$e)||this.figure.escort){let i;n<=this.conditions.length?i=this.conditions[n-1]:n==this.conditions.length+1?(this.permanentEnabled=!this.permanentEnabled,this.immunityEnabled=!1):n==this.conditions.length+2&&(this.immunityEnabled=!this.immunityEnabled,this.permanentEnabled=!1),i&&(!this.isImmune(i.name)||this.immunityEnabled&&!s.E.entityManager.isImmune(this.entity,this.figure,i.name,!0))&&this.toggleCondition(i)}this.timeout=void 0,this.numberStore=-1}initializeConditions(){this.conditions=[],this.conditionSeparator=[];let n=[];n.push(...s.E.conditionsForTypes("standard","negative",this.type)),n.push(...s.E.conditionsForTypes("upgrade","negative",this.type)),n.push(...s.E.conditionsForTypes("stack","negative",this.type)),n=n.filter((o,g,m)=>m.map(k=>k.name).indexOf(o.name)==g),n.length&&this.conditions.push(...n);let i=[];i.push(...s.E.conditionsForTypes("standard","positive",this.type)),i.push(...s.E.conditionsForTypes("upgrade","positive",this.type)),i.push(...s.E.conditionsForTypes("stack","positive",this.type)),i=i.filter((o,g,m)=>m.map(k=>k.name).indexOf(o.name)==g),i.length&&(this.conditionSeparator.push(this.conditions.length-1),this.conditions.push(...i));let e=[];e.push(...s.E.conditionsForTypes("standard","neutral",this.type)),e.push(...s.E.conditionsForTypes("upgrade","neutral",this.type)),e.push(...s.E.conditionsForTypes("stack","neutral",this.type)),e=e.filter((o,g,m)=>m.map(k=>k.name).indexOf(o.name)==g),e.length&&(this.conditionSeparator.push(this.conditions.length-1),this.conditions.push(...e)),this.immunityEnabled&&(this.conditionSeparator.push(this.conditions.length-1),this.conditions.push(new Q.kW(Q.r5.curse)),this.enfeeble&&this.conditions.push(new Q.kW(Q.r5.enfeeble)),this.conditions.push(new Q.kW(Q.r5.bless)),this.empower&&this.conditions.push(new Q.kW(Q.r5.empower)))}hasCondition(n,i=!1,e=!1){return this.entityConditions?this.entityConditions.some(o=>o.name==n.name&&o.state!=Q.mg.removed&&!o.expired&&(!this.permanentEnabled||(i||this.permanentEnabled)&&o.permanent)):this.entity?s.E.entityManager.hasCondition(this.entity,n,i||this.permanentEnabled):this.entities.every(o=>s.E.entityManager.hasCondition(o,n,i||this.permanentEnabled))}isImmune(n,i=!1){let e=!1;return this.immunities&&!i&&(e=this.immunities.includes(n)),e||(this.entity?e=s.E.entityManager.isImmune(this.entity,this.figure,n,!0):this.entities&&(e=this.entities.every(o=>s.E.entityManager.isImmune(o,this.figure,n,!0)))),e}isPermanent(n){return!!this.entityConditions&&this.entityConditions.some(i=>i.name==n&&i.permanent&&!i.expired)}inc(n){n.name==Q.r5.plague&&3==n.value||(n.value=this.getValue(n)+1,this.checkUpdate(n),this.onChange.emit(this.entityConditions))}dec(n){n.value=this.getValue(n)-1,n.value<1&&(n.value=1),this.checkUpdate(n),this.onChange.emit(this.entityConditions)}getValue(n){const i=this.entityConditions.find(e=>e.name==n.name&&!e.expired);return i?i.value:n.value}checkUpdate(n){const i=this.entityConditions.find(e=>e.name==n.name&&!e.expired);i&&(i.value=n.value)}toggleCondition(n,i=!1){if(this.immunityEnabled&&!i)this.immunities.includes(n.name)?this.immunities.splice(this.immunities.indexOf(n.name),1):this.immunities.push(n.name);else{if(this.hasCondition(n,i||this.permanentEnabled)){let e=this.entityConditions.find(o=>o.name==n.name&&(!i||o.permanent));e&&(e.expired=!0,e.lastState=e.state,e.state=Q.mg.removed)}else{let e=this.entityConditions.find(o=>o.name==n.name&&(!i||o.permanent));e?(e.expired=!1,e.lastState=e.state,e.state=Q.mg.new):(e=new Q.BR(n.name,n.value),e.lastState=e.state,e.state=Q.mg.new,this.entityConditions.push(e)),e.permanent=i||this.permanentEnabled}this.onChange.emit(this.entityConditions)}}togglePermanentEnabled(){this.permanentEnabled=!this.permanentEnabled,this.immunityEnabled=!1,this.initializeConditions()}toggleImmunityEnabled(){this.immunityEnabled=!this.immunityEnabled,this.permanentEnabled=!1,this.initializeConditions()}static \u0275fac=function(i){return new(i||a)(t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-conditions"]],hostBindings:function(i,e){1&i&&t.bIt("keydown",function(g){return e.onKeyPress(g)},t.EBC)},inputs:{entityConditions:"entityConditions",immunities:"immunities",entity:"entity",entities:"entities",figure:"figure",type:"type",columns:"columns",empower:"empower",enfeeble:"enfeeble"},outputs:{onChange:"conditionChange"},standalone:!1,decls:6,vars:8,consts:[[3,"ngClass"],[1,"condition-container"],[1,"item",3,"ngClass"],["tabclick","","src","./assets/images/left.svg",1,"ghs-svg","dec",3,"ngClass"],["tabclick","",1,"condition",3,"click","ghs-tooltip","originX","overlayX","originY","overlayY","ngClass"],[3,"src"],[1,"value",3,"ngClass"],[1,"condition","permanent","permanent-overlay"],["tabclick","","src","./assets/images/right.svg",1,"ghs-svg","inc"],[1,"separator"],["tabclick","","src","./assets/images/left.svg",1,"ghs-svg","dec",3,"click","ngClass"],["tabclick","","src","./assets/images/right.svg",1,"ghs-svg","inc",3,"click"],[1,"item"],["tabclick","",1,"condition","toggle",3,"click","ngClass","ghs-tooltip","originX","overlayX","originY","overlayY"],["src","./assets/images/condition/permanent.svg"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.Z7z(2,v_,8,18,null,null,m_),t.nI1(4,"trackUUID"),t.nVh(5,O_,7,17),t.k0s()()),2&i&&(t.xc7("--condition-columns",e.columns),t.Y8G("ngClass",t.eq3(6,d_,e.settingsManager.settings.fhStyle)),t.R7$(2),t.Dyx(t.bMT(4,4,e.conditions)),t.R7$(3),t.vxM(e.conditions.length?5:-1))},dependencies:[N.YU,Mt,Ft,ct],styles:['.condition-container[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));display:grid;grid-template-columns:repeat(var(--condition-columns),calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor)));column-gap:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));row-gap:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));align-items:center;justify-items:center;margin-bottom:auto;margin-bottom:calc(var(--ghs-unit) / 4 * var(--ghs-dialog-factor));max-height:calc(var(--ghs-unit) * 65 * var(--ghs-dialog-factor))}.condition-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{grid-column:span var(--condition-columns);width:100%;border-top:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) solid var(--ghs-color-darkgray)}.item[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor))}.item.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray);filter:brightness(.5) grayscale(.2)}.item.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}.item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{cursor:pointer;display:flex;position:relative;width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));z-index:1}.item[_ngcontent-%COMP%]   .condition.permanent-overlay[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));pointer-events:none;z-index:2}.item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:after{pointer-events:none;content:" ";height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}.item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:auto}.item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);position:absolute;bottom:0;left:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));transform:translate(-50%)}.item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value.stack[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));bottom:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor))}.item[_ngcontent-%COMP%]   .condition.active[_ngcontent-%COMP%]:after{border:calc(var(--ghs-unit) / 4) var(--ghs-color-white) solid;border-radius:100%}.item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:hover:after{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.item[_ngcontent-%COMP%]   .condition.active[_ngcontent-%COMP%]:hover:after{border:calc(var(--ghs-unit) / 5) var(--ghs-color-red) solid}.item[_ngcontent-%COMP%]   .condition.toggle[_ngcontent-%COMP%]{justify-content:center;align-items:center}.item[_ngcontent-%COMP%]   .condition.toggle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:70%;width:auto}.item[_ngcontent-%COMP%]   .dec[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .inc[_ngcontent-%COMP%]{cursor:pointer;position:absolute;width:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow);top:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));transform:translateY(-50%)}.item[_ngcontent-%COMP%]   .dec.dec[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .inc.dec[_ngcontent-%COMP%]{left:0}.item[_ngcontent-%COMP%]   .dec.inc[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .inc.inc[_ngcontent-%COMP%]{right:0}.item[_ngcontent-%COMP%]   .dec.disabled[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .inc.disabled[_ngcontent-%COMP%]{pointer-events:none;filter:var(--ghs-filter-darkgray)}']})}return a})();const es=(a,r)=>({"negative-value":a,"positive-value":r}),Pi=a=>({inactive:a}),P_=(a,r,n)=>({active:a,new:r,center:n}),b_=(a,r)=>r._trackUUID;function k_(a,r){if(1&a&&t.nrm(0,"img",17),2&a){const n=t.XpG(2);t.Y8G("src",n.gameManager.monsterManager.monsterThumbnail(n.monster),t.B4B)}}function y_(a,r){1&a&&(t.j41(0,"span",19),t.nrm(1,"span",18),t.EFF(2,"\xa0"),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","game.ally"))}function x_(a,r){1&a&&(t.j41(0,"span",20),t.nrm(1,"span",18),t.EFF(2,"\xa0"),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","game.allied"))}function E_(a,r){if(1&a&&t.nrm(0,"span",21),2&a){const n=t.XpG(2);t.Y8G("ghs-label","(%game.monsterType."+n.data.type+"%)")}}function w_(a,r){if(1&a&&(t.j41(0,"div",1),t.nVh(1,k_,1,1,"img",17),t.nrm(2,"span",18),t.EFF(3,"\xa0 "),t.nVh(4,y_,3,1,"span",19),t.nVh(5,x_,3,1,"span",20),t.nVh(6,E_,1,1,"span",21),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.vxM(!n.monster.noThumbnail&&n.settingsManager.settings.artwork?1:-1),t.R7$(),t.Y8G("ghs-label","data.monster."+n.monster.name),t.R7$(2),t.vxM(n.monster.isAlly?4:-1),t.R7$(),t.vxM(n.monster.isAllied?5:-1),t.R7$(),t.vxM(n.data.type?6:-1)}}function R_(a,r){if(1&a&&(t.j41(0,"span",1),t.nrm(1,"img",22),t.j41(2,"span"),t.EFF(3),t.k0s()()),2&a){const n=t.XpG();t.R7$(),t.Y8G("src",n.character.iconUrl,t.B4B),t.R7$(2),t.JRh(n.gameManager.characterManager.characterName(n.character,!0))}}function j_(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",25),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.toggleEntity(e))}),t.EFF(1),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG();t.HbH(t.VkB("entity ",i.gameManager.toMonsterEntity(n).type)),t.Y8G("ngClass",t.eq3(5,Pi,!i.entities.includes(n))),t.R7$(),t.JRh(n.number)}}function G_(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function T_(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG(2).$implicit,i=t.XpG();t.R7$(),t.JRh(i.gameManager.toSummon(n).number)}}function S_(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",26),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.toggleEntity(e))}),t.j41(1,"span",27),t.nrm(2,"img",28),t.j41(3,"span",29),t.nVh(4,G_,2,0,"span"),t.nVh(5,T_,2,1,"span"),t.k0s()()()}if(2&a){const n=t.XpG().$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(6,Pi,!i.entities.includes(n))),t.R7$(),t.Y8G("ngClass",t.sMw(8,P_,i.gameManager.toSummon(n).state==i.SummonState.true,i.gameManager.toSummon(n).state==i.SummonState.new,i.gameManager.toSummon(n).entityConditions.length%2==0)),t.R7$(),t.Y8G("src",t.VkB("./assets/images/summons/",i.gameManager.toSummon(n).color,".png"),t.B4B),t.R7$(2),t.vxM(0==i.gameManager.toSummon(n).number?4:-1),t.R7$(),t.vxM(i.gameManager.toSummon(n).number>0?5:-1)}}function D_(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",26),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.toggleEntity(e))}),t.j41(1,"span",30),t.EFF(2),t.k0s()()}if(2&a){const n=t.XpG().$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(2,Pi,!i.entities.includes(n))),t.R7$(2),t.SpI(" ",i.gameManager.toObjectiveEntity(n).number," ")}}function $_(a,r){if(1&a&&(t.nVh(0,j_,2,7,"div",23),t.nVh(1,S_,6,12,"div",24),t.nVh(2,D_,3,4,"div",24)),2&a){const n=t.XpG();t.vxM(n.monster?0:-1),t.R7$(),t.vxM(n.character?1:-1),t.R7$(),t.vxM(n.objective?2:-1)}}function I_(a,r){if(1&a&&t.nrm(0,"ghs-conditions",11),2&a){const n=t.XpG();t.Y8G("entityConditions",n.entityConditions)("immunities",n.entityImmunities)("entities",n.entities)("figure",n.monster)("type","monster")("columns",4)}}function A_(a,r){if(1&a&&t.nrm(0,"ghs-conditions",11),2&a){const n=t.XpG();t.Y8G("entityConditions",n.entityConditions)("immunities",n.entityImmunities)("entities",n.entities)("figure",n.character)("type","monster")("columns",4)}}function V_(a,r){if(1&a&&t.nrm(0,"ghs-conditions",11),2&a){const n=t.XpG();t.Y8G("entityConditions",n.entityConditions)("immunities",n.entityImmunities)("entities",n.entities)("figure",n.objective)("type",n.objective.escort?"character":"objective")("columns",4)}}function F_(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",31),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleType())}),t.nrm(1,"span",18)(2,"img",32)(3,"span",18),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","%game.monsterType.normal%"),t.R7$(2),t.Y8G("ghs-label","%game.monsterType.elite%"))}let bi=(()=>{class a{data;dialogRef;ghsManager;gameManager=s.E;settingsManager=p.f;health=0;maxHealth=0;ConditionName=Q.r5;ConditionType=Q.GV;MonsterType=S.N;entities;allEntities=[];entityConditions=[];initialImmunities=[];entityImmunities=[];monster;character;objective;SummonState=_t.N5;EntityValueFunction=A.hZ;constructor(n,i,e){this.data=n,this.dialogRef=i,this.ghsManager=e,this.data.monster?(this.monster=this.data.monster,this.allEntities=this.monster.entities.filter(o=>!n.type||o.type==n.type)):this.data.character?(this.character=this.data.character,this.allEntities=this.character.summons):this.data.objective&&(this.objective=this.data.objective,this.allEntities=this.objective.entities),this.dialogRef.closed.subscribe({next:o=>{o||this.close()}}),this.entities=[],this.allEntities.forEach(o=>this.entities.push(o)),this.update()}keyboardShortcuts(n){p.f.settings.keyboardShortcuts&&!n.altKey&&!n.metaKey&&(!window.document.activeElement||"INPUT"!=window.document.activeElement.tagName&&"SELECT"!=window.document.activeElement.tagName&&"TEXTAREA"!=window.document.activeElement.tagName)&&(n.ctrlKey||n.shiftKey||"ArrowRight"!==n.key?n.ctrlKey||n.shiftKey||"ArrowLeft"!==n.key?n.ctrlKey||n.shiftKey||"ArrowUp"!==n.key?n.ctrlKey||n.shiftKey||"ArrowDown"!==n.key?!n.ctrlKey&&!n.shiftKey&&("k"===n.key.toLowerCase()||"d"===n.key.toLowerCase())&&(this.toggleDead(),n.preventDefault(),n.stopPropagation()):(this.changeMaxHealth(-1),n.preventDefault(),n.stopPropagation()):(this.changeMaxHealth(1),n.preventDefault(),n.stopPropagation()):(this.changeHealth(-1),n.preventDefault(),n.stopPropagation()):(this.changeHealth(1),n.preventDefault(),n.stopPropagation()))}update(){this.entityConditions=[],this.entities.forEach((n,i,e)=>{n.entityConditions.forEach(o=>{!this.entityConditions.find(g=>g.name==o.name)&&e.every(g=>g.entityConditions.find(m=>m.name==o.name&&m.state==o.state))&&this.entityConditions.push(JSON.parse(JSON.stringify(o)))}),n.immunities.forEach(o=>{!this.entityImmunities.find(g=>g==o)&&e.every(g=>g.immunities.find(m=>m==o))&&(this.entityImmunities.push(o),this.initialImmunities.push(o))})})}toggleEntity(n){this.entities.includes(n)?this.entities.splice(this.entities.indexOf(n),1):this.entities.push(n),this.update()}changeHealth(n){this.health+=n}changeMaxHealth(n){this.maxHealth+=n}toggleType(){if(this.monster){const n=this.monster.stats.find(e=>this.monster&&e.level==this.monster.level&&e.type==S.N.normal),i=this.monster.stats.find(e=>this.monster&&e.level==this.monster.level&&e.type==S.N.elite);n&&i?(s.E.stateManager.before("toggleTypeAll","monster."+this.monster.name),this.entities.forEach(e=>{this.monster&&s.E.entityManager.isAlive(e)&&e instanceof Dt.I&&(e.type=e.type==S.N.elite?S.N.normal:S.N.elite,e.maxHealth=(0,A.hZ)(e.type==S.N.normal?n.health:i.health,this.monster.level),(e.health>e.maxHealth||e.health<e.maxHealth&&e.health==(0,A.hZ)(e.type==S.N.normal?i.health:n.health,this.monster.level))&&(e.health=e.maxHealth))}),s.E.stateManager.after()):console.warn("Missing stats!",this.monster)}}toggleDead(){this.monster?s.E.stateManager.before("monsterDead","monster."+this.monster.name,this.data.type?"monster."+this.data.type+" ":""):this.character?s.E.stateManager.before("summonsDead",s.E.characterManager.characterName(this.character)):this.objective&&s.E.stateManager.before("objectivesDead",s.E.objectiveManager.objectiveName(this.objective)),this.entities.forEach(n=>{n.dead=!0}),setTimeout(()=>{this.entities.forEach(n=>{(s.E.game.state==D.mk.draw||0==n.entityConditions.length||n.entityConditions.every(i=>!i.types.includes(Q.GV.turn)&&!i.types.includes(Q.GV.apply)))&&(this.monster&&n instanceof Dt.I?s.E.monsterManager.removeMonsterEntity(this.monster,n):this.character&&n instanceof _t.up?s.E.characterManager.removeSummon(this.character,n):this.objective&&n instanceof ln.X&&s.E.objectiveManager.removeObjectiveEntity(this.objective,n))}),this.entities.every(n=>!s.E.entityManager.isAlive(n))&&this.monster&&this.monster.active&&s.E.roundManager.toggleFigure(this.monster),s.E.stateManager.after(),this.ghsManager.triggerUiChange()},p.f.settings.animations?1500*p.f.settings.animationSpeed:0),(0,F.co)(this.dialogRef,!0)}close(){if(this.entityConditions.filter(n=>n.state==Q.mg.new||n.state==Q.mg.removed).forEach(n=>{this.monster?s.E.stateManager.before(...s.E.entityManager.undoInfos(void 0,this.monster,n.state==Q.mg.removed?"removeCondition":"addCondition"),n.name,this.data.type?"monster."+this.data.type+" ":""):this.character?s.E.stateManager.before(n.state==Q.mg.removed?"removeCondition.summons":"addCondition.summons",s.E.characterManager.characterName(this.character),n.name):this.objective&&s.E.stateManager.before(n.state==Q.mg.removed?"removeCondition.objectives":"addCondition.objectives",s.E.objectiveManager.objectiveName(this.objective),n.name),this.entities.forEach(i=>{n.expired=n.state==Q.mg.new,n.state==Q.mg.removed?s.E.entityManager.removeCondition(i,this.monster||this.character||this.objective||new b.R(new pe.f),n,n.permanent):(this.monster&&!s.E.entityManager.isImmune(i,this.monster,n.name)||this.character||this.objective)&&s.E.entityManager.addCondition(i,this.monster||this.character||this.objective||new b.R(new pe.f),n,n.permanent)}),s.E.stateManager.after()}),this.entityConditions.forEach(n=>{this.entities.find(i=>i.entityConditions.find(e=>e.name==n.name&&!e.expired&&e.value!=n.value))&&(this.monster?s.E.stateManager.before(...s.E.entityManager.undoInfos(void 0,this.monster,"setConditionValue"),n.name,""+n.value,this.data.type?"monster."+this.data.type+" ":""):this.character?s.E.stateManager.before("setConditionValue.summons",s.E.characterManager.characterName(this.character),n.name,""+n.value):this.objective&&s.E.stateManager.before("setConditionValue.objectives",s.E.objectiveManager.objectiveName(this.objective),n.name,""+n.value),this.entities.forEach(i=>{const e=i.entityConditions.find(o=>o.name==n.name&&!o.expired);e&&e.value!=n.value&&(e.value=n.value)}),s.E.stateManager.after())}),this.initialImmunities.forEach(n=>{this.entityImmunities.includes(n)||(this.monster?s.E.stateManager.before(...s.E.entityManager.undoInfos(void 0,this.monster,"removeImmunity"),n,this.data.type?"monster."+this.data.type+" ":""):this.character?s.E.stateManager.before("removeImmunity.summons",s.E.characterManager.characterName(this.character),n):this.objective&&s.E.stateManager.before("removeImmunity.objectives",s.E.objectiveManager.objectiveName(this.objective),n),this.entities.forEach(i=>{i.immunities=i.immunities.filter(e=>e!=n)}),s.E.stateManager.after())}),this.entityImmunities.forEach(n=>{this.initialImmunities.includes(n)||(this.monster?s.E.stateManager.before(...s.E.entityManager.undoInfos(void 0,this.monster,"addImmunity"),n,this.data.type?"monster."+this.data.type+" ":""):this.character?s.E.stateManager.before("addImmunity.summons",s.E.characterManager.characterName(this.character),n):this.objective&&s.E.stateManager.before("addImmunity.objectives",s.E.objectiveManager.objectiveName(this.objective),n),this.entities.forEach(i=>{i.immunities.push(n)}),s.E.stateManager.after())}),0!=this.health){this.monster?s.E.stateManager.before("changeMonsterHP","monster."+this.monster.name,(0,F.n1)(this.health),this.data.type?"monster."+this.data.type+" ":""):this.character?s.E.stateManager.before("changeSummonsHP",s.E.characterManager.characterName(this.character),(0,F.n1)(this.health)):this.objective&&s.E.stateManager.before("changeObjectivesHP",s.E.objectiveManager.objectiveName(this.objective),(0,F.n1)(this.health));let n=[];this.entities.forEach(i=>{0!=this.health&&(this.monster?s.E.entityManager.changeHealth(i,this.monster,this.health):this.character?s.E.entityManager.changeHealth(i,this.character,this.health):this.objective&&s.E.entityManager.changeHealth(i,this.objective,this.health)),(i.maxHealth>0&&i.health<=0||i.dead)&&(i.dead=0==i.entityConditions.length||i.entityConditions.every(e=>!e.highlight||!e.types.includes(Q.GV.turn)&&!e.types.includes(Q.GV.apply)),n.push(i))}),this.health=0,n.length>0?setTimeout(()=>{n.forEach(i=>{i.dead&&(this.monster&&i instanceof Dt.I?s.E.monsterManager.removeMonsterEntity(this.monster,i):this.character&&i instanceof _t.up?s.E.characterManager.removeSummon(this.character,i):this.objective&&i instanceof ln.X&&s.E.objectiveManager.removeObjectiveEntity(this.objective,i))}),this.entities.every(i=>!s.E.entityManager.isAlive(i))&&(this.monster&&this.monster.active&&s.E.roundManager.toggleFigure(this.monster),this.objective&&s.E.objectiveManager.removeObjective(this.objective)),this.objective&&0==this.objective.entities.length&&s.E.objectiveManager.removeObjective(this.objective),s.E.stateManager.after()},p.f.settings.animations?1500*p.f.settings.animationSpeed:0):s.E.stateManager.after()}0!=this.maxHealth&&(this.monster?s.E.stateManager.before("changeMonsterMaxHP","monster."+this.monster.name,(0,F.n1)(this.health),this.data.type?"monster."+this.data.type+" ":""):this.character?s.E.stateManager.before("changeSummonsMaxHP",s.E.characterManager.characterName(this.character),(0,F.n1)(this.health)):this.objective&&(s.E.stateManager.before("changeObjectivesMaxHP",s.E.objectiveManager.objectiveName(this.objective),(0,F.n1)(this.health)),this.objective.health=(0,F.n1)(this.health)),this.entities.forEach(n=>{n.health==n.maxHealth&&(n.health+=this.maxHealth),n.maxHealth+=this.maxHealth,n.health>n.maxHealth&&(n.health=n.maxHealth)}),s.E.stateManager.after())}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-entities-menu-dialog"]],hostBindings:function(i,e){1&i&&t.bIt("keydown",function(g){return e.keyboardShortcuts(g)},t.EBC)},standalone:!1,decls:36,vars:32,consts:[[1,"entity-menu-dialog","scroll-container"],[1,"name"],[1,"entities"],[1,"entity-container"],[1,"item"],["tabclick","",1,"button",3,"singleClick","repeat"],["src","./assets/images/minus.svg",1,"ghs-svg"],[1,"item",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/status/health.svg"],[1,"badge","health-count",3,"ngClass"],["src","./assets/images/plus.svg",1,"ghs-svg"],[3,"entityConditions","immunities","entities","figure","type","columns"],["tabclick","",1,"button",3,"click"],["src","./assets/images/status/dead.svg"],[1,"item","max-health-container"],["src","./assets/images/status/health.svg",3,"ghs-label","ghs-label-attribute"],["tabclick","",1,"toggle-type"],[1,"standee",3,"src"],[3,"ghs-label"],[1,"ally"],[1,"allied"],[1,"monster-type",3,"ghs-label"],[1,"icon","character-icon",3,"src"],["tabclick","",3,"class","ngClass"],["tabclick","",1,"entity",3,"ngClass"],["tabclick","",3,"click","ngClass"],["tabclick","",1,"entity",3,"click","ngClass"],[1,"summon-image",3,"ngClass"],[3,"src"],[1,"summon-number"],[1,"objective-marker"],["tabclick","",1,"toggle-type",3,"click"],["src","./assets/images/switch.svg",1,"ghs-svg"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nVh(1,w_,7,5,"div",1),t.nVh(2,R_,4,2,"span",1),t.j41(3,"div",2),t.Z7z(4,$_,3,3,null,null,b_),t.nI1(6,"trackUUID"),t.k0s(),t.j41(7,"div",3)(8,"span",4)(9,"ghs-pointer-input",5),t.bIt("singleClick",function(){return e.changeHealth(-1)}),t.nrm(10,"img",6),t.k0s()(),t.j41(11,"span",7),t.nrm(12,"img",8),t.j41(13,"span",9),t.EFF(14),t.nI1(15,"ghsValueSign"),t.k0s()(),t.j41(16,"span",4)(17,"ghs-pointer-input",5),t.bIt("singleClick",function(){return e.changeHealth(1)}),t.nrm(18,"img",10),t.k0s()()(),t.nVh(19,I_,1,6,"ghs-conditions",11),t.nVh(20,A_,1,6,"ghs-conditions",11),t.nVh(21,V_,1,6,"ghs-conditions",11),t.j41(22,"div",3)(23,"span",7)(24,"a",12),t.bIt("click",function(){return e.toggleDead()}),t.nrm(25,"img",13),t.k0s()(),t.j41(26,"span",14)(27,"ghs-pointer-input",5),t.bIt("singleClick",function(){return e.changeMaxHealth(-1)}),t.nrm(28,"img",6),t.k0s(),t.nrm(29,"img",15),t.j41(30,"span",9),t.EFF(31),t.nI1(32,"ghsValueSign"),t.k0s(),t.j41(33,"ghs-pointer-input",5),t.bIt("singleClick",function(){return e.changeMaxHealth(1)}),t.nrm(34,"img",10),t.k0s()()(),t.nVh(35,F_,4,2,"span",16),t.k0s()),2&i&&(t.R7$(),t.vxM(e.monster?1:-1),t.R7$(),t.vxM(e.character?2:-1),t.R7$(2),t.Dyx(t.bMT(6,20,e.allEntities)),t.R7$(5),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-label","game.health")("ghs-label-attribute","title"),t.R7$(2),t.Y8G("ngClass",t.l_i(26,es,e.health<0,e.health>0)),t.R7$(),t.JRh(t.bMT(15,22,e.health)),t.R7$(3),t.Y8G("repeat",!0),t.R7$(2),t.vxM(e.monster?19:-1),t.R7$(),t.vxM(e.character?20:-1),t.R7$(),t.vxM(e.objective?21:-1),t.R7$(2),t.Y8G("ghs-label","game.dead")("ghs-label-attribute","title"),t.R7$(4),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-label","game.maxHealth")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ngClass",t.l_i(29,es,e.maxHealth<0,e.maxHealth>0)),t.R7$(),t.JRh(t.bMT(32,24,e.maxHealth)),t.R7$(2),t.Y8G("repeat",!0),t.R7$(2),t.vxM(e.monster?35:-1))},dependencies:[N.YU,Pa,it,dt,Ft,Me,ct],styles:['.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));width:auto;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   img.standee[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top-left-radius:30%;border-top-right-radius:30%;height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));width:auto}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap;margin:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor)) auto;max-width:calc(var(--ghs-unit) * 28 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]{position:relative;cursor:pointer;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-white);border-radius:100%;font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   .entity.normal[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   .entity.elite[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   .entity.boss[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   .entity.inactive[_ngcontent-%COMP%]{filter:none;opacity:.7;border-color:transparent}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]:hover{filter:none;opacity:.7;border-color:var(--ghs-color-gray)}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-image[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 4);height:calc(var(--ghs-unit) * 4);transition:top calc(var(--ghs-animation-speed) * .5s) ease-out,left calc(var(--ghs-animation-speed) * .5s) ease-out}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-image.new[_ngcontent-%COMP%]:before{content:" ";display:block;position:absolute;width:calc(var(--ghs-unit) * 4);height:calc(var(--ghs-unit) * 4);background-image:url(minus.97c98a810771fceb.svg);background-size:cover;z-index:2}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-image[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%]{position:absolute;display:flex;justify-content:center;align-items:center;top:0;left:calc(var(--ghs-unit) * -.1);height:calc(var(--ghs-unit) * 4);width:calc(var(--ghs-unit) * 2);font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5);color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray);border-top-left-radius:calc(var(--ghs-unit) * 4);border-bottom-left-radius:calc(var(--ghs-unit) * 4);z-index:3;opacity:.9}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor)));align-content:space-between}.entity-menu-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   .max-health-container[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:space-evenly;grid-column:2 span;width:calc(var(--ghs-unit) * 14 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   .max-health-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:auto}.entity-menu-dialog[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.entity-menu-dialog[_ngcontent-%COMP%]   span.item[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.entity-menu-dialog[_ngcontent-%COMP%]   a.button[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.entity-menu-dialog[_ngcontent-%COMP%]   a.button[_ngcontent-%COMP%]:hover, .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.button[_ngcontent-%COMP%]:hover{opacity:.4}.entity-menu-dialog[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.entity-menu-dialog[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}.entity-menu-dialog[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:auto}.entity-menu-dialog[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0;color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));text-shadow:var(--ghs-outline);text-align:center}.toggle-type[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer;color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}']})}return a})();var wt=v(2941),as=v(8503);const X_=["characterSheet"],B_=a=>({denied:a});let An=(()=>{class a{data;dialogRef;characterSheet;settingsManager=p.f;constructor(n,i){this.data=n,this.dialogRef=i,this.dialogRef.closed.subscribe({next:()=>{this.characterSheet.applyValues()}})}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-character-sheet-dialog"]],viewQuery:function(i,e){if(1&i&&t.GBs(X_,5),2&i){let o;t.mGM(o=t.lsd())&&(e.characterSheet=o.first)}},standalone:!1,decls:7,vars:9,consts:[["characterSheet",""],[1,"light","character-sheet-dialog"],[1,"scroll-container"],[1,"lock-toggle",3,"ghs-tooltip","ngClass"],["ghs-pointer-input","",3,"singleClick"],[3,"src"],[3,"character","editable","forceEdit","dialogRef"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"a",4),t.bIt("singleClick",function(){return c.eBV(o),c.Njj(e.settingsManager.toggle("characterSheetLocked"))}),t.nrm(4,"img",5),t.k0s()(),t.nrm(5,"ghs-character-sheet",6,0),t.k0s()()}2&i&&(t.R7$(2),t.Y8G("ghs-tooltip","character.progress.lock")("ngClass",t.eq3(7,B_,e.data.viewOnly&&!e.data.forceEdit)),t.R7$(2),t.Y8G("src","./assets/images/lock"+(e.settingsManager.settings.characterSheetLocked||e.data.viewOnly&&!e.data.forceEdit?"":"-open")+".svg",t.B4B),t.R7$(),t.Y8G("character",e.data.character)("editable",!e.data.viewOnly)("forceEdit",e.data.forceEdit)("dialogRef",e.dialogRef))},styles:[".character-sheet-dialog[_ngcontent-%COMP%]{position:relative;background-color:var(--ghs-color-white)}.character-sheet-dialog[_ngcontent-%COMP%]   ghs-character-sheet[_ngcontent-%COMP%]{display:block}.character-sheet-dialog[_ngcontent-%COMP%]   .lock-toggle[_ngcontent-%COMP%]{position:sticky;top:0;left:0;width:100%;height:0;overflow:visible;display:flex;justify-content:flex-end;z-index:2}.character-sheet-dialog[_ngcontent-%COMP%]   .lock-toggle[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 3.2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3.2 * var(--ghs-dialog-factor))}.character-sheet-dialog[_ngcontent-%COMP%]   .lock-toggle[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.character-sheet-dialog[_ngcontent-%COMP%]   .lock-toggle.permissive[_ngcontent-%COMP%]{opacity:.6}"]})}return a})();const is=a=>[a],Y_=a=>({disabled:a}),U_=()=>[],N_=a=>({selected:a}),z_=(a,r)=>r._trackUUID;function L_(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",7),t.bIt("click",function(){const e=c.eBV(n).$index,o=t.XpG();return c.Njj(o.toggleSelect(e))}),t.nrm(1,"img",8),t.j41(2,"span",9),t.EFF(3),t.k0s()()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG();t.Y8G("ngClass",t.eq3(3,N_,e.selected==i)),t.R7$(),t.Y8G("src",n.iconUrl,t.B4B),t.R7$(2),t.SpI(" ",e.gameManager.characterManager.characterName(n,!0)," ")}}let os=(()=>{class a{data;dialogRef;gameManager=s.E;selected=0;characters;type;constructor(n,i){this.data=n,this.dialogRef=i,this.characters=n.characters,this.type=n.type}toggleSelect(n){this.selected=this.selected==n?-1:n}close(n=void 0){(0,F.co)(this.dialogRef,n)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-additional-am-select-dialog"]],standalone:!1,decls:11,vars:15,consts:[[3,"ghs-label","ghs-label-args"],[1,"characters"],[1,"character",3,"ngClass"],[1,"menu"],[1,"cancel",3,"click"],[3,"ghs-label"],[1,"select",3,"click","ngClass"],[1,"character",3,"click","ngClass"],[1,"icon",3,"src"],[1,"name"]],template:function(i,e){1&i&&(t.j41(0,"p"),t.nrm(1,"span",0),t.k0s(),t.j41(2,"div",1),t.Z7z(3,L_,4,5,"div",2,z_),t.nI1(5,"trackUUID"),t.k0s(),t.j41(6,"div",3)(7,"a",4),t.bIt("click",function(){return e.close()}),t.nrm(8,"span",5),t.k0s(),t.j41(9,"a",6),t.bIt("click",function(){return e.close(e.selected)}),t.nrm(10,"span",0),t.k0s()()),2&i&&(t.R7$(),t.Y8G("ghs-label","game.attackModifiers.additional.dialog")("ghs-label-args",t.eq3(8,is,e.type)),t.R7$(2),t.Dyx(t.bMT(5,6,e.characters)),t.R7$(5),t.Y8G("ghs-label","cancel"),t.R7$(),t.Y8G("ngClass",t.eq3(10,Y_,-1==e.selected)),t.R7$(),t.Y8G("ghs-label",-1==e.selected?"game.attackModifiers.additional.select":"game.attackModifiers.additional.apply")("ghs-label-args",-1!=e.selected?t.eq3(12,is,e.characters[e.selected].title||"%data.character."+e.characters[e.selected].edition+"."+e.characters[e.selected].name+"%"):t.lJ4(14,U_)))},dependencies:[N.YU,it,ct],styles:["p[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.8 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-align:center}.characters[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);margin:.25em;padding:.25em;border:1px solid transparent}.characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:1.5em;height:auto;margin-right:.2em;filter:grayscale(.7)}.characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]:hover{color:var(--ghs-color-darkgray);border-color:var(--ghs-color-darkgray)}.characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]:hover   .icon[_ngcontent-%COMP%]{filter:grayscale(.3)}.characters[_ngcontent-%COMP%]   .character.selected[_ngcontent-%COMP%]{color:var(--ghs-color-white);border-color:var(--ghs-color-gray)}.characters[_ngcontent-%COMP%]   .character.selected[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{filter:none}.menu[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;color:var(--ghs-color-green);margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-gray)}.menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.5;color:var(--ghs-color-gray)}"]})}return a})();const ss=a=>({highlight:a});function q_(a,r){if(1&a&&(t.j41(0,"kbd",1),t.nI1(1,"ghsFloor"),t.j41(2,"span"),t.EFF(3),t.nI1(4,"ghsFloor"),t.k0s()()),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(6,ss,t.bMT(1,2,n.entityIndex/10)==n.gameManager.stateManager.keyboardSelect)),t.R7$(3),t.JRh(t.bMT(4,4,n.entityIndex/10))}}function H_(a,r){if(1&a&&(t.j41(0,"span",0),t.nVh(1,q_,5,8,"kbd",1),t.j41(2,"kbd",1)(3,"span"),t.EFF(4),t.k0s()()()),2&a){const n=t.XpG();t.R7$(),t.vxM(n.entityIndex>=10?1:-1),t.R7$(),t.Y8G("ngClass",t.eq3(3,ss,n.entityIndex<10&&n.entityIndex==n.gameManager.stateManager.keyboardSelect)),t.R7$(2),t.JRh(n.entityIndex%10)}}let ba=(()=>{class a{ghsManager;gameManager=s.E;entity;show=!1;entityIndex=-1;constructor(n){this.ghsManager=n}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.entityIndex=s.E.entityManager.getIndexForEntity(this.entity,"w"===s.E.stateManager.keyboardSelecting),-1!=this.entityIndex&&this.entityIndex++}static \u0275fac=function(i){return new(i||a)(t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-entity-index-key"]],inputs:{entity:"entity",show:"show"},standalone:!1,decls:1,vars:1,consts:[[1,"key-container"],[3,"ngClass"]],template:function(i,e){1&i&&t.nVh(0,H_,5,5,"span",0),2&i&&t.vxM(e.gameManager.stateManager.keyboardSelecting||e.show?0:-1)},dependencies:[N.YU,Jo],styles:[".key-container[_ngcontent-%COMP%]{position:absolute;display:flex;min-width:calc(var(--ghs-unit) * 10);max-width:calc(var(--ghs-unit) * 10);font-size:calc(var(--ghs-unit) * 2.5);z-index:999}"]})}return a})(),Ne=(()=>{class a{el;value=0;colored=!0;empty=!0;hideEmpty=!1;reverse=!1;invert=!1;container=!1;constructor(n){this.el=n,this.update()}ngOnChanges(n){this.update()}update(){this.el.nativeElement.innerHTML=(0,F.n1)(this.reverse?-this.value:this.value,this.empty),this.container&&(this.el.nativeElement.innerHTML='<span class="value">'+(0,F.n1)(this.reverse?-this.value:this.value,this.empty)+"</span>"),this.el.nativeElement.classList.remove("hide-zero-value","positive-value","negative-value"),0==this.value&&this.hideEmpty?this.el.nativeElement.classList.add("hide-zero-value"):this.colored&&(!this.invert&&this.value>0||this.invert&&this.value<0?this.el.nativeElement.classList.add("positive-value"):(!this.invert&&this.value<0||this.invert&&this.value>0)&&this.el.nativeElement.classList.add("negative-value"))}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT))};static \u0275dir=t.FsC({type:a,selectors:[["","value-sign",""]],inputs:{value:[0,"value-sign","value"],colored:"colored",empty:"empty",hideEmpty:"hideEmpty",reverse:"reverse",invert:"invert",container:"container"},standalone:!1,features:[t.OA$]})}return a})();const K_=["charactertitle"],W_=["objectiveTitle"],Z_=["summonTitle"],J_=a=>({absent:a}),Q_=a=>({"change-entity":a}),tm=a=>({fh:a}),Xt=a=>({disabled:a}),ka=a=>({"immunity disabled":a}),rs=a=>({empty:a}),ya=a=>({active:a}),nm=(a,r,n)=>({active:a,new:r,fh:n}),em=a=>({"disabled soft":a}),am=(a,r)=>({active:a,new:r}),ki=()=>[],im=a=>({deactivated:a}),om=a=>({"active-tag":a}),sm=a=>({bb:a}),xa=(a,r)=>r._trackUUID;function rm(a,r){if(1&a&&t.nrm(0,"ghs-entity-index-key",4),2&a){const n=t.XpG();t.Y8G("entity",n.data.entity)("show",!0)}}function cm(a,r){if(1&a){const n=t.RV6();t.nrm(0,"span",12),t.j41(1,"img",13),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleCharacterMarker())}),t.k0s(),t.j41(2,"span",14),t.EFF(3),t.k0s(),t.nrm(4,"span",12),t.j41(5,"img",15),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleCharacterAbsent())}),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("src",n.gameManager.toCharacter(n.data.figure).iconUrl,t.B4B),t.R7$(),t.Y8G("ngClass",t.eq3(6,J_,n.gameManager.toCharacter(n.data.figure).absent)),t.R7$(),t.JRh(n.gameManager.characterManager.characterName(n.gameManager.toCharacter(n.data.figure),!0)),t.R7$(2),t.Y8G("src","./assets/images/status/"+(n.gameManager.toCharacter(n.data.figure).absent?"absent":"present")+".svg",t.B4B)("ghs-label",n.gameManager.toCharacter(n.data.figure).absent?"character.present":"character.absent")("ghs-label-attribute","title")}}function lm(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.JRh(n.gameManager.toObjectiveContainer(n.data.figure).title)}}function gm(a,r){if(1&a&&t.nrm(0,"span",17),2&a){const n=t.XpG(2);t.Y8G("ghs-label","data.objective."+n.gameManager.toObjectiveContainer(n.data.figure).name)}}function dm(a,r){if(1&a&&t.nrm(0,"span",17),2&a){const n=t.XpG(2);t.Y8G("ghs-label",n.gameManager.toObjectiveContainer(n.data.figure).escort?"escort":"objective")}}function hm(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1," \xa0( "),t.nrm(2,"span",17),t.EFF(3," ) "),t.k0s()),2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label",n.gameManager.toObjectiveContainer(n.data.figure).escort?"escort":"objective")}}function _m(a,r){if(1&a&&(t.nrm(0,"img",16),t.nVh(1,lm,2,1,"span"),t.nVh(2,gm,1,1,"span",17),t.nVh(3,dm,1,1,"span",17),t.nVh(4,hm,4,1,"span")),2&a){const n=t.XpG();t.Y8G("src","./assets/images/objective/"+(n.gameManager.toObjectiveContainer(n.data.figure).escort?"escort":"objective")+".svg",t.B4B),t.R7$(),t.vxM(n.gameManager.toObjectiveContainer(n.data.figure).title?1:-1),t.R7$(),t.vxM(!n.gameManager.toObjectiveContainer(n.data.figure).title&&n.gameManager.toObjectiveContainer(n.data.figure).name?2:-1),t.R7$(),t.vxM(n.gameManager.toObjectiveContainer(n.data.figure).title||n.gameManager.toObjectiveContainer(n.data.figure).name?-1:3),t.R7$(),t.vxM(n.gameManager.toObjectiveContainer(n.data.figure).title?4:-1)}}function mm(a,r){if(1&a&&t.nrm(0,"img",19),2&a){const n=t.XpG(2);t.Y8G("src",n.gameManager.monsterManager.monsterThumbnail(n.gameManager.toMonster(n.data.figure)),t.B4B)}}function pm(a,r){1&a&&(t.j41(0,"span",20),t.nrm(1,"span",17),t.EFF(2,"\xa0"),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","game.ally"))}function um(a,r){1&a&&(t.j41(0,"span",21),t.nrm(1,"span",17),t.EFF(2,"\xa0"),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","game.allied"))}function fm(a,r){if(1&a&&(t.j41(0,"span",22),t.EFF(1),t.k0s()),2&a){const n=t.XpG(2);t.Y8G("ngClass",n.gameManager.toMonsterEntity(n.data.entity).type+(n.bb?" bb-"+n.gameManager.toMonsterEntity(n.data.entity).number:"")),t.R7$(),t.SpI("#",n.gameManager.toMonsterEntity(n.data.entity).number)}}function Cm(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",18),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeMonsterEntity())}),t.nVh(1,mm,1,1,"img",19),t.nrm(2,"span",17),t.EFF(3,"\xa0 "),t.nVh(4,pm,3,1,"span",20),t.nVh(5,um,3,1,"span",21),t.nVh(6,fm,2,2,"span",22),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(6,Q_,n.gameManager.monsterManager.monsterStandeeMax(n.gameManager.toMonster(n.data.figure))>1||n.data.entity&&n.gameManager.isMonsterEntity(n.data.entity)&&n.gameManager.toMonsterEntity(n.data.entity).type!=n.MonsterType.boss)),t.R7$(),t.vxM(!n.gameManager.toMonster(n.data.figure).noThumbnail&&n.settingsManager.settings.artwork?1:-1),t.R7$(),t.Y8G("ghs-label","data.monster."+n.data.figure.name),t.R7$(2),t.vxM(n.gameManager.toMonster(n.data.figure).isAlly?4:-1),t.R7$(),t.vxM(n.gameManager.toMonster(n.data.figure).isAllied?5:-1),t.R7$(),t.vxM(n.data.entity&&n.gameManager.isMonsterEntity(n.data.entity)?6:-1)}}function Mm(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.JRh(n.gameManager.toCharacter(n.data.figure).title)}}function vm(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1,"\xa0("),t.nrm(2,"span",17),t.EFF(3,")"),t.k0s()),2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","data.character."+n.data.figure.edition+"."+n.data.figure.name)}}function Om(a,r){if(1&a&&t.nrm(0,"span",17),2&a){const n=t.XpG(2);t.Y8G("ghs-label","data.character."+n.data.figure.edition+"."+n.data.figure.name)}}function Pm(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.SpI("",n.gameManager.toSummon(n.data.entity).title,"\xa0")}}function bm(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"("),t.k0s())}function km(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,")"),t.k0s())}function ym(a,r){if(1&a&&(t.j41(0,"span"),t.nVh(1,bm,2,0,"span"),t.nrm(2,"span",17),t.nVh(3,km,2,0,"span"),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.vxM(n.gameManager.toSummon(n.data.entity).title?1:-1),t.R7$(),t.Y8G("ghs-label","data.summon."+n.gameManager.toSummon(n.data.entity).name),t.R7$(),t.vxM(n.gameManager.toSummon(n.data.entity).title?3:-1)}}function xm(a,r){1&a&&(t.j41(0,"span"),t.nrm(1,"span",17),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","game.summon"))}function Em(a,r){if(1&a&&t.nrm(0,"img",24),2&a){const n=t.XpG(2);t.Y8G("src",t.VkB("./assets/images/summons/",n.gameManager.toSummon(n.data.entity).color,".png"),t.B4B)}}function wm(a,r){if(1&a&&(t.j41(0,"small"),t.nrm(1,"img",16),t.nVh(2,Mm,2,1,"span"),t.nVh(3,vm,4,1,"span"),t.nVh(4,Om,1,1,"span",17),t.k0s(),t.nVh(5,Pm,2,1,"span"),t.nVh(6,ym,4,3,"span"),t.nVh(7,xm,2,1,"span"),t.j41(8,"span",23),t.nVh(9,Em,1,2,"img",24),t.j41(10,"span",25),t.EFF(11),t.k0s()()),2&a){const n=t.XpG();t.R7$(),t.Y8G("src",n.gameManager.toCharacter(n.data.figure).iconUrl,t.B4B),t.R7$(),t.vxM(n.gameManager.toCharacter(n.data.figure).title?2:-1),t.R7$(),t.vxM(n.gameManager.toCharacter(n.data.figure).title?3:-1),t.R7$(),t.vxM(n.gameManager.toCharacter(n.data.figure).title?-1:4),t.R7$(),t.vxM(n.gameManager.toSummon(n.data.entity).title?5:-1),t.R7$(),t.vxM(n.gameManager.toSummon(n.data.entity).name?6:-1),t.R7$(),t.vxM(n.gameManager.toSummon(n.data.entity).name?-1:7),t.R7$(),t.Y8G("ngClass",t.eq3(10,tm,n.gameManager.toSummon(n.data.entity).color==n.SummonColor.fh)),t.R7$(),t.vxM(n.gameManager.toSummon(n.data.entity).color!=n.SummonColor.fh?9:-1),t.R7$(2),t.JRh(n.gameManager.toSummon(n.data.entity).number)}}function Rm(a,r){if(1&a&&(t.j41(0,"div",27),t.nrm(1,"ghs-action",33),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(),t.Y8G("action",n)("highlight",i.settingsManager.settings.statAnimations)}}function jm(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",34)(1,"ghs-pointer-input",40),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(4);return c.Njj(e.changeLoot(-1))}),t.nrm(2,"img",36),t.k0s()(),t.j41(3,"span",30)(4,"span",37),t.EFF(5),t.k0s(),t.nrm(6,"img",45)(7,"span",43),t.k0s(),t.j41(8,"span",34)(9,"ghs-pointer-input",35),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(4);return c.Njj(e.changeLoot(1))}),t.nrm(10,"img",41),t.k0s()()}if(2&a){const n=t.XpG(4);t.R7$(),t.Y8G("ngClass",t.eq3(8,Xt,n.gameManager.toCharacter(n.data.entity).loot+n.loot==0))("repeat",!0),t.R7$(2),t.Y8G("ghs-label","game.loot")("ghs-label-attribute","title"),t.R7$(2),t.JRh(n.gameManager.toCharacter(n.data.entity).loot+n.loot),t.R7$(2),t.Y8G("value-sign",n.loot)("hideEmpty",!0),t.R7$(2),t.Y8G("repeat",!0)}}function Gm(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",34)(1,"ghs-pointer-input",40),t.bIt("singleClick",function(){const e=c.eBV(n).$index,o=t.XpG(4);return c.Njj(o.changeCharacterToken(-1,e))}),t.nrm(2,"img",36),t.k0s()(),t.j41(3,"span",44)(4,"span",37),t.EFF(5),t.k0s(),t.nrm(6,"span",17)(7,"span",43),t.k0s(),t.j41(8,"span",34)(9,"ghs-pointer-input",35),t.bIt("singleClick",function(){const e=c.eBV(n).$index,o=t.XpG(4);return c.Njj(o.changeCharacterToken(1,e))}),t.nrm(10,"img",41),t.k0s()()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(4);t.R7$(),t.Y8G("ngClass",t.eq3(9,Xt,e.gameManager.toCharacter(e.data.entity).tokenValues[i]+e.characterTokenValues[i]==0))("repeat",!0),t.R7$(2),t.Y8G("ghs-label","data.character."+e.gameManager.toCharacter(e.data.entity).edition+"."+e.gameManager.toCharacter(e.data.entity).name+".tokens."+n)("ghs-label-attribute","title"),t.R7$(2),t.JRh(e.gameManager.toCharacter(e.data.entity).tokenValues[i]+e.characterTokenValues[i]),t.R7$(),t.Y8G("ghs-label","%data.characterToken."+e.gameManager.toCharacter(e.data.entity).name+"."+n+"%"),t.R7$(),t.Y8G("value-sign",e.characterTokenValues[i])("hideEmpty",!0),t.R7$(2),t.Y8G("repeat",!0)}}function Tm(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",34)(1,"ghs-pointer-input",40),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.changeExperience(-1))}),t.nrm(2,"img",36),t.k0s()(),t.j41(3,"span",30)(4,"span",37),t.EFF(5),t.k0s(),t.nrm(6,"img",42)(7,"span",43),t.k0s(),t.j41(8,"span",34)(9,"ghs-pointer-input",35),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.changeExperience(1))}),t.nrm(10,"img",41),t.k0s()(),t.nVh(11,jm,11,10),t.j41(12,"span",34)(13,"ghs-pointer-input",40),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.changeCharacterToken(-1))}),t.nrm(14,"img",36),t.k0s()(),t.j41(15,"span",44)(16,"span",37),t.EFF(17),t.k0s(),t.nrm(18,"span",17)(19,"span",43),t.k0s(),t.j41(20,"span",34)(21,"ghs-pointer-input",35),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.changeCharacterToken(1))}),t.nrm(22,"img",41),t.k0s()(),t.Z7z(23,Gm,11,11,null,null,t.fX1)}if(2&a){const n=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(18,Xt,n.gameManager.toCharacter(n.data.entity).experience+n.experience==0))("repeat",!0),t.R7$(2),t.Y8G("ghs-label","game.experience")("ghs-label-attribute","title"),t.R7$(2),t.JRh(n.gameManager.toCharacter(n.data.entity).experience+n.experience),t.R7$(2),t.Y8G("value-sign",n.experience)("hideEmpty",!0),t.R7$(2),t.Y8G("repeat",!0),t.R7$(2),t.vxM(n.settingsManager.settings.lootDeck&&(n.settingsManager.settings.alwaysLootDeck||n.gameManager.fhRules())||n.settingsManager.settings.hideCharacterLoot?-1:11),t.R7$(2),t.Y8G("ngClass",t.eq3(20,Xt,n.gameManager.toCharacter(n.data.entity).token+n.characterToken==0))("repeat",!0),t.R7$(2),t.Y8G("ghs-label","character.token")("ghs-label-attribute","title"),t.R7$(2),t.JRh(n.gameManager.toCharacter(n.data.entity).token+n.characterToken),t.R7$(),t.Y8G("ghs-label","%data.characterToken."+n.gameManager.toCharacter(n.data.entity).name+"%"),t.R7$(),t.Y8G("value-sign",n.characterToken)("hideEmpty",!0),t.R7$(2),t.Y8G("repeat",!0),t.R7$(2),t.Dyx(n.gameManager.toCharacter(n.data.entity).tokens)}}function Sm(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",34)(1,"ghs-pointer-input",35),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeHealth(-1))}),t.nrm(2,"img",36),t.k0s()(),t.j41(3,"span",30)(4,"span",37),t.EFF(5),t.nI1(6,"ghsMinZero"),t.k0s(),t.nrm(7,"img",38)(8,"span",39),t.k0s(),t.j41(9,"span",34)(10,"ghs-pointer-input",40),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeHealth(1))}),t.nrm(11,"img",41),t.k0s()(),t.nVh(12,Tm,25,22)}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-label","game.health")("ghs-label-attribute","title"),t.R7$(2),t.JRh(t.bMT(6,9,n.data.entity.health+n.health)),t.R7$(3),t.Y8G("value-sign",n.health)("hideEmpty",!0),t.R7$(2),t.Y8G("ngClass",t.eq3(11,Xt,n.data.entity.health+n.health==n.Math.max(n.EntityValueFunction(n.data.entity.maxHealth),n.specialTags.includes("unbridled-power")?26:0)+n.maxHp))("repeat",!0),t.R7$(2),t.vxM(n.gameManager.isCharacter(n.data.entity)&&!n.bb?12:-1)}}function Dm(a,r){1&a&&(t.j41(0,"span",49),t.nrm(1,"img",52),t.k0s())}function $m(a,r){1&a&&(t.j41(0,"span",49),t.nrm(1,"img",52),t.k0s())}function Im(a,r){1&a&&(t.j41(0,"span",49),t.nrm(1,"img",52),t.k0s())}function Am(a,r){if(1&a&&(t.j41(0,"span",55),t.nrm(1,"img",24),t.k0s()),2&a){const n=t.XpG(4);t.R7$(),t.Y8G("src",n.empowerChar.iconUrl,t.B4B)}}function Vm(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",34)(1,"ghs-pointer-input",40),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.changeEmpower(-1))}),t.nrm(2,"img",36),t.k0s()(),t.j41(3,"span",34)(4,"span",53),t.EFF(5),t.k0s(),t.j41(6,"span",47),t.nrm(7,"img",54),t.k0s(),t.nrm(8,"span",43),t.nVh(9,Im,2,0,"span",49),t.nVh(10,Am,2,1,"span",55),t.k0s(),t.j41(11,"span",34)(12,"ghs-pointer-input",40),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.changeEmpower(1))}),t.nrm(13,"img",41),t.k0s()()}if(2&a){const n=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(15,Xt,n.countUpcomingAttackModifier(n.AttackModifierType.empower)+n.empower==0||n.isImmune(n.ConditionName.empower)||n.entityImmunities.includes(n.ConditionName.empower)))("repeat",!0),t.R7$(4),t.JRh(n.countUpcomingAttackModifier(n.AttackModifierType.empower)+n.empower),t.R7$(),t.Y8G("ghs-tooltip","game.condition.empower.hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom")("ngClass",t.eq3(17,ka,n.isImmune(n.ConditionName.empower)||n.entityImmunities.includes(n.ConditionName.empower))),t.R7$(2),t.Y8G("value-sign",n.empower)("hideEmpty",!0),t.R7$(),t.vxM(n.countEmpower()<0?9:-1),t.R7$(),t.vxM(n.empowerChar?10:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(19,Xt,n.empowerChar&&n.empower>=n.countEmpower()||n.isImmune(n.ConditionName.empower)||n.entityImmunities.includes(n.ConditionName.empower)))("repeat",!0)}}function Fm(a,r){1&a&&(t.j41(0,"span",49),t.nrm(1,"img",52),t.k0s())}function Xm(a,r){if(1&a&&(t.j41(0,"span",55),t.nrm(1,"img",24),t.k0s()),2&a){const n=t.XpG(4);t.R7$(),t.Y8G("src",n.enfeebleChar.iconUrl,t.B4B)}}function Bm(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",34)(1,"ghs-pointer-input",40),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.changeEnfeeble(-1))}),t.nrm(2,"img",36),t.k0s()(),t.j41(3,"span",34)(4,"span",56),t.EFF(5),t.k0s(),t.j41(6,"span",47),t.nrm(7,"img",57),t.k0s(),t.nrm(8,"span",43),t.nVh(9,Fm,2,0,"span",49),t.nVh(10,Xm,2,1,"span",55),t.k0s(),t.j41(11,"span",34)(12,"ghs-pointer-input",40),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.changeEnfeeble(1))}),t.nrm(13,"img",41),t.k0s()()}if(2&a){const n=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(15,Xt,n.countUpcomingAttackModifier(n.AttackModifierType.enfeeble)+n.enfeeble==0||n.isImmune(n.ConditionName.enfeeble)||n.entityImmunities.includes(n.ConditionName.enfeeble)))("repeat",!0),t.R7$(4),t.JRh(n.countUpcomingAttackModifier(n.AttackModifierType.enfeeble)+n.enfeeble),t.R7$(),t.Y8G("ghs-tooltip","game.condition.enfeeble.hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom")("ngClass",t.eq3(17,ka,n.isImmune(n.ConditionName.enfeeble)||n.entityImmunities.includes(n.ConditionName.enfeeble))),t.R7$(2),t.Y8G("value-sign",n.enfeeble)("hideEmpty",!0),t.R7$(),t.vxM(n.countEnfeeble()<0?9:-1),t.R7$(),t.vxM(n.enfeebleChar?10:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(19,Xt,n.enfeebleChar&&n.enfeeble>=n.countEnfeeble()||n.isImmune(n.ConditionName.enfeeble)||n.entityImmunities.includes(n.ConditionName.enfeeble)))("repeat",!0)}}function Ym(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",34)(1,"ghs-pointer-input",40),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeBless(-1))}),t.nrm(2,"img",36),t.k0s()(),t.j41(3,"span",34)(4,"span",46),t.EFF(5),t.k0s(),t.j41(6,"span",47),t.nrm(7,"img",48),t.k0s(),t.nrm(8,"span",43),t.nVh(9,Dm,2,0,"span",49),t.k0s(),t.j41(10,"span",34)(11,"ghs-pointer-input",40),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeBless(1))}),t.nrm(12,"img",41),t.k0s()(),t.j41(13,"span",34)(14,"ghs-pointer-input",40),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeCurse(-1))}),t.nrm(15,"img",36),t.k0s()(),t.j41(16,"span",34)(17,"span",50),t.EFF(18),t.k0s(),t.j41(19,"span",47),t.nrm(20,"img",51),t.k0s(),t.nrm(21,"span",43),t.nVh(22,$m,2,0,"span",49),t.k0s(),t.j41(23,"span",34)(24,"ghs-pointer-input",40),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeCurse(1))}),t.nrm(25,"img",41),t.k0s()(),t.nVh(26,Vm,14,21),t.nVh(27,Bm,14,21)}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(30,Xt,n.countUpcomingAttackModifier(n.AttackModifierType.bless)+n.bless==0||n.isImmune(n.ConditionName.bless)||n.entityImmunities.includes(n.ConditionName.bless)))("repeat",!0),t.R7$(4),t.JRh(n.countUpcomingAttackModifier(n.AttackModifierType.bless)+n.bless),t.R7$(),t.Y8G("ghs-tooltip","game.condition.bless.hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom")("ngClass",t.eq3(32,ka,n.isImmune(n.ConditionName.bless)||n.entityImmunities.includes(n.ConditionName.bless))),t.R7$(2),t.Y8G("value-sign",n.bless)("hideEmpty",!0),t.R7$(),t.vxM(n.gameManager.attackModifierManager.countUpcomingBlesses()+n.bless>10?9:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(34,Xt,n.gameManager.attackModifierManager.countUpcomingBlesses()+n.bless>=10||n.isImmune(n.ConditionName.bless)||n.entityImmunities.includes(n.ConditionName.bless)))("repeat",!0),t.R7$(3),t.Y8G("ngClass",t.eq3(36,Xt,n.countUpcomingAttackModifier(n.AttackModifierType.curse)+n.curse==0||n.isImmune(n.ConditionName.curse)||n.entityImmunities.includes(n.ConditionName.curse)))("repeat",!0),t.R7$(4),t.JRh(n.countUpcomingAttackModifier(n.AttackModifierType.curse)+n.curse),t.R7$(),t.Y8G("ghs-tooltip","game.condition.curse.hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom")("ngClass",t.eq3(38,ka,n.isImmune(n.ConditionName.curse)||n.entityImmunities.includes(n.ConditionName.curse))),t.R7$(2),t.Y8G("value-sign",n.curse)("hideEmpty",!0),t.R7$(),t.vxM(n.gameManager.attackModifierManager.countUpcomingCurses(n.gameManager.isMonster(n.data.figure)&&!n.gameManager.toMonster(n.data.figure).isAlly&&!n.gameManager.toMonster(n.data.figure).isAllied)+n.curse>10?22:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(40,Xt,n.gameManager.attackModifierManager.countUpcomingCurses(n.gameManager.isMonster(n.data.figure)&&!n.gameManager.toMonster(n.data.figure).isAlly&&!n.gameManager.toMonster(n.data.figure).isAllied||n.gameManager.isObjectiveContainer(n.data.figure)&&"M"==n.gameManager.toObjectiveContainer(n.data.figure).amDeck)+n.curse>=10||n.isImmune(n.ConditionName.curse)||n.entityImmunities.includes(n.ConditionName.curse)))("repeat",!0),t.R7$(2),t.vxM(n.hasCondition(n.ConditionName.empower)?26:-1),t.R7$(),t.vxM(n.hasCondition(n.ConditionName.enfeeble)?27:-1)}}function Um(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",34)(1,"ghs-pointer-input",35),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeHealth(-1))}),t.nrm(2,"img",36),t.k0s()(),t.j41(3,"span",30)(4,"span",37),t.EFF(5),t.nI1(6,"ghsMinZero"),t.k0s(),t.nrm(7,"img",58)(8,"span",59),t.k0s(),t.j41(9,"span",34)(10,"ghs-pointer-input",35),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeHealth(1))}),t.nrm(11,"img",41),t.k0s()()}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-label","game.health")("ghs-label-attribute","title"),t.R7$(2),t.JRh(t.bMT(6,8,n.data.entity.health+n.health)),t.R7$(3),t.Y8G("value-sign",n.health)("hideEmpty",!0)("invert",!0),t.R7$(2),t.Y8G("repeat",!0)}}function Nm(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",34)(1,"ghs-pointer-input",35),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeId(-1))}),t.nrm(2,"img",60),t.k0s()(),t.j41(3,"span",34)(4,"span",61),t.EFF(5),t.k0s()(),t.j41(6,"span",34)(7,"ghs-pointer-input",35),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeId(1))}),t.nrm(8,"img",62),t.k0s()()}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("repeat",!0),t.R7$(4),t.JRh(n.gameManager.toObjectiveEntity(n.data.entity).number+n.id),t.R7$(2),t.Y8G("repeat",!0)}}function zm(a,r){if(1&a&&(t.j41(0,"span",34)(1,"span",63),t.EFF(2),t.k0s()()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(2,rs,!n.OBJECTIV_MARKERS[(n.marker+n.OBJECTIV_MARKERS.indexOf(n.gameManager.toObjectiveContainer(n.data.figure).marker))%n.OBJECTIV_MARKERS.length])),t.R7$(),t.JRh(n.OBJECTIV_MARKERS[(n.marker+n.OBJECTIV_MARKERS.indexOf(n.gameManager.toObjectiveContainer(n.data.figure).marker))%n.OBJECTIV_MARKERS.length])}}function Lm(a,r){if(1&a&&(t.j41(0,"span",34)(1,"span",63),t.EFF(2),t.k0s()()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(2,rs,!n.OBJECTIV_MARKERS[(n.marker+n.OBJECTIV_MARKERS.indexOf(n.gameManager.toObjectiveEntity(n.data.entity).marker))%n.OBJECTIV_MARKERS.length])),t.R7$(),t.JRh(n.OBJECTIV_MARKERS[(n.marker+n.OBJECTIV_MARKERS.indexOf(n.gameManager.toObjectiveEntity(n.data.entity).marker))%n.OBJECTIV_MARKERS.length])}}function qm(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",34)(1,"ghs-pointer-input",35),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeMarker(-1))}),t.nrm(2,"img",60),t.k0s()(),t.nVh(3,zm,3,4,"span",34),t.nVh(4,Lm,3,4,"span",34),t.j41(5,"span",34)(6,"ghs-pointer-input",35),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeMarker(1))}),t.nrm(7,"img",62),t.k0s()()}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("repeat",!0),t.R7$(2),t.vxM(n.data.entity&&n.gameManager.isObjectiveEntity(n.data.entity)?-1:3),t.R7$(),t.vxM(n.data.entity&&n.gameManager.isObjectiveEntity(n.data.entity)?4:-1),t.R7$(2),t.Y8G("repeat",!0)}}function Hm(a,r){if(1&a&&t.nrm(0,"span",17),2&a){const n=t.XpG(3);t.Y8G("ghs-label",""+n.gameManager.toSummon(n.data.entity).attack)}}function Km(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function Wm(a,r){if(1&a&&(t.j41(0,"span",69),t.nrm(1,"ghs-action",70),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("action",n.gameManager.toSummon(n.data.entity).action)}}function Zm(a,r){if(1&a&&(t.j41(0,"span",69),t.nrm(1,"ghs-action",70),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("action",n.gameManager.toSummon(n.data.entity).additionalAction)}}function Jm(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",28)(1,"span",64),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openLevelDialog())}),t.nrm(2,"img",65),t.j41(3,"span",66),t.EFF(4,">"),t.k0s()(),t.j41(5,"span",64),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openLevelDialog())}),t.nrm(6,"img",67),t.nVh(7,Hm,1,1,"span",17),t.nVh(8,Km,2,0,"span"),t.k0s(),t.j41(9,"span",64),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openLevelDialog())}),t.nrm(10,"img",68),t.j41(11,"span",66),t.EFF(12,">"),t.k0s()(),t.nVh(13,Wm,2,1,"span",69),t.nVh(14,Zm,2,1,"span",69),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(3),t.Y8G("value-calc",n.gameManager.toSummon(n.data.entity).movement)("empty",!0),t.R7$(4),t.vxM(0!=n.gameManager.toSummon(n.data.entity).attack?7:-1),t.R7$(),t.vxM(0==n.gameManager.toSummon(n.data.entity).attack?8:-1),t.R7$(3),t.Y8G("value-calc",n.gameManager.toSummon(n.data.entity).range)("empty",!0),t.R7$(2),t.vxM(n.gameManager.toSummon(n.data.entity).action?13:-1),t.R7$(),t.vxM(n.gameManager.toSummon(n.data.entity).additionalAction?14:-1)}}function Qm(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",29)(1,"a",71),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.toggleExhausted())}),t.nrm(2,"img",72),t.k0s()()}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","game.exhausted")("ghs-label-attribute","title")("ngClass",t.eq3(3,ya,n.gameManager.toCharacter(n.data.entity).exhausted))}}function tp(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",30)(1,"a",73),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.toggleDead())}),t.nrm(2,"img",74),t.k0s()()}2&a&&t.Y8G("ghs-label","game.dead")("ghs-label-attribute","title")}function np(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",30)(1,"a",75),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openLevelDialog())}),t.EFF(2),t.nrm(3,"img",76),t.k0s()()}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","game.level")("ghs-label-attribute","title"),t.R7$(2),t.SpI(" ",n.data.figure.level," ")}}function ep(a,r){if(1&a&&t.nrm(0,"img",24),2&a){const n=t.XpG(3);t.Y8G("src",t.VkB("./assets/images/summons/",n.gameManager.toSummon(n.data.entity).color,".png"),t.B4B)}}function ap(a,r){if(1&a&&(t.j41(0,"span",25),t.EFF(1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.SpI(" ",n.gameManager.toSummon(n.data.entity).number," ")}}function ip(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",30)(1,"a",73),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.toggleDead())}),t.nrm(2,"img",74),t.k0s()(),t.j41(3,"span",30)(4,"a",75),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openLevelDialog())}),t.EFF(5),t.nrm(6,"img",76),t.k0s()(),t.j41(7,"span",34)(8,"a",77),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.toggleSummonStatus())}),t.nVh(9,ep,1,2,"img",24),t.nVh(10,ap,2,1,"span",25),t.k0s()()}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","game.dead")("ghs-label-attribute","title"),t.R7$(3),t.Y8G("ghs-label","game.level")("ghs-label-attribute","title"),t.R7$(2),t.SpI(" ",n.data.figure.level," "),t.R7$(3),t.Y8G("ngClass",t.sMw(8,nm,n.gameManager.toSummon(n.data.entity).state==n.SummonState.true,n.gameManager.toSummon(n.data.entity).state==n.SummonState.new,n.gameManager.toSummon(n.data.entity).color==n.SummonColor.fh)),t.R7$(),t.vxM(n.gameManager.toSummon(n.data.entity).color!=n.SummonColor.fh?9:-1),t.R7$(),t.vxM(n.gameManager.toSummon(n.data.entity).color==n.SummonColor.fh?10:-1)}}function op(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",78)(1,"ghs-pointer-input",35),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.changeMaxHealth(-1))}),t.nrm(2,"img",36),t.k0s(),t.nrm(3,"img",79),t.j41(4,"span",80),t.EFF(5),t.k0s(),t.j41(6,"ghs-pointer-input",35),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.changeMaxHealth(1))}),t.nrm(7,"img",41),t.k0s()()}if(2&a){const n=t.XpG(3);t.R7$(),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-label","game.maxHealth")("ghs-label-attribute","title"),t.R7$(2),t.Lme("",n.EntityValueFunction(n.data.entity.maxHealth)+n.maxHp<n.EntityValueFunction(n.data.entity.maxHealth)||n.data.entity.health==+n.data.entity.maxHealth?n.EntityValueFunction(n.data.entity.maxHealth)+n.maxHp:n.data.entity.health,"/",n.EntityValueFunction(n.data.entity.maxHealth)+n.maxHp),t.R7$(),t.Y8G("repeat",!0)}}function sp(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",30)(1,"a",73),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.toggleDead())}),t.nrm(2,"img",74),t.k0s()(),t.nVh(3,op,8,6,"span",78)}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","game.dead")("ghs-label-attribute","title"),t.R7$(3),t.vxM(n.EntityValueFunction(n.data.entity.maxHealth)>0?3:-1)}}function rp(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",30)(1,"ghs-pointer-input",81),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.dead(!0))})("doubleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.dead(!0,!0))}),t.nrm(2,"img",82),t.k0s()()}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","data.buildings.stables.pets.catch")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ngClass",t.eq3(3,em,n.catchingDisabled))}}function cp(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",77),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.toggleSummon())}),t.nrm(1,"img",24),t.k0s()}if(2&a){const n=t.XpG(3);t.Y8G("ngClass",t.l_i(3,am,n.gameManager.toMonsterEntity(n.data.entity).summon==n.SummonState.true,n.gameManager.toMonsterEntity(n.data.entity).summon==n.SummonState.new)),t.R7$(),t.Y8G("src",t.VkB("./assets/images/summons/",n.gameManager.toMonster(n.data.figure).summonColor,".png"),t.B4B)}}function lp(a,r){if(1&a){const n=t.RV6();t.j41(0,"span")(1,"a",84),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.toggleMarker(e))}),t.j41(2,"span",85),t.nrm(3,"img",24),t.k0s()()()}if(2&a){const n=r.$implicit,i=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(2,ya,i.hasMarker(n))),t.R7$(2),t.Y8G("src",i.gameManager.characterManager.characterIcon(n),t.B4B)}}function gp(a,r){if(1&a&&(t.j41(0,"div",31),t.nVh(1,cp,2,6,"a",83),t.Z7z(2,lp,4,4,"span",null,t.fX1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.vxM(n.data.entity&&n.EntityValueFunction(n.data.entity.maxHealth)>0&&(!n.gameManager.isMonster(n.data.figure)||!n.gameManager.toMonster(n.data.figure).immortal)&&n.gameManager.isMonsterEntity(n.data.entity)?1:-1),t.R7$(),t.Dyx(n.markers())}}function dp(a,r){if(1&a&&t.nrm(0,"ghs-conditions",32),2&a){const n=t.XpG(2);t.Y8G("entityConditions",n.entityConditions)("immunities",n.entityImmunities)("entity",n.data.entity)("figure",n.data.figure)("type",n.conditionType)("empower",n.hasCondition(n.ConditionName.empower))("enfeeble",n.hasCondition(n.ConditionName.enfeeble))}}function hp(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-pointer-input",95),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(4);return c.Njj(e.changeRetaliate(e.entityRetaliate.length,1,0))}),t.nrm(1,"img",96),t.k0s()}}function _p(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",91)(1,"ghs-pointer-input",88),t.bIt("singleClick",function(){const e=c.eBV(n).$index,o=t.XpG(3);return c.Njj(o.changeRetaliate(e,-1,0))}),t.nrm(2,"img",36),t.k0s(),t.j41(3,"ghs-pointer-input",92),t.bIt("singleClick",function(){const e=c.eBV(n).$index,o=t.XpG(3);return c.Njj(o.changeRetaliate(e,0,-1))}),t.nrm(4,"img",36),t.k0s()(),t.j41(5,"span",91),t.nrm(6,"ghs-action",70)(7,"ghs-action",70),t.nVh(8,hp,2,0,"ghs-pointer-input",93),t.k0s(),t.j41(9,"span",91)(10,"ghs-pointer-input",89),t.bIt("singleClick",function(){const e=c.eBV(n).$index,o=t.XpG(3);return c.Njj(o.changeRetaliate(e,1,0))}),t.nrm(11,"img",41),t.k0s(),t.j41(12,"ghs-pointer-input",94),t.bIt("singleClick",function(){const e=c.eBV(n).$index,o=t.XpG(3);return c.Njj(o.changeRetaliate(e,0,1))}),t.nrm(13,"img",41),t.k0s()()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(9,Xt,!n.value)),t.R7$(2),t.Y8G("ngClass",t.eq3(11,Xt,e.EntityValueFunction(e.entityRetaliateRange[i].value)<=1)),t.R7$(3),t.Aen("fh"),t.Y8G("action",n),t.R7$(),t.Aen("fh"),t.Y8G("action",e.entityRetaliateRange[i]),t.R7$(),t.vxM(i==e.entityRetaliate.length-1&&n.value?8:-1)}}function mp(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-pointer-input",95),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(4);return c.Njj(e.changeRetaliatePersistent(e.entityRetaliatePersistent.length,1,0))}),t.nrm(1,"img",96),t.k0s()}}function pp(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",91)(1,"ghs-pointer-input",88),t.bIt("singleClick",function(){const e=c.eBV(n).$index,o=t.XpG(3);return c.Njj(o.changeRetaliatePersistent(e,-1,0))}),t.nrm(2,"img",36),t.k0s(),t.j41(3,"ghs-pointer-input",92),t.bIt("singleClick",function(){const e=c.eBV(n).$index,o=t.XpG(3);return c.Njj(o.changeRetaliatePersistent(e,0,-1))}),t.nrm(4,"img",36),t.k0s()(),t.j41(5,"span",91),t.nrm(6,"ghs-action",70)(7,"ghs-action",70),t.nVh(8,mp,2,0,"ghs-pointer-input",93),t.k0s(),t.j41(9,"span",91)(10,"ghs-pointer-input",89),t.bIt("singleClick",function(){const e=c.eBV(n).$index,o=t.XpG(3);return c.Njj(o.changeRetaliatePersistent(e,1,0))}),t.nrm(11,"img",41),t.k0s(),t.j41(12,"ghs-pointer-input",94),t.bIt("singleClick",function(){const e=c.eBV(n).$index,o=t.XpG(3);return c.Njj(o.changeRetaliatePersistent(e,0,1))}),t.nrm(13,"img",41),t.k0s()()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(9,Xt,!n.value)),t.R7$(2),t.Y8G("ngClass",t.eq3(11,Xt,e.EntityValueFunction(e.entityRetaliateRangePersistent[i].value)<=1)),t.R7$(3),t.Aen("fh"),t.Y8G("action",n),t.R7$(),t.Aen("fh"),t.Y8G("action",e.entityRetaliateRangePersistent[i]),t.R7$(),t.vxM(i==e.entityRetaliatePersistent.length-1&&n.value?8:-1)}}function up(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",26)(1,"span",86),t.nrm(2,"span",87),t.k0s(),t.j41(3,"span",34)(4,"ghs-pointer-input",88),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeShield(-1))}),t.nrm(5,"img",36),t.k0s()(),t.j41(6,"span",34),t.nrm(7,"ghs-action",70),t.k0s(),t.j41(8,"span",34)(9,"ghs-pointer-input",89),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeShield(1))}),t.nrm(10,"img",41),t.k0s()(),t.Z7z(11,_p,14,13,null,null,xa),t.nI1(13,"trackUUID"),t.nrm(14,"div",90),t.j41(15,"span",86),t.nrm(16,"span",87),t.k0s(),t.j41(17,"span",34)(18,"ghs-pointer-input",88),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeShieldPersistent(-1))}),t.nrm(19,"img",36),t.k0s()(),t.j41(20,"span",34),t.nrm(21,"ghs-action",70),t.k0s(),t.j41(22,"span",34)(23,"ghs-pointer-input",89),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeShieldPersistent(1))}),t.nrm(24,"img",41),t.k0s()(),t.Z7z(25,pp,14,13,null,null,xa),t.nI1(27,"trackUUID"),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","%game.card.round%"),t.R7$(2),t.Y8G("ngClass",t.eq3(14,Xt,!n.entityShield.value)),t.R7$(3),t.Aen("fh"),t.Y8G("action",n.entityShield),t.R7$(4),t.Dyx(t.bMT(13,10,n.entityRetaliate)),t.R7$(5),t.Y8G("ghs-label","%game.card.persistent%"),t.R7$(2),t.Y8G("ngClass",t.eq3(16,Xt,!n.entityShieldPersistent.value)),t.R7$(3),t.Aen("fh"),t.Y8G("action",n.entityShieldPersistent),t.R7$(4),t.Dyx(t.bMT(27,12,n.entityRetaliatePersistent))}}function fp(a,r){if(1&a&&(t.j41(0,"div",7)(1,"div",26),t.Z7z(2,Rm,2,2,"div",27,xa),t.nI1(4,"trackUUID"),t.nVh(5,Sm,13,13),t.nVh(6,Ym,28,42),t.nVh(7,Um,12,10),t.nVh(8,Nm,9,3),t.nVh(9,qm,8,4),t.nVh(10,Jm,15,8,"div",28),t.nVh(11,Qm,3,5,"span",29),t.nVh(12,tp,3,2,"span",30),t.nVh(13,np,4,3,"span",30),t.nVh(14,ip,11,12),t.nVh(15,sp,4,3),t.nVh(16,rp,3,5,"span",30),t.nVh(17,gp,4,1,"div",31),t.k0s(),t.nVh(18,dp,1,7,"ghs-conditions",32),t.nVh(19,up,28,18,"div",26),t.k0s()),2&a){const n=t.XpG();t.R7$(2),t.Dyx(t.bMT(4,15,n.actionHints)),t.R7$(3),t.vxM(!(n.data.entity&&n.EntityValueFunction(n.data.entity.maxHealth)>0)||n.gameManager.isMonster(n.data.figure)&&n.gameManager.toMonster(n.data.figure).immortal?-1:5),t.R7$(),t.vxM((n.gameManager.isCharacter(n.data.figure)&&n.settingsManager.settings.characterSheet&&n.settingsManager.settings.characterAttackModifierDeck||n.gameManager.isMonster(n.data.figure))&&(!n.data.entity||n.EntityValueFunction(n.data.entity.maxHealth)>0&&(!n.gameManager.isMonster(n.data.figure)||!n.gameManager.toMonster(n.data.figure).immortal)&&!n.bb)||n.gameManager.isObjectiveContainer(n.data.figure)&&n.gameManager.toObjectiveContainer(n.data.figure).escort&&n.gameManager.toObjectiveContainer(n.data.figure).amDeck?6:-1),t.R7$(),t.vxM(n.data.entity&&0==n.EntityValueFunction(n.data.entity.maxHealth)&&n.objectiveData&&n.objectiveData.trackDamage?7:-1),t.R7$(),t.vxM(n.data.entity&&n.gameManager.isObjectiveEntity(n.data.entity)?8:-1),t.R7$(),t.vxM(n.data.figure&&n.gameManager.isObjectiveContainer(n.data.figure)?9:-1),t.R7$(),t.vxM(n.data.entity&&n.gameManager.isSummon(n.data.entity)?10:-1),t.R7$(),t.vxM(n.data.entity&&n.gameManager.isCharacter(n.data.entity)?11:-1),t.R7$(),t.vxM(n.data.entity&&n.gameManager.isObjectiveEntity(n.data.entity)?12:-1),t.R7$(),t.vxM(n.data.entity&&n.gameManager.isCharacter(n.data.entity)?13:-1),t.R7$(),t.vxM(n.data.entity&&n.gameManager.isSummon(n.data.entity)?14:-1),t.R7$(),t.vxM(n.data.entity&&n.gameManager.isMonsterEntity(n.data.entity)?15:-1),t.R7$(),t.vxM(n.catching?16:-1),t.R7$(),t.vxM(n.bb?-1:17),t.R7$(),t.vxM(!(n.data.entity&&n.EntityValueFunction(n.data.entity.maxHealth)>0)||n.gameManager.isMonster(n.data.figure)&&n.gameManager.toMonster(n.data.figure).immortal?-1:18),t.R7$(),t.vxM(n.data.entity&&(n.settingsManager.settings.characterShieldRetaliate&&(n.gameManager.isCharacter(n.data.entity)||n.gameManager.isObjectiveContainer(n.data.figure)&&n.gameManager.toObjectiveContainer(n.data.figure).escort&&n.gameManager.isObjectiveEntity(n.data.entity))||n.settingsManager.settings.standeeShieldRetaliate&&(n.gameManager.isMonsterEntity(n.data.entity)||n.gameManager.isSummon(n.data.entity)))?19:-1)}}function Cp(a,r){1&a&&t.nrm(0,"hr",8)}function Mp(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",98),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.setIdentity(e))}),t.nrm(1,"img",24),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ghs-tooltip","data.character."+i.gameManager.toCharacter(i.data.entity).edition+"."+i.gameManager.toCharacter(i.data.entity).name+"."+i.gameManager.toCharacter(i.data.entity).identities[n])("ngClass",t.eq3(3,im,i.gameManager.toCharacter(i.data.entity).identity==n)),t.R7$(),t.Y8G("src",i.gameManager.characterManager.characterIdentityIcon(i.gameManager.toCharacter(i.data.entity).name,n),t.B4B)}}function vp(a,r){if(1&a&&(t.j41(0,"div",9),t.Z7z(1,Mp,2,5,"a",97,t.fX1),t.nI1(3,"ghsRange"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(t.i5U(3,0,t.lJ4(3,ki),n.gameManager.toCharacter(n.data.entity).identities.length))}}function Op(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",99),t.nrm(1,"img",100),t.j41(2,"span",101),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(2);return c.Njj(o.applySpecialAction(e))}),t.nrm(3,"span",17),t.k0s()()}if(2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.R7$(),t.Y8G("ghs-tooltip","data.character."+i.data.figure.edition+"."+i.data.figure.name+"."+n.name+".hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom"),t.R7$(),t.Y8G("ngClass",t.eq3(7,om,i.specialTags.includes(n.name))),t.R7$(),t.Y8G("ghs-label","data.character."+i.data.figure.edition+"."+i.data.figure.name+"."+n.name)}}function Pp(a,r){if(1&a&&t.nVh(0,Op,4,9,"div",99),2&a){const n=r.$implicit,i=t.XpG(2);t.vxM((!n.level||n.level<=i.data.figure.level)&&(!n.perk||i.gameManager.isCharacter(i.data.entity)&&i.gameManager.toCharacter(i.data.figure).progress.perks[n.perk-1]==i.gameManager.toCharacter(i.data.figure).perks[n.perk-1].count)&&(i.gameManager.isCharacter(i.data.entity)&&!n.summon||i.gameManager.isSummon(i.data.entity)&&n.summon)?0:-1)}}function bp(a,r){if(1&a&&(t.j41(0,"div",10),t.Z7z(1,Pp,1,1,null,null,xa),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(t.bMT(3,0,n.gameManager.toCharacter(n.data.figure).specialActions))}}function kp(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",73),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeMaxHealth(-1))}),t.nrm(1,"img",36),t.k0s(),t.j41(2,"span",34),t.nrm(3,"img",38),t.j41(4,"span",80),t.EFF(5),t.k0s()(),t.j41(6,"a",73),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeMaxHealth(1))}),t.nrm(7,"img",41),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(5),t.Lme("",n.EntityValueFunction(n.gameManager.toObjectiveContainer(n.data.figure).health)+n.maxHp<n.EntityValueFunction(n.gameManager.toObjectiveContainer(n.data.figure).health)||n.data.entity.health==n.EntityValueFunction(n.gameManager.toObjectiveContainer(n.data.figure).health)?n.EntityValueFunction(n.gameManager.toObjectiveContainer(n.data.figure).health)+n.maxHp:n.data.entity.health,"/",n.EntityValueFunction(n.gameManager.toObjectiveContainer(n.data.figure).health)+n.maxHp)}}function yp(a,r){1&a&&t.EFF(0," m ")}function xp(a,r){1&a&&t.EFF(0," A ")}function Ep(a,r){if(1&a&&t.nrm(0,"img",24),2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.Y8G("src",i.gameManager.characterManager.characterIcon(n),t.B4B)}}function wp(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",107),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.toggleAMDeck(e))}),t.nVh(1,yp,1,0),t.nVh(2,xp,1,0),t.nVh(3,Ep,1,1,"img",24),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.eq3(4,ya,i.gameManager.toObjectiveContainer(i.data.figure).amDeck==n)),t.R7$(),t.vxM("M"==n?1:-1),t.R7$(),t.vxM("A"==n?2:-1),t.R7$(),t.vxM("M"!=n&&"A"!=n?3:-1)}}function Rp(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",108),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.toggleAMDeck(e.gameManager.toObjectiveContainer(e.data.figure).amDeck||""))}),t.nrm(1,"img",24),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("src",n.gameManager.characterManager.characterIcon(n.gameManager.toObjectiveContainer(n.data.figure).amDeck||""),t.B4B)}}function jp(a,r){if(1&a&&(t.j41(0,"div",102),t.nrm(1,"input",103,0),t.nVh(3,kp,8,2),t.k0s(),t.j41(4,"div",104),t.Z7z(5,wp,4,6,"span",105,t.fX1),t.nVh(7,Rp,2,1,"span",106),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("value",n.gameManager.toObjectiveContainer(n.data.figure).title||""),t.R7$(2),t.vxM(n.showMaxHealth()&&n.data.entity&&n.gameManager.isObjectiveEntity(n.data.entity)?3:-1),t.R7$(2),t.Dyx(n.amDecks),t.R7$(2),t.vxM(n.gameManager.toObjectiveContainer(n.data.figure).amDeck&&-1==n.amDecks.indexOf(n.gameManager.toObjectiveContainer(n.data.figure).amDeck||"")?7:-1)}}function Gp(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",34)(1,"a",112),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.setLevel(e+1))}),t.EFF(2),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(2,ya,n+1==i.data.entity.level)),t.R7$(),t.JRh(n+1)}}function Tp(a,r){if(1&a&&t.nrm(0,"img",24)(1,"input",113,1),2&a){const n=t.XpG(3);t.Y8G("src",n.gameManager.characterManager.characterIcon(n.gameManager.toCharacter(n.data.entity).name),t.B4B),t.R7$(),t.Y8G("value",n.gameManager.toCharacter(n.data.entity).title)}}function Sp(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",114),t.nrm(1,"img",24),t.j41(2,"input",115),t.bIt("change",function(e){const o=c.eBV(n).$implicit,g=t.XpG(4);return c.Njj(g.setTitle(e,o))}),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG(4);t.R7$(),t.Y8G("src",i.gameManager.characterManager.characterIdentityIcon(i.gameManager.toCharacter(i.data.entity).name,i.gameManager.toCharacter(i.data.entity).identity),t.B4B),t.R7$(),t.Y8G("value",i.titles[n])}}function Dp(a,r){if(1&a&&(t.j41(0,"div",111),t.Z7z(1,Sp,3,2,"div",114,t.fX1),t.nI1(3,"ghsRange"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.i5U(3,0,t.lJ4(3,ki),n.gameManager.toCharacter(n.data.entity).identities.length))}}function $p(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",109)(1,"span",34),t.nrm(2,"img",76),t.k0s(),t.Z7z(3,Gp,3,4,"span",34,t.fX1),t.nI1(5,"ghsRange"),t.k0s(),t.j41(6,"div",110),t.nVh(7,Tp,3,2),t.nVh(8,Dp,4,4,"div",111),t.j41(9,"a",73),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeMaxHealth(-1))}),t.nrm(10,"img",36),t.k0s(),t.j41(11,"span",30),t.nrm(12,"img",38),t.j41(13,"span",80),t.EFF(14),t.k0s()(),t.j41(15,"a",73),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeMaxHealth(1))}),t.nrm(16,"img",41),t.k0s()()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(10,sm,n.bb)),t.R7$(3),t.Dyx(t.i5U(5,7,t.lJ4(12,ki),n.bb?5:9)),t.R7$(4),t.vxM(0!=n.titles.length&&n.settingsManager.settings.characterIdentities?-1:7),t.R7$(),t.vxM(n.titles.length>0&&n.settingsManager.settings.characterIdentities?8:-1),t.R7$(3),t.Y8G("ghs-label","game.maxHealth")("ghs-label-attribute","title"),t.R7$(3),t.Lme("",n.EntityValueFunction(n.data.entity.maxHealth)+n.maxHp<n.EntityValueFunction(n.data.entity.maxHealth)||n.data.entity.health==n.EntityValueFunction(n.data.entity.maxHealth)?n.EntityValueFunction(n.data.entity.maxHealth)+n.maxHp:n.data.entity.health,"/",n.EntityValueFunction(n.data.entity.maxHealth)+n.maxHp)}}function Ip(a,r){if(1&a&&t.nrm(0,"span",119),2&a){const n=t.XpG(3);t.Y8G("value-calc",+n.gameManager.toSummon(n.data.entity).attack+n.attack)("empty",!0)}}function Ap(a,r){1&a&&(t.j41(0,"span",120),t.EFF(1,"X"),t.k0s())}function Vp(a,r){if(1&a){const n=t.RV6();t.nrm(0,"input",116,2),t.j41(2,"div",117)(3,"a",118),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeMaxHealth(-1))}),t.nrm(4,"img",36),t.k0s(),t.j41(5,"span",34),t.nrm(6,"img",38),t.j41(7,"span",80),t.EFF(8),t.k0s()(),t.j41(9,"a",73),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeMaxHealth(1))}),t.nrm(10,"img",41),t.k0s(),t.j41(11,"a",118),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeMovement(-1))}),t.nrm(12,"img",36),t.k0s(),t.j41(13,"span",34),t.nrm(14,"img",65),t.j41(15,"span",119),t.EFF(16,">"),t.k0s()(),t.j41(17,"a",73),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeMovement(1))}),t.nrm(18,"img",41),t.k0s(),t.j41(19,"a",118),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeAttack(-1))}),t.nrm(20,"img",36),t.k0s(),t.j41(21,"span",34),t.nrm(22,"img",67),t.nVh(23,Ip,1,2,"span",119),t.nVh(24,Ap,2,0,"span",120),t.k0s(),t.j41(25,"a",118),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeAttack(1))}),t.nrm(26,"img",41),t.k0s(),t.j41(27,"a",118),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeRange(-1))}),t.nrm(28,"img",36),t.k0s(),t.j41(29,"span",34),t.nrm(30,"img",68),t.j41(31,"span",119),t.EFF(32,">"),t.k0s()(),t.j41(33,"a",73),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeRange(1))}),t.nrm(34,"img",41),t.k0s()()}if(2&a){const n=t.XpG(2);t.R7$(3),t.Y8G("ngClass",t.eq3(13,Xt,n.EntityValueFunction(n.data.entity.maxHealth)+n.maxHp==0)),t.R7$(5),t.Lme("",n.EntityValueFunction(n.data.entity.maxHealth)+n.maxHp<n.EntityValueFunction(n.data.entity.maxHealth)||n.data.entity.health==n.EntityValueFunction(n.data.entity.maxHealth)?n.EntityValueFunction(n.data.entity.maxHealth)+n.maxHp:n.data.entity.health,"/",n.EntityValueFunction(n.data.entity.maxHealth)+n.maxHp),t.R7$(3),t.Y8G("ngClass",t.eq3(15,Xt,n.gameManager.toSummon(n.data.entity).movement+n.movement==0)),t.R7$(4),t.Y8G("value-calc",n.gameManager.toSummon(n.data.entity).movement+n.movement)("empty",!0),t.R7$(4),t.Y8G("ngClass",t.eq3(17,Xt,"X"==n.gameManager.toSummon(n.data.entity).attack||+n.gameManager.toSummon(n.data.entity).attack+n.attack==0)),t.R7$(4),t.vxM("X"!=n.gameManager.toSummon(n.data.entity).attack?23:-1),t.R7$(),t.vxM("X"==n.gameManager.toSummon(n.data.entity).attack?24:-1),t.R7$(),t.Y8G("ngClass",t.eq3(19,Xt,"X"==n.gameManager.toSummon(n.data.entity).attack)),t.R7$(2),t.Y8G("ngClass",t.eq3(21,Xt,n.gameManager.toSummon(n.data.entity).range+n.range==0)),t.R7$(4),t.Y8G("value-calc",n.gameManager.toSummon(n.data.entity).range+n.range)("empty",!0)}}function Fp(a,r){if(1&a&&(t.j41(0,"div",11),t.nVh(1,$p,17,13),t.nVh(2,Vp,35,23),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.vxM(n.data.entity&&n.gameManager.isCharacter(n.data.entity)?1:-1),t.R7$(),t.vxM(n.data.entity&&n.gameManager.isSummon(n.data.entity)?2:-1)}}let ze=(()=>{class a{data;changeDetectorRef;dialogRef;dialog;overlay;ghsManager;gameManager=s.E;settingsManager=p.f;characterTitleInput;objectiveTitleInput;summonTitleInput;conditionType="";levelDialog=!1;health=0;experience=0;loot=0;maxHp=0;attack=0;movement=0;range=0;bless=0;curse=0;empower=0;enfeeble=0;marker=0;id=0;characterToken=0;characterTokenValues=[];objectiveDead=!1;entityConditions=[];entityImmunities=[];actionHints=[];specialTags=[];entityShield=new $.rc($.X2.shield,0);entityShieldPersistent=new $.rc($.X2.shield,0);entityRetaliate=[new $.rc($.X2.retaliate,0)];entityRetaliatePersistent=[new $.rc($.X2.retaliate,0)];entityRetaliateRange=[new $.rc($.X2.range,1,$.iQ.fixed,[],!0)];entityRetaliateRangePersistent=[new $.rc($.X2.range,1,$.iQ.fixed,[],!0)];titles=[];empowerChar;empowerChars=[];enfeebleChar;enfeebleChars=[];bb=!1;amDecks=[];AttackModifierType=w.Yn;SummonState=_t.N5;SummonColor=_t.rX;ConditionName=Q.r5;ConditionType=Q.GV;MonsterType=S.N;OBJECTIV_MARKERS=ft.ZM;EntityValueFunction=A.hZ;ghsModulo=F.L$;Math=Math;catching=!1;catchingDisabled=!0;objectiveData;constructor(n,i,e,o,g,m){if(this.data=n,this.changeDetectorRef=i,this.dialogRef=e,this.dialog=o,this.overlay=g,this.ghsManager=m,n.entity instanceof H.K){this.conditionType="character";for(let k=0;k<n.entity.tokens.length;k++)this.characterTokenValues[k]=0;if(n.entity.identities&&n.entity.identities.length>1&&p.f.settings.characterIdentities){if(this.titles=n.entity.title.split("|"),this.titles.length<n.entity.identities.length)for(let k=this.titles.length;k<n.entity.identities.length;k++)this.titles.push("");for(let k=0;k<this.titles.length;k++)this.titles[k]||(this.titles[k]=p.f.getLabel("data.character."+n.entity.edition+"."+n.entity.name.toLowerCase()))}}else n.figure instanceof ft.$e?this.conditionType=n.figure.escort?"character":"objective":n.entity instanceof Dt.I?this.conditionType="monster":n.entity instanceof _t.up&&(this.conditionType="monster",n.entity.init&&(this.levelDialog=!0));this.data.entity&&(this.entityConditions=JSON.parse(JSON.stringify(this.data.entity.entityConditions)),this.entityImmunities=JSON.parse(JSON.stringify(this.data.entity.immunities))),this.data.figure instanceof b.R&&this.data.entity instanceof Dt.I&&(this.actionHints=s.E.actionsManager.calcActionHints(this.data.figure,this.data.entity).map(k=>new $.rc(k.type,k.value,$.iQ.fixed,k.range?[new $.rc($.X2.range,k.range,$.iQ.fixed,[],!0)]:[]))),this.data.figure instanceof H.K&&this.data.figure.specialActions&&this.data.figure.specialActions.forEach(k=>{(this.data.entity instanceof H.K&&!k.summon&&this.data.entity.tags.includes(k.name)||this.data.entity instanceof _t.up&&k.summon&&this.data.entity.tags.includes(k.name))&&this.specialTags.push(k.name)}),n.figure instanceof ft.$e&&n.figure.objectiveId&&(this.objectiveData=s.E.objectiveManager.objectiveDataByObjectiveIdentifier(n.figure.objectiveId)),this.data.entity&&(this.data.entity.shield&&(this.entityShield.value=this.data.entity.shield.value),this.data.entity.shieldPersistent&&(this.entityShieldPersistent.value=this.data.entity.shieldPersistent.value),this.data.entity.retaliate.forEach((k,X)=>{this.entityRetaliate[X]?this.entityRetaliate[X].value=k.value:this.entityRetaliate[X]=new $.rc($.X2.retaliate,k.value),this.entityRetaliateRange[X]||(this.entityRetaliateRange[X]=new $.rc($.X2.range,1),this.entityRetaliateRange[X].small=!0);const at=k.subActions.find(tt=>tt.type==$.X2.range);at&&(this.entityRetaliateRange[X].value=at.value)}),this.data.entity.retaliatePersistent.forEach((k,X)=>{this.entityRetaliatePersistent[X]?this.entityRetaliatePersistent[X].value=k.value:this.entityRetaliatePersistent[X]=new $.rc($.X2.retaliate,k.value),this.entityRetaliateRangePersistent[X]||(this.entityRetaliateRangePersistent[X]=new $.rc($.X2.range,1),this.entityRetaliateRangePersistent[X].small=!0);const at=k.subActions.find(tt=>tt.type==$.X2.range);at&&(this.entityRetaliateRangePersistent[X].value=at.value)}),s.E.buildingsManager.petsEnabled&&this.data.figure instanceof b.R&&this.data.figure.pet&&(this.catching=!0,this.catchingDisabled=null==s.E.game.figures.find(k=>k instanceof H.K&&k.progress.equippedItems.find(X=>!("fh"!=X.edition||"247"!=X.name||X.tags&&X.tags.includes(wt.Tr.consumed)))))),this.dialogRef.closed.subscribe({next:k=>{k||this.close()}}),this.empowerChars=s.E.game.figures.filter(k=>k instanceof H.K&&s.E.entityManager.isAlive(k)&&k.additionalModifier&&k.additionalModifier.find(X=>X.attackModifier&&X.attackModifier.type==w.Yn.empower)).map(k=>k),this.empowerChars.forEach(k=>{k.active&&(this.empowerChar=k)}),!this.empowerChar&&1==this.empowerChars.length&&(this.empowerChar=this.empowerChars[0]),this.enfeebleChars=s.E.game.figures.filter(k=>k instanceof H.K&&s.E.entityManager.isAlive(k)&&!k.absent&&k.additionalModifier&&k.additionalModifier.find(X=>X.attackModifier&&X.attackModifier.type==w.Yn.enfeeble)).map(k=>k),this.enfeebleChars.forEach(k=>{k.active&&(this.enfeebleChar=k)}),!this.enfeebleChar&&1==this.enfeebleChars.length&&(this.enfeebleChar=this.enfeebleChars[0]),this.bb=this.data.entity instanceof H.K&&this.data.entity.bb||this.data.figure instanceof b.R&&this.data.figure.bb,this.amDecks=["M"],p.f.settings.allyAttackModifierDeck&&(p.f.settings.alwaysAllyAttackModifierDeck||s.E.fhRules(!0))&&this.amDecks.push("A"),this.amDecks.push(...s.E.game.figures.filter(k=>k instanceof H.K&&!k.absent).map(k=>k.name)),this.data.figure instanceof ft.$e&&this.data.figure.amDeck&&!this.amDecks.includes(this.data.figure.amDeck)&&(this.data.figure.amDeck="M")}keyboardShortcuts(n){p.f.settings.keyboardShortcuts&&!this.levelDialog&&!n.altKey&&!n.metaKey&&(!window.document.activeElement||"INPUT"!=window.document.activeElement.tagName&&"SELECT"!=window.document.activeElement.tagName&&"TEXTAREA"!=window.document.activeElement.tagName)&&((!(this.data.entity instanceof H.K)||!this.data.entity.absent)&&(n.ctrlKey||n.shiftKey||"ArrowRight"!==n.key?n.ctrlKey||n.shiftKey||"ArrowLeft"!==n.key?n.ctrlKey||n.shiftKey||"ArrowUp"!==n.key?n.ctrlKey||n.shiftKey||"ArrowDown"!==n.key?n.ctrlKey||"x"!==n.key.toLowerCase()?n.ctrlKey||"l"!==n.key.toLowerCase()?n.ctrlKey||"b"!==n.key.toLowerCase()?n.ctrlKey||"c"!==n.key.toLowerCase()?n.ctrlKey||n.shiftKey||"k"!==n.key.toLowerCase()&&"d"!==n.key.toLowerCase()?!n.ctrlKey&&!n.shiftKey&&"s"===n.key.toLowerCase()&&this.data.entity instanceof H.K&&((0,F.co)(this.dialogRef),this.dialog.open(An,{panelClass:["dialog-invert"],data:{character:this.data.entity}}),n.preventDefault(),n.stopPropagation()):(this.data.entity instanceof H.K?this.toggleExhausted():this.toggleDead(),n.preventDefault(),n.stopPropagation()):(this.changeCurse(n.shiftKey?-1:1),n.preventDefault(),n.stopPropagation()):(this.changeBless(n.shiftKey?-1:1),n.preventDefault(),n.stopPropagation()):(this.changeLoot(n.shiftKey?-1:1),n.preventDefault(),n.stopPropagation()):(this.changeExperience(n.shiftKey?-1:1),n.preventDefault(),n.stopPropagation()):(this.changeMaxHealth(-1),n.preventDefault(),n.stopPropagation()):(this.changeMaxHealth(1),n.preventDefault(),n.stopPropagation()):(this.changeHealth(-1),n.preventDefault(),n.stopPropagation()):(this.changeHealth(1),n.preventDefault(),n.stopPropagation())),p.f.settings.keyboardShortcuts&&!n.ctrlKey&&!n.shiftKey&&"a"===n.key.toLowerCase()&&this.data.entity instanceof H.K&&(this.toggleCharacterAbsent(),n.preventDefault(),n.stopPropagation()))}changeHealth(n){if(this.health+=n,this.data.entity){let i=(0,A.hZ)(this.data.entity.maxHealth);this.data.entity instanceof H.K&&"lightning"==this.data.entity.name&&this.specialTags.includes("unbridled-power")&&(i=Math.max(i,26)),this.maxHp&&this.data.entity.health+this.health>i+this.maxHp&&(this.health=i+this.maxHp-this.data.entity.health)}}changeExperience(n){this.data.entity instanceof H.K&&(this.experience+=n,this.data.entity.experience+this.experience<=0&&(this.experience=-this.data.entity.experience))}changeCharacterToken(n,i=-1){this.data.entity instanceof H.K&&(i<0?(this.characterToken+=n,this.data.entity.token+this.characterToken<=0&&(this.characterToken=-this.data.entity.token)):(this.characterTokenValues[i]+=n,this.data.entity.tokenValues[i]+this.characterTokenValues[i]<=0&&(this.characterTokenValues[i]=-this.data.entity.tokenValues[i])))}changeLoot(n){this.data.entity instanceof H.K&&(this.loot+=n,this.data.entity.loot+this.loot<=0&&(this.loot=-this.data.entity.loot))}attackModifierDeck(){return s.E.attackModifierManager.byFigure(this.data.figure)}beforeAttackModifierDeck(n){s.E.stateManager.before("updateAttackModifierDeck."+n.type,this.data.figure instanceof H.K?s.E.characterManager.characterName(this.data.figure):this.data.figure instanceof b.R&&(this.data.figure.isAlly||this.data.figure.isAllied)?"ally":"monster",...n.values)}afterAttackModifierDeck(n){this.attackModifierDeck().merge(n.deck),s.E.stateManager.after()}countAttackModifier(n){return this.attackModifierDeck().cards.filter(i=>i.type==n).length}countUpcomingAttackModifier(n,i=void 0){return this.attackModifierDeck().cards.filter((e,o)=>e.type==n&&o>this.attackModifierDeck().current&&(!i||e.id&&e.id.startsWith(i))).length}countDrawnAttackModifier(n){return this.attackModifierDeck().cards.filter((i,e)=>i.type==n&&e<=this.attackModifierDeck().current).length}changeAttackModifier(n,i){if(i>0){if(n==w.Yn.bless&&s.E.attackModifierManager.countUpcomingBlesses()>=10)return;if(n==w.Yn.curse&&s.E.attackModifierManager.countUpcomingCurses(this.data.figure instanceof b.R&&!this.data.figure.isAlly&&!this.data.figure.isAllied)>=10)return;for(let e=0;e<i;e++)s.E.attackModifierManager.addModifier(this.attackModifierDeck(),new w.uU(n))}else if(i<0){let e=this.attackModifierDeck().cards.find((o,g)=>o.type==n&&g>this.attackModifierDeck().current);for(;e&&i<0;)this.attackModifierDeck().cards.splice(this.attackModifierDeck().cards.indexOf(e),1),e=this.attackModifierDeck().cards.find((o,g)=>o.type==n&&g>this.attackModifierDeck().current),i++}}changeBless(n){if(this.data.figure instanceof H.K||this.data.figure instanceof b.R||this.data.figure instanceof ft.$e&&this.data.figure.amDeck){this.bless+=n;const i=s.E.attackModifierManager.countUpcomingBlesses();this.bless+i>=10?this.bless=10-i:this.bless+i<0&&(this.bless=-i)}}changeCurse(n){if(this.data.figure instanceof H.K||this.data.figure instanceof b.R||this.data.figure instanceof ft.$e&&this.data.figure.amDeck){this.curse+=n;const i=s.E.attackModifierManager.countUpcomingCurses(this.data.figure instanceof b.R&&!this.data.figure.isAlly&&!this.data.figure.isAllied||this.data.figure instanceof ft.$e&&"M"==this.data.figure.amDeck);this.curse+i>=10?this.curse=10-i:this.curse+i<0&&(this.curse=-i)}}countEmpower(n=!1){return this.empowerChar?this.empowerChar.additionalModifier.filter(i=>i.attackModifier&&i.attackModifier.type==w.Yn.empower).map(i=>i.count).reduce((i,e)=>i+e)-(n?0:s.E.attackModifierManager.countUpcomingAdditional(this.empowerChar,w.Yn.empower)):-1}countEnfeeble(n=!1){return this.enfeebleChar?this.enfeebleChar.additionalModifier.filter(i=>i.attackModifier&&i.attackModifier.type==w.Yn.enfeeble).map(i=>i.count).reduce((i,e)=>i+e)-(n?0:s.E.attackModifierManager.countUpcomingAdditional(this.enfeebleChar,w.Yn.enfeeble)):-1}changeEmpower(n){if(this.empowerChar||n<0){this.empower+=n;const i=this.countUpcomingAttackModifier(w.Yn.empower),e=this.countEmpower();this.empower>=e?this.empower=e:this.empower+i<0&&(this.empower=-i)}else this.dialog.open(os,{panelClass:["dialog"],data:{characters:this.empowerChars,type:w.Yn.empower}}).closed.subscribe({next:e=>{"number"==typeof e&&-1!=e&&(this.empowerChar=this.empowerChars[e])}})}changeEnfeeble(n){if(this.enfeebleChar||n<0){this.enfeeble+=n;const i=this.countUpcomingAttackModifier(w.Yn.enfeeble),e=this.countEnfeeble();this.enfeeble>=e?this.enfeeble=e:this.enfeeble+i<0&&(this.enfeeble=-i)}else this.dialog.open(os,{panelClass:["dialog"],data:{characters:this.enfeebleChars,type:w.Yn.enfeeble}}).closed.subscribe({next:e=>{"number"==typeof e&&-1!=e&&(this.enfeebleChar=this.enfeebleChars[e])}})}hasCondition(n){return n==Q.r5.empower?this.empowerChars.length>0:n==Q.r5.enfeeble?this.enfeebleChars.length>0:null!=s.E.conditions(s.E.game.edition).find(i=>i.name==n)}toggleExhausted(){this.data.entity instanceof H.K&&(s.E.stateManager.before(this.data.entity.exhausted?"unsetExhausted":"setExhausted",s.E.characterManager.characterName(this.data.entity)),this.exhausted(),s.E.stateManager.after())}exhausted(){this.data.entity instanceof H.K&&(this.data.entity.exhausted=!this.data.entity.exhausted,this.data.entity.exhausted?(this.data.entity.off=!0,this.data.entity.active=!1):this.data.entity.off=!1)}changeMaxHealth(n){this.maxHp+=n,!(this.data.entity instanceof H.K)&&!(this.data.figure instanceof ft.$e)&&(this.health+=n),this.data.figure instanceof ft.$e?(0,A.hZ)(this.data.figure.health)+this.maxHp<=1&&(this.maxHp=1-(0,A.hZ)(this.data.figure.health)):this.data.entity&&(0,A.hZ)(this.data.entity.maxHealth)+this.maxHp<=1&&(this.maxHp=1-(0,A.hZ)(this.data.entity.maxHealth))}setLevel(n){this.data.entity instanceof H.K&&(s.E.stateManager.before("setLevel",s.E.characterManager.characterName(this.data.entity),""+n),s.E.characterManager.setLevel(this.data.entity,n),s.E.stateManager.after())}isImmune(n){return!!this.data.entity&&s.E.entityManager.isImmune(this.data.entity,this.data.figure,n)}markers(){return this.data.entity?[...s.E.markers(),...this.data.entity.markers].filter((n,i,e)=>i==e.indexOf(n)):[]}hasMarker(n){return!!this.data.entity&&s.E.entityManager.hasMarker(this.data.entity,n)}toggleCharacterAbsent(){this.data.entity instanceof H.K&&(this.data.entity.absent||s.E.characterManager.characterCount()>1)&&(s.E.stateManager.before(this.data.entity.absent?"unsetAbsent":"setAbsent",s.E.characterManager.characterName(this.data.entity)),this.data.entity.absent=!this.data.entity.absent,this.data.entity.absent&&this.data.entity.active&&s.E.roundManager.toggleFigure(this.data.entity),s.E.stateManager.after())}toggleCharacterMarker(){this.data.entity instanceof H.K&&(s.E.stateManager.before(this.data.entity.marker?"disableMarker":"enableMarker",s.E.characterManager.characterName(this.data.entity)),this.data.entity.marker=!this.data.entity.marker,s.E.stateManager.after())}toggleMarker(n){if(this.data.entity){const i=new H.K(s.E.getCharacterData(n),1),e=s.E.characterManager.characterName(i),o=i.name;s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,this.hasMarker(n)?"removeMarker":"addMarker"),e,o),s.E.entityManager.toggleMarker(this.data.entity,n),s.E.stateManager.after()}}toggleSummon(){if(this.data.entity instanceof Dt.I){let n=_t.N5.false;this.data.entity.summon==_t.N5.false?n=_t.N5.new:this.data.entity.summon==_t.N5.new&&(n=_t.N5.true),s.E.stateManager.before("setEntitySummonState","data.monster."+this.data.figure.name,"monster."+this.data.entity.type,""+this.data.entity.number,"summon.state."+n),this.data.entity.summon=n,s.E.stateManager.after()}}changeMonsterEntity(){this.data.figure instanceof b.R&&this.data.entity instanceof Dt.I&&(s.E.monsterManager.monsterStandeeMax(this.data.figure)>1||this.data.entity.type!=S.N.boss)&&(this.close(),this.dialog.open(ua,{panelClass:["dialog"],data:{monster:this.data.figure,entity:this.data.entity,change:!0},positionStrategy:this.overlay.position().flexibleConnectedTo(this.data.positionElement).withPositions((0,F.yE)())}),(0,F.co)(this.dialogRef))}toggleDead(){(this.data.entity instanceof Dt.I||this.data.entity instanceof _t.up||this.data.entity instanceof ln.X)&&this.dead()}dead(n=!1,i=!1){if(this.data.figure instanceof b.R&&this.data.entity instanceof Dt.I&&(!n||this.catching&&(!this.catchingDisabled||i))){if(s.E.stateManager.before(n?"buildings.stables.pets.catch":"entityDead","data.monster."+this.data.figure.name,"monster."+this.data.entity.type,""+this.data.entity.number),this.data.entity.dead=!0,this.data.figure.entities.every(e=>e.dead)&&this.data.figure.active&&s.E.roundManager.toggleFigure(this.data.figure),n&&null==s.E.game.party.pets.find(e=>this.data.figure instanceof b.R&&e.edition==this.data.figure.edition&&e.name==this.data.figure.pet)){s.E.game.party.pets.push(new as.j(this.data.figure.pet,this.data.figure.edition));const e=s.E.game.figures.find(o=>o instanceof H.K&&o.progress.equippedItems.find(g=>!("fh"!=g.edition||"247"!=g.name||g.tags&&g.tags.includes(wt.Tr.consumed))));if(e){const o=e.progress.equippedItems.find(g=>!("fh"!=g.edition||"247"!=g.name||g.tags&&g.tags.includes(wt.Tr.consumed)));o&&(o.tags=o.tags||[],o.tags.push(wt.Tr.consumed))}}setTimeout(()=>{this.data.figure instanceof b.R&&this.data.entity instanceof Dt.I&&(s.E.monsterManager.removeMonsterEntity(this.data.figure,this.data.entity),s.E.stateManager.after())},p.f.settings.animations?1500*p.f.settings.animationSpeed:0),(0,F.co)(this.dialogRef,!0)}else if(this.data.figure instanceof H.K&&this.data.entity instanceof _t.up)s.E.stateManager.before("summonDead",s.E.characterManager.characterName(this.data.figure),"data.summon."+this.data.entity.name),this.data.entity.dead=!0,setTimeout(()=>{this.data.figure instanceof H.K&&this.data.entity instanceof _t.up&&(s.E.characterManager.removeSummon(this.data.figure,this.data.entity),s.E.stateManager.after())},p.f.settings.animations?1500*p.f.settings.animationSpeed:0),(0,F.co)(this.dialogRef,!0);else if(this.data.figure instanceof ft.$e&&this.data.entity instanceof ln.X){let e=this.data.figure.name;e||(e=this.data.figure.title,e||(e=this.data.figure.escort?"%escort%":"%objective%")),s.E.stateManager.before("objectiveEntityDead",e,""+this.data.entity.number),this.data.entity.dead=!0,this.data.figure.entities.every(o=>o.dead)&&this.data.figure.active&&s.E.roundManager.toggleFigure(this.data.figure),setTimeout(()=>{this.data.figure instanceof ft.$e&&this.data.entity instanceof ln.X&&(s.E.objectiveManager.removeObjectiveEntity(this.data.figure,this.data.entity),s.E.stateManager.after())},p.f.settings.animations&&this.data.figure.entities.some(o=>s.E.entityManager.isAlive(o))?1500*p.f.settings.animationSpeed:0),(0,F.co)(this.dialogRef,!0)}}changeAttack(n){this.data.entity instanceof _t.up&&(this.attack+=n,"number"==typeof this.data.entity.attack&&this.data.entity.attack+this.attack<0&&(this.attack=-this.data.entity.attack))}changeMovement(n){this.data.entity instanceof _t.up&&(this.movement+=n,this.data.entity.movement+this.movement<=0&&(this.movement=-this.data.entity.movement))}changeRange(n){this.data.entity instanceof _t.up&&(this.range+=n,this.data.entity.range+this.range<=0&&(this.range=-this.data.entity.range))}toggleSummonStatus(){if(this.data.entity instanceof _t.up){let n=_t.N5.new;this.data.entity.state==_t.N5.new&&(n=_t.N5.true),s.E.stateManager.before("setSummonState",s.E.characterManager.characterName(this.data.figure),"data.summon."+this.data.entity.name,"summon.state."+n),this.data.entity.state=n,s.E.stateManager.after()}}changeId(n){if(this.data.figure instanceof ft.$e&&this.data.entity instanceof ln.X){this.id+=n;let i=this.data.entity.number+this.id;if(i<1?this.id=12-this.data.entity.number:i>12&&(this.id=1-this.data.entity.number),i=this.data.entity.number+this.id,this.data.figure.entities.length<12)for(;this.data.figure.entities.some(e=>e.number==i&&e!=this.data.entity);)this.id+=n,i=this.data.entity.number+this.id,i<1?this.id=12-this.data.entity.number:i>12&&(this.id=1-this.data.entity.number),i=this.data.entity.number+this.id}}changeMarker(n){this.data.figure instanceof ft.$e&&(this.marker=(0,F.L$)(this.marker+n,ft.ZM.length))}openLevelDialog(){if(this.levelDialog=!0,this.changeDetectorRef.detectChanges(),this.data.entity instanceof H.K&&(this.characterTitleInput&&(this.characterTitleInput.nativeElement.value=this.data.entity.title||p.f.getLabel("data.character."+this.data.entity.edition+"."+this.data.entity.name.toLowerCase())),this.titles=[],this.data.entity.identities&&this.data.entity.identities.length>1&&p.f.settings.characterIdentities)){if(this.titles=this.data.entity.title.split("|"),this.titles.length<this.data.entity.identities.length)for(let n=this.titles.length;n<this.data.entity.identities.length;n++)this.titles.push("");for(let n=0;n<this.titles.length;n++)this.titles[n]||(this.titles[n]=p.f.getLabel("data.character."+this.data.entity.edition+"."+this.data.entity.name.toLowerCase()))}this.data.entity instanceof _t.up&&(this.summonTitleInput.nativeElement.value=this.data.entity.title||p.f.getLabel("data.summon."+this.data.entity.name.toLowerCase()))}applySpecialAction(n){n.noTag||(this.specialTags.includes(n.name)?this.specialTags.splice(this.specialTags.indexOf(n.name),1):this.specialTags.push(n.name))}changeShield(n){this.entityShield.value=(0,A.hZ)(this.entityShield.value)+n,this.entityShield.value<0&&(this.entityShield.value=0),this.ghsManager.triggerUiChange()}changeShieldPersistent(n){this.entityShieldPersistent.value=(0,A.hZ)(this.entityShieldPersistent.value)+n,this.entityShieldPersistent.value<0&&(this.entityShieldPersistent.value=0),this.ghsManager.triggerUiChange()}changeRetaliate(n,i,e){this.entityRetaliate[n]||(this.entityRetaliate[n]=new $.rc($.X2.retaliate,0)),this.entityRetaliateRange[n]||(this.entityRetaliateRange[n]=new $.rc($.X2.range,1),this.entityRetaliateRange[n].small=!0),this.entityRetaliate[n].value=(0,A.hZ)(this.entityRetaliate[n].value)+i,this.entityRetaliateRange[n].value=(0,A.hZ)(this.entityRetaliateRange[n].value)+e,(0,A.hZ)(this.entityRetaliate[n].value)<=0&&this.entityRetaliate.length>1&&(this.entityRetaliate.splice(n,1),this.entityRetaliateRange.splice(n,1)),this.ghsManager.triggerUiChange()}changeRetaliatePersistent(n,i,e){this.entityRetaliatePersistent[n]||(this.entityRetaliatePersistent[n]=new $.rc($.X2.retaliate,0)),this.entityRetaliateRangePersistent[n]||(this.entityRetaliateRangePersistent[n]=new $.rc($.X2.range,1),this.entityRetaliateRangePersistent[n].small=!0),this.entityRetaliatePersistent[n].value=(0,A.hZ)(this.entityRetaliatePersistent[n].value)+i,this.entityRetaliateRangePersistent[n].value=(0,A.hZ)(this.entityRetaliateRangePersistent[n].value)+e,(0,A.hZ)(this.entityRetaliatePersistent[n].value)<=0&&this.entityRetaliatePersistent.length>1&&(this.entityRetaliatePersistent.splice(n,1),this.entityRetaliateRangePersistent.splice(n,1)),this.ghsManager.triggerUiChange()}setTitle(n,i){this.titles[i]=n.target.value}setIdentity(n){if(this.data.entity instanceof H.K&&n!=this.data.entity.identity){let i="blinkblade"==this.data.entity.name&&this.data.entity.tags.includes("time_tokens")&&0==this.data.entity.primaryToken;if((s.E.game.state==D.mk.next||s.E.game.state==D.mk.draw&&0==this.data.entity.identity&&0==this.data.entity.tokenValues[0])&&i)return;s.E.stateManager.before("setIdentity",s.E.characterManager.characterName(this.data.entity,!1,!1,!1),this.data.entity.name,this.data.entity.identities[n],this.data.entity.edition),this.data.entity.identity=n,s.E.stateManager.after()}}toggleAMDeck(n){this.data.figure instanceof ft.$e&&(this.data.figure.amDeck==n?(s.E.stateManager.before("unsetObjectiveAmDeck",this.data.figure.title||this.data.figure.name||this.data.figure.escort?"escort":"objective",n),this.data.figure.amDeck=void 0,s.E.stateManager.after()):this.amDecks.includes(n)&&(s.E.stateManager.before("setObjectiveAmDeck",this.data.figure.title||this.data.figure.name||this.data.figure.escort?"escort":"objective",n),this.data.figure.amDeck=n,s.E.stateManager.after()))}close(){this.data.entity instanceof H.K?this.closeCharacter():this.data.figure instanceof b.R?this.closeMonster():this.data.entity instanceof _t.up?this.closeSummon():this.data.entity instanceof ln.X?this.closeObjectiveEntity():this.data.figure instanceof ft.$e&&this.closeObjectiveContainer(),this.closeShieldRetaliate(),this.closeAMs(),this.closeConditions()}closeCharacter(){if(this.data.entity instanceof H.K){const n=this.data.entity;if(this.maxHp&&(s.E.stateManager.before("changeMaxHP",s.E.characterManager.characterName(n),(0,F.n1)(this.maxHp)),(n.maxHealth+this.maxHp<n.maxHealth||n.health==n.maxHealth)&&(n.health=n.maxHealth+this.maxHp),n.maxHealth+=this.maxHp,s.E.stateManager.after(),this.maxHp=0),0!=this.health&&(s.E.stateManager.before("changeHP",s.E.characterManager.characterName(n),(0,F.n1)(this.health)),s.E.entityManager.changeHealth(n,this.data.figure,this.health),this.health=0,s.E.stateManager.after()),0!=this.experience&&(s.E.stateManager.before("changeXP",s.E.characterManager.characterName(n),(0,F.n1)(this.experience)),n.experience+=this.experience,n.experience<0&&(n.experience=0),this.experience=0,s.E.stateManager.after()),0!=this.characterToken){let g=n.token+this.characterToken;g<0&&(g=0),s.E.stateManager.before("setCharacterToken",s.E.characterManager.characterName(n),g),n.token=g,this.characterToken=0,s.E.stateManager.after()}for(let g=0;g<n.tokens.length;g++)if(0!=this.characterTokenValues[g]){let m=n.tokenValues[g]+this.characterTokenValues[g];m<0&&(m=0),s.E.stateManager.before("setCharacterTokenValue",s.E.characterManager.characterName(n),"%data.characterToken."+this.data.figure.name+"."+n.tokens[g]+"%",m),n.tokenValues[g]=m,this.characterTokenValues[g]=0,s.E.stateManager.after()}0!=this.loot&&(s.E.stateManager.before("changeLoot",s.E.characterManager.characterName(n),(0,F.n1)(this.loot)),n.loot+=this.loot,n.loot<0&&(n.loot=0),this.loot=0,s.E.stateManager.after());const i=n.tags.filter(g=>this.data.figure instanceof H.K&&this.data.figure.specialActions&&null!=this.data.figure.specialActions.find(m=>m.name==g)&&!this.specialTags.includes(g));i.length&&(s.E.stateManager.before("removeSpecialTags",s.E.characterManager.characterName(n),i.map(g=>"%data.character."+this.data.figure.edition+"."+this.data.figure.name+"."+g+"%").join(",")),n.tags=n.tags.filter(g=>!i.includes(g)),"lightning"==n.name&&i.includes("careless-charge")&&(n.immunities=[],this.entityImmunities=n.immunities),"shackles"==n.name&&i.includes("delayed_malady")&&(n.immunities=[],n.tags=n.tags.filter(g=>"delayed_malady"!=g),this.entityImmunities=n.immunities),"fist"==n.name&&i.includes("one-with-the-mountain")&&(n.entityConditions=n.entityConditions.filter(g=>g.name!=Q.r5.regenerate||!g.permanent)),"demolitionist"==n.name&&i.includes("mech")&&(n.maxHealth-=5,s.E.entityManager.checkHealth(n,n)),"boneshaper"==n.name&&(i.includes("solid-bones")||i.includes("unholy-prowess"))&&n.summons.forEach(g=>{"shambling-skeleton"===g.name&&(g.maxHealth-=1,g.health>g.maxHealth?g.health=g.maxHealth:g.health-=1,s.E.entityManager.checkHealth(g,n),i.includes("solid-bones")&&(g.movement-=1,g.action=void 0))}),"astral"==n.name&&(i.includes("veil-of-protection")&&(n.health-=3,n.maxHealth-=3,n.summons.forEach(g=>{g.health-=3,g.maxHealth-=3})),i.includes("imbue-with-life")&&(n.entityConditions=n.entityConditions.filter(g=>g.name!=Q.r5.disarm||!g.permanent))),s.E.stateManager.after());const e=this.specialTags.filter(g=>n&&!n.tags.includes(g));if(e.length){if(s.E.stateManager.before("addSpecialTags",s.E.characterManager.characterName(n),e.map(g=>"%data.character."+this.data.figure.edition+"."+this.data.figure.name+"."+g+"%").join(",")),n.tags.push(...e),"lightning"==n.name&&e.includes("careless-charge")&&(n.immunities=s.E.conditionsForTypes("character","negative").map(g=>g.name),n.immunities.push(Q.r5.curse),this.hasCondition(Q.r5.enfeeble)&&n.immunities.push(Q.r5.enfeeble),this.entityImmunities=n.immunities),"shackles"==n.name&&e.includes("delayed_malady")&&(n.entityConditions.forEach(g=>{g.types.indexOf(Q.GV.negative)&&!g.expired&&g.state!=Q.mg.removed&&!this.entityConditions.find(m=>m.state==Q.mg.removed&&m.name==g.name)&&!n.immunities.includes(g.name)&&n.immunities.push(g.name)}),this.entityConditions.forEach(g=>{g.state==Q.mg.new&&n.immunities.push(g.name)}),this.entityImmunities=n.immunities,n.tags.push(...[1,2,3].map(()=>"delayed_malady"))),"fist"==n.name&&e.includes("one-with-the-mountain")){let g=n.entityConditions.find(m=>m.name==Q.r5.regenerate);g?g.permanent=!0:(g=new Q.BR(Q.r5.regenerate),g.permanent=!0,n.entityConditions.push(g))}if("demolitionist"==n.name&&e.includes("mech")&&(n.maxHealth+=5,n.health+=10,s.E.entityManager.addCondition(n,this.data.figure,new Q.kW(Q.r5.heal,10)),s.E.entityManager.applyCondition(n,this.data.figure,Q.r5.heal,!0)),"boneshaper"==n.name&&(e.includes("solid-bones")||e.includes("unholy-prowess"))&&n.summons.forEach(g=>{"shambling-skeleton"===g.name&&(g.maxHealth+=1,g.health==g.maxHealth-1?g.health=g.maxHealth:g.health+=1,s.E.entityManager.checkHealth(g,n),e.includes("solid-bones")&&(g.movement+=1,g.action=new $.rc($.X2.pierce,1)))}),"astral"==n.name&&(e.includes("veil-of-protection")&&(n.health+=3,n.maxHealth+=3,n.summons.forEach(g=>{g.health+=3,g.maxHealth+=3})),e.includes("imbue-with-life"))){let g=n.entityConditions.find(m=>m.name==Q.r5.disarm);g?(g.expired=!1,g.permanent=!0):(g=new Q.BR(Q.r5.disarm),g.permanent=!0,n.entityConditions.push(g))}s.E.stateManager.after()}let o=n.title;if(this.characterTitleInput&&(o=this.characterTitleInput.nativeElement.value),this.titles.length>0){for(let g=0;g<this.titles.length;g++)this.titles[g]==p.f.getLabel("data.character."+n.edition+"."+n.name.toLowerCase())&&(this.titles[g]="");for(o=this.titles.join("|");o.endsWith("|");)o=o.substring(0,o.length-1)}o!=p.f.getLabel("data.character."+n.edition+"."+n.name.toLowerCase())?n.title!=o&&(s.E.stateManager.before("setTitle",s.E.characterManager.characterName(n),o),n.title=o,s.E.stateManager.after()):""!=n.title&&(s.E.stateManager.before("unsetTitle",s.E.characterManager.characterName(n),n.title),n.title="",s.E.stateManager.after())}}closeMonster(){this.data.figure instanceof b.R&&this.data.entity instanceof Dt.I&&(this.maxHp&&(s.E.stateManager.before("changeEntityMaxHp","data.monster."+this.data.figure.name,"monster."+this.data.entity.type,""+this.data.entity.number,(0,F.n1)(this.maxHp)),this.data.entity.maxHealth+=this.maxHp,s.E.stateManager.after(),this.maxHp=0),0!=this.health&&(s.E.stateManager.before("changeEntityHp","data.monster."+this.data.figure.name,"monster."+this.data.entity.type,""+this.data.entity.number,(0,F.n1)(this.health)),s.E.entityManager.changeHealth(this.data.entity,this.data.figure,this.health),s.E.stateManager.after(),this.health=0),(this.data.entity.maxHealth>0&&this.data.entity.health<=0||this.data.entity.dead)&&(0==this.data.entity.entityConditions.length||this.data.entity.entityConditions.every(n=>!n.highlight&&!n.types.includes(Q.GV.turn)&&!n.types.includes(Q.GV.apply)))&&this.dead())}closeSummon(){if(this.data.figure instanceof H.K&&this.data.entity instanceof _t.up){const n=this.data.figure,i=this.data.entity;if(i.init)s.E.characterManager.removeSummon(n,i),s.E.stateManager.before("addSummon",s.E.characterManager.characterName(n),i.name),i.init=!1,0!=this.health&&s.E.entityManager.changeHealth(i,n,this.health),0!=this.attack&&"number"==typeof i.attack&&(i.attack+=this.attack),0!=this.movement&&(i.movement+=this.movement),0!=this.range&&(i.range+=this.range),this.maxHp&&((i.maxHealth+this.maxHp<i.maxHealth||i.health==i.maxHealth)&&(i.health=i.maxHealth+this.maxHp),i.maxHealth+=this.maxHp),s.E.characterManager.addSummon(n,i),s.E.stateManager.after();else{this.summonTitleInput&&(this.summonTitleInput.nativeElement.value&&this.summonTitleInput.nativeElement.value!=i.name?i.title!=this.summonTitleInput.nativeElement.value&&(s.E.stateManager.before("setTitle",i.name,this.summonTitleInput.nativeElement.value),i.title=this.summonTitleInput.nativeElement.value,s.E.stateManager.after()):""!=i.title&&(s.E.stateManager.before("unsetTitle","data.summon."+i.name,i.title),i.title="",s.E.stateManager.after())),this.maxHp&&(s.E.stateManager.before("changeSummonMaxHp",s.E.characterManager.characterName(n),i.title?i.title:"data.summon."+i.name,(0,F.n1)(this.maxHp)),i.maxHealth+=this.maxHp,s.E.stateManager.after()),0!=this.health&&(s.E.stateManager.before("changeSummonHp",s.E.characterManager.characterName(n),i.title?i.title:"data.summon."+i.name,(0,F.n1)(this.health)),s.E.entityManager.changeHealth(i,n,this.health),s.E.stateManager.after()),0!=this.attack&&"number"==typeof i.attack&&(s.E.stateManager.before("changeSummonAttack",s.E.characterManager.characterName(n),i.title?i.title:"data.summon."+i.name,(0,F.n1)(this.attack)),i.attack+=this.attack,s.E.stateManager.after()),0!=this.movement&&(s.E.stateManager.before("changeSummonMove",s.E.characterManager.characterName(n),i.title?i.title:"data.summon."+i.name,(0,F.n1)(this.movement)),i.movement+=this.movement,s.E.stateManager.after()),0!=this.range&&(s.E.stateManager.before("changeSummonRange",s.E.characterManager.characterName(n),i.title?i.title:"data.summon."+i.name,(0,F.n1)(this.range)),i.range+=this.range,s.E.stateManager.after());const e=i.tags.filter(g=>n instanceof H.K&&n.specialActions&&null!=n.specialActions.find(m=>m.name==g)&&!this.specialTags.includes(g));e.length&&(s.E.stateManager.before("removeSpecialTagsSummon",s.E.characterManager.characterName(n),e.map(g=>"%data.character."+n.edition+"."+n.name+"."+g+"%").join(","),i.title?i.title:"data.summon."+i.name),i.tags=i.tags.filter(g=>!e.includes(g)),s.E.stateManager.after());const o=this.specialTags.filter(g=>i&&!i.tags.includes(g));o.length&&(s.E.stateManager.before("addSpecialTagsSummon",s.E.characterManager.characterName(n),o.map(g=>"%data.character."+n.edition+"."+n.name+"."+g+"%").join(","),i.title?i.title:"data.summon."+i.name),n.tags.includes("autoapply_mode")&&o.includes("prism_mode")&&(s.E.entityManager.changeHealth(n,n,i.health-i.maxHealth),i.health=i.maxHealth,i.entityConditions.forEach(m=>{!m.expired&&m.state!=Q.mg.expire&&m.state!=Q.mg.removed&&!s.E.entityManager.isImmune(n,n,m.name)&&s.E.entityManager.addCondition(n,n,new Q.kW(m.name))}),i.entityConditions=[],n.summons.forEach(m=>m.tags=m.tags.filter(k=>"prism_mode"!=k))),i.tags.push(...o),s.E.stateManager.after())}(i.health<=0||i.dead)&&(0==i.entityConditions.length||i.entityConditions.every(e=>!e.highlight&&!e.types.includes(Q.GV.turn)&&!e.types.includes(Q.GV.apply)))&&this.dead()}}showMaxHealth(){return this.data.figure instanceof ft.$e&&!isNaN(+this.data.figure.health)&&(0,A.hZ)(this.data.figure.health)>0}closeObjectiveEntity(){if(this.data.figure instanceof ft.$e&&this.data.entity instanceof ln.X){if(this.maxHp){s.E.stateManager.before("changeObjectiveMaxHp",this.data.figure.title||this.data.figure.name||this.data.figure.escort?"escort":"objective",(0,F.n1)(this.maxHp));const e=(0,A.hZ)(this.data.figure.health)+this.maxHp;this.data.figure.health=e,this.data.figure.entities.forEach(o=>{(o.health==o.maxHealth||o.health>e)&&(o.health=e),o.maxHealth=e}),s.E.stateManager.after()}0!=this.health&&(s.E.stateManager.before("changeObjectiveEntityHP",this.data.figure.title||this.data.figure.name||this.data.figure.escort?"escort":"objective",this.data.entity.number,(0,F.n1)(this.health)),s.E.entityManager.changeHealth(this.data.entity,this.data.figure,this.health),(!this.objectiveData||!this.objectiveData.trackDamage)&&this.data.entity.health<=0&&s.E.objectiveManager.removeObjectiveEntity(this.data.figure,this.data.entity),s.E.stateManager.after(),this.health=0);const n=this.data.entity.number+this.id;n!=this.data.entity.number&&(s.E.stateManager.before("changeObjectiveEntityNumber",this.data.figure.title||this.data.figure.name||this.data.figure.escort?"escort":"objective",this.data.entity.number,""+n),this.data.entity.number=n,s.E.stateManager.after()),this.id=0,this.data.entity.marker||(this.data.entity.marker="");const i=ft.ZM[(0,F.L$)(this.marker+ft.ZM.indexOf(this.data.entity.marker),ft.ZM.length)];i!=this.data.entity.marker&&(i?s.E.stateManager.before("setObjectiveEntityMarker",this.data.figure.title||this.data.figure.name||this.data.figure.escort?"escort":"objective",this.data.entity.number,i):s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"removeEntityMarker"),this.data.entity.marker),this.data.entity.marker=i,s.E.stateManager.after()),this.marker=0,this.objectiveTitleInput&&(this.objectiveTitleInput.nativeElement.value&&this.objectiveTitleInput.nativeElement.value!=this.data.figure.name?this.data.figure.title!=this.objectiveTitleInput.nativeElement.value&&(s.E.stateManager.before("setTitle",this.data.figure.name,this.objectiveTitleInput.nativeElement.value),this.data.figure.title=this.objectiveTitleInput.nativeElement.value,s.E.stateManager.after()):""!=this.data.figure.title&&(s.E.stateManager.before("unsetTitle",this.data.figure.name||this.data.figure.escort?"escort":"objective",this.data.figure.title),this.data.figure.title="",s.E.stateManager.after()))}}closeObjectiveContainer(){if(this.data.figure instanceof ft.$e){this.data.figure.marker=this.data.figure.marker||"";const n=ft.ZM[(0,F.L$)(this.marker+ft.ZM.indexOf(this.data.figure.marker),ft.ZM.length)];n!=this.data.figure.marker&&(s.E.stateManager.before("changeObjectiveMarker",this.data.figure.title||this.data.figure.name||this.data.figure.escort?"escort":"objective",n),this.data.figure.marker=n,this.data.figure.entities.forEach(i=>i.marker=n),s.E.stateManager.after()),this.marker=0,this.objectiveTitleInput&&(this.objectiveTitleInput.nativeElement.value&&this.objectiveTitleInput.nativeElement.value!=this.data.figure.name?this.data.figure.title!=this.objectiveTitleInput.nativeElement.value&&(s.E.stateManager.before("setTitle",this.data.figure.name,this.objectiveTitleInput.nativeElement.value),this.data.figure.title=this.objectiveTitleInput.nativeElement.value,s.E.stateManager.after()):""!=this.data.figure.title&&(s.E.stateManager.before("unsetTitle",this.data.figure.name||this.data.figure.escort?"escort":"objective",this.data.figure.title),this.data.figure.title="",s.E.stateManager.after()))}}closeShieldRetaliate(){if(p.f.settings.characterShieldRetaliate&&(this.data.entity instanceof H.K||this.data.entity instanceof ln.X)||p.f.settings.standeeShieldRetaliate&&(this.data.entity instanceof _t.up||this.data.entity instanceof Dt.I)){this.entityShield.value?(!this.data.entity.shield||this.entityShield.value!=this.data.entity.shield.value)&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"setEntityShield"),this.entityShield.value),this.data.entity.shield=this.entityShield,s.E.stateManager.after()):this.data.entity.shield&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"removeEntityShield")),this.data.entity.shield=void 0,s.E.stateManager.after()),this.entityShieldPersistent.value?(!this.data.entity.shieldPersistent||this.entityShieldPersistent.value!=this.data.entity.shieldPersistent.value)&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"setEntityShieldPersistent"),this.entityShield.value),this.data.entity.shieldPersistent=this.entityShieldPersistent,s.E.stateManager.after()):this.data.entity.shieldPersistent&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"removeEntityShieldPersistent")),this.data.entity.shieldPersistent=void 0,s.E.stateManager.after());const n=this.entityRetaliate.filter(e=>e.value).map((e,o)=>{let g=new $.rc($.X2.retaliate,e.value);return g.subActions=e.subActions||[],this.entityRetaliateRange[o]&&1!=this.entityRetaliateRange[o].value&&g.subActions.unshift(this.entityRetaliateRange[o]),g});JSON.stringify(n)!=JSON.stringify(this.data.entity.retaliate)&&(n.length>0?s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"setEntityRetaliate"),n.map(e=>"%game.action.retaliate% "+(0,A.hZ)(e.value)+(e.subActions&&e.subActions[0]&&e.subActions[0].type==$.X2.range&&(0,A.hZ)(e.subActions[0].value)>1?" %game.action.range% "+(0,A.hZ)(e.subActions[0].value):"")).join(", ")):s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"removeEntityRetaliate")),this.data.entity.retaliate=n,s.E.stateManager.after());const i=this.entityRetaliatePersistent.filter(e=>e.value).map((e,o)=>{let g=new $.rc($.X2.retaliate,e.value);return g.subActions=[],this.entityRetaliateRangePersistent[o]&&1!=this.entityRetaliateRangePersistent[o].value&&g.subActions.push(this.entityRetaliateRangePersistent[o]),g});JSON.stringify(i)!=JSON.stringify(this.data.entity.retaliatePersistent)&&(i.length>0?s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"setEntityRetaliatePersistent"),i.map(e=>"%game.action.retaliate% "+(0,A.hZ)(e.value)+(e.subActions&&e.subActions[0]&&e.subActions[0].type==$.X2.range&&(0,A.hZ)(e.subActions[0].value)>1?" %game.action.range% "+(0,A.hZ)(e.subActions[0].value):"")).join(", ")):s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"removeEntityRetaliatePersistent")),this.data.entity.retaliatePersistent=i,s.E.stateManager.after())}}closeAMs(){if(0!=this.bless&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,this.bless<0?"removeCondition"+(this.bless<-1?"s":""):"addCondition"+(this.bless>1?"s":"")),w.Yn.bless,this.bless>0?this.bless:-1*this.bless),this.changeAttackModifier(w.Yn.bless,this.bless),s.E.stateManager.after(),this.bless=0),0!=this.curse&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,this.curse<0?"removeCondition"+(this.curse<-1?"s":""):"addCondition"+(this.curse>1?"s":"")),w.Yn.curse,this.curse>0?this.curse:-1*this.curse),this.changeAttackModifier(w.Yn.curse,this.curse),s.E.stateManager.after(),this.curse=0),0!=this.empower&&(this.empowerChar||this.empower<0)){if(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,this.empower<0?"removeCondition"+(this.empower<-1?"s":""):"addCondition"+(this.empower>1?"s":"")),w.Yn.empower,this.empower>0?this.empower:-1*this.empower),this.empowerChar&&this.empower>0){const n=s.E.attackModifierManager.getAdditional(this.empowerChar,w.Yn.empower);for(let i=0;i<Math.min(this.empower,n.length);i++)s.E.attackModifierManager.addModifier(this.attackModifierDeck(),n[i])}else for(let n=0;n<-1*this.empower;n++){const i=this.attackModifierDeck().cards.find((e,o)=>o>this.attackModifierDeck().current&&e.type==w.Yn.empower);i&&this.attackModifierDeck().cards.splice(this.attackModifierDeck().cards.indexOf(i),1)}s.E.stateManager.after(),this.empower=0}if(0!=this.enfeeble&&(this.enfeebleChar||this.enfeeble<0)){if(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,this.enfeeble<0?"removeCondition"+(this.enfeeble<-1?"s":""):"addCondition"+(this.enfeeble>1?"s":"")),w.Yn.enfeeble,this.enfeeble>0?this.enfeeble:-1*this.enfeeble),this.enfeebleChar&&this.enfeeble>0){const n=s.E.attackModifierManager.getAdditional(this.enfeebleChar,w.Yn.enfeeble);for(let i=0;i<Math.min(this.enfeeble,n.length);i++)s.E.attackModifierManager.addModifier(this.attackModifierDeck(),n[i])}else for(let n=0;n<-1*this.enfeeble;n++){const i=this.attackModifierDeck().cards.find((e,o)=>o>this.attackModifierDeck().current&&e.type==w.Yn.enfeeble);i&&this.attackModifierDeck().cards.splice(this.attackModifierDeck().cards.indexOf(i),1)}s.E.stateManager.after(),this.enfeeble=0}}closeConditions(){this.data.entity&&(this.entityConditions.filter(n=>n.state==Q.mg.new||n.state==Q.mg.removed).forEach(n=>{this.data.entity&&(n.state==Q.mg.new||s.E.entityManager.hasCondition(this.data.entity,n,n.permanent))&&(this.data.entity instanceof H.K&&n.name==Q.r5.muddle&&n.state==Q.mg.new&&this.data.entity.progress.equippedItems.find(i=>"gh"==i.edition&&"108"==i.name)&&(n.name=Q.r5.strengthen),n.expired=n.state==Q.mg.new,s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,n.state==Q.mg.removed?"removeCondition":"addCondition"),n.name,this.data.entity instanceof Dt.I?"monster."+this.data.entity.type+" ":""),n.state==Q.mg.removed?s.E.entityManager.removeCondition(this.data.entity,this.data.figure,n,n.permanent):(s.E.entityManager.addCondition(this.data.entity,this.data.figure,n,n.permanent),this.data.entity instanceof H.K&&"shackles"==this.data.entity.name&&!this.data.entity.absent&&this.data.entity.tags.includes("delayed_malady")&&n.types.includes(Q.GV.negative)&&!this.data.entity.immunities.includes(n.name)&&(this.data.entity.immunities.push(n.name),this.entityImmunities.push(n.name))),s.E.stateManager.after())}),this.entityConditions.forEach(n=>{if(this.data.entity){const i=this.data.entity.entityConditions.find(e=>e.name==n.name&&!e.expired);(n.types.includes(Q.GV.stack)||n.types.includes(Q.GV.upgrade))&&i&&i.value!=n.value&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"setConditionValue"),n.name,""+n.value,this.data.entity instanceof Dt.I?"monster."+this.data.entity.type+" ":""),i.value=n.value,s.E.stateManager.after())}}),this.data.entity.immunities.forEach(n=>{this.data.entity&&!this.entityImmunities.includes(n)&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"removeImmunity"),n),this.data.entity.immunities=this.data.entity.immunities.filter(i=>i!=n),s.E.stateManager.after())}),this.entityImmunities.forEach(n=>{this.data.entity&&!this.data.entity.immunities.includes(n)&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"addImmunity"),n),this.data.entity.immunities.push(n),s.E.stateManager.after())}))}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(x.gRc),t.rXU(O.ce),t.rXU(O.lG),t.rXU(qt.hJ),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-entity-menu-dialog"]],viewQuery:function(i,e){if(1&i&&(t.GBs(K_,5),t.GBs(W_,5),t.GBs(Z_,5)),2&i){let o;t.mGM(o=t.lsd())&&(e.characterTitleInput=o.first),t.mGM(o=t.lsd())&&(e.objectiveTitleInput=o.first),t.mGM(o=t.lsd())&&(e.summonTitleInput=o.first)}},hostBindings:function(i,e){1&i&&t.bIt("keydown",function(g){return e.keyboardShortcuts(g)},t.EBC)},standalone:!1,decls:13,vars:11,consts:[["objectiveTitle",""],["charactertitle",""],["summonTitle",""],[1,"entity-menu-dialog","scroll-container"],[3,"entity","show"],[1,"name"],["tabclick","",1,"name",3,"ngClass"],[1,"status-container"],[1,"character-special"],[1,"identities-container"],[1,"special-actions"],[1,"level-dialog"],[1,"spacer"],["tabclick","",1,"icon","character-icon",3,"click","src"],[1,"character-title",3,"ngClass"],["tabclick","",1,"absent",3,"click","src","ghs-label","ghs-label-attribute"],[1,"icon",3,"src"],[3,"ghs-label"],["tabclick","",1,"name",3,"click","ngClass"],[1,"standee",3,"src"],[1,"ally"],[1,"allied"],[1,"standee-number",3,"ngClass"],[1,"summon-icon",3,"ngClass"],[3,"src"],[1,"summon-number"],[1,"entity-container"],[1,"action-hint"],[1,"summon-stats-container"],[1,"item",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"item",3,"ghs-label","ghs-label-attribute"],[1,"marker-container"],[3,"entityConditions","immunities","entity","figure","type","empower","enfeeble"],[3,"action","highlight"],[1,"item"],["tabclick","",1,"button",3,"singleClick","repeat"],["src","./assets/images/minus.svg",1,"ghs-svg"],[1,"badge","badge-left"],["src","./assets/images/status/health.svg"],[1,"badge","badge-right","health-count",3,"value-sign","hideEmpty"],["tabclick","",1,"button",3,"singleClick","ngClass","repeat"],["src","./assets/images/plus.svg",1,"ghs-svg"],["src","./assets/images/status/experience.svg"],[1,"badge","badge-right",3,"value-sign","hideEmpty"],[1,"item","character-token",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/status/loot.svg"],[1,"badge","badge-left","bless-count"],[1,"condition",3,"ghs-tooltip","originX","overlayX","originY","overlayY","ngClass"],["src","./assets/images/status/bless.svg"],[1,"badge","badge-center","badge-warning"],[1,"badge","badge-left","curse-count"],["src","./assets/images/status/curse.svg"],["src","./assets/images/warning.svg"],[1,"badge","badge-left","empower-count"],["src","./assets/images/status/empower.svg"],[1,"badge","badge-character-icon"],[1,"badge","badge-left","enfeeble-count"],["src","./assets/images/status/enfeeble.svg"],["src","./assets/images/action/damage.svg",1,"damage"],[1,"badge","badge-right","health-count",3,"value-sign","hideEmpty","invert"],["src","./assets/images/left.svg",1,"ghs-svg"],[1,"objective-marker"],["src","./assets/images/right.svg",1,"ghs-svg"],[1,"map-marker",3,"ngClass"],["tabclick","",1,"stat",3,"click"],["src","./assets/images/action/move.svg",1,"ghs-svg"],[3,"value-calc","empty"],["src","./assets/images/action/attack.svg",1,"ghs-svg"],["src","./assets/images/action/range.svg",1,"ghs-svg"],[1,"action"],[3,"action"],["tabclick","",1,"exhausted",3,"click"],["src","./assets/images/status/exhausted.svg",1,"ghs-svg"],["tabclick","",1,"button",3,"click"],["src","./assets/images/status/dead.svg"],["tabclick","",1,"button","level-button",3,"click"],["src","./assets/images/status/level.svg"],["tabclick","",1,"summon",3,"click","ngClass"],[1,"item","max-health-container"],["src","./assets/images/status/health.svg",3,"ghs-label","ghs-label-attribute"],[1,"badge","badge-right","max-health"],["tabclick","",1,"button",3,"singleClick","doubleClick","ngClass"],["src","./assets/images/fh/catching.svg",1,"ghs-svg"],["tabclick","",1,"summon",3,"ngClass"],[1,"item",3,"click","ngClass"],[1,"condition","marker"],[1,"shield-overlay"],[1,"text-white",3,"ghs-label"],["tabclick","",1,"button",3,"singleClick","ngClass"],["tabclick","",1,"button",3,"singleClick"],[1,"separator"],[1,"item","column"],["tabclick","",1,"button","small",3,"singleClick","ngClass"],["tabclick","",1,"button","add-retaliate"],["tabclick","",1,"button","small",3,"singleClick"],["tabclick","",1,"button","add-retaliate",3,"singleClick"],["src","./assets/images/select-arrow.svg",1,"ghs-svg"],[1,"item",3,"ghs-tooltip","ngClass"],[1,"item",3,"click","ghs-tooltip","ngClass"],[1,"hint-container"],["src","./assets/images/hint.svg",1,"hint-trigger","ghs-svg",3,"ghs-tooltip","originX","overlayX","originY","overlayY"],["tabclick","",1,"special-action","text-white",3,"click","ngClass"],[1,"objective-container"],[1,"title",3,"value"],[1,"decks"],[1,"deck",3,"ngClass"],[1,"deck","active","warning"],[1,"deck",3,"click","ngClass"],[1,"deck","active","warning",3,"click"],[1,"level-container",3,"ngClass"],[1,"char-container"],[1,"titles-container"],["tabclick","",1,"level",3,"click","ngClass"],["type","text",1,"title",3,"value"],[1,"title-container"],["type","text",1,"title",3,"change","value"],[1,"title"],[1,"summon-container"],["tabclick","",1,"button",3,"click","ngClass"],[1,"badge","badge-right",3,"value-calc","empty"],[1,"badge","badge-right"]],template:function(i,e){1&i&&(t.j41(0,"div",3),t.nVh(1,rm,1,2,"ghs-entity-index-key",4),t.j41(2,"div",5),t.nVh(3,cm,6,8),t.nVh(4,_m,5,5),t.nVh(5,Cm,7,8,"div",6),t.nVh(6,wm,12,12),t.k0s(),t.nVh(7,fp,20,17,"div",7),t.nVh(8,Cp,1,0,"hr",8),t.nVh(9,vp,4,4,"div",9),t.nVh(10,bp,4,2,"div",10),t.nVh(11,jp,8,3),t.nVh(12,Fp,3,2,"div",11),t.k0s()),2&i&&(t.R7$(),t.vxM(e.data.entityIndexKey&&e.data.entity?1:-1),t.R7$(2),t.vxM(e.data.entity&&e.gameManager.isCharacter(e.data.figure)&&e.gameManager.isCharacter(e.data.entity)?3:-1),t.R7$(),t.vxM(e.gameManager.isObjectiveContainer(e.data.figure)?4:-1),t.R7$(),t.vxM(e.gameManager.isMonster(e.data.figure)?5:-1),t.R7$(),t.vxM(e.data.entity&&e.gameManager.isCharacter(e.data.figure)&&e.gameManager.isSummon(e.data.entity)?6:-1),t.R7$(),t.vxM(e.levelDialog||e.gameManager.isCharacter(e.data.figure)&&e.gameManager.toCharacter(e.data.figure).absent?-1:7),t.R7$(),t.vxM(e.data.entity&&e.gameManager.isCharacter(e.data.entity)&&(e.settingsManager.settings.characterIdentities&&e.gameManager.toCharacter(e.data.entity).identities&&e.gameManager.toCharacter(e.data.entity).identities.length>1||e.gameManager.toCharacter(e.data.figure).specialActions&&e.gameManager.toCharacter(e.data.figure).specialActions.length>0)?8:-1),t.R7$(),t.vxM(e.data.entity&&e.gameManager.isCharacter(e.data.entity)&&e.settingsManager.settings.characterIdentities&&e.gameManager.toCharacter(e.data.entity).identities&&e.gameManager.toCharacter(e.data.entity).identities.length>1?9:-1),t.R7$(),t.vxM(e.data.entity&&!e.levelDialog&&e.gameManager.isCharacter(e.data.figure)&&e.gameManager.toCharacter(e.data.figure).specialActions&&e.gameManager.toCharacter(e.data.figure).specialActions.length>0?10:-1),t.R7$(),t.vxM(e.gameManager.isObjectiveContainer(e.data.figure)?11:-1),t.R7$(),t.vxM(e.levelDialog?12:-1))},dependencies:[N.YU,en,Pa,ba,it,Mt,dt,Ft,nn,Ne,Ma,At,ct],styles:['.entity-menu-dialog[_ngcontent-%COMP%]{position:relative}.entity-menu-dialog[_ngcontent-%COMP%]   ghs-entity-index-key[_ngcontent-%COMP%]{position:absolute;top:0;left:0}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);min-width:calc(var(--ghs-unit) * 44 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));width:auto;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   img.standee[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top-left-radius:30%;border-top-right-radius:30%;height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));width:auto}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%]{cursor:pointer}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%]:hover{opacity:.4}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .character-title[_ngcontent-%COMP%]{display:flex;align-items:center}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .character-title.absent[_ngcontent-%COMP%]{text-decoration:line-through}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   img.absent[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));cursor:pointer;filter:var(--ghs-filter-white)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .change-entity[_ngcontent-%COMP%]{cursor:w-resize}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.normal[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.elite[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.boss[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.bb-1[_ngcontent-%COMP%]{color:var(--ghs-color-bb-1)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.bb-2[_ngcontent-%COMP%]{color:var(--ghs-color-bb-2)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.bb-3[_ngcontent-%COMP%]{color:var(--ghs-color-bb-3)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.bb-4[_ngcontent-%COMP%]{color:var(--ghs-color-bb-4)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.bb-5[_ngcontent-%COMP%]{color:var(--ghs-color-bb-5)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.bb-6[_ngcontent-%COMP%]{color:var(--ghs-color-bb-6)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.bb-7[_ngcontent-%COMP%]{color:var(--ghs-color-bb-7)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.bb-8[_ngcontent-%COMP%]{color:var(--ghs-color-bb-8)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.bb-9[_ngcontent-%COMP%]{color:var(--ghs-color-bb-9)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.bb-10[_ngcontent-%COMP%]{color:var(--ghs-color-bb-10)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .summon-icon[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .summon-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .summon-icon[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * -.1 * var(--ghs-dialog-factor));display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 2.25 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray);border-top-left-radius:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));border-bottom-left-radius:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));z-index:1;opacity:.9}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .summon-icon.fh[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-gh-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);border:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor)) solid var(--ghs-color-white);border-radius:100%}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{flex-basis:100%;flex-shrink:0;display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .status-container[_ngcontent-%COMP%]{display:flex;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .status-container[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor)));row-gap:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor));align-items:center;justify-items:center;margin-bottom:auto}.entity-menu-dialog[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.entity-menu-dialog[_ngcontent-%COMP%]   span.item[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   span.item.column[_ngcontent-%COMP%]{flex-direction:column;justify-content:space-around}.entity-menu-dialog[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.entity-menu-dialog[_ngcontent-%COMP%]   a.button[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.entity-menu-dialog[_ngcontent-%COMP%]   a.button[_ngcontent-%COMP%]:hover, .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.button[_ngcontent-%COMP%]:hover{opacity:.4}.entity-menu-dialog[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]:hover, .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.disabled[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.disabled[_ngcontent-%COMP%]:hover{pointer-events:none;color:var(--ghs-color-gray)!important;opacity:initial}.entity-menu-dialog[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.disabled[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}.entity-menu-dialog[_ngcontent-%COMP%]   a.disabled.soft[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]:hover.soft, .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.disabled.soft[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.disabled[_ngcontent-%COMP%]:hover.soft{cursor:initial;pointer-events:initial}.entity-menu-dialog[_ngcontent-%COMP%]   a.small[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.small[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   a.small[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.small[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));width:auto}.entity-menu-dialog[_ngcontent-%COMP%]   .add-retaliate[_ngcontent-%COMP%]{position:absolute;left:50%;bottom:0;transform:translate(-50%,60%)}.entity-menu-dialog[_ngcontent-%COMP%]   .character-token[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3.25 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:auto}.entity-menu-dialog[_ngcontent-%COMP%]   img.damage[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) brightness(.7) var(--ghs-filter-outline-thin-black)}.entity-menu-dialog[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .condition.disabled[_ngcontent-%COMP%]{color:var(--ghs-color-gray);filter:brightness(.5) grayscale(.2)}.entity-menu-dialog[_ngcontent-%COMP%]   .max-health-container[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:space-evenly;grid-column:2 span;width:calc(var(--ghs-unit) * 14 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .max-health-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:auto}.entity-menu-dialog[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{position:absolute;bottom:0;color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));text-shadow:var(--ghs-outline);text-align:center}.entity-menu-dialog[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:auto}.entity-menu-dialog[_ngcontent-%COMP%]   .badge.badge-left[_ngcontent-%COMP%]{left:0}.entity-menu-dialog[_ngcontent-%COMP%]   .badge.badge-right[_ngcontent-%COMP%]{right:0}.entity-menu-dialog[_ngcontent-%COMP%]   .badge.badge-center[_ngcontent-%COMP%]{bottom:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));left:50%;transform:translate(-50%)}.entity-menu-dialog[_ngcontent-%COMP%]   .badge.badge-warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red)}.entity-menu-dialog[_ngcontent-%COMP%]   .badge.badge-character-icon[_ngcontent-%COMP%]{bottom:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));right:40%}.entity-menu-dialog[_ngcontent-%COMP%]   .badge.badge-character-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   input.badge[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * -1.5 * var(--ghs-dialog-factor));min-width:0;border:none;width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));background:transparent}.entity-menu-dialog[_ngcontent-%COMP%]   .marker-container.marker-container[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .identities-container.marker-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor)));row-gap:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));align-items:center;justify-items:center;margin-bottom:auto;grid-column:1/span 3}.entity-menu-dialog[_ngcontent-%COMP%]   .marker-container.identities-container[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .identities-container.identities-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap}.entity-menu-dialog[_ngcontent-%COMP%]   .marker-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .identities-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .marker-container[_ngcontent-%COMP%]   .item.deactivated[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .identities-container[_ngcontent-%COMP%]   .item.deactivated[_ngcontent-%COMP%]{cursor:initial}.entity-menu-dialog[_ngcontent-%COMP%]   .marker-container[_ngcontent-%COMP%]   .item.active[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .marker-container[_ngcontent-%COMP%]   .item.new[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .identities-container[_ngcontent-%COMP%]   .item.active[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .identities-container[_ngcontent-%COMP%]   .item.new[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) / 4) var(--ghs-color-white) solid;border-radius:100%}.entity-menu-dialog[_ngcontent-%COMP%]   .marker-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover, .entity-menu-dialog[_ngcontent-%COMP%]   .identities-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.entity-menu-dialog[_ngcontent-%COMP%]   .marker-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover.deactivated, .entity-menu-dialog[_ngcontent-%COMP%]   .identities-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover.deactivated{border:none}.entity-menu-dialog[_ngcontent-%COMP%]   .marker-container[_ngcontent-%COMP%]   .item.disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .marker-container[_ngcontent-%COMP%]   .item.deactivated[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .identities-container[_ngcontent-%COMP%]   .item.disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .identities-container[_ngcontent-%COMP%]   .item.deactivated[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:grayscale(.7);opacity:.7}.entity-menu-dialog[_ngcontent-%COMP%]   .item.active[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) / 4) var(--ghs-color-white) solid;border-radius:100%}.entity-menu-dialog[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{grid-column:span 3;width:100%;border-top:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) solid var(--ghs-color-darkgray);margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .action-hint[_ngcontent-%COMP%]{grid-column:span 3;font-size:1.5em}.entity-menu-dialog[_ngcontent-%COMP%]   .shield-overlay[_ngcontent-%COMP%]{grid-column:span 3;font-size:1.7em;height:.5em}.entity-menu-dialog[_ngcontent-%COMP%]   .exhausted[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .condition.marker[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.entity-menu-dialog[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));filter:grayscale(70%)}.entity-menu-dialog[_ngcontent-%COMP%]   .summon.new[_ngcontent-%COMP%]:after, .entity-menu-dialog[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]:hover:after{content:" ";display:block;position:absolute;width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));background-image:url(minus.97c98a810771fceb.svg);background-size:cover}.entity-menu-dialog[_ngcontent-%COMP%]   .summon.active[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .summon.new[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) / 4) var(--ghs-color-white) solid;border-radius:100%;filter:none}.entity-menu-dialog[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%;filter:none}.entity-menu-dialog[_ngcontent-%COMP%]   .summon.new[_ngcontent-%COMP%]:hover:after, .entity-menu-dialog[_ngcontent-%COMP%]   .summon.active[_ngcontent-%COMP%]:hover:after{content:"";display:none}.entity-menu-dialog[_ngcontent-%COMP%]   .summon.active[_ngcontent-%COMP%]:hover{filter:grayscale(70%)}.entity-menu-dialog[_ngcontent-%COMP%]   .summon.fh.new[_ngcontent-%COMP%]:after, .entity-menu-dialog[_ngcontent-%COMP%]   .summon.fh[_ngcontent-%COMP%]:hover:after{right:calc(var(--ghs-unit) * -.3 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));background-image:url(minus.4a3eac90cfce6ac6.svg);z-index:2}.entity-menu-dialog[_ngcontent-%COMP%]   .summon.fh[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));background-color:var(--ghs-color-darkgray);z-index:1;opacity:.9;font-family:var(--ghs-font-gh-title);color:var(--ghs-color-white);border:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor)) solid var(--ghs-color-white);border-radius:100%}.entity-menu-dialog[_ngcontent-%COMP%]   .max-health-container[_ngcontent-%COMP%]{justify-content:space-evenly!important;width:calc(var(--ghs-unit) * 12 * var(--ghs-dialog-factor))!important}.entity-menu-dialog[_ngcontent-%COMP%]   .max-health-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));width:auto}.entity-menu-dialog[_ngcontent-%COMP%]   .max-health-container[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3.2 * var(--ghs-dialog-factor));filter:var(--ghs-filter-red)}.entity-menu-dialog[_ngcontent-%COMP%]   .summon-stats-container[_ngcontent-%COMP%]{grid-column:span 3;grid-row:span 2;display:flex;flex-direction:column;justify-content:center;align-items:center;margin-bottom:auto}.entity-menu-dialog[_ngcontent-%COMP%]   .summon-stats-container[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .summon-stats-container[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .map-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 4.7 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .map-marker.empty[_ngcontent-%COMP%]{filter:grayscale(.7)}.entity-menu-dialog[_ngcontent-%COMP%]   input.title[_ngcontent-%COMP%]{max-width:calc(var(--ghs-unit) * 20 * var(--ghs-dialog-factor));margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);border-radius:calc(var(--ghs-unit) * 1);user-select:auto;-webkit-user-select:auto;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center}.entity-menu-dialog[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   img.hint-trigger[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:auto;margin-top:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   .special-action[_ngcontent-%COMP%]{height:auto;margin-left:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]   .special-action[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));opacity:.8;filter:grayscale(.5)}.entity-menu-dialog[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]   .special-action[_ngcontent-%COMP%]:after{position:relative;content:" ";width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));transform:scale(0);transform-origin:bottom left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;clip-path:polygon(14% 44%,0 65%,50% 100%,100% 16%,80% 0%,43% 62%);color:var(--ghs-color-white);background-color:var(--ghs-color-white);margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]   .special-action.active-tag[_ngcontent-%COMP%]{opacity:1;filter:none}.entity-menu-dialog[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]   .special-action.active-tag[_ngcontent-%COMP%]:after{transform:scale(1)}.entity-menu-dialog[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:calc(var(--ghs-unit) * 1) 0}.entity-menu-dialog[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);display:flex;justify-content:center;z-index:2;width:calc(var(--ghs-unit) * 5);height:calc(var(--ghs-unit) * 5);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 3.5);line-height:calc(var(--ghs-unit) * 4.5);background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-character-icon.83c1ab396221d56b.png);margin:calc(var(--ghs-unit) * 1);cursor:pointer}.entity-menu-dialog[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * .8);filter:grayscale(100%) brightness(100) contrast(100%);height:70%;width:auto}.entity-menu-dialog[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]:hover{filter:brightness(.7)}.entity-menu-dialog[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .deck.active[_ngcontent-%COMP%]{filter:grayscale(.5) brightness(.5)}.entity-menu-dialog[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .deck.warning[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) * .4) solid var(--ghs-color-red);border-radius:100%;filter:brightness(.7)}.entity-menu-dialog[_ngcontent-%COMP%]   .objective-container[_ngcontent-%COMP%]{display:flex;align-items:center;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .objective-container[_ngcontent-%COMP%]   .max-health[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .level-button[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));display:flex;align-items:center}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor)));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .level-container.bb[_ngcontent-%COMP%]{grid-template-columns:repeat(3,calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor)))}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .level.active[_ngcontent-%COMP%]{pointer-events:none;border:calc(var(--ghs-unit) / 4) var(--ghs-color-white) solid;border-radius:100%}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .char-container[_ngcontent-%COMP%]{display:flex;align-items:center;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .char-container[_ngcontent-%COMP%]   .titles-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .char-container[_ngcontent-%COMP%]   .titles-container[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]{display:flex;align-items:center}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .char-container[_ngcontent-%COMP%]   .max-health[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor)))}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{left:50%;transform:translate(-50%,calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor)))}']})}return a})();var rt=v(1604);const Xp=(a,r,n)=>({inline:a,right:r,fh:n}),Bp=a=>({spacing:a}),Yp=(a,r)=>r._trackUUID;function Up(a,r){1&a&&t.nrm(0,"div",1)}function Np(a,r){if(1&a){const n=t.RV6();t.nVh(0,Up,1,0,"div",1),t.j41(1,"ghs-action",2),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG();t.vxM(e.divider[i]?0:-1),t.R7$(),t.Aen(e.style),t.Y8G("action",n)("monster",e.monster)("monsterType",e.monsterType)("objective",e.objective)("inline",e.inline)("right",e.right)("textBlack",e.textBlack)("hexSize",e.hexSize)("relative",e.relative)("statsCalculation",e.statsCalculation)("highlight",e.highlightActions.includes(n.type))("interactiveAbilities",e.interactiveAbilities)("interactiveActions",e.interactiveActions)("index",(e.actionIndex?e.actionIndex+"-":"")+i)("character",e.character)("cardId",e.cardId)("ngClass",t.eq3(20,Bp,!e.noDivider&&!e.inline&&i>0&&!e.divider[i]&&e.spacing[i]))}}let ve=(()=>{class a{ghsManager;monster;monsterType;objective;actions;relative=!1;inline=!1;textBlack=!1;right=!1;statsCalculation=!1;interactiveAbilities=!1;interactiveActions=[];interactiveActionsChange=new t.bkB;highlightActions=[];hexSize;actionIndex="";style=!1;noDivider=!1;character;cardId;divider=[];spacing=[];settingsManager=p.f;ActionType=$.X2;ActionValueType=$.iQ;additionalActions=[];additionActionTypes=[$.X2.shield,$.X2.retaliate,$.X2.heal,$.X2.element,$.X2.elementHalf];constructor(n){this.ghsManager=n}ngOnInit(){this.update(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){if(this.additionalActions=[],this.monster&&p.f.settings.calculateStats){const n=s.E.monsterManager.getStat(this.monster,this.monster.boss?S.N.boss:S.N.normal);let i=this.monster.boss||this.monster.bb?void 0:s.E.monsterManager.getStat(this.monster,S.N.elite);n.actions&&n.actions.filter(e=>this.additionActionTypes.includes(e.type)).forEach(e=>{!i||i.actions&&i.actions.some(o=>JSON.stringify(e)==JSON.stringify(o))?this.additionalActions.push(JSON.parse(JSON.stringify(e))):i&&(!i.actions||!i.actions.some(o=>JSON.stringify(e)==JSON.stringify(o)))&&this.additionalActions.push(new $.rc($.X2.monsterType,S.N.normal,$.iQ.fixed,[JSON.parse(JSON.stringify(e))]))}),i&&i.actions.filter(e=>this.additionActionTypes.includes(e.type)).forEach(e=>{(!n.actions||!n.actions.some(o=>JSON.stringify(e)==JSON.stringify(o)))&&this.additionalActions.push(new $.rc($.X2.monsterType,S.N.elite,$.iQ.fixed,[JSON.parse(JSON.stringify(e))]))})}!this.noDivider&&this.actions&&this.actions.forEach((n,i)=>{this.divider[i]=this.calcDivider(n,i),this.spacing[i]=this.calcSpacing(n,i)})}calcDivider(n,i){return!(i<1||this.inline||n.noDivider||(n.type==$.X2.element||n.type==$.X2.elementHalf)&&n.valueType!=$.iQ.minus||n.type==$.X2.card||n.type==$.X2.hint||n.type==$.X2.round||this.actions[i-1].type==$.X2.box||p.f.settings.calculate&&this.actions[i-1].type==$.X2.monsterType&&this.monster&&!this.monster.entities.find(e=>s.E.entityManager.isAlive(e)&&e.type==this.actions[i-1].value)||n.type==$.X2.concatenation&&n.subActions.every(e=>e.type==$.X2.card||e.type==$.X2.element||e.type==$.X2.elementHalf||e.type==$.X2.concatenationSpacer))}calcSpacing(n,i){return!(i<1||this.inline||this.actions[i-1].type==$.X2.box||this.actions[i-1].type==$.X2.round||n.type==$.X2.concatenation&&n.subActions.every(e=>[$.X2.card,$.X2.concatenationSpacer].includes(e.type)))}onInteractiveActionsChange(n){this.interactiveActionsChange.emit(n)}static \u0275fac=function(i){return new(i||a)(t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-actions"]],inputs:{monster:"monster",monsterType:"monsterType",objective:"objective",actions:"actions",relative:"relative",inline:"inline",textBlack:"textBlack",right:"right",statsCalculation:"statsCalculation",interactiveAbilities:"interactiveAbilities",interactiveActions:"interactiveActions",highlightActions:"highlightActions",hexSize:"hexSize",actionIndex:[0,"index","actionIndex"],style:"style",noDivider:"noDivider",character:"character",cardId:"cardId"},outputs:{interactiveActionsChange:"interactiveActionsChange"},standalone:!1,decls:4,vars:7,consts:[[1,"actions",3,"ngClass"],[1,"divider"],[3,"interactiveActionsChange","action","monster","monsterType","objective","inline","right","textBlack","hexSize","relative","statsCalculation","highlight","interactiveAbilities","interactiveActions","index","character","cardId","ngClass"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.Z7z(1,Np,2,22,null,null,Yp),t.nI1(3,"trackUUID"),t.k0s()),2&i&&(t.Y8G("ngClass",t.sMw(3,Xp,e.inline,e.right,e.settingsManager.settings.fhStyle)),t.R7$(),t.Dyx(t.bMT(3,1,e.actions)))},dependencies:[N.YU,en,ct],styles:[".actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;height:100%;position:relative}.actions.inline[_ngcontent-%COMP%]{align-items:flex-start}.actions.right[_ngcontent-%COMP%]{align-items:flex-end;text-align:right}.actions.right[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]{margin-left:auto}.actions[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]{position:relative;width:100%}.actions[_ngcontent-%COMP%]   ghs-action.spacing[_ngcontent-%COMP%]{margin-top:.7em}.actions[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{width:2em;border-top:.11em var(--ghs-color-white) dotted;margin:.1em}.actions[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:first-child{margin-top:auto}.actions[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:last-child{margin-bottom:auto}.actions.fh[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{width:3em;height:.06em;min-height:.06em;border-top:none;background:linear-gradient(90deg,transparent 0%,var(--ghs-color-white) 50%,transparent 100%);margin:.2em}"]})}return a})();const zp=(a,r,n,i,e)=>({flipped:a,random:r,fh:n,craft:i,bb:e}),cs=a=>({wide:a}),Oe=(a,r)=>({interactive:a,usable:r}),Ea=a=>({fh:a}),Lp=()=>[],qp=a=>[a],ls=(a,r)=>r._trackUUID;function Hp(a,r){if(1&a&&(t.j41(0,"span",23),t.EFF(1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.SpI("",n.edition,"\xa0")}}function Kp(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function Wp(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function Zp(a,r){if(1&a&&(t.j41(0,"div",3)(1,"span",25),t.nrm(2,"span",26),t.k0s(),t.j41(3,"div",22),t.nVh(4,Hp,2,1,"span",23),t.nVh(5,Kp,2,0,"span"),t.nVh(6,Wp,2,0,"span"),t.j41(7,"span"),t.EFF(8),t.k0s()()()),2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","game.cards.confirmReveal"),t.R7$(2),t.vxM(n.edition?4:-1),t.R7$(),t.vxM(n.idNumber&&+n.item.id<100?5:-1),t.R7$(),t.vxM(n.idNumber&&+n.item.id<10?6:-1),t.R7$(2),t.JRh(n.item.id)}}function Jp(a,r){if(1&a&&t.nrm(0,"img",6),2&a){const n=t.XpG(3);t.Y8G("src","./assets/artwork/items/"+n.item.edition+"-"+(n.idNumber&&+n.item.id<100?"0":"")+(n.idNumber&&+n.item.id<10?"0":"")+n.item.id+(n.item.backArtwork?"-back":"")+".png",t.B4B)}}function Qp(a,r){if(1&a&&t.nrm(0,"span",32),2&a){const n=t.XpG().$index,i=t.XpG(4);t.Y8G("ngClass",t.eq3(2,Ea,i.settingsManager.settings.fhStyle))("ghs-label","%game.characterToken."+i.slotsBackMarked[n]+"%")}}function tu(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",30),t.bIt("singleClick",function(){const e=c.eBV(n).$index,o=t.XpG(4);return c.Njj(o.clickedSlotBack.emit(e))}),t.nrm(1,"ghs-action",31),t.nVh(2,Qp,1,4,"span",32),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(4);t.Y8G("ngClass",t.l_i(5,Oe,e.clickedSlotBack.observed,e.usable)),t.R7$(),t.Aen(e.fhStyle||e.bb?"fh":"gh"),t.Y8G("action",n),t.R7$(),t.vxM(e.slotsBackMarked.length>=i-1&&e.slotsBackMarked[i]?2:-1)}}function nu(a,r){if(1&a&&(t.j41(0,"div",10),t.Z7z(1,tu,3,8,"span",29,ls),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.Y8G("ngClass",t.eq3(3,cs,n.slotsBack.length<4)),t.R7$(),t.Dyx(t.bMT(3,1,n.slotsBack))}}function eu(a,r){if(1&a&&(t.j41(0,"div",11),t.EFF(1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Lme("",n.count,"/",n.item.count)}}function au(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",33),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.flipped=!e.flipped)}),t.nrm(1,"span",34),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","%game.card.flipItem%"))}function iu(a,r){if(1&a&&(t.j41(0,"div",21),t.nrm(1,"img",35),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("src","./assets/images/items/slots/"+n.item.slot+".svg",t.B4B)}}function ou(a,r){if(1&a&&(t.j41(0,"span",23),t.EFF(1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.SpI("",n.edition,"\xa0")}}function su(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function ru(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function cu(a,r){if(1&a&&(t.j41(0,"div",24),t.nrm(1,"span",36),t.k0s()),2&a){const n=t.XpG(3);t.Y8G("ngClass",t.eq3(2,Ea,n.settingsManager.settings.fhStyle)),t.R7$(),t.Y8G("ghs-label","%game.characterToken."+n.item.solo+"%")}}function lu(a,r){if(1&a&&(t.j41(0,"div",4)(1,"span",25),t.nrm(2,"span",26),t.k0s(),t.nVh(3,Jp,1,1,"img",6),t.nrm(4,"div",7),t.j41(5,"div",8)(6,"div",9),t.nrm(7,"ghs-actions",27),t.k0s(),t.nVh(8,nu,4,5,"div",10),t.k0s(),t.nVh(9,eu,2,2,"div",11),t.nVh(10,au,2,1,"div",28),t.nVh(11,iu,2,1,"div",21),t.j41(12,"div",22),t.nVh(13,ou,2,1,"span",23),t.nVh(14,su,2,0,"span"),t.nVh(15,ru,2,0,"span"),t.j41(16,"span"),t.EFF(17),t.k0s()(),t.nVh(18,cu,2,4,"div",24),t.k0s()),2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","game.cards.confirmReveal"),t.R7$(),t.vxM(n.item.noArtwork?-1:3),t.R7$(),t.Y8G("ghs-label","data.items."+n.item.edition+"-"+n.item.id),t.R7$(3),t.Aen(n.fhStyle||n.bb?"fh":"gh"),t.Y8G("actions",n.item.actionsBack)("noDivider",!0),t.R7$(),t.vxM(n.slotsBack.length>0?8:-1),t.R7$(),t.vxM(n.item.count?9:-1),t.R7$(),t.vxM(n.item.actionsBack&&n.item.actionsBack.length>0?10:-1),t.R7$(),t.vxM(n.item.slot?11:-1),t.R7$(2),t.vxM(n.edition?13:-1),t.R7$(),t.vxM(n.idNumber&&+n.item.id<100?14:-1),t.R7$(),t.vxM(n.idNumber&&+n.item.id<10?15:-1),t.R7$(2),t.JRh(n.item.id),t.R7$(),t.vxM(n.item.solo?18:-1)}}function gu(a,r){if(1&a&&t.nrm(0,"img",6),2&a){const n=t.XpG(2);t.Y8G("src","./assets/artwork/items/"+n.item.edition+"-"+(n.idNumber&&+n.item.id<100?"0":"")+(n.idNumber&&+n.item.id<10?"0":"")+n.item.id+".png",t.B4B)}}function du(a,r){if(1&a&&(t.j41(0,"div",9),t.nrm(1,"ghs-actions",27),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Aen(n.fhStyle||n.bb?"fh":"gh"),t.Y8G("actions",n.item.actions)("noDivider",!0)}}function hu(a,r){if(1&a&&t.nrm(0,"span",32),2&a){const n=t.XpG().$index,i=t.XpG(3);t.Y8G("ngClass",t.eq3(2,Ea,i.settingsManager.settings.fhStyle))("ghs-label","%game.characterToken."+i.slotsMarked[n]+"%")}}function _u(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",30),t.bIt("singleClick",function(){const e=c.eBV(n).$index,o=t.XpG(3);return c.Njj(o.clickedSlot.emit(e))}),t.nrm(1,"ghs-action",31),t.nVh(2,hu,1,4,"span",32),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.Y8G("ngClass",t.l_i(5,Oe,e.clickedSlot.observed,e.usable)),t.R7$(),t.Aen(e.fhStyle||e.bb?"fh":"gh"),t.Y8G("action",n),t.R7$(),t.vxM(e.slotsMarked.length>=i-1&&e.slotsMarked[i]?2:-1)}}function mu(a,r){if(1&a&&(t.j41(0,"div",10),t.Z7z(1,_u,3,8,"span",29,ls),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(3,cs,n.slots.length<4)),t.R7$(),t.Dyx(t.bMT(3,1,n.slots))}}function pu(a,r){if(1&a&&(t.j41(0,"div",11),t.EFF(1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Lme("",n.count,"/",n.item.count)}}function uu(a,r){1&a&&t.nrm(0,"span",37),2&a&&t.Y8G("ghs-label","%game.itemFh."+r.$implicit+"%")}function fu(a,r){if(1&a&&t.Z7z(0,uu,1,1,"span",37,t.fX1),2&a){const n=t.XpG(3);t.Dyx(n.item.requiredItems)}}function Cu(a,r){if(1&a&&(t.j41(0,"span",40),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.SpI("x",n.value)}}function Mu(a,r){if(1&a&&(t.j41(0,"span",38),t.nrm(1,"img",39),t.nVh(2,Cu,2,1,"span",40),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+n.key+".svg",t.B4B),t.R7$(),t.vxM(n.value&&n.value>1?2:-1)}}function vu(a,r){if(1&a&&(t.Z7z(0,Mu,3,2,"span",38,t.fX1),t.nI1(2,"keyvalue")),2&a){const n=t.XpG(3);t.Dyx(t.bMT(2,0,n.item.resources))}}function Ou(a,r){if(1&a&&(t.j41(0,"span",40),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.SpI("x",n.value)}}function Pu(a,r){if(1&a&&(t.j41(0,"span",38),t.nrm(1,"span",41),t.nVh(2,Ou,2,1,"span",40),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.Y8G("ghs-label","game.items.anyResource")("ghs-label-args",t.eq3(3,qp,n.key)),t.R7$(),t.vxM(n.value&&n.value>1?2:-1)}}function bu(a,r){1&a&&(t.Z7z(0,Pu,3,5,"span",38,t.fX1),t.nI1(2,"keyvalue")),2&a&&t.Dyx(t.bMT(2,0,r.$implicit))}function ku(a,r){if(1&a&&(t.j41(0,"div",12),t.nVh(1,fu,2,0),t.nVh(2,vu,3,2),t.Z7z(3,bu,3,2,null,null,t.fX1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.vxM(n.item.requiredItems?1:-1),t.R7$(),t.vxM(n.item.resources?2:-1),t.R7$(),t.Dyx(n.item.resourcesAny||t.lJ4(2,Lp))}}function yu(a,r){if(1&a&&(t.j41(0,"div",13)(1,"span",40),t.EFF(2),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(2),t.JRh(n.item.cost)}}function xu(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",42),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.clickedConsumed.emit())})("doubleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.clickedConsumed.emit(!0))}),t.nrm(1,"span",34),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.l_i(2,Oe,n.clickedConsumed.observed,n.usable)),t.R7$(),t.Y8G("ghs-label","%game.card.lost%")}}function Eu(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",43),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.clickedSpent.emit())})("doubleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.clickedSpent.emit(!0))}),t.nrm(1,"span",34),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.l_i(2,Oe,n.clickedSpent.observed,n.usable)),t.R7$(),t.Y8G("ghs-label","%game.card.spent%")}}function wu(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",44),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return e.flipped=!e.flipped,c.Njj(e.clickedFlip.emit())})("doubleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.clickedFlip.emit(!0))}),t.nrm(1,"span",34),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.l_i(2,Oe,n.clickedFlip.observed,n.usable)),t.R7$(),t.Y8G("ghs-label","%game.card.flipItem%")}}function Ru(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",45),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.clickedPersistent.emit())})("doubleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.clickedPersistent.emit(!0))}),t.nrm(1,"span",34),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.l_i(2,Oe,n.clickedPersistent.observed,n.usable)),t.R7$(),t.Y8G("ghs-label","%game.card.persistent%")}}function ju(a,r){1&a&&(t.j41(0,"div",18),t.nrm(1,"span",34),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","%game.card.loss%"))}function Gu(a,r){1&a&&(t.j41(0,"div",19),t.nrm(1,"span",34),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","%game.card.round%"))}function Tu(a,r){if(1&a&&(t.j41(0,"div",20)(1,"span",46),t.nrm(2,"img",47),t.k0s(),t.j41(3,"span",40),t.EFF(4),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("src","./assets/images"+(n.fhStyle||n.bb?"/fh/attackmodifier/icons/minus1.png":"/items/minus1.svg"),t.B4B),t.R7$(2),t.SpI("x",n.item.minusOne)}}function Su(a,r){if(1&a&&(t.j41(0,"div",21),t.nrm(1,"img",35),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("src","./assets/images/items/slots/"+n.item.slot+".svg",t.B4B)}}function Du(a,r){if(1&a&&(t.j41(0,"span",23),t.EFF(1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.SpI("",n.edition,"\xa0")}}function $u(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function Iu(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function Au(a,r){if(1&a&&(t.j41(0,"div",24),t.nrm(1,"span",36),t.k0s()),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Ea,n.settingsManager.settings.fhStyle)),t.R7$(),t.Y8G("ghs-label","%game.characterToken."+n.item.solo+"%")}}function Vu(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",2),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.emitRevealed(e))}),t.nVh(1,Zp,9,5,"div",3),t.nVh(2,lu,19,16,"div",4),t.j41(3,"div",5),t.nVh(4,gu,1,1,"img",6),t.nrm(5,"div",7),t.j41(6,"div",8),t.nVh(7,du,2,4,"div",9),t.nVh(8,mu,4,5,"div",10),t.k0s(),t.nVh(9,pu,2,2,"div",11),t.nVh(10,ku,5,3,"div",12),t.nVh(11,yu,3,1,"div",13),t.nVh(12,xu,2,5,"div",14),t.nVh(13,Eu,2,5,"div",15),t.nVh(14,wu,2,5,"div",16),t.nVh(15,Ru,2,5,"div",17),t.nVh(16,ju,2,1,"div",18),t.nVh(17,Gu,2,1,"div",19),t.nVh(18,Tu,5,2,"div",20),t.nVh(19,Su,2,1,"div",21),t.j41(20,"div",22),t.nVh(21,Du,2,1,"span",23),t.nVh(22,$u,2,0,"span"),t.nVh(23,Iu,2,0,"span"),t.j41(24,"span"),t.EFF(25),t.k0s()(),t.nVh(26,Au,2,4,"div",24),t.k0s()()}if(2&a){const n=t.XpG();t.xc7("font-size",n.fontsize),t.Y8G("ngClass",t.s1E(26,zp,n.flipped,n.item.random,n.fhStyle,n.craft,n.bb))("disabled",!n.reveal),t.R7$(),t.vxM(n.item.actionsBack&&0!=n.item.actionsBack.length?-1:1),t.R7$(),t.vxM(n.item.actionsBack&&n.item.actionsBack.length>0?2:-1),t.R7$(2),t.vxM(n.bb||n.item.noArtwork?-1:4),t.R7$(),t.Y8G("ghs-label","data.items."+n.item.edition+"-"+n.item.id),t.R7$(2),t.vxM(n.item.actions&&n.item.actions.length>0?7:-1),t.R7$(),t.vxM(n.slots.length>0?8:-1),t.R7$(),t.vxM(n.item.count&&(!n.bb||n.item.count>1)?9:-1),t.R7$(),t.vxM(n.craft?10:-1),t.R7$(),t.vxM(n.item.cost&&!n.item.solo?11:-1),t.R7$(),t.vxM(n.item.consumed?12:-1),t.R7$(),t.vxM(n.item.spent?13:-1),t.R7$(),t.vxM(n.item.actionsBack&&n.item.actionsBack.length>0?14:-1),t.R7$(),t.vxM(n.item.persistent?15:-1),t.R7$(),t.vxM(n.item.loss?16:-1),t.R7$(),t.vxM(n.item.round?17:-1),t.R7$(),t.vxM(n.item.minusOne?18:-1),t.R7$(),t.vxM(n.item.slot?19:-1),t.R7$(2),t.vxM(n.edition?21:-1),t.R7$(),t.vxM(n.idNumber&&+n.item.id<100?22:-1),t.R7$(),t.vxM(n.idNumber&&+n.item.id<10?23:-1),t.R7$(2),t.JRh(n.item.id),t.R7$(),t.vxM(n.item.solo?26:-1)}}let Vn=(()=>{class a{elementRef;ghsManager;item;identifier;flipped=!1;reveal=!1;count=1;slotsMarked=[];slotsBackMarked=[];editionLabel="";revealed=new t.bkB;clickedConsumed=new t.bkB;clickedSpent=new t.bkB;clickedFlip=new t.bkB;clickedSlot=new t.bkB;clickedSlotBack=new t.bkB;clickedPersistent=new t.bkB;fhStyle=!1;bb=!1;craft=!1;edition="";slots=[];slotsBack=[];idNumber=!1;usable=!0;settingsManager=p.f;gameManager=s.E;fontsize="1em";constructor(n,i){this.elementRef=n,this.ghsManager=i}ngOnInit(){if(!this.item&&this.identifier&&(this.item=s.E.itemManager.getItem(this.identifier.name,this.identifier.edition,!0)),this.item){if(this.item.edition!=this.editionLabel&&(this.edition=this.item.edition),s.E.newItemStyle(this.item.edition)&&(this.fhStyle=!0),"bb"==this.item.edition&&(this.bb=!0),(this.item.resources&&Object.values(this.item.resources).some(n=>n)||this.item.requiredItems&&this.item.requiredItems.length>0||this.item.resourcesAny&&this.item.resourcesAny.length>0)&&(this.fhStyle=!0,this.craft=!0),this.item.actions=this.item.actions||[],this.applySlots(this.item.slots,this.slots),this.item.slotsBack&&(this.item.actionsBack=this.item.actionsBack||[],this.applySlots(this.item.slotsBack,this.slotsBack)),this.item.summon&&!this.item.actions.find(n=>n.type==$.X2.summon&&"summonDataItem"==n.value)){const n=new $.rc($.X2.summon,"summonDataItem");n.valueObject=this.item.summon,n.small=!0,this.item.actions.push(n)}this.idNumber="number"==typeof this.item.id,this.usable=s.E.itemManager.itemUsable(this.item)}this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.fontsize=.072*this.elementRef.nativeElement.offsetWidth+"px",this.item&&(this.usable=s.E.itemManager.itemUsable(this.item))}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}ngAfterViewInit(){setTimeout(()=>{this.fontsize=.072*this.elementRef.nativeElement.offsetWidth+"px"},1)}applySlots(n,i){if(n&&!i.find(e=>e.type==$.X2.card&&e.subActions.length>0&&(""+e.value).startsWith("slot")))for(let e=0;e<n;e++){let o=new $.rc($.X2.card,"slot");this.fhStyle&&0==e?o=new $.rc($.X2.card,"slotStart"):this.fhStyle&&e==n-1&&(o=new $.rc($.X2.card,"slotEnd")),n>3&&(o.small=!0),i.push(o)}}applySlotsGrid(n,i){if(n&&!i.find(e=>e.type==$.X2.grid&&e.subActions.length>0&&e.subActions[0].type==$.X2.card&&(""+e.subActions[0].value).startsWith("slot")))if(n<5){const e=new $.rc($.X2.grid,n);for(let o=0;o<n;o++)e.subActions.push(new $.rc($.X2.card,this.fhStyle&&0==o?"slotStart":this.fhStyle&&o==n-1?"slotEnd":"slot"));n>3&&(e.small=!0),i.push(e)}else{const e=Math.ceil(n/3);for(let o=0;o<e;o++){const g=o<e-1?3:n%3,m=new $.rc($.X2.grid,g);e>1&&(m.small=!0);for(let k=0;k<g;k++)m.subActions.push(new $.rc($.X2.card,this.fhStyle&&0==k&&0==o?"slotStart":this.fhStyle&&k==g-1&&o==e-1?"slotEnd":"slot"));i.push(m)}}}emitRevealed(n){this.revealed.emit(n)}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-item"]],inputs:{item:"item",identifier:"identifier",flipped:"flipped",reveal:"reveal",count:"count",slotsMarked:"slotsMarked",slotsBackMarked:"slotsBackMarked",editionLabel:"editionLabel"},outputs:{revealed:"revealed",clickedConsumed:"clickedConsumed",clickedSpent:"clickedSpent",clickedFlip:"clickedFlip",clickedSlot:"clickedSlot",clickedSlotBack:"clickedSlotBack",clickedPersistent:"clickedPersistent"},standalone:!1,decls:2,vars:1,consts:[[1,"item-container"],["card-reveal","",1,"card","vertical","reverse","item",3,"ngClass","fontSize","disabled"],["card-reveal","",1,"card","vertical","reverse","item",3,"change","ngClass","disabled"],[1,"card-back","back"],[1,"card-back","front"],[1,"card-front","front"],[1,"artwork",3,"src"],[1,"name",3,"ghs-label"],[1,"content"],[1,"actions"],[1,"actions","slot-actions",3,"ngClass"],[1,"count"],[1,"craft"],[1,"costs"],["ghs-pointer-input","",1,"consumed",3,"ngClass"],["ghs-pointer-input","",1,"spent",3,"ngClass"],["ghs-pointer-input","",1,"flip",3,"ngClass"],["ghs-pointer-input","",1,"persistent",3,"ngClass"],[1,"loss"],[1,"round"],[1,"minus-one"],[1,"slot"],[1,"id"],[1,"edition"],[1,"solo",3,"ngClass"],[1,"revealed"],[1,"text",3,"ghs-label"],[3,"actions","noDivider"],["ghs-pointer-input","",1,"flip"],["ghs-pointer-input","",1,"slot-action",3,"ngClass"],["ghs-pointer-input","",1,"slot-action",3,"singleClick","ngClass"],[3,"action"],[1,"marker",3,"ngClass","ghs-label"],["ghs-pointer-input","",1,"flip",3,"singleClick"],[1,"placeholder","text-white",3,"ghs-label"],[1,"ghs-svg",3,"src"],[3,"ghs-label"],[1,"required-item",3,"ghs-label"],[1,"resource"],[3,"src"],[1,"value"],[1,"any",3,"ghs-label","ghs-label-args"],["ghs-pointer-input","",1,"consumed",3,"singleClick","doubleClick","ngClass"],["ghs-pointer-input","",1,"spent",3,"singleClick","doubleClick","ngClass"],["ghs-pointer-input","",1,"flip",3,"singleClick","doubleClick","ngClass"],["ghs-pointer-input","",1,"persistent",3,"singleClick","doubleClick","ngClass"],[1,"card-icon","small"],[1,"icon",3,"src"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nVh(1,Vu,27,32,"div",1),t.k0s()),2&i&&(t.R7$(),t.vxM(e.item?1:-1))},dependencies:[N.YU,en,ve,Nn,it,dt,N.lG,ct],styles:[".item-container[_ngcontent-%COMP%]{position:relative;width:100%;padding-bottom:147%}.item[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;color:var(--ghs-color-white)}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]{background-image:url(item-front.8bf9b41fdff9cdd6.png);background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:.5em;background-clip:padding-box}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .artwork[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;-webkit-mask-image:url(item-front-mask.3394fd70bd536cc8.png);mask-image:url(item-front-mask.3394fd70bd536cc8.png);-webkit-mask-size:100% 100%;mask-size:100% 100%;-webkit-mask-position:center center;mask-position:center center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;top:4%;left:50%;width:90%;height:10%;display:flex;justify-content:center;align-items:center;text-align:center;transform:translate(-56%);font-family:var(--ghs-font-gh-title);font-size:1.2em;filter:var(--ghs-filter-outline)}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]{position:relative;height:3.5em;width:3.5em;margin:.2em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:auto}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .card-icon.small[_ngcontent-%COMP%]{height:2.2em;width:2.2em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{position:absolute;top:60%;left:50%;width:100%;height:27%;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;transform:translate(-50%);font-family:var(--ghs-font-gh-normal);font-size:1.25em;line-height:.8em;--ghs-filter-shadow: brightness(1) !important;--ghs-filter-shadow-thin: brightness(1) !important}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{width:85%;font-size:1.2em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{width:95%;font-size:calc(1em * var(--ghs-fontsize))}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{filter:none}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]   .text-white[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .actions.slot-actions[_ngcontent-%COMP%]{width:85%;display:flex;flex-wrap:wrap;justify-content:center;align-items:center}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .actions.slot-actions[_ngcontent-%COMP%]   .slot-action[_ngcontent-%COMP%]{position:relative;margin:-.2em .2em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .actions.slot-actions[_ngcontent-%COMP%]   .slot-action[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]{position:absolute;top:calc(.2em * var(--ghs-fontsize));left:calc(.2em * var(--ghs-fontsize));font-size:calc(1.2em * var(--ghs-fontsize))}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .actions.slot-actions[_ngcontent-%COMP%]   .slot-action[_ngcontent-%COMP%]   .marker.fh[_ngcontent-%COMP%]{font-size:calc(1em * var(--ghs-fontsize))}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{position:absolute;top:51.5%;left:11%;width:10%;height:5%;display:flex;justify-content:center;align-items:center;text-align:center;font-family:var(--ghs-font-gh-normal);font-size:.8em;text-shadow:var(--ghs-filter-outline-thin)}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]{position:absolute;top:45%;left:71%;width:20%;height:13%;display:flex;justify-content:center;align-items:center;text-align:center}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);font-size:2em;filter:var(--ghs-filter-outline-thin)}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .craft[_ngcontent-%COMP%]{position:absolute;top:13%;left:80.4%;width:15%;height:35%;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;font-family:var(--ghs-font-gh-title);font-size:1em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .craft[_ngcontent-%COMP%]   .required-item[_ngcontent-%COMP%]{font-size:1.2em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .craft[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:1em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .craft[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1.7em;width:auto}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .craft[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]   .any[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-text);color:var(--ghs-color-black);font-size:1.2em;line-height:.9em;font-weight:700}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .craft[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-text);color:var(--ghs-color-black);margin:-.4em 0;font-size:1.2em;font-weight:700}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .craft[_ngcontent-%COMP%]   .required-item[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .craft[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]{width:100%;margin:.1em 0;border-top:.12em solid transparent}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .craft[_ngcontent-%COMP%]   .required-item[_ngcontent-%COMP%]:not(:first-child), .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .craft[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]:not(:first-child){border-color:var(--ghs-color-black)}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .flip[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .persistent[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .loss[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round[_ngcontent-%COMP%]{position:absolute;top:81%;left:69%;width:20%;height:13%;display:flex;justify-content:center;align-items:center;text-align:center;font-size:1.8em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed.consumed[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent.consumed[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .flip.consumed[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .persistent.consumed[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .loss.consumed[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round.consumed[_ngcontent-%COMP%]{left:71%}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed.persistent[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed.round[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent.persistent[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent.round[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .flip.persistent[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .flip.round[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .persistent.persistent[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .persistent.round[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .loss.persistent[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .loss.round[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round.persistent[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round.round[_ngcontent-%COMP%]{left:12.5%}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed.flip[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent.flip[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .flip.flip[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .persistent.flip[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .loss.flip[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round.flip[_ngcontent-%COMP%]{cursor:ew-resize}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed.loss[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent.loss[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .flip.loss[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .persistent.loss[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .loss.loss[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round.loss[_ngcontent-%COMP%]{left:57%;font-size:1.2em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .interactive[_ngcontent-%COMP%]{cursor:not-allowed}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .interactive.usable[_ngcontent-%COMP%]{cursor:pointer}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .interactive.usable[_ngcontent-%COMP%]:hover{opacity:.6}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .minus-one[_ngcontent-%COMP%]{position:absolute;top:84%;left:12.5%;width:25%;height:13%;display:flex;justify-content:center;align-items:center;text-align:center;font-family:var(--ghs-font-gh-title);font-size:.8em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .minus-one[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:1.4em;filter:var(--ghs-filter-outline-thin);margin-top:-.5em;margin-left:.1em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]{position:absolute;top:88%;left:45%;width:10%;height:7%;display:flex;justify-content:center;align-items:center}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:100%;width:auto;opacity:.8}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{position:absolute;top:1%;left:80%;width:15%;height:7%;display:flex;justify-content:flex-end;align-items:center;font-family:var(--ghs-font-gh-normal);font-size:.8em;filter:var(--ghs-filter-thin)}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]{text-transform:uppercase}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .solo[_ngcontent-%COMP%]{position:absolute;top:43.5%;left:70%;width:23%;height:15%;display:flex;justify-content:center;align-items:center;z-index:1;font-size:2.4em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .solo.fh[_ngcontent-%COMP%]{font-size:2.1em;top:41%}.item[_ngcontent-%COMP%]   .front.card-back[_ngcontent-%COMP%]{background-image:url(item-front-flipped.127cb9a750311d37.png)!important}.item[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%]{background-image:url(item-back.64e65973760cc390.png);background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:.5em;background-clip:padding-box}.item[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{position:absolute;top:46.5%;left:0%;width:22%;height:7%;display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-gh-normal);font-size:1.2em;filter:var(--ghs-filter-outline)}.item.disabled[_ngcontent-%COMP%]{cursor:initial}.item.confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]{position:relative;top:30%;width:100%;height:70%;display:flex;justify-content:center;align-items:center;text-align:center;color:var(--ghs-color-white);font-size:1.5em;filter:drop-shadow(calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) var(--ghs-color-black))}.item.confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{text-align:center}.item.random[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]{background-image:url(item-random-front.88f16c05c7ae8ab1.png)}.item.random[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%]{background-image:url(item-random-back.4e43c9e17cefa170.png)}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]{background-image:url(item-front-fh.4fc516965fc2ca34.png)}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .artwork[_ngcontent-%COMP%]{-webkit-mask-image:url(item-front-mask-fh.cd7e1477ce66b2d1.png);mask-image:url(item-front-mask-fh.cd7e1477ce66b2d1.png)}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{top:1%;font-family:var(--ghs-font-fh-title);letter-spacing:.02em;transform:translate(-58%)}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-text)!important;font-size:1.4em;line-height:1em}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .actions.slot-actions.wide[_ngcontent-%COMP%]{width:100%;margin-bottom:.5em}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .actions.slot-actions[_ngcontent-%COMP%]   .slot-action[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]{top:calc(.3em * var(--ghs-fontsize));left:calc(.25em * var(--ghs-fontsize))}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{top:48.5%;left:5%;letter-spacing:.1em}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]{top:35%;left:69.5%;background-image:url(costs.fa9800cb8300123b.png);background-size:contain;background-repeat:no-repeat;width:28%;height:19%}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{position:relative;font-size:2.3em;top:-.5%;left:-.5%}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .flip[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .persistent[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .loss[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round[_ngcontent-%COMP%]{top:86%;left:73%}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed.consumed[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent.consumed[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .flip.consumed[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .persistent.consumed[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .loss.consumed[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round.consumed[_ngcontent-%COMP%]{left:74%}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed.persistent[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed.round[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent.persistent[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent.round[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .flip.persistent[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .flip.round[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .persistent.persistent[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .persistent.round[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .loss.persistent[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .loss.round[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round.persistent[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round.round[_ngcontent-%COMP%]{left:4%}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed.loss[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent.loss[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .flip.loss[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .persistent.loss[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .loss.loss[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round.loss[_ngcontent-%COMP%]{left:58.5%;font-size:1.7em}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .minus-one[_ngcontent-%COMP%]{top:86%;left:4%;font-family:var(--ghs-font-fh-text);font-size:.9em}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .minus-one[_ngcontent-%COMP%]   .card-icon.small[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:80%;left:20%}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .minus-one[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{margin-top:-.3em}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]{top:90.5%}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{opacity:.5}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{top:0%;left:83%;align-items:flex-start}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .solo[_ngcontent-%COMP%]{top:36%;font-size:2em}.item.fh[_ngcontent-%COMP%]   .front.card-back[_ngcontent-%COMP%]{background-image:url(item-front-fh.4fc516965fc2ca34.png)!important}.item.fh[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%]{background-image:url(item-back-fh.e293bb7bd25a2ea5.png)}.item.fh[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{transform:rotate(-90deg);top:24%;left:-6%;color:var(--ghs-color-black);filter:none;font-family:var(--ghs-font-fh-title);font-size:1em}.item.fh.random[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]{background-image:url(item-random-front-fh.2b2d210fbf1d2b55.png)}.item.fh.random[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%]{background-image:url(item-random-back-fh.45214b480302b366.png)}.item.fh.craft[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]{background-image:url(item-craft-front-fh.d073f3df88fe481d.png)}.item.fh.craft[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .artwork[_ngcontent-%COMP%]{-webkit-mask-image:url(item-craft-front-mask-fh.0f1291f6ecc709fa.png);mask-image:url(item-craft-front-mask-fh.0f1291f6ecc709fa.png)}.item.fh.craft[_ngcontent-%COMP%]   .front.card-back[_ngcontent-%COMP%]   .artwork[_ngcontent-%COMP%]{left:15%}.item.fh.craft.random[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]{background-image:url(item-craft-random-front-fh.9511a49714d79585.png)}.item.bb[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]{background-image:url(item-front-bb.ffe0ae0c84f98c49.png)}.item.bb[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-title)!important;top:30%;transform:translate(-50%);text-transform:uppercase;font-size:1.1em;filter:none;text-align:center}.item.bb[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-text)!important;top:45%;font-size:1.7em;line-height:1.2em}.item.bb[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent[_ngcontent-%COMP%], .item.bb[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed[_ngcontent-%COMP%]{top:75%;left:50%;transform:translate(-50%)}.item.bb[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]{top:20%}.item.bb[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.item.bb[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{top:initial;bottom:0%;left:0%;align-items:flex-start}"]})}return a})();const Fu=(a,r)=>({equipped:a,disabled:r}),Xu=(a,r)=>({selected:a,unavailable:r}),Bu=(a,r,n)=>({filtered:a,unavailable:r,owned:n});function Yu(a,r){if(1&a&&t.nrm(0,"ghs-item",2),2&a){const n=t.XpG();t.Y8G("item",n.item)("flipped",n.flipped)("count",n.gameManager.itemManager.assigned(n.item))("editionLabel",n.gameManager.currentEdition())("ngClass",t.l_i(5,Xu,!(n.dialog||!n.equipped()),!n.dialog&&n.bbBlocked()))}}function Uu(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-item",7),t.bIt("clickedConsumed",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.toggleFlag(e,o.ItemFlags.consumed))})("clickedFlip",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.toggleFlag(e,o.ItemFlags.flipped))})("clickedSpent",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.toggleFlag(e,o.ItemFlags.spent))})("clickedPersistent",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.toggleFlag(e,o.ItemFlags.persistent))})("clickedSlot",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.toggleFlagCount(e,o.ItemFlags.slot))})("clickedSlotBack",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.toggleFlagCount(e,o.ItemFlags.slotBack))}),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("item",n.item)("count",n.gameManager.itemManager.assigned(n.item))("flipped",n.flipped&&!n.countFlag(n.ItemFlags.flipped))("slotsMarked",n.slotsMarked(n.ItemFlags.slot))("slotsBackMarked",n.slotsMarked(n.ItemFlags.slotBack))("editionLabel",n.gameManager.currentEdition())("ngClass",t.sMw(7,Bu,!n.equipped(),n.countFlag(n.ItemFlags.consumed)>0||n.bbBlocked(),n.countFlag(n.ItemFlags.persistent)>0))}}function Nu(a,r){1&a&&(t.j41(0,"span",4),t.nrm(1,"img",8),t.k0s())}let yi=(()=>{class a{ghsManager;character;item;flipped=!0;setup=!1;dialog=!1;gameManager=s.E;settingsManager=p.f;ItemFlags=wt.Tr;GameState=D.mk;constructor(n){this.ghsManager=n}equipped(){return this.character.progress.equippedItems.find(n=>n.name==""+this.item.id&&n.edition==this.item.edition)}bbBlocked(){return s.E.bbRules()&&!this.equipped()&&null!=this.character.progress.equippedItems.find(n=>"number"==typeof this.item.id&&+n.name==(this.item.id%2==0?this.item.id-1:this.item.id+1)&&n.edition==this.item.edition)}isLootRandomItem(){return this.character.progress.equippedItems.find(n=>n.name==""+this.item.id&&n.edition==this.item.edition&&"loot-random-item"==n.marker)}toggleEquippedItem(n=!1){const i=null!=this.character.progress.items.find(e=>e.name==""+this.item.id&&e.edition==this.item.edition);(this.setup||n)&&(i||!this.bbBlocked()||n)&&(s.E.stateManager.before(this.equipped()?"unequipItem":"equipItem",s.E.characterManager.characterName(this.character),this.item.id,this.item.edition),s.E.itemManager.toggleEquippedItem(this.item,this.character,n),s.E.bbRules()&&(!this.equipped()&&i?s.E.itemManager.removeItem(this.item,this.character):this.equipped()&&!i&&s.E.itemManager.addItem(this.item,this.character)),s.E.stateManager.after(),p.f.settings.animations&&setTimeout(()=>{this.ghsManager.triggerUiChange()},500*p.f.settings.animationSpeed))}countFlag(n){const i=this.equipped();return i&&i.tags&&i.tags.filter(e=>e==n).length||0}toggleFlag(n,i){if((n||!s.E.challengesManager.apply||!s.E.challengesManager.isActive(1502,"fh")||this.item.slot!=wt.o8.small)&&(!this.setup&&s.E.game.state==D.mk.next||n)){const e=this.equipped();e&&(s.E.itemManager.itemUsable(this.item)||n)&&(e.tags=e.tags||[],s.E.stateManager.before((e.tags.includes(i)?"characterItemUnapply.":"characterItemApply.")+i,s.E.characterManager.characterName(this.character),this.item.id,this.item.edition,this.item.name),e.tags.includes(i)?(e.tags=e.tags.filter(o=>o!=i),i==wt.Tr.spent&&(e.tags=e.tags.filter(o=>o!=wt.Tr.slot&&o!=wt.Tr.slotBack))):!n&&s.E.challengesManager.apply&&s.E.challengesManager.isActive(1507,"fh")&&i==wt.Tr.spent?e.tags.push(wt.Tr.consumed):e.tags.push(i),(i==wt.Tr.consumed||i==wt.Tr.spent)&&e.tags.includes(i)&&p.f.settings.characterItemsApply&&s.E.itemManager.applyItemEffects(this.character,this.item,!0),s.E.stateManager.after(),p.f.settings.animations&&setTimeout(()=>{this.ghsManager.triggerUiChange()},500*p.f.settings.animationSpeed))}}toggleFlagCount(n,i){if(!this.setup&&s.E.game.state==D.mk.next){const e=this.equipped();if(e){e.tags=e.tags||[];const o=this.countFlag(i);if(s.E.stateManager.before((o<=n?"characterItemApply.":"characterItemUnapply.")+i,s.E.characterManager.characterName(this.character),this.item.id,this.item.edition,this.item.name),o<=n){for(let g=o;g<=n;g++)e.tags.push(i);i==wt.Tr.slot&&this.countFlag(i)==this.item.slots&&(this.item.spent&&!this.countFlag(wt.Tr.spent)?e.tags.push(wt.Tr.spent):this.item.consumed&&!this.countFlag(wt.Tr.consumed)&&e.tags.push(wt.Tr.consumed))}else for(let g=n;g<o;g++)e.tags.splice(e.tags.indexOf(i),1);s.E.stateManager.after(),p.f.settings.animations&&setTimeout(()=>{this.ghsManager.triggerUiChange()},500*p.f.settings.animationSpeed)}}}slotsMarked(n){let i=[];for(let e=0;e<this.countFlag(n);e++)i.push(this.character.name);return i}static \u0275fac=function(i){return new(i||a)(t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-character-item"]],inputs:{character:"character",item:"item",flipped:"flipped",setup:"setup",dialog:"dialog"},standalone:!1,decls:7,vars:9,consts:[["container",""],[1,"item"],["ghs-pointer-input","",3,"item","flipped","count","editionLabel","ngClass"],[3,"item","count","flipped","slotsMarked","slotsBackMarked","editionLabel","ngClass"],[1,"loot-random-item"],["ghs-pointer-input","",1,"button-equip",3,"singleClick","doubleClick","ngClass"],["src","./assets/images/check.svg",1,"ghs-svg"],[3,"clickedConsumed","clickedFlip","clickedSpent","clickedPersistent","clickedSlot","clickedSlotBack","item","count","flipped","slotsMarked","slotsBackMarked","editionLabel","ngClass"],["src","./assets/images/fh/loot-token.png"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",1,0),t.nVh(2,Yu,1,8,"ghs-item",2),t.nVh(3,Uu,1,11,"ghs-item",3),t.nVh(4,Nu,2,0,"span",4),t.j41(5,"a",5),t.bIt("singleClick",function(){return c.eBV(o),c.Njj(e.toggleEquippedItem())})("doubleClick",function(){return c.eBV(o),c.Njj(e.toggleEquippedItem(!0))}),t.nrm(6,"img",6),t.k0s()()}if(2&i){const o=t.sdS(1);t.xc7("font-size",.1*o.offsetWidth+"px"),t.R7$(2),t.vxM(e.setup?2:-1),t.R7$(),t.vxM(e.setup?-1:3),t.R7$(),t.vxM(e.isLootRandomItem()?4:-1),t.R7$(),t.Y8G("ngClass",t.l_i(6,Fu,e.equipped(),!e.setup||e.bbBlocked()))}},dependencies:[N.YU,Vn,dt],styles:[".item[_ngcontent-%COMP%]{position:relative;width:100%;padding-bottom:150%}.item[_ngcontent-%COMP%]   ghs-item[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;border:.1em solid transparent;border-radius:.5em;overflow:hidden;cursor:initial}.item[_ngcontent-%COMP%]   ghs-item.disabled[_ngcontent-%COMP%]{opacity:.5}.item[_ngcontent-%COMP%]   ghs-item.unavailable[_ngcontent-%COMP%]{cursor:not-allowed;border-color:var(--ghs-color-darkgray);filter:grayscale(.7)}.item[_ngcontent-%COMP%]   ghs-item.filtered[_ngcontent-%COMP%]{border-color:var(--ghs-color-red)}.item[_ngcontent-%COMP%]   ghs-item.selected[_ngcontent-%COMP%]{cursor:pointer;border-color:var(--ghs-color-green)}.item[_ngcontent-%COMP%]   .loot-random-item[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;position:absolute;top:-1em;left:-1em;width:1.8em;height:1.8em}.item[_ngcontent-%COMP%]   .loot-random-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:auto}.item[_ngcontent-%COMP%]   .button-equip[_ngcontent-%COMP%]{z-index:1;position:absolute;display:flex;cursor:pointer;bottom:.5em;left:4.2em;justify-content:center;align-items:center;width:1.6em;height:1.6em;opacity:.6}.item[_ngcontent-%COMP%]   .button-equip.disabled[_ngcontent-%COMP%]{cursor:initial}.item[_ngcontent-%COMP%]   .button-equip[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:100%;height:auto;filter:var(--ghs-filter-white)}.item[_ngcontent-%COMP%]   .button-equip.equipped[_ngcontent-%COMP%]{opacity:1}.item[_ngcontent-%COMP%]   .button-equip.equipped[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.item[_ngcontent-%COMP%]   .button-equip[_ngcontent-%COMP%]:hover:not(.disabled){opacity:.6}.item[_ngcontent-%COMP%]   .button-equip[_ngcontent-%COMP%]:hover:not(.disabled)   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.item[_ngcontent-%COMP%]   .button-equip[_ngcontent-%COMP%]:hover:not(.disabled).equipped   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-red)}"]})}return a})();const zu=(a,r)=>({closed:a,opened:r});function Lu(a,r){if(1&a&&t.nrm(0,"ghs-item",1),2&a){const n=t.XpG();t.Y8G("item",n.item)("flipped",n.opened)("editionLabel",n.gameManager.currentEdition())}}function qu(a,r){if(1&a&&t.nrm(0,"ghs-character-item",2),2&a){const n=t.XpG();t.Y8G("character",n.character)("item",n.item)("setup",n.setup)("flipped",n.opened)("dialog",!0)}}function Hu(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",5),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.close())}),t.k0s()}}let fn=(()=>{class a{data;dialogRef;opened=!1;gameManager=s.E;item;character;setup=!1;constructor(n,i){this.data=n,this.dialogRef=i,this.item=n.item,this.character=n.character,this.setup=n.setup||!1}ngOnInit(){this.opened=!0}close(){this.opened=!1,setTimeout(()=>{this.dialogRef.close()},p.f.settings.animations?1e3*p.f.settings.animationSpeed:0)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-item-dialog"]],standalone:!1,decls:5,vars:7,consts:[[1,"item-dialog",3,"click","ngClass"],[3,"item","flipped","editionLabel"],[3,"character","item","setup","flipped","dialog"],[1,"close-dialog"],[1,"close-container",3,"click"],[1,"close-dialog",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.bIt("click",function(){return!e.character&&e.close()}),t.nVh(1,Lu,1,3,"ghs-item",1),t.nVh(2,qu,1,5,"ghs-character-item",2),t.nVh(3,Hu,1,0,"a",3),t.k0s(),t.j41(4,"div",4),t.bIt("click",function(){return e.close()}),t.k0s()),2&i&&(t.Y8G("ngClass",t.l_i(4,zu,!e.opened,e.opened)),t.R7$(),t.vxM(e.character?-1:1),t.R7$(),t.vxM(e.character?2:-1),t.R7$(),t.vxM(e.character?3:-1))},dependencies:[N.YU,yi,Vn],styles:["[_nghost-%COMP%]{background-color:transparent;padding:0;margin:0;border:0}.item-dialog[_ngcontent-%COMP%]{position:relative;width:66.66vh;max-width:400px;height:100vh;max-height:600px;border-image:none;background:none;transition:transform calc(var(--ghs-animation-speed) * .15s) ease-in-out;transform:scale(0);z-index:2}.item-dialog[_ngcontent-%COMP%]   ghs-item[_ngcontent-%COMP%], .item-dialog[_ngcontent-%COMP%]   ghs-character-item[_ngcontent-%COMP%]{width:100%;height:auto}.item-dialog[_ngcontent-%COMP%]   .close-dialog[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:0;left:0;width:100%;height:45%}.item-dialog.opened[_ngcontent-%COMP%]{transform:scale(1)}.item-dialog.closed[_ngcontent-%COMP%]{transform:scale(0);transition-delay:.8s}@media (max-width: 600px),(orientation: portrait){.item-dialog[_ngcontent-%COMP%]{width:80vw;max-width:400px;height:120vw;max-height:600px}}.close-container[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1}"]})}return a})();const Ku=(a,r)=>({fh:a,modern:r}),Wu=()=>[],Zu=a=>({absent:a}),Ju=(a,r)=>({disabled:a,unavailable:r}),Qu=a=>[a],xi=(a,r,n)=>({active:a,disabled:r,spent:n}),gs=(a,r)=>[a,r],tf=(a,r,n,i)=>[a,r,n,i],nf=a=>({selected:a}),ef=(a,r)=>r._trackUUID;function af(a,r){1&a&&(t.j41(0,"span",4),t.nrm(1,"img",18)(2,"span",3),t.k0s()),2&a&&(t.R7$(2),t.Y8G("ghs-label","game.items.brewing.disabled"))}function of(a,r){if(1&a&&(t.j41(0,"span",6),t.EFF(1),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.SpI("",n+1,".")}}function sf(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",19),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.toggleHerb(e,2))}),t.nrm(1,"img",20),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG();t.Y8G("ngClass",t.sMw(2,xi,i.receipe.length>2&&i.receipe[2]==n,i.receipe[2]!=n&&0==(i.character.progress.loot[n]||0)&&0==(i.gameManager.game.party.loot[n]||0),i.receipe[2]!=n&&((i.characterSpent[n]||0)>0||(i.fhSupportSpent[n]||0)>0)&&(i.character.progress.loot[n]||0)<=(i.characterSpent[n]||0)&&(i.gameManager.game.party.loot[n]||0)<=(i.fhSupportSpent[n]||0))),t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+n+".svg",t.B4B)}}function rf(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",25),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2).$implicit,o=t.XpG();return c.Njj(o.moveHerb(e,o.characterSpent,o.fhSupportSpent))}),t.nrm(1,"img",26),t.k0s()}}function cf(a,r){if(1&a&&(t.j41(0,"span",23),t.EFF(1),t.k0s(),t.nVh(2,rf,2,0,"a",24)),2&a){const n=t.XpG().$implicit,i=t.XpG();t.Y8G("ghs-label","game.loot.")("ghs-label-attribute","title"),t.R7$(),t.Lme(" ",i.characterSpent[n]||"-"," / ",i.character.progress.loot[n]||0," "),t.R7$(),t.vxM(i.characterSpent[n]&&(i.gameManager.game.party.loot[n]||0)>(i.fhSupportSpent[n]||0)?2:-1)}}function lf(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function gf(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",25),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2).$implicit,o=t.XpG();return c.Njj(o.moveHerb(e,o.fhSupportSpent,o.characterSpent))}),t.nrm(1,"img",27),t.k0s()}}function df(a,r){if(1&a&&(t.nVh(0,gf,2,0,"a",24),t.j41(1,"span",23),t.EFF(2),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG();t.vxM(i.fhSupportSpent[n]&&(i.character.progress.loot[n]||0)>(i.characterSpent[n]||0)?0:-1),t.R7$(),t.Y8G("ghs-label","game.loot.")("ghs-label-attribute","title"),t.R7$(),t.Lme(" ",i.fhSupportSpent[n]||"-"," / ",i.gameManager.game.party.loot[n]||0," ")}}function hf(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function _f(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",19),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.toggleHerb(e,0))}),t.nrm(1,"img",20),t.k0s(),t.j41(2,"span",19),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.toggleHerb(e,1))}),t.nrm(3,"img",20),t.k0s(),t.nVh(4,sf,2,6,"span",21),t.j41(5,"span",22),t.nVh(6,cf,3,5),t.nVh(7,lf,2,0,"span"),t.k0s(),t.j41(8,"span",22),t.nVh(9,df,3,5),t.nVh(10,hf,2,0,"span"),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.sMw(9,xi,i.receipe.length>0&&i.receipe[0]==n,i.receipe[0]!=n&&0==(i.character.progress.loot[n]||0)&&0==(i.gameManager.game.party.loot[n]||0),i.receipe[0]!=n&&((i.characterSpent[n]||0)>0||(i.fhSupportSpent[n]||0)>0)&&(i.character.progress.loot[n]||0)<=(i.characterSpent[n]||0)&&(i.gameManager.game.party.loot[n]||0)<=(i.fhSupportSpent[n]||0))),t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+n+".svg",t.B4B),t.R7$(),t.Y8G("ngClass",t.sMw(13,xi,i.receipe.length>1&&i.receipe[1]==n,i.receipe[1]!=n&&0==(i.character.progress.loot[n]||0)&&0==(i.gameManager.game.party.loot[n]||0),i.receipe[1]!=n&&((i.characterSpent[n]||0)>0||(i.fhSupportSpent[n]||0)>0)&&(i.character.progress.loot[n]||0)<=(i.characterSpent[n]||0)&&(i.gameManager.game.party.loot[n]||0)<=(i.fhSupportSpent[n]||0))),t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+n+".svg",t.B4B),t.R7$(),t.vxM(3==i.brewing?4:-1),t.R7$(2),t.vxM(i.character.progress.loot[n]?6:-1),t.R7$(),t.vxM(i.character.progress.loot[n]?-1:7),t.R7$(2),t.vxM(i.gameManager.game.party.loot[n]?9:-1),t.R7$(),t.vxM(i.gameManager.game.party.loot[n]?-1:10)}}function mf(a,r){if(1&a&&t.nrm(0,"img",20),2&a){const n=t.XpG().$implicit;t.Y8G("src","./assets/images/fh/loot/"+n+".svg",t.B4B)}}function pf(a,r){1&a&&t.nrm(0,"img",29)}function uf(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"+"),t.k0s())}function ff(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",28),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.removeHerb(e,!1))}),t.nVh(1,mf,1,1,"img",20),t.nVh(2,pf,1,0,"img",29),t.nVh(3,uf,2,0,"span"),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG();t.R7$(),t.vxM(n?1:-1),t.R7$(),t.vxM(n?-1:2),t.R7$(),t.vxM(i<e.receipe.length-1?3:-1)}}function Cf(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"="),t.k0s())}function Mf(a,r){if(1&a&&t.nrm(0,"span",12),2&a){const n=t.XpG();t.Y8G("ghs-label","game.items.brewing.item")("ghs-label-args",t.l_i(2,gs,n.item.id,n.item.name))}}function vf(a,r){if(1&a&&t.nrm(0,"span",12),2&a){const n=t.XpG();t.Y8G("ghs-label","game.items.brewing.item")("ghs-label-args",t.l_i(2,gs,n.brewed.id,n.brewed.name))}}function Of(a,r){1&a&&(t.j41(0,"span",11),t.nrm(1,"img",29),t.k0s())}function Pf(a,r){if(1&a&&(t.j41(0,"div",10),t.nrm(1,"span",12),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","game.items.brewing.brewed"+(n.otherCharacter?"Other":""))("ghs-label-args",t.ziG(2,tf,n.brewed.id,n.brewed.name,n.gameManager.characterManager.characterName(n.character,!0),n.otherCharacter?n.gameManager.characterManager.characterName(n.otherCharacter,!0):""))}}function bf(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",33),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.otherCharacter=e)}),t.nrm(1,"img",34),t.j41(2,"span",35),t.EFF(3),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.eq3(3,nf,i.otherCharacter==n)),t.R7$(),t.Y8G("src",n.iconUrl,t.B4B),t.R7$(2),t.SpI(" ",i.gameManager.characterManager.characterName(n,!0)," ")}}function kf(a,r){if(1&a&&(t.j41(0,"div",10),t.nrm(1,"span",30),t.k0s(),t.j41(2,"div",31),t.Z7z(3,bf,4,5,"div",32,ef),t.nI1(5,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","game.items.brewing.selectCharacter"),t.R7$(2),t.Dyx(t.bMT(5,1,n.otherCharacters))}}function yf(a,r){1&a&&(t.j41(0,"div",10),t.nrm(1,"span",36),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","game.items.brewing.noChar"))}function xf(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",13)(1,"ghs-item",37),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openItemDialog())}),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("item",n.brewed||n.item)("flipped",!0)}}let ds=(()=>{class a{character;dialogRef;dialog;ghsManager;gameManager=s.E;settingsManager=p.f;herbs=[rt.r6.arrowvine,rt.r6.axenut,rt.r6.corpsecap,rt.r6.flamefruit,rt.r6.rockroot,rt.r6.snowthistle];brewing;characterSpent={};fhSupportSpent={};receipe=[void 0,void 0];item;brewed;otherCharacters=[];otherCharacter;noChar=!1;constructor(n,i,e,o){if(this.character=n,this.dialogRef=i,this.dialog=e,this.ghsManager=o,this.brewing=0,s.E.fhRules()&&s.E.game.party.campaignMode&&s.E.game.party.buildings){const g=s.E.game.party.buildings.find(m=>"alchemist"==m.name);g&&g.level&&(this.brewing=g.level<3?2:3)}}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.updateItem()}),this.updateItem()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}updateItem(){const n=this.getItem();this.item=n&&s.E.game.party.unlockedItems.find(i=>i.name==""+n.id&&i.edition==n.edition)&&n,this.brewed=void 0,this.otherCharacters=[],this.otherCharacter=void 0,this.noChar=!1}addHerb(n,i,e=-1){n&&(i||(this.character.progress.loot[n]&&(this.character.progress.loot[n]||0)>(this.characterSpent[n]||0)?i=this.characterSpent:s.E.game.party.loot[n]&&(s.E.game.party.loot[n]||0)>(this.fhSupportSpent[n]||0)&&(i=this.fhSupportSpent)),i&&(i[n]=(i[n]||0)+1,this.receipe[e>-1?e:this.receipe.length]=n)),this.updateItem()}removeHerb(n,i,e=-1){this.receipe[e>-1?e:this.receipe.indexOf(n)]=void 0,2==e&&this.receipe.splice(2,1),n&&(i||(i=this.fhSupportSpent[n]?this.fhSupportSpent:this.characterSpent),i[n]=(i[n]||1)-1),this.updateItem()}toggleHerb(n,i){const e=this.receipe[i]!=n;this.receipe[i]&&this.removeHerb(this.receipe[i],!1,i),e&&((this.character.progress.loot[n]||0)<=(this.characterSpent[n]||0)&&(s.E.game.party.loot[n]||0)<=(this.fhSupportSpent[n]||0)&&this.removeHerb(n,!1),this.addHerb(n,!1,i))}moveHerb(n,i,e){i[n]=(i[n]||1)-1,e[n]=(e[n]||0)+1}brew(n=!1){(!s.E.itemManager.brewingDisabled()||n)&&(this.brewed=this.getItem(),this.brewed&&(this.otherCharacter?this.brewInternal(this.otherCharacter,this.brewed):this.character.progress.items.find(i=>this.brewed&&i.name==""+this.brewed.id&&i.edition==this.brewed.edition)?(this.otherCharacters=s.E.game.figures.filter(i=>i instanceof H.K&&i!=this.character&&!i.progress.items.find(e=>this.brewed&&e.name==""+this.brewed.id&&e.edition==this.brewed.edition)).map(i=>i),this.noChar=0==this.otherCharacters.length,1==this.otherCharacters.length&&(this.otherCharacter=this.otherCharacters[0])):(this.brewInternal(this.character,this.brewed),this.otherCharacters=[],this.otherCharacter=void 0,this.noChar=!1)))}brewInternal(n,i){this.otherCharacter=n!=this.character?n:void 0,s.E.stateManager.before(this.otherCharacter?"brewPotionOther":"brewPotion",s.E.characterManager.characterName(this.character),i.id,i.edition,this.otherCharacter?s.E.characterManager.characterName(this.otherCharacter):""),this.herbs.forEach(e=>{this.fhSupportSpent[e]&&(s.E.game.party.loot[e]=(s.E.game.party.loot[e]||0)-(this.fhSupportSpent[e]||0)),this.characterSpent[e]&&(this.character.progress.loot[e]=(this.character.progress.loot[e]||0)-(this.characterSpent[e]||0))}),s.E.game.party.unlockedItems.find(e=>e.name==""+i.id&&e.edition==i.edition)||s.E.game.party.unlockedItems.push(new yt.VP(""+i.id,i.edition)),n.progress.items.push(new yt.gw(""+i.id,i.edition)),s.E.stateManager.after(),this.brewed=i,this.otherCharacter=n!=this.character?n:void 0}getItem(){if(this.receipe[0]&&this.receipe[1])return this.receipe.filter((n,i,e)=>n&&e.indexOf(n)==i).length!=this.receipe.filter(n=>n).length?s.E.itemManager.getItems(s.E.currentEdition(),!0).find(n=>!(n.requiredItems&&n.requiredItems.length||"alchemist"!=n.requiredBuilding||!(this.receipe[2]?n.requiredBuildingLevel>=3:n.requiredBuildingLevel<3)||n.resources)):s.E.itemManager.getItems(s.E.currentEdition(),!0).find(n=>(!n.requiredItems||!n.requiredItems.length)&&"alchemist"==n.requiredBuilding&&(this.receipe[2]?n.requiredBuildingLevel>=3:n.requiredBuildingLevel<3)&&n.resources&&this.herbs.every(i=>n.resources&&this.receipe.filter(e=>e==i).length==(n.resources[i]||0)))}openItemDialog(){this.dialog.open(fn,{panelClass:["fullscreen-panel"],disableClose:!0,data:{item:this.brewed||this.item}})}close(){(0,F.co)(this.dialogRef)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-items-brew"]],standalone:!1,decls:33,vars:35,consts:[[1,"items-brew-dialog",3,"ngClass"],[1,"scroll-container"],[1,"title"],[3,"ghs-label"],[1,"brewing-disabled"],[1,"table"],[1,"head-col","first"],[1,"first"],[1,"icon","character-icon",3,"src"],[1,"name",3,"ngClass"],[1,"receipe"],[1,"herb"],[1,"placeholder","text-white","item",3,"ghs-label","ghs-label-args"],[1,"brewed"],[1,"menu"],[1,"cancel",3,"click"],["ghs-pointer-input","",1,"apply",3,"singleClick","doubleClick","ngClass"],[3,"ghs-label","ghs-label-args"],["src","./assets/images/close.svg"],[1,"head-col","calc-col","toggle",3,"click","ngClass"],[1,"ghs-svg",3,"src"],[1,"head-col","calc-col","toggle",3,"ngClass"],[1,"calc-col"],[1,"value",3,"ghs-label","ghs-label-attribute"],[1,"button"],[1,"button",3,"click"],["src","./assets/images/right.svg",1,"ghs-svg"],["src","./assets/images/left.svg",1,"ghs-svg"],[1,"herb",3,"click"],["src","./assets/images/fh/loot/unknown.svg",1,"ghs-svg"],[1,"placeholder","text-white","item",3,"ghs-label"],[1,"characters"],[1,"character",3,"ngClass"],[1,"character",3,"click","ngClass"],[1,"icon",3,"src"],[1,"name"],[1,"placeholder","item","already",3,"ghs-label"],[3,"click","item","flipped"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"label",2),t.nrm(3,"span",3),t.nVh(4,af,3,1,"span",4),t.k0s(),t.j41(5,"div",5),t.Z7z(6,of,2,1,"span",6,t.fX1),t.nI1(8,"ghsRange"),t.j41(9,"span",7),t.nrm(10,"img",8),t.j41(11,"span",9),t.EFF(12),t.k0s()(),t.j41(13,"span",7),t.nrm(14,"span",3),t.k0s(),t.Z7z(15,_f,11,17,null,null,t.fX1),t.k0s(),t.j41(17,"div",10),t.Z7z(18,ff,4,3,"span",11,t.fX1),t.nVh(20,Cf,2,0,"span"),t.nVh(21,Mf,1,5,"span",12),t.nVh(22,vf,1,5,"span",12),t.nVh(23,Of,2,0,"span",11),t.k0s(),t.nVh(24,Pf,2,7,"div",10),t.nVh(25,kf,6,3),t.nVh(26,yf,2,1,"div",10),t.nVh(27,xf,2,2,"div",13),t.j41(28,"div",14)(29,"a",15),t.bIt("click",function(){return e.close()}),t.nrm(30,"span",3),t.k0s(),t.j41(31,"a",16),t.bIt("singleClick",function(){return e.brew()})("doubleClick",function(){return e.brew(!0)}),t.nrm(32,"span",17),t.k0s()()()()),2&i&&(t.Y8G("ngClass",t.l_i(24,Ku,"fh"==e.settingsManager.settings.theme,"modern"==e.settingsManager.settings.theme)),t.R7$(3),t.Y8G("ghs-label","game.items.brewing"),t.R7$(),t.vxM(e.gameManager.itemManager.brewingDisabled()?4:-1),t.R7$(),t.xc7("--ghs-summary-columns",2+e.brewing),t.R7$(),t.Dyx(t.i5U(8,21,t.lJ4(27,Wu),e.brewing)),t.R7$(4),t.Y8G("src",e.character.iconUrl,t.B4B),t.R7$(),t.Y8G("ngClass",t.eq3(28,Zu,e.character.absent)),t.R7$(),t.SpI(" ",e.gameManager.characterManager.characterName(e.character)," "),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.supply"),t.R7$(),t.Dyx(e.herbs),t.R7$(3),t.Dyx(e.receipe),t.R7$(2),t.vxM(!e.brewed||e.otherCharacters.length>0||e.noChar?20:-1),t.R7$(),t.vxM(!e.item||e.brewed&&!e.noChar?-1:21),t.R7$(),t.vxM(e.brewed&&e.otherCharacters.length>0?22:-1),t.R7$(),t.vxM(e.item||e.brewed?-1:23),t.R7$(),t.vxM(e.brewed&&0==e.otherCharacters.length&&!e.noChar?24:-1),t.R7$(),t.vxM(e.brewed&&e.otherCharacters.length>0?25:-1),t.R7$(),t.vxM(e.noChar?26:-1),t.R7$(),t.vxM(e.brewed||e.item?27:-1),t.R7$(3),t.Y8G("ghs-label","cancel"),t.R7$(),t.Y8G("ngClass",t.l_i(30,Ju,e.noChar||e.brewed&&(0==e.otherCharacters.length||!e.otherCharacter)||e.receipe.length<2||!e.receipe[0]||!e.receipe[1],e.gameManager.itemManager.brewingDisabled())),t.R7$(),t.Y8G("ghs-label","game.items.brewing.brew"+(e.otherCharacter?"For":""))("ghs-label-args",t.eq3(33,Qu,e.otherCharacter?e.gameManager.characterManager.characterName(e.otherCharacter,!0):"")))},dependencies:[N.YU,it,Vn,dt,At,ct],styles:[".items-brew-dialog[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto;margin:0 .3em}.items-brew-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.items-brew-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline);margin-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.items-brew-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .brewing-disabled[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white);margin:.5em}.items-brew-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .brewing-disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:0 .2em;height:1em;width:auto;filter:var(--ghs-filter-red)}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]{--ghs-summary-columns: 5;font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));display:grid;grid-template-columns:repeat(var(--ghs-summary-columns),auto);padding-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));color:var(--ghs-color-white);overflow:auto}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-white)}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;text-align:center;padding:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));border-bottom:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-white);border-right:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-darkgray)}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-weight:700;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));flex-direction:row;justify-content:flex-end;background-image:url(dialog_background.fa4ff388462f6a00.png);position:sticky;left:0;z-index:1}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col.calc-col[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:.6}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]{cursor:pointer}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray);opacity:.6}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .toggle.active[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .toggle.spent[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow);opacity:.6}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .toggle.disabled[_ngcontent-%COMP%]{pointer-events:none}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .toggle.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);opacity:.4}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .calc-col[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:.6}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .first[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);border-top:none}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--ghs-color-white);display:flex;justify-content:center;align-items:center;padding:0 .15em;white-space:nowrap}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;padding:0 .15em}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1em;width:auto}.items-brew-dialog.fh[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.items-brew-dialog.modern[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.items-brew-dialog[_ngcontent-%COMP%]   .receipe[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));color:var(--ghs-color-white)}.items-brew-dialog[_ngcontent-%COMP%]   .receipe[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]{display:flex;align-items:center}.items-brew-dialog[_ngcontent-%COMP%]   .receipe[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));filter:var(--ghs-filter-white)}.items-brew-dialog[_ngcontent-%COMP%]   .receipe[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{margin-left:.5em}.items-brew-dialog[_ngcontent-%COMP%]   .receipe[_ngcontent-%COMP%]   .already[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.items-brew-dialog[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%}.items-brew-dialog[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;margin:.25em;padding:.25em;border:1px solid transparent}.items-brew-dialog[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline)}.items-brew-dialog[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:1.5em;height:auto;margin-right:.2em;filter:grayscale(.7)}.items-brew-dialog[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]:hover{color:var(--ghs-color-darkgray);border-color:var(--ghs-color-darkgray)}.items-brew-dialog[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]:hover   .icon[_ngcontent-%COMP%]{filter:grayscale(.3)}.items-brew-dialog[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character.selected[_ngcontent-%COMP%]{color:var(--ghs-color-white);border-color:var(--ghs-color-gray)}.items-brew-dialog[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character.selected[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{filter:none}.items-brew-dialog[_ngcontent-%COMP%]   .brewed[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:100%}.items-brew-dialog[_ngcontent-%COMP%]   .brewed[_ngcontent-%COMP%]   ghs-item[_ngcontent-%COMP%]{position:relative;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 27 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 40.5 * var(--ghs-dialog-factor))}.items-brew-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center}.items-brew-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:2em;padding:.3em}.items-brew-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.items-brew-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.items-brew-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.items-brew-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}.items-brew-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.unavailable[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-gray)}.items-brew-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.unavailable[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}"]})}return a})();const hs=a=>[a],Ef=a=>({disabled:a}),wf=a=>({selected:a});function Rf(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",12),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.toggleSelected(e))}),t.nrm(1,"img",13),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(2,wf,n==i.selectedResource)),t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+n+".svg",t.B4B)}}let _s=(()=>{class a{data;dialogRef;availableResources=[];selectedResource;character;item;constructor(n,i){this.data=n,this.dialogRef=i,this.character=n.character,this.item=n.item,s.E.itemManager.canDistill(this.item)?this.availableResources=this.item.resourcesAny&&this.item.resourcesAny.length?rt.Pr:Object.keys(this.item.resources).map(e=>e):this.dialogRef.close()}toggleSelected(n){this.selectedResource=this.selectedResource==n?void 0:n}close(){(0,F.co)(this.dialogRef)}distill(){this.selectedResource&&(s.E.stateManager.before("distillItem",s.E.characterManager.characterName(this.character),this.item.id,this.item.edition),s.E.itemManager.removeItem(this.item,this.character),this.character.progress.loot[this.selectedResource]=(this.character.progress.loot[this.selectedResource]||0)+1,s.E.stateManager.after(),(0,F.co)(this.dialogRef))}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-item-distill-dialog"]],standalone:!1,decls:13,vars:15,consts:[[1,"item-distill-dialog"],[1,"header"],[1,"title",3,"ghs-label","ghs-label-args"],[1,"item"],[3,"item","reveal","flipped"],[1,"resources"],[1,"resource",3,"ngClass"],[1,"menu"],[1,"cancel",3,"click"],[3,"ghs-label"],["ghs-pointer-input","",1,"apply",3,"singleClick","ngClass"],[3,"ghs-label","ghs-label-args"],[1,"resource",3,"click","ngClass"],[1,"ghs-svg",3,"src"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"span",2),t.k0s(),t.j41(3,"div",3),t.nrm(4,"ghs-item",4),t.k0s(),t.j41(5,"div",5),t.Z7z(6,Rf,2,4,"div",6,t.fX1),t.k0s(),t.j41(8,"div",7)(9,"a",8),t.bIt("click",function(){return e.close()}),t.nrm(10,"span",9),t.k0s(),t.j41(11,"a",10),t.bIt("singleClick",function(){return e.distill()}),t.nrm(12,"span",11),t.k0s()()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","game.items.distilling")("ghs-label-args",t.eq3(9,hs,"data.items."+e.item.edition+"-"+e.item.id)),t.R7$(2),t.Y8G("item",e.item)("reveal",!0)("flipped",!0),t.R7$(2),t.Dyx(e.availableResources),t.R7$(4),t.Y8G("ghs-label","cancel"),t.R7$(),t.Y8G("ngClass",t.eq3(11,Ef,!e.selectedResource)),t.R7$(),t.Y8G("ghs-label",e.selectedResource?"game.items.distilling.distill":"game.items.distilling.select")("ghs-label-args",t.eq3(13,hs,""+e.selectedResource)))},dependencies:[N.YU,it,Vn,dt],styles:[".item-distill-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.item-distill-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.item-distill-dialog[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{display:flex;justify-content:center}.item-distill-dialog[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ghs-item[_ngcontent-%COMP%]{display:block;position:relative;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 27 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 40.5 * var(--ghs-dialog-factor));transition:all calc(var(--ghs-animation-speed) * .5s) ease-in-out}.item-distill-dialog[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.item-distill-dialog[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]{cursor:pointer}.item-distill-dialog[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray);width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:auto}.item-distill-dialog[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource.selected[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.item-distill-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center}.item-distill-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:1.5em;padding:.3em}.item-distill-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.item-distill-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.item-distill-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.item-distill-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}"]})}return a})();const jf=(a,r)=>({fh:a,modern:r}),Ei=(a,r)=>[a,r],Gf=a=>({management:a}),wi=a=>({disabled:a}),ms=a=>({selected:a}),Ri=a=>[a],ps=()=>[],Tf=(a,r,n,i,e)=>({selected:a,disabled:r,filtered:n,unavailable:i,owned:e}),Sf=a=>({equipped:a}),us=(a,r)=>r._trackUUID;function Df(a,r){1&a&&t.nrm(0,"span",3),2&a&&t.Y8G("ghs-label","game.items.shop")}function $f(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",17),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openItems())}),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ghs-label","game.items.shop.character")("ghs-label-args",t.l_i(3,Ei,n.character.name,n.gameManager.characterManager.characterName(n.character)))("ngClass",t.eq3(6,Gf,n.character.progress.items&&n.character.progress.items.length))}}function If(a,r){if(1&a&&(t.j41(0,"span",22),t.nrm(1,"img",31),t.EFF(2),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.SpI(" ",n.character.progress.loot.lumber," ")}}function Af(a,r){if(1&a&&(t.j41(0,"span",23),t.nrm(1,"img",32),t.EFF(2),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.SpI(" ",n.character.progress.loot.metal," ")}}function Vf(a,r){if(1&a&&(t.j41(0,"span",24),t.nrm(1,"img",33),t.EFF(2),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.SpI(" ",n.character.progress.loot.hide," ")}}function Ff(a,r){if(1&a&&(t.j41(0,"span",25),t.nrm(1,"img",34),t.EFF(2),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.SpI(" ",n.character.progress.loot.arrowvine," ")}}function Xf(a,r){if(1&a&&(t.j41(0,"span",26),t.nrm(1,"img",35),t.EFF(2),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.SpI(" ",n.character.progress.loot.axenut," ")}}function Bf(a,r){if(1&a&&(t.j41(0,"span",27),t.nrm(1,"img",36),t.EFF(2),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.SpI(" ",n.character.progress.loot.corpsecap," ")}}function Yf(a,r){if(1&a&&(t.j41(0,"span",28),t.nrm(1,"img",37),t.EFF(2),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.SpI(" ",n.character.progress.loot.flamefruit," ")}}function Uf(a,r){if(1&a&&(t.j41(0,"span",29),t.nrm(1,"img",38),t.EFF(2),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.SpI(" ",n.character.progress.loot.rockroot," ")}}function Nf(a,r){if(1&a&&(t.j41(0,"span",30),t.nrm(1,"img",39),t.EFF(2),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.SpI(" ",n.character.progress.loot.snowthistle," ")}}function zf(a,r){if(1&a&&(t.j41(0,"div",20),t.nVh(1,If,3,1,"span",22),t.nVh(2,Af,3,1,"span",23),t.nVh(3,Vf,3,1,"span",24),t.nVh(4,Ff,3,1,"span",25),t.nVh(5,Xf,3,1,"span",26),t.nVh(6,Bf,3,1,"span",27),t.nVh(7,Yf,3,1,"span",28),t.nVh(8,Uf,3,1,"span",29),t.nVh(9,Nf,3,1,"span",30),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.vxM(n.character.progress.loot.lumber?1:-1),t.R7$(),t.vxM(n.character.progress.loot.metal?2:-1),t.R7$(),t.vxM(n.character.progress.loot.hide?3:-1),t.R7$(),t.vxM(n.character.progress.loot.arrowvine?4:-1),t.R7$(),t.vxM(n.character.progress.loot.axenut?5:-1),t.R7$(),t.vxM(n.character.progress.loot.corpsecap?6:-1),t.R7$(),t.vxM(n.character.progress.loot.flamefruit?7:-1),t.R7$(),t.vxM(n.character.progress.loot.rockroot?8:-1),t.R7$(),t.vxM(n.character.progress.loot.snowthistle?9:-1)}}function Lf(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",40),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.brewDialog())})("doubleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.brewDialog(!0))}),t.nrm(1,"img",41)(2,"span",12),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(2,wi,n.gameManager.itemManager.brewingDisabled())),t.R7$(2),t.Y8G("ghs-label","game.items.brewing")}}function qf(a,r){if(1&a&&(t.j41(0,"div",5)(1,"span",18),t.nrm(2,"img",19),t.EFF(3),t.k0s(),t.nVh(4,zf,10,9,"div",20),t.nVh(5,Lf,3,4,"a",21),t.k0s()),2&a){const n=t.XpG();t.R7$(2),t.Y8G("src","./assets/images/"+(n.settingsManager.settings.fhStyle?"fh/":"")+"loot.svg",t.B4B),t.R7$(),t.JRh(n.character.progress.gold),t.R7$(),t.vxM(n.gameManager.fhRules()?4:-1),t.R7$(),t.vxM(n.brewing?5:-1)}}function Hf(a,r){1&a&&t.nrm(0,"img",42)(1,"span",12),2&a&&(t.R7$(),t.Y8G("ghs-label","game.items.shop.buyingDisabled"))}function Kf(a,r){1&a&&t.nrm(0,"img",42)(1,"span",12),2&a&&(t.R7$(),t.Y8G("ghs-label","game.items.shop.craftingDisabled"))}function Wf(a,r){if(1&a&&(t.j41(0,"div",6),t.nVh(1,Hf,2,1),t.nVh(2,Kf,2,1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.vxM(n.gameManager.itemManager.buyingDisabled()&&n.character&&!n.character.tags.includes("new-character")?1:-1),t.R7$(),t.vxM(n.gameManager.itemManager.craftingDisabled()?2:-1)}}function Zf(a,r){if(1&a){const n=t.RV6();t.j41(0,"label",43),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.toggleItemSlotFilter(e))})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.toggleItemSlotFilter(e,!0))}),t.nrm(1,"img",44),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(2,ms,i.itemSlots.includes(n))),t.R7$(),t.Y8G("src","./assets/images/items/slots/"+n+".svg",t.B4B)}}function Jf(a,r){if(1&a){const n=t.RV6();t.j41(0,"label",43),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleItemSlotFilter("undefined"))})("doubleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleItemSlotFilter("undefined",!0))}),t.nrm(1,"img",45),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(1,ms,n.itemSlots.includes("undefined")))}}function Qf(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",11),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2);return t.DH7(o.affordable,e)||(o.affordable=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.update(!0))}),t.k0s(),t.nrm(2,"span",12),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(),t.R50("ngModel",n.affordable),t.R7$(),t.Y8G("ghs-label","game.items.filter.affordable")}}function tC(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",11),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2);return t.DH7(o.owned,e)||(o.owned=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.update(!0))}),t.k0s(),t.nrm(2,"span",12),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(),t.R50("ngModel",n.owned),t.R7$(),t.Y8G("ghs-label","game.items.filter.owned")}}function nC(a,r){if(1&a){const n=t.RV6();t.nVh(0,Qf,3,2,"label"),t.nVh(1,tC,3,2,"label"),t.j41(2,"label")(3,"input",11),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.sorted,e)||(o.sorted=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.update(!0))}),t.k0s(),t.nrm(4,"span",12),t.k0s()}if(2&a){const n=t.XpG();t.vxM(n.owned?-1:0),t.R7$(),t.vxM(n.affordable||n.all?-1:1),t.R7$(2),t.R50("ngModel",n.sorted),t.R7$(),t.Y8G("ghs-label","game.items.filter.sorted")}}function eC(a,r){if(1&a){const n=t.RV6();t.j41(0,"label",46)(1,"input",47),t.bIt("change",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.setEdition(e))}),t.k0s(),t.nrm(2,"span",12),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.eq3(3,wi,i.currentEdition==n)),t.R7$(),t.Y8G("checked",i.currentEdition==n),t.R7$(),t.Y8G("ghs-label","data.edition."+n)}}function aC(a,r){if(1&a&&(t.j41(0,"div",13),t.Z7z(1,eC,3,5,"label",46,t.fX1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(n.editions)}}function iC(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",53),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.addItem(e.selected,!0))}),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","game.items.add")("ghs-label-args",n.selected?t.eq3(2,Ri,"data.items."+n.selected.edition+"-"+n.selected.id):t.lJ4(4,ps))}}function oC(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",54),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(!!e.selected&&(e.selected.cost?e.buyItem(e.selected):e.craftItem(e.selected)))}),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(3,wi,!n.selected||!n.gameManager.itemManager.canBuy(n.selected,n.character)&&!n.gameManager.itemManager.canCraft(n.selected,n.character)))("ghs-label","game.items."+(n.selected?n.selected.cost?"buy":"craft":"choose"))("ghs-label-args",n.selected?t.l_i(5,Ei,"data.items."+n.selected.edition+"-"+n.selected.id,n.selected.cost+n.gameManager.itemManager.pricerModifier()):t.lJ4(8,ps))}}function sC(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",53),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.removeItem(e.selected))}),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","game.items.remove")("ghs-label-args",t.eq3(2,Ri,"data.items."+n.selected.edition+"-"+n.selected.id))}}function rC(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",55),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.sellItem(e.selected))}),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","game.items.sell")("ghs-label-args",t.l_i(2,Ei,"data.items."+n.selected.edition+"-"+n.selected.id,n.gameManager.itemManager.itemSellValue(n.selected)))}}function cC(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",56),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.distillItem(e.selected))}),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","game.items.distilling")("ghs-label-args",t.eq3(2,Ri,"data.items."+n.selected.edition+"-"+n.selected.id))}}function lC(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",14)(1,"a",48),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.close())}),t.k0s(),t.nVh(2,iC,1,5,"a",49),t.nVh(3,oC,1,9,"a",50),t.nVh(4,sC,1,4,"a",49),t.nVh(5,rC,1,5,"a",51),t.nVh(6,cC,1,4,"a",52),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","cancel"),t.R7$(),t.vxM(n.selected&&!n.gameManager.itemManager.owned(n.selected,n.character)?2:-1),t.R7$(),t.vxM(!n.selected||(n.selected.cost||n.selected.resources||n.selected.requiredItems)&&!n.gameManager.itemManager.owned(n.selected,n.character)?3:-1),t.R7$(),t.vxM(n.selected&&n.gameManager.itemManager.owned(n.selected,n.character)?4:-1),t.R7$(),t.vxM(n.selected&&n.gameManager.itemManager.owned(n.selected,n.character)?5:-1),t.R7$(),t.vxM(n.selected&&n.gameManager.itemManager.owned(n.selected,n.character)&&n.gameManager.itemManager.canDistill(n.selected)?6:-1)}}function gC(a,r){1&a&&(t.j41(0,"div",15)(1,"div",57),t.nrm(2,"span",12),t.k0s()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","game.items.empty"))}function dC(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-item",63),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.select(e))})("doubleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.select(e,!0))}),t.k0s()}if(2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG();t.Y8G("item",i)("flipped",!0)("count",o.character?o.itemsMeta[e].countAvailable<1?"-":o.itemsMeta[e].assigned+1:1)("editionLabel",o.currentEdition)("ngClass",t.s1E(5,Tf,i==o.selected,!o.character,!o.itemsMeta[e].canAdd,(i.cost||i.resources)&&!o.itemsMeta[e].canBuy&&!o.itemsMeta[e].canCraft,o.itemsMeta[e].owned))}}function hC(a,r){if(1&a&&t.nrm(0,"ghs-item",60),2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG();t.Y8G("item",i)("flipped",!0)("count",o.character?o.itemsMeta[e].countAvailable<1?"-":o.itemsMeta[e].assigned+1:1)("editionLabel",o.currentEdition)}}function _C(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",64),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.removeUnlocked(e))}),t.nrm(1,"img",65),t.k0s()}}function mC(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",66),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.toggleEquippedItem(e))})("doubleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.toggleEquippedItem(e,!0))}),t.nrm(1,"img",67),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(1,Sf,i.gameManager.itemManager.isEquipped(n,i.character)))}}function pC(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",16)(1,"img",58),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.openItemDialog(e))}),t.k0s(),t.nVh(2,dC,1,11,"ghs-item",59),t.nVh(3,hC,1,4,"ghs-item",60),t.nVh(4,_C,2,0,"a",61),t.nVh(5,mC,2,3,"a",62),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.R7$(2),t.vxM(i.character?2:-1),t.R7$(),t.vxM(i.character&&i.select?-1:3),t.R7$(),t.vxM(!i.all&&i.unlocked(n)?4:-1),t.R7$(),t.vxM(i.character&&i.gameManager.itemManager.owned(n,i.character)?5:-1)}}function uC(a,r){1&a&&t.nrm(0,"span",69),2&a&&t.Y8G("ghs-label","game.items.unlock")}function fC(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",64),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.removeUnlocked(e))}),t.nrm(1,"img",65),t.k0s()}}function CC(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",16)(1,"ghs-item",68),t.bIt("revealed",function(e){const o=c.eBV(n).$implicit,g=t.XpG();return c.Njj(g.unlockItemReveal(o,e))}),t.k0s(),t.nVh(2,uC,1,1,"span",69),t.nVh(3,fC,2,0,"a",61),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.R7$(),t.Y8G("item",n)("reveal",!0)("flipped",i.unlocked(n))("editionLabel",i.currentEdition),t.R7$(),t.vxM(i.unlocked(n)?-1:2),t.R7$(),t.vxM(!i.all&&i.unlocked(n)?3:-1)}}let Le=(()=>{class a{data;dialogRef;dialog;ghsManager;gameManager=s.E;settingsManager=p.f;edition;currentEdition;editions;editionItems=[];items=[];itemsMeta=[];selected;character;filter="";all=!1;owned=!1;affordable=!1;sorted=!1;itemSlots=[];itemSlotUndefined=!1;unlocks=[];campaignMode=!1;brewing=0;ItemSlot=Object.values(wt.o8);constructor(n,i,e,o){this.data=n,this.dialogRef=i,this.dialog=e,this.ghsManager=o,this.selected=void 0,this.character=n.select,this.sorted=null!=this.character&&this.character.progress.items.length>0,this.edition=n.edition,this.affordable=n.affordable||!1,this.campaignMode=this.edition&&s.E.game.party.campaignMode||!1,this.editions=this.edition?s.E.itemManager.itemEditions(this.edition):s.E.itemManager.itemEditions(),this.all=null==this.edition,this.currentEdition=this.edition||this.editions[0]}ngOnInit(){this.updateEditionItems(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}setEdition(n){this.currentEdition=n,this.updateEditionItems()}updateEditionItems(){this.editions=this.all?s.E.itemManager.itemEditions():this.edition&&!this.campaignMode?s.E.itemManager.itemEditions(this.edition):[],this.editions.includes(this.currentEdition)||(this.currentEdition=this.edition||this.editions[0]),this.editionItems=this.edition&&this.campaignMode&&!this.all?s.E.itemManager.getItems(this.edition):s.E.itemManager.getItems(this.currentEdition,this.all).filter(n=>n.edition==this.currentEdition),this.all&&(this.sorted=!1),this.update()}brewDialog(n=!1){(!s.E.itemManager.brewingDisabled()||n)&&this.dialog.open(ds,{panelClass:["dialog"],data:this.character})}update(n=!1){if(this.unlocks=[],this.selected=void 0,this.items=this.editionItems.filter(i=>!this.affordable||s.E.itemManager.assigned(i)<i.count).filter(i=>!this.affordable||this.character&&s.E.itemManager.canAdd(i,this.character)&&(s.E.itemManager.canBuy(i,this.character)||s.E.itemManager.canCraft(i,this.character))),this.character&&this.edition&&this.campaignMode&&!this.all&&!this.affordable&&this.character.progress.items.forEach(i=>{if(i.edition==this.edition&&!this.items.find(e=>e.id==+i.name&&e.edition==i.edition)){const e=s.E.itemManager.getItem(i.name,i.edition,!0);e&&this.items.push(e)}}),this.items=this.items.filter(i=>!this.filter||(0,F.oB)(i.name,this.filter)||(0,F.oB)(p.f.getLabel("data.items."+i.edition+"-"+i.id),this.filter)||(0,F.oB)(("number"==typeof i.id&&i.id<100?"0":"")+("number"==typeof i.id&&i.id<10?"0":"")+i.id,this.filter)),this.itemSlotUndefined=null!=this.items.find(i=>!i.slot),this.itemSlotUndefined||(this.itemSlots=this.itemSlots.filter(i=>"undefined"!=i)),this.itemSlots.length>0&&(this.items=this.items.filter(i=>i.slot&&this.itemSlots.includes(i.slot)||!i.slot&&this.itemSlots.includes("undefined"))),this.campaignMode&&this.edition&&!this.all&&!this.affordable&&(this.unlocks=s.E.itemManager.getItems(this.edition,!0).filter(i=>(""+i.id==this.filter||"0"+i.id==this.filter||"00"+i.id==this.filter)&&!this.items.find(e=>e.id==i.id&&e.edition==i.edition))),!n&&this.affordable&&0==this.items.length)this.affordable=!1,this.sorted=null!=this.character&&this.character.progress.items.length>0,this.update();else{if(this.itemsMeta=[],this.character&&(this.owned&&!this.all&&(this.items=this.items.filter(i=>!!this.character&&s.E.itemManager.owned(i,this.character))),this.items.forEach(i=>{this.character&&this.itemsMeta.push({edition:i.edition,id:i.id,canAdd:s.E.itemManager.canAdd(i,this.character),canBuy:s.E.itemManager.canBuy(i,this.character),canCraft:s.E.itemManager.canCraft(i,this.character),owned:s.E.itemManager.owned(i,this.character),assigned:s.E.itemManager.assigned(i),countAvailable:s.E.itemManager.countAvailable(i)})}),s.E.fhRules()&&s.E.game.party.campaignMode&&s.E.game.party.buildings)){const i=s.E.game.party.buildings.find(e=>"alchemist"==e.name);i&&i.level&&(this.brewing=i.level<3?2:3)}this.items.sort((i,e)=>{if(this.sorted){if(this.character){const o=this.itemsMeta.find(m=>m.edition==i.edition&&m.id==i.id),g=this.itemsMeta.find(m=>m.edition==e.edition&&m.id==e.id);if(!o||!g)return 0;if(o.owned&&!g.owned)return-1;if(!o.owned&&g.owned)return 1;if((o.canBuy||o.canCraft)&&!g.canBuy&&!g.canCraft)return-1;if((g.canBuy||g.canCraft)&&!o.canBuy&&!o.canCraft)return 1;if(o.canAdd&&!g.canAdd)return-1;if(!o.canAdd&&g.canAdd)return 1;if(i.slot&&!e.slot)return-1;if(e.slot&&!i.slot)return 1}return i.slot&&e.slot?Object.values(wt.o8).indexOf(i.slot)-Object.values(wt.o8).indexOf(e.slot):0}return i.edition!=e.edition?i.edition==this.currentEdition?-1:1:s.E.itemManager.sortItems(i,e)}),this.itemsMeta.sort((i,e)=>{const o=this.items.find(m=>m.edition==i.edition&&m.id==i.id),g=this.items.find(m=>m.edition==e.edition&&m.id==e.id);return o&&g?this.items.indexOf(o)-this.items.indexOf(g):0})}this.brewing=0}toggleItemSlotFilter(n,i=!1){this.itemSlots.includes(n)?this.itemSlots=this.itemSlots.filter(e=>e!=n):i?this.itemSlots.push(n):this.itemSlots=[n],this.update(!0)}select(n,i=!1){this.data.select&&(this.selected=this.selected!=n&&(i||this.character&&(s.E.itemManager.owned(n,this.character)||s.E.itemManager.canAdd(n,this.character)))?n:void 0)}unlocked(n){return s.E.game.party.unlockedItems&&null!=s.E.game.party.unlockedItems.find(i=>i.name==""+n.id&&i.edition==n.edition)}unlockItemReveal(n,i){this.unlocks.includes(n)&&i&&(s.E.game.party.unlockedItems=s.E.game.party.unlockedItems||[],this.unlocked(n)||(s.E.stateManager.before("addUnlockedItem",n.edition,n.id,n.name),s.E.game.party.unlockedItems.push(new yt.VP(""+n.id,n.edition)),s.E.stateManager.after(),this.updateEditionItems()))}removeUnlocked(n){this.unlocked(n)&&(s.E.stateManager.before("removeUnlockedItem",n.edition,n.id,n.name),s.E.game.party.unlockedItems=s.E.game.party.unlockedItems||[],s.E.game.party.unlockedItems=s.E.game.party.unlockedItems.filter(i=>i.name!=""+n.id||i.edition!=n.edition),s.E.stateManager.after(),this.updateEditionItems())}addItem(n,i=!1){this.character&&(s.E.itemManager.canAdd(n,this.character)||i)&&(s.E.stateManager.before("addItem",s.E.characterManager.characterName(this.character),n.id+"",n.edition),s.E.itemManager.addItem(n,this.character),s.E.stateManager.after(),this.update())}buyItem(n){this.character&&s.E.itemManager.canBuy(n,this.character)&&(s.E.stateManager.before("buyItem",s.E.characterManager.characterName(this.character),n.id+"",n.edition),s.E.itemManager.buyItem(n,this.character),s.E.stateManager.after(),this.update())}craftItem(n){this.character&&s.E.itemManager.canCraft(n,this.character)&&(s.E.stateManager.before("craftItem",s.E.characterManager.characterName(this.character),n.id+"",n.edition),s.E.itemManager.craftItem(n,this.character),s.E.stateManager.after(),this.update())}removeItem(n){const i=this.character&&this.character.progress.items.find(e=>e.name==""+n.id&&e.edition==n.edition);if(i&&this.character){const e=this.character.progress.items.indexOf(i);s.E.stateManager.before("removeItem",s.E.characterManager.characterName(this.character),this.character.progress.items[e].name,this.character.progress.items[e].edition),s.E.itemManager.removeItem(n,this.character),s.E.stateManager.after(),this.update()}}sellItem(n){const i=this.character&&this.character.progress.items.find(e=>e.name==""+n.id&&e.edition==n.edition);if(this.character&&i&&s.E.itemManager.itemSellValue(n)){const e=this.character.progress.items.indexOf(i);s.E.stateManager.before("sellItem",s.E.characterManager.characterName(this.character),this.character.progress.items[e].name,this.character.progress.items[e].edition),s.E.itemManager.sellItem(n,this.character),s.E.stateManager.after(),this.update()}}distillItem(n){this.character&&this.dialog.open(_s,{panelClass:["dialog"],data:{character:this.character,item:n}})}toggleEquippedItem(n,i=!1){if(this.character&&(!(s.E.game.state!=D.mk.draw||s.E.game.round>0)||i)){const g=this.character.progress.equippedItems.map(m=>this.items.find(k=>m.name==""+k.id&&k.edition==m.edition)).filter(m=>m).map(m=>m).indexOf(n);s.E.stateManager.before(-1!=g?"unequipItem":"equipItem",s.E.characterManager.characterName(this.character),n.name,n.edition),s.E.itemManager.toggleEquippedItem(n,this.character,i),s.E.stateManager.after()}}openItems(){this.character&&this.character.progress.items&&this.character.progress.items.length&&(this.dialogRef.close(),this.dialog.open(fs,{panelClass:["dialog"],data:this.character}))}openItemDialog(n){this.dialog.open(fn,{panelClass:["fullscreen-panel"],data:{item:n}})}close(){(0,F.co)(this.dialogRef)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-items-dialog"]],standalone:!1,decls:29,vars:22,consts:[[1,"items-dialog",3,"ngClass"],[1,"scroll-container"],[1,"header"],[1,"title",3,"ghs-label"],[1,"title",3,"ghs-label","ghs-label-args","ngClass"],[1,"resources"],[1,"shop-disabled"],[1,"filter"],[1,"slots"],["ghs-pointer-input","",3,"ngClass"],["type","text",3,"ngModelChange","keyup","ngModel","ghs-label","ghs-label-attribute"],["type","checkbox",3,"ngModelChange","change","ngModel"],[3,"ghs-label"],[1,"editions"],[1,"menu"],[1,"item-list"],[1,"item"],[1,"title",3,"click","ghs-label","ghs-label-args","ngClass"],[1,"resource","gold"],[3,"src"],[1,"resource-grid"],["ghs-pointer-input","",1,"brewing",3,"ngClass"],[1,"resource","lumber"],[1,"resource","metal"],[1,"resource","hide"],[1,"resource","arrowvine"],[1,"resource","axenut"],[1,"resource","corpsecap"],[1,"resource","flamefruit"],[1,"resource","rockroot"],[1,"resource","snowthistle"],["src","./assets/images/fh/loot/lumber.svg"],["src","./assets/images/fh/loot/metal.svg"],["src","./assets/images/fh/loot/hide.svg"],["src","./assets/images/fh/loot/arrowvine.svg"],["src","./assets/images/fh/loot/axenut.svg"],["src","./assets/images/fh/loot/corpsecap.svg"],["src","./assets/images/fh/loot/flamefruit.svg"],["src","./assets/images/fh/loot/rockroot.svg"],["src","./assets/images/fh/loot/snowthistle.svg"],["ghs-pointer-input","",1,"brewing",3,"singleClick","doubleClick","ngClass"],["src","./assets/images/fh/brewing.svg"],["src","./assets/images/close.svg"],["ghs-pointer-input","",3,"singleClick","doubleClick","ngClass"],[1,"ghs-svg",3,"src"],["src","./assets/images/unknown.svg",1,"ghs-svg"],[1,"edition",3,"ngClass"],["type","checkbox",3,"change","checked"],[1,"cancel",3,"click","ghs-label"],[1,"secondary",3,"ghs-label","ghs-label-args"],[1,"primary",3,"ngClass","ghs-label","ghs-label-args"],[1,"primary",3,"ghs-label","ghs-label-args"],[1,"tertiary",3,"ghs-label","ghs-label-args"],[1,"secondary",3,"click","ghs-label","ghs-label-args"],[1,"primary",3,"click","ngClass","ghs-label","ghs-label-args"],[1,"primary",3,"click","ghs-label","ghs-label-args"],[1,"tertiary",3,"click","ghs-label","ghs-label-args"],[1,"empty"],["src","./assets/images/fullscreen.svg","ghs-pointer-input","",1,"open-item",3,"singleClick"],["ghs-pointer-input","",3,"item","flipped","count","editionLabel","ngClass"],[3,"item","flipped","count","editionLabel"],[1,"button-remove"],["ghs-pointer-input","",1,"button-equip",3,"ngClass"],["ghs-pointer-input","",3,"singleClick","doubleClick","item","flipped","count","editionLabel","ngClass"],[1,"button-remove",3,"click"],["src","./assets/images/minus.svg",1,"ghs-svg"],["ghs-pointer-input","",1,"button-equip",3,"singleClick","doubleClick","ngClass"],["src","./assets/images/check.svg",1,"ghs-svg"],[3,"revealed","item","reveal","flipped","editionLabel"],[1,"overlay-text",3,"ghs-label"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.nVh(3,Df,1,1,"span",3),t.nVh(4,$f,1,8,"span",4),t.nVh(5,qf,6,4,"div",5),t.nVh(6,Wf,3,2,"div",6),t.j41(7,"div",7)(8,"div",8),t.Z7z(9,Zf,2,4,"label",9,t.fX1),t.nVh(11,Jf,2,3,"label",9),t.k0s(),t.j41(12,"input",10),t.mxI("ngModelChange",function(g){return t.DH7(e.filter,g)||(e.filter=g),g}),t.bIt("keyup",function(){return e.update()}),t.k0s(),t.nVh(13,nC,5,4),t.j41(14,"label")(15,"input",11),t.mxI("ngModelChange",function(g){return t.DH7(e.all,g)||(e.all=g),g}),t.bIt("change",function(){return e.updateEditionItems()}),t.k0s(),t.EFF(16," <"),t.nrm(17,"span",12),t.EFF(18,"(!)> "),t.k0s()(),t.nVh(19,aC,3,0,"div",13),t.k0s(),t.nVh(20,lC,7,6,"div",14),t.nVh(21,gC,3,1,"div",15),t.j41(22,"div",15),t.Z7z(23,pC,6,4,"div",16,us),t.nI1(25,"trackUUID"),t.Z7z(26,CC,4,6,"div",16,us),t.nI1(28,"trackUUID"),t.k0s()()()),2&i&&(t.Y8G("ngClass",t.l_i(19,jf,"fh"==e.settingsManager.settings.theme,"modern"==e.settingsManager.settings.theme)),t.R7$(3),t.vxM(e.character?-1:3),t.R7$(),t.vxM(e.character?4:-1),t.R7$(),t.vxM(e.character?5:-1),t.R7$(),t.vxM(e.gameManager.itemManager.buyingDisabled()&&e.character&&!e.character.tags.includes("new-character")||e.gameManager.itemManager.craftingDisabled()?6:-1),t.R7$(3),t.Dyx(e.ItemSlot),t.R7$(2),t.vxM(e.itemSlotUndefined?11:-1),t.R7$(),t.R50("ngModel",e.filter),t.Y8G("ghs-label","game.items.filter")("ghs-label-attribute","placeholder"),t.R7$(),t.vxM(e.character?13:-1),t.R7$(2),t.R50("ngModel",e.all),t.R7$(2),t.Y8G("ghs-label","game.items.filter.all"),t.R7$(2),t.vxM(e.editions&&e.editions.length>1?19:-1),t.R7$(),t.vxM(e.character?20:-1),t.R7$(),t.vxM(0==e.items.length&&0==e.unlocks.length?21:-1),t.R7$(2),t.Dyx(t.bMT(25,15,e.items)),t.R7$(3),t.Dyx(t.bMT(28,17,e.unlocks)))},dependencies:[N.YU,E.me,E.Zm,E.BC,E.vS,it,Vn,dt,ct],styles:[".items-dialog[_ngcontent-%COMP%]{position:relative}.items-dialog[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%]{overflow-x:hidden;max-height:calc(90vh - var(--ghs-unit) * 6)}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title.management[_ngcontent-%COMP%]{cursor:pointer}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));color:var(--ghs-color-white);margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));display:flex;justify-content:center;align-items:center}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-right:.25em;height:1.2em;width:auto;filter:var(--ghs-filter-white)}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource.gold[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .brewing[_ngcontent-%COMP%]{cursor:pointer;color:var(--ghs-color-gray);display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .brewing[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray);height:1em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .brewing[_ngcontent-%COMP%]:hover{opacity:.7}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .brewing.disabled[_ngcontent-%COMP%]{cursor:initial;opacity:.8}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .brewing.disabled[_ngcontent-%COMP%]:hover{opacity:.6}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .shop-disabled[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white);margin:.5em}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .shop-disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:0 .2em;height:1em;width:auto;filter:var(--ghs-filter-red)}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly;align-items:center;z-index:1}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1.2em;width:auto;filter:var(--ghs-filter-darkgray)}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   label.selected[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{max-width:100%;min-width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer;color:var(--ghs-color-white);margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap;margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer;color:var(--ghs-color-gray);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{position:sticky;top:-1px;left:0;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));max-width:100%;display:flex;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly;align-items:center;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:10}.items-dialog[_ngcontent-%COMP%]   .menu.small[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor)) 0;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.7 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;margin:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.primary[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.secondary[_ngcontent-%COMP%]{color:var(--ghs-color-gray)}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.tertiary[_ngcontent-%COMP%]{color:var(--ghs-color-blue)}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{flex-direction:column-reverse;height:calc(var(--ghs-unit) * 14 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{min-width:initial}}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]{position:relative;display:flex;flex-wrap:wrap;justify-content:center;margin:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));min-height:calc(var(--ghs-unit) * 40.5 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-yellow)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{position:relative;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 27 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 40.5 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * .75 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * .75 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow);cursor:zoom-in;z-index:4}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ghs-item[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;border:calc(var(--ghs-unit) * .35 * var(--ghs-dialog-factor)) solid transparent;border-radius:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));overflow:hidden;cursor:pointer;z-index:1}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ghs-item.disabled[_ngcontent-%COMP%]{cursor:initial;opacity:.5}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ghs-item.unavailable[_ngcontent-%COMP%]{cursor:not-allowed;border-color:var(--ghs-color-red)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ghs-item.filtered[_ngcontent-%COMP%]{cursor:initial;border-color:var(--ghs-color-darkgray);filter:grayscale(.3)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ghs-item.owned[_ngcontent-%COMP%]{border-color:var(--ghs-color-blue)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ghs-item.selected[_ngcontent-%COMP%]{border-color:var(--ghs-color-green)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .overlay-text[_ngcontent-%COMP%]{cursor:pointer;z-index:1;position:absolute;display:flex;justify-content:center;align-items:center;text-align:center;top:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-darkgray);z-index:2}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]{z-index:1;position:absolute;display:flex;cursor:pointer;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-filter-white) var(--ghs-filter-shadow);z-index:3}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-shadow)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .button-equip[_ngcontent-%COMP%]{z-index:1;position:absolute;display:flex;cursor:pointer;bottom:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 11.8 * var(--ghs-dialog-factor));justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));opacity:.6;z-index:4}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .button-equip[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:100%;height:auto;filter:var(--ghs-filter-white)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .button-equip.equipped[_ngcontent-%COMP%]{opacity:1}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .button-equip.equipped[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .button-equip[_ngcontent-%COMP%]:hover{opacity:.6}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .button-equip[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .button-equip[_ngcontent-%COMP%]:hover.equipped   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-red)}@media (max-width: 600px),(orientation: portrait){.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]{flex-direction:column;align-items:center}}.items-dialog.fh[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.items-dialog.modern[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}"]})}return a})();const MC=(a,r)=>({fh:a,modern:r}),vC=(a,r)=>[a,r],OC=a=>({spent:a}),PC=(a,r)=>r._trackUUID;function bC(a,r){1&a&&(t.j41(0,"div",8)(1,"div",9),t.nrm(2,"span",7),t.k0s()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","game.items.empty"))}function kC(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",10)(1,"img",11),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.openItemDialog(e))}),t.k0s(),t.nrm(2,"ghs-character-item",12),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(2),t.Y8G("character",i.character)("item",n)("setup",i.setup)("ngClass",t.eq3(4,OC,!i.setup&&i.countFlag(n,i.ItemFlags.spent)))}}function yC(a,r){if(1&a&&(t.j41(0,"div",8),t.Z7z(1,kC,3,6,"div",10,PC),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(t.bMT(3,0,n.items))}}let fs=(()=>{class a{character;dialogRef;dialog;gameManager=s.E;settingsManager=p.f;setup=!1;onlyEquipped=!1;items=[];ItemFlags=wt.Tr;GameState=D.mk;constructor(n,i,e){this.character=n,this.dialogRef=i,this.dialog=e,this.setup=s.E.game.state==D.mk.draw&&s.E.roundManager.firstRound,this.onlyEquipped=!this.setup,this.update()}sortItemData(n,i){if(!this.setup){if(this.equipped(n)&&!this.equipped(i))return-1;if(this.equipped(i)&&!this.equipped(n))return 1}return n.slot&&!i.slot?-1:i.slot&&!n.slot?1:n.slot&&i.slot?Object.values(wt.o8).indexOf(n.slot)-Object.values(wt.o8).indexOf(i.slot):0}update(){this.items=s.E.bbRules()?s.E.itemManager.getItems("bb"):this.character.progress.items.map(n=>s.E.itemManager.getItem(n.name,n.edition,!0)).filter(n=>n).map(n=>n).sort((n,i)=>this.sortItemData(n,i)),this.onlyEquipped&&(this.items=this.items.filter(n=>this.equipped(n)))}equipped(n){return this.character.progress.equippedItems.find(i=>i.name==""+n.id&&i.edition==n.edition)}countFlag(n,i){const e=this.equipped(n);return e&&e.tags&&e.tags.filter(o=>o==i).length||0}openShop(){this.dialogRef.close(),this.dialog.open(Le,{panelClass:["dialog"],data:{edition:s.E.game.edition,select:this.character,affordable:!0}})}openItemDialog(n){this.dialog.open(fn,{panelClass:["fullscreen-panel"],data:{item:n,character:this.character,setup:this.setup}})}close(){(0,F.co)(this.dialogRef)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-items-character-dialog"]],standalone:!1,decls:11,vars:15,consts:[[1,"items-dialog",3,"ngClass"],[1,"scroll-container"],[1,"header"],[1,"title",3,"click","ghs-label","ghs-label-args","ghs-tooltip"],[1,"menu"],[1,"shop",3,"click","ghs-label"],["type","checkbox",3,"ngModelChange","change","ngModel"],[3,"ghs-label"],[1,"item-list"],[1,"empty"],[1,"item"],["src","./assets/images/fullscreen.svg","ghs-pointer-input","",1,"open-item",3,"singleClick"],[3,"character","item","setup","ngClass"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),t.bIt("click",function(){return e.openShop()}),t.k0s()(),t.j41(4,"div",4)(5,"a",5),t.bIt("click",function(){return e.openShop()}),t.k0s(),t.j41(6,"label")(7,"input",6),t.mxI("ngModelChange",function(g){return t.DH7(e.onlyEquipped,g)||(e.onlyEquipped=g),g}),t.bIt("change",function(){return e.update()}),t.k0s(),t.nrm(8,"span",7),t.k0s()(),t.nVh(9,bC,3,1,"div",8),t.nVh(10,yC,4,2,"div",8),t.k0s()()),2&i&&(t.Y8G("ngClass",t.l_i(9,MC,"fh"==e.settingsManager.settings.theme,"modern"==e.settingsManager.settings.theme)),t.R7$(3),t.Y8G("ghs-label","game.items.character")("ghs-label-args",t.l_i(12,vC,e.character.name,e.gameManager.characterManager.characterName(e.character)))("ghs-tooltip","game.items.character.shop"),t.R7$(2),t.Y8G("ghs-label","game.items.character.shop"),t.R7$(2),t.R50("ngModel",e.onlyEquipped),t.R7$(),t.Y8G("ghs-label","game.items.character.toggleEquipped"),t.R7$(),t.vxM(0==e.items.length?9:-1),t.R7$(),t.vxM(e.items.length>0?10:-1))},dependencies:[N.YU,E.Zm,E.BC,E.vS,yi,it,Mt,dt,ct],styles:[".items-dialog[_ngcontent-%COMP%]{position:relative}.items-dialog[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%]{overflow-x:hidden;max-height:calc(90vh - var(--ghs-unit) * 6)}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white);cursor:pointer}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:center;align-items:center;z-index:1}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer;color:var(--ghs-color-white);margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .shop[_ngcontent-%COMP%]{cursor:pointer;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .shop[_ngcontent-%COMP%]:hover{opacity:.7}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;margin:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));min-height:calc(var(--ghs-unit) * 40.5 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-yellow)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{position:relative;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 27 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 40.5 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * .75 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * .75 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow);cursor:zoom-in;z-index:2}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ghs-character-item[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;transition:all calc(var(--ghs-animation-speed) * .5s) ease-in-out;z-index:1}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ghs-character-item.spent[_ngcontent-%COMP%]{transform:rotate(90deg);margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * 7.25 * var(--ghs-dialog-factor))}@media (max-width: 600px),(orientation: portrait){.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]{flex-direction:column;align-items:center}}.items-dialog.fh[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.items-dialog.modern[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}"]})}return a})();const xC=()=>[1,2,3,4,5,6,7,8,9],EC=a=>({active:a});function wC(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1,"\xa0("),t.nrm(2,"span",3),t.EFF(3,")"),t.k0s()),2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","data.character."+n.character.edition+"."+n.character.name)}}function RC(a,r){if(1&a&&(t.j41(0,"span",2),t.nrm(1,"img",10),t.EFF(2),t.nVh(3,wC,4,1,"span"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("src",n.character.iconUrl,t.B4B),t.R7$(),t.SpI(" ",n.gameManager.characterManager.characterName(n.character)," "),t.R7$(),t.vxM(n.character.title?3:-1)}}function jC(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.SpI(" ",n.objective.title)}}function GC(a,r){if(1&a&&t.nrm(0,"span",3),2&a){const n=t.XpG(2);t.Y8G("ghs-label",n.objective.name?"data.objective."+n.objective.name:n.objective.escort?"escort":"objective")}}function TC(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1,"\xa0"),t.nrm(2,"span",3),t.k0s()),2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label",n.objective.escort?"escort":"objective")}}function SC(a,r){if(1&a&&(t.j41(0,"span",2),t.nrm(1,"img",10),t.nVh(2,jC,2,1,"span"),t.nVh(3,GC,1,1,"span",3),t.nVh(4,TC,3,1,"span"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("src","./assets/images/objective/"+(n.objective.escort?"escort":"objective")+".svg",t.B4B),t.R7$(),t.vxM(n.objective.title?2:-1),t.R7$(),t.vxM(n.objective.title?-1:3),t.R7$(),t.vxM(n.objective.title?4:-1)}}function DC(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",7),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.pickNumber(e))}),t.j41(1,"span",8),t.EFF(2),t.k0s()()}if(2&a){const n=r.$implicit;t.R7$(2),t.JRh(n)}}function $C(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",11),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.longRest())}),t.nrm(1,"img",12)(2,"span",3),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(2,EC,n.character.longRest)),t.R7$(2),t.Y8G("ghs-label","game.figure.longRest"+(n.character.longRest?"Off":""))}}let ji=(()=>{class a{figure;dialogRef;value="__";characterManager=s.E.characterManager;gameManager=s.E;settingsManager=p.f;GameState=D.mk;character;objective;constructor(n,i){this.figure=n,this.dialogRef=i,this.figure instanceof H.K?this.character=this.figure:this.figure instanceof ft.$e&&(this.objective=this.figure),i.closed.subscribe({next:()=>{this.value.includes("_")&&!isNaN(+this.value.replace("_",""))&&this.updateInitiative(+this.value.replace("_",""))}})}onKeyPress(n){p.f.settings.keyboardShortcuts&&(n.key in["0","1","2","3","4","5","6","7","8","9"]?(this.pickNumber(+n.key),n.preventDefault(),n.stopPropagation()):"Enter"===n.key&&(0,F.co)(this.dialogRef))}pickNumber(n){this.value=(this.value+""+n).substring(1,3),this.value.includes("_")||(this.updateInitiative(+this.value),(0,F.co)(this.dialogRef))}updateInitiative(n){this.figure.initiative!=n&&(s.E.stateManager.before("setInitiative",this.character?s.E.characterManager.characterName(this.character):"data.objective."+this.figure.name,""+(n>0&&n<100?n:0)),n>0&&n<100?(this.setInitiative(n),this.character&&99!=n&&("prism"!=this.character.name||!this.character.tags.includes("long_rest"))&&(this.character.longRest=!1)):s.E.game.state==D.mk.draw&&(this.figure.initiative=0),s.E.game.state==D.mk.next&&s.E.sortFigures(this.character),s.E.stateManager.after())}setInitiative(n){((s.E.game.state==D.mk.draw||!p.f.settings.initiativeRequired)&&n>=0||n>0)&&n<100&&n!=this.figure.initiative&&(this.figure.initiative=n,this.character&&(this.character.initiativeVisible=!0))}longRest(){this.character&&(this.character.longRest?(s.E.stateManager.before("setInitiative",s.E.characterManager.characterName(this.character),this.character.initiative),this.character.longRest=!1,s.E.stateManager.after()):(s.E.stateManager.before("characterLongRest",s.E.characterManager.characterName(this.character)),99==this.character.initiative||"prism"==this.character.name&&this.character.tags.includes("long_rest")?this.character.longRest=!0:(this.setInitiative(99),this.character.longRest=!0,s.E.game.state==D.mk.next&&s.E.sortFigures(this.character)),s.E.stateManager.after()),(0,F.co)(this.dialogRef))}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-character-initiative-dialog"]],hostBindings:function(i,e){1&i&&t.bIt("keydown",function(g){return e.onKeyPress(g)},t.EBC)},standalone:!1,decls:18,vars:6,consts:[[1,"initiative-dialog"],[1,"title"],[1,"character"],[3,"ghs-label"],[1,"number-container"],[1,"value"],[1,"number-button"],[1,"number-button",3,"click"],[1,"number"],[1,"long-rest-button",3,"ngClass"],[1,"icon",3,"src"],[1,"long-rest-button",3,"click","ngClass"],["src","./assets/images/long-rest.svg",1,"ghs-svg"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.nVh(2,RC,4,3,"span",2),t.nVh(3,SC,5,4,"span",2),t.nrm(4,"span",3),t.k0s(),t.j41(5,"div",4),t.nrm(6,"span"),t.j41(7,"span",5),t.EFF(8),t.k0s(),t.nrm(9,"span"),t.Z7z(10,DC,3,1,"span",6,t.fX1),t.nrm(12,"span"),t.j41(13,"span",7),t.bIt("click",function(){return e.pickNumber(0)}),t.j41(14,"span",8),t.EFF(15,"0"),t.k0s()(),t.nrm(16,"span"),t.k0s(),t.nVh(17,$C,3,4,"span",9),t.k0s()),2&i&&(t.R7$(2),t.vxM(e.character?2:-1),t.R7$(),t.vxM(e.objective?3:-1),t.R7$(),t.Y8G("ghs-label","game.figure.setInitiative"),t.R7$(4),t.JRh(e.value),t.R7$(2),t.Dyx(t.lJ4(5,xC)),t.R7$(7),t.vxM(e.character?17:-1))},dependencies:[N.YU,it],styles:[".initiative-dialog[_ngcontent-%COMP%]{position:relative}.initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));width:auto;margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.initiative-dialog[_ngcontent-%COMP%]   .number-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor) * var(--ghs-text-factor)))}.initiative-dialog[_ngcontent-%COMP%]   .number-container[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor) * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.initiative-dialog[_ngcontent-%COMP%]   .number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor) * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor) * var(--ghs-text-factor));cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor) * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline)}.initiative-dialog[_ngcontent-%COMP%]   .number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray);margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button.active[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button.active[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button.active[_ngcontent-%COMP%]:hover{color:var(--ghs-color-darkgray)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button.active[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)}"]})}return a})();const Cs=(a,r)=>[a,r],IC=a=>({selected:a}),AC=(a,r)=>({disabled:a,remove:r}),VC=(a,r)=>r._trackUUID;function FC(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",6),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.toggleSelect(e.name))}),t.nrm(1,"img",7),t.j41(2,"span"),t.EFF(3),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(3,IC,n.name==i.selected)),t.R7$(),t.Y8G("src",n.iconUrl,t.B4B),t.R7$(2),t.JRh(i.gameManager.characterManager.characterName(n,!0))}}function XC(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",8),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.close())}),t.nrm(1,"span",0),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.l_i(3,AC,!(n.selected||n.edit&&n.data.selected),n.edit&&!n.selected&&n.data.selected)),t.R7$(),t.Y8G("ghs-label",n.edit&&!n.selected&&n.data.selected?"game.loot.remove":n.edit&&n.data.selected&&n.selected==n.data.selected?"game.loot.keep":"game.loot.apply")("ghs-label-args",t.l_i(6,Cs,n.edition,n.selected||n.data.selected||""))}}function BC(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",9),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.close())}),t.nrm(1,"span",10),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","cancel"))}let Ms=(()=>{class a{data;dialogRef;gameManager=s.E;characters=[];selected;edition;loot;edit=!1;constructor(n,i){this.data=n,this.dialogRef=i,this.loot=n.loot,this.selected=n.selected||"",this.edit=n.edit||!1,this.characters=s.E.game.figures.filter(e=>e instanceof H.K&&!e.absent&&s.E.entityManager.isAlive(e)).map(e=>e),this.edition=this.characters.find(e=>e.name==this.selected)?.edition||""}toggleSelect(n){this.selected==n?(this.selected="",this.data.selected&&(this.edition=this.characters.find(i=>i.name==this.data.selected)?.edition||"")):(this.selected=n,this.edition=this.characters.find(i=>i.name==this.selected)?.edition||"")}close(){(0,F.co)(this.dialogRef,this.selected)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-loot-apply-dialog"]],standalone:!1,decls:9,vars:9,consts:[[3,"ghs-label","ghs-label-args"],[1,"characters"],[1,"character",3,"ngClass"],[1,"menu"],[3,"ngClass"],[1,"cancel"],[1,"character",3,"click","ngClass"],[1,"icon",3,"src"],[3,"click","ngClass"],[1,"cancel",3,"click"],[3,"ghs-label"]],template:function(i,e){1&i&&(t.j41(0,"p"),t.nrm(1,"span",0),t.k0s(),t.j41(2,"div",1),t.Z7z(3,FC,4,5,"div",2,VC),t.nI1(5,"trackUUID"),t.k0s(),t.j41(6,"div",3),t.nVh(7,XC,2,9,"a",4),t.nVh(8,BC,2,1,"a",5),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","game.loot.chooseCharacter")("ghs-label-args",t.l_i(6,Cs,""+e.gameManager.lootManager.getValue(e.loot),"game.loot."+e.loot.type)),t.R7$(2),t.Dyx(t.bMT(5,4,e.characters)),t.R7$(4),t.vxM(e.selected||e.data.selected?7:-1),t.R7$(),t.vxM(e.selected||e.data.selected?-1:8))},dependencies:[N.YU,it,ct],styles:["p[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.8 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-align:center}.characters[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);margin:.25em;padding:.25em;border:1px solid transparent}.characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:1.5em;height:auto;margin-right:.2em;filter:grayscale(.7)}.characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]:hover{color:var(--ghs-color-darkgray);border-color:var(--ghs-color-darkgray)}.characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]:hover   .icon[_ngcontent-%COMP%]{filter:grayscale(.3)}.characters[_ngcontent-%COMP%]   .character.selected[_ngcontent-%COMP%]{color:var(--ghs-color-white);border-color:var(--ghs-color-gray)}.characters[_ngcontent-%COMP%]   .character.selected[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{filter:none}.menu[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;color:var(--ghs-color-green)}.menu[_ngcontent-%COMP%]   a.remove[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray)}.menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.5;color:var(--ghs-color-gray)}"]})}return a})();const YC=(a,r)=>({fh:a,modern:r}),UC=(a,r)=>[a,r],NC=a=>({autosell:a});let Gi=(()=>{class a{data;dialogRef;dialog;settingsManager=p.f;gameManager=s.E;item;character;autoSell=!1;constructor(n,i,e){this.data=n,this.dialogRef=i,this.dialog=e,this.item=n.item,this.character=n.character,this.autoSell=null!=this.character&&null!=this.character.progress.items.find(o=>o.name==""+this.item.id&&o.edition==this.item.edition)}close(){(0,F.co)(this.dialogRef)}openDialog(){this.dialog.open(fn,{panelClass:["fullscreen-panel"],disableClose:!0,data:{item:this.item}})}apply(){(0,F.co)(this.dialogRef,this.item)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-random-item-dialog"]],standalone:!1,decls:10,vars:17,consts:[[1,"random-item-dialog",3,"ngClass"],[1,"scroll-container"],[1,"title",3,"ghs-label","ghs-label-args"],[1,"item",3,"ngClass"],[3,"click","item","flipped","editionLabel"],[1,"menu"],[1,"cancel",3,"click"],[3,"ghs-label"],[1,"apply",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"span",2),t.j41(3,"div",3)(4,"ghs-item",4),t.bIt("click",function(){return e.openDialog()}),t.k0s()(),t.j41(5,"div",5)(6,"a",6),t.bIt("click",function(){return e.close()}),t.nrm(7,"span",7),t.k0s(),t.j41(8,"a",8),t.bIt("click",function(){return e.apply()}),t.nrm(9,"span",7),t.k0s()()()()),2&i&&(t.Y8G("ngClass",t.l_i(9,YC,"fh"==e.settingsManager.settings.theme,"modern"==e.settingsManager.settings.theme)),t.R7$(2),t.Y8G("ghs-label","game.loot.random_item.draw")("ghs-label-args",t.l_i(12,UC,e.character.name,e.gameManager.characterManager.characterName(e.character))),t.R7$(),t.Y8G("ngClass",t.eq3(15,NC,e.autoSell)),t.R7$(),t.Y8G("item",e.item)("flipped",!0)("editionLabel",e.gameManager.currentEdition()),t.R7$(3),t.Y8G("ghs-label","cancel"),t.R7$(2),t.Y8G("ghs-label","game.loot.random_item.apply"))},dependencies:[N.YU,it,Vn],styles:[".random-item-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:block;font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline);margin-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.random-item-dialog.fh[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.random-item-dialog.modern[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.random-item-dialog[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:100%}.random-item-dialog[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ghs-item[_ngcontent-%COMP%]{display:block;width:calc(var(--ghs-unit) * 27 * var(--ghs-dialog-factor));height:auto}.random-item-dialog[_ngcontent-%COMP%]   .item.autosell[_ngcontent-%COMP%]{cursor:not-allowed;border-color:var(--ghs-color-darkgray);filter:grayscale(.7)}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:2em;padding:.3em}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}"]})}return a})();var ut=v(9733);const zC=(a,r)=>({flipped:a,"no-animations":r});function LC(a,r){1&a&&t.nrm(0,"img",9),2&a&&t.Y8G("ghs-tooltip","challenges.automation.hint")}function qC(a,r){if(1&a&&t.nrm(0,"img",12),2&a){const n=t.XpG(2);t.Y8G("ghs-tooltip","data.challenges."+n.challenge.edition+"."+n.challenge.cardId+".hint")}}function HC(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function KC(a,r){if(1&a&&(t.j41(0,"div",7)(1,"div",8),t.nVh(2,LC,1,1,"img",9),t.k0s(),t.nrm(3,"p",10),t.j41(4,"div",11),t.nVh(5,qC,1,1,"img",12),t.k0s()(),t.j41(6,"div",13),t.nrm(7,"p",10),t.k0s(),t.j41(8,"div",14),t.nVh(9,HC,2,0,"span"),t.EFF(10),t.k0s()),2&a){const n=t.XpG();t.R7$(2),t.vxM(n.challenge.automation&&n.settingsManager.settings.fhChallengesApply?2:-1),t.R7$(),t.Y8G("ghs-label","data.challenges."+n.challenge.edition+"."+n.challenge.cardId),t.R7$(2),t.vxM("partial"==n.challenge.automation&&n.settingsManager.settings.fhChallengesApply?5:-1),t.R7$(2),t.Y8G("ghs-label","data.challenges."+n.challenge.edition+"."+n.challenge.cardId+".text"),t.R7$(2),t.vxM(n.challenge.cardId<10?9:-1),t.R7$(),t.SpI("",n.challenge.cardId," ")}}let wa=(()=>{class a{challenge;keep=!1;flipped=!1;reveal=!1;disableFlip=!1;revealed=!1;animate=!1;settingsManager=p.f;onChange(n){this.revealed=n}ngOnChanges(n){const i=n.flipped;i&&!this.disableFlip&&i.currentValue&&i.currentValue!=i.previousValue&&(this.animate=!0)}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-challenge-card"]],inputs:{challenge:"challenge",keep:"keep",flipped:"flipped",reveal:"reveal",disableFlip:"disableFlip"},standalone:!1,features:[t.OA$],decls:8,vars:9,consts:[["container",""],[1,"challenge"],["card-reveal","",1,"card",3,"change","ngClass","disabled"],[1,"card-back"],[1,"revealed"],[1,"text",3,"ghs-label"],[1,"card-front"],[1,"title"],[1,"automation"],["src","./assets/images/automation.svg",1,"ghs-svg",3,"ghs-tooltip"],[1,"placeholder",3,"ghs-label"],[1,"hint"],["src","./assets/images/warning.svg",1,"ghs-svg",3,"ghs-tooltip"],[1,"text"],[1,"card-id"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",1,0)(2,"div",2),t.bIt("change",function(m){return c.eBV(o),c.Njj(e.onChange(m))}),t.j41(3,"div",3)(4,"span",4),t.nrm(5,"span",5),t.k0s()(),t.j41(6,"div",6),t.nVh(7,KC,11,6),t.k0s()()()}if(2&i){const o=t.sdS(1);t.R7$(2),t.xc7("font-size",.1*o.offsetWidth+"px"),t.Y8G("ngClass",t.l_i(6,zC,e.flipped||e.revealed,!e.animate))("disabled",!e.reveal),t.R7$(3),t.Y8G("ghs-label","game.cards.confirmReveal"),t.R7$(2),t.vxM(e.challenge?7:-1)}},dependencies:[N.YU,Nn,it,Mt],styles:[".challenge[_ngcontent-%COMP%]{position:relative;width:100%;padding-bottom:147%}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;border:5% solid transparent;border-radius:5%;transition:transform calc(var(--ghs-animation-speed) * .5s) cubic-bezier(.75,0,.85,1)}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]{background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:5%;background-image:url(challenge-front.9a22e80ccfbf0b6d.png)}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{position:absolute;top:6%;left:0;width:100%;height:20%;display:flex;justify-content:center;align-items:center;text-align:center;margin:0;font-family:var(--ghs-font-title);font-size:.85em;transform:rotate(-3deg)}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{max-width:60%;margin:0}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .automation[_ngcontent-%COMP%], .challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{display:flex;align-items:center;width:20%}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .automation[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{cursor:help}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .automation.automation[_ngcontent-%COMP%], .challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .hint.automation[_ngcontent-%COMP%]{justify-content:flex-end}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .automation.automation[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .hint.automation[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{margin-right:.2em;width:1.5em;height:auto;filter:var(--ghs-filter-darkgray)}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .automation.hint[_ngcontent-%COMP%], .challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .hint.hint[_ngcontent-%COMP%]{justify-content:flex-start}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .automation.hint[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .hint.hint[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{margin-left:.2em;width:1.3em;height:auto;filter:var(--ghs-filter-yellow)}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{position:absolute;top:30%;left:17.5%;width:65%;height:60%;margin:0;font-family:var(--ghs-font-normal);font-size:.75em;line-height:.9em;text-align:center;transform:rotate(-3deg)}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{position:absolute;bottom:1%;right:8%;text-align:right;font-family:var(--ghs-font-normal);font-size:.5em;color:var(--ghs-color-white);filter:var(--ghs-filter-outline)}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]{background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:5%;background-image:url(challenge-back.73584a0c39f15db5.png)}.challenge[_ngcontent-%COMP%]   .confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center;color:var(--ghs-color-black);font-size:1.3em;filter:drop-shadow(calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) var(--ghs-color-white))}.challenge[_ngcontent-%COMP%]   .confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{text-align:center}"]})}return a})();v(3492);const WC=(a,r)=>({closed:a,opened:r});let ZC=(()=>{class a{card;dialogRef;opened=!1;constructor(n,i){this.card=n,this.dialogRef=i}ngOnInit(){this.opened=!0}close(){this.opened=!1,setTimeout(()=>{this.dialogRef.close()},p.f.settings.animations?1e3*p.f.settings.animationSpeed:0)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-challenge-dialog"]],standalone:!1,decls:3,vars:6,consts:[[1,"challenge-dialog",3,"click","ngClass"],[3,"challenge","flipped"],[1,"close-container",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.bIt("click",function(){return e.close()}),t.nrm(1,"ghs-challenge-card",1),t.k0s(),t.j41(2,"div",2),t.bIt("click",function(){return e.close()}),t.k0s()),2&i&&(t.Y8G("ngClass",t.l_i(3,WC,!e.opened,e.opened)),t.R7$(),t.Y8G("challenge",e.card)("flipped",e.opened))},dependencies:[N.YU,wa],styles:["[_nghost-%COMP%]{background-color:transparent;padding:0;margin:0;border:0}.challenge-dialog[_ngcontent-%COMP%]{position:relative;width:66.66vh;max-width:400px;height:100vh;max-height:600px;border-image:none;background:none;transition:transform calc(var(--ghs-animation-speed) * .15s) ease-in-out;transform:scale(0);z-index:2}.challenge-dialog[_ngcontent-%COMP%]   ghs-challenge-card[_ngcontent-%COMP%]{width:100%;height:auto}.challenge-dialog[_ngcontent-%COMP%]   .close-dialog[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:0;left:0;width:100%;height:45%}.challenge-dialog.opened[_ngcontent-%COMP%]{transform:scale(1)}.challenge-dialog.closed[_ngcontent-%COMP%]{transform:scale(0);transition-delay:.8s}@media (max-width: 600px),(orientation: portrait){.challenge-dialog[_ngcontent-%COMP%]{width:80vw;max-width:400px;height:120vw;max-height:600px}}.close-container[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1}"]})}return a})();const qe=(a,r)=>[a,r],zn=a=>[a],Ti=(a,r,n)=>[a,r,n],Si=(a,r)=>r._trackUUID;function JC(a,r){if(1&a&&(t.j41(0,"div",1),t.nrm(1,"span",3),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","scenario.requirements.solo")("ghs-label-args",t.l_i(2,qe,n.scenarioData.edition,n.solo))}}function QC(a,r){if(1&a&&t.nrm(0,"div",6),2&a){const n=r.$implicit;t.Y8G("ghs-label","scenario.requirements.party")("ghs-label-args",t.eq3(2,zn,n))}}function tM(a,r){if(1&a&&t.nrm(0,"div",6),2&a){const n=r.$implicit;t.Y8G("ghs-label","scenario.requirements.partyCount")("ghs-label-args",t.sMw(2,Ti,n.name,n.required-n.count,n.required))}}function nM(a,r){if(1&a&&t.nrm(0,"div",6),2&a){const n=r.$implicit;t.Y8G("ghs-label","scenario.requirements.partyMissing")("ghs-label-args",t.eq3(2,zn,n))}}function eM(a,r){if(1&a&&t.nrm(0,"div",6),2&a){const n=r.$implicit;t.Y8G("ghs-label","scenario.requirements.global")("ghs-label-args",t.eq3(2,zn,n))}}function aM(a,r){if(1&a&&t.nrm(0,"div",6),2&a){const n=r.$implicit;t.Y8G("ghs-label","scenario.requirements.globalCount")("ghs-label-args",t.sMw(2,Ti,n.name,n.required-n.count,n.required))}}function iM(a,r){if(1&a&&t.nrm(0,"div",6),2&a){const n=r.$implicit;t.Y8G("ghs-label","scenario.requirements.globalMissing")("ghs-label-args",t.eq3(2,zn,n))}}function oM(a,r){if(1&a&&t.nrm(0,"div",6),2&a){const n=r.$implicit;t.Y8G("ghs-label","scenario.requirements.campaignStickers")("ghs-label-args",t.eq3(2,zn,n))}}function sM(a,r){if(1&a&&t.nrm(0,"div",6),2&a){const n=r.$implicit;t.Y8G("ghs-label","scenario.requirements.campaignStickersCount")("ghs-label-args",t.sMw(2,Ti,n.name,n.required-n.count,n.required))}}function rM(a,r){if(1&a&&t.nrm(0,"div",6),2&a){const n=r.$implicit;t.Y8G("ghs-label","scenario.requirements.campaignStickersMissing")("ghs-label-args",t.eq3(2,zn,n))}}function cM(a,r){if(1&a&&t.nrm(0,"div",6),2&a){const n=r.$implicit;t.Y8G("ghs-label","scenario.requirements.buildings")("ghs-label-args",t.eq3(2,zn,n))}}function lM(a,r){if(1&a&&t.nrm(0,"div",6),2&a){const n=r.$implicit;t.Y8G("ghs-label","scenario.requirements.buildingsLevel")("ghs-label-args",t.l_i(2,qe,n.name,n.level))}}function gM(a,r){if(1&a&&t.nrm(0,"div",6),2&a){const n=r.$implicit;t.Y8G("ghs-label","scenario.requirements.buildingsMissing")("ghs-label-args",t.eq3(2,zn,n))}}function dM(a,r){if(1&a&&t.nrm(0,"div",11),2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ghs-label","scenario.requirements.characters")("ghs-label-args",t.l_i(2,qe,i.scenarioData.edition,n))}}function hM(a,r){if(1&a&&t.nrm(0,"div",11),2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ghs-label","scenario.requirements.charactersMissing")("ghs-label-args",t.l_i(2,qe,i.scenarioData.edition,n))}}function _M(a,r){1&a&&t.nrm(0,"div",15),2&a&&t.Y8G("ghs-label","scenario.requirements.scenarios.and")}function mM(a,r){if(1&a&&(t.nrm(0,"div",16),t.nVh(1,_M,1,1,"div",15)),2&a){const n=r.$implicit,i=r.$index,e=t.XpG().$implicit,o=t.XpG(3);t.Y8G("ghs-label","scenario.requirements.scenarios.scenario")("ghs-label-args",t.l_i(3,qe,n,o.scenarioData.edition)),t.R7$(),t.vxM(e.length>1&&i<e.length-1?1:-1)}}function pM(a,r){1&a&&t.nrm(0,"div",15),2&a&&t.Y8G("ghs-label","scenario.requirements.scenarios.or")}function uM(a,r){if(1&a&&(t.j41(0,"div",12),t.Z7z(1,mM,2,6,null,null,t.fX1),t.k0s(),t.nVh(3,pM,1,1,"div",15)),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2).$implicit;t.R7$(),t.Dyx(n),t.R7$(2),t.vxM(e.scenarios.length>1&&i<e.scenarios.length-1?3:-1)}}function fM(a,r){if(1&a&&(t.j41(0,"div",12),t.nrm(1,"div",14),t.Z7z(2,uM,4,1,null,null,t.fX1),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.Y8G("ghs-label","scenario.requirements.scenarios"),t.R7$(),t.Dyx(n.scenarios)}}function CM(a,r){1&a&&(t.j41(0,"span",13),t.nrm(1,"span",17),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","or"))}function MM(a,r){if(1&a&&(t.j41(0,"div",4)(1,"div",5),t.Z7z(2,QC,1,4,"div",6,t.fX1),t.k0s(),t.j41(4,"div",5),t.Z7z(5,tM,1,6,"div",6,t.fX1),t.k0s(),t.j41(7,"div",5),t.Z7z(8,nM,1,4,"div",6,t.fX1),t.k0s(),t.j41(10,"div",7),t.Z7z(11,eM,1,4,"div",6,t.fX1),t.k0s(),t.j41(13,"div",7),t.Z7z(14,aM,1,6,"div",6,t.fX1),t.k0s(),t.j41(16,"div",7),t.Z7z(17,iM,1,4,"div",6,t.fX1),t.k0s(),t.j41(19,"div",8),t.Z7z(20,oM,1,4,"div",6,t.fX1),t.k0s(),t.j41(22,"div",8),t.Z7z(23,sM,1,6,"div",6,Si),t.nI1(25,"trackUUID"),t.k0s(),t.j41(26,"div",8),t.Z7z(27,rM,1,4,"div",6,t.fX1),t.k0s(),t.j41(29,"div",9),t.Z7z(30,cM,1,4,"div",6,t.fX1),t.k0s(),t.j41(32,"div",9),t.Z7z(33,lM,1,5,"div",6,Si),t.nI1(35,"trackUUID"),t.k0s(),t.j41(36,"div",9),t.Z7z(37,gM,1,4,"div",6,t.fX1),t.k0s(),t.j41(39,"div",10),t.Z7z(40,dM,1,5,"div",11,t.fX1),t.k0s(),t.j41(42,"div",10),t.Z7z(43,hM,1,5,"div",11,t.fX1),t.k0s(),t.nVh(45,fM,4,1,"div",12),t.k0s(),t.nVh(46,CM,2,1,"span",13)),2&a){const n=r.$implicit,i=r.$index,e=t.XpG();t.R7$(2),t.Dyx(n.partyAchievements),t.R7$(3),t.Dyx(n.partyAchievementsCount),t.R7$(3),t.Dyx(n.partyAchievementsMissing),t.R7$(3),t.Dyx(n.globalAchievements),t.R7$(3),t.Dyx(n.globalAchievementsCount),t.R7$(3),t.Dyx(n.globalAchievementsMissing),t.R7$(3),t.Dyx(n.campaignStickers),t.R7$(3),t.Dyx(t.bMT(25,2,n.campaignStickersCount)),t.R7$(4),t.Dyx(n.campaignStickersMissing),t.R7$(3),t.Dyx(n.buildings),t.R7$(3),t.Dyx(t.bMT(35,4,n.buildingsLevel)),t.R7$(4),t.Dyx(n.buildingsMissing),t.R7$(3),t.Dyx(n.characters),t.R7$(3),t.Dyx(n.charactersMissing),t.R7$(2),t.vxM(n.scenarios.length?45:-1),t.R7$(),t.vxM(i<e.requirements.length-1?46:-1)}}function vM(a,r){if(1&a){const n=t.RV6();t.j41(0,"label",2)(1,"input",18),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.all,e)||(o.all=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.update())}),t.k0s(),t.nrm(2,"span",17),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.R50("ngModel",n.all),t.R7$(),t.Y8G("ghs-label","scenario.requirements.all")}}function OM(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",6)(1,"a",7),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.close())}),t.nrm(2,"span",3),t.k0s(),t.j41(3,"a",8),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.startScenario())}),t.nrm(4,"span",3),t.k0s()()}2&a&&(t.R7$(2),t.Y8G("ghs-label","scenario.requirements.cancel"),t.R7$(2),t.Y8G("ghs-label","scenario.requirements.start"))}let vs=(()=>{class a{scenarioData;highlight=!1;all=!1;allToggle=!0;gameManager=s.E;solo="";requirements=[];missingRequirements=[];hideAll=!1;ngOnInit(){this.update()}ngOnChanges(n){n.all&&this.update()}update(){this.requirements=s.E.scenarioManager.getRequirements(this.scenarioData,this.all),this.missingRequirements=s.E.scenarioManager.getRequirements(this.scenarioData),this.solo="",this.hideAll=!this.all&&JSON.stringify(s.E.scenarioManager.getRequirements(this.scenarioData,!0))==JSON.stringify(this.requirements),this.scenarioData.solo&&(this.all||!s.E.game.figures.find(n=>n instanceof H.K&&n.name==this.scenarioData.solo&&n.level>=5))&&(this.solo=this.scenarioData.solo)}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-requirements"]],inputs:{scenarioData:"scenarioData",highlight:"highlight",all:"all",allToggle:"allToggle"},standalone:!1,features:[t.OA$],decls:6,vars:4,consts:[[1,"requirements"],[1,"solo"],[1,"checkbox"],[3,"ghs-label","ghs-label-args"],[1,"requirement"],[1,"party"],[1,"achievement",3,"ghs-label","ghs-label-args"],[1,"global"],[1,"campaign-stickers"],[1,"buildings"],[1,"characters"],[1,"characters",3,"ghs-label","ghs-label-args"],[1,"scenarios"],[1,"separator"],[1,"requires",3,"ghs-label"],[1,"separator",3,"ghs-label"],[1,"scenario",3,"ghs-label","ghs-label-args"],[3,"ghs-label"],["type","checkbox",3,"ngModelChange","change","ngModel"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nVh(1,JC,2,5,"div",1),t.Z7z(2,MM,47,6,null,null,Si),t.nI1(4,"trackUUID"),t.nVh(5,vM,3,2,"label",2),t.k0s()),2&i&&(t.R7$(),t.vxM(e.solo?1:-1),t.R7$(),t.Dyx(t.bMT(4,2,e.requirements)),t.R7$(3),t.vxM(e.allToggle&&!e.hideAll?5:-1))},dependencies:[E.Zm,E.BC,E.vS,it,ct],styles:[".requirements[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.requirements[_ngcontent-%COMP%]   .achievement[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.requirements[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{cursor:pointer;margin-top:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));display:flex;align-items:center;font-family:var(--ghs-font-text);color:var(--ghs-color-gray);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor))}.requirements[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));display:flex;justify-content:center;align-items:center;flex-wrap:wrap}.requirements[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .requires[_ngcontent-%COMP%]{text-align:center;width:100%;flex-grow:1}.requirements[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}"]})}return a})(),Ra=(()=>{class a{data;dialogRef;gameManager=s.E;constructor(n,i){this.data=n,this.dialogRef=i}startScenario(){s.E.stateManager.before("setScenario",...s.E.scenarioManager.scenarioUndoArgs(new ut.Nz(this.data.scenarioData))),s.E.scenarioManager.setScenario(new ut.Nz(this.data.scenarioData),this.data.linked||!1),s.E.stateManager.after(),(0,F.co)(this.dialogRef,!0)}close(){(0,F.co)(this.dialogRef)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-requirements-dialog"]],standalone:!1,decls:9,vars:5,consts:[[1,"requirements-dialog"],[1,"header"],[1,"title"],[3,"ghs-label"],[1,"name"],[3,"scenarioData"],[1,"buttons"],[1,"cancel",3,"click"],[1,"start",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"span",2),t.nrm(3,"span",3),t.j41(4,"span",4),t.EFF(5),t.nrm(6,"span",3),t.k0s()()(),t.nrm(7,"ghs-requirements",5),t.nVh(8,OM,5,2,"div",6),t.k0s()),2&i&&(t.R7$(3),t.Y8G("ghs-label","scenario.requirements"),t.R7$(2),t.SpI("#",e.data.scenarioData.index," "),t.R7$(),t.Y8G("ghs-label",e.gameManager.scenarioManager.scenarioTitle(e.data.scenarioData)),t.R7$(),t.Y8G("scenarioData",e.data.scenarioData),t.R7$(),t.vxM(e.data.hideMenu?-1:8))},dependencies:[it,vs],styles:[".requirements-dialog[_ngcontent-%COMP%]{position:relative;color:var(--ghs-color-white)}.requirements-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-family:var(--ghs-font-title);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor))}.requirements-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;flex-direction:column}.requirements-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{text-align:center;color:var(--ghs-color-gray);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.requirements-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly;align-items:center}.requirements-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;min-width:33%;display:flex;justify-content:center;margin:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));white-space:nowrap}.requirements-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.requirements-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.requirements-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .start[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}"]})}return a})();const PM=(a,r)=>({flipped:a,"no-animations":r});function bM(a,r){1&a&&t.nrm(0,"img",9),2&a&&t.Y8G("ghs-tooltip","campaign.trials.automation")}function kM(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function yM(a,r){if(1&a&&(t.nrm(0,"div",7),t.j41(1,"div",8),t.nVh(2,bM,1,1,"img",9),t.k0s(),t.j41(3,"div",10),t.nrm(4,"p",11),t.k0s(),t.j41(5,"div",12),t.nVh(6,kM,2,0,"span"),t.EFF(7),t.k0s()),2&a){const n=t.XpG();t.Y8G("ghs-label","data.trials."+n.trialCard.edition+"."+n.trialCard.cardId),t.R7$(2),t.vxM(n.trialCard.automation&&n.settingsManager.settings.fhChallengesApply?2:-1),t.R7$(2),t.Y8G("ghs-label","data.trials."+n.trialCard.edition+"."+n.trialCard.cardId+".text"),t.R7$(2),t.vxM(n.trialCard.cardId<1e3?6:-1),t.R7$(),t.SpI("",n.settingsManager.settings.fhSecondEdition?n.gameManager.trialsManager.cardIdSecondPrinting(n.trialCard.cardId):n.trialCard.cardId," ")}}let xM=(()=>{class a{trial;edition;keep=!1;flipped=!1;reveal=!1;disableFlip=!1;trialCard;revealed=!1;animate=!1;gameManager=s.E;settingsManager=p.f;ngOnInit(){const n=s.E.editionData.find(i=>i.edition==this.edition&&i.trials);n&&(this.trialCard=n.trials.find(i=>i.edition==this.edition&&i.cardId==this.trial))}onChange(n){this.revealed=n}ngOnChanges(n){const i=n.flipped;i&&!this.disableFlip&&i.currentValue&&i.currentValue!=i.previousValue&&(this.animate=!0)}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-trial-card"]],inputs:{trial:"trial",edition:"edition",keep:"keep",flipped:"flipped",reveal:"reveal",disableFlip:"disableFlip"},standalone:!1,features:[t.OA$],decls:8,vars:9,consts:[["container",""],[1,"trial"],["card-reveal","",1,"card",3,"change","ngClass","disabled"],[1,"card-back"],[1,"revealed"],[1,"text",3,"ghs-label"],[1,"card-front"],[1,"title",3,"ghs-label"],[1,"automation"],["src","./assets/images/automation.svg",1,"ghs-svg",3,"ghs-tooltip"],[1,"text"],[1,"placeholder","margin-breaks",3,"ghs-label"],[1,"card-id"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",1,0)(2,"div",2),t.bIt("change",function(m){return c.eBV(o),c.Njj(e.onChange(m))}),t.j41(3,"div",3)(4,"span",4),t.nrm(5,"span",5),t.k0s()(),t.j41(6,"div",6),t.nVh(7,yM,8,5),t.k0s()()()}if(2&i){const o=t.sdS(1);t.R7$(2),t.xc7("font-size",.1*o.offsetWidth+"px"),t.Y8G("ngClass",t.l_i(6,PM,e.flipped||e.revealed,!e.animate))("disabled",!e.reveal),t.R7$(3),t.Y8G("ghs-label","game.cards.confirmReveal"),t.R7$(2),t.vxM(e.trialCard?7:-1)}},dependencies:[N.YU,Nn,it,Mt],styles:[".trial[_ngcontent-%COMP%]{position:relative;width:100%;padding-bottom:147%}.trial[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;border:5% solid transparent;border-radius:5%}.trial[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]{background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:5%;background-image:url(trial-front.88b3e4fb0b27e613.png)}.trial[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{position:absolute;top:7%;left:25%;width:100%;margin:0;font-family:var(--ghs-font-title);font-size:1.1em;color:var(--ghs-color-white);filter:var(--ghs-filter-outline);text-transform:uppercase}.trial[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .automation[_ngcontent-%COMP%]{position:absolute;top:4%;right:8%;display:flex;justify-content:center;align-items:center}.trial[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .automation[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{cursor:help;width:1.2em;height:auto;filter:var(--ghs-filter-white)}.trial[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{position:absolute;top:20%;left:11%;width:78%;height:70%;margin:0;font-family:var(--ghs-font-normal);font-size:.8em;line-height:.9em;display:flex;justify-content:center;align-items:center}.trial[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;text-align:center}.trial[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{position:absolute;bottom:1.2%;right:88%;text-align:right;font-family:var(--ghs-font-normal);font-size:.45em;color:var(--ghs-color-white);filter:var(--ghs-filter-outline)}.trial[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]{background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:5%;background-image:url(trial-back.5d90a94e1c9992f4.png)}.trial[_ngcontent-%COMP%]   .confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center;color:var(--ghs-color-black);font-size:1.3em;filter:drop-shadow(calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) var(--ghs-color-white))}.trial[_ngcontent-%COMP%]   .confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{text-align:center}"]})}return a})();const EM=(a,r)=>({closed:a,opened:r});let Os=(()=>{class a{data;dialogRef;opened=!1;constructor(n,i){this.data=n,this.dialogRef=i}ngOnInit(){this.opened=!0}close(){this.opened=!1,setTimeout(()=>{this.dialogRef.close()},p.f.settings.animations?1e3*p.f.settings.animationSpeed:0)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-trial-dialog"]],standalone:!1,decls:3,vars:7,consts:[[1,"trial-dialog",3,"click","ngClass"],[3,"edition","trial","flipped"],[1,"close-container",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.bIt("click",function(){return e.close()}),t.nrm(1,"ghs-trial-card",1),t.k0s(),t.j41(2,"div",2),t.bIt("click",function(){return e.close()}),t.k0s()),2&i&&(t.Y8G("ngClass",t.l_i(4,EM,!e.opened,e.opened)),t.R7$(),t.Y8G("edition",e.data.edition)("trial",e.data.trial)("flipped",e.opened))},dependencies:[N.YU,xM],styles:["[_nghost-%COMP%]{background-color:transparent;padding:0;margin:0;border:0}.trial-dialog[_ngcontent-%COMP%]{position:relative;width:66.66vh;max-width:400px;height:100vh;max-height:600px;border-image:none;background:none;transition:transform calc(var(--ghs-animation-speed) * .15s) ease-in-out;transform:scale(0);z-index:2}.trial-dialog[_ngcontent-%COMP%]   ghs-trial[_ngcontent-%COMP%]{width:100%;height:auto}.trial-dialog[_ngcontent-%COMP%]   .close-dialog[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:0;left:0;width:100%;height:45%}.trial-dialog.opened[_ngcontent-%COMP%]{transform:scale(1)}.trial-dialog.closed[_ngcontent-%COMP%]{transform:scale(0);transition-delay:.8s}@media (max-width: 600px),(orientation: portrait){.trial-dialog[_ngcontent-%COMP%]{width:80vw;max-width:400px;height:120vw;max-height:600px}}.close-container[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1}"]})}return a})();var Pt=v(7165);const Ps=(a,r)=>r._trackUUID;function wM(a,r){if(1&a&&t.nrm(0,"span",3),2&a){const n=t.XpG().$index,i=t.XpG(2);t.Y8G("ghs-label",i.rewardLabel[n][0]+".result")("ghs-label-args",i.rewardResults[n])}}function RM(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,",\xa0"),t.k0s())}function jM(a,r){if(1&a&&(t.nrm(0,"span",2),t.nVh(1,wM,1,2,"span",3),t.nVh(2,RM,2,0,"span")),2&a){const n=r.$index,i=t.XpG(2);t.Y8G("ghs-label",i.rewardLabel[n][0])("ghs-label-args",i.rewardLabel[n].slice(1)),t.R7$(),t.vxM(i.rewardResults&&i.rewardResults[n]&&i.rewardResults[n].length>0?1:-1),t.R7$(),t.vxM(i.treasure.rewards.length>1&&n<i.treasure.rewards.length-1?2:-1)}}function GM(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-item",5),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.openItemDialog(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(3);t.Y8G("item",n)("flipped",!0)("editionLabel",i.gameManager.game.edition||"")}}function TM(a,r){if(1&a&&(t.j41(0,"div",1),t.Z7z(1,GM,1,3,"ghs-item",4,Ps),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Dyx(t.bMT(3,0,n.items))}}function SM(a,r){if(1&a&&(t.j41(0,"span",0),t.Z7z(1,jM,3,4,null,null,Ps),t.nI1(3,"trackUUID"),t.nVh(4,TM,4,2,"div",1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(t.bMT(3,1,n.treasure.rewards)),t.R7$(3),t.vxM(n.itemCards&&n.items.length>0?4:-1)}}let Pe=(()=>{class a{dialog;gameManager=s.E;treasure;index;edition;rewardResults;itemCards=!1;items=[];rewardLabel=[];labelPrefix="game.loot.treasures.rewards.";constructor(n){this.dialog=n}ngOnInit(){if(this.treasure)this.index=this.treasure.index;else{const n=s.E.editionData.find(i=>i.edition==this.edition);if(n&&n.treasures){const i=this.index<0?this.index:this.index-(n.treasureOffset||0);i>=0&&i<n.treasures.length?this.treasure=new Pt.Ah(n.treasures[i],this.index):i<0&&n.treasures.length+i+1>0?this.treasure=new Pt.Ah(n.treasures[i+1+n.treasures.length],this.index):console.warn("Invalid treasure index: '"+this.index+"' for Edition "+this.edition,n.treasures.length)}}this.treasure&&(this.treasure.rewards.forEach((n,i)=>{this.rewardLabel[i]=this.calcRewardLabel(n)}),this.itemCards&&this.treasure.rewards.forEach((n,i)=>{if([Pt.lb.item,Pt.lb.itemBlueprint,Pt.lb.itemDesign,Pt.lb.itemFh].includes(n.type)){const e=""+n.value;let o=this.edition,g=-1;isNaN(+e)?(g=+e.split("-")[0],o=e.split("-")[1]):g=+e;const m=s.E.itemManager.getItem(g,o,!0);m&&this.items.push(m)}else if([Pt.lb.randomItem,Pt.lb.randomItemBlueprint,Pt.lb.randomItemDesign].includes(n.type)&&this.rewardResults&&this.rewardResults[i]&&this.rewardResults[i][0]&&!isNaN(+this.rewardResults[i][0])){const e=s.E.itemManager.getItem(this.rewardResults[i][0],this.rewardResults[i][2],!0);e&&this.items.push(e)}}))}calcRewardLabel(n){if("custom"==n.type)return[""+n.value];const i=""+(n.value||"");switch(n.type){case Pt.lb.gold:case Pt.lb.goldFh:case Pt.lb.experience:case Pt.lb.experienceFh:case Pt.lb.battleGoal:case Pt.lb.randomScenario:case Pt.lb.randomScenarioFh:case Pt.lb.randomItem:case Pt.lb.randomItemDesign:case Pt.lb.randomItemBlueprint:case Pt.lb.partyAchievement:case Pt.lb.campaignSticker:case Pt.lb.heal:case Pt.lb.loot:case Pt.lb.lootCards:return[this.labelPrefix+n.type,i];case Pt.lb.damage:return"terrain"==i?[this.labelPrefix+n.type,"%game.level.hazardousTerrain%"]:[this.labelPrefix+n.type,"%game.damage:"+i+"%"];case Pt.lb.condition:const e=i.split("+").map(lt=>"%game.condition."+lt+"%");let o=e[0];return e.length>1&&(o=e.slice(0,-1).join(","),o+=" %and% "+e[e.length-1]),[this.labelPrefix+n.type,o];case Pt.lb.item:case Pt.lb.itemDesign:case Pt.lb.itemFh:case Pt.lb.itemBlueprint:const g=[],m=[];i.split("+").forEach(lt=>{let St=this.edition,Ct=-1;isNaN(+lt)?(Ct=+lt.split("-")[0],St=lt.split("-")[1]):Ct=+lt;const sn=s.E.itemManager.getItem(Ct,St,!0);sn?(g.push(n.type==Pt.lb.itemFh||n.type==Pt.lb.itemBlueprint?sn.id+"":"%game.item% "+(St==this.edition?sn.id:sn.id+" [%data.edition."+sn.edition+"%]")),m.push('"'+p.f.getLabel("data.items."+sn.edition+"-"+sn.id)+'"')):(console.warn("Invalid Item '"+Ct+"' (Edition "+St+") on treasure '"+this.index+"' for Edition "+this.edition),m.push('<img class="icon ghs-svg" src="./assets/images/warning.svg"> %item% '+Ct))});let k=g[0];g.length>1&&(k=g.slice(0,-1).join(","),k+=" %and% "+g[g.length-1]);let X=m[0];return m.length>1&&(X=m.slice(0,-1).join(","),X+=" %and% "+m[m.length-1]),[this.labelPrefix+n.type,k,X];case Pt.lb.scenario:const at=s.E.scenarioManager.getScenario(i,this.edition,void 0);return at?[this.labelPrefix+n.type,at.index,s.E.scenarioManager.scenarioTitle(at)]:(console.warn("Invalid Scenario '"+i+"' on treasure '"+this.index+"' for Edition "+this.edition),[this.labelPrefix+n.type,i,'<img class="icon ghs-svg" src="./assets/images/warning.svg"> %scenario%']);case Pt.lb.event:const tt=i.split("-")[0],J=i.split("-")[1];return[this.labelPrefix+n.type+"."+tt,""+J];case Pt.lb.resource:const et=i.split("+").map(lt=>lt.split("-")[1]+'<img class="icon ghs-svg" src="./assets/images/fh/loot/'+lt.split("-")[0]+'.svg">');let ot=et[0];return et.length>1&&(ot=et.slice(0,-1).join(","),ot+=" %and% "+et[et.length-1]),[this.labelPrefix+n.type,ot];case Pt.lb.calendarSection:if(i.split("-").length>1)return[this.labelPrefix+n.type,i.split("-")[0],i.split("-")[1]]}return[]}openItemDialog(n){this.dialog.open(fn,{panelClass:["fullscreen-panel"],disableClose:!0,data:{item:n}})}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-treasure-label"]],inputs:{treasure:"treasure",index:"index",edition:"edition",rewardResults:"rewardResults",itemCards:"itemCards"},standalone:!1,decls:1,vars:1,consts:[[1,"treasure-label"],[1,"items"],[1,"label",3,"ghs-label","ghs-label-args"],[1,"result",3,"ghs-label","ghs-label-args"],[3,"item","flipped","editionLabel"],[3,"click","item","flipped","editionLabel"]],template:function(i,e){1&i&&t.nVh(0,SM,5,3,"span",0),2&i&&t.vxM(e.treasure?0:-1)},dependencies:[it,Vn,ct],styles:[".treasure-label{display:inline-block;line-height:1em}.treasure-label:first-letter{text-transform:uppercase}.treasure-label .items{display:flex;flex-wrap:wrap;justify-content:center;align-items:center}.treasure-label .items ghs-item{position:relative;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 20 * var(--ghs-dialog-factor))}\n"],encapsulation:2})}return a})();const DM=(a,r)=>({fh:a,modern:r}),$M=a=>({absent:a}),bs=a=>({denied:a}),Ot=a=>[a],Jt=()=>[],gn=(a,r)=>[a,r],He=(a,r,n)=>[a,r,n],IM=()=>["+1"],AM=(a,r)=>({unlocked:a,disabled:r}),Et=(a,r)=>r._trackUUID;function VM(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.SpI("#",n.scenario.index,"\xa0")}}function FM(a,r){1&a&&(t.j41(0,"span",6),t.nrm(1,"span",3),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","scenario.finish.success"))}function XM(a,r){if(1&a&&(t.j41(0,"span",7),t.nrm(1,"span",3),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label",n.conclusion.name?n.gameManager.scenarioManager.scenarioTitle(n.conclusion,!0):"%scenario.section% #"+n.conclusion.index)}}function BM(a,r){1&a&&(t.j41(0,"span",8),t.nrm(1,"span",3),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","scenario.summary.casualWarning"))}function YM(a,r){1&a&&(t.j41(0,"span",9),t.nrm(1,"span",3),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","scenario.finish.failure"))}function UM(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",18)(1,"img",22),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.openCharacterSheet(e))}),t.k0s(),t.j41(2,"span",23),t.EFF(3),t.k0s(),t.j41(4,"span",24)(5,"img",25),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.toggleAbsent(e))}),t.k0s()()()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(),t.Y8G("src",n.iconUrl,t.B4B),t.R7$(),t.Y8G("ngClass",t.eq3(7,$M,n.absent)),t.R7$(),t.SpI(" ",i.gameManager.characterManager.characterName(n,!0)," "),t.R7$(),t.Y8G("ngClass",t.eq3(9,bs,!i.gameManager.stateManager.characterPermissions[n.name+"|"+n.edition])),t.R7$(),t.Y8G("src","./assets/images/status/"+(n.absent?"absent":"present")+".svg",t.B4B)("ghs-label",n.absent?"character.present":"character.absent")("ghs-label-attribute","title")}}function NM(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.JRh(t.bMT(2,1,n.loot))}}function zM(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.R7$(),t.Lme("",n.lootCards.length,"/",i.gameManager.game.lootDeck.cards.length)}}function LM(a,r){if(1&a&&(t.j41(0,"span",20),t.nVh(1,NM,3,3,"span"),t.nVh(2,zM,2,2,"span"),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.vxM(n.gameManager.game.lootDeck.cards.length?-1:1),t.R7$(),t.vxM(n.gameManager.game.lootDeck.cards.length?2:-1)}}function qM(a,r){if(1&a&&(t.j41(0,"span",20),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.SpI(" ",t.bMT(2,1,n.rewards.gold)," ")}}function HM(a,r){if(1&a&&(t.j41(0,"span",19),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,qM,3,3,"span",20,Et),t.nI1(4,"trackUUID")),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.summary.rewards.gold"),t.R7$(),t.Dyx(t.bMT(4,1,n.characters))}}function KM(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",20)(1,"input",26),t.bIt("change",function(e){const o=c.eBV(n).$index,g=t.XpG(3);return c.Njj(g.changeCollectiveGold(e,o))}),t.k0s()()}if(2&a){const n=r.$index,i=t.XpG(3);t.R7$(),t.Y8G("max",i.collectiveGold[n]+i.availableCollectiveGold())("value",i.collectiveGold[n])}}function WM(a,r){if(1&a&&(t.j41(0,"span",21),t.nrm(1,"span",5),t.k0s(),t.Z7z(2,KM,2,2,"span",20,Et),t.nI1(4,"trackUUID")),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.summary.rewards.collectiveGold"),t.R7$(),t.Dyx(t.bMT(4,1,n.characters))}}function ZM(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",20)(1,"input",26),t.bIt("change",function(e){const o=c.eBV(n).$index,g=t.XpG().$implicit,m=t.XpG(3);return c.Njj(m.changeCollectiveResource(e,o,g.type))}),t.k0s()()}if(2&a){const n=r.$index,i=t.XpG().$implicit,e=t.XpG(3);t.R7$(),t.Y8G("max",(e.collectiveResources[n]&&e.collectiveResources[n][i.type]||0)+e.availableCollectiveResource(i.type))("value",e.collectiveResources[n]&&e.collectiveResources[n][i.type]||0)}}function JM(a,r){if(1&a&&(t.j41(0,"span",21),t.nrm(1,"span",27),t.k0s(),t.Z7z(2,ZM,2,2,"span",20,Et),t.nI1(4,"trackUUID")),2&a){const n=r.$implicit,i=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.summary.rewards.collectiveResource")("ghs-label-args",t.eq3(4,Ot,n.type)),t.R7$(),t.Dyx(t.bMT(4,2,i.characters))}}function QM(a,r){if(1&a&&t.Z7z(0,JM,5,6,null,null,t.fX1),2&a){const n=t.XpG(2);t.Dyx(n.rewards.collectiveResources)}}function t1(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.SpI("\xa0(",n.gameManager.trialsManager.activeFavor("fh","wealth"),"x)")}}function n1(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&a){const n=t.XpG(3).$implicit;t.R7$(),t.JRh(t.bMT(2,1,n.loot))}}function e1(a,r){if(1&a&&(t.EFF(0," \xa0 "),t.j41(1,"span"),t.EFF(2,"("),t.k0s(),t.Z7z(3,n1,3,3,"span",null,t.fX1),t.nI1(5,"ghsRange"),t.j41(6,"span"),t.EFF(7,")"),t.k0s()),2&a){const n=t.XpG(5);t.R7$(3),t.Dyx(t.i5U(5,0,t.lJ4(3,Jt),n.gameManager.trialsManager.activeFavor("fh","wealth")))}}function a1(a,r){if(1&a&&(t.j41(0,"span",29),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s(),t.nVh(3,e1,8,4)),2&a){const n=t.XpG().$implicit,i=t.XpG(3);t.R7$(),t.JRh(t.bMT(2,2,n.loot*i.gameManager.trialsManager.activeFavor("fh","wealth"))),t.R7$(2),t.vxM(i.gameManager.trialsManager.activeFavor("fh","wealth")>1?3:-1)}}function i1(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function o1(a,r){if(1&a&&(t.j41(0,"span",20),t.nVh(1,a1,4,4),t.nVh(2,i1,2,0,"span"),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.vxM(n.loot?1:-1),t.R7$(),t.vxM(n.loot?-1:2)}}function s1(a,r){if(1&a&&(t.j41(0,"span",19),t.nrm(1,"span",28),t.nVh(2,t1,2,1,"span"),t.k0s(),t.Z7z(3,o1,3,2,"span",20,Et),t.nI1(5,"trackUUID")),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","data.favors.fh.wealth.reward")("ghs-tooltip","data.favors.fh.wealth.text"),t.R7$(),t.vxM(n.gameManager.trialsManager.activeFavor("fh","wealth")>1?2:-1),t.R7$(),t.Dyx(t.bMT(5,3,n.characters))}}function r1(a,r){1&a&&t.nrm(0,"span",3),2&a&&t.Y8G("ghs-label","scenario.summary.gold")}function c1(a,r){if(1&a&&(t.nrm(0,"img",30),t.EFF(1)),2&a){const n=t.XpG(2);t.R7$(),t.Lme(" ",n.lootedGold,"/",n.totalGold," ")}}function l1(a,r){if(1&a&&(t.j41(0,"span")(1,"span",29),t.EFF(2),t.nI1(3,"ghsValueSign"),t.k0s(),t.EFF(4),t.k0s()),2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG(2);t.R7$(2),t.JRh(t.bMT(3,2,(o.success&&o.rewards&&o.rewards.gold?o.rewards.gold:0)+(o.collectiveGold[e]?o.collectiveGold[e]:0)+i.loot*o.gameManager.levelManager.loot()+(o.gameManager.trialsManager.favorsEnabled&&o.gameManager.trialsManager.apply?i.loot*o.gameManager.trialsManager.activeFavor("fh","wealth"):0))),t.R7$(2),t.SpI(" (",i.progress.gold+(o.success&&o.rewards&&o.rewards.gold?o.rewards.gold:0)+(o.collectiveGold[e]?o.collectiveGold[e]:0)+i.loot*o.gameManager.levelManager.loot()+(o.gameManager.trialsManager.favorsEnabled&&o.gameManager.trialsManager.apply?i.loot*o.gameManager.trialsManager.activeFavor("fh","wealth"):0),") ")}}function g1(a,r){if(1&a&&(t.j41(0,"span")(1,"span"),t.EFF(2,"/"),t.k0s(),t.EFF(3),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(3),t.SpI(" (",n.progress.gold,") ")}}function d1(a,r){if(1&a&&(t.nVh(0,l1,5,4,"span"),t.nVh(1,g1,4,1,"span")),2&a){const n=r.$implicit;t.vxM(n.absent?-1:0),t.R7$(),t.vxM(n.absent?1:-1)}}function h1(a,r){if(1&a&&(t.j41(0,"span")(1,"span",32),t.EFF(2),t.nI1(3,"ghsValueSign"),t.k0s(),t.EFF(4),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG().$implicit,e=t.XpG(2);t.R7$(2),t.JRh(t.bMT(3,2,e.lootValue(n,i))),t.R7$(2),t.SpI(" (",(n.progress.loot[i]||0)+e.lootValue(n,i),") ")}}function _1(a,r){if(1&a&&(t.j41(0,"span")(1,"span",32),t.EFF(2,"/"),t.k0s(),t.EFF(3),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG().$implicit;t.R7$(3),t.SpI(" (",n.progress.loot[i]||0,") ")}}function m1(a,r){if(1&a&&(t.nVh(0,h1,5,4,"span"),t.nVh(1,_1,4,1,"span")),2&a){const n=r.$implicit;t.vxM(n.absent?-1:0),t.R7$(),t.vxM(n.absent?1:-1)}}function p1(a,r){if(1&a&&(t.j41(0,"span",21),t.nrm(1,"img",31),t.EFF(2),t.k0s(),t.Z7z(3,m1,2,2,null,null,Et),t.nI1(5,"trackUUID")),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+n+".svg",t.B4B),t.R7$(),t.Lme(" ",e.lootColumnsLooted[i],"/",e.lootColumnsTotal[i]," "),t.R7$(),t.Dyx(t.bMT(5,3,e.characters))}}function u1(a,r){if(1&a&&(t.j41(0,"span",20),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.SpI(" ",t.bMT(2,1,n.experience)," ")}}function f1(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&a){const n=t.XpG(4);t.R7$(),t.JRh(t.bMT(2,1,n.gameManager.levelManager.experience()))}}function C1(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"/"),t.k0s())}function M1(a,r){if(1&a&&(t.j41(0,"span",20),t.nVh(1,f1,3,3,"span"),t.nVh(2,C1,2,0,"span"),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.vxM(n.absent?-1:1),t.R7$(),t.vxM(n.absent?2:-1)}}function v1(a,r){if(1&a&&(t.j41(0,"span",20),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&a){const n=t.XpG(4);t.R7$(),t.SpI(" ",t.bMT(2,1,n.rewards.experience)," ")}}function O1(a,r){if(1&a&&(t.j41(0,"span",19),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,v1,3,3,"span",20,Et),t.nI1(4,"trackUUID")),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.summary.rewards.experience"),t.R7$(),t.Dyx(t.bMT(4,1,n.characters))}}function P1(a,r){if(1&a&&(t.j41(0,"span",19),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,M1,3,2,"span",20,Et),t.nI1(4,"trackUUID"),t.nVh(5,O1,5,3)),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.summary.xpBonus"),t.R7$(),t.Dyx(t.bMT(4,2,n.characters)),t.R7$(3),t.vxM(n.success&&n.rewards&&n.rewards.experience?5:-1)}}function b1(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&a){const n=t.XpG(4);t.R7$(),t.JRh(t.bMT(2,1,2*n.challenges))}}function k1(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"/"),t.k0s())}function y1(a,r){if(1&a&&(t.j41(0,"span",20),t.nVh(1,b1,3,3,"span"),t.nVh(2,k1,2,0,"span"),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.vxM(n.absent?-1:1),t.R7$(),t.vxM(n.absent?2:-1)}}function x1(a,r){if(1&a&&(t.j41(0,"span",19),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,y1,3,2,"span",20,Et),t.nI1(4,"trackUUID")),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.summary.xpChallenges"),t.R7$(),t.Dyx(t.bMT(4,1,n.characters))}}function E1(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.SpI("\xa0(",n.gameManager.trialsManager.activeFavor("fh","knowledge"),"x)")}}function w1(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"+3"),t.k0s())}function R1(a,r){if(1&a&&(t.EFF(0," \xa0 "),t.j41(1,"span"),t.EFF(2,"("),t.k0s(),t.Z7z(3,w1,2,0,"span",null,t.fX1),t.nI1(5,"ghsRange"),t.j41(6,"span"),t.EFF(7,")"),t.k0s()),2&a){const n=t.XpG(5);t.R7$(3),t.Dyx(t.i5U(5,0,t.lJ4(3,Jt),n.gameManager.trialsManager.activeFavor("fh","knowledge")))}}function j1(a,r){if(1&a&&(t.j41(0,"span",33),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s(),t.nVh(3,R1,8,4)),2&a){const n=t.XpG(4);t.R7$(),t.JRh(t.bMT(2,2,3*n.gameManager.trialsManager.activeFavor("fh","knowledge"))),t.R7$(2),t.vxM(n.gameManager.trialsManager.activeFavor("fh","knowledge")>1?3:-1)}}function G1(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function T1(a,r){if(1&a&&(t.j41(0,"span",20),t.nVh(1,j1,4,4),t.nVh(2,G1,2,0,"span"),t.k0s()),2&a){const n=r.$index,i=t.XpG(3);t.R7$(),t.vxM(i.battleGoals[n]?1:-1),t.R7$(),t.vxM(i.battleGoals[n]?-1:2)}}function S1(a,r){if(1&a&&(t.j41(0,"span",19),t.nrm(1,"span",28),t.nVh(2,E1,2,1,"span"),t.k0s(),t.Z7z(3,T1,3,2,"span",20,Et),t.nI1(5,"trackUUID")),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","data.favors.fh.knowledge.reward")("ghs-tooltip","data.favors.fh.knowledge.text"),t.R7$(),t.vxM(n.gameManager.trialsManager.activeFavor("fh","knowledge")>1?2:-1),t.R7$(),t.Dyx(t.bMT(5,3,n.characters))}}function D1(a,r){if(1&a&&(t.j41(0,"span",33),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&a){const n=t.XpG(2).$implicit,i=t.XpG(2);t.R7$(),t.JRh(t.bMT(2,1,(i.rewards&&i.rewards.experience?i.rewards.experience:0)+2*i.challenges+n.experience+(i.rewards&&i.rewards.ignoredBonus&&-1!=i.rewards.ignoredBonus.indexOf("experience")?0:i.gameManager.levelManager.experience())))}}function $1(a,r){if(1&a&&(t.j41(0,"span",33),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&a){const n=t.XpG(2).$implicit;t.R7$(),t.JRh(t.bMT(2,1,n.experience))}}function I1(a,r){if(1&a&&(t.j41(0,"span",34),t.nrm(1,"img",35),t.k0s()),2&a){const n=t.XpG(2).$implicit;t.Y8G("ghs-tooltip","scenario.summary.levelUp")("ghs-label-args",t.l_i(2,gn,n.level,n.level+1))}}function A1(a,r){if(1&a&&(t.j41(0,"span"),t.nVh(1,D1,3,3,"span",33),t.nVh(2,$1,3,3,"span",33),t.EFF(3),t.nVh(4,I1,2,5,"span",34),t.k0s()),2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG(2);t.R7$(),t.vxM(o.success?1:-1),t.R7$(),t.vxM(o.success?-1:2),t.R7$(),t.SpI(" (",i.progress.experience+2*o.challenges+i.experience+(o.success&&o.rewards&&o.rewards.experience?o.rewards.experience:0)+(!o.success||o.rewards&&o.rewards.ignoredBonus&&o.rewards.ignoredBonus.includes("experience")?0:o.gameManager.levelManager.experience())+(o.gameManager.trialsManager.favorsEnabled&&o.gameManager.trialsManager.apply&&o.battleGoals[e]?3*o.gameManager.trialsManager.activeFavor("fh","knowledge"):0),") "),t.R7$(),t.vxM(o.levelUp[e]?4:-1)}}function V1(a,r){if(1&a&&(t.j41(0,"span")(1,"span",33),t.EFF(2,"/"),t.k0s(),t.EFF(3),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(3),t.SpI(" (",n.progress.experience,") ")}}function F1(a,r){if(1&a&&(t.nVh(0,A1,5,4,"span"),t.nVh(1,V1,4,1,"span")),2&a){const n=r.$implicit;t.vxM(n.absent?-1:0),t.R7$(),t.vxM(n.absent?1:-1)}}function X1(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function B1(a,r){if(1&a&&(t.j41(0,"span"),t.nVh(1,X1,2,0,"span"),t.EFF(2),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.vxM(!(""+n).startsWith("G")&&+(""+n).split(":")[0]<10?1:-1),t.R7$(),t.SpI(" ",(""+n).startsWith("G-")?"G":(""+n).split(":")[0])}}function Y1(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"??? "),t.k0s())}function U1(a,r){if(1&a&&t.nrm(0,"ghs-treasure-label",40),2&a){const n=t.XpG().$implicit,i=t.XpG(4);t.Y8G("edition",i.scenario.edition)("index",+(""+n).split(":")[0]-1)("rewardResults",i.gameManager.scenarioManager.treasureRewardsFromString(""+n))}}function N1(a,r){if(1&a&&(t.j41(0,"div",37)(1,"span",38),t.nVh(2,B1,3,2,"span"),t.nVh(3,Y1,2,0,"span"),t.k0s(),t.j41(4,"span",39),t.nVh(5,U1,1,3,"ghs-treasure-label",40),t.k0s()()),2&a){const n=r.$implicit;t.R7$(2),t.vxM((""+n).startsWith("G")||+(""+n).split(":")[0]>=0?2:-1),t.R7$(),t.vxM(!(""+n).startsWith("G")&&+(""+n).split(":")[0]<0?3:-1),t.R7$(2),t.vxM((""+n).startsWith("G-")?-1:5)}}function z1(a,r){if(1&a&&(t.j41(0,"span",36),t.Z7z(1,N1,6,3,"div",37,t.fX1),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.Dyx(n.treasures||t.lJ4(0,Jt))}}function L1(a,r){if(1&a&&(t.j41(0,"span",21),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,z1,3,1,"span",36,Et),t.nI1(4,"trackUUID")),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.summary.treasures"),t.R7$(),t.Dyx(t.bMT(4,1,n.characters))}}function q1(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-item",45),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2).$implicit,o=t.XpG(2);return c.Njj(o.openItemDialog(e))}),t.k0s()}if(2&a){const n=t.XpG(2).$implicit;t.Y8G("item",n)("flipped",!0)}}function H1(a,r){if(1&a){const n=t.RV6();t.j41(0,"span"),t.nVh(1,q1,1,2,"ghs-item",43),t.j41(2,"input",44),t.bIt("change",function(e){const o=c.eBV(n).$index,g=t.XpG().$index,m=t.XpG(2);return c.Njj(m.toggleItem(e,o,g))}),t.k0s()()}if(2&a){const n=r.$index,i=t.XpG().$index,e=t.XpG(2);t.R7$(),t.vxM(e.items[n]&&e.items[n].includes(i)?1:-1),t.R7$(),t.Y8G("disabled",e.itemDistributed(n,i))("checked",e.items[n]&&e.items[n].includes(i))}}function K1(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",41),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.openItemDialog(e))}),t.nrm(1,"span",42),t.k0s(),t.Z7z(2,H1,3,3,"span",null,Et),t.nI1(4,"trackUUID")}if(2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.summary.item")("ghs-label-args",t.eq3(4,Ot,n.name)),t.R7$(),t.Dyx(t.bMT(4,2,i.characters))}}function W1(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-item",45),t.bIt("click",function(){c.eBV(n);const e=t.XpG(4);return c.Njj(e.openItemDialog(e.randomItem))}),t.k0s()}if(2&a){const n=t.XpG(4);t.Y8G("item",n.randomItem)("flipped",!0)}}function Z1(a,r){if(1&a){const n=t.RV6();t.j41(0,"span"),t.nVh(1,W1,1,2,"ghs-item",43),t.j41(2,"input",44),t.bIt("change",function(e){const o=c.eBV(n).$index,g=t.XpG(3);return c.Njj(g.toggleRandomItem(e,o))}),t.k0s()()}if(2&a){const n=r.$index,i=t.XpG(3);t.R7$(),t.vxM(i.randomItemIndex==n?1:-1),t.R7$(),t.Y8G("disabled",i.randomItemIndex>-1&&i.randomItemIndex!=n)("checked",i.randomItemIndex==n)}}function J1(a,r){if(1&a&&(t.j41(0,"span",21),t.nrm(1,"span",42),t.k0s(),t.Z7z(2,Z1,3,3,"span",null,Et),t.nI1(4,"trackUUID")),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.summary.randomItem")("ghs-label-args",t.eq3(4,Ot,n.randomItem.name)),t.R7$(),t.Dyx(t.bMT(4,2,n.characters))}}function Q1(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-item",45),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG(3);return c.Njj(o.openItemDialog(o.randomItems[e]))}),t.k0s()}if(2&a){const n=t.XpG().$index,i=t.XpG(3);t.Y8G("item",i.randomItems[n])("flipped",!0)}}function tv(a,r){if(1&a&&(t.j41(0,"span"),t.nVh(1,Q1,1,2,"ghs-item",43),t.k0s()),2&a){const n=r.$index,i=t.XpG(3);t.R7$(),t.vxM(i.randomItems[n]?1:-1)}}function nv(a,r){if(1&a&&(t.j41(0,"span",21),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,tv,2,1,"span",null,Et),t.nI1(4,"trackUUID")),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.summary.randomItems"),t.R7$(),t.Dyx(t.bMT(4,1,n.characters))}}function ev(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",52),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(3);return c.Njj(o.openBattleGoals(e))}),t.nrm(1,"ghs-battlegoal",53),t.k0s()}if(2&a){const n=t.XpG().$implicit;t.R7$(),t.Y8G("identifier",n.battleGoal&&n.battleGoals[0])("flipped",n.battleGoal)}}function av(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",52),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2).$implicit,o=t.XpG(3);return c.Njj(o.openBattleGoals(e))}),t.nrm(1,"ghs-battlegoal",53),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2).$implicit;t.R7$(),t.Y8G("identifier",n)("flipped",i.battleGoal)}}function iv(a,r){if(1&a&&(t.j41(0,"div",48),t.Z7z(1,av,2,2,"span",47,Et),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.Dyx(t.bMT(3,0,n.battleGoals))}}function ov(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",52),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2).$implicit,o=t.XpG(3);return c.Njj(o.openBattleGoals(e))}),t.nrm(1,"ghs-battlegoal",53),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2).$implicit;t.R7$(),t.Y8G("identifier",n)("flipped",i.battleGoal)}}function sv(a,r){if(1&a&&(t.j41(0,"div",48),t.Z7z(1,ov,2,2,"span",47,Et),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.Dyx(t.bMT(3,0,n.battleGoals.slice(0,n.battleGoals.length-2)))}}function rv(a,r){1&a&&t.nrm(0,"input",54),2&a&&t.Y8G("disabled",!0)("checked",!0)}function cv(a,r){if(1&a&&(t.Z7z(0,rv,1,2,"input",54,t.fX1),t.nI1(2,"ghsRange")),2&a){const n=t.XpG(4);t.Dyx(t.i5U(2,0,t.lJ4(3,Jt),n.rewards.battleGoals))}}function lv(a,r){if(1&a){const n=t.RV6();t.j41(0,"input",55),t.bIt("change",function(e){c.eBV(n);const o=t.XpG().$index,g=t.XpG(3);return c.Njj(g.toggleBattleGoal(e,o,2))}),t.k0s()}if(2&a){const n=t.XpG().$index,i=t.XpG(3);t.Y8G("checked",i.battleGoals[n]>1)}}function gv(a,r){if(1&a){const n=t.RV6();t.j41(0,"input",55),t.bIt("change",function(e){const o=c.eBV(n).$implicit,g=t.XpG(2).$index,m=t.XpG(3);return c.Njj(m.toggleBattleGoal(e,g,3+o))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2).$index,e=t.XpG(3);t.Y8G("checked",e.battleGoals[i]>2+n)}}function dv(a,r){if(1&a&&(t.Z7z(0,gv,1,1,"input",50,t.fX1),t.nI1(2,"ghsRange")),2&a){const n=t.XpG().$index,i=t.XpG(3);t.Dyx(t.i5U(2,0,t.lJ4(3,Jt),i.battleGoals[n]-1))}}function hv(a,r){1&a&&(t.j41(0,"span",51),t.nrm(1,"img",35),t.k0s()),2&a&&t.Y8G("ghs-tooltip","scenario.summary.perksUp")}function _v(a,r){if(1&a){const n=t.RV6();t.j41(0,"span")(1,"span",46),t.nVh(2,ev,2,2,"span",47),t.nVh(3,iv,4,2,"div",48),t.nVh(4,sv,4,2,"div",48),t.j41(5,"span",49),t.nVh(6,cv,3,4),t.j41(7,"input",44),t.bIt("change",function(e){const o=c.eBV(n).$index,g=t.XpG(3);return c.Njj(g.toggleBattleGoal(e,o,1))}),t.k0s(),t.nVh(8,lv,1,1,"input",50),t.nVh(9,dv,3,4),t.k0s(),t.nVh(10,hv,2,1,"span",51),t.k0s()()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.R7$(2),t.vxM(e.settingsManager.settings.battleGoals&&n.battleGoal&&n.battleGoals.length>0&&n!=e.trial349&&n!=e.trial356?2:-1),t.R7$(),t.vxM(e.settingsManager.settings.battleGoals&&n.battleGoal&&n.battleGoals.length>0&&n==e.trial349?3:-1),t.R7$(),t.vxM(e.settingsManager.settings.battleGoals&&n.battleGoal&&n.battleGoals.length>2&&n==e.trial356?4:-1),t.R7$(2),t.vxM(e.rewards&&e.rewards.battleGoals?6:-1),t.R7$(),t.Y8G("disabled",n.absent)("checked",!n.absent&&e.battleGoals[i]>0),t.R7$(),t.vxM(!n.absent&&e.battleGoals[i]>0?8:-1),t.R7$(),t.vxM(!n.absent&&n==e.trial349&&e.battleGoals[i]>1?9:-1),t.R7$(),t.vxM(e.perksUp[i]?10:-1)}}function mv(a,r){if(1&a&&(t.j41(0,"span",21),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,_v,11,9,"span",null,Et),t.nI1(4,"trackUUID")),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","game.battleGoals"),t.R7$(),t.Dyx(t.bMT(4,1,n.characters))}}function pv(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",59),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(3);return c.Njj(o.openTrial(e))}),t.nrm(1,"img",60),t.k0s()}}function uv(a,r){if(1&a){const n=t.RV6();t.j41(0,"span")(1,"span",56),t.nVh(2,pv,2,0,"span",57),t.j41(3,"span",58)(4,"input",44),t.bIt("change",function(e){const o=c.eBV(n).$index,g=t.XpG(3);return c.Njj(g.toggleTrial(e,o))}),t.k0s()(),t.nrm(5,"span",57),t.k0s()()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.R7$(2),t.vxM(n.progress.trial?2:-1),t.R7$(2),t.Y8G("disabled",n.absent)("checked",!n.absent&&e.trials[i])}}function fv(a,r){if(1&a&&(t.j41(0,"span",21),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,uv,6,3,"span",null,Et),t.nI1(4,"trackUUID")),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","character.progress.trial"),t.R7$(),t.Dyx(t.bMT(4,1,n.characters))}}function Cv(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",61),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.stats=!e.stats)}),t.k0s(),t.nrm(1,"span",62)}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","scenario.stats.toggle."+(n.stats?"hide":"show")),t.R7$(),t.xc7("grid-column","span "+(n.characters.length-1))}}function Mv(a,r){if(1&a&&(t.j41(0,"span",63),t.nrm(1,"span",64)(2,"span",64)(3,"span",64),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.dealtDamage")("ghs-label-args",t.eq3(15,Ot,n.scenarioStats.dealtDamage))("ghs-tooltip","scenario.stats.dealtDamage.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.monsterDamage")("ghs-label-args",t.eq3(17,Ot,n.scenarioStats.monsterDamage))("ghs-tooltip","scenario.stats.monsterDamage.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.otherDamage")("ghs-label-args",t.eq3(19,Ot,n.scenarioStats.otherDamage))("ghs-tooltip","scenario.stats.otherDamage.hint")}}function vv(a,r){if(1&a&&(t.j41(0,"span",63),t.nrm(1,"span",64)(2,"span",64),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.heals")("ghs-label-args",t.eq3(10,Ot,n.scenarioStats.heals))("ghs-tooltip","scenario.stats.heals.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.healedDamage")("ghs-label-args",t.eq3(12,Ot,n.scenarioStats.healedDamage))("ghs-tooltip","scenario.stats.healedDamage.hint")}}function Ov(a,r){if(1&a&&t.nrm(0,"span",64),2&a){const n=t.XpG().$implicit;t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.normalKills")("ghs-label-args",t.eq3(5,Ot,n.scenarioStats.normalKills))("ghs-tooltip","scenario.stats.normalKills.hint")}}function Pv(a,r){if(1&a&&t.nrm(0,"span",64),2&a){const n=t.XpG().$implicit;t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.eliteKills")("ghs-label-args",t.eq3(5,Ot,n.scenarioStats.eliteKills))("ghs-tooltip","scenario.stats.eliteKills.hint")}}function bv(a,r){if(1&a&&t.nrm(0,"span",64),2&a){const n=t.XpG().$implicit;t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.bossKills")("ghs-label-args",t.eq3(5,Ot,n.scenarioStats.bossKills))("ghs-tooltip","scenario.stats.bossKills.hint")}}function kv(a,r){if(1&a&&(t.j41(0,"span",63),t.nVh(1,Ov,1,7,"span",65),t.nVh(2,Pv,1,7,"span",65),t.nVh(3,bv,1,7,"span",65),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.vxM(n.scenarioStats.normalKills?1:-1),t.R7$(),t.vxM(n.scenarioStats.eliteKills?2:-1),t.R7$(),t.vxM(n.scenarioStats.bossKills?3:-1)}}function yv(a,r){if(1&a&&(t.j41(0,"span",63),t.nrm(1,"span",64)(2,"span",64),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.maxDealtDamage")("ghs-label-args",t.eq3(10,Ot,n.scenarioStats.maxDealtDamage))("ghs-tooltip","scenario.stats.maxDealtDamage.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.maxDamage")("ghs-label-args",t.eq3(12,Ot,n.scenarioStats.maxDamage))("ghs-tooltip","scenario.stats.maxDamage.hint")}}function xv(a,r){if(1&a&&(t.j41(0,"span",21),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,Mv,4,21,"span",63,Et),t.nI1(4,"trackUUID"),t.j41(5,"span",21),t.nrm(6,"span",3),t.k0s(),t.Z7z(7,vv,3,14,"span",63,Et),t.nI1(9,"trackUUID"),t.j41(10,"span",21),t.nrm(11,"span",3),t.k0s(),t.Z7z(12,kv,4,3,"span",63,Et),t.nI1(14,"trackUUID"),t.j41(15,"span",21),t.nrm(16,"span",3),t.k0s(),t.Z7z(17,yv,3,14,"span",63,Et),t.nI1(19,"trackUUID")),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.stats.damage"),t.R7$(),t.Dyx(t.bMT(4,4,n.characters)),t.R7$(4),t.Y8G("ghs-label","scenario.stats.heal"),t.R7$(),t.Dyx(t.bMT(9,6,n.characters)),t.R7$(4),t.Y8G("ghs-label","scenario.stats.kills"),t.R7$(),t.Dyx(t.bMT(14,8,n.characters)),t.R7$(4),t.Y8G("ghs-label","scenario.stats.max"),t.R7$(),t.Dyx(t.bMT(19,10,n.characters))}}function Ev(a,r){if(1&a&&(t.j41(0,"div",16)(1,"span",17),t.nrm(2,"span",3),t.k0s(),t.Z7z(3,UM,6,11,"span",18,Et),t.nI1(5,"trackUUID"),t.j41(6,"span",19),t.nrm(7,"span",3),t.k0s(),t.Z7z(8,LM,3,2,"span",20,Et),t.nI1(10,"trackUUID"),t.nVh(11,HM,5,3),t.nVh(12,WM,5,3),t.nVh(13,QM,2,0),t.nVh(14,s1,6,5),t.j41(15,"span",21),t.nVh(16,r1,1,1,"span",3),t.nVh(17,c1,2,2),t.k0s(),t.Z7z(18,d1,2,2,null,null,Et),t.nI1(20,"trackUUID"),t.Z7z(21,p1,6,5,null,null,t.fX1),t.j41(23,"span",19),t.nrm(24,"span",3),t.k0s(),t.Z7z(25,u1,3,3,"span",20,Et),t.nI1(27,"trackUUID"),t.nVh(28,P1,6,4),t.nVh(29,x1,5,3),t.nVh(30,S1,6,5),t.j41(31,"span",21),t.nrm(32,"span",3),t.k0s(),t.Z7z(33,F1,2,2,null,null,Et),t.nI1(35,"trackUUID"),t.nVh(36,L1,5,3),t.Z7z(37,K1,5,6,null,null,Et),t.nI1(39,"trackUUID"),t.nVh(40,J1,5,6),t.nVh(41,nv,5,3),t.nVh(42,mv,5,3),t.nVh(43,fv,5,3),t.nVh(44,Cv,2,3),t.nVh(45,xv,20,12),t.k0s()),2&a){const n=t.XpG();t.xc7("--ghs-summary-columns",1+n.characters.length),t.R7$(2),t.Y8G("ghs-label","scenario.summary.name"),t.R7$(),t.Dyx(t.bMT(5,22,n.characters)),t.R7$(4),t.Y8G("ghs-label","scenario.summary.loot"),t.R7$(),t.Dyx(t.bMT(10,24,n.characters)),t.R7$(3),t.vxM(n.success&&n.rewards&&n.rewards.gold?11:-1),t.R7$(),t.vxM(n.success&&n.rewards&&n.rewards.collectiveGold?12:-1),t.R7$(),t.vxM(n.success&&n.rewards&&n.rewards.collectiveResources?13:-1),t.R7$(),t.vxM(n.success&&n.gameManager.trialsManager.favorsEnabled&&n.gameManager.trialsManager.apply&&n.gameManager.trialsManager.activeFavor("fh","wealth")?14:-1),t.R7$(2),t.vxM(n.totalGold?-1:16),t.R7$(),t.vxM(n.totalGold?17:-1),t.R7$(),t.Dyx(t.bMT(20,26,n.characters)),t.R7$(3),t.Dyx(n.lootColumns),t.R7$(3),t.Y8G("ghs-label","scenario.summary.xpGained"),t.R7$(),t.Dyx(t.bMT(27,28,n.characters)),t.R7$(3),t.vxM(!n.success||n.rewards&&n.rewards.ignoredBonus&&n.rewards.ignoredBonus.includes("experience")?-1:28),t.R7$(),t.vxM(n.success&&n.challenges>0?29:-1),t.R7$(),t.vxM(n.success&&n.gameManager.trialsManager.favorsEnabled&&n.gameManager.trialsManager.apply&&n.gameManager.trialsManager.activeFavor("fh","knowledge")?30:-1),t.R7$(2),t.Y8G("ghs-label","scenario.summary.xp"),t.R7$(),t.Dyx(t.bMT(35,30,n.characters)),t.R7$(3),t.vxM(n.gameManager.scenarioManager.getTreasures(n.scenario,n.gameManager.game.sections).length>0?36:-1),t.R7$(),t.Dyx(t.bMT(39,32,n.rewardItems)),t.R7$(3),t.vxM(n.randomItem?40:-1),t.R7$(),t.vxM(n.randomItems&&n.randomItems.length>0?41:-1),t.R7$(),t.vxM(n.success?42:-1),t.R7$(),t.vxM(n.success&&n.gameManager.trialsManager.trialsEnabled?43:-1),t.R7$(),t.vxM(n.settingsManager.settings.scenarioStats?44:-1),t.R7$(),t.vxM(n.stats?45:-1)}}function wv(a,r){1&a&&(t.j41(0,"div",67)(1,"span"),t.nrm(2,"span",3),t.k0s()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","scenario.summary.alreadyWarning.hint"))}function Rv(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",13)(1,"label"),t.nrm(2,"span",3),t.k0s(),t.j41(3,"div",66),t.nVh(4,wv,3,1,"div",67),t.j41(5,"div",67)(6,"a",68),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.updateState(!e.forceCampaign))}),t.nrm(7,"span",3),t.k0s()()()()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","scenario.summary.alreadyWarning"),t.R7$(2),t.vxM(n.forceCampaign?-1:4),t.R7$(3),t.Y8G("ghs-label","scenario.summary.alreadyWarning."+(n.forceCampaign?"reapply":"ignore"))}}function jv(a,r){1&a&&(t.j41(0,"div",67)(1,"span"),t.nrm(2,"span",3),t.k0s()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","scenario.summary.casualWarning.hintFh"))}function Gv(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",67)(1,"a",68),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return e.characterProgress=!e.gameManager.fhRules()||!e.characterProgress,c.Njj(e.updateState())}),t.nrm(2,"span",3),t.k0s()()}if(2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","scenario.summary.casualWarning."+(n.characterProgress||n.forceCampaign?"reapply":"ignore"))}}function Tv(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",67)(1,"a",68),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.updateState(!0))}),t.nrm(2,"span",3),t.k0s()()}2&a&&(t.R7$(2),t.Y8G("ghs-label","scenario.summary.casualWarning.campaignRewards"))}function Sv(a,r){if(1&a&&(t.j41(0,"div",13)(1,"label"),t.nrm(2,"span",3),t.k0s(),t.j41(3,"div",66),t.nVh(4,jv,3,1,"div",67),t.nVh(5,Gv,3,1,"div",67),t.nVh(6,Tv,3,1,"div",67),t.k0s()()),2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","scenario.summary.casualWarning"+(n.gameManager.fhRules()?".fh":"")),t.R7$(2),t.vxM(!n.characterProgress&&n.gameManager.fhRules()?4:-1),t.R7$(),t.vxM(n.forceCampaign||n.gameManager.fhRules()?5:-1),t.R7$(),t.vxM(n.forceCampaign?-1:6)}}function Dv(a,r){1&a&&(t.j41(0,"div",13)(1,"label"),t.nrm(2,"span",3),t.k0s(),t.j41(3,"div",66)(4,"div",67),t.nrm(5,"span",71),t.k0s()()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","scenario.summary.conclusionWarning"),t.R7$(3),t.Y8G("ghs-label","scenario.summary.conclusionWarning.hint"))}function $v(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function Iv(a,r){if(1&a&&(t.j41(0,"div",72),t.nrm(1,"span",3)(2,"span",3),t.nVh(3,$v,2,0,"span"),t.k0s()),2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG(4);t.R7$(),t.Y8G("ghs-label",o.gameManager.scenarioManager.scenarioTitle(o.gameManager.scenarioManager.getScenario(i,o.scenario.edition,o.scenario.group))),t.R7$(),t.Y8G("ghs-label","%data.scenarioNumber:"+i+"%"),t.R7$(),t.vxM(o.scenario.unlocks.length>1&&e<o.scenario.unlocks.length-1?3:-1)}}function Av(a,r){if(1&a&&t.nVh(0,Iv,4,3,"div",72),2&a){const n=r.$implicit,i=t.XpG(4);t.vxM(i.gameManager.scenarioManager.getScenario(n,i.scenario.edition,i.scenario.group)?0:-1)}}function Vv(a,r){if(1&a&&(t.j41(0,"div",66),t.Z7z(1,Av,1,1,null,null,t.fX1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(n.scenario.unlocks)}}function Fv(a,r){if(1&a){const n=t.RV6();t.j41(0,"label",73)(1,"input",74),t.bIt("change",function(){const e=c.eBV(n).$implicit,o=t.XpG(4);return c.Njj(o.selectLocation(e))}),t.k0s(),t.nrm(2,"span",3)(3,"span",3),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(4);t.R7$(),t.Y8G("value",n)("checked",i.chooseLocation==n),t.R7$(),t.Y8G("ghs-label",i.gameManager.scenarioManager.scenarioTitle(i.gameManager.scenarioManager.getScenario(n,i.scenario.edition,i.scenario.group))),t.R7$(),t.Y8G("ghs-label","%data.scenarioNumber:"+n+"%")}}function Xv(a,r){if(1&a&&(t.j41(0,"div",66)(1,"div",67),t.nrm(2,"span",3),t.EFF(3,":"),t.k0s(),t.Z7z(4,Fv,4,4,"label",73,t.fX1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.chooseLocation"),t.R7$(2),t.Dyx(n.rewards.chooseLocation)}}function Bv(a,r){if(1&a&&(t.j41(0,"div",69)(1,"label"),t.nrm(2,"span",3),t.k0s(),t.nVh(3,Vv,3,0,"div",66),t.nVh(4,Xv,6,1,"div",66),t.k0s()),2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label",n.scenario.unlocks&&n.scenario.unlocks.length>1||n.rewards&&n.rewards.chooseLocation&&n.rewards.chooseLocation.length>1?"scenario.rewards.locations":"scenario.rewards.location"),t.R7$(),t.vxM(n.scenario.unlocks?3:-1),t.R7$(),t.vxM(n.rewards&&n.rewards.chooseLocation&&n.rewards.chooseLocation.length?4:-1)}}function Yv(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function Uv(a,r){if(1&a&&(t.j41(0,"div",72),t.nrm(1,"span",3)(2,"span",3),t.nVh(3,Yv,2,0,"span"),t.k0s()),2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG(3);t.R7$(),t.Y8G("ghs-label",o.gameManager.scenarioManager.scenarioTitle(o.gameManager.scenarioManager.getScenario(i,o.scenario.edition,o.scenario.group))),t.R7$(),t.Y8G("ghs-label","%data.scenarioNumber:"+i+"%"),t.R7$(),t.vxM(o.conclusion.unlocks.length>1&&e<o.conclusion.unlocks.length-1?3:-1)}}function Nv(a,r){if(1&a&&t.nVh(0,Uv,4,3,"div",72),2&a){const n=r.$implicit,i=t.XpG(3);t.vxM(i.gameManager.scenarioManager.getScenario(n,i.conclusion.edition,i.conclusion.group)?0:-1)}}function zv(a,r){if(1&a&&(t.j41(0,"div",69)(1,"label"),t.nrm(2,"span",3),t.k0s(),t.j41(3,"div",66),t.Z7z(4,Nv,1,1,null,null,t.fX1),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label",n.conclusion.unlocks.length>1?"scenario.rewards.locations":"scenario.rewards.location"),t.R7$(2),t.Dyx(n.conclusion.unlocks)}}function Lv(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG().$index,i=t.XpG(3);t.Y8G("ghs-label",i.rewards.hints.globalAchievements[n])}}function qv(a,r){if(1&a&&(t.j41(0,"div",75)(1,"span"),t.nrm(2,"span",3),t.k0s(),t.nVh(3,Lv,1,1,"span",76),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","data.globalAchievements."+n),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.globalAchievements&&e.rewards.hints.globalAchievements[i]?3:-1)}}function Hv(a,r){if(1&a&&(t.j41(0,"div",70)(1,"label"),t.nrm(2,"span",3),t.EFF(3,":"),t.k0s(),t.j41(4,"div",66),t.Z7z(5,qv,4,2,"div",75,t.fX1),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.globalAchievements"),t.R7$(3),t.Dyx(n.rewards.globalAchievements)}}function Kv(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG().$index,i=t.XpG(3);t.Y8G("ghs-label",i.rewards.hints.lostPartyAchievements[n])}}function Wv(a,r){if(1&a&&(t.j41(0,"div",75)(1,"span"),t.nrm(2,"span",3),t.k0s(),t.nVh(3,Kv,1,1,"span",76),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","data.partyAchievements."+n),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.lostPartyAchievements&&e.rewards.hints.lostPartyAchievements[i]?3:-1)}}function Zv(a,r){if(1&a&&(t.j41(0,"div",70)(1,"label"),t.nrm(2,"span",3),t.EFF(3,":"),t.k0s(),t.j41(4,"div",66),t.Z7z(5,Wv,4,2,"div",75,t.fX1),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.lostPartyAchievements"),t.R7$(3),t.Dyx(n.rewards.lostPartyAchievements)}}function Jv(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG().$index,i=t.XpG(3);t.Y8G("ghs-label",i.rewards.hints.partyAchievements[n])}}function Qv(a,r){if(1&a&&(t.j41(0,"div",75)(1,"span"),t.nrm(2,"span",3),t.k0s(),t.nVh(3,Jv,1,1,"span",76),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","data.partyAchievements."+n),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.partyAchievements&&e.rewards.hints.partyAchievements[i]?3:-1)}}function tO(a,r){if(1&a&&(t.j41(0,"div",70)(1,"label"),t.nrm(2,"span",3),t.EFF(3,":"),t.k0s(),t.j41(4,"div",66),t.Z7z(5,Qv,4,2,"div",75,t.fX1),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.partyAchievements"),t.R7$(3),t.Dyx(n.rewards.partyAchievements)}}function nO(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG().$index,i=t.XpG(3);t.Y8G("ghs-label",i.rewards.hints.campaignSticker[n])}}function eO(a,r){if(1&a&&(t.j41(0,"div",75)(1,"span"),t.nrm(2,"span",3),t.k0s(),t.nVh(3,nO,1,1,"span",76),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","data.campaignSticker."+n),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.campaignSticker&&e.rewards.hints.campaignSticker[i]?3:-1)}}function aO(a,r){if(1&a&&(t.j41(0,"div",70)(1,"label"),t.nrm(2,"span",3),t.EFF(3,":"),t.k0s(),t.j41(4,"div",66),t.Z7z(5,eO,4,2,"div",75,t.fX1),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.campaignSticker"),t.R7$(3),t.Dyx(n.rewards.campaignSticker)}}function iO(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG().$index,i=t.XpG(3);t.Y8G("ghs-label",i.rewards.hints.calendarSection[n])}}function oO(a,r){if(1&a&&(t.j41(0,"div",75),t.nrm(1,"span",77),t.nVh(2,iO,1,1,"span",76),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.rewards.calendarSection.add"+(n.split("-")[1].split(":").length>1?".next":""))("ghs-label-args",t.sMw(3,He,n.split("-")[0],n.split("-")[1].split(":").length>1?n.split("-")[1].split(":")[1]:n.split("-")[1],n.split("-")[1].split(":").length>1?n.split("-")[1].split(":")[0]:"")),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.calendarSection&&e.rewards.hints.calendarSection[i]?2:-1)}}function sO(a,r){if(1&a&&(t.j41(0,"div",70)(1,"label"),t.nrm(2,"span",3),t.EFF(3,":"),t.k0s(),t.j41(4,"div",66),t.Z7z(5,oO,3,7,"div",75,t.fX1),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.calendarSection"),t.R7$(3),t.Dyx(n.rewards.calendarSection)}}function rO(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",75),t.nrm(1,"span",71),t.j41(2,"input",78),t.bIt("change",function(e){const o=c.eBV(n).$index,g=t.XpG(3);return c.Njj(g.changeCalendarSectionManual(e,o))}),t.k0s()()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.R7$(),t.Y8G("ghs-label",n.hint),t.R7$(),t.Y8G("value",e.calendarSectionManual[i]||-1)}}function cO(a,r){if(1&a&&(t.j41(0,"div",70)(1,"label"),t.nrm(2,"span",3),t.EFF(3,":"),t.k0s(),t.j41(4,"div",66),t.Z7z(5,rO,3,2,"div",75,Et),t.nI1(7,"trackUUID"),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.calendarSection"),t.R7$(3),t.Dyx(t.bMT(7,1,n.rewards.calendarSectionManual))}}function lO(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG().$index,i=t.XpG(3);t.Y8G("ghs-label",i.rewards.hints.envelopes[n])}}function gO(a,r){if(1&a&&(t.j41(0,"div",79),t.nrm(1,"span",77),t.nVh(2,lO,1,1,"span",76),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.rewards.envelope")("ghs-label-args",t.eq3(3,Ot,n)),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.envelopes&&e.rewards.hints.envelopes[i]?2:-1)}}function dO(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG(4);t.Y8G("ghs-label",n.rewards.hints.gold)}}function hO(a,r){if(1&a&&(t.j41(0,"div",80)(1,"span"),t.nrm(2,"span",42),t.k0s(),t.nVh(3,dO,1,1,"span",76),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.gold")("ghs-label-args",t.eq3(3,Ot,""+n.rewards.gold)),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.gold?3:-1)}}function _O(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG(4);t.Y8G("ghs-label",n.rewards.hints.experience)}}function mO(a,r){if(1&a&&(t.j41(0,"div",81)(1,"span"),t.nrm(2,"span",42),t.k0s(),t.nVh(3,_O,1,1,"span",76),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.experience")("ghs-label-args",t.eq3(3,Ot,""+n.rewards.experience)),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.experience?3:-1)}}function pO(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG(4);t.Y8G("ghs-label",n.rewards.hints.collectiveGold)}}function uO(a,r){if(1&a&&(t.j41(0,"div",82)(1,"span"),t.nrm(2,"span",42),t.k0s(),t.nVh(3,pO,1,1,"span",76),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.collectiveGold")("ghs-label-args",t.eq3(3,Ot,""+n.rewards.collectiveGold)),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.collectiveGold?3:-1)}}function fO(a,r){if(1&a&&t.nrm(0,"span",77),2&a){const n=t.XpG().$implicit,i=t.XpG(4);t.Y8G("ghs-label","scenario.rewards.resources"+(i.EntityValueFunction(n.value)<0?"Lose":""))("ghs-label-args",t.l_i(2,gn,n.type,""+i.EntityValueFunction(n.value)))}}function CO(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG().$index,i=t.XpG(4);t.Y8G("ghs-label",i.rewards.hints.resources[n])}}function MO(a,r){if(1&a&&(t.nVh(0,fO,1,5,"span",77),t.nVh(1,CO,1,1,"span",76)),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(4);t.vxM(n.value?0:-1),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.resources&&e.rewards.hints.resources[i]?1:-1)}}function vO(a,r){if(1&a&&(t.j41(0,"div",83),t.Z7z(1,MO,2,2,null,null,Et),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(3,0,n.rewards.resources))}}function OO(a,r){if(1&a&&t.nrm(0,"span",77),2&a){const n=t.XpG().$implicit,i=t.XpG(4);t.Y8G("ghs-label","scenario.rewards.collectiveResources"+(i.EntityValueFunction(n.value)<0?"Lose":""))("ghs-label-args",t.l_i(2,gn,n.type,i.EntityValueFunction(n.value)))}}function PO(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG().$index,i=t.XpG(4);t.Y8G("ghs-label",i.rewards.hints.resources[n])}}function bO(a,r){if(1&a&&(t.nVh(0,OO,1,5,"span",77),t.nVh(1,PO,1,1,"span",76)),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(4);t.vxM(n.value?0:-1),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.resources&&e.rewards.hints.resources[i]?1:-1)}}function kO(a,r){if(1&a&&(t.j41(0,"div",84),t.Z7z(1,bO,2,2,null,null,Et),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(3,0,n.rewards.collectiveResources))}}function yO(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG(4);t.Y8G("ghs-label",n.rewards.hints.reputation)}}function xO(a,r){if(1&a&&(t.j41(0,"div",85)(1,"span"),t.nrm(2,"span",27),t.nI1(3,"ghsValueSign"),t.k0s(),t.nVh(4,yO,1,1,"span",76),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.reputation")("ghs-label-args",t.eq3(5,Ot,t.bMT(3,3,n.rewards.reputation))),t.R7$(2),t.vxM(n.rewards.hints&&n.rewards.hints.reputation?4:-1)}}function EO(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG().$index,i=t.XpG(4);t.Y8G("ghs-label",i.rewards.hints.reputationFactions[n])}}function wO(a,r){if(1&a&&(t.j41(0,"span"),t.nrm(1,"span",27),t.k0s(),t.nVh(2,EO,1,1,"span",76)),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(4);t.R7$(),t.Y8G("ghs-label","scenario.rewards.reputationFactions")("ghs-label-args",t.l_i(3,gn,n.split(":")[0],n.split(":")[1])),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.reputationFactions[i]?2:-1)}}function RO(a,r){if(1&a&&(t.j41(0,"div",86),t.Z7z(1,wO,3,6,null,null,t.fX1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(n.rewards.reputationFactions)}}function jO(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG(4);t.Y8G("ghs-label",n.rewards.hints.prosperity)}}function GO(a,r){if(1&a&&(t.j41(0,"div",87)(1,"span"),t.nrm(2,"span",77),t.nI1(3,"ghsValueSign"),t.k0s(),t.nVh(4,jO,1,1,"span",76),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.prosperity")("ghs-label-args",t.eq3(5,Ot,""+t.bMT(3,3,n.rewards.prosperity))),t.R7$(2),t.vxM(n.rewards.hints&&n.rewards.hints.prosperity?4:-1)}}function TO(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG(4);t.Y8G("ghs-label",n.rewards.hints.inspiration)}}function SO(a,r){if(1&a&&(t.j41(0,"div",88)(1,"span"),t.nrm(2,"span",77),t.nI1(3,"ghsValueSign"),t.k0s(),t.nVh(4,TO,1,1,"span",76),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.inspiration")("ghs-label-args",t.eq3(5,Ot,t.bMT(3,3,n.EntityValueFunction(n.rewards.inspiration)))),t.R7$(2),t.vxM(n.rewards.hints&&n.rewards.hints.inspiration?4:-1)}}function DO(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG(4);t.Y8G("ghs-label",n.rewards.hints.morale)}}function $O(a,r){if(1&a&&(t.j41(0,"div",89)(1,"span"),t.nrm(2,"span",77),t.nI1(3,"ghsValueSign"),t.k0s(),t.nVh(4,DO,1,1,"span",76),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.morale")("ghs-label-args",t.eq3(5,Ot,t.bMT(3,3,n.EntityValueFunction(n.rewards.morale)))),t.R7$(2),t.vxM(n.rewards.hints&&n.rewards.hints.morale?4:-1)}}function IO(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG(4);t.Y8G("ghs-label",n.rewards.hints.perks)}}function AO(a,r){if(1&a&&(t.j41(0,"div",90)(1,"span"),t.nrm(2,"span",77),t.k0s(),t.nVh(3,IO,1,1,"span",76),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.perks")("ghs-label-args",t.eq3(3,Ot,""+n.rewards.perks)),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.perks?3:-1)}}function VO(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG(4);t.Y8G("ghs-label",n.rewards.hints.battleGoals)}}function FO(a,r){if(1&a&&(t.j41(0,"div",91),t.nrm(1,"span",77),t.nVh(2,VO,1,1,"span",76),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.rewards.battleGoals")("ghs-label-args",t.eq3(3,Ot,""+n.rewards.battleGoals)),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.battleGoals?2:-1)}}function XO(a,r){if(1&a&&(t.j41(0,"div",87)(1,"span"),t.nrm(2,"span",77),t.k0s()()),2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.factionUnlock")("ghs-label-args",t.eq3(2,Ot,n.rewards.factionUnlock))}}function BO(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",104),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(3);return c.Njj(o.openItemDialog(o.gameManager.itemManager.getItem(e.split(":")[0].split("-")[0],e.split(":")[0].split("-").slice(1).join("-")||o.scenario.edition||"",!0)))}),t.k0s()}if(2&a){let n;const i=t.XpG().$implicit,e=t.XpG(3);t.Y8G("ghs-label","scenario.rewards.items")("ghs-label-args",t.sMw(2,He,i.split(":")[0].split("-")[0],(null==(n=e.gameManager.itemManager.getItem(i.split(":")[0].split("-")[0],i.split(":")[0].split("-").slice(1).join("-")||e.scenario.edition||"",!0))?null:n.name)||"",i.split(":")[1]))}}function YO(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",104),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(3);return c.Njj(o.openItemDialog(o.gameManager.itemManager.getItem(e.split("-")[0],e.split("-").slice(1).join("-")||o.scenario.edition||"",!0)))}),t.k0s()}if(2&a){let n;const i=t.XpG().$implicit,e=t.XpG(3);t.Y8G("ghs-label","scenario.rewards.item")("ghs-label-args",t.l_i(2,gn,i.split("-")[0],(null==(n=e.gameManager.itemManager.getItem(i.split("-")[0],i.split("-").slice(1).join("-")||e.scenario.edition||"",!0))?null:n.name)||""))}}function UO(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG().$index,i=t.XpG(3);t.Y8G("ghs-label",i.rewards.hints.items[n])}}function NO(a,r){if(1&a&&(t.j41(0,"div",92),t.nVh(1,BO,1,6,"span",77),t.nVh(2,YO,1,5,"span",77),t.nVh(3,UO,1,1,"span",76),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.R7$(),t.vxM(n.includes(":")?1:-1),t.R7$(),t.vxM(n.includes(":")?-1:2),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.items&&e.rewards.hints.items[i]?3:-1)}}function zO(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",104),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(5);return c.Njj(o.openItemDialog(o.gameManager.itemManager.getItem(e.split(":")[0].split("-")[0],e.split(":")[0].split("-").slice(1).join("-")||o.scenario.edition||"",!0)))}),t.k0s()}if(2&a){let n;const i=t.XpG().$implicit,e=t.XpG(5);t.Y8G("ghs-label","scenario.rewards.items")("ghs-label-args",t.sMw(2,He,i.split(":")[0].split("-")[0],(null==(n=e.gameManager.itemManager.getItem(i.split(":")[0].split("-")[0],i.split(":")[0].split("-").slice(1).join("-")||e.scenario.edition||"",!0))?null:n.name)||"",i.split(":")[1]))}}function LO(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",104),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(5);return c.Njj(o.openItemDialog(o.gameManager.itemManager.getItem(e.split("-")[0],e.split("-").slice(1).join("-")||o.scenario.edition||"",!0)))}),t.k0s()}if(2&a){let n;const i=t.XpG().$implicit,e=t.XpG(5);t.Y8G("ghs-label","scenario.rewards.item")("ghs-label-args",t.l_i(2,gn,i.split("-")[0],(null==(n=e.gameManager.itemManager.getItem(i.split("-")[0],i.split("-").slice(1).join("-")||e.scenario.edition||"",!0))?null:n.name)||""))}}function qO(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG(2).$index,i=t.XpG(4);t.Y8G("ghs-label",i.rewards.hints.chooseItem[n])}}function HO(a,r){if(1&a&&(t.nVh(0,zO,1,6,"span",77),t.nVh(1,LO,1,5,"span",77),t.nVh(2,qO,1,1,"span",76)),2&a){const n=r.$implicit,i=t.XpG().$index,e=t.XpG(4);t.vxM(n.includes(":")?0:-1),t.R7$(),t.vxM(n.includes(":")?-1:1),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.chooseItem&&e.rewards.hints.chooseItem[i]?2:-1)}}function KO(a,r){1&a&&t.nrm(0,"span",71),2&a&&t.Y8G("ghs-label","or")}function WO(a,r){if(1&a&&(t.Z7z(0,HO,3,3,null,null,t.fX1),t.nVh(2,KO,1,1,"span",71)),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(4);t.Dyx(n||t.lJ4(1,Jt)),t.R7$(2),t.vxM(i<e.rewards.chooseItem.length-1?2:-1)}}function ZO(a,r){if(1&a&&(t.j41(0,"div",93)(1,"span"),t.nrm(2,"span",3),t.k0s(),t.Z7z(3,WO,3,2,null,null,t.fX1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.chooseItem"),t.R7$(),t.Dyx(n.rewards.chooseItem||t.lJ4(1,Jt))}}function JO(a,r){if(1&a&&t.nrm(0,"span",77),2&a){const n=t.XpG().$implicit;t.Y8G("ghs-label","scenario.rewards.itemDesignRange")("ghs-label-args",t.eq3(2,Ot,n))}}function QO(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",104),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(3);return c.Njj(o.openItemDialog(o.gameManager.itemManager.getItem(e.split(":")[0],e.includes(":")?e.split(":")[1]:o.scenario.edition||"",!0)))}),t.k0s()}if(2&a){let n;const i=t.XpG().$implicit,e=t.XpG(3);t.Y8G("ghs-label","scenario.rewards.itemDesign")("ghs-label-args",t.l_i(2,gn,i,(null==(n=e.gameManager.itemManager.getItem(i.split(":")[0],i.includes(":")?i.split(":")[1]:e.scenario.edition||"",!0))?null:n.name)||""))}}function tP(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",104),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(3);return c.Njj(o.openItemDialog(o.gameManager.itemManager.getItem(e.split(":")[0],e.split(":")[1],!0)))}),t.k0s()}if(2&a){let n;const i=t.XpG().$implicit,e=t.XpG(3);t.Y8G("ghs-label","scenario.rewards.itemDesignEdition")("ghs-label-args",t.sMw(2,He,i.split(":")[0],(null==(n=e.gameManager.itemManager.getItem(i.split(":")[0],i.split(":")[1],!0))?null:n.name)||"",i.split(":")[1]))}}function nP(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG().$index,i=t.XpG(3);t.Y8G("ghs-label",i.rewards.hints.itemDesigns[n])}}function eP(a,r){if(1&a&&(t.j41(0,"div",94),t.nVh(1,JO,1,4,"span",77),t.nVh(2,QO,1,5,"span",77),t.nVh(3,tP,1,6,"span",77),t.nVh(4,nP,1,1,"span",76),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.R7$(),t.vxM(n.includes("-")?1:-1),t.R7$(),t.vxM(n.includes("-")||n.includes(":")?-1:2),t.R7$(),t.vxM(!n.includes("-")&&n.includes(":")?3:-1),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.itemDesigns&&e.rewards.hints.itemDesigns[i]?4:-1)}}function aP(a,r){if(1&a&&t.nrm(0,"span",77),2&a){const n=t.XpG().$implicit;t.Y8G("ghs-label","scenario.rewards.itemBlueprintRange")("ghs-label-args",n.split("-"))}}function iP(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",104),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(3);return c.Njj(o.openItemDialog(o.gameManager.itemManager.getItem(e,o.scenario.edition||"",!0)))}),t.k0s()}if(2&a){let n;const i=t.XpG().$implicit,e=t.XpG(3);t.Y8G("ghs-label","scenario.rewards.itemBlueprint")("ghs-label-args",t.l_i(2,gn,i,(null==(n=e.gameManager.itemManager.getItem(i,e.scenario.edition||"",!0))?null:n.name)||""))}}function oP(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG().$index,i=t.XpG(3);t.Y8G("ghs-label",i.rewards.hints.itemBlueprints[n])}}function sP(a,r){if(1&a&&(t.j41(0,"div",95),t.nVh(1,aP,1,2,"span",77),t.nVh(2,iP,1,5,"span",77),t.nVh(3,oP,1,1,"span",76),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.R7$(),t.vxM(n.includes("-")?1:-1),t.R7$(),t.vxM(n.includes("-")?-1:2),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.itemBlueprints&&e.rewards.hints.itemBlueprints[i]?3:-1)}}function rP(a,r){if(1&a&&t.nrm(0,"span",77),2&a){const n=t.XpG(4);t.Y8G("ghs-label","scenario.rewards.randomItemBlueprints")("ghs-label-args",n.rewards.randomItemBlueprints.split("-"))}}function cP(a,r){if(1&a&&(t.j41(0,"div",95),t.nVh(1,rP,1,2,"span",77),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.vxM(n.rewards.randomItemBlueprints.includes("-")?1:-1)}}function lP(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",104),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(4);return c.Njj(o.openItemDialog(o.gameManager.itemManager.getItem(e,o.scenario.edition||"",!0)))}),t.k0s()}if(2&a){let n;const i=t.XpG().$implicit,e=t.XpG(4);t.Y8G("ghs-label","scenario.rewards.itemBlueprint")("ghs-label-args",t.l_i(2,gn,i,(null==(n=e.gameManager.itemManager.getItem(i,e.scenario.edition||"",!0))?null:n.name)||""))}}function gP(a,r){1&a&&(t.j41(0,"span"),t.nrm(1,"span",42),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","scenario.rewards.inspiration")("ghs-label-args",t.lJ4(2,IM)))}function dP(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG(5);t.Y8G("ghs-label",n.rewards.hints.randomItemBlueprint)}}function hP(a,r){if(1&a&&(t.nVh(0,lP,1,5,"span",77),t.nVh(1,gP,2,3,"span"),t.nVh(2,dP,1,1,"span",76)),2&a){const n=r.$implicit,i=t.XpG(4);t.vxM(n>0?0:-1),t.R7$(),t.vxM(-1==n?1:-1),t.R7$(),t.vxM(i.rewards.hints&&i.rewards.hints.randomItemBlueprint?2:-1)}}function _P(a,r){if(1&a&&(t.j41(0,"div",95),t.nrm(1,"span",71),t.Z7z(2,hP,3,3,null,null,t.fX1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.rewards.randomItemBlueprint"),t.R7$(),t.Dyx(n.randomItemBlueprints)}}function mP(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG().$index,i=t.XpG(3);t.Y8G("ghs-label",i.rewards.hints.events[n])}}function pP(a,r){if(1&a&&(t.j41(0,"div",96),t.nrm(1,"span",77),t.nVh(2,mP,1,1,"span",76),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.rewards.event."+n.split(":")[0])("ghs-label-args",t.eq3(3,Ot,n.split(":")[1])),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.events&&e.rewards.hints.events[i]?2:-1)}}function uP(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG().$index,i=t.XpG(3);t.Y8G("ghs-label",i.rewards.hints.removeEvents[n])}}function fP(a,r){if(1&a&&(t.j41(0,"div",96),t.nrm(1,"span",77),t.nVh(2,uP,1,1,"span",76),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.rewards.removeEvent."+n.split(":")[0])("ghs-label-args",t.eq3(3,Ot,n.split(":")[1])),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.removeEvents&&e.rewards.hints.removeEvents[i]?2:-1)}}function CP(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG(4);t.Y8G("ghs-label",n.rewards.hints.overlayCampaignSticker)}}function MP(a,r){if(1&a&&t.nrm(0,"span",77),2&a){const n=t.XpG(4);t.Y8G("ghs-label","scenario.rewards.overlayCampaignSticker")("ghs-label-args",t.l_i(2,gn,n.rewards.overlayCampaignSticker.name,n.rewards.overlayCampaignSticker.location))}}function vP(a,r){if(1&a&&(t.j41(0,"div",97),t.nVh(1,CP,1,1,"span",76),t.nVh(2,MP,1,5,"span",77),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.overlayCampaignSticker?1:-1),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.overlayCampaignSticker?-1:2)}}function OP(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG(4);t.Y8G("ghs-label",n.rewards.hints.overlaySticker)}}function PP(a,r){if(1&a&&t.nrm(0,"span",77),2&a){const n=t.XpG(4);t.Y8G("ghs-label","scenario.rewards.overlaySticker")("ghs-label-args",t.l_i(2,gn,n.rewards.overlaySticker.name,n.rewards.overlaySticker.location))}}function bP(a,r){if(1&a&&(t.j41(0,"div",97),t.nVh(1,OP,1,1,"span",76),t.nVh(2,PP,1,5,"span",77),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.overlaySticker?1:-1),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.overlaySticker?-1:2)}}function kP(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG(4);t.Y8G("ghs-label",n.rewards.hints.pet)}}function yP(a,r){if(1&a&&t.nrm(0,"span",77),2&a){const n=t.XpG(4);t.Y8G("ghs-label","scenario.rewards.pet")("ghs-label-args",t.l_i(2,gn,n.rewards.pet,n.scenario.edition))}}function xP(a,r){if(1&a&&(t.j41(0,"div",97),t.nVh(1,kP,1,1,"span",76),t.nVh(2,yP,1,5,"span",77),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.pet?1:-1),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.pet?-1:2)}}function EP(a,r){if(1&a){const n=t.RV6();t.j41(0,"input",107),t.bIt("change",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(4);return c.Njj(o.selectCharacter(e))}),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG(4);t.Y8G("value",n)("checked",i.chooseUnlockCharacter==n)}}function wP(a,r){1&a&&(t.j41(0,"span"),t.nrm(1,"span",3),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","or"))}function RP(a,r){if(1&a&&(t.j41(0,"label",105),t.nVh(1,EP,1,2,"input",106),t.nrm(2,"span",77),t.nVh(3,wP,2,1,"span"),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(4);t.Y8G("ngClass",t.l_i(5,AM,e.unlocked(n),!e.settingsManager.settings.automaticUnlocking)),t.R7$(),t.vxM(e.settingsManager.settings.automaticUnlocking?1:-1),t.R7$(),t.Y8G("ghs-label","scenario.rewards.unlockCharacter.box")("ghs-label-args",t.eq3(8,Ot,n)),t.R7$(),t.vxM(i<e.rewards.chooseUnlockCharacter.length-1?3:-1)}}function jP(a,r){if(1&a&&(t.j41(0,"div",98)(1,"span"),t.nrm(2,"span",3),t.k0s(),t.Z7z(3,RP,4,10,"label",105,t.fX1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.unlockCharacter"),t.R7$(),t.Dyx(n.rewards.chooseUnlockCharacter)}}function GP(a,r){if(1&a&&(t.j41(0,"div",99)(1,"span"),t.nrm(2,"span",3),t.k0s(),t.nrm(3,"span",77),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.unlockCharacter"),t.R7$(),t.Y8G("ghs-label","scenario.rewards.unlockCharacter.box")("ghs-label-args",t.eq3(3,Ot,n.rewards.unlockCharacter))}}function TP(a,r){if(1&a&&(t.j41(0,"div",100),t.nrm(1,"span",71),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("ghs-label",n.rewards.custom)}}function SP(a,r){1&a&&(t.j41(0,"div",100),t.nrm(1,"span",71),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","scenario.rewards.repeatScenario"))}function DP(a,r){if(1&a&&t.nrm(0,"span",77),2&a){const n=t.XpG().$implicit;t.Y8G("ghs-label","scenario.rewards.eventDeck")("ghs-label-args",t.sMw(2,He,n.split(":")[0],n.split(":")[1].split("|")[0],n.split(":")[1].split("|")[1]))}}function $P(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG().$index,i=t.XpG(4);t.Y8G("ghs-label",i.rewards.hints.eventDecks[n])}}function IP(a,r){if(1&a&&(t.nVh(0,DP,1,6,"span",77),t.nVh(1,$P,1,1,"span",76)),2&a){const n=r.$index,i=t.XpG(4);t.vxM(i.rewards.hints&&i.rewards.hints.eventDecks&&i.rewards.hints.eventDecks[n]?-1:0),t.R7$(),t.vxM(i.rewards.hints&&i.rewards.hints.eventDecks&&i.rewards.hints.eventDecks[n]?1:-1)}}function AP(a,r){if(1&a&&(t.j41(0,"div",101),t.Z7z(1,IP,2,2,null,null,t.fX1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(n.rewards.eventDecks)}}function VP(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG().$index,i=t.XpG(3);t.Y8G("ghs-label",i.rewards.hints.lootDeckCards[n])}}function FP(a,r){if(1&a&&(t.j41(0,"div",102),t.nrm(1,"span",77),t.nVh(2,VP,1,1,"span",76),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.rewards.lootDeckCard")("ghs-label-args",t.eq3(3,Ot,n)),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.lootDeckCards&&e.rewards.hints.lootDeckCards[i]?2:-1)}}function XP(a,r){if(1&a&&t.nrm(0,"span",76),2&a){const n=t.XpG().$index,i=t.XpG(3);t.Y8G("ghs-label",i.rewards.hints.removeLootDeckCards[n])}}function BP(a,r){if(1&a&&(t.j41(0,"div",102),t.nrm(1,"span",77),t.nVh(2,XP,1,1,"span",76),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.rewards.removeLootDeckCard")("ghs-label-args",t.eq3(3,Ot,n)),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.removeLootDeckCards&&e.rewards.hints.removeLootDeckCards[i]?2:-1)}}function YP(a,r){if(1&a&&t.nrm(0,"span",77),2&a){const n=r.$implicit;t.Y8G("ghs-label","scenario.rewards.townGuardAm")("ghs-label-args",t.l_i(2,gn,n.value,n.valueType))}}function UP(a,r){if(1&a&&(t.j41(0,"div",103),t.Z7z(1,YP,1,5,"span",77,Et),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(3,0,n.townGuardAMs))}}function NP(a,r){if(1&a&&(t.j41(0,"div",14)(1,"label"),t.nrm(2,"span",3),t.EFF(3,":"),t.k0s(),t.j41(4,"div",66),t.Z7z(5,gO,3,5,"div",79,t.fX1),t.nVh(7,hO,4,5,"div",80),t.nVh(8,mO,4,5,"div",81),t.nVh(9,uO,4,5,"div",82),t.nVh(10,vO,4,2,"div",83),t.nVh(11,kO,4,2,"div",84),t.nVh(12,xO,5,7,"div",85),t.nVh(13,RO,3,0,"div",86),t.nVh(14,GO,5,7,"div",87),t.nVh(15,SO,5,7,"div",88),t.nVh(16,$O,5,7,"div",89),t.nVh(17,AO,4,5,"div",90),t.nVh(18,FO,3,5,"div",91),t.nVh(19,XO,3,4,"div",87),t.Z7z(20,NO,4,3,"div",92,t.fX1),t.nVh(22,ZO,5,2,"div",93),t.Z7z(23,eP,5,4,"div",94,t.fX1),t.Z7z(25,sP,4,3,"div",95,t.fX1),t.nVh(27,cP,2,1,"div",95),t.nVh(28,_P,4,1,"div",95),t.Z7z(29,pP,3,5,"div",96,t.fX1),t.Z7z(31,fP,3,5,"div",96,t.fX1),t.nVh(33,vP,3,2,"div",97),t.nVh(34,bP,3,2,"div",97),t.nVh(35,xP,3,2,"div",97),t.nVh(36,jP,5,1,"div",98),t.nVh(37,GP,4,5,"div",99),t.nVh(38,TP,2,1,"div",100),t.nVh(39,SP,2,1,"div",100),t.nVh(40,AP,3,0,"div",101),t.Z7z(41,FP,3,5,"div",102,t.fX1),t.Z7z(43,BP,3,5,"div",102,t.fX1),t.nVh(45,UP,4,2,"div",103),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","scenario.rewards"),t.R7$(3),t.Dyx(n.rewards.envelopes||t.lJ4(26,Jt)),t.R7$(2),t.vxM(n.rewards.gold?7:-1),t.R7$(),t.vxM(n.rewards.experience?8:-1),t.R7$(),t.vxM(n.rewards.collectiveGold?9:-1),t.R7$(),t.vxM(n.rewards.resources&&n.rewards.resources.length?10:-1),t.R7$(),t.vxM(n.rewards.collectiveResources&&n.rewards.collectiveResources.length?11:-1),t.R7$(),t.vxM(n.rewards.reputation?12:-1),t.R7$(),t.vxM(n.rewards.reputationFactions&&n.rewards.reputationFactions.length?13:-1),t.R7$(),t.vxM(n.rewards.prosperity?14:-1),t.R7$(),t.vxM(n.rewards.inspiration?15:-1),t.R7$(),t.vxM(n.rewards.morale?16:-1),t.R7$(),t.vxM(n.rewards.perks?17:-1),t.R7$(),t.vxM(n.rewards.battleGoals?18:-1),t.R7$(),t.vxM(n.rewards.factionUnlock?19:-1),t.R7$(),t.Dyx(n.rewards.items||t.lJ4(27,Jt)),t.R7$(2),t.vxM(n.rewards.chooseItem&&n.rewards.chooseItem.length>0?22:-1),t.R7$(),t.Dyx(n.rewards.itemDesigns||t.lJ4(28,Jt)),t.R7$(2),t.Dyx(n.rewards.itemBlueprints||t.lJ4(29,Jt)),t.R7$(2),t.vxM(n.rewards.randomItemBlueprints?27:-1),t.R7$(),t.vxM(n.rewards.randomItemBlueprint?28:-1),t.R7$(),t.Dyx(n.rewards.events||t.lJ4(30,Jt)),t.R7$(2),t.Dyx(n.rewards.removeEvents||t.lJ4(31,Jt)),t.R7$(2),t.vxM(n.rewards.overlayCampaignSticker?33:-1),t.R7$(),t.vxM(n.rewards.overlaySticker?34:-1),t.R7$(),t.vxM(n.rewards.pet?35:-1),t.R7$(),t.vxM(n.rewards&&n.rewards.chooseUnlockCharacter&&n.rewards.chooseUnlockCharacter.length>0?36:-1),t.R7$(),t.vxM(n.rewards&&n.rewards.unlockCharacter?37:-1),t.R7$(),t.vxM(n.rewards.custom?38:-1),t.R7$(),t.vxM(n.rewards.repeatScenario?39:-1),t.R7$(),t.vxM(n.rewards.eventDecks&&n.rewards.eventDecks.length?40:-1),t.R7$(),t.Dyx(n.rewards.lootDeckCards||t.lJ4(32,Jt)),t.R7$(2),t.Dyx(n.rewards.removeLootDeckCards||t.lJ4(33,Jt)),t.R7$(2),t.vxM(n.townGuardAMs&&n.townGuardAMs.length>0?45:-1)}}function zP(a,r){if(1&a&&(t.nVh(0,Dv,6,2,"div",13),t.nVh(1,Bv,5,3,"div",69),t.nVh(2,zv,6,1,"div",69),t.nVh(3,Hv,7,1,"div",70),t.nVh(4,Zv,7,1,"div",70),t.nVh(5,tO,7,1,"div",70),t.nVh(6,aO,7,1,"div",70),t.nVh(7,sO,7,1,"div",70),t.nVh(8,cO,8,3,"div",70),t.nVh(9,NP,46,34,"div",14)),2&a){const n=t.XpG();t.vxM(n.conclusionWarning?0:-1),t.R7$(),t.vxM(n.success&&(n.scenario.unlocks&&n.scenario.unlocks.length>0||n.rewards&&n.rewards.chooseLocation&&n.rewards.chooseLocation.length>0)?1:-1),t.R7$(),t.vxM(n.success&&(!n.scenario.unlocks||0==n.scenario.unlocks.length)&&n.conclusion&&n.conclusion.unlocks&&n.conclusion.unlocks.length>0?2:-1),t.R7$(),t.vxM(n.rewards&&n.rewards.globalAchievements&&n.rewards.globalAchievements.length>0?3:-1),t.R7$(),t.vxM(n.rewards&&n.rewards.lostPartyAchievements&&n.rewards.lostPartyAchievements.length>0?4:-1),t.R7$(),t.vxM(n.rewards&&n.rewards.partyAchievements&&n.rewards.partyAchievements.length>0?5:-1),t.R7$(),t.vxM(n.rewards&&n.rewards.campaignSticker&&n.rewards.campaignSticker.length>0?6:-1),t.R7$(),t.vxM(n.rewards&&n.rewards.calendarSection&&n.rewards.calendarSection.length>0?7:-1),t.R7$(),t.vxM(n.rewards&&n.rewards.calendarSectionManual&&n.rewards.calendarSectionManual.length>0?8:-1),t.R7$(),t.vxM(n.rewards&&n.hasRewards()?9:-1)}}function LP(a,r){if(1&a&&(t.j41(0,"div",88)(1,"span"),t.nrm(2,"span",42),t.nI1(3,"ghsValueSign"),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.inspiration")("ghs-label-args",t.eq3(4,Ot,t.bMT(3,2,n.EntityValueFunction("4-C"))))}}function qP(a,r){if(1&a){const n=t.RV6();t.j41(0,"input",55),t.bIt("change",function(e){c.eBV(n);const o=t.XpG(3);return c.Njj(o.toggleChallenges(e))}),t.k0s()}if(2&a){const n=t.XpG(3);t.Y8G("checked",n.challenges>0)}}function HP(a,r){if(1&a){const n=t.RV6();t.j41(0,"input",55),t.bIt("change",function(e){c.eBV(n);const o=t.XpG(3);return c.Njj(o.toggleChallenges(e,!0))}),t.k0s()}if(2&a){const n=t.XpG(3);t.Y8G("checked",n.challenges>1)}}function KP(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",111)(1,"ghs-challenge-card",112),t.bIt("click",function(){c.eBV(n);const e=t.XpG(4);return c.Njj(e.openChallenge(e.gameManager.game.challengeDeck.keep[1]))}),t.k0s(),t.j41(2,"input",55),t.bIt("change",function(e){c.eBV(n);const o=t.XpG(4);return c.Njj(o.toggleChallenges(e,!0))}),t.k0s()()}if(2&a){const n=t.XpG(4);t.R7$(),t.Y8G("challenge",n.gameManager.game.challengeDeck.cards[n.gameManager.game.challengeDeck.keep[1]])("flipped",!0),t.R7$(),t.Y8G("checked",n.challenges>1)}}function WP(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",110)(1,"div",111)(2,"ghs-challenge-card",112),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openChallenge(e.gameManager.game.challengeDeck.keep[0]))}),t.k0s(),t.j41(3,"input",55),t.bIt("change",function(e){c.eBV(n);const o=t.XpG(3);return c.Njj(o.toggleChallenges(e))}),t.k0s()(),t.nVh(4,KP,3,3,"div",111),t.k0s()}if(2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("challenge",n.gameManager.game.challengeDeck.cards[n.gameManager.game.challengeDeck.keep[0]])("flipped",!0),t.R7$(),t.Y8G("checked",n.challenges>0),t.R7$(),t.vxM(n.numberChallenges>1?4:-1)}}function ZP(a,r){if(1&a&&(t.j41(0,"div",108)(1,"div",109),t.nrm(2,"span",3),t.nVh(3,qP,1,1,"input",50),t.nVh(4,HP,1,1,"input",50),t.k0s(),t.nVh(5,WP,5,4,"div",110),t.k0s()),2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","scenario.summary.challenges."+(n.numberChallenges>1?"completed":"complete")),t.R7$(),t.vxM(n.gameManager.challengesManager.enabled?-1:3),t.R7$(),t.vxM(!n.gameManager.challengesManager.enabled&&n.numberChallenges>1?4:-1),t.R7$(),t.vxM(n.gameManager.challengesManager.enabled?5:-1)}}function JP(a,r){if(1&a&&(t.j41(0,"div",14)(1,"label"),t.nrm(2,"span",3),t.EFF(3,":"),t.k0s(),t.j41(4,"div",66),t.nVh(5,LP,4,6,"div",88),t.nVh(6,ZP,6,4,"div",108),t.k0s()()),2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","scenario.rewards.bonus"),t.R7$(3),t.vxM(!n.gameManager.fhRules()||!n.EntityValueFunction("4-C")||n.rewards&&n.rewards.ignoredBonus&&n.rewards.ignoredBonus.includes("inspiration")?-1:5),t.R7$(),t.vxM(n.numberChallenges>0?6:-1)}}function QP(a,r){1&a&&(t.j41(0,"div",114)(1,"span"),t.nrm(2,"span",5),t.k0s()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","scenario.rewards.addWeek.winter"))}function tb(a,r){1&a&&(t.j41(0,"div",115)(1,"span"),t.nrm(2,"span",5),t.k0s()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","scenario.rewards.addWeek.summer"))}function nb(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",118),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.showWeekConclusion(e))}),t.k0s()}if(2&a){const n=r.$implicit;t.Y8G("ghs-label","scenario.rewards.addWeek.section")("ghs-label-args",t.eq3(2,Ot,n.index))}}function eb(a,r){if(1&a&&(t.j41(0,"div",116),t.Z7z(1,nb,1,4,"span",117,Et),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Dyx(t.bMT(3,0,n.weekSections()))}}function ab(a,r){if(1&a&&(t.j41(0,"div",14)(1,"label"),t.nrm(2,"span",3),t.EFF(3,":"),t.k0s(),t.j41(4,"div",66)(5,"div",113)(6,"span"),t.nrm(7,"span",27),t.k0s()(),t.nVh(8,QP,3,1,"div",114),t.nVh(9,tb,3,1,"div",115),t.nVh(10,eb,4,2,"div",116),t.k0s()()),2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","scenario.rewards.addWeek"),t.R7$(5),t.Y8G("ghs-label","scenario.rewards.addWeek.next")("ghs-label-args",t.eq3(6,Ot,n.gameManager.game.party.weeks+1)),t.R7$(),t.vxM(n.gameManager.game.party.weeks%20<10&&(n.gameManager.game.party.weeks+1)%20>=10?8:-1),t.R7$(),t.vxM(n.gameManager.game.party.weeks%20>=10&&(n.gameManager.game.party.weeks+1)%20<10?9:-1),t.R7$(),t.vxM(n.weekSections().length?10:-1)}}function ib(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",125),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(4);return c.Njj(o.finish(e,!0))}),t.nrm(1,"span",42),t.k0s()}if(2&a){const n=r.$implicit;t.R7$(),t.Y8G("ghs-label","scenario.summary.link")("ghs-label-args",t.eq3(2,Ot,n))}}function ob(a,r){if(1&a&&(t.j41(0,"span",123),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,ib,2,4,"a",124,t.fX1)),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.summary.forcedLinks"),t.R7$(),t.Dyx(n.scenario.forcedLinks)}}function sb(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",125),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(4);return c.Njj(o.finish(e,!0))}),t.nrm(1,"span",42),t.k0s()}if(2&a){const n=r.$implicit;t.R7$(),t.Y8G("ghs-label","scenario.summary.link")("ghs-label-args",t.eq3(2,Ot,n))}}function rb(a,r){if(1&a&&(t.j41(0,"span",123),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,sb,2,4,"a",124,t.fX1)),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.summary.forcedLinks"),t.R7$(),t.Dyx(n.conclusion.forcedLinks)}}function cb(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",127),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(4);return c.Njj(o.finish(e))}),t.nrm(1,"span",42),t.k0s()}if(2&a){const n=r.$implicit;t.R7$(),t.Y8G("ghs-label","scenario.summary.link")("ghs-label-args",t.eq3(2,Ot,n))}}function lb(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",127),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(5);return c.Njj(o.finish(e))}),t.nrm(1,"span",42),t.k0s()}if(2&a){const n=r.$implicit;t.R7$(),t.Y8G("ghs-label","scenario.summary.link")("ghs-label-args",t.eq3(2,Ot,n))}}function gb(a,r){if(1&a&&t.Z7z(0,lb,2,4,"a",126,t.fX1),2&a){const n=t.XpG(4);t.Dyx(n.conclusion.links)}}function db(a,r){if(1&a&&(t.j41(0,"span",123),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,cb,2,4,"a",126,t.fX1),t.nVh(4,gb,2,0)),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.summary.links"),t.R7$(),t.Dyx(n.scenario.links),t.R7$(2),t.vxM(n.conclusion&&n.conclusion.links?4:-1)}}function hb(a,r){if(1&a&&(t.j41(0,"span",120),t.nVh(1,ob,4,1),t.nVh(2,rb,4,1),t.nVh(3,db,5,2),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.vxM(n.scenario.forcedLinks&&n.scenario.forcedLinks.length>0?1:-1),t.R7$(),t.vxM(n.conclusion&&n.conclusion.forcedLinks&&n.conclusion.forcedLinks.length>0?2:-1),t.R7$(),t.vxM(n.scenario.forcedLinks&&0!=n.scenario.forcedLinks.length||n.conclusion&&n.conclusion.forcedLinks&&0!=n.conclusion.forcedLinks.length?-1:3)}}function _b(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",128),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.finish())}),t.nrm(1,"span",3),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label",n.conclusionOnly?"scenario.summary.solve":"scenario.summary.apply")}}function mb(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",129),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.restart())}),t.nrm(1,"span",3),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label",n.lootColumns.length>0?"scenario.summary.restartLoseLoot":"scenario.summary.restart")}}function pb(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",15)(1,"a",119),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.close())}),t.nrm(2,"span",3),t.k0s(),t.nVh(3,hb,4,3,"span",120),t.nVh(4,_b,2,1,"a",121),t.nVh(5,mb,2,1,"a",122),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(5,bs,n.gameManager.stateManager.permissions&&(!n.gameManager.stateManager.permissions.round||!n.gameManager.stateManager.permissions.scenario||!n.gameManager.stateManager.permissions.characters))),t.R7$(2),t.Y8G("ghs-label","scenario.summary.cancel"),t.R7$(),t.vxM(n.success&&(n.gameManager.game.party.campaignMode||n.forceCampaign)&&(n.scenario.links&&n.scenario.links.length>0||n.scenario.forcedLinks&&n.scenario.forcedLinks.length>0||n.conclusion&&n.conclusion.forcedLinks&&n.conclusion.forcedLinks.length>0)?3:-1),t.R7$(),t.vxM(n.success&&n.gameManager.game.party.campaignMode&&!n.alreadyWarning&&!n.forceCampaign&&(n.scenario.forcedLinks&&0!=n.scenario.forcedLinks.length||n.conclusion&&n.conclusion.forcedLinks&&0!=n.conclusion.forcedLinks.length)?-1:4),t.R7$(),t.vxM(n.success?-1:5)}}let zt=(()=>{class a{dialogRef;dialog;ghsManager;gameManager=s.E;settingsManager=p.f;LootType=rt.r6;scenario;conclusion;success;conclusionWarning;alreadyWarning=!1;characterProgress=!0;gainRewards=!0;forceCampaign=!1;conclusionOnly;rewardsOnly;characters;battleGoals=[];collectiveGold=[];collectiveResources=[];lootColumns=[];lootColumnsLooted=[];lootColumnsTotal=[];lootedGold=0;totalGold=0;rewardItems=[];rewardItemCount=[];items=[];chooseLocation;chooseUnlockCharacter;rewards=void 0;challenges=0;numberChallenges=0;calendarSectionManual=[];randomItem;randomItemIndex=-1;randomItems=[];randomItemBlueprints=[];trials=[];trial349;trial356;townGuardAMs=[];levelUp=[];perksUp=[];stats=!1;EntityValueFunction=A.hZ;waitForClose=!1;constructor(n,i,e,o){this.dialogRef=i,this.dialog=e,this.ghsManager=o,this.scenario=n.scenario,this.success=n.success,this.conclusion=n.conclusion,this.conclusionOnly=n.conclusionOnly,this.rewardsOnly=n.rewardsOnly,this.conclusionOnly&&(this.conclusion=this.scenario,this.success=!0,s.E.game.finish=void 0,(this.conclusion.repeatable||s.E.game.party.conclusions.find(g=>g.index==this.scenario.index&&g.edition==this.scenario.edition&&g.group==this.scenario.group))&&(this.rewardsOnly=!0)),this.conclusionWarning=this.success&&!this.conclusion&&null!=s.E.sectionData(this.scenario.edition).find(g=>g.parent==this.scenario.index&&g.group==this.scenario.group&&g.edition==this.scenario.edition&&g.conclusion),this.characters=s.E.game.figures.filter(g=>g instanceof H.K).map((g,m)=>(this.battleGoals[m]=0,g)).sort((g,m)=>{if(!g.absent&&m.absent)return-1;if(g.absent&&!m.absent)return 1;const k=s.E.characterManager.characterName(g).toLowerCase(),X=s.E.characterManager.characterName(m).toLowerCase();return k>X?1:k<X?-1:0}),this.trial349=this.characters.find(g=>g.progress.trial&&"fh"==g.progress.trial.edition&&"349"==g.progress.trial.name),this.trial356=this.characters.find(g=>g.progress.trial&&"fh"==g.progress.trial.edition&&"356"==g.progress.trial.name);for(let g in rt.r6){const m=g;m!=rt.r6.money&&m!=rt.r6.special1&&m!=rt.r6.special2&&!this.lootColumns.includes(m)&&this.characters.some(k=>k.lootCards&&k.lootCards.some(X=>s.E.game.lootDeck.cards[X].type==m))&&(this.lootColumns.push(m),this.lootColumnsLooted.push(this.characters.map(k=>this.lootValue(k,m)).reduce((k,X)=>k+X)),this.lootColumnsTotal.push(s.E.lootManager.getTotal(s.E.game.lootDeck,m)))}s.E.game.lootDeck&&s.E.game.lootDeck.cards.length>0&&(this.characters.length>0&&(this.lootedGold=this.characters.map(g=>this.lootValue(g,rt.r6.money)+this.lootValue(g,rt.r6.special1)+this.lootValue(g,rt.r6.special2)).reduce((g,m)=>g+m)),this.totalGold=s.E.lootManager.getTotal(s.E.game.lootDeck,rt.r6.money),this.totalGold+=s.E.lootManager.getTotal(s.E.game.lootDeck,rt.r6.special1),this.totalGold+=s.E.lootManager.getTotal(s.E.game.lootDeck,rt.r6.special2)),this.alreadyWarning=!this.rewardsOnly&&s.E.game.party.campaignMode&&this.success&&(s.E.scenarioManager.isSuccess(this.scenario)||this.conclusion&&null!=s.E.game.party.conclusions.find(g=>this.conclusion&&g.index==this.conclusion.index&&g.edition==this.conclusion.edition&&g.group==this.conclusion.group))||!1,this.characterProgress=!this.rewardsOnly&&!this.conclusionOnly&&(s.E.game.party.campaignMode||!s.E.fhRules()),this.gainRewards=s.E.game.party.campaignMode,this.updateState(),s.E.stateManager.scenarioSummary=!0,s.E.game.finish||this.conclusionOnly||this.rewardsOnly?this.rewardsOnly||this.loadFinish():(s.E.stateManager.before("finishScenario.dialog",...s.E.scenarioManager.scenarioUndoArgs()),this.updateFinish(),s.E.stateManager.after()),this.dialogRef.closed.subscribe({next:()=>{s.E.stateManager.scenarioSummary&&!this.conclusionOnly&&!this.rewardsOnly&&!this.waitForClose&&(s.E.stateManager.before("finishScenario.close",...s.E.scenarioManager.scenarioUndoArgs()),s.E.stateManager.scenarioSummary=!1,s.E.game.finish=void 0,s.E.stateManager.after())}}),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.conclusionOnly||(s.E.game.finish?this.loadFinish():(s.E.stateManager.scenarioSummary=!1,this.close()))}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}updateFinish(){const n=new Ue.Af;n.conclusion=this.conclusion?new ut.Ag(this.conclusion.index,this.conclusion.edition,this.conclusion.group):void 0,n.success=this.success,n.battleGoals=this.battleGoals,n.challenges=this.challenges,n.chooseLocation=this.chooseLocation,n.chooseUnlockCharacter=this.chooseUnlockCharacter,n.collectiveGold=this.collectiveGold,n.collectiveResources=this.collectiveResources||[],n.items=this.items,n.calendarSectionManual=this.calendarSectionManual,n.randomItem=this.randomItem?new yt.gw(""+this.randomItem.id,this.randomItem.edition):void 0,n.randomItemIndex=this.randomItemIndex,n.randomItems=this.randomItems?this.randomItems.map(i=>i?new yt.gw(""+i.id,i.edition):void 0):[],n.randomItemBlueprints=this.randomItemBlueprints,n.trials=this.trials,s.E.game.finish=n,this.updateState()}loadFinish(){if(s.E.game.finish){const n=s.E.game.finish;this.conclusion=n.conclusion?s.E.sectionData(n.conclusion.edition).find(i=>n.conclusion&&i.index==n.conclusion.index&&i.group==n.conclusion.group&&i.conclusion):void 0,this.success=n.success,this.battleGoals=n.battleGoals||[],this.challenges=n.challenges,this.chooseLocation=n.chooseLocation,this.chooseUnlockCharacter=n.chooseUnlockCharacter,this.collectiveGold=n.collectiveGold||[],this.collectiveResources=n.collectiveResources||[],this.items=n.items,this.calendarSectionManual=n.calendarSectionManual||n.calenderSectionManual,this.randomItem=n.randomItem?s.E.itemManager.getItem(n.randomItem.name,n.randomItem.edition,!0):void 0,this.randomItemIndex=n.randomItemIndex,this.randomItems=n.randomItems?n.randomItems.map(i=>i?s.E.itemManager.getItem(i.name,i.edition,!0):void 0):[],this.randomItemBlueprints=n.randomItemBlueprints||[],this.trials=n.trials||[],this.updateState()}}updateState(n=!1){if(this.forceCampaign=n,this.numberChallenges=0,this.rewards=void 0,this.townGuardAMs=[],(s.E.game.party.campaignMode||n)&&this.success){if(this.scenario.rewards&&(this.rewards=Object.assign(new Ue.$v,this.scenario.rewards)),this.conclusion&&this.conclusion.rewards&&(this.rewards?Object.assign(this.rewards,this.conclusion.rewards):this.rewards=Object.assign(new Ue.$v,this.conclusion.rewards)),p.f.settings.scenarioRewards&&this.rewards){if(this.rewards.collectiveGold&&this.characters.forEach((i,e)=>{this.collectiveGold[e]||(this.collectiveGold[e]=0)}),this.rewards.collectiveResources&&(this.collectiveResources=this.collectiveResources||[],this.characters.forEach((i,e)=>{this.collectiveResources[e]||(this.collectiveResources[e]={})})),this.rewards.items&&this.rewards.items.forEach((i,e)=>{const o=s.E.itemManager.getItem(i.split(":")[0].split("-")[0],i.split(":")[0].split("-").slice(1).join("-")||this.scenario.edition,!0);if(o){if(this.rewardItems[e]=o,this.rewardItemCount[e]=i.includes(":")?+i.split(":")[1]:1,1==this.characters.filter(g=>!g.absent).length){const g=this.characters.find(m=>!m.absent);g&&(void 0===this.items[this.characters.indexOf(g)]&&(this.items[this.characters.indexOf(g)]=[]),this.items[this.characters.indexOf(g)].includes(e)||this.items[this.characters.indexOf(g)].push(e))}}else console.error("Unknown Item '"+i+"' for scenario '"+this.scenario.index+" ("+this.scenario.edition+")")}),this.rewards.chooseItem){let i=0;this.rewards.chooseItem.forEach(e=>{e.forEach(o=>{const g=s.E.itemManager.getItem(o.split(":")[0].split("-")[0],o.split(":")[0].split("-").slice(1).join("-")||this.scenario.edition,!0);g?(this.rewardItems[i]=g,this.rewardItemCount[i]=o.includes(":")?+o.split(":")[1]:1,i++):console.error("Unknown Item '"+o+"' for scenario '"+this.scenario.index+" ("+this.scenario.edition+")")})})}if(this.rewards.chooseLocation&&this.rewards.chooseLocation.length>0&&!this.chooseLocation&&(this.chooseLocation=this.rewards.chooseLocation[0]),this.rewards.chooseUnlockCharacter&&this.rewards.chooseUnlockCharacter.length>0&&!this.chooseUnlockCharacter){let i=0;for(;i<this.rewards.chooseUnlockCharacter.length&&s.E.game.unlockedCharacters.includes(this.scenario.edition+":"+this.rewards.chooseUnlockCharacter[i]);)i++;i<this.rewards.chooseUnlockCharacter.length&&(this.chooseUnlockCharacter=this.rewards.chooseUnlockCharacter[i])}if(this.rewards.calendarSectionManual&&this.rewards.calendarSectionManual.forEach((i,e)=>{this.calendarSectionManual[e]||(this.calendarSectionManual[e]=0)}),p.f.settings.drawRandomItem&&this.rewards.randomItemBlueprint&&this.randomItemBlueprints.length<this.rewards.randomItemBlueprint)for(let i=this.randomItemBlueprints.length;i<this.rewards.randomItemBlueprint;i++){let e=s.E.itemManager.drawRandomItem(this.scenario.edition,!0),o=e?new yt.gw(""+e.id,e.edition):void 0;this.randomItemBlueprints[i]=o?+o.name:-1}if(p.f.settings.drawRandomItem&&this.rewards.randomItem&&!this.randomItem){const i=+this.rewards.randomItem.split("-")[0],e=+this.rewards.randomItem.split("-")[1],o=this.rewards.randomItem.split("-").length>2?this.rewards.randomItem.split("-")[2]:this.scenario.edition;let g=s.E.itemManager.drawRandomItem(o,!1,i,e);g&&(this.randomItem=g)}if(p.f.settings.drawRandomItem&&this.rewards.randomItems&&this.randomItems.length<this.characters.length&&this.rewards.randomItems.split("-").length>1){const i=+this.rewards.randomItems.split("-")[0],e=+this.rewards.randomItems.split("-")[1],o=this.rewards.randomItems.split("-").length>2?this.rewards.randomItems.split("-")[2]:this.scenario.edition;for(let g=this.randomItems.length;g<this.characters.length;g++){const m=this.characters[g];if(m.absent)this.randomItems[g]=void 0;else{let k=s.E.itemManager.drawRandomItem(o,!1,i,e);m.progress.items.find(X=>k&&X.name==k.id+""&&X.edition==k.edition)&&(k=void 0),this.randomItems[g]=k||void 0}}}this.rewards.townGuardAm&&(this.townGuardAMs=this.rewards.townGuardAm.map(i=>w.qq.find(e=>e.id==i))),this.rewards.valueMapping&&Object.keys(this.rewards.valueMapping).forEach(i=>{if(this.rewards&&this.rewards.valueMapping&&this.rewards.valueMapping[i]){const e=this.rewards.valueMapping[i],o=s.E.scenarioRulesManager.presentEntitiesByFigureRule(e,void 0).length,g=e.value;this.rewards&&"string"==typeof this.rewards[g]&&(this.rewards[g]=this.rewards[g].replaceAll(i,""+o))}})}if(s.E.challengesManager.enabled)this.numberChallenges=s.E.game.challengeDeck.keep.length;else if(s.E.fhRules()){const i=s.E.game.party.buildings.find(e=>"town-hall"==e.name&&e.level&&"wrecked"!=e.state);i&&(1==i.level||2==i.level?this.numberChallenges=1:3==i.level&&(this.numberChallenges=2))}}this.characters.forEach((i,e)=>{const o=i.progress.experience+2*this.challenges+i.experience+(this.success&&this.rewards&&this.rewards.experience?this.rewards.experience:0)+(!this.success||this.rewards&&this.rewards.ignoredBonus&&this.rewards.ignoredBonus.includes("experience")?0:s.E.levelManager.experience());this.levelUp[e]=s.E.characterManager.levelForXp(o)>s.E.characterManager.levelForXp(i.progress.experience);const g=Math.floor(i.progress.battleGoals/3),m=Math.floor((i.progress.battleGoals+this.battleGoals[e])/3);this.perksUp[e]=m>g,p.f.settings.scenarioStats&&!i.absent&&s.E.scenarioStatsManager.applyScenarioStats(i,this.scenario,this.success)})}hasRewards(){const n=this.rewards;return!(!n||!(n.envelopes||n.gold||n.experience||n.collectiveGold||n.resources||n.collectiveResources||n.reputation||n.prosperity||n.inspiration||n.morale||n.perks||n.battleGoals||n.items||n.chooseItem||n.itemDesigns||n.itemBlueprints||n.randomItemBlueprint||n.randomItemBlueprints||n.events||n.chooseUnlockCharacter||n.unlockCharacter||n.custom||n.lootDeckCards||n.removeLootDeckCards||n.townGuardAm||n.overlayCampaignSticker||n.overlaySticker||n.pet||n.eventDecks||n.reputationFactions||n.factionUnlock))}hasBonus(){return(s.E.game.party.campaignMode||this.forceCampaign)&&this.success&&!this.conclusionOnly&&!this.scenario.solo&&(s.E.fhRules()&&s.E.characterManager.characterCount()<4&&(!this.rewards||!this.rewards.ignoredBonus||!this.rewards.ignoredBonus.includes("inspiration"))||this.numberChallenges>0)}addWeek(){return s.E.fhRules()&&(s.E.game.party.campaignMode||this.forceCampaign)&&this.success&&!this.conclusionOnly&&!this.scenario.solo&&!this.scenario.conclusion&&(!this.rewards||!this.rewards.calendarIgnore)&&(!this.scenario.forcedLinks||!this.scenario.forcedLinks.length)&&(!this.conclusion||!this.conclusion.forcedLinks||!this.conclusion.forcedLinks.length)&&p.f.settings.automaticPassTime&&p.f.settings.partySheet}weekSections(){let n=[];const i=s.E.editionData.find(o=>o.edition==this.scenario.edition);let e=[];return i&&i.campaign&&e.push(...i.campaign.weeks&&i.campaign.weeks[s.E.game.party.weeks+1]||[]),e.push(...s.E.game.party.weekSections[s.E.game.party.weeks+1]||[]),e.forEach(o=>{const g=s.E.sectionData(this.scenario.edition).find(m=>m.index==o&&m.group==this.scenario.group&&m.conclusion);g&&n.push(g)}),n}showWeekConclusion(n){const i=new ut.Nz(n);this.dialog.open(a,{panelClass:["dialog"],data:{scenario:i,conclusionOnly:!0,rewardsOnly:!0}})}availableCollectiveGold(){return this.rewards&&this.rewards.collectiveGold&&this.collectiveGold.length>0&&this.rewards.collectiveGold-this.collectiveGold.reduce((n,i)=>n+i)||0}availableCollectiveResource(n){const i=this.rewards&&this.rewards.collectiveResources&&this.rewards.collectiveResources.find(o=>o.type==n)||{type:n,value:0},e=(0,A.hZ)(i.value);return e>0&&e-(this.collectiveResources&&this.collectiveResources.length>0?this.collectiveResources.map(o=>o[n]||0).reduce((o,g)=>o+g):0)||0}lootValue(n,i){let e=0;return n.lootCards&&n.lootCards.forEach(o=>{const g=s.E.game.lootDeck.cards[o];g&&g.type==i&&(e+=s.E.lootManager.getValue(g))}),e}toggleBattleGoal(n,i,e){const o=this.characters[i];let g;s.E.stateManager.before("finishScenario.battleGoal",o.edition,o.name,e),p.f.settings.battleGoals&&o.battleGoal&&o.battleGoals.length>0&&(g=s.E.battleGoalManager.getBattleGoal(o.battleGoals[0])),n.target.checked&&this.battleGoals[i]<e?(this.battleGoals[i]=e,g&&g.checks>e&&(this.battleGoals[i]=g.checks)):this.battleGoals[i]>=e&&(this.battleGoals[i]=e-1,g&&g.checks>e-1&&(this.battleGoals[i]=0)),this.updateFinish(),s.E.stateManager.after()}openBattleGoals(n){this.dialog.open(Oi,{panelClass:["dialog"],data:{character:n,cardOnly:n.battleGoal}})}openTrial(n){n.progress.trial&&this.dialog.open(Os,{panelClass:["fullscreen-panel"],data:{edition:n.progress.trial.edition,trial:+n.progress.trial.name}})}openChallenge(n){s.E.game.challengeDeck.cards[n]&&this.dialog.open(ZC,{panelClass:["fullscreen-panel"],data:s.E.game.challengeDeck.cards[n]})}toggleTrial(n,i){s.E.stateManager.before("finishScenario.trial",this.characters[i].name,this.trials[i]),this.trials[i]=n.target.checked,this.updateFinish(),s.E.stateManager.after()}toggleChallenges(n,i=!1){if(s.E.stateManager.before("finishScenario.dialog.challenge"+(i?"s":"")),this.challenges<1&&i&&s.E.challengesManager.enabled){const e=s.E.game.challengeDeck.cards.splice(s.E.game.challengeDeck.keep[0],1)[0];s.E.game.challengeDeck.cards.splice(s.E.game.challengeDeck.keep[1],0,e),this.challenges=1,n.target.checked=!1}else this.challenges=this.challenges>(i?1:0)?i?1:0:i?2:1;this.updateFinish(),s.E.stateManager.after()}itemDistributed(n,i,e=!0){if(this.items[n]||(this.items[n]=[]),e&&this.rewards&&this.rewards.chooseItem){let k=0,X=0,at=0,tt=!1;if(this.rewards.chooseItem.forEach(J=>{!tt&&i<J.length+at&&(X=J.length+at-1,tt=!0),at+=J.length,tt||(k=at)}),this.rewardItems.some((J,et)=>et!=i&&(et<k||et>X)&&this.characters.some((ot,lt)=>this.itemDistributed(lt,et,!1))))return!0}const o=this.rewardItems[i];if(this.characters[n].progress.items.find(k=>k.name==""+o.id&&k.edition==o.edition))return!0;const g=this.rewardItems[i],m=e?g.count-this.characters.filter(k=>k.progress.items.find(X=>X.name==""+g.id&&X.edition==g.edition)).length:1;return!this.items[n].includes(i)&&this.items.filter(k=>k.includes(i)).length>=Math.min(this.rewardItemCount[i],m)}toggleItem(n,i,e){s.E.stateManager.before("finishScenario.dialog.item",i,this.rewardItems[e].id),this.items[i].includes(e)?this.items[i].splice(this.items[i].indexOf(e),1):this.items[i].push(e),this.updateFinish(),s.E.stateManager.after()}toggleRandomItem(n,i){s.E.stateManager.before("finishScenario.dialog.item",i),this.randomItemIndex=this.randomItemIndex==i?-1:i,this.updateFinish(),s.E.stateManager.after()}openItemDialog(n){n&&this.dialog.open(fn,{panelClass:["fullscreen-panel"],disableClose:!0,data:{item:n}})}changeCollectiveGold(n,i){let e=+n.target.value;const o=this.collectiveGold[i]||0;this.collectiveGold[i]=0,e<0?e=0:e>this.availableCollectiveGold()&&(e=this.availableCollectiveGold()),this.collectiveGold[i]=o,e!=(this.collectiveGold[i]||0)&&(s.E.stateManager.before("finishScenario.dialog.collectiveGold",i,n.target.value),this.collectiveGold[i]=+n.target.value,this.updateFinish(),s.E.stateManager.after()),n.target.value=e}changeCollectiveResource(n,i,e){let o=+n.target.value;this.collectiveResources[i]||(this.collectiveResources[i]={});const g=this.collectiveResources[i][e]||0;this.collectiveResources[i][e]=0,o<0?o=0:o>this.availableCollectiveResource(e)&&(o=this.availableCollectiveResource(e)),this.collectiveResources[i][e]=g,o!=(this.collectiveResources[i][e]||0)&&(s.E.stateManager.before("finishScenario.dialog.collectiveResource",e,i,n.target.value),this.collectiveResources[i]=this.collectiveResources[i]||{},this.collectiveResources[i][e]=o,this.updateFinish(),s.E.stateManager.after()),n.target.value=o}changeCalendarSectionManual(n,i){s.E.stateManager.before("finishScenario.dialog.calendarSectionManual",i,n.target.value),this.calendarSectionManual[i]=+n.target.value,this.updateFinish(),s.E.stateManager.after()}selectLocation(n){s.E.stateManager.before("finishScenario.dialog.chooseLocation",n),this.chooseLocation=n,this.updateFinish(),s.E.stateManager.after()}selectCharacter(n){s.E.stateManager.before("finishScenario.dialog.chooseUnlockCharacter",n),this.chooseUnlockCharacter=n,this.updateFinish(),s.E.stateManager.after()}openCharacterSheet(n){this.dialog.open(An,{panelClass:["dialog-invert"],data:{character:n}})}toggleAbsent(n){s.E.stateManager.before(n.absent?"unsetAbsent":"setAbsent",s.E.characterManager.characterName(n)),n.absent=!n.absent,s.E.stateManager.after()}finish(){var n=this;return(0,I.A)(function*(i=void 0,e=!1){n.waitForClose=!0;const o=s.E.scenarioData(n.scenario.edition).find(g=>g.group==n.scenario.group&&g.index==i);if(n.conclusionOnly?s.E.stateManager.before("finishConclusion",...s.E.scenarioManager.scenarioUndoArgs(n.scenario)):s.E.stateManager.before(n.success&&o?"finishScenario.linked":"finishScenario."+(n.success?"success":"failure"),...s.E.scenarioManager.scenarioUndoArgs(),i||""),p.f.settings.scenarioRewards&&n.success&&!s.E.bbRules()){if(n.characters.forEach((g,m)=>{if(!g.absent){if(n.battleGoals[m]>0&&(g.progress.battleGoals+=n.battleGoals[m]),n.trials[m]&&(g.progress.trial=void 0),n.collectiveGold[m]>0&&(g.progress.gold+=n.collectiveGold[m]),n.collectiveResources[m]&&Object.keys(n.collectiveResources[m]).forEach(k=>{g.progress.loot[k]=(g.progress.loot[k]||0)+(n.collectiveResources[m][k]||0)}),n.rewardItems.forEach((k,X)=>{n.items.every(at=>!at.includes(X))&&(n.items[m]=n.items[m]||[],n.items[m].push(X))}),n.items[m]&&n.items[m].length>0&&n.items[m].forEach(k=>{const X=n.rewardItems[k];p.f.settings.characterItems&&g.progress.items.push(new yt.gw(""+X.id,X.edition)),s.E.itemManager.addItemCount(X)}),n.challenges)for(let k=0;k<n.challenges;k++)g.progress.experience+=2;s.E.trialsManager.favorsEnabled&&s.E.trialsManager.apply&&(g.progress.gold+=g.loot*s.E.trialsManager.activeFavor("fh","wealth"),n.battleGoals[m]&&(g.progress.experience+=3*s.E.trialsManager.activeFavor("fh","knowledge")))}}),n.rewards&&n.rewards.collectiveResources&&n.rewards.collectiveResources.forEach(g=>{const m=n.availableCollectiveResource(g.type);m&&(s.E.game.party.loot[g.type]=(s.E.game.party.loot[g.type]||0)+m)}),n.chooseLocation&&s.E.game.party.manualScenarios.push(new ut.Ag(n.chooseLocation,n.scenario.edition,n.scenario.group)),p.f.settings.automaticUnlocking&&n.chooseUnlockCharacter&&!s.E.game.unlockedCharacters.includes(n.scenario.edition+":"+n.chooseUnlockCharacter)&&s.E.game.unlockedCharacters.push(n.scenario.edition+":"+n.chooseUnlockCharacter),n.challenges)for(let g=0;g<n.challenges;g++)s.E.game.party.townGuardPerks+=1;(n.gainRewards||n.forceCampaign)&&n.randomItemBlueprints.length>0&&n.randomItemBlueprints.forEach(g=>{-1==g?s.E.game.party.inspiration+=1:s.E.game.party.unlockedItems.push(new yt.VP(""+g,n.scenario.edition))}),(n.gainRewards||n.forceCampaign)&&n.rewards&&n.rewards.calendarSectionManual&&n.rewards.calendarSectionManual.forEach((g,m)=>{if(n.calendarSectionManual[m]>=0){const k=s.E.game.party.weeks+n.calendarSectionManual[m];s.E.game.party.weekSections[k]=[...s.E.game.party.weekSections[k]||[],g.section]}}),s.E.challengesManager.enabled&&n.challenges&&(s.E.game.challengeDeck.finished+=n.challenges),s.E.trialsManager.applyTrialCards()}n.conclusionOnly?s.E.scenarioManager.finishScenario(n.scenario,!0,n.conclusion,!1,!1,p.f.settings.scenarioRewards&&(n.characterProgress||n.forceCampaign),n.gainRewards||n.forceCampaign,!0):s.E.scenarioManager.finishScenario(s.E.game.scenario,n.success,n.conclusion,!1,null!=o,p.f.settings.scenarioRewards&&!s.E.bbRules()&&(n.characterProgress||n.forceCampaign),n.gainRewards||n.forceCampaign),o?e||!s.E.scenarioManager.isBlocked(o)&&!s.E.scenarioManager.isLocked(o)?s.E.scenarioManager.setScenario(new ut.Nz(o),!0):n.dialog.open(Ra,{panelClass:["dialog"],data:{scenarioData:o,linked:!0}}):s.E.game.figures.forEach(g=>{g instanceof H.K&&(g.absent=!1)}),yield s.E.stateManager.after(0,p.f.settings.autoBackup>-1&&p.f.settings.autoBackupFinish&&(0==p.f.settings.autoBackup||(s.E.game.revision+s.E.game.revisionOffset)%p.f.settings.autoBackup!=0)),n.close()}).apply(this,arguments)}restart(){this.waitForClose=!0,s.E.stateManager.before("finishScenario.restart",...s.E.scenarioManager.scenarioUndoArgs()),s.E.scenarioManager.finishScenario(this.gameManager.game.scenario,this.success,this.conclusion,!0,!1,p.f.settings.scenarioRewards&&(this.characterProgress||this.forceCampaign),this.gainRewards||this.forceCampaign,!1),s.E.stateManager.after(1e3),this.close()}close(){(0,F.co)(this.dialogRef)}unlocked(n){return s.E.game.unlockedCharacters.includes(this.scenario.edition+":"+n)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-scenario-summary"]],standalone:!1,decls:20,vars:18,consts:[[1,"scroll-container"],[1,"header"],[1,"title"],[3,"ghs-label"],[1,"name"],[1,"text-white",3,"ghs-label"],[1,"success"],[1,"conclusion"],[1,"casual"],[1,"failure"],[1,"main",3,"ngClass"],[1,"table",3,"--ghs-summary-columns"],[1,"rewards"],[1,"reward","warning"],[1,"reward"],[1,"buttons",3,"ngClass"],[1,"table"],[1,"head-col","first"],[1,"first"],[1,"head-col","calc-col"],[1,"calc-col"],[1,"head-col"],[1,"icon","character-icon",3,"click","src"],[1,"name",3,"ngClass"],[1,"absent-icon-container",3,"ngClass"],[1,"ghs-svg","absent-icon",3,"click","src","ghs-label","ghs-label-attribute"],["type","number","min","0",3,"change","max","value"],[1,"text-white",3,"ghs-label","ghs-label-args"],[3,"ghs-label","ghs-tooltip"],[1,"gold"],["src","./assets/images/fh/loot/money.svg",1,"ghs-svg"],[1,"ghs-svg",3,"src"],[1,"loot"],[1,"xp"],[1,"level-up",3,"ghs-tooltip","ghs-label-args"],["src","./assets/images/arrow-up.svg",1,"ghs-svg"],[1,"treasures"],[1,"hint-container"],[1,"treasure","hint-trigger"],[1,"hint","above","center"],[1,"text","placeholder","text-white",3,"edition","index","rewardResults"],[1,"head-col",3,"click"],[3,"ghs-label","ghs-label-args"],[3,"item","flipped"],["type","checkbox",3,"change","disabled","checked"],[3,"click","item","flipped"],[1,"battlegoals"],[1,"battlegoal"],[1,"battlegoal-list"],[1,"checkmarks"],["type","checkbox",3,"checked"],[1,"level-up",3,"ghs-tooltip"],[1,"battlegoal",3,"click"],[3,"identifier","flipped"],["type","checkbox",3,"disabled","checked"],["type","checkbox",3,"change","checked"],[1,"trials"],[1,"trial"],[1,"checkmark"],[1,"trial",3,"click"],["src","./assets/images/fh/trials/trial.png"],[1,"head-col","stats-toggle",3,"click","ghs-label"],[1,"stats-header"],[1,"scenario-stats"],[1,"text-white",3,"ghs-label","ghs-label-args","ghs-tooltip"],[1,"text-white",3,"ghs-label","ghs-label-args","style","ghs-tooltip"],[1,"list"],[1,"item"],[3,"click"],[1,"reward","locations"],[1,"reward","achievements"],[1,"placeholder","text-white",3,"ghs-label"],[1,"item","location"],[1,"item","location","choose"],["type","radio","name","chooseLocation",3,"change","value","checked"],[1,"item","achievement"],[1,"placeholder","text-white","hint",3,"ghs-label"],[1,"placeholder","text-white",3,"ghs-label","ghs-label-args"],["type","number","min","-1",3,"change","value"],[1,"item","envelope"],[1,"item","gold"],[1,"item","experience"],[1,"item","collectiveGold"],[1,"item","resources"],[1,"item","collective-resources"],[1,"item","reputation"],[1,"item","reputation","faction"],[1,"item","prosperity"],[1,"item","inspiration"],[1,"item","morale"],[1,"item","perks"],[1,"item","battleGoals"],[1,"item","items"],[1,"item","chooseItem"],[1,"item","item-designs"],[1,"item","item-blueprints"],[1,"item","events"],[1,"item","overlay-sticker"],[1,"list-inline","unlock-character"],[1,"item","character"],[1,"item","custom"],[1,"item","event-deck"],[1,"item","loot-deck-cards"],[1,"item","town-guard-am"],[1,"placeholder","text-white",3,"click","ghs-label","ghs-label-args"],[1,"item","character","choose",3,"ngClass"],["type","radio","name","chooseUnlockCharacter",3,"value","checked"],["type","radio","name","chooseUnlockCharacter",3,"change","value","checked"],[1,"item","challenges"],[1,"menu"],[1,"cards"],[1,"card"],[3,"click","challenge","flipped"],[1,"item","week"],[1,"item","winter"],[1,"item","summer"],[1,"item","week-sections"],[1,"week-section","text-white",3,"ghs-label","ghs-label-args"],[1,"week-section","text-white",3,"click","ghs-label","ghs-label-args"],[1,"cancel",3,"click"],[1,"links"],[1,"apply"],[1,"restart"],[1,"text"],[1,"apply","forced-link"],[1,"apply","forced-link",3,"click"],[1,"link"],[1,"link",3,"click"],[1,"apply",3,"click"],[1,"restart",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"span",2),t.nrm(3,"span",3),t.j41(4,"span",4),t.nVh(5,VM,2,1,"span"),t.nrm(6,"span",5),t.k0s()(),t.nVh(7,FM,2,1,"span",6),t.nVh(8,XM,2,1,"span",7),t.nVh(9,BM,2,1,"span",8),t.nVh(10,YM,2,1,"span",9),t.k0s(),t.j41(11,"div",10),t.nVh(12,Ev,46,34,"div",11),t.j41(13,"div",12),t.nVh(14,Rv,8,3,"div",13),t.nVh(15,Sv,7,4,"div",13),t.nVh(16,zP,10,10),t.nVh(17,JP,7,3,"div",14),t.nVh(18,ab,11,8,"div",14),t.k0s()(),t.nVh(19,pb,6,7,"div",15),t.k0s()),2&i&&(t.R7$(3),t.Y8G("ghs-label",e.conclusionOnly?"scenario.conclusion":e.rewardsOnly?"scenario.summary.rewards":"scenario.summary"),t.R7$(2),t.vxM(e.scenario.index&&!e.scenario.hideIndex?5:-1),t.R7$(),t.Y8G("ghs-label",e.gameManager.scenarioManager.scenarioTitle(e.scenario,e.conclusionOnly)),t.R7$(),t.vxM(!e.success||e.conclusionOnly||e.rewardsOnly?-1:7),t.R7$(),t.vxM(e.conclusion&&e.conclusion!=e.scenario?8:-1),t.R7$(),t.vxM(!e.success||e.gameManager.game.party.campaignMode||e.rewardsOnly?-1:9),t.R7$(),t.vxM(e.success?-1:10),t.R7$(),t.Y8G("ngClass",t.l_i(15,DM,"fh"==e.settingsManager.settings.theme,"modern"==e.settingsManager.settings.theme)),t.R7$(),t.vxM(e.characters.length>0&&(e.characterProgress||e.forceCampaign)&&e.settingsManager.settings.characterSheet&&!e.conclusionOnly&&!e.rewardsOnly&&!e.gameManager.bbRules()?12:-1),t.R7$(2),t.vxM(!e.conclusionOnly&&e.alreadyWarning&&e.gameManager.game.party.campaignMode?14:-1),t.R7$(),t.vxM(e.conclusionOnly||e.gameManager.game.party.campaignMode?-1:15),t.R7$(),t.vxM(!e.alreadyWarning&&e.gameManager.game.party.campaignMode||e.forceCampaign?16:-1),t.R7$(),t.vxM(e.hasBonus()?17:-1),t.R7$(),t.vxM(e.addWeek()?18:-1),t.R7$(),t.vxM(e.conclusionOnly&&e.alreadyWarning||e.rewardsOnly?-1:19))},dependencies:[N.YU,vi,wa,it,Mt,Vn,Pe,At,Me,ct],styles:['.header[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-family:var(--ghs-font-title);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));margin-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;flex-direction:column}.header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{text-align:center;color:var(--ghs-color-white);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.header[_ngcontent-%COMP%]   .failure[_ngcontent-%COMP%]{color:var(--ghs-color-red);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor))}.header[_ngcontent-%COMP%]   .success[_ngcontent-%COMP%]{color:var(--ghs-color-green);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor))}.header[_ngcontent-%COMP%]   .casual[_ngcontent-%COMP%]{color:var(--ghs-color-red);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor))}.header[_ngcontent-%COMP%]   .conclusion[_ngcontent-%COMP%]{text-align:center;color:var(--ghs-color-gray);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.main[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap-reverse;height:100%}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]{--ghs-summary-columns: 5;font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));display:grid;grid-template-columns:repeat(var(--ghs-summary-columns),auto);padding-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));color:var(--ghs-color-white);overflow:auto}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-white)}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%], .main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .absent-icon[_ngcontent-%COMP%]{cursor:pointer}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%]:hover, .main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .absent-icon[_ngcontent-%COMP%]:hover{opacity:.7}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .character-icon.absent-icon[_ngcontent-%COMP%], .main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .absent-icon.absent-icon[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .absent[_ngcontent-%COMP%]{text-decoration:line-through}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .gold[_ngcontent-%COMP%], .main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .xp[_ngcontent-%COMP%], .main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .gold.gold[_ngcontent-%COMP%], .main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .xp.gold[_ngcontent-%COMP%], .main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .loot.gold[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .gold.xp[_ngcontent-%COMP%], .main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .xp.xp[_ngcontent-%COMP%], .main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .loot.xp[_ngcontent-%COMP%]{color:var(--ghs-color-blue)}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .level-up[_ngcontent-%COMP%]{position:absolute;right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:100%;margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-normal);font-size:.7em}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .level-up[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1em;width:auto;margin-left:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;text-align:center;padding:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));border-bottom:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-white);border-right:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-darkgray)}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%] > span.stats-header[_ngcontent-%COMP%]{border:none}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-weight:700;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));flex-direction:row;justify-content:flex-end;background-image:url(dialog_background.fa4ff388462f6a00.png);position:sticky;left:0;z-index:1}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col.calc-col[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:.6}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col.stats-toggle[_ngcontent-%COMP%]{cursor:pointer;border:none;grid-column:span 2;justify-content:flex-start}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .calc-col[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:.6}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .first[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);border-top:none}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{flex-grow:1;width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));text-align:center}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .battlegoals[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .battlegoals[_ngcontent-%COMP%]   .battlegoal[_ngcontent-%COMP%]{display:flex;justify-content:center}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .battlegoals[_ngcontent-%COMP%]   .battlegoal[_ngcontent-%COMP%]   ghs-battlegoal[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 12 * var(--ghs-dialog-factor))}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .battlegoals[_ngcontent-%COMP%]   .battlegoal-list[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap;max-width:calc(var(--ghs-unit) * 38 * var(--ghs-dialog-factor));max-height:calc(var(--ghs-unit) * 34 * var(--ghs-dialog-factor));padding:0 calc(var(--ghs-unit) * 1);overflow:auto}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .battlegoals[_ngcontent-%COMP%]   .checkmarks[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;text-align:center}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .trials[_ngcontent-%COMP%]{display:flex;align-items:center}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .trials[_ngcontent-%COMP%]   .trial[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .trials[_ngcontent-%COMP%]   .trial[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .trials[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;text-align:center}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);justify-content:center;align-items:center}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;background-image:url(treasure.0792d529e76ec279.png);background-size:contain;background-repeat:no-repeat;background-position:center;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));color:var(--ghs-color-black);width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   ghs-item[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 12 * var(--ghs-dialog-factor))}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .scenario-stats[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .scenario-stats[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .scenario-stats[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:auto}.main.fh[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.main.modern[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.rewards[_ngcontent-%COMP%]{color:var(--ghs-color-white);display:flex;flex-direction:column;min-width:0;max-width:calc(var(--ghs-unit) * 35 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-brown);font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;width:100%;height:100%;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-text);padding-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:0;background:linear-gradient(180deg,var(--ghs-color-brown) 0%,var(--ghs-color-brown) calc(100% - var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor)),transparent 100%);opacity:.2;filter:brightness(20);border-top-left-radius:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor));border-top-right-radius:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor));z-index:0}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;z-index:1;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.location[_ngcontent-%COMP%], .rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.character[_ngcontent-%COMP%]{flex-direction:row;align-items:flex-end;margin:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.character[_ngcontent-%COMP%]   .placeholder[_ngcontent-%COMP%]{white-space:nowrap}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.choose[_ngcontent-%COMP%]{cursor:pointer;color:var(--ghs-color-white);justify-content:flex-start;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-text)}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.choose[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-family:var(--ghs-font-normal);color:var(--ghs-color-gray);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.disabled[_ngcontent-%COMP%], .rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.character.unlocked[_ngcontent-%COMP%]{pointer-events:none}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.character.unlocked[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:50%;left:0;right:0;height:.1em;background-color:var(--ghs-color-white);transform:translateY(-50%);z-index:2}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.challenges[_ngcontent-%COMP%]{flex-direction:column;justify-content:center;align-items:center;margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.challenges[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%], .rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.challenges[_ngcontent-%COMP%]   .cards[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.challenges[_ngcontent-%COMP%]   .cards[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.challenges[_ngcontent-%COMP%]   .cards[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   ghs-challenge-card[_ngcontent-%COMP%]{cursor:pointer;display:block;width:calc(var(--ghs-unit) * 12 * var(--ghs-dialog-factor));color:initial}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.week-sections[_ngcontent-%COMP%]   .week-section[_ngcontent-%COMP%]{cursor:pointer}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .location[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{display:flex;justify-content:center;width:1.5em;height:1.5em;font-size:1em;color:var(--ghs-color-black);background-color:var(--ghs-color-white);border-radius:100%;border:2px solid var(--ghs-color-black);margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list-inline[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-end;flex-wrap:wrap}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list-inline[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{margin:0 .1em}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list-inline[_ngcontent-%COMP%]   .choose[_ngcontent-%COMP%]{align-items:flex-end}.rewards[_ngcontent-%COMP%]   .reward.warning[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.rewards[_ngcontent-%COMP%]   .reward.warning[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.buttons[_ngcontent-%COMP%]{display:flex;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly;align-items:center}.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));display:flex;justify-content:center}.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.buttons[_ngcontent-%COMP%]   .apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.buttons[_ngcontent-%COMP%]   .links[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.buttons[_ngcontent-%COMP%]   .links[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white);white-space:nowrap}.buttons.denied[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{pointer-events:initial}']})}return a})();const ub=(a,r)=>({flipped:a,"no-animations":r}),fb=()=>[],ne=(a,r)=>({value:a,"value-highlight":r}),Cb=(a,r)=>({"with-header":a,edit:r}),Mb=a=>({checked:a});function vb(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.JRh(n.loot.value4P>0?""+n.loot.value4P:"")}}function Ob(a,r){if(1&a&&(t.nrm(0,"span",15),t.EFF(1,"/ "),t.nrm(2,"span",15)),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.l_i(4,ne,n.highlight,n.highlight&&n.gameManager.characterManager.characterCount()>2))("ghs-label","%game.loot.player.3-4% +"+n.loot.value4P),t.R7$(2),t.Y8G("ngClass",t.l_i(7,ne,n.highlight,n.highlight&&n.gameManager.characterManager.characterCount()<=2))("ghs-label","%game.loot.player.2% +"+n.loot.value2P)}}function Pb(a,r){if(1&a&&(t.nrm(0,"span",15),t.EFF(1,"/ "),t.nrm(2,"span",15)),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.l_i(4,ne,n.highlight,n.highlight&&n.gameManager.characterManager.characterCount()>=4))("ghs-label","%game.loot.player.4% +"+n.loot.value4P),t.R7$(2),t.Y8G("ngClass",t.l_i(7,ne,n.highlight,n.highlight&&n.gameManager.characterManager.characterCount()<=3))("ghs-label","%game.loot.player.2-3% +"+n.loot.value2P)}}function bb(a,r){if(1&a&&(t.nrm(0,"span",15),t.EFF(1,"/ "),t.nrm(2,"span",15),t.EFF(3,"/ "),t.nrm(4,"span",15)),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.l_i(6,ne,n.highlight,n.highlight&&n.gameManager.characterManager.characterCount()>3))("ghs-label","%game.loot.player.4% +"+n.loot.value4P),t.R7$(2),t.Y8G("ngClass",t.l_i(9,ne,n.highlight,n.highlight&&3==n.gameManager.characterManager.characterCount()))("ghs-label","%game.loot.player.3% +"+n.loot.value3P),t.R7$(2),t.Y8G("ngClass",t.l_i(12,ne,n.highlight,n.highlight&&n.gameManager.characterManager.characterCount()<3))("ghs-label","%game.loot.player.2% +"+n.loot.value2P)}}function kb(a,r){if(1&a&&(t.j41(0,"span",6),t.nVh(1,vb,2,1,"span"),t.nVh(2,Ob,3,10),t.nVh(3,Pb,3,10),t.nVh(4,bb,5,15),t.nrm(5,"span",14),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.vxM(n.loot.value2P==n.loot.value3P&&n.loot.value3P==n.loot.value4P?1:-1),t.R7$(),t.vxM(n.loot.value4P==n.loot.value3P&&n.loot.value3P!=n.loot.value2P?2:-1),t.R7$(),t.vxM(n.loot.value4P!=n.loot.value3P&&n.loot.value3P==n.loot.value2P?3:-1),t.R7$(),t.vxM(n.loot.value4P!=n.loot.value3P&&n.loot.value3P!=n.loot.value2P?4:-1),t.R7$(),t.Y8G("ghs-label","game.loot."+n.loot.type)}}function yb(a,r){if(1&a&&t.nrm(0,"img",17),2&a){const n=t.XpG(2);t.Y8G("src",n.gameManager.characterManager.characterIcon(n.character),t.B4B)}}function xb(a,r){1&a&&t.nrm(0,"img",18)}function Eb(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",16),t.bIt("click",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.changeCharacter(e))}),t.nVh(1,yb,1,1,"img",17),t.nVh(2,xb,1,0,"img",18),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.l_i(3,Cb,n.loot.type!=n.LootType.money&&n.loot.type!=n.LootType.special1&&n.loot.type!=n.LootType.special2,n.edit&&n.settingsManager.settings.applyLoot)),t.R7$(),t.vxM(n.character?1:-1),t.R7$(),t.vxM(!n.character&&n.settingsManager.settings.applyLoot&&n.apply?2:-1)}}function wb(a,r){1&a&&t.nrm(0,"img",9)}function Rb(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",20),t.bIt("singleClick",function(e){const o=c.eBV(n).$implicit,g=t.XpG(2);return c.Njj(g.toggleSection(e,o))})("doubleClick",function(e){const o=c.eBV(n).$implicit,g=t.XpG(2);return c.Njj(g.toggleSection(e,o,!0))}),t.nrm(1,"span",21),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(1,Mb,i.hasSection(n)))}}function jb(a,r){if(1&a&&(t.j41(0,"span",10),t.Z7z(1,Rb,2,3,"span",19,t.fX1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(n.sections)}}let ja=(()=>{class a{dialog;loot;index=-1;disableFlip=!1;flipped=!1;reveal=!1;edit=!1;looted=!1;highlight=!0;apply=!0;character="";gameManager=s.E;settingsManager=p.f;LootType=rt.r6;revealed=!1;animate=!1;sections=[];constructor(n){this.dialog=n}ngOnInit(){this.animate=!this.disableFlip,(this.loot.type==rt.r6.special1||this.loot.type==rt.r6.special2)&&this.loot.value&&(this.sections=this.loot.value.split("|"))}onChange(n){this.revealed=n}ngOnChanges(n){const i=n.flipped;i&&!this.disableFlip&&i.currentValue&&i.currentValue!=i.previousValue&&(this.animate=!0),(this.loot.type==rt.r6.special1||this.loot.type==rt.r6.special2)&&this.loot.value&&(this.sections=this.loot.value.split("|"))}hasSection(n){return null!=s.E.game.party.conclusions.find(i=>i.edition==s.E.currentEdition()&&i.index==n)}toggleSection(n,i,e=!1){if(this.hasSection(i))e&&(s.E.stateManager.before("unsetLootCardSection",i),s.E.game.party.conclusions=s.E.game.party.conclusions.filter(o=>o.edition!=s.E.currentEdition()||o.index!=i),s.E.stateManager.after());else{const o=s.E.sectionData(s.E.currentEdition()).find(g=>g.index==i&&g.conclusion);o&&!e?this.dialog.open(zt,{panelClass:["dialog"],data:{scenario:o,conclusionOnly:!0}}).closed.subscribe({next:()=>{if(this.hasSection(i)){if(s.E.stateManager.before("setLootCardSection",i),s.E.game.lootDeckSections.push(i),this.character&&o.rewards){const g=s.E.game.figures.find(m=>m instanceof H.K&&m.name==this.character);g instanceof H.K&&(o.rewards.lootingGold&&(g.progress.gold+=(0,A.hZ)(o.rewards.lootingGold)),o.rewards.items&&o.rewards.items.forEach(m=>{g.progress.items.find(k=>k.edition==s.E.currentEdition()&&k.name==m)||g.progress.items.push(new yt.gw(m,s.E.currentEdition()))}))}o.rewards&&o.rewards.removeLootDeckCards&&o.rewards.removeLootDeckCards.forEach(g=>{const m=rt.Di.find(k=>k.cardId==g);m&&s.E.game.lootDeckFixed.includes(m.type)&&s.E.game.lootDeckFixed.splice(s.E.game.lootDeckFixed.indexOf(m.type),1)}),s.E.stateManager.after()}}}):(s.E.stateManager.before("setLootCardSection",i),s.E.game.lootDeckSections.push(i),s.E.game.party.conclusions.push(new ut.Ag(i,s.E.currentEdition())),s.E.stateManager.after())}n.stopPropagation(),n.preventDefault()}changeCharacter(n){p.f.settings.applyLoot&&(this.edit||!this.character)&&(n.preventDefault(),n.stopPropagation(),this.dialog.open(Ms,{panelClass:["dialog"],data:{loot:this.loot,selected:this.character,edit:this.edit}}).closed.subscribe({next:e=>{if("string"==typeof e){const o=s.E.game.figures.find(m=>m instanceof H.K&&m.name==this.character);let g;if(o instanceof H.K&&o.name!=e&&(this.loot.type==rt.r6.random_item&&e?g=o.progress.equippedItems.find(m=>"loot-random-item"==m.marker):(s.E.stateManager.before("removeLootCard",s.E.characterManager.characterName(o),"game.loot."+this.loot.type,s.E.lootManager.getValue(this.loot)),o.lootCards=o.lootCards.filter(m=>m!=this.index),(this.loot.type==rt.r6.money||this.loot.type==rt.r6.special1||this.loot.type==rt.r6.special2)&&(o.loot-=s.E.lootManager.getValue(this.loot)),this.loot.type==rt.r6.random_item&&(g=o.progress.equippedItems.find(m=>"loot-random-item"==m.marker),g&&(o.progress.items=o.progress.items.filter(m=>g&&(m.edition!=g.edition||m.name!=g.name)),o.progress.equippedItems=o.progress.equippedItems.filter(m=>g&&(m.edition!=g.edition||m.name!=g.name)))),s.E.stateManager.after())),e&&(!o||o.name!=e)){const m=s.E.game.figures.find(k=>k instanceof H.K&&k.name==e);if(m instanceof H.K)if(this.loot.type!=rt.r6.random_item)s.E.stateManager.before("addLootCard",s.E.characterManager.characterName(m),"game.loot."+this.loot.type,s.E.lootManager.getValue(this.loot)),s.E.lootManager.applyLoot(this.loot,m,this.index),s.E.stateManager.after();else{let k=g?s.E.itemManager.getItem(g.name,g.edition,!0):void 0;k||(k=s.E.lootManager.applyLoot(this.loot,m,this.index)),k&&this.dialog.open(Gi,{panelClass:["dialog"],data:{item:k,character:m}}).closed.subscribe({next:X=>{if(X){const at=X;s.E.stateManager.before("lootRandomItem",at.id,at.edition,at.name,s.E.characterManager.characterName(m));let tt=new yt.gw(""+at.id,at.edition);s.E.itemManager.addItemCount(at),m.lootCards.includes(this.index)||(m.lootCards.push(this.index),m.lootCards.sort((J,et)=>J-et)),null!=m.progress.items.find(J=>J.name==""+at.id&&J.edition==at.edition)?m.progress.gold+=s.E.itemManager.itemSellValue(at):(m.progress.items.push(tt),m.progress.equippedItems.push(new yt.h5(tt.name,tt.edition,void 0,"loot-random-item"))),g&&o instanceof H.K&&(o.lootCards=o.lootCards.filter(J=>J!=this.index),o.progress.items=o.progress.items.filter(J=>g&&(J.edition!=g.edition||J.name!=g.name)),o.progress.equippedItems=o.progress.equippedItems.filter(J=>"loot-random-item"!=J.marker)),s.E.stateManager.after()}else m.lootCards=m.lootCards.filter(at=>at!=this.index)}})}}}}}))}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-loot"]],inputs:{loot:"loot",index:"index",disableFlip:"disableFlip",flipped:"flipped",reveal:"reveal",edit:"edit",looted:"looted",highlight:"highlight",apply:"apply",character:"character"},standalone:!1,features:[t.OA$],decls:18,vars:24,consts:[["card",""],["card-reveal","",1,"card",3,"change","ngClass","disabled"],[1,"card-back","back"],[1,"revealed"],[1,"text",3,"ghs-label"],[1,"card-front","front",3,"ngClass"],[1,"header"],[1,"character",3,"ngClass"],[1,"enhancements"],["src","./assets/images/fh/loot/plus1.svg",1,"icon"],[1,"sections"],[1,"card-id"],[1,"footer"],[1,"icon"],[3,"ghs-label"],[3,"ngClass","ghs-label"],[1,"character",3,"click","ngClass"],[3,"src"],["src","./assets/images/warning.svg",1,"warning"],["ghs-pointer-input","",1,"section"],["ghs-pointer-input","",1,"section",3,"singleClick","doubleClick"],[1,"checkbox",3,"ngClass"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div")(1,"div",1,0),t.bIt("change",function(m){return c.eBV(o),c.Njj(e.onChange(m))}),t.j41(3,"div",2)(4,"span",3),t.nrm(5,"span",4),t.k0s()(),t.j41(6,"div",5),t.nVh(7,kb,6,5,"span",6),t.nVh(8,Eb,3,6,"span",7),t.j41(9,"span",8),t.Z7z(10,wb,1,0,"img",9,t.fX1),t.nI1(12,"ghsRange"),t.k0s(),t.nVh(13,jb,3,0,"span",10),t.j41(14,"span",11),t.EFF(15),t.k0s(),t.j41(16,"span",12),t.nrm(17,"span",13),t.k0s()()()()}if(2&i){const o=t.sdS(2);t.HbH(t.VkB("loot ",e.loot.type)),t.R7$(),t.xc7("font-size",.08*o.offsetWidth+"px"),t.Y8G("ngClass",t.l_i(20,ub,e.flipped||e.revealed,!e.animate))("disabled",!e.reveal),t.R7$(4),t.Y8G("ghs-label","game.cards.confirmReveal"),t.R7$(),t.xc7("background-image","url(./assets/images/fh/loot/loot-"+e.loot.type+(e.loot.type==e.LootType.money?e.gameManager.lootManager.getValue(e.loot,!1):"")+".png)"),t.Y8G("ngClass",e.loot.type),t.R7$(),t.vxM(e.loot.type!=e.LootType.money&&e.loot.type!=e.LootType.special1&&e.loot.type!=e.LootType.special2?7:-1),t.R7$(),t.vxM(e.looted||e.character?8:-1),t.R7$(2),t.Dyx(t.i5U(12,17,t.lJ4(23,fb),e.loot.enhancements)),t.R7$(3),t.vxM(e.sections.length>0?13:-1),t.R7$(2),t.SpI(" ",e.loot.cardId," * "),t.R7$(2),t.xc7("background-image","url(./assets/images/fh/loot/"+(e.loot.type==e.LootType.special1||e.loot.type==e.LootType.special2?e.LootType.money:e.loot.type)+".svg)")}},dependencies:[N.YU,Nn,it,dt,At],styles:['.loot[_ngcontent-%COMP%]{position:absolute;inset:0;display:block}.loot[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{transition:transform calc(var(--ghs-animation-speed) * .5s) cubic-bezier(.75,0,.85,1)}.loot[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%]{background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(loot-back.b3962872f80142fe.png);border-radius:5%}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]{display:flex;position:relative;top:0;left:0;width:100%;height:100%;border-radius:5%;background-position:center;background-size:100% auto;background-repeat:no-repeat}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;position:absolute;top:0;left:0;width:100%;height:10%;font-size:1.3em;text-align:center;white-space:nowrap}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:.7em;opacity:.7}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .value.value-highlight[_ngcontent-%COMP%]{opacity:1;font-size:1.1em}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:20%;display:flex;justify-content:center;align-items:center;z-index:2}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .character.with-header[_ngcontent-%COMP%]{top:10%}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .character.edit[_ngcontent-%COMP%]{cursor:pointer}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:auto;filter:var(--ghs-filter-outline)}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   img.warning[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-outline);height:60%;margin-left:5%}.loot[_ngcontent-%COMP%]   .front.special1[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%], .loot[_ngcontent-%COMP%]   .front.special2[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{left:initial;right:0;width:60%;justify-content:flex-start}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]{position:absolute;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;top:50%;left:50%;height:50%;width:100%;transform:translate(-50%,-50%);z-index:1}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:20%;height:auto;margin:5%}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]{display:flex;flex-direction:column;font-size:1em;position:absolute;top:1em;left:.4em;z-index:2}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{cursor:pointer;position:relative;width:4em;height:.9em;margin-bottom:.8em}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{display:inline-block;position:relative;width:.9em;height:.9em;color:var(--ghs-color-black);border:.2em solid var(--ghs-color-black);background-color:var(--ghs-color-white);margin:0!important}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:before{position:absolute;left:5%;top:-35%;content:" ";width:130%;height:130%;transform:scale(0);transform-origin:bottom left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;clip-path:polygon(14% 44%,0 65%,50% 100%,100% 16%,80% 0%,43% 62%);color:var(--ghs-color-gray);background-color:var(--ghs-color-gray)}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .checkbox.checked[_ngcontent-%COMP%]:before{transform:scale(1);color:var(--ghs-color-black);background-color:var(--ghs-color-black)}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:hover   .checkbox[_ngcontent-%COMP%]:before{transform:scale(1);color:var(--ghs-color-gray);background-color:var(--ghs-color-gray)}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;font-size:.8em;width:20%;height:5%;display:flex;justify-content:center;align-content:center}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{position:absolute;display:flex;justify-content:center;align-items:center;bottom:0%;left:50%;height:12%;width:20%;transform:translate(-50%);border-top-left-radius:25%;border-top-right-radius:25%}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:80%;height:80%;background-size:contain;background-position:center center;background-repeat:no-repeat}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .bg-click[_ngcontent-%COMP%]{position:absolute;inset:0}.loot[_ngcontent-%COMP%]   .confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center;color:var(--ghs-color-white);font-size:1.3em;filter:drop-shadow(calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) var(--ghs-color-black))}.loot[_ngcontent-%COMP%]   .confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{text-align:center}']})}return a})();const Gb=a=>({"random-item":a}),Tb=(a,r)=>r._trackUUID;function Sb(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",7),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.randomItem(e)&&o.randomItemDialog(e))}),t.nrm(1,"ghs-loot",8),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.eq3(4,Gb,i.randomItem(n))),t.R7$(),t.Y8G("loot",n)("flipped",!0)("disableFlip",!0)}}function Db(a,r){if(1&a&&(t.j41(0,"div",5),t.Z7z(1,Sb,2,6,"div",6,Tb),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(t.bMT(3,0,n.lootCards))}}let $b=(()=>{class a{character;dialogRef;dialog;gameManager=s.E;lootCards=[];sorted=!1;constructor(n,i,e){this.character=n,this.dialogRef=i,this.dialog=e,this.character.lootCards&&this.character.lootCards.forEach(o=>this.lootCards.push(s.E.game.lootDeck.cards[o]))}sort(){this.sorted?(this.sorted=!1,this.lootCards=[],this.character.lootCards&&this.character.lootCards.forEach(n=>this.lootCards.push(s.E.game.lootDeck.cards[n]))):(this.sorted=!0,this.lootCards.sort((n,i)=>n.cardId-i.cardId))}randomItem(n){if(n.type==rt.r6.random_item){const i=this.character.progress.equippedItems.find(e=>"loot-random-item"==e.marker);if(i)return s.E.itemManager.getItem(i.name,i.edition,!0)}}randomItemDialog(n){const i=this.randomItem(n);i&&this.dialog.open(fn,{panelClass:["fullscreen-panel"],disableClose:!0,data:{item:i}})}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-character-loot-cards"]],standalone:!1,decls:6,vars:2,consts:[[1,"loot-cards-dialog"],[1,"scroll-container"],[1,"menu"],[3,"click"],[3,"ghs-label"],[1,"loot-cards"],[1,"loot-container",3,"ngClass"],[1,"loot-container",3,"click","ngClass"],[3,"loot","flipped","disableFlip"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),t.bIt("click",function(){return e.sort()}),t.nrm(4,"span",4),t.k0s()(),t.nVh(5,Db,4,2,"div",5),t.k0s()()),2&i&&(t.R7$(4),t.Y8G("ghs-label",e.sorted?"character.lootCards.drawn":"character.lootCards.sort"),t.R7$(),t.vxM(e.character.lootCards?5:-1))},dependencies:[N.YU,it,ja,ct],styles:[".loot-cards-dialog[_ngcontent-%COMP%]{position:relative}.loot-cards-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;flex-wrap:wrap;max-width:calc(var(--ghs-unit) * 60 * var(--ghs-dialog-factor))}.loot-cards-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.loot-cards-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.loot-cards-dialog[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-evenly;align-items:center;overflow-y:auto;overflow-x:hidden;width:calc(var(--ghs-unit) * 57 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.loot-cards-dialog[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]{position:relative;display:flex;transition:none;width:calc(var(--ghs-unit) * 25.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 38.25 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) 0;flex-shrink:0;flex-grow:0}.loot-cards-dialog[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-container.random-item[_ngcontent-%COMP%]{cursor:pointer}.loot-cards-dialog[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]   ghs-loot[_ngcontent-%COMP%]{position:absolute;display:flex;top:0;left:0;width:100%;height:100%;z-index:1}"]})}return a})();const Ib=()=>[],Ab=a=>({active:a}),Ke=a=>({disabled:a}),ks=a=>({fh:a}),Vb=a=>[a],Fb=(a,r)=>r._trackUUID;function Xb(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",10),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.selectColor(e))}),t.j41(1,"span",11),t.nrm(2,"img",12),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.eq3(3,Ab,n==i.summonColor)),t.R7$(2),t.Y8G("src",t.VkB("./assets/images/summons/",n,".png"),t.B4B)}}function Bb(a,r){if(1&a&&t.Z7z(0,Xb,3,5,"span",9,t.fX1),2&a){const n=t.XpG();t.Dyx(n.summonColors)}}function Yb(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",13),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.pickNumber(e+1))}),t.j41(1,"span",14),t.EFF(2),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(2,Ke,i.summonNumber==n+1)),t.R7$(2),t.JRh(n+1)}}function Ub(a,r){1&a&&t.nrm(0,"img",18)}function Nb(a,r){if(1&a&&t.nrm(0,"img",12),2&a){const n=t.XpG(3);t.Y8G("src",t.VkB("./assets/images/summons/",n.summonColor,".png"),t.B4B)}}function zb(a,r){if(1&a&&t.nrm(0,"span",20),2&a){const n=t.XpG(2).$implicit;t.Y8G("ghs-label","character.summon.level")("ghs-label-args",t.eq3(2,Vb,n.level||1))}}function Lb(a,r){if(1&a&&(t.nrm(0,"span",21),t.j41(1,"span",22),t.nrm(2,"img",12),t.k0s()),2&a){const n=t.XpG(2).$implicit;t.R7$(2),t.Y8G("src",n.thumbnailUrl?n.thumbnailUrl:"./assets/images/summons/thumbnail/"+n.edition+"-"+n.name+".png",t.B4B)}}function qb(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",15),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.addSummon(e))}),t.j41(1,"span",16)(2,"span",17),t.nVh(3,Ub,1,0,"img",18),t.nVh(4,Nb,1,2,"img",12),t.j41(5,"span",19),t.EFF(6),t.k0s()()(),t.j41(7,"label"),t.nrm(8,"span",3),t.nVh(9,zb,1,4,"span",20),t.k0s(),t.nVh(10,Lb,3,1),t.k0s()}if(2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG();t.Y8G("ngClass",t.eq3(8,Ke,-1==o.summonNumbers[e]||!o.available(i,o.summonNumber||o.summonNumbers[e]))),t.R7$(2),t.Y8G("ngClass",t.eq3(10,ks,o.fhSummon)),t.R7$(),t.vxM(!o.fhSummon&&i.special?3:-1),t.R7$(),t.vxM(o.fhSummon||i.special?-1:4),t.R7$(2),t.JRh(o.summonNumber?o.summonNumber:-1!=o.summonNumbers[e]?o.summonNumbers[e]:"-"),t.R7$(2),t.Y8G("ghs-label","data.summon."+i.name),t.R7$(),t.vxM(o.showLevel(i)?9:-1),t.R7$(),t.vxM(i.thumbnail&&!i.noThumbnail||i.thumbnailUrl?10:-1)}}function Hb(a,r){if(1&a&&t.nVh(0,qb,11,12,"span",8),2&a){const n=r.$index,i=t.XpG();t.vxM(i.showAll||-1!=i.summonNumbers[n]?0:-1)}}function Kb(a,r){if(1&a&&t.nrm(0,"img",12),2&a){const n=t.XpG(2);t.Y8G("src",t.VkB("./assets/images/summons/",n.summonColor,".png"),t.B4B)}}function Wb(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",8)(1,"span",10),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.addCustomSummon())}),t.j41(2,"span",17),t.nVh(3,Kb,1,2,"img",12),t.j41(4,"span",19),t.EFF(5),t.k0s()()(),t.j41(6,"input",23),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setSummonName(e))})("keyup",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setSummonName(e))}),t.k0s(),t.j41(7,"span",24),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.addCustomSummon())}),t.nrm(8,"img",25),t.k0s()()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(9,Ke,!n.summonNumber)),t.R7$(),t.Y8G("ngClass",t.eq3(11,Ke,n.customDisabled())),t.R7$(),t.Y8G("ngClass",t.eq3(13,ks,n.fhSummon)),t.R7$(),t.vxM(n.fhSummon?-1:3),t.R7$(2),t.JRh(n.summonNumber?n.summonNumber:"-"),t.R7$(),t.Y8G("value",n.summonName)("ghs-label","summon.name")("ghs-label-attribute","placeholder"),t.R7$(),t.Y8G("ngClass",t.eq3(15,Ke,n.customDisabled()))}}let Zb=(()=>{class a{character;dialogRef;gameManager=s.E;summonColors=Object.values(_t.rX).filter(n=>n!=_t.rX.custom&&n!=_t.rX.fh);summonColor=_t.rX.blue;summonNumber;summonName="";summonFilter;fhSummon=!1;summonData=[];summonNumbers=[];showAll=!1;constructor(n,i){if(this.character=n,this.dialogRef=i,this.summonFilter="",this.fhSummon="fh"===this.character.edition||s.E.editionExtensions(this.character.edition).includes("fh"),this.fhSummon&&(this.summonColor=_t.rX.fh),this.updateSummonData(),!this.fhSummon){this.summonNumber=1;for(let e=2;e<9;e++)this.summonData.filter(o=>this.available(o,e))>this.summonData.filter(o=>this.available(o,e-1))&&(this.summonNumber=e)}}pickNumber(n){this.summonNumber=this.summonNumber==n?void 0:n}selectColor(n){this.summonColor=n}available(n,i){return this.summonColor!=_t.rX.custom&&0!=i&&this.character.summons.every(e=>e.dead||e.name!=n.name||(n.special?0!=e.number:e.number!=i)||(n.special?e.color!=_t.rX.custom:e.color!=this.summonColor))&&(n.count||1)>this.character.summons.filter(e=>e.name==n.name&&e.cardId==n.cardId&&s.E.entityManager.isAlive(e)).length}customDisabled(){return this.character.summons.some(n=>s.E.entityManager.isAlive(n)&&n.name==this.summonName&&n.number==this.summonNumber&&n.color==this.summonColor)}showLevel(n){return this.summonData.some(i=>i.name==n.name&&i.cardId!=n.cardId&&n.level!=i.level)}updateSummonData(){let n=[];if(n.push(...this.character.availableSummons.filter(i=>!i.level||i.level<=this.character.level)),p.f.settings.characterItems){if(this.character.progress&&this.character.progress.items)for(let i of this.character.progress.items){const e=s.E.itemManager.getItem(i.name,i.edition,!0);e&&e.summon&&(e.summon.name||(e.summon.name=e.name),e.summon.count||(e.summon.count=1),n.push(e.summon))}}else{const i=s.E.game.edition?[s.E.game.edition,...s.E.editionExtensions(s.E.game.edition)]:s.E.editions(!1,!0);for(let e of i)s.E.itemManager.getItems(e,!0).filter(o=>o.summon).forEach(o=>{o.summon&&n.push(o.summon)})}this.summonData=n.filter(i=>!this.summonFilter||i.cardId==this.summonFilter),this.summonData.forEach((i,e)=>{this.summonNumbers[e]=-1;for(let o=1;o<9;o++)this.available(i,o)&&-1==this.summonNumbers[e]&&(this.summonNumbers[e]=o)})}setSummonName(n){this.summonName=n.target.value}addCustomSummon(){if(this.summonNumber){s.E.stateManager.before("addCustomSummon",s.E.characterManager.characterName(this.character),this.summonNumber,this.summonColor);let n=new _t.up((0,va.A)(),this.summonName,"",this.character.level,this.summonNumber,this.summonColor);n.state=_t.N5.new,s.E.characterManager.addSummon(this.character,n),(0,F.co)(this.dialogRef),s.E.stateManager.after(),this.updateSummonData()}}addSummon(n){const i=this.summonData.indexOf(n);if(-1!=i){s.E.stateManager.before("addSummon",s.E.characterManager.characterName(this.character),"data.summon."+n.name);let e=new _t.up((0,va.A)(),n.name,n.cardId,this.character.level,n.special?0:this.summonNumber||this.summonNumbers[i],n.special?_t.rX.custom:this.summonColor,n);e.state=n.special?_t.N5.true:_t.N5.new,e.init=!1,s.E.characterManager.addSummon(this.character,e),n.count&&this.character.summons.filter(o=>o.name==n.name&&o.cardId==n.cardId).length!=n.count?(this.summonFilter=n.cardId,this.summonNumber&&(this.fhSummon?this.summonNumber=void 0:(this.summonNumber++,this.summonNumber>(this.fhSummon?8:4)&&(this.summonNumber=1)))):(0,F.co)(this.dialogRef),s.E.stateManager.after(),this.updateSummonData()}}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-character-summondialog"]],standalone:!1,decls:17,vars:11,consts:[[1,"summon-dialog"],[1,"title"],[1,"icon",3,"src"],[3,"ghs-label"],[1,"container"],[1,"color-container"],[1,"number-button",3,"ngClass"],[1,"scroll-container","summons"],[1,"summon",3,"ngClass"],[1,"summon-button",3,"ngClass"],[1,"summon-button",3,"click","ngClass"],[1,"image"],[3,"src"],[1,"number-button",3,"click","ngClass"],[1,"number"],[1,"summon",3,"click","ngClass"],[1,"summon-button"],[1,"image",3,"ngClass"],["src","./assets/images/summons/custom.png"],[1,"summon-number"],[1,"level-hint",3,"ghs-label","ghs-label-args"],[1,"spacer"],[1,"thumbnail"],["type","text",3,"change","keyup","value","ghs-label","ghs-label-attribute"],[1,"add-summon-button",3,"click","ngClass"],["src","./assets/images/plus.svg",1,"ghs-svg"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"small"),t.nrm(3,"img",2),t.EFF(4),t.k0s(),t.nrm(5,"span",3),t.k0s(),t.j41(6,"div",4)(7,"div",5),t.nVh(8,Bb,2,0),t.Z7z(9,Yb,3,4,"span",6,t.fX1),t.nI1(11,"ghsRange"),t.k0s(),t.j41(12,"div",7),t.Z7z(13,Hb,1,1,null,null,Fb),t.nI1(15,"trackUUID"),t.nVh(16,Wb,9,17,"span",8),t.k0s()()()),2&i&&(t.R7$(3),t.Y8G("src",e.character.iconUrl,t.B4B),t.R7$(),t.SpI(" ",e.gameManager.characterManager.characterName(e.character)," "),t.R7$(),t.Y8G("ghs-label","summon"),t.R7$(3),t.vxM(e.fhSummon?-1:8),t.R7$(),t.Dyx(t.i5U(11,5,t.lJ4(10,Ib),8)),t.R7$(4),t.Dyx(t.bMT(15,8,e.summonData)),t.R7$(3),t.vxM(e.summonFilter?-1:16))},dependencies:[N.YU,it,At,ct],styles:[".title[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.title[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{flex-basis:100%;flex-shrink:0;display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.title[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));width:auto;margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .add-summon-button[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 6.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 6.5 * var(--ghs-dialog-factor))}.container[_ngcontent-%COMP%]   .summon-button.add-summon-button[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .add-summon-button.add-summon-button[_ngcontent-%COMP%]{position:relative;border:none!important}.container[_ngcontent-%COMP%]   .summon-button.add-summon-button[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .add-summon-button.add-summon-button[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.container[_ngcontent-%COMP%]   .summon-button.add-summon-button[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .add-summon-button.add-summon-button[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .add-summon-button[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor))}.container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .add-summon-button[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}.container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .add-summon-button[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%]{position:absolute;display:flex;justify-content:center;align-items:center;top:0;left:calc(var(--ghs-unit) * -.1 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray);border-top-left-radius:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));border-bottom-left-radius:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));z-index:1;opacity:.9}.container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]   .image.fh[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .add-summon-button[_ngcontent-%COMP%]   .image.fh[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));font-family:var(--ghs-font-gh-title);color:var(--ghs-color-white);border:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor)) solid var(--ghs-color-white);border-radius:100%}.container[_ngcontent-%COMP%]   .summon-button.active[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .add-summon-button.active[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) / 4) var(--ghs-color-white) solid;border-radius:100%}.container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]:hover, .container[_ngcontent-%COMP%]   .add-summon-button[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.container[_ngcontent-%COMP%]   .summon-button.disabled[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .add-summon-button.disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.5}.container[_ngcontent-%COMP%]   .summon-button.disabled[_ngcontent-%COMP%]:hover, .container[_ngcontent-%COMP%]   .add-summon-button.disabled[_ngcontent-%COMP%]:hover{border:none}.container[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.container[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));height:auto}.container[_ngcontent-%COMP%]   .color-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,calc(var(--ghs-unit) * 7.5 * var(--ghs-dialog-factor)));row-gap:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.container[_ngcontent-%COMP%]   .color-container[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 6.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 6.5 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.container[_ngcontent-%COMP%]   .color-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 6.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 6.5 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline)}.container[_ngcontent-%COMP%]   .color-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white);border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.container[_ngcontent-%COMP%]   .color-container[_ngcontent-%COMP%]   .number-button.disabled[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-darkgray)}.container[_ngcontent-%COMP%]   .color-container[_ngcontent-%COMP%]   .number-button.disabled[_ngcontent-%COMP%]:hover{border:none}.container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:calc(var(--ghs-unit) * 50 * var(--ghs-dialog-factor))}.container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center}.container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .level-hint[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]:hover   .summon-button[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]:hover   .summon-button.disabled[_ngcontent-%COMP%]{pointer-events:none!important;border:none}.container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]:hover   label[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{margin:0;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);background-color:transparent;border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);border-radius:calc(var(--ghs-unit) * 1);user-select:auto;-webkit-user-select:auto;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   .summon.disabled[_ngcontent-%COMP%]{pointer-events:none!important}.container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   .summon.disabled[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]{opacity:.5}.container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   .summon.disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray)}"]})}return a})();var Tt=v(5532);const Jb=a=>({fh:a}),ys=a=>({consume:a}),Qb=(a,r)=>r._trackUUID;function t0(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function n0(a,r){if(1&a&&(t.j41(0,"span",4),t.nVh(1,t0,2,0,"span"),t.j41(2,"span",6),t.EFF(3),t.k0s()()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.R7$(),t.vxM(i>0?1:-1),t.R7$(),t.HbH(e.gameManager.isMonsterEntity(n)&&e.gameManager.toMonsterEntity(n).type||""),t.R7$(),t.JRh(n.number)}}function e0(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",10),t.bIt("singleClick",function(e){const o=c.eBV(n).$implicit,g=t.XpG(3);return c.Njj(g.selectWildElement(e,o))}),t.nrm(1,"img",8),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(3);t.Y8G("ngClass",t.eq3(2,ys,i.chooseElementAction.action.valueType==i.ActionValueType.minus)),t.R7$(),t.Y8G("src","./assets/images"+(i.settingsManager.settings.fhStyle?"/fh":"")+"/element/"+n+".svg",t.B4B)}}function a0(a,r){if(1&a&&(t.j41(0,"span",5)(1,"span",7),t.nrm(2,"img",8),t.k0s(),t.Z7z(3,e0,2,4,"span",9,t.fX1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(2,ys,n.chooseElementAction.action.valueType==n.ActionValueType.minus)),t.R7$(),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/element/wild.svg",t.B4B),t.R7$(),t.Dyx(n.chooseElementAction.action.valueType==n.ActionValueType.minus?n.wildToConsume():n.wildToCreate())}}function o0(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",1),t.bIt("singleClick",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.applyInteractiveActions(e))}),t.nrm(1,"span",2),t.j41(2,"span",3),t.Z7z(3,n0,4,4,"span",4,Qb),t.nI1(5,"trackUUID"),t.k0s(),t.nVh(6,a0,5,4,"span",5),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(5,Jb,"fh"==n.settingsManager.settings.theme)),t.R7$(),t.Y8G("ghs-label",n.interactiveActions.length?"monster.applyInteractiveActions":"monster.skipInteractiveActions"),t.R7$(2),t.Dyx(t.bMT(5,3,n.interactiveActionEntities)),t.R7$(3),t.vxM(n.chooseElementAction?6:-1)}}let xs=(()=>{class a{ghsManager;actions;figure;preIndex="";interactiveActions=[];interactiveActionsChange=new t.bkB;gameManager=s.E;settingsManager=p.f;ActionValueType=$.iQ;interactiveActionEntities=[];chooseElementAction;chooseElementValues=[];constructor(n){this.ghsManager=n}ngOnInit(){this.update(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){let n=this.interactiveActions.length>0;this.interactiveActions=[],this.interactiveActionEntities=[],p.f.settings.interactiveAbilities&&this.figure.active&&(this.interactiveActions=s.E.actionsManager.getAllInteractiveActions(this.figure,this.actions,this.preIndex),this.chooseElementAction=void 0,this.chooseElementValues=[],this.interactiveActionEntities=this.figure.entities.filter(i=>s.E.actionsManager.getInteractiveActions(i,this.figure,this.actions,this.preIndex).length),this.figure instanceof b.R&&(this.interactiveActionEntities=this.interactiveActionEntities.map(i=>i).sort(s.E.monsterManager.sortEntities)),this.interactiveActionEntities=this.interactiveActionEntities.filter((i,e)=>p.f.settings.combineInteractiveAbilities||0==e),n=!0),n&&setTimeout(()=>{this.interactiveActionsChange.emit(this.interactiveActions)},1)}applyInteractiveActions(n,i=!1){if(!i&&this.chooseElementAction&&s.E.actionsManager.getValues(this.chooseElementAction.action).filter(e=>e==Tt.Hg.wild).length!=this.chooseElementValues.length)return this.chooseElementAction=void 0,void(this.chooseElementValues=[]);if(this.chooseElementAction=this.interactiveActions.find(e=>e.action.type==$.X2.element&&s.E.actionsManager.getValues(e.action).includes(Tt.Hg.wild)),this.chooseElementAction){const e=s.E.actionsManager.getValues(this.chooseElementAction.action).filter(o=>o==Tt.Hg.wild).length;if(e!=this.chooseElementValues.length)if(this.chooseElementAction.action.valueType==$.iQ.minus&&this.wildToConsume().length==e-this.chooseElementValues.length)this.wildToConsume().forEach(o=>this.chooseElementValues.push(o));else{if(this.chooseElementAction.action.valueType==$.iQ.minus||this.wildToCreate().length!=e-this.chooseElementValues.length)return;this.wildToConsume().forEach(o=>this.chooseElementValues.push(o))}}if(this.interactiveActionEntities.length||this.interactiveActionEntities.length){let e=!0;const o=(p.f.settings.combineInteractiveAbilities?this.interactiveActions:s.E.actionsManager.getInteractiveActions(this.interactiveActionEntities[0],this.figure,this.actions,this.preIndex)).filter(m=>this.interactiveActions.find(k=>k.index==m.index)).map(m=>{let k=m.action.type,X=s.E.actionsManager.getValues(m.action);if(k==$.X2.element)if(m.action.valueType==$.iQ.minus){k="elementConsume",X=X.map(J=>"%game.element.consume."+J+"%");let at=s.E.actionsManager.getElementsToConsume(m.action).map(J=>"%game.element.consume."+J.type+"%"),tt=this.chooseElementValues.map(J=>"%game.element.consume."+J+"%");X=X.map(J=>J==Tt.Hg.wild?tt.pop()||at.pop():(at.pop(),J)).map(J=>J)}else k="elementInfuse",X=X.map((at,tt)=>this.chooseElementValues[tt]?"%game.element."+this.chooseElementValues[tt]+"%":"%game.element."+at+"%");return p.f.getLabel("state.info.applyHighlightAction."+k,[X.join(", ")])}).join(", "),g=this.interactiveActionEntities.map(m=>m instanceof Dt.I?"%game.monsterType."+m.type+"."+m.number+"%":m.number).join(", ");s.E.stateManager.before(this.interactiveActions.length?"applyInteractiveActions":"skipInteractiveActions",o,g,this.figure instanceof b.R?"data.monster."+this.figure.name:s.E.objectiveManager.objectiveName(this.figure)),this.interactiveActionEntities.forEach(m=>{let k=s.E.actionsManager.getInteractiveActions(m,this.figure,this.actions,this.preIndex).filter(tt=>this.interactiveActions.find(J=>J.index==tt.index)),X=k[0]||void 0;for(;X;){if(s.E.actionsManager.applyInteractiveAction(m,this.figure,X,this.chooseElementValues),X.action.type==$.X2.element&&(this.chooseElementValues=[]),k=s.E.actionsManager.getInteractiveActions(m,this.figure,this.actions,this.preIndex).filter(tt=>this.interactiveActions.find(J=>J.index==tt.index)),k.some(tt=>tt.index==X.index)){console.warn("Interactive Action already processed, should not happen",X);break}X=k[0]||void 0}s.E.actionsManager.getInteractiveActions(m,this.figure,this.actions,this.preIndex).filter(tt=>!this.interactiveActions.find(J=>J.index==tt.index)).forEach(tt=>{const J=s.E.actionsManager.roundTag(tt.action,tt.index);m.tags.includes(J)||m.tags.push(J)})}),this.interactiveActionEntities.some(m=>m.dead)&&(e=!1,this.ghsManager.triggerUiChange(),setTimeout(()=>{this.interactiveActionEntities.forEach(m=>{m.dead&&(this.figure instanceof b.R&&m instanceof Dt.I?s.E.monsterManager.removeMonsterEntity(this.figure,m):this.figure instanceof ft.$e&&m instanceof ln.X&&s.E.objectiveManager.removeObjectiveEntity(this.figure,m),this.figure.entities.every(k=>k.dead||k.health<=0||!k.active)&&(this.figure.off=!0,this.figure.active&&s.E.roundManager.toggleFigure(this.figure)))}),this.update(),s.E.stateManager.after()},p.f.settings.animations?1500*p.f.settings.animationSpeed:0)),e&&(this.update(),s.E.stateManager.after()),n.preventDefault(),n.stopPropagation()}}wildToConsume(){return s.E.game.elementBoard.filter(n=>!(n.state==Tt.e_.inert||n.state==Tt.e_.new||n.state==Tt.e_.consumed||this.chooseElementValues.includes(n.type)||this.chooseElementAction&&s.E.actionsManager.getValues(this.chooseElementAction.action).includes(n.type)||this.interactiveActions.find(i=>i.action.type==$.X2.element&&i.action.valueType==$.iQ.minus&&i.action.value==n.type))).map(n=>n.type)}wildToCreate(){return s.E.game.elementBoard.filter(n=>!(n.state==Tt.e_.new||n.state==Tt.e_.strong||n.state==Tt.e_.always||this.chooseElementValues.includes(n.type)||this.chooseElementAction&&s.E.actionsManager.getValues(this.chooseElementAction.action).includes(n.type))).map(n=>n.type)}selectWildElement(n,i){this.chooseElementValues.push(i),this.applyInteractiveActions(n,!0),n.preventDefault(),n.stopPropagation()}onInteractiveActionsChange(n){this.interactiveActionsChange.emit(n)}static \u0275fac=function(i){return new(i||a)(t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-interactive-actions"]],inputs:{actions:"actions",figure:"figure",preIndex:"preIndex",interactiveActions:"interactiveActions"},outputs:{interactiveActionsChange:"interactiveActionsChange"},standalone:!1,decls:1,vars:1,consts:[["ghs-pointer-input","",1,"interactive-entities",3,"ngClass"],["ghs-pointer-input","",1,"interactive-entities",3,"singleClick","ngClass"],[3,"ghs-label"],[1,"entity-numbers"],[1,"entity"],[1,"choose-element-container"],[1,"number"],[1,"element",3,"ngClass"],[3,"src"],["ghs-pointer-input","",1,"element","choose-element",3,"ngClass"],["ghs-pointer-input","",1,"element","choose-element",3,"singleClick","ngClass"]],template:function(i,e){1&i&&t.nVh(0,o0,7,7,"div",0),2&i&&t.vxM(e.interactiveActions.length||e.interactiveActionEntities.length?0:-1)},dependencies:[N.YU,it,dt,ct],styles:['.interactive-entities[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;cursor:pointer;font-size:1.3em;line-height:.8em;color:var(--ghs-color-gray);height:1.8em}.interactive-entities.fh[_ngcontent-%COMP%]{height:2.2em;padding-bottom:.4em}.interactive-entities[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{z-index:1}.interactive-entities[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:0;background-color:var(--ghs-color-darkgray);opacity:.5}.interactive-entities[_ngcontent-%COMP%]   .entity-numbers[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap;font-size:1.2em}.interactive-entities[_ngcontent-%COMP%]   .entity-numbers[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{margin-left:.2em}.interactive-entities[_ngcontent-%COMP%]   .entity-numbers[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .number.normal[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.interactive-entities[_ngcontent-%COMP%]   .entity-numbers[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .number.elite[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.interactive-entities[_ngcontent-%COMP%]   .entity-numbers[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .number.boss[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]{position:absolute;width:5.5em;height:5.5em;bottom:.2em;left:50%;transform:translate(-50%);cursor:initial}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%]{position:absolute;width:25%;height:25%;top:50%;left:50%;transform:translate(-50%,-50%)}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:0;background-color:var(--ghs-color-darkgray);opacity:.5;z-index:0;border-radius:100%}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]   .choose-element[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:50%;left:50%;width:25%;height:25%;margin:-12.5%;z-index:1}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]   .choose-element[_ngcontent-%COMP%]:before{display:none}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]   .choose-element[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:brightness(.8) grayscale(.4)}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]   .choose-element[_ngcontent-%COMP%]:hover:before{display:block}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]   .choose-element[_ngcontent-%COMP%]:nth-child(2){transform:rotate(-30deg) translate(125%) rotate(30deg)}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]   .choose-element[_ngcontent-%COMP%]:nth-child(3){transform:rotate(-210deg) translate(125%) rotate(210deg)}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]   .choose-element[_ngcontent-%COMP%]:nth-child(4){transform:rotate(-330deg) translate(125%) rotate(330deg)}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]   .choose-element[_ngcontent-%COMP%]:nth-child(5){transform:rotate(-150deg) translate(125%) rotate(150deg)}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]   .choose-element[_ngcontent-%COMP%]:nth-child(6){transform:rotate(-90deg) translate(125%) rotate(90deg)}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]   .choose-element[_ngcontent-%COMP%]:nth-child(7){transform:rotate(-270deg) translate(125%) rotate(270deg)}.interactive-entities[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white);font-size:1.6em;line-height:1em;height:2.5em}.interactive-entities[_ngcontent-%COMP%]:hover:before{opacity:.7}']})}return a})();const s0=(a,r,n)=>({fh:a,bb:r,expand:n}),r0=a=>({flipped:a}),Es=(a,r)=>({"bottom-actions":a,"character-actions":r}),ws=a=>({disabled:a}),c0=a=>({"interactive-actions-top":a});function l0(a,r){if(1&a&&t.nrm(0,"span",7),2&a){const n=t.XpG();t.Y8G("ghs-label",n.deckLabel)}}function g0(a,r){if(1&a&&(t.j41(0,"span",8),t.nrm(1,"span",11),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","data.character."+n.character.edition+"."+n.character.name)}}function d0(a,r){if(1&a&&(t.j41(0,"span",9),t.nrm(1,"img",12),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("src",n.character.iconUrl,t.B4B)}}function h0(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function _0(a,r){1&a&&t.nrm(0,"div",17)}function m0(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-interactive-actions",24),t.mxI("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(2);return t.DH7(o.interactiveActions,e)||(o.interactiveActions=e),c.Njj(e)}),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(4,c0,n.ability.bottomActions&&n.ability.bottomActions.length>0||n.character))("figure",n.monster)("actions",n.ability.actions),t.R50("interactiveActions",n.interactiveActions)}}function p0(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-interactive-actions",29),t.mxI("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(3);return t.DH7(o.interactiveBottomActions,e)||(o.interactiveBottomActions=e),c.Njj(e)}),t.k0s()}if(2&a){const n=t.XpG(3);t.Y8G("figure",n.monster)("actions",n.ability.bottomActions),t.R50("interactiveActions",n.interactiveBottomActions),t.Y8G("preIndex","bottom")}}function u0(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",25),t.nrm(1,"span",6),t.k0s(),t.j41(2,"div",14)(3,"div",26)(4,"ghs-actions",27),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.onInteractiveBottomActionsChange(e))}),t.k0s()()(),t.nVh(5,p0,1,4,"ghs-interactive-actions",28)}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label",n.ability.level||0),t.R7$(),t.Y8G("ngClass",t.eq3(12,ws,n.activeActions&&"top"==n.activeActions)),t.R7$(2),t.Y8G("actions",n.ability.bottomActions)("monster",n.monster)("character",n.character)("statsCalculation",n.statsCalculation)("relative",n.relative)("interactiveAbilities",n.interactiveAbilities)("interactiveActions",n.interactiveBottomActions)("index","bottom")("cardId",n.ability.cardId),t.R7$(),t.vxM(n.interactiveAbilities&&n.monster&&(!n.activeActions||n.activeActions&&"bottom"==n.activeActions)?5:-1)}}function f0(a,r){1&a&&(t.j41(0,"div",19),t.nrm(1,"img",30),t.k0s())}function C0(a,r){1&a&&(t.j41(0,"div",20),t.nrm(1,"img",30),t.k0s())}function M0(a,r){if(1&a&&(t.j41(0,"span",21),t.EFF(1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.SpI("[",n.abilityIndex+1,"]")}}function v0(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function O0(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function P0(a,r){if(1&a&&(t.j41(0,"span",21),t.nVh(1,v0,2,0,"span"),t.nVh(2,O0,2,0,"span"),t.j41(3,"span"),t.EFF(4),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(),t.vxM(n.character&&n.ability.cardId<100?1:-1),t.R7$(),t.vxM(n.character&&n.ability.cardId<10?2:-1),t.R7$(2),t.JRh(n.ability.cardId)}}function b0(a,r){if(1&a&&(t.j41(0,"span",9),t.nrm(1,"img",12),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("src",n.character.iconUrl,t.B4B)}}function k0(a,r){if(1&a&&(t.j41(0,"span",33),t.nrm(1,"img",38),t.j41(2,"span",39),t.EFF(3),t.k0s()()),2&a){const n=t.XpG(3);t.R7$(3),t.JRh(n.ability.xp)}}function y0(a,r){1&a&&(t.j41(0,"span",34),t.nrm(1,"img",40)(2,"img",41),t.k0s())}function x0(a,r){1&a&&(t.j41(0,"span",35),t.nrm(1,"img",42)(2,"img",43),t.k0s())}function E0(a,r){1&a&&(t.j41(0,"span",36),t.nrm(1,"img",44)(2,"img",45),t.k0s())}function w0(a,r){1&a&&(t.j41(0,"span",37),t.nrm(1,"img",46)(2,"img",47),t.k0s())}function R0(a,r){if(1&a&&(t.j41(0,"div",22)(1,"span",31),t.EFF(2,"!"),t.k0s(),t.j41(3,"div",32),t.nVh(4,k0,4,1,"span",33),t.nVh(5,y0,3,0,"span",34),t.nVh(6,x0,3,0,"span",35),t.nVh(7,E0,3,0,"span",36),t.nVh(8,w0,3,0,"span",37),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(4),t.vxM(n.ability.xp?4:-1),t.R7$(),t.vxM(n.ability.persistent?5:-1),t.R7$(),t.vxM(n.ability.loss?6:-1),t.R7$(),t.vxM(n.ability.round?7:-1),t.R7$(),t.vxM(n.ability.lost?8:-1)}}function j0(a,r){if(1&a&&(t.j41(0,"span",33),t.nrm(1,"img",38),t.j41(2,"span",39),t.EFF(3),t.k0s()()),2&a){const n=t.XpG(3);t.R7$(3),t.JRh(n.ability.bottomXp)}}function G0(a,r){1&a&&(t.j41(0,"span",34),t.nrm(1,"img",40)(2,"img",41),t.k0s())}function T0(a,r){1&a&&(t.j41(0,"span",35),t.nrm(1,"img",42)(2,"img",43),t.k0s())}function S0(a,r){1&a&&(t.j41(0,"span",36),t.nrm(1,"img",44)(2,"img",45),t.k0s())}function D0(a,r){1&a&&(t.j41(0,"span",37),t.nrm(1,"img",46)(2,"img",47),t.k0s())}function $0(a,r){if(1&a&&(t.j41(0,"div",23)(1,"span",31),t.EFF(2,"!"),t.k0s(),t.j41(3,"div",32),t.nVh(4,j0,4,1,"span",33),t.nVh(5,G0,3,0,"span",34),t.nVh(6,T0,3,0,"span",35),t.nVh(7,S0,3,0,"span",36),t.nVh(8,D0,3,0,"span",37),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(4),t.vxM(n.ability.bottomXp?4:-1),t.R7$(),t.vxM(n.ability.bottomPersistent?5:-1),t.R7$(),t.vxM(n.ability.bottomLoss?6:-1),t.R7$(),t.vxM(n.ability.bottomRound?7:-1),t.R7$(),t.vxM(n.ability.bottomLost?8:-1)}}function I0(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",13),t.nVh(1,h0,2,0,"span"),t.EFF(2),t.k0s(),t.j41(3,"span",8),t.EFF(4),t.k0s(),t.j41(5,"div",14)(6,"div",15)(7,"ghs-actions",16),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()(),t.nVh(8,_0,1,0,"div",17),t.k0s(),t.nVh(9,m0,1,6,"ghs-interactive-actions",18),t.nVh(10,u0,6,14),t.nVh(11,f0,2,0,"div",19),t.nVh(12,C0,2,0,"div",20),t.nVh(13,M0,2,1,"span",21),t.nVh(14,P0,5,3,"span",21),t.nVh(15,b0,2,1,"span",9),t.nVh(16,R0,9,5,"div",22),t.nVh(17,$0,9,5,"div",23)}if(2&a){const n=t.XpG();t.R7$(),t.vxM(n.ability.initiative<10?1:-1),t.R7$(),t.JRh(n.ability.initiative),t.R7$(2),t.JRh(n.abilityLabel),t.R7$(),t.Y8G("ngClass",t.eq3(22,ws,n.activeActions&&"bottom"==n.activeActions)),t.R7$(2),t.Y8G("actions",n.ability.actions)("monster",n.monster)("character",n.character)("statsCalculation",n.statsCalculation)("relative",n.relative)("interactiveAbilities",n.interactiveAbilities)("interactiveActions",n.interactiveActions)("cardId",n.ability.cardId),t.R7$(),t.vxM(n.interactiveActions.length||n.settingsManager.settings.interactiveAbilities&&n.settingsManager.settings.showExpandedAbilityCard?8:-1),t.R7$(),t.vxM(n.interactiveAbilities&&n.monster&&(!n.activeActions||n.activeActions&&"top"==n.activeActions)?9:-1),t.R7$(),t.vxM(n.ability.bottomActions&&n.ability.bottomActions.length>0||n.character?10:-1),t.R7$(),t.vxM(n.ability.shuffle?11:-1),t.R7$(),t.vxM(n.ability.bottomShuffle?12:-1),t.R7$(),t.vxM(!n.ability.cardId&&n.settingsManager.settings.abilityNumbers?13:-1),t.R7$(),t.vxM(n.ability.cardId&&n.settingsManager.settings.abilityNumbers?14:-1),t.R7$(),t.vxM(n.character?15:-1),t.R7$(),t.vxM(n.ability.lost||n.ability.persistent||n.ability.loss||n.ability.round||n.ability.xp?16:-1),t.R7$(),t.vxM(n.ability.bottomLost||n.ability.bottomPersistent||n.ability.bottomLoss||n.ability.bottomRound||n.ability.bottomXp?17:-1)}}let ee=(()=>{class a{elementRef;ghsManager;ability;abilities;monster;character;flipped=!1;reveal=!1;relative=!1;interactiveAbilities=!1;statsCalculation=!0;activeActions=!1;gameManager=s.E;settingsManager=p.f;ActionValueType=$.iQ;deckLabel="";abilityIndex=-1;abilityLabel="";fh=!1;interactiveActions=[];interactiveActionsChange=new t.bkB;interactiveBottomActions=[];interactiveBottomActionsChange=new t.bkB;fontsize="";constructor(n,i){this.elementRef=n,this.ghsManager=i}ngOnInit(){this.update(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}ngOnChanges(n){this.update()}update(){if(this.fontsize=.04*this.elementRef.nativeElement.offsetWidth+"px",this.monster){const n=this.monster.statEffect&&this.monster.statEffect.deck&&!this.monster.statEffect.deck.startsWith(this.monster.name)?this.monster.statEffect.deck:this.monster.deck?this.monster.deck:this.monster.name;this.deckLabel="data.deck."+n,n==p.f.getLabel(this.deckLabel)&&(this.deckLabel="data.monster."+n)}else if(this.character){const n=this.character.deck?this.character.deck:this.character.name;this.deckLabel="data.deck."+n,n==p.f.getLabel(this.deckLabel)&&(this.deckLabel="data.character."+this.character.edition+"."+n)}this.abilityIndex=-1,this.abilityLabel="",this.ability&&(this.abilityIndex=this.getAbilityIndex(this.ability),this.abilityLabel=this.getAbilityLabel(this.ability)),this.fh=this.character&&("fh"==this.character.edition||s.E.editionExtensions(this.character.edition).includes("fh"))||!1}getAbilityIndex(n){return this.abilities&&this.abilities.length>0?this.abilities.indexOf(n):this.monster?s.E.abilities(this.monster).indexOf(n):-1}getAbilityLabel(n){let i=n.name||"";return i=i?"data.ability."+i:this.deckLabel,te(p.f.getLabel(i))}onChange(n){this.ability&&(this.ability.revealed=n)}onInteractiveActionsChange(n){this.interactiveAbilities&&(this.interactiveActionsChange.emit(n),this.interactiveActions=n)}onInteractiveBottomActionsChange(n){this.interactiveAbilities&&(this.interactiveBottomActionsChange.emit(n),this.interactiveBottomActions=n)}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-ability"]],inputs:{ability:"ability",abilities:"abilities",monster:"monster",character:"character",flipped:"flipped",reveal:"reveal",relative:"relative",interactiveAbilities:"interactiveAbilities",statsCalculation:"statsCalculation",activeActions:"activeActions"},standalone:!1,features:[t.OA$],decls:12,vars:26,consts:[["card",""],[1,"card-container","ability",3,"ngClass"],["card-reveal","",1,"card",3,"change","ngClass","disabled"],[1,"card-back","ability-back",3,"ngClass"],[1,"touch"],[1,"revealed"],[1,"text",3,"ghs-label"],[1,"name",3,"ghs-label"],[1,"name"],[1,"logo"],[1,"card-front","ability-front",3,"ngClass"],[3,"ghs-label"],[3,"src"],[1,"initiative"],[1,"ability-actions-container",3,"ngClass"],[1,"ability-actions"],[3,"interactiveActionsChange","actions","monster","character","statsCalculation","relative","interactiveAbilities","interactiveActions","cardId"],[1,"bottom-spacer"],[3,"ngClass","figure","actions","interactiveActions"],[1,"shuffle"],[1,"bottom-shuffle"],[1,"index"],[1,"required-container"],[1,"required-container","bottom"],[3,"interactiveActionsChange","ngClass","figure","actions","interactiveActions"],[1,"level"],[1,"ability-actions","ability-bottom-actions"],[3,"interactiveActionsChange","actions","monster","character","statsCalculation","relative","interactiveAbilities","interactiveActions","index","cardId"],[1,"interactive-actions-bottom",3,"figure","actions","interactiveActions","preIndex"],[1,"interactive-actions-bottom",3,"interactiveActionsChange","figure","actions","interactiveActions","preIndex"],["src","./assets/images/shuffle.svg"],[1,"label"],[1,"box"],[1,"xp"],[1,"persistent"],[1,"loss"],[1,"round"],[1,"lost"],["src","./assets/images/action/card/experience.svg"],[1,"value"],["src","./assets/images/action/card/persistent.svg"],["src","./assets/images/action/card/overlay/persistent.svg",1,"overlay"],["src","./assets/images/action/card/loss.svg"],["src","./assets/images/action/card/overlay/loss.svg",1,"overlay"],["src","./assets/images/action/card/round.svg"],["src","./assets/images/action/card/overlay/round.svg",1,"overlay"],["src","./assets/images/action/card/lost.svg"],["src","./assets/images/action/card/overlay/lost.svg",1,"overlay"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",1)(1,"div",2,0),t.bIt("change",function(m){return c.eBV(o),c.Njj(e.onChange(m))}),t.j41(3,"div",3),t.nrm(4,"div",4),t.j41(5,"span",5),t.nrm(6,"span",6),t.k0s(),t.nVh(7,l0,1,1,"span",7),t.nVh(8,g0,2,1,"span",8),t.nVh(9,d0,2,1,"span",9),t.k0s(),t.j41(10,"div",10),t.nVh(11,I0,18,24),t.k0s()()()}2&i&&(t.xc7("--ghs-ability-color",e.character&&e.character.color),t.Y8G("ngClass",t.sMw(14,s0,e.settingsManager.settings.fhStyle,"bb"==e.settingsManager.settings.theme,e.flipped||e.ability&&e.ability.revealed)),t.R7$(),t.xc7("font-size",e.fontsize),t.Y8G("ngClass",t.eq3(18,r0,e.flipped||e.ability&&e.ability.revealed))("disabled",!e.reveal||!e.ability),t.R7$(2),t.Y8G("ngClass",t.l_i(20,Es,e.ability&&e.ability.bottomActions&&e.ability.bottomActions.length>0&&!e.character,e.character)),t.R7$(3),t.Y8G("ghs-label","game.cards.confirmReveal"),t.R7$(),t.vxM(e.monster?7:-1),t.R7$(),t.vxM(e.character?8:-1),t.R7$(),t.vxM(e.character?9:-1),t.R7$(),t.Y8G("ngClass",t.l_i(23,Es,e.ability&&e.ability.bottomActions&&e.ability.bottomActions.length>0&&!e.character,e.character)),t.R7$(),t.vxM(e.ability?11:-1))},dependencies:[N.YU,ve,Nn,it,xs],styles:['.ability[_ngcontent-%COMP%]{width:100%;height:100%;color:var(--ghs-color-white);--ghs-ability-color: var(--ghs-color-red)}.ability[_ngcontent-%COMP%]   .ability-back[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]{min-height:16em;display:flex;flex-direction:column;justify-content:center;text-align:center;border-radius:3.5%}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]{position:relative;z-index:1}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]:before{content:" ";position:absolute;width:100%;height:100%;background-image:url(monster-ability-front.6630d6e4791f6c50.png);background-position:0em -.9em;background-size:100% auto;background-repeat:no-repeat;z-index:0}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]:after{content:" ";position:absolute;width:100%;height:100%;background-image:url(monster-ability-front-repeat.90ec2bf17a27d884.png);background-position:0em -2.9em;background-size:100% auto;background-repeat:repeat-y;z-index:-1}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .ability-actions-container[_ngcontent-%COMP%]{position:relative;overflow:auto;z-index:2}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .ability-actions-container.disabled[_ngcontent-%COMP%]{opacity:.3}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .ability-actions-container.disabled[_ngcontent-%COMP%]:hover{opacity:.8}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .ability-actions-container[_ngcontent-%COMP%]   .ability-actions[_ngcontent-%COMP%]{position:relative;margin-top:2em;padding-bottom:.4em;width:100%;min-height:5.4em;font-size:1.7em;z-index:1;display:flex;align-items:center}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .ability-actions-container[_ngcontent-%COMP%]   .ability-actions[_ngcontent-%COMP%]   ghs-actions[_ngcontent-%COMP%]{font-size:calc(1em * var(--ghs-fontsize));position:relative;width:100%;height:100%}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .ability-actions-container[_ngcontent-%COMP%]   .bottom-spacer[_ngcontent-%COMP%]{display:block;position:relative;margin-top:2em}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{display:block;position:absolute;top:.2em;left:0;width:100%;font-family:var(--ghs-font-title);font-size:1.7em;filter:var(--ghs-filter-shadow);text-align:center}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]{position:absolute;font-family:var(--ghs-font-title);font-size:2.4em;filter:var(--ghs-filter-shadow);top:1em;left:.5em;text-align:center;width:1em}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .shuffle[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .bottom-shuffle[_ngcontent-%COMP%]{position:absolute;bottom:1em;right:.5em;z-index:0;filter:var(--ghs-filter-white) var(--ghs-filter-shadow);width:2em}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .shuffle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .bottom-shuffle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{position:absolute;font-size:1em;filter:var(--ghs-filter-shadow-thin);bottom:.5em;left:.5em}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]{background-position:top;background-attachment:local;height:100%;overflow-x:unset;overflow-y:auto}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions.bottom-actions[_ngcontent-%COMP%]:before, .ability[_ngcontent-%COMP%]   .ability-front.character-actions.bottom-actions[_ngcontent-%COMP%]:before{background-position:top;background-image:url(monster-ability-front-bottom.43963667f697d866.png)}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions.character-actions[_ngcontent-%COMP%]:before, .ability[_ngcontent-%COMP%]   .ability-front.character-actions.character-actions[_ngcontent-%COMP%]:before{background-position:top;background-color:var(--ghs-ability-color);background-image:url(character-ability-front.49c9deaf55e5e694.png),url(character-ability-front-blend.fe1021dc39bab753.png);background-blend-mode:screen,luminosity}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions.character-actions[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions.character-actions[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{position:absolute;bottom:1.2em;left:50%;width:1.8em;height:auto;transform:translate(-50%);z-index:1}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions.character-actions[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions.character-actions[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto;filter:drop-shadow(.5em .5em .5em var(--ghs-color-black))}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{top:.8em}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]{top:7em;left:5.2em;transform:translate(-50%)}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{position:absolute;top:3.1em;left:9.4em;width:2.1em;height:1.6em;font-size:1.2em;font-family:var(--ghs-font-title);display:flex;justify-content:center;align-items:center;background-color:var(--ghs-ability-color);mask-image:url(level.38e1f58a07dc5898.svg);-webkit-mask-image:url(level.38e1f58a07dc5898.svg);mask-size:115% 170%;-webkit-mask-size:115% 170%;mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:60% 66%;-webkit-mask-position:60% 66%}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{background:inherit;-webkit-background-clip:text;background-clip:text;color:transparent;filter:invert(1) grayscale(1) contrast(100)}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%]   .shuffle[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .shuffle[_ngcontent-%COMP%]{top:15.5em;right:3.5em;bottom:initial}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%]   .bottom-shuffle[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .bottom-shuffle[_ngcontent-%COMP%]{bottom:2.3em;right:4.8em}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{left:14.7em;bottom:2.2em}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%]   .ability-actions-container[_ngcontent-%COMP%]   .ability-actions[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .ability-actions-container[_ngcontent-%COMP%]   .ability-actions[_ngcontent-%COMP%]{left:1.6em;width:11.5em;min-height:6.4em;max-height:6.4em;margin-top:1.8em}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%]   .ability-actions-container[_ngcontent-%COMP%]   .ability-actions.ability-bottom-actions[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .ability-actions-container[_ngcontent-%COMP%]   .ability-actions.ability-bottom-actions[_ngcontent-%COMP%]{top:1.5em;margin-top:0;margin-bottom:2.2em;padding-top:.2em;padding-bottom:0}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%]   .ability-actions-container[_ngcontent-%COMP%]   .bottom-spacer[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .ability-actions-container[_ngcontent-%COMP%]   .bottom-spacer[_ngcontent-%COMP%]{display:none}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   ghs-interactive-actions[_ngcontent-%COMP%]{position:absolute;left:0;width:100%;bottom:0;z-index:999}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   ghs-interactive-actions.interactive-actions-top[_ngcontent-%COMP%]{position:absolute;bottom:16em}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   ghs-interactive-actions.interactive-actions-bottom[_ngcontent-%COMP%]{position:absolute;bottom:2.5em}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]{position:absolute;bottom:16.5em;right:3.3em;display:flex}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:none}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]{position:relative;display:flex;flex-grow:1;justify-content:flex-start;align-items:center;padding:.2em}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:relative;display:block;height:2em;margin:0 .1em}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]   span.loss[_ngcontent-%COMP%]{height:1.4em;margin:0 .2em}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:relative;top:0;left:0;height:100%;width:auto}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:nth-child(1){filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:nth-child(2){position:absolute}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;font-size:1.6em;font-family:var(--ghs-font-gh-title);text-align:center;color:var(--ghs-color-black);margin:0}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container.bottom[_ngcontent-%COMP%]{right:4.6em;bottom:3em}.ability[_ngcontent-%COMP%]   .ability-back[_ngcontent-%COMP%]{background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(monster-ability-back.1b996f6c655437aa.png);z-index:1}.ability[_ngcontent-%COMP%]   .ability-back[_ngcontent-%COMP%]   .touch[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1;overflow:auto}.ability[_ngcontent-%COMP%]   .ability-back[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;top:50%;left:0;width:100%;font-family:var(--ghs-font-title);font-size:1.4em;filter:drop-shadow(calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) var(--ghs-color-black));text-align:center;transform:translateY(2.9em)}.ability[_ngcontent-%COMP%]   .ability-back.bottom-actions[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-back.character-actions[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:50%;height:auto;transform:translate(-50%,-50%);z-index:1}.ability[_ngcontent-%COMP%]   .ability-back.bottom-actions[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-back.character-actions[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto;filter:drop-shadow(.5em .5em .5em var(--ghs-color-black))}.ability[_ngcontent-%COMP%]   .ability-back.bottom-actions.bottom-actions[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-back.character-actions.bottom-actions[_ngcontent-%COMP%]{background-image:url(monster-ability-back-botton.5146fd83ee4567f9.png)}.ability[_ngcontent-%COMP%]   .ability-back.bottom-actions.bottom-actions[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-back.character-actions.bottom-actions[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{top:57.5%}.ability[_ngcontent-%COMP%]   .ability-back.bottom-actions.character-actions[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-back.character-actions.character-actions[_ngcontent-%COMP%]{background-color:var(--ghs-ability-color);background-image:url(character-ability-back.e184c6b79281a977.png),url(character-ability-back-blend.f5f2fb421bd7a6d9.png);background-blend-mode:screen,luminosity}.ability[_ngcontent-%COMP%]   .ability-back.bottom-actions.character-actions[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-back.character-actions.character-actions[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{top:.5em;bottom:initial;font-size:2em;transform:none}.ability[_ngcontent-%COMP%]   .confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center;color:var(--ghs-color-white);font-size:2.3em;filter:drop-shadow(calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) var(--ghs-color-black));z-index:2}.ability[_ngcontent-%COMP%]   .confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{text-align:center}.ability.fh[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]:before{background-image:url(monster-ability-front.bae377edfe8630cc.png);background-position:0em -.6em}.ability.fh[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]:after{background-image:url(monster-ability-front-repeat.21d351b34ecd76d1.png)}.ability.fh[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%]:before{background-image:url(monster-ability-front-bottom.43963667f697d866.png)}.ability.fh[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{bottom:.5em;left:.5em}.ability.fh[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]{font-size:2.6em;top:.8em}.ability.fh[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]:before{background-color:var(--ghs-ability-color);background-image:url(character-ability-front.df38cb6102117d07.png),url(character-ability-front-blend.727e78f926c84cf4.png);background-blend-mode:luminosity,luminosity}.ability.fh[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{color:var(--ghs-color-black);top:1.25em;font-size:1.6em;filter:none}.ability.fh[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{top:1.1em;left:.8em;font-size:1.6em;font-family:var(--ghs-font-gh-title);color:var(--ghs-color-black);-webkit-mask:none;mask:none;background-color:transparent}.ability.fh[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{background:none;color:var(--ghs-color-black);filter:none}.ability.fh[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);font-size:2.6em;top:6.35em;left:4.8em}.ability.fh[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{top:2.4em;right:1.4em;bottom:initial;left:initial;filter:brightness(0);width:1.5em}.ability.fh[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{bottom:1.6em;left:2.8em}.ability.fh[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]{bottom:15.7em;right:2.6em;overflow:hidden}.ability.fh[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]:before{content:" ";display:block;position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--ghs-color-black);opacity:.5;z-index:0;border:.1em solid var(--ghs-color-white);border-top-left-radius:.5em}.ability.fh[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:block;position:relative;top:.1em;display:flex;flex-grow:1;justify-content:center;align-items:center;padding:.3em;border-right:.1em solid var(--ghs-color-white);font-size:1.5em}.ability.fh[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container.bottom[_ngcontent-%COMP%]{bottom:2em;right:2.3em}.ability.fh[_ngcontent-%COMP%]   .ability-back[_ngcontent-%COMP%]{background-image:url(monster-ability-back.7df0db1b0ed7e94a.png)}.ability.fh[_ngcontent-%COMP%]   .ability-back.bottom-actions[_ngcontent-%COMP%]{background-image:url(monster-ability-back-botton.5146fd83ee4567f9.png)}.ability.fh[_ngcontent-%COMP%]   .ability-back.character-actions[_ngcontent-%COMP%]{background-color:var(--ghs-ability-color);background-image:url(character-ability-back.898512c963e50735.png),url(character-ability-back-blend.0a471a56ae7d8140.png);background-blend-mode:luminosity,luminosity}.ability.fh[_ngcontent-%COMP%]   .ability-back.character-actions[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{color:var(--ghs-color-black);top:.4em;font-size:2.6em;filter:none}.ability.bb[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]:before{background-image:url(monster-ability-front.fcbe1060c337aabd.png);background-position:0em -.6em}.ability.bb[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]:after{background-image:url(monster-ability-front-repeat.50495f927bbccdc9.png)}.ability.bb[_ngcontent-%COMP%]   .ability-back[_ngcontent-%COMP%]{background-image:url(monster-ability-back.3ae9372eae8029aa.png)}']})}return a})();const A0=(a,r)=>({closed:a,opened:r}),Rs=(a,r)=>({"bottom-actions":a,"second-ability":r});function V0(a,r){if(1&a&&(t.j41(0,"div",1),t.nrm(1,"ghs-ability",3),t.k0s()),2&a){const n=t.XpG();t.Y8G("ngClass",t.l_i(8,Rs,n.ability&&n.ability.bottomActions&&n.ability.bottomActions.length>0||!1,!!n.secondAbility)),t.R7$(),t.Y8G("ability",n.ability)("monster",n.monster)("character",n.character)("flipped",n.opened)("relative",n.relative)("interactiveAbilities",n.interactiveAbilities)("activeActions",!(!n.monster||!n.monster.firstActiveAction)&&("bottom"==n.monster.firstActiveAction?"bottom":"top"))}}function F0(a,r){if(1&a&&(t.j41(0,"div",1),t.nrm(1,"ghs-ability",3),t.k0s()),2&a){const n=t.XpG();t.Y8G("ngClass",t.l_i(8,Rs,n.secondAbility&&n.secondAbility.bottomActions&&n.secondAbility.bottomActions.length>0||!1,!!n.secondAbility)),t.R7$(),t.Y8G("ability",n.secondAbility)("monster",n.monster)("character",n.character)("flipped",n.opened)("relative",n.relative)("interactiveAbilities",n.interactiveAbilities)("activeActions",!(!n.monster||!n.monster.firstActiveAction)&&("bottom"==n.monster.firstActiveAction?"top":"bottom"))}}let Di=(()=>{class a{dialogRef;ability;secondAbility;monster;character;relative;interactiveAbilities;opened=!1;gameManager=s.E;constructor(n,i){this.dialogRef=i,this.ability=n.ability,this.monster=n.monster||void 0,this.character=n.character||void 0,this.relative=n.relative,this.interactiveAbilities=n.interactive,this.monster&&!this.ability&&(this.ability=s.E.monsterManager.getAbility(this.monster),s.E.monsterManager.hasBottomActions(this.monster)&&(this.secondAbility=this.ability,this.ability=s.E.monsterManager.getAbility(this.monster,!0))),this.ability||this.dialogRef.close()}ngOnInit(){this.opened=!0}close(){this.opened=!1,setTimeout(()=>{this.dialogRef.close()},p.f.settings.animations?1e3*p.f.settings.animationSpeed:0)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-ability-dialog"]],standalone:!1,decls:4,vars:6,consts:[["ghs-pointer-input","",1,"ability-dialog",3,"singleClick","ngClass"],[1,"ability-container",3,"ngClass"],[1,"close-container",3,"click"],[3,"ability","monster","character","flipped","relative","interactiveAbilities","activeActions"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.bIt("singleClick",function(){return e.close()}),t.nVh(1,V0,2,11,"div",1),t.nVh(2,F0,2,11,"div",1),t.k0s(),t.j41(3,"div",2),t.bIt("click",function(){return e.close()}),t.k0s()),2&i&&(t.Y8G("ngClass",t.l_i(3,A0,!e.opened,e.opened)),t.R7$(),t.vxM(e.ability?1:-1),t.R7$(),t.vxM(e.secondAbility?2:-1))},dependencies:[N.YU,ee,dt],styles:["[_nghost-%COMP%]{background-color:transparent;padding:0;margin:0;border:0}.ability-dialog[_ngcontent-%COMP%]{position:relative;width:100vw;height:100vh;border-image:none;background:none;transition:transform calc(var(--ghs-animation-speed) * .15s) ease-in-out;transform:scale(0);z-index:2;overflow:auto;display:flex;justify-content:center;align-items:center;-ms-overflow-style:none;scrollbar-width:none}.ability-dialog[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.ability-dialog.opened[_ngcontent-%COMP%]{transform:scale(1)}.ability-dialog.closed[_ngcontent-%COMP%]{transform:scale(0);transition-delay:.8s}.ability-dialog[_ngcontent-%COMP%]   .ability-container[_ngcontent-%COMP%]{overflow:visible;width:100vw;max-width:600px;max-height:100vh}.ability-dialog[_ngcontent-%COMP%]   .ability-container[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{display:block;margin:1vh 0}.ability-dialog[_ngcontent-%COMP%]   .ability-container.bottom-actions[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{height:135vw;max-height:810px}@media (max-height: 600px),(orientation: portrait){.ability-dialog[_ngcontent-%COMP%]   .ability-container.bottom-actions.second-ability[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{height:67.5vw;max-height:405px}}.close-container[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1}"]})}return a})();var $t=v(4074);class js{name="";cardId="";edition="";health=0;attack=0;movement=0;range=0;flying=!1;action;additionalAction;level;special=!1;count=1;enhancements=[];thumbnail=!1;thumbnailUrl;noThumbnail=!1}const X0=(a,r)=>({small:a,edit:r}),B0=a=>({enhanced:a}),Y0=(a,r)=>r._trackUUID;function U0(a,r){if(1&a&&t.nrm(0,"img",3),2&a){const n=t.XpG().$implicit;t.Y8G("src","./assets/images/action/hex/"+n.type+".svg",t.B4B)}}function N0(a,r){if(1&a&&t.nrm(0,"ghs-action-enhancements",4),2&a){const n=t.XpG().$implicit,i=t.XpG();t.Y8G("action",i.action)("index",i.actionIndex)("character",i.character)("cardId",i.cardId)("slot",i.enhanceHexes.indexOf(n))}}function z0(a,r){if(1&a&&(t.j41(0,"span",5),t.nrm(1,"img",6),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.Y8G("src","./assets/images/condition/"+n.value+".svg",t.B4B)}}function L0(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",2),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.click(e))}),t.nVh(1,U0,1,1,"img",3),t.nVh(2,N0,1,5,"ghs-action-enhancements",4),t.nVh(3,z0,2,1,"span",5),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.xc7("grid-column-start",2*n.x+1+n.y%2)("grid-column-end",2*n.x+3+n.y%2)("grid-row-start",n.y+1)("grid-row-end",n.y+1),t.Y8G("ngClass",t.eq3(12,B0,i.enhancedHexes.includes(n))),t.R7$(),t.vxM("enhance"!=n.type||i.editMode?1:-1),t.R7$(),t.vxM(i.editMode||"enhance"!=n.type?-1:2),t.R7$(),t.vxM(i.hasCondition(n)?3:-1)}}let Ga=(()=>{class a{action;value;size;actionIndex="";cardId;character;clickCallback=new t.bkB;doubleclickCallback=new t.bkB;hexes=[];enhanceHexes=[];enhancedHexes=[];edit=!1;editMode=!1;ActionHex=K.wd;ActionHexToString=K.mC;doubleClick=null;ngOnChanges(n){this.hexes=[],this.enhanceHexes=[],this.enhancedHexes=[],this.value||(this.value=""+this.action.value),this.value.split("|").forEach(i=>{const e=(0,K.dy)(i);null!=e&&(this.hexes.push(e),e.type==K.Gq.enhance&&(this.enhanceHexes.push(e),this.character&&this.cardId&&this.actionIndex&&this.character.progress.enhancements&&this.character.progress.enhancements.find(o=>o.cardId==this.cardId&&o.actionIndex==this.actionIndex&&o.index==this.enhanceHexes.length-1&&"hex"==o.action)&&this.enhancedHexes.push(e)),e.type==K.Gq.invisible&&(this.editMode=!0))}),this.edit=this.character&&this.character.tags.includes("edit-abilities")||!1}click(n){this.doubleClick?(clearTimeout(this.doubleClick),this.doubleClick=null,this.doubleclickCallback.emit(n)):this.doubleClick=setTimeout(()=>{this.doubleClick&&(this.clickCallback.emit(n),this.doubleClick=null)},200)}hasCondition(n){return n.value&&Object.keys(Q.r5).includes(n.value)||!1}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-action-hex"]],inputs:{action:"action",value:"value",size:"size",actionIndex:[0,"index","actionIndex"],cardId:"cardId",character:"character"},outputs:{clickCallback:"clickCallback",doubleclickCallback:"doubleclickCallback"},standalone:!1,features:[t.OA$],decls:4,vars:8,consts:[[1,"hex-grid",3,"ngClass"],[1,"hex",3,"grid-column-start","grid-column-end","grid-row-start","grid-row-end","ngClass"],[1,"hex",3,"click","ngClass"],[1,"icon",3,"src"],[1,"enhance",3,"action","index","character","cardId","slot"],[1,"condition"],[3,"src"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.Z7z(1,L0,4,14,"div",1,Y0),t.nI1(3,"trackUUID"),t.k0s()),2&i&&(t.xc7("--ghs-hex-size",e.size),t.Y8G("ngClass",t.l_i(5,X0,e.action.small,e.edit)),t.R7$(),t.Dyx(t.bMT(3,3,e.hexes)))},styles:[".hex-grid[_ngcontent-%COMP%]{--ghs-hex-size: 1;display:grid;justify-items:center;align-items:center;grid-template-columns:calc(.6em * var(--ghs-hex-size));filter:var(--ghs-filter-shadow)}.hex-grid.small[_ngcontent-%COMP%]{filter:var(--ghs-filter-shadow-thin)}.hex-grid[_ngcontent-%COMP%]   .hex[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:calc(.6em * var(--ghs-hex-size) * 2);height:calc(.6em * var(--ghs-hex-size) * 1.7);z-index:1}.hex-grid[_ngcontent-%COMP%]   .hex[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:100%;height:auto}.hex-grid[_ngcontent-%COMP%]   .hex[_ngcontent-%COMP%]   ghs-action-enhancements[_ngcontent-%COMP%]{font-size:calc(.6em * var(--ghs-hex-size) * 2);position:absolute;top:calc(.6em * var(--ghs-hex-size) * .3);left:calc(.6em * var(--ghs-hex-size) * -.1)}.hex-grid[_ngcontent-%COMP%]   .hex.enhanced[_ngcontent-%COMP%]{filter:brightness(1.3);z-index:2}.hex-grid[_ngcontent-%COMP%]   .hex.enhanced[_ngcontent-%COMP%]   ghs-action-enhancements[_ngcontent-%COMP%]{left:calc(.6em * var(--ghs-hex-size) * -.5)}.hex-grid[_ngcontent-%COMP%]   .hex[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{position:absolute;top:calc(.6em * var(--ghs-hex-size) * -.2);left:calc(.6em * var(--ghs-hex-size) * -.1);width:calc(.6em * var(--ghs-hex-size) * 1.3)}.hex-grid[_ngcontent-%COMP%]   .hex[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}"]})}return a})();var Ta=v(3414);const q0=(a,r,n,i)=>({action:a,additional:r,item:n,fh:i}),Gs=a=>({xs:a}),Ts=a=>({"text-white":a}),H0=(a,r,n)=>[a,r,n];function K0(a,r){if(1&a&&t.nrm(0,"img",16),2&a){const n=t.XpG(3);t.Y8G("src",n.summonData.thumbnailUrl||"./assets/images/summons/thumbnail//"+n.summonData.edition+"-"+n.summonData.name+".png",t.B4B)}}function W0(a,r){if(1&a&&(t.j41(0,"span",17),t.nrm(1,"img",16),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("src",n.summonData.thumbnailUrl||"./assets/images/summons/thumbnail//"+n.summonData.edition+"-"+n.summonData.name+".png",t.B4B)}}function Z0(a,r){if(1&a&&(t.j41(0,"span",1),t.nVh(1,K0,1,1,"img",16),t.nVh(2,W0,2,1,"span",17),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.vxM(n.fhStyle?-1:1),t.R7$(),t.vxM(n.fhStyle?2:-1)}}function J0(a,r){if(1&a&&(t.j41(0,"span",18),t.nrm(1,"span",22),t.EFF(2,"\xa0"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Aen(n.style),t.Y8G("ghs-label","game.action.summon")}}function Q0(a,r){if(1&a&&(t.j41(0,"span",19),t.EFF(1),t.k0s()),2&a){const n=t.XpG(3);t.Y8G("ngClass",t.eq3(2,Ts,!n.right)),t.R7$(),t.JRh(n.summon.title)}}function tk(a,r){if(1&a&&t.nrm(0,"span",23),2&a){const n=t.XpG(3);t.Aen(n.style),t.Y8G("ghs-label","data.summon."+n.summon.name)("ngClass",t.eq3(4,Ts,!n.right))}}function nk(a,r){if(1&a&&(t.j41(0,"span",21),t.nrm(1,"img",16),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("src","./assets/images"+(n.fhStyle?"/fh":"")+"/action/fly.svg",t.B4B)}}function ek(a,r){if(1&a&&(t.nVh(0,J0,3,3,"span",18),t.nVh(1,Q0,2,4,"span",19),t.nVh(2,tk,1,6,"span",20),t.nVh(3,nk,2,1,"span",21)),2&a){const n=t.XpG(2);t.vxM(n.action?0:-1),t.R7$(),t.vxM(n.summon.title?1:-1),t.R7$(),t.vxM(n.summon.title?-1:2),t.R7$(),t.vxM(n.summon.flying?3:-1)}}function ak(a,r){if(1&a&&t.nrm(0,"span",3),2&a){const n=t.XpG(2);t.Y8G("ghs-label","character.summon.action"+(n.summonData.count&&n.summonData.count>1?".count":"")+(n.summonData.flying?".fly":""))("ghs-label-args",t.sMw(2,H0,n.summonData.name,n.summonData.count,n.summonData.flying))}}function ik(a,r){if(1&a&&t.nrm(0,"ghs-action-enhancements",8),2&a){const n=t.XpG(2);t.Y8G("action",n.enhancementActions[0])("index",n.actionIndex)("character",n.character)("cardId",n.cardId)("slot",0)("summon",n.summonData)}}function ok(a,r){if(1&a&&t.nrm(0,"ghs-action-enhancements",8),2&a){const n=t.XpG(2);t.Y8G("action",n.enhancementActions[2])("index",n.actionIndex)("character",n.character)("cardId",n.cardId)("slot",2)("summon",n.summonData)}}function sk(a,r){if(1&a&&t.nrm(0,"ghs-action",11),2&a){const n=t.XpG(2);t.Y8G("action",n.summon.action)}}function rk(a,r){if(1&a&&t.nrm(0,"span",22),2&a){const n=t.XpG(2);t.Aen(n.style),t.Y8G("ghs-label",""+n.summon.attack)}}function ck(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function lk(a,r){if(1&a&&t.nrm(0,"ghs-action-enhancements",8),2&a){const n=t.XpG(2);t.Y8G("action",n.enhancementActions[1])("index",n.actionIndex)("character",n.character)("cardId",n.cardId)("slot",1)("summon",n.summonData)}}function gk(a,r){if(1&a&&t.nrm(0,"ghs-action-enhancements",8),2&a){const n=t.XpG(2);t.Y8G("action",n.enhancementActions[3])("index",n.actionIndex)("character",n.character)("cardId",n.cardId)("slot",3)("summon",n.summonData)}}function dk(a,r){if(1&a&&(t.j41(0,"span",15),t.nrm(1,"ghs-action",11),t.k0s()),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Gs,n.summon.additionalAction&&"custom"==n.summon.additionalAction.type)),t.R7$(),t.Y8G("action",n.summon.additionalAction)}}function hk(a,r){if(1&a&&(t.j41(0,"div",0),t.nVh(1,Z0,3,2,"span",1),t.j41(2,"span",2),t.nVh(3,ek,4,4),t.nVh(4,ak,1,6,"span",3),t.k0s(),t.j41(5,"div",4)(6,"span",5),t.nrm(7,"img",6),t.j41(8,"span"),t.EFF(9,":"),t.k0s(),t.nrm(10,"span",7),t.nVh(11,ik,1,6,"ghs-action-enhancements",8),t.k0s(),t.j41(12,"span",9),t.nrm(13,"img",6),t.j41(14,"span"),t.EFF(15,":"),t.k0s(),t.nrm(16,"span",7),t.nVh(17,ok,1,6,"ghs-action-enhancements",8),t.k0s(),t.j41(18,"span",10),t.nVh(19,sk,1,1,"ghs-action",11),t.k0s(),t.j41(20,"span",12),t.nrm(21,"img",6),t.j41(22,"span"),t.EFF(23,":"),t.k0s(),t.nVh(24,rk,1,3,"span",13),t.nVh(25,ck,2,0,"span"),t.nVh(26,lk,1,6,"ghs-action-enhancements",8),t.k0s(),t.j41(27,"span",14),t.nrm(28,"img",6),t.j41(29,"span"),t.EFF(30,":"),t.k0s(),t.nrm(31,"span",7),t.nVh(32,gk,1,6,"ghs-action-enhancements",8),t.k0s(),t.nVh(33,dk,2,4,"span",15),t.k0s()()),2&a){const n=t.XpG();t.Y8G("ngClass",t.ziG(23,q0,n.summon.action,n.summon.additionalAction||n.additional,n.item,n.fhStyle)),t.R7$(),t.vxM(n.summonData&&n.summonData.thumbnail?1:-1),t.R7$(2),t.vxM(n.summonData?-1:3),t.R7$(),t.vxM(n.summonData?4:-1),t.R7$(3),t.Y8G("src","./assets/images/"+(n.fhStyle?"fh/":"")+"action/heal.svg",t.B4B),t.R7$(3),t.Y8G("value-calc",n.summon.maxHealth)("empty",!0),t.R7$(),t.vxM(n.summonData&&n.summonData.enhancements&&n.summonData.enhancements.includes("heal")?11:-1),t.R7$(2),t.Y8G("src","./assets/images/"+(n.fhStyle?"fh/":"")+"action/move.svg",t.B4B),t.R7$(3),t.Y8G("value-calc",n.summon.movement)("empty",!0),t.R7$(),t.vxM(n.summonData&&n.summonData.enhancements&&n.summonData.enhancements.includes("move")?17:-1),t.R7$(),t.Y8G("ngClass",t.eq3(28,Gs,n.summon.action&&"custom"==n.summon.action.type)),t.R7$(),t.vxM(n.summon.action?19:-1),t.R7$(2),t.Y8G("src","./assets/images/"+(n.fhStyle?"fh/":"")+"action/attack.svg",t.B4B),t.R7$(3),t.vxM(""!=n.summon.attack?24:-1),t.R7$(),t.vxM(""==n.summon.attack?25:-1),t.R7$(),t.vxM(n.summonData&&n.summonData.enhancements&&n.summonData.enhancements.includes("attack")?26:-1),t.R7$(2),t.Y8G("src","./assets/images/"+(n.fhStyle?"fh/":"")+"action/range.svg",t.B4B),t.R7$(3),t.Y8G("value-calc",n.summon.range)("empty",!0),t.R7$(),t.vxM(n.summonData&&n.summonData.enhancements&&n.summonData.enhancements.includes("range")?32:-1),t.R7$(),t.vxM(n.summon.additionalAction?33:-1)}}let $i=(()=>{class a{ghsManager;summon;summonData;action=!1;additional=!1;item=!1;right=!1;style=!1;actionIndex="";cardId;character;fhStyle=!1;settingsManager=p.f;enhancementActions=[];hasSummon=!1;constructor(n){this.ghsManager=n}ngOnInit(){this.update(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.hasSummon=null!=this.summon,this.fhStyle=p.f.settings.fhStyle&&!this.style||"fh"==this.style,this.enhancementActions=[],this.summonData&&(this.enhancementActions.push(new $.rc($.X2.heal,this.summonData.health)),this.enhancementActions.push(new $.rc($.X2.attack,this.summonData.attack)),this.enhancementActions.push(new $.rc($.X2.move,this.summonData.movement)),this.enhancementActions.push(new $.rc($.X2.range,this.summonData.range)),this.enhancementActions.forEach(n=>{n.enhancementTypes=[$t.J.square,$t.J.square,$t.J.square,$t.J.square]}))}static \u0275fac=function(i){return new(i||a)(t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-summon-sheet"]],inputs:{summon:"summon",summonData:"summonData",action:"action",additional:"additional",item:"item",right:"right",style:"style",actionIndex:[0,"index","actionIndex"],cardId:"cardId",character:"character"},standalone:!1,decls:1,vars:1,consts:[[1,"summon-container",3,"ngClass"],[1,"thumbnail"],[1,"name"],[1,"summon-label","text-white",3,"ghs-label","ghs-label-args"],[1,"grid"],[1,"item","health"],[1,"ghs-svg",3,"src"],[3,"value-calc","empty"],[1,"enhance",3,"action","index","character","cardId","slot","summon"],[1,"item","move"],[1,"action",3,"ngClass"],[3,"action"],[1,"item","attack"],[3,"ghs-label","style"],[1,"item","range"],[1,"additionalAction",3,"ngClass"],[3,"src"],[1,"thumbnail-border"],[1,"summon-label"],[3,"ngClass"],[3,"ghs-label","style","ngClass"],[1,"flying"],[3,"ghs-label"],[3,"ghs-label","ngClass"]],template:function(i,e){1&i&&t.nVh(0,hk,34,30,"div",0),2&i&&t.vxM(e.hasSummon?0:-1)},styles:[".summon-container[_ngcontent-%COMP%]{position:relative;width:100%;padding-top:38%;background-image:url(character-ability-summon1.6652de7b772cb310.png);background-size:contain;background-repeat:no-repeat;text-shadow:none}.summon-container[_ngcontent-%COMP%]   .summon-label[_ngcontent-%COMP%]{font-family:var(--ghs-font-text)}.summon-container[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{position:absolute;width:15%;height:53%;top:11%;left:0;overflow:hidden}.summon-container[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;width:127%;height:auto;top:2%;right:7%;border-radius:100%}.summon-container[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:1.1em;letter-spacing:-.04em;position:absolute;top:6%;left:14%;width:86%;height:34%;display:flex;justify-content:center;align-items:center}.summon-container[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .summon-label[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal)}.summon-container[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .flying[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:auto;margin-left:calc(var(--ghs-unit) * .5)}.summon-container[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .flying[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:45% 25% 30%;grid-template-rows:50% 50%;position:absolute;top:34%;left:0;width:100%;height:60%}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr .5fr 1.5fr 1.5fr;justify-content:flex-start;align-items:center}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(1){justify-self:end}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(2){justify-self:center}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(3){justify-self:start}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(4){justify-self:start}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .placeholder[_ngcontent-%COMP%]{display:flex}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ghs-action-enhancements[_ngcontent-%COMP%]{margin-left:-25%}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%], .summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .attack[_ngcontent-%COMP%]{padding-left:3em}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%], .summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .additionalAction[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:.85em}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .action.xs[_ngcontent-%COMP%], .summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .additionalAction.xs[_ngcontent-%COMP%]{font-size:.75em}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{grid-row:2 span}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:.9em;width:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.summon-container.additional[_ngcontent-%COMP%]{background-image:url(character-ability-summon2.01e34f17184b79db.png)}.summon-container.additional[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{grid-row:1 span}.summon-container.item[_ngcontent-%COMP%]{background-image:url(summon-item.1142452805cc7730.png)}.summon-container.item[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:1em}.summon-container.item[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{grid-template-columns:65% 25% 0%}.summon-container.item[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{grid-row:1 span}.summon-container.fh[_ngcontent-%COMP%]{background-image:url(character-ability-summon1.087db978155a9f1c.png)}.summon-container.fh[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{top:1.8em;width:4.3em;height:4em;clip-path:polygon(0em 0em,3.3em 0em,4.3em 2em,3.3em 4em,0em 4em);background-color:var(--ghs-ability-color)}.summon-container.fh[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]   .thumbnail-border[_ngcontent-%COMP%]{position:absolute;top:.1em;left:.1em;width:4.3em;height:4em;clip-path:polygon(0em 0em,3.1em 0em,4em 1.9em,3.1em 3.8em,0em 3.8em)}.summon-container.fh[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]   .thumbnail-border[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{left:-1.9em;top:-.3em;width:155%}.summon-container.fh[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{top:38%;grid-template-columns:60% 40% 0%}.summon-container.fh[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%], .summon-container.fh[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .attack[_ngcontent-%COMP%]{padding-left:5em}.summon-container.fh.action[_ngcontent-%COMP%]{background-image:url(character-ability-summon2.52aae50ce5366dbc.png)}.summon-container.fh.action[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{grid-template-columns:55% 20% 25%}.summon-container.fh.additional[_ngcontent-%COMP%]{background-image:url(character-ability-summon3.137fcec726831188.png)}.summon-container.fh.additional[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{grid-template-columns:45% 20% 35%}.summon-container.fh.additional[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%], .summon-container.fh.additional[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .attack[_ngcontent-%COMP%]{padding-left:4.5em}"]})}return a})();const _k=(a,r)=>({"text-white":a,small:r}),Ss=(a,r)=>({"action-interactive":a,"action-interactive-highlight":r}),mk=(a,r,n,i)=>[a,r,n,i],Ds=(a,r,n)=>[a,r,n],$s=(a,r)=>r._trackUUID;function pk(a,r){if(1&a&&t.nrm(0,"span",7),2&a){const n=t.XpG(2).$implicit,i=t.XpG(2);t.Aen(i.style),t.Y8G("ghs-label",n.marker?"game.summon.spawnTypeMarker":"game.summon.spawnType")("ghs-label-args",t.ziG(4,mk,n.monster.name,n.monster.type,n.count?n.count:"",n.marker))}}function uk(a,r){if(1&a&&t.nrm(0,"span",7),2&a){const n=t.XpG(2).$implicit,i=t.XpG(2);t.Aen(i.style),t.Y8G("ghs-label",n.marker?"game.summon.spawnMarker":"game.summon.spawn")("ghs-label-args",t.sMw(4,Ds,n.monster.name,n.count?n.count:"",n.marker))}}function fk(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1," ("),t.nrm(2,"span",8),t.EFF(3,"\xa0"),t.nrm(4,"span",3),t.EFF(5,")\xa0 "),t.k0s()),2&a){const n=t.XpG(2).$implicit,i=t.XpG(2);t.R7$(2),t.Y8G("value-calc",n.monster.health),t.R7$(2),t.Aen(i.style),t.Y8G("ghs-label","game.hp")}}function Ck(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1,"\xa0"),t.nrm(2,"span",3),t.EFF(3,"\xa0"),t.k0s()),2&a){const n=t.XpG(4);t.R7$(2),t.Aen(n.style),t.Y8G("ghs-label","and")}}function Mk(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",5),t.bIt("singleClick",function(e){c.eBV(n);const o=t.XpG(3);return c.Njj(o.toggleHighlight(e))}),t.nVh(1,pk,1,9,"span",6),t.nVh(2,uk,1,8,"span",6),t.nVh(3,fk,6,4,"span"),t.nVh(4,Ck,4,3,"span"),t.k0s()}if(2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG(2);t.Y8G("clickBehind",!o.isInteractiveApplicableAction())("ghs-tooltip","monster.toggleAction")("delay",1)("disabled",!o.isInteractiveApplicableAction())("ngClass",t.l_i(9,Ss,o.isInteractiveApplicableAction(),o.highlightAction())),t.R7$(),t.vxM(i.monster.type!=o.MonsterType.boss?1:-1),t.R7$(),t.vxM(i.monster.type==o.MonsterType.boss?2:-1),t.R7$(),t.vxM(i.monster.health?3:-1),t.R7$(),t.vxM(e<o.monsters.length-1&&o.monsters.length>1?4:-1)}}function vk(a,r){1&a&&t.nVh(0,Mk,5,12,"span",4),2&a&&t.vxM(r.$implicit.monster.type?0:-1)}function Ok(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1,"\xa0"),t.nrm(2,"span",3),t.EFF(3,"\xa0"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.Aen(n.style),t.Y8G("ghs-label","and")}}function Pk(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",5),t.bIt("singleClick",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.toggleHighlight(e))}),t.nrm(1,"span",7),t.nVh(2,Ok,4,3,"span"),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.Y8G("clickBehind",!e.isInteractiveApplicableAction())("ghs-tooltip","monster.toggleAction")("delay",1)("disabled",!e.isInteractiveApplicableAction())("ngClass",t.l_i(10,Ss,e.isInteractiveApplicableAction(),e.highlightAction())),t.R7$(),t.Aen(e.style),t.Y8G("ghs-label",n.marker?"game.summon.spawnObjectiveMarker":"game.summon.spawnObjective")("ghs-label-args",t.sMw(13,Ds,n.objective.name,n.count?n.count:"",n.marker)),t.R7$(),t.vxM(i<e.objectives.length-1&&e.objectives.length>1?2:-1)}}function bk(a,r){if(1&a&&(t.j41(0,"span",0)(1,"span",2),t.nrm(2,"span",3),t.EFF(3,"\xa0"),t.k0s(),t.Z7z(4,vk,1,1,null,null,$s),t.nI1(6,"trackUUID"),t.Z7z(7,Pk,3,17,"span",4,$s),t.nI1(9,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.Y8G("ngClass",t.l_i(8,_k,!n.right,n.action.small)),t.R7$(2),t.Aen(n.style),t.Y8G("ghs-label",n.isSpawn?"game.action.spawn":"game.action.summon"),t.R7$(2),t.Dyx(t.bMT(6,4,n.monsters)),t.R7$(3),t.Dyx(t.bMT(9,6,n.objectives))}}function kk(a,r){if(1&a&&t.nrm(0,"ghs-summon-sheet",9),2&a){const n=t.XpG();t.Aen(n.style),t.Y8G("summon",n.getSummon())("summonData",n.summonData)("action",!0)("additional",n.additional)("right",n.right)("item","summonDataItem"==n.action.value)("character",n.character)("cardId",n.cardId)("index",n.actionIndex)}}let Is=(()=>{class a{ghsManager;monster;monsterType;objective;action;textBlack=!1;right=!1;isSpawn=!1;additional=!1;interactiveAbilities=!1;interactiveActions=[];interactiveActionsChange=new t.bkB;actionIndex="";style=!1;character;cardId;spawners=[];monsters=[];objectives=[];type;summonData;count;tags=[];settingsManager=p.f;MonsterType=S.N;constructor(n){this.ghsManager=n,this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}ngOnChanges(n){this.update()}update(){this.summonData=void 0,this.spawners=[],this.monster?this.spawners=s.E.entityManager.entities(this.monster,!0).map(n=>n).filter(n=>!this.monsterType||n.type==this.monsterType):this.objective instanceof ft.$e&&(this.spawners=s.E.entityManager.entities(this.objective,!0).map(n=>n)),this.monsters=s.E.actionsManager.getMonsterSpawnData(this.action).map(n=>{const i=new Ta._K(n);if(p.f.settings.calculate&&!p.f.settings.combineInteractiveAbilities&&this.isInteractiveApplicableAction()&&"string"==typeof i.count&&this.spawners.length){const e=this.spawners.find(o=>s.E.actionsManager.isInteractiveApplicableAction(o,this.action,this.actionIndex));e&&(i.count=(0,A.hZ)(i.count.replaceAll("HP",""+e.health).replaceAll("H",""+(0,A.hZ)(e.maxHealth)),e.level))}return i}),this.objectives=s.E.actionsManager.getObjectiveSpawnData(this.action),this.count=void 0,this.type=void 0,this.action&&("summonData"==this.action.value||"summonDataItem"==this.action.value)&&(this.summonData=this.action.valueObject,this.summonData.edition||(this.character&&this.cardId?this.summonData.edition=this.character.edition:this.monster&&(this.summonData.edition=this.monster.edition)),this.action.small=!0)}getSummonLabel(n){const i="string"==typeof n.monster.health&&n.monster.health.includes("H")?n.monster.health:n.monster.health?(0,A.hZ)(n.monster.health):"";return n.monster.player2==n.monster.player3&&n.monster.player3==n.monster.player4?p.f.getLabel("game.summon.playerAll",[""+n.monster.type])+(i?"("+i+" "+p.f.getLabel("game.hp")+")":""):n.monster.player2==n.monster.player3?p.f.getLabel("game.summon.player2-3",[""+n.monster.player2,""+n.monster.player4])+(i?"("+i+" "+p.f.getLabel("game.hp")+")":""):n.monster.player3==n.monster.player4?p.f.getLabel("game.summon.player3-4",[""+n.monster.player2,""+n.monster.player4])+(i?"("+i+" "+p.f.getLabel("game.hp")+")":""):(console.warn("Incorrect summon data",n),"")}getSummon(){return this.summonData?new _t.up("",this.summonData.name,this.summonData.cardId,this.summonData.level||0,this.summonData.count,_t.rX.custom,this.summonData):new _t.up("","","",0,0,_t.rX.custom)}highlightAction(){return null!=this.interactiveActions.find(n=>n.index==this.actionIndex)||!1}isInteractiveApplicableAction(){return this.interactiveAbilities&&this.monster&&this.monster.entities.some(n=>this.action&&s.E.actionsManager.isInteractiveApplicableAction(n,this.action,this.actionIndex))||this.objective&&this.objective.entities.some(n=>this.action&&s.E.actionsManager.isInteractiveApplicableAction(n,this.action,this.actionIndex))||!1}toggleHighlight(n){this.isInteractiveApplicableAction()&&(this.highlightAction()?this.interactiveActions=this.interactiveActions.filter(i=>i.index!=this.actionIndex):this.action&&this.interactiveActions.push({action:this.action,index:this.actionIndex}),this.interactiveActionsChange.emit(this.interactiveActions),n.preventDefault(),n.stopPropagation())}static \u0275fac=function(i){return new(i||a)(t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-action-summon"]],inputs:{monster:"monster",monsterType:"monsterType",objective:"objective",action:"action",textBlack:"textBlack",right:"right",isSpawn:[0,"spawn","isSpawn"],additional:"additional",interactiveAbilities:"interactiveAbilities",interactiveActions:"interactiveActions",actionIndex:[0,"index","actionIndex"],style:"style",character:"character",cardId:"cardId"},outputs:{interactiveActionsChange:"interactiveActionsChange"},standalone:!1,features:[t.OA$],decls:2,vars:2,consts:[[1,"summon-value",3,"ngClass"],[3,"summon","summonData","action","additional","right","item","style","character","cardId","index"],[1,"summon-label"],[3,"ghs-label"],["ghs-pointer-input","",1,"spawn",3,"clickBehind","ghs-tooltip","delay","disabled","ngClass"],["ghs-pointer-input","",1,"spawn",3,"singleClick","clickBehind","ghs-tooltip","delay","disabled","ngClass"],[3,"ghs-label","ghs-label-args","style"],[3,"ghs-label","ghs-label-args"],[3,"value-calc"],[3,"summon","summonData","action","additional","right","item","character","cardId","index"]],template:function(i,e){1&i&&(t.nVh(0,bk,10,11,"span",0),t.nVh(1,kk,1,11,"ghs-summon-sheet",1)),2&i&&(t.vxM(e.summonData?-1:0),t.R7$(),t.vxM(e.summonData?1:-1))},dependencies:[N.YU,it,Mt,dt,$i,nn,ct],styles:[".summon-value[_ngcontent-%COMP%]{font-family:var(--ghs-font-text)}.summon-value[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{filter:var(--ghs-filter-shadow)}.summon-value.small[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{filter:var(--ghs-filter-shadow-thin)}@keyframes _ngcontent-%COMP%_spawn-pulse{0%{transform:scale(.9)}50%{transform:scale(1)}to{transform:scale(.9)}}.summon-value[_ngcontent-%COMP%]   .spawn-highlight[_ngcontent-%COMP%]{display:inline-block;animation:_ngcontent-%COMP%_spawn-pulse calc(var(--ghs-animation-speed) * 1.2s) ease-in-out infinite}.summon-value[_ngcontent-%COMP%]   .spawn-highlight[_ngcontent-%COMP%]:hover{transform:scale(1);opacity:.8;animation:none}.summon-value[_ngcontent-%COMP%]   .spawn.action-interactive[_ngcontent-%COMP%]{display:inline-block;cursor:zoom-in}.summon-value[_ngcontent-%COMP%]   .spawn.action-interactive.action-interactive-highlight[_ngcontent-%COMP%]{cursor:zoom-out;animation:_ngcontent-%COMP%_spawn-pulse calc(var(--ghs-animation-speed) * 1.2s) ease-in-out infinite}.summon-value[_ngcontent-%COMP%]   .spawn.action-interactive.action-interactive-highlight[_ngcontent-%COMP%]:hover{transform:scale(1);opacity:.8;animation:none}.summon-value[_ngcontent-%COMP%]   .spawn-objective-highlight[_ngcontent-%COMP%]{display:inline-block;transform:scale(.9);font-style:italic}.summon-value[_ngcontent-%COMP%]   .spawn-objective-highlight[_ngcontent-%COMP%]:hover{transform:scale(1);opacity:.8}.summon-value[_ngcontent-%COMP%]   .placeholder[_ngcontent-%COMP%]{vertical-align:initial}"]})}return a})();const yk=a=>[a],xk=(a,r,n,i,e,o,g,m,k,X)=>[a,r,n,i,e,o,g,m,k,X],Ek=(a,r,n,i,e,o,g,m,k,X,at,tt)=>[a,r,n,i,e,o,g,m,k,X,at,tt],Ii=()=>["X"],As=()=>[],wk=(a,r)=>r._trackUUID;function Rk(a,r){if(1&a){const n=t.RV6();t.j41(0,"input",20),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.action.small,e)||(o.action.small=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.change())}),t.k0s()}if(2&a){const n=t.XpG();t.R50("ngModel",n.action.small)}}function jk(a,r){1&a&&t.nrm(0,"span",5),2&a&&t.Y8G("ghs-label","editor.action.small")}function Gk(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",21),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.subActionRemoved.emit(e.subactionIndex))}),t.nrm(1,"img",22)(2,"span",5),t.k0s()}2&a&&(t.R7$(2),t.Y8G("ghs-label","editor.action.removeSubAction"))}function Tk(a,r){if(1&a&&(t.j41(0,"option",9),t.nrm(1,"span",5),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n),t.R7$(),t.Y8G("ghs-label","game.action."+n)}}function Sk(a,r){1&a&&(t.j41(0,"label"),t.nrm(1,"span",5),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","editor.action.value"))}function Dk(a,r){if(1&a&&(t.j41(0,"option",9),t.nrm(1,"span",25),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n),t.R7$(),t.Aen("gh"),t.Y8G("ghs-label","game.specialTarget."+n)("ghs-label-args",t.lJ4(5,Ii))}}function $k(a,r){if(1&a){const n=t.RV6();t.j41(0,"label",24),t.EFF(1," X: "),t.j41(2,"input",26),t.bIt("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.changeSpecialTarget(o.value,e))}),t.k0s()()}if(2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ngModel",n.subValue)}}function Ik(a,r){if(1&a){const n=t.RV6();t.j41(0,"select",23),t.bIt("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.changeSpecialTarget(e,o.subValue))}),t.Z7z(1,Dk,2,6,"option",9,t.fX1),t.k0s(),t.nVh(3,$k,3,1,"label",24)}if(2&a){const n=t.XpG();t.Y8G("ngModel",n.value),t.R7$(),t.Dyx(n.ActionSpecialTarget),t.R7$(2),t.vxM(n.subValue?3:-1)}}function Ak(a,r){if(1&a){const n=t.RV6();t.j41(0,"input",27),t.bIt("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.action.value=o.valueChange(e))})("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.change())}),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngModel",n.action.value)}}function Vk(a,r){if(1&a){const n=t.RV6();t.j41(0,"textarea",28),t.bIt("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.action.value=o.valueChange(e))})("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.change())}),t.EFF(1,"  "),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngModel",n.action.value)}}function Fk(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",12)(1,"div",29)(2,"ghs-action-hex",30),t.bIt("clickCallback",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.toggleHex(e))})("doubleclickCallback",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.removeHex(e))}),t.k0s()(),t.j41(3,"textarea",23),t.bIt("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.changeHex(e))}),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("action",n.hexAction)("value",""+n.hexAction.value)("character",n.character)("cardId",n.cardId),t.R7$(),t.Y8G("ngModel",n.hexAction.value)}}function Xk(a,r){if(1&a&&(t.j41(0,"option",9),t.nrm(1,"span",5),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n),t.R7$(),t.Y8G("ghs-label","data.monster."+n)}}function Bk(a,r){if(1&a&&(t.j41(0,"option",9),t.nrm(1,"span",5),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n),t.R7$(),t.Y8G("ghs-label","monster."+n)}}function Yk(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",34)(1,"select",28),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2);return t.DH7(o.monster,e)||(o.monster=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeSummonMonster())}),t.Z7z(2,Xk,2,2,"option",9,t.fX1),t.k0s(),t.j41(4,"select",28),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2);return t.DH7(o.monsterType,e)||(o.monsterType=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeSummonMonster())}),t.nrm(5,"option"),t.Z7z(6,Bk,2,2,"option",9,t.fX1),t.k0s()()}if(2&a){const n=t.XpG(2);t.R7$(),t.R50("ngModel",n.monster),t.R7$(),t.Dyx(n.monsters),t.R7$(2),t.R50("ngModel",n.monsterType),t.R7$(2),t.Dyx(n.MonsterTypes)}}function Uk(a,r){1&a&&(t.j41(0,"span"),t.nrm(1,"span",5),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","editor.action.add"))}function Nk(a,r){1&a&&t.nrm(0,"span",5),2&a&&t.Y8G("ghs-label","editor.action.add")}function zk(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",35),t.nrm(1,"ghs-action-summon",36),t.j41(2,"input",37),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2);return t.DH7(o.summon.name,e)||(o.summon.name=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeSummon())}),t.k0s(),t.j41(3,"div",38)(4,"span",39)(5,"input",40),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2);return t.DH7(o.summon.health,e)||(o.summon.health=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeSummon())}),t.k0s()(),t.j41(6,"span",39)(7,"input",41),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2);return t.DH7(o.summon.movement,e)||(o.summon.movement=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeSummon())}),t.k0s()(),t.j41(8,"a",42),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.editSummonAction())}),t.nVh(9,Uk,2,1,"span"),t.k0s(),t.j41(10,"span",39)(11,"input",43),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2);return t.DH7(o.summon.attack,e)||(o.summon.attack=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeSummon())}),t.k0s()(),t.j41(12,"span",39)(13,"input",44),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2);return t.DH7(o.summon.range,e)||(o.summon.range=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeSummon())}),t.k0s()(),t.j41(14,"a",42),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.editSummonAdditionalAction())}),t.nVh(15,Nk,1,1,"span",5),t.k0s()()()}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("action",n.action)("additional",!0)("character",n.character)("cardId",n.cardId),t.R7$(),t.R50("ngModel",n.summon.name),t.R7$(3),t.R50("ngModel",n.summon.health),t.R7$(2),t.R50("ngModel",n.summon.movement),t.R7$(2),t.vxM(n.summon.action?-1:9),t.R7$(2),t.R50("ngModel",n.summon.attack),t.R7$(2),t.R50("ngModel",n.summon.range),t.R7$(2),t.vxM(n.summon.additionalAction?-1:15)}}function Lk(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",13)(1,"div",31)(2,"label")(3,"input",32),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.changeSummonType(e))}),t.k0s(),t.nrm(4,"span",5),t.k0s(),t.j41(5,"label")(6,"input",33),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.changeSummonType(e))}),t.k0s(),t.nrm(7,"span",5),t.k0s()(),t.nVh(8,Yk,8,2,"div",34),t.nVh(9,zk,16,11,"div",35),t.k0s()}if(2&a){const n=t.XpG();t.R7$(3),t.Y8G("checked",!n.summon),t.R7$(),t.Y8G("ghs-label","editor.action.summon.type.monster"),t.R7$(2),t.Y8G("checked",n.summon),t.R7$(),t.Y8G("ghs-label","editor.action.summon.type.summon"),t.R7$(),t.vxM(n.summon?-1:8),t.R7$(),t.vxM(n.summon?9:-1)}}function qk(a,r){if(1&a&&(t.j41(0,"option",9),t.nrm(1,"span",25),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n),t.R7$(),t.Y8G("ghs-label","game.condition."+n)("ghs-label-args",t.lJ4(3,Ii))}}function Hk(a,r){if(1&a){const n=t.RV6();t.j41(0,"label",24),t.EFF(1," X: "),t.j41(2,"input",45),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2);return t.DH7(o.subValue,e)||(o.subValue=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeCondition())}),t.k0s()()}if(2&a){const n=t.XpG(2);t.R7$(2),t.R50("ngModel",n.subValue)}}function Kk(a,r){if(1&a){const n=t.RV6();t.j41(0,"select",28),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.value,e)||(o.value=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeCondition())}),t.Z7z(1,qk,2,4,"option",9,t.fX1),t.k0s(),t.nVh(3,Hk,3,1,"label",24)}if(2&a){const n=t.XpG();t.R50("ngModel",n.value),t.R7$(),t.Dyx(n.conditionNames),t.R7$(2),t.vxM(n.subValue?3:-1)}}function Wk(a,r){if(1&a&&(t.j41(0,"option",9),t.nrm(1,"span",25),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("value",n),t.R7$(),t.Y8G("ghs-label","game.card."+n)("ghs-label-args",i.hasCardValue(n)?t.lJ4(3,Ii):t.lJ4(4,As))}}function Zk(a,r){if(1&a){const n=t.RV6();t.j41(0,"label",24),t.EFF(1," X: "),t.j41(2,"input",45),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2);return t.DH7(o.subValue,e)||(o.subValue=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeCard())}),t.k0s()()}if(2&a){const n=t.XpG(2);t.R7$(2),t.R50("ngModel",n.subValue)}}function Jk(a,r){if(1&a){const n=t.RV6();t.j41(0,"select",28),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.value,e)||(o.value=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeCard())}),t.Z7z(1,Wk,2,5,"option",9,t.fX1),t.k0s(),t.nVh(3,Zk,3,1,"label",24)}if(2&a){const n=t.XpG();t.R50("ngModel",n.value),t.R7$(),t.Dyx(n.ActionCardTypes),t.R7$(2),t.vxM(n.subValue?3:-1)}}function Qk(a,r){if(1&a&&(t.j41(0,"option",9),t.nrm(1,"span",5),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n),t.R7$(),t.Y8G("ghs-label","game.element."+n)}}function ty(a,r){if(1&a){const n=t.RV6();t.j41(0,"select",28),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.action.value,e)||(o.action.value=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.change())}),t.Z7z(1,Qk,2,2,"option",9,t.fX1),t.k0s()}if(2&a){const n=t.XpG();t.R50("ngModel",n.action.value),t.R7$(),t.Dyx(n.Elements)}}function ny(a,r){if(1&a&&(t.j41(0,"option",9),t.nrm(1,"span",5),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n),t.R7$(),t.Y8G("ghs-label","game.element."+n)}}function ey(a,r){if(1&a){const n=t.RV6();t.j41(0,"select",28),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.value,e)||(o.value=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeElementHalf())}),t.Z7z(1,ny,2,2,"option",9,t.fX1),t.k0s()}if(2&a){const n=t.XpG();t.R50("ngModel",n.value),t.R7$(),t.Dyx(n.HalfElementsLeft)}}function ay(a,r){if(1&a&&(t.j41(0,"option",9),t.nrm(1,"span",5),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n),t.R7$(),t.Y8G("ghs-label","game.element."+n)}}function iy(a,r){if(1&a){const n=t.RV6();t.j41(0,"select",28),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.subValue,e)||(o.subValue=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeElementHalf())}),t.Z7z(1,ay,2,2,"option",9,t.fX1),t.k0s()}if(2&a){const n=t.XpG();t.R50("ngModel",n.subValue),t.R7$(),t.Dyx(n.HalfElementsRight)}}function oy(a,r){if(1&a&&(t.j41(0,"option",9),t.nrm(1,"span",5),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n),t.R7$(),t.Y8G("ghs-label","game.monster."+n)}}function sy(a,r){if(1&a){const n=t.RV6();t.j41(0,"select",28),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.action.value,e)||(o.action.value=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.change())}),t.Z7z(1,oy,2,2,"option",9,t.fX1),t.k0s()}if(2&a){const n=t.XpG();t.R50("ngModel",n.action.value),t.R7$(),t.Dyx(n.MonsterTypes)}}function ry(a,r){if(1&a&&(t.j41(0,"option",47),t.nrm(1,"span",5),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("value",n)("selected",i.action.valueType==n||!i.action.valueType&&n==i.ActionValueType.fixed),t.R7$(),t.Y8G("ghs-label","editor.action.valueType."+n)}}function cy(a,r){if(1&a){const n=t.RV6();t.j41(0,"label"),t.nrm(1,"span",5),t.k0s(),t.j41(2,"select",46),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.action.valueType,e)||(o.action.valueType=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.change())}),t.Z7z(3,ry,2,3,"option",47,t.fX1),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","editor.action.valueType"),t.R7$(),t.R50("ngModel",n.action.valueType),t.R7$(),t.Dyx(n.ActionValueTypes)}}function ly(a,r){if(1&a&&(t.j41(0,"option",9),t.nrm(1,"span",5),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n),t.R7$(),t.Y8G("ghs-label","character.abilities.enhancements.types."+n)}}function gy(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",48)(1,"select",28),t.mxI("ngModelChange",function(e){const o=c.eBV(n).$implicit,g=t.XpG(3);return t.DH7(g.action.enhancementTypes[o],e)||(g.action.enhancementTypes[o]=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.change())}),t.Z7z(2,ly,2,2,"option",9,t.fX1),t.k0s(),t.j41(4,"a",42),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.removeEnhancement(e))}),t.nrm(5,"img",22)(6,"span",5),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG(3);t.R7$(),t.R50("ngModel",i.action.enhancementTypes[n]),t.R7$(),t.Dyx(i.EnhancementTypes),t.R7$(4),t.Y8G("ghs-label","editor.action.removeEnhancement")}}function dy(a,r){if(1&a&&(t.Z7z(0,gy,7,2,"div",48,t.fX1),t.nI1(2,"ghsRange")),2&a){const n=t.XpG(2);t.Dyx(t.i5U(2,0,t.lJ4(3,As),n.action.enhancementTypes.length))}}function hy(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",15)(1,"div",1),t.nrm(2,"label",5),t.j41(3,"a",17),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.addEnhancement())}),t.nrm(4,"img",18)(5,"span",5),t.k0s()(),t.nVh(6,dy,3,4),t.k0s()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","editor.action.enhancements"),t.R7$(3),t.Y8G("ghs-label","editor.action.addEnhancement"),t.R7$(),t.vxM(n.action.enhancementTypes?6:-1)}}function _y(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",19)(1,"span",49),t.nrm(2,"img",50),t.k0s(),t.j41(3,"ghs-editor-action",51),t.bIt("subActionRemoved",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.removeSubAction(e))})("actionChange",function(e){const o=c.eBV(n).$index,g=t.XpG();return c.Njj(g.changeSubAction(o,e))}),t.k0s()()}if(2&a){const n=r.$index,i=t.XpG();t.R7$(3),t.Y8G("action",i.action.subActions[n])("subactionIndex",n)}}function my(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-action",6),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.relative=!e.relative)}),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("action",n.data.action)("relative",n.relative)("character",n.data.character)("cardId",n.data.cardId)}}let Vs=(()=>{class a{dialog;ghsManager;action;actionTypes=Object.values($.X2);hideValues=!1;subactionIndex;character;cardId;actionChange=new t.bkB;subActionRemoved=new t.bkB;conditionNames=Object.values(Q.r5);ActionType=$.X2;ActionSpecialTarget=Object.values($.lB);Elements=Object.values(Tt.Hg);HalfElementsLeft=Object.values(Tt.Hg);HalfElementsRight=Object.values(Tt.Hg);ActionValueType=$.iQ;ActionValueTypes=Object.values($.iQ);ActionCardTypes=Object.values($.di);MonsterTypes=Object.values(S.N);EnhancementTypes=Object.values($t.J);hexAction=new $.rc($.X2.area,"(0,0,invisible)");value="";subValue="";summon;monster="";monsterType;monsters=[];constructor(n,i){this.dialog=n,this.ghsManager=i}ngOnInit(){if(this.monsters=s.E.monstersData().map(n=>n.name),this.action&&this.action.type==$.X2.area){this.hexAction.value=this.action.value?""+this.action.value:"(0,0,invisible)";let n=[];this.hexAction.value.split("|").forEach(i=>{const e=(0,K.dy)(i);null!=e&&n.push(e)}),n.forEach(i=>this.fillHexes(i,n)),this.hexAction.value=n.map(i=>(0,K.mC)(i)).join("|"),this.ghsManager.triggerUiChange()}else if(this.action.type==$.X2.condition||this.action.type==$.X2.specialTarget||this.action.type==$.X2.card||this.action.type==$.X2.elementHalf)(""+this.action.value).includes(":")?(this.value=(""+this.action.value).split(":")[0],this.subValue=(""+this.action.value).split(":")[1]):this.value=""+this.action.value,this.action.type==$.X2.elementHalf&&(this.HalfElementsLeft=this.Elements.filter(n=>n!=Tt.Hg.wild&&(!this.subValue||n!=this.subValue)),this.HalfElementsRight=this.Elements.filter(n=>n!=Tt.Hg.wild&&(!this.value||n!=this.value)));else if(this.action.type==$.X2.summon&&this.action.valueObject)try{this.summon=Object.assign(new js,this.action.valueObject)}catch{this.summon=void 0;const i=(this.action.value+"").split(":");this.monster=i[0],i.length>1&&(this.monsterType=i[1])}}valueChange(n){return isNaN(+n)?n||"":+n}addSubAction(){this.action.subActions||(this.action.subActions=[]),this.action.subActions=[...this.action.subActions,new $.rc($.X2.attack)],this.change()}changeSubAction(n,i){this.action.subActions[n]=i,setTimeout(()=>{this.change()})}removeSubAction(n){this.action.subActions.splice(n,1),this.change()}changeType(n){const i=this.action.type;if(n!=i){if(this.action.type=n,this.action.valueType=$.iQ.fixed,this.action.type==$.X2.area){this.hexAction.value="(0,0,invisible)";let e=[];this.hexAction.value.split("|").forEach(o=>{const g=(0,K.dy)(o);null!=g&&e.push(g)}),e.forEach(o=>this.fillHexes(o,e)),this.hexAction.value=e.map(o=>(0,K.mC)(o)).join("|"),this.action.value=e.filter(o=>o.type!=K.Gq.invisible).map(o=>(0,K.mC)(o)).join("|")}else this.action.type==$.X2.condition?(this.value=this.conditionNames[0],this.changeCondition()):this.action.type==$.X2.element?this.action.value=this.Elements[0]:this.action.type==$.X2.card?(this.value=this.ActionCardTypes[0],this.changeCard()):[$.X2.area,$.X2.condition,$.X2.element,$.X2.card].includes(i)&&(this.action.value="1");this.change()}}change(){this.actionChange.emit(this.action),this.ghsManager.triggerUiChange()}toggleHex(n){switch(n.type){case K.Gq.target:n.type=K.Gq.active;break;case K.Gq.active:n.type=K.Gq.blank;break;case K.Gq.blank:n.type=K.Gq.ally;break;case K.Gq.ally:n.type=K.Gq.conditional;break;case K.Gq.conditional:n.type=K.Gq.enhance;break;case K.Gq.enhance:n.type=K.Gq.invisible;break;case K.Gq.invisible:n.type=K.Gq.target}let i=[];(""+this.hexAction.value).split("|").forEach(o=>{const g=(0,K.dy)(o);null!=g&&i.push(g)});const e=i.find(o=>n.x==o.x&&n.y==o.y);e?i.splice(i.indexOf(e),1,n):i.push(n),this.fillHexes(n,i),this.hexAction.value=i.map(o=>(0,K.mC)(o)).join("|"),this.action.value=i.filter(o=>o.type!=K.Gq.invisible).map(o=>(0,K.mC)(o)).join("|"),this.change()}changeHex(n){if(n!=this.hexAction.value){this.hexAction.value=n;let i=[];(""+this.hexAction.value).split("|").forEach(e=>{const o=(0,K.dy)(e);null!=o&&i.push(o)}),this.hexAction.value=i.map(e=>(0,K.mC)(e)).join("|"),this.action.value=i.filter(e=>e.type!=K.Gq.invisible).map(e=>(0,K.mC)(e)).join("|"),this.change()}}removeHex(n){let i=[];(""+this.hexAction.value).split("|").forEach(o=>{const g=(0,K.dy)(o);null!=g&&i.push(g)});const e=i.find(o=>n.x==o.x&&n.y==o.y);if(e){0==e.x&&0==e.y?e.type=K.Gq.invisible:i.splice(i.indexOf(e),1);for(let o=-1;o<2;o++)for(let g=-1;g<2;g++)if((n.x+o!=n.x||n.y+g!=n.y)&&n.x+o>=0&&n.y+g>=0){let m=i.find(k=>n.x+o==k.x&&n.y+g==k.y&&k.type==K.Gq.invisible);m&&(0!=m.x||0!=m.y)&&i.splice(i.indexOf(m),1)}}i.filter(o=>o.type!=K.Gq.invisible).forEach(o=>this.fillHexes(o,i)),this.hexAction.value=i.map(o=>(0,K.mC)(o)).join("|"),this.action.value=i.filter(o=>o.type!=K.Gq.invisible).map(o=>(0,K.mC)(o)).join("|"),this.change()}fillHexes(n,i){for(let e=-1;e<2;e++)for(let o=-1;o<2;o++)(n.x+e!=n.x||n.y+o!=n.y)&&n.x+e>=0&&n.y+o>=0&&(i.find(g=>n.x+e==g.x&&n.y+o==g.y)||i.push(new K.wd(n.x+e,n.y+o,K.Gq.invisible,"")))}changeSpecialTarget(n,i){p.f.getLabel("game.specialTarget."+!n).includes("{0}")?i="":i||(i="1"),this.value=n,this.subValue=i,this.action.value=this.value+(this.subValue?":"+this.subValue:""),this.change()}changeCondition(){new Q.kW(this.value).types.includes(Q.GV.value)?(this.subValue||(this.subValue="1"),this.action.value=this.value+":"+this.subValue):(this.action.value=this.value,this.subValue=""),this.change()}hasCardValue(n){return n==$.di.experience||n==$.di.slotXp||n==$.di.slotXpFh||n==$.di.slotEndXp||n==$.di.slotStartXp}changeCard(){this.hasCardValue(this.value)?(this.subValue||(this.subValue="1"),this.action.value=this.value+":"+this.subValue):(this.action.value=this.value,this.subValue=""),this.change()}changeElementHalf(){this.HalfElementsLeft=this.Elements.filter(n=>n!=Tt.Hg.wild&&(!this.subValue||n!=this.subValue)),this.HalfElementsRight=this.Elements.filter(n=>n!=Tt.Hg.wild&&(!this.value||n!=this.value)),this.value=this.value||this.HalfElementsLeft[0],this.subValue=this.subValue||this.HalfElementsRight[0],this.Elements.includes(this.value)&&this.Elements.includes(this.subValue)&&(this.action.value=this.value+":"+this.subValue),this.change()}dropSubAction(n){(0,V.HD)(this.action.subActions,n.previousIndex,n.currentIndex),this.ghsManager.triggerUiChange()}changeSummonType(n){this.monster="",this.monsterType=void 0,"monster"==n.target.value?(this.summon=void 0,this.changeSummonMonster()):"summon"==n.target.value&&(this.summon=new js,this.action.value="summonData",this.action.valueObject=this.summon)}changeSummonMonster(){this.action.value=this.monster+(this.monsterType?":"+this.monsterType:""),this.ghsManager.triggerUiChange()}changeSummon(){this.summon&&(this.action.valueObject=this.summon),this.ghsManager.triggerUiChange()}editSummonAction(){this.summon&&(this.summon.action||(this.summon.action=new $.rc($.X2.attack)),this.dialog.open(wn,{panelClass:["dialog"],data:{action:this.summon.action}}).closed.subscribe({next:i=>{0==i&&this.summon&&(this.summon.action=void 0),this.changeSummon()}}))}editSummonAdditionalAction(){this.summon&&(this.summon.additionalAction||(this.summon.additionalAction=new $.rc($.X2.attack)),this.dialog.open(wn,{panelClass:["dialog"],data:{action:this.summon.additionalAction}}).closed.subscribe({next:i=>{0==i&&this.summon&&(this.summon.additionalAction=void 0),this.changeSummon()}}))}removeEnhancement(n){this.action.enhancementTypes&&this.action.enhancementTypes[n]&&(this.action.enhancementTypes.splice(n,1),this.change())}addEnhancement(){this.action.enhancementTypes=this.action.enhancementTypes||[],this.action.enhancementTypes.push(this.EnhancementTypes[0]),this.change()}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-editor-action"]],inputs:{action:"action",actionTypes:"actionTypes",hideValues:"hideValues",subactionIndex:"subactionIndex",character:"character",cardId:"cardId"},outputs:{actionChange:"actionChange",subActionRemoved:"subActionRemoved"},standalone:!1,decls:35,vars:49,consts:[[1,"action"],[1,"header"],[1,"type",3,"ghs-label"],[1,"small"],["type","checkbox",3,"ngModel"],[3,"ghs-label"],[1,"spacer"],[1,"remove"],["placeholder","type",3,"ngModelChange","ngModel"],[3,"value"],["type","text",3,"ngModel"],[3,"ngModel"],[1,"area-container"],[1,"summon"],[1,"action-element-half-container"],[1,"enhancements"],["cdkDropList","",1,"subactions",3,"cdkDropListDropped"],[1,"add",3,"click"],["src","./assets/images/plus.svg",1,"ghs-icon"],["cdkDrag","",1,"subaction"],["type","checkbox",3,"ngModelChange","change","ngModel"],[1,"remove",3,"click"],["src","./assets/images/minus.svg",1,"ghs-icon"],[3,"ngModelChange","ngModel"],[1,"inline"],[3,"ghs-label","ghs-label-args"],["type","text",3,"ngModelChange","ngModel"],["type","text",3,"ngModelChange","change","ngModel"],[3,"ngModelChange","change","ngModel"],[1,"hexes"],[3,"clickCallback","doubleclickCallback","action","value","character","cardId"],[1,"summon-type"],["type","radio","name","summonType","value","monster",3,"change","checked"],["type","radio","name","summonType","value","summon",3,"change","checked"],[1,"summon-monster"],[1,"summon-form"],[3,"action","additional","character","cardId"],[1,"summon-name",3,"ngModelChange","change","ngModel"],[1,"grid"],[1,"item"],[1,"summon-health",3,"ngModelChange","change","ngModel"],[1,"summon-movement",3,"ngModelChange","change","ngModel"],[3,"click"],[1,"summon-attack",3,"ngModelChange","change","ngModel"],[1,"summon-range",3,"ngModelChange","change","ngModel"],["min","1","type","number",3,"ngModelChange","change","ngModel"],["placeholder","valueType",3,"ngModelChange","change","ngModel"],[3,"value","selected"],[1,"enhancement"],["cdkDragHandle","",1,"handle"],["src","./assets/images/menu.svg",1,"ghs-icon"],[3,"subActionRemoved","actionChange","action","subactionIndex"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"span",2),t.j41(3,"label",3),t.nVh(4,Rk,1,1,"input",4),t.nVh(5,jk,1,1,"span",5),t.k0s(),t.nrm(6,"span",6),t.nVh(7,Gk,3,1,"a",7),t.k0s(),t.j41(8,"select",8),t.bIt("ngModelChange",function(g){return e.changeType(g)}),t.Z7z(9,Tk,2,2,"option",9,t.fX1),t.k0s(),t.nVh(11,Sk,2,1,"label"),t.nVh(12,Ik,4,2),t.nVh(13,Ak,1,1,"input",10),t.nVh(14,Vk,2,1,"textarea",11),t.nVh(15,Fk,4,5,"div",12),t.nVh(16,Lk,10,6,"div",13),t.nVh(17,Kk,4,2),t.nVh(18,Jk,4,2),t.nVh(19,ty,3,1,"select",11),t.j41(20,"div",14),t.nVh(21,ey,3,1,"select",11),t.nVh(22,iy,3,1,"select",11),t.k0s(),t.nVh(23,sy,3,1,"select",11),t.nVh(24,cy,5,2),t.nVh(25,hy,7,3,"div",15),t.j41(26,"div",16),t.bIt("cdkDropListDropped",function(g){return e.dropSubAction(g)}),t.j41(27,"div",1),t.nrm(28,"label",5),t.j41(29,"a",17),t.bIt("click",function(){return e.addSubAction()}),t.nrm(30,"img",18)(31,"span",5),t.k0s()(),t.Z7z(32,_y,4,2,"div",19,wk),t.nI1(34,"trackUUID"),t.k0s()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","editor.action.type"),t.R7$(2),t.vxM(e.hideValues?-1:4),t.R7$(),t.vxM(e.hideValues?-1:5),t.R7$(2),t.vxM(e.subactionIndex||0==e.subactionIndex?7:-1),t.R7$(),t.Y8G("ngModel",e.action.type),t.R7$(),t.Dyx(e.actionTypes),t.R7$(2),t.vxM(e.hideValues||t.eq3(23,yk,e.ActionType.jump).includes(e.action.type)?-1:11),t.R7$(),t.vxM(e.action.type==e.ActionType.specialTarget?12:-1),t.R7$(),t.vxM(!e.hideValues&&t.zJS(25,xk,[e.ActionType.area,e.ActionType.card,e.ActionType.condition,e.ActionType.element,e.ActionType.elementHalf,e.ActionType.jump,e.ActionType.monsterType,e.ActionType.specialTarget,e.ActionType.summon,!e.ActionType.custom]).includes(e.action.type)?13:-1),t.R7$(),t.vxM(e.hideValues||e.action.type!=e.ActionType.custom?-1:14),t.R7$(),t.vxM(e.action.type==e.ActionType.area?15:-1),t.R7$(),t.vxM(e.action.type==e.ActionType.summon?16:-1),t.R7$(),t.vxM(e.action.type==e.ActionType.condition?17:-1),t.R7$(),t.vxM(e.action.type==e.ActionType.card?18:-1),t.R7$(),t.vxM(e.action.type==e.ActionType.element?19:-1),t.R7$(2),t.vxM(e.action.type==e.ActionType.elementHalf?21:-1),t.R7$(),t.vxM(e.action.type==e.ActionType.elementHalf?22:-1),t.R7$(),t.vxM(e.action.type==e.ActionType.monsterType?23:-1),t.R7$(),t.vxM(!e.hideValues&&t.zJS(36,Ek,[e.ActionType.area,e.ActionType.card,e.ActionType.condition,e.ActionType.concatenation,e.ActionType.custom,e.ActionType.grant,e.ActionType.grid,e.ActionType.jump,e.ActionType.monsterType,e.ActionType.specialTarget,e.ActionType.summon,!e.ActionType.trigger]).includes(e.action.type)?24:-1),t.R7$(),t.vxM(e.hideValues?-1:25),t.R7$(3),t.Y8G("ghs-label","editor.action.subActions"),t.R7$(3),t.Y8G("ghs-label","editor.action.addSubAction"),t.R7$(),t.Dyx(t.bMT(34,21,e.action.subActions)))},dependencies:[E.xH,E.y7,E.me,E.Q0,E.Zm,E.wz,E.BC,E.VZ,E.vS,V.O7,V.T1,V.Fb,Ga,Is,a,it,At,ct],styles:[".action[_ngcontent-%COMP%]{display:flex;flex-direction:column;color:var(--ghs-color-white)}.action[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center;flex-wrap:wrap}.action[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1);display:flex;align-items:center}.action[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 3)}.action[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1)}.action[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{display:flex;align-items:center}.action[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]{display:flex;flex-direction:column}.action[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]{display:flex;align-items:center}.action[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{white-space:nowrap;margin-left:calc(var(--ghs-unit) * .5)}.action[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%]{display:flex;flex-direction:column}.action[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%]   .subaction[_ngcontent-%COMP%]{position:relative;margin-left:calc(var(--ghs-unit) * 2)}.action[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%]   .subaction[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.action[_ngcontent-%COMP%]   .area-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:calc(var(--ghs-unit) * .5)}.action[_ngcontent-%COMP%]   .area-container[_ngcontent-%COMP%]   .hexes[_ngcontent-%COMP%]{width:0}.action[_ngcontent-%COMP%]   .area-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:50%}.action[_ngcontent-%COMP%]   .action-element-half-container[_ngcontent-%COMP%]{display:flex}label.inline[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * .5);display:flex}input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{width:100%;min-width:initial;color:var(--ghs-color-white);background-color:transparent;border:1px solid var(--ghs-color-gray);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.7 * var(--ghs-fontsize))}input[type=text][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:hover, select[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:hover{border:1px solid var(--ghs-color-gray)}input[type=text][_ngcontent-%COMP%]   option[_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]   option[_ngcontent-%COMP%], select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:var(--ghs-color-black)}.ghs-icon[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}a[_ngcontent-%COMP%]{display:flex;align-items:center}a[_ngcontent-%COMP%]   .ghs-icon[_ngcontent-%COMP%]:nth-child(1){margin-right:.2em}a[_ngcontent-%COMP%], ghs-action-hex[_ngcontent-%COMP%]{cursor:pointer}.summon[_ngcontent-%COMP%]   .summon-type[_ngcontent-%COMP%], .summon[_ngcontent-%COMP%]   .summon-type[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .summon[_ngcontent-%COMP%]   .summon-monster[_ngcontent-%COMP%]{display:flex}.summon[_ngcontent-%COMP%]   .summon-form[_ngcontent-%COMP%]{position:relative;padding-top:38%;background-color:var(--ghs-color-darkgray)}.summon[_ngcontent-%COMP%]   .summon-form[_ngcontent-%COMP%]   ghs-action-summon[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%}.summon[_ngcontent-%COMP%]   .summon-form[_ngcontent-%COMP%]   .summon-name[_ngcontent-%COMP%]{position:absolute;top:5%;left:50%;width:65%;height:20%;transform:translate(-50%)}.summon[_ngcontent-%COMP%]   .summon-form[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:32% 32% 36%;grid-template-rows:1fr 1fr;position:absolute;justify-items:stretch;top:36%;left:13%;width:87%;height:56%}.summon[_ngcontent-%COMP%]   .summon-form[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{display:flex;justify-content:center}.summon[_ngcontent-%COMP%]   .summon-form[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:100%;width:30%;margin-left:40%}.summon[_ngcontent-%COMP%]   .summon-form[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:var(--ghs-color-black);opacity:.7}"]})}return a})(),wn=(()=>{class a{data;dialogRef;relative=!0;noPreview=[];constructor(n,i){this.data=n,this.dialogRef=i}deleteAction(){this.dialogRef.close(!1)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-editor-action-dialog"]],standalone:!1,decls:6,vars:5,consts:[[1,"scroll-container"],[3,"action","relative","character","cardId"],[3,"actionChange","action","character","cardId"],[3,"click"],["src","./assets/images/minus.svg",1,"ghs-icon"],[3,"ghs-label"],[3,"click","action","relative","character","cardId"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nVh(1,my,1,4,"ghs-action",1),t.j41(2,"ghs-editor-action",2),t.mxI("actionChange",function(g){return t.DH7(e.data.action,g)||(e.data.action=g),g}),t.k0s(),t.j41(3,"a",3),t.bIt("click",function(){return e.deleteAction()}),t.nrm(4,"img",4)(5,"span",5),t.k0s()()),2&i&&(t.R7$(),t.vxM(e.noPreview.includes(e.data.action.type)?-1:1),t.R7$(),t.R50("action",e.data.action),t.Y8G("character",e.data.character)("cardId",e.data.cardId),t.R7$(3),t.Y8G("ghs-label","editor.action.remove"))},dependencies:[en,Vs,it],styles:["[_nghost-%COMP%]{display:block;font-size:calc(var(--ghs-unit) * 2.7 * var(--ghs-fontsize));width:500px}ghs-action[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.7 * var(--ghs-fontsize))}.ghs-icon[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}a[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center}a[_ngcontent-%COMP%]   .ghs-icon[_ngcontent-%COMP%]:nth-child(1){margin-right:.2em}"]})}return a})();const py=(a,r,n,i,e)=>[a,r,n,i,e],uy=(a,r,n,i)=>[a,r,n,i],Sa=(a,r)=>[a,r],fy=a=>[a],Fs=()=>[],Ln=a=>({active:a}),Ai=a=>({enabled:a}),Cy=a=>({disabled:a});function My(a,r){1&a&&t.nrm(0,"div",2)}function vy(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-editor-action",23),t.bIt("actionChange",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.updateAction(e.action))}),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("action",n.action)("actionTypes",n.actionTypes)("hideValues",!0)}}function Oy(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",25),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.level=e+1)}),t.EFF(1),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Ln,i.level==n+1)),t.R7$(),t.JRh(n+1)}}function Py(a,r){1&a&&(t.Z7z(0,Oy,2,4,"a",24,t.fX1),t.nI1(2,"ghsRange")),2&a&&t.Dyx(t.i5U(2,0,t.lJ4(3,Fs),9))}function by(a,r){if(1&a&&(t.j41(0,"a",9),t.EFF(1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.JRh(n.level)}}function ky(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",28),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.enhancements=e)}),t.EFF(1),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Ln,i.enhancements==n)),t.R7$(),t.JRh(n)}}function yy(a,r){if(1&a){const n=t.RV6();t.Z7z(0,ky,2,4,"a",26,t.fX1),t.nI1(2,"ghsRange"),t.j41(3,"a",27),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.enhancements=e.enhancements+1)}),t.EFF(4,"+"),t.k0s()}if(2&a){const n=t.XpG();t.Dyx(t.i5U(2,0,t.lJ4(3,Fs),n.enhancements+1))}}function xy(a,r){if(1&a&&(t.j41(0,"a",11),t.EFF(1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.JRh(n.enhancements)}}function Ey(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",33),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.toggleSpecial("lost"))}),t.nrm(1,"img",34)(2,"img",35),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(1,Ai,"lost"==n.special))}}function wy(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",36),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.toggleSpecial("persistent"))}),t.nrm(1,"img",37)(2,"img",38),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(1,Ai,"persistent"==n.special))}}function Ry(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",12)(1,"a",29),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleSpecial("summon"))}),t.nrm(2,"img",30),t.k0s(),t.nVh(3,Ey,3,3,"a",31),t.nVh(4,wy,3,3,"a",32),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(3,Ai,"summon"==n.special)),t.R7$(2),t.vxM(n.gameManager.enhancementsManager.fh?3:-1),t.R7$(),t.vxM(n.gameManager.enhancementsManager.fh&&!n.gameManager.gh2eRules()?4:-1)}}function jy(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",39),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.setEnhancementAction("plus1"))}),t.EFF(1,"+1 "),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(1,Ln,"plus1"==n.enhancementAction))}}function Gy(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",41),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.setEnhancementAction(e))}),t.nrm(1,"span",8),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Ln,i.enhancementAction==n)),t.R7$(),t.Y8G("ghs-label","%game.element."+n+"%")}}function Ty(a,r){if(1&a&&(t.j41(0,"div",15),t.Z7z(1,Gy,2,4,"div",40,t.fX1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(n.Elements)}}function Sy(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",43),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.setEnhancementAction(e))}),t.nrm(1,"span",8),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Ln,i.enhancementAction==n)),t.R7$(),t.Y8G("ghs-label","%game.conditionIcon."+n+"%")}}function Dy(a,r){if(1&a&&(t.j41(0,"div",16),t.Z7z(1,Sy,2,4,"div",42,t.fX1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(n.gameManager.enhancementsManager.diamondConditions)}}function $y(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",43),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.setEnhancementAction(e))}),t.nrm(1,"span",8),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Ln,i.enhancementAction==n)),t.R7$(),t.Y8G("ghs-label","%game.conditionIcon."+n+"%")}}function Iy(a,r){if(1&a&&(t.j41(0,"div",16),t.Z7z(1,$y,2,4,"div",42,t.fX1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(n.gameManager.enhancementsManager.diamondPlusConditions)}}function Ay(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",44),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.setEnhancementAction(e.ActionType.jump))}),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(2,Ln,n.enhancementAction==n.ActionType.jump))("ghs-label","%game.actionIcon.jump%")}}function Vy(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",45),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.setEnhancementAction("hex"))}),t.nrm(1,"img",46),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(1,Ln,"hex"==n.enhancementAction))}}function Fy(a,r){if(1&a&&(t.j41(0,"tr"),t.nrm(1,"th",8),t.j41(2,"td",47),t.EFF(3),t.k0s()()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","character.abilities.enhancements.multiTarget"),t.R7$(2),t.SpI("+",n.gameManager.enhancementsManager.calculateBaseCosts(n.enhanceAction,n.special))}}function Xy(a,r){if(1&a&&(t.j41(0,"tr"),t.nrm(1,"th",8),t.j41(2,"td",48),t.EFF(3),t.nI1(4,"ghsCeil"),t.k0s()()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","character.abilities.enhancements.lost"),t.R7$(2),t.SpI("-",t.bMT(4,2,n.gameManager.enhancementsManager.calculateBaseCosts(n.enhanceAction,n.special)/(n.gameManager.actionsManager.isMultiTarget(n.enhanceAction)?1:2))," ")}}function By(a,r){if(1&a&&(t.j41(0,"tr"),t.nrm(1,"th",8),t.j41(2,"td",47),t.EFF(3),t.k0s()()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","character.abilities.enhancements.persistent"),t.R7$(2),t.SpI("+",n.gameManager.enhancementsManager.calculateBaseCosts(n.enhanceAction,n.special)*(n.gameManager.actionsManager.isMultiTarget(n.enhanceAction)?5:2))}}function Yy(a,r){if(1&a&&(t.j41(0,"tr"),t.nrm(1,"th",8),t.j41(2,"td",47),t.EFF(3),t.k0s()()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","character.abilities.enhancements.level"),t.R7$(2),t.SpI("+",n.gameManager.enhancementsManager.levelCosts(n.level))}}function Uy(a,r){if(1&a&&(t.j41(0,"tr"),t.nrm(1,"th",8),t.j41(2,"td",47),t.EFF(3),t.k0s()()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","character.abilities.enhancements.enhancements"),t.R7$(2),t.SpI("+",n.gameManager.enhancementsManager.enhancementCosts(n.enhancements))}}function Ny(a,r){if(1&a&&(t.j41(0,"tr"),t.nrm(1,"th",8),t.j41(2,"td",48),t.EFF(3),t.nI1(4,"ghsCeil"),t.k0s()()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","character.abilities.enhancements.temporary"),t.R7$(2),t.SpI(" -",t.bMT(4,2,.2*n.gameManager.enhancementsManager.calculateCosts(n.enhanceAction,n.level,n.special,n.enhancements,!0)))}}function zy(a,r){1&a&&(t.j41(0,"tr"),t.nrm(1,"th",8),t.j41(2,"td",48),t.EFF(3,"-10"),t.k0s()()),2&a&&(t.R7$(),t.Y8G("ghs-label","character.abilities.enhancements.enhancerLevel"))}function Ly(a,r){if(1&a&&t.nrm(0,"p",21),2&a){const n=t.XpG();t.Y8G("ghs-label","character.abilities.enhancements.disabled.enhancements")("ghs-label-args",t.l_i(2,Sa,n.enhancedCards,n.gameManager.prosperityLevel()))}}function qy(a,r){if(1&a&&t.nrm(0,"p",21),2&a){const n=t.XpG();t.Y8G("ghs-label","character.abilities.enhancements.disabled.gold")("ghs-label-args",t.l_i(2,Sa,n.data.character.progress.gold,n.gameManager.enhancementsManager.calculateCosts(n.enhanceAction,n.level,n.special,n.enhancements)))}}function Hy(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",22)(1,"a",49),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.close())}),t.nrm(2,"span",8),t.k0s(),t.j41(3,"a",50),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.apply())})("doubleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.apply(!0))}),t.nrm(4,"span",8),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","cancel"),t.R7$(),t.Y8G("ngClass",t.eq3(3,Cy,n.data.character&&n.data.character.progress.gold<n.gameManager.enhancementsManager.calculateCosts(n.enhanceAction,n.level,n.special,n.enhancements)||!n.gameManager.enhancementsManager.fh&&n.enhancedCards>=n.gameManager.prosperityLevel())),t.R7$(),t.Y8G("ghs-label","character.abilities.enhancements.apply")}}let Vi=(()=>{class a{data;dialogRef;ghsManager;gameManager=s.E;ActionType=$.X2;EnhancementType=$t.J;Elements=Object.values(Tt.Hg);action;enhanceAction;level=1;enhancements=0;special;character;customAction;wipSpecial=!1;customSpecial=!1;actionTypes=[];enhancementAction="plus1";enhancementType;enhancedCards=0;constructor(n,i,e){this.data=n,this.dialogRef=i,this.ghsManager=e,this.data=n||{},this.action=this.data.action?JSON.parse(JSON.stringify(this.data.action)):new $.rc($.X2.attack,1),this.action.small=!1,this.character=this.data.character?JSON.parse(JSON.stringify(this.data.character)):void 0,this.customAction=!1,this.enhanceAction=new $.rc(this.action.type,this.action.value,this.action.valueType,this.action.subActions),this.data.summon&&(this.action=new $.rc($.X2.summon,"summonData"),this.action.valueObject=this.data.summon,this.action.enhancementTypes=[$t.J.square,$t.J.square,$t.J.square,$t.J.square]),this.wipSpecial=null!=this.action&&this.action.type==$.X2.custom&&"%character.abilities.wip%"==this.action.value}ngOnInit(){if(this.data.action&&this.data.actionIndex&&this.data.cardId&&null!=this.data.enhancementIndex&&this.data.character){const n=s.E.deckData(this.data.character).abilities.find(i=>i.cardId==this.data.cardId);if(n&&(this.level="number"==typeof n.level?n.level:1,this.data.actionIndex.includes("bottom")?((n.bottomLost||n.bottomActions.find(i=>i.type==$.X2.card&&i.value.toString().includes("lost")))&&(this.special="lost"),(n.bottomPersistent||n.bottomActions.find(i=>i.type==$.X2.card&&i.value.toString().includes("persistent")))&&(this.special="persistent")):((n.lost||n.actions.find(i=>i.type==$.X2.card&&i.value.toString().includes("lost")))&&(this.special="lost"),(n.persistent||n.actions.find(i=>i.type==$.X2.card&&i.value.toString().includes("persistent")))&&(this.special="persistent")),this.data.summon&&(this.special="summon")),this.enhancements=this.data.character.progress.enhancements&&this.data.character.progress.enhancements.filter(i=>i.cardId==this.data.cardId&&this.data.actionIndex&&i.actionIndex.indexOf("bottom")==this.data.actionIndex.indexOf("bottom")).length||0,this.enhancedCards=this.data.character.progress.enhancements&&this.data.character.progress.enhancements.filter(i=>!i.inherited).map(i=>i.cardId).filter((i,e,o)=>(!this.data.cardId||this.data.cardId!=i)&&e==o.indexOf(i)).length,[$.X2.custom,$.X2.specialTarget].includes(this.data.action.type)&&this.data.action.enhancementTypes&&!this.wipSpecial){switch(this.customSpecial=!0,this.data.action.enhancementTypes[this.data.enhancementIndex]){case $t.J.square:this.actionTypes=s.E.enhancementsManager.squareActions;break;case $t.J.circle:this.actionTypes=s.E.enhancementsManager.circleActions;break;case $t.J.diamond:this.actionTypes=s.E.enhancementsManager.diamondActions;break;case $t.J.diamond_plus:this.actionTypes=s.E.enhancementsManager.diamondPlusActions}this.action=new $.rc(this.actionTypes[0],1)}}else this.customAction=!0;this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.data.character&&this.data.cardId&&(this.enhancements=this.data.character.progress.enhancements&&this.data.character.progress.enhancements.filter(n=>n.cardId==this.data.cardId&&this.data.actionIndex&&n.actionIndex.indexOf("bottom")==this.data.actionIndex.indexOf("bottom")).length||0,this.enhancedCards=this.data.character.progress.enhancements&&this.data.character.progress.enhancements.filter(n=>!n.inherited).map(n=>n.cardId).filter((n,i,e)=>(!this.data.cardId||this.data.cardId!=n)&&i==e.indexOf(n)).length)}}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}updateAction(n=void 0){n&&(this.action=n,this.enhanceAction=new $.rc(this.action.type,this.action.value,this.action.valueType,this.action.subActions)),this.update()}update(){this.customSpecial||(this.actionTypes=[...s.E.enhancementsManager.squareActions,...s.E.enhancementsManager.circleActions,...s.E.enhancementsManager.diamondActions,...s.E.enhancementsManager.diamondPlusActions,...s.E.enhancementsManager.hexActions].filter((i,e,o)=>e===o.indexOf(i))),"summon"===this.special?this.actionTypes=[...s.E.enhancementsManager.summonActions]:this.actionTypes.includes(this.action.type)||(this.action=new $.rc($.X2.attack,1));const n=this.enhancementType;this.action.enhancementTypes&&this.action.enhancementTypes.length&&!this.wipSpecial?null!=this.data.enhancementIndex&&(this.enhancementType=this.action.enhancementTypes[this.data.enhancementIndex]):(s.E.enhancementsManager.squareActions.includes(this.action.type)&&(this.enhancementType=$t.J.square),s.E.enhancementsManager.circleActions.includes(this.action.type)&&(this.enhancementType=$t.J.circle),s.E.enhancementsManager.diamondActions.includes(this.action.type)&&(this.action.type!=$.X2.condition||new Q.kW(""+this.action.value).types.includes(Q.GV.negative))&&(this.enhancementType=$t.J.diamond),s.E.enhancementsManager.diamondPlusActions.includes(this.action.type)&&(this.action.type!=$.X2.condition||new Q.kW(""+this.action.value).types.includes(Q.GV.positive))&&(this.enhancementType=$t.J.diamond_plus),s.E.enhancementsManager.hexActions.includes(this.action.type)&&(this.enhancementType=$t.J.hex)),"summon"===this.special&&(this.enhancementType=$t.J.square,this.enhancementAction="plus1"),!this.data.action||"plus1"!=this.enhancementAction&&"hex"!=this.enhancementAction?Object.values(Q.r5).includes(this.enhancementAction)?this.enhanceAction=new $.rc($.X2.condition,this.enhancementAction):Object.values(Tt.Hg).includes(this.enhancementAction)?this.enhanceAction=new $.rc($.X2.element,this.enhancementAction):this.enhancementAction==$.X2.jump?this.enhanceAction=new $.rc($.X2.jump):"plus1"==this.enhancementAction&&(this.enhanceAction=new $.rc(this.action.type,this.action.value,this.action.valueType,this.action.subActions)):this.wipSpecial||this.customSpecial?(this.enhanceAction=this.action,this.enhanceAction.enhancementTypes=this.data.action.enhancementTypes):this.enhanceAction=new $.rc(this.data.action.type,this.data.action.value,this.data.action.valueType),this.action.subActions&&(this.enhanceAction.subActions=JSON.parse(JSON.stringify(this.action.subActions))),this.enhancementType==$t.J.hex?this.enhancementAction="hex":n!=this.enhancementType&&(this.enhancementAction="plus1"),this.data.actionIndex&&this.data.cardId&&null!=this.data.enhancementIndex&&this.character&&(this.character.tags=[],this.character.progress.enhancements=this.data.character&&this.data.character.progress.enhancements&&JSON.parse(JSON.stringify(this.data.character.progress.enhancements))||[],this.character.progress.enhancements.push(new $t.V(this.data.cardId,this.data.actionIndex,this.data.enhancementIndex,this.enhancementAction))),this.ghsManager.triggerUiChange()}setEnhancementAction(n){this.enhancementAction=n,this.update()}toggleSpecial(n){this.special=this.special==n?void 0:n,this.update()}close(){(0,F.co)(this.dialogRef)}apply(n=!1){const i=s.E.enhancementsManager.calculateCosts(this.enhanceAction,this.level,this.special,this.enhancements);this.data.actionIndex&&this.data.cardId&&null!=this.data.enhancementIndex&&this.data.character&&(this.data.character.progress.gold>=i&&(s.E.enhancementsManager.fh||this.enhancedCards<s.E.prosperityLevel())||n)&&(s.E.stateManager.before("enhanceCard",s.E.characterManager.characterName(this.data.character),this.data.cardId),this.data.character.progress.enhancements||(this.data.character.progress.enhancements=[]),this.data.character.progress.enhancements.push(new $t.V(this.data.cardId,this.data.actionIndex,this.data.enhancementIndex,this.enhancementAction)),n||(this.data.character.progress.gold-=i),s.E.stateManager.after(),(0,F.co)(this.dialogRef))}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-enhancement-dialog"]],standalone:!1,decls:45,vars:53,consts:[[1,"enhancement-dialog","scroll-container"],[1,"header"],["ghs-setting-menu","alwaysFhEnhancements"],["ghs-setting-menu","temporaryEnhancements"],[1,"action"],[3,"action","relative","character","index","cardId"],[3,"action","actionTypes","hideValues"],[1,"levels"],[3,"ghs-label"],[1,"level","active","disabled"],[1,"previous-enhancements"],[1,"previous-enhancement","active","disabled"],[1,"card-properties"],[1,"enhancement-types"],[1,"plus1",3,"ngClass"],[1,"elements"],[1,"conditions"],[1,"jump","text-white",3,"ngClass","ghs-label"],[1,"hex",3,"ngClass"],[1,"costs"],[1,"hints"],[3,"ghs-label","ghs-label-args"],[1,"menu"],[3,"actionChange","action","actionTypes","hideValues"],[1,"level",3,"ngClass"],[1,"level",3,"click","ngClass"],[1,"previous-enhancement",3,"ngClass"],[1,"previous-enhancement","plus",3,"click"],[1,"previous-enhancement",3,"click","ngClass"],[1,"summon",3,"click","ngClass"],["src","./assets/images/summons/red.png"],[1,"lost",3,"ngClass"],[1,"persistent",3,"ngClass"],[1,"lost",3,"click","ngClass"],["src","./assets/images/action/card/lost.svg"],["src","./assets/images/action/card/overlay/lost.svg",1,"overlay"],[1,"persistent",3,"click","ngClass"],["src","./assets/images/action/card/persistent.svg"],["src","./assets/images/action/card/overlay/persistent.svg",1,"overlay"],[1,"plus1",3,"click","ngClass"],[1,"element",3,"ngClass"],[1,"element",3,"click","ngClass"],[1,"condition",3,"ngClass"],[1,"condition",3,"click","ngClass"],[1,"jump","text-white",3,"click","ngClass","ghs-label"],[1,"hex",3,"click","ngClass"],["src","./assets/images/action/hex/target.svg"],[1,"plus"],[1,"minus"],[1,"cancel",3,"click"],["ghs-pointer-input","",1,"apply",3,"singleClick","doubleClick","ngClass"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.nVh(2,My,1,0,"div",2),t.nrm(3,"div",3),t.j41(4,"div",4),t.nrm(5,"ghs-action",5),t.nVh(6,vy,1,3,"ghs-editor-action",6),t.k0s(),t.j41(7,"div",7),t.nrm(8,"label",8),t.nVh(9,Py,3,4),t.nVh(10,by,2,1,"a",9),t.k0s(),t.j41(11,"div",10),t.nrm(12,"label",8),t.nVh(13,yy,5,4),t.nVh(14,xy,2,1,"a",11),t.k0s(),t.nVh(15,Ry,5,5,"div",12),t.j41(16,"div",13),t.nVh(17,jy,2,3,"div",14),t.nVh(18,Ty,3,0,"div",15),t.nVh(19,Dy,3,0,"div",16),t.nVh(20,Iy,3,0,"div",16),t.nVh(21,Ay,1,4,"div",17),t.nVh(22,Vy,2,3,"div",18),t.k0s()(),t.j41(23,"div",19)(24,"table")(25,"tr"),t.nrm(26,"th",8),t.j41(27,"td"),t.EFF(28),t.k0s()(),t.nVh(29,Fy,4,2,"tr"),t.nVh(30,Xy,5,4,"tr"),t.nVh(31,By,4,2,"tr"),t.nVh(32,Yy,4,2,"tr"),t.nVh(33,Uy,4,2,"tr"),t.nVh(34,Ny,5,4,"tr"),t.nVh(35,zy,4,1,"tr"),t.j41(36,"tfoot")(37,"tr"),t.nrm(38,"th",8),t.j41(39,"td"),t.EFF(40),t.k0s()()()()(),t.j41(41,"div",20),t.nVh(42,Ly,1,5,"p",21),t.nVh(43,qy,1,5,"p",21),t.k0s(),t.nVh(44,Hy,5,5,"div",22),t.k0s()),2&i&&(t.R7$(2),t.vxM(e.gameManager.fhRules(!0)?-1:2),t.R7$(3),t.Y8G("action",e.action)("relative",!1)("character",e.character)("index",e.data.actionIndex||"")("cardId",e.data.cardId),t.R7$(),t.vxM(e.customAction||e.wipSpecial||e.customSpecial?6:-1),t.R7$(2),t.Y8G("ghs-label","character.abilities.enhancements.level"),t.R7$(),t.vxM(e.customAction?9:-1),t.R7$(),t.vxM(e.customAction?-1:10),t.R7$(2),t.Y8G("ghs-label","character.abilities.enhancements.enhancements"),t.R7$(),t.vxM(e.customAction?13:-1),t.R7$(),t.vxM(e.customAction?-1:14),t.R7$(),t.vxM(e.customAction?15:-1),t.R7$(2),t.vxM(e.enhancementType&&t.s1E(34,py,e.EnhancementType.square,e.EnhancementType.circle,e.EnhancementType.diamond,e.EnhancementType.diamond_plus,e.EnhancementType.any).includes(e.enhancementType)?17:-1),t.R7$(),t.vxM(e.enhancementType&&t.ziG(40,uy,e.EnhancementType.circle,e.EnhancementType.diamond,e.EnhancementType.diamond_plus,e.EnhancementType.any).includes(e.enhancementType)?18:-1),t.R7$(),t.vxM(e.enhancementType&&t.l_i(45,Sa,e.EnhancementType.diamond,e.EnhancementType.any).includes(e.enhancementType)?19:-1),t.R7$(),t.vxM(e.enhancementType&&t.l_i(48,Sa,e.EnhancementType.diamond_plus,e.EnhancementType.any).includes(e.enhancementType)?20:-1),t.R7$(),t.vxM(e.enhancementType&&e.action.type==e.ActionType.move&&"summon"!=e.special?21:-1),t.R7$(),t.vxM(e.enhancementType&&t.eq3(51,fy,e.EnhancementType.any).includes(e.enhancementType)?22:-1),t.R7$(4),t.Y8G("ghs-label","character.abilities.enhancements.baseCosts"),t.R7$(2),t.JRh(e.gameManager.enhancementsManager.calculateBaseCosts(e.enhanceAction,e.special)),t.R7$(),t.vxM(e.gameManager.actionsManager.isMultiTarget(e.enhanceAction)?29:-1),t.R7$(),t.vxM(e.gameManager.enhancementsManager.fh&&"lost"==e.special?30:-1),t.R7$(),t.vxM(e.gameManager.enhancementsManager.fh&&"persistent"==e.special?31:-1),t.R7$(),t.vxM(e.level>1?32:-1),t.R7$(),t.vxM(e.enhancements?33:-1),t.R7$(),t.vxM(e.gameManager.enhancementsManager.fh&&e.gameManager.enhancementsManager.temporary?34:-1),t.R7$(),t.vxM(e.gameManager.enhancementsManager.enhancerLevel>1?35:-1),t.R7$(3),t.Y8G("ghs-label","character.abilities.enhancements.costs"),t.R7$(2),t.SpI("",e.gameManager.enhancementsManager.calculateCosts(e.enhanceAction,e.level,e.special,e.enhancements)," "),t.R7$(2),t.vxM(!e.gameManager.enhancementsManager.fh&&e.enhancedCards>=e.gameManager.prosperityLevel()?42:-1),t.R7$(),t.vxM(e.data.character&&e.data.character.progress.gold<e.gameManager.enhancementsManager.calculateCosts(e.enhanceAction,e.level,e.special,e.enhancements)?43:-1),t.R7$(),t.vxM(e.character?44:-1))},dependencies:[N.YU,en,Vs,it,dt,fe,Fh,At],styles:[".enhancement-dialog[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));color:var(--ghs-color-white)}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]{display:block}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]{display:flex;align-items:center;flex-wrap:wrap}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));color:var(--ghs-color-gray)}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .previous-enhancement[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .previous-enhancement[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));color:var(--ghs-color-darkgray);text-shadow:var(--ghs-outline);height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor))}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level.level[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .previous-enhancement.level[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .level.level[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .previous-enhancement.level[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor))}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level.placeholder[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .previous-enhancement.placeholder[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .level.placeholder[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .previous-enhancement.placeholder[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level.active[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .previous-enhancement.active[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .level.active[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .previous-enhancement.active[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level.active.placeholder[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .previous-enhancement.active.placeholder[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .level.active.placeholder[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .previous-enhancement.active.placeholder[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level.disabled[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .previous-enhancement.disabled[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .level.disabled[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .previous-enhancement.disabled[_ngcontent-%COMP%]{cursor:initial;pointer-events:none}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover, .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .previous-enhancement[_ngcontent-%COMP%]:hover, .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover, .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .previous-enhancement[_ngcontent-%COMP%]:hover{color:var(--ghs-color-gray)}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover.placeholder, .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .previous-enhancement[_ngcontent-%COMP%]:hover.placeholder, .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover.placeholder, .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .previous-enhancement[_ngcontent-%COMP%]:hover.placeholder{filter:var(--ghs-filter-gray)}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .card-properties[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .card-properties[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;height:2.5em;width:2.5em;margin:.25em;filter:grayscale(.7);opacity:.5;cursor:pointer;padding:.3em;border-radius:100%}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .card-properties[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{filter:grayscale(.5);opacity:1}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .card-properties[_ngcontent-%COMP%]   a.enabled[_ngcontent-%COMP%]{filter:grayscale(0);opacity:1;border:calc(var(--ghs-unit) * .1 * var(--ghs-text-factor)) solid var(--ghs-color-white)}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .card-properties[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:relative;width:1.5em;height:auto}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .card-properties[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:nth-child(1){filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .card-properties[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:nth-child(2){position:absolute}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .card-properties[_ngcontent-%COMP%]   a.summon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:1.6em}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .card-properties[_ngcontent-%COMP%]   a.summon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:nth-child(1){filter:none}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .plus1[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .jump[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor));opacity:.7;filter:grayscale(.6);border-radius:100%}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .plus1.condition[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .element.condition[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .condition.condition[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .jump.condition[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.1 * var(--ghs-text-factor))}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .plus1[_ngcontent-%COMP%]:hover, .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%]:hover, .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:hover, .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .jump[_ngcontent-%COMP%]:hover{font-size:1.4em;opacity:1}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .plus1.active[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .element.active[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .condition.active[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .jump.active[_ngcontent-%COMP%]{font-size:1.6em;opacity:1;filter:none;border:calc(var(--ghs-unit) * .1 * var(--ghs-text-factor)) solid var(--ghs-color-white);pointer-events:none}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .plus1.active.condition[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .element.active.condition[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .condition.active.condition[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .jump.active.condition[_ngcontent-%COMP%]{font-size:1.3em}.enhancement-dialog[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]{display:flex;justify-content:center}.enhancement-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor))}.enhancement-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:left;padding-right:calc(var(--ghs-unit) * 6 * var(--ghs-text-factor))}.enhancement-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:right;padding-left:0}.enhancement-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .3 * var(--ghs-text-factor)) solid var(--ghs-color-gray)}.enhancement-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .plus[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.enhancement-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .minus[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.enhancement-dialog[_ngcontent-%COMP%]   .hints[_ngcontent-%COMP%]{display:flex;flex-direction:column}.enhancement-dialog[_ngcontent-%COMP%]   .hints[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.3em;text-align:center;color:var(--ghs-color-yellow);margin:.2em 0}.enhancement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.enhancement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:2em;padding:.3em}.enhancement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.enhancement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.enhancement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]:hover{opacity:.7}.enhancement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply.disabled[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray)}.enhancement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply.disabled[_ngcontent-%COMP%]:hover{opacity:1}"]})}return a})();const Xs=a=>[a],Ky=()=>[],Bs=(a,r)=>({active:a,exclusive:r}),Wy=a=>({active:a}),Zy=(a,r,n,i)=>({pick:a,"in-deck":r,always:n,disabled:i}),Ys=(a,r)=>r._trackUUID;function Jy(a,r){if(1&a&&t.nrm(0,"p",2),2&a){const n=t.XpG();t.Y8G("ghs-label","character.abilities.pickCard")("ghs-label-args",t.eq3(2,Xs,n.levelToPick))}}function Qy(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",14),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.undoLastCard())})("doubleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.resetDeck())}),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ghs-label","character.abilities.undoLastPick")("ghs-label-args",t.eq3(3,Xs,n.levelToPick?n.levelToPick-1:n.character.level))("ghs-tooltip","character.abilities.undoLastPick.hint")}}function t2(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",18),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.setLevel(e))})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.setLevel(e,!0))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.l_i(2,Bs,i.level==n,i.exclusiveLevel==n))("ghs-label",n)}}function n2(a,r){1&a&&(t.j41(0,"span",16),t.EFF(1,"|"),t.k0s())}function e2(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",19),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.setLevel(e+1))})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.setLevel(e+1,!0))}),t.EFF(1),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.l_i(2,Bs,i.level==n+1,i.exclusiveLevel==n+1)),t.R7$(),t.JRh(n+1)}}function a2(a,r){if(1&a&&(t.j41(0,"div",4),t.Z7z(1,t2,1,5,"a",15,t.fX1),t.nVh(3,n2,2,0,"span",16),t.Z7z(4,e2,2,5,"a",17,t.fX1),t.nI1(6,"ghsRange"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(n.additionalLevels),t.R7$(2),t.vxM(n.additionalLevels.length?3:-1),t.R7$(),t.Dyx(t.i5U(6,1,t.lJ4(4,Ky),n.deck?n.maxLevel:9))}}function i2(a,r){if(1&a&&t.nrm(0,"option",21),2&a){const n=r.$implicit;t.Y8G("value",n)("ghs-label","character.abilities.sort."+n)}}function o2(a,r){if(1&a){const n=t.RV6();t.j41(0,"select",20),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.sort,e)||(o.sort=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.update())}),t.Z7z(1,i2,1,2,"option",21,t.fX1),t.k0s()}if(2&a){const n=t.XpG();t.R50("ngModel",n.sort),t.R7$(),t.Dyx(n.sorts)}}function s2(a,r){if(1&a){const n=t.RV6();t.j41(0,"img",22),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleEnhanced())})("doubleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openEnhancementDialog())}),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(1,Wy,n.enhanced))}}function r2(a,r){1&a&&t.nrm(0,"p",8),2&a&&t.Y8G("ghs-label","character.abilities.deckWarning")}function c2(a,r){1&a&&t.nrm(0,"p",8),2&a&&t.Y8G("ghs-label","character.abilities.levelWarning")}function l2(a,r){if(1&a&&(t.j41(0,"div",11),t.nrm(1,"ghs-ability",23),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("character",n.character)}}function g2(a,r){if(1&a){const n=t.RV6();t.j41(0,"img",26),t.bIt("doubleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.toggleDeck(e,!0))}),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG();t.Y8G("ghs-tooltip",-1!=i.character.progress.deck.indexOf(i.abilities.indexOf(n))?"character.abilities.removeFromDeck":"character.abilities.forceDeck")}}function d2(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",12)(1,"ghs-ability",24),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.clickAbility(e))})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.openDialog(e))}),t.k0s(),t.nVh(2,g2,1,1,"img",25),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.ziG(5,Zy,i.levelToPick,1==n.level||"X"==n.level||-1!=i.character.progress.deck.indexOf(i.abilities.indexOf(n)),1==n.level||"X"==n.level,-1==i.character.progress.deck.indexOf(i.abilities.indexOf(n))&&(i.levelToPick<+n.level||i.cardsToPick<1))),t.R7$(),t.Y8G("ability",n)("character",i.character)("flipped",!0),t.R7$(),t.vxM(i.deck?-1:2)}}function h2(a,r){1&a&&t.nrm(0,"p",13),2&a&&t.Y8G("ghs-label","character.abilities.currentDeck")}function _2(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",28),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.openDialog(e))}),t.nrm(1,"ghs-ability",29),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(),t.Y8G("ability",n)("character",i.character)("flipped",!0)}}function m2(a,r){if(1&a&&(t.j41(0,"div",10),t.Z7z(1,_2,2,3,"div",27,Ys),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(t.bMT(3,0,n.smallAbilities))}}let Us=(()=>{class a{data;dialogRef;dialog;ghsManager;character;level;exclusiveLevel;additionalLevels=[];abilities=[];visibleAbilities=[];smallAbilities=[];cardsToPick=1;levelToPick=1;sort="level-deck";sorts=["level-deck","cardId","level-name","name"];deck=!0;maxLevel=1;enhanced=!1;constructor(n,i,e,o){this.data=n,this.dialogRef=i,this.dialog=e,this.ghsManager=o,this.character=n.character,this.level=this.character.level,this.abilities=s.E.deckData(this.character).abilities,this.abilities.filter(g=>"string"==typeof g.level&&"X"!=g.level||"number"==typeof g.level&&g.level>9).forEach(g=>{this.additionalLevels.includes(g.level)||this.additionalLevels.push(g.level)}),this.dialogRef.closed.subscribe({next:()=>{this.character.tags=this.character.tags.filter(g=>"edit-abilities"!=g)}})}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.cardsToPick=this.character.level-this.character.progress.deck.length-1,this.character.tags=this.character.tags.filter(n=>"edit-abilities"!=n),this.cardsToPick<0&&(this.cardsToPick=0),this.character.progress.deck=this.character.progress.deck||[],this.levelToPick=this.deck&&this.cardsToPick?this.character.level-this.cardsToPick+1:0,this.maxLevel=Math.max(...this.abilities.filter((n,i)=>"number"==typeof n.level&&this.character.progress.deck.includes(i)).map(n=>+n.level),this.character.level),this.levelToPick?(this.visibleAbilities=this.abilities.filter((n,i)=>"number"==typeof n.level&&n.level>1&&n.level<=this.levelToPick&&!this.character.progress.deck.includes(i)).sort((n,i)=>"number"==typeof n.level&&"number"==typeof i.level&&n.level!=i.level?i.level-n.level:n.cardId&&i.cardId?n.cardId-i.cardId:0),this.smallAbilities=this.abilities.filter((n,i)=>"X"==n.level||1==n.level||this.character.progress.deck.includes(i))):(this.visibleAbilities=this.abilities.filter(n=>!this.exclusiveLevel&&"number"==typeof this.level&&("string"==typeof n.level||+n.level<=this.level)&&!this.additionalLevels.includes(n.level)||this.exclusiveLevel&&n.level==this.exclusiveLevel||1==this.exclusiveLevel&&"X"==n.level),this.smallAbilities=[],this.deck&&(this.visibleAbilities=this.visibleAbilities.filter(n=>"X"==n.level||1==n.level||"string"==typeof n.level&&n.level==this.level||-1!=this.character.progress.deck.indexOf(this.abilities.indexOf(n))),this.character.tags.push("edit-abilities")),"cardId"==this.sort?this.visibleAbilities.sort((n,i)=>n.cardId&&i.cardId?n.cardId-i.cardId:0):"level-name"==this.sort?this.visibleAbilities.sort((n,i)=>n.level==i.level?n.name&&i.name?n.name<i.name?-1:1:n.cardId&&i.cardId?n.cardId-i.cardId:0:1==n.level&&"X"==i.level?-1:"X"==n.level&&1==i.level?1:"X"==n.level?-1:"X"==i.level?1:"number"==typeof n.level&&"number"==typeof i.level?n.level-i.level:0):"level-deck"==this.sort?this.visibleAbilities.sort((n,i)=>1!=n.level&&"X"!=n.level||1!=i.level&&"X"!=i.level?1==n.level||"X"==n.level?-1:1==i.level||"X"==i.level?1:-1!=this.character.progress.deck.indexOf(this.abilities.indexOf(n))&&-1==this.character.progress.deck.indexOf(this.abilities.indexOf(i))?-1:-1==this.character.progress.deck.indexOf(this.abilities.indexOf(n))&&-1!=this.character.progress.deck.indexOf(this.abilities.indexOf(i))?1:0:0):"name"==this.sort&&this.visibleAbilities.sort((n,i)=>n.name&&i.name?n.name<i.name?-1:1:n.cardId&&i.cardId?n.cardId-i.cardId:0)),!this.levelToPick&&this.enhanced&&this.character.progress.enhancements&&this.character.progress.enhancements.length&&(this.visibleAbilities=this.visibleAbilities.filter(n=>this.character.progress.enhancements&&this.character.progress.enhancements.find(i=>i.cardId==n.cardId)))}togglePick(){this.deck=!this.deck,this.ghsManager.triggerUiChange()}setLevel(n,i=!1){this.level=n,this.exclusiveLevel=i?n:void 0,this.additionalLevels.includes(n)&&(this.exclusiveLevel=n),this.update()}undoLastCard(){s.E.stateManager.before("character.undoLastCard",s.E.characterManager.characterName(this.character)),this.character.progress.deck.splice(-1,1),s.E.stateManager.after(),this.update()}resetDeck(){s.E.stateManager.before("character.resetDeck",s.E.characterManager.characterName(this.character)),this.character.progress.deck=[],s.E.stateManager.after(),this.update()}clickAbility(n){"string"!=typeof n.level&&1!=n.level&&this.levelToPick&&this.deck?this.toggleDeck(n):this.openDialog(n)}toggleDeck(n,i=!1){const e=-1!=this.character.progress.deck.indexOf(this.abilities.indexOf(n));(e||i||this.levelToPick>=+n.level&&this.cardsToPick>0)&&(e?(s.E.stateManager.before("character.cardFromDeck",s.E.characterManager.characterName(this.character),n.name||n.cardId||""),this.character.progress.deck=this.character.progress.deck.filter(o=>o!=this.abilities.indexOf(n))):(s.E.stateManager.before("character.cardToDeck",s.E.characterManager.characterName(this.character),n.name||n.cardId||""),this.character.progress.deck.push(this.abilities.indexOf(n))),s.E.stateManager.after(),this.update())}openDialog(n){this.dialog.open(Di,{panelClass:["fullscreen-panel"],disableClose:!0,data:{ability:n,character:this.character}})}toggleEnhanced(){this.character.progress.enhancements&&this.character.progress.enhancements.length?(this.enhanced=!this.enhanced,this.ghsManager.triggerUiChange()):(this.enhanced=!1,this.openEnhancementDialog())}openEnhancementDialog(){this.dialog.open(Vi,{panelClass:["dialog"]})}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-ability-cards-dialog"]],standalone:!1,decls:18,vars:13,consts:[[1,"ability-cards-dialog"],[1,"menu"],[1,"title",3,"ghs-label","ghs-label-args"],["ghs-pointer-input","",3,"ghs-label","ghs-label-args","ghs-tooltip"],[1,"levels"],[3,"ngModel"],[3,"click","ghs-label"],["src","./assets/images/character/enhancements.svg","ghs-pointer-input","",1,"enhancement",3,"ngClass"],[1,"warning",3,"ghs-label"],[1,"scroll-container"],[1,"abilities"],[1,"container"],[1,"container","ability",3,"ngClass"],[1,"title",3,"ghs-label"],["ghs-pointer-input","",3,"singleClick","doubleClick","ghs-label","ghs-label-args","ghs-tooltip"],["ghs-pointer-input","",1,"level",3,"ngClass","ghs-label"],[1,"separator"],["ghs-pointer-input","",1,"level",3,"ngClass"],["ghs-pointer-input","",1,"level",3,"singleClick","doubleClick","ngClass","ghs-label"],["ghs-pointer-input","",1,"level",3,"singleClick","doubleClick","ngClass"],[3,"ngModelChange","change","ngModel"],[3,"value","ghs-label"],["src","./assets/images/character/enhancements.svg","ghs-pointer-input","",1,"enhancement",3,"singleClick","doubleClick","ngClass"],[3,"character"],["ghs-pointer-input","",3,"singleClick","doubleClick","ability","character","flipped"],["src","./assets/images/character/deck.svg","ghs-pointer-input","",1,"deck",3,"ghs-tooltip"],["src","./assets/images/character/deck.svg","ghs-pointer-input","",1,"deck",3,"doubleClick","ghs-tooltip"],[1,"container","small","ability"],[1,"container","small","ability",3,"click"],[3,"ability","character","flipped"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.nVh(2,Jy,1,4,"p",2),t.nVh(3,Qy,1,5,"a",3),t.nVh(4,a2,7,5,"div",4),t.nVh(5,o2,3,1,"select",5),t.j41(6,"a",6),t.bIt("click",function(){return e.togglePick()}),t.k0s(),t.nVh(7,s2,1,3,"img",7),t.nVh(8,r2,1,1,"p",8),t.nVh(9,c2,1,1,"p",8),t.k0s(),t.j41(10,"div",9)(11,"div",10),t.nVh(12,l2,2,1,"div",11),t.Z7z(13,d2,3,10,"div",12,Ys),t.nI1(15,"trackUUID"),t.k0s(),t.nVh(16,h2,1,1,"p",13),t.nVh(17,m2,4,2,"div",10),t.k0s()()),2&i&&(t.R7$(2),t.vxM(e.levelToPick?2:-1),t.R7$(),t.vxM(e.character.progress.deck.length&&e.deck?3:-1),t.R7$(),t.vxM(e.levelToPick?-1:4),t.R7$(),t.vxM(e.levelToPick?-1:5),t.R7$(),t.Y8G("ghs-label",e.deck?"character.abilities.show":"character.abilities.showDeck"),t.R7$(),t.vxM(e.levelToPick?-1:7),t.R7$(),t.vxM(e.character.progress.deck.length>e.character.level-1?8:-1),t.R7$(),t.vxM(e.maxLevel>e.character.level?9:-1),t.R7$(3),t.vxM(e.exclusiveLevel||e.levelToPick||e.enhanced?-1:12),t.R7$(),t.Dyx(t.bMT(15,11,e.visibleAbilities)),t.R7$(3),t.vxM(e.smallAbilities.length?16:-1),t.R7$(),t.vxM(e.smallAbilities.length?17:-1))},dependencies:[N.YU,E.xH,E.y7,E.wz,E.BC,E.vS,ee,it,Mt,dt,At,ct],styles:[".title[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);display:flex;justify-content:center;align-items:center;width:100%;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));color:var(--ghs-color-gray)}.warning[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);display:flex;justify-content:center;align-items:center;width:100%;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));color:var(--ghs-color-yellow)}.menu[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));color:var(--ghs-color-gray)}.menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.menu[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));height:auto;filter:var(--ghs-filter-gray);opacity:1;z-index:2;cursor:pointer}.menu[_ngcontent-%COMP%]   .enhancement.active[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.menu[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]:hover{filter:var(--ghs-filter-white)}.menu[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap}.menu[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));color:var(--ghs-color-darkgray);text-shadow:var(--ghs-outline);height:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor))}.menu[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level.placeholder[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)}.menu[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level.active[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.menu[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level.active.placeholder[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.menu[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level.exclusive[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) / 4) var(--ghs-color-white) solid;border-radius:100%}.menu[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover{color:var(--ghs-color-gray)}.menu[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover.placeholder{filter:var(--ghs-filter-gray)}.menu[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray);font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.scroll-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;max-height:calc(var(--ghs-unit) * 78 * var(--ghs-text-factor))}.scroll-container[_ngcontent-%COMP%]   .abilities[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap}.scroll-container[_ngcontent-%COMP%]   .abilities[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 32 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 43.2 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));flex-shrink:0;flex-grow:0}.scroll-container[_ngcontent-%COMP%]   .abilities[_ngcontent-%COMP%]   .container.small[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 20 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 27 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.scroll-container[_ngcontent-%COMP%]   .abilities[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{display:block;position:relative;width:100%;height:100%;z-index:1;cursor:zoom-in}.scroll-container[_ngcontent-%COMP%]   .abilities[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]{position:absolute;top:5%;right:5%;width:9%;height:auto;filter:var(--ghs-filter-white);opacity:1;z-index:2;cursor:pointer}.scroll-container[_ngcontent-%COMP%]   .abilities[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]:hover{opacity:.7}.scroll-container[_ngcontent-%COMP%]   .abilities[_ngcontent-%COMP%]   .ability.pick[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{cursor:pointer}.scroll-container[_ngcontent-%COMP%]   .abilities[_ngcontent-%COMP%]   .ability.in-deck[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]{filter:var(--ghs-filter-green);opacity:1}.scroll-container[_ngcontent-%COMP%]   .abilities[_ngcontent-%COMP%]   .ability.disabled[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkred);cursor:initial}.scroll-container[_ngcontent-%COMP%]   .abilities[_ngcontent-%COMP%]   .ability.disabled[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]:hover{opacity:1}.scroll-container[_ngcontent-%COMP%]   .abilities[_ngcontent-%COMP%]   .ability.always[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]{filter:var(--ghs-filter-white);cursor:initial;pointer-events:none}"]})}return a})();const p2=(a,r,n)=>({fh:a,"new-style":r,"town-guard":n}),Fi=a=>({target:a}),u2=a=>({"sub-effects":a}),f2=(a,r)=>({target:a,"sub-effects":r}),Da=a=>({"ghs-svg":a}),C2=()=>[],M2=a=>({"text-white":a}),v2=a=>({"new-style":a}),an=(a,r)=>r._trackUUID;function O2(a,r){if(1&a&&(t.j41(0,"span",10),t.EFF(1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.JRh(n.effect.value.split(":")[1])}}function P2(a,r){if(1&a&&(t.j41(0,"span"),t.nrm(1,"span",14),t.k0s()),2&a){const n=t.XpG(3);t.HbH(t.VkB("target-value-container ","target-"+n.targetString.replace("game.specialTarget.",""))),t.R7$(),t.Aen(!!n.newStyle&&"fh"),t.Y8G("ghs-label",n.targetString.split(":")[0])("ghs-label-args",n.targetString.split(":").slice(1))}}function b2(a,r){if(1&a&&(t.j41(0,"span",12),t.nrm(1,"img",15),t.EFF(2),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("src","./assets/images/action/target.svg",t.B4B),t.R7$(),t.SpI(" ",n.targetValue," ")}}function k2(a,r){if(1&a&&(t.j41(0,"span",13),t.nrm(1,"span",16),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Aen(!!n.newStyle&&"fh"),t.Y8G("ghs-label",n.rangeValue)}}function y2(a,r){if(1&a&&(t.nrm(0,"img",9),t.nVh(1,O2,2,1,"span",10),t.nVh(2,P2,2,7,"span",11),t.nVh(3,b2,3,2,"span",12),t.nVh(4,k2,2,3,"span",13)),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(6,Fi,n.targetClass))("src","./assets/images/"+(n.settingsManager.settings.fhStyle?"fh/":"")+"condition/"+n.effect.value.split(":")[0]+".svg",t.B4B),t.R7$(),t.vxM(n.effect.value.split(":").length>1?1:-1),t.R7$(),t.vxM(n.targetString?2:-1),t.R7$(),t.vxM(n.targetValue?3:-1),t.R7$(),t.vxM(n.rangeValue?4:-1)}}function x2(a,r){if(1&a&&(t.j41(0,"div",17),t.nrm(1,"ghs-attackmodifier-effect",18),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(3);t.R7$(),t.Y8G("attackModifier",i.attackModifier)("effect",n)("offsetWidth",i.offsetWidth)("newStyle",i.newStyle)}}function E2(a,r){if(1&a&&(t.nrm(0,"img",9),t.Z7z(1,x2,2,4,"div",17,an),t.nI1(3,"trackUUID")),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(4,u2,n.effect.effects&&n.effect.effects.length))("src","./assets/images/"+(n.settingsManager.settings.fhStyle?"fh/":"")+"element/"+n.effect.value+".svg",t.B4B),t.R7$(),t.Dyx(t.bMT(3,2,n.effect.effects))}}function w2(a,r){if(1&a&&(t.j41(0,"span",3)(1,"span",19),t.nrm(2,"img",20),t.k0s(),t.j41(3,"span",19),t.nrm(4,"img",20),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("src","./assets/images/"+(n.settingsManager.settings.fhStyle?"fh/":"")+"element/"+n.effect.value.split("|")[0]+".svg",t.B4B),t.R7$(2),t.Y8G("src","./assets/images/"+(n.settingsManager.settings.fhStyle?"fh/":"")+"element/"+n.effect.value.split("|")[1]+".svg",t.B4B)}}function R2(a,r){if(1&a&&(t.j41(0,"div",17),t.nrm(1,"ghs-attackmodifier-effect",18),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(3);t.R7$(),t.Y8G("attackModifier",i.attackModifier)("effect",n)("offsetWidth",i.offsetWidth)("newStyle",i.newStyle)}}function j2(a,r){if(1&a&&(t.j41(0,"span",21),t.nrm(1,"img",20),t.k0s(),t.j41(2,"span",22),t.EFF(3,":"),t.k0s(),t.Z7z(4,R2,2,4,"div",17,an),t.nI1(6,"trackUUID")),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("src","./assets/images/"+(n.settingsManager.settings.fhStyle?"fh/":"")+"element/"+n.effect.value+".svg",t.B4B),t.R7$(3),t.Dyx(t.bMT(6,1,n.effect.effects))}}function G2(a,r){if(1&a&&(t.j41(0,"span",10),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.JRh(t.bMT(2,1,+n.effect.value))}}function T2(a,r){if(1&a&&(t.j41(0,"span"),t.nrm(1,"span",14),t.k0s()),2&a){const n=t.XpG(3);t.HbH(t.VkB("target-value-container ","target-"+n.targetString.replace("game.specialTarget.",""))),t.R7$(),t.Aen(!!n.newStyle&&"fh"),t.Y8G("ghs-label",n.targetString.split(":")[0])("ghs-label-args",n.targetString.split(":").slice(1))}}function S2(a,r){if(1&a&&(t.j41(0,"span",12),t.nrm(1,"img",20)(2,"span",14),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("src","./assets/images/action/target.svg",t.B4B),t.R7$(),t.Aen(!!n.newStyle&&"fh"),t.Y8G("ghs-label",n.targetString)("ghs-label-args",t.lJ4(5,C2))}}function D2(a,r){if(1&a&&(t.j41(0,"span",12),t.nrm(1,"img",15),t.EFF(2),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("src","./assets/images/action/target.svg",t.B4B),t.R7$(),t.SpI(" ",n.targetValue," ")}}function $2(a,r){if(1&a&&(t.j41(0,"span",13),t.nrm(1,"span",16),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Aen(!!n.newStyle&&"fh"),t.Y8G("ghs-label",n.rangeValue)}}function I2(a,r){if(1&a&&t.nrm(0,"ghs-attackmodifier-effect",18),2&a){const n=r.$implicit,i=t.XpG(3);t.Y8G("attackModifier",i.attackModifier)("effect",n)("offsetWidth",i.offsetWidth)("newStyle",i.newStyle)}}function A2(a,r){if(1&a&&(t.j41(0,"div",23),t.nrm(1,"img",24),t.nVh(2,G2,3,3,"span",10),t.nVh(3,T2,2,7,"span",11),t.nVh(4,S2,3,6,"span",12),t.nVh(5,D2,3,2,"span",12),t.nVh(6,$2,2,3,"span",13),t.j41(7,"div",17)(8,"span",22),t.EFF(9,","),t.k0s(),t.Z7z(10,I2,1,4,"ghs-attackmodifier-effect",18,an),t.nI1(12,"trackUUID"),t.k0s()()),2&a){const n=t.XpG(2);t.xc7("border-width",.02*n.offsetWidth+"px"),t.Y8G("ngClass",t.l_i(12,f2,n.targetClass,n.subEffects().length>0)),t.R7$(),t.Y8G("ngClass",t.eq3(15,Da,n.isGhsSvg(n.effect.type)))("src","./assets/images/action/"+n.effect.type+".svg",t.B4B),t.R7$(),t.vxM(n.effect.value?2:-1),t.R7$(),t.vxM(n.targetString&&n.targetString.startsWith("game.specialTarget")?3:-1),t.R7$(),t.vxM(n.targetString&&!n.targetString.startsWith("game.specialTarget")?4:-1),t.R7$(),t.vxM(n.targetValue?5:-1),t.R7$(),t.vxM(n.rangeValue?6:-1),t.R7$(4),t.Dyx(t.bMT(12,10,n.subEffects()))}}function V2(a,r){if(1&a&&(t.j41(0,"span",10),t.EFF(1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.JRh(+n.effect.value)}}function F2(a,r){if(1&a&&(t.j41(0,"span"),t.nrm(1,"span",14),t.k0s()),2&a){const n=t.XpG(3);t.HbH(t.VkB("target-value-container ","target-"+n.targetString.replace("game.specialTarget.",""))),t.R7$(),t.Aen(!!n.newStyle&&"fh"),t.Y8G("ghs-label",n.targetString.split(":")[0])("ghs-label-args",n.targetString.split(":").slice(1))}}function X2(a,r){if(1&a&&(t.j41(0,"span",12),t.nrm(1,"img",15),t.EFF(2),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("src","./assets/images/action/target.svg",t.B4B),t.R7$(),t.SpI(" ",n.targetValue," ")}}function B2(a,r){if(1&a&&(t.j41(0,"span",13),t.nrm(1,"span",16),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Aen(!!n.newStyle&&"fh"),t.Y8G("ghs-label",n.rangeValue)}}function Y2(a,r){if(1&a&&t.nrm(0,"ghs-attackmodifier-effect",18),2&a){const n=r.$implicit,i=t.XpG(3);t.Y8G("attackModifier",i.attackModifier)("effect",n)("offsetWidth",i.offsetWidth)("newStyle",i.newStyle)}}function U2(a,r){if(1&a&&(t.j41(0,"div",25),t.nrm(1,"img",24),t.nVh(2,V2,2,1,"span",10),t.nVh(3,F2,2,7,"span",11),t.nVh(4,X2,3,2,"span",12),t.nVh(5,B2,2,3,"span",13),t.j41(6,"div",17),t.Z7z(7,Y2,1,4,"ghs-attackmodifier-effect",18,an),t.nI1(9,"trackUUID"),t.k0s()()),2&a){const n=t.XpG(2);t.xc7("border-width",.02*n.offsetWidth+"px"),t.Y8G("ngClass",t.eq3(11,Fi,n.targetClass)),t.R7$(),t.Y8G("ngClass",t.eq3(13,Da,n.isGhsSvg(n.effect.type)))("src","./assets/images/"+(n.settingsManager.settings.fhStyle?"fh/":"")+"action/"+n.effect.type+".svg",t.B4B),t.R7$(),t.vxM(n.effect.value?2:-1),t.R7$(),t.vxM(n.targetString?3:-1),t.R7$(),t.vxM(n.targetValue?4:-1),t.R7$(),t.vxM(n.rangeValue?5:-1),t.R7$(2),t.Dyx(t.bMT(9,9,n.subEffects()))}}function N2(a,r){if(1&a&&(t.j41(0,"span",10),t.EFF(1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.JRh(+n.effect.value)}}function z2(a,r){if(1&a&&(t.j41(0,"span"),t.nrm(1,"span",14),t.k0s()),2&a){const n=t.XpG(3);t.HbH(t.VkB("target-value-container ","target-"+n.targetString.replace("game.specialTarget.",""))),t.R7$(),t.Aen(!!n.newStyle&&"fh"),t.Y8G("ghs-label",n.targetString.split(":")[0])("ghs-label-args",n.targetString.split(":").slice(1))}}function L2(a,r){if(1&a&&(t.j41(0,"span",12),t.nrm(1,"img",15),t.EFF(2),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("src","./assets/images/action/target.svg",t.B4B),t.R7$(),t.SpI(" ",n.targetValue," ")}}function q2(a,r){if(1&a&&(t.j41(0,"span",13),t.nrm(1,"span",16),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Aen(!!n.newStyle&&"fh"),t.Y8G("ghs-label",n.rangeValue)}}function H2(a,r){if(1&a&&t.nrm(0,"ghs-attackmodifier-effect",18),2&a){const n=r.$implicit,i=t.XpG(3);t.Y8G("attackModifier",i.attackModifier)("effect",n)("offsetWidth",i.offsetWidth)("newStyle",i.newStyle)}}function K2(a,r){if(1&a&&(t.j41(0,"div",26),t.nrm(1,"img",24),t.nVh(2,N2,2,1,"span",10),t.nVh(3,z2,2,7,"span",11),t.nVh(4,L2,3,2,"span",12),t.nVh(5,q2,2,3,"span",13),t.j41(6,"div",17),t.Z7z(7,H2,1,4,"ghs-attackmodifier-effect",18,an),t.nI1(9,"trackUUID"),t.k0s()()),2&a){const n=t.XpG(2);t.xc7("border-width",.02*n.offsetWidth+"px"),t.Y8G("ngClass",t.eq3(11,Fi,n.targetClass)),t.R7$(),t.Y8G("ngClass",t.eq3(13,Da,n.isGhsSvg(n.effect.type)))("src","./assets/images/"+(n.settingsManager.settings.fhStyle?"fh/":"")+"action/"+n.effect.type+".svg",t.B4B),t.R7$(),t.vxM(n.effect.value?2:-1),t.R7$(),t.vxM(n.targetString?3:-1),t.R7$(),t.vxM(n.targetValue?4:-1),t.R7$(),t.vxM(n.rangeValue?5:-1),t.R7$(2),t.Dyx(t.bMT(9,9,n.subEffects()))}}function W2(a,r){if(1&a&&t.nrm(0,"ghs-attackmodifier-effect",18),2&a){const n=r.$implicit,i=t.XpG(4);t.Y8G("attackModifier",i.attackModifier)("effect",n)("offsetWidth",i.offsetWidth)("newStyle",i.newStyle)}}function Z2(a,r){if(1&a&&(t.j41(0,"div",17),t.Z7z(1,W2,1,4,"ghs-attackmodifier-effect",18,an),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(3,0,n.effect.effects))}}function J2(a,r){if(1&a&&(t.nrm(0,"img",15),t.nVh(1,Z2,4,2,"div",17)),2&a){const n=t.XpG(2);t.Y8G("src","./assets/images/attackmodifier/target.svg",t.B4B),t.R7$(),t.vxM(n.effect.effects?1:-1)}}function Q2(a,r){if(1&a&&t.nrm(0,"ghs-attackmodifier-effect",18),2&a){const n=r.$implicit,i=t.XpG(4);t.Y8G("attackModifier",i.attackModifier)("effect",n)("offsetWidth",i.offsetWidth)("newStyle",i.newStyle)}}function tx(a,r){if(1&a&&(t.j41(0,"div",17),t.Z7z(1,Q2,1,4,"ghs-attackmodifier-effect",18,an),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(3,0,n.effect.effects))}}function nx(a,r){if(1&a&&(t.nrm(0,"ghs-action-hex",27),t.nVh(1,tx,4,2,"div",17)),2&a){const n=t.XpG(2);t.Y8G("value",n.effect.value),t.R7$(),t.vxM(n.effect.effects?1:-1)}}function ex(a,r){if(1&a&&t.nrm(0,"ghs-attackmodifier-effect",18),2&a){const n=r.$implicit,i=t.XpG(4);t.Y8G("attackModifier",i.attackModifier)("effect",n)("offsetWidth",i.offsetWidth)("newStyle",i.newStyle)}}function ax(a,r){if(1&a&&(t.j41(0,"div",17),t.Z7z(1,ex,1,4,"ghs-attackmodifier-effect",18,an),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(3,0,n.effect.effects))}}function ix(a,r){if(1&a&&(t.j41(0,"span",28),t.nrm(1,"img",29)(2,"img",30),t.k0s(),t.nVh(3,ax,4,2,"div",17)),2&a){const n=t.XpG(2);t.R7$(3),t.vxM(n.effect.effects?3:-1)}}function ox(a,r){if(1&a&&t.nrm(0,"ghs-attackmodifier-effect",18),2&a){const n=r.$implicit,i=t.XpG(4);t.Y8G("attackModifier",i.attackModifier)("effect",n)("offsetWidth",i.offsetWidth)("newStyle",i.newStyle)}}function sx(a,r){if(1&a&&(t.j41(0,"div",17),t.Z7z(1,ox,1,4,"ghs-attackmodifier-effect",18,an),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(3,0,n.effect.effects))}}function rx(a,r){if(1&a&&(t.j41(0,"div",7)(1,"span",28),t.nrm(2,"img",29)(3,"img",30),t.k0s(),t.j41(4,"span",31),t.nrm(5,"span",32),t.k0s(),t.nVh(6,sx,4,2,"div",17),t.k0s()),2&a){const n=t.XpG(2);t.R7$(5),t.Y8G("ghs-label","game.attackModifiers.effects.refreshSpentItem"),t.R7$(),t.vxM(n.effect.effects?6:-1)}}function cx(a,r){if(1&a&&t.nrm(0,"ghs-attackmodifier-effect",18),2&a){const n=r.$implicit,i=t.XpG(4);t.Y8G("attackModifier",i.attackModifier)("effect",n)("offsetWidth",i.offsetWidth)("newStyle",i.newStyle)}}function lx(a,r){if(1&a&&(t.j41(0,"div",17),t.Z7z(1,cx,1,4,"ghs-attackmodifier-effect",18,an),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(3,0,n.effect.effects))}}function gx(a,r){if(1&a&&(t.j41(0,"span",28),t.nrm(1,"img",33)(2,"img",34),t.k0s(),t.nVh(3,lx,4,2,"div",17)),2&a){const n=t.XpG(2);t.R7$(3),t.vxM(n.effect.effects?3:-1)}}function dx(a,r){if(1&a&&(t.j41(0,"span",35),t.nrm(1,"span",37),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(2,M2,!n.settingsManager.settings.fhStyle||n.townGuard))("ghs-label",n.effect.value+"")}}function hx(a,r){if(1&a&&(t.j41(0,"span",36),t.nrm(1,"img",20),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("src","./assets/images/action/custom/"+n.effect.value+".svg",t.B4B)}}function _x(a,r){if(1&a&&t.nrm(0,"ghs-attackmodifier-effect",18),2&a){const n=r.$implicit,i=t.XpG(4);t.Y8G("attackModifier",i.attackModifier)("effect",n)("offsetWidth",i.offsetWidth)("newStyle",i.newStyle)}}function mx(a,r){if(1&a&&(t.j41(0,"div",17),t.Z7z(1,_x,1,4,"ghs-attackmodifier-effect",18,an),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(3,0,n.effect.effects))}}function px(a,r){if(1&a&&(t.nVh(0,dx,2,4,"span",35),t.nVh(1,hx,2,1,"span",36),t.nVh(2,mx,4,2,"div",17)),2&a){const n=t.XpG(2);t.vxM(n.effect.icon?-1:0),t.R7$(),t.vxM(n.effect.icon?1:-1),t.R7$(),t.vxM(n.effect.effects?2:-1)}}function ux(a,r){if(1&a&&t.nrm(0,"ghs-attackmodifier-effect",18),2&a){const n=r.$implicit,i=t.XpG(3);t.Y8G("attackModifier",i.attackModifier)("effect",n)("offsetWidth",i.offsetWidth)("newStyle",i.newStyle)}}function fx(a,r){if(1&a&&(t.j41(0,"span",38),t.nrm(1,"span",32),t.k0s(),t.Z7z(2,ux,1,4,"ghs-attackmodifier-effect",18,an),t.nI1(4,"trackUUID")),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(4,v2,n.newStyle)),t.R7$(),t.Y8G("ghs-label","or"),t.R7$(),t.Dyx(t.bMT(4,2,n.effect.effects))}}function Cx(a,r){if(1&a&&t.nrm(0,"ghs-attackmodifier-effect",18),2&a){const n=r.$implicit,i=t.XpG(4);t.Y8G("attackModifier",i.attackModifier)("effect",n)("offsetWidth",i.offsetWidth)("newStyle",i.newStyle)}}function Mx(a,r){if(1&a&&(t.j41(0,"div",17),t.Z7z(1,Cx,1,4,"ghs-attackmodifier-effect",18,an),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(3,0,n.effect.effects))}}function vx(a,r){if(1&a&&(t.nrm(0,"img",39),t.nVh(1,Mx,4,2,"div",17)),2&a){const n=t.XpG(2);t.Y8G("src","./assets/images/attackmodifier/overlays/replace/"+n.effect.value+".png",t.B4B),t.R7$(),t.vxM(n.effect.effects?1:-1)}}function Ox(a,r){if(1&a&&t.nrm(0,"span",40),2&a){const n=t.XpG(3);t.Y8G("ghs-label",""+n.effect.value)}}function Px(a,r){1&a&&(t.j41(0,"span",31),t.EFF(1,"!"),t.k0s())}function bx(a,r){if(1&a&&t.nrm(0,"ghs-attackmodifier-effect",18),2&a){const n=r.$implicit,i=t.XpG(3);t.Y8G("attackModifier",i.attackModifier)("effect",n)("offsetWidth",i.offsetWidth)("newStyle",i.newStyle)}}function kx(a,r){if(1&a&&(t.j41(0,"span",8),t.nVh(1,Ox,1,1,"span",40),t.nVh(2,Px,2,0,"span",31),t.j41(3,"div",17),t.Z7z(4,bx,1,4,"ghs-attackmodifier-effect",18,an),t.nI1(6,"trackUUID"),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(),t.vxM(n.effect.value?1:-1),t.R7$(),t.vxM(n.effect.value?-1:2),t.R7$(2),t.Dyx(t.bMT(6,2,n.effect.effects))}}function yx(a,r){if(1&a&&(t.j41(0,"span",10),t.EFF(1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.JRh(+n.effect.value)}}function xx(a,r){if(1&a&&(t.nrm(0,"img",9),t.nVh(1,yx,2,1,"span",10)),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(3,Da,n.isGhsSvg(n.effect.type)))("src","./assets/images/"+(n.settingsManager.settings.fhStyle?"fh/":"")+"action/"+n.effect.type+".svg",t.B4B),t.R7$(),t.vxM(n.effect.value?1:-1)}}function Ex(a,r){if(1&a&&(t.j41(0,"span",1)(1,"span",2),t.nVh(2,y2,5,8)(3,E2,4,6)(4,w2,5,2,"span",3)(5,j2,7,3)(6,A2,13,17,"div",4)(7,U2,10,15,"div",5)(8,K2,10,15,"div",6)(9,J2,2,2)(10,nx,2,2)(11,ix,4,1)(12,rx,7,2,"div",7)(13,gx,4,1)(14,px,3,3)(15,fx,5,6)(16,vx,2,2)(17,kx,7,4,"span",8)(18,xx,2,5),t.k0s()()),2&a){let n;const i=t.XpG();t.HbH(t.VkB("effect-wrapper ",i.effect.type)),t.Y8G("ngClass",t.sMw(5,p2,i.settingsManager.settings.fhStyle,i.newStyle,i.townGuard)),t.R7$(2),t.vxM((n=i.effect.type)===i.AttackModifierEffectType.condition?2:n===i.AttackModifierEffectType.element?3:n===i.AttackModifierEffectType.elementHalf?4:n===i.AttackModifierEffectType.elementConsume?5:n===i.AttackModifierEffectType.heal?6:n===i.AttackModifierEffectType.shield?7:n===i.AttackModifierEffectType.retaliate?8:n===i.AttackModifierEffectType.target?9:n===i.AttackModifierEffectType.area?10:n===i.AttackModifierEffectType.refreshItem?11:n===i.AttackModifierEffectType.refreshSpentItem?12:n===i.AttackModifierEffectType.recoverRandomDiscard?13:n===i.AttackModifierEffectType.custom?14:n===i.AttackModifierEffectType.or?15:n===i.AttackModifierEffectType.changeType?16:n===i.AttackModifierEffectType.required?17:18)}}let wx=(()=>{class a{elementRef;ghsManager;offsetWidth;attackModifier;effect;newStyle=!1;townGuard=!1;length=1;targetValue=0;targetString="";rangeValue="";targetClass=!1;settingsManager=p.f;AttackModifierType=w.Yn;AttackModifierEffectType=w.hY;invertIcons=[w.hY.attack,w.hY.heal,w.hY.range,w.hY.retaliate,w.hY.shield,w.hY.target];constructor(n,i){this.elementRef=n,this.ghsManager=i}ngOnInit(){this.update(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.update()})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.elementRef.nativeElement.style.fontSize=.2*this.elementRef.nativeElement.offsetWidth+"px",this.targetValue=0,this.targetString="";const n=this.getTarget();"string"==typeof n?this.targetString=n:this.targetValue=n,this.rangeValue=this.getRange(),this.targetClass=!!this.targetString||!!this.targetValue||!!this.rangeValue}getTarget(){if(this.effect.effects){const n=this.effect.effects.find(o=>o.type==w.hY.specialTarget);if(n)return"game.specialTarget."+n.value;const i=this.effect.effects.find(o=>o.type==w.hY.target);if(i)return i.value;const e=this.effect.effects.find(o=>o.type==w.hY.custom);if(e)return e.value}return""}getRange(){if(this.effect.effects){const n=this.effect.effects.find(i=>i.type==w.hY.range);if(n)return"%game.action.range:"+n.value+"%"}return""}subEffects(){return this.effect.effects&&this.effect.effects.filter(n=>n.type!=w.hY.specialTarget&&n.type!=w.hY.target&&n.type!=w.hY.range&&n.type!=w.hY.custom)||[]}isGhsSvg(n){return this.invertIcons.includes(n)}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-attackmodifier-effect"]],inputs:{offsetWidth:"offsetWidth",attackModifier:"attackModifier",effect:"effect",newStyle:"newStyle",townGuard:"townGuard",length:"length"},standalone:!1,decls:1,vars:1,consts:[[3,"class","ngClass"],[3,"ngClass"],[1,"effect"],[1,"element-half-container"],[1,"effect-container","heal-container",3,"border-width","ngClass"],[1,"effect-container","shield-container",3,"border-width","ngClass"],[1,"effect-container","retaliate-container",3,"border-width","ngClass"],[1,"card-action-container"],[1,"required-container"],[1,"full",3,"ngClass","src"],[1,"value"],[3,"class"],[1,"target-value-container"],[1,"target-value-container","range"],[1,"target-value","text-white",3,"ghs-label","ghs-label-args"],[1,"full",3,"src"],[1,"target-value","text-white",3,"ghs-label"],[1,"sub-effects"],[3,"attackModifier","effect","offsetWidth","newStyle"],[1,"element-half"],[3,"src"],[1,"element","consume"],[1,"divider"],[1,"effect-container","heal-container",3,"ngClass"],[3,"ngClass","src"],[1,"effect-container","shield-container",3,"ngClass"],[1,"effect-container","retaliate-container",3,"ngClass"],[3,"value"],[1,"card-action"],["src","./assets/images/action/card/refresh.svg",1,"ghs-svg"],["src","./assets/images/action/card/overlay/refresh.svg",1,"overlay"],[1,"label"],[3,"ghs-label"],["src","./assets/images/action/card/recover.svg",1,"ghs-svg"],["src","./assets/images/action/card/overlay/recover.svg",1,"overlay"],[1,"custom-value-container"],[1,"effect-icon"],[1,"custom-value",3,"ngClass","ghs-label"],[1,"or-label",3,"ngClass"],[1,"overlay",3,"src"],[1,"label",3,"ghs-label"]],template:function(i,e){1&i&&t.nVh(0,Ex,19,9,"span",0),2&i&&t.vxM(e.effect?0:-1)},dependencies:[N.YU,Ga,a,it,Me,ct],styles:['.effect-wrapper[_ngcontent-%COMP%]{position:relative;display:block;width:100%;padding-bottom:100%}.effect-wrapper[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center}.effect-wrapper[_ngcontent-%COMP%]:nth-child(2){top:5%}.effect-wrapper[_ngcontent-%COMP%]   img.full[_ngcontent-%COMP%]{position:relative;width:100%;height:auto}.effect-wrapper[_ngcontent-%COMP%]   img.full.target[_ngcontent-%COMP%]{top:-20%;width:65%}.effect-wrapper[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.effect-wrapper[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{position:absolute;top:35%;left:50%;transform:translate(-50%);font-family:var(--ghs-font-title);font-size:1em;color:var(--ghs-color-white)}.effect-wrapper.condition[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%], .effect-wrapper.pierce[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%], .effect-wrapper.push[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%], .effect-wrapper.pull[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]{top:4%;left:4%;width:92%;height:92%}.effect-wrapper.condition[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{top:55%}.effect-wrapper[_ngcontent-%COMP%]   .target-value-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;position:absolute;width:100%;height:40%;bottom:0;font-family:var(--ghs-font-title);font-size:.6em;line-height:.8em;color:var(--ghs-color-white);left:50%;transform:translate(-50%)}.effect-wrapper[_ngcontent-%COMP%]   .target-value-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:relative!important;left:initial!important;top:initial!important;width:20%!important;filter:var(--ghs-filter-white)}.effect-wrapper[_ngcontent-%COMP%]   .target-value-container[_ngcontent-%COMP%]   .target-value[_ngcontent-%COMP%]{display:inline;text-align:center}.effect-wrapper.fh[_ngcontent-%COMP%]   .target-value-container[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:.7em}.effect-wrapper.fh[_ngcontent-%COMP%]   .target-value-container.target-self[_ngcontent-%COMP%], .effect-wrapper.fh[_ngcontent-%COMP%]   .target-value-container.target-allyShort[_ngcontent-%COMP%]{font-size:1.3em}.effect-wrapper[_ngcontent-%COMP%]   .effect-container[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;border:1px solid var(--ghs-color-white);border-radius:100%}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.target[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{top:8%;width:40%}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.target[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{top:22%;font-size:1.4em}.effect-wrapper[_ngcontent-%COMP%]   .effect-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:10%;left:50%;transform:translate(-50%);width:50%;height:auto}.effect-wrapper[_ngcontent-%COMP%]   .effect-container[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{position:absolute;top:35%;left:50%;transform:translate(-50%);font-family:var(--ghs-font-gh-title);font-size:.6em;color:var(--ghs-color-black)}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.heal-container[_ngcontent-%COMP%]{background-color:#a11f1a}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.heal-container[_ngcontent-%COMP%]   .sub-effects[_ngcontent-%COMP%]{display:none}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.heal-container.sub-effects[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .effect-wrapper[_ngcontent-%COMP%]   .effect-container.heal-container.sub-effects[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{left:35%}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.heal-container.sub-effects[_ngcontent-%COMP%]   .sub-effects[_ngcontent-%COMP%]{display:block;position:absolute;top:15%;left:40%;width:100%;height:100%}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.heal-container.sub-effects[_ngcontent-%COMP%]   .sub-effects[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{position:absolute;top:10%;left:10%;color:var(--ghs-color-white);margin-left:5%;margin-right:3%;font-size:1.5em}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.heal-container.sub-effects[_ngcontent-%COMP%]   .sub-effects[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]{top:0;left:0;width:100%;height:100%;transform:none}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.shield-container[_ngcontent-%COMP%]{background-color:#6e4e34}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.shield-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{top:10%;width:80%}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.shield-container[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:1.5em;top:35%}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.shield-container.target[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{top:15%;width:48%}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.shield-container.target[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{top:17%;font-size:1.3em}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.retaliate-container[_ngcontent-%COMP%]{background-color:#384c5a;position:relative}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.retaliate-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50%;left:42%;top:20%}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.retaliate-container[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--ghs-color-white);font-size:1.5em;top:25%;left:80%}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.retaliate-container.target[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{top:15%;width:48%}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.retaliate-container.target[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{top:17%;font-size:1.3em}.effect-wrapper[_ngcontent-%COMP%]   .card-action-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.effect-wrapper[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%]{position:relative;width:80%}.effect-wrapper[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:relative;top:0;left:0;width:100%;height:auto}.effect-wrapper[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%]   img.overlay[_ngcontent-%COMP%]{position:absolute;width:100%;height:auto}.effect-wrapper[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:var(--ghs-color-white);text-transform:uppercase}.effect-wrapper[_ngcontent-%COMP%]   .custom-value-container[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-normal);width:98%}.effect-wrapper[_ngcontent-%COMP%]   .custom-value-container[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%]{display:block;text-align:center;font-size:.8em;line-height:.8em;white-space:break-spaces}.effect-wrapper.elementConsume[_ngcontent-%COMP%]   .element.consume[_ngcontent-%COMP%]{width:50%;height:auto;display:flex}.effect-wrapper.elementConsume[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{margin-left:5%;margin-right:3%}.effect-wrapper.elementConsume[_ngcontent-%COMP%]   .sub-effects[_ngcontent-%COMP%]{width:50%}.effect-wrapper.elementConsume[_ngcontent-%COMP%]   .sub-effects[_ngcontent-%COMP%]   ghs-attackmodifier-effect[_ngcontent-%COMP%]{position:relative;display:block;width:100%}.effect-wrapper.elementConsume[_ngcontent-%COMP%]   .sub-effects[_ngcontent-%COMP%]   ghs-attackmodifier-effect[_ngcontent-%COMP%]   .effect.center.element[_ngcontent-%COMP%]{width:100%;height:auto;display:flex}.effect-wrapper[_ngcontent-%COMP%]   .effect-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.effect-wrapper.pull[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .effect-wrapper.push[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{top:60%}.effect-wrapper.pierce[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{left:30%;background-color:#c6833f}.effect-wrapper.pierce.fh[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{background-color:#c88c4e;font-size:1.2em;left:25%;font-family:var(--ghs-font-gh-title);top:32%}.effect-wrapper.push.fh[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);top:12%;color:#4f504f}.effect-wrapper.pull.fh[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);top:40%;color:#4f504f}.effect-wrapper.loot[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60%;height:auto;filter:var(--ghs-filter-white)}.effect-wrapper.loot[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--ghs-color-black)}.effect-wrapper.attack[_ngcontent-%COMP%]   .full[_ngcontent-%COMP%], .effect-wrapper.range[_ngcontent-%COMP%]   .full[_ngcontent-%COMP%]{width:80%}.effect-wrapper.attack[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .effect-wrapper.range[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{top:0;left:105%;font-size:4.2em}.effect-wrapper[_ngcontent-%COMP%]   .element-background[_ngcontent-%COMP%]{position:absolute;inset:0;background-image:url(am-front.48806d22feb6f4bf.png);background-size:100%}.effect-wrapper.or[_ngcontent-%COMP%]{width:100%;height:100%}.effect-wrapper.or[_ngcontent-%COMP%]   .or-label[_ngcontent-%COMP%]{font-size:.8em;color:var(--ghs-color-white);position:relative}.effect-wrapper.or[_ngcontent-%COMP%]   .or-label.new-style[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:-1em -1.25em 1em .75em;color:var(--ghs-color-white);background-color:var(--ghs-color-white);clip-path:polygon(100% 0%,95% 0%,0% 95%,0% 100%,5% 100%,100% 5%)}.effect-wrapper.or[_ngcontent-%COMP%]   .or-label.new-style[_ngcontent-%COMP%]:after{content:" ";position:absolute;inset:1em .75em -1em -1.25em;color:var(--ghs-color-white);background-color:var(--ghs-color-white);clip-path:polygon(100% 0%,95% 0%,0% 95%,0% 100%,5% 100%,100% 5%)}.effect-wrapper.or[_ngcontent-%COMP%]   ghs-attackmodifier-effect[_ngcontent-%COMP%]{position:absolute;inset:0}.effect-wrapper.or[_ngcontent-%COMP%]   ghs-attackmodifier-effect[_ngcontent-%COMP%]:nth-child(2){transform:translate(-18%,-18%) scale(.5)}.effect-wrapper.or[_ngcontent-%COMP%]   ghs-attackmodifier-effect[_ngcontent-%COMP%]:nth-child(3){transform:translate(18%,18%) scale(.5)}.effect-wrapper.required[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]{width:100%;height:50%;position:relative;display:flex;margin-bottom:.5em}.effect-wrapper.required[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{position:relative;top:.1em;display:flex;justify-content:center;align-items:center;padding:.3em;border-right:.1em solid var(--ghs-color-white)}.effect-wrapper.required[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .sub-effects[_ngcontent-%COMP%]{position:relative;display:flex;flex-grow:1;justify-content:flex-start;align-items:center;padding:.2em}.effect-wrapper.required[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .sub-effects[_ngcontent-%COMP%]   ghs-attackmodifier-effect[_ngcontent-%COMP%]{display:block;width:45%;margin-right:5%}.effect-wrapper.required[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]:before{content:" ";display:block;position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--ghs-color-black);opacity:.5;z-index:0;border:.1em solid var(--ghs-color-white);border-radius:.5em}.effect-wrapper.custom[_ngcontent-%COMP%]   .sub-effects[_ngcontent-%COMP%]{position:absolute;top:75%;width:20%}.effect-wrapper.changeType[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{width:273%;height:183%;z-index:1}.effect-wrapper.changeType[_ngcontent-%COMP%]   .sub-effects[_ngcontent-%COMP%]{position:absolute;top:25%;width:100%;z-index:2}.effect-wrapper.town-guard.custom[_ngcontent-%COMP%]   .custom-value-container[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);font-size:2.3em;text-shadow:var(--ghs-outline-thin)}']})}return a})();const Rx=a=>({"town-guard":a}),jx=(a,r)=>({flipped:a,"no-animations":r}),be=(a,r)=>({"new-style":a,fh:r}),Ns=(a,r,n,i,e)=>({"new-style":a,fh:r,"multiple-2":n,"multiple-3":i,"multiple-4":e}),Xi=a=>({side:a}),zs=(a,r,n,i,e)=>({center:a,multiple:r,"multiple-2":n,"multiple-3":i,"multiple-4":e}),Gx=a=>({character:a}),Ls=a=>({effects:a}),ke=(a,r)=>r._trackUUID;function Tx(a,r){if(1&a&&(t.j41(0,"div",2),t.nrm(1,"img",26),t.k0s()),2&a){const n=t.XpG(3);t.HbH(t.VkB("type ",n.effectClasses)),t.Y8G("ngClass",t.l_i(5,be,n.newStyle,n.settingsManager.settings.fhStyle)),t.R7$(),t.Y8G("src","./assets/images/attackmodifier/"+(!n.defaultType||n.townGuard||n.csOak||n.imbue||n.newStyle&&n.attackModifier.valueType==n.AttackModifierValueType.plus&&n.attackModifier.effects&&0!=n.attackModifier.effects.length?"am-front":n.attackModifier.type)+".png",t.B4B)}}function Sx(a,r){if(1&a&&t.nrm(0,"div",2),2&a){const n=r.$implicit,i=t.XpG(4);t.HbH(t.ai1("type multiple ",n.type," ",n.value)),t.Y8G("ngClass",t.s1E(5,Ns,i.newStyle,i.settingsManager.settings.fhStyle,2==i.attackModifier.effects.length,3==i.attackModifier.effects.length,4==i.attackModifier.effects.length))}}function Dx(a,r){if(1&a&&(t.Z7z(0,Sx,1,11,"div",1,ke),t.nI1(2,"trackUUID")),2&a){const n=t.XpG(3);t.Dyx(t.bMT(2,0,n.attackModifier.effects))}}function $x(a,r){if(1&a&&t.nrm(0,"div",2),2&a){const n=t.XpG().$implicit,i=t.XpG(4);t.HbH(t.ai1("type multiple multiple-mixed-element ",n.type," ",n.value)),t.Y8G("ngClass",t.l_i(5,be,i.newStyle,i.settingsManager.settings.fhStyle))}}function Ix(a,r){if(1&a&&t.nVh(0,$x,1,8,"div",1),2&a){const n=r.$implicit,i=t.XpG(4);t.vxM(i.filter(n)?0:-1)}}function Ax(a,r){if(1&a&&t.nrm(0,"div",2),2&a){const n=r.$implicit,i=t.XpG(5);t.HbH(t.ai1("type multiple  multiple-mixed-element multiple-mixed-element-or ",n.type," ",n.value)),t.Y8G("ngClass",t.l_i(5,be,i.newStyle,i.settingsManager.settings.fhStyle))}}function Vx(a,r){if(1&a&&(t.Z7z(0,Ax,1,8,"div",1,ke),t.nI1(2,"trackUUID")),2&a){const n=t.XpG(4);t.Dyx(t.bMT(2,0,n.orTypeEffect.effects))}}function Fx(a,r){if(1&a&&(t.nrm(0,"div",2),t.Z7z(1,Ix,1,1,null,null,ke),t.nI1(3,"trackUUID"),t.nVh(4,Vx,3,2)),2&a){const n=t.XpG(3);t.HbH(t.VkB("type multiple multiple-mixed-element ",n.mixedElement.value)),t.Y8G("ngClass",t.l_i(7,be,n.newStyle,n.settingsManager.settings.fhStyle)),t.R7$(),t.Dyx(t.bMT(3,5,n.effects)),t.R7$(3),t.vxM(n.orTypeEffect&&n.orTypeEffect.effects.length>1?4:-1)}}function Xx(a,r){if(1&a&&t.nrm(0,"div",2),2&a){const n=r.$implicit,i=t.XpG(4);t.HbH(t.ai1("type multiple ",n.type," ",n.value)),t.Y8G("ngClass",t.s1E(5,Ns,i.newStyle,i.settingsManager.settings.fhStyle,2==i.orTypeEffect.effects.length,3==i.orTypeEffect.effects.length,4==i.orTypeEffect.effects.length))}}function Bx(a,r){if(1&a&&(t.Z7z(0,Xx,1,11,"div",1,ke),t.nI1(2,"trackUUID")),2&a){const n=t.XpG(3);t.Dyx(t.bMT(2,0,n.orTypeEffect.effects))}}function Yx(a,r){if(1&a&&t.nrm(0,"div",2),2&a){const n=r.$implicit,i=t.XpG(4);t.HbH(t.VkB("type multiple multiple-1 ",n)),t.Y8G("ngClass",t.l_i(4,be,i.newStyle,i.settingsManager.settings.fhStyle))}}function Ux(a,r){if(1&a&&t.Z7z(0,Yx,1,7,"div",1,t.fX1),2&a){const n=t.XpG(3);t.Dyx(n.attackModifier.effects[0].value.split("|"))}}function Nx(a,r){1&a&&t.nrm(0,"div",27)(1,"div",28)(2,"div",29)(3,"div",30)(4,"div",31)(5,"div",32)}function zx(a,r){1&a&&(t.j41(0,"div",8),t.nrm(1,"img",33),t.k0s())}function Lx(a,r){if(1&a&&(t.j41(0,"div",9),t.nrm(1,"img",26),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("src","./assets/images/attackmodifier/"+n.attackModifier.valueType+n.attackModifier.value+".png",t.B4B)}}function qx(a,r){1&a&&(t.j41(0,"div",10),t.nrm(1,"img",34),t.k0s())}function Hx(a,r){1&a&&(t.j41(0,"div",11),t.nrm(1,"img",35),t.k0s())}function Kx(a,r){if(1&a&&t.nrm(0,"img",14),2&a){const n=t.XpG(3);t.Y8G("ngClass",t.eq3(2,Xi,n.newStyle))("src","./assets/images/attackmodifier/"+(n.newStyle?"icons/":"overlays/")+n.attackModifier.type+".png",t.B4B)}}function Wx(a,r){if(1&a&&t.nrm(0,"img",15),2&a){const n=t.XpG(3);t.Y8G("src","./assets/images/attackmodifier/"+(n.newStyle?"icons/":"overlays/")+n.attackModifier.valueType+n.attackModifier.value+".png",t.B4B)}}function Zx(a,r){1&a&&t.nrm(0,"img",16)}function Jx(a,r){if(1&a&&(t.j41(0,"span",17),t.EFF(1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.JRh(n.numeration)}}function Qx(a,r){1&a&&(t.j41(0,"span",18),t.EFF(1," * "),t.k0s())}function t3(a,r){if(1&a&&(t.j41(0,"span",19),t.EFF(1),t.k0s()),2&a){const n=t.XpG(3);t.Y8G("ngClass",t.eq3(2,Xi,n.newStyle&&n.attackModifier.effects&&n.attackModifier.effects.length>0)),t.R7$(),t.SpI("+",n.attackModifier.value)}}function n3(a,r){if(1&a&&(t.j41(0,"span",19),t.EFF(1),t.k0s()),2&a){const n=t.XpG(3);t.Y8G("ngClass",t.eq3(2,Xi,n.newStyle&&n.attackModifier.effects&&n.attackModifier.effects.length>0)),t.R7$(),t.SpI("-",n.attackModifier.value)}}function e3(a,r){if(1&a&&(t.j41(0,"span",20),t.nrm(1,"img",26),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("src",n.characterIcon,t.B4B)}}function a3(a,r){if(1&a&&(t.j41(0,"span",21),t.nrm(1,"img",26),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("src","./assets/images/attackmodifier/imbuement/"+n.attackModifier.type+".svg",t.B4B)}}function i3(a,r){if(1&a&&t.nrm(0,"ghs-attackmodifier-effect",36),2&a){const n=r.$implicit;t.XpG(3);const i=t.sdS(2),e=t.XpG();t.Y8G("attackModifier",e.attackModifier)("effect",n)("offsetWidth",i.offsetWidth)("newStyle",e.newStyle)("length",e.effects.length)}}function o3(a,r){if(1&a&&(t.j41(0,"div",22),t.Z7z(1,i3,1,5,"ghs-attackmodifier-effect",36,ke),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.Y8G("ngClass",t.s1E(3,zs,n.attackModifier.type==n.AttackModifierType.plus0||n.newStyle,n.effects.length>1,2==n.effects.length,3==n.effects.length,4==n.effects.length)),t.R7$(),t.Dyx(t.bMT(3,1,n.effects))}}function s3(a,r){if(1&a&&(t.j41(0,"div",23),t.nrm(1,"ghs-attackmodifier-effect",37),t.k0s()),2&a){t.XpG(2);const n=t.sdS(2),i=t.XpG();t.R7$(),t.Y8G("attackModifier",i.attackModifier)("effect",i.mixedElement)("offsetWidth",n.offsetWidth)("newStyle",i.newStyle)}}function r3(a,r){if(1&a&&(t.j41(0,"div",24),t.nrm(1,"img",26),t.k0s()),2&a){const n=t.XpG(3);t.Y8G("ngClass",t.eq3(2,Gx,n.characterIcon)),t.R7$(),t.Y8G("src","./assets/images/bb/attackmodifier/"+n.bbIndex+".svg",t.B4B)}}function c3(a,r){1&a&&(t.j41(0,"span",25),t.nrm(1,"img",38),t.k0s())}function l3(a,r){if(1&a&&(t.nVh(0,Tx,2,8,"div",1),t.nVh(1,Dx,3,2),t.nVh(2,Fx,5,10),t.nVh(3,Bx,3,2),t.nVh(4,Ux,2,0),t.nVh(5,Nx,6,0),t.nVh(6,zx,2,0,"div",8),t.nVh(7,Lx,2,1,"div",9),t.nVh(8,qx,2,0,"div",10),t.nVh(9,Hx,2,0,"div",11),t.nrm(10,"img",12)(11,"img",13),t.nVh(12,Kx,1,4,"img",14),t.nVh(13,Wx,1,1,"img",15),t.nVh(14,Zx,1,0,"img",16),t.nVh(15,Jx,2,1,"span",17),t.nVh(16,Qx,2,0,"span",18),t.nVh(17,t3,2,4,"span",19),t.nVh(18,n3,2,4,"span",19),t.nVh(19,e3,2,1,"span",20),t.nVh(20,a3,2,1,"span",21),t.nVh(21,o3,4,9,"div",22),t.nVh(22,s3,2,4,"div",23),t.nVh(23,r3,2,4,"div",24),t.nVh(24,c3,2,0,"span",25)),2&a){const n=t.XpG(2);t.vxM(!n.mixedElement&&!n.multipe||n.wildElement?0:-1),t.R7$(),t.vxM(n.multipe&&n.attackModifier.effects.length>1?1:-1),t.R7$(),t.vxM(n.mixedElement&&n.effects.length>0?2:-1),t.R7$(),t.vxM(!n.mixedElement&&n.orTypeEffect&&n.orTypeEffect.effects.length>1?3:-1),t.R7$(),t.vxM(n.multipe&&1==n.attackModifier.effects.length?4:-1),t.R7$(),t.vxM(n.wildElement?5:-1),t.R7$(),t.vxM(n.csOak?6:-1),t.R7$(),t.vxM(!n.imbue||n.attackModifier.effects&&0!=n.attackModifier.effects.length?-1:7),t.R7$(),t.vxM(n.attackModifier.type==n.AttackModifierType.empower?8:-1),t.R7$(),t.vxM(n.attackModifier.type==n.AttackModifierType.enfeeble?9:-1),t.R7$(3),t.vxM(n.attackModifier.effects&&n.attackModifier.effects.length>0&&(n.attackModifier.type!=n.AttackModifierType.plus0&&n.attackModifier.type!=n.AttackModifierType.plus&&n.attackModifier.type!=n.AttackModifierType.minus||n.newStyle)&&n.attackModifier.type!=n.AttackModifierType.empower&&n.attackModifier.type!=n.AttackModifierType.enfeeble&&n.attackModifier.type!=n.AttackModifierType.imbue&&n.attackModifier.type!=n.AttackModifierType.advancedImbue?12:-1),t.R7$(),t.vxM(n.attackModifier.type==n.AttackModifierType.empower||n.attackModifier.type==n.AttackModifierType.enfeeble||(n.attackModifier.type==n.AttackModifierType.imbue||n.attackModifier.type==n.AttackModifierType.advancedImbue)&&n.attackModifier.effects&&n.attackModifier.effects.length?13:-1),t.R7$(),t.vxM(n.attackModifier.rolling?14:-1),t.R7$(),t.vxM((n.characterIcon||n.ally)&&(n.attackModifier.character||n.attackModifier.type==n.AttackModifierType.curse)||n.attackModifier.type==n.AttackModifierType.bless||n.csOak||n.imbue||n.attackModifier.type==n.AttackModifierType.minus1extra?-1:15),t.R7$(),t.vxM((n.characterIcon||n.ally)&&n.attackModifier.type==n.AttackModifierType.curse||n.attackModifier.type==n.AttackModifierType.minus1extra?16:-1),t.R7$(),t.vxM(n.attackModifier.type==n.AttackModifierType.plus?17:-1),t.R7$(),t.vxM(n.attackModifier.type==n.AttackModifierType.minus?18:-1),t.R7$(),t.vxM(n.characterIcon&&n.attackModifier.character?19:-1),t.R7$(),t.vxM(n.imbue?20:-1),t.R7$(),t.vxM(n.attackModifier.effects?21:-1),t.R7$(),t.vxM(n.mixedElement?22:-1),t.R7$(),t.vxM(n.bbIndex>-1&&n.bbIndex<3?23:-1),t.R7$(),t.vxM(n.attackModifier.shuffle?24:-1)}}function g3(a,r){if(1&a&&(t.j41(0,"span",19),t.EFF(1),t.k0s()),2&a){const n=t.XpG(4);t.Y8G("ngClass",t.eq3(2,Ls,!n.townGuardEffectIcon&&n.attackModifier.effects.length>0||n.townGuardEffectIcon&&n.attackModifier.effects.length>1)),t.R7$(),t.SpI("+",n.attackModifier.value)}}function d3(a,r){if(1&a&&(t.j41(0,"span",19),t.EFF(1),t.k0s()),2&a){const n=t.XpG(4);t.Y8G("ngClass",t.eq3(2,Ls,n.attackModifier.effects.length>0)),t.R7$(),t.SpI("-",n.attackModifier.value)}}function h3(a,r){if(1&a&&(t.nVh(0,g3,2,4,"span",19),t.nVh(1,d3,2,4,"span",19)),2&a){const n=t.XpG(3);t.vxM(!(n.attackModifier.value>0||0==n.attackModifier.effects.length)||n.attackModifier.valueType!=n.AttackModifierValueType.plus&&n.attackModifier.valueType!=n.AttackModifierValueType.default?-1:0),t.R7$(),t.vxM(n.attackModifier.valueType==n.AttackModifierValueType.minus?1:-1)}}function _3(a,r){if(1&a&&(t.j41(0,"span",40),t.nrm(1,"img",26),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("src","./assets/images/action/custom/"+n.townGuardEffectIcon.value+".svg",t.B4B)}}function m3(a,r){if(1&a&&t.nrm(0,"ghs-attackmodifier-effect",42),2&a){const n=r.$implicit;t.XpG(3);const i=t.sdS(2),e=t.XpG();t.Y8G("attackModifier",e.attackModifier)("effect",n)("offsetWidth",i.offsetWidth)("townGuard",!0)("length",e.effects.length)}}function p3(a,r){if(1&a&&(t.j41(0,"div",41),t.Z7z(1,m3,1,5,"ghs-attackmodifier-effect",42,ke),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.Y8G("ngClass",t.s1E(3,zs,0==n.attackModifier.value,n.effects.length>1,2==n.effects.length,3==n.effects.length,4==n.effects.length)),t.R7$(),t.Dyx(t.bMT(3,1,n.effects))}}function u3(a,r){1&a&&t.nrm(0,"img",16)}function f3(a,r){if(1&a&&(t.j41(0,"div",39),t.nrm(1,"img",26),t.k0s(),t.nVh(2,h3,2,2),t.nVh(3,_3,2,1,"span",40),t.nVh(4,p3,4,9,"div",41),t.nVh(5,u3,1,0,"img",16)),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.l_i(6,be,n.newStyle,n.settingsManager.settings.fhStyle)),t.R7$(),t.Y8G("src","./assets/images/attackmodifier/town-guard/"+(n.attackModifier.type==n.AttackModifierType.townguard?n.attackModifier.valueType:n.attackModifier.type)+".png",t.B4B),t.R7$(),t.vxM(n.attackModifier.type==n.AttackModifierType.townguard?2:-1),t.R7$(),t.vxM(n.townGuardEffectIcon?3:-1),t.R7$(),t.vxM(n.attackModifier.effects?4:-1),t.R7$(),t.vxM(n.attackModifier.rolling?5:-1)}}function C3(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",2)(1,"div",3,0),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.onChange(e))}),t.j41(3,"div",4)(4,"span",5),t.nrm(5,"span",6),t.k0s()(),t.j41(6,"div",7),t.nVh(7,l3,25,23),t.nVh(8,f3,6,9),t.k0s()()()}if(2&a){const n=t.XpG();t.HbH(t.VkB("attack-modifier ",n.attackModifier.type)),t.Y8G("ngClass",t.eq3(9,Rx,n.townGuard)),t.R7$(),t.Y8G("ngClass",t.l_i(11,jx,n.flipped||n.attackModifier.revealed,!n.animate))("disabled",!n.reveal),t.R7$(4),t.Y8G("ghs-label","game.cards.confirmReveal"),t.R7$(2),t.vxM(n.townGuard?-1:7),t.R7$(),t.vxM(n.townGuard?8:-1)}}let We=(()=>{class a{elementRef;ghsManager;attackModifier;characterIcon;ally=!1;numeration="";number=0;reveal=!1;disableFlip=!1;flipped=!1;newStyle=!1;townGuard=!1;bbIndex=-1;effectClasses="";AttackModifierType=w.Yn;AttackModifierValueType=w.tW;AttackModifierEffectType=w.hY;effects=[];defaultType=!0;animate=!0;multipe=!1;wildElement=!1;csOak=!1;imbue=!1;mixedElement;orTypeEffect;townGuardEffectIcon;settingsManager=p.f;constructor(n,i){this.elementRef=n,this.ghsManager=i}ngOnInit(){this.animate=!this.disableFlip,this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.adjustFontSize()}),this.init()}ngAfterViewInit(){this.adjustFontSize()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}adjustFontSize(){this.elementRef.nativeElement.style.fontSize=.08*this.elementRef.nativeElement.offsetWidth+"px"}init(){this.attackModifier&&(this.csOak=this.attackModifier.id&&this.attackModifier.id.startsWith("cs-oak")||!1,this.imbue=this.attackModifier.type==w.Yn.imbue||this.attackModifier.type==w.Yn.advancedImbue,this.newStyle=this.newStyle||this.attackModifier.type==w.Yn.empower||this.attackModifier.type==w.Yn.enfeeble||this.imbue,this.multipe=!1,this.wildElement=!1,this.mixedElement=void 0,this.orTypeEffect=void 0,!this.characterIcon&&this.attackModifier.character&&this.attackModifier.id.startsWith("challenge-fh-1503-")&&(this.characterIcon=s.E.characterManager.characterIcon(this.attackModifier.id.replace("challenge-fh-1503-","").split("-")[0])),this.attackModifier.effects&&(this.attackModifier.effects.find(n=>n.type==w.hY.element)&&this.attackModifier.effects.some(n=>n.type!=w.hY.element)&&(this.mixedElement=this.attackModifier.effects.find(n=>n.type==w.hY.element)),this.townGuard&&(this.townGuardEffectIcon=this.attackModifier.effects.find(n=>n.type==w.hY.custom&&n.icon)),this.effects=(this.mixedElement?this.attackModifier.effects.filter(n=>n!=this.mixedElement):this.attackModifier.effects).filter(n=>!this.townGuard||n.type!=w.hY.custom||!n.icon),this.multipe=this.effects.length>1&&this.effects.every(n=>n.type==w.hY.element)||this.effects.length>1&&this.effects.every(n=>n.type==w.hY.condition||n.type==w.hY.pierce||n.type==w.hY.pull||n.type==w.hY.push)||1==this.effects.length&&this.effects.every(n=>n.type==w.hY.elementHalf)||!1,this.wildElement=1==this.effects.length&&this.effects.every(n=>(n.type==w.hY.element||n.type==w.hY.elementConsume)&&"wild"==n.value),this.orTypeEffect=this.effects.find(n=>n.type==w.hY.or),this.effects.forEach(n=>{n.type!=w.hY.heal&&n.type!=w.hY.shield&&(this.defaultType=!1),this.effectClasses+=n.type==w.hY.condition||n.type==w.hY.element||n.type==w.hY.elementHalf?" "+n.value.replaceAll("|","-").replaceAll(":","-"):" "+n.type})))}onChange(n){this.attackModifier.revealed=n}ngOnChanges(n){const i=n.flipped;i&&!this.disableFlip&&i.currentValue&&i.currentValue!=i.previousValue&&(this.animate=!0);const e=n.attackModifier;e&&e.currentValue&&e.currentValue!=e.previousValue&&this.init()}getTarget(n){if(n.effects){const i=n.effects.find(e=>e.type==w.hY.specialTarget);if(i)return""+i.value}return""}filter(n){return[w.hY.element,w.hY.elementConsume,w.hY.elementHalf,w.hY.condition,w.hY.custom,w.hY.pull,,w.hY.push,w.hY.pierce].includes(n.type)}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-attackmodifier"]],inputs:{attackModifier:"attackModifier",characterIcon:"characterIcon",ally:"ally",numeration:"numeration",number:"number",reveal:"reveal",disableFlip:"disableFlip",flipped:"flipped",newStyle:"newStyle",townGuard:"townGuard",bbIndex:"bbIndex"},standalone:!1,features:[t.OA$],decls:1,vars:1,consts:[["card",""],[3,"class","ngClass"],[3,"ngClass"],["card-reveal","",1,"card",3,"change","ngClass","disabled"],[1,"card-back","back"],[1,"revealed"],[1,"text",3,"ghs-label"],[1,"card-front","front"],[1,"type","cs-oak"],[1,"type","imbue"],[1,"type","empower"],[1,"type","enfeeble"],["src","./assets/images/attackmodifier/overlays/custom.png",1,"overlay","custom"],["src","./assets/images/attackmodifier/overlays/custom-fh.png",1,"overlay","custom-fh"],[1,"overlay",3,"ngClass","src"],[1,"overlay","side",3,"src"],["src","./assets/images/attackmodifier/rolling.svg",1,"rolling"],[1,"numeration"],[1,"numeration","character-curse-icon"],[1,"am-value",3,"ngClass"],[1,"character-icon"],[1,"character-icon","imbue-icon"],[1,"effects",3,"ngClass"],[1,"mixed-element"],[1,"bb-index",3,"ngClass"],[1,"shuffle-icon"],[3,"src"],[1,"type","multiple","wild","air"],[1,"type","multiple","wild","ice"],[1,"type","multiple","wild","fire"],[1,"type","multiple","wild","earth"],[1,"type","multiple","wild","light"],[1,"type","multiple","wild","dark"],["src","./assets/images/attackmodifier/cs-oak.png"],["src","./assets/images/attackmodifier/empower.png"],["src","./assets/images/attackmodifier/enfeeble.png"],[3,"attackModifier","effect","offsetWidth","newStyle","length"],[3,"attackModifier","effect","offsetWidth","newStyle"],["src","./assets/images/shuffle.svg",1,"svg-icon"],[1,"type",3,"ngClass"],[1,"town-guard-icon"],[1,"effects","town-guard",3,"ngClass"],[3,"attackModifier","effect","offsetWidth","townGuard","length"]],template:function(i,e){1&i&&t.nVh(0,C3,9,14,"div",1),2&i&&t.vxM(e.attackModifier?0:-1)},dependencies:[N.YU,wx,Nn,it,ct],styles:[".attack-modifier{position:relative;width:100%;height:100%;transition:filter calc(var(--ghs-animation-speed) * 2s) linear,transform calc(var(--ghs-animation-speed) * .8s) cubic-bezier(.75,0,.85,1),top calc(var(--ghs-animation-speed) * .5s) linear,left calc(var(--ghs-animation-speed) * .5s) linear}.attack-modifier .card{transition:transform calc(var(--ghs-animation-speed) * .5s) cubic-bezier(.75,0,.85,1)}.attack-modifier .back{background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-back.e947b7717f678f92.png);border-radius:5%}.attack-modifier .front{display:flex;position:relative;top:0;left:0;width:100%;height:100%;border-radius:5%}.attack-modifier .front .type{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1}.attack-modifier .front .type img{position:absolute;top:0;left:0;width:100%;height:100%}.attack-modifier .front .type.custom.new-style{filter:none}.attack-modifier .front .type.custom.new-style~.overlay.custom{display:inline-block}.attack-modifier .front .type.custom.fh~.overlay.custom{display:none}.attack-modifier .front .type.custom.fh~.overlay.custom-fh{display:inline-block}.attack-modifier .front .type.multiple{background-image:url(am-front.48806d22feb6f4bf.png);background-size:100%}.attack-modifier .front .type.multiple.multiple-mixed-element:not(:nth-child(1)){-webkit-mask-image:conic-gradient(from 90deg at 50% 50%,rgb(0,0,0) 25%,rgba(0,0,0,0) 30%,rgba(0,0,0,0) 70%,rgb(0,0,0) 75%);mask-image:conic-gradient(from 90deg at 50% 50%,#000 25%,#0000 30% 70%,#000 75%)}.attack-modifier .front .type.multiple.multiple-mixed-element.multiple-mixed-element-or{-webkit-mask-image:linear-gradient(to right,rgba(0,0,0,0) 20%,rgb(0,0,0) 100%);mask-image:linear-gradient(to right,#0000 20%,#000)}.attack-modifier .front .type.multiple.multiple-1:nth-child(2){-webkit-mask-image:linear-gradient(to right,rgba(0,0,0,0) 45%,rgb(0,0,0) 55%,rgb(0,0,0) 100%);mask-image:linear-gradient(to right,#0000 45%,#000 55% 100%)}.attack-modifier .front .type.multiple.multiple-1.fh:nth-child(2){-webkit-mask-image:conic-gradient(from 110deg at 50% 50%,rgb(0,0,0) 20%,rgba(0,0,0,0) 25%,rgba(0,0,0,0) 70%,rgb(0,0,0) 75%);mask-image:conic-gradient(from 110deg at 50% 50%,#000 20%,#0000 25% 70%,#000 75%)}.attack-modifier .front .type.multiple.multiple-2:nth-child(2){-webkit-mask-image:conic-gradient(from 90deg at 50% 50%,rgb(0,0,0) 35%,rgba(0,0,0,0) 40%,rgba(0,0,0,0) 85%,rgb(0,0,0) 95%);mask-image:conic-gradient(from 90deg at 50% 50%,#000 35%,#0000 40% 85%,#000 95%)}.attack-modifier .front .type.multiple.multiple-3:nth-child(2){-webkit-mask-image:conic-gradient(from 90deg at 50% 50%,rgba(0,0,0,0) 5%,rgb(0,0,0) 10%,rgb(0,0,0) 40%,rgba(0,0,0,0) 45%);mask-image:conic-gradient(from 90deg at 50% 50%,#0000 5%,#000 10% 40%,#0000 45%)}.attack-modifier .front .type.multiple.multiple-3:nth-child(3){-webkit-mask-image:conic-gradient(from 90deg at 50% 50%,rgb(0,0,0) 5%,rgba(0,0,0,0) 10%,rgba(0,0,0,0) 60%,rgb(0,0,0) 75%);mask-image:conic-gradient(from 90deg at 50% 50%,#000 5%,#0000 10% 60%,#000 75%)}.attack-modifier .front .type.multiple.wild.air{-webkit-mask-image:conic-gradient(from 90deg at 50% 20%,rgba(0,0,0,0) 45%,rgb(0,0,0) 50%,rgb(0,0,0) 75%,rgba(0,0,0,0) 80%);mask-image:conic-gradient(from 90deg at 50% 20%,#0000 45%,#000 50% 75%,#0000 80%)}.attack-modifier .front .type.multiple.wild.ice{-webkit-mask-image:conic-gradient(from 180deg at 50% 20%,rgba(0,0,0,0) 45%,rgb(0,0,0) 50%,rgb(0,0,0) 75%,rgba(0,0,0,0) 80%);mask-image:conic-gradient(from 180deg at 50% 20%,#0000 45%,#000 50% 75%,#0000 80%)}.attack-modifier .front .type.multiple.wild.fire{-webkit-mask-image:conic-gradient(from 270deg at 66% 30%,rgba(0,0,0,0) 35%,rgb(0,0,0) 50%,rgb(0,0,0) 65%,rgba(0,0,0,0) 70%,rgba(0,0,0,0) 70%);mask-image:conic-gradient(from 270deg at 66% 30%,#0000 35%,#000 50% 65%,#0000 70% 70%)}.attack-modifier .front .type.multiple.wild.earth{-webkit-mask-image:conic-gradient(from 290deg at 50% 80%,rgba(0,0,0,0) 35%,rgb(0,0,0) 50%,rgb(0,0,0) 65%,rgba(0,0,0,0) 70%,rgba(0,0,0,0) 70%);mask-image:conic-gradient(from 290deg at 50% 80%,#0000 35%,#000 50% 65%,#0000 70% 70%)}.attack-modifier .front .type.multiple.wild.light{-webkit-mask-image:conic-gradient(from 30deg at 50% 80%,rgba(0,0,0,0) 35%,rgb(0,0,0) 50%,rgb(0,0,0) 65%,rgba(0,0,0,0) 70%,rgba(0,0,0,0) 70%);mask-image:conic-gradient(from 30deg at 50% 80%,#0000 35%,#000 50% 65%,#0000 70% 70%)}.attack-modifier .front .type.multiple.wild.dark{-webkit-mask-image:conic-gradient(from 40deg at 33% 30%,rgba(0,0,0,0) 35%,rgb(0,0,0) 50%,rgb(0,0,0) 65%,rgba(0,0,0,0) 70%,rgba(0,0,0,0) 70%);mask-image:conic-gradient(from 40deg at 33% 30%,#0000 35%,#000 50% 65%,#0000 70% 70%)}.attack-modifier .front .type.air{filter:hue-rotate(160deg) saturate(80%)}.attack-modifier .front .type.dark{filter:hue-rotate(180deg) saturate(20%) brightness(85%)}.attack-modifier .front .type.earth{filter:hue-rotate(60deg) saturate(160%)}.attack-modifier .front .type.fire{filter:hue-rotate(355deg) saturate(250%)}.attack-modifier .front .type.ice{filter:hue-rotate(165deg) saturate(250%) brightness(120%)}.attack-modifier .front .type.light{filter:hue-rotate(20deg) saturate(200%) brightness(110%)}.attack-modifier .front .type.bless{filter:hue-rotate(20deg) saturate(250%) brightness(100%)}.attack-modifier .front .type.brittle{filter:hue-rotate(175deg) saturate(90%)}.attack-modifier .front .type.curse{filter:hue-rotate(254deg) saturate(110%) brightness(90%)}.attack-modifier .front .type.disarm{filter:hue-rotate(200deg) saturate(50%) sepia(10%)}.attack-modifier .front .type.immobilize{filter:hue-rotate(330deg) saturate(200%) brightness(80%)}.attack-modifier .front .type.invisible{filter:hue-rotate(200deg) saturate(20%) brightness(70%) contrast(110%)}.attack-modifier .front .type.muddle{filter:hue-rotate(335deg) saturate(170%) sepia(40%) brightness(80%)}.attack-modifier .front .type.poison{filter:hue-rotate(80deg) saturate(90%)}.attack-modifier .front .type.regenerate{filter:hue-rotate(290deg) saturate(200%)}.attack-modifier .front .type.ward{filter:hue-rotate(290deg) saturate(200%) brightness(60%)}.attack-modifier .front .type.strengthen{filter:hue-rotate(165deg) saturate(100%)}.attack-modifier .front .type.stun{filter:hue-rotate(168deg) saturate(150%)}.attack-modifier .front .type.wound:not(.heal){filter:hue-rotate(355deg) saturate(250%)}.attack-modifier .front .type.chill{filter:hue-rotate(165deg) saturate(90%) brightness(120%)}.attack-modifier .front .type.push,.attack-modifier .front .type.pull{filter:grayscale(80%)}.attack-modifier .front .type.pierce{filter:hue-rotate(10deg) saturate(180%)}.attack-modifier .front .type.retaliate{filter:hue-rotate(160deg) grayscale(30%)}.attack-modifier .front .type.target{filter:hue-rotate(330deg) saturate(350%) brightness(80%)}.attack-modifier .front .type.refreshItem{filter:hue-rotate(330deg) saturate(130%)}.attack-modifier .front .type.custom{filter:hue-rotate(330deg) saturate(250%)}.attack-modifier .front img.overlay{position:absolute;width:100%;height:100%;z-index:2}.attack-modifier .front img.overlay.custom,.attack-modifier .front img.overlay.custom-fh{display:none}.attack-modifier .front img.overlay.side{top:50%;width:18%;height:auto;left:5%;transform:translateY(-50%)}.attack-modifier .front img.rolling{position:absolute;z-index:3;width:auto;height:28%;top:36%;right:5%}.attack-modifier .front .bb-index{position:absolute;z-index:4;width:30%;height:15%;top:15%;left:0;display:flex;justify-content:center;align-items:center}.attack-modifier .front .bb-index.character{right:0;left:initial}.attack-modifier .front .bb-index img{width:100%;height:auto;filter:var(--ghs-filter-white) var(--ghs-filter-outline)}.attack-modifier .front .numeration{position:absolute;left:9.6%;top:74%;font-family:var(--ghs-font-gh-title);font-size:.8em;line-height:.8em;color:var(--ghs-color-white);z-index:2;width:8%;height:12%;display:flex;justify-content:center;align-items:center}.attack-modifier .front .numeration.character-curse-icon{font-size:1.8em;top:80%}.attack-modifier .front .numeration img{filter:grayscale(100%) brightness(100) contrast(100%);width:90%;height:auto}.attack-modifier .front .character-icon{position:absolute;left:7.5%;top:67%;z-index:2;width:14%;height:20%;display:flex;justify-content:center;align-items:center;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-character-icon.83c1ab396221d56b.png)}.attack-modifier .front .character-icon img{filter:grayscale(100%) brightness(100) contrast(100%);height:70%;width:auto}.attack-modifier .front .character-icon.imbue-icon img{filter:var(--ghs-filter-white)}.attack-modifier .front .shuffle-icon{position:absolute;right:8.5%;top:67.5%;z-index:2;width:14%;height:20%;display:flex;justify-content:center;align-items:center;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-shuffle-icon.83c1ab396221d56b.png)}.attack-modifier .front .shuffle-icon img{filter:var(--ghs-filter-white);height:70%;width:auto}.attack-modifier .front .town-guard-icon{position:absolute;left:7.5%;top:67%;z-index:2;width:16%;height:24%;display:flex;justify-content:center;align-items:center;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-town-guard-icon.c02be0601faddc20.png)}.attack-modifier .front .town-guard-icon img{filter:var(--ghs-filter-white) var(--ghs-filter-shadow);height:70%;width:auto}.attack-modifier .front .effects{position:absolute;width:18%;top:35%;left:6%;z-index:3}.attack-modifier .front .effects>ghs-attackmodifier-effect{display:block;position:absolute;top:0;left:0;width:100%}.attack-modifier .front .effects.multiple.multiple-2>ghs-attackmodifier-effect:nth-child(1){transform:translateY(-110%)}.attack-modifier .front .effects.town-guard{top:56%;left:43%;width:15%}.attack-modifier .front .effects.center{top:22%;left:31%;width:37%}.attack-modifier .front .effects.center.multiple>ghs-attackmodifier-effect:nth-child(1){transform:translate(-70%,-70%) scale(.5)}.attack-modifier .front .effects.center.multiple>ghs-attackmodifier-effect:nth-child(2){transform:translate(-30%,-30%) scale(.5)}.attack-modifier .front .effects.center.multiple>ghs-attackmodifier-effect:nth-child(3){transform:translate(-30%,-70%) scale(.5)}.attack-modifier .front .effects.center.multiple>ghs-attackmodifier-effect:nth-child(4){transform:translate(-70%,-30%) scale(.5)}.attack-modifier .front .effects.center.multiple.multiple-2>ghs-attackmodifier-effect:nth-child(1){transform:translate(-18%,-18%) scale(.5)}.attack-modifier .front .effects.center.multiple.multiple-2>ghs-attackmodifier-effect:nth-child(2){transform:translate(18%,18%) scale(.5)}.attack-modifier .front .effects.center.multiple.multiple-3>ghs-attackmodifier-effect:nth-child(1){transform:translate(-25%,-15%) scale(.4)}.attack-modifier .front .effects.center.multiple.multiple-3>ghs-attackmodifier-effect:nth-child(2){transform:translateY(25%) scale(.4)}.attack-modifier .front .effects.center.multiple.multiple-3>ghs-attackmodifier-effect:nth-child(3){transform:translate(25%,-15%) scale(.4)}.attack-modifier .front .am-value{position:absolute;display:flex;justify-content:center;align-items:center;top:50%;left:49.5%;width:34%;height:52%;transform:translate(-50%,-50%);font-family:var(--ghs-font-gh-title);color:var(--ghs-color-white);font-size:3.5em;z-index:1;text-shadow:1px 0px var(--ghs-color-darkgray),0px 1px var(--ghs-color-darkgray),1px 0px var(--ghs-color-darkgray),0px 1px var(--ghs-color-darkgray);filter:drop-shadow(1px 1px 1px var(--ghs-color-darkgray))}.attack-modifier .front .am-value.side{left:13%;width:15%;height:25%;font-size:1.6em;z-index:4}.attack-modifier .front .mixed-element{position:absolute;top:8%;left:5%;width:16%;height:25%;z-index:3}.attack-modifier.bless .front:before{display:none}.attack-modifier.draw{z-index:0}.attack-modifier .confirm .revealed{width:100%;height:100%;display:flex;justify-content:center;align-items:center;color:var(--ghs-color-white);font-size:1.3em;filter:drop-shadow(calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) var(--ghs-color-black))}.attack-modifier .confirm .revealed .text{text-align:center}.attack-modifier.town-guard .back{background-image:url(back.86db9c801336d036.png)}.attack-modifier.town-guard .front .am-value.effects{top:43%}\n"],encapsulation:2})}return a})();const M3=["menu"],v3=(a,r)=>({denied:a,"has-deleted":r}),Rn=a=>({disabled:a}),O3=a=>({active:a}),P3=(a,r)=>({active:a,disabled:r}),b3=a=>({"has-deleted":a}),k3=a=>({denied:a}),y3=(a,r)=>({drawn:a,current:r}),ae=(a,r)=>r._trackUUID;function x3(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",6),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.removeDrawnDiscards())}),t.nrm(1,"span",7),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","game.cards.removeDrawnDiscards"))}function E3(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",15),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleEdit())}),t.k0s(),t.nrm(2,"span",7),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("checked",n.edit),t.R7$(),t.Y8G("ghs-label","game.cards.edit")}}function w3(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",15),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleBB())}),t.k0s(),t.nrm(2,"span",7),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("checked",n.bbTable),t.R7$(),t.Y8G("ghs-label","game.cards.edit.toggleBB")}}function R3(a,r){1&a&&(t.j41(0,"span",22),t.nrm(1,"img",28),t.k0s())}function j3(a,r){1&a&&(t.j41(0,"span",22),t.nrm(1,"img",28),t.k0s())}function G3(a,r){1&a&&(t.j41(0,"span",22),t.nrm(1,"img",28),t.k0s())}function T3(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",9)(1,"span",16)(2,"a",17),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeBless(-1))}),t.nrm(3,"img",18),t.k0s()(),t.j41(4,"span",19),t.nrm(5,"img",20),t.j41(6,"span",21),t.EFF(7),t.k0s(),t.nVh(8,R3,2,0,"span",22),t.k0s(),t.j41(9,"span",16)(10,"a",17),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeBless(1))}),t.nrm(11,"img",23),t.k0s()(),t.j41(12,"span",16)(13,"a",17),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeCurse(-1))}),t.nrm(14,"img",18),t.k0s()(),t.j41(15,"span",19),t.nrm(16,"img",24),t.j41(17,"span",25),t.EFF(18),t.k0s(),t.nVh(19,j3,2,0,"span",22),t.k0s(),t.j41(20,"span",16)(21,"a",17),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeCurse(1))}),t.nrm(22,"img",23),t.k0s()(),t.j41(23,"span",16)(24,"a",17),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeMinus1Extra(-1))}),t.nrm(25,"img",18),t.k0s()(),t.j41(26,"span",19),t.nrm(27,"img",26),t.j41(28,"span",27),t.EFF(29),t.k0s(),t.nVh(30,G3,2,0,"span",22),t.k0s(),t.j41(31,"span",16)(32,"a",17),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeMinus1Extra(1))}),t.nrm(33,"img",23),t.k0s()()()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("ngClass",t.eq3(18,Rn,0==n.countUpcomingAttackModifier(n.AttackModifierType.bless))),t.R7$(2),t.Y8G("ghs-label","game.condition.bless")("ghs-label-attribute","title"),t.R7$(3),t.JRh(n.countUpcomingAttackModifier(n.AttackModifierType.bless)),t.R7$(),t.vxM(n.gameManager.attackModifierManager.countUpcomingBlesses()>10?8:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(20,Rn,n.gameManager.attackModifierManager.countUpcomingBlesses()>=10)),t.R7$(3),t.Y8G("ngClass",t.eq3(22,Rn,0==n.countUpcomingAttackModifier(n.AttackModifierType.curse))),t.R7$(2),t.Y8G("ghs-label","game.condition.curse")("ghs-label-attribute","title"),t.R7$(3),t.JRh(n.countUpcomingAttackModifier(n.AttackModifierType.curse)),t.R7$(),t.vxM(n.gameManager.attackModifierManager.countUpcomingCurses(!n.character&&!n.ally)>10?19:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(24,Rn,n.gameManager.attackModifierManager.countUpcomingCurses(!n.character&&!n.ally)>=10)),t.R7$(3),t.Y8G("ngClass",t.eq3(26,Rn,0==n.countAttackModifier(n.AttackModifierType.minus1extra))),t.R7$(2),t.Y8G("ghs-label","game.attackmodifiers.types.minus1")("ghs-label-attribute","title"),t.R7$(3),t.JRh(n.countAttackModifier(n.AttackModifierType.minus1extra)),t.R7$(),t.vxM(n.gameManager.attackModifierManager.countExtraMinus1()>15?30:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(28,Rn,n.gameManager.attackModifierManager.countExtraMinus1()>=15))}}function S3(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",16)(1,"a",17),t.bIt("click",function(){const e=c.eBV(n).$index,o=t.XpG(2);return c.Njj(o.changeEmpower(e,-1))}),t.nrm(2,"img",18),t.k0s()(),t.j41(3,"span",19),t.nrm(4,"img",29),t.j41(5,"span",30),t.EFF(6),t.k0s(),t.j41(7,"span",31),t.nrm(8,"img",32),t.k0s()(),t.j41(9,"span",16)(10,"a",17),t.bIt("click",function(){const e=c.eBV(n).$index,o=t.XpG(2);return c.Njj(o.changeEmpower(e,1))}),t.nrm(11,"img",23),t.k0s()()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(6,Rn,0==e.countUpcomingAttackModifier(e.AttackModifierType.empower,"additional-"+n.name))),t.R7$(2),t.Y8G("ghs-label","game.attackmodifiers.types.empower")("ghs-label-attribute","title"),t.R7$(3),t.JRh(e.countUpcomingAttackModifier(e.AttackModifierType.empower,"additional-"+n.name)),t.R7$(2),t.Y8G("src",n.iconUrl,t.B4B),t.R7$(2),t.Y8G("ngClass",t.eq3(8,Rn,0==e.countEmpower(i)))}}function D3(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",16)(1,"a",17),t.bIt("click",function(){const e=c.eBV(n).$index,o=t.XpG(2);return c.Njj(o.changeEnfeeble(e,-1))}),t.nrm(2,"img",18),t.k0s()(),t.j41(3,"span",19),t.nrm(4,"img",33),t.j41(5,"span",30),t.EFF(6),t.k0s(),t.j41(7,"span",31),t.nrm(8,"img",32),t.k0s()(),t.j41(9,"span",16)(10,"a",17),t.bIt("click",function(){const e=c.eBV(n).$index,o=t.XpG(2);return c.Njj(o.changeEnfeeble(e,1))}),t.nrm(11,"img",23),t.k0s()()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(6,Rn,0==e.countUpcomingAttackModifier(e.AttackModifierType.enfeeble,"additional-"+n.name))),t.R7$(2),t.Y8G("ghs-label","game.attackmodifiers.types.enfeeble")("ghs-label-attribute","title"),t.R7$(3),t.JRh(e.countUpcomingAttackModifier(e.AttackModifierType.enfeeble,"additional-"+n.name)),t.R7$(2),t.Y8G("src",n.iconUrl,t.B4B),t.R7$(2),t.Y8G("ngClass",t.eq3(8,Rn,0==e.countEnfeeble(i)))}}function $3(a,r){if(1&a&&(t.j41(0,"div",10),t.Z7z(1,S3,12,10,null,null,ae),t.nI1(3,"trackUUID"),t.Z7z(4,D3,12,10,null,null,ae),t.nI1(6,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(t.bMT(3,0,n.empowerChars)),t.R7$(3),t.Dyx(t.bMT(6,2,n.enfeebleChars))}}function I3(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",6),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.restoreDefault())}),t.nrm(1,"span",7),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","game.cards.restore"))}function A3(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",11)(1,"a",34),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.newFirst(e.type))}),t.nrm(2,"img",23),t.k0s(),t.j41(3,"a",34),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeType(!0))}),t.nrm(4,"img",35),t.k0s(),t.j41(5,"span",36),t.nrm(6,"img",32),t.k0s(),t.j41(7,"a",34),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeType())}),t.nrm(8,"img",37),t.k0s(),t.j41(9,"a",34),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.newShuffle(e.type))}),t.nrm(10,"img",38),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(6),t.Y8G("src",t.VkB("./assets/images/attackmodifier/",n.type,".png"),t.B4B)}}function V3(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",11)(1,"a",34),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.addModifier())}),t.nrm(2,"img",23),t.k0s(),t.j41(3,"a",34),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeType(!0))}),t.nrm(4,"img",35),t.k0s(),t.j41(5,"span",36),t.nrm(6,"ghs-attackmodifier",39),t.k0s(),t.j41(7,"a",34),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeType())}),t.nrm(8,"img",37),t.k0s(),t.j41(9,"a",34),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.addModifierShuffle())}),t.nrm(10,"img",38),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(6),t.Y8G("attackModifier",n.tgAM)("flipped",!0)("newStyle",!0)("characterIcon",n.characterIcon)("ally",n.ally)("townGuard",n.townGuard)}}function F3(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",44),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.toggleFaction(e))}),t.nrm(1,"img",45),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.eq3(2,O3,n==i.activeFaction)),t.R7$(),t.Y8G("src","./assets/images/gh2e/faction/"+n+".svg",t.B4B)}}function X3(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",46),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.toggleFactionAm(e))})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.toggleFactionAm(e,!0))}),t.nrm(1,"ghs-attackmodifier",47),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.l_i(4,P3,i.hasFactionModifier(n),i.anyHasFactionModifier(n))),t.R7$(),t.Y8G("attackModifier",n)("flipped",!0)("newStyle",!0)}}function B3(a,r){if(1&a&&(t.j41(0,"div",12)(1,"div",40),t.Z7z(2,F3,2,4,"a",41,t.fX1),t.k0s(),t.j41(4,"div",42),t.Z7z(5,X3,2,7,"div",43,ae),t.nI1(7,"trackUUID"),t.k0s()()),2&a){const n=t.XpG();t.R7$(2),t.Dyx(n.gameManager.gh2eFactionUnlocks()),t.R7$(3),t.Dyx(t.bMT(7,0,n.factionAttackModifier))}}function Y3(a,r){1&a&&t.nrm(0,"div",50)}function U3(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",57),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG(2);return c.Njj(o.remove(e+o.deck.current+1))}),t.nrm(1,"img",18),t.k0s()}}function N3(a,r){1&a&&t.nrm(0,"div",56)}function z3(a,r){if(1&a&&(t.j41(0,"div",51),t.nrm(1,"ghs-attackmodifier",54),t.nVh(2,U3,2,0,"a",55),t.nVh(3,N3,1,0,"div",56),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.R7$(),t.Y8G("attackModifier",n)("numeration",e.numeration)("reveal",!0)("flipped",2==e.reveal||n.revealed)("newStyle",e.newStyle)("characterIcon",e.characterIcon)("ally",e.ally)("townGuard",e.townGuard)("bbIndex",e.deck.bb?(i+e.deck.current+1)%3:-1),t.R7$(),t.vxM(e.edit?2:-1),t.R7$(),t.vxM(e.edit?3:-1)}}function L3(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",57),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG(2);return c.Njj(o.remove(o.deck.current-e))}),t.nrm(1,"img",18),t.k0s()}}function q3(a,r){1&a&&t.nrm(0,"div",56)}function H3(a,r){if(1&a&&(t.j41(0,"div",51),t.nrm(1,"ghs-attackmodifier",58),t.nVh(2,L3,2,0,"a",55),t.nVh(3,q3,1,0,"div",56),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.R7$(),t.Y8G("attackModifier",n)("numeration",e.numeration)("flipped",!0)("newStyle",e.newStyle)("characterIcon",e.characterIcon)("ally",e.ally)("townGuard",e.townGuard)("bbIndex",e.deck.bb?(e.deck.current-i)%3:-1),t.R7$(),t.vxM(e.edit?2:-1),t.R7$(),t.vxM(e.edit?3:-1)}}function K3(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",61),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG(3);return c.Njj(o.restore(e))}),t.nrm(1,"img",23),t.k0s()}}function W3(a,r){1&a&&t.nrm(0,"div",56)}function Z3(a,r){if(1&a&&(t.j41(0,"div",51),t.nrm(1,"ghs-attackmodifier",59),t.nVh(2,K3,2,0,"a",60),t.nVh(3,W3,1,0,"div",56),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(3);t.R7$(),t.Y8G("attackModifier",n)("numeration",i.numeration)("flipped",!0)("newStyle",i.newStyle)("characterIcon",i.characterIcon)("ally",i.ally)("townGuard",i.townGuard),t.R7$(),t.vxM(i.edit?2:-1),t.R7$(),t.vxM(i.edit?3:-1)}}function J3(a,r){if(1&a&&(t.j41(0,"div",53),t.Z7z(1,Z3,4,9,"div",51,ae),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Dyx(t.bMT(3,0,n.deletedCards))}}function Q3(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",48)(1,"div",49,1),t.bIt("cdkDropListDropped",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.dropUpcoming(e))}),t.nVh(3,Y3,1,0,"div",50),t.Z7z(4,z3,4,11,"div",51,ae),t.nI1(6,"trackUUID"),t.k0s(),t.j41(7,"div",52,2),t.bIt("cdkDropListDropped",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.dropDiscarded(e))}),t.nrm(9,"div",50),t.Z7z(10,H3,4,10,"div",51,ae),t.nI1(12,"trackUUID"),t.k0s(),t.nVh(13,J3,4,2,"div",53),t.k0s()}if(2&a){const n=t.sdS(2),i=t.sdS(8),e=t.XpG();t.xc7("max-height",e.maxHeight),t.Y8G("ngClass",t.eq3(16,b3,e.edit&&e.deletedCards.length)),t.R7$(),t.Y8G("cdkDropListDisabled",!e.edit)("cdkDropListConnectedTo",i)("cdkDropListAutoScrollStep",20)("ngClass",t.eq3(18,k3,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.attackModifiers&&(!e.character||!e.gameManager.stateManager.characterPermissions[e.character.name+"|"+e.character.edition]))),t.R7$(2),t.vxM(0==e.upcomingCards.length?3:-1),t.R7$(),t.Dyx(t.bMT(6,12,e.upcomingCards)),t.R7$(3),t.Y8G("cdkDropListDisabled",!e.edit)("cdkDropListConnectedTo",n)("cdkDropListAutoScrollStep",20),t.R7$(3),t.Dyx(t.bMT(12,14,e.discardedCards)),t.R7$(3),t.vxM(e.edit&&e.deletedCards.length?13:-1)}}function t4(a,r){if(1&a&&(t.j41(0,"div",66),t.nrm(1,"ghs-attackmodifier",59),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.Y8G("ngClass",t.l_i(8,y3,i!=e.deck.current&&i!=e.deck.lastVisible&&i<e.bbDrawnIndex,i==e.deck.current||i==e.deck.lastVisible)),t.R7$(),t.Y8G("attackModifier",n)("numeration",e.numeration)("flipped",!0)("newStyle",e.newStyle)("characterIcon",e.characterIcon)("ally",e.ally)("townGuard",e.townGuard)}}function n4(a,r){if(1&a&&(t.j41(0,"div",14)(1,"div",62),t.nrm(2,"img",63),t.k0s(),t.j41(3,"div",62),t.nrm(4,"img",64),t.k0s(),t.j41(5,"div",62),t.nrm(6,"img",65),t.k0s(),t.Z7z(7,t4,2,11,"div",66,ae),t.nI1(9,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(7),t.Dyx(t.bMT(9,0,n.deck.cards))}}let qs=(()=>{class a{dialogRef;ghsManager;deck;character;numeration="";before;after;menuElement;gameManager=s.E;settingsManager=p.f;GameState=D.mk;reveal=0;edit=!1;maxHeight="";characterIcon="";ally=!1;newStyle=!1;townGuard=!1;bbTable=!1;bbDrawnIndex=0;AttackModifierType=w.Yn;type=w.Yn.minus1;tgAM=w.qq[0];currentAttackModifier=-1;drawing=!1;upcomingCards=[];discardedCards=[];deletedCards=[];empowerChars=[];enfeebleChars=[];activeFaction;factionAttackModifier=[];constructor(n,i,e){this.dialogRef=i,this.ghsManager=e,this.deck=n.deck,this.character=n.character,this.ally=n.ally,this.numeration=n.numeration,this.newStyle=n.newStyle,this.townGuard=n.townGuard,this.before=n.before,this.after=n.after,this.dialogRef.closed.subscribe(()=>{this.upcomingCards.forEach(o=>o.revealed=!1)})}ngOnInit(){this.character&&(this.deck=this.character.attackModifierDeck,this.numeration=""+this.character.number,this.characterIcon=this.character.iconUrl,s.E.gh2eFactionUnlocks().forEach(n=>{this.deck.cards.some(i=>i.id&&i.id.includes(n))&&this.toggleFaction(n)})),setTimeout(()=>{this.maxHeight="calc(80vh - "+this.menuElement.nativeElement.offsetHeight+"px)"},p.f.settings.animations?250*p.f.settings.animationSpeed:0),s.E.bbRules()&&p.f.settings.bbAm&&(this.bbTable=!0),this.update(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.update()})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}toggleEdit(){this.edit=!this.edit,this.bbTable=!1,setTimeout(()=>{this.maxHeight="calc(80vh - "+this.menuElement.nativeElement.offsetHeight+"px)"},0)}toggleBB(){this.bbTable=!this.bbTable,this.edit=!1,setTimeout(()=>{this.maxHeight="calc(80vh - "+this.menuElement.nativeElement.offsetHeight+"px)"},0)}update(){let n;this.upcomingCards=this.deck.cards.filter((i,e)=>e>this.deck.current),this.discardedCards=this.deck.cards.filter((i,e)=>e<=this.deck.current).reverse(),this.character?n=s.E.attackModifierManager.buildCharacterAttackModifierDeck(this.character):this.townGuard?(n=s.E.attackModifierManager.buildTownGuardAttackModifierDeck(s.E.game.party,s.E.campaignData()),s.E.game.party.townGuardDeck=this.deck.toModel()):n=new w.J,this.deck.cards.forEach(i=>{if(n){const e=n.cards.find(o=>o.id==i.id);e&&n.cards.splice(n.cards.indexOf(e),1)}}),this.deletedCards=n.cards,(!this.character||!s.E.entityManager.isImmune(this.character,this.character,Q.r5.empower))&&(this.empowerChars=s.E.game.figures.filter(i=>i instanceof H.K&&s.E.entityManager.isAlive(i)&&i.additionalModifier&&i.additionalModifier.find(e=>e.attackModifier&&e.attackModifier.type==w.Yn.empower)).map(i=>i)),(!this.character||!s.E.entityManager.isImmune(this.character,this.character,Q.r5.enfeeble))&&(this.enfeebleChars=s.E.game.figures.filter(i=>i instanceof H.K&&s.E.entityManager.isAlive(i)&&!i.absent&&i.additionalModifier&&i.additionalModifier.find(e=>e.attackModifier&&e.attackModifier.type==w.Yn.enfeeble)).map(i=>i)),this.bbDrawnIndex=3*Math.floor(this.deck.current/3)}shuffle(n=!1){this.before.emit(new mt(this.deck,"shuffle"+(n?"Upcoming":""))),s.E.attackModifierManager.shuffleModifiers(this.deck,n),this.after.emit(new mt(this.deck,"shuffle"+(n?"Upcoming":""))),this.update()}removeDrawnDiscards(){this.before.emit(new mt(this.deck,"removeDrawnDiscards")),s.E.attackModifierManager.removeDrawnDiscards(this.deck),this.after.emit(new mt(this.deck,"removeDrawnDiscards")),this.update()}restoreDefault(){if(this.before.emit(new mt(this.deck,"restoreDefault")),this.character)s.E.attackModifierManager.mergeAttackModifierDeck(this.character.attackModifierDeck,s.E.attackModifierManager.buildCharacterAttackModifierDeck(this.character)),s.E.attackModifierManager.fromModel(this.deck,this.character.attackModifierDeck.toModel());else if(this.townGuard)this.deck=s.E.attackModifierManager.buildTownGuardAttackModifierDeck(s.E.game.party,s.E.campaignData()),s.E.game.party.townGuardDeck=this.deck.toModel();else if(s.E.bbRules()){const n=s.E.editionData.find(i=>"bb"==i.edition&&i.monsterAmTables&&i.monsterAmTables.length);if(n){const i=s.E.levelManager.bbMonsterDifficutly();this.deck=new w.J(n.monsterAmTables[i].map(e=>new w.uU(e)),p.f.settings.bbAm)}else this.deck=new w.J}else this.deck=s.E.attackModifierManager.buildMonsterAttackModifierDeck(this.ally);this.after.emit(new mt(this.deck,"restoreDefault")),this.update()}hasDrawnDiscards(){return this.deck.cards.some((n,i)=>i<=this.deck.current&&(n.type==w.Yn.bless||n.type==w.Yn.curse||n.type==w.Yn.empower||n.type==w.Yn.enfeeble))}dropUpcoming(n){if(this.before.emit(new mt(this.deck,"reorder")),n.container==n.previousContainer){const i=this.deck.current+1;(0,V.HD)(this.deck.cards,n.previousIndex+i,n.currentIndex+i)}else{const i=this.deck.current;(0,V.HD)(this.deck.cards,i-n.previousIndex,n.currentIndex+i),this.deck.current=this.deck.current-1}this.after.emit(new mt(this.deck,"reorder")),this.update()}dropDiscarded(n){if(this.before.emit(new mt(this.deck,"reorder")),n.container==n.previousContainer)(0,V.HD)(this.deck.cards,this.deck.current-n.previousIndex,this.deck.current-n.currentIndex);else{this.deck.current=this.deck.current+1;const i=this.deck.current;(0,V.HD)(this.deck.cards,n.previousIndex+i,i-n.currentIndex),this.deck.cards[i-n.currentIndex].revealed=!0}this.after.emit(new mt(this.deck,"reorder")),this.update()}remove(n){this.before.emit(new mt(this.deck,"removeCard",n)),n<=this.deck.current&&(this.deck.current--,this.currentAttackModifier=this.deck.current),this.deck.cards.splice(n,1),this.after.emit(new mt(this.deck,"removeCard",n)),this.update()}restore(n){this.before.emit(new mt(this.deck,"restoreCard",n)),this.deck.cards.splice(this.deck.current+1,0,this.deletedCards[n]),this.after.emit(new mt(this.deck,"restoreCard",n)),this.update()}newFirst(n){this.before.emit(new mt(this.deck,"addCard","game.attackModifiers.types."+n));let i=new w.uU(n);i.revealed=!0,this.deck.cards.splice(this.deck.current+1,0,i),this.after.emit(new mt(this.deck,"addCard","game.attackModifiers.types."+n)),this.update()}newShuffle(n){this.before.emit(new mt(this.deck,"addCardShuffled","game.attackModifiers.types."+n)),this.deck.cards.splice(this.deck.current+1+Math.random()*(this.deck.cards.length-this.deck.current),0,new w.uU(n)),this.after.emit(new mt(this.deck,"addCardShuffled","game.attackModifiers.types."+n)),this.update()}addModifier(){this.before.emit(new mt(this.deck,"addCard","game.attackModifiers.types."+this.tgAM.type));let n=Object.assign(new w.uU(this.tgAM.type),this.tgAM);n.revealed=!0,this.deck.attackModifiers.find(i=>i.id==n.id)||this.deck.attackModifiers.push(n),this.deck.cards.splice(this.deck.current+1,0,n),this.after.emit(new mt(this.deck,"addCard","game.attackModifiers.types."+this.tgAM.type)),this.update()}addModifierShuffle(){this.before.emit(new mt(this.deck,"addCard","game.attackModifiers.types."+this.tgAM.type));let n=Object.assign(new w.uU(this.tgAM.type),this.tgAM);this.deck.cards.splice(this.deck.current+1+Math.random()*(this.deck.cards.length-this.deck.current),0,n),this.deck.attackModifiers.find(i=>i.id==n.id)||this.deck.attackModifiers.push(n),this.after.emit(new mt(this.deck,"addCard","game.attackModifiers.types."+this.tgAM.type)),this.update()}countAttackModifier(n){return this.deck.cards.filter(i=>i.type==n&&!i.character).length}countDrawnAttackModifier(n){return this.deck.cards.filter((i,e)=>i.type==n&&e<=this.deck.current).length}countUpcomingAttackModifier(n,i=void 0){return this.deck.cards.filter((e,o)=>e.type==n&&o>this.deck.current&&(!i||e.id&&e.id.startsWith(i))).length}changeAttackModifier(n,i){if(i>0){if(n==w.Yn.bless&&s.E.attackModifierManager.countUpcomingBlesses()>=10)return;if(n==w.Yn.curse&&s.E.attackModifierManager.countUpcomingCurses(!this.character&&!this.ally)>=10)return;if(n==w.Yn.minus1&&s.E.attackModifierManager.countExtraMinus1()>=15)return;s.E.attackModifierManager.addModifier(this.deck,new w.uU(n))}else if(i<0){const e=this.deck.cards.find((o,g)=>o.type==n&&g>this.deck.current);e&&this.deck.cards.splice(this.deck.cards.indexOf(e),1)}this.update()}changeBless(n){this.before.emit(new mt(this.deck,n<0?"removeBless":"addBless")),this.changeAttackModifier(w.Yn.bless,n),this.after.emit(new mt(this.deck,n<0?"removeBless":"addBless")),this.update()}changeCurse(n){this.before.emit(new mt(this.deck,n<0?"removeCurse":"addCurse")),this.changeAttackModifier(w.Yn.curse,n),this.after.emit(new mt(this.deck,n<0?"removeCurse":"addCurse")),this.update()}changeMinus1Extra(n){this.before.emit(new mt(this.deck,n<0?"removeMinus1":"addMinus1")),this.changeAttackModifier(w.Yn.minus1extra,n),this.after.emit(new mt(this.deck,n<0?"removeMinus1":"addMinus1")),this.update()}onChange(n,i){n.revealed=i}changeType(n=!1){if(this.townGuard){let i=w.qq.indexOf(this.tgAM)+(n?-1:1);i<0?i=w.qq.length-1:i>=w.qq.length&&(i=0),this.tgAM=w.qq[i]}else{let i=Object.values(w.Yn).indexOf(this.type)+(n?-1:1);i<0?i=Object.values(w.Yn).length-1:i>=Object.values(w.Yn).length&&(i=0),this.type=Object.values(w.Yn)[i],[w.Yn.plus,w.Yn.plus3,w.Yn.plus4,w.Yn.plusX,w.Yn.invalid,w.Yn.minus,w.Yn.minus1extra,w.Yn.empower,w.Yn.enfeeble,w.Yn.townguard,w.Yn.success,w.Yn.wreck,w.Yn.imbue,w.Yn.advancedImbue].includes(this.type)&&this.changeType(n)}this.update()}countEmpower(n,i=!1){return this.empowerChars[n]?this.empowerChars[n].additionalModifier.filter(e=>e.attackModifier&&e.attackModifier.type==w.Yn.empower).map(e=>e.count).reduce((e,o)=>e+o)-(i?0:s.E.attackModifierManager.countUpcomingAdditional(this.empowerChars[n],w.Yn.empower)):-1}countEnfeeble(n,i=!1){return this.enfeebleChars[n]?this.enfeebleChars[n].additionalModifier.filter(e=>e.attackModifier&&e.attackModifier.type==w.Yn.enfeeble).map(e=>e.count).reduce((e,o)=>e+o)-(i?0:s.E.attackModifierManager.countUpcomingAdditional(this.enfeebleChars[n],w.Yn.enfeeble)):-1}changeEmpower(n,i){if(this.empowerChars[n]){this.before.emit(new mt(this.deck,i<0?"removeEmpower":"addEmpower"));const e=s.E.attackModifierManager.getAdditional(this.empowerChars[n],w.Yn.empower);if(i>0)for(let o=0;o<Math.min(i,e.length);o++)s.E.attackModifierManager.addModifier(this.deck,e[o]);else for(let o=0;o<-1*i;o++){const g=this.deck.cards.find((m,k)=>this.empowerChars[n]&&k>this.deck.current&&m.type==w.Yn.empower&&m.id&&m.id.startsWith("additional-"+this.empowerChars[n].name));g&&this.deck.cards.splice(this.deck.cards.indexOf(g),1)}this.after.emit(new mt(this.deck,i<0?"removeEmpower":"addEmpower")),this.update()}}changeEnfeeble(n,i){if(this.enfeebleChars[n]){this.before.emit(new mt(this.deck,i<0?"removeEnfeeble":"addEnfeeble"));const e=s.E.attackModifierManager.getAdditional(this.enfeebleChars[n],w.Yn.enfeeble);if(i>0)for(let o=0;o<Math.min(i,e.length);o++)s.E.attackModifierManager.addModifier(this.deck,e[o]);else for(let o=0;o<-1*i;o++){const g=this.deck.cards.find((m,k)=>this.empowerChars[n]&&k>this.deck.current&&m.type==w.Yn.enfeeble&&m.id&&m.id.startsWith("additional-"+this.empowerChars[n].name));g&&this.deck.cards.splice(this.deck.cards.indexOf(g),1)}this.after.emit(new mt(this.deck,i<0?"removeEnfeeble":"addEnfeeble")),this.update()}}toggleFaction(n){this.factionAttackModifier=[],this.activeFaction==n?this.activeFaction=void 0:(this.activeFaction=n,this.factionAttackModifier=w.vY.filter(i=>i.id&&i.id.startsWith("gh2e-"+n)))}toggleFactionAm(n,i=!1){this.hasFactionModifier(n)?(this.before.emit(new mt(this.deck,"removeFactionModifier",n.id)),this.deck.cards=this.deck.cards.filter(e=>e.id!=n.id),this.after.emit(new mt(this.deck,"removeFactionModifier",n.id))):(!this.anyHasFactionModifier(n)||i)&&(this.before.emit(new mt(this.deck,"addFactionModifier",n.id)),i||(this.deck.cards=this.deck.cards.filter(e=>!e.id||s.E.gh2eFactionUnlocks().every(o=>!e.id.includes(o)))),this.deck.cards=[...this.deck.cards,Object.assign(new w.uU(n.type),n)],this.after.emit(new mt(this.deck,"addFactionModifier",n.id)))}hasFactionModifier(n){return this.deck.cards.some(i=>i.id==n.id)}anyHasFactionModifier(n){return s.E.game.figures.some(i=>i instanceof H.K&&(i.edition!=this.character.edition||i.name!=this.character.name)&&i.attackModifierDeck.cards.some(e=>e.id==n.id))}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-attackmodifier-deck-dialog"]],viewQuery:function(i,e){if(1&i&&t.GBs(M3,5),2&i){let o;t.mGM(o=t.lsd())&&(e.menuElement=o.first)}},standalone:!1,decls:19,vars:19,consts:[["menu",""],["upcomingList","cdkDropList"],["discardedList","cdkDropList"],[1,"attack-modifiers-dialog"],[1,"scroll-container"],[1,"menu",3,"ngClass"],[3,"click"],[3,"ghs-label"],["ghs-pointer-input","",3,"singleClick","doubleClick","ghs-tooltip","overlayX"],[1,"curse-bless"],[1,"additional-modifier"],[1,"insert-menu"],[1,"factions-modifier"],[1,"attack-modifiers-container",3,"maxHeight","ngClass"],[1,"bb-table"],["type","checkbox",3,"click","checked"],[1,"item"],[1,"button",3,"click","ngClass"],["src","./assets/images/minus.svg",1,"ghs-svg"],[1,"item",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/status/bless.svg"],[1,"badge","bless-count"],[1,"warning"],["src","./assets/images/plus.svg",1,"ghs-svg"],["src","./assets/images/status/curse.svg"],[1,"badge","curse-count"],["src","./assets/images/attackmodifier/icons/minus1.png"],[1,"badge","minus1-count"],["src","./assets/images/warning.svg"],["src","./assets/images/attackmodifier/icons/empower.png"],[1,"badge"],[1,"badge","badge-character-icon"],[3,"src"],["src","./assets/images/attackmodifier/icons/enfeeble.png"],[1,"icon-button",3,"click"],["src","./assets/images/left.svg",1,"ghs-svg"],[1,"attack-modifier"],["src","./assets/images/right.svg",1,"ghs-svg"],["src","./assets/images/shuffle.svg",1,"ghs-svg"],[1,"drag-hidden",3,"attackModifier","flipped","newStyle","characterIcon","ally","townGuard"],[1,"factions"],[1,"faction",3,"ngClass"],[1,"attack-modifier-list"],["ghs-pointer-input","",1,"am",3,"ngClass"],[1,"faction",3,"click","ngClass"],[1,"ghs-svg",3,"src"],["ghs-pointer-input","",1,"am",3,"singleClick","doubleClick","ngClass"],[3,"attackModifier","flipped","newStyle"],[1,"attack-modifiers-container",3,"ngClass"],["cdkDropList","",1,"upcoming","drop-list",3,"cdkDropListDropped","cdkDropListDisabled","cdkDropListConnectedTo","cdkDropListAutoScrollStep","ngClass"],[1,"empty"],["cdkDrag","",1,"attack-modifier-container"],["cdkDropList","",1,"discarded","drop-list",3,"cdkDropListDropped","cdkDropListDisabled","cdkDropListConnectedTo","cdkDropListAutoScrollStep"],[1,"deleted"],[1,"drag-hidden",3,"attackModifier","numeration","reveal","flipped","newStyle","characterIcon","ally","townGuard","bbIndex"],[1,"button-remove"],["cdkDragHandle","",1,"drag-handle"],[1,"button-remove",3,"click"],[1,"drag-hidden",3,"attackModifier","numeration","flipped","newStyle","characterIcon","ally","townGuard","bbIndex"],[1,"drag-hidden",3,"attackModifier","numeration","flipped","newStyle","characterIcon","ally","townGuard"],[1,"button-restore"],[1,"button-restore",3,"click"],[1,"header"],["src","./assets/images/bb/attackmodifier/0.svg",1,"ghs-svg"],["src","./assets/images/bb/attackmodifier/1.svg",1,"ghs-svg"],["src","./assets/images/bb/attackmodifier/2.svg",1,"ghs-svg"],[1,"attack-modifier-container",3,"ngClass"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",3)(1,"div",4)(2,"div",5,0)(4,"a",6),t.bIt("click",function(){return c.eBV(o),c.Njj(e.reveal=(e.reveal+1)%3)}),t.nrm(5,"span",7),t.k0s(),t.j41(6,"a",8),t.bIt("singleClick",function(){return c.eBV(o),c.Njj(e.shuffle())})("doubleClick",function(){return c.eBV(o),c.Njj(e.shuffle(!0))}),t.nrm(7,"span",7),t.k0s(),t.nVh(8,x3,2,1,"a"),t.nVh(9,E3,3,2,"label"),t.nVh(10,w3,3,2,"label"),t.nVh(11,T3,34,30,"div",9),t.nVh(12,$3,7,4,"div",10),t.nVh(13,I3,2,1,"a"),t.nVh(14,A3,11,2,"div",11),t.nVh(15,V3,11,6,"div",11),t.nVh(16,B3,8,2,"div",12),t.k0s(),t.nVh(17,Q3,14,20,"div",13),t.nVh(18,n4,10,2,"div",14),t.k0s()()}2&i&&(t.R7$(2),t.Y8G("ngClass",t.l_i(16,v3,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.attackModifiers&&(!e.character||!e.gameManager.stateManager.characterPermissions[e.character.name+"|"+e.character.edition]),e.edit&&e.deletedCards.length)),t.R7$(3),t.Y8G("ghs-label",2==e.reveal?"game.cards.coverAll":0==e.reveal?"game.cards.revealAll":"game.cards.revealAllConfirm"),t.R7$(),t.Y8G("ghs-tooltip","game.cards.shuffle.upcomingHint")("overlayX","center"),t.R7$(),t.Y8G("ghs-label","game.cards.shuffle"),t.R7$(),t.vxM(e.hasDrawnDiscards()?8:-1),t.R7$(),t.vxM(e.gameManager.bbRules()&&e.settingsManager.settings.bbAm?-1:9),t.R7$(),t.vxM(e.gameManager.bbRules()&&e.settingsManager.settings.bbAm?10:-1),t.R7$(),t.vxM(e.gameManager.bbRules()||e.edit||e.townGuard?-1:11),t.R7$(),t.vxM(e.edit||e.townGuard||!e.empowerChars.length&&!e.enfeebleChars.length?-1:12),t.R7$(),t.vxM(e.edit?13:-1),t.R7$(),t.vxM(e.edit&&!e.townGuard?14:-1),t.R7$(),t.vxM(e.edit&&e.townGuard?15:-1),t.R7$(),t.vxM(e.character&&e.gameManager.gh2eRules()&&(e.edit||e.gameManager.game.scenario&&0==e.gameManager.game.round&&"draw"==e.gameManager.game.state)?16:-1),t.R7$(),t.vxM(e.bbTable?-1:17),t.R7$(),t.vxM(e.bbTable?18:-1))},dependencies:[N.YU,V.O7,V.T1,V.Fb,We,it,Mt,dt,ct],styles:['.attack-modifiers-dialog[_ngcontent-%COMP%]{position:relative}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;flex-wrap:wrap;max-width:calc(var(--ghs-unit) * 60 * var(--ghs-dialog-factor))}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]{display:flex;max-width:calc(100% - var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor) * 2)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   span.item[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   span.item[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-darkgray)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:auto}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0;color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));text-shadow:var(--ghs-outline)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   .badge.badge-character-icon[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   .badge.badge-character-icon[_ngcontent-%COMP%]{bottom:calc(var(--ghs-unit) * -.8 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor))}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   .badge.badge-character-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   .badge.badge-character-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{position:absolute;left:0;bottom:0}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:auto}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless.additional-modifier[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier.additional-modifier[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(6,1fr)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .factions-modifier[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .factions-modifier[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .factions-modifier[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));opacity:.5}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .factions-modifier[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:90%;height:auto;filter:var(--ghs-filter-white)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .factions-modifier[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction.active[_ngcontent-%COMP%]{opacity:1}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .factions-modifier[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction[_ngcontent-%COMP%]:hover{opacity:.7}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .factions-modifier[_ngcontent-%COMP%]   .attack-modifier-list[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .factions-modifier[_ngcontent-%COMP%]   .attack-modifier-list[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]{position:relative;cursor:pointer;display:block;width:calc(var(--ghs-unit) * 13.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 9 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor));filter:grayscale(.8)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .factions-modifier[_ngcontent-%COMP%]   .attack-modifier-list[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]:hover{filter:grayscale(.4)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .factions-modifier[_ngcontent-%COMP%]   .attack-modifier-list[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]:hover   ghs-attackmodifier[_ngcontent-%COMP%]{border-color:var(--ghs-color-darkgray);top:0%;left:0%;width:100%;height:100%}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .factions-modifier[_ngcontent-%COMP%]   .attack-modifier-list[_ngcontent-%COMP%]   .am.disabled[_ngcontent-%COMP%]{cursor:not-allowed;filter:grayscale(1);opacity:.7}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .factions-modifier[_ngcontent-%COMP%]   .attack-modifier-list[_ngcontent-%COMP%]   .am.disabled[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%]{top:7%;left:7%;width:86%;height:86%}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .factions-modifier[_ngcontent-%COMP%]   .attack-modifier-list[_ngcontent-%COMP%]   .am.disabled[_ngcontent-%COMP%]:hover   ghs-attackmodifier[_ngcontent-%COMP%]{top:5%;left:5%;width:90%;height:90%}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .factions-modifier[_ngcontent-%COMP%]   .attack-modifier-list[_ngcontent-%COMP%]   .am.active[_ngcontent-%COMP%]{filter:none;opacity:1}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .factions-modifier[_ngcontent-%COMP%]   .attack-modifier-list[_ngcontent-%COMP%]   .am.active[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%]{border-color:var(--ghs-color-gray);top:0%;left:0%;width:100%;height:100%}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .factions-modifier[_ngcontent-%COMP%]   .attack-modifier-list[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%]{position:absolute;display:flex;top:5%;left:5%;width:90%;height:90%;border:calc(var(--ghs-unit) * .15 * var(--ghs-dialog-factor)) solid transparent;border-radius:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{cursor:pointer;appearance:none;background-color:var(--form-background);width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));border-width:calc(var(--ghs-unit) * .3);border-style:solid;display:grid;place-content:center;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before{left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));position:relative;content:" ";width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));transform:scale(0);transform-origin:bottom left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;clip-path:polygon(14% 44%,0 65%,50% 100%,100% 16%,80% 0%,43% 62%);color:var(--ghs-color-gray);background-color:var(--ghs-color-gray)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked:before{transform:scale(1)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover:before{background-color:var(--ghs-color-white)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .insert-menu[_ngcontent-%COMP%]{display:flex;align-items:center;flex-basis:100%;flex-shrink:0;max-width:calc(100% - var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor) * 2)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .insert-menu[_ngcontent-%COMP%]   .attack-modifier[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));flex-grow:1}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .insert-menu[_ngcontent-%COMP%]   .attack-modifier[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;max-height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:auto;border-radius:5%}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .insert-menu[_ngcontent-%COMP%]   .attack-modifier[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 19.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 13 * var(--ghs-dialog-factor))}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .insert-menu[_ngcontent-%COMP%]   .icon-button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .insert-menu[_ngcontent-%COMP%]   .icon-button[_ngcontent-%COMP%]:hover{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu.has-deleted[_ngcontent-%COMP%]{max-width:calc(var(--ghs-unit) * 90 * var(--ghs-dialog-factor))}.attack-modifiers-dialog[_ngcontent-%COMP%]   .drop-list[_ngcontent-%COMP%]{position:relative}.attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]{display:flex;width:calc(var(--ghs-unit) * 60 * var(--ghs-dialog-factor));overflow:auto}.attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;overflow-y:auto;overflow-x:hidden;width:calc(var(--ghs-unit) * 30 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .attack-modifier-container[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .attack-modifier-container[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .attack-modifier-container[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{position:relative;display:flex;transition:none;width:calc(var(--ghs-unit) * 25.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 17 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) 0;flex-shrink:0;flex-grow:0}.attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .attack-modifier-container[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .attack-modifier-container[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .attack-modifier-container[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%]{position:absolute;display:flex;top:0;left:0;width:100%;height:100%}.attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .7 * var(--ghs-dialog-factor));display:block;border-style:dashed;border-width:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor));border-color:var(--ghs-color-white);width:calc(var(--ghs-unit) * 25.1 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 16.6 * var(--ghs-dialog-factor));border-radius:5%}.attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]{z-index:1;position:absolute;display:flex;cursor:pointer;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-filter-white) var(--ghs-filter-shadow)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-shadow)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-remove.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-restore.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-remove.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-restore.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .button-remove.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .button-restore.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-green) var(--ghs-filter-shadow)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{position:absolute;cursor:grab;left:50%;top:50%;width:50%;height:70%;transform:translate(-50%,-50%)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container.has-deleted[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 90 * var(--ghs-dialog-factor))}.attack-modifiers-dialog[_ngcontent-%COMP%]   .bb-table[_ngcontent-%COMP%]{display:grid;justify-items:center;grid-template-columns:auto auto auto}.attack-modifiers-dialog[_ngcontent-%COMP%]   .bb-table[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;transition:none;width:calc(var(--ghs-unit) * 18 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.attack-modifiers-dialog[_ngcontent-%COMP%]   .bb-table[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));width:auto;filter:var(--ghs-filter-white)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .bb-table[_ngcontent-%COMP%]   .attack-modifier-container[_ngcontent-%COMP%]{position:relative;display:flex;transition:none;width:calc(var(--ghs-unit) * 18 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 12 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));flex-shrink:0;flex-grow:0;border-radius:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.attack-modifiers-dialog[_ngcontent-%COMP%]   .bb-table[_ngcontent-%COMP%]   .attack-modifier-container.drawn[_ngcontent-%COMP%]{filter:grayscale(.7)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .bb-table[_ngcontent-%COMP%]   .attack-modifier-container.current[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .bb-table[_ngcontent-%COMP%]   .attack-modifier-container[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%]{position:absolute;display:flex;top:0;left:0;width:100%;height:100%}.cdk-drag-preview[_ngcontent-%COMP%]{opacity:0;cursor:grabbing;z-index:999}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.5;cursor:grabbing}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}']})}return a})();const e4=["menu"],a4=["drawCard"],i4=(a,r,n)=>({disabled:a,vertical:r,character:n}),o4=a=>({denied:a}),s4=(a,r)=>({"town-guard":a,disabled:r}),r4=a=>({"has-shuffle":a}),c4=(a,r)=>({vertical:a,minimize:r}),l4=(a,r,n)=>({vertical:a,"without-fullscreen":r,minimize:n}),Hs=(a,r,n,i)=>({vertical:a,"without-fullscreen":r,minimize:n,"has-shuffle":i}),g4=(a,r,n,i,e,o,g,m,k,X,at)=>({discarded:a,current:r,last:n,bottom:i,rolling:e,active:o,"discard-active":g,animate:m,"animate-reverse":!1,disabled:k,highlight:X,ignored:at}),Ks=(a,r)=>({bottom:a,disabled:r}),Bi=(a,r)=>r._trackUUID;function d4(a,r){1&a&&t.nrm(0,"img",15)}function h4(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",13),t.bIt("click",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.openBattleGoals(e))}),t.nrm(1,"img",14),t.nVh(2,d4,1,0,"img",15),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ghs-label","game.battleGoals")("ghs-label-attribute","title"),t.R7$(),t.Y8G("src",n.settingsManager.settings.fhStyle?"./assets/images/fh/battlegoals/battle-goal-back-fh.png":"./assets/images/battlegoals/battle-goal-back.png",t.B4B),t.R7$(),t.vxM(n.character.battleGoal&&n.character.battleGoals.length>0?2:-1)}}function _4(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.JRh(n.deck.current<n.deck.cards.length-1?n.deck.cards.length-n.deck.current-1+"/"+n.deck.cards.length:"")}}function m4(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.JRh(n.bbCurrent+"/"+n.bbRows)}}function p4(a,r){1&a&&t.nrm(0,"img",6),2&a&&t.Y8G("ghs-label","game.cards.shuffle")("ghs-label-attribute","title")}function u4(a,r){if(1&a&&(t.j41(0,"span",7),t.EFF(1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.JRh(n.numeration)}}function f4(a,r){if(1&a&&(t.j41(0,"span",8),t.nrm(1,"img",14),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("src",n.characterIcon,t.B4B)}}function C4(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",16),t.bIt("click",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.openFullscreen(e))}),t.nrm(1,"img",17),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ghs-label","game.cards.fullscreen")("ghs-label-attribute","title")("ngClass",t.l_i(3,c4,n.vertical,!n.deck.active))}}function M4(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",18),t.bIt("click",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.open(e))}),t.nrm(1,"img",19),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ghs-label","game.cards.openDialog")("ghs-label-attribute","title")("ngClass",t.sMw(3,l4,n.vertical,!n.fullscreen,!n.deck.active))}}function v4(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",20),t.bIt("click",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.draw(e,"advantage"))}),t.nrm(1,"img",14),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ghs-label","game.cards.drawAdvantage")("ghs-label-attribute","title")("ngClass",t.ziG(4,Hs,n.vertical,!n.fullscreen,!n.deck.active,n.deck.current>=n.deck.cards.length-1)),t.R7$(),t.Y8G("src","./assets/images/"+(n.settingsManager.settings.fhStyle?"fh/":"")+"condition/strengthen.svg",t.B4B)}}function O4(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",21),t.bIt("click",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.draw(e,"disadvantage"))}),t.nrm(1,"img",14),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ghs-label","game.cards.drawDisadvantage")("ghs-label-attribute","title")("ngClass",t.ziG(4,Hs,n.vertical,!n.fullscreen,!n.deck.active,n.deck.current>=n.deck.cards.length-1)),t.R7$(),t.Y8G("src","./assets/images/"+(n.settingsManager.settings.fhStyle?"fh/":"")+"condition/muddle.svg",t.B4B)}}function P4(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",23),t.bIt("click",function(e){c.eBV(n);const o=t.XpG().$index,g=t.XpG(2);return c.Njj(g.clickCard(o,e))}),t.nrm(1,"ghs-attackmodifier",24),t.k0s()}if(2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG(2),g=t.sdS(3);t.xc7("z-index",e>o.current?o.deck.cards.length-e:o.deck.cards.length+e+1)("left",!o.vertical&&e<o.current&&(e>=o.lastVisible||i.active&&!o.deck.discarded.includes(e))?"calc(75% + "+(o.current-e-1+(i.active&&e<o.lastVisible?e-o.lastVisible+o.activeAMs.indexOf(i)+1:0))+" * 25%)":"")("top",o.vertical&&e<o.current&&(e>=o.lastVisible||i.active&&!o.deck.discarded.includes(e))?"calc("+(o.current-e-1+(i.active&&e<o.lastVisible?e-o.lastVisible+o.activeAMs.indexOf(i)+1:0))*(g.offsetHeight/1.3)+"px)":""),t.Y8G("ngClass",t.zJS(18,g4,[e<o.current-1,e==o.current,e==o.current-1,o.bottom,i.rolling&&e<=o.current,i.active&&e<=o.current&&!o.deck.discarded.includes(e),o.deck.discarded.includes(e),e<o.current-1&&e>=o.lastVisible,o.disabled,!o.drawing&&o.deck.state&&e==o.current,!o.drawing&&"disadvantage"==o.deck.state&&(e<o.current||!o.gameManager.fhRules()&&!o.settingsManager.settings.alwaysFhAdvantage)&&i.rolling]))("ghs-label","game.cards.openDialog")("ghs-label-attribute","title"),t.R7$(),t.Y8G("attackModifier",i)("numeration",o.numeration)("characterIcon",o.characterIcon)("ally",o.ally)("flipped",e<=o.current)("disableFlip",!o.drawing||e!=o.current)("newStyle",o.newStyle)("townGuard",o.townGuard)("bbIndex",o.deck.bb?e%3:-1)}}function b4(a,r){if(1&a&&t.nVh(0,P4,2,30,"div",22),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.vxM(i<=e.current+1&&(i>=e.lastVisible||n.active&&!e.deck.discarded.includes(i))?0:-1)}}function k4(a,r){if(1&a&&(t.Z7z(0,b4,1,1,null,null,Bi),t.nI1(2,"trackUUID")),2&a){const n=t.XpG();t.Dyx(t.bMT(2,0,n.deck.cards))}}function y4(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",26),t.bIt("click",function(e){c.eBV(n);const o=t.XpG().$index,g=t.XpG(2);return c.Njj(g.clickCard(o,e))}),t.nrm(1,"ghs-attackmodifier",24),t.k0s()}if(2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG(2);t.xc7("z-index",o.deck.cards.length+2),t.Y8G("ngClass",t.l_i(14,Ks,o.bottom,o.disabled))("ghs-label","game.cards.openDialog")("ghs-label-attribute","title"),t.R7$(),t.Y8G("attackModifier",i)("numeration",o.numeration)("characterIcon",o.characterIcon)("ally",o.ally)("flipped",!0)("disableFlip",!o.drawing)("newStyle",o.newStyle)("townGuard",o.townGuard)("bbIndex",o.deck.bb?e%3:-1)}}function x4(a,r){if(1&a&&t.nVh(0,y4,2,17,"div",25),2&a){const n=r.$index,i=t.XpG(2);t.vxM(n==i.current?0:-1)}}function E4(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",28),t.bIt("click",function(e){c.eBV(n);const o=t.XpG().$index,g=t.XpG(2);return c.Njj(g.clickCard(o,e))}),t.nrm(1,"ghs-attackmodifier",24),t.k0s()}if(2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG(2);t.xc7("z-index",o.deck.cards.length+1),t.Y8G("ngClass",t.l_i(14,Ks,o.bottom,o.disabled))("ghs-label","game.cards.openDialog")("ghs-label-attribute","title"),t.R7$(),t.Y8G("attackModifier",i)("numeration",o.numeration)("characterIcon",o.characterIcon)("ally",o.ally)("flipped",!0)("disableFlip",!o.drawing)("newStyle",o.newStyle)("townGuard",o.townGuard)("bbIndex",o.deck.bb?e%3:-1)}}function w4(a,r){if(1&a&&t.nVh(0,E4,2,17,"div",27),2&a){const n=r.$index,i=t.XpG(2);t.vxM(i.deck.state&&i.current>=0&&i.lastVisible>=0&&n==i.lastVisible?0:-1)}}function R4(a,r){if(1&a&&(t.Z7z(0,x4,1,1,null,null,Bi),t.nI1(2,"trackUUID"),t.Z7z(3,w4,1,1,null,null,Bi),t.nI1(5,"trackUUID")),2&a){const n=t.XpG();t.Dyx(t.bMT(2,0,n.deck.cards)),t.R7$(3),t.Dyx(t.bMT(5,2,n.deck.cards))}}class mt{deck;type;values;constructor(r,n,...i){this.deck=r,this.type=n,this.values=i}}let ye=(()=>{class a{element;dialog;ghsManager;deck;character;ally=!1;numeration="";bottom=!1;before=new t.bkB;after=new t.bkB;menuElement;fullscreen=!0;vertical=!1;townGuard=!1;battleGoals=!0;standalone=!1;edition;initTimeout=1500;gameManager=s.E;settingsManager=p.f;GameState=D.mk;reveal=0;edit=!1;maxHeight="";characterIcon="";AttackModifierType=w.Yn;type=w.Yn.minus1;current=-1;lastVisible=0;drawing=!1;drawTimeout=null;queue=0;queueTimeout=null;newStyle=!1;init=!1;disabled=!1;compact=!1;initServer=!1;bbCurrent=0;bbRows=0;activeAMs=[];drawCard;constructor(n,i,e){this.element=n,this.dialog=i,this.ghsManager=e,this.element.nativeElement.addEventListener("pointerdown",o=>{let g=document.elementsFromPoint(o.clientX,o.clientY);g[0].classList.contains("attack-modifiers")&&g.length>2&&g[2].click()})}ngOnInit(){this.character?(this.deck=this.character.attackModifierDeck,this.edition=this.character.edition,this.numeration=""+this.character.number,this.characterIcon=this.character.iconUrl):(this.battleGoals=!1,this.characterIcon=""),this.current=this.deck.current,this.lastVisible=this.deck.lastVisible,this.compact=!this.drawing&&this.fullscreen&&p.f.settings.automaticAttackModifierFullscreen&&p.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400),this.deck.bb&&(this.bbCurrent=Math.ceil((this.deck.current+1)/3),this.bbRows=Math.ceil(this.deck.cards.length/3)),this.init||(this.drawTimeout=setTimeout(()=>{this.current=this.deck.current,this.lastVisible=this.deck.lastVisible,this.drawTimeout=null,this.init=!0},p.f.settings.animations?this.initTimeout*p.f.settings.animationSpeed:0)),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:n=>{this.update(n)}}),this.edition&&!this.newStyle&&(this.newStyle=s.E.newAmStyle(this.edition)),p.f.settings.fhStyle&&(this.newStyle=!0),this.disabled=!this.standalone&&(!this.townGuard&&s.E.game.state==D.mk.draw||this.townGuard&&null!=s.E.game.scenario),window.addEventListener("resize",n=>{this.compact=p.f.settings.automaticAttackModifierFullscreen&&p.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)}),window.addEventListener("fullscreenchange",n=>{this.compact=p.f.settings.automaticAttackModifierFullscreen&&p.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}ngOnChanges(n){n.deck?this.update():n.character&&this.initCharacter()}initCharacter(){this.character&&(this.deck=this.character.attackModifierDeck,this.edition=this.character.edition,this.numeration=""+this.character.number,this.characterIcon=this.character.iconUrl,this.queue=0,this.drawing=!1,this.current=this.deck.current,this.lastVisible=this.deck.lastVisible)}update(n=!1){this.character?(this.deck=this.character.attackModifierDeck,this.edition=this.character.edition,this.numeration=""+this.character.number,this.characterIcon=this.character.iconUrl):(this.battleGoals=!1,this.characterIcon=""),this.disabled=!this.standalone&&(!this.townGuard&&s.E.game.state==D.mk.draw||this.townGuard&&null!=s.E.game.scenario),this.character&&this.deck!=this.character.attackModifierDeck&&(this.deck=this.character.attackModifierDeck),this.initServer&&s.E.stateManager.wsState()!=WebSocket.OPEN&&(this.initServer=!1),this.deck.active?!this.init||n&&!this.initServer?(this.current=this.deck.current,this.lastVisible=this.deck.lastVisible,n&&!this.initServer&&(this.initServer=!0)):this.current<this.deck.current?(this.queue=Math.max(0,this.deck.current-this.current),this.queueTimeout||(this.deck.bb?(this.queue=0,this.current=this.deck.current,this.lastVisible=this.deck.lastVisible,this.drawQueue()):(this.queue--,this.current++,this.lastVisible=this.deck.lastVisible,this.drawQueue()))):(!this.queueTimeout||this.deck.current<this.current+this.queue)&&(this.queueTimeout&&(clearTimeout(this.queueTimeout),this.queueTimeout=null),this.queue=0,this.drawing=!1,this.current=this.deck.current,this.lastVisible=this.deck.lastVisible):(this.queueTimeout&&(clearTimeout(this.queueTimeout),this.queueTimeout=null),this.queue=0,this.drawing=!1,this.current=this.deck.current,this.lastVisible=this.deck.lastVisible,this.initServer=s.E.stateManager.wsState()==WebSocket.OPEN),p.f.settings.fhStyle&&(this.newStyle=!0),this.deck.bb&&(this.bbCurrent=Math.ceil((this.current+1)/3),this.bbRows=Math.ceil(this.deck.cards.length/3)),this.compact=p.f.settings.automaticAttackModifierFullscreen&&p.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400),this.activeAMs=this.deck.cards.filter((i,e)=>i.active&&e<this.deck.lastVisible&&!this.deck.discarded.includes(e))}drawQueue(){this.drawing=!0,this.element.nativeElement.getElementsByClassName("attack-modifiers")[0].classList.add("drawing"),this.queueTimeout=setTimeout(()=>{this.drawing=!1,this.queueTimeout=null,this.queue>0?(this.queue--,this.current++,this.drawQueue()):(this.element.nativeElement.getElementsByClassName("attack-modifiers")[0].classList.remove("drawing"),this.queue<0&&(this.queue=0))},p.f.settings.animations?1050*p.f.settings.animationSpeed:0)}draw(n,i=void 0){this.compact&&this.fullscreen?this.openFullscreen(n):this.disabled?this.dialog.open(qs,{panelClass:["dialog"],data:{deck:this.deck,character:this.character,ally:this.ally,numeration:this.numeration,newStyle:this.newStyle,townGuard:this.townGuard,before:this.before,after:this.after}}):!this.drawTimeout&&this.deck.current<this.deck.cards.length-(0==this.queue?0:1)?this.drawTimeout=setTimeout(()=>{this.before.emit(new mt(this.deck,"draw"+(i||""))),s.E.attackModifierManager.drawModifier(this.deck,i),this.after.emit(new mt(this.deck,"draw"+(i||""))),this.drawTimeout=null},p.f.settings.animations?150*p.f.settings.animationSpeed:0):!this.drawTimeout&&this.deck.current>=this.deck.cards.length&&(this.before.emit(new mt(this.deck,"shuffle")),s.E.attackModifierManager.shuffleModifiers(this.deck),this.after.emit(new mt(this.deck,"shuffle")))}openFullscreen(n){this.dialog.open(Ci,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:{deck:this.deck,character:this.character,ally:this.ally,numeration:this.numeration,newStyle:this.newStyle,townGuard:this.townGuard,before:this.before,after:this.after}}),n.preventDefault(),n.stopPropagation()}openBattleGoals(n){this.character&&(this.dialog.open(Oi,{panelClass:["dialog"],data:{character:this.character,draw:!this.character.battleGoals||0==this.character.battleGoals.length}}),n.preventDefault(),n.stopPropagation())}clickCard(n,i){(!this.drawing||n>this.current)&&(this.deck.cards[n].active&&!this.deck.discarded.includes(n)?(this.before.emit(new mt(this.deck,"discard",n)),this.deck.discarded.push(n),this.after.emit(new mt(this.deck,"discard",n))):this.open(i))}open(n){s.E.game.state==D.mk.next&&this.fullscreen&&p.f.settings.automaticAttackModifierFullscreen&&p.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)?this.openFullscreen(n):(this.dialog.open(qs,{panelClass:["dialog"],data:{deck:this.deck,character:this.character,ally:this.ally,numeration:this.numeration,newStyle:this.newStyle,townGuard:this.townGuard,before:this.before,after:this.after}}),n.preventDefault(),n.stopPropagation())}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT),t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-attackmodifier-deck"]],viewQuery:function(i,e){if(1&i&&(t.GBs(e4,5),t.GBs(a4,5)),2&i){let o;t.mGM(o=t.lsd())&&(e.menuElement=o.first),t.mGM(o=t.lsd())&&(e.drawCard=o.first)}},inputs:{deck:"deck",character:"character",ally:"ally",numeration:"numeration",bottom:"bottom",fullscreen:"fullscreen",vertical:"vertical",townGuard:"townGuard",battleGoals:"battleGoals",standalone:"standalone",edition:"edition",initTimeout:"initTimeout"},outputs:{before:"before",after:"after"},standalone:!1,features:[t.OA$],decls:17,vars:33,consts:[["drawCard",""],[1,"attack-modifiers",3,"ngClass"],[1,"battlegoals-button",3,"ghs-label","ghs-label-attribute"],[1,"am-container","draw",3,"ngClass"],[1,"am",3,"click","ghs-label","ghs-label-attribute","ngClass"],[1,"number",3,"ngClass"],["src","./assets/images/shuffle.svg",1,"shuffle",3,"ghs-label","ghs-label-attribute"],[1,"numeration"],[1,"character-icon"],[1,"fullscreen",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"settings",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"advantage",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"disadvantage",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"battlegoals-button",3,"click","ghs-label","ghs-label-attribute"],[3,"src"],["src","./assets/images/check.svg",1,"check"],[1,"fullscreen",3,"click","ghs-label","ghs-label-attribute","ngClass"],["src","./assets/images/fullscreen.svg",1,"ghs-svg"],[1,"settings",3,"click","ghs-label","ghs-label-attribute","ngClass"],["src","./assets/images/settings.svg",1,"ghs-svg"],[1,"advantage",3,"click","ghs-label","ghs-label-attribute","ngClass"],[1,"disadvantage",3,"click","ghs-label","ghs-label-attribute","ngClass"],[1,"am-container",3,"z-index","ngClass","left","top","ghs-label","ghs-label-attribute"],[1,"am-container",3,"click","ngClass","ghs-label","ghs-label-attribute"],[1,"am",3,"attackModifier","numeration","characterIcon","ally","flipped","disableFlip","newStyle","townGuard","bbIndex"],[1,"am-container","current","animate",3,"z-index","ngClass","ghs-label","ghs-label-attribute"],[1,"am-container","current","animate",3,"click","ngClass","ghs-label","ghs-label-attribute"],[1,"am-container","discarded","animate",3,"z-index","ngClass","ghs-label","ghs-label-attribute"],[1,"am-container","discarded","animate",3,"click","ngClass","ghs-label","ghs-label-attribute"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",1),t.nVh(1,h4,3,4,"div",2),t.j41(2,"div",3,0)(4,"div",4),t.bIt("click",function(m){return c.eBV(o),c.Njj(e.draw(m))}),t.j41(5,"span",5),t.nVh(6,_4,2,1,"span"),t.nVh(7,m4,2,1,"span"),t.k0s(),t.nVh(8,p4,1,2,"img",6),t.nVh(9,u4,2,1,"span",7),t.nVh(10,f4,2,1,"span",8),t.k0s(),t.nVh(11,C4,2,6,"span",9),t.nVh(12,M4,2,7,"span",10),t.nVh(13,v4,2,9,"span",11),t.nVh(14,O4,2,9,"span",12),t.k0s(),t.nVh(15,k4,3,2),t.nVh(16,R4,6,4),t.k0s()}if(2&i){const o=t.sdS(3);t.Y8G("ngClass",t.sMw(22,i4,!e.standalone&&(!e.townGuard&&e.gameManager.game.state==e.GameState.draw||e.townGuard&&e.gameManager.game.scenario),e.vertical,e.character)),t.R7$(),t.vxM(!e.gameManager.bbRules()&&e.character&&e.battleGoals&&e.gameManager.game.scenario&&e.settingsManager.settings.battleGoals&&e.gameManager.game.round>0&&!e.settingsManager.settings.battleGoalsCharacter?1:-1),t.R7$(),t.xc7("z-index",e.deck.cards.length+1)("font-size",.08*o.offsetWidth+"px"),t.Y8G("ngClass",t.eq3(26,o4,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.attackModifiers&&(!e.character||!e.gameManager.stateManager.characterPermissions[e.character.name+"|"+e.character.edition]))),t.R7$(2),t.Y8G("ghs-label",e.compact&&e.fullscreen?"game.cards.fullscreen":e.deck.current>=e.deck.cards.length-1?"game.cards.shuffle":"game.cards.draw")("ghs-label-attribute","title")("ngClass",t.l_i(28,s4,e.townGuard,e.disabled)),t.R7$(),t.Y8G("ngClass",t.eq3(31,r4,e.deck.current>=e.deck.cards.length+(e.deck.bb?-3:-1))),t.R7$(),t.vxM(e.deck.bb?-1:6),t.R7$(),t.vxM(e.deck.bb?7:-1),t.R7$(),t.vxM(e.deck.current>=e.deck.cards.length+(e.deck.bb?-3:-1)?8:-1),t.R7$(),t.vxM(e.characterIcon||e.townGuard||e.bottom?-1:9),t.R7$(),t.vxM(e.characterIcon&&!e.bottom?10:-1),t.R7$(),t.vxM(e.fullscreen&&!e.compact?11:-1),t.R7$(),t.vxM(!e.compact||e.vertical?12:-1),t.R7$(),t.vxM(!e.deck.bb&&!e.settingsManager.settings.amAdvantage||e.compact&&!e.vertical?-1:13),t.R7$(),t.vxM(!e.deck.bb&&!e.settingsManager.settings.amAdvantage||e.compact&&!e.vertical?-1:14),t.R7$(),t.vxM(e.deck.bb?-1:15),t.R7$(),t.vxM(e.deck.bb?16:-1)}},dependencies:[N.YU,We,it,ct],styles:[".attack-modifiers[_ngcontent-%COMP%]{position:relative;width:100%;height:100%}.attack-modifiers[_ngcontent-%COMP%]   .am-container[_ngcontent-%COMP%]{position:absolute;width:40%;padding-top:26.66%;top:0;left:0;transition:filter calc(var(--ghs-animation-speed) * 1s) ease-in-out}.attack-modifiers[_ngcontent-%COMP%]   .am-container.disabled[_ngcontent-%COMP%]{filter:grayscale(.8)}.attack-modifiers[_ngcontent-%COMP%]   .am-container[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]{position:absolute;inset:0;cursor:pointer;display:block}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]{cursor:pointer;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-back.e947b7717f678f92.png);border-radius:5%;transition:filter calc(var(--ghs-animation-speed) * 2s) ease-in-out}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am.town-guard[_ngcontent-%COMP%]{background-image:url(back.86db9c801336d036.png)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am.disabled[_ngcontent-%COMP%]{cursor:initial;filter:grayscale(.8)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{display:flex;align-items:center;font-family:var(--ghs-font-text);color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);position:absolute;font-size:2em;line-height:1em;left:50%;bottom:0%;z-index:500;transform:translate(-50%)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .number.has-shuffle[_ngcontent-%COMP%]{top:0;bottom:initial}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .shuffle[_ngcontent-%COMP%]{height:22%;width:auto;position:absolute;right:5%;bottom:5%;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .numeration[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);display:flex;justify-content:center;position:absolute;left:7.5%;top:67%;z-index:2;width:20%;height:30%;color:var(--ghs-color-white);font-size:1.6em;line-height:1.5em;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-character-icon.83c1ab396221d56b.png)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .numeration.character-icon[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .character-icon.character-icon[_ngcontent-%COMP%]{align-items:center}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .numeration.character-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .character-icon.character-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:grayscale(100%) brightness(100) contrast(100%);height:70%;width:auto}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am.open-dialog[_ngcontent-%COMP%]{cursor:help}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage[_ngcontent-%COMP%]{cursor:pointer;left:-14%;font-family:var(--ghs-font-gh-title);display:flex;justify-content:center;position:absolute;color:var(--ghs-color-white);width:20%;height:30%;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-character-icon.83c1ab396221d56b.png);transition:transform calc(var(--ghs-animation-speed) * .5s) ease-in-out;transform:scale(1.2)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.minimize[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.minimize[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.minimize[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.minimize[_ngcontent-%COMP%]{transform:scale(0)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.vertical[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.vertical[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.vertical[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.vertical[_ngcontent-%COMP%]{left:initial;right:-14%}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.fullscreen[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.fullscreen[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.fullscreen[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.fullscreen[_ngcontent-%COMP%]{cursor:zoom-in;top:-9%}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.settings[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.settings[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.settings[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.settings[_ngcontent-%COMP%]{cursor:help;bottom:-9%}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.settings.without-fullscreen[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.settings.without-fullscreen[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.settings.without-fullscreen[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.settings.without-fullscreen[_ngcontent-%COMP%]{top:50%;bottom:initial;transform:translateY(-50%)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.advantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.disadvantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.advantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.disadvantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.advantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.disadvantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.advantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.disadvantage[_ngcontent-%COMP%]{left:initial;right:0;transition:transform calc(var(--ghs-animation-speed) * .1s) ease-in-out;z-index:499}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.advantage.without-fullscreen[_ngcontent-%COMP%]:not(.vertical), .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.disadvantage.without-fullscreen[_ngcontent-%COMP%]:not(.vertical), .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.advantage.without-fullscreen[_ngcontent-%COMP%]:not(.vertical), .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.disadvantage.without-fullscreen[_ngcontent-%COMP%]:not(.vertical), .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.advantage.without-fullscreen[_ngcontent-%COMP%]:not(.vertical), .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.disadvantage.without-fullscreen[_ngcontent-%COMP%]:not(.vertical), .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.advantage.without-fullscreen[_ngcontent-%COMP%]:not(.vertical), .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.disadvantage.without-fullscreen[_ngcontent-%COMP%]:not(.vertical){left:-14%;right:initial}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.advantage[_ngcontent-%COMP%]:hover, .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.disadvantage[_ngcontent-%COMP%]:hover, .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.advantage[_ngcontent-%COMP%]:hover, .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.disadvantage[_ngcontent-%COMP%]:hover, .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.advantage[_ngcontent-%COMP%]:hover, .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.disadvantage[_ngcontent-%COMP%]:hover, .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.advantage[_ngcontent-%COMP%]:hover, .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.disadvantage[_ngcontent-%COMP%]:hover{transform:scale(1.4)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.advantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.advantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.advantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.advantage[_ngcontent-%COMP%]{top:-9%}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.advantage.has-shuffle[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.advantage.has-shuffle[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.advantage.has-shuffle[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.advantage.has-shuffle[_ngcontent-%COMP%]{transform:scale(.7) translate(50%,-25%);filter:grayscale(.8)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.disadvantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.disadvantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.disadvantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.disadvantage[_ngcontent-%COMP%]{bottom:-9%}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.disadvantage.has-shuffle[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.disadvantage.has-shuffle[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.disadvantage.has-shuffle[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.disadvantage.has-shuffle[_ngcontent-%COMP%]{transform:scale(.7) translate(50%,25%);filter:grayscale(.8)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:60%;width:auto;align-self:center}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.attack-modifiers[_ngcontent-%COMP%]   .draw.denied[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw.denied[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]   *[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw.denied[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw.denied[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]   *[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw.denied[_ngcontent-%COMP%]   .am.open-dialig[_ngcontent-%COMP%]{pointer-events:initial}.attack-modifiers[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%]{cursor:pointer;position:absolute;display:flex;align-items:center;z-index:3;width:20%;left:-20%;top:50%;transform:translateY(-50%)}.attack-modifiers[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%]:hover{opacity:.7}.attack-modifiers[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80%;border-radius:5%}.attack-modifiers[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-70%,-50%);width:40%;filter:var(--ghs-filter-green) var(--ghs-filter-outline)}@keyframes _ngcontent-%COMP%_attackmodifier-draw{0%{transform:scale(1) translate(-102%,16.5%)}35%,70%{transform:scale(1.1) translate(-51%,25%)}to{transform:scale(1) translate(0)}}@keyframes _ngcontent-%COMP%_attackmodifier-draw-bottom{0%{transform:scale(1) translate(-102%,-16.5%)}35%,70%{transform:scale(2) translate(-80%,-166.5%)}to{transform:scale(1) translate(0)}}@keyframes _ngcontent-%COMP%_attackmodifier-last{0%{top:0;left:42%;transform:rotate(0)}70%{top:0;left:42%;transform:rotate(0)}to{top:16.5%;left:75%;transform:rotate(25deg)}}@keyframes _ngcontent-%COMP%_attackmodifier-rolling{0%{transform:translate(-61.85%) rotate(25deg)}70%{transform:translate(-61.85%) rotate(25deg)}to{transform:rotate(25deg)}}@keyframes _ngcontent-%COMP%_attackmodifier-active{0%{transform:translate(-61.85%) rotate(-25deg)}70%{transform:translate(-61.85%) rotate(-25deg)}to{transform:rotate(-25deg)}}@keyframes _ngcontent-%COMP%_attackmodifier-active-reverse{0%{transform:translate(61.85%) rotate(-25deg)}70%{transform:translate(61.85%) rotate(-25deg)}to{transform:rotate(-25deg)}}.attack-modifiers[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{position:absolute;top:0;left:42%;z-index:1}.attack-modifiers[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .last[_ngcontent-%COMP%]{position:absolute;top:16.5%;left:75%;transform:rotate(25deg);z-index:0}.attack-modifiers[_ngcontent-%COMP%]   .discarded.discarded[_ngcontent-%COMP%]:hover, .attack-modifiers[_ngcontent-%COMP%]   .last.discarded[_ngcontent-%COMP%]:hover{z-index:100!important}.attack-modifiers[_ngcontent-%COMP%]   .discarded.active[_ngcontent-%COMP%]:not(.last), .attack-modifiers[_ngcontent-%COMP%]   .last.active[_ngcontent-%COMP%]:not(.last){transform:rotate(-25deg)}.attack-modifiers[_ngcontent-%COMP%]   .discard-active[_ngcontent-%COMP%]{filter:grayscale(.3)}.attack-modifiers[_ngcontent-%COMP%]   .highlight[_ngcontent-%COMP%]{filter:brightness(1)}.attack-modifiers[_ngcontent-%COMP%]   .ignored[_ngcontent-%COMP%]{filter:grayscale(.8) opacity(.8)}.attack-modifiers[_ngcontent-%COMP%]   .ignored[_ngcontent-%COMP%]:hover{filter:none}.attack-modifiers.open-dialog[_ngcontent-%COMP%]{cursor:help}.attack-modifiers[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{filter:grayscale(.8)}.attack-modifiers[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]:hover{transition:filter calc(var(--ghs-animation-speed) * .25s) linear,transform calc(var(--ghs-animation-speed) * .8s) cubic-bezier(.75,0,.85,1),top calc(var(--ghs-animation-speed) * .5s) linear,left calc(var(--ghs-animation-speed) * .5s) linear;filter:grayscale(15%)}.attack-modifiers.drawing[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%], .attack-modifiers.drawing[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%]{cursor:wait!important}.attack-modifiers.drawing[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{cursor:wait!important;animation:_ngcontent-%COMP%_attackmodifier-draw calc(var(--ghs-animation-speed) * 1s) ease-in-out;animation-iteration-count:1}.attack-modifiers.drawing[_ngcontent-%COMP%]   .current.bottom[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_attackmodifier-draw-bottom calc(var(--ghs-animation-speed) * 1s) ease-in-out}.attack-modifiers.drawing[_ngcontent-%COMP%]   .last[_ngcontent-%COMP%]{cursor:wait!important;animation:_ngcontent-%COMP%_attackmodifier-last calc(var(--ghs-animation-speed) * 1s) ease-in-out;animation-iteration-count:1}.attack-modifiers.drawing[_ngcontent-%COMP%]   .animate.rolling[_ngcontent-%COMP%]{cursor:wait!important;animation:_ngcontent-%COMP%_attackmodifier-rolling calc(var(--ghs-animation-speed) * 1s) ease-in-out;animation-iteration-count:1}.attack-modifiers.drawing[_ngcontent-%COMP%]   .animate.active[_ngcontent-%COMP%]{cursor:wait!important;animation:_ngcontent-%COMP%_attackmodifier-active calc(var(--ghs-animation-speed) * 1s) ease-in-out;animation-iteration-count:1}.attack-modifiers.drawing[_ngcontent-%COMP%]   .animate-reverse.active[_ngcontent-%COMP%]{cursor:wait!important;animation:_ngcontent-%COMP%_attackmodifier-active-reverse calc(var(--ghs-animation-speed) * 1s) ease-in-out;animation-iteration-count:1}.vertical[_ngcontent-%COMP%]   .am-container[_ngcontent-%COMP%]{top:0;left:0;width:60%;padding-top:40%}.vertical[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{top:0;position:absolute;transform:translateY(120%);z-index:1}.vertical[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%], .vertical[_ngcontent-%COMP%]   .last[_ngcontent-%COMP%]{position:absolute;top:0;left:45%;transform:translateY(140%) rotate(25deg);z-index:0}.vertical[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%]{width:27%;left:72%;top:12%}@keyframes _ngcontent-%COMP%_attackmodifier-draw-vertical{0%{transform:scale(1)}35%,70%{transform:scale(1.1) translate(15%,125%)}to{transform:scale(1) translateY(120%)}}@keyframes _ngcontent-%COMP%_attackmodifier-last-vertical{0%{left:0;transform:translateY(120%) rotate(0)}70%{left:0;transform:translateY(120%) rotate(0)}to{left:45%;transform:translateY(140%) rotate(25deg)}}.vertical.drawing[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_attackmodifier-draw-vertical calc(var(--ghs-animation-speed) * 1s) ease-in-out}.vertical.drawing[_ngcontent-%COMP%]   .last[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_attackmodifier-last-vertical calc(var(--ghs-animation-speed) * 1s) ease-in-out}"]})}return a})();const j4=["drawCard"],G4=a=>({character:a}),T4=(a,r)=>r._trackUUID;function S4(a,r){if(1&a&&(t.j41(0,"div",1),t.nrm(1,"ghs-attackmodifier",2),t.k0s()),2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG();t.R7$(),t.Y8G("attackModifier",i)("numeration",o.numeration)("characterIcon",o.characterIcon)("flipped",e==o.current)("newStyle",o.newStyle)}}function D4(a,r){if(1&a&&t.nVh(0,S4,2,5,"div",1),2&a){const n=r.$index,i=t.XpG();t.vxM(n==i.current?0:-1)}}let $4=(()=>{class a{element;ghsManager;character;drawingEmitter=new t.bkB;initTimeout=1500;gameManager=s.E;settingsManager=p.f;deck;numeration="";characterIcon="";AttackModifierType=w.Yn;current=-1;drawing=!1;drawTimeout=null;queue=0;queueTimeout=null;newStyle=!1;drawCard;constructor(n,i){this.element=n,this.ghsManager=i,this.element.nativeElement.addEventListener("pointerdown",e=>{let o=document.elementsFromPoint(e.clientX,e.clientY);o[0].classList.contains("attack-modifiers")&&o.length>2&&o[2].click()})}ngOnInit(){this.character&&(this.deck=this.character.attackModifierDeck,this.characterIcon=this.character.iconUrl,this.numeration=""+this.character.number,this.newStyle=s.E.newAmStyle(this.character.edition)),p.f.settings.fhStyle&&(this.newStyle=!0),this.current=this.deck.current,this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}ngOnChanges(n){n.deck&&this.update()}update(){this.character&&this.deck!=this.character.attackModifierDeck&&(this.deck=this.character.attackModifierDeck),this.current<this.deck.current?(this.queue=Math.max(0,this.deck.current-this.current),this.queueTimeout||(this.queue--,this.current++,this.drawQueue())):(!this.queueTimeout||this.deck.current<this.current+this.queue)&&(this.queueTimeout&&(clearTimeout(this.queueTimeout),this.queueTimeout=null),this.queue=0,this.drawing=!1,this.drawingEmitter.emit(!1),this.current=this.deck.current)}drawQueue(){this.drawing=!0,this.drawingEmitter.emit(!0),this.element.nativeElement.getElementsByClassName("attack-modifier-draw")[0].classList.add("drawing"),this.queueTimeout=setTimeout(()=>{this.drawing=!1,this.drawingEmitter.emit(!1),this.queueTimeout=null,this.queue>0?(this.queue--,this.current++,this.drawQueue()):(this.element.nativeElement.getElementsByClassName("attack-modifier-draw")[0].classList.remove("drawing"),this.queue<0&&(this.queue=0))},p.f.settings.animations?2500*p.f.settings.animationSpeed:0)}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-attackmodifier-draw"]],viewQuery:function(i,e){if(1&i&&t.GBs(j4,5),2&i){let o;t.mGM(o=t.lsd())&&(e.drawCard=o.first)}},inputs:{character:"character",initTimeout:"initTimeout"},outputs:{drawingEmitter:"drawing"},standalone:!1,features:[t.OA$],decls:4,vars:5,consts:[[1,"attack-modifier-draw",3,"ngClass"],[1,"am-container"],[1,"am",3,"attackModifier","numeration","characterIcon","flipped","newStyle"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.Z7z(1,D4,1,1,null,null,T4),t.nI1(3,"trackUUID"),t.k0s()),2&i&&(t.Y8G("ngClass",t.eq3(3,G4,e.character)),t.R7$(),t.Dyx(t.bMT(3,1,e.deck.cards)))},dependencies:[N.YU,We,ct],styles:[".attack-modifier-draw[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;overflow:visible}.attack-modifier-draw[_ngcontent-%COMP%]   .am-container[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;transition:filter calc(var(--ghs-animation-speed) * 1s) ease-in-out;transform:scale(0)}.attack-modifier-draw[_ngcontent-%COMP%]   .am-container[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]{display:block;position:absolute;inset:0}@keyframes _ngcontent-%COMP%_attackmodifier-draw{0%{transform:scale(0) translate(-152%,-16.5%)}35%,70%{transform:scale(1) translate(-50%,-50%)}to{transform:scale(0) translate(0)}}.attack-modifier-draw.drawing[_ngcontent-%COMP%]   .am-container[_ngcontent-%COMP%]{cursor:wait!important;animation:_ngcontent-%COMP%_attackmodifier-draw calc(var(--ghs-animation-speed) * 2.5s) ease-in-out;animation-iteration-count:1;transform-origin:top left}"]})}return a})();const I4=a=>({critical:a});let Ws=(()=>{class a{entity;diff=0;maxHealth(){return(0,A.hZ)(this.entity.maxHealth)}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-healthbar"]],inputs:{entity:"entity",diff:"diff"},standalone:!1,decls:2,vars:5,consts:[[1,"health-bar",3,"ngClass"],[1,"health-bar-value"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nrm(1,"div",1),t.k0s()),2&i&&(t.Y8G("ngClass",t.eq3(3,I4,(e.entity.health+e.diff)/e.maxHealth()<.35)),t.R7$(),t.xc7("width",(e.entity.health+e.diff)/e.maxHealth()*100+"%"))},dependencies:[N.YU],styles:[".health-bar[_ngcontent-%COMP%]{width:100%;height:100%;border:none;background-color:transparent}.health-bar[_ngcontent-%COMP%]   .health-bar-value[_ngcontent-%COMP%]{height:100%;max-width:1000%;transition:width calc(var(--ghs-animation-speed) * .5s);background-color:var(--ghs-color-lightgreen)}.health-bar.critical[_ngcontent-%COMP%]   .health-bar-value[_ngcontent-%COMP%]{background-color:var(--ghs-color-red)}"]})}return a})();const A4=(a,r,n,i,e)=>({"active-border":a,disabled:r,off:n,"no-artwork":i,modern:e});let Zs=(()=>{class a{character;characterManager=s.E.characterManager;gameManager=s.E;settingsManager=p.f;GameState=D.mk;static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-character-image"]],inputs:{character:"character"},standalone:!1,decls:3,vars:13,consts:[[1,"image-container",3,"ngClass","ghs-label","ghs-label-attribute"],[1,"image",3,"src"],[3,"entity"]],template:function(i,e){1&i&&(t.j41(0,"a",0),t.nrm(1,"img",1)(2,"ghs-healthbar",2),t.k0s()),2&i&&(t.xc7("--ghs-character-color",e.character.color),t.Y8G("ngClass",t.s1E(7,A4,e.character.active,e.character.absent,e.character.off||e.character.exhausted||e.character.health<=0,e.character.noThumbnail||!e.settingsManager.settings.artwork,"modern"==e.settingsManager.settings.theme))("ghs-label",e.gameManager.game.state==e.GameState.next?e.character.active?"game.figure.endTurn":"game.figure.startTurn":"game.figure.setInitiative")("ghs-label-attribute","title"),t.R7$(),t.Y8G("src",e.character.noThumbnail||!e.settingsManager.settings.artwork?e.character.iconUrl:e.characterManager.characterThumbnail(e.character),t.B4B),t.R7$(),t.Y8G("entity",e.character))},dependencies:[N.YU,it,Ws],styles:[".image-container[_ngcontent-%COMP%]{position:relative;display:block;width:100%;height:100%;cursor:pointer;border-radius:calc(var(--ghs-unit) * 1);overflow:hidden;transition:box-shadow calc(var(--ghs-animation-speed) * .1s) ease-in-out}.image-container.disabled[_ngcontent-%COMP%]{pointer-events:none}.image-container[_ngcontent-%COMP%]:not(.active-border){border:calc(var(--ghs-unit) * .01) solid transparent;box-shadow:0 0 calc(var(--ghs-unit) * .5) calc(var(--ghs-unit) * .1) var(--ghs-color-darkgray)}.image-container.no-artwork[_ngcontent-%COMP%]{background-color:var(--ghs-color-darkgray);border-color:var(--ghs-character-color)}.image-container[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:auto;height:100%}.image-container[_ngcontent-%COMP%]   ghs-healthbar[_ngcontent-%COMP%]{position:absolute;bottom:0;width:100%;height:5%;left:0}.image-container.off[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{filter:grayscale(.7)}.image-container.modern[_ngcontent-%COMP%]{border-radius:0;-webkit-mask:url(char-image-mask.be960a101527d144.png);mask:url(char-image-mask.be960a101527d144.png);-webkit-mask-size:100% 100%;mask-size:100% 100%}.image-container.modern.active-border[_ngcontent-%COMP%]{border:none!important;box-shadow:none}.number-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,calc(var(--ghs-unit) * 8))}.number-container[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7);width:calc(var(--ghs-unit) * 7);font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3);color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7);width:calc(var(--ghs-unit) * 7);cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3);color:var(--ghs-color-gray);text-shadow:var(--ghs-outline)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}"]})}return a})();const V4=["initiativeInput"],F4=a=>({empty:a}),X4=a=>({hidden:a});function B4(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",6),t.bIt("click",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.enableReveal(e))}),t.EFF(1,"??"),t.k0s()}}function Y4(a,r){if(1&a){const n=t.RV6();t.j41(0,"img",7),t.bIt("click",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.longRestOff(e))}),t.k0s()}2&a&&t.Y8G("ghs-label","game.figure.longRestOff")("ghs-label-attribute","title")}let Yi=(()=>{class a{dialog;overlay;elementRef;figure;initiativeInput;characterManager=s.E.characterManager;gameManager=s.E;settingsManager=p.f;GameState=D.mk;character;objectiveContainer;reveal=0;constructor(n,i,e){this.dialog=n,this.overlay=i,this.elementRef=e}ngOnInit(){this.figure instanceof H.K?this.character=this.figure:this.figure instanceof ft.$e&&(this.objectiveContainer=this.figure)}ngAfterViewInit(){this.initiativeInput&&this.initiativeInput.nativeElement.addEventListener("keydown",n=>{if(p.f.settings.keyboardShortcuts){const i=this.tabindex();if("Tab"!==n.key&&"Enter"!==n.key||s.E.game.state!=D.mk.draw){if("Escape"===n.key){const e=document.getElementById("initiative-input-"+i);e&&document.activeElement==e&&(e.blur(),n.preventDefault(),n.stopPropagation())}else if(!n.ctrlKey&&!n.shiftKey&&"n"===n.key.toLowerCase()){const e=document.getElementById("initiative-input-"+i);e&&document.activeElement==e&&e.blur()}}else{let e=n.shiftKey?i-1:i+1,o=document.getElementById("initiative-input-"+e);if(!o&&i>0)o=document.getElementById("initiative-input-0");else if(e<0)for(e=s.E.game.figures.filter(g=>g instanceof H.K&&!g.absent&&(g.initiativeVisible||!g.initiative)).length-1,o=document.getElementById("initiative-input-"+e);!o&&e>0;)e--,o=document.getElementById("initiative-input-"+e);o&&o.focus(),n.preventDefault(),n.stopPropagation()}}})}initiativeHidden(){return s.E.game.state==D.mk.draw&&this.figure instanceof H.K&&!this.figure.initiativeVisible}updateInitiative(n){this.reveal&&this.disableReveal();const i=isNaN(+n.target.value)?0:+n.target.value;((s.E.game.state==D.mk.draw||!p.f.settings.initiativeRequired)&&i>=0||i>0)&&i<100?this.setInitiative(i):n.target.value=(this.figure.initiative<10?"0":"")+this.figure.initiative}enableReveal(n){this.initiativeInput&&(this.reveal=this.figure.initiative,this.figure.initiative=0,setTimeout(()=>{this.initiativeInput.nativeElement.focus()},1),n.preventDefault(),n.stopPropagation())}disableReveal(){this.reveal&&(this.figure.initiative=this.reveal,this.reveal=0)}setInitiative(n){((s.E.game.state==D.mk.draw||!p.f.settings.initiativeRequired)&&n>=0||n>0)&&n<100&&n!=this.figure.initiative&&(this.character&&(s.E.stateManager.before("setInitiative",s.E.characterManager.characterName(this.character),""+n),this.character.initiativeVisible=!0,("prism"!=this.character.name||!this.character.tags.includes("long_rest"))&&(this.character.longRest=!1),99==n&&(this.character.longRest=!0)),this.figure.initiative=n,s.E.game.state==D.mk.next&&s.E.sortFigures(this.character),s.E.stateManager.after())}longRestOff(n){this.character&&this.character.longRest&&(s.E.stateManager.before("characterLongRestOff",s.E.characterManager.characterName(this.character)),this.character.longRest=!1,s.E.game.state==D.mk.next&&s.E.sortFigures(this.character),s.E.stateManager.after(),n.preventDefault())}open(n){this.dialog.open(ji,{panelClass:["dialog"],data:this.figure,positionStrategy:this.overlay.position().flexibleConnectedTo(this.elementRef).withPositions((0,F.yE)())})}tabindex(){return s.E.game.figures.filter(n=>n instanceof H.K&&!n.absent&&!n.exhausted&&(n.initiativeVisible||!n.initiative)).indexOf(this.figure)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG),t.rXU(qt.hJ),t.rXU(t.aKT))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-character-initiative"]],viewQuery:function(i,e){if(1&i&&t.GBs(V4,5),2&i){let o;t.mGM(o=t.lsd())&&(e.initiativeInput=o.first)}},inputs:{figure:"figure"},standalone:!1,decls:6,vars:13,consts:[["initiativeInput",""],[1,"initiative",3,"ngClass","ghs-label","ghs-label-attribute"],["src","./assets/images/initiative.svg",1,"ghs-svg",3,"click"],["type","number","max","99","maxlength","2",3,"change","focus","blur","ngClass","value","min","id"],[1,"hidden-initiative"],["src","./assets/images/long-rest.svg",1,"ghs-svg","long-rest",3,"ghs-label","ghs-label-attribute"],[1,"hidden-initiative",3,"click"],["src","./assets/images/long-rest.svg",1,"ghs-svg","long-rest",3,"click","ghs-label","ghs-label-attribute"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",1)(1,"img",2),t.bIt("click",function(m){return c.eBV(o),c.Njj(e.open(m))}),t.k0s(),t.j41(2,"input",3,0),t.bIt("change",function(m){return c.eBV(o),c.Njj(e.updateInitiative(m))})("focus",function(){c.eBV(o);const m=t.sdS(3);return c.Njj(m.select())})("blur",function(){return c.eBV(o),c.Njj(e.disableReveal())}),t.k0s(),t.nVh(4,B4,2,0,"span",4),t.nVh(5,Y4,1,2,"img",5),t.k0s()}2&i&&(t.Y8G("ngClass",t.eq3(9,F4,e.figure.initiative<=0&&(!e.settingsManager.settings.initiativeRequired||e.character&&e.character.exhausted)))("ghs-label","game.figure.setInitiative")("ghs-label-attribute","title"),t.R7$(2),t.Y8G("ngClass",t.eq3(11,X4,e.figure.initiative>0&&e.initiativeHidden()&&!e.reveal))("value",e.figure.initiative>0&&(e.figure.initiative<10&&e.figure.initiative>0?"0"+e.figure.initiative:e.figure.initiative)||"")("min",e.gameManager.game.state==e.GameState.draw?0:1)("id","initiative-input-"+e.tabindex()),t.R7$(2),t.vxM(e.figure.initiative>0&&e.initiativeHidden()&&!e.reveal?4:-1),t.R7$(),t.vxM(e.character&&!e.initiativeHidden()&&e.character.longRest?5:-1))},dependencies:[N.YU,it],styles:[".initiative[_ngcontent-%COMP%]{position:relative;display:flex;height:100%;flex-direction:column;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline);transition:width calc(var(--ghs-animation-speed) * .5s) ease-in-out;width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor))}.initiative[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{cursor:pointer;width:calc(var(--ghs-unit) * 2.7 * var(--ghs-text-factor));height:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.initiative[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.initiative[_ngcontent-%COMP%]   img.long-rest[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));position:absolute;bottom:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.initiative[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:pointer;text-align:center;border:none;background:none;width:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 6.5 * var(--ghs-text-factor));margin-top:calc(var(--ghs-unit) * -.7 * var(--ghs-text-factor));padding:0;font-family:var(--ghs-font-title);color:var(--ghs-color-white);text-shadow:var(--ghs-outline);font-size:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor));-moz-appearance:textfield}.initiative[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-outer-spin-button, .initiative[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.initiative[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .initiative[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus-visible, .initiative[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active, .initiative[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover{border:none;outline:none!important}.initiative[_ngcontent-%COMP%]   input.hidden[_ngcontent-%COMP%]{display:none}.initiative[_ngcontent-%COMP%]   .hidden-initiative[_ngcontent-%COMP%]{display:block;text-align:center;margin-top:calc(var(--ghs-unit) * -.7 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 6.5 * var(--ghs-text-factor))}.initiative.empty[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor))}.initiative.empty[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .initiative.empty[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;transition:opacity calc(var(--ghs-animation-speed) * .5s) ease-in-out}.initiative.empty[_ngcontent-%COMP%]:hover, .initiative.empty[_ngcontent-%COMP%]:focus-within{width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor))}.initiative.empty[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%], .initiative.empty[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .initiative.empty[_ngcontent-%COMP%]:focus-within   img[_ngcontent-%COMP%], .initiative.empty[_ngcontent-%COMP%]:focus-within   input[_ngcontent-%COMP%]{opacity:1}"]})}return a})();const U4=(a,r)=>({active:a,disabled:r}),N4=a=>({active:a}),Js=a=>({disabled:a}),z4=a=>({spent:a}),L4=(a,r)=>r._trackUUID;function q4(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",10),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openShop())}),t.nrm(1,"img",11)(2,"span",12),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("src",n.settingsManager.settings.fhStyle?"./assets/images/fh/items/item-back-fh.png":"./assets/images/items/item-back.png",t.B4B),t.R7$(),t.Y8G("ghs-label","game.items.character.empty")}}function H4(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",2),t.nrm(1,"ghs-character-item",13),t.j41(2,"a",14),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.openItemDialog(e))}),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(4,z4,!i.setup&&i.countFlag(n,i.ItemFlags.spent))),t.R7$(),t.Y8G("character",i.character)("item",n)("setup",i.setup)}}let K4=(()=>{class a{dialog;ghsManager;character;gameManager=s.E;settingsManager=p.f;setup=!1;items=[];ItemFlags=wt.Tr;GameState=D.mk;constructor(n,i){this.dialog=n,this.ghsManager=i}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.setup=s.E.game.state==D.mk.draw&&s.E.roundManager.firstRound,this.items=(s.E.bbRules()?s.E.itemManager.getItems("bb"):this.character.progress.items.map(n=>s.E.itemManager.getItem(n.name,n.edition,!0))).filter(n=>n&&(this.setup||!p.f.settings.characterItemsPermanentEquipped||this.equipped(n))).map(n=>n).sort((n,i)=>this.sortItems(n,i))}sortItems(n,i){if(!p.f.settings.characterItemsPermanentSorted)return 0;if(!this.setup){if(this.equipped(n)&&!this.equipped(i))return-1;if(this.equipped(i)&&!this.equipped(n)||this.countFlag(n,wt.Tr.consumed)&&!this.countFlag(i,wt.Tr.consumed))return 1;if(this.countFlag(i,wt.Tr.consumed)&&!this.countFlag(n,wt.Tr.consumed))return-1}return n.slot&&!i.slot?-1:i.slot&&!n.slot?1:n.slot&&i.slot?Object.values(wt.o8).indexOf(n.slot)-Object.values(wt.o8).indexOf(i.slot):0}equipped(n){return this.character.progress.equippedItems.find(i=>i.name==""+n.id&&i.edition==n.edition)}countFlag(n,i){const e=this.equipped(n);return e&&e.tags&&e.tags.filter(o=>o==i).length||0}toggleEquipped(){p.f.settings.characterItemsPermanentEquipped=!p.f.settings.characterItemsPermanentEquipped,p.f.storeSettings()}toggleSorted(){p.f.settings.characterItemsPermanentSorted=!p.f.settings.characterItemsPermanentSorted,p.f.storeSettings()}zoom(n){p.f.settings.characterItemsPermanentZoom+=n,p.f.settings.characterItemsPermanentZoom<.5?p.f.settings.characterItemsPermanentZoom=.5:p.f.settings.characterItemsPermanentZoom>1.5&&(p.f.settings.characterItemsPermanentZoom=1.5),p.f.storeSettings(),p.f.settings.animations&&setTimeout(()=>{this.ghsManager.triggerUiChange()},500*p.f.settings.animationSpeed)}resetZoom(){p.f.settings.characterItemsPermanentZoom=1,p.f.storeSettings(),p.f.settings.animations&&setTimeout(()=>{this.ghsManager.triggerUiChange()},500*p.f.settings.animationSpeed)}openShop(){this.dialog.open(Le,{panelClass:["dialog"],data:{edition:s.E.game.edition,select:this.character,affordable:!0}})}openItemDialog(n){this.dialog.open(fn,{panelClass:["fullscreen-panel"],disableClose:!0,data:{item:n,character:this.character,setup:this.setup}})}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-character-item-list"]],inputs:{character:"character"},standalone:!1,decls:14,vars:24,consts:[[1,"item-list"],[1,"empty"],[1,"item-container",3,"ngClass"],[1,"menu"],[3,"click","ngClass","ghs-tooltip","overlayX","overlayY"],["src","./assets/images/check.svg",1,"toggle","ghs-svg"],["src","./assets/images/sort.svg",1,"toggle","ghs-svg"],["ghs-pointer-input","",3,"singleClick","doubleClick","ngClass"],["src","./assets/images/zoom-in.svg",1,"ghs-svg"],["src","./assets/images/zoom-out.svg",1,"ghs-svg"],[1,"empty",3,"click"],[3,"src"],[1,"text",3,"ghs-label"],[3,"character","item","setup"],[1,"open-dialog",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nVh(1,q4,3,2,"div",1),t.Z7z(2,H4,3,6,"div",2,L4),t.nI1(4,"trackUUID"),t.j41(5,"div",3)(6,"a",4),t.bIt("click",function(){return e.toggleEquipped()}),t.nrm(7,"img",5),t.k0s(),t.j41(8,"a",4),t.bIt("click",function(){return e.toggleSorted()}),t.nrm(9,"img",6),t.k0s(),t.j41(10,"a",7),t.bIt("singleClick",function(){return e.zoom(.075)})("doubleClick",function(){return e.resetZoom()}),t.nrm(11,"img",8),t.k0s(),t.j41(12,"a",7),t.bIt("singleClick",function(){return e.zoom(-.075)})("doubleClick",function(){return e.resetZoom()}),t.nrm(13,"img",9),t.k0s()()()),2&i&&(t.xc7("--ghs-item-list-zoom",e.settingsManager.settings.characterItemsPermanentZoom),t.R7$(),t.vxM(0==e.items.length?1:-1),t.R7$(),t.Dyx(t.bMT(4,13,e.items)),t.R7$(4),t.Y8G("ngClass",t.l_i(15,U4,e.settingsManager.settings.characterItemsPermanentEquipped,e.setup))("ghs-tooltip","game.items.character.toggleEquipped")("overlayX","end")("overlayY","bottom"),t.R7$(2),t.Y8G("ngClass",t.eq3(18,N4,e.settingsManager.settings.characterItemsPermanentSorted))("ghs-tooltip","game.items.character.toggleSorted")("overlayX","end")("overlayY","bottom"),t.R7$(2),t.Y8G("ngClass",t.eq3(20,Js,e.settingsManager.settings.characterItemsPermanentZoom>=1.5)),t.R7$(2),t.Y8G("ngClass",t.eq3(22,Js,e.settingsManager.settings.characterItemsPermanentZoom<=.5)))},dependencies:[N.YU,yi,it,Mt,dt,ct],styles:[".item-list[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;flex-wrap:wrap;padding-right:calc(var(--ghs-unit) * 4.5);--ghs-item-list-zoom: 1;min-height:calc(var(--ghs-unit) * 18 * var(--ghs-item-list-zoom))}.item-list[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;justify-content:center;align-items:center;margin:calc(var(--ghs-unit) * .5);margin-bottom:0;width:calc(var(--ghs-unit) * 12 * var(--ghs-item-list-zoom));height:calc(var(--ghs-unit) * 18 * var(--ghs-item-list-zoom));border-radius:calc(var(--ghs-unit) * 1 * var(--ghs-item-list-zoom));overflow:hidden}.item-list[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;filter:grayscale(.7)}.item-list[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{text-align:center;font-size:calc(var(--ghs-unit) * 2.6 * var(--ghs-item-list-zoom));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.item-list[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]:hover{opacity:.7}.item-list[_ngcontent-%COMP%]   .item-container[_ngcontent-%COMP%]{position:relative;margin:calc(var(--ghs-unit) * .5);margin-bottom:0;width:calc(var(--ghs-unit) * 12 * var(--ghs-item-list-zoom));height:calc(var(--ghs-unit) * 18 * var(--ghs-item-list-zoom));transition:all calc(var(--ghs-animation-speed) * .5s) ease-in-out}.item-list[_ngcontent-%COMP%]   .item-container.spent[_ngcontent-%COMP%]{transform:rotate(90deg);transform-origin:center center;margin:0 calc(var(--ghs-unit) * 3 * var(--ghs-item-list-zoom));margin-bottom:0}.item-list[_ngcontent-%COMP%]   .item-container[_ngcontent-%COMP%]   ghs-character-item[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}.item-list[_ngcontent-%COMP%]   .item-container[_ngcontent-%COMP%]   .open-dialog[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:0;left:0;width:100%;height:45%}.item-list[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;right:0;z-index:2;display:flex;flex-direction:column;flex-wrap:wrap-reverse;justify-content:flex-start;align-items:flex-end;margin-top:calc(var(--ghs-unit) * 1)}.item-list[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;margin:0 calc(var(--ghs-unit) * 1);color:var(--ghs-color-darkgray)}.item-list[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.5);height:calc(var(--ghs-unit) * 2.5);filter:var(--ghs-filter-darkgray)}.item-list[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ghs-svg.toggle[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-outline)}.item-list[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]{filter:var(--ghs-filter-green) var(--ghs-filter-outline)}.item-list[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}.item-list[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.7}.item-list[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}.item-list[_ngcontent-%COMP%]   .zoom-bar[_ngcontent-%COMP%]{z-index:1;position:absolute;display:block;height:calc(var(--ghs-unit) * 8 * var(--ghs-item-list-zoom));top:0;left:0;right:0}"]})}return a})(),$a=(()=>{class a{el;ghsManager;entityAnimation;constructor(n,i){this.el=n,this.ghsManager=i}ngOnChanges(n){if(n&&n.entityAnimation){const i=n.entityAnimation;i.currentValue!=i.previousValue&&(i.currentValue?(this.el.nativeElement.classList.add("entity-dead"),setTimeout(()=>{this.el.nativeElement.classList.remove("entity-dead"),this.ghsManager.triggerUiChange()},p.f.settings.animations?1500*p.f.settings.animationSpeed:0)):i.currentValue||(this.el.nativeElement.classList.add("entity-alive"),setTimeout(()=>{this.el.nativeElement.classList.remove("entity-alive"),this.ghsManager.triggerUiChange()},p.f.settings.animations?1500*p.f.settings.animationSpeed:0)))}}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT),t.rXU(st))};static \u0275dir=t.FsC({type:a,selectors:[["","entityAnimation",""]],inputs:{entityAnimation:"entityAnimation"},standalone:!1,features:[t.OA$]})}return a})();function W4(a,r){1&a&&(t.j41(0,"a"),t.nrm(1,"img",1),t.k0s())}const Z4=()=>[],J4=(a,r)=>r._trackUUID;function Q4(a,r){if(1&a&&(t.j41(0,"div",2)(1,"span",3),t.nrm(2,"span",4),t.k0s(),t.nrm(3,"span",5),t.k0s()),2&a){const n=r.$implicit;t.R7$(2),t.Y8G("ghs-label","game.figure.error."+n.type),t.R7$(),t.Y8G("ghs-label","game.figure.error."+n.type+".hint")("ghs-label-args",n.args)("ghs-label-args-replace",!1)}}let Qs=(()=>{class a{dialog;figure;constructor(n){this.dialog=n}ngOnInit(){this.figure.errors||(this.figure.errors=[])}open(n){this.dialog.open(tE,{panelClass:["dialog"],data:this.figure})}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-figure-errors"]],inputs:{figure:"figure"},standalone:!1,decls:2,vars:3,consts:[[1,"button",3,"click"],["src","./assets/images/warning.svg",1,"ghs-svg"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.bIt("click",function(g){return e.open(g)}),t.nVh(1,W4,2,0,"a"),t.k0s()),2&i&&(t.xc7("display",e.figure.errors&&e.figure.errors.length>0?"":"none"),t.R7$(),t.vxM(e.figure.errors&&e.figure.errors.length>0?1:-1))},styles:[".button[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));display:flex;width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));filter:var(--ghs-filter-yellow) var(--ghs-filter-shadow)}.button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}"]})}return a})(),tE=(()=>{class a{figure;constructor(n){this.figure=n}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-figure-errors-dialog"]],standalone:!1,decls:5,vars:3,consts:[[1,"figure-errors-dialog"],[1,"figure-errors"],[1,"figure-error"],[1,"error"],[3,"ghs-label"],[1,"hint",3,"ghs-label","ghs-label-args","ghs-label-args-replace"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.Z7z(2,Q4,4,4,"div",2,J4),t.nI1(4,"trackUUID"),t.k0s()()),2&i&&(t.R7$(2),t.Dyx(t.bMT(4,0,e.figure.errors||t.lJ4(2,Z4))))},dependencies:[it,ct],styles:[".figure-errors[_ngcontent-%COMP%]{display:flex;flex-direction:column;text-align:center}.figure-errors[_ngcontent-%COMP%]   .figure-error[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) 0}.figure-errors[_ngcontent-%COMP%]   .figure-error[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-red)}.figure-errors[_ngcontent-%COMP%]   .figure-error[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}"]})}return a})();const nE=(a,r)=>({apply:a,double:r}),eE=(a,r)=>r._trackUUID;function aE(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",8),t.bIt("singleClick",function(e){c.eBV(n);const o=t.XpG().$implicit,g=t.XpG(2);return c.Njj(g.declineApplyCondition(o.name,e))}),t.nrm(1,"img",9),t.k0s()}if(2&a){const n=t.XpG().$implicit;t.Y8G("conditionHighlight",n)}}function iE(a,r){if(1&a&&(t.j41(0,"span",5),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.JRh(n.value)}}function oE(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",10),t.bIt("singleClick",function(e){c.eBV(n);const o=t.XpG().$implicit,g=t.XpG(2);return c.Njj(g.applyCondition(o.name,e,!0))}),t.nrm(1,"img",4),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.Y8G("conditionHighlight",n),t.R7$(),t.Y8G("src","./assets/images"+(i.settingsManager.settings.fhStyle?"/fh":"")+"/attackmodifier/icons/double.png",t.B4B)}}function sE(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",11),t.bIt("singleClick",function(e){c.eBV(n);const o=t.XpG().$implicit,g=t.XpG(2);return c.Njj(g.applyCondition(o.name,e))}),t.nrm(1,"img",12),t.k0s()}if(2&a){const n=t.XpG().$implicit;t.Y8G("conditionHighlight",n)}}function rE(a,r){if(1&a&&(t.j41(0,"span",1),t.nVh(1,aE,2,1,"a",2),t.j41(2,"span",3),t.nrm(3,"img",4),t.nVh(4,iE,2,1,"span",5),t.k0s(),t.nVh(5,oE,2,2,"a",6),t.nVh(6,sE,2,1,"a",7),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("conditionHighlight",n)("ngClass",t.l_i(7,nE,i.settingsManager.settings.applyConditions&&i.settingsManager.settings.activeApplyConditions&&!n.expired&&!i.settingsManager.settings.activeApplyConditionsExcludes.includes(n.name)&&n.types.includes(i.ConditionType.apply),n.types.includes(i.ConditionType.double))),t.R7$(),t.vxM(i.settingsManager.settings.applyConditions&&i.settingsManager.settings.activeApplyConditions&&!n.expired&&-1==i.settingsManager.settings.activeApplyConditionsExcludes.indexOf(n.name)&&n.types.includes(i.ConditionType.apply)?1:-1),t.R7$(2),t.Y8G("src","./assets/images"+(i.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+n.name+".svg",t.B4B),t.R7$(),t.vxM(n.types.includes(i.ConditionType.value)?4:-1),t.R7$(),t.vxM(i.settingsManager.settings.applyConditions&&i.settingsManager.settings.activeApplyConditions&&!n.expired&&-1==i.settingsManager.settings.activeApplyConditionsExcludes.indexOf(n.name)&&n.types.includes(i.ConditionType.apply)&&n.types.includes(i.ConditionType.double)?5:-1),t.R7$(),t.vxM(i.settingsManager.settings.applyConditions&&i.settingsManager.settings.activeApplyConditions&&!n.expired&&-1==i.settingsManager.settings.activeApplyConditionsExcludes.indexOf(n.name)&&n.types.includes(i.ConditionType.apply)?6:-1)}}function cE(a,r){if(1&a&&(t.j41(0,"div",0),t.Z7z(1,rE,7,10,"span",1,eE),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(t.bMT(3,0,n.highlightedConditions))}}let Ia=(()=>{class a{ghsManager;entity;figure;gameManager=s.E;settingsManager=p.f;ConditionType=Q.GV;highlightedConditions=[];constructor(n){this.ghsManager=n}ngOnInit(){this.update(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.highlightedConditions=s.E.entityManager.highlightedConditions(this.entity)}applyCondition(n,i,e=!1){i.stopPropagation(),s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.figure,"applyCondition"),n),s.E.entityManager.applyCondition(this.entity,this.figure,n),e&&s.E.entityManager.applyCondition(this.entity,this.figure,n),this.after()}declineApplyCondition(n,i){i.stopPropagation(),s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.figure,"declineApplyCondition"),n),s.E.entityManager.declineApplyCondition(this.entity,this.figure,n),this.after()}after(){s.E.entityManager.checkHealth(this.entity,this.figure),this.figure instanceof b.R&&this.entity instanceof Dt.I&&this.entity.dead&&(0==this.entity.entityConditions.length||this.entity.entityConditions.every(n=>!n.highlight||!n.types.includes(Q.GV.turn)&&!n.types.includes(Q.GV.apply)))?setTimeout(()=>{this.figure instanceof b.R&&this.entity instanceof Dt.I&&(s.E.monsterManager.removeMonsterEntity(this.figure,this.entity),this.figure.entities.every(n=>!s.E.entityManager.isAlive(n))&&this.figure.active&&s.E.roundManager.toggleFigure(this.figure)),s.E.stateManager.after()},p.f.settings.animations?1500*p.f.settings.animationSpeed:0):s.E.stateManager.after()}static \u0275fac=function(i){return new(i||a)(t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-highlight-conditions"]],inputs:{entity:"entity",figure:"figure"},standalone:!1,decls:1,vars:1,consts:[[1,"highlight-conditions"],[1,"condition",3,"conditionHighlight","ngClass"],["ghs-pointer-input","",1,"close",3,"conditionHighlight"],[1,"condition-image"],[3,"src"],[1,"value"],["ghs-pointer-input","",1,"double",3,"conditionHighlight"],["ghs-pointer-input","",1,"check",3,"conditionHighlight"],["ghs-pointer-input","",1,"close",3,"singleClick","conditionHighlight"],["src","./assets/images/close_dialog.svg",1,"ghs-svg"],["ghs-pointer-input","",1,"double",3,"singleClick","conditionHighlight"],["ghs-pointer-input","",1,"check",3,"singleClick","conditionHighlight"],["src","./assets/images/check.svg",1,"ghs-svg"]],template:function(i,e){1&i&&t.nVh(0,cE,4,2,"div",0),2&i&&t.vxM(e.highlightedConditions.length>0?0:-1)},dependencies:()=>[N.YU,lE,dt,ct],styles:['.highlight-conditions[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-end;align-items:center;width:0;height:0;overflow:visible}.highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;transform:scale(0);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}@keyframes _ngcontent-%COMP%_condition-highlight{0%{transform:scale(0) translateY(0)}25%,60%{transform:scale(1) translateY(-70%)}to{transform:scale(0) translateY(0)}}.highlight-conditions[_ngcontent-%COMP%]   .condition.animation[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_condition-highlight calc(var(--ghs-animation-speed) * 1s) ease-in-out}.highlight-conditions[_ngcontent-%COMP%]   .condition.apply[_ngcontent-%COMP%]{transform:scale(1)}.highlight-conditions[_ngcontent-%COMP%]   .condition.apply[_ngcontent-%COMP%]:not(.animation):before{content:" ";position:absolute;top:calc(var(--ghs-unit) * -.5 * var(--ghs-text-factor));bottom:0;left:calc(var(--ghs-unit) * -.5 * var(--ghs-text-factor));right:calc(var(--ghs-unit) * -.5 * var(--ghs-text-factor));background-color:var(--ghs-color-darkgray);border-radius:30%;opacity:.5}.highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .condition-image[_ngcontent-%COMP%]{position:relative;z-index:1}.highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .condition-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));width:auto}.highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .condition-image[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));left:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));color:var(--ghs-color-white);text-shadow:none;transform:translate(-50%)}.highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .double[_ngcontent-%COMP%]{cursor:pointer;width:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));height:auto;z-index:2;margin-top:calc(var(--ghs-unit) * .8 * var(--ghs-text-factor))}.highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .close.animation[_ngcontent-%COMP%], .highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .check.animation[_ngcontent-%COMP%], .highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .double.animation[_ngcontent-%COMP%]{animation:hide-animation calc(var(--ghs-animation-speed) * .95s) ease-in-out}.highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .double[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:hover, .highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]:hover, .highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .double[_ngcontent-%COMP%]:hover{transition:all calc(var(--ghs-animation-speed) * .1s);transform:scale(1.2)}.highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .double[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * -7 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 4.7 * var(--ghs-text-factor))}.highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-shadow);margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{filter:var(--ghs-filter-green) var(--ghs-filter-shadow);margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.highlight-conditions[_ngcontent-%COMP%]   .condition.double[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 6.5 * var(--ghs-text-factor))}.highlight-conditions[_ngcontent-%COMP%]   .condition.double[_ngcontent-%COMP%]:not(.animation):before{top:calc(var(--ghs-unit) * -5.5 * var(--ghs-text-factor))}']})}return a})(),lE=(()=>{class a{el;ghsManager;condition;constructor(n,i){this.el=n,this.ghsManager=i}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.condition.highlight&&!this.condition.expired&&(!p.f.settings.applyConditions||!p.f.settings.activeApplyConditions||p.f.settings.activeApplyConditionsExcludes.includes(this.condition.name))&&this.playAnimation()}}),this.playAnimation()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}playAnimation(){this.el.nativeElement.classList.add("animation"),setTimeout(()=>{this.el.nativeElement.classList.remove("animation"),(this.condition.types.includes(Q.GV.turn)||!p.f.settings.applyConditions||!p.f.settings.activeApplyConditions||p.f.settings.activeApplyConditionsExcludes.includes(this.condition.name))&&(this.condition.highlight=!1,s.E.stateManager.saveLocal())},p.f.settings.animations?1100*p.f.settings.animationSpeed:0)}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT),t.rXU(st))};static \u0275dir=t.FsC({type:a,selectors:[["","conditionHighlight",""]],inputs:{condition:[0,"conditionHighlight","condition"]},standalone:!1})}return a})();const gE=["standee"],dE=(a,r,n,i,e,o,g,m,k,X,at,tt,J,et,ot)=>({dead:a,off:r,dormant:n,revealed:i,"revealed-active":e,active:o,"active-focus":g,"active-turn":m,monster:k,objective:X,summon:at,denied:tt,"action-hint-border":J,fh:et,modern:ot}),hE=(a,r,n,i)=>({"monster-standee":a,"objective-standee":r,"summon-standee":n,"bb-elite":i}),_E=a=>({damage:a}),mE=(a,r,n,i)=>({active:a,new:r,center:n,fh:i}),tr=a=>({center:a}),pE=a=>({retaliate:a}),uE=(a,r,n)=>({center:a,expired:r,fh:n}),fE=()=>[],CE=(a,r)=>({active:a,new:r}),nr=(a,r)=>r._trackUUID;function ME(a,r){if(1&a&&(t.j41(0,"div",4),t.nrm(1,"ghs-summon-sheet",22),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("summon",n.gameManager.toSummon(n.entity))}}function vE(a,r){if(1&a&&t.nrm(0,"div",23),2&a){const n=t.XpG();t.xc7("background-image",!n.figure.noThumbnail&&n.settingsManager.settings.artwork&&n.gameManager.isMonster(n.figure)?"url("+n.gameManager.monsterManager.monsterThumbnail(n.gameManager.toMonster(n.figure))+")":"")}}function OE(a,r){if(1&a&&t.nrm(0,"div",23),2&a){const n=t.XpG();t.xc7("background-image",n.gameManager.toSummon(n.entity).thumbnailUrl?"url("+n.gameManager.toSummon(n.entity).thumbnailUrl+")":"url(./assets/images/summons/thumbnail/"+n.gameManager.toSummon(n.entity).thumbnail+".png)")}}function PE(a,r){if(1&a&&t.nrm(0,"img",24),2&a){const n=t.XpG(2);t.Y8G("src",t.VkB("./assets/images/summons/",n.gameManager.toSummon(n.entity).color,".png"),t.B4B)}}function bE(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function kE(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.JRh(n.gameManager.toSummon(n.entity).number)}}function yE(a,r){if(1&a&&(t.j41(0,"span",9),t.nVh(1,PE,1,2,"img",24),t.j41(2,"span",25),t.nVh(3,bE,2,0,"span"),t.nVh(4,kE,2,1,"span"),t.k0s()()),2&a){const n=t.XpG();t.Y8G("ngClass",t.ziG(4,mE,n.gameManager.toSummon(n.entity).state==n.SummonState.true,n.gameManager.toSummon(n.entity).state==n.SummonState.new,n.gameManager.toSummon(n.entity).entityConditions.length%2==0,n.gameManager.toSummon(n.entity).color==n.SummonColor.fh)),t.R7$(),t.vxM(n.gameManager.toSummon(n.entity).color!=n.SummonColor.fh?1:-1),t.R7$(2),t.vxM(0==n.gameManager.toSummon(n.entity).number?3:-1),t.R7$(),t.vxM(n.gameManager.toSummon(n.entity).number>0?4:-1)}}function xE(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsMinZero"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.SpI(" ",t.bMT(2,1,n.entity.health+n.health)," ")}}function EE(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsMinZero"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Lme(" ",n.maxHp,"/",t.bMT(2,2,n.maxHp-n.entity.health+n.health)," ")}}function wE(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsMinZero"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.SpI(" ",t.bMT(2,1,n.entity.health+n.health)," ")}}function RE(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function jE(a,r){if(1&a&&(t.j41(0,"span",29),t.nrm(1,"img",24),t.j41(2,"span",8),t.EFF(3),t.k0s()()),2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.R7$(),t.Y8G("src","./assets/images/"+(i.settingsManager.settings.fhStyle?"fh/":"")+"action/range.svg",t.B4B),t.R7$(2),t.JRh(n.range)}}function GE(a,r){if(1&a&&(t.j41(0,"span",26)(1,"span",27),t.nrm(2,"img",24),t.j41(3,"span",28),t.EFF(4),t.k0s(),t.nVh(5,jE,4,2,"span",29),t.k0s()()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.Y8G("ngClass",t.eq3(5,tr,e.actionHints.length%2==1&&i==e.actionHints.length-1)),t.R7$(2),t.Y8G("src","./assets/images/"+(e.settingsManager.settings.fhStyle?"fh/":"")+"action/hint/"+n.type+".svg",t.B4B),t.R7$(),t.Y8G("ngClass",t.eq3(7,pE,"retaliate"==n.type)),t.R7$(),t.JRh(n.value),t.R7$(),t.vxM(n.range?5:-1)}}function TE(a,r){if(1&a&&(t.j41(0,"div",11),t.Z7z(1,GE,6,9,"span",26,nr),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(t.bMT(3,0,n.actionHints))}}function SE(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",30),t.bIt("doubleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.removeMarker())}),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ghs-label","%game.mapMarker."+n.marker+"%")}}function DE(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",31),t.bIt("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.removeCharacterMarker(e))}),t.nrm(1,"img",24),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.R7$(),t.Y8G("src",i.gameManager.characterManager.characterIcon(n),t.B4B)}}function $E(a,r){if(1&a&&t.nrm(0,"span",15),2&a){const n=t.XpG();t.Y8G("ghs-label","%data.characterToken."+n.figure.name+"."+n.specialActionsMarker+"%")}}function IE(a,r){if(1&a&&t.nrm(0,"img",38),2&a){const n=r.$implicit,i=t.XpG(2),e=i.$implicit,o=i.$index,g=t.XpG(2);t.xc7("z-index",10*o+e.value-n-1),t.Y8G("src","./assets/images"+(g.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+e.name+".svg",t.B4B)}}function AE(a,r){if(1&a&&(t.Z7z(0,IE,1,3,"img",37,t.fX1),t.nI1(2,"ghsRange")),2&a){const n=t.XpG().$implicit;t.Dyx(t.i5U(2,0,t.lJ4(3,fE),n.value-1))}}function VE(a,r){if(1&a&&(t.j41(0,"span",8),t.EFF(1),t.k0s()),2&a){const n=t.XpG(),i=n.$implicit;t.xc7("z-index",10*n.$index+i.value+1),t.R7$(),t.JRh(i.value)}}function FE(a,r){if(1&a&&t.nrm(0,"span",39),2&a){const n=t.XpG();t.xc7("z-index",10*n.$index+n.$implicit.value+2)}}function XE(a,r){if(1&a&&t.nrm(0,"span",40),2&a){const n=t.XpG();t.xc7("z-index",10*n.$index+n.$implicit.value+3)}}function BE(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",26)(1,"span",33),t.bIt("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.removeCondition(e))}),t.nrm(2,"img",24),t.nVh(3,AE,3,4),t.nVh(4,VE,2,3,"span",34),t.nVh(5,FE,1,2,"span",35),t.nVh(6,XE,1,2,"span",36),t.k0s()()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.Y8G("ngClass",t.sMw(8,uE,(e.gameManager.isMonsterEntity(e.entity)&&e.gameManager.toMonsterEntity(e.entity).summon==e.SummonState.false||e.gameManager.isSummon(e.entity)||e.gameManager.isObjectiveEntity(e.entity))&&e.activeConditions.length%2==1&&e.activeConditions.length==i+1,n.expired,e.settingsManager.settings.fhStyle)),t.R7$(2),t.xc7("z-index",10*i+n.value),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+n.name+".svg",t.B4B),t.R7$(),t.vxM(n.types.includes(e.ConditionType.stack)?3:-1),t.R7$(),t.vxM(n.types.includes(e.ConditionType.value)&&!n.types.includes(e.ConditionType.stack)?4:-1),t.R7$(),t.vxM(e.entity.immunities.includes(n.name)?5:-1),t.R7$(),t.vxM(n.permanent?6:-1)}}function YE(a,r){if(1&a&&(t.j41(0,"span",32)(1,"span",41),t.nrm(2,"img",24),t.k0s()()),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(4,tr,n.entity.entityConditions.length%2==0)),t.R7$(),t.Y8G("ngClass",t.l_i(6,CE,n.gameManager.isMonsterEntity(n.entity)&&n.gameManager.toMonsterEntity(n.entity).summon==n.SummonState.true,n.gameManager.isMonsterEntity(n.entity)&&n.gameManager.toMonsterEntity(n.entity).summon==n.SummonState.new)),t.R7$(),t.Y8G("src",t.VkB("./assets/images/summons/",n.gameManager.toMonster(n.figure).summonColor,".png"),t.B4B)}}function UE(a,r){if(1&a&&(t.j41(0,"div",17),t.Z7z(1,BE,7,12,"span",26,nr),t.nI1(3,"trackUUID"),t.nVh(4,YE,3,9,"span",32),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(t.bMT(3,1,n.activeConditions)),t.R7$(3),t.vxM(n.gameManager.isMonsterEntity(n.entity)&&n.gameManager.toMonsterEntity(n.entity).summon!=n.SummonState.false?4:-1)}}let Aa=(()=>{class a{element;dialog;overlay;ghsManager;standee;gameManager=s.E;settingsManager=p.f;figure;entity;Conditions=Q.kW;AttackModifierType=w.Yn;SummonState=_t.N5;SummonColor=_t.rX;ConditionName=Q.r5;ConditionType=Q.GV;MonsterType=S.N;health=0;maxHp=0;activeConditions=[];actionHints=[];activeIndex=-1;activeTurn=!1;marker="";specialActionsMarker=[];objectiveData;EntityValueFunction=A.hZ;constructor(n,i,e,o){this.element=n,this.dialog=i,this.overlay=e,this.ghsManager=o}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}additionalType(){return this.entity instanceof Dt.I?this.entity.type:this.entity instanceof _t.up?this.entity.name:""}update(){if(this.activeConditions=s.E.entityManager.activeConditions(this.entity,!0),this.entity.immunities.forEach(n=>{this.activeConditions.find(i=>i.name==n)||this.activeConditions.push(new Q.BR(n))}),this.actionHints=[],p.f.settings.standeeStats&&(this.actionHints=s.E.actionsManager.calcActionHints(this.figure,this.entity)),this.entity.revealed){const n=s.E.game.figures.find(i=>i.active);if(n){const i=s.E.game.figures.indexOf(n);-1!=i&&(-1==this.activeIndex?this.activeIndex=i:this.activeIndex!=i&&this.entity.number>0&&(this.entity.revealed=!1))}}if(this.marker=this.entity instanceof Dt.I||this.entity instanceof ln.X?this.entity.marker:"",this.figure instanceof ft.$e&&this.figure.entities.flatMap(n=>n.marker).every((n,i,e)=>0==e.indexOf(n))&&(this.marker=""),this.activeTurn=!1,this.figure instanceof b.R){const n=this.figure.entities.filter(i=>i.active).sort(s.E.monsterManager.sortEntities);n.length&&n[0]==this.entity&&(this.activeTurn=!0)}this.maxHp=(0,A.hZ)(this.entity.maxHealth),this.specialActionsMarker=[],this.entity.tags.forEach(n=>{this.figure instanceof H.K&&"prism"==this.figure.name&&this.figure.specialActions.find(i=>i.name==n&&i.summon)&&"prism_mode"==n&&this.specialActionsMarker.push("mode")}),this.figure instanceof ft.$e&&this.figure.objectiveId&&(this.objectiveData=s.E.objectiveManager.objectiveDataByObjectiveIdentifier(this.figure.objectiveId))}dragHpMove(n){((0,A.hZ)(this.entity.maxHealth)>0||this.objectiveData&&this.objectiveData.trackDamage)&&(!(this.figure instanceof b.R)||!this.figure.immortal)&&(this.health=n,(!this.objectiveData||!this.objectiveData.trackDamage)&&this.entity.health+this.health>(0,A.hZ)(this.entity.maxHealth)&&(this.health=(0,A.hZ)(this.entity.maxHealth)-this.entity.health))}dragHpEnd(n){if(0!=this.health&&((0,A.hZ)(this.entity.maxHealth)>0||this.objectiveData&&this.objectiveData.trackDamage)&&(!(this.figure instanceof b.R)||!this.figure.immortal)){let i=this.figure.name;!i&&this.figure instanceof ft.$e&&(i=this.figure.title,i||(i=this.figure.escort?"%escort%":"%objective%")),s.E.stateManager.before(this.figure.type+"ChangeEntityHp",i,""+this.entity.number,""+this.health,this.additionalType()),s.E.entityManager.changeHealth(this.entity,this.figure,this.health),this.figure instanceof b.R&&this.figure.entities.every(e=>e.dead)&&this.figure.active&&s.E.roundManager.toggleFigure(this.figure),s.E.stateManager.after()}this.health=0}dragHpCancel(n){this.health=0}removeCondition(n){s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.figure,"removeCondition"),n.name,this.entity instanceof Dt.I?"monster."+this.entity.type+" ":""),n.types.indexOf(Q.GV.stackable)&&n.value>1?n.value--:s.E.entityManager.removeCondition(this.entity,this.figure,n,n.permanent),s.E.stateManager.after()}removeMarker(){(this.entity instanceof Dt.I||this.entity instanceof ln.X)&&this.entity.marker&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.figure,"removeEntityMarker"),this.marker),this.entity.marker="",s.E.stateManager.after())}removeCharacterMarker(n){const i=new H.K(s.E.getCharacterData(n),1),e=s.E.characterManager.characterName(i),o=i.name;s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.figure,"removeMarker"),e,o),this.entity.markers=this.entity.markers.filter(g=>g!=n),s.E.stateManager.after()}doubleClick(n){this.entity.revealed?this.entity.revealed=!1:p.f.settings.activeStandees&&this.entity instanceof Dt.I?(s.E.stateManager.before(this.figure.type+(this.entity.active?"UnsetEntityActive":"SetEntityActive"),this.figure.name,""+this.entity.number,this.additionalType()),s.E.entityManager.toggleActive(this.figure,this.entity),s.E.stateManager.after()):p.f.settings.activeSummons&&this.entity instanceof _t.up&&this.toggleActive()}toggleActive(){if(this.entity instanceof _t.up&&this.figure instanceof H.K)if(this.entity.active)s.E.stateManager.before("summonInactive",s.E.characterManager.characterName(this.figure),"data.summon."+this.entity.name),p.f.settings.activeSummons&&this.figure.active?s.E.roundManager.toggleFigure(this.figure):this.entity.active=!1,s.E.stateManager.after();else{s.E.stateManager.before("summonActive",s.E.characterManager.characterName(this.figure),"data.summon."+this.entity.name);const n=this.figure.summons.find(i=>i.active);if(p.f.settings.activeSummons&&this.figure.active&&s.E.entityManager.isAlive(this.entity,!0)&&(!n||this.figure.summons.indexOf(n)<this.figure.summons.indexOf(this.entity)))for(;!this.entity.active;)s.E.roundManager.toggleFigure(this.figure);else this.figure.summons.forEach(i=>i.active=!1),this.entity.active=!0;s.E.stateManager.after()}}openEntityMenu(n){if(this.entity.number<0&&this.figure instanceof b.R&&this.entity instanceof Dt.I)if(p.f.settings.randomStandees){const i=s.E.monsterManager.monsterRandomStandee(this.figure);s.E.stateManager.before("addRandomStandee","data.monster."+this.figure.name,"monster."+this.entity.type,""+i),this.entity.number=i,s.E.stateManager.after()}else this.dialog.open(ua,{panelClass:["dialog"],data:{monster:this.figure,type:this.entity.type,range:[],entity:this.entity,entities:this.figure.entities},positionStrategy:this.overlay.position().flexibleConnectedTo(this.standee).withPositions((0,F.yE)())});else this.dialog.open(ze,{panelClass:["dialog"],data:{entity:this.entity,figure:this.figure,positionElement:this.standee},positionStrategy:this.overlay.position().flexibleConnectedTo(this.standee).withPositions((0,F.yE)())}).closed.subscribe({next:()=>{(this.entity instanceof Dt.I||this.entity instanceof ln.X)&&this.entity.dead&&(this.element.nativeElement.classList.add("dead"),this.ghsManager.triggerUiChange())}})}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT),t.rXU(O.lG),t.rXU(qt.hJ),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-standee"]],viewQuery:function(i,e){if(1&i&&t.GBs(gE,5),2&i){let o;t.mGM(o=t.lsd())&&(e.standee=o.first)}},inputs:{figure:"figure",entity:"entity"},standalone:!1,decls:30,vars:57,consts:[["standee",""],[1,"entity-border",3,"ngClass","entityAnimation"],[1,"entity",3,"ngClass"],[1,"standee",3,"ngClass"],[1,"sheet"],[1,"background-image-container"],[1,"background-image",3,"background-image"],[1,"number",3,"ngClass"],[1,"value"],[1,"summon-state",3,"ngClass"],[1,"health",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"conditions","actions"],[1,"markers"],["ghs-pointer-input","",1,"placeholder","placeholder-marker",3,"ghs-label"],["ghs-pointer-input","",1,"marker"],[1,"special-action-marker",3,"ghs-label"],[3,"entity","figure"],[1,"conditions"],[1,"value-overlay",3,"value-sign","hideEmpty","reverse","invert","container"],[3,"entity","diff"],[3,"entity"],[1,"drag-hp",3,"dragMove","dragEnd","dragCancel","singleClick","doubleClick","draggingDisabled","relative","screenWidth","fastShift"],[3,"summon"],[1,"background-image"],[3,"src"],[1,"summon-number"],[1,"condition-container",3,"ngClass"],[1,"condition","action-hint"],[1,"value",3,"ngClass"],[1,"range"],["ghs-pointer-input","",1,"placeholder","placeholder-marker",3,"doubleClick","ghs-label"],["ghs-pointer-input","",1,"marker",3,"doubleClick"],[1,"summon-container",3,"ngClass"],["ghs-pointer-input","",1,"condition",3,"doubleClick"],[1,"value",3,"z-index"],[1,"condition","immunity","condition-overlay",3,"z-index"],[1,"condition","permanent","condition-overlay",3,"z-index"],[1,"stack",3,"z-index","src"],[1,"stack",3,"src"],[1,"condition","immunity","condition-overlay"],[1,"condition","permanent","condition-overlay"],[1,"summon",3,"ngClass"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3,0),t.nVh(4,ME,2,1,"div",4),t.j41(5,"div",5),t.nVh(6,vE,1,2,"div",6),t.nVh(7,OE,1,2,"div",6),t.k0s(),t.j41(8,"span",7)(9,"span",8),t.EFF(10),t.k0s()(),t.nVh(11,yE,5,9,"span",9),t.j41(12,"span",10),t.nVh(13,xE,3,3,"span"),t.nVh(14,EE,3,4,"span"),t.nVh(15,wE,3,3,"span"),t.nVh(16,RE,2,0,"span"),t.k0s()(),t.nVh(17,TE,4,2,"div",11),t.j41(18,"div",12),t.nVh(19,SE,1,1,"span",13),t.Z7z(20,DE,2,1,"span",14,t.fX1),t.Z7z(22,$E,1,1,"span",15,t.fX1),t.k0s(),t.nrm(24,"ghs-highlight-conditions",16),t.nVh(25,UE,5,3,"div",17),t.nrm(26,"span",18)(27,"ghs-healthbar",19)(28,"ghs-entity-index-key",20),t.k0s(),t.j41(29,"ghs-pointer-input",21),t.bIt("dragMove",function(m){return c.eBV(o),c.Njj(e.dragHpMove(m))})("dragEnd",function(m){return c.eBV(o),c.Njj(e.dragHpEnd(m))})("dragCancel",function(m){return c.eBV(o),c.Njj(e.dragHpCancel(m))})("singleClick",function(m){return c.eBV(o),c.Njj(e.openEntityMenu(m))})("doubleClick",function(m){return c.eBV(o),c.Njj(e.doubleClick(m))}),t.k0s()()}2&i&&(t.Y8G("ngClass",t.zJS(34,dE,[e.entity.dead,!e.entity.dormant&&e.entity.off,e.entity.dormant,!e.entity.dormant&&e.entity.revealed&&e.settingsManager.settings.scenarioRooms,e.figure.active&&!e.entity.dormant&&e.entity.revealed&&e.settingsManager.settings.scenarioRooms&&e.settingsManager.settings.activeStandees,!e.entity.dormant&&(e.gameManager.isMonsterEntity(e.entity)&&e.entity.active&&e.settingsManager.settings.activeStandees||e.gameManager.isSummon(e.entity)&&e.entity.active&&e.settingsManager.settings.activeSummons),!e.entity.dormant&&e.entity.active&&e.settingsManager.settings.activeStandees&&!e.figure.active,e.activeTurn,e.gameManager.isMonsterEntity(e.entity),e.gameManager.isObjectiveEntity(e.entity),e.gameManager.isSummon(e.entity),e.gameManager.isMonster(e.figure)&&!e.gameManager.stateManager.monsterPermissions[e.figure.name+"|"+e.figure.edition]||e.gameManager.isObjectiveContainer(e.figure)&&e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.characters||e.gameManager.isCharacter(e.figure)&&!e.gameManager.stateManager.characterPermissions[e.figure.name+"|"+e.figure.edition],e.actionHints.length>0&&e.actionHints.length%2==1&&0==e.activeConditions.length&&(e.gameManager.isObjectiveEntity(e.entity)&&e.gameManager.isMonsterEntity(e.entity)&&e.gameManager.toMonsterEntity(e.entity).summon==e.SummonState.false||e.gameManager.isSummon(e.entity)&&e.gameManager.toSummon(e.entity).state==e.SummonState.false),"fh"==e.settingsManager.settings.theme,"modern"==e.settingsManager.settings.theme]))("entityAnimation",e.entity.dead),t.R7$(),t.Y8G("ngClass",e.gameManager.isMonsterEntity(e.entity)?e.gameManager.toMonsterEntity(e.entity).type:""),t.R7$(),t.Y8G("ngClass",t.ziG(50,hE,e.gameManager.isMonsterEntity(e.entity),e.gameManager.isObjectiveEntity(e.entity),e.gameManager.isSummon(e.entity),e.gameManager.isMonster(e.figure)&&e.gameManager.toMonster(e.figure).bb&&e.gameManager.isMonsterEntity(e.entity)&&e.gameManager.toMonsterEntity(e.entity).type==e.MonsterType.elite)),t.R7$(2),t.vxM(e.gameManager.isSummon(e.entity)&&e.gameManager.toSummon(e.entity).active?4:-1),t.R7$(2),t.vxM(e.gameManager.isMonsterEntity(e.entity)?6:-1),t.R7$(),t.vxM(e.gameManager.isSummon(e.entity)&&e.settingsManager.settings.artwork&&(e.gameManager.toSummon(e.entity).thumbnail&&!e.gameManager.toSummon(e.entity).noThumbnail||e.gameManager.toSummon(e.entity).thumbnailUrl)?7:-1),t.R7$(),t.Y8G("ngClass",(e.gameManager.isMonster(e.figure)&&e.gameManager.toMonster(e.figure).bb?"bb-"+e.entity.number:"")+(e.entity.number<1&&e.settingsManager.settings.animations?" highlight":"")),t.R7$(2),t.JRh(e.entity.number<0?"?":e.entity.number),t.R7$(),t.vxM(e.gameManager.isSummon(e.entity)?11:-1),t.R7$(),t.Y8G("ghs-label","game.health")("ghs-label-attribute","title")("ngClass",t.eq3(55,_E,e.settingsManager.settings.damageHP||e.objectiveData&&e.objectiveData.trackDamage)),t.R7$(),t.vxM(e.maxHp&&!e.settingsManager.settings.damageHP?13:-1),t.R7$(),t.vxM(e.maxHp&&e.settingsManager.settings.damageHP?14:-1),t.R7$(),t.vxM(e.objectiveData&&e.objectiveData.trackDamage?15:-1),t.R7$(),t.vxM(e.objectiveData&&e.objectiveData.trackDamage||e.maxHp?-1:16),t.R7$(),t.vxM(e.specialActionsMarker.length&&e.specialActionsMarker.includes("mode")?-1:17),t.R7$(2),t.vxM(e.marker?19:-1),t.R7$(),t.Dyx(e.entity.markers),t.R7$(2),t.Dyx(e.specialActionsMarker),t.R7$(2),t.Y8G("entity",e.entity)("figure",e.figure),t.R7$(),t.vxM(e.specialActionsMarker.length&&e.specialActionsMarker.includes("mode")?-1:25),t.R7$(),t.Y8G("value-sign",e.health)("hideEmpty",!0)("reverse",e.settingsManager.settings.damageHP)("invert",!!e.objectiveData&&e.objectiveData.trackDamage)("container",!0),t.R7$(),t.Y8G("entity",e.entity)("diff",e.health),t.R7$(),t.Y8G("entity",e.entity),t.R7$(),t.Y8G("draggingDisabled",!e.settingsManager.settings.dragValuesHp)("relative",!0)("screenWidth",!0)("fastShift",!0))},dependencies:[N.YU,$a,ba,it,Ws,Ia,dt,$i,Ne,Ma,At,ct],styles:['.entity-border[_ngcontent-%COMP%]{position:relative;touch-action:none;height:calc(var(--ghs-unit) * 7 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]:hover{z-index:999}.entity-border[_ngcontent-%COMP%]:before{content:" ";display:block;position:absolute;top:calc(var(--ghs-unit) * 1.6 * var(--ghs-text-factor));left:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));bottom:calc(var(--ghs-unit) * 1.1 * var(--ghs-text-factor));right:calc(var(--ghs-unit) * 2.1 * var(--ghs-text-factor));border-width:calc(var(--ghs-unit) * .4);border-style:solid;border-color:var(--ghs-color-gray);border-radius:calc(var(--ghs-unit) * .7)}.entity-border.action-hint-border[_ngcontent-%COMP%]:before{right:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]:not(.dead){opacity:1;transform:translate(0)}.entity-border.dead[_ngcontent-%COMP%]{opacity:0;max-width:0;transform:translateY(100%)}@keyframes _ngcontent-%COMP%_monster-entity-active-focus{0%{box-shadow:0 0 calc(var(--ghs-unit) * 1) calc(var(--ghs-unit) * .3) var(--ghs-color-red)}40%,60%{box-shadow:0 0 calc(var(--ghs-unit) * 1) calc(var(--ghs-unit) * .6) var(--ghs-color-red)}to{box-shadow:0 0 calc(var(--ghs-unit) * 1) calc(var(--ghs-unit) * .3) var(--ghs-color-red)}}.entity-border.active.active-focus[_ngcontent-%COMP%]   .monster-standee[_ngcontent-%COMP%], .entity-border.active.active-focus[_ngcontent-%COMP%]   .objective-standee[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_monster-entity-active-focus calc(var(--ghs-animation-speed) * 1s) ease-in-out infinite}.entity-border.active[_ngcontent-%COMP%]   .monster-standee[_ngcontent-%COMP%], .entity-border.active[_ngcontent-%COMP%]   .objective-standee[_ngcontent-%COMP%]{box-shadow:0 0 calc(var(--ghs-unit) * 1) calc(var(--ghs-unit) * .5) var(--ghs-color-red)}.entity-border.active.active-turn[_ngcontent-%COMP%]   .monster-standee[_ngcontent-%COMP%], .entity-border.active.active-turn[_ngcontent-%COMP%]   .objective-standee[_ngcontent-%COMP%]{box-shadow:0 0 calc(var(--ghs-unit) * 1) calc(var(--ghs-unit) * .5) var(--ghs-color-blue)}@keyframes _ngcontent-%COMP%_monster-entity-revealed{0%{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .1) var(--ghs-color-white)}40%,60%{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .3) var(--ghs-color-white)}to{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .1) var(--ghs-color-white)}}@keyframes _ngcontent-%COMP%_monster-entity-revealed-elite{0%{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .1) var(--ghs-color-yellow)}40%,60%{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .3) var(--ghs-color-yellow)}to{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .1) var(--ghs-color-yellow)}}@keyframes _ngcontent-%COMP%_monster-entity-revealed-boss{0%{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .1) var(--ghs-color-red)}40%,60%{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .3) var(--ghs-color-red)}to{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .1) var(--ghs-color-red)}}.entity-border.revealed[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .monster-standee[_ngcontent-%COMP%], .entity-border.revealed[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .objective-standee[_ngcontent-%COMP%]{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .3) var(--ghs-color-white)}.entity-border.revealed[_ngcontent-%COMP%]   .entity.elite[_ngcontent-%COMP%]   .monster-standee[_ngcontent-%COMP%]{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .3) var(--ghs-color-yellow)}.entity-border.revealed[_ngcontent-%COMP%]   .entity.boss[_ngcontent-%COMP%]   .monster-standee[_ngcontent-%COMP%]{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .3) var(--ghs-color-red)}.entity-border.revealed.revealed-active[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .monster-standee[_ngcontent-%COMP%], .entity-border.revealed.revealed-active[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .objective-standee[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_monster-entity-revealed calc(var(--ghs-animation-speed) * 1s) ease-in-out infinite}.entity-border.revealed.revealed-active[_ngcontent-%COMP%]   .entity.elite[_ngcontent-%COMP%]   .monster-standee[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_monster-entity-revealed-elite calc(var(--ghs-animation-speed) * 1s) ease-in-out infinite}.entity-border.revealed.revealed-active[_ngcontent-%COMP%]   .entity.boss[_ngcontent-%COMP%]   .monster-standee[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_monster-entity-revealed-boss calc(var(--ghs-animation-speed) * 1s) ease-in-out infinite}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]{position:relative;display:flex;cursor:pointer;height:calc(var(--ghs-unit) * 7 * var(--ghs-text-factor));text-align:center;color:var(--ghs-color-white);text-shadow:var(--ghs-outline);width:100%;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));margin-top:calc(var(--ghs-unit) * .25 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]{position:relative;display:flex;height:100%;width:calc(var(--ghs-unit) * 9 * var(--ghs-text-factor));border:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor)) solid var(--ghs-color-black);border-bottom-width:calc(var(--ghs-unit) * .35 * var(--ghs-text-factor));border-top-left-radius:25%;border-top-right-radius:25%;background-color:var(--ghs-color-black);filter:var(--ghs-filter-outline)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee.bb-elite[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor)) solid var(--ghs-color-yellow);border-top:none;border-left:none}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .background-image-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;border-top-left-radius:25%;border-top-right-radius:25%;overflow:hidden;z-index:0}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .background-image-container[_ngcontent-%COMP%]   .background-image[_ngcontent-%COMP%]{position:absolute;top:-7%;left:0;width:100%;height:150%;background-color:var(--ghs-color-darkgray);background-size:calc(var(--ghs-unit) * 9.5 * var(--ghs-text-factor)) AUTO;background-repeat:no-repeat;filter:brightness(70%)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{display:flex;width:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));justify-content:center;align-items:center;font-family:var(--ghs-font-gh-normal);flex-shrink:0;z-index:1}@keyframes _ngcontent-%COMP%_number-pulse{0%{transform:scale(.9)}50%{transform:scale(1.1)}to{transform:scale(.9)}}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray);background-color:var(--ghs-color-white);border-bottom-right-radius:50%;border-top-left-radius:35%;height:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));text-shadow:none}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.highlight[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_number-pulse calc(var(--ghs-animation-speed) * 2s) ease-in-out infinite}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor));position:relative;top:calc(var(--ghs-unit) * 1.2 * var(--ghs-text-factor));left:0;height:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]:before{content:" ";position:absolute;left:50%;top:calc(var(--ghs-unit) * -.9 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));background-image:url(health.8d6a842a197d29d3.svg);background-size:contain;background-repeat:no-repeat;transform:translate(-50%)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .health.damage[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .health.damage[_ngcontent-%COMP%]:before{background-image:url(damage.9a6bcf7352ecd379.svg);width:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));filter:var(--ghs-filter-red) brightness(.7) var(--ghs-filter-outline-thin-black)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;max-height:calc(var(--ghs-unit) * 7 * var(--ghs-text-factor));padding-left:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]   .placeholder-marker[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1.3 * var(--ghs-text-factor));font-size:calc(var(--ghs-unit) * 3.2 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]   ghs-element-icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));margin-top:calc(var(--ghs-unit) * 1.4 * var(--ghs-text-factor));margin-left:calc(var(--ghs-unit) * -.5 * var(--ghs-text-factor));margin-right:calc(var(--ghs-unit) * -.5 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));background-color:var(--ghs-color-darkgray);border-radius:100%;height:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));margin-top:calc(var(--ghs-unit) * .8 * var(--ghs-text-factor));margin-left:calc(var(--ghs-unit) * -1 * var(--ghs-text-factor));margin-right:calc(var(--ghs-unit) * -1 * var(--ghs-text-factor));border-width:calc(var(--ghs-unit) * .4);border-style:solid;border-color:var(--ghs-color-gray)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]   .special-action-marker[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * .3 * var(--ghs-text-factor));font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   ghs-highlight-conditions[_ngcontent-%COMP%]{z-index:20;position:absolute;bottom:0;left:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]{position:relative;display:grid;grid-template-rows:repeat(2,auto);grid-auto-flow:column;height:calc(var(--ghs-unit) * 7.5 * var(--ghs-text-factor));margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));margin-right:calc(var(--ghs-unit) * -.5 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;margin-left:calc(var(--ghs-unit) * -.5 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container.expired[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container.expired[_ngcontent-%COMP%]{opacity:.6}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));overflow:visible}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));margin:0}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img.stack[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]   img.stack[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img.stack[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]   img.stack[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * -2 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition.condition-overlay[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .summon.condition-overlay[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .condition.condition-overlay[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .summon.condition-overlay[_ngcontent-%COMP%]{position:absolute;width:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));top:0;left:0;pointer-events:none;z-index:2}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));color:var(--ghs-color-white);position:absolute;top:calc(var(--ghs-unit) * 2.1 * var(--ghs-text-factor));left:50%;text-shadow:none;transform:translate(-50%)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]:hover{transform-origin:center center;z-index:999}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]:nth-child(2n)   .condition[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]:nth-child(2n)   .summon[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]:nth-child(2n)   .condition[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]:nth-child(2n)   .summon[_ngcontent-%COMP%]:hover{transform:scale(2) translateY(-25%)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]:nth-child(odd)   .condition[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]:nth-child(odd)   .summon[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]:nth-child(odd)   .condition[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]:nth-child(odd)   .summon[_ngcontent-%COMP%]:hover{transform:scale(2) translateY(25%)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container.center[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container.center[_ngcontent-%COMP%]{grid-row:span 2}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container.center[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container.center[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container.center[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container.center[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]:hover{transform:scale(2)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions.actions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions.actions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{position:absolute;top:0;left:0;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));height:100%;transform:none;color:var(--ghs-color-white);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3.3 * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));text-shadow:var(--ghs-outline-thin);filter:invert(1)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions.actions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value.retaliate[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));top:calc(var(--ghs-unit) * .7 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions.actions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));height:auto;filter:var(--ghs-filter-white) var(--ghs-filter-outline)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions.actions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .range[_ngcontent-%COMP%]{position:relative;top:20%}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions.actions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .range[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.3 * var(--ghs-text-factor));height:auto}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions.actions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .range[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.3 * var(--ghs-text-factor));left:calc(var(--ghs-unit) * -.3 * var(--ghs-text-factor));top:calc(var(--ghs-unit) * .3 * var(--ghs-text-factor));font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon.new[_ngcontent-%COMP%]:before{content:" ";display:block;position:absolute;width:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));background-image:url(minus.97c98a810771fceb.svg);background-size:cover}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   ghs-healthbar[_ngcontent-%COMP%]{position:absolute;bottom:calc(var(--ghs-unit) * .2 * var(--ghs-text-factor));left:calc(var(--ghs-unit) * .4 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 8.2 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * .75 * var(--ghs-text-factor));z-index:0;border-radius:15%;overflow:hidden}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   ghs-entity-index-key[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));top:calc(var(--ghs-unit) * -3.5 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity.normal[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{background-color:var(--ghs-color-white)}.entity-border[_ngcontent-%COMP%]   .entity.elite[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{background-color:var(--ghs-color-yellow)}.entity-border[_ngcontent-%COMP%]   .entity.boss[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{background-color:var(--ghs-color-red)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-1[_ngcontent-%COMP%]{background-color:var(--ghs-color-bb-1)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-2[_ngcontent-%COMP%]{background-color:var(--ghs-color-bb-2)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-3[_ngcontent-%COMP%]{background-color:var(--ghs-color-bb-3)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-4[_ngcontent-%COMP%]{background-color:var(--ghs-color-bb-4)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-5[_ngcontent-%COMP%]{background-color:var(--ghs-color-bb-5)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-6[_ngcontent-%COMP%]{background-color:var(--ghs-color-bb-6)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-7[_ngcontent-%COMP%]{background-color:var(--ghs-color-bb-7)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-8[_ngcontent-%COMP%]{background-color:var(--ghs-color-bb-8)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-9[_ngcontent-%COMP%]{background-color:var(--ghs-color-bb-9)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-10[_ngcontent-%COMP%]{background-color:var(--ghs-color-bb-10)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-1[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-2[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-3[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-4[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-5[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-6[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-7[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-8[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-9[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-10[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--ghs-color-white);filter:var(--ghs-filter-shadow)}.entity-border.dormant[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]{filter:grayscale(.4)}.entity-border.dormant[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .background-image-container[_ngcontent-%COMP%], .entity-border.dormant[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   ghs-healthbar[_ngcontent-%COMP%]{filter:grayscale(.8)}.entity-border[_ngcontent-%COMP%]   .drag-hp[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:calc(var(--ghs-unit) * 9 * var(--ghs-text-factor));height:100%;z-index:4}.entity-border[_ngcontent-%COMP%]   .value-overlay[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));top:calc(var(--ghs-unit) * -3 * var(--ghs-text-factor));font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor));z-index:1000}.entity-border.summon[_ngcontent-%COMP%]{transition:height calc(var(--ghs-animation-speed) * .5s) ease-out}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]{transition:width calc(var(--ghs-animation-speed) * .5s) ease-out}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]{background-color:var(--ghs-color-darkgray);transition:height calc(var(--ghs-animation-speed) * .5s) ease-out,width calc(var(--ghs-animation-speed) * .5s) ease-out}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{display:none}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * .5);left:0;width:calc(var(--ghs-unit) * 4);height:calc(var(--ghs-unit) * 4);transition:top calc(var(--ghs-animation-speed) * .5s) ease-out,left calc(var(--ghs-animation-speed) * .5s) ease-out}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .summon-state.new[_ngcontent-%COMP%]:before{content:" ";display:block;position:absolute;width:calc(var(--ghs-unit) * 4);height:calc(var(--ghs-unit) * 4);background-image:url(minus.97c98a810771fceb.svg);background-size:cover;z-index:2}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%]{position:absolute;display:flex;justify-content:center;align-items:center;top:0;left:calc(var(--ghs-unit) * -.1);height:calc(var(--ghs-unit) * 4);width:calc(var(--ghs-unit) * 2);font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5);color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray);border-top-left-radius:calc(var(--ghs-unit) * 4);border-bottom-left-radius:calc(var(--ghs-unit) * 4);z-index:3;opacity:.9;transition:top calc(var(--ghs-animation-speed) * .5s) ease-out,left calc(var(--ghs-animation-speed) * .5s) ease-out}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .summon-state.fh[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 1);width:calc(var(--ghs-unit) * 3.5);height:calc(var(--ghs-unit) * 3.5)}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .summon-state.fh.new[_ngcontent-%COMP%]:before{right:calc(var(--ghs-unit) * -.7);top:calc(var(--ghs-unit) * .8);width:calc(var(--ghs-unit) * 2);height:calc(var(--ghs-unit) * 2);background-image:url(minus.4a3eac90cfce6ac6.svg);z-index:4}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .summon-state.fh[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5);height:calc(var(--ghs-unit) * 3.5);font-family:var(--ghs-font-gh-title);font-size:calc(var(--ghs-unit) * 2.5);color:var(--ghs-color-white);border:calc(var(--ghs-unit) * .3) solid var(--ghs-color-white);border-radius:100%}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .background-image-container[_ngcontent-%COMP%]{transition:height calc(var(--ghs-animation-speed) * .5s) ease-out,width calc(var(--ghs-animation-speed) * .5s) ease-out,top calc(var(--ghs-animation-speed) * .5s) ease-out,left calc(var(--ghs-animation-speed) * .5s) ease-out}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .background-image-container[_ngcontent-%COMP%]   .background-image[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * -1.3 * var(--ghs-text-factor));left:calc(var(--ghs-unit) * -.8 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 9.5 * var(--ghs-text-factor));height:150%;background-size:100% AUTO;background-color:transparent;transition:height calc(var(--ghs-animation-speed) * .5s) ease-out,width calc(var(--ghs-animation-speed) * .5s) ease-out,top calc(var(--ghs-animation-speed) * .5s) ease-out,left calc(var(--ghs-animation-speed) * .5s) ease-out}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 1.2 * var(--ghs-text-factor));left:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));transition:top calc(var(--ghs-animation-speed) * .5s) ease-out,left calc(var(--ghs-animation-speed) * .5s) ease-out}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   ghs-healthbar[_ngcontent-%COMP%]{transition:width calc(var(--ghs-animation-speed) * .5s) ease-out}.entity-border.summon[_ngcontent-%COMP%]   .value-overlay[_ngcontent-%COMP%]{top:initial;bottom:calc(var(--ghs-unit) * -2.5 * var(--ghs-text-factor))}.entity-border.active.summon[_ngcontent-%COMP%]{z-index:15}.entity-border.active.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 12 * var(--ghs-text-factor))}.entity-border.active.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 30 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 12 * var(--ghs-text-factor));font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor))}.entity-border.active.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 11 * var(--ghs-text-factor))}.entity-border.active.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .background-image-container[_ngcontent-%COMP%]{top:5%;left:0;height:75%;width:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor))}.entity-border.active.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .background-image-container[_ngcontent-%COMP%]   .background-image[_ngcontent-%COMP%]{top:8%;left:-35%;width:calc(var(--ghs-unit) * 6 * var(--ghs-text-factor))}.entity-border.active.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   ghs-summon-sheet[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}.entity-border.active.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * -1);left:calc(var(--ghs-unit) * -2)}.entity-border.active.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 6.5 * var(--ghs-text-factor));left:calc(var(--ghs-unit) * 1)}.entity-border.active.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .value-overlay[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 0 * var(--ghs-text-factor));bottom:calc(var(--ghs-unit) * -3 * var(--ghs-text-factor))}.entity-border.active.summon[_ngcontent-%COMP%]   ghs-healthbar[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * .4 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 29.2 * var(--ghs-text-factor))}.entity-border.active.summon.fh[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .background-image-container[_ngcontent-%COMP%]{top:25%;height:85%;width:calc(var(--ghs-unit) * 9.5 * var(--ghs-text-factor))}.entity-border.active.summon.fh[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .background-image-container[_ngcontent-%COMP%]   .background-image[_ngcontent-%COMP%]{top:0;left:-10%;width:calc(var(--ghs-unit) * 9.5 * var(--ghs-text-factor))}.entity-border.active.summon.fh[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 2)}.entity-border.active.summon[_ngcontent-%COMP%]   ghs-pointer-input.drag-hp[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 30 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 12 * var(--ghs-text-factor))}@keyframes _ngcontent-%COMP%_monster-entity-active-focus-fh{0%{box-shadow:0 0 calc(var(--ghs-unit) * 1) calc(var(--ghs-unit) * .3) var(--ghs-color-blue)}40%,60%{box-shadow:0 0 calc(var(--ghs-unit) * 1) calc(var(--ghs-unit) * .6) var(--ghs-color-blue)}to{box-shadow:0 0 calc(var(--ghs-unit) * 1) calc(var(--ghs-unit) * .3) var(--ghs-color-blue)}}.entity-border.fh.active.active-focus[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_monster-entity-active-focus-fh calc(var(--ghs-animation-speed) * 1s) ease-in-out infinite}.entity-border.fh.active[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]{box-shadow:0 0 calc(var(--ghs-unit) * 1) calc(var(--ghs-unit) * .5) var(--ghs-color-blue)}.entity-border.fh.active.active-turn[_ngcontent-%COMP%]   .monster-standee[_ngcontent-%COMP%], .entity-border.fh.active.active-turn[_ngcontent-%COMP%]   .objective-standee[_ngcontent-%COMP%]{box-shadow:0 0 calc(var(--ghs-unit) * 1) calc(var(--ghs-unit) * .5) var(--ghs-color-red)}@keyframes _ngcontent-%COMP%_monster-entity-revealed-fh{0%{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .1) var(--ghs-color-darkgray)}40%,60%{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .3) var(--ghs-color-darkgray)}to{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .1) var(--ghs-color-darkgray)}}.entity-border.fh.revealed[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .3) var(--ghs-color-darkgray);animation:_ngcontent-%COMP%_monster-entity-revealed-fh calc(var(--ghs-animation-speed) * 1s) ease-in-out infinite}.entity-border.fh.revealed[_ngcontent-%COMP%]   .entity.elite[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_monster-entity-revealed-elite calc(var(--ghs-animation-speed) * 1s) ease-in-out infinite}.entity-border.fh.revealed[_ngcontent-%COMP%]   .entity.boss[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_monster-entity-revealed-boss calc(var(--ghs-animation-speed) * 1s) ease-in-out infinite}.entity-border.fh[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions.actions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value.retaliate[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 1.1 * var(--ghs-text-factor))}.entity-border.modern[_ngcontent-%COMP%]:not(.active)   .standee[_ngcontent-%COMP%]{box-shadow:none;filter:none}']})}return a})();const NE=["charactertitle"],zE=["characterName"],LE=["summonButton"],qE=(a,r,n,i,e,o,g,m,k,X)=>({off:a,denied:r,absent:n,dimmed:i,compact:e,short:o,menu:g,fh:m,modern:k,"active-border":X}),er=(a,r)=>({empty:a,off:r}),ar=(a,r)=>({empty:a,disabled:r}),HE=a=>({"outer-denied":a}),Ui=a=>({active:a}),KE=a=>({identities:a}),WE=a=>({damage:a}),ZE=a=>({fh:a}),JE=()=>[],QE=a=>({disabled:a}),tw=(a,r)=>({bb:a,active:r}),nw=a=>({drawing:a}),ir=a=>({bb:a}),ew=a=>({"hand-size-margin":a}),xe=(a,r)=>r._trackUUID;function aw(a,r){if(1&a&&t.nrm(0,"ghs-standee",23),2&a){const n=r.$implicit,i=t.XpG(3);t.Y8G("figure",i.character)("entity",n)}}function iw(a,r){if(1&a&&(t.j41(0,"div",22),t.Z7z(1,aw,1,2,"ghs-standee",23,xe),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Dyx(t.bMT(3,0,n.summons))}}function ow(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",2),t.nrm(1,"span",7),t.j41(2,"span",19),t.bIt("click",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.openEntitiesMenu(e))}),t.nrm(3,"img",20)(4,"img",21),t.k0s(),t.nVh(5,iw,4,2,"div",22),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.l_i(5,er,0==n.summonCount,n.character.off||n.character.exhausted||n.character.health<=0)),t.R7$(2),t.Y8G("ngClass",t.l_i(8,ar,0==n.summonCount,n.summonCount<2))("entityAnimation",0==n.summonCount),t.R7$(),t.Y8G("src",n.character.iconUrl,t.B4B),t.R7$(2),t.vxM(n.summonCount?5:-1)}}function sw(a,r){if(1&a&&t.nrm(0,"ghs-character-initiative",25),2&a){const n=t.XpG(2);t.Y8G("figure",n.character)}}function rw(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",27)(1,"div",29)(2,"ghs-attackmodifier-deck",30),t.bIt("before",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.beforeAttackModifierDeck(e))})("after",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.afterAttackModifierDeck(e))}),t.k0s()(),t.j41(3,"div",31),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.toggleAttackModifierDeckVisible())}),t.k0s()()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Ui,n.character.attackModifierDeckVisible)),t.R7$(2),t.Y8G("character",n.character)}}function cw(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",35),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openLootDeckDialog())}),t.nrm(1,"ghs-loot",36),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(3);t.R7$(),t.Y8G("loot",i.gameManager.game.lootDeck.cards[n])("flipped",!0)("disableFlip",!0)}}function lw(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",28)(1,"div",29)(2,"div",32),t.Z7z(3,cw,2,3,"div",33,t.fX1),t.k0s()(),t.j41(5,"div",34),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.toggleLootCardsVisible())}),t.k0s()()}if(2&a){const n=t.XpG(2);t.R7$(3),t.Dyx(n.character.lootCards)}}function gw(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-pointer-input",24),t.bIt("dragMove",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.gameManager.stateManager.characterPermissions[o.character.name+"|"+o.character.edition]&&o.dragInitiativeMove(e))})("dragEnd",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.gameManager.stateManager.characterPermissions[o.character.name+"|"+o.character.edition]&&o.dragInitiativeEnd(e))})("singleClick",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.toggleFigure(e))})("doubleClick",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.gameManager.stateManager.characterPermissions[o.character.name+"|"+o.character.edition]&&o.initiativeDoubleClick(e))}),t.k0s(),t.nVh(1,sw,1,1,"ghs-character-initiative",25),t.nrm(2,"ghs-highlight-conditions",26),t.nVh(3,rw,4,4,"div",27),t.nVh(4,lw,6,0,"div",28)}if(2&a){const n=t.XpG();t.Y8G("draggingDisabled",!n.settingsManager.settings.dragValuesInitiative)("ngClass",t.eq3(7,HE,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.round&&!n.gameManager.stateManager.characterPermissions[n.character.name+"|"+n.character.edition])),t.R7$(),t.vxM(n.short?-1:1),t.R7$(),t.Y8G("entity",n.character)("figure",n.character),t.R7$(),t.vxM(!n.bb&&!n.settingsManager.settings.characterSheet||!n.settingsManager.settings.characterAttackModifierDeck||n.settingsManager.settings.characterAttackModifierDeckPermanent||n.settingsManager.settings.characterAttackModifierDeckActiveBottom?-1:3),t.R7$(),t.vxM(!n.bb&&n.settingsManager.settings.lootDeck&&n.character.lootCardsVisible?4:-1)}}function dw(a,r){if(1&a&&t.nrm(0,"ghs-character-initiative",25),2&a){const n=t.XpG(2);t.Y8G("figure",n.character)}}function hw(a,r){if(1&a&&t.nrm(0,"ghs-character-initiative",15),2&a){const n=t.XpG(2);t.Y8G("figure",n.character)}}function _w(a,r){1&a&&t.nrm(0,"img",45)}function mw(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",57),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openEntityMenu())})("doubleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.removeShield())}),t.nrm(1,"ghs-action",58),t.k0s()}if(2&a){const n=t.XpG(3);t.R7$(),t.Aen("fh"),t.Y8G("action",n.character.shield)}}function pw(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",57),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openEntityMenu())})("doubleClick",function(){const e=c.eBV(n).$index,o=t.XpG(3);return c.Njj(o.removeRetaliate(e))}),t.nrm(1,"ghs-action",58),t.k0s()}if(2&a){const n=r.$implicit;t.R7$(),t.Aen("fh"),t.Y8G("action",n)}}function uw(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",57),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openEntityMenu())})("doubleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.removeShieldPersistent())}),t.j41(1,"span",59),t.nrm(2,"span",60),t.k0s(),t.nrm(3,"ghs-action",58),t.k0s()}if(2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","%game.card.persistent%"),t.R7$(),t.Aen("fh"),t.Y8G("action",n.character.shieldPersistent)}}function fw(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",57),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openEntityMenu())})("doubleClick",function(){const e=c.eBV(n).$index,o=t.XpG(3);return c.Njj(o.removeRetaliatePersistent(e))}),t.j41(1,"span",59),t.nrm(2,"span",60),t.k0s(),t.nrm(3,"ghs-action",58),t.k0s()}if(2&a){const n=r.$implicit;t.R7$(2),t.Y8G("ghs-label","%game.card.persistent%"),t.R7$(),t.Aen("fh"),t.Y8G("action",n)}}function Cw(a,r){if(1&a&&(t.j41(0,"span",46),t.nVh(1,mw,2,3,"span",56),t.Z7z(2,pw,2,3,"span",56,xe),t.nI1(4,"trackUUID"),t.nVh(5,uw,4,4,"span",56),t.Z7z(6,fw,4,4,"span",56,xe),t.nI1(8,"trackUUID"),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.vxM(n.character.shield?1:-1),t.R7$(),t.Dyx(t.bMT(4,2,n.character.retaliate)),t.R7$(3),t.vxM(n.character.shieldPersistent?5:-1),t.R7$(),t.Dyx(t.bMT(8,4,n.character.retaliatePersistent))}}function Mw(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",61),t.bIt("dragMove",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.dragTokenMove(e))})("dragEnd",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.dragTokenEnd(e))})("dragCancel",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.dragCancel(e))})("singleClick",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.nextIdentity(e))}),t.EFF(1,">"),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","%data.characterToken."+n.character.name+"%")("relative",!0)("screenWidth",!0)}}function vw(a,r){if(1&a&&(t.j41(0,"span",49)(1,"span"),t.EFF(2),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(2),t.SpI("x",n.character.token+(n.character.primaryToken<0?n.token:0))}}function Ow(a,r){if(1&a&&t.nrm(0,"span",62),2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.Y8G("ghs-label","%data.characterToken."+i.character.name+"."+n+"%")}}function Pw(a,r){if(1&a&&(t.j41(0,"span",49)(1,"span"),t.EFF(2),t.k0s()()),2&a){const n=t.XpG().$index,i=t.XpG(2);t.R7$(2),t.SpI("x",i.character.tokenValues[n]+(i.character.primaryToken==n?i.token:0))}}function bw(a,r){if(1&a&&(t.nVh(0,Ow,1,1,"span",62),t.nVh(1,Pw,3,1,"span",49)),2&a){const n=r.$index,i=t.XpG(2);t.vxM(i.character.tokenValues[n]+(i.character.primaryToken==n?i.token:0)>0?0:-1),t.R7$(),t.vxM(i.character.tokenValues[n]+(i.character.primaryToken==n?i.token:0)>1?1:-1)}}function kw(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsMinZero"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Lme(" ",t.bMT(2,2,n.character.health+n.health),"/",n.character.maxHealth," ")}}function yw(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsMinZero"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Lme(" ",n.character.maxHealth,"/",t.bMT(2,2,n.character.maxHealth-(n.character.health+n.health))," ")}}function xw(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",63),t.bIt("dragMove",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.dragHpMove(e))})("dragEnd",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.dragHpEnd(e))})("dragCancel",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.dragCancel(e))})("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openEntityMenu())})("doubleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.toggleDamageHP())}),t.nrm(1,"img",43),t.nVh(2,kw,3,4,"span"),t.nVh(3,yw,3,4,"span"),t.nrm(4,"span",64),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","game.health")("ghs-label-attribute","title")("draggingDisabled",!n.settingsManager.settings.dragValuesHp)("relative",!0)("screenWidth",!0)("fastShift",!0),t.R7$(),t.Y8G("ngClass",t.eq3(14,WE,n.settingsManager.settings.damageHP))("src","./assets/images/"+(n.settingsManager.settings.damageHP?"action/damage.svg":"status/health.svg"),t.B4B),t.R7$(),t.vxM(n.settingsManager.settings.damageHP?-1:2),t.R7$(),t.vxM(n.settingsManager.settings.damageHP?3:-1),t.R7$(),t.Y8G("value-sign",n.health)("hideEmpty",!0)("reverse",n.settingsManager.settings.damageHP)("container",!0)}}function Ew(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",65),t.bIt("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.removeMarker(e))}),t.nrm(1,"img",66),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(),t.Y8G("src",i.gameManager.characterManager.characterIcon(n),t.B4B)}}function ww(a,r){if(1&a&&t.nrm(0,"img",72),2&a){const n=r.$implicit,i=t.XpG(2),e=i.$implicit,o=i.$index,g=t.XpG(2);t.xc7("z-index",10*o+e.value-n-1),t.Y8G("src","./assets/images"+(g.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+e.name+".svg",t.B4B)}}function Rw(a,r){if(1&a&&(t.Z7z(0,ww,1,3,"img",71,t.fX1),t.nI1(2,"ghsRange")),2&a){const n=t.XpG().$implicit;t.Dyx(t.i5U(2,0,t.lJ4(3,JE),n.value-1))}}function jw(a,r){if(1&a&&(t.j41(0,"span",73),t.EFF(1),t.k0s()),2&a){const n=t.XpG(),i=n.$implicit;t.xc7("z-index",10*n.$index+i.value+1),t.R7$(),t.JRh(i.value)}}function Gw(a,r){if(1&a&&t.nrm(0,"span",74),2&a){const n=t.XpG();t.xc7("z-index",10*n.$index+n.$implicit.value+2)}}function Tw(a,r){if(1&a&&t.nrm(0,"span",75),2&a){const n=t.XpG();t.xc7("z-index",10*n.$index+n.$implicit.value+3)}}function Sw(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",67),t.bIt("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.removeCondition(e))}),t.nrm(1,"img",66),t.nVh(2,Rw,3,4),t.nVh(3,jw,2,3,"span",68),t.nVh(4,Gw,1,2,"span",69),t.nVh(5,Tw,1,2,"span",70),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.Y8G("ngClass",t.eq3(8,ZE,e.settingsManager.settings.fhStyle)),t.R7$(),t.xc7("z-index",10*i+n.value),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+n.name+".svg",t.B4B),t.R7$(),t.vxM(n.types.includes(e.ConditionType.stack)?2:-1),t.R7$(),t.vxM(n.types.includes(e.ConditionType.value)&&!n.types.includes(e.ConditionType.stack)?3:-1),t.R7$(),t.vxM(e.character.immunities.includes(n.name)?4:-1),t.R7$(),t.vxM(n.permanent?5:-1)}}function Dw(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",37),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openEntityMenu())})("doubleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.compact&&e.openCharacterSheet())}),t.k0s(),t.j41(1,"div",38)(2,"div",37),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openEntityMenu())})("doubleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.compact&&e.openCharacterSheet())}),t.k0s(),t.nVh(3,dw,1,1,"ghs-character-initiative",25),t.j41(4,"div",39)(5,"div",37),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openEntityMenu())})("doubleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.compact&&e.openCharacterSheet())}),t.k0s(),t.j41(6,"span",40)(7,"span",41,0)(9,"span",42),t.bIt("dragMove",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.dragTokenMove(e))})("dragEnd",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.dragTokenEnd(e))})("dragCancel",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.dragCancel(e))})("singleClick",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.nextIdentity(e))}),t.nrm(10,"img",43),t.k0s(),t.nVh(11,hw,1,1,"ghs-character-initiative",15),t.j41(12,"span",44),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openEntityMenu())})("doubleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.compact&&e.openCharacterSheet())}),t.EFF(13),t.nVh(14,_w,1,0,"img",45),t.k0s()(),t.nVh(15,Cw,9,6,"span",46),t.j41(16,"span",47),t.nVh(17,Mw,2,3,"span",48),t.nVh(18,vw,3,1,"span",49),t.Z7z(19,bw,2,2,null,null,t.fX1),t.k0s()(),t.j41(21,"div",50),t.nVh(22,xw,5,16,"div",51),t.j41(23,"div",52),t.Z7z(24,Ew,2,1,"span",53,t.fX1),t.k0s(),t.j41(26,"div",54),t.Z7z(27,Sw,6,10,"span",55,xe),t.nI1(29,"trackUUID"),t.k0s()()()()}if(2&a){const n=t.XpG();t.R7$(3),t.vxM(n.short?3:-1),t.R7$(6),t.Y8G("relative",!0)("screenWidth",!0),t.R7$(),t.Y8G("ngClass",t.eq3(14,KE,n.settingsManager.settings.characterIdentities&&n.character.identities&&n.character.identities.length>1))("src",0!=n.character.identities.length&&n.settingsManager.settings.characterIdentities?n.gameManager.characterManager.characterIdentityIcon(n.character.name,n.character.identity):n.character.iconUrl,t.B4B),t.R7$(),t.vxM(n.compact?11:-1),t.R7$(2),t.SpI(" ",n.characterTitle," "),t.R7$(),t.vxM(n.character.exhausted?14:-1),t.R7$(),t.vxM(n.settingsManager.settings.characterShieldRetaliate?15:-1),t.R7$(2),t.vxM(n.character.token+(n.character.primaryToken<0?n.token:0)>0?17:-1),t.R7$(),t.vxM(n.character.token+(n.character.primaryToken<0?n.token:0)>1?18:-1),t.R7$(),t.Dyx(n.character.tokens),t.R7$(3),t.vxM(n.settingsManager.settings.hideCharacterHP?-1:22),t.R7$(2),t.Dyx(n.character.markers),t.R7$(3),t.Dyx(t.bMT(29,12,n.activeConditions))}}function $w(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",79),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openEntityMenu())})("doubleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.compact&&e.openCharacterSheet())}),t.k0s()}}function Iw(a,r){1&a&&t.nrm(0,"img",45)}function Aw(a,r){if(1&a&&(t.nVh(0,$w,1,0,"div",76),t.j41(1,"div",77,0)(3,"span",78),t.nrm(4,"img",66),t.k0s(),t.EFF(5),t.nVh(6,Iw,1,0,"img",45),t.k0s()),2&a){const n=t.XpG();t.vxM(n.character.absent?0:-1),t.R7$(4),t.Y8G("src",n.character.iconUrl,t.B4B),t.R7$(),t.SpI(" ",n.gameManager.characterManager.characterName(n.character,n.character.absent)," "),t.R7$(),t.vxM(n.character.exhausted?6:-1)}}function Vw(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",92),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.toggleLootCardsVisible())}),t.nrm(1,"img",93),t.j41(2,"span",94),t.EFF(3),t.k0s()()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(2,QE,n.character.lootCardsVisible)),t.R7$(3),t.JRh(n.character.lootCards.length)}}function Fw(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",95),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.toggleAttackModifierDeckVisible())}),t.nrm(1,"img",96),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","game.attackModifiers")("ghs-label-attribute","title")("ngClass",t.l_i(3,tw,n.bb,n.settingsManager.settings.characterAttackModifierDeckActiveBottom&&n.character.attackModifierDeckVisible))}}function Xw(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",83)(1,"ghs-attackmodifier-draw",97),t.bIt("drawing",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.amAnimationDrawing=e)}),t.k0s()()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(3,nw,n.amAnimationDrawing))("ngClass",t.eq3(5,ir,n.bb)),t.R7$(),t.Y8G("character",n.character)}}function Bw(a,r){1&a&&t.nrm(0,"img",99)}function Yw(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",98),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openBattleGoals())}),t.nrm(1,"img",66),t.nVh(2,Bw,1,0,"img",99),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","game.battleGoals")("ghs-label-attribute","title"),t.R7$(),t.Y8G("src",n.settingsManager.settings.fhStyle?"./assets/images/fh/battlegoals/battle-goal-back-fh.png":"./assets/images/battlegoals/battle-goal-back.png",t.B4B),t.R7$(),t.vxM(n.character.battleGoal&&n.character.battleGoals.length>0?2:-1)}}function Uw(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",100),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openItems())})("doubleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openItems(!0))}),t.nrm(1,"img",66),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","game.items")("ghs-label-attribute","title")("ngClass",t.eq3(4,ir,n.bb)),t.R7$(),t.Y8G("src",n.settingsManager.settings.fhStyle?"./assets/images/fh/items/item-back-fh.png":"./assets/images/items/item-back.png",t.B4B)}}function Nw(a,r){1&a&&t.nrm(0,"div",86)}function zw(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",87)(1,"div",37),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openEntityMenu())})("doubleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.compact&&e.openCharacterSheet())}),t.k0s(),t.j41(2,"a",101,1),t.bIt("singleClick",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.openSummonDialog(e))}),t.nrm(4,"img",102),t.k0s()()}2&a&&(t.R7$(2),t.Y8G("ghs-label","summon")("ghs-label-attribute","title"))}function Lw(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",88)(1,"div",103),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openEntityMenu())}),t.k0s(),t.j41(2,"a",104),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.shortMenu=!e.shortMenu)}),t.nrm(3,"img",105),t.k0s()()}}function qw(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",106),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.addExperience(1))})("doubleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.addExperience(-1))})("dragMove",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.dragXpMove(e))})("dragEnd",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.dragXpEnd(e))})("dragCancel",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.dragCancel(e))}),t.EFF(1),t.nrm(2,"img",107)(3,"span",108),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","game.experience")("ghs-label-attribute","title")("draggingDisabled",!n.settingsManager.settings.dragValuesXp)("relative",!0)("screenWidth",!0),t.R7$(),t.SpI(" ",n.character.experience+n.experience," "),t.R7$(2),t.Y8G("value-sign",n.experience)("hideEmpty",!0)("container",!0)}}function Hw(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",109),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.addLoot(1))})("doubleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.addLoot(-1))})("dragMove",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.dragLootMove(e))})("dragEnd",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.dragLootEnd(e))})("dragCancel",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.dragCancel(e))}),t.EFF(1),t.nrm(2,"img",110)(3,"span",108),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","game.loot")("ghs-label-attribute","title")("draggingDisabled",!n.settingsManager.settings.dragValuesLoot)("relative",!0)("screenWidth",!0),t.R7$(),t.SpI(" ",n.character.loot+n.loot," "),t.R7$(2),t.Y8G("value-sign",n.loot)("hideEmpty",!0)("container",!0)}}function Kw(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",80),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openEntityMenu())})("doubleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.compact&&e.openCharacterSheet())}),t.k0s(),t.nVh(1,Vw,4,4,"div",81),t.nVh(2,Fw,2,6,"span",82),t.nVh(3,Xw,2,7,"span",83),t.nVh(4,Yw,3,4,"div",84),t.nVh(5,Uw,2,6,"div",85),t.nVh(6,Nw,1,0,"div",86),t.nVh(7,zw,5,2,"div",87),t.nVh(8,Lw,4,0,"div",88),t.j41(9,"div",89)(10,"div",37),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openEntityMenu())})("doubleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.compact&&e.openCharacterSheet())}),t.k0s(),t.nVh(11,qw,4,9,"span",90),t.nVh(12,Hw,4,9,"span",91),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.vxM(!n.bb&&n.settingsManager.settings.lootDeck&&n.character.lootCards&&n.character.lootCards.length>0&&!n.settingsManager.settings.hideCharacterLoot?1:-1),t.R7$(),t.vxM((n.bb||n.settingsManager.settings.characterSheet)&&n.settingsManager.settings.characterAttackModifierDeck?2:-1),t.R7$(),t.vxM(!((n.bb&&!n.settingsManager.settings.characterAttackModifierDeckActiveBottom||!n.bb&&n.settingsManager.settings.characterSheet)&&n.settingsManager.settings.characterAttackModifierDeck&&n.settingsManager.settings.characterAttackModifierAnimate)||n.character.attackModifierDeckVisible||(n.settingsManager.settings.characterAttackModifierDeckPermanentActive||n.settingsManager.settings.characterAttackModifierDeckActiveBottom)&&n.character.active?-1:3),t.R7$(),t.vxM(n.bb||!n.gameManager.game.scenario||!n.settingsManager.settings.battleGoals||!n.gameManager.roundManager.firstRound&&!n.settingsManager.settings.battleGoalsCharacter&&n.settingsManager.settings.characterSheet&&n.settingsManager.settings.characterAttackModifierDeck?-1:4),t.R7$(),t.vxM(n.settingsManager.settings.characterItems?5:-1),t.R7$(),t.vxM(n.bb?6:-1),t.R7$(),t.vxM(!n.bb&&n.settingsManager.settings.summons?7:-1),t.R7$(),t.vxM(n.compact&&n.short?8:-1),t.R7$(3),t.vxM(n.bb||n.settingsManager.settings.hideCharacterXP?-1:11),t.R7$(),t.vxM(n.bb||n.settingsManager.settings.lootDeck&&(n.settingsManager.settings.alwaysLootDeck||n.gameManager.fhRules())||n.settingsManager.settings.hideCharacterLoot?-1:12)}}function Ww(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",111),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.settingsManager.settings.characterSheet?e.openCharacterSheet():e.openEntityMenu())})("doubleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.characterFullView())}),t.nrm(1,"img",66),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ghs-label","character.progress")("ghs-label-attribute","title")("ngClass",t.eq3(4,ew,n.settingsManager.settings.characterHandSize)),t.R7$(),t.Y8G("src",n.character.iconUrl,t.B4B)}}function Zw(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",112),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openEntityMenu())})("doubleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openAbilityCards())}),t.EFF(1),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.SpI(" ",n.character.handSize," ")}}function Jw(a,r){if(1&a&&(t.j41(0,"div",10),t.EFF(1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.SpI(" ",n.character.level-1,"|4 ")}}function Qw(a,r){if(1&a&&(t.j41(0,"div",11),t.EFF(1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.SpI(" ",n.character.level," ")}}function t7(a,r){if(1&a&&(t.j41(0,"div",12),t.EFF(1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.SpI(" #",n.character.number," ")}}function n7(a,r){1&a&&t.nrm(0,"span",115)}function e7(a,r){1&a&&(t.j41(0,"span",115),t.EFF(1,"|"),t.k0s())}function a7(a,r){1&a&&t.nrm(0,"span",115)}function i7(a,r){if(1&a&&(t.nVh(0,n7,1,0,"span",115),t.nrm(1,"span",116),t.nVh(2,e7,2,0,"span",115),t.nVh(3,a7,1,0,"span",115)),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.vxM(0==i?0:-1),t.R7$(),t.Y8G("ghs-label","data.character.traits."+n),t.R7$(),t.vxM(i<e.character.traits.length-1?2:-1),t.R7$(),t.vxM(i==e.character.traits.length-1?3:-1)}}function o7(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",113),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openEntityMenu())})("doubleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.compact&&e.openCharacterSheet())}),t.j41(1,"span",78),t.nrm(2,"img",114),t.k0s(),t.Z7z(3,i7,4,4,null,null,t.fX1),t.k0s()}if(2&a){const n=t.XpG();t.R7$(3),t.Dyx(n.character.traits)}}function s7(a,r){1&a&&(t.j41(0,"span",118),t.EFF(1,"|"),t.k0s())}function r7(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",117),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openEntityMenu())})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.removeSpecialAction(e.name))}),t.k0s(),t.nVh(1,s7,2,0,"span",118)}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.Y8G("ghs-label","data.character."+e.character.edition+"."+e.character.name+"."+n.name)("ghs-tooltip","data.character."+e.character.edition+"."+e.character.name+"."+n.name+".hint")("originY","top")("overlayY","bottom")("originX","center")("overlayX","center"),t.R7$(),t.vxM(i<e.specialActions.length-1&&e.specialActions.length>1?1:-1)}}function c7(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",14)(1,"div",37),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openEntityMenu())})("doubleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.compact&&e.openCharacterSheet())}),t.k0s(),t.Z7z(2,r7,2,7,null,null,xe),t.nI1(4,"trackUUID"),t.k0s()}if(2&a){const n=t.XpG();t.R7$(2),t.Dyx(t.bMT(4,0,n.specialActions))}}function l7(a,r){if(1&a&&t.nrm(0,"ghs-standee",119),2&a){const n=r.$implicit,i=t.XpG(3);t.Y8G("ngClass",t.eq3(3,Ui,n.active))("figure",i.character)("entity",n)}}function g7(a,r){if(1&a&&(t.j41(0,"div",22),t.Z7z(1,l7,1,5,"ghs-standee",119,xe),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Dyx(t.bMT(3,0,n.skullSpirits))}}function d7(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",16),t.nrm(1,"span",7),t.j41(2,"span",19),t.bIt("click",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.openEntitiesMenu(e))}),t.nrm(3,"img",20)(4,"img",21),t.k0s(),t.nVh(5,g7,4,2,"div",22),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.l_i(5,er,0==n.skullSpiritCount,n.character.off||n.character.exhausted||n.character.health<=0)),t.R7$(2),t.Y8G("ngClass",t.l_i(8,ar,0==n.skullSpiritCount,n.skullSpiritCount<2))("entityAnimation",0==n.skullSpiritCount),t.R7$(),t.Y8G("src",n.character.iconUrl,t.B4B),t.R7$(2),t.vxM(n.skullSpiritCount?5:-1)}}function h7(a,r){if(1&a&&(t.j41(0,"div",17),t.nrm(1,"ghs-character-item-list",5),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("character",n.character)}}function _7(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",18)(1,"div",29)(2,"ghs-attackmodifier-deck",30),t.bIt("before",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.beforeAttackModifierDeck(e))})("after",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.afterAttackModifierDeck(e))}),t.k0s()()()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(2,Ui,n.character.attackModifierDeckVisible||n.settingsManager.settings.characterAttackModifierDeckPermanentActive&&n.character.active)),t.R7$(2),t.Y8G("character",n.character)}}let or=(()=>{class a{dialog;overlay;ghsManager;character;titleInput;characterName;summonButton;gameManager=s.E;settingsManager=p.f;characterManager=s.E.characterManager;GameState=D.mk;ConditionType=Q.GV;AttackModifierType=w.Yn;levelDialog=!1;characterTitle="";initiative=-1;health=0;experience=0;loot=0;maxHp=0;token=0;amAnimationDrawing=!1;compact=!1;short=!1;shortMenu=!1;summons=[];skullSpirits=[];summonCount=0;skullSpiritCount=0;activeConditions=[];specialActions=[];bb=!1;constructor(n,i,e){this.dialog=n,this.overlay=i,this.ghsManager=e}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.characterTitle=s.E.characterManager.characterName(this.character),this.summons=this.character.summons.filter(n=>!n.tags.includes("cs-skull-spirit")),this.skullSpirits=this.character.summons.filter(n=>n.tags.includes("cs-skull-spirit")),this.summonCount=this.summons.filter(n=>s.E.entityManager.isAlive(n)).length,this.skullSpiritCount=this.skullSpirits.filter(n=>s.E.entityManager.isAlive(n)).length,this.activeConditions=s.E.entityManager.activeConditions(this.character),this.character.immunities.forEach(n=>{this.activeConditions.find(i=>i.name==n)||this.activeConditions.push(new Q.BR(n))}),p.f.settings.characterAttackModifierDeckPermanent&&p.f.settings.characterAttackModifierDeckPermanentActive&&s.E.game.state==D.mk.next&&this.character.active&&(this.character.attackModifierDeck.active=!0),this.compact=p.f.settings.characterCompact&&"modern"!=p.f.settings.theme,this.short=!(p.f.settings.abilities&&p.f.settings.stats||"modern"==p.f.settings.theme),this.shortMenu=!1,this.bb=s.E.bbRules()||this.character.bb,this.specialActions=this.character.specialActions.filter(n=>this.character.tags.includes(n.name))}beforeAttackModifierDeck(n){s.E.stateManager.before("updateAttackModifierDeck."+n.type,s.E.characterManager.characterName(this.character),...n.values)}afterAttackModifierDeck(n){this.character.attackModifierDeck=n.deck,s.E.stateManager.after()}exhausted(){this.character.exhausted=!this.character.exhausted,this.character.exhausted?(this.character.off=!0,this.character.active=!1):this.character.off=!1,s.E.sortFigures(this.character)}dragInitiativeMove(n){n>99?n=99:n<0&&(n=0),s.E.game.state==D.mk.next&&0==n&&p.f.settings.initiativeRequired&&(n=1),-1==this.initiative&&(this.initiative=this.character.initiative),this.character.initiative=n,this.character.initiativeVisible=!0,("prism"!=this.character.name||!this.character.tags.includes("long_rest"))&&(this.character.longRest=!1),99==n&&(this.character.longRest=!0)}dragInitiativeEnd(n){n>99?n=99:n<0&&(n=0),s.E.game.state==D.mk.next&&0==n&&p.f.settings.initiativeRequired&&(n=1),this.character.initiative!=this.initiative&&(this.character.initiative=this.initiative,s.E.stateManager.before("setInitiative",s.E.characterManager.characterName(this.character),""+n),this.character.initiative=n,99==n?this.character.longRest=!0:(!n||"prism"!=this.character.name||!this.character.tags.includes("long_rest"))&&(this.character.longRest=!1),this.initiative=-1,this.character instanceof H.K&&(this.character.initiativeVisible=!0),s.E.game.state==D.mk.next&&s.E.sortFigures(this.character),s.E.stateManager.after())}toggleFigure(n){if(!this.character.absent)if(s.E.game.state!=D.mk.next||this.character.exhausted||p.f.settings.initiativeRequired&&!(this.character.initiative>0))(p.f.settings.initiativeRequired&&this.character.initiative<=0||s.E.game.state==D.mk.draw)&&this.openInitiativeDialog(n);else{const i=this.character.summons.find(o=>o.active),e=this.character.summons.filter(o=>o.tags.includes("cs-skull-spirit"));p.f.settings.activeSummons&&!i&&this.character.active&&e.length&&!e.find(o=>o.active)?(s.E.stateManager.before("summonInactive",s.E.characterManager.characterName(this.character),"data.summon."+e[0].name),e.forEach(o=>o.tags.push("cs-skull-spirit-turn"))):p.f.settings.activeSummons&&this.character.active&&i?s.E.stateManager.before("summonInactive",s.E.characterManager.characterName(this.character),"data.summon."+i.name):s.E.stateManager.before(this.character.active?"unsetActive":"setActive",s.E.characterManager.characterName(this.character)),s.E.roundManager.toggleFigure(this.character),s.E.stateManager.after()}}nextIdentity(n){if(p.f.settings.characterIdentities&&this.character.identities&&this.character.identities.length>1){let i="blinkblade"==this.character.name&&this.character.tags.includes("time_tokens")&&0==this.character.primaryToken;if((s.E.game.state==D.mk.next||s.E.game.state==D.mk.draw&&0==this.character.identity&&0==this.character.tokenValues[0])&&i)return;let e=this.character.identity+1;e>=this.character.identities.length&&(e=0),s.E.stateManager.before("nextIdentity",s.E.characterManager.characterName(this.character,!1,!1,!1),this.character.name,this.character.identities[this.character.identity],this.character.identities[e],this.character.edition),this.character.identity=e,s.E.stateManager.after(),n.preventDefault()}else this.openEntityMenu()}openInitiativeDialog(n){this.dialog.open(ji,{panelClass:["dialog"],data:this.character,positionStrategy:this.overlay.position().flexibleConnectedTo(n.target).withPositions((0,F.yE)())})}initiativeDoubleClick(n){this.character.active&&this.character.summons.filter(i=>s.E.entityManager.isAlive(i)&&i.state!=_t.N5.new).find((i,e,o)=>i.active&&e<o.length-1)?this.character.summons.forEach(i=>i.active=!1):this.openInitiativeDialog(n)}dragHpMove(n){this.health=n;let i=(0,A.hZ)(this.character.maxHealth);"lightning"==this.character.name&&this.character.tags.find(e=>"unbridled-power"===e)&&(i=Math.max(i,26)),this.character.health+this.health>i&&(this.health=i-this.character.health)}dragHpEnd(n){0!=this.health&&(s.E.stateManager.before("changeHP",s.E.characterManager.characterName(this.character),(0,F.n1)(this.health)),s.E.entityManager.changeHealth(this.character,this.character,this.health),this.health=0,s.E.stateManager.after())}dragXpMove(n){this.experience=n,this.character.experience+this.experience<0&&(this.experience=-this.character.experience)}dragXpEnd(n){0!=this.experience&&(s.E.stateManager.before("changeXP",s.E.characterManager.characterName(this.character),(0,F.n1)(this.experience)),this.character.experience+=this.experience,this.experience=0,s.E.stateManager.after())}addExperience(n){this.experience=n,this.character.experience+this.experience>=0&&(s.E.stateManager.before("changeXP",s.E.characterManager.characterName(this.character),(0,F.n1)(this.experience)),this.character.experience+=this.experience,s.E.stateManager.after()),this.experience=0}dragTokenMove(n){this.token=n,this.character.primaryToken<0&&this.character.token+this.token<0?this.token=-this.character.token:this.character.primaryToken>=0&&this.character.tokenValues[this.character.primaryToken]+this.token<0?this.token=-this.character.tokenValues[this.character.primaryToken]:"blinkblade"==this.character.name&&this.character.tags.find(i=>["time_tokens","resonance_token"].indexOf(i)>=0)&&0==this.character.primaryToken&&this.character.tokenValues[0]+this.token>5&&(this.token=5-this.character.tokenValues[this.character.primaryToken])}dragTokenEnd(n){0!=this.token&&(this.character.primaryToken<0?(s.E.stateManager.before("setCharacterToken",s.E.characterManager.characterName(this.character),this.character.token+this.token),this.character.token+=this.token,this.token=0,s.E.stateManager.after()):(s.E.stateManager.before("setCharacterTokenValue",s.E.characterManager.characterName(this.character),"%data.characterToken."+this.character.name+"."+this.character.tokens[this.character.primaryToken]+"%",this.character.token+this.token),this.character.tokenValues[this.character.primaryToken]+=this.token,"blinkblade"==this.character.name&&this.character.tags.find(i=>["time_tokens","resonance_token"].indexOf(i)>=0)&&0==this.character.primaryToken&&this.character.tokenValues[0]>5&&(this.character.tokenValues[0]=5),this.token=0,s.E.stateManager.after()))}dragLootMove(n){this.loot=n,this.character.loot+this.loot<0&&(this.loot=-this.character.loot)}dragLootEnd(n){0!=this.loot&&(s.E.stateManager.before("changeLoot",s.E.characterManager.characterName(this.character),(0,F.n1)(this.loot)),this.character.loot+=this.loot,this.loot=0,s.E.stateManager.after())}addLoot(n){this.loot=n,this.character.loot+this.loot>=0&&(s.E.stateManager.before("changeLoot",s.E.characterManager.characterName(this.character),(0,F.n1)(this.loot)),this.character.loot+=this.loot,s.E.stateManager.after()),this.loot=0}dragCancel(n){this.health=0,this.experience=0,this.loot=0,this.token=0}openEntityMenu(){this.dialog.open(ze,{panelClass:["dialog"],data:{entity:this.character,figure:this.character},positionStrategy:this.overlay.position().flexibleConnectedTo(this.characterName).withPositions((0,F.yE)())})}toggleDamageHP(){this.compact?this.openCharacterSheet():p.f.settings.damageHPToggle&&p.f.toggle("damageHP")}openEntitiesMenu(n){this.dialog.open(bi,{panelClass:["dialog"],data:{character:this.character},positionStrategy:this.overlay.position().flexibleConnectedTo(n.target).withPositions((0,F.yE)())})}openSummonDialog(n){this.dialog.open(Zb,{panelClass:["dialog"],data:this.character,positionStrategy:this.overlay.position().flexibleConnectedTo(this.summonButton).withPositions((0,F.yE)("left"))})}openCharacterSheet(){this.dialog.open(An,{panelClass:["dialog-invert"],data:{character:this.character}})}removeCondition(n){s.E.stateManager.before(...s.E.entityManager.undoInfos(this.character,this.character,"removeCondition"),n.name);const i=this.character.immunities.indexOf(n.name);-1!=i&&this.character.immunities.splice(i,1),n.types.indexOf(Q.GV.stackable)&&n.value>1?n.value--:s.E.entityManager.removeCondition(this.character,this.character,n,n.permanent),s.E.stateManager.after()}removeMarker(n){const i=new H.K(s.E.getCharacterData(n),1),e=s.E.characterManager.characterName(i),o=i.name;s.E.stateManager.before(...s.E.entityManager.undoInfos(this.character,this.character,"removeMarker"),e,o),this.character.markers=this.character.markers.filter(g=>g!=n),s.E.stateManager.after()}openBattleGoals(){this.dialog.open(Oi,{panelClass:["dialog"],data:{character:this.character,draw:!this.character.battleGoals||0==this.character.battleGoals.length}})}openItems(n=!1){p.f.settings.characterItemsPermanent&&!n?(this.character.itemsVisible=!this.character.itemsVisible,s.E.stateManager.saveLocal(),this.ghsManager.triggerUiChange()):0!=this.character.progress.items.length&&!n||this.bb?this.dialog.open(fs,{panelClass:["dialog"],data:this.character}):this.dialog.open(Le,{panelClass:["dialog"],data:{edition:s.E.game.edition,select:this.character,affordable:!0}})}characterFullView(){p.f.settings.characterFullView?(s.E.game.figures.forEach(n=>{n instanceof H.K&&(n.fullview=!1)}),this.character.fullview=!0,s.E.stateManager.saveLocal(),this.ghsManager.triggerUiChange()):p.f.settings.characterSheet?this.openCharacterSheet():this.openEntityMenu()}toggleAttackModifierDeckVisible(){if(p.f.settings.characterAttackModifierDeckActiveBottom)this.character.attackModifierDeckVisible?(this.character.attackModifierDeckVisible=!1,this.character.active||s.E.game.figures.forEach(n=>{n instanceof H.K&&n.active&&(n.attackModifierDeckVisible=!0)})):(s.E.game.figures.forEach(n=>{n instanceof H.K&&(n.attackModifierDeckVisible=!1)}),this.character.attackModifierDeckVisible=!0);else if(!this.character.attackModifierDeckVisible||p.f.settings.characterAttackModifierDeckPermanent&&p.f.settings.characterAttackModifierDeckPermanentActive&&this.character.active)if(p.f.settings.characterAttackModifierDeckPermanent)this.character.attackModifierDeck.active=!0,this.character.attackModifierDeckVisible=!0,this.character.lootCardsVisible=!1;else if(p.f.settings.automaticAttackModifierFullscreen&&p.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)){this.character.lootCardsVisible=!1;const n=new t.bkB,i=new t.bkB;n.subscribe({next:o=>this.beforeAttackModifierDeck(o)}),i.subscribe({next:o=>this.afterAttackModifierDeck(o)}),this.dialog.open(Ci,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:{deck:this.character.attackModifierDeck,character:this.character,ally:!1,numeration:""+this.character.number,before:n,after:i}}).closed.subscribe({next:()=>{n.unsubscribe(),i.unsubscribe()}})}else this.character.attackModifierDeck.active=!0,this.character.attackModifierDeckVisible=!0,this.character.lootCardsVisible=!1;else this.character.attackModifierDeck.active=!1,this.character.attackModifierDeckVisible=!1;s.E.stateManager.saveLocal(),this.ghsManager.triggerUiChange()}toggleLootCardsVisible(){this.character.lootCardsVisible?this.character.lootCardsVisible=!1:p.f.settings.automaticAttackModifierFullscreen&&p.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)?(this.character.lootCardsVisible=!1,this.openLootDeckDialog()):(this.character.lootCardsVisible=!0,this.character.attackModifierDeck.active=!1,this.character.attackModifierDeckVisible=!1),s.E.stateManager.saveLocal()}openLootDeckDialog(){this.dialog.open($b,{panelClass:["dialog"],data:this.character})}removeShield(){s.E.stateManager.before(...s.E.entityManager.undoInfos(this.character,this.character,"removeEntityShield")),this.character.shield=void 0,s.E.stateManager.after()}removeShieldPersistent(){s.E.stateManager.before(...s.E.entityManager.undoInfos(this.character,this.character,"removeEntityShieldPersistent")),this.character.shieldPersistent=void 0,s.E.stateManager.after()}removeRetaliate(n){let i=JSON.parse(JSON.stringify(this.character.retaliate));i.splice(n,1),i.length>0?s.E.stateManager.before(...s.E.entityManager.undoInfos(this.character,this.character,"setEntityRetaliate"),i.map(e=>"%game.action.retaliate% "+(0,A.hZ)(e.value)+(e.subActions&&e.subActions[0]&&e.subActions[0].type==$.X2.range&&(0,A.hZ)(e.subActions[0].value)>1?" %game.action.range% "+(0,A.hZ)(e.subActions[0].value):"")).join(", ")):s.E.stateManager.before(...s.E.entityManager.undoInfos(this.character,this.character,"removeEntityRetaliate")),this.character.retaliate=i,s.E.stateManager.after()}removeRetaliatePersistent(n){let i=JSON.parse(JSON.stringify(this.character.retaliatePersistent));i.splice(n,1),i.length>0?s.E.stateManager.before(...s.E.entityManager.undoInfos(this.character,this.character,"setEntityRetaliatePersistent"),i.map(e=>"%game.action.retaliate% "+(0,A.hZ)(e.value)+(e.subActions&&e.subActions[0]&&e.subActions[0].type==$.X2.range&&(0,A.hZ)(e.subActions[0].value)>1?" %game.action.range% "+(0,A.hZ)(e.subActions[0].value):"")).join(", ")):s.E.stateManager.before(...s.E.entityManager.undoInfos(this.character,this.character,"removeEntityRetaliatePersistent")),this.character.retaliatePersistent=i,s.E.stateManager.after()}removeSpecialAction(n){s.E.stateManager.before("removeSpecialTags",s.E.characterManager.characterName(this.character),"%data.character."+this.character.edition+"."+this.character.name+"."+n+"%"),this.character.tags=this.character.tags.filter(i=>i!=n),"lightning"==this.character.name&&"careless-charge"==n&&(this.character.immunities=[]),"shackles"==this.character.name&&"delayed_malady"==n&&(this.character.immunities=[]),"boneshaper"==this.character.name&&("solid-bones"==n||"unholy-prowess"==n)&&this.character.summons.forEach(i=>{"shambling-skeleton"===i.name&&(i.maxHealth-=1,i.health>i.maxHealth?i.health=i.maxHealth:i.health-=1,s.E.entityManager.checkHealth(i,this.character),"solid-bones"==n&&(i.movement-=1,i.action=void 0))}),"astral"==this.character.name&&("veil-of-protection"==n&&(this.character.health-=3,this.character.maxHealth-=3,this.character.summons.forEach(i=>{i.health-=3,i.maxHealth-=3})),"imbue-with-life"==n&&(this.character.entityConditions=this.character.entityConditions.filter(i=>i.name!=Q.r5.disarm||!i.permanent))),s.E.stateManager.after()}openAbilityCards(){s.E.deckData(this.character,!0).abilities.length>0&&this.dialog.open(Us,{panelClass:["dialog"],data:{character:this.character}})}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG),t.rXU(qt.hJ),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-character"]],viewQuery:function(i,e){if(1&i&&(t.GBs(NE,5),t.GBs(zE,5),t.GBs(LE,5)),2&i){let o;t.mGM(o=t.lsd())&&(e.titleInput=o.first),t.mGM(o=t.lsd())&&(e.characterName=o.first),t.mGM(o=t.lsd())&&(e.summonButton=o.first)}},inputs:{character:"character"},standalone:!1,decls:21,vars:32,consts:[["characterName",""],["summonButton",""],[1,"summons-container",3,"ngClass"],[1,"character",3,"ngClass"],[3,"entity"],[3,"character"],[1,"stats"],[1,"spacer"],["ghs-pointer-input","",1,"character-sheet-button",3,"ghs-label","ghs-label-attribute","ngClass"],["ghs-pointer-input","",1,"hand-size"],[1,"hand-size"],[1,"character-level"],[1,"player-number"],["ghs-pointer-input","",1,"character-traits"],[1,"special-actions"],[3,"figure"],[1,"summons-container","spirits",3,"ngClass"],[1,"items-container-permanent"],[1,"attack-modifierdeck-container","permanent",3,"ngClass"],[1,"entities-menu",3,"click","ngClass","entityAnimation"],[1,"icon",3,"src"],["src","./assets/images/up.svg",1,"menu"],[1,"summons"],[3,"figure","entity"],[1,"drag-initiative",3,"dragMove","dragEnd","singleClick","doubleClick","draggingDisabled","ngClass"],[1,"initiative",3,"figure"],[3,"entity","figure"],[1,"attack-modifierdeck-container",3,"ngClass"],[1,"loot-cards-container"],[1,"scroll-container"],[3,"before","after","character"],[1,"attack-modifierdeck-close",3,"click"],[1,"loot-cards"],[1,"loot-card"],[1,"loot-cards-close",3,"click"],[1,"loot-card",3,"click"],[3,"loot","flipped","disableFlip"],["ghs-pointer-input","",1,"entity-menu-container",3,"singleClick","doubleClick"],[1,"column","col-1"],[1,"bar-container"],[1,"title-bar"],[1,"title"],["ghs-pointer-input","",1,"icon",3,"dragMove","dragEnd","dragCancel","singleClick","relative","screenWidth"],[3,"ngClass","src"],["ghs-pointer-input","",1,"name",3,"singleClick","doubleClick"],["src","./assets/images/status/exhausted.svg",1,"ghs-svg","exhausted"],[1,"actions"],[1,"token-container"],["ghs-pointer-input","",1,"token",3,"ghs-label","relative","screenWidth"],[1,"token","value"],[1,"status-bar"],["ghs-pointer-input","",1,"health",3,"ghs-label","ghs-label-attribute","draggingDisabled","relative","screenWidth","fastShift"],[1,"markers"],["ghs-pointer-input","",1,"marker"],[1,"conditions"],["ghs-pointer-input","",1,"condition",3,"ngClass"],["ghs-pointer-input","",1,"action"],["ghs-pointer-input","",1,"action",3,"singleClick","doubleClick"],[3,"action"],[1,"action-overlay"],[1,"text-white",3,"ghs-label"],["ghs-pointer-input","",1,"token",3,"dragMove","dragEnd","dragCancel","singleClick","ghs-label","relative","screenWidth"],[1,"token",3,"ghs-label"],["ghs-pointer-input","",1,"health",3,"dragMove","dragEnd","dragCancel","singleClick","doubleClick","ghs-label","ghs-label-attribute","draggingDisabled","relative","screenWidth","fastShift"],[1,"value-overlay",3,"value-sign","hideEmpty","reverse","container"],["ghs-pointer-input","",1,"marker",3,"doubleClick"],[3,"src"],["ghs-pointer-input","",1,"condition",3,"doubleClick","ngClass"],[1,"value",3,"z-index"],[1,"condition","immunity","condition-overlay",3,"z-index"],[1,"condition","permanent","condition-overlay",3,"z-index"],[1,"stack",3,"z-index","src"],[1,"stack",3,"src"],[1,"value"],[1,"condition","immunity","condition-overlay"],[1,"condition","permanent","condition-overlay"],["ghs-pointer-input","",1,"absent-menu"],[1,"title","absent"],[1,"icon"],["ghs-pointer-input","",1,"absent-menu",3,"singleClick","doubleClick"],["ghs-pointer-input","",1,"spacer",3,"singleClick","doubleClick"],["ghs-pointer-input","",1,"loot-cards-button",3,"ngClass"],["ghs-pointer-input","",1,"attack-modifier-button",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"attack-modifier-draw",3,"ngClass"],["ghs-pointer-input","",1,"battlegoals-button",3,"ghs-label","ghs-label-attribute"],["ghs-pointer-input","",1,"items-button",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"bb-spacer"],[1,"summon-dialog"],[1,"short-menu"],[1,"column","col-2"],["ghs-pointer-input","",1,"experience",3,"ghs-label","ghs-label-attribute","draggingDisabled","relative","screenWidth"],["ghs-pointer-input","",1,"loot",3,"ghs-label","ghs-label-attribute","draggingDisabled","relative","screenWidth"],["ghs-pointer-input","",1,"loot-cards-button",3,"singleClick","ngClass"],["src","./assets/images/fh/loot-token.png"],[1,"badge"],["ghs-pointer-input","",1,"attack-modifier-button",3,"singleClick","ghs-label","ghs-label-attribute","ngClass"],["src","./assets/images/attackmodifier/icon.png"],[3,"drawing","character"],["ghs-pointer-input","",1,"battlegoals-button",3,"singleClick","ghs-label","ghs-label-attribute"],["src","./assets/images/check.svg",1,"check"],["ghs-pointer-input","",1,"items-button",3,"singleClick","doubleClick","ghs-label","ghs-label-attribute","ngClass"],["ghs-pointer-input","",1,"summon-dialog-button",3,"singleClick","ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg",1,"ghs-svg"],["ghs-pointer-input","",1,"entity-menu-container",3,"singleClick"],["ghs-pointer-input","",1,"toggle-menu",3,"singleClick"],["src","./assets/images/menu.svg",1,"ghs-svg"],["ghs-pointer-input","",1,"experience",3,"singleClick","doubleClick","dragMove","dragEnd","dragCancel","ghs-label","ghs-label-attribute","draggingDisabled","relative","screenWidth"],["src","./assets/images/status/experience.svg"],[1,"value-overlay",3,"value-sign","hideEmpty","container"],["ghs-pointer-input","",1,"loot",3,"singleClick","doubleClick","dragMove","dragEnd","dragCancel","ghs-label","ghs-label-attribute","draggingDisabled","relative","screenWidth"],["src","./assets/images/status/loot.svg"],["ghs-pointer-input","",1,"character-sheet-button",3,"singleClick","doubleClick","ghs-label","ghs-label-attribute","ngClass"],["ghs-pointer-input","",1,"hand-size",3,"singleClick","doubleClick"],["ghs-pointer-input","",1,"character-traits",3,"singleClick","doubleClick"],["src","./assets/images/fh/character/traits/trait.svg",1,"ghs-svg"],[1,"divider"],[1,"trait",3,"ghs-label"],["ghs-pointer-input","",1,"special-tag","text-white",3,"singleClick","doubleClick","ghs-label","ghs-tooltip","originY","overlayY","originX","overlayX"],[1,"separator"],[3,"ngClass","figure","entity"]],template:function(i,e){1&i&&(t.nVh(0,ow,6,11,"div",2),t.j41(1,"div",3),t.nrm(2,"ghs-entity-index-key",4)(3,"ghs-character-image",5),t.nVh(4,gw,5,9),t.j41(5,"div",6),t.nVh(6,Dw,30,16),t.nVh(7,Aw,7,4),t.nrm(8,"span",7),t.nVh(9,Kw,13,10),t.nVh(10,Ww,2,6,"a",8),t.nVh(11,Zw,2,1,"div",9),t.nVh(12,Jw,2,1,"div",10),t.nVh(13,Qw,2,1,"div",11),t.nVh(14,t7,2,1,"div",12),t.nVh(15,o7,5,0,"div",13),t.nVh(16,c7,5,2,"div",14),t.k0s(),t.nrm(17,"ghs-figure-errors",15),t.k0s(),t.nVh(18,d7,6,11,"div",16),t.nVh(19,h7,2,1,"div",17),t.nVh(20,_7,3,4,"div",18)),2&i&&(t.vxM(!e.character.absent&&e.settingsManager.settings.summons?0:-1),t.R7$(),t.xc7("--ghs-character-color",e.character.color),t.Y8G("ngClass",t.zJS(21,qE,[e.character.off||e.character.exhausted||e.character.health<=0||e.character.absent,!e.gameManager.stateManager.characterPermissions[e.character.name+"|"+e.character.edition],e.character.absent,(e.bb||e.settingsManager.settings.characterSheet)&&e.settingsManager.settings.characterAttackModifierDeck&&e.character.attackModifierDeckVisible&&!e.settingsManager.settings.characterAttackModifierDeckPermanent&&!e.settingsManager.settings.characterAttackModifierDeckActiveBottom||e.settingsManager.settings.lootDeck&&e.settingsManager.settings.applyLoot&&e.character.lootCardsVisible,e.compact,e.short,e.shortMenu,"fh"==e.settingsManager.settings.theme,"modern"==e.settingsManager.settings.theme,e.character.active&&("modern"==e.settingsManager.settings.theme||e.compact)])),t.R7$(),t.Y8G("entity",e.character),t.R7$(),t.Y8G("character",e.character),t.R7$(),t.vxM(e.character.absent?-1:4),t.R7$(2),t.vxM(e.character.absent?-1:6),t.R7$(),t.vxM(e.character.absent?7:-1),t.R7$(2),t.vxM(e.character.absent?-1:9),t.R7$(),t.vxM(e.bb?-1:10),t.R7$(),t.vxM(e.character.bb||!e.settingsManager.settings.characterHandSize||e.character.absent?-1:11),t.R7$(),t.vxM(e.character.bb&&e.settingsManager.settings.characterHandSize&&!e.character.absent?12:-1),t.R7$(),t.vxM(e.settingsManager.settings.characterHandSize&&!e.character.absent?13:-1),t.R7$(),t.vxM(!e.character.bb&&e.settingsManager.settings.playerNumber?14:-1),t.R7$(),t.vxM(e.settingsManager.settings.characterTraits&&!e.character.absent&&e.character.traits.length>0?15:-1),t.R7$(),t.vxM(e.character.specialActions?16:-1),t.R7$(),t.Y8G("figure",e.character),t.R7$(),t.vxM(!e.character.absent&&e.settingsManager.settings.summons?18:-1),t.R7$(),t.vxM(e.settingsManager.settings.characterItems&&e.settingsManager.settings.characterItemsPermanent&&(e.character.itemsVisible||e.settingsManager.settings.characterItemsPermanentActive&&e.character.active&&e.character.progress.items.length>0)?19:-1),t.R7$(),t.vxM((e.bb||e.settingsManager.settings.characterSheet)&&e.settingsManager.settings.characterAttackModifierDeck&&e.settingsManager.settings.characterAttackModifierDeckPermanent&&!e.settingsManager.settings.characterAttackModifierDeckActiveBottom?20:-1))},dependencies:[N.YU,en,ye,$4,Zs,Yi,K4,$a,ba,Qs,it,Mt,Ia,ja,dt,Aa,Ne,Ma,At,ct],styles:['.attack-modifierdeck-container[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:5;width:0;height:0;visibility:hidden}.attack-modifierdeck-container[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;width:100%;overflow-x:auto;overflow-y:hidden}.attack-modifierdeck-container[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{position:absolute;display:flex;top:calc(var(--ghs-unit) * 1.5);left:calc(var(--ghs-unit) * 21.5);width:calc(var(--ghs-unit) * 37.5);height:calc(var(--ghs-unit) * 10);z-index:5}.attack-modifierdeck-container.active[_ngcontent-%COMP%], .attack-modifierdeck-container.loot-cards-container[_ngcontent-%COMP%], .loot-cards-container.active[_ngcontent-%COMP%], .loot-cards-container.loot-cards-container[_ngcontent-%COMP%]{visibility:visible;width:100%;height:100%}.attack-modifierdeck-container.permanent.active[_ngcontent-%COMP%], .loot-cards-container.permanent.active[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 98);height:calc(var(--ghs-unit) * 15.6)}.attack-modifierdeck-container.permanent.active[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%], .loot-cards-container.permanent.active[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 20)}.attack-modifierdeck-container.permanent.active[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%], .loot-cards-container.permanent.active[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 2.3);left:calc(var(--ghs-unit) * 17);width:calc(var(--ghs-unit) * 45);height:calc(var(--ghs-unit) * 12)}.attack-modifierdeck-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]{position:absolute;display:flex;top:calc(var(--ghs-unit) * .5 / var(--ghs-text-factor) / var(--ghs-text-factor));left:calc(var(--ghs-unit) * 21.5);z-index:3}.attack-modifierdeck-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 8.6666666667 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 13 * var(--ghs-text-factor));margin-right:calc(var(--ghs-unit) * .5 / var(--ghs-text-factor) / var(--ghs-text-factor))}.attack-modifierdeck-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]   ghs-loot[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]   ghs-loot[_ngcontent-%COMP%]{position:absolute;inset:0;display:block}.attack-modifierdeck-container[_ngcontent-%COMP%]   .attack-modifierdeck-close[_ngcontent-%COMP%], .attack-modifierdeck-container[_ngcontent-%COMP%]   .loot-cards-close[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .attack-modifierdeck-close[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .loot-cards-close[_ngcontent-%COMP%]{display:inline-block;position:relative;cursor:zoom-out;top:0;left:0;z-index:2;width:100%;height:100%}.summons-container[_ngcontent-%COMP%]{position:relative;z-index:2;display:flex;align-items:center;transition:max-height calc(var(--ghs-animation-speed) * 2s) ease-out;max-height:100%;min-width:calc(var(--ghs-unit) * 7);max-width:calc(var(--ghs-unit) * 96)}.summons-container.empty[_ngcontent-%COMP%]{max-height:0}.summons-container[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{flex:none;width:calc(var(--ghs-unit) * 10.5);height:100%}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:block;width:auto;height:calc(var(--ghs-unit) * 6);margin-right:calc(var(--ghs-unit) * 1)}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{height:100%;width:auto;filter:var(--ghs-filter-shadow)}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]   img.menu[_ngcontent-%COMP%]{position:absolute;top:50%;left:calc(var(--ghs-unit) * -4);transform:translateY(-50%);width:calc(var(--ghs-unit) * 3.7 * var(--ghs-text-factor));height:auto;filter:var(--ghs-filter-darkgray);opacity:.5}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]:not(.empty){opacity:1;transform:translate(0)}.summons-container[_ngcontent-%COMP%]   .entities-menu.empty[_ngcontent-%COMP%]{opacity:0;max-width:0;height:0;transform:translateY(100%)}.summons-container[_ngcontent-%COMP%]   .entities-menu.disabled[_ngcontent-%COMP%]{cursor:initial;pointer-events:none}.summons-container[_ngcontent-%COMP%]   .entities-menu.disabled[_ngcontent-%COMP%]   img.menu[_ngcontent-%COMP%]{display:none}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]:hover   img.icon[_ngcontent-%COMP%]{opacity:.5}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]:hover   img.menu[_ngcontent-%COMP%]{opacity:1}.summons-container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;max-width:calc(var(--ghs-unit) * 77.5)}.summons-container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   ghs-standee[_ngcontent-%COMP%]{position:relative;margin-bottom:calc(var(--ghs-unit) * 1)}.summons-container.spirits[_ngcontent-%COMP%]   ghs-standee[_ngcontent-%COMP%]{transition:top calc(var(--ghs-animation-speed) * .5s) ease-in-out}.summons-container.spirits[_ngcontent-%COMP%]   ghs-standee.active[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * -5)}.summons-container.off[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{filter:grayscale(100%)}.character[_ngcontent-%COMP%]{position:relative;z-index:1;height:100%;width:calc(var(--ghs-unit) * 98);height:calc(var(--ghs-unit) * 14);background-color:var(--ghs-character-color);background-image:url(char-mat.5a0fee77df1ff44e.png),url(char-mat.5a0fee77df1ff44e.png);background-blend-mode:multiply,overlay;background-size:100% 100%;display:flex;--ghs-character-color: #000;border-radius:calc(var(--ghs-unit) * .5);filter:var(--ghs-filter-outline);transition:background-color calc(var(--ghs-animation-speed) * .15s) ease-in-out,background-image calc(var(--ghs-animation-speed) * .15s) ease-in-out,background-blend-mode calc(var(--ghs-animation-speed) * .15s) ease-in-out}.character.dimmed[_ngcontent-%COMP%]{background-color:var(--ghs-color-gray);background-image:url(char-mat.5a0fee77df1ff44e.png);background-blend-mode:multiply}.character.dimmed[_ngcontent-%COMP%]   ghs-character-image[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   ghs-character-initiative[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .summon-dialog[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .short-menu[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .player-number[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]{filter:grayscale(.15);opacity:.5}.character[_ngcontent-%COMP%]   ghs-entity-index-key[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 5);left:calc(var(--ghs-unit) * 3.2);z-index:6}.character[_ngcontent-%COMP%]   ghs-character-image[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 9.5);height:calc(var(--ghs-unit) * 9.5);margin:calc(var(--ghs-unit) * 2.1) calc(var(--ghs-unit) * 3.4);left:calc(var(--ghs-unit) * 2.4)}.character[_ngcontent-%COMP%]   ghs-character-initiative[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   ghs-character-image[_ngcontent-%COMP%]{z-index:2}.character[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 2.1);left:calc(var(--ghs-unit) * 6);width:calc(var(--ghs-unit) * 9.5);height:calc(var(--ghs-unit) * 9.5);z-index:4}.character[_ngcontent-%COMP%]   .drag-initiative.dragging[_ngcontent-%COMP%]{left:0!important;width:100%!important}.character[_ngcontent-%COMP%]   ghs-highlight-conditions[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 10.5);bottom:calc(var(--ghs-unit) * 2.5);z-index:20}.character[_ngcontent-%COMP%]   .entity-menu-container[_ngcontent-%COMP%]{cursor:pointer;position:absolute;inset:0}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{height:100%;display:flex;flex-basis:100%;cursor:pointer;margin-left:calc(var(--ghs-unit) * 1)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:flex-start}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 13);max-width:calc(var(--ghs-unit) * 10);overflow:visible}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .bar-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:flex-start}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-2[_ngcontent-%COMP%]{width:auto;z-index:2}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]{display:flex;align-items:center;z-index:2}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5);color:var(--ghs-color-white);text-shadow:var(--ghs-outline);display:flex;align-items:center;white-space:nowrap}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:calc(var(--ghs-unit) * 5.5);margin-left:calc(var(--ghs-unit) * -1.1);margin-right:calc(var(--ghs-unit) * .5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:auto}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   img.exhausted[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1);height:calc(var(--ghs-unit) * 4);width:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .token-container[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--ghs-color-white);font-family:var(--ghs-font-text);margin-left:calc(var(--ghs-unit) * .5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .token-container[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.7);margin:0 calc(var(--ghs-unit) * .1)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .token-container[_ngcontent-%COMP%]   .token.placeholder[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * -.5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{position:relative;display:flex;margin-left:calc(var(--ghs-unit) * .5);font-size:calc(var(--ghs-unit) * 2)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{position:relative;margin-left:calc(var(--ghs-unit) * .5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]:hover{transform:translate(50%,50%) scale(2);transform-origin:center center;z-index:999}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]:hover:before{content:" ";position:absolute;top:calc(var(--ghs-unit) * -1);left:calc(var(--ghs-unit) * -1);right:calc(var(--ghs-unit) * -1);bottom:calc(var(--ghs-unit) * -1);background-color:var(--ghs-color-darkgray);opacity:.5;border-radius:calc(var(--ghs-unit) * 1)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .action-overlay[_ngcontent-%COMP%]{position:absolute;z-index:1;top:calc(var(--ghs-unit) * 1);left:calc(var(--ghs-unit) * -.5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .status-bar[_ngcontent-%COMP%]{display:flex;align-items:center;z-index:2;touch-action:none}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));width:auto}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]   img.damage[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) brightness(.7) var(--ghs-filter-outline-thin-black)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]   .value-overlay[_ngcontent-%COMP%]{position:absolute;left:100%;top:50%;transform:translateY(-50%);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor));z-index:1000}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;max-height:calc(var(--ghs-unit) * 7 * var(--ghs-text-factor));padding:0 calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));background-color:var(--ghs-color-darkgray);border-radius:100%;height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));margin-right:calc(var(--ghs-unit) * -1 * var(--ghs-text-factor));border-width:calc(var(--ghs-unit) * .4);border-style:solid;border-color:var(--ghs-color-gray)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.7 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 2.7 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]{position:relative;display:flex}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;margin-right:calc(var(--ghs-unit) * -.5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));overflow:visible}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));margin:0}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img.stack[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * -2 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition.condition-overlay[_ngcontent-%COMP%]{position:absolute;width:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));top:0;left:0;pointer-events:none;z-index:2}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));color:var(--ghs-color-white);position:absolute;top:calc(var(--ghs-unit) * 2.1 * var(--ghs-text-factor));left:50%;text-shadow:none;transform:translate(-50%)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:hover{transform:scale(2);transform-origin:center center;z-index:999}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw[_ngcontent-%COMP%]{position:relative;z-index:999;width:0;height:0;top:50%;left:calc(var(--ghs-unit) * -3);overflow:visible}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw[_ngcontent-%COMP%]   ghs-attackmodifier-draw[_ngcontent-%COMP%]{position:absolute;width:0;height:0}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw.drawing[_ngcontent-%COMP%]   ghs-attackmodifier-draw[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 18);height:calc(var(--ghs-unit) * 12)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;align-self:center;z-index:1}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor) * var(--ghs-text-factor));height:auto;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%]:hover, .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%]:hover, .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%]:hover, .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%]:hover{opacity:.7}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.disabled[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.disabled[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.disabled[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.disabled[_ngcontent-%COMP%]{pointer-events:none}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.loot-cards-button[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.loot-cards-button[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.loot-cards-button[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.loot-cards-button[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{position:absolute;bottom:calc(var(--ghs-unit) * -1.5 * var(--ghs-text-factor));right:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));color:var(--ghs-color-white)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.battlegoals-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.items-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.battlegoals-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.items-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.battlegoals-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.items-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.battlegoals-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.items-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));border-radius:calc(var(--ghs-unit) * .3 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.battlegoals-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.items-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.battlegoals-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.items-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.battlegoals-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.items-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.battlegoals-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.items-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-70%,-50%);width:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));filter:var(--ghs-filter-green) var(--ghs-filter-outline)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.attack-modifier-button.bb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.attack-modifier-button.bb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.attack-modifier-button.bb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.attack-modifier-button.bb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.attack-modifier-button.active[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.attack-modifier-button.active[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.attack-modifier-button.active[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.attack-modifier-button.active[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor) * var(--ghs-text-factor));height:auto}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.items-button.bb[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.items-button.bb[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.items-button.bb[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.items-button.bb[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .bb-spacer[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 7 / var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));filter:var(--ghs-filter-shadow);width:calc(var(--ghs-unit) * 6.5);margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));margin-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .experience.experience[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot.experience[_ngcontent-%COMP%]{color:var(--ghs-color-blue)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .experience.loot[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot.loot[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.character.absent[_ngcontent-%COMP%]{cursor:initial;opacity:.6}.character.absent[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{cursor:initial}.character[_ngcontent-%COMP%]   .absent-menu[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:calc(var(--ghs-unit) * 82);height:calc(var(--ghs-unit) * 14);cursor:pointer;z-index:2}.character[_ngcontent-%COMP%]   .summon-dialog[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .short-menu[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .summon-dialog-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .toggle-menu[_ngcontent-%COMP%]{position:relative;display:flex;width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));cursor:pointer;font-size:calc(var(--ghs-unit) * 10 * var(--ghs-text-factor));color:var(--ghs-color-gray);filter:var(--ghs-filter-gray);stroke:var(--ghs-color-black);stroke-width:calc(var(--ghs-unit) * 1.5)}.character[_ngcontent-%COMP%]   .summon-dialog-button[_ngcontent-%COMP%]:hover, .character[_ngcontent-%COMP%]   .toggle-menu[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white);filter:var(--ghs-filter-white)}.character[_ngcontent-%COMP%]   .summon-dialog-button.toggle-menu[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .toggle-menu.toggle-menu[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   ghs-figure-errors[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 14.5);top:50%;transform:translateY(-50%);z-index:99}.character[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]{position:relative;cursor:pointer;height:100%;width:calc(var(--ghs-unit) * 10);display:flex;justify-content:center;align-items:center;margin-right:calc(var(--ghs-unit) * 4);margin-left:calc(var(--ghs-unit) * 2)}.character[_ngcontent-%COMP%]   .character-sheet-button.hand-size-margin[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 4.5)}.character[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 8);width:auto;filter:var(--ghs-filter-shadow)}.character[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%]{position:absolute;right:calc(var(--ghs-unit) * 14);top:calc(var(--ghs-unit) * 4);width:calc(var(--ghs-unit) * 4.2);height:calc(var(--ghs-unit) * 5);display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.4);padding-right:calc(var(--ghs-unit) * .4);z-index:1}.character[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%]:after{content:" ";position:absolute;inset:0;background-color:var(--ghs-character-color);-webkit-mask-image:url(hand-size-mask.5857c02745e3d418.svg);mask-image:url(hand-size-mask.5857c02745e3d418.svg);-webkit-mask-size:100%;mask-size:100%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;filter:brightness(1.6);z-index:-1}.character[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]{position:absolute;right:calc(var(--ghs-unit) * 13.3);top:calc(var(--ghs-unit) * 10);width:calc(var(--ghs-unit) * 4.2);height:calc(var(--ghs-unit) * 5);display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.4);padding-right:calc(var(--ghs-unit) * .4);z-index:1}.character[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:0;left:calc(var(--ghs-unit) * -.5);bottom:0;right:0;background-color:var(--ghs-character-color);-webkit-mask-image:url(level.38e1f58a07dc5898.svg);mask-image:url(level.38e1f58a07dc5898.svg);-webkit-mask-size:100%;mask-size:100%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;z-index:-1}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 32.5);top:calc(var(--ghs-unit) * .5);width:calc(var(--ghs-unit) * 33);height:calc(var(--ghs-unit) * 2.64);display:flex;justify-content:space-evenly;align-items:center;z-index:0}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:0;background-color:var(--ghs-character-color);-webkit-mask-image:url(outer-mask.f0af43cfab648186.svg);mask-image:url(outer-mask.f0af43cfab648186.svg);-webkit-mask-size:100%;mask-size:100%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;z-index:0}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]:after{content:" ";position:absolute;inset:0;background-color:var(--ghs-character-color);-webkit-mask-image:url(inner-mask.f2d18d4a7559b09e.svg);mask-image:url(inner-mask.f2d18d4a7559b09e.svg);-webkit-mask-size:100%;mask-size:100%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;filter:brightness(.5);z-index:1}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]   .trait[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.5);color:var(--ghs-character-color);z-index:2}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{position:absolute;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 1.8);height:calc(var(--ghs-unit) * 1.8);left:0;top:50%;transform:translateY(-45%) rotate(45deg);border:calc(var(--ghs-unit) * .2) solid var(--ghs-character-color);z-index:2}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:110%;width:auto;filter:var(--ghs-filter-white);transform:rotate(-45deg);z-index:1}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:0;background-color:var(--ghs-character-color);z-index:0;filter:brightness(.5)}.character[_ngcontent-%COMP%]   .player-number[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 1.8);top:calc(var(--ghs-unit) * 4.3);width:calc(var(--ghs-unit) * 5);height:calc(var(--ghs-unit) * 5);display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.7);z-index:1;border:calc(var(--ghs-unit) * .2) solid var(--ghs-color-gray);border-top-left-radius:80%;border-bottom-left-radius:80%;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}.character[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 18 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 62 * var(--ghs-text-factor));bottom:calc(var(--ghs-unit) * .5);color:var(--ghs-color-white);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2);display:flex;justify-content:center;align-items:center}.character[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * .2 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]:before{transition:filter calc(var(--ghs-animation-speed) * .15s) ease-in-out}.character.off[_ngcontent-%COMP%]{background-color:var(--ghs-color-gray);background-image:url(char-mat.5a0fee77df1ff44e.png);background-blend-mode:multiply}.character.off[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .summon-dialog[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .short-menu[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]:before{filter:grayscale(1)!important}.character.denied[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .attack-modifierdeck-close[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .loot-cards-close[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{pointer-events:initial}.character.fh[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]:after{top:calc(var(--ghs-unit) * -.5)}.character.short[_ngcontent-%COMP%]:not(.compact){width:calc(var(--ghs-unit) * 57);height:calc(var(--ghs-unit) * 28);background-image:url(char-mat-short.a094776e83c7bcfc.png),url(char-mat-short.a094776e83c7bcfc.png)}.character.short[_ngcontent-%COMP%]:not(.compact)   ghs-character-image[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * 2.8) calc(var(--ghs-unit) * 2)}.character.short[_ngcontent-%COMP%]:not(.compact)   ghs-highlight-conditions[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 9);bottom:calc(var(--ghs-unit) * 16)}.character.short[_ngcontent-%COMP%]:not(.compact)   .drag-initiative[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 2.8);left:calc(var(--ghs-unit) * 4.3)}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 2);right:calc(var(--ghs-unit) * 2);height:calc(var(--ghs-unit) * 26.5);flex-wrap:wrap}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 12);width:100%;max-width:initial;flex-direction:row;justify-content:flex-start;align-items:center}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   ghs-character-initiative[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 10);margin-top:calc(var(--ghs-unit) * 1);margin-left:initial}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .bar-container[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1.5);max-width:calc(var(--ghs-unit) * 40)}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .bar-container[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]{flex-wrap:wrap}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));flex-wrap:wrap}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 2);margin-right:calc(var(--ghs-unit) * 2);margin-top:calc(var(--ghs-unit) * 2);height:auto}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 16);left:calc(var(--ghs-unit) * 0);right:initial}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 20.5);left:calc(var(--ghs-unit) * .2);right:initial}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .player-number[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 4.8);left:calc(var(--ghs-unit) * -6.7)}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 14)}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * -2.5 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 56 * var(--ghs-text-factor));bottom:calc(var(--ghs-unit) * -1)}.character.compact[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 10.25);background-image:url(char-mat_compact.b0d0dd33f05dffe7.png),url(char-mat_compact.b0d0dd33f05dffe7.png)}.character.compact[_ngcontent-%COMP%]   ghs-entity-index-key[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 3.1)}.character.compact[_ngcontent-%COMP%]   ghs-character-image[_ngcontent-%COMP%], .character.compact[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]{display:none}.character.compact[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 2.5);left:calc(var(--ghs-unit) * 6.5);width:calc(var(--ghs-unit) * 5);height:calc(var(--ghs-unit) * 5)}.character.compact[_ngcontent-%COMP%]   .attack-modifierdeck-container[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 1 / var(--ghs-text-factor));left:calc(var(--ghs-unit) * 13);width:calc(var(--ghs-unit) * 30 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 8 * var(--ghs-text-factor))}.character.compact[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * .5 / var(--ghs-text-factor) / var(--ghs-text-factor));left:calc(var(--ghs-unit) * 8)}.character.compact[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 6 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 9 * var(--ghs-text-factor))}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 7)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%], .character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .bar-container[_ngcontent-%COMP%]{flex-direction:row;justify-content:flex-start;align-items:center}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .bar-container[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]{flex-wrap:initial}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * .5);margin-left:calc(var(--ghs-unit) * -.5)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4.5)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 7 * var(--ghs-text-factor));padding-top:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-2[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 7)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%], .character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 6)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw.drawing[_ngcontent-%COMP%]   ghs-attackmodifier-draw[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 13.5);height:calc(var(--ghs-unit) * 9)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 1.4);right:calc(var(--ghs-unit) * 2);left:initial}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 6);right:calc(var(--ghs-unit) * 1.8);left:initial}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .player-number[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 3.3);left:calc(var(--ghs-unit) * 1.7);width:calc(var(--ghs-unit) * 3.5);height:calc(var(--ghs-unit) * 3.5);font-size:calc(var(--ghs-unit) * 2);border-radius:80%}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]{display:none}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 11);bottom:0;width:calc(var(--ghs-unit) * 71);justify-content:flex-start}.character.compact.short[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 57)}.character.compact.short[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 2)}.character.compact.short[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * .5)}.character.compact.short[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3);white-space:initial}.character.compact.short[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .status-bar[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{width:auto}.character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1.5)}.character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .col-1[_ngcontent-%COMP%]{max-width:calc(var(--ghs-unit) * 35)}.character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .summon-dialog[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-2[_ngcontent-%COMP%]{display:none}.character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .short-menu[_ngcontent-%COMP%]{position:absolute;top:0;right:calc(var(--ghs-unit) * 6);bottom:0;z-index:2}.character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 11)}.character.compact.short.menu[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   ghs-highlight-conditions[_ngcontent-%COMP%]{display:none}.character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 4.5)}.character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{display:none}.character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .summon-dialog[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-2[_ngcontent-%COMP%]{display:inherit}.character.modern[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 16);border-top-left-radius:calc(var(--ghs-unit) * 13);border-top-right-radius:calc(var(--ghs-unit) * 12);border-bottom-right-radius:calc(var(--ghs-unit) * 12);background-image:url(char-mat_modern.2238b82519930f08.png);background-blend-mode:hard-light;filter:none;overflow:hidden}.character.modern.dimmed[_ngcontent-%COMP%]{background-image:url(char-mat_modern.2238b82519930f08.png)}.character.modern[_ngcontent-%COMP%]   ghs-entity-index-key[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * .5);left:calc(var(--ghs-unit) * 13.7)}.character.modern[_ngcontent-%COMP%]   ghs-character-image[_ngcontent-%COMP%], .character.modern[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{top:0;left:0;width:calc(var(--ghs-unit) * 16);height:calc(var(--ghs-unit) * 16);margin:0}.character.modern[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 5)}.character.modern[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:grayscale(1) brightness(.3)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 2.5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * -1 / var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4.5);filter:grayscale(1) brightness(.3);margin-left:calc(var(--ghs-unit) * -.5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .status-bar[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 2.5);min-height:calc(var(--ghs-unit) * 5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 5.5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .summon-dialog-button[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .col-2[_ngcontent-%COMP%]{padding-top:calc(var(--ghs-unit) * 5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 6.5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * 13.9);top:0}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]:after{top:calc(var(--ghs-unit) * -.5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 18);top:initial;bottom:0}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]:before{transform:rotate(180deg)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]:after{transform:rotate(180deg)}.character.modern[_ngcontent-%COMP%]   .attack-modifierdeck-container[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 3 / var(--ghs-text-factor) / var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * .5 / var(--ghs-text-factor) / var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 10 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 15 * var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 17);width:calc(var(--ghs-unit) * 55);justify-content:flex-start}']})}return a})();var Ee=v(9819),we=v(3417);const Vt=a=>[a],ie=(a,r)=>r._trackUUID;function m7(a,r){1&a&&t.nrm(0,"div",2)}function p7(a,r){if(1&a&&(t.j41(0,"th")(1,"span",4),t.nrm(2,"img",5),t.j41(3,"span",6),t.EFF(4),t.k0s()()()),2&a){const n=r.$implicit,i=t.XpG();t.R7$(2),t.Y8G("src",n.iconUrl,t.B4B),t.R7$(2),t.SpI(" ",i.gameManager.characterManager.characterName(n)," ")}}function u7(a,r){1&a&&(t.j41(0,"th"),t.nrm(1,"span",3),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","scenario.stats.total"))}function f7(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s(),t.j41(2,"span",7),t.EFF(3),t.k0s(),t.j41(4,"span",8),t.EFF(5),t.k0s()),2&a){const n=t.XpG().$index,i=t.XpG();t.R7$(),t.JRh(i.scenarios[n][0]),t.R7$(2),t.JRh(i.scenarios[n][1]),t.R7$(2),t.JRh(i.scenarios[n][2])}}function C7(a,r){if(1&a&&(t.j41(0,"td"),t.nVh(1,f7,6,3),t.k0s()),2&a){const n=r.$index,i=t.XpG();t.R7$(),t.vxM(i.scenarios[n]&&i.scenarios[n].length>2?1:-1)}}function M7(a,r){if(1&a&&(t.j41(0,"td")(1,"span"),t.EFF(2),t.k0s(),t.j41(3,"span",7),t.EFF(4),t.k0s(),t.j41(5,"span",8),t.EFF(6),t.k0s()()),2&a){const n=t.XpG();t.R7$(2),t.JRh(n.scenarios[n.characters.length][0]),t.R7$(2),t.JRh(n.scenarios[n.characters.length][1]),t.R7$(2),t.JRh(n.scenarios[n.characters.length][2])}}function v7(a,r){if(1&a&&(t.j41(0,"td"),t.nrm(1,"span",9)(2,"span",9)(3,"span",9),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.dealtDamage")("ghs-label-args",t.eq3(15,Vt,n.scenarioStats.dealtDamage))("ghs-tooltip","scenario.stats.dealtDamage.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.monsterDamage")("ghs-label-args",t.eq3(17,Vt,n.scenarioStats.monsterDamage))("ghs-tooltip","scenario.stats.monsterDamage.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.otherDamage")("ghs-label-args",t.eq3(19,Vt,n.scenarioStats.otherDamage))("ghs-tooltip","scenario.stats.otherDamage.hint")}}function O7(a,r){if(1&a&&(t.j41(0,"td"),t.nrm(1,"span",9)(2,"span",9)(3,"span",9),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.dealtDamage")("ghs-label-args",t.eq3(15,Vt,n.overall.dealtDamage))("ghs-tooltip","scenario.stats.dealtDamage.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.monsterDamage")("ghs-label-args",t.eq3(17,Vt,n.overall.monsterDamage))("ghs-tooltip","scenario.stats.monsterDamage.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.otherDamage")("ghs-label-args",t.eq3(19,Vt,n.overall.otherDamage))("ghs-tooltip","scenario.stats.otherDamage.hint")}}function P7(a,r){if(1&a&&(t.j41(0,"td"),t.nrm(1,"span",9)(2,"span",9),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.heals")("ghs-label-args",t.eq3(10,Vt,n.scenarioStats.heals))("ghs-tooltip","scenario.stats.heals.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.healedDamage")("ghs-label-args",t.eq3(12,Vt,n.scenarioStats.healedDamage))("ghs-tooltip","scenario.stats.healedDamage.hint")}}function b7(a,r){if(1&a&&(t.j41(0,"td"),t.nrm(1,"span",9)(2,"span",9),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.heals")("ghs-label-args",t.eq3(10,Vt,n.overall.heals))("ghs-tooltip","scenario.stats.heals.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.healedDamage")("ghs-label-args",t.eq3(12,Vt,n.overall.healedDamage))("ghs-tooltip","scenario.stats.healedDamage.hint")}}function k7(a,r){if(1&a&&t.nrm(0,"span",12),2&a){const n=t.XpG().$implicit;t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.normalKills")("ghs-label-args",t.eq3(5,Vt,n.scenarioStats.normalKills))("ghs-tooltip","scenario.stats.normalKills.hint")}}function y7(a,r){if(1&a&&t.nrm(0,"span",9),2&a){const n=t.XpG().$implicit;t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.eliteKills")("ghs-label-args",t.eq3(5,Vt,n.scenarioStats.eliteKills))("ghs-tooltip","scenario.stats.eliteKills.hint")}}function x7(a,r){if(1&a&&t.nrm(0,"span",9),2&a){const n=t.XpG().$implicit;t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.bossKills")("ghs-label-args",t.eq3(5,Vt,n.scenarioStats.bossKills))("ghs-tooltip","scenario.stats.bossKills.hint")}}function E7(a,r){if(1&a&&(t.j41(0,"td"),t.nVh(1,k7,1,7,"span",10),t.nVh(2,y7,1,7,"span",11),t.nVh(3,x7,1,7,"span",11),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.vxM(n.scenarioStats.normalKills?1:-1),t.R7$(),t.vxM(n.scenarioStats.eliteKills?2:-1),t.R7$(),t.vxM(n.scenarioStats.bossKills?3:-1)}}function w7(a,r){if(1&a&&t.nrm(0,"span",12),2&a){const n=t.XpG(2);t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.normalKills")("ghs-label-args",t.eq3(5,Vt,n.overall.normalKills))("ghs-tooltip","scenario.stats.normalKills.hint")}}function R7(a,r){if(1&a&&t.nrm(0,"span",9),2&a){const n=t.XpG(2);t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.eliteKills")("ghs-label-args",t.eq3(5,Vt,n.overall.eliteKills))("ghs-tooltip","scenario.stats.eliteKills.hint")}}function j7(a,r){if(1&a&&t.nrm(0,"span",9),2&a){const n=t.XpG(2);t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.bossKills")("ghs-label-args",t.eq3(5,Vt,n.overall.bossKills))("ghs-tooltip","scenario.stats.bossKills.hint")}}function G7(a,r){if(1&a&&(t.j41(0,"td"),t.nVh(1,w7,1,7,"span",10),t.nVh(2,R7,1,7,"span",11),t.nVh(3,j7,1,7,"span",11),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.vxM(n.overall.normalKills?1:-1),t.R7$(),t.vxM(n.overall.eliteKills?2:-1),t.R7$(),t.vxM(n.overall.bossKills?3:-1)}}function T7(a,r){if(1&a&&(t.j41(0,"td"),t.nrm(1,"span",9)(2,"span",9),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.maxDealtDamage")("ghs-label-args",t.eq3(10,Vt,n.scenarioStats.maxDealtDamage))("ghs-tooltip","scenario.stats.maxDealtDamage.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.maxDamage")("ghs-label-args",t.eq3(12,Vt,n.scenarioStats.maxDamage))("ghs-tooltip","scenario.stats.maxDamage.hint")}}function S7(a,r){if(1&a&&(t.j41(0,"td"),t.nrm(1,"span",9)(2,"span",9),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.maxDealtDamage")("ghs-label-args",t.eq3(10,Vt,n.overall.maxDealtDamage))("ghs-tooltip","scenario.stats.maxDealtDamage.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.maxDamage")("ghs-label-args",t.eq3(12,Vt,n.overall.maxDamage))("ghs-tooltip","scenario.stats.maxDamage.hint")}}function D7(a,r){if(1&a&&(t.j41(0,"td"),t.nrm(1,"span",9)(2,"span",9)(3,"span",9),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.gold")("ghs-label-args",t.eq3(15,Vt,n.scenarioStats.gold))("ghs-tooltip","scenario.stats.gold.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.xp")("ghs-label-args",t.eq3(17,Vt,n.scenarioStats.xp))("ghs-tooltip","scenario.stats.xp.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.treasures")("ghs-label-args",t.eq3(19,Vt,n.scenarioStats.treasures))("ghs-tooltip","scenario.stats.treasures.hint")}}function $7(a,r){if(1&a&&(t.j41(0,"td"),t.nrm(1,"span",9)(2,"span",9)(3,"span",9),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.gold")("ghs-label-args",t.eq3(15,Vt,n.overall.gold))("ghs-tooltip","scenario.stats.gold.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.xp")("ghs-label-args",t.eq3(17,Vt,n.overall.xp))("ghs-tooltip","scenario.stats.xp.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.treasures")("ghs-label-args",t.eq3(19,Vt,n.overall.treasures))("ghs-tooltip","scenario.stats.treasures.hint")}}let sr=(()=>{class a{character;characters=[];scenarios=[];overall=new Ee.yn;retired=!1;available=!1;gameManager=s.E;constructor(n){this.character=n}ngOnInit(){this.update()}update(){this.character?this.characters=[this.character]:(this.characters=s.E.game.figures.filter(n=>n instanceof H.K).map(n=>{const i=new H.K(n,n.level);return i.fromModel(n.toModel()),i}),this.retired&&this.characters.push(...s.E.game.party.retirements.map(n=>{const i=new H.K(s.E.getCharacterData(n.name,n.edition),n.level);return i.fromModel(n),i})),this.available&&this.characters.push(...s.E.game.party.availableCharacters.map(n=>{const i=new H.K(s.E.getCharacterData(n.name,n.edition),n.level);return i.fromModel(n),i}))),this.characters.forEach((n,i)=>{n.scenarioStats=new Ee.yn,this.scenarios[i]=[0,0,0],n.progress.scenarioStats.length&&(n.scenarioStats=this.scenarioStatisticsSum(n.progress.scenarioStats),this.scenarios[i]=[n.progress.scenarioStats.length,n.progress.scenarioStats.filter(e=>e.success).length,n.progress.scenarioStats.filter(e=>!e.success).length])}),this.overall=this.scenarioStatisticsSum(this.characters.map(n=>n.scenarioStats)),this.scenarios[this.characters.length]=this.scenarios.reduce((n,i)=>[n[0]+i[0],n[1]+i[1],n[2]+i[2]])}scenarioStatisticsSum(n){let i=new Ee.yn,e=this.damageStatisticsSum(n);return i.dealtDamage=e.dealtDamage,i.monsterDamage=e.monsterDamage,i.otherDamage=e.otherDamage,i.healedDamage=e.healedDamage,i.heals=e.monsterDamage,i.normalKills=e.normalKills,i.eliteKills=e.eliteKills,i.bossKills=e.bossKills,i.exhausts=e.exhausts,i.maxDealtDamage=e.maxDealtDamage,i.maxDamage=e.maxDamage,n.length&&(i.gold=n.map(o=>o.gold).reduce((o,g)=>o+g),i.xp=n.map(o=>o.xp).reduce((o,g)=>o+g),i.treasures=n.map(o=>o.treasures).reduce((o,g)=>o+g),i.loot=n.map(o=>o.loot).reduce((o,g)=>{let m={};return m.arrowvine=(o.arrowvine||0)+(g.arrowvine||0),m.axenut=(o.axenut||0)+(g.axenut||0),m.corpsecap=(o.corpsecap||0)+(g.corpsecap||0),m.flamefruit=(o.flamefruit||0)+(g.flamefruit||0),m.hide=(o.hide||0)+(g.hide||0),m.lumber=(o.lumber||0)+(g.lumber||0),m.metal=(o.metal||0)+(g.metal||0),m.money=(o.money||0)+(g.money||0),m.random_item=(o.random_item||0)+(g.random_item||0),m.rockroot=(o.rockroot||0)+(g.rockroot||0),m.snowthistle=(o.snowthistle||0)+(g.snowthistle||0),m}),i.summons=this.damageStatisticsSum(n.filter(o=>o.summons).map(o=>o.summons))),i}damageStatisticsSum(n){let i=new Ee.F3;return n.length&&(i.dealtDamage=n.map(e=>e.dealtDamage).reduce((e,o)=>e+o),i.monsterDamage=n.map(e=>e.monsterDamage).reduce((e,o)=>e+o),i.otherDamage=n.map(e=>e.otherDamage).reduce((e,o)=>e+o),i.healedDamage=n.map(e=>e.healedDamage).reduce((e,o)=>e+o),i.heals=n.map(e=>e.heals).reduce((e,o)=>e+o),i.normalKills=n.map(e=>e.normalKills).reduce((e,o)=>e+o),i.eliteKills=n.map(e=>e.eliteKills).reduce((e,o)=>e+o),i.bossKills=n.map(e=>e.bossKills).reduce((e,o)=>e+o),i.exhausts=n.map(e=>e.exhausts).reduce((e,o)=>e+o),i.maxDealtDamage=Math.max(...n.map(e=>e.maxDealtDamage)),i.maxDamage=Math.max(...n.map(e=>e.maxDamage))),i}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-statistics-dialog"]],standalone:!1,decls:55,vars:29,consts:[[1,"statistics-dialog"],[1,"scroll-container"],[1,"header"],[3,"ghs-label"],[1,"character"],[1,"icon","character-icon",3,"src"],[1,"name"],[1,"success"],[1,"failure"],[3,"ghs-label","ghs-label-args","ghs-tooltip"],[1,"text-black",3,"ghs-label","ghs-label-args","style","ghs-tooltip"],[3,"ghs-label","ghs-label-args","style","ghs-tooltip"],[1,"text-black",3,"ghs-label","ghs-label-args","ghs-tooltip"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.nVh(2,m7,1,0,"div",2),t.j41(3,"table")(4,"thead")(5,"tr")(6,"th"),t.nrm(7,"span",3),t.k0s(),t.Z7z(8,p7,5,2,"th",null,ie),t.nI1(10,"trackUUID"),t.nVh(11,u7,2,1,"th"),t.k0s()(),t.j41(12,"tbody")(13,"tr")(14,"th"),t.nrm(15,"span",3),t.k0s(),t.Z7z(16,C7,2,1,"td",null,ie),t.nI1(18,"trackUUID"),t.nVh(19,M7,7,3,"td"),t.k0s(),t.j41(20,"tr")(21,"th"),t.nrm(22,"span",3),t.k0s(),t.Z7z(23,v7,4,21,"td",null,ie),t.nI1(25,"trackUUID"),t.nVh(26,O7,4,21,"td"),t.k0s(),t.j41(27,"tr")(28,"th"),t.nrm(29,"span",3),t.k0s(),t.Z7z(30,P7,3,14,"td",null,ie),t.nI1(32,"trackUUID"),t.nVh(33,b7,3,14,"td"),t.k0s(),t.j41(34,"tr")(35,"th"),t.nrm(36,"span",3),t.k0s(),t.Z7z(37,E7,4,3,"td",null,ie),t.nI1(39,"trackUUID"),t.nVh(40,G7,4,3,"td"),t.k0s(),t.j41(41,"tr")(42,"th"),t.nrm(43,"span",3),t.k0s(),t.Z7z(44,T7,3,14,"td",null,ie),t.nI1(46,"trackUUID"),t.nVh(47,S7,3,14,"td"),t.k0s(),t.j41(48,"tr")(49,"th"),t.nrm(50,"span",3),t.k0s(),t.Z7z(51,D7,4,21,"td",null,ie),t.nI1(53,"trackUUID"),t.nVh(54,$7,4,21,"td"),t.k0s()()()()()),2&i&&(t.R7$(2),t.vxM(e.character?-1:2),t.R7$(5),t.Y8G("ghs-label","scenario.stats"),t.R7$(),t.Dyx(t.bMT(10,15,e.characters)),t.R7$(3),t.vxM(e.character?-1:11),t.R7$(4),t.Y8G("ghs-label","scenario.stats.scenarios"),t.R7$(),t.Dyx(t.bMT(18,17,e.characters)),t.R7$(3),t.vxM(!e.character&&e.scenarios.length==e.characters.length+1&&e.scenarios[e.characters.length].length>2?19:-1),t.R7$(3),t.Y8G("ghs-label","scenario.stats.damage"),t.R7$(),t.Dyx(t.bMT(25,19,e.characters)),t.R7$(3),t.vxM(e.character?-1:26),t.R7$(3),t.Y8G("ghs-label","scenario.stats.heal"),t.R7$(),t.Dyx(t.bMT(32,21,e.characters)),t.R7$(3),t.vxM(e.character?-1:33),t.R7$(3),t.Y8G("ghs-label","scenario.stats.kills"),t.R7$(),t.Dyx(t.bMT(39,23,e.characters)),t.R7$(3),t.vxM(e.character?-1:40),t.R7$(3),t.Y8G("ghs-label","scenario.stats.max"),t.R7$(),t.Dyx(t.bMT(46,25,e.characters)),t.R7$(3),t.vxM(e.character?-1:47),t.R7$(3),t.Y8G("ghs-label","scenario.stats.progress"),t.R7$(),t.Dyx(t.bMT(53,27,e.characters)),t.R7$(3),t.vxM(e.character?-1:54))},dependencies:[it,Mt,ct],styles:[".statistics-dialog[_ngcontent-%COMP%]{position:relative;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor))}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{border-collapse:collapse;width:100%;margin:0;padding:0}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{margin:0;padding:0;border-bottom:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-darkgray)}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(odd){background-color:var(--ghs-color-lightgray)}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:var(--ghs-color-yellow-light)}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle;padding:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));border-right:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-darkgray)}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:right;font-family:var(--ghs-font-title);font-weight:initial}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);text-align:center}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor))}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .success[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .failure[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:auto}"]})}return a})();const I7=a=>({absent:a}),rr=a=>({disabled:a});function A7(a,r){if(1&a){const n=t.RV6();t.j41(0,"label"),t.nrm(1,"img",11)(2,"span",3),t.k0s(),t.j41(3,"a",12),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.changeLoot(e,-1))}),t.nrm(4,"img",13),t.k0s(),t.j41(5,"span",14),t.EFF(6),t.k0s(),t.j41(7,"a",12),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.changeLoot(e,1))}),t.nrm(8,"img",15),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+(n==i.LootType.special1||n==i.LootType.special2?i.LootType.money:n)+".svg",t.B4B),t.R7$(),t.Y8G("ghs-label","game.loot."+n),t.R7$(),t.Y8G("ngClass",t.eq3(8,rr,!i.loot[n]||0==i.loot[n])),t.R7$(2),t.Y8G("ghs-label","game.loot."+n)("ghs-label-attribute","title"),t.R7$(),t.Lme(" ",i.loot[n]||"-"," / ",i.character.progress.loot[n]," "),t.R7$(),t.Y8G("ngClass",t.eq3(10,rr,i.loot[n]==i.character.progress.loot[n]))}}function V7(a,r){if(1&a&&t.nVh(0,A7,9,12),2&a){const n=r.$implicit,i=t.XpG();t.vxM(i.character.progress.loot[n]?0:-1)}}let Ni=(()=>{class a{data;dialogRef;gameManager=s.E;character;lootTypes=Object.values(rt.r6);LootType=rt.r6;loot={};constructor(n,i){this.data=n,this.dialogRef=i,this.character=n.character,n.all&&this.lootTypes.forEach(e=>{this.loot[e]=this.character.progress.loot[e]||0})}ngOnInit(){this.character.progress||(this.character.progress=new Ee.lv)}changeLoot(n,i){this.loot[n]||(this.loot[n]=0),this.loot[n]=this.loot[n]+i,this.loot[n]<0?this.loot[n]=0:(!this.character.progress.loot[n]||this.loot[n]>this.character.progress.loot[n])&&(this.loot[n]=this.character.progress.loot[n]||0)}moveLoot(){Object.keys(this.loot).forEach(n=>{const i=n;let e=this.loot[i]||0;(this.character.progress.loot[i]||0)<e&&(e=this.character.progress.loot[i]||0),e>0&&(s.E.stateManager.before("moveResource",s.E.characterManager.characterName(this.character),"game.loot."+i,e),s.E.game.party.loot[i]=(s.E.game.party.loot[i]||0)+e,this.character.progress.loot[i]=(this.character.progress.loot[i]||0)-e,s.E.stateManager.after())}),this.close()}close(){(0,F.co)(this.dialogRef)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-character-move-resources"]],standalone:!1,decls:16,vars:8,consts:[[1,"move-resources-dialog"],[1,"scroll-container"],[1,"title"],[3,"ghs-label"],[1,"name"],[1,"icon","character-icon",3,"src"],[1,"character-title",3,"ngClass"],[1,"values"],[1,"menu"],[1,"cancel",3,"click"],[1,"apply",3,"click"],[1,"ghs-svg",3,"src"],[1,"button",3,"click","ngClass"],["src","./assets/images/minus.svg",1,"ghs-svg"],[1,"value",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg",1,"ghs-svg"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"label",2),t.nrm(3,"span",3),t.j41(4,"span",4),t.nrm(5,"img",5),t.j41(6,"span",6),t.EFF(7),t.k0s()()(),t.j41(8,"div",7),t.Z7z(9,V7,1,1,null,null,t.fX1),t.k0s(),t.j41(11,"div",8)(12,"a",9),t.bIt("click",function(){return e.close()}),t.nrm(13,"span",3),t.k0s(),t.j41(14,"a",10),t.bIt("click",function(){return e.moveLoot()}),t.nrm(15,"span",3),t.k0s()()()()),2&i&&(t.R7$(3),t.Y8G("ghs-label","character.progress.resources.move"),t.R7$(2),t.Y8G("src",e.character.iconUrl,t.B4B),t.R7$(),t.Y8G("ngClass",t.eq3(6,I7,e.character.absent)),t.R7$(),t.JRh(e.gameManager.characterManager.characterName(e.character,!0)),t.R7$(2),t.Dyx(e.lootTypes),t.R7$(4),t.Y8G("ghs-label","cancel"),t.R7$(2),t.Y8G("ghs-label","character.progress.resources.apply"))},dependencies:[N.YU,it],styles:[".move-resources-dialog[_ngcontent-%COMP%]{padding:.5em}.move-resources-dialog[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1em;width:auto;margin:0 .3em;filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline);margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);min-width:calc(var(--ghs-unit) * 44 * var(--ghs-dialog-factor))}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));width:auto;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .character-title[_ngcontent-%COMP%]{display:flex;align-items:center}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .character-title.absent[_ngcontent-%COMP%]{text-decoration:line-through}.move-resources-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto auto auto;font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor))}.move-resources-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-white);display:flex;justify-content:flex-start;align-items:center;white-space:nowrap}.move-resources-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white);margin-right:.3em}.move-resources-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--ghs-color-white);display:flex;justify-content:center;align-items:center;padding:.3em;white-space:nowrap}.move-resources-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;padding:.3em}.move-resources-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.move-resources-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .button.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:2em;padding:.3em}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}"]})}return a})();var Fn=v(1571);const Re=a=>[a],Ze=a=>({"already-unlocked":a}),jn=(a,r)=>[a,r],F7=()=>["2"];function X7(a,r){1&a&&t.nrm(0,"span",15),2&a&&t.Y8G("ghs-label","character.progress.retirement.event"+(r.$implicit.includes(":")?"":"s"))}function B7(a,r){if(1&a&&(t.j41(0,"div",8),t.Z7z(1,X7,1,1,"span",15,t.fX1),t.k0s()),2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(1,Ze,n.alreadyRetired)),t.R7$(),t.Dyx(n.character.retireEvent.split("|"))}}function Y7(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",9)(1,"a",16),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openConclusion())}),t.nrm(2,"span",17),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","character.progress.retirement.conclusion")("ghs-label-args",t.eq3(2,Re,n.conclusion.index))}}function U7(a,r){if(1&a&&t.nrm(0,"div",18),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(3,Ze,n.characterAlreadyUnlocked))("ghs-label","character.progress.personalQuest.unlockCharacter")("ghs-label-args",t.eq3(5,Re,n.personalQuest.unlockCharacter))}}function N7(a,r){if(1&a&&t.nrm(0,"div",17),2&a){const n=t.XpG(2);t.Y8G("ghs-label","character.progress.personalQuest.unlockCharacter.randomScenario")("ghs-label-args",t.l_i(2,jn,n.characterScenario.index,n.characterScenario.name))}}function z7(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",24),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.itemDialog(e.characterItemDesign))}),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","character.progress.personalQuest.unlockCharacter.itemDesign")("ghs-label-args",t.l_i(2,jn,n.characterItemDesign.id,n.characterItemDesign.edition))}}function L7(a,r){1&a&&t.nrm(0,"span",25),2&a&&t.Y8G("ghs-label","character.progress.retirement.event"+(r.$implicit.includes(":")?"":"s"))}function q7(a,r){if(1&a&&(t.j41(0,"div",20),t.Z7z(1,L7,1,1,"span",25,t.fX1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Dyx(n.unlockEvent.split("|"))}}function H7(a,r){if(1&a&&t.nrm(0,"span",27),2&a){const n=t.XpG(3);t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.building")("ghs-label-args",t.l_i(2,jn,n.personalQuestBuilding.id,n.personalQuestBuilding.name))}}function K7(a,r){if(1&a&&(t.j41(0,"div",21),t.nrm(1,"span",26),t.nVh(2,H7,1,5,"span",27),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope"+(n.personalQuest.openEnvelope.split(":").length>1?".alt":""))("ghs-label-args",n.personalQuest.openEnvelope.split(":"))("ngClass",t.eq3(4,Ze,n.envelopeAlreadyUnlocked)),t.R7$(),t.vxM(n.personalQuestBuilding?2:-1)}}function W7(a,r){if(1&a&&t.nrm(0,"div",17),2&a){const n=t.XpG(2);t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.randomScenario")("ghs-label-args",t.l_i(2,jn,n.envelopeSection.index,n.envelopeSection.unlocks&&n.envelopeSection.unlocks[0]))}}function Z7(a,r){1&a&&t.nrm(0,"div",22),2&a&&t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.randomScenarioInfo")}function J7(a,r){1&a&&t.nrm(0,"div",22),2&a&&t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.inspiration")}function Q7(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",24),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.itemDialog(e.envelopeItemBlueprint))}),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.itemBlueprint")("ghs-label-args",t.l_i(2,jn,n.envelopeItemBlueprint.id,n.envelopeItemBlueprint.edition))}}function tR(a,r){1&a&&t.nrm(0,"div",22),2&a&&t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.itemBlueprintInfo")}function nR(a,r){if(1&a&&t.nrm(0,"div",17),2&a){const n=t.XpG(2);t.Y8G("ghs-label","character.progress.personalQuest.unlockPQ")("ghs-label-args",t.eq3(2,Re,n.personalQuest.unlockPQ))}}function eR(a,r){1&a&&t.nrm(0,"div",22),2&a&&t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.inspiration")}function aR(a,r){if(1&a&&(t.j41(0,"div",23),t.nrm(1,"span",2),t.EFF(2,":\xa0"),t.nrm(3,"span",28),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","errata"),t.R7$(2),t.Y8G("ghs-label","data.custom."+n.personalQuest.edition+".errata."+n.personalQuest.errata)}}function iR(a,r){if(1&a&&(t.j41(0,"div",10),t.nVh(1,U7,1,7,"div",18),t.nVh(2,N7,1,5,"div",17),t.nVh(3,z7,1,5,"div",19),t.nVh(4,q7,3,0,"div",20),t.nVh(5,K7,3,6,"div",21),t.nVh(6,W7,1,5,"div",17),t.nVh(7,Z7,1,1,"div",22),t.nVh(8,J7,1,1,"div",22),t.nVh(9,Q7,1,5,"div",19),t.nVh(10,tR,1,1,"div",22),t.nVh(11,nR,1,4,"div",17),t.nVh(12,eR,1,1,"div",22),t.nVh(13,aR,4,2,"div",23),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.vxM(n.personalQuest.unlockCharacter?1:-1),t.R7$(),t.vxM(n.characterScenario?2:-1),t.R7$(),t.vxM(n.characterItemDesign?3:-1),t.R7$(),t.vxM(n.unlockEvent?4:-1),t.R7$(),t.vxM(n.personalQuest.openEnvelope?5:-1),t.R7$(),t.vxM(n.envelopeSection&&1!=n.envelopeSection?6:-1),t.R7$(),t.vxM(1==n.envelopeSection?7:-1),t.R7$(),t.vxM(n.envelopeAlreadyUnlocked&&!n.envelopeSection?8:-1),t.R7$(),t.vxM(n.envelopeItemBlueprint&&1!=n.envelopeItemBlueprint?9:-1),t.R7$(),t.vxM(1==n.envelopeItemBlueprint?10:-1),t.R7$(),t.vxM(n.personalQuest.unlockPQ?11:-1),t.R7$(),t.vxM(n.envelopeAlreadyUnlocked&&!n.envelopeItemBlueprint?12:-1),t.R7$(),t.vxM(n.settingsManager.settings.errata&&n.personalQuest.errata?13:-1)}}function oR(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",11)(1,"a",16),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.moveResources())}),t.nrm(2,"span",2),t.k0s()()}2&a&&(t.R7$(2),t.Y8G("ghs-label","character.progress.retirement.moveSupply"))}function sR(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",11)(1,"a",16),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.additional=!e.additional)}),t.nrm(2,"span",2),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","character.progress.retirement.additionalPQ"+(n.additional?".cancel":""))}}function rR(a,r){if(1&a){const n=t.RV6();t.j41(0,"input",32),t.bIt("change",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.changeAdditionalPQ(e))}),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("value",n.additionalPQ&&n.additionalPQ.cardId||"")}}function cR(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.SpI("\xa0(",n.additionalPQ.altId,")")}}function lR(a,r){if(1&a&&(t.j41(0,"span",31),t.nrm(1,"span",2),t.nVh(2,cR,2,1,"span"),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","data.personalQuest."+n.additionalPQ.edition+"."+n.additionalPQ.cardId),t.R7$(),t.vxM(n.additionalPQ.altId?2:-1)}}function gR(a,r){if(1&a&&t.nrm(0,"div",26),2&a){const n=t.XpG(2);t.Y8G("ghs-label","character.progress.personalQuest.unlockCharacter")("ghs-label-args",t.eq3(3,Re,n.additionalPQ.unlockCharacter))("ngClass",t.eq3(5,Ze,n.additionalCharacterAlreadyUnlocked))}}function dR(a,r){if(1&a&&t.nrm(0,"div",17),2&a){const n=t.XpG(2);t.Y8G("ghs-label","character.progress.personalQuest.unlockCharacter.randomScenario")("ghs-label-args",t.l_i(2,jn,n.additionalCharacterScenario.index,n.additionalCharacterScenario.name))}}function hR(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",24),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.itemDialog(e.additionalCharacterItemDesign))}),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","character.progress.personalQuest.unlockCharacter.itemDesign")("ghs-label-args",t.l_i(2,jn,n.additionalCharacterItemDesign.id,n.additionalCharacterItemDesign.edition))}}function _R(a,r){1&a&&t.nrm(0,"span",25),2&a&&t.Y8G("ghs-label","character.progress.retirement.event"+(r.$implicit.includes(":")?"":"s"))}function mR(a,r){if(1&a&&(t.j41(0,"div",20),t.Z7z(1,_R,1,1,"span",25,t.fX1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Dyx(n.additionalUnlockEvent.split("|"))}}function pR(a,r){if(1&a&&t.nrm(0,"span",27),2&a){const n=t.XpG(3);t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.building")("ghs-label-args",t.l_i(2,jn,n.additionalPQBuilding.id,n.additionalPQBuilding.name))}}function uR(a,r){if(1&a&&(t.j41(0,"div",21),t.nrm(1,"span",26),t.nVh(2,pR,1,5,"span",27),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope"+(n.additionalPQ.openEnvelope.split(":").length>1?".alt":""))("ghs-label-args",n.additionalPQ.openEnvelope.split(":"))("ngClass",t.eq3(4,Ze,n.additionalEnvelopeAlreadyUnlocked)),t.R7$(),t.vxM(n.additionalPQBuilding?2:-1)}}function fR(a,r){if(1&a&&t.nrm(0,"div",17),2&a){const n=t.XpG(2);t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.randomScenario")("ghs-label-args",t.l_i(2,jn,n.additionalEnvelopeSection.index,n.additionalEnvelopeSection.unlocks&&n.additionalEnvelopeSection.unlocks[0]))}}function CR(a,r){1&a&&t.nrm(0,"div",22),2&a&&t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.randomScenarioInfo")}function MR(a,r){1&a&&t.nrm(0,"div",22),2&a&&t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.inspiration")}function vR(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",24),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.itemDialog(e.additionalEnvelopeItemBlueprint))}),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.itemBlueprint")("ghs-label-args",t.l_i(2,jn,n.additionalEnvelopeItemBlueprint.id,n.additionalEnvelopeItemBlueprint.edition))}}function OR(a,r){1&a&&t.nrm(0,"div",22),2&a&&t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.itemBlueprintInfo")}function PR(a,r){1&a&&t.nrm(0,"div",22),2&a&&t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.inspiration")}function bR(a,r){if(1&a&&t.nrm(0,"div",17),2&a){const n=t.XpG(2);t.Y8G("ghs-label","character.progress.personalQuest.unlockPQ")("ghs-label-args",t.eq3(2,Re,n.additionalPQ.unlockPQ))}}function kR(a,r){if(1&a&&(t.j41(0,"div",23),t.nrm(1,"span",2),t.EFF(2,":\xa0"),t.nrm(3,"span",28),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","errata"),t.R7$(2),t.Y8G("ghs-label","data.custom."+n.additionalPQ.edition+".errata."+n.additionalPQ.errata)}}function yR(a,r){if(1&a&&(t.j41(0,"div",10)(1,"div",29),t.nVh(2,rR,1,1,"input",30),t.nVh(3,lR,3,2,"span",31),t.k0s(),t.nrm(4,"span",2)(5,"span",7),t.nVh(6,gR,1,7,"div",26),t.nVh(7,dR,1,5,"div",17),t.nVh(8,hR,1,5,"div",19),t.nVh(9,mR,3,0,"div",20),t.nVh(10,uR,3,6,"div",21),t.nVh(11,fR,1,5,"div",17),t.nVh(12,CR,1,1,"div",22),t.nVh(13,MR,1,1,"div",22),t.nVh(14,vR,1,5,"div",19),t.nVh(15,OR,1,1,"div",22),t.nVh(16,PR,1,1,"div",22),t.nVh(17,bR,1,4,"div",17),t.nVh(18,kR,4,2,"div",23),t.k0s()),2&a){const n=t.XpG();t.R7$(2),t.vxM(n.additional?2:-1),t.R7$(),t.vxM(n.additionalPQ?3:-1),t.R7$(),t.Y8G("ghs-label","character.progress.retirement.additionalPQ.inspiration"),t.R7$(),t.Y8G("ghs-label","character.progress.retirement.prosperity")("ghs-label-args",t.lJ4(18,F7)),t.R7$(),t.vxM(n.additionalPQ&&n.additionalPQ.unlockCharacter?6:-1),t.R7$(),t.vxM(n.additionalCharacterScenario?7:-1),t.R7$(),t.vxM(n.additionalCharacterItemDesign?8:-1),t.R7$(),t.vxM(n.additionalUnlockEvent?9:-1),t.R7$(),t.vxM(n.additionalPQ&&n.additionalPQ.openEnvelope?10:-1),t.R7$(),t.vxM(n.additionalEnvelopeSection&&1!=n.additionalEnvelopeSection?11:-1),t.R7$(),t.vxM(1==n.additionalEnvelopeSection?12:-1),t.R7$(),t.vxM(n.additionalEnvelopeAlreadyUnlocked&&!n.additionalEnvelopeSection?13:-1),t.R7$(),t.vxM(n.additionalEnvelopeItemBlueprint&&1!=n.additionalEnvelopeItemBlueprint?14:-1),t.R7$(),t.vxM(1==n.additionalEnvelopeItemBlueprint?15:-1),t.R7$(),t.vxM(n.additionalEnvelopeAlreadyUnlocked&&!n.additionalEnvelopeItemBlueprint?16:-1),t.R7$(),t.vxM(n.additionalPQ&&n.additionalPQ.unlockPQ?17:-1),t.R7$(),t.vxM(n.settingsManager.settings.errata&&n.additionalPQ&&n.additionalPQ.errata?18:-1)}}let xR=(()=>{class a{character;dialogRef;dialog;gameManager=s.E;settingsManager=p.f;conclusion;personalQuest;personalQuestBuilding;unlockEvent="";alreadyRetired=!1;characterAlreadyUnlocked=!1;characterScenario;characterItemDesign;envelopeAlreadyUnlocked=!1;envelopeSection;envelopeItemBlueprint;additional=!1;additionalPQ;additionalPQBuilding;additionalUnlockEvent="";additionalCharacterAlreadyUnlocked=!1;additionalCharacterScenario;additionalCharacterItemDesign;additionalEnvelopeAlreadyUnlocked=!1;additionalEnvelopeSection;additionalEnvelopeItemBlueprint;hasResources=!1;constructor(n,i,e){this.character=n,this.dialogRef=i,this.dialog=e,this.conclusion=s.E.sectionData(this.character.edition).find(o=>o.retirement==this.character.name&&o.conclusion),this.character.progress.personalQuest&&(this.personalQuest=s.E.characterManager.personalQuestByCard(s.E.currentEdition(),this.character.progress.personalQuest),p.f.settings.unlockEnvelopeBuildings&&this.personalQuest&&this.personalQuest.openEnvelope&&(this.personalQuestBuilding=this.buildingsEnvelopeHelper(this.personalQuest.openEnvelope)));for(let o of Object.keys(this.character.progress.loot)){const g=o;rt.s$.includes(g)&&this.character.progress.loot[g]&&(this.hasResources=!0)}if(this.personalQuest){if(this.personalQuest.unlockCharacter)if(this.characterAlreadyUnlocked=s.E.game.unlockedCharacters.includes(this.personalQuest.edition+":"+this.personalQuest.unlockCharacter),this.characterAlreadyUnlocked)this.characterScenario=s.E.scenarioManager.drawRandomScenario(s.E.currentEdition()),this.characterItemDesign=s.E.itemManager.drawRandomItem(s.E.currentEdition());else{const o=s.E.charactersData(this.personalQuest.edition).find(g=>this.personalQuest&&g.edition==this.personalQuest.edition&&g.name==this.personalQuest.unlockCharacter);this.unlockEvent=o&&o.unlockEvent||""}this.personalQuest.openEnvelope&&s.E.fhRules()&&(this.envelopeAlreadyUnlocked=!this.buildingsEnvelopeHelper(this.personalQuest.openEnvelope,!1)&&!this.buildingsEnvelopeHelper(this.personalQuest.openEnvelope),this.envelopeAlreadyUnlocked&&(this.envelopeSection=!p.f.settings.drawRandomScenario||s.E.scenarioManager.drawRandomScenarioSection(s.E.currentEdition()),this.envelopeItemBlueprint=!p.f.settings.drawRandomItem||s.E.itemManager.drawRandomItem(s.E.currentEdition(),!0)))}this.alreadyRetired=null!=s.E.game.party.retirements.find(o=>o.edition==this.character.edition&&o.name==this.character.name)}openConclusion(){this.conclusion&&this.dialog.open(zt,{panelClass:["dialog"],data:{scenario:this.conclusion,conclusionOnly:!0,rewardsOnly:null!=s.E.game.party.conclusions.find(n=>this.conclusion&&n.edition==this.conclusion.edition&&n.group==this.conclusion.group&&n.index==this.conclusion.index)}})}moveResources(){this.dialog.open(Ni,{panelClass:["dialog"],data:{character:this.character,all:!0}})}apply(){if((0,F.co)(this.dialogRef,!0),s.E.stateManager.before("setRetired",s.E.characterManager.characterName(this.character)),this.character.progress.retired=!0,s.E.game.party.retirements.push(this.character.toModel()),s.E.characterManager.removeCharacter(this.character,!0),this.personalQuest&&this.personalQuest.unlockCharacter&&p.f.settings.automaticUnlocking&&!s.E.game.unlockedCharacters.includes(this.personalQuest.edition+":"+this.personalQuest.unlockCharacter)&&(s.E.game.unlockedCharacters.push(this.personalQuest.edition+":"+this.personalQuest.unlockCharacter),p.f.settings.events)){const n=s.E.getCharacterData(this.personalQuest.unlockCharacter);n.unlockEvent&&n.unlockEvent.split("|").forEach(i=>{i.split(":").length>1?s.E.eventCardManager.addEvent(i.split(":")[0],i.split(":")[1],!0):(s.E.eventCardManager.addEvent("city",i,!0),s.E.eventCardManager.addEvent("road",i,!0))})}if(this.characterAlreadyUnlocked&&(this.characterScenario&&s.E.game.party.manualScenarios.push(new ut.Ag(this.characterScenario.index,this.characterScenario.edition,this.characterScenario.group)),this.characterItemDesign&&s.E.game.party.unlockedItems.push(new yt.VP(""+this.characterItemDesign.id,this.characterItemDesign.edition))),this.additionalCharacterAlreadyUnlocked&&(this.additionalCharacterScenario&&s.E.game.party.manualScenarios.push(new ut.Ag(this.additionalCharacterScenario.index,this.additionalCharacterScenario.edition,this.additionalCharacterScenario.group)),this.additionalCharacterItemDesign&&s.E.game.party.unlockedItems.push(new yt.VP(""+this.additionalCharacterItemDesign.id,this.additionalCharacterItemDesign.edition))),this.envelopeAlreadyUnlocked&&(this.envelopeSection&&1!=this.envelopeSection?(s.E.game.party.conclusions.push(new ut.Ag(""+this.envelopeSection.index,this.envelopeSection.edition,this.envelopeSection.group)),this.envelopeSection.unlocks&&this.envelopeSection.unlocks.forEach(n=>{this.envelopeSection&&1!=this.envelopeSection&&s.E.game.party.manualScenarios.push(new ut.Ag(n,this.envelopeSection.edition))})):s.E.game.party.inspiration+=1,this.envelopeItemBlueprint&&1!=this.envelopeItemBlueprint?s.E.game.party.unlockedItems.push(new yt.VP(""+this.envelopeItemBlueprint.id,this.envelopeItemBlueprint.edition)):s.E.game.party.inspiration+=1),this.additionalEnvelopeAlreadyUnlocked&&(this.additionalEnvelopeSection&&1!=this.additionalEnvelopeSection?(s.E.game.party.conclusions.push(new ut.Ag(""+this.additionalEnvelopeSection.index,this.additionalEnvelopeSection.edition,this.additionalEnvelopeSection.group)),this.additionalEnvelopeSection.unlocks&&this.additionalEnvelopeSection.unlocks.forEach(n=>{this.additionalEnvelopeSection&&1!=this.additionalEnvelopeSection&&s.E.game.party.manualScenarios.push(new ut.Ag(n,this.additionalEnvelopeSection.edition))})):s.E.game.party.inspiration+=1,this.additionalEnvelopeItemBlueprint&&1!=this.additionalEnvelopeItemBlueprint?s.E.game.party.unlockedItems.push(new yt.VP(""+this.additionalEnvelopeItemBlueprint.id,this.additionalEnvelopeItemBlueprint.edition)):s.E.game.party.inspiration+=1),this.additional&&(s.E.game.party.inspiration-=15,s.E.game.party.prosperity+=2,this.additionalPQ&&this.additionalPQ.unlockCharacter&&p.f.settings.automaticUnlocking&&!s.E.game.unlockedCharacters.includes(this.additionalPQ.edition+":"+this.additionalPQ.unlockCharacter)&&(s.E.game.unlockedCharacters.push(this.additionalPQ.edition+":"+this.additionalPQ.unlockCharacter),p.f.settings.events))){const n=s.E.getCharacterData(this.additionalPQ.unlockCharacter);n.unlockEvent&&n.unlockEvent.split("|").forEach(i=>{i.split(":").length>1?s.E.eventCardManager.addEvent(i.split(":")[0],i.split(":")[1],!0):(s.E.eventCardManager.addEvent("city",i,!0),s.E.eventCardManager.addEvent("road",i,!0))})}p.f.settings.unlockEnvelopeBuildings&&(this.personalQuestBuilding&&s.E.game.party.buildings.push(new Fn.k(this.personalQuestBuilding.name,0)),this.additionalPQBuilding&&s.E.game.party.buildings.push(new Fn.k(this.additionalPQBuilding.name,0))),s.E.stateManager.after(),this.conclusion&&!s.E.game.party.conclusions.find(n=>this.conclusion&&n.edition==this.conclusion.edition&&n.group==this.conclusion.group&&n.index==this.conclusion.index)&&this.openConclusion()}buildingsEnvelopeHelper(n,i=!0){const e=s.E.campaignData().buildings;if(e){const o=n.split(":").map(g=>e.find(m=>m.id===g)).filter(g=>g).map(g=>g);if(o.length>0){if(!(s.E.game.party.buildings.find(g=>g.name==o[0].name)||this.personalQuestBuilding&&this.personalQuestBuilding==o[0]))return o[0];if(i&&o.length>1&&!s.E.game.party.buildings.find(g=>g.name==o[1].name))return o[1]}}}changeAdditionalPQ(n){if(this.additionalPQ=s.E.characterManager.personalQuestByCard(s.E.currentEdition(),n.target.value),this.additionalPQ){if(p.f.settings.unlockEnvelopeBuildings&&this.additionalPQ.openEnvelope&&(this.additionalPQBuilding=this.buildingsEnvelopeHelper(this.additionalPQ.openEnvelope)),this.additionalPQ.unlockCharacter)if(this.additionalCharacterAlreadyUnlocked=s.E.game.unlockedCharacters.includes(this.additionalPQ.edition+":"+this.additionalPQ.unlockCharacter),this.characterAlreadyUnlocked)this.additionalCharacterScenario=s.E.scenarioManager.drawRandomScenario(s.E.currentEdition()),this.additionalCharacterItemDesign=s.E.itemManager.drawRandomItem(s.E.currentEdition());else{const i=s.E.charactersData(this.additionalPQ.edition).find(e=>this.additionalPQ&&e.edition==this.additionalPQ.edition&&e.name==this.additionalPQ.unlockCharacter);this.additionalUnlockEvent=i&&i.unlockEvent||""}this.additionalPQ.openEnvelope&&s.E.fhRules()&&(this.additionalEnvelopeAlreadyUnlocked=!this.buildingsEnvelopeHelper(this.additionalPQ.openEnvelope,!1)&&!this.buildingsEnvelopeHelper(this.additionalPQ.openEnvelope),this.additionalEnvelopeAlreadyUnlocked&&(this.additionalEnvelopeSection=!p.f.settings.drawRandomScenario||s.E.scenarioManager.drawRandomScenarioSection(s.E.currentEdition()),this.additionalEnvelopeItemBlueprint=!p.f.settings.drawRandomItem||s.E.itemManager.drawRandomItem(s.E.currentEdition(),!0)))}}itemDialog(n){this.dialog.open(fn,{panelClass:["fullscreen-panel"],disableClose:!0,data:{item:n}})}close(){(0,F.co)(this.dialogRef)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-character-retirement-dialog"]],standalone:!1,decls:20,vars:15,consts:[[1,"retirement-dialog"],[1,"title"],[3,"ghs-label"],[1,"name"],[1,"icon","character-icon",3,"src"],[1,"character-title"],[1,"rewards"],[3,"ghs-label","ghs-label-args"],[1,"event",3,"ngClass"],[1,"conclusion"],[1,"personal-quest"],[1,"additional"],[1,"menu"],[1,"cancel",3,"click"],[1,"apply",3,"click"],["![ghs-label-args]","rE.includes(':') ? [rE] : [rE.split(':')[0], rE.split(':')[1]]",1,"text-white",3,"ghs-label"],[3,"click"],[1,"text-white",3,"ghs-label","ghs-label-args"],[1,"text-white",3,"ngClass","ghs-label","ghs-label-args"],[1,"text-white","link",3,"ghs-label","ghs-label-args"],[1,"event"],[1,"envelope"],[1,"text-white",3,"ghs-label"],[1,"errata","text-white"],[1,"text-white","link",3,"click","ghs-label","ghs-label-args"],["![ghs-label-args]","uE.includes(':') ? [uE] : [uE.split(':')[0], uE.split(':')[1]]",1,"text-white",3,"ghs-label"],[1,"text-white",3,"ghs-label","ghs-label-args","ngClass"],[1,"building",3,"ghs-label","ghs-label-args"],[1,"text",3,"ghs-label"],[1,"personal-quest-card"],["type","text",1,"card-id",3,"value"],[1,"personal-quest-name"],["type","text",1,"card-id",3,"change","value"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"label",1),t.nrm(2,"span",2),t.j41(3,"span",3),t.nrm(4,"img",4),t.j41(5,"span",5),t.EFF(6),t.k0s()()(),t.j41(7,"div",6),t.nrm(8,"span",7),t.k0s(),t.nVh(9,B7,3,3,"div",8),t.nVh(10,Y7,3,4,"div",9),t.nVh(11,iR,14,13,"div",10),t.nVh(12,oR,3,1,"div",11),t.nVh(13,sR,3,1,"div",11),t.nVh(14,yR,19,19,"div",10),t.j41(15,"div",12)(16,"a",13),t.bIt("click",function(){return e.close()}),t.nrm(17,"span",2),t.k0s(),t.j41(18,"a",14),t.bIt("click",function(){return e.apply()}),t.nrm(19,"span",2),t.k0s()()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","character.progress.retirement"),t.R7$(2),t.Y8G("src",e.character.iconUrl,t.B4B),t.R7$(2),t.JRh(e.gameManager.characterManager.characterName(e.character,!0)),t.R7$(2),t.Y8G("ghs-label","character.progress.retirement.prosperity")("ghs-label-args",t.eq3(13,Re,e.gameManager.fhRules(!0)?"2":"1")),t.R7$(),t.vxM(e.character.retireEvent?9:-1),t.R7$(),t.vxM(e.conclusion?10:-1),t.R7$(),t.vxM(e.personalQuest?11:-1),t.R7$(),t.vxM(e.gameManager.fhRules()&&e.hasResources?12:-1),t.R7$(),t.vxM(e.gameManager.fhRules(!0)&&e.gameManager.game.party.inspiration>14?13:-1),t.R7$(),t.vxM(e.additional?14:-1),t.R7$(3),t.Y8G("ghs-label","cancel"),t.R7$(2),t.Y8G("ghs-label","character.progress.retirement.apply"))},dependencies:[N.YU,it],styles:[".retirement-dialog[_ngcontent-%COMP%]{padding:.5em;color:var(--ghs-color-white)}.retirement-dialog[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1em;width:auto;margin:0 .3em;filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.retirement-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline);margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.retirement-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);min-width:calc(var(--ghs-unit) * 44 * var(--ghs-dialog-factor))}.retirement-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));width:auto;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.retirement-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .character-title[_ngcontent-%COMP%]{display:flex;align-items:center}.retirement-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .character-title.absent[_ngcontent-%COMP%]{text-decoration:line-through}.retirement-dialog[_ngcontent-%COMP%]   .rewards[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;min-width:calc(var(--ghs-unit) * 35 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));padding-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray)}.retirement-dialog[_ngcontent-%COMP%]   .rewards[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{cursor:pointer}.retirement-dialog[_ngcontent-%COMP%]   .event[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2.6 * var(--ghs-dialog-factor))}.retirement-dialog[_ngcontent-%COMP%]   .conclusion[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);display:flex;flex-direction:column;justify-content:center;align-items:center}.retirement-dialog[_ngcontent-%COMP%]   .conclusion[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:1.5em;padding:.2em}.retirement-dialog[_ngcontent-%COMP%]   .conclusion[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}.retirement-dialog[_ngcontent-%COMP%]   .already-unlocked[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-darkgray)}.retirement-dialog[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{cursor:pointer}.retirement-dialog[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]:hover{opacity:.7}.retirement-dialog[_ngcontent-%COMP%]   .personal-quest[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center}.retirement-dialog[_ngcontent-%COMP%]   .envelope[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column}.retirement-dialog[_ngcontent-%COMP%]   .envelope[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.retirement-dialog[_ngcontent-%COMP%]   .errata[_ngcontent-%COMP%]{text-align:justify;max-width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor))}.retirement-dialog[_ngcontent-%COMP%]   .errata[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-style:italic}.retirement-dialog[_ngcontent-%COMP%]   .additional[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);display:flex;flex-direction:column;justify-content:center;align-items:center;margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));padding-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray)}.retirement-dialog[_ngcontent-%COMP%]   .additional[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:1.5em;padding:.2em}.retirement-dialog[_ngcontent-%COMP%]   .additional-card[_ngcontent-%COMP%]{display:flex;align-items:center}.retirement-dialog[_ngcontent-%COMP%]   .additional-card[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.retirement-dialog[_ngcontent-%COMP%]   .personal-quest-card[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.retirement-dialog[_ngcontent-%COMP%]   .personal-quest-card[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{text-align:right;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor) * var(--ghs-text-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor) * var(--ghs-text-factor));min-width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor) * var(--ghs-text-factor))}.retirement-dialog[_ngcontent-%COMP%]   .personal-quest-card[_ngcontent-%COMP%]   .personal-quest-name[_ngcontent-%COMP%]{font-family:var(--ghs-font-title)}.retirement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.retirement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:2em;padding:.3em}.retirement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.retirement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.retirement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}"]})}return a})();const cr=a=>({disabled:a}),ER=(a,r)=>[a,r],lr=a=>[a],wR=a=>({ignore:a}),RR=(a,r)=>r._trackUUID;function jR(a,r){if(1&a&&t.nrm(0,"img",9),2&a){const n=t.XpG().$implicit;t.Y8G("src","./assets/images/items/slots/"+n.slot+".svg",t.B4B)}}function GR(a,r){if(1&a&&t.nrm(0,"span",10),2&a){const n=t.XpG().$implicit;t.Y8G("ghs-label","%game.itemFh."+n.id+"%")}}function TR(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1,"\xa0("),t.nrm(2,"span",1),t.EFF(3,")"),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(2),t.Y8G("ghs-label","data.edition."+n.edition)}}function SR(a,r){1&a&&(t.j41(0,"span",14),t.nrm(1,"img",22),t.k0s())}function DR(a,r){1&a&&(t.j41(0,"div",15),t.nrm(1,"img",23),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-tooltip","game.items.effect")("hint",!0))}function $R(a,r){if(1&a&&(t.j41(0,"span",16),t.nrm(1,"img",24),t.EFF(2),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(2,wR,i.gameManager.characterManager.ignoreNegativeItemEffects(i.character))),t.R7$(2),t.SpI(" x",n.minusOne," ")}}function IR(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",25),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.distillItem(e))}),t.nrm(1,"img",26),t.k0s()}if(2&a){const n=t.XpG().$implicit;t.Y8G("ghs-tooltip","game.items.distilling")("ghs-label-args",t.eq3(2,lr,"data.items."+n.edition+"-"+n.id))}}function AR(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",3)(1,"span",8),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.openItem(e))}),t.nVh(2,jR,1,1,"img",9),t.nVh(3,GR,1,1,"span",10),t.k0s(),t.j41(4,"span",11),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.openItem(e))}),t.EFF(5),t.k0s(),t.j41(6,"span",12),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.toggleEquippedItem(e))})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.toggleEquippedItem(e,!0))}),t.nrm(7,"span",1),t.nVh(8,TR,4,1,"span"),t.k0s(),t.nrm(9,"span",13),t.nVh(10,SR,2,0,"span",14),t.nVh(11,DR,2,2,"div",15),t.nVh(12,$R,3,4,"span",16),t.nVh(13,IR,2,4,"a",17),t.j41(14,"a",18),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.sellItem(e))}),t.nrm(15,"img",19),t.EFF(16),t.k0s(),t.j41(17,"a",20),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.removeItem(e))}),t.nrm(18,"img",21),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG();t.R7$(2),t.vxM(n.slot?2:-1),t.R7$(),t.vxM(n.slot?-1:3),t.R7$(2),t.SpI("",n.id,"."),t.R7$(),t.Y8G("ngClass",t.eq3(15,cr,i.gameManager.game.state!=i.GameState.draw||i.gameManager.game.round>0)),t.R7$(),t.Y8G("ghs-label","data.items."+n.edition+"-"+n.id),t.R7$(),t.vxM(n.edition!=i.itemEdition?8:-1),t.R7$(2),t.vxM(i.isEquipped(n)?10:-1),t.R7$(),t.vxM(i.gameManager.characterManager.itemEffect(n)?11:-1),t.R7$(),t.vxM(i.isEquipped(n)&&n.minusOne?12:-1),t.R7$(),t.vxM(i.gameManager.itemManager.canDistill(n)?13:-1),t.R7$(),t.Y8G("ghs-tooltip","game.items.sell")("ghs-label-args",t.l_i(17,ER,"data.items."+n.edition+"-"+n.id,i.gameManager.itemManager.itemSellValue(n))),t.R7$(2),t.SpI(" ",i.gameManager.itemManager.itemSellValue(n)," "),t.R7$(),t.Y8G("ghs-tooltip","game.items.remove")("ghs-label-args",t.eq3(20,lr,"data.items."+n.edition+"-"+n.id))}}function VR(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",27),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.brewDialog())})("doubleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.brewDialog(!0))}),t.nrm(1,"img",26)(2,"span",1),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(2,cr,n.gameManager.itemManager.brewingDisabled())),t.R7$(2),t.Y8G("ghs-label","game.items.brewing")}}let FR=(()=>{class a{dialog;ghsManager;character;items=[];item;itemIndex=1;itemEdition="";brewing=0;herbs=[rt.r6.rockroot,rt.r6.snowthistle,rt.r6.axenut,rt.r6.flamefruit,rt.r6.corpsecap,rt.r6.arrowvine];gameManager=s.E;settingsManager=p.f;GameState=D.mk;constructor(n,i){this.dialog=n,this.ghsManager=i}ngOnInit(){this.updateItems(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.updateItems()}}),this.itemEdition||(this.itemEdition=s.E.currentEdition(this.character.edition)),this.editionChange()}uiChangeSubscription;ngOnDestroy(){this.itemEdition&&(this.itemEdition=s.E.currentEdition(this.character.edition)),this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}updateItems(){if(this.items=[],this.character.progress.items&&(this.character.progress.items.forEach(n=>{const i=s.E.itemManager.getItem(n.name,n.edition,!0);i?this.items.push(i):console.warn("Unknown Item for edition '"+n.edition+"': "+n.name)}),this.items.sort(s.E.itemManager.sortItems)),this.brewing=0,s.E.fhRules()&&s.E.game.party.campaignMode&&s.E.game.party.buildings){const n=s.E.game.party.buildings.find(i=>"alchemist"==i.name);n&&n.level&&(this.brewing=n.level<3?2:3)}}brewDialog(n=!1){(!s.E.itemManager.brewingDisabled()||n)&&this.dialog.open(ds,{panelClass:["dialog"],data:this.character})}itemDialog(){this.dialog.open(Le,{panelClass:["dialog"],data:{edition:s.E.game.edition,select:this.character}})}itemChange(n=0){setTimeout(()=>{if(0!=n){const i=s.E.itemManager.maxItemIndex(this.itemEdition||this.character.edition);for(this.itemIndex+=n,this.itemIndex<1&&(this.itemIndex=i),this.item=s.E.itemManager.getItem(this.itemIndex,this.itemEdition&&this.itemEdition||this.character.edition,!1);!this.item&&this.itemIndex>0&&this.itemIndex<i;)this.itemIndex+=n,this.item=s.E.itemManager.getItem(this.itemIndex,this.itemEdition||this.character.edition,!1);this.itemIndex>i&&(this.itemIndex=1,this.item=s.E.itemManager.getItem(this.itemIndex,this.itemEdition||this.character.edition,!1))}else this.item=s.E.itemManager.getItem(this.itemIndex,this.itemEdition||this.character.edition,!1)})}editionChange(){if(this.itemIndex=1,this.itemEdition){const n=s.E.editionData.find(i=>i.edition==this.itemEdition);n&&n.items&&(this.itemIndex=Math.min(...n.items.filter(i=>"number"==typeof i.id).map(i=>+i.id)))}this.itemChange()}canAdd(n){if(n){const i=this.assigned(n);if(n.count&&i<n.count&&!this.character.progress.items.find(e=>n&&e.name==""+n.id&&e.edition==n.edition))return!0}return!1}assigned(n){return s.E.game.figures.filter(i=>i instanceof H.K&&i.progress&&i.progress.items).map(i=>i).map(i=>i.progress&&i.progress.items).reduce((i,e)=>i&&e&&i.concat(e)).filter(i=>n&&i.name==""+n.id&&i.edition==n.edition).length}canBuy(n,i=0){return n&&n.cost&&n.cost+s.E.itemManager.pricerModifier()+i<=this.character.progress.gold&&this.canAdd(n)||!1}canCraft(n,i={}){if(n){let e=!0;return n.resources&&Object.keys(n.resources).forEach(o=>{const g=o,m=(n.resources[g]||0)+(i[g]||0);e=(0,rt.hV)(g)==rt.hM.herb_resources?e&&((this.character.progress.loot[g]||0)>=m||(s.E.game.party.loot[g]||0)>=m):e&&(this.character.progress.loot[g]||0)>=m}),n.requiredItems&&n.requiredItems.forEach(o=>{if(o!=n.id){const g=s.E.itemManager.getItem(o,n.edition,!0);g?this.items.find(m=>m.id==g.id&&m.edition==g.edition)||(e=e&&(this.canCraft(g,n.resources||{})||this.canBuy(g,n.cost))):console.error("Missing required item '"+o+"' for item '"+n.id+"' ("+n.name+")")}}),e}return!1}addItem(n,i=!1){n&&(this.canAdd(n)||i)&&(s.E.stateManager.before("addItem",s.E.characterManager.characterName(this.character),n.id+"",n.edition),this.character.progress.items.push(new yt.gw(n.id+"",n.edition)),this.items.push(n),this.items.sort(s.E.itemManager.sortItems),s.E.stateManager.after(),this.itemChange())}buyItem(n){n&&this.canBuy(n)&&(s.E.stateManager.before("buyItem",s.E.characterManager.characterName(this.character),n.id+"",n.edition),this.character.progress.gold-=n.cost+s.E.itemManager.pricerModifier(),this.character.progress.items.push(new yt.gw(n.id+"",n.edition)),this.items.push(n),this.items.sort(s.E.itemManager.sortItems),s.E.stateManager.after(),this.itemChange())}craftItemResources(n){this.canCraft(n)&&(n.resources&&Object.keys(n.resources).forEach(i=>{const e=i,o=n.resources[e]||0;(0,rt.hV)(e)==rt.hM.herb_resources?(this.character.progress.loot[e]||0)>=o?this.character.progress.loot[e]=(this.character.progress.loot[e]||0)-o:s.E.game.party.loot[e]=(s.E.game.party.loot[e]||0)-o:this.character.progress.loot[e]=(this.character.progress.loot[e]||0)-o}),n.requiredItems&&n.requiredItems.forEach(i=>{if(i!=n.id){const e=s.E.itemManager.getItem(i,n.edition,!0);if(e)if(this.items.find(o=>o.id==e.id&&o.edition==e.edition)){const o=this.character.progress.items.find(g=>g.name==""+e.id&&g.edition==e.edition);if(o){const g=this.character.progress.items.indexOf(o);this.character.progress.items.splice(g,1),this.character.progress.equippedItems=this.character.progress.equippedItems.filter(m=>m.name!=""+e.id||m.edition!=e.edition),this.items.splice(g,1)}}else this.canBuy(e)?this.character.progress.gold-=n.cost+s.E.itemManager.pricerModifier():this.craftItemResources(e);else console.error("Missing required item '"+i+"' for item '"+n.id+"' ("+n.name+")")}}))}craftItem(n){n&&this.canCraft(n)&&(s.E.stateManager.before("craftItem",s.E.characterManager.characterName(this.character),n.id+"",n.edition),this.craftItemResources(n),this.character.progress.items.push(new yt.gw(n.id+"",n.edition)),this.items.push(n),this.items.sort(s.E.itemManager.sortItems),s.E.stateManager.after(),this.itemChange())}openItem(n){this.dialog.open(fn,{panelClass:["fullscreen-panel"],data:{character:p.f.settings.characterItems?this.character:void 0,item:n,setup:s.E.game.state==D.mk.draw&&s.E.roundManager.firstRound}})}removeItem(n){const i=this.character.progress.items.find(e=>e.name==""+n.id&&e.edition==n.edition);i&&this.dialog.open(fi,{panelClass:["dialog"],data:{label:"game.items.remove",args:["data.items."+i.edition+"-"+n.id]}}).closed.subscribe({next:e=>{if(e){const o=this.character.progress.items.indexOf(i);s.E.stateManager.before("removeItem",s.E.characterManager.characterName(this.character),this.character.progress.items[o].name,this.character.progress.items[o].edition),this.character.progress.items.splice(o,1),this.character.progress.equippedItems=this.character.progress.equippedItems.filter(g=>g.name!=""+n.id||g.edition!=n.edition),this.items.splice(o,1),s.E.stateManager.after(),this.itemChange()}}})}sellItem(n){const i=this.character.progress.items.find(e=>e.name==""+n.id&&e.edition==n.edition);i&&s.E.itemManager.itemSellValue(n)&&this.dialog.open(fi,{panelClass:["dialog"],data:{label:"game.items.sell",args:["data.items."+i.edition+"-"+n.id,s.E.itemManager.itemSellValue(n)]}}).closed.subscribe({next:e=>{if(e){const o=this.character.progress.items.indexOf(i);s.E.stateManager.before("sellItem",s.E.characterManager.characterName(this.character),this.character.progress.items[o].name,this.character.progress.items[o].edition),this.character.progress.gold+=s.E.itemManager.itemSellValue(n),this.character.progress.items.splice(o,1),this.character.progress.equippedItems=this.character.progress.equippedItems.filter(g=>g.name!=""+n.id||g.edition!=n.edition),this.items.splice(o,1),s.E.stateManager.after(),this.itemChange()}}})}distillItem(n){this.dialog.open(_s,{panelClass:["dialog"],data:{character:this.character,item:n}})}isEquipped(n){return this.character.progress.equippedItems.find(i=>i.name==""+n.id&&i.edition==n.edition)}toggleEquippedItem(n,i=!1){(!(s.E.game.state!=D.mk.draw||s.E.game.round>0)||i)&&null!=this.character.progress.items.find(o=>o.name==""+n.id&&o.edition==n.edition)&&(s.E.stateManager.before(s.E.itemManager.isEquipped(n,this.character)?"unequipItem":"equipItem",s.E.characterManager.characterName(this.character),n.id,n.edition),s.E.itemManager.toggleEquippedItem(n,this.character,i),s.E.stateManager.after())}setItemNotes(n){this.character.progress.itemNotes!=n.target.value&&(s.E.stateManager.before("setItems",s.E.characterManager.characterName(this.character),n.target.value),this.character.progress.itemNotes=n.target.value,s.E.stateManager.after())}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-character-items"]],inputs:{character:"character"},standalone:!1,decls:13,vars:5,consts:[[1,"items"],[3,"ghs-label"],[1,"item-list"],[1,"item-entry"],[1,"item-form"],[1,"shop",3,"click"],["src","./assets/images/items/item.svg"],["ghs-pointer-input","",3,"ngClass"],["ghs-pointer-input","",1,"icon","item-dialog",3,"singleClick"],[3,"src"],[1,"item","placeholder",3,"ghs-label"],["ghs-pointer-input","",1,"id","item-dialog",3,"singleClick"],["ghs-pointer-input","",1,"name",3,"singleClick","doubleClick","ngClass"],[1,"spacer"],[1,"equipped"],[1,"effect","hint-container"],[1,"minus-one",3,"ngClass"],[1,"button","distill",3,"ghs-tooltip","ghs-label-args"],[1,"button","loot",3,"click","ghs-tooltip","ghs-label-args"],["src","./assets/images/loot.svg"],[1,"button","remove",3,"click","ghs-tooltip","ghs-label-args"],["src","./assets/images/close.svg"],["src","./assets/images/check.svg"],["src","./assets/images/hint.svg",1,"hint-trigger","ghs-svg",3,"ghs-tooltip","hint"],["src","./assets/images/action/card/minus1.svg"],[1,"button","distill",3,"click","ghs-tooltip","ghs-label-args"],["src","./assets/images/fh/brewing.svg"],["ghs-pointer-input","",3,"singleClick","doubleClick","ngClass"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"label"),t.nrm(2,"span",1),t.EFF(3,":"),t.k0s(),t.j41(4,"div",2),t.Z7z(5,AR,19,22,"div",3,RR),t.nI1(7,"trackUUID"),t.k0s(),t.j41(8,"div",4)(9,"a",5),t.bIt("click",function(){return e.itemDialog()}),t.nrm(10,"img",6)(11,"span",1),t.k0s(),t.nVh(12,VR,3,4,"a",7),t.k0s()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","game.items"),t.R7$(3),t.Dyx(t.bMT(7,3,e.items)),t.R7$(6),t.Y8G("ghs-label","game.items.character.shop"),t.R7$(),t.vxM(e.brewing?12:-1))},dependencies:[N.YU,it,Mt,dt,ct],styles:[".items{display:flex;flex-direction:column}.items img{width:auto;height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.items .button{cursor:pointer;display:flex;align-items:center}.items .button.add img{filter:var(--ghs-filter-green)}.items .button.remove img{filter:var(--ghs-filter-red)}.items .button.loot{margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));color:var(--ghs-color-yellow)}.items .button.loot img{filter:var(--ghs-filter-yellow);width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.items .button.distill{margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));color:var(--ghs-color-yellow)}.items .button.distill img{filter:var(--ghs-filter-blue);width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.items .button.craft{margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));color:var(--ghs-color-black)}.items .button.craft .resource{display:flex;align-items:center;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items .button.craft .resource img{width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.items .button.craft .item{margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items .button.disabled{color:var(--ghs-color-darkgray)!important}.items .button.disabled img{filter:var(--ghs-filter-darkgray)!important}.items .button.disabled .item,.items .button.disabled .resource img{opacity:.6}.items .button:hover{opacity:.8}.items .item-list{font-family:var(--ghs-font-text);display:flex;flex-direction:column;overflow:visible}.items .item-list .item-entry{display:flex;align-items:center;margin:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor))}.items .item-list .item-entry .item-dialog{cursor:zoom-in}.items .item-list .item-entry .icon{display:flex;justify-content:center;align-items:center;position:relative;width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.items .item-list .item-entry .id{text-align:right;margin-right:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.items .item-list .item-entry .id{display:flex;justify-content:flex-end;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.items .item-list .item-entry .name{cursor:pointer;display:inline-block;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.items .item-list .item-entry .name.disabled{cursor:initial}.items .item-list .item-entry .edition{font-size:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.items .item-list .item-entry .action-icon{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));display:flex;justify-content:center;align-items:center}.items .item-list .item-entry .action-icon img{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:auto}.items .item-list .item-entry .loot{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.items .item-list .item-entry .equipped{display:flex;justify-content:center;align-items:center;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items .item-list .item-entry .equipped img{filter:var(--ghs-filter-green);height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));width:auto}.items .item-list .item-entry .effect.hint-container .hint-trigger.ghs-svg{filter:var(--ghs-filter-gray)}.items .item-list .item-entry .effect.hint-container .hint{left:initial;right:0}.items .item-list .item-entry .minus-one{font-family:var(--ghs-font-title);display:flex;justify-content:center;align-items:center;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items .item-list .item-entry .minus-one img{margin-right:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.items .item-list .item-entry .minus-one.ignore{opacity:.5}.items .item-form{display:flex;justify-content:space-evenly;align-items:center;max-width:calc(var(--ghs-unit) * 33 * var(--ghs-dialog-factor))}.items .item-form a{cursor:pointer;color:var(--ghs-color-black);display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.items .item-form a img{height:1em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items .item-form a:hover{opacity:.7}.items .item-form a.disabled{cursor:initial;opacity:.8}.items .item-form a.disabled:hover{opacity:.6}\n"],encapsulation:2})}return a})();function XR(a,r){1&a&&t.nrm(0,"span",2),2&a&&t.Y8G("ghs-label","and")}function BR(a,r){if(1&a&&(t.nrm(0,"span",3),t.nVh(1,XR,1,1,"span",2)),2&a){const n=t.XpG();t.Y8G("ghs-label",n.perk.custom),t.R7$(),t.vxM(n.perk.type!=n.PerkType.custom?1:-1)}}function YR(a,r){if(1&a&&t.nrm(0,"span",1),2&a){const n=t.XpG();t.Y8G("ghs-label","game.attackModifiers.perks.type."+n.perk.type)("ghs-label-args",n.perkLabel(n.perk))}}function UR(a,r){1&a&&t.nrm(0,"span",2),2&a&&t.Y8G("ghs-label","game.attackModifiers.perks.monsterDeck")}let gr=(()=>{class a{perk;PerkType=we.RU;perkLabel(n){let i=[],e=[];if(n.cards){if(n.cards.forEach(o=>{e.push(p.f.getLabel("game.attackModifiers.perks.cardLabel",["game.attackModifiers.perks.cards."+o.count,this.attackModifierHtml(o.attackModifier),o.count>1?"game.attackModifiers.perks.cards":"game.attackModifiers.perks.card"]))}),n.type==we.RU.replace){const o=s.E.attackModifierManager.replaceCount(n);if(1==o&&2==e.length)i=e;else{if(o>1){let g="";for(let m=o-1;m>=0;m--)g=g?p.f.getLabel("game.attackModifiers.perks.additional",[e[m],g]):e[m];i.push(g)}else i.push(e[0]);if(e.length-o==1)i.push(e[o]);else{let g="";for(let m=e.length;m>=o;m--)g=g?p.f.getLabel("game.attackModifiers.perks.additional",[e[m],g]):e[m];i.push(g)}}}e.length<2?i=e:e.length<3?e.forEach((o,g,m)=>{g%2==0&&g<m.length-1&&i.push(p.f.getLabel("game.attackModifiers.perks.additional",[o,e[g+1]]))}):e.length<4&&e.forEach((o,g,m)=>{g%2==0&&g<m.length-2&&i.push(p.f.getLabel("game.attackModifiers.perks.additionalTwo",[o,e[g+1],e[g+2]]))})}return i}attackModifierHtml(n){let i="";return n=new w.uU(n.type,n.value,n.valueType,n.id,n.effects,n.rolling,n.active,n.shuffle),i+='<span class="attack-modifier-container">',!p.f.settings.fhStyle&&n.rolling&&(i+='<span class="attack-modifier-effect rolling">&zwj;<img class="action-icon sw" src="./assets/images/attackmodifier/rolling.svg"></span>'),(!n.rolling||n.type!=w.Yn.plus0)&&(i+=n.valueType==w.tW.minus?'<span class="attack-modifier-icon'+(n.value>9?" small":"")+'">-'+n.value+"</span>":n.type!=w.Yn.null&&n.valueType==w.tW.multiply?'<span class="attack-modifier-icon'+(n.value>9?" small":"")+'">'+n.value+"x</span>":n.type==w.Yn.null?'<span class="attack-modifier-icon">&zwj;<img class="null" src="./assets/images/attackmodifier/null.svg"></span>':n.type==w.Yn.plusX?'<span class="attack-modifier-icon">+X</span>':'<span class="attack-modifier-icon'+(n.value>9?" small":"")+'">+'+n.value+"</span>"),n.effects&&(n.effects.length>1&&(i+='"'),n.effects.forEach((e,o)=>{o>0&&(i+=","),i+=this.attackModifierEffectHtml(e,n.effects.length>1)}),n.effects.length>1&&(i+='"')),n.shuffle&&n.type!=w.Yn.null&&(i+='<span class="attack-modifier-effect shuffle">&zwj;<img class="action-icon sw" src="./assets/images/shuffle.svg"></span>'),p.f.settings.fhStyle&&n.rolling&&(i+='<span class="attack-modifier-effect rolling">&zwj;<img class="action-icon sw" src="./assets/images/attackmodifier/rolling.svg"></span>'),i+="</span>",i}attackModifierEffectHtml(n,i=!1){let e="",o=!1;switch(n.type){case w.hY.condition:let g=n.value.split(":")[0];g=g.replace("_x",""),e+='<span class="attack-modifier-effect condition">'+(p.f.settings.fhStyle?"":p.f.getLabel("game.condition."+g))+'<img class="action-icon sw" src="./assets/images/'+(p.f.settings.fhStyle?"fh/":"")+"condition/"+g+'.svg">',n.value.split(":").length>1&&(e+=n.value.split(":")[1]),e+="</span>";break;case w.hY.element:e+='<span class="attack-modifier-effect element"><img class="action-icon sw" src="./assets/images/'+(p.f.settings.fhStyle?"fh/":"")+"element/"+n.value+'.svg"></span>';break;case w.hY.elementHalf:const m=n.value.split("|");e+='<span class="attack-modifier-effect element-half-placeholder'+(p.f.settings.fhStyle?" fh":"")+'"><span class="element-half-container"><span class="element-half"><img src="./assets/images/'+(p.f.settings.fhStyle?"fh/":"")+"element/"+m[0]+'.svg"></span><span class="element-half"><img src="./assets/images/'+(p.f.settings.fhStyle?"fh/":"")+"element/"+m[1]+'.svg"></span></span></span>';break;case w.hY.elementConsume:return e+='<span class="attack-modifier-effect element consume"><img class="action-icon sw" src="./assets/images/'+(p.f.settings.fhStyle?"fh/":"")+"element/"+n.value+'.svg"></span>',n.effects&&(e+=":",n.effects.forEach(k=>{e+=this.attackModifierEffectHtml(k,!0)})),i?e:'"'+e+'"';case w.hY.target:if(p.f.settings.fhStyle){const k=isNaN(+n.value)?n.value:"+"+n.value;e+='<span class="placeholder attack-modifier-effect target">'+k+'<img class="action-icon" src="./assets/images/fh/attackmodifier/target.svg"></span>'}else e+='<span class="placeholder attack-modifier-effect target">'+p.f.getLabel(+n.value<=1?"game.custom.perks.addTarget":"game.custom.perks.addTargets",[n.value+""])+'<img class="action-icon" src="./assets/images/attackmodifier/target.svg"></span>';break;case w.hY.specialTarget:n.value.split(":").length>1?e+='<span class="placeholder attack-modifier-effect special-target">'+p.f.getLabel("game.specialTarget."+n.value.split(":")[0],n.value.split(":").slice(1))+"</span>":e+=p.f.settings.fhStyle&&"allyShort"==n.value?'<span class="placeholder attack-modifier-effect special-target">'+p.f.getLabel("game.specialTarget.ally")+"</span>":'<span class="placeholder attack-modifier-effect special-target">'+p.f.getLabel("game.specialTarget."+n.value)+"</span>";break;case w.hY.refreshItem:e+='<span class="placeholder attack-modifier-effect card">'+p.f.getLabel("game.attackModifiers.perks.effects."+n.type+(p.f.settings.fhStyle?"Fh":""))+"</span>";break;case w.hY.refreshSpentItem:case w.hY.recoverRandomDiscard:e+='<span class="placeholder attack-modifier-effect card">'+p.f.getLabel("game.attackModifiers.perks.effects."+n.type)+"</span>";break;case w.hY.custom:e+=n.hint?'<span class="placeholder attack-modifier-effect custom-hint">'+p.f.getLabel(n.hint)+"</span>":'<span class="placeholder attack-modifier-effect custom">'+p.f.getLabel(""+n.value)+"</span>",o=!0;break;case w.hY.or:return n.effects&&n.effects.forEach((k,X)=>{e+=this.attackModifierEffectHtml(k,!0),X<n.effects.length-1&&(e+=" "+p.f.getLabel("or")+" ")}),i?e:'"'+e+'"';case w.hY.changeType:return n.value.startsWith("plus")?e+='<span class="attack-modifier-icon">+'+n.value.replace("plus","")+"</span>":n.value.startsWith("minus")?e+='<span class="attack-modifier-icon">-'+n.value.replace("minus","")+"</span>":n.value.startsWith("multiply")&&(e+='<span class="attack-modifier-icon">x'+n.value.replace("multiply","")+"</span>"),n.effects&&n.effects.forEach(k=>{e+=this.attackModifierEffectHtml(k,!0)}),i||(e='"'+e+'"'),e;case w.hY.required:return e+=n.value?"<span>"+n.value+"</span>":"<span>!</span>",n.effects&&n.effects.forEach(k=>{e+=this.attackModifierEffectHtml(k,!0)}),i||(e='"'+e+'"'),e;default:e+='<span class="placeholder attack-modifier-effect default '+n.type+'">'+(p.f.settings.fhStyle?"":p.f.getLabel("game.action."+n.type))+'<img  class="action-icon" src="./assets/images/'+(p.f.settings.fhStyle?"fh/":"")+"action/"+n.type+'.svg"><span class="value">'+n.value+"</span></span>",[w.hY.pull,w.hY.push,w.hY.swing,!w.hY.pierce].includes(n.type)&&(o=!0)}return n.effects&&(o=!0,n.effects.forEach(g=>{e+=","+this.attackModifierEffectHtml(g,!0)})),o&&!i&&(e='"'+e+'"'),e}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-perk-label"]],inputs:{perk:"perk"},standalone:!1,decls:4,vars:3,consts:[[1,"perk-label","capitalize"],[1,"label",3,"ghs-label","ghs-label-args"],[1,"spacing",3,"ghs-label"],[3,"ghs-label"]],template:function(i,e){1&i&&(t.j41(0,"span",0),t.nVh(1,BR,2,2),t.nVh(2,YR,1,2,"span",1),t.nVh(3,UR,1,1,"span",2),t.k0s()),2&i&&(t.R7$(),t.vxM(e.perk.custom?1:-1),t.R7$(),t.vxM(e.perk.type!=e.PerkType.custom?2:-1),t.R7$(),t.vxM(e.perk.monsterDeck?3:-1))},dependencies:[it],styles:['.perk-label{display:inline-block;line-height:1em}.perk-label:first-letter{text-transform:uppercase}.perk-label .spacing{margin:0 calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor))}.perk-label .attack-modifier-container{white-space:nowrap}.perk-label .attack-modifier-container *{white-space:initial}.perk-label .attack-modifier-effect{position:relative;margin-left:calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor))}.perk-label .attack-modifier-effect img.action-icon{position:relative;height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor));width:auto;vertical-align:middle}.perk-label .attack-modifier-effect img.action-icon.sw{filter:invert(1) contrast(1) grayscale(1) brightness(2.5);filter:none}.perk-label .attack-modifier-effect img.action-icon.circled{border:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);border-radius:100%}.perk-label .attack-modifier-effect.rolling img.action-icon,.perk-label .attack-modifier-effect.condition img.action-icon,.perk-label .attack-modifier-effect.target img.action-icon,.perk-label .attack-modifier-effect.pierce img.action-icon,.perk-label .attack-modifier-effect.pull img.action-icon,.perk-label .attack-modifier-effect.push img.action-icon,.perk-label .attack-modifier-effect.element img.action-icon,.perk-label .attack-modifier-effect.element-half img.action-icon{height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.perk-label .attack-modifier-effect .value{margin-left:calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor))}.perk-label .attack-modifier-effect.condition,.perk-label .attack-modifier-effect.target,.perk-label .attack-modifier-effect.pierce{text-transform:uppercase}.perk-label .attack-modifier-effect.element img{margin:0}.perk-label .attack-modifier-effect.element-half-placeholder{display:inline-block;position:relative;width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:0}.perk-label .attack-modifier-effect.element-half-placeholder .element-half-container{position:absolute;width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * -1.6 * var(--ghs-dialog-factor))}.perk-label .attack-modifier-effect.element-half-placeholder.fh{width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor))}.perk-label .attack-modifier-effect.element-half-placeholder.fh .element-half-container{width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:initial}.perk-label .attack-modifier-effect .placeholder-action{vertical-align:middle}.perk-label .attack-modifier-icon{position:relative;display:inline-flex;justify-content:center;align-items:center;font-family:var(--ghs-font-gh-title);font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor));vertical-align:middle}.perk-label .attack-modifier-icon.small{font-size:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor))}.perk-label .attack-modifier-icon img.null{filter:var(--ghs-filter-black);width:70%;height:70%}.perk-label .attack-modifier-icon:before{content:" ";position:absolute;left:0;top:calc(var(--ghs-unit) * -.15 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);border-radius:100%}\n'],encapsulation:2})}return a})();const NR=["charactertitle"],zR=(a,r,n,i)=>({"cs-sheet":a,"fh-sheet":r,"gh2e-sheet":n,compact:i}),dr=(a,r)=>({denied:a,"view-only":r}),LR=(a,r)=>[a,r],je=()=>[],Je=a=>({checked:a}),hr=a=>[a],Qe=a=>({disabled:a}),qR=a=>({combined:a}),HR=(a,r)=>({checked:a,disabled:r}),_r=(a,r)=>r._trackUUID;function KR(a,r){if(1&a){const n=t.RV6();t.j41(0,"input",65,0),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.titleChange())}),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("value",n.character.title)}}function WR(a,r){if(1&a){const n=t.RV6();t.nrm(0,"img",7),t.j41(1,"input",65),t.bIt("change",function(e){const o=c.eBV(n).$implicit,g=t.XpG(2);return c.Njj(g.setTitle(e,o))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("src",i.gameManager.characterManager.characterIdentityIcon(i.character.name,n),t.B4B),t.R7$(),t.Y8G("value",i.titles[n])}}function ZR(a,r){if(1&a&&(t.Z7z(0,WR,2,2,null,null,t.fX1),t.nI1(2,"ghsRange")),2&a){const n=t.XpG();t.Dyx(t.i5U(2,0,t.lJ4(3,je),n.character.identities.length))}}function JR(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",66),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.setLevel(e+1))}),t.EFF(1),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(2,Je,i.character.level>n)),t.R7$(),t.JRh(n+1)}}function QR(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",67),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.setLevel(e+1))}),t.EFF(1),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(2,Je,i.character.progress.experience>=i.gameManager.characterManager.xpMap[n])),t.R7$(),t.SpI(" ",i.gameManager.characterManager.xpMap[n]," ")}}function tj(a,r){1&a&&(t.j41(0,"span"),t.nrm(1,"span",14),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","character.progress.notes"))}function nj(a,r){1&a&&(t.j41(0,"label"),t.nrm(1,"span",14),t.EFF(2,":"),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","character.progress.gold-notes"))}function ej(a,r){1&a&&(t.j41(0,"label"),t.nrm(1,"span",14)(2,"img",68),t.EFF(3,":"),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","character.progress.gold"))}function aj(a,r){if(1&a&&(t.j41(0,"span",27),t.nrm(1,"span",10),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","character.progress.donations")("ghs-label-args",t.eq3(2,hr,n.character.progress.donations))}}function ij(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",28),t.nrm(1,"span",14),t.EFF(2,": "),t.j41(3,"a",69),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.donate())}),t.j41(4,"span",70),t.nrm(5,"img",71),t.EFF(6),t.k0s()()()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","character.progress.donate"),t.R7$(2),t.Y8G("ngClass",t.eq3(3,Qe,n.character.progress.gold<(n.fhSheet?5:10)||n.gameManager.game.round>0)),t.R7$(3),t.JRh(n.fhSheet?5:10)}}function oj(a,r){1&a&&t.nrm(0,"hr",29)}function sj(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",30)(1,"label"),t.nrm(2,"span",14),t.EFF(3,":"),t.k0s(),t.j41(4,"a",72),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.moveResources())}),t.nrm(5,"span",14),t.k0s(),t.j41(6,"div",73)(7,"div",74)(8,"div",75),t.nrm(9,"img",76),t.j41(10,"input",25),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setResource(o.LootType.lumber,e))}),t.k0s()(),t.j41(11,"div",77),t.nrm(12,"img",78),t.j41(13,"input",25),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setResource(o.LootType.metal,e))}),t.k0s()(),t.j41(14,"div",79),t.nrm(15,"img",80),t.j41(16,"input",25),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setResource(o.LootType.hide,e))}),t.k0s()()(),t.j41(17,"div",81)(18,"div",82),t.nrm(19,"img",83),t.j41(20,"input",25),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setResource(o.LootType.arrowvine,e))}),t.k0s()(),t.j41(21,"div",84),t.nrm(22,"img",85),t.j41(23,"input",25),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setResource(o.LootType.axenut,e))}),t.k0s()(),t.j41(24,"div",86),t.nrm(25,"img",87),t.j41(26,"input",25),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setResource(o.LootType.corpsecap,e))}),t.k0s()(),t.j41(27,"div",88),t.nrm(28,"img",89),t.j41(29,"input",25),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setResource(o.LootType.flamefruit,e))}),t.k0s()(),t.j41(30,"div",90),t.nrm(31,"img",91),t.j41(32,"input",25),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setResource(o.LootType.rockroot,e))}),t.k0s()(),t.j41(33,"div",92),t.nrm(34,"img",93),t.j41(35,"input",25),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setResource(o.LootType.snowthistle,e))}),t.k0s()()()()()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","character.progress.resources"),t.R7$(3),t.Y8G("ghs-label","character.progress.resources.move"),t.R7$(5),t.Y8G("value",n.character.progress.loot.lumber),t.R7$(3),t.Y8G("value",n.character.progress.loot.metal),t.R7$(3),t.Y8G("value",n.character.progress.loot.hide),t.R7$(4),t.Y8G("value",n.character.progress.loot.arrowvine),t.R7$(3),t.Y8G("value",n.character.progress.loot.axenut),t.R7$(3),t.Y8G("value",n.character.progress.loot.corpsecap),t.R7$(3),t.Y8G("value",n.character.progress.loot.flamefruit),t.R7$(3),t.Y8G("value",n.character.progress.loot.rockroot),t.R7$(3),t.Y8G("value",n.character.progress.loot.snowthistle)}}function rj(a,r){1&a&&(t.j41(0,"span",99),t.EFF(1,"-"),t.k0s())}function cj(a,r){if(1&a&&(t.nrm(0,"span",98),t.nVh(1,rj,2,0,"span",99)),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.Y8G("ghs-label","data.character.traits."+n),t.R7$(),t.vxM(i<e.character.traits.length-1?1:-1)}}function lj(a,r){if(1&a&&(t.j41(0,"div",94)(1,"span",96),t.nrm(2,"img",97),t.k0s(),t.Z7z(3,cj,2,2,null,null,t.fX1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(3),t.Dyx(n.character.traits)}}function gj(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",31)(1,"label"),t.nrm(2,"span",14),t.EFF(3,": "),t.nVh(4,lj,5,0,"div",94),t.k0s(),t.j41(5,"textarea",95),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setNotes(e))}),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","character.progress.notes"),t.R7$(2),t.vxM(n.character.traits.length>0?4:-1),t.R7$(),t.Y8G("readOnly",!n.gameManager.stateManager.characterPermissions[n.character.name+"|"+n.character.edition])("value",n.character.progress.notes)("ghs-label","character.progress.notes")("ghs-label-attribute","placeholder")}}function dj(a,r){if(1&a&&t.nrm(0,"ghs-character-items",32),2&a){const n=t.XpG();t.Y8G("character",n.character)}}function hj(a,r){1&a&&t.nrm(0,"hr",29)}function _j(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",101)(1,"span",102),t.nrm(2,"img",103),t.EFF(3,":"),t.k0s(),t.j41(4,"span",104),t.bIt("click",function(){const e=c.eBV(n).$index,o=t.XpG(2);return c.Njj(o.toggleMastery(e))}),t.k0s(),t.nrm(5,"span",105),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.R7$(4),t.Y8G("ngClass",t.eq3(2,Je,e.character.progress.masteries.includes(i))),t.R7$(),t.Y8G("ghs-label",n)}}function mj(a,r){if(1&a&&(t.j41(0,"div",33)(1,"label"),t.nrm(2,"span",14),t.EFF(3,":"),t.k0s(),t.j41(4,"div",100),t.Z7z(5,_j,6,4,"div",101,t.fX1),t.k0s()()),2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","character.progress.masteries"),t.R7$(3),t.Dyx(n.character.masteries)}}function pj(a,r){1&a&&t.nrm(0,"hr",29)}function uj(a,r){1&a&&(t.j41(0,"label",36),t.nrm(1,"span",14),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","game.attackModifiers.perks"))}function fj(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",109),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG().$index,g=t.XpG();return c.Njj(g.addPerk(o,e+1))})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG().$index,g=t.XpG();return c.Njj(g.addPerk(o,e+1,!0))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG().$index,e=t.XpG();t.Y8G("ngClass",t.l_i(1,HR,e.character.progress.perks[i]&&e.character.progress.perks[i]>n,!e.forceEdit&&(e.gameManager.game.state!=e.GameState.draw||e.gameManager.game.round>0)||e.character.progress.perks[i]<=n&&e.availablePerks<n-e.character.progress.perks[i]+1))}}function Cj(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",38)(1,"div",106),t.Z7z(2,fj,1,4,"span",107,t.fX1),t.nI1(4,"ghsRange"),t.k0s(),t.j41(5,"ghs-perk-label",108),t.bIt("singleClick",function(){const e=c.eBV(n).$index,o=t.XpG();return c.Njj(o.togglePerk(e))})("doubleClick",function(){const e=c.eBV(n).$index,o=t.XpG();return c.Njj(o.togglePerk(e,!0))}),t.k0s()()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(6,qR,n.combined)),t.R7$(),t.Dyx(t.i5U(4,3,t.lJ4(8,je),n.count)),t.R7$(3),t.Y8G("ngClass",t.eq3(9,Qe,e.gameManager.game.state!=e.GameState.draw||e.gameManager.game.round>0||0==e.availablePerks&&!e.character.progress.perks[i]))("perk",n)}}function Mj(a,r){1&a&&(t.j41(0,"div",39),t.nrm(1,"img",110)(2,"span",14),t.k0s()),2&a&&(t.Y8G("ghs-label","game.attackModifiers.perks.warning")("ghs-label-attribute","title"),t.R7$(2),t.Y8G("ghs-label","game.attackModifiers.perks.warning"))}function vj(a,r){1&a&&(t.j41(0,"div",40),t.nrm(1,"img",110)(2,"span",14),t.k0s()),2&a&&(t.Y8G("ghs-label","wip")("ghs-label-attribute","title"),t.R7$(2),t.Y8G("ghs-label","game.attackModifiers.perks.wip"))}function Oj(a,r){1&a&&(t.j41(0,"label",36),t.nrm(1,"span",14),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","game.battleGoals"))}function Pj(a,r){1&a&&(t.j41(0,"label",36),t.nrm(1,"span",14),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","game.attackModifiers.perks"))}function bj(a,r){if(1&a&&(t.j41(0,"span",102),t.nrm(1,"img",7),t.EFF(2,":"),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("src","./assets/images/"+(n.gh2eSheet||n.fhSheet?"checkmark":"check")+".svg",t.B4B)}}function kj(a,r){if(1&a){const n=t.RV6();t.nVh(0,bj,3,1,"span",102),t.j41(1,"span",111),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.setBattleGoals(e+1))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.vxM(n%3==0?0:-1),t.R7$(),t.Y8G("ngClass",t.eq3(2,Je,i.character.progress.battleGoals>=n+1))}}function yj(a,r){1&a&&t.nrm(0,"hr",29)}function xj(a,r){1&a&&(t.j41(0,"label",36),t.nrm(1,"span",14),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","character.progress.notes"))}function Ej(a,r){if(1&a){const n=t.RV6();t.j41(0,"textarea",95),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setNotes(e))}),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("readOnly",!n.gameManager.stateManager.characterPermissions[n.character.name+"|"+n.character.edition])("value",n.character.progress.notes)("ghs-label","character.progress.notes")("ghs-label-attribute","placeholder")}}function wj(a,r){if(1&a&&t.nrm(0,"ghs-character-items",45),2&a){const n=t.XpG();t.Y8G("character",n.character)}}function Rj(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"/"),t.k0s())}function jj(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.SpI(" ",n.gameManager.game.party.players[n.character.number-1])}}function Gj(a,r){if(1&a){const n=t.RV6();t.j41(0,"label",119),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.retire())})("doubleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.retire(!0))}),t.nrm(1,"img",120)(2,"span",14),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Qe,!n.retireEnabled)),t.R7$(2),t.Y8G("ghs-label","character.progress.retirement")}}function Tj(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.SpI("\xa0(",n.personalQuest.altId,")")}}function Sj(a,r){if(1&a&&(t.j41(0,"span",115),t.nrm(1,"span",14),t.nVh(2,Tj,2,1,"span"),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","data.personalQuest."+n.personalQuest.edition+"."+n.personalQuest.cardId),t.R7$(),t.vxM(n.personalQuest.altId&&n.personalQuest.altId!=n.personalQuest.cardId?2:-1)}}function Dj(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",124),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openTrial())}),t.nrm(1,"img",125),t.k0s()}}function $j(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",116)(1,"label"),t.nrm(2,"span",14),t.EFF(3,":"),t.k0s(),t.j41(4,"div",121)(5,"input",122,1),t.bIt("change",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.setTrial(e))})("keyup",function(){c.eBV(n);const e=t.sdS(6);return c.Njj(e.classList.remove("error"))}),t.k0s(),t.nVh(7,Dj,2,0,"a",123),t.k0s()()}if(2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","character.progress.trial"),t.R7$(3),t.Y8G("value",n.character.progress.trial?n.settingsManager.settings.fhSecondEdition?n.gameManager.trialsManager.cardIdSecondPrinting(+n.character.progress.trial.name):n.character.progress.trial.name:""),t.R7$(2),t.vxM(n.fhSheet&&n.character.progress.trial?7:-1)}}function Ij(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG(3);t.R7$(),t.Lme("\xa0",o.character.progress.personalQuestProgress[e]||0,"/",o.EntityValueFunction(i.counter))}}function Aj(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",131),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2).$index,g=t.XpG(3);return c.Njj(g.setPersonalQuestProgress(o,e+1))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2).$index,e=t.XpG(3);t.Y8G("ngClass",t.eq3(3,Je,e.character.progress.personalQuestProgress[i]>n))("ghs-label","character.progress.personalQuest.counter")("ghs-label-attribute","title")}}function Vj(a,r){if(1&a&&(t.Z7z(0,Aj,1,5,"span",130,t.fX1),t.nI1(2,"ghsRange")),2&a){const n=t.XpG().$implicit,i=t.XpG(3);t.Dyx(t.i5U(2,0,t.lJ4(3,je),i.EntityValueFunction(n.counter)))}}function Fj(a,r){if(1&a){const n=t.RV6();t.j41(0,"input",132),t.bIt("change",function(e){c.eBV(n);const o=t.XpG().$index,g=t.XpG(3);return c.Njj(g.setPersonalQuestProgress(o,e))}),t.k0s()}if(2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG(3);t.Y8G("value",o.character.progress.personalQuestProgress[e])("max",o.EntityValueFunction(i.counter))}}function Xj(a,r){if(1&a&&(t.j41(0,"div",126)(1,"span",127),t.nrm(2,"span",14),t.EFF(3,":"),t.nVh(4,Ij,2,2,"span"),t.k0s(),t.j41(5,"span",128),t.nVh(6,Vj,3,4),t.nVh(7,Fj,1,2,"input",129),t.k0s()()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.Y8G("ngClass",t.eq3(5,Qe,n.requires&&n.requires.length>0&&!e.personalQuestRequirementUnlocked(i))),t.R7$(2),t.Y8G("ghs-label",n.name),t.R7$(2),t.vxM(e.EntityValueFunction(n.counter)>1?4:-1),t.R7$(2),t.vxM(e.EntityValueFunction(n.counter)<11?6:-1),t.R7$(),t.vxM(e.EntityValueFunction(n.counter)>10?7:-1)}}function Bj(a,r){if(1&a&&(t.j41(0,"div",117),t.Z7z(1,Xj,8,7,"div",126,_r),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Dyx(t.bMT(3,0,n.personalQuest.requirements))}}function Yj(a,r){if(1&a&&t.nrm(0,"div",133),2&a){const n=t.XpG(3);t.Y8G("ghs-label","character.progress.personalQuest.unlockCharacter")("ghs-label-args",t.eq3(2,hr,n.personalQuest.unlockCharacter))}}function Uj(a,r){if(1&a&&t.nrm(0,"div",133),2&a){const n=t.XpG(3);t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope"+(n.personalQuest.openEnvelope.split(":").length>1?".alt":""))("ghs-label-args",n.personalQuest.openEnvelope.split(":"))}}function Nj(a,r){if(1&a&&(t.j41(0,"div",118),t.nVh(1,Yj,1,4,"div",133),t.nVh(2,Uj,1,2,"div",133),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.vxM(n.personalQuest.unlockCharacter?1:-1),t.R7$(),t.vxM(n.personalQuest.openEnvelope?2:-1)}}function zj(a,r){if(1&a){const n=t.RV6();t.j41(0,"label",119),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.retire())})("doubleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.retire(!0))}),t.nrm(1,"img",120)(2,"span",14),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Qe,!n.retireEnabled)),t.R7$(2),t.Y8G("ghs-label","character.progress.retirement")}}function Lj(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",52)(1,"label"),t.nrm(2,"span",14),t.EFF(3,":"),t.k0s(),t.j41(4,"div",112)(5,"input",113),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setPersonalQuest(e))}),t.k0s(),t.nVh(6,Gj,3,4,"label",114),t.nVh(7,Sj,3,2,"span",115),t.k0s(),t.nVh(8,$j,8,3,"div",116),t.nVh(9,Bj,4,2,"div",117),t.nVh(10,Nj,3,2,"div",118),t.nVh(11,zj,3,4,"label",114),t.k0s()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","character.progress.personalQuest"),t.R7$(3),t.Y8G("value",n.character.progress.personalQuest),t.R7$(),t.vxM(n.editable&&!n.personalQuest?6:-1),t.R7$(),t.vxM(n.personalQuest?7:-1),t.R7$(),t.vxM(n.gameManager.trialsManager.trialsEnabled?8:-1),t.R7$(),t.vxM(n.personalQuest?9:-1),t.R7$(),t.vxM(n.personalQuest?10:-1),t.R7$(),t.vxM(n.editable&&n.personalQuest?11:-1)}}function qj(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",53)(1,"label"),t.nrm(2,"span",14),t.EFF(3,":"),t.k0s(),t.j41(4,"input",55),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setRetirements(e))})("keyup",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setRetirements(e))}),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","character.progress.retirements"),t.R7$(2),t.Y8G("value",n.character.progress.retirements)}}function Hj(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",56)(1,"label",134),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.setAside())}),t.nrm(2,"img",135)(3,"span",14),t.k0s()()}2&a&&(t.R7$(3),t.Y8G("ghs-label","character.setAside"))}function Kj(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",56)(1,"label",136),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.replay())}),t.nrm(2,"img",135)(3,"span",14),t.k0s()()}2&a&&(t.R7$(3),t.Y8G("ghs-label","character.replay"))}function Wj(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",137),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openAbilityCards())}),t.k0s()}}let mr=(()=>{class a{dialog;ghsManager;character;editable=!0;forceEdit=!1;standalone=!1;dialogRef;titleInput;gameManager=s.E;settingsManager=p.f;ghsInputFullScreenCheck=F.It;EntityValueFunction=A.hZ;GameState=D.mk;PerkType=we.RU;LootType=rt.r6;availablePerks=0;personalQuest;retireEnabled=!1;hasAbilities=!1;goldTimeout=null;xpTimeout=null;replayable=!1;fhSheet=!1;gh2eSheet=!1;csSheet=!1;donations=!0;titles=[];constructor(n,i){this.dialog=n,this.ghsManager=i}ngOnInit(){if(this.character.identities&&this.character.identities.length>1&&p.f.settings.characterIdentities){if(this.titles=this.character.title.split("|"),this.titles.length<this.character.identities.length)for(let n=this.titles.length;n<this.character.identities.length;n++)this.titles.push("");for(let n=0;n<this.titles.length;n++)this.titles[n]||(this.titles[n]=p.f.getLabel("data.character."+this.character.edition+"."+this.character.name.toLowerCase()))}this.character.progress||(this.character.progress=new Ee.lv),this.character.progress.perks=this.character.progress.perks||[],this.fhSheet=s.E.fhRules(!0),this.gh2eSheet=!s.E.fhRules()&&s.E.fhRules(!0),this.csSheet=!this.fhSheet&&("cs"==this.character.edition||s.E.editionExtensions(this.character.edition).includes("cs")),this.donations=!this.fhSheet;for(let n=0;n<15;n++)this.character.progress.perks[n]||(this.character.progress.perks[n]=0);if(this.fhSheet){for(let n in rt.r6)this.character.progress.loot[n]=this.character.progress.loot[n]||0;s.E.game.party.buildings.find(n=>"temple"==n.name&&n.level>0&&"wrecked"!=n.state)&&(this.donations=!0)}this.character.progress.experience<s.E.characterManager.xpMap[this.character.level-1]&&(this.character.progress.experience=s.E.characterManager.xpMap[this.character.level-1]),this.availablePerks=this.character.level+Math.min(6,Math.floor(this.character.progress.battleGoals/3))-(this.character.progress.perks&&this.character.progress.perks.length>0?this.character.progress.perks.reduce((n,i)=>n+i):0)-1+this.character.progress.extraPerks+this.character.progress.retirements+this.character.progress.masteries.length,this.character.progress.personalQuest&&(this.personalQuest=s.E.characterManager.personalQuestByCard(s.E.currentEdition(),this.character.progress.personalQuest),this.character.progress.personalQuestProgress||(this.character.progress.personalQuestProgress=[])),s.E.game.scenario||(this.retireEnabled=!this.personalQuest||this.personalQuest.requirements.every((n,i)=>this.character.progress.personalQuestProgress[i]>=(0,A.hZ)(n.counter))),this.hasAbilities=s.E.deckData(this.character,!0).abilities.length>0,this.replayable=!s.E.game.scenario&&null==s.E.game.figures.find(n=>n instanceof H.K&&n.name==this.character.name&&n.number==this.character.number),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.availablePerks=this.character.level+Math.min(6,Math.floor(this.character.progress.battleGoals/3))-(this.character.progress.perks&&this.character.progress.perks.length>0?this.character.progress.perks.reduce((n,i)=>n+i):0)-1+this.character.progress.extraPerks+this.character.progress.retirements+this.character.progress.masteries.length;for(let n=0;n<15;n++)this.character.progress.perks[n]||(this.character.progress.perks[n]=0);this.retireEnabled=!1,s.E.game.scenario||(this.retireEnabled=!this.personalQuest||this.personalQuest.requirements.every((n,i)=>this.character.progress.personalQuestProgress[i]>=(0,A.hZ)(n.counter)))}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}applyValues(){let n="";if(this.titleInput&&(n=this.titleInput.nativeElement.value),this.titles.length>0){for(let i=0;i<this.titles.length;i++)this.titles[i]==p.f.getLabel("data.character."+this.character.edition+"."+this.character.name.toLowerCase())&&(this.titles[i]="");for(n=this.titles.join("|");n.endsWith("|");)n=n.substring(0,n.length-1)}n!=p.f.getLabel("data.character."+this.character.edition+"."+this.character.name.toLowerCase())?this.character.title!=n&&(s.E.stateManager.before("setTitle",s.E.characterManager.characterName(this.character),n),this.character.title=n,s.E.stateManager.after()):""!=this.character.title&&(s.E.stateManager.before("unsetTitle",s.E.characterManager.characterName(this.character),this.character.title),this.character.title="",s.E.stateManager.after())}titleChange(){this.standalone&&this.applyValues()}ngAfterViewInit(){this.titleInput&&(this.titleInput.nativeElement.value=this.character.title||p.f.getLabel("data.character."+this.character.edition+"."+this.character.name.toLowerCase()))}toggleCharacterAbsent(){(this.character.absent||s.E.characterManager.characterCount()>1)&&(s.E.stateManager.before(this.character.absent?"unsetAbsent":"setAbsent",s.E.characterManager.characterName(this.character)),this.character.absent=!this.character.absent,this.character.absent&&this.character.active&&s.E.roundManager.toggleFigure(this.character),s.E.stateManager.after())}setTitle(n,i){this.titles[i]=n.target.value,this.titleChange()}setLevel(n){this.character.level==n&&n--,n<1?n=1:n>9&&(n=9),s.E.stateManager.before("setLevel",s.E.characterManager.characterName(this.character),""+n),s.E.characterManager.setLevel(this.character,n),s.E.stateManager.after()}setXP(n){!isNaN(+n.target.value)&&this.character.progress.experience!=+n.target.value&&(this.xpTimeout&&(clearTimeout(this.xpTimeout),this.xpTimeout=null),this.xpTimeout=setTimeout(()=>{s.E.stateManager.before("setXP",s.E.characterManager.characterName(this.character),(0,F.n1)(+n.target.value-this.character.progress.experience)),s.E.characterManager.addXP(this.character,n.target.value-this.character.progress.experience,!s.E.game.scenario&&s.E.roundManager.firstRound),s.E.stateManager.after(),this.xpTimeout=null},500))}setGold(n){!isNaN(+n.target.value)&&this.character.progress.gold!=+n.target.value&&(this.goldTimeout&&(clearTimeout(this.goldTimeout),this.goldTimeout=null),this.goldTimeout=setTimeout(()=>{s.E.stateManager.before("setGold",s.E.characterManager.characterName(this.character),n.target.value),this.character.progress.gold=+n.target.value,s.E.stateManager.after(),this.goldTimeout=null},500))}setResource(n,i){isNaN(+i.target.value)||(s.E.stateManager.before("setResource",s.E.characterManager.characterName(this.character),"game.loot."+n,i.target.value),this.character.progress.loot[n]=+i.target.value,s.E.stateManager.after())}donate(){s.E.game.round<1&&this.character.progress.gold>9&&(s.E.stateManager.before("donate",s.E.characterManager.characterName(this.character)),this.character.progress.donations+=1,this.character.donations+=1,s.E.game.party.donations+=1,this.character.progress.gold-=this.fhSheet?5:10,s.E.stateManager.after())}setPersonalQuest(n){this.character.progress.personalQuest!=n.target.value&&(s.E.stateManager.before("setPQ",s.E.characterManager.characterName(this.character),n.target.value),this.character.progress.personalQuest=n.target.value,this.character.progress.personalQuestProgress=[],this.personalQuest=s.E.characterManager.personalQuestByCard(s.E.currentEdition(),this.character.progress.personalQuest),this.personalQuest&&(this.character.progress.personalQuest=this.personalQuest.cardId,this.retireEnabled=this.personalQuest.requirements.every((i,e)=>this.character.progress.personalQuestProgress[e]>=(0,A.hZ)(i.counter))),s.E.stateManager.after())}setPersonalQuestProgress(n,i){for(let o=0;o<=n;o++)this.character.progress.personalQuestProgress[o]||(this.character.progress.personalQuestProgress[o]=0);let e=0;if(e="number"==typeof i?i:+i.target.value,this.character.progress.personalQuestProgress[n]==e&&e--,s.E.stateManager.before("setPQProgress",s.E.characterManager.characterName(this.character),n+1,e),this.character.progress.personalQuestProgress[n]=e,s.E.stateManager.after(),!s.E.game.scenario){const o=this.retireEnabled;this.personalQuest&&(this.retireEnabled=this.personalQuest.requirements.every((g,m)=>this.character.progress.personalQuestProgress[m]>=(0,A.hZ)(g.counter))),!o&&this.retireEnabled&&p.f.settings.applyRetirement&&s.E.game.party.campaignMode&&this.retire(!1,!0)}}retire(n=!1,i=!1){(n||this.retireEnabled)&&(p.f.settings.applyRetirement&&s.E.game.party.campaignMode?this.dialog.open(xR,{panelClass:["dialog"],data:this.character}).closed.subscribe({next:e=>{e&&this.dialogRef&&(0,F.co)(this.dialogRef)}}):i||(this.dialogRef&&(0,F.co)(this.dialogRef),s.E.stateManager.before(this.character.progress.retired?"setRetired":"unsetRetired",s.E.characterManager.characterName(this.character)),this.character.progress.retired=!0,s.E.game.party.campaignMode&&(s.E.game.party.retirements.push(this.character.toModel()),s.E.characterManager.removeCharacter(this.character)),s.E.stateManager.after()))}personalQuestRequirementUnlocked(n){return null!=this.personalQuest&&null!=this.personalQuest.requirements[n]&&this.personalQuest.requirements[n].requires&&this.personalQuest.requirements[n].requires.every(i=>this.personalQuest&&this.character.progress.personalQuestProgress[i-1]>=(0,A.hZ)(this.personalQuest.requirements[i-1].counter))}setExtraPerks(n){!isNaN(+n.target.value)&&this.character.progress.extraPerks!=+n.target.value&&(s.E.stateManager.before("setExtraPerks",s.E.characterManager.characterName(this.character),n.target.value),this.character.progress.extraPerks=+n.target.value,s.E.stateManager.after())}setRetirements(n){!isNaN(+n.target.value)&&this.character.progress.retirements!=+n.target.value&&(s.E.stateManager.before("setRetirements",s.E.characterManager.characterName(this.character),n.target.value),this.character.progress.retirements=+n.target.value,s.E.stateManager.after())}setPlayerNumber(n){if(!isNaN(+n.target.value)&&this.character.number!=+n.target.value&&+n.target.value>0){s.E.stateManager.before("setPlayerNumber",s.E.characterManager.characterName(this.character),n.target.value);const i=s.E.game.figures.find(e=>e instanceof H.K&&e.number==+n.target.value);i&&(i.number=this.character.number),this.character.number=+n.target.value,s.E.stateManager.after()}}setBattleGoals(n){this.character.progress.battleGoals==n&&n--,n<0?n=0:n>18&&(n=18),this.character.progress.battleGoals!=n&&(s.E.stateManager.before("setBG",s.E.characterManager.characterName(this.character),""+n),this.character.progress.battleGoals=n,s.E.stateManager.after())}setNotes(n){this.character.progress.notes!=n.target.value&&(s.E.stateManager.before("setNotes",s.E.characterManager.characterName(this.character),n.target.value),this.character.progress.notes=n.target.value,s.E.stateManager.after())}toggleMastery(n){this.character.progress.masteries||(this.character.progress.masteries=[]),this.character.progress.masteries.includes(n)?(s.E.stateManager.before("removeMastery",s.E.characterManager.characterName(this.character),""+n),this.character.progress.masteries.splice(this.character.progress.masteries.indexOf(n),1)):(s.E.stateManager.before("addMastery",s.E.characterManager.characterName(this.character),""+n),this.character.progress.masteries.push(n)),s.E.stateManager.after()}togglePerk(n,i=!1){let e=this.character.progress.perks[n]+1;e>this.character.perks[n].count&&(e=0),!i&&0==this.availablePerks&&0!=e&&this.character.progress.perks[n]&&(e=this.character.progress.perks[n]-1),!i&&(s.E.game.state!=D.mk.draw||s.E.game.round>0||0==this.availablePerks&&!this.character.progress.perks[n])&&e>1&&(e=0),this.addPerk(n,e,i)}addPerk(n,i,e=!1){if(!(!this.forceEdit&&(s.E.game.state!=D.mk.draw||s.E.game.round>0)||this.character.progress.perks[n]<i&&this.availablePerks<i-this.character.progress.perks[n])||e&&!p.f.settings.characterSheetLocked&&this.editable){s.E.stateManager.before("setPerk",s.E.characterManager.characterName(this.character),""+n,""+i);const g="shackles"==this.character.name&&"fh"==this.character.edition&&11==n&&2==this.character.progress.perks[n];this.character.progress.perks[n]&&this.character.progress.perks[n]==i?this.character.progress.perks[n]--:this.character.progress.perks[n]=i,this.character.perks[n].monsterDeck?(s.E.game.monsterAttackModifierDeck=s.E.attackModifierManager.buildMonsterAttackModifierDeck(),s.E.attackModifierManager.shuffleModifiers(s.E.game.monsterAttackModifierDeck)):(s.E.attackModifierManager.mergeAttackModifierDeck(this.character.attackModifierDeck,s.E.attackModifierManager.buildCharacterAttackModifierDeck(this.character)),s.E.attackModifierManager.shuffleModifiers(this.character.attackModifierDeck),"shackles"==this.character.name&&"fh"==this.character.edition&&11==n&&(2==this.character.progress.perks[n]?this.character.maxHealth+=5:g&&(this.character.maxHealth-=5),this.character.health=this.character.maxHealth)),s.E.stateManager.after()}}moveResources(){this.dialog.open(Ni,{panelClass:["dialog"],data:{character:this.character}})}exportCharacter(){const n=document.createElement("a");n.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(this.character.toModel()))),n.setAttribute("download",(this.character.title?this.character.title+"_":"")+this.character.name+".json"),document.body.appendChild(n),n.click(),document.body.removeChild(n)}importCharacter(n){const i=n.target.parentElement;i.classList.remove("error");try{const e=new FileReader;e.addEventListener("load",o=>{const g=Object.assign(new H.K(this.character,this.character.level).toModel(),JSON.parse(o.target.result));g.name!=this.character.name||g.edition!=this.character.edition?i.classList.add("error"):(s.E.stateManager.before("importCharacter",s.E.characterManager.characterName(this.character)),this.character.fromModel(g),s.E.stateManager.after())}),e.readAsText(n.target.files[0])}catch(e){console.warn(e),i.classList.add("error")}}setAside(){s.E.stateManager.before("characterSetAside",s.E.characterManager.characterName(this.character,!0,!0),s.E.game.party.players[this.character.number-1]?s.E.game.party.players[this.character.number-1]:""+this.character.number),s.E.game.party.availableCharacters=s.E.game.party.availableCharacters||[],s.E.game.party.availableCharacters.push(this.character.toModel()),s.E.characterManager.removeCharacter(this.character),s.E.stateManager.after(),this.dialogRef&&(0,F.co)(this.dialogRef)}replay(){this.replayable&&(s.E.stateManager.before("characterReplay",s.E.characterManager.characterName(this.character,!0,!0),s.E.game.party.players[this.character.number-1]?s.E.game.party.players[this.character.number-1]:""+this.character.number),s.E.game.party.availableCharacters=s.E.game.party.availableCharacters.filter(n=>n.name!=this.character.name||n.edition!=this.character.edition||n.number!=this.character.number),s.E.game.figures.forEach(n=>{n instanceof H.K&&n.number==this.character.number&&(s.E.game.party.availableCharacters.push(n.toModel()),s.E.characterManager.removeCharacter(n))}),s.E.game.figures.push(this.character),s.E.stateManager.after(),this.dialogRef&&(0,F.co)(this.dialogRef))}toggleFhSheet(){this.fhSheet=!this.fhSheet,this.gh2eSheet=!this.gh2eSheet&&!s.E.fhRules()&&s.E.fhRules(!0),this.csSheet=!this.fhSheet&&("cs"==this.character.edition||s.E.editionExtensions(this.character.edition).includes("cs"))}openAbilityCards(){this.dialog.open(Us,{panelClass:["dialog"],data:{character:this.character}})}statistics(){this.dialog.open(sr,{panelClass:["dialog-invert"],data:this.character})}openTrial(){this.character.progress.trial&&this.dialog.open(Os,{panelClass:["fullscreen-panel"],data:{edition:this.character.progress.trial.edition,trial:+this.character.progress.trial.name}})}setTrial(n){n.target.classList.add("error");let i=+n.target.value;if(p.f.settings.fhSecondEdition&&(i=s.E.trialsManager.cardIdSecondPrinting(i)),!this.character.progress.trial||this.character.progress.trial.name!=""+i){const e=s.E.editionData.find(o=>o.edition==s.E.currentEdition()&&o.trials&&o.trials.length);if(e&&e.trials.find(g=>g.cardId==i&&g.edition==s.E.currentEdition()))if(n.target.classList.remove("error"),n.target.classList.add("warning"),s.E.game.figures.find(g=>g instanceof H.K&&g.progress.trial&&g.progress.trial.edition==s.E.currentEdition()&&g.progress.trial.name==""+i))this.character.progress.trial&&(i=p.f.settings.fhSecondEdition?s.E.trialsManager.cardIdSecondPrinting(+this.character.progress.trial.name):+this.character.progress.trial.name,n.target.value=i);else{s.E.stateManager.before("setTrial",s.E.characterManager.characterName(this.character),n.target.value),this.character.progress.trial=new yt.gw(""+i,s.E.currentEdition());const g=Math.max(...s.E.game.figures.filter(m=>m instanceof H.K).map(m=>e.trials.find(k=>m.progress.trial&&k.cardId==+m.progress.trial.name&&k.edition==m.progress.trial.edition)).map(m=>m?e.trials.indexOf(m):-1));(!s.E.game.party.trials||s.E.game.party.trials!=g)&&(s.E.game.party.trials=g),n.target.classList.remove("warning"),s.E.stateManager.after()}}}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-character-sheet"]],viewQuery:function(i,e){if(1&i&&t.GBs(NR,5),2&i){let o;t.mGM(o=t.lsd())&&(e.titleInput=o.first)}},inputs:{character:"character",editable:"editable",forceEdit:"forceEdit",standalone:"standalone",dialogRef:"dialogRef"},standalone:!1,decls:115,vars:89,consts:[["charactertitle",""],["trialIndex",""],[1,"light","character-sheet",3,"ngClass"],[1,"container",3,"ngClass"],[1,"columns"],[1,"column","column-left"],[1,"row","title"],[3,"src"],[1,"headline",3,"ghs-label","ghs-label-attribute"],[1,"character-title"],[3,"ghs-label","ghs-label-args"],[1,"absent",3,"click","src","ghs-label","ghs-label-attribute"],[1,"row","base"],[1,"name"],[3,"ghs-label"],["type","text",3,"value"],[1,"level"],[1,"column"],["src","./assets/images/level.svg"],["src","./assets/images/experience.svg"],[1,"level-grid"],[1,"checkbox","level-item",3,"ngClass"],[1,"xp-item",3,"ngClass"],[1,"xp-gold-container"],[1,"row","xp-notes"],["type","number","min","0",3,"change","value"],[1,"row","gold-notes"],[1,"donations"],[1,"donate"],[1,"compact-separator"],[1,"row","resources"],[1,"row","notes"],[1,"row",3,"character"],[1,"row","masteries"],[1,"column","column-right"],[1,"row","perks"],[1,"headline"],[1,"list","ignore-denied",3,"ngClass"],[1,"perk"],[1,"warning",3,"ghs-label","ghs-label-attribute"],[1,"wip",3,"ghs-label","ghs-label-attribute"],[1,"row","battlegoals"],[1,"battlegoals-grid"],[1,"additional"],[1,"ignore-denied",3,"readOnly","value","ghs-label","ghs-label-attribute"],[3,"character"],[1,"column","column-right","notes"],[1,"spacer"],[1,"ignore-denied",3,"click","ghs-tooltip"],["src","./assets/images/stats.svg",1,"ghs-svg"],[1,"player-number"],["type","number","min","1",3,"change","keyup","value"],[1,"personal-quest"],[1,"retirements"],[1,"extra-perks"],["type","number","min","0",3,"change","keyup","value"],[1,"set-aside"],[1,"import-export"],[1,"export","ignore-denied",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/export.svg"],[1,"import",3,"click","ghs-label","ghs-label-attribute"],["type","file","accept","application/json",3,"change"],["src","./assets/images/import.svg"],[1,"toggle-fh-sheet","ignore-denied",3,"click"],[1,"ability-cards"],["type","text",3,"change","value"],[1,"checkbox","level-item",3,"click","ngClass"],[1,"xp-item",3,"click","ngClass"],["src","./assets/images/fh/loot.svg"],[3,"click","ngClass"],[1,"price"],["src","./assets/images/loot.svg"],[1,"move",3,"click"],[1,"resource-table"],[1,"materials"],[1,"resource","lumber"],["src","./assets/images/fh/loot/lumber.svg"],[1,"resource","metal"],["src","./assets/images/fh/loot/metal.svg"],[1,"resource","hide"],["src","./assets/images/fh/loot/hide.svg"],[1,"herbs"],[1,"resource","arrowvine"],["src","./assets/images/fh/loot/arrowvine.svg"],[1,"resource","axenut"],["src","./assets/images/fh/loot/axenut.svg"],[1,"resource","corpsecap"],["src","./assets/images/fh/loot/corpsecap.svg"],[1,"resource","flamefruit"],["src","./assets/images/fh/loot/flamefruit.svg"],[1,"resource","rockroot"],["src","./assets/images/fh/loot/rockroot.svg"],[1,"resource","snowthistle"],["src","./assets/images/fh/loot/snowthistle.svg"],[1,"traits"],[1,"ignore-denied",3,"change","readOnly","value","ghs-label","ghs-label-attribute"],[1,"icon"],["src","./assets/images/fh/character/traits/trait.svg",1,"ghs-svg"],[1,"trait",3,"ghs-label"],[1,"divider"],[1,"masteries-list"],[1,"mastery"],[1,"checkmark"],["src","./assets/images/close.svg"],[1,"mastery-check","checkbox",3,"click","ngClass"],[1,"placeholder","text",3,"ghs-label"],[1,"checkboxes",3,"ngClass"],["ghs-pointer-input","",1,"checkbox",3,"ngClass"],["ghs-pointer-input","",3,"singleClick","doubleClick","ngClass","perk"],["ghs-pointer-input","",1,"checkbox",3,"singleClick","doubleClick","ngClass"],["src","./assets/images/warning.svg",1,"ghs-svg"],[1,"battlegoal","checkbox",3,"click","ngClass"],[1,"personal-quest-card"],["type","text",1,"card-id",3,"change","value"],["ghs-pointer-input","",1,"retire-button",3,"ngClass"],[1,"personal-quest-name"],[1,"trial"],[1,"requirements"],[1,"rewards"],["ghs-pointer-input","",1,"retire-button",3,"singleClick","doubleClick","ngClass"],["src","./assets/images/trophy.svg",1,"ghs-svg"],[1,"trial-card"],["type","text",1,"card-id",3,"change","keyup","value"],[1,"open","ignore-denied"],[1,"open","ignore-denied",3,"click"],["src","./assets/images/fh/trials/trial.png"],[1,"requirement",3,"ngClass"],[1,"requirement-name"],[1,"counter"],["type","number","min","0",3,"value","max"],[1,"checkbox",3,"ngClass","ghs-label","ghs-label-attribute"],[1,"checkbox",3,"click","ngClass","ghs-label","ghs-label-attribute"],["type","number","min","0",3,"change","value","max"],[1,"reward",3,"ghs-label","ghs-label-args"],[3,"click"],["src","./assets/images/long-rest.svg"],[1,"ignore-denied",3,"click"],[1,"ability-cards",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6),t.nrm(5,"img",7),t.j41(6,"label",8)(7,"div",9),t.nrm(8,"span",10),t.k0s(),t.j41(9,"img",11),t.bIt("click",function(){return e.toggleCharacterAbsent()}),t.k0s()()(),t.j41(10,"div",12)(11,"div",13)(12,"label"),t.nrm(13,"span",14),t.EFF(14,":"),t.k0s(),t.nVh(15,KR,2,1,"input",15),t.nVh(16,ZR,3,4),t.k0s(),t.j41(17,"div",16)(18,"div",4)(19,"div",17)(20,"label"),t.nrm(21,"span",14)(22,"img",18),t.EFF(23,":"),t.k0s(),t.j41(24,"label"),t.nrm(25,"span",14)(26,"img",19),t.EFF(27,":"),t.k0s()(),t.j41(28,"div",17)(29,"div",20),t.Z7z(30,JR,2,4,"div",21,t.fX1),t.nI1(32,"ghsRange"),t.Z7z(33,QR,2,4,"div",22,t.fX1),t.nI1(35,"ghsRange"),t.k0s()()()()(),t.j41(36,"div",23)(37,"div",24)(38,"label"),t.nrm(39,"span",14)(40,"img",19),t.nVh(41,tj,2,1,"span"),t.EFF(42,":"),t.k0s(),t.j41(43,"input",25),t.bIt("change",function(g){return e.setXP(g)}),t.k0s()(),t.j41(44,"div",26),t.nVh(45,nj,3,1,"label"),t.nVh(46,ej,4,1,"label"),t.j41(47,"input",25),t.bIt("change",function(g){return e.setGold(g)}),t.k0s(),t.nVh(48,aj,2,4,"span",27),t.nVh(49,ij,7,5,"span",28),t.k0s()(),t.nVh(50,oj,1,0,"hr",29),t.nVh(51,sj,36,11,"div",30),t.nrm(52,"hr",29),t.nVh(53,gj,6,6,"div",31),t.nVh(54,dj,1,1,"ghs-character-items",32),t.nVh(55,hj,1,0,"hr",29),t.nVh(56,mj,7,1,"div",33),t.k0s(),t.j41(57,"div",34),t.nVh(58,pj,1,0,"hr",29),t.j41(59,"div",35),t.nVh(60,uj,2,1,"label",36),t.j41(61,"div",37),t.Z7z(62,Cj,6,11,"div",38,_r),t.nI1(64,"trackUUID"),t.k0s(),t.nVh(65,Mj,3,3,"div",39),t.nVh(66,vj,3,3,"div",40),t.k0s(),t.j41(67,"div",41),t.nVh(68,Oj,2,1,"label",36),t.nVh(69,Pj,2,1,"label",36),t.j41(70,"div",42),t.Z7z(71,kj,2,4,null,null,t.fX1),t.nI1(73,"ghsRange"),t.k0s()(),t.nVh(74,yj,1,0,"hr",29),t.k0s()(),t.j41(75,"div",43),t.nrm(76,"hr",29),t.nVh(77,xj,2,1,"label",36),t.j41(78,"div",4)(79,"div",5),t.nVh(80,Ej,1,4,"textarea",44),t.nVh(81,wj,1,1,"ghs-character-items",45),t.k0s(),t.j41(82,"div",46)(83,"div",13),t.nVh(84,Rj,2,0,"span"),t.nVh(85,jj,2,1,"span"),t.nrm(86,"span",47),t.j41(87,"a",48),t.bIt("click",function(){return e.statistics()}),t.nrm(88,"img",49),t.k0s()(),t.j41(89,"div",50)(90,"label"),t.nrm(91,"span",14),t.EFF(92,":"),t.k0s(),t.j41(93,"input",51),t.bIt("change",function(g){return e.setPlayerNumber(g)})("keyup",function(g){return e.setPlayerNumber(g)}),t.k0s()(),t.nVh(94,Lj,12,8,"div",52),t.nVh(95,qj,5,2,"div",53),t.j41(96,"div",54)(97,"label"),t.nrm(98,"span",14),t.EFF(99,":"),t.k0s(),t.j41(100,"input",55),t.bIt("change",function(g){return e.setExtraPerks(g)})("keyup",function(g){return e.setExtraPerks(g)}),t.k0s()(),t.nVh(101,Hj,4,1,"div",56),t.nVh(102,Kj,4,1,"div",56),t.nrm(103,"hr",29),t.j41(104,"div",57)(105,"label",58),t.bIt("click",function(){return e.exportCharacter()}),t.nrm(106,"img",59)(107,"span",14),t.k0s(),t.j41(108,"label",60),t.bIt("click",function(){return e.ghsInputFullScreenCheck()}),t.j41(109,"input",61),t.bIt("change",function(g){return e.importCharacter(g)}),t.k0s(),t.nrm(110,"img",62)(111,"span",14),t.k0s()(),t.j41(112,"span",63),t.bIt("click",function(){return e.toggleFhSheet()}),t.nrm(113,"span",14),t.k0s()()()()(),t.nVh(114,Wj,1,0,"div",64),t.k0s()),2&i&&(t.xc7("--ghs-character-color",e.character.color),t.Y8G("ngClass",t.ziG(72,zR,e.csSheet,e.fhSheet,e.gh2eSheet,e.settingsManager.settings.characterSheetCompact)),t.R7$(),t.Y8G("ngClass",t.l_i(77,dr,!e.forceEdit&&(!e.editable||!e.gameManager.stateManager.characterPermissions[e.character.name+"|"+e.character.edition])||e.settingsManager.settings.characterSheetLocked,!e.forceEdit&&!e.editable||e.settingsManager.settings.characterSheetLocked)),t.R7$(4),t.Y8G("src",e.character.iconUrl,t.B4B),t.R7$(),t.Y8G("ghs-label",e.character.absent?"character.absent":"character.present")("ghs-label-attribute","title"),t.R7$(2),t.Y8G("ghs-label","character.progress.title")("ghs-label-args",t.l_i(80,LR,"data.character."+e.character.edition+"."+e.character.name,e.character.characterClass?"character.class."+(e.character.gender?e.character.gender+".":"")+e.character.characterClass:"")),t.R7$(),t.Y8G("src","./assets/images/status/"+(e.character.absent?"absent":"present")+".svg",t.B4B)("ghs-label",e.character.absent?"character.present":"character.absent")("ghs-label-attribute","title"),t.R7$(4),t.Y8G("ghs-label","character.progress.name"),t.R7$(2),t.vxM(0!=e.titles.length&&e.settingsManager.settings.characterIdentities?-1:15),t.R7$(),t.vxM(e.titles.length>0&&e.settingsManager.settings.characterIdentities?16:-1),t.R7$(5),t.Y8G("ghs-label","character.progress.level"),t.R7$(4),t.Y8G("ghs-label","character.progress.xp"),t.R7$(5),t.Dyx(t.i5U(32,61,t.lJ4(83,je),9)),t.R7$(3),t.Dyx(t.i5U(35,64,t.lJ4(84,je),9)),t.R7$(6),t.Y8G("ghs-label","character.progress.xp"),t.R7$(2),t.vxM(e.fhSheet?-1:41),t.R7$(2),t.Y8G("value",e.character.progress.experience),t.R7$(2),t.vxM(e.fhSheet?-1:45),t.R7$(),t.vxM(e.fhSheet?46:-1),t.R7$(),t.Y8G("value",e.character.progress.gold),t.R7$(),t.vxM(e.donations?48:-1),t.R7$(),t.vxM(e.donations?49:-1),t.R7$(),t.vxM(e.fhSheet?50:-1),t.R7$(),t.vxM(e.fhSheet&&!e.gh2eSheet?51:-1),t.R7$(2),t.vxM(e.fhSheet?53:-1),t.R7$(),t.vxM(e.fhSheet?-1:54),t.R7$(),t.vxM(e.fhSheet?55:-1),t.R7$(),t.vxM(e.fhSheet?56:-1),t.R7$(2),t.vxM(e.fhSheet?-1:58),t.R7$(2),t.vxM(e.fhSheet?-1:60),t.R7$(),t.Y8G("ngClass",t.l_i(85,dr,!e.editable||e.settingsManager.settings.characterSheetLocked||!e.gameManager.stateManager.characterPermissions[e.character.name+"|"+e.character.edition],!e.editable||e.settingsManager.settings.characterSheetLocked)),t.R7$(),t.Dyx(t.bMT(64,67,e.character.perks)),t.R7$(3),t.vxM(e.availablePerks<0?65:-1),t.R7$(),t.vxM(e.character.perkWarning?66:-1),t.R7$(2),t.vxM(e.fhSheet||e.csSheet?-1:68),t.R7$(),t.vxM(e.fhSheet?69:-1),t.R7$(2),t.Dyx(t.i5U(73,69,t.lJ4(88,je),18)),t.R7$(3),t.vxM(e.fhSheet?74:-1),t.R7$(3),t.vxM(e.settingsManager.settings.characterSheetCompact&&e.fhSheet?-1:77),t.R7$(3),t.vxM(e.fhSheet?-1:80),t.R7$(),t.vxM(e.fhSheet?81:-1),t.R7$(3),t.vxM(0==e.character.number||e.character.number>e.gameManager.game.party.players.length||!e.gameManager.game.party.players[e.character.number-1]?84:-1),t.R7$(),t.vxM(e.character.number>0&&e.character.number<=e.gameManager.game.party.players.length&&e.gameManager.game.party.players[e.character.number-1]?85:-1),t.R7$(2),t.Y8G("ghs-tooltip","scenario.stats"),t.R7$(4),t.Y8G("ghs-label","character.playerNumber"),t.R7$(2),t.Y8G("value",e.character.number),t.R7$(),t.vxM(e.gameManager.editionRules("jotl")?-1:94),t.R7$(),t.vxM(e.gameManager.editionRules("jotl")?-1:95),t.R7$(3),t.Y8G("ghs-label","character.progress.perks.extra"),t.R7$(2),t.Y8G("value",e.character.progress.extraPerks),t.R7$(),t.vxM(e.editable&&e.settingsManager.settings.partySheet&&!e.gameManager.game.scenario?101:-1),t.R7$(),t.vxM(e.replayable&&e.settingsManager.settings.partySheet?102:-1),t.R7$(3),t.Y8G("ghs-label","character.progress.export")("ghs-label-attribute","title"),t.R7$(2),t.Y8G("ghs-label","character.progress.export"),t.R7$(),t.Y8G("ghs-label","character.progress.import")("ghs-label-attribute","title"),t.R7$(3),t.Y8G("ghs-label","character.progress.import"),t.R7$(2),t.Y8G("ghs-label","character.progress.fh."+(e.fhSheet?"disable":"enable")),t.R7$(),t.vxM(e.hasAbilities?114:-1))},dependencies:[N.YU,FR,it,Mt,gr,dt,At,ct],styles:['.character-sheet{position:relative;background-color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.character-sheet .denied.view-only{cursor:initial!important}.character-sheet .container{width:calc(var(--ghs-unit) * 62 * var(--ghs-dialog-factor));height:100%;background-image:url(character-sheet.70b336945f4b7a49.svg);background-position:top center;background-repeat:no-repeat;background-size:contain;padding-left:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor))}.character-sheet .container .compact-separator{display:none}.character-sheet .container .columns{display:flex}.character-sheet .container .columns .column{display:flex;flex-direction:column}.character-sheet .container .columns .column.column-left{width:calc(var(--ghs-unit) * 33 * var(--ghs-dialog-factor))}.character-sheet .container .columns .column.column-right{margin-left:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 25 * var(--ghs-dialog-factor))}.character-sheet .container .columns .column .row{display:flex}.character-sheet .container label{display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));white-space:nowrap}.character-sheet .container label img{width:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));height:auto;margin:0 calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.character-sheet .container label.headline{width:100%;justify-content:center}.character-sheet .container label.headline.absent{text-decoration:line-through}.character-sheet .container .title{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor))}.character-sheet .container .title img{width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:auto}.character-sheet .container .title label{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));padding-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));overflow:hidden}.character-sheet .container .title label .character-title{display:table;align-self:center}.character-sheet .container .title label .absent{cursor:pointer}.character-sheet .container .base{flex-direction:column;height:calc(var(--ghs-unit) * 10 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.character-sheet .container .base .level-grid{margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));display:grid;grid-template-columns:repeat(9,1fr)}.character-sheet .container .base .level-grid .level-item{cursor:pointer;position:relative;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);margin-left:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor));z-index:2}.character-sheet .container .base .level-grid .level-item.checked:before{opacity:.8}.character-sheet .container .base .level-grid .xp-item{cursor:pointer;position:relative;display:flex;justify-content:center;align-items:flex-end;width:calc(var(--ghs-unit) * 2.8 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));border-right:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);margin-top:calc(var(--ghs-unit) * -1 * var(--ghs-dialog-factor))}.character-sheet .container .base .level-grid .xp-item:last-child{border-right:none}.character-sheet .container .base .level-grid .xp-item:before{content:" ";position:absolute;top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));background-image:url(initiative.a7663b57012bb669.svg);background-position:center;background-repeat:no-repeat;background-size:contain}.character-sheet .container .base .level-grid .xp-item.checked:after{content:" ";position:absolute;top:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));clip-path:polygon(10% 100%,25% 100%,85% 0,70% 0);background-color:var(--ghs-color-black)}.character-sheet .container .xp-gold-container{display:flex;flex-direction:column}.character-sheet .container .xp-notes,.character-sheet .container .gold-notes{flex-direction:column;height:calc(var(--ghs-unit) * 10 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.character-sheet .container .gold-notes .donations{display:flex;align-items:center;line-height:.5em;margin-top:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor))}.character-sheet .container .gold-notes .donate{display:flex;align-items:center}.character-sheet .container .gold-notes .donate a{display:flex;align-items:center;cursor:pointer;color:var(--ghs-color-darkgray);margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet .container .gold-notes .donate a:hover{color:var(--ghs-color-black)}.character-sheet .container .gold-notes .donate a.disabled{pointer-events:none;color:var(--ghs-color-gray)}.character-sheet .container .gold-notes .donate a .price{display:flex;align-items:center;color:var(--ghs-color-yellow);margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet .container .gold-notes .donate a .price img{margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));filter:var(--ghs-filter-yellow);width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.character-sheet .container .notes,.character-sheet .container ghs-character-items{height:calc(var(--ghs-unit) * 34 * var(--ghs-dialog-factor));width:100%;margin-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.character-sheet .container .notes .items,.character-sheet .container ghs-character-items .items{width:100%}.character-sheet .container .notes .item-list,.character-sheet .container ghs-character-items .item-list{height:calc(var(--ghs-unit) * 27 * var(--ghs-dialog-factor));max-height:calc(var(--ghs-unit) * 27 * var(--ghs-dialog-factor));overflow:auto}.character-sheet .container .perks{flex-direction:column;height:calc(var(--ghs-unit) * 67 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet .container .perks .list{display:flex;flex-direction:column;height:calc(var(--ghs-unit) * 63.5 * var(--ghs-dialog-factor));overflow-y:auto}.character-sheet .container .perks .list .perk{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 1.9 * var(--ghs-dialog-factor) * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor) * var(--ghs-text-factor));margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));display:flex}.character-sheet .container .perks .list .perk .checkboxes{display:flex}.character-sheet .container .perks .list .perk .checkboxes .checkbox{margin-top:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor) * var(--ghs-text-factor) * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor) * var(--ghs-text-factor) * var(--ghs-text-factor))}.character-sheet .container .perks .list .perk .checkboxes .checkbox.disabled{pointer-events:initial;cursor:not-allowed}.character-sheet .container .perks .list .perk .checkboxes.combined{flex-direction:column;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet .container .perks .list .perk .checkboxes.combined .checkbox{border-top-style:dashed;border-bottom-style:dashed;margin:0}.character-sheet .container .perks .list .perk .checkboxes.combined .checkbox:nth-child(1){border-top-style:solid}.character-sheet .container .perks .list .perk .checkboxes.combined .checkbox:nth-last-child(1){border-bottom-style:solid}.character-sheet .container .perks .list .perk ghs-perk-label{cursor:pointer}.character-sheet .container .perks .list .perk ghs-perk-label.disabled{cursor:initial}.character-sheet .container .perks .wip,.character-sheet .container .perks .warning{flex-basis:0}.character-sheet .container .battlegoals{flex-direction:column;height:calc(var(--ghs-unit) * 9 * var(--ghs-dialog-factor))}.character-sheet .container .battlegoals .battlegoals-grid{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));display:grid;grid-template-columns:repeat(12,1fr);align-items:center}.character-sheet .container .battlegoals .battlegoals-grid img{width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));height:auto}.character-sheet .container .battlegoals .battlegoals-grid .battlegoal{width:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.character-sheet .container .battlegoals .battlegoals-grid .checkmark{height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));display:flex;align-items:center}.character-sheet .container .personal-quest{flex-direction:column}.character-sheet .container .personal-quest .personal-quest-card{display:flex;align-items:center}.character-sheet .container .personal-quest .personal-quest-card .card-id{text-align:right;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor) * var(--ghs-text-factor));min-width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor) * var(--ghs-text-factor))}.character-sheet .container .personal-quest .personal-quest-card .personal-quest-name{font-family:var(--ghs-font-title)}.character-sheet .container .personal-quest .requirements{display:flex;flex-direction:column;margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.character-sheet .container .personal-quest .requirements .requirement{display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet .container .personal-quest .requirements .requirement.disabled{pointer-events:none;opacity:.7}.character-sheet .container .personal-quest .requirements .requirement .requirement-name{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.character-sheet .container .personal-quest .requirements .requirement .counter{display:flex;align-items:center;flex-grow:1}.character-sheet .container .personal-quest .requirements .requirement .counter .checkbox{margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet .container .personal-quest .requirements .requirement .counter input[type=number]{margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor) * var(--ghs-text-factor));min-width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor) * var(--ghs-text-factor));flex-grow:1;text-align:right;border:none;border-bottom-width:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor));border-bottom-style:solid;border-bottom-color:var(--ghs-color-gray)}.character-sheet .container .personal-quest .rewards{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-black)}.character-sheet .container .personal-quest .retire-button{cursor:pointer;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));display:flex;align-items:center}.character-sheet .container .personal-quest .retire-button:hover{opacity:.7}.character-sheet .container .personal-quest .retire-button.disabled{cursor:initial;color:var(--ghs-color-gray)}.character-sheet .container .personal-quest .retire-button.disabled .ghs-svg{filter:var(--ghs-filter-gray)}.character-sheet .container .trial{flex-direction:column}.character-sheet .container .trial .trial-card{display:flex;align-items:center}.character-sheet .container .trial .trial-card .card-id{text-align:right;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor) * var(--ghs-text-factor));min-width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor) * var(--ghs-text-factor))}.character-sheet .container .trial .trial-card .open{cursor:pointer}.character-sheet .container .trial .trial-card .open img{width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:auto}.character-sheet .container .notes{display:flex;flex-direction:column;height:calc(var(--ghs-unit) * 15 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor))}.character-sheet .container .notes .columns{margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));flex-grow:1}.character-sheet .container .notes .column-right{justify-content:space-between}.character-sheet .container .notes .name{display:flex;justify-content:initial;align-items:center}.character-sheet .container .notes .name a{cursor:pointer}.character-sheet .container .notes .name a:hover{opacity:.7}.character-sheet .container .notes .personal-quest,.character-sheet .container .notes .trial,.character-sheet .container .notes .extra-perks,.character-sheet .container .notes .retirements,.character-sheet .container .notes .player-number,.character-sheet .container .notes .set-aside{margin-top:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor));display:flex;align-items:center}.character-sheet .container .notes .personal-quest label,.character-sheet .container .notes .trial label,.character-sheet .container .notes .extra-perks label,.character-sheet .container .notes .retirements label,.character-sheet .container .notes .player-number label,.character-sheet .container .notes .set-aside label{flex-shrink:0;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.character-sheet .container .notes .personal-quest input[type=number],.character-sheet .container .notes .trial input[type=number],.character-sheet .container .notes .extra-perks input[type=number],.character-sheet .container .notes .retirements input[type=number],.character-sheet .container .notes .player-number input[type=number],.character-sheet .container .notes .set-aside input[type=number]{flex-grow:1;flex-basis:0;min-width:auto}.character-sheet .container .notes .personal-quest .checkbox,.character-sheet .container .notes .trial .checkbox,.character-sheet .container .notes .extra-perks .checkbox,.character-sheet .container .notes .retirements .checkbox,.character-sheet .container .notes .player-number .checkbox,.character-sheet .container .notes .set-aside .checkbox{flex-shrink:0;margin-left:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor))}.character-sheet .container .notes .personal-quest.set-aside label,.character-sheet .container .notes .trial.set-aside label,.character-sheet .container .notes .extra-perks.set-aside label,.character-sheet .container .notes .retirements.set-aside label,.character-sheet .container .notes .player-number.set-aside label,.character-sheet .container .notes .set-aside.set-aside label{cursor:pointer;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor))}.character-sheet .container .notes .personal-quest.set-aside label:hover,.character-sheet .container .notes .trial.set-aside label:hover,.character-sheet .container .notes .extra-perks.set-aside label:hover,.character-sheet .container .notes .retirements.set-aside label:hover,.character-sheet .container .notes .player-number.set-aside label:hover,.character-sheet .container .notes .set-aside.set-aside label:hover{opacity:.7}.character-sheet .container .notes .personal-quest.personal-quest,.character-sheet .container .notes .personal-quest.trial,.character-sheet .container .notes .trial.personal-quest,.character-sheet .container .notes .trial.trial,.character-sheet .container .notes .extra-perks.personal-quest,.character-sheet .container .notes .extra-perks.trial,.character-sheet .container .notes .retirements.personal-quest,.character-sheet .container .notes .retirements.trial,.character-sheet .container .notes .player-number.personal-quest,.character-sheet .container .notes .player-number.trial,.character-sheet .container .notes .set-aside.personal-quest,.character-sheet .container .notes .set-aside.trial{align-items:flex-start}.character-sheet .container .import-export{display:flex;justify-content:space-around}.character-sheet .container .import-export label{cursor:pointer}.character-sheet .container .import-export label input[type=file]{width:0;height:0;margin:0;padding:0;visibility:hidden}.character-sheet .container .import-export label:hover{opacity:.7}.character-sheet .container .wip,.character-sheet .container .warning{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));display:flex;justify-content:center;align-items:center;color:var(--ghs-color-red)}.character-sheet .container .wip.warning,.character-sheet .container .warning.warning{color:var(--ghs-color-yellow)}.character-sheet .container .wip img,.character-sheet .container .warning img{width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:auto;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));filter:var(--ghs-filter-red)}.character-sheet .container .wip.warning img,.character-sheet .container .warning.warning img{filter:var(--ghs-filter-yellow)}.character-sheet .container .checkbox{cursor:pointer;position:relative;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);border-radius:calc(var(--ghs-unit) * .15 * var(--ghs-dialog-factor));box-shadow:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * .15 * var(--ghs-dialog-factor)) var(--ghs-color-gray);z-index:2}.character-sheet .container .checkbox:before{content:" ";position:absolute;left:50%;top:50%;width:115%;height:115%;transform:scale(0);transform-origin:top left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;z-index:1;background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;filter:var(--ghs-filter-darkgray)}.character-sheet .container .checkbox.checked:before{transform:scale(1) translate(-50%,-50%)}.character-sheet .container .checkbox.checked.check:before{transform:scale(1)}.character-sheet .container .checkbox.disabled{top:calc(var(--ghs-unit) * .15 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * .15 * var(--ghs-dialog-factor));pointer-events:none;border-color:var(--ghs-color-gray);box-shadow:none}.character-sheet .container input[type=text]{margin:0;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));color:var(--ghs-color-black);background-color:transparent;border:none;border-bottom-width:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor));border-bottom-style:solid;border-bottom-color:var(--ghs-color-gray);user-select:auto;-webkit-user-select:auto;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.character-sheet .container input[type=number]{margin:0;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));color:var(--ghs-color-black);background-color:transparent;border:none;user-select:auto;-webkit-user-select:auto;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor))}.character-sheet .container textarea{color:var(--ghs-color-black);background-color:transparent;border:none;user-select:auto;-webkit-user-select:auto;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));width:100%;height:100%}.character-sheet .container .name{display:flex;align-items:center}.character-sheet .container .name img{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:auto}.character-sheet .container .name input[type=text]{min-width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.character-sheet.cs-sheet .container{background-image:url(character-sheet.00b73de5eb36d58f.svg)}.character-sheet.cs-sheet .columns .column.column-right .perks{margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 70 * var(--ghs-dialog-factor))}.character-sheet.cs-sheet .columns .column.column-right .perks .list{height:calc(var(--ghs-unit) * 69.5 * var(--ghs-dialog-factor))}.character-sheet .additional{margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet .additional .headline{margin-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .container{background-image:url(character-sheet.546b1024f4246598.svg)}.character-sheet.fh-sheet .xp-gold-container{display:grid;grid-template-columns:1fr 1fr;column-gap:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .xp-gold-container .xp-notes,.character-sheet.fh-sheet .xp-gold-container .gold-notes{margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .notes{position:relative;height:calc(var(--ghs-unit) * 11 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .notes .traits{position:relative;display:flex;justify-content:space-evenly;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor));flex-grow:1}.character-sheet.fh-sheet .notes .traits .icon{width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .notes .traits .icon .ghs-svg{height:100%;width:auto}.character-sheet.fh-sheet ghs-character-items{margin-top:0;height:auto}.character-sheet.fh-sheet ghs-character-items .item-list{height:auto!important}.character-sheet.fh-sheet .resources{position:relative;height:calc(var(--ghs-unit) * 19 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));flex-direction:column}.character-sheet.fh-sheet .resources .move{cursor:pointer;position:absolute;top:0;right:0;color:var(--ghs-color-black)}.character-sheet.fh-sheet .resources .move:hover{opacity:.5}.character-sheet.fh-sheet .resources .resource-table{display:flex;flex-direction:column;margin-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .resources .resource-table .resource{display:flex;padding:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .resources .resource-table .resource img{width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:auto}.character-sheet.fh-sheet .resources .resource-table .resource input{min-width:0;flex-grow:1}.character-sheet.fh-sheet .resources .resource-table .materials{display:grid;grid-template-columns:repeat(3,calc(var(--ghs-unit) * 11.1 * var(--ghs-dialog-factor)))}.character-sheet.fh-sheet .resources .resource-table .materials .resource{flex-direction:column;height:calc(var(--ghs-unit) * 5.5 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .resources .resource-table .materials .resource input{width:100%;margin-left:0}.character-sheet.fh-sheet .resources .resource-table .herbs{display:grid;grid-template-columns:repeat(3,calc(var(--ghs-unit) * 11.1 * var(--ghs-dialog-factor)))}.character-sheet.fh-sheet .resources .resource-table .herbs .resource{height:calc(var(--ghs-unit) * 4.7 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .masteries{height:calc(var(--ghs-unit) * 14 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));display:flex;flex-direction:column;overflow:auto}.character-sheet.fh-sheet .masteries .mastery{display:flex}.character-sheet.fh-sheet .masteries .mastery .mastery-check{flex-shrink:0;width:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .masteries .mastery .checkmark{flex-shrink:0;height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));display:flex;align-items:center}.character-sheet.fh-sheet .masteries .mastery .checkmark img{width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));height:auto}.character-sheet.fh-sheet .masteries .mastery .text{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 1.9 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .columns .column.column-right{flex-direction:column-reverse}.character-sheet.fh-sheet .columns .column.column-right .battlegoals{margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .columns .column.column-right .perks{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 65 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .columns .column.column-right .perks .list{height:calc(var(--ghs-unit) * 65 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .notes,.character-sheet.fh-sheet .additional{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .notes .columns .column.column-right,.character-sheet.fh-sheet .additional .columns .column.column-right{flex-direction:column;justify-content:flex-start}.character-sheet.gh2e-sheet .container{background-image:url(character-sheet.a4c938b6ef4aae81.svg)}.character-sheet.gh2e-sheet .columns .column.column-right .battlegoals{position:relative;top:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor))}.character-sheet.gh2e-sheet .columns .column.column-right .battlegoals .battlegoals-grid{margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet.gh2e-sheet .notes{position:relative;margin-top:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 30 * var(--ghs-dialog-factor))}.character-sheet.compact .container{background-image:none;width:initial;max-width:calc(var(--ghs-unit) * 50 * var(--ghs-dialog-factor))}.character-sheet.compact .container .compact-separator{display:block;width:100%;margin:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor)) 0}.character-sheet.compact .container label.headline{justify-content:flex-start}.character-sheet.compact .container .checkbox{width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor) * var(--ghs-text-factor))!important;height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor) * var(--ghs-text-factor))!important}.character-sheet.compact .container input[type=number],.character-sheet.compact .container input[type=text]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor) * var(--ghs-text-factor))}.character-sheet.compact .container .notes{height:initial}.character-sheet.compact .container .columns{flex-direction:column}.character-sheet.compact .container .columns .column{width:auto!important;justify-content:center}.character-sheet.compact .container .columns .column.column-right{margin-left:0!important}.character-sheet.compact .container .columns .column .xp-gold-container{display:flex;flex-direction:column}.character-sheet.compact .container .columns .column .xp-gold-container .row{flex-direction:row}.character-sheet.compact .container .columns .column .xp-gold-container .row .donate{margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet.compact .container .columns .column .row{height:auto!important;margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))!important}.character-sheet.compact .container .columns .column .row.perks .list{height:auto!important;overflow-y:initial}.character-sheet.compact .container .columns .column .row.perks .list .perk{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor) * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor) * var(--ghs-text-factor))}.character-sheet.compact .container .columns .column .row label.headline{width:auto!important}.character-sheet.compact .container .columns .column .row .resource-table .materials,.character-sheet.compact .container .columns .column .row .resource-table .herbs{grid-template-columns:repeat(3,1fr)}.character-sheet.compact .container .columns .column .row .resource-table .materials .resource,.character-sheet.compact .container .columns .column .row .resource-table .herbs .resource{display:grid;grid-template-columns:.3fr 1fr;align-items:center}.character-sheet.compact .container .columns .column .row .resource-table .materials .resource input,.character-sheet.compact .container .columns .column .row .resource-table .herbs .resource input{width:100%;margin-left:0}.character-sheet.compact .container .columns .column ghs-character-items .item-list{height:auto!important}.character-sheet.compact .level .columns{flex-direction:row}.character-sheet.compact .level .columns .column{width:auto!important}.character-sheet.compact .level .columns .column .level-item{width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor) * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor) * var(--ghs-text-factor));font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor) * var(--ghs-text-factor));border-width:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor) * var(--ghs-text-factor));margin-left:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor) * var(--ghs-text-factor))}.character-sheet.compact .level .columns .column .xp-item{width:calc(var(--ghs-unit) * 2.8 * var(--ghs-dialog-factor) * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor) * var(--ghs-text-factor));font-size:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor) * var(--ghs-text-factor));border-right-width:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor) * var(--ghs-text-factor));margin-top:calc(var(--ghs-unit) * -1 * var(--ghs-dialog-factor) / var(--ghs-text-factor))}.character-sheet.compact .level .columns .column .xp-item:before{top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor) * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor) * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor) * var(--ghs-text-factor))}.character-sheet.compact .level .columns .column .xp-item.checked:after{top:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor) * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor) * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor) * var(--ghs-text-factor))}.character-sheet.compact .battlegoals .battlegoals-grid{grid-template-columns:repeat(12,calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor)))}.character-sheet.compact .masteries .mastery .text{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor) * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor) * var(--ghs-text-factor))}.character-sheet .scroll-container.denied .export,.character-sheet .scroll-container.denied .export *{pointer-events:initial}.character-sheet .toggle-fh-sheet{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));cursor:pointer;display:flex;justify-content:flex-end;width:100%;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.character-sheet .ability-cards{position:absolute;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 30.5 * var(--ghs-dialog-factor));cursor:pointer;width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));z-index:1}.character-sheet .ability-cards:after{content:" ";position:absolute;inset:0;background-color:var(--ghs-character-color);-webkit-mask-image:url(hand-size.7a3c0915c9cd2c92.svg);mask-image:url(hand-size.7a3c0915c9cd2c92.svg);-webkit-mask-size:100%;mask-size:100%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;z-index:-1}\n'],encapsulation:2})}return a})();const Zj=(a,r)=>({empty:a,off:r}),Jj=a=>({empty:a}),Qj=a=>({denied:a}),t5=a=>({"outer-denied":a}),n5=()=>[],pr=(a,r)=>r._trackUUID;function e5(a,r){if(1&a&&t.nrm(0,"ghs-standee",6),2&a){const n=r.$implicit,i=t.XpG();t.Y8G("figure",i.character)("entity",n)}}function a5(a,r){if(1&a&&t.nrm(0,"img",25),2&a){const n=r.$implicit,i=t.XpG(2).$implicit,e=t.XpG();t.xc7("z-index",i.value-n-1),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+i.name+".svg",t.B4B)}}function i5(a,r){if(1&a&&(t.Z7z(0,a5,1,3,"img",24,t.fX1),t.nI1(2,"ghsRange")),2&a){const n=t.XpG().$implicit;t.Dyx(t.i5U(2,0,t.lJ4(3,n5),n.value-1))}}function o5(a,r){if(1&a&&(t.j41(0,"span",23),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.JRh(n.value)}}function s5(a,r){if(1&a&&(t.j41(0,"span",14),t.nrm(1,"img",4),t.nVh(2,i5,3,4),t.nVh(3,o5,2,1,"span",23),t.k0s()),2&a){const n=r.$implicit,i=t.XpG();t.R7$(),t.xc7("z-index",n.value),t.Y8G("src","./assets/images"+(i.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+n.name+".svg",t.B4B),t.R7$(),t.vxM(n.types.includes(i.ConditionType.stack)?2:-1),t.R7$(),t.vxM(n.types.includes(i.ConditionType.value)?3:-1)}}let r5=(()=>{class a extends or{cancel(){this.character.fullview=!1,s.E.stateManager.saveLocal(),this.ghsManager.triggerUiChange()}static \u0275fac=(()=>{let n;return function(e){return(n||(n=t.xGo(a)))(e||a)}})();static \u0275cmp=t.VBU({type:a,selectors:[["ghs-character-fullview"]],standalone:!1,features:[t.Vt3],decls:32,vars:33,consts:[[1,"container"],[1,"summons-container",3,"ngClass"],[1,"spacer"],[1,"icon",3,"ngClass","entityAnimation"],[3,"src"],[1,"summons"],[3,"figure","entity"],[1,"fullview"],[1,"row"],[3,"character","ngClass"],[1,"drag-initiative",3,"dragMove","dragEnd","singleClick","doubleClick","draggingDisabled","ngClass"],[3,"figure"],[3,"entity","figure"],[1,"conditions"],[1,"condition"],[1,"dialog"],[1,"dialog-container"],["type","character",3,"entity","figure","entityConditions","immunities","columns"],[1,"row","sheet"],[3,"character","standalone"],[1,"wip",3,"click"],["src","./assets/images/warning.svg",1,"ghs-svg"],[3,"ghs-label"],[1,"value"],[1,"stack",3,"z-index","src"],[1,"stack",3,"src"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"span",2),t.j41(3,"span",3),t.nrm(4,"img",4),t.k0s(),t.j41(5,"div",5),t.Z7z(6,e5,1,2,"ghs-standee",6,pr),t.nI1(8,"trackUUID"),t.k0s()(),t.j41(9,"div",7)(10,"div",8),t.nrm(11,"ghs-character-image",9),t.j41(12,"ghs-pointer-input",10),t.bIt("dragMove",function(g){return e.gameManager.stateManager.characterPermissions[e.character.name+"|"+e.character.edition]&&e.dragInitiativeMove(g)})("dragEnd",function(g){return e.gameManager.stateManager.characterPermissions[e.character.name+"|"+e.character.edition]&&e.dragInitiativeEnd(g)})("singleClick",function(g){return e.toggleFigure(g)})("doubleClick",function(g){return e.gameManager.stateManager.characterPermissions[e.character.name+"|"+e.character.edition]&&e.initiativeDoubleClick(g)}),t.k0s(),t.nrm(13,"ghs-character-initiative",11)(14,"ghs-highlight-conditions",12),t.k0s(),t.j41(15,"div",8)(16,"div",13),t.Z7z(17,s5,4,5,"span",14,pr),t.nI1(19,"trackUUID"),t.k0s()(),t.j41(20,"div",8)(21,"div",15)(22,"div",16),t.nrm(23,"ghs-conditions",17),t.k0s()()(),t.j41(24,"div",18),t.nrm(25,"ghs-character-sheet",19),t.k0s()(),t.j41(26,"a",20),t.bIt("click",function(){return e.cancel()}),t.nrm(27,"img",21)(28,"span",22),t.EFF(29,"!\xa0"),t.nrm(30,"span",22),t.EFF(31,"! "),t.k0s()()),2&i&&(t.R7$(),t.Y8G("ngClass",t.l_i(24,Zj,0==e.summonCount,e.character.off||e.character.exhausted||e.character.health<=0)),t.R7$(2),t.Y8G("ngClass",t.eq3(27,Jj,0==e.summonCount))("entityAnimation",0==e.summonCount),t.R7$(),t.Y8G("src",e.character.iconUrl,t.B4B),t.R7$(2),t.Dyx(t.bMT(8,20,e.character.summons)),t.R7$(5),t.Y8G("character",e.character)("ngClass",t.eq3(29,Qj,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.round)),t.R7$(),t.Y8G("draggingDisabled",!e.settingsManager.settings.dragValuesInitiative)("ngClass",t.eq3(31,t5,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.round&&!e.gameManager.stateManager.characterPermissions[e.character.name+"|"+e.character.edition])),t.R7$(),t.Y8G("figure",e.character),t.R7$(),t.Y8G("entity",e.character)("figure",e.character),t.R7$(3),t.Dyx(t.bMT(19,22,e.activeConditions)),t.R7$(6),t.Y8G("entity",e.character)("figure",e.character)("entityConditions",e.character.entityConditions)("immunities",e.character.immunities)("columns",6),t.R7$(2),t.Y8G("character",e.character)("standalone",!0),t.R7$(3),t.Y8G("ghs-label","wip"),t.R7$(2),t.Y8G("ghs-label","cancel"))},dependencies:[N.YU,Zs,Yi,mr,Pa,$a,it,Ia,dt,Aa,At,ct],styles:['.attack-modifierdeck-container[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:5;width:0;height:0;visibility:hidden}.attack-modifierdeck-container[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;width:100%;overflow-x:auto;overflow-y:hidden}.attack-modifierdeck-container[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{position:absolute;display:flex;top:calc(var(--ghs-unit) * 1.5);left:calc(var(--ghs-unit) * 21.5);width:calc(var(--ghs-unit) * 37.5);height:calc(var(--ghs-unit) * 10);z-index:5}.attack-modifierdeck-container.active[_ngcontent-%COMP%], .attack-modifierdeck-container.loot-cards-container[_ngcontent-%COMP%], .loot-cards-container.active[_ngcontent-%COMP%], .loot-cards-container.loot-cards-container[_ngcontent-%COMP%]{visibility:visible;width:100%;height:100%}.attack-modifierdeck-container.permanent.active[_ngcontent-%COMP%], .loot-cards-container.permanent.active[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 98);height:calc(var(--ghs-unit) * 15.6)}.attack-modifierdeck-container.permanent.active[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%], .loot-cards-container.permanent.active[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 20)}.attack-modifierdeck-container.permanent.active[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%], .loot-cards-container.permanent.active[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 2.3);left:calc(var(--ghs-unit) * 17);width:calc(var(--ghs-unit) * 45);height:calc(var(--ghs-unit) * 12)}.attack-modifierdeck-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]{position:absolute;display:flex;top:calc(var(--ghs-unit) * .5 / var(--ghs-text-factor) / var(--ghs-text-factor));left:calc(var(--ghs-unit) * 21.5);z-index:3}.attack-modifierdeck-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 8.6666666667 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 13 * var(--ghs-text-factor));margin-right:calc(var(--ghs-unit) * .5 / var(--ghs-text-factor) / var(--ghs-text-factor))}.attack-modifierdeck-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]   ghs-loot[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]   ghs-loot[_ngcontent-%COMP%]{position:absolute;inset:0;display:block}.attack-modifierdeck-container[_ngcontent-%COMP%]   .attack-modifierdeck-close[_ngcontent-%COMP%], .attack-modifierdeck-container[_ngcontent-%COMP%]   .loot-cards-close[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .attack-modifierdeck-close[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .loot-cards-close[_ngcontent-%COMP%]{display:inline-block;position:relative;cursor:zoom-out;top:0;left:0;z-index:2;width:100%;height:100%}.summons-container[_ngcontent-%COMP%]{position:relative;z-index:2;display:flex;align-items:center;transition:max-height calc(var(--ghs-animation-speed) * 2s) ease-out;max-height:100%;min-width:calc(var(--ghs-unit) * 7);max-width:calc(var(--ghs-unit) * 96)}.summons-container.empty[_ngcontent-%COMP%]{max-height:0}.summons-container[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{flex:none;width:calc(var(--ghs-unit) * 10.5);height:100%}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:block;width:auto;height:calc(var(--ghs-unit) * 6);margin-right:calc(var(--ghs-unit) * 1)}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{height:100%;width:auto;filter:var(--ghs-filter-shadow)}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]   img.menu[_ngcontent-%COMP%]{position:absolute;top:50%;left:calc(var(--ghs-unit) * -4);transform:translateY(-50%);width:calc(var(--ghs-unit) * 3.7 * var(--ghs-text-factor));height:auto;filter:var(--ghs-filter-darkgray);opacity:.5}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]:not(.empty){opacity:1;transform:translate(0)}.summons-container[_ngcontent-%COMP%]   .entities-menu.empty[_ngcontent-%COMP%]{opacity:0;max-width:0;height:0;transform:translateY(100%)}.summons-container[_ngcontent-%COMP%]   .entities-menu.disabled[_ngcontent-%COMP%]{cursor:initial;pointer-events:none}.summons-container[_ngcontent-%COMP%]   .entities-menu.disabled[_ngcontent-%COMP%]   img.menu[_ngcontent-%COMP%]{display:none}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]:hover   img.icon[_ngcontent-%COMP%]{opacity:.5}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]:hover   img.menu[_ngcontent-%COMP%]{opacity:1}.summons-container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;max-width:calc(var(--ghs-unit) * 77.5)}.summons-container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   ghs-standee[_ngcontent-%COMP%]{position:relative;margin-bottom:calc(var(--ghs-unit) * 1)}.summons-container.spirits[_ngcontent-%COMP%]   ghs-standee[_ngcontent-%COMP%]{transition:top calc(var(--ghs-animation-speed) * .5s) ease-in-out}.summons-container.spirits[_ngcontent-%COMP%]   ghs-standee.active[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * -5)}.summons-container.off[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{filter:grayscale(100%)}.character[_ngcontent-%COMP%]{position:relative;z-index:1;height:100%;width:calc(var(--ghs-unit) * 98);height:calc(var(--ghs-unit) * 14);background-color:var(--ghs-character-color);background-image:url(char-mat.5a0fee77df1ff44e.png),url(char-mat.5a0fee77df1ff44e.png);background-blend-mode:multiply,overlay;background-size:100% 100%;display:flex;--ghs-character-color: #000;border-radius:calc(var(--ghs-unit) * .5);filter:var(--ghs-filter-outline);transition:background-color calc(var(--ghs-animation-speed) * .15s) ease-in-out,background-image calc(var(--ghs-animation-speed) * .15s) ease-in-out,background-blend-mode calc(var(--ghs-animation-speed) * .15s) ease-in-out}.character.dimmed[_ngcontent-%COMP%]{background-color:var(--ghs-color-gray);background-image:url(char-mat.5a0fee77df1ff44e.png);background-blend-mode:multiply}.character.dimmed[_ngcontent-%COMP%]   ghs-character-image[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   ghs-character-initiative[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .summon-dialog[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .short-menu[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .player-number[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]{filter:grayscale(.15);opacity:.5}.character[_ngcontent-%COMP%]   ghs-entity-index-key[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 5);left:calc(var(--ghs-unit) * 3.2);z-index:6}.character[_ngcontent-%COMP%]   ghs-character-image[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 9.5);height:calc(var(--ghs-unit) * 9.5);margin:calc(var(--ghs-unit) * 2.1) calc(var(--ghs-unit) * 3.4);left:calc(var(--ghs-unit) * 2.4)}.character[_ngcontent-%COMP%]   ghs-character-initiative[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   ghs-character-image[_ngcontent-%COMP%]{z-index:2}.character[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 2.1);left:calc(var(--ghs-unit) * 6);width:calc(var(--ghs-unit) * 9.5);height:calc(var(--ghs-unit) * 9.5);z-index:4}.character[_ngcontent-%COMP%]   .drag-initiative.dragging[_ngcontent-%COMP%]{left:0!important;width:100%!important}.character[_ngcontent-%COMP%]   ghs-highlight-conditions[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 10.5);bottom:calc(var(--ghs-unit) * 2.5);z-index:20}.character[_ngcontent-%COMP%]   .entity-menu-container[_ngcontent-%COMP%]{cursor:pointer;position:absolute;inset:0}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{height:100%;display:flex;flex-basis:100%;cursor:pointer;margin-left:calc(var(--ghs-unit) * 1)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:flex-start}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 13);max-width:calc(var(--ghs-unit) * 10);overflow:visible}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .bar-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:flex-start}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-2[_ngcontent-%COMP%]{width:auto;z-index:2}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]{display:flex;align-items:center;z-index:2}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5);color:var(--ghs-color-white);text-shadow:var(--ghs-outline);display:flex;align-items:center;white-space:nowrap}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:calc(var(--ghs-unit) * 5.5);margin-left:calc(var(--ghs-unit) * -1.1);margin-right:calc(var(--ghs-unit) * .5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:auto}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   img.exhausted[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1);height:calc(var(--ghs-unit) * 4);width:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .token-container[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--ghs-color-white);font-family:var(--ghs-font-text);margin-left:calc(var(--ghs-unit) * .5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .token-container[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.7);margin:0 calc(var(--ghs-unit) * .1)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .token-container[_ngcontent-%COMP%]   .token.placeholder[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * -.5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{position:relative;display:flex;margin-left:calc(var(--ghs-unit) * .5);font-size:calc(var(--ghs-unit) * 2)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{position:relative;margin-left:calc(var(--ghs-unit) * .5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]:hover{transform:translate(50%,50%) scale(2);transform-origin:center center;z-index:999}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]:hover:before{content:" ";position:absolute;top:calc(var(--ghs-unit) * -1);left:calc(var(--ghs-unit) * -1);right:calc(var(--ghs-unit) * -1);bottom:calc(var(--ghs-unit) * -1);background-color:var(--ghs-color-darkgray);opacity:.5;border-radius:calc(var(--ghs-unit) * 1)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .action-overlay[_ngcontent-%COMP%]{position:absolute;z-index:1;top:calc(var(--ghs-unit) * 1);left:calc(var(--ghs-unit) * -.5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .status-bar[_ngcontent-%COMP%]{display:flex;align-items:center;z-index:2;touch-action:none}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));width:auto}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]   img.damage[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) brightness(.7) var(--ghs-filter-outline-thin-black)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]   .value-overlay[_ngcontent-%COMP%]{position:absolute;left:100%;top:50%;transform:translateY(-50%);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor));z-index:1000}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;max-height:calc(var(--ghs-unit) * 7 * var(--ghs-text-factor));padding:0 calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));background-color:var(--ghs-color-darkgray);border-radius:100%;height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));margin-right:calc(var(--ghs-unit) * -1 * var(--ghs-text-factor));border-width:calc(var(--ghs-unit) * .4);border-style:solid;border-color:var(--ghs-color-gray)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.7 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 2.7 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]{position:relative;display:flex}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;margin-right:calc(var(--ghs-unit) * -.5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));overflow:visible}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));margin:0}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img.stack[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * -2 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition.condition-overlay[_ngcontent-%COMP%]{position:absolute;width:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));top:0;left:0;pointer-events:none;z-index:2}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));color:var(--ghs-color-white);position:absolute;top:calc(var(--ghs-unit) * 2.1 * var(--ghs-text-factor));left:50%;text-shadow:none;transform:translate(-50%)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:hover{transform:scale(2);transform-origin:center center;z-index:999}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw[_ngcontent-%COMP%]{position:relative;z-index:999;width:0;height:0;top:50%;left:calc(var(--ghs-unit) * -3);overflow:visible}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw[_ngcontent-%COMP%]   ghs-attackmodifier-draw[_ngcontent-%COMP%]{position:absolute;width:0;height:0}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw.drawing[_ngcontent-%COMP%]   ghs-attackmodifier-draw[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 18);height:calc(var(--ghs-unit) * 12)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;align-self:center;z-index:1}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor) * var(--ghs-text-factor));height:auto;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%]:hover, .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%]:hover, .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%]:hover, .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%]:hover{opacity:.7}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.disabled[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.disabled[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.disabled[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.disabled[_ngcontent-%COMP%]{pointer-events:none}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.loot-cards-button[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.loot-cards-button[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.loot-cards-button[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.loot-cards-button[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{position:absolute;bottom:calc(var(--ghs-unit) * -1.5 * var(--ghs-text-factor));right:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));color:var(--ghs-color-white)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.battlegoals-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.items-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.battlegoals-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.items-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.battlegoals-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.items-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.battlegoals-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.items-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));border-radius:calc(var(--ghs-unit) * .3 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.battlegoals-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.items-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.battlegoals-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.items-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.battlegoals-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.items-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.battlegoals-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.items-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-70%,-50%);width:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));filter:var(--ghs-filter-green) var(--ghs-filter-outline)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.attack-modifier-button.bb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.attack-modifier-button.bb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.attack-modifier-button.bb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.attack-modifier-button.bb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.attack-modifier-button.active[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.attack-modifier-button.active[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.attack-modifier-button.active[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.attack-modifier-button.active[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor) * var(--ghs-text-factor));height:auto}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.items-button.bb[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.items-button.bb[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.items-button.bb[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.items-button.bb[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .bb-spacer[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 7 / var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));filter:var(--ghs-filter-shadow);width:calc(var(--ghs-unit) * 6.5);margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));margin-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .experience.experience[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot.experience[_ngcontent-%COMP%]{color:var(--ghs-color-blue)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .experience.loot[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot.loot[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.character.absent[_ngcontent-%COMP%]{cursor:initial;opacity:.6}.character.absent[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{cursor:initial}.character[_ngcontent-%COMP%]   .absent-menu[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:calc(var(--ghs-unit) * 82);height:calc(var(--ghs-unit) * 14);cursor:pointer;z-index:2}.character[_ngcontent-%COMP%]   .summon-dialog[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .short-menu[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .summon-dialog-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .toggle-menu[_ngcontent-%COMP%]{position:relative;display:flex;width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));cursor:pointer;font-size:calc(var(--ghs-unit) * 10 * var(--ghs-text-factor));color:var(--ghs-color-gray);filter:var(--ghs-filter-gray);stroke:var(--ghs-color-black);stroke-width:calc(var(--ghs-unit) * 1.5)}.character[_ngcontent-%COMP%]   .summon-dialog-button[_ngcontent-%COMP%]:hover, .character[_ngcontent-%COMP%]   .toggle-menu[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white);filter:var(--ghs-filter-white)}.character[_ngcontent-%COMP%]   .summon-dialog-button.toggle-menu[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .toggle-menu.toggle-menu[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   ghs-figure-errors[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 14.5);top:50%;transform:translateY(-50%);z-index:99}.character[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]{position:relative;cursor:pointer;height:100%;width:calc(var(--ghs-unit) * 10);display:flex;justify-content:center;align-items:center;margin-right:calc(var(--ghs-unit) * 4);margin-left:calc(var(--ghs-unit) * 2)}.character[_ngcontent-%COMP%]   .character-sheet-button.hand-size-margin[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 4.5)}.character[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 8);width:auto;filter:var(--ghs-filter-shadow)}.character[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%]{position:absolute;right:calc(var(--ghs-unit) * 14);top:calc(var(--ghs-unit) * 4);width:calc(var(--ghs-unit) * 4.2);height:calc(var(--ghs-unit) * 5);display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.4);padding-right:calc(var(--ghs-unit) * .4);z-index:1}.character[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%]:after{content:" ";position:absolute;inset:0;background-color:var(--ghs-character-color);-webkit-mask-image:url(hand-size-mask.5857c02745e3d418.svg);mask-image:url(hand-size-mask.5857c02745e3d418.svg);-webkit-mask-size:100%;mask-size:100%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;filter:brightness(1.6);z-index:-1}.character[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]{position:absolute;right:calc(var(--ghs-unit) * 13.3);top:calc(var(--ghs-unit) * 10);width:calc(var(--ghs-unit) * 4.2);height:calc(var(--ghs-unit) * 5);display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.4);padding-right:calc(var(--ghs-unit) * .4);z-index:1}.character[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:0;left:calc(var(--ghs-unit) * -.5);bottom:0;right:0;background-color:var(--ghs-character-color);-webkit-mask-image:url(level.38e1f58a07dc5898.svg);mask-image:url(level.38e1f58a07dc5898.svg);-webkit-mask-size:100%;mask-size:100%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;z-index:-1}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 32.5);top:calc(var(--ghs-unit) * .5);width:calc(var(--ghs-unit) * 33);height:calc(var(--ghs-unit) * 2.64);display:flex;justify-content:space-evenly;align-items:center;z-index:0}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:0;background-color:var(--ghs-character-color);-webkit-mask-image:url(outer-mask.f0af43cfab648186.svg);mask-image:url(outer-mask.f0af43cfab648186.svg);-webkit-mask-size:100%;mask-size:100%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;z-index:0}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]:after{content:" ";position:absolute;inset:0;background-color:var(--ghs-character-color);-webkit-mask-image:url(inner-mask.f2d18d4a7559b09e.svg);mask-image:url(inner-mask.f2d18d4a7559b09e.svg);-webkit-mask-size:100%;mask-size:100%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;filter:brightness(.5);z-index:1}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]   .trait[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.5);color:var(--ghs-character-color);z-index:2}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{position:absolute;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 1.8);height:calc(var(--ghs-unit) * 1.8);left:0;top:50%;transform:translateY(-45%) rotate(45deg);border:calc(var(--ghs-unit) * .2) solid var(--ghs-character-color);z-index:2}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:110%;width:auto;filter:var(--ghs-filter-white);transform:rotate(-45deg);z-index:1}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:0;background-color:var(--ghs-character-color);z-index:0;filter:brightness(.5)}.character[_ngcontent-%COMP%]   .player-number[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 1.8);top:calc(var(--ghs-unit) * 4.3);width:calc(var(--ghs-unit) * 5);height:calc(var(--ghs-unit) * 5);display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.7);z-index:1;border:calc(var(--ghs-unit) * .2) solid var(--ghs-color-gray);border-top-left-radius:80%;border-bottom-left-radius:80%;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}.character[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 18 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 62 * var(--ghs-text-factor));bottom:calc(var(--ghs-unit) * .5);color:var(--ghs-color-white);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2);display:flex;justify-content:center;align-items:center}.character[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * .2 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]:before{transition:filter calc(var(--ghs-animation-speed) * .15s) ease-in-out}.character.off[_ngcontent-%COMP%]{background-color:var(--ghs-color-gray);background-image:url(char-mat.5a0fee77df1ff44e.png);background-blend-mode:multiply}.character.off[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .summon-dialog[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .short-menu[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]:before{filter:grayscale(1)!important}.character.denied[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .attack-modifierdeck-close[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .loot-cards-close[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{pointer-events:initial}.character.fh[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]:after{top:calc(var(--ghs-unit) * -.5)}.character.short[_ngcontent-%COMP%]:not(.compact){width:calc(var(--ghs-unit) * 57);height:calc(var(--ghs-unit) * 28);background-image:url(char-mat-short.a094776e83c7bcfc.png),url(char-mat-short.a094776e83c7bcfc.png)}.character.short[_ngcontent-%COMP%]:not(.compact)   ghs-character-image[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * 2.8) calc(var(--ghs-unit) * 2)}.character.short[_ngcontent-%COMP%]:not(.compact)   ghs-highlight-conditions[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 9);bottom:calc(var(--ghs-unit) * 16)}.character.short[_ngcontent-%COMP%]:not(.compact)   .drag-initiative[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 2.8);left:calc(var(--ghs-unit) * 4.3)}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 2);right:calc(var(--ghs-unit) * 2);height:calc(var(--ghs-unit) * 26.5);flex-wrap:wrap}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 12);width:100%;max-width:initial;flex-direction:row;justify-content:flex-start;align-items:center}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   ghs-character-initiative[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 10);margin-top:calc(var(--ghs-unit) * 1);margin-left:initial}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .bar-container[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1.5);max-width:calc(var(--ghs-unit) * 40)}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .bar-container[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]{flex-wrap:wrap}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));flex-wrap:wrap}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 2);margin-right:calc(var(--ghs-unit) * 2);margin-top:calc(var(--ghs-unit) * 2);height:auto}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 16);left:calc(var(--ghs-unit) * 0);right:initial}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 20.5);left:calc(var(--ghs-unit) * .2);right:initial}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .player-number[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 4.8);left:calc(var(--ghs-unit) * -6.7)}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 14)}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * -2.5 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 56 * var(--ghs-text-factor));bottom:calc(var(--ghs-unit) * -1)}.character.compact[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 10.25);background-image:url(char-mat_compact.b0d0dd33f05dffe7.png),url(char-mat_compact.b0d0dd33f05dffe7.png)}.character.compact[_ngcontent-%COMP%]   ghs-entity-index-key[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 3.1)}.character.compact[_ngcontent-%COMP%]   ghs-character-image[_ngcontent-%COMP%], .character.compact[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]{display:none}.character.compact[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 2.5);left:calc(var(--ghs-unit) * 6.5);width:calc(var(--ghs-unit) * 5);height:calc(var(--ghs-unit) * 5)}.character.compact[_ngcontent-%COMP%]   .attack-modifierdeck-container[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 1 / var(--ghs-text-factor));left:calc(var(--ghs-unit) * 13);width:calc(var(--ghs-unit) * 30 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 8 * var(--ghs-text-factor))}.character.compact[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * .5 / var(--ghs-text-factor) / var(--ghs-text-factor));left:calc(var(--ghs-unit) * 8)}.character.compact[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 6 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 9 * var(--ghs-text-factor))}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 7)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%], .character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .bar-container[_ngcontent-%COMP%]{flex-direction:row;justify-content:flex-start;align-items:center}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .bar-container[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]{flex-wrap:initial}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * .5);margin-left:calc(var(--ghs-unit) * -.5)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4.5)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 7 * var(--ghs-text-factor));padding-top:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-2[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 7)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%], .character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 6)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw.drawing[_ngcontent-%COMP%]   ghs-attackmodifier-draw[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 13.5);height:calc(var(--ghs-unit) * 9)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 1.4);right:calc(var(--ghs-unit) * 2);left:initial}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 6);right:calc(var(--ghs-unit) * 1.8);left:initial}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .player-number[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 3.3);left:calc(var(--ghs-unit) * 1.7);width:calc(var(--ghs-unit) * 3.5);height:calc(var(--ghs-unit) * 3.5);font-size:calc(var(--ghs-unit) * 2);border-radius:80%}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]{display:none}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 11);bottom:0;width:calc(var(--ghs-unit) * 71);justify-content:flex-start}.character.compact.short[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 57)}.character.compact.short[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 2)}.character.compact.short[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * .5)}.character.compact.short[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3);white-space:initial}.character.compact.short[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .status-bar[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{width:auto}.character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1.5)}.character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .col-1[_ngcontent-%COMP%]{max-width:calc(var(--ghs-unit) * 35)}.character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .summon-dialog[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-2[_ngcontent-%COMP%]{display:none}.character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .short-menu[_ngcontent-%COMP%]{position:absolute;top:0;right:calc(var(--ghs-unit) * 6);bottom:0;z-index:2}.character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 11)}.character.compact.short.menu[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   ghs-highlight-conditions[_ngcontent-%COMP%]{display:none}.character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 4.5)}.character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{display:none}.character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .summon-dialog[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-2[_ngcontent-%COMP%]{display:inherit}.character.modern[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 16);border-top-left-radius:calc(var(--ghs-unit) * 13);border-top-right-radius:calc(var(--ghs-unit) * 12);border-bottom-right-radius:calc(var(--ghs-unit) * 12);background-image:url(char-mat_modern.2238b82519930f08.png);background-blend-mode:hard-light;filter:none;overflow:hidden}.character.modern.dimmed[_ngcontent-%COMP%]{background-image:url(char-mat_modern.2238b82519930f08.png)}.character.modern[_ngcontent-%COMP%]   ghs-entity-index-key[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * .5);left:calc(var(--ghs-unit) * 13.7)}.character.modern[_ngcontent-%COMP%]   ghs-character-image[_ngcontent-%COMP%], .character.modern[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{top:0;left:0;width:calc(var(--ghs-unit) * 16);height:calc(var(--ghs-unit) * 16);margin:0}.character.modern[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 5)}.character.modern[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:grayscale(1) brightness(.3)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 2.5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * -1 / var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4.5);filter:grayscale(1) brightness(.3);margin-left:calc(var(--ghs-unit) * -.5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .status-bar[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 2.5);min-height:calc(var(--ghs-unit) * 5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 5.5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .summon-dialog-button[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .col-2[_ngcontent-%COMP%]{padding-top:calc(var(--ghs-unit) * 5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 6.5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * 13.9);top:0}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]:after{top:calc(var(--ghs-unit) * -.5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 18);top:initial;bottom:0}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]:before{transform:rotate(180deg)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]:after{transform:rotate(180deg)}.character.modern[_ngcontent-%COMP%]   .attack-modifierdeck-container[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 3 / var(--ghs-text-factor) / var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * .5 / var(--ghs-text-factor) / var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 10 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 15 * var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 17);width:calc(var(--ghs-unit) * 55);justify-content:flex-start}',"[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%;height:100%;overflow:auto}.container[_ngcontent-%COMP%]{height:100%}.fullview[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;align-items:center}.fullview[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1);position:relative;display:flex}.fullview[_ngcontent-%COMP%]   ghs-character-image[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 15);height:calc(var(--ghs-unit) * 15);border-radius:calc(var(--ghs-unit) * 2)}.fullview[_ngcontent-%COMP%]   ghs-highlight-conditions[_ngcontent-%COMP%]{position:absolute;left:0;top:50%;transform:translateY(-50%);width:calc(var(--ghs-unit) * 15);z-index:5}.fullview[_ngcontent-%COMP%]   ghs-pointer-input.drag-initiative[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:calc(var(--ghs-unit) * 15);height:100%;z-index:4}.fullview[_ngcontent-%COMP%]   ghs-pointer-input.drag-initiative.dragging[_ngcontent-%COMP%]{left:0;width:100%}.fullview[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]{position:relative;display:flex;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.fullview[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{position:relative;display:flex;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.fullview[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));margin:0}.fullview[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img.stack[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * -3 * var(--ghs-text-factor))}.fullview[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-text-factor));color:var(--ghs-color-white);position:absolute;top:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));left:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));text-shadow:none;transform:translate(-50%)}.fullview[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]{padding:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));background-color:var(--ghs-color-white)}.wip[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;color:var(--ghs-color-red);font-size:calc(var(--ghs-unit) * 4)}.wip[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow) var(--ghs-filter-shadow);width:calc(var(--ghs-unit) * 4);height:auto;margin-right:calc(var(--ghs-unit) * 1)}.wip[_ngcontent-%COMP%]:hover{color:var(--ghs-color-black)}"]})}return a})();const c5=["menu"],l5=(a,r,n)=>({fh:a,modern:r,"has-removed":n}),zi=(a,r)=>[a,r],Li=a=>({edit:a}),ur=a=>({disabled:a}),g5=(a,r)=>({active:a,keep:r}),Va=(a,r)=>r._trackUUID;function d5(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",21),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.reveal=(e.reveal+1)%3)}),t.nrm(1,"span",20),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label",2==n.reveal?"game.cards.coverAll":0==n.reveal?"game.cards.revealAll":"game.cards.revealAllConfirm")}}function h5(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",22),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.drawCard())}),t.nrm(1,"span",20),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(2,ur,n.drawDisabled)),t.R7$(),t.Y8G("ghs-label","game.cards.draw")}}function _5(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",23),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.shuffle(!0))})("doubleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.shuffle())}),t.nrm(1,"span",20),t.k0s()}2&a&&(t.Y8G("ghs-tooltip","game.cards.shuffle.allHint")("overlayX","center"),t.R7$(),t.Y8G("ghs-label","game.cards.shuffle"))}function m5(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",24),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.toggleEdit())}),t.k0s(),t.nrm(2,"span",20),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("checked",n.edit),t.R7$(),t.Y8G("ghs-label","game.cards.edit")}}function p5(a,r){if(1&a){const n=t.RV6();t.nVh(0,d5,2,1,"a"),t.nVh(1,h5,2,4,"a",17),t.nVh(2,_5,2,3,"a",18),t.j41(3,"a",19),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.clear())})("doubleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.clear(!1))}),t.nrm(4,"span",20),t.k0s(),t.nVh(5,m5,3,2,"label")}if(2&a){const n=t.XpG();t.vxM(n.edit?0:-1),t.R7$(),t.vxM(n.edit?-1:1),t.R7$(),t.vxM(n.edit?2:-1),t.R7$(),t.Y8G("ngClass",t.eq3(6,ur,n.deck.current<=n.deck.finished)),t.R7$(),t.Y8G("ghs-label","challenges.deck.clear"+(n.drawAvailable>1?".multiple":"")),t.R7$(),t.vxM(n.gameManager.game.scenario?5:-1)}}function u5(a,r){if(1&a&&t.nrm(0,"span",20),2&a){const n=t.XpG(2);t.Y8G("ghs-label","challenges.deck.hint.drawAvailable"+(n.drawAvailable>1?".multiple":""))}}function f5(a,r){if(1&a&&t.nrm(0,"span",20),2&a){const n=t.XpG(2);t.Y8G("ghs-label","challenges.deck.hint.select"+(n.keepAvailable>1?".multiple":""))}}function C5(a,r){if(1&a&&t.nrm(0,"span",20),2&a){const n=t.XpG(2);t.Y8G("ghs-label","challenges.deck.hint.current"+(n.keepAvailable>1?".multiple":""))}}function M5(a,r){if(1&a&&(t.j41(0,"div",7),t.nVh(1,u5,1,1,"span",20),t.nVh(2,f5,1,1,"span",20),t.nVh(3,C5,1,1,"span",20),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.vxM(n.drawDisabled?-1:1),t.R7$(),t.vxM(!n.disabled&&n.drawDisabled?2:-1),t.R7$(),t.vxM(n.disabled&&n.drawDisabled?3:-1)}}function v5(a,r){1&a&&t.nrm(0,"div",11)}function O5(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",28),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG();return c.Njj(o.remove(e+o.deck.current+1))}),t.nrm(1,"img",29),t.k0s()}}function P5(a,r){1&a&&t.nrm(0,"div",27)}function b5(a,r){if(1&a&&(t.j41(0,"div",12),t.nrm(1,"ghs-challenge-card",25),t.nVh(2,O5,2,0,"a",26),t.nVh(3,P5,1,0,"div",27),t.k0s()),2&a){const n=r.$implicit,i=t.XpG();t.R7$(),t.Y8G("challenge",n)("reveal",!0)("flipped",2==i.reveal),t.R7$(),t.vxM(i.edit?2:-1),t.R7$(),t.vxM(i.edit?3:-1)}}function k5(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",28),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG();return c.Njj(o.remove(o.deck.current-e))}),t.nrm(1,"img",29),t.k0s()}}function y5(a,r){1&a&&t.nrm(0,"div",27)}function x5(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",14)(1,"ghs-challenge-card",30),t.bIt("singleClick",function(){const e=c.eBV(n).$index,o=t.XpG();return c.Njj(o.toggleKeep(o.deck.current-e))})("doubleClick",function(){const e=c.eBV(n).$index,o=t.XpG();return c.Njj(o.toggleKeep(o.deck.current-e,!0))}),t.k0s(),t.nVh(2,k5,2,0,"a",26),t.nVh(3,y5,1,0,"div",27),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG();t.Y8G("ngClass",t.l_i(6,g5,!e.edit&&!!e.gameManager.game.scenario&&e.gameManager.roundManager.firstRound&&e.gameManager.game.state==e.GameState.draw,!e.disabled&&e.deck.keep.includes(e.deck.current-i))),t.R7$(),t.Y8G("challenge",n)("keep",e.deck.keep.includes(e.deck.current-i))("flipped",!0),t.R7$(),t.vxM(e.edit?2:-1),t.R7$(),t.vxM(e.edit?3:-1)}}function E5(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",28),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG();return c.Njj(o.remove(o.deck.finished-e))}),t.nrm(1,"img",29),t.k0s()}}function w5(a,r){1&a&&t.nrm(0,"div",27)}function R5(a,r){if(1&a&&(t.j41(0,"div",12),t.nrm(1,"ghs-challenge-card",31),t.nVh(2,E5,2,0,"a",26),t.nVh(3,w5,1,0,"div",27),t.k0s()),2&a){const n=r.$implicit,i=t.XpG();t.R7$(),t.Y8G("challenge",n)("flipped",!0),t.R7$(),t.vxM(i.edit?2:-1),t.R7$(),t.vxM(i.edit?3:-1)}}function j5(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",12),t.nrm(1,"ghs-challenge-card",31),t.j41(2,"a",32),t.bIt("click",function(){const e=c.eBV(n).$index,o=t.XpG(2);return c.Njj(o.restoreCard(e))}),t.nrm(3,"img",33),t.k0s()()}if(2&a){const n=r.$implicit;t.R7$(),t.Y8G("challenge",n)("flipped",!0)}}function G5(a,r){if(1&a&&(t.j41(0,"div",16),t.nrm(1,"div",10),t.Z7z(2,j5,4,2,"div",12,Va),t.nI1(4,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","challenges.deck.removed"),t.R7$(),t.Dyx(t.bMT(4,1,n.removedCards))}}let fr=(()=>{class a{data;dialogRef;ghsManager;menuElement;gameManager=s.E;settingsManager=p.f;GameState=D.mk;reveal=0;edit=!1;apply=!0;maxHeight="";deck;before;after;current=-1;drawing=!1;disabled=!1;drawDisabled=!1;drawAvailable=0;keepAvailable=0;upcomingCards=[];discardedCards=[];finishedCards=[];removedCards=[];constructor(n,i,e){this.data=n,this.dialogRef=i,this.ghsManager=e,this.deck=n.deck,this.before=n.before,this.after=n.after}ngOnInit(){setTimeout(()=>{this.maxHeight="calc(80vh - "+this.menuElement.nativeElement.offsetHeight+"px)"},p.f.settings.animations?250*p.f.settings.animationSpeed:0),this.update(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.update()}),this.edit=!s.E.game.scenario}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.upcomingCards=this.deck.cards.filter((i,e)=>e>this.deck.current),this.discardedCards=this.deck.cards.filter((i,e)=>e<=this.deck.current&&e>this.deck.finished).reverse(),this.finishedCards=this.deck.cards.filter((i,e)=>e<=this.deck.finished).reverse(),this.removedCards=s.E.challengesData(s.E.game.edition).filter(i=>null==this.deck.cards.find(e=>e.cardId==i.cardId));const n=s.E.game.party.buildings.find(i=>"town-hall"==i.name&&i.level&&"wrecked"!=i.state);n&&(this.drawAvailable=n.level,this.keepAvailable=Math.ceil(n.level/2)),this.disabled=!s.E.roundManager.firstRound||s.E.game.state==D.mk.next||!s.E.game.scenario||!this.deck.cards.length,this.drawDisabled=this.disabled||this.deck.current-this.deck.finished>=this.drawAvailable}toggleEdit(){this.edit=!this.edit,setTimeout(()=>{this.maxHeight="calc(80vh - "+this.menuElement.nativeElement.offsetHeight+"px)"},0)}shuffle(n=!1){this.before.emit(new Bt(this.deck,"challengeDeck.shuffle"+(n?"Upcoming":""))),s.E.challengesManager.shuffleDeck(this.deck,n),this.after.emit(new Bt(this.deck,"challengeDeck.shuffle"+(n?"Upcoming":""))),this.update()}clear(n=!0){this.before.emit(new Bt(this.deck,"challengeDeck.clear")),s.E.challengesManager.clearDrawn(this.deck,n),this.after.emit(new Bt(this.deck,"challengeDeck.clear")),this.update()}drawCard(){!this.disabled&&this.deck.cards.length>0&&(this.before.emit(new Bt(this.deck,"challengeDeck.draw")),s.E.challengesManager.drawCard(this.deck),this.after.emit(new Bt(this.deck,"challengeDeck.draw")))}dropUpcoming(n){this.before.emit(new Bt(this.deck,"challengeDeck.reorder"));let i=0,e=0,o=0;n.container==n.previousContainer?(i=this.deck.current+1,e=n.previousIndex+i,o=n.currentIndex+i,(0,V.HD)(this.deck.cards,e,o)):"listFinished"==n.previousContainer.id?(i=this.deck.finished,e=i-n.previousIndex,o=n.currentIndex+this.deck.current,this.deck.finished=this.deck.finished-1,this.deck.current=this.deck.current-1,(0,V.HD)(this.deck.cards,e,o)):(i=this.deck.current,e=i-n.previousIndex,o=n.currentIndex+i,this.deck.current=this.deck.current-1,(0,V.HD)(this.deck.cards,e,o)),this.after.emit(new Bt(this.deck,"challengeDeck.reorder")),this.update()}dropDiscarded(n){this.before.emit(new Bt(this.deck,"challengeDeck.reorder"));let i=0,e=0,o=0;n.container==n.previousContainer?(i=this.deck.current,e=i-n.previousIndex,o=i-n.currentIndex,(0,V.HD)(this.deck.cards,e,o)):"listFinished"==n.previousContainer.id?(i=this.deck.finished,e=i-n.previousIndex,this.deck.finished=this.deck.finished-1,o=this.deck.current-n.currentIndex,(0,V.HD)(this.deck.cards,e,o)):(this.deck.current=this.deck.current+1,i=this.deck.current,e=i+n.previousIndex,o=i-n.currentIndex,(0,V.HD)(this.deck.cards,e,o)),this.after.emit(new Bt(this.deck,"challengeDeck.reorder")),this.update()}dropFinished(n){this.before.emit(new Bt(this.deck,"challengeDeck.reorder"));let i=0,e=0,o=0;n.container==n.previousContainer?(i=this.deck.finished,e=i-n.previousIndex,o=i-n.currentIndex,(0,V.HD)(this.deck.cards,e,o)):"listDiscarded"==n.previousContainer.id?(this.deck.finished=this.deck.finished+1,i=this.deck.finished,e=this.deck.current-n.previousIndex,o=i-n.currentIndex,(0,V.HD)(this.deck.cards,e,o)):(this.deck.finished=this.deck.finished+1,this.deck.current=this.deck.current+1,i=this.deck.finished,e=this.deck.current+n.previousIndex,o=i-n.currentIndex,(0,V.HD)(this.deck.cards,e,o)),this.after.emit(new Bt(this.deck,"challengeDeck.reorder")),this.update()}toggleKeep(n,i=!1){n<=this.deck.current&&(i||!this.edit&&s.E.game.scenario&&s.E.roundManager.firstRound&&s.E.game.state==D.mk.draw)&&(this.before.emit(new Bt(this.deck,"challengeDeck.toggle",n)),s.E.challengesManager.toggleKeep(this.deck,n,this.keepAvailable),this.after.emit(new Bt(this.deck,"challengeDeck.toggle",n)))}remove(n){this.before.emit(new Bt(this.deck,"challengeDeck.removeCard",n)),n<=this.deck.current&&(this.deck.current--,this.current=this.deck.current),this.deck.cards.splice(n,1),this.after.emit(new Bt(this.deck,"challengeDeck.removeCard",n)),this.update()}restoreCard(n){const i=this.removedCards[n];i&&(this.before.emit(new Bt(this.deck,"challengeDeck.restoreCard",i.cardId)),n=Math.floor(Math.random()*(this.deck.cards.length-this.deck.current))+this.deck.current+1,this.deck.cards.splice(n,0,i),this.after.emit(new Bt(this.deck,"challengeDeck.restoreCard")),this.update())}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-challenges-dialog"]],viewQuery:function(i,e){if(1&i&&t.GBs(c5,5),2&i){let o;t.mGM(o=t.lsd())&&(e.menuElement=o.first)}},standalone:!1,decls:29,vars:47,consts:[["menu",""],["upcomingList","cdkDropList"],["discardedList","cdkDropList"],["finishedList","cdkDropList"],[1,"challenge-deck-dialog"],[1,"scroll-container"],[1,"menu"],[1,"hint"],[1,"challenge-deck-container",3,"ngClass"],["cdkDropList","","id","listUpcomping",1,"upcoming","drop-list",3,"cdkDropListDropped","cdkDropListDisabled","cdkDropListConnectedTo","cdkDropListAutoScrollStep","ngClass"],[1,"title",3,"ghs-label"],[1,"empty"],["cdkDrag","",1,"challenge-container"],["cdkDropList","","id","listDiscarded",1,"discarded","drop-list",3,"cdkDropListDropped","cdkDropListDisabled","cdkDropListConnectedTo","cdkDropListAutoScrollStep","ngClass"],["cdkDrag","",1,"challenge-container",3,"ngClass"],["cdkDropList","","id","listFinished",1,"finished","drop-list",3,"cdkDropListDropped","cdkDropListDisabled","cdkDropListConnectedTo","cdkDropListAutoScrollStep","ngClass"],[1,"removed","edit"],[3,"ngClass"],["ghs-pointer-input","",3,"ghs-tooltip","overlayX"],["ghs-pointer-input","",3,"singleClick","doubleClick","ngClass"],[3,"ghs-label"],[3,"click"],[3,"click","ngClass"],["ghs-pointer-input","",3,"singleClick","doubleClick","ghs-tooltip","overlayX"],["type","checkbox",3,"click","checked"],[1,"drag-hidden",3,"challenge","reveal","flipped"],[1,"button-remove"],["cdkDragHandle","",1,"drag-handle"],[1,"button-remove",3,"click"],["src","./assets/images/minus.svg",1,"ghs-svg"],["ghs-pointer-input","",1,"drag-hidden",3,"singleClick","doubleClick","challenge","keep","flipped"],[1,"drag-hidden",3,"challenge","flipped"],[1,"button-restore",3,"click"],["src","./assets/images/plus.svg",1,"ghs-svg"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",4)(1,"div",5)(2,"div",6,0),t.nVh(4,p5,6,8),t.k0s(),t.nVh(5,M5,4,3,"div",7),t.j41(6,"div",8)(7,"div",9,1),t.bIt("cdkDropListDropped",function(m){return c.eBV(o),c.Njj(e.dropUpcoming(m))}),t.nrm(9,"div",10),t.nVh(10,v5,1,0,"div",11),t.Z7z(11,b5,4,5,"div",12,Va),t.nI1(13,"trackUUID"),t.k0s(),t.j41(14,"div",13,2),t.bIt("cdkDropListDropped",function(m){return c.eBV(o),c.Njj(e.dropDiscarded(m))}),t.nrm(16,"div",10)(17,"div",11),t.Z7z(18,x5,4,9,"div",14,Va),t.nI1(20,"trackUUID"),t.k0s(),t.j41(21,"div",15,3),t.bIt("cdkDropListDropped",function(m){return c.eBV(o),c.Njj(e.dropFinished(m))}),t.nrm(23,"div",10)(24,"div",11),t.Z7z(25,R5,4,4,"div",12,Va),t.nI1(27,"trackUUID"),t.k0s(),t.nVh(28,G5,5,3,"div",16),t.k0s()()()}if(2&i){const o=t.sdS(8),g=t.sdS(15),m=t.sdS(22);t.R7$(4),t.vxM(e.deck.cards.length>0?4:-1),t.R7$(),t.vxM(!e.edit&&e.gameManager.game.scenario?5:-1),t.R7$(),t.xc7("max-height",e.maxHeight),t.Y8G("ngClass",t.sMw(28,l5,"fh"==e.settingsManager.settings.theme,"modern"==e.settingsManager.settings.theme,e.removedCards.length)),t.R7$(),t.Y8G("cdkDropListDisabled",!e.edit)("cdkDropListConnectedTo",t.l_i(32,zi,g,m))("cdkDropListAutoScrollStep",20)("ngClass",t.eq3(35,Li,e.edit)),t.R7$(2),t.Y8G("ghs-label","challenges.deck.upcoming"),t.R7$(),t.vxM(0==e.upcomingCards.length?10:-1),t.R7$(),t.Dyx(t.bMT(13,22,e.upcomingCards)),t.R7$(3),t.Y8G("cdkDropListDisabled",!e.edit)("cdkDropListConnectedTo",t.l_i(37,zi,o,m))("cdkDropListAutoScrollStep",20)("ngClass",t.eq3(40,Li,e.edit)),t.R7$(2),t.Y8G("ghs-label","challenges.deck.current"),t.R7$(2),t.Dyx(t.bMT(20,24,e.discardedCards)),t.R7$(3),t.Y8G("cdkDropListDisabled",!e.edit)("cdkDropListConnectedTo",t.l_i(42,zi,o,g))("cdkDropListAutoScrollStep",20)("ngClass",t.eq3(45,Li,e.edit)),t.R7$(2),t.Y8G("ghs-label","challenges.deck.finished"),t.R7$(2),t.Dyx(t.bMT(27,26,e.finishedCards)),t.R7$(3),t.vxM(e.edit&&e.removedCards.length?28:-1)}},dependencies:[N.YU,V.O7,V.T1,V.Fb,wa,it,Mt,dt,ct],styles:['.challenge-deck-dialog[_ngcontent-%COMP%]{position:relative}.challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;flex-wrap:wrap;max-width:calc(var(--ghs-unit) * 90 * var(--ghs-dialog-factor))}.challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-darkgray)}.challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{cursor:pointer;appearance:none;background-color:var(--form-background);width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));border-width:calc(var(--ghs-unit) * .3);border-style:solid;display:grid;place-content:center;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before{left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));position:relative;content:" ";width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));transform:scale(0);transform-origin:bottom left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;clip-path:polygon(14% 44%,0 65%,50% 100%,100% 16%,80% 0%,43% 62%);color:var(--ghs-color-gray);background-color:var(--ghs-color-gray)}.challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked:before{transform:scale(1)}.challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover:before{background-color:var(--ghs-color-white)}.challenge-deck-dialog[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.challenge-deck-dialog[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1em;width:auto;margin:0 .3em;filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.challenge-deck-dialog[_ngcontent-%COMP%]   .drop-list[_ngcontent-%COMP%]{position:relative}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]{display:flex;width:calc(var(--ghs-unit) * 90 * var(--ghs-dialog-factor));overflow:auto}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container.has-removed[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 120 * var(--ghs-dialog-factor))}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;overflow-y:auto;overflow-x:hidden;width:calc(var(--ghs-unit) * 30 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);display:none;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 30 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);z-index:2}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.edit[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.edit[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.edit[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.edit[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.upcoming[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.finished[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.removed[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.upcoming[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.finished[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.removed[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.upcoming[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.finished[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.removed[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.upcoming[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.finished[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.removed[_ngcontent-%COMP%]{display:none}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.upcoming.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.finished.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.removed.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.upcoming.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.finished.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.removed.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.upcoming.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.finished.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.removed.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.upcoming.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.finished.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.removed.edit[_ngcontent-%COMP%]{display:flex}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.discarded[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.discarded[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.discarded[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.discarded[_ngcontent-%COMP%]{flex-direction:row;flex-wrap:wrap;width:calc(var(--ghs-unit) * 90 * var(--ghs-dialog-factor));min-height:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor))}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.discarded.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.discarded.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.discarded.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.discarded.edit[_ngcontent-%COMP%]{flex-direction:column;flex-wrap:initial;width:calc(var(--ghs-unit) * 30 * var(--ghs-dialog-factor))}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.discarded.edit[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.discarded.edit[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.discarded.edit[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.discarded.edit[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 4.2 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{position:relative;display:flex;transition:none;width:calc(var(--ghs-unit) * 25.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 38.25 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));flex-shrink:0;flex-grow:0;border:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) solid transparent;border-radius:5%}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%]   ghs-challenge-card[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   ghs-challenge-card[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%]   ghs-challenge-card[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   ghs-challenge-card[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%]   ghs-challenge-card[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   ghs-challenge-card[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%]   ghs-challenge-card[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   ghs-challenge-card[_ngcontent-%COMP%]{position:absolute;display:flex;top:0;left:0;width:100%;height:100%}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .challenge-container.keep[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty.keep[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .challenge-container.keep[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .empty.keep[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .challenge-container.keep[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .empty.keep[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .challenge-container.keep[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .empty.keep[_ngcontent-%COMP%]{border-color:var(--ghs-color-blue)}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 4.2 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));display:block;border-style:dashed;border-width:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor));border-color:var(--ghs-color-white);width:calc(var(--ghs-unit) * 24 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 37 * var(--ghs-dialog-factor));border-radius:5%}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]{z-index:1;position:absolute;display:flex;cursor:pointer;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-filter-white) var(--ghs-filter-shadow)}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:100%;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-remove.button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-restore.button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-remove.button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-restore.button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .button-remove.button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .button-restore.button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .button-remove.button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .button-restore.button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-shadow)}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-remove.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-restore.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-remove.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-restore.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .button-remove.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .button-restore.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .button-remove.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .button-restore.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-green) var(--ghs-filter-shadow)}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.discarded[_ngcontent-%COMP%]   .challenge-container.active[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.discarded[_ngcontent-%COMP%]   .challenge-container.active[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.discarded[_ngcontent-%COMP%]   .challenge-container.active[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.discarded[_ngcontent-%COMP%]   .challenge-container.active[_ngcontent-%COMP%]{cursor:pointer}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.finished[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.finished[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.finished[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.finished[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%]{filter:grayscale(.9)}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{position:absolute;cursor:grab;left:50%;top:65%;width:60%;height:70%;transform:translate(-50%,-50%)}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container.fh[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container.fh[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container.fh[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container.fh[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container.modern[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container.modern[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container.modern[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container.modern[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.cdk-drag-preview[_ngcontent-%COMP%]{opacity:0;cursor:grabbing;z-index:999}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.5;cursor:grabbing}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}']})}return a})();const T5=a=>({vertical:a});let Cr=(()=>{class a{data;dialogRef;deck;before;after;constructor(n,i){this.data=n,this.dialogRef=i,this.deck=n.deck,this.before=n.before,this.after=n.after}vertical(){return window.innerWidth<800}beforeChallengeDeck(n){this.before.emit(n)}afterChallengeDeck(n){this.after.emit(n)}close(){(0,F.co)(this.dialogRef)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-challenge-deck-fullscreen"]],standalone:!1,decls:4,vars:6,consts:[[1,"challenge-deck-fullscreen",3,"ngClass"],[3,"before","after","deck","fullscreen","vertical"],[1,"close-container",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"ghs-challenge-deck",1),t.bIt("before",function(g){return e.beforeChallengeDeck(g)})("after",function(g){return e.afterChallengeDeck(g)}),t.k0s(),t.j41(2,"div",2),t.bIt("click",function(){return e.close()}),t.k0s()(),t.j41(3,"div",2),t.bIt("click",function(){return e.close()}),t.k0s()),2&i&&(t.Y8G("ngClass",t.eq3(4,T5,e.vertical())),t.R7$(),t.Y8G("deck",e.deck)("fullscreen",!1)("vertical",e.vertical()))},styles:[".challenge-deck-fullscreen[_ngcontent-%COMP%]{width:100vw;height:100vh;overflow-x:auto;overflow-y:auto;display:flex;flex-direction:column;justify-content:flex-start;align-items:center;z-index:3}.challenge-deck-fullscreen[_ngcontent-%COMP%]   ghs-challenge-deck[_ngcontent-%COMP%]{display:flex;width:99vw;max-width:600px;height:100vw;max-height:420px;z-index:4;margin-top:2em;margin-left:1%}.challenge-deck-fullscreen.vertical[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden}.challenge-deck-fullscreen.vertical[_ngcontent-%COMP%]   ghs-challenge-deck[_ngcontent-%COMP%]{width:98vw;margin-right:1%;height:132vw;max-height:800px;transform:none}.challenge-deck-fullscreen[_ngcontent-%COMP%]   .close-container[_ngcontent-%COMP%]{cursor:zoom-out;position:absolute;display:flex;width:100%;height:100%;z-index:2;top:0;left:0}"]})}return a})();const S5=(a,r,n)=>({disabled:a,vertical:r,denied:n}),D5=a=>({disabled:a}),$5=(a,r)=>({vertical:a,minimize:r}),I5=(a,r,n)=>({vertical:a,"without-fullscreen":r,minimize:n}),A5=(a,r,n,i)=>({discarded:a,current:r,bottom:n,unkept:i}),V5=(a,r)=>r._trackUUID;function F5(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",7),t.bIt("click",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.openFullscreen(e))}),t.nrm(1,"img",8),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ghs-label","game.cards.fullscreen")("ghs-label-attribute","title")("ngClass",t.l_i(3,$5,n.vertical,!n.deck.active))}}function X5(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",9),t.bIt("click",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.open(e))}),t.nrm(1,"img",10),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ghs-label","game.cards.openDialog")("ghs-label-attribute","title")("ngClass",t.sMw(3,I5,n.vertical,!n.fullscreen,!n.deck.active))}}function B5(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",12),t.bIt("singleClick",function(e){c.eBV(n);const o=t.XpG().$index,g=t.XpG();return c.Njj(g.clickCard(o,e))})("doubleClick",function(e){c.eBV(n);const o=t.XpG().$index,g=t.XpG();return c.Njj(g.doubleClickCard(o,e))}),t.nrm(1,"ghs-challenge-card",13),t.k0s()}if(2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG();t.xc7("z-index",e>o.current?o.deck.cards.length-e:o.deck.cards.length+e+1+(o.deck.keep.includes(e)?5:0))("right",e<o.current?55+25*(o.current-e-1)+"%":""),t.Y8G("ngClass",t.ziG(9,A5,e<o.current,e==o.current,o.bottom,!o.deck.keep.includes(e))),t.R7$(),t.Y8G("challenge",i)("keep",o.deck.keep.includes(e))("flipped",e<=o.current)("disableFlip",!o.drawing||e!=o.current)}}function Y5(a,r){if(1&a&&t.nVh(0,B5,2,14,"div",11),2&a){const n=r.$index,i=t.XpG();t.vxM(n>i.current-3&&n>i.deck.finished?0:-1)}}class Bt{deck;type;values;constructor(r,n,...i){this.deck=r,this.type=n,this.values=i}}let Mr=(()=>{class a{element;dialog;ghsManager;deck;bottom=!1;fullscreen=!0;vertical=!1;before=new t.bkB;after=new t.bkB;initTimeout=1500;gameManager=s.E;settingsManager=p.f;current=-1;internalDraw=-99;GameState=D.mk;drawing=!1;drawTimeout=null;queue=0;queueTimeout=null;compact=!1;disabled=!1;drawDisabled=!1;init=!1;initServer=!1;drawAvailable=0;keepAvailable=0;constructor(n,i,e){this.element=n,this.dialog=i,this.ghsManager=e,this.element.nativeElement.addEventListener("pointerdown",o=>{let g=document.elementsFromPoint(o.clientX,o.clientY);g[0].classList.contains("deck")&&g.length>2&&g[2].click()})}ngOnInit(){this.current=this.deck.current,this.internalDraw=-99,this.compact=this.deck.cards.length>0&&p.f.settings.automaticAttackModifierFullscreen&&p.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400);const n=s.E.game.party.buildings.find(i=>"town-hall"==i.name&&i.level&&"wrecked"!=i.state);n&&(this.drawAvailable=n.level,this.keepAvailable=Math.ceil(n.level/2)),this.disabled=!s.E.roundManager.firstRound||s.E.game.state==D.mk.next||!s.E.game.scenario||!this.deck.cards.length,this.drawDisabled=this.disabled||this.deck.current-this.deck.finished>=this.drawAvailable,this.init||(this.drawTimeout=setTimeout(()=>{this.current=this.deck.current,this.drawTimeout=null,this.init=!0},p.f.settings.animations?this.initTimeout*p.f.settings.animationSpeed:0)),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:i=>{this.update(i)}}),window.addEventListener("resize",i=>{this.compact=this.deck.cards.length>0&&p.f.settings.automaticAttackModifierFullscreen&&p.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)}),window.addEventListener("fullscreenchange",i=>{this.compact=this.deck.cards.length>0&&p.f.settings.automaticAttackModifierFullscreen&&p.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}ngOnChanges(n){n.deck&&this.update()}update(n=!1){const i=s.E.game.party.buildings.find(e=>"town-hall"==e.name&&e.level&&"wrecked"!=e.state);i&&(this.drawAvailable=i.level,this.keepAvailable=Math.ceil(i.level/2)),this.disabled=!s.E.roundManager.firstRound||s.E.game.state==D.mk.next||!s.E.game.scenario||!this.deck.cards.length,this.drawDisabled=this.disabled||this.deck.current-this.deck.finished>=this.drawAvailable,this.initServer&&s.E.stateManager.wsState()!=WebSocket.OPEN&&(this.initServer=!1),this.deck.active?!this.init||n&&!this.initServer?(this.current=this.deck.current,n&&!this.initServer&&(this.initServer=!0)):this.current<this.deck.current?(this.queue=Math.max(0,this.deck.current-this.current),this.queueTimeout||(this.queue--,this.current++,this.drawQueue(n))):(!this.queueTimeout||this.deck.current<this.current+this.queue)&&(this.queueTimeout&&(clearTimeout(this.queueTimeout),this.queueTimeout=null),this.queue=0,this.drawing=!1,this.current=this.deck.current):(this.queueTimeout&&(clearTimeout(this.queueTimeout),this.queueTimeout=null),this.queue=0,this.drawing=!1,this.current=this.deck.current,this.initServer=s.E.stateManager.wsState()==WebSocket.OPEN),this.compact=p.f.settings.automaticAttackModifierFullscreen&&p.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)}drawQueue(n){this.drawing=!0,this.element.nativeElement.getElementsByClassName("deck")[0].classList.add("drawing"),this.queueTimeout=setTimeout(()=>{this.drawing=!1,this.queueTimeout=null,this.queue>0?(this.queue--,this.current++,this.drawQueue(n)):(this.element.nativeElement.getElementsByClassName("deck")[0].classList.remove("drawing"),this.queue<0&&(this.queue=0))},p.f.settings.animations?1050*p.f.settings.animationSpeed:0)}draw(n){this.compact&&this.fullscreen?this.openFullscreen(n):!this.drawDisabled&&this.deck.cards.length>0?!this.drawTimeout&&this.deck.current<this.deck.cards.length-(0==this.queue?0:1)&&(this.drawTimeout=setTimeout(()=>{this.before.emit(new Bt(this.deck,"challengeDeck.draw")),s.E.challengesManager.drawCard(this.deck),this.after.emit(new Bt(this.deck,"challengeDeck.draw")),this.drawTimeout=null},p.f.settings.animations?150*p.f.settings.animationSpeed:0)):this.dialog.open(fr,{panelClass:["dialog"],data:{deck:this.deck,before:this.before,after:this.after}})}openFullscreen(n){this.fullscreen&&(this.dialog.open(Cr,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:{deck:this.deck,before:this.before,after:this.after}}),n.preventDefault(),n.stopPropagation())}clickCard(n,i){this.disabled?this.open(i):n<=this.current&&(this.before.emit(new Bt(this.deck,"challengeDeck.toggle",n)),s.E.challengesManager.toggleKeep(this.deck,n,this.keepAvailable),this.after.emit(new Bt(this.deck,"challengeDeck.toggle",n)))}doubleClickCard(n,i){(!this.drawing||n>this.current)&&this.open(i)}open(n){this.deck.cards.length>0&&this.fullscreen&&p.f.settings.automaticAttackModifierFullscreen&&p.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)?this.openFullscreen(n):this.dialog.open(fr,{panelClass:["dialog"],data:{deck:this.deck,before:this.before,after:this.after}}),n.preventDefault(),n.stopPropagation()}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT),t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-challenge-deck"]],inputs:{deck:"deck",bottom:"bottom",fullscreen:"fullscreen",vertical:"vertical",initTimeout:"initTimeout"},outputs:{before:"before",after:"after"},standalone:!1,features:[t.OA$],decls:11,vars:17,consts:[["card",""],[1,"deck",3,"ngClass"],[1,"challenge-container","draw"],[1,"challenge-card",3,"click","ngClass"],[1,"number"],[1,"fullscreen",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"settings",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"fullscreen",3,"click","ghs-label","ghs-label-attribute","ngClass"],["src","./assets/images/fullscreen.svg"],[1,"settings",3,"click","ghs-label","ghs-label-attribute","ngClass"],["src","./assets/images/settings.svg",1,"ghs-svg"],["ghs-pointer-input","",1,"challenge-container",3,"z-index","ngClass","right"],["ghs-pointer-input","",1,"challenge-container",3,"singleClick","doubleClick","ngClass"],[1,"challenge-card",3,"challenge","keep","flipped","disableFlip"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3,0),t.bIt("click",function(m){return c.eBV(o),c.Njj(e.draw(m))}),t.j41(4,"span",4),t.EFF(5),t.k0s()(),t.nVh(6,F5,2,6,"span",5),t.nVh(7,X5,2,7,"span",6),t.k0s(),t.Z7z(8,Y5,1,1,null,null,V5),t.nI1(10,"trackUUID"),t.k0s()}if(2&i){const o=t.sdS(3);t.Y8G("ngClass",t.sMw(11,S5,e.disabled,e.vertical,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.scenario)),t.R7$(),t.xc7("z-index",e.deck.cards.length+1),t.R7$(),t.xc7("font-size",.08*o.offsetWidth+"px"),t.Y8G("ngClass",t.eq3(15,D5,e.drawDisabled)),t.R7$(3),t.JRh(e.deck.current<e.deck.cards.length-1?e.deck.cards.length-e.deck.current-1+"/"+e.deck.cards.length:0),t.R7$(),t.vxM(e.fullscreen&&!e.compact?6:-1),t.R7$(),t.vxM(!e.compact||e.vertical?7:-1),t.R7$(),t.Dyx(t.bMT(10,9,e.deck.cards))}},dependencies:[N.YU,wa,it,dt,ct],styles:[".deck[_ngcontent-%COMP%]{position:relative;width:100%;height:100%}.deck[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%]{position:absolute;width:30%;padding-top:45%;bottom:0;right:0}.deck[_ngcontent-%COMP%]   .challenge-card[_ngcontent-%COMP%]{position:absolute;inset:0;cursor:pointer;display:block;transition:filter calc(var(--ghs-animation-speed) * 1s) ease-in-out}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .challenge-card[_ngcontent-%COMP%]{cursor:pointer;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(challenge-back.73584a0c39f15db5.png);border-radius:5%;transition:filter calc(var(--ghs-animation-speed) * 1s) ease-in-out}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .challenge-card[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);position:absolute;font-size:2em;line-height:1em;left:5%;bottom:0%;z-index:500}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .challenge-card.disabled[_ngcontent-%COMP%]{cursor:initial;filter:grayscale(.7)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .challenge-card.disabled[_ngcontent-%COMP%]:hover{transition:filter calc(var(--ghs-animation-speed) * .25s) linear,transform calc(var(--ghs-animation-speed) * .8s) cubic-bezier(.75,0,.85,1),top calc(var(--ghs-animation-speed) * .5s) linear,left calc(var(--ghs-animation-speed) * .5s) linear;filter:grayscale(15%)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]{cursor:pointer;right:-14%;font-family:var(--ghs-font-gh-title);display:flex;justify-content:center;position:absolute;color:var(--ghs-color-white);width:22%;height:15%;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-character-icon.83c1ab396221d56b.png);transition:transform calc(var(--ghs-animation-speed) * .5s) ease-in-out;transform:scale(1.1)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.minimize[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.minimize[_ngcontent-%COMP%]{transform:scale(0)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.fullscreen[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.fullscreen[_ngcontent-%COMP%]{cursor:zoom-in;bottom:32.5%}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.settings[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.settings[_ngcontent-%COMP%]{cursor:help;bottom:-4%}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.settings.without-fullscreen[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.settings.without-fullscreen[_ngcontent-%COMP%]{top:50%;bottom:initial;transform:translateY(-50%)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:60%;width:auto;align-self:center;filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}@keyframes _ngcontent-%COMP%_challenge-draw{0%{transform:scale(1) translate(102%,16.5%)}35%,70%{transform:scale(1.1) translate(51%,25%)}to{transform:scale(1) translate(0)}}@keyframes _ngcontent-%COMP%_challenge-draw-bottom{0%{transform:scale(1) translate(102%,-16.5%)}35%,70%{transform:scale(1.6) translate(110%,-90%)}to{transform:scale(1) translate(0)}}@keyframes _ngcontent-%COMP%_challenge-last{0%{right:42%;transform:rotate(0)}70%{right:42%;transform:rotate(0)}to{right:75%;transform:rotate(-5deg)}}.deck[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{position:absolute;bottom:0;right:31.5%;z-index:1}.deck[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]{position:absolute;bottom:0;right:55%;transform:rotate(-5deg);z-index:0}.deck[_ngcontent-%COMP%]   .discarded.last[_ngcontent-%COMP%]:hover{z-index:100!important}.deck.drawing[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]{cursor:wait!important}.deck.drawing[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{cursor:wait!important;animation:_ngcontent-%COMP%_challenge-draw calc(var(--ghs-animation-speed) * 1s) ease-in-out;animation-iteration-count:1}.deck.drawing[_ngcontent-%COMP%]   .current.bottom[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_challenge-draw-bottom calc(var(--ghs-animation-speed) * 1s) ease-in-out}.deck.drawing[_ngcontent-%COMP%]   .last[_ngcontent-%COMP%]{cursor:wait!important;animation:_ngcontent-%COMP%_challenge-last calc(var(--ghs-animation-speed) * 1s) ease-in-out;animation-iteration-count:1}.deck[_ngcontent-%COMP%]   .unkept[_ngcontent-%COMP%]{filter:grayscale(.9)}.vertical[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%]{top:0;bottom:initial;left:0}.vertical[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{top:0;bottom:initial;position:absolute;transform:translateY(110%);z-index:1}.vertical[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%], .vertical[_ngcontent-%COMP%]   .last[_ngcontent-%COMP%]{position:absolute;top:0;bottom:initial;left:30%;transform:translateY(118%) rotate(5deg);z-index:0}@keyframes _ngcontent-%COMP%_challenge-draw-vertical{0%{transform:scale(1)}35%,70%{transform:scale(1.1) translate(15%,125%)}to{transform:scale(1) translateY(110%)}}@keyframes _ngcontent-%COMP%_challenge-last-vertical{0%{left:0;transform:translateY(110%) rotate(0)}70%{left:0;transform:translateY(110%) rotate(0)}to{left:30%;transform:translateY(118%) rotate(5deg)}}.vertical.drawing[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_challenge-draw-vertical calc(var(--ghs-animation-speed) * 1s) ease-in-out}.vertical.drawing[_ngcontent-%COMP%]   .last[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_challenge-last-vertical calc(var(--ghs-animation-speed) * 1s) ease-in-out}"]})}return a})();const U5=["menu"],vr=a=>[a],Or=a=>({disabled:a}),N5=()=>[],qi=(a,r)=>r._trackUUID;function z5(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",16),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return e.configuration=!e.configuration,c.Njj(e.enhancements=!1)}),t.nrm(1,"img",17)(2,"span",8),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","game.loot.config."+(n.configuration?"hide":"show"))}}function L5(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",12),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.reveal=(e.reveal+1)%3)}),t.nrm(1,"span",8),t.k0s(),t.j41(2,"a",13),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.shuffle())})("doubleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.shuffle(!0))}),t.nrm(3,"span",8),t.k0s(),t.j41(4,"label")(5,"input",14),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleEdit())}),t.k0s(),t.nrm(6,"span",8),t.k0s(),t.nVh(7,z5,3,1,"a",15)}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label",2==n.reveal?"game.cards.coverAll":0==n.reveal?"game.cards.revealAll":"game.cards.revealAllConfirm"),t.R7$(),t.Y8G("ghs-tooltip","game.cards.shuffle.upcomingHint")("overlayX","center"),t.R7$(),t.Y8G("ghs-label","game.cards.shuffle"),t.R7$(2),t.Y8G("checked",n.edit),t.R7$(),t.Y8G("ghs-label","game.cards.edit"),t.R7$(),t.vxM(n.edit?7:-1)}}function q5(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",14),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleSpecial(e.LootType.special1))}),t.k0s(),t.nrm(2,"span",18),t.k0s(),t.j41(3,"label")(4,"input",14),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleSpecial(e.LootType.special2))}),t.k0s(),t.nrm(5,"span",18),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("checked",n.gameManager.game.lootDeckFixed.includes(n.LootType.special1)),t.R7$(),t.Y8G("ghs-label","game.loot.toggleSpecial")("ghs-label-args",t.eq3(6,vr,n.LootType.special1)),t.R7$(2),t.Y8G("checked",n.gameManager.game.lootDeckFixed.includes(n.LootType.special2)),t.R7$(),t.Y8G("ghs-label","game.loot.toggleSpecial")("ghs-label-args",t.eq3(8,vr,n.LootType.special2))}}function H5(a,r){if(1&a){const n=t.RV6();t.j41(0,"label"),t.nrm(1,"img",7)(2,"span",8),t.k0s(),t.j41(3,"a",22),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.changeType(e,-1))}),t.nrm(4,"img",23),t.k0s(),t.j41(5,"span",24),t.EFF(6),t.k0s(),t.j41(7,"a",22),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.changeType(e,1))}),t.nrm(8,"img",25),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+(n==i.LootType.special1||n==i.LootType.special2?i.LootType.money:n)+".svg",t.B4B),t.R7$(),t.Y8G("ghs-label","game.loot."+n),t.R7$(),t.Y8G("ngClass",t.eq3(7,Or,!i.lootDeckConfig[n]||n==i.LootType.random_item&&i.gameManager.lootManager.randomItemLooted())),t.R7$(2),t.Y8G("ghs-label","game.loot."+n)("ghs-label-attribute","title"),t.R7$(),t.SpI(" ",i.lootDeckConfig[n]&&"x"+i.lootDeckConfig[n]||"-"," "),t.R7$(),t.Y8G("ngClass",t.eq3(9,Or,i.lootDeckConfig[n]==i.maxValue(n)||n==i.LootType.random_item&&i.gameManager.lootManager.randomItemLooted()))}}function K5(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",12),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.currentConfig())}),t.nrm(1,"span",8),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","game.loot.config.discard"))}function W5(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",9)(1,"label",19),t.nrm(2,"span",8),t.k0s(),t.j41(3,"div",20),t.Z7z(4,H5,9,11,null,null,t.fX1),t.k0s(),t.j41(6,"div",21),t.nVh(7,K5,2,1,"a"),t.j41(8,"a",12),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.applyConfig())}),t.nrm(9,"span",8),t.k0s()()()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","game.loot.config"),t.R7$(2),t.Dyx(n.types),t.R7$(3),t.vxM(n.deck.cards.length>0?7:-1),t.R7$(2),t.Y8G("ghs-label","game.loot.config."+(0==n.deck.cards.length?"create":"apply"))}}function Z5(a,r){if(1&a){const n=t.RV6();t.j41(0,"img",32),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2).$implicit,o=t.XpG(2);return c.Njj(o.unenhanceCard(e))}),t.k0s()}2&a&&t.Y8G("ghs-label","game.loot.enhancements.remove")("ghs-label-attribute","title")}function J5(a,r){if(1&a&&(t.j41(0,"div",30),t.Z7z(1,Z5,1,2,"img",31,t.fX1),t.nI1(3,"ghsRange"),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.Dyx(t.i5U(3,0,t.lJ4(3,N5),n.enhancements))}}function Q5(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",26),t.nrm(1,"ghs-loot",27),t.j41(2,"a",28),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.enhanceCard(e))}),t.nrm(3,"img",29),t.k0s(),t.nVh(4,J5,4,4,"div",30),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(),t.Y8G("loot",n)("flipped",!0)("highlight",!1)("apply",i.apply),t.R7$(),t.Y8G("ghs-label","game.loot.enhancements.add")("ghs-label-attribute","title"),t.R7$(2),t.vxM(n.enhancements>0?4:-1)}}function tG(a,r){if(1&a&&(t.j41(0,"div",10),t.Z7z(1,Q5,5,7,"div",26,qi),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(t.bMT(3,0,n.enhancementDeck))}}function nG(a,r){1&a&&t.nrm(0,"div",35)}function eG(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",41),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG(2);return c.Njj(o.remove(e+o.deck.current+1))}),t.nrm(1,"img",23),t.k0s()}}function aG(a,r){1&a&&t.nrm(0,"div",40)}function iG(a,r){if(1&a&&(t.j41(0,"div",36),t.nrm(1,"ghs-loot",38),t.nVh(2,eG,2,0,"a",39),t.nVh(3,aG,1,0,"div",40),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.R7$(),t.Y8G("loot",n)("reveal",!0)("flipped",2==e.reveal)("index",e.deck.current+i+1)("character",e.getCharacter(e.deck.current+i+1))("apply",e.apply),t.R7$(),t.vxM(e.edit?2:-1),t.R7$(),t.vxM(e.edit?3:-1)}}function oG(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",41),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG(2);return c.Njj(o.remove(o.deck.current-e))}),t.nrm(1,"img",23),t.k0s()}}function sG(a,r){1&a&&t.nrm(0,"div",40)}function rG(a,r){if(1&a&&(t.j41(0,"div",36),t.nrm(1,"ghs-loot",42),t.nVh(2,oG,2,0,"a",39),t.nVh(3,sG,1,0,"div",40),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.R7$(),t.Y8G("loot",n)("flipped",!0)("index",e.deck.current-i)("character",e.getCharacter(e.deck.current-i))("edit",e.edit)("looted",!0)("apply",e.apply),t.R7$(),t.vxM(e.edit?2:-1),t.R7$(),t.vxM(e.edit?3:-1)}}function cG(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",33)(1,"div",34,1),t.bIt("cdkDropListDropped",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.dropUpcoming(e))}),t.nVh(3,nG,1,0,"div",35),t.Z7z(4,iG,4,8,"div",36,qi),t.nI1(6,"trackUUID"),t.k0s(),t.j41(7,"div",37,2),t.bIt("cdkDropListDropped",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.dropDiscarded(e))}),t.nrm(9,"div",35),t.Z7z(10,rG,4,9,"div",36,qi),t.nI1(12,"trackUUID"),t.k0s()()}if(2&a){const n=t.sdS(2),i=t.sdS(8),e=t.XpG();t.xc7("max-height",e.maxHeight),t.R7$(),t.Y8G("cdkDropListDisabled",!e.edit)("cdkDropListConnectedTo",i)("cdkDropListAutoScrollStep",20),t.R7$(2),t.vxM(0==e.upcomingCards.length?3:-1),t.R7$(),t.Dyx(t.bMT(6,9,e.upcomingCards)),t.R7$(3),t.Y8G("cdkDropListDisabled",!e.edit)("cdkDropListConnectedTo",n)("cdkDropListAutoScrollStep",20),t.R7$(3),t.Dyx(t.bMT(12,11,e.discardedCards))}}let Pr=(()=>{class a{data;dialogRef;ghsManager;menuElement;gameManager=s.E;GameState=D.mk;reveal=0;edit=!1;apply=!0;maxHeight="";deck;before;after;types=Object.values(rt.r6);lootDeckConfig={};startlootDeckConfig={};LootType=rt.r6;type=rt.r6.money;current=-1;drawing=!1;configuration=!1;enhancements=!1;characters=!0;upcomingCards=[];discardedCards=[];enhancementDeck=[];constructor(n,i,e){this.data=n,this.dialogRef=i,this.ghsManager=e,this.deck=n.deck,this.characters=n.characters,this.before=n.before,this.after=n.after,this.apply=n.apply}ngOnInit(){this.currentConfig(),setTimeout(()=>{this.maxHeight="calc(80vh - "+this.menuElement.nativeElement.offsetHeight+"px)"},p.f.settings.animations?250*p.f.settings.animationSpeed:0),0==this.deck.cards.length&&(this.edit=!0,this.configuration=!0),this.dialogRef.closed.subscribe({next:()=>{let n=new rt.yX;JSON.stringify(this.startlootDeckConfig)!=JSON.stringify(this.lootDeckConfig)&&(s.E.lootManager.apply(n,this.lootDeckConfig),this.applyConfig())}}),this.enhancementDeck=s.E.lootManager.fullLootDeck().filter(n=>rt.rz.includes(n.type)).sort((n,i)=>n.cardId-i.cardId),this.update(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.update()})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.upcomingCards=this.deck.cards.filter((n,i)=>i>this.deck.current),this.discardedCards=this.deck.cards.filter((n,i)=>i<=this.deck.current).reverse()}enhanceCard(n){this.before.emit(new Lt(this.deck,"lootDeckAddEnhancement",n.type,s.E.lootManager.valueLabel(n))),n.enhancements++,s.E.game.lootDeckEnhancements=this.enhancementDeck.filter(i=>i.enhancements>0),this.after.emit(new Lt(this.deck,"lootDeckAddEnhancement",n.type,s.E.lootManager.valueLabel(n))),this.update()}unenhanceCard(n){n.enhancements>0&&(this.before.emit(new Lt(this.deck,"lootDeckRemoveEnhancement",n.type,s.E.lootManager.valueLabel(n))),n.enhancements--,s.E.game.lootDeckEnhancements=this.enhancementDeck.filter(i=>i.enhancements>0),this.after.emit(new Lt(this.deck,"lootDeckRemoveEnhancement",n.type,s.E.lootManager.valueLabel(n)))),this.update()}toggleEdit(){this.edit=!this.edit,this.edit||(this.configuration=!1,this.enhancements=!1),setTimeout(()=>{this.maxHeight="calc(80vh - "+this.menuElement.nativeElement.offsetHeight+"px)"},0)}toggleEnhancements(){this.enhancements=!this.enhancements,this.edit=!1,this.configuration=!1,!this.enhancements&&0==this.deck.cards.length&&(this.edit=!0,this.configuration=!0)}toggleSpecial(n){const i=s.E.game.lootDeckFixed.indexOf(n),e=0!=this.deck.cards.length;this.before.emit(new Lt(this.deck,"lootDeckChangeConfig")),-1==i?(s.E.game.lootDeckFixed.push(n),e&&(this.lootDeckConfig[n]=1)):(s.E.game.lootDeckFixed.splice(i,1),e&&(this.lootDeckConfig[n]=0)),this.after.emit(new Lt(this.deck,"lootDeckChangeConfig")),this.update()}maxValue(n){return s.E.lootManager.fullLootDeck().filter(i=>i.type==n).length}currentConfig(){this.types.forEach(n=>{const i=this.deck.cards.filter(e=>e.type==n).length;this.lootDeckConfig[n]=i>0?i:void 0}),this.startlootDeckConfig=JSON.parse(JSON.stringify(this.lootDeckConfig))}applyConfig(){const n=0==this.deck.cards.length;(Object.values(this.lootDeckConfig).reduce((i,e)=>(i||0)+(e||0))>0||!n)&&(this.before.emit(new Lt(this.deck,"lootDeckChangeConfig")),s.E.lootManager.apply(this.deck,this.lootDeckConfig),s.E.lootManager.shuffleDeck(this.deck),this.types.forEach(i=>{0==this.lootDeckConfig[i]&&(this.lootDeckConfig[i]=void 0)}),this.after.emit(new Lt(this.deck,"lootDeckChangeConfig")),this.deck.cards.length>0&&(n?(0,F.co)(this.dialogRef):this.toggleEdit())),this.update()}changeType(n,i){this.lootDeckConfig[n]=(this.lootDeckConfig[n]||0)+i,0==this.lootDeckConfig[n]&&(this.lootDeckConfig[n]=void 0),this.update()}shuffle(n=!1){this.before.emit(new Lt(this.deck,"lootDeckShuffle"+(n?"Upcoming":""))),s.E.lootManager.shuffleDeck(this.deck,n),s.E.game.figures.forEach(i=>{i instanceof H.K&&(i.lootCards=i.lootCards.filter(e=>e<=this.deck.current))}),this.after.emit(new Lt(this.deck,"lootDeckShuffle"+(n?"Upcoming":""))),this.update()}dropUpcoming(n){this.before.emit(new Lt(this.deck,"lootDeckReorder"));let i=0,e=0,o=0;n.container==n.previousContainer?(i=this.deck.current+1,e=n.previousIndex+i,o=n.currentIndex+i,(0,V.HD)(this.deck.cards,e,o)):(i=this.deck.current,e=i-n.previousIndex,o=n.currentIndex+i,(0,V.HD)(this.deck.cards,e,o),this.deck.current=this.deck.current-1),s.E.game.figures.forEach(g=>{g instanceof H.K&&g.lootCards&&(g.lootCards=g.lootCards.map(m=>(e<o&&m>e&&m<=o?m--:e>o&&m>=o&&m<e?m++:m==e&&(m=o),m)).sort((m,k)=>m-k))}),s.E.game.figures.forEach(g=>{g instanceof H.K&&(g.lootCards=g.lootCards.filter(m=>m<=this.deck.current))}),this.after.emit(new Lt(this.deck,"lootDeckReorder")),this.update()}dropDiscarded(n){this.before.emit(new Lt(this.deck,"lootDeckReorder"));let i=0,e=0,o=0;n.container==n.previousContainer?(i=this.deck.current,e=i-n.previousIndex,o=i-n.currentIndex,(0,V.HD)(this.deck.cards,e,o)):(this.deck.current=this.deck.current+1,i=this.deck.current,e=i+n.previousIndex,o=i-n.currentIndex,(0,V.HD)(this.deck.cards,e,o)),s.E.game.figures.forEach(g=>{g instanceof H.K&&g.lootCards&&(g.lootCards=g.lootCards.map(m=>(e<o&&m>e&&m<=o?m--:e>o&&m>=o&&m<e?m++:m==e&&(m=o),m)).sort((m,k)=>m-k))}),this.after.emit(new Lt(this.deck,"lootDeckReorder")),this.update()}remove(n){this.before.emit(new Lt(this.deck,"lootDeckRemoveCard",n)),n<=this.deck.current&&(this.deck.current--,this.current=this.deck.current),this.deck.cards.splice(n,1),this.after.emit(new Lt(this.deck,"lootDeckRemoveCard",n)),this.update()}countLoot(n){return this.deck.cards.filter(i=>i.type==n).length}countDrawnLoot(n){return this.deck.cards.filter((i,e)=>i.type==n&&e<=this.deck.current).length}countUpcomingLoot(n){return this.deck.cards.filter((i,e)=>i.type==n&&e>this.deck.current).length}getCharacter(n){if(this.characters){const i=s.E.game.figures.find(e=>e instanceof H.K&&e.lootCards&&e.lootCards.includes(n));if(i)return i.name}return""}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-loot-deck-dialog"]],viewQuery:function(i,e){if(1&i&&t.GBs(U5,5),2&i){let o;t.mGM(o=t.lsd())&&(e.menuElement=o.first)}},standalone:!1,decls:12,vars:7,consts:[["menu",""],["upcomingList","cdkDropList"],["discardedList","cdkDropList"],[1,"loot-deck-dialog"],[1,"scroll-container"],[1,"menu"],[1,"toggle-enhancements",3,"click"],[1,"ghs-svg",3,"src"],[3,"ghs-label"],[1,"config"],[1,"enhancements"],[1,"loot-deck-container",3,"maxHeight"],[3,"click"],["ghs-pointer-input","",3,"singleClick","doubleClick","ghs-tooltip","overlayX"],["type","checkbox",3,"click","checked"],[1,"toggle-config"],[1,"toggle-config",3,"click"],["src","./assets/images/settings.svg",1,"ghs-svg"],[3,"ghs-label","ghs-label-args"],[1,"title"],[1,"values"],[1,"config-menu"],[1,"button",3,"click","ngClass"],["src","./assets/images/minus.svg",1,"ghs-svg"],[1,"value",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg",1,"ghs-svg"],[1,"loot-container"],[1,"drag-hidden",3,"loot","flipped","highlight","apply"],[1,"button-enhance",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/fh/loot/plus1.svg",1,"ghs-svg"],[1,"remove-enhancements"],["src","./assets/images/fh/loot/plus1.svg",1,"ghs-svg",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/fh/loot/plus1.svg",1,"ghs-svg",3,"click","ghs-label","ghs-label-attribute"],[1,"loot-deck-container"],["cdkDropList","",1,"upcoming","drop-list",3,"cdkDropListDropped","cdkDropListDisabled","cdkDropListConnectedTo","cdkDropListAutoScrollStep"],[1,"empty"],["cdkDrag","",1,"loot-container"],["cdkDropList","",1,"discarded","drop-list",3,"cdkDropListDropped","cdkDropListDisabled","cdkDropListConnectedTo","cdkDropListAutoScrollStep"],[1,"drag-hidden",3,"loot","reveal","flipped","index","character","apply"],[1,"button-remove"],["cdkDragHandle","",1,"drag-handle"],[1,"button-remove",3,"click"],[1,"drag-hidden",3,"loot","flipped","index","character","edit","looted","apply"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",3)(1,"div",4)(2,"div",5,0),t.nVh(4,L5,8,7),t.j41(5,"a",6),t.bIt("click",function(){return c.eBV(o),c.Njj(e.toggleEnhancements())}),t.nrm(6,"img",7)(7,"span",8),t.k0s(),t.nVh(8,q5,6,10),t.k0s(),t.nVh(9,W5,10,3,"div",9),t.nVh(10,tG,4,2,"div",10),t.nVh(11,cG,13,13,"div",11),t.k0s()()}2&i&&(t.R7$(4),t.vxM(e.deck.cards.length>0?4:-1),t.R7$(2),t.Y8G("src","./assets/images/fh/loot/"+(e.enhancements?"money":"plus1")+".svg",t.B4B),t.R7$(),t.Y8G("ghs-label","game.loot."+(e.enhancements&&e.gameManager.game.scenario?"deck":"enhancements")),t.R7$(),t.vxM(e.enhancements?8:-1),t.R7$(),t.vxM(e.configuration?9:-1),t.R7$(),t.vxM(e.enhancements?10:-1),t.R7$(),t.vxM(e.configuration||e.enhancements?-1:11))},dependencies:[N.YU,V.O7,V.T1,V.Fb,it,Mt,ja,dt,At,ct],styles:['.loot-deck-dialog[_ngcontent-%COMP%]{position:relative}.loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;flex-wrap:wrap;max-width:calc(var(--ghs-unit) * 60 * var(--ghs-dialog-factor))}.loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]{pointer-events:none}.loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{cursor:pointer;appearance:none;background-color:var(--form-background);width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));border-width:calc(var(--ghs-unit) * .3);border-style:solid;display:grid;place-content:center;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before{left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));position:relative;content:" ";width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));transform:scale(0);transform-origin:bottom left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;clip-path:polygon(14% 44%,0 65%,50% 100%,100% 16%,80% 0%,43% 62%);color:var(--ghs-color-gray);background-color:var(--ghs-color-gray)}.loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked:before{transform:scale(1)}.loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover:before{background-color:var(--ghs-color-white)}.loot-deck-dialog[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1em;width:auto;margin:0 .3em;filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.loot-deck-dialog[_ngcontent-%COMP%]   .config[_ngcontent-%COMP%]{margin-bottom:5%;min-height:500px}.loot-deck-dialog[_ngcontent-%COMP%]   .config[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline);margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.loot-deck-dialog[_ngcontent-%COMP%]   .config[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto auto auto;font-size:1.5em}.loot-deck-dialog[_ngcontent-%COMP%]   .config[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-white);display:flex;justify-content:flex-start;align-items:center;white-space:nowrap}.loot-deck-dialog[_ngcontent-%COMP%]   .config[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white);margin-right:.3em}.loot-deck-dialog[_ngcontent-%COMP%]   .config[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--ghs-color-white);display:flex;justify-content:center;align-items:center;padding:.3em}.loot-deck-dialog[_ngcontent-%COMP%]   .config[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;padding:.3em}.loot-deck-dialog[_ngcontent-%COMP%]   .config[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.loot-deck-dialog[_ngcontent-%COMP%]   .config[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .button.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}.loot-deck-dialog[_ngcontent-%COMP%]   .config[_ngcontent-%COMP%]   .config-menu[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.loot-deck-dialog[_ngcontent-%COMP%]   .config[_ngcontent-%COMP%]   .config-menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:2em;padding:.3em}.loot-deck-dialog[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-evenly;align-items:center;overflow-y:auto;overflow-x:hidden;width:calc(var(--ghs-unit) * 57 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.loot-deck-dialog[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]{position:relative;display:flex;transition:none;width:calc(var(--ghs-unit) * 25.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 38.25 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) 0;flex-shrink:0;flex-grow:0}.loot-deck-dialog[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]   ghs-loot[_ngcontent-%COMP%]{position:absolute;display:flex;top:0;left:0;width:100%;height:100%;z-index:1}.loot-deck-dialog[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]   .button-enhance[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:2}.loot-deck-dialog[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]   .button-enhance[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));height:auto}.loot-deck-dialog[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]   .button-enhance[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]:hover{filter:var(--ghs-filter-gray) brightness(1.5)}.loot-deck-dialog[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]   .remove-enhancements[_ngcontent-%COMP%]{position:absolute;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;top:50%;left:50%;height:50%;width:100%;transform:translate(-50%,-50%);z-index:2}.loot-deck-dialog[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]   .remove-enhancements[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{cursor:pointer;width:20%;height:auto;margin:5%;transition:all calc(var(--ghs-animation-speed) * .1s) ease-in-out;filter:none}.loot-deck-dialog[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]   .remove-enhancements[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]:hover{filter:var(--ghs-filter-red);opacity:.6}.loot-deck-dialog[_ngcontent-%COMP%]   .drop-list[_ngcontent-%COMP%]{position:relative}.loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]{display:flex;width:calc(var(--ghs-unit) * 60 * var(--ghs-dialog-factor));overflow:auto}.loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;overflow-y:auto;overflow-x:hidden;width:calc(var(--ghs-unit) * 30 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{position:relative;display:flex;transition:none;width:calc(var(--ghs-unit) * 25.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 38.25 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) 0;flex-shrink:0;flex-grow:0}.loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]   ghs-loot[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   ghs-loot[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]   ghs-loot[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   ghs-loot[_ngcontent-%COMP%]{position:absolute;display:flex;top:0;left:0;width:100%;height:100%}.loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .7 * var(--ghs-dialog-factor));display:block;border-style:dashed;border-width:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor));border-color:var(--ghs-color-white);width:calc(var(--ghs-unit) * 25.1 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 37 * var(--ghs-dialog-factor));border-radius:5%}.loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]{z-index:1;position:absolute;display:flex;cursor:pointer;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-filter-white) var(--ghs-filter-shadow)}.loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:100%;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-shadow)}.loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{position:absolute;cursor:grab;left:50%;top:65%;width:60%;height:70%;transform:translate(-50%,-50%)}.cdk-drag-preview[_ngcontent-%COMP%]{opacity:0;cursor:grabbing;z-index:999}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.5;cursor:grabbing}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}']})}return a})();const lG=a=>({vertical:a});let br=(()=>{class a{data;dialogRef;configuration=!1;deck;before;after;constructor(n,i){this.data=n,this.dialogRef=i,this.deck=n.deck,this.before=n.before,this.after=n.after}ngOnInit(){0==this.deck.cards.length&&(this.configuration=!0)}vertical(){return window.innerWidth<800}beforeLootDeck(n){this.before.emit(n)}afterLootDeck(n){this.after.emit(n)}close(){(0,F.co)(this.dialogRef)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-loot-deck-fullscreen"]],standalone:!1,decls:4,vars:6,consts:[[1,"loot-deck-fullscreen",3,"ngClass"],[3,"before","after","deck","fullscreen","vertical"],[1,"close-container",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"ghs-loot-deck",1),t.bIt("before",function(g){return e.beforeLootDeck(g)})("after",function(g){return e.afterLootDeck(g)}),t.k0s(),t.j41(2,"div",2),t.bIt("click",function(){return e.close()}),t.k0s()(),t.j41(3,"div",2),t.bIt("click",function(){return e.close()}),t.k0s()),2&i&&(t.Y8G("ngClass",t.eq3(4,lG,e.vertical())),t.R7$(),t.Y8G("deck",e.deck)("fullscreen",!1)("vertical",e.vertical()))},styles:[".loot-deck-fullscreen[_ngcontent-%COMP%]{width:100vw;height:100vh;overflow-x:auto;overflow-y:auto;display:flex;flex-direction:column;justify-content:flex-start;align-items:center;z-index:3}.loot-deck-fullscreen[_ngcontent-%COMP%]   ghs-loot-deck[_ngcontent-%COMP%]{display:flex;width:99vw;max-width:600px;height:100vw;max-height:420px;z-index:4;margin-top:2em;margin-left:1%}.loot-deck-fullscreen.vertical[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden}.loot-deck-fullscreen.vertical[_ngcontent-%COMP%]   ghs-loot-deck[_ngcontent-%COMP%]{width:98vw;margin-right:1%;height:132vw;max-height:800px;transform:none}.loot-deck-fullscreen[_ngcontent-%COMP%]   .close-container[_ngcontent-%COMP%]{cursor:zoom-out;position:absolute;display:flex;width:100%;height:100%;z-index:2;top:0;left:0}"]})}return a})();const gG=(a,r,n)=>({disabled:a,vertical:r,denied:n}),kr=a=>({disabled:a}),dG=(a,r)=>({vertical:a,minimize:r}),hG=(a,r,n)=>({vertical:a,"without-fullscreen":r,minimize:n}),_G=(a,r,n,i)=>({discarded:a,current:r,last:n,bottom:i}),mG=(a,r)=>r._trackUUID;function pG(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",7),t.bIt("click",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.openFullscreen(e))}),t.nrm(1,"img",8),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ghs-label","game.cards.fullscreen")("ghs-label-attribute","title")("ngClass",t.l_i(3,dG,n.vertical,!n.deck.active))}}function uG(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",9),t.bIt("click",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.open(e))}),t.nrm(1,"img",10),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ghs-label","game.cards.openDialog")("ghs-label-attribute","title")("ngClass",t.sMw(3,hG,n.vertical,!n.fullscreen,!n.deck.active))}}function fG(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",12),t.bIt("click",function(e){c.eBV(n);const o=t.XpG().$index,g=t.XpG();return c.Njj(g.clickCard(o,e))}),t.nrm(1,"ghs-loot",13),t.k0s()}if(2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG();t.xc7("z-index",e>o.current?o.deck.cards.length-e:o.deck.cards.length+e+1),t.Y8G("ngClass",t.ziG(11,_G,e<o.current-1,e==o.current,e==o.current-1,o.bottom)),t.R7$(),t.Y8G("loot",i)("flipped",e<=o.current)("looted",e<=o.current)("index",e)("disableFlip",!o.drawing||e!=o.current)("character",o.getCharacter(e))("apply",!o.standalone)("ngClass",t.eq3(16,kr,o.disabled))}}function CG(a,r){if(1&a&&t.nVh(0,fG,2,18,"div",11),2&a){const n=r.$index,i=t.XpG();t.vxM(n>i.current-3?0:-1)}}class Lt{deck;type;values;constructor(r,n,...i){this.deck=r,this.type=n,this.values=i}}let Hi=(()=>{class a{element;dialog;ghsManager;deck;bottom=!1;characters=!0;fullscreen=!0;vertical=!1;standalone=!1;before=new t.bkB;after=new t.bkB;initTimeout=1500;gameManager=s.E;settingsManager=p.f;lootManager=s.E.lootManager;current=-1;internalDraw=-99;LootType=rt.r6;GameState=D.mk;drawing=!1;drawTimeout=null;queue=0;queueTimeout=null;compact=!1;disabled=!1;init=!1;initServer=!1;constructor(n,i,e){this.element=n,this.dialog=i,this.ghsManager=e,this.element.nativeElement.addEventListener("pointerdown",o=>{let g=document.elementsFromPoint(o.clientX,o.clientY);g[0].classList.contains("deck")&&g.length>2&&g[2].click()})}ngOnInit(){this.current=this.deck.current,this.internalDraw=-99,this.compact=this.deck.cards.length>0&&p.f.settings.automaticAttackModifierFullscreen&&p.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400),this.disabled=!this.standalone&&s.E.game.state==D.mk.draw,this.init||(this.drawTimeout=setTimeout(()=>{this.current=this.deck.current,this.drawTimeout=null,this.init=!0},p.f.settings.animations?this.initTimeout*p.f.settings.animationSpeed:0)),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:n=>{this.update(n)}}),window.addEventListener("resize",n=>{this.compact=this.deck.cards.length>0&&p.f.settings.automaticAttackModifierFullscreen&&p.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)}),window.addEventListener("fullscreenchange",n=>{this.compact=this.deck.cards.length>0&&p.f.settings.automaticAttackModifierFullscreen&&p.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}ngOnChanges(n){n.deck&&this.update()}update(n=!1){this.disabled=!this.standalone&&s.E.game.state==D.mk.draw,this.initServer&&s.E.stateManager.wsState()!=WebSocket.OPEN&&(this.initServer=!1),this.deck.active||this.standalone?!this.init||n&&!this.initServer?(this.current=this.deck.current,n&&!this.initServer&&(this.initServer=!0)):this.current<this.deck.current?(this.queue=Math.max(0,this.deck.current-this.current),this.queueTimeout||(this.queue--,this.current++,this.drawQueue(n))):(!this.queueTimeout||this.deck.current<this.current+this.queue)&&(this.queueTimeout&&(clearTimeout(this.queueTimeout),this.queueTimeout=null),this.queue=0,this.drawing=!1,this.current=this.deck.current):(this.queueTimeout&&(clearTimeout(this.queueTimeout),this.queueTimeout=null),this.queue=0,this.drawing=!1,this.current=this.deck.current,this.initServer=s.E.stateManager.wsState()==WebSocket.OPEN),this.compact=p.f.settings.automaticAttackModifierFullscreen&&p.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)}drawQueue(n){this.drawing=!0,this.element.nativeElement.getElementsByClassName("deck")[0].classList.add("drawing"),this.queueTimeout=setTimeout(()=>{this.drawing=!1,this.queueTimeout=null;const i=this.current,e=this.deck.cards[i];if(this.queue>0?(this.queue--,this.current++,this.drawQueue(n)):(this.element.nativeElement.getElementsByClassName("deck")[0].classList.remove("drawing"),this.queue<0&&(this.queue=0)),!n&&e&&null!=rt.mn.indexOf(e.type)&&p.f.settings.applyLoot&&!this.standalone&&this.fullscreen&&s.E.game.figures.find(o=>o instanceof H.K&&s.E.gameplayFigure(o))){let o=s.E.game.figures.find(g=>g instanceof H.K&&g.active);!o||p.f.settings.alwaysLootApplyDialog?this.dialog.open(Ms,{panelClass:["dialog"],data:{loot:e}}).closed.subscribe({next:m=>{if(m){const k=s.E.game.figures.find(X=>X instanceof H.K&&X.name==m);k instanceof H.K&&this.applyLoot(k,e,i)}}}):o&&this.applyLoot(o,e,i)}},p.f.settings.animations?1050*p.f.settings.animationSpeed:0)}applyLoot(n,i,e){if(!n.lootCards.includes(e)){s.E.stateManager.before(i.type==rt.r6.random_item?"lootRandomItem":"addResource",s.E.characterManager.characterName(n),"game.loot."+i.type,this.lootManager.getValue(i));const o=s.E.lootManager.applyLoot(i,n,e);s.E.stateManager.after(),o&&this.dialog.open(Gi,{panelClass:["dialog"],data:{item:o,character:n}}).closed.subscribe({next:g=>{if(g){const m=g;s.E.stateManager.before("lootRandomItem",m.id,m.edition,m.name,s.E.characterManager.characterName(n));let k=new yt.gw(""+m.id,m.edition);s.E.itemManager.addItemCount(m),n.lootCards.includes(e)||(n.lootCards.push(e),n.lootCards.sort((X,at)=>X-at)),null!=n.progress.items.find(X=>X.name==""+m.id&&X.edition==m.edition)?n.progress.gold+=s.E.itemManager.itemSellValue(m):(n.progress.items.push(k),n.progress.equippedItems.push(new yt.h5(k.name,k.edition,void 0,"loot-random-item"))),s.E.stateManager.after()}else n.lootCards=n.lootCards.filter(m=>m!=m)}})}}draw(n,i=!1){if(this.compact&&this.fullscreen&&!i)this.openFullscreen(n);else if(!this.disabled&&this.deck.cards.length>0){if(!this.drawTimeout&&this.deck.current<this.deck.cards.length-(0==this.queue?0:1)){const e=s.E.game.figures.find(o=>o instanceof H.K&&o.active);this.drawTimeout=setTimeout(()=>{if(this.before.emit(new Lt(this.deck,"lootDeckDraw")),!p.f.settings.alwaysLootApplyDialog&&e instanceof H.K){const o=s.E.lootManager.drawCard(this.deck,e);o&&setTimeout(()=>{this.dialog.open(Gi,{panelClass:["dialog"],data:{item:o,character:e}}).closed.subscribe({next:g=>{if(g){const m=g;s.E.stateManager.before("lootRandomItem",m.id,m.edition,m.name,s.E.characterManager.characterName(e));let k=new yt.gw(""+m.id,m.edition);s.E.itemManager.addItemCount(m),e.lootCards.includes(this.current)||(e.lootCards.push(this.current),e.lootCards.sort((X,at)=>X-at)),null!=e.progress.items.find(X=>X.name==""+m.id&&X.edition==m.edition)?e.progress.gold+=s.E.itemManager.itemSellValue(m):(e.progress.items.push(k),e.progress.equippedItems.push(new yt.h5(k.name,k.edition,void 0,"loot-random-item"))),s.E.stateManager.after()}else e.lootCards=e.lootCards.filter(m=>m!=this.current)}})},p.f.settings.animations?1050*p.f.settings.animationSpeed:0)}else s.E.lootManager.drawCard(this.deck,void 0);this.after.emit(new Lt(this.deck,"lootDeckDraw")),this.drawTimeout=null},p.f.settings.animations?150*p.f.settings.animationSpeed:0)}}else this.dialog.open(Pr,{panelClass:["dialog"],data:{deck:this.deck,characters:this.characters,before:this.before,after:this.after,apply:!this.standalone}})}openFullscreen(n){this.fullscreen&&(this.dialog.open(br,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:{deck:this.deck,before:this.before,after:this.after}}),n.preventDefault(),n.stopPropagation())}clickCard(n,i){(!this.drawing||n>this.current)&&this.open(i)}getCharacter(n){if(this.characters){const i=s.E.game.figures.find(e=>e instanceof H.K&&e.lootCards&&e.lootCards.includes(n));if(i)return i.name}return""}open(n){this.deck.cards.length>0&&s.E.game.state==D.mk.next&&this.fullscreen&&p.f.settings.automaticAttackModifierFullscreen&&p.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)?this.openFullscreen(n):this.dialog.open(Pr,{panelClass:["dialog"],data:{deck:this.deck,characters:this.characters,before:this.before,after:this.after,apply:!this.standalone}}),n.preventDefault(),n.stopPropagation()}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT),t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-loot-deck"]],inputs:{deck:"deck",bottom:"bottom",characters:"characters",fullscreen:"fullscreen",vertical:"vertical",standalone:"standalone",initTimeout:"initTimeout"},outputs:{before:"before",after:"after"},standalone:!1,features:[t.OA$],decls:11,vars:17,consts:[["card",""],[1,"deck",3,"ngClass"],[1,"loot-container","draw"],[1,"loot-card",3,"click","ngClass"],[1,"number"],[1,"fullscreen",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"settings",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"fullscreen",3,"click","ghs-label","ghs-label-attribute","ngClass"],["src","./assets/images/fullscreen.svg"],[1,"settings",3,"click","ghs-label","ghs-label-attribute","ngClass"],["src","./assets/images/settings.svg",1,"ghs-svg"],[1,"loot-container",3,"z-index","ngClass"],[1,"loot-container",3,"click","ngClass"],[1,"loot-card",3,"loot","flipped","looted","index","disableFlip","character","apply","ngClass"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3,0),t.bIt("click",function(m){return c.eBV(o),c.Njj(e.draw(m))}),t.j41(4,"span",4),t.EFF(5),t.k0s()(),t.nVh(6,pG,2,6,"span",5),t.nVh(7,uG,2,7,"span",6),t.k0s(),t.Z7z(8,CG,1,1,null,null,mG),t.nI1(10,"trackUUID"),t.k0s()}if(2&i){const o=t.sdS(3);t.Y8G("ngClass",t.sMw(11,gG,!e.standalone&&e.gameManager.game.state==e.GameState.draw,e.vertical,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.lootDeck)),t.R7$(),t.xc7("z-index",e.deck.cards.length+1),t.R7$(),t.xc7("font-size",.08*o.offsetWidth+"px"),t.Y8G("ngClass",t.eq3(15,kr,e.disabled)),t.R7$(3),t.JRh(e.deck.current<e.deck.cards.length-1?e.deck.cards.length-e.deck.current-1+"/"+e.deck.cards.length:0),t.R7$(),t.vxM(e.fullscreen&&!e.compact?6:-1),t.R7$(),t.vxM(!e.compact||e.vertical?7:-1),t.R7$(),t.Dyx(t.bMT(10,9,e.deck.cards))}},dependencies:[N.YU,it,ja,ct],styles:[".deck[_ngcontent-%COMP%]{position:relative;width:100%;height:100%}.deck[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]{position:absolute;width:40%;padding-top:60%;bottom:0;right:0}.deck[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]{position:absolute;inset:0;cursor:pointer;display:block;transition:filter calc(var(--ghs-animation-speed) * 1s) ease-in-out}.deck[_ngcontent-%COMP%]   .loot-card.disabled[_ngcontent-%COMP%]{filter:grayscale(.8)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]{cursor:pointer;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(loot-back.b3962872f80142fe.png);border-radius:5%;transition:filter calc(var(--ghs-animation-speed) * 1s) ease-in-out}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);position:absolute;font-size:2em;line-height:1em;left:5%;bottom:0%;z-index:500}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .loot-card.disabled[_ngcontent-%COMP%]{cursor:initial;filter:grayscale(.7)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]{cursor:pointer;right:-14%;font-family:var(--ghs-font-gh-title);display:flex;justify-content:center;position:absolute;color:var(--ghs-color-white);width:22%;height:15%;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-character-icon.83c1ab396221d56b.png);transition:transform calc(var(--ghs-animation-speed) * .5s) ease-in-out;transform:scale(1.1)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.minimize[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.minimize[_ngcontent-%COMP%]{transform:scale(0)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.fullscreen[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.fullscreen[_ngcontent-%COMP%]{cursor:zoom-in;bottom:32.5%}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.settings[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.settings[_ngcontent-%COMP%]{cursor:help;bottom:-4%}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.settings.without-fullscreen[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.settings.without-fullscreen[_ngcontent-%COMP%]{top:50%;bottom:initial;transform:translateY(-50%)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:60%;width:auto;align-self:center;filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}@keyframes _ngcontent-%COMP%_loot-draw{0%{transform:scale(1) translate(102%,16.5%)}35%,70%{transform:scale(1.1) translate(51%,25%)}to{transform:scale(1) translate(0)}}@keyframes _ngcontent-%COMP%_loot-draw-bottom{0%{transform:scale(1) translate(102%,-16.5%)}35%,70%{transform:scale(1.6) translate(110%,-90%)}to{transform:scale(1) translate(0)}}@keyframes _ngcontent-%COMP%_loot-last{0%{right:42%;transform:rotate(0)}70%{right:42%;transform:rotate(0)}to{right:75%;transform:rotate(-5deg)}}.deck[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{position:absolute;bottom:0;right:42%;z-index:1}.deck[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .last[_ngcontent-%COMP%]{position:absolute;bottom:0;right:75%;transform:rotate(-5deg);z-index:0}.deck[_ngcontent-%COMP%]   .discarded.last[_ngcontent-%COMP%]:hover, .deck[_ngcontent-%COMP%]   .last.last[_ngcontent-%COMP%]:hover{z-index:100!important}.deck[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{filter:grayscale(.8)}.deck[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]:hover{transition:filter calc(var(--ghs-animation-speed) * .25s) linear,transform calc(var(--ghs-animation-speed) * .8s) cubic-bezier(.75,0,.85,1),top calc(var(--ghs-animation-speed) * .5s) linear,left calc(var(--ghs-animation-speed) * .5s) linear;filter:grayscale(15%)}.deck.drawing[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]{cursor:wait!important}.deck.drawing[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{cursor:wait!important;animation:_ngcontent-%COMP%_loot-draw calc(var(--ghs-animation-speed) * 1s) ease-in-out;animation-iteration-count:1}.deck.drawing[_ngcontent-%COMP%]   .current.bottom[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_loot-draw-bottom calc(var(--ghs-animation-speed) * 1s) ease-in-out}.deck.drawing[_ngcontent-%COMP%]   .last[_ngcontent-%COMP%]{cursor:wait!important;animation:_ngcontent-%COMP%_loot-last calc(var(--ghs-animation-speed) * 1s) ease-in-out;animation-iteration-count:1}.vertical[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]{top:0;bottom:initial;left:0}.vertical[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{top:0;bottom:initial;position:absolute;transform:translateY(110%);z-index:1}.vertical[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%], .vertical[_ngcontent-%COMP%]   .last[_ngcontent-%COMP%]{position:absolute;top:0;bottom:initial;left:30%;transform:translateY(118%) rotate(5deg);z-index:0}@keyframes _ngcontent-%COMP%_loot-draw-vertical{0%{transform:scale(1)}35%,70%{transform:scale(1.1) translate(15%,125%)}to{transform:scale(1) translateY(110%)}}@keyframes _ngcontent-%COMP%_loot-last-vertical{0%{left:0;transform:translateY(110%) rotate(0)}70%{left:0;transform:translateY(110%) rotate(0)}to{left:30%;transform:translateY(118%) rotate(5deg)}}.vertical.drawing[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_loot-draw-vertical calc(var(--ghs-animation-speed) * 1s) ease-in-out}.vertical.drawing[_ngcontent-%COMP%]   .last[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_loot-last-vertical calc(var(--ghs-animation-speed) * 1s) ease-in-out}"]})}return a})();const MG=(a,r)=>[a,r],vG=(a,r)=>r._trackUUID;function OG(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",8),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.close(e))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ghs-label","scenario.section.conclusion"+(i.data.parent.conclusion?".continue":"")+(n.named?".named":""))("ghs-label-args",t.l_i(2,MG,"%data.section:"+n.index+"%",n.named?i.gameManager.scenarioManager.scenarioTitle(n,!0):""))}}let Xn=(()=>{class a{data;dialogRef;gameManager=s.E;constructor(n,i){this.data=n,this.dialogRef=i,1==this.data.conclusions.length&&this.close(this.data.conclusions[0])}close(n=void 0){(0,F.co)(this.dialogRef,n)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-scenario-conclusion-dialog"]],standalone:!1,decls:11,vars:4,consts:[[1,"section-popup"],[1,"header"],["src","./assets/images/scenario/conclusion.svg",1,"ghs-svg"],[3,"ghs-label"],[1,"conclusions"],[1,"placeholder","text-white","conclusion",3,"ghs-label","ghs-label-args"],[1,"buttons"],[1,"cancel",3,"click"],[1,"placeholder","text-white","conclusion",3,"click","ghs-label","ghs-label-args"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"img",2)(3,"span",3),t.k0s(),t.j41(4,"div",4),t.Z7z(5,OG,1,5,"span",5,vG),t.nI1(7,"trackUUID"),t.k0s(),t.j41(8,"div",6)(9,"a",7),t.bIt("click",function(){return e.close()}),t.nrm(10,"span",3),t.k0s()()()),2&i&&(t.R7$(3),t.Y8G("ghs-label","scenario.section.conclusion.select"),t.R7$(2),t.Dyx(t.bMT(7,2,e.data.conclusions)),t.R7$(5),t.Y8G("ghs-label","scenario.section.cancel"))},dependencies:[it,ct],styles:[".section-popup[_ngcontent-%COMP%]{text-align:center;min-width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor));padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.section-popup[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.section-popup[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-white)}.section-popup[_ngcontent-%COMP%]   .conclusions[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.section-popup[_ngcontent-%COMP%]   .conclusions[_ngcontent-%COMP%]   .conclusion[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.section-popup[_ngcontent-%COMP%]   .conclusions[_ngcontent-%COMP%]   .conclusion[_ngcontent-%COMP%]:hover{opacity:.7}.section-popup[_ngcontent-%COMP%]   .conclusions[_ngcontent-%COMP%]   .conclusion[_ngcontent-%COMP%]:not(:first-child){border-top:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray)}.section-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly}.section-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}.section-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.section-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}"]})}return a})();const PG=a=>[a];function bG(a,r){1&a&&(t.j41(0,"p"),t.nrm(1,"span",3),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","round.hint.empty"))}function kG(a,r){1&a&&(t.j41(0,"p"),t.nrm(1,"span",3),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","round.hint.missingInitiative"))}function yG(a,r){1&a&&(t.j41(0,"p"),t.nrm(1,"span",3),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","round.hint.active"))}function xG(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",4),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.confirm())}),t.nrm(1,"span",3),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","round.hint.confirm"))}function EG(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",5),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.next())}),t.nrm(1,"span",3),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","round.hint.confirmTurns"))}function wG(a,r){1&a&&(t.j41(0,"p"),t.nrm(1,"span",3),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","round.hint.finish"))}function RG(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",4),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.finishScenario(!0))}),t.nrm(1,"span",3),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","round.hint.confirmFinish"))}function jG(a,r){1&a&&(t.j41(0,"p"),t.nrm(1,"span",3),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","round.hint.failed"))}function GG(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",4),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.finishScenario(!1))}),t.nrm(1,"span",3),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","round.hint.confirmFailed"))}function TG(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",4),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.resetScenario())}),t.nrm(1,"span",3),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","round.hint.confirmReset"))}function SG(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",4),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.confirm())}),t.nrm(1,"span",3),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label",n.gameManager.game.state==n.GameState.next?"round.hint.continueNext":"round.hint.continueDraw")}}function DG(a,r){1&a&&(t.j41(0,"p"),t.nrm(1,"span",3),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","round.hint.battleGoals"))}function $G(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",4),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.confirm())}),t.nrm(1,"span",3),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","round.hint.confirm"))}function IG(a,r){if(1&a&&(t.j41(0,"p"),t.nrm(1,"span",6),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","round.hint.eventDraw")("ghs-label-args",t.eq3(2,PG,n.gameManager.game.eventDraw))}}function AG(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",4),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.confirm())}),t.nrm(1,"span",3),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","round.hint.confirm"))}let VG=(()=>{class a{dialogRef;dialog;gameManager=s.E;GameState=D.mk;constructor(n,i){this.dialogRef=n,this.dialog=i}confirm(){s.E.game.figures.find(i=>i.active)&&(s.E.stateManager.before("endAllTurns"),s.E.game.figures.forEach(i=>s.E.roundManager.afterTurn(i)),s.E.stateManager.after()),this.next()}next(){(0,F.co)(this.dialogRef,!0)}finishScenario(n){if(s.E.game.scenario){const i=s.E.sectionData(s.E.game.scenario.edition).filter(e=>!!s.E.game.scenario&&e.edition==s.E.game.scenario.edition&&e.parent==s.E.game.scenario.index&&e.group==s.E.game.scenario.group&&e.conclusion&&0==s.E.scenarioManager.getRequirements(e).length);0!=i.length&&n?this.dialog.open(Xn,{panelClass:["dialog"],data:{conclusions:i,parent:s.E.game.scenario}}).closed.subscribe({next:e=>{e&&this.dialog.open(zt,{panelClass:["dialog"],data:{scenario:s.E.game.scenario,conclusion:e,success:n}})}}):this.dialog.open(zt,{panelClass:["dialog"],data:{scenario:s.E.game.scenario,success:n}}),(0,F.co)(this.dialogRef,!1)}}resetScenario(){s.E.stateManager.before("resetScenario",...s.E.scenarioManager.scenarioUndoArgs()),s.E.roundManager.resetScenario(),s.E.scenarioManager.setScenario(s.E.game.scenario),s.E.stateManager.after(),(0,F.co)(this.dialogRef)}empty(){return 0==s.E.game.figures.length}missingInitiative(){return s.E.game.figures.some(n=>p.f.settings.initiativeRequired&&(n instanceof H.K&&s.E.entityManager.isAlive(n)&&!n.absent||n instanceof ft.$e)&&n.getInitiative()<=0)}active(){return null!=s.E.game.figures.find(n=>n.active&&!n.off)}battleGoals(){return!this.missingInitiative()&&p.f.settings.battleGoals&&p.f.settings.battleGoalsReminder&&null!=s.E.game.scenario&&s.E.roundManager.firstRound&&!s.E.game.figures.every(n=>!(n instanceof H.K)||n.battleGoal||n.absent)&&!s.E.bbRules()}eventDraw(){return!this.missingInitiative()&&!p.f.settings.eventsDraw&&p.f.settings.eventsDrawReminder&&null!=s.E.game.scenario&&s.E.roundManager.firstRound&&null!=s.E.game.eventDraw}finish(){return!1}failed(){return!this.active()&&!this.empty()&&s.E.game.figures.some(n=>n instanceof H.K)&&s.E.game.figures.every(n=>!(n instanceof H.K)||n instanceof H.K&&(!s.E.entityManager.isAlive(n)||n.absent))}onKeyEnter(n){p.f.settings.keyboardShortcuts&&"Enter"===n.key&&(this.active()?this.confirm():this.finish()?this.finishScenario(!0):this.failed()?this.finishScenario(!1):(this.battleGoals()||this.eventDraw())&&this.confirm(),n.preventDefault(),n.stopPropagation())}static \u0275fac=function(i){return new(i||a)(t.rXU(O.ce),t.rXU(O.lG))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-hint-dialog"]],hostBindings:function(i,e){1&i&&t.bIt("keydown",function(g){return e.onKeyEnter(g)},t.EBC)},standalone:!1,decls:17,vars:15,consts:[[1,"hint-dialog"],[1,"hint"],[1,"small"],[3,"ghs-label"],[3,"click"],[1,"small",3,"click"],[3,"ghs-label","ghs-label-args"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.nVh(2,bG,2,1,"p"),t.nVh(3,kG,2,1,"p"),t.nVh(4,yG,2,1,"p"),t.nVh(5,xG,2,1,"a"),t.nVh(6,EG,2,1,"a",2),t.nVh(7,wG,2,1,"p"),t.nVh(8,RG,2,1,"a"),t.nVh(9,jG,2,1,"p"),t.nVh(10,GG,2,1,"a"),t.nVh(11,TG,2,1,"a"),t.nVh(12,SG,2,1,"a"),t.nVh(13,DG,2,1,"p"),t.nVh(14,$G,2,1,"a"),t.nVh(15,IG,2,4,"p"),t.nVh(16,AG,2,1,"a"),t.k0s()()),2&i&&(t.R7$(2),t.vxM(e.empty()?2:-1),t.R7$(),t.vxM(e.missingInitiative()?3:-1),t.R7$(),t.vxM(e.active()?4:-1),t.R7$(),t.vxM(e.active()?5:-1),t.R7$(),t.vxM(e.active()?6:-1),t.R7$(),t.vxM(e.finish()?7:-1),t.R7$(),t.vxM(e.finish()?8:-1),t.R7$(),t.vxM(e.failed()?9:-1),t.R7$(),t.vxM(e.failed()?10:-1),t.R7$(),t.vxM(e.failed()?11:-1),t.R7$(),t.vxM(e.finish()||e.failed()?12:-1),t.R7$(),t.vxM(e.battleGoals()?13:-1),t.R7$(),t.vxM(e.battleGoals()?14:-1),t.R7$(),t.vxM(e.eventDraw()&&e.gameManager.game.eventDraw?15:-1),t.R7$(),t.vxM(e.eventDraw()?16:-1))},dependencies:[it],styles:[".hint-dialog[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);text-align:center}.hint-dialog[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;min-height:calc(var(--ghs-unit) * 6 * var(--ghs-text-factor))}.hint-dialog[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));color:var(--ghs-color-gray);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor))}.hint-dialog[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));color:var(--ghs-color-gray);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.hint-dialog[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.hint-dialog[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   a.small[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));font-style:italic}"]})}return a})();const yr=a=>({disabled:a});function FG(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",5),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.change(-e))}),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.eq3(4,yr,i.min&&i.model-n<i.min)),t.R7$(),t.SpI(" ",t.bMT(2,2,i.relative?-n:i.model-n)," ")}}function XG(a,r){if(1&a&&(t.j41(0,"div",1),t.Z7z(1,FG,3,6,"div",4,t.fX1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(n.stepsNegative)}}function BG(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.JRh(n.model)}}function YG(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.JRh(t.bMT(2,1,n.model))}}function UG(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",5),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.change(e))}),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(4,yr,i.max&&i.model+n>i.max)),t.R7$(),t.SpI(" ",t.bMT(2,2,i.relative?n:i.model+n)," ")}}let NG=(()=>{class a{model=0;modelChange=new t.bkB;steps=[1,2];negative=!0;min=0;max=void 0;relative=!1;stepsNegative=this.steps.map(n=>n).reverse();ngOnInit(){this.stepsNegative=this.steps.map(n=>n).reverse()}change(n){this.modelChange.emit(this.model+n)}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-number-input"]],inputs:{model:"model",steps:"steps",negative:"negative",min:"min",max:"max",relative:"relative"},outputs:{modelChange:"modelChange"},standalone:!1,decls:8,vars:3,consts:[[1,"number-input-container"],[1,"value-container","negative"],[1,"current"],[1,"value-container"],["tabclick","",1,"value",3,"ngClass"],["tabclick","",1,"value",3,"click","ngClass"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nVh(1,XG,3,0,"div",1),t.j41(2,"div",2),t.nVh(3,BG,2,1,"span"),t.nVh(4,YG,3,3,"span"),t.k0s(),t.j41(5,"div",3),t.Z7z(6,UG,3,6,"div",4,t.fX1),t.k0s()()),2&i&&(t.R7$(),t.vxM(e.negative?1:-1),t.R7$(2),t.vxM(e.relative?3:-1),t.R7$(),t.vxM(e.relative?-1:4),t.R7$(2),t.Dyx(e.steps))},dependencies:[N.YU,Ft,Me],styles:[".number-input-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:1em}.number-input-container[_ngcontent-%COMP%]   .value-container[_ngcontent-%COMP%]{display:flex}.number-input-container[_ngcontent-%COMP%]   .value-container[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{cursor:pointer;font-size:1em;margin:.2em;filter:brightness(.8)}.number-input-container[_ngcontent-%COMP%]   .value-container[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:hover{filter:brightness(1.5)}.number-input-container[_ngcontent-%COMP%]   .value-container[_ngcontent-%COMP%]   .value.disabled[_ngcontent-%COMP%]{pointer-events:none;visibility:hidden}.number-input-container[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{font-size:1.5em;margin:.2em}"]})}return a})();const zG=a=>({denied:a}),LG=a=>({disabled:a}),xr=(a,r)=>({active:a,scenariolevel:r}),qG=a=>[a],HG=()=>[],KG=a=>({current:a}),WG=(a,r,n,i)=>({"level-1":a,"level-2":r,"level-3":n,"level-4":i});function ZG(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",10),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.setLevelCalculation(!e.gameManager.game.levelCalculation))}),t.k0s(),t.nrm(2,"span",4),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("checked",n.gameManager.game.levelCalculation),t.R7$(),t.Y8G("ghs-label","settings.levelCalculation")}}function JG(a,r){if(1&a){const n=t.RV6();t.j41(0,"label"),t.nrm(1,"span",4),t.EFF(2," :\xa0 "),t.j41(3,"ghs-number-input",5),t.bIt("modelChange",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.setLevelAdjustment(e))}),t.k0s()()}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","settings.levelAdjustment"),t.R7$(2),t.Y8G("model",n.gameManager.game.levelAdjustment)("min",-6)("max",6)}}function QG(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",10),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.setGe5Player(!e.gameManager.game.ge5Player))}),t.k0s(),t.nrm(2,"span",4),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("checked",n.gameManager.game.ge5Player),t.R7$(),t.Y8G("ghs-label","settings.ge5Player")}}function tT(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",28),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(2);return c.Njj(o.setLevel(e))}),t.EFF(1),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.Y8G("ngClass",t.l_i(2,xr,n==i.gameManager.game.level,i.gameManager.game.playerCount<1&&n==i.gameManager.levelManager.scenarioLevel())),t.R7$(),t.JRh(n)}}function nT(a,r){if(1&a&&(t.j41(0,"a",27),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.Y8G("ngClass",t.l_i(2,xr,n==i.gameManager.game.level,i.gameManager.game.playerCount<1&&n==i.gameManager.levelManager.scenarioLevel())),t.R7$(),t.JRh(n)}}function eT(a,r){if(1&a&&(t.j41(0,"span",7),t.nVh(1,tT,2,5,"a",26),t.nVh(2,nT,2,5,"a",27),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.vxM(n.gameManager.game.levelCalculation?-1:1),t.R7$(),t.vxM(n.gameManager.game.levelCalculation?2:-1)}}function aT(a,r){if(1&a&&t.nrm(0,"span",17),2&a){const n=t.XpG(2);t.Y8G("ghs-label","data.favors.fh.wealth.level")("ghs-label-args",t.eq3(2,qG,n.gameManager.trialsManager.activeFavor("fh","wealth")))}}function iT(a,r){if(1&a){const n=t.RV6();t.j41(0,"input",29,0),t.bIt("keyup",function(){return c.eBV(n),c.Njj(0)})("change",function(){c.eBV(n);const e=t.sdS(1),o=t.XpG(2);return c.Njj(o.setPlayerCount(+e.value))}),t.k0s()}if(2&a){const n=t.sdS(1),i=t.XpG(2);t.Y8G("value",i.gameManager.game.playerCount)("size",n.value.length)("ghs-label","settings.playerCount")("ghs-label-attribute","placeholder")}}function oT(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",3),t.nVh(1,ZG,3,2,"label"),t.nVh(2,JG,4,4,"label"),t.j41(3,"label"),t.nrm(4,"span",4),t.EFF(5," :\xa0 "),t.j41(6,"ghs-number-input",5),t.bIt("modelChange",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setBonusAdjustment(e))}),t.k0s()(),t.nVh(7,QG,3,2,"label"),t.k0s(),t.j41(8,"div",6)(9,"span",7),t.nrm(10,"img",8),t.k0s(),t.Z7z(11,eT,3,2,"span",7,t.fX1),t.j41(13,"div",9)(14,"label")(15,"input",10),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.setSolo(!e.gameManager.game.solo))}),t.k0s(),t.nrm(16,"span",4),t.k0s()()(),t.j41(17,"div",11)(18,"div",12)(19,"span",13),t.nrm(20,"img",14),t.EFF(21,":"),t.k0s(),t.j41(22,"span",15),t.EFF(23),t.k0s(),t.j41(24,"span",16),t.nrm(25,"span",4),t.EFF(26,"\xa0"),t.nVh(27,aT,1,4,"span",17),t.k0s()(),t.j41(28,"div",18)(29,"span",13),t.nrm(30,"img",19),t.EFF(31,":"),t.k0s(),t.j41(32,"span",15),t.EFF(33),t.k0s(),t.j41(34,"span",16),t.nrm(35,"span",4),t.k0s()(),t.j41(36,"div",20)(37,"span",13),t.nrm(38,"img",21),t.EFF(39,":"),t.k0s(),t.j41(40,"span",15),t.EFF(41),t.k0s(),t.j41(42,"span",16),t.nrm(43,"span",4),t.k0s()(),t.j41(44,"div",22)(45,"span",13),t.nrm(46,"img",23),t.EFF(47,":"),t.k0s(),t.j41(48,"span",15),t.EFF(49),t.k0s(),t.j41(50,"span",16),t.nrm(51,"span",4),t.k0s()()(),t.j41(52,"label",24)(53,"input",10),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.togglePlayerCount(e))}),t.k0s(),t.nrm(54,"span",4),t.nVh(55,iT,2,4,"input",25),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.vxM(n.gameManager.game.playerCount<1?1:-1),t.R7$(),t.vxM(n.gameManager.game.levelCalculation?2:-1),t.R7$(2),t.Y8G("ghs-label","settings.bonusAdjustment"),t.R7$(2),t.Y8G("model",n.gameManager.game.bonusAdjustment)("min",-6)("max",6),t.R7$(),t.vxM(n.ge5Player()?7:-1),t.R7$(),t.Y8G("ngClass",t.eq3(23,LG,n.gameManager.game.levelCalculation)),t.R7$(3),t.Dyx(n.levels),t.R7$(4),t.Y8G("checked",n.gameManager.game.solo),t.R7$(),t.Y8G("ghs-label","game.solo"),t.R7$(4),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/loot.svg",t.B4B),t.R7$(3),t.SpI("x",n.loot),t.R7$(2),t.Y8G("ghs-label","game.level.loot"),t.R7$(2),t.vxM(n.gameManager.trialsManager.activeFavor("fh","wealth")?27:-1),t.R7$(6),t.JRh(n.trap),t.R7$(2),t.Y8G("ghs-label","game.level.trap"),t.R7$(6),t.SpI("+",n.experience),t.R7$(2),t.Y8G("ghs-label","game.level.experience"),t.R7$(6),t.JRh(n.hazardousTerrain),t.R7$(2),t.Y8G("ghs-label","game.level.hazardousTerrain"),t.R7$(2),t.Y8G("checked",n.gameManager.game.playerCount>0),t.R7$(),t.Y8G("ghs-label","settings.playerCount"),t.R7$(),t.vxM(n.gameManager.game.playerCount>0?55:-1)}}function sT(a,r){1&a&&t.nrm(0,"img",34)}function rT(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",32),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.setBbMonsterDifficutly(e))}),t.nrm(1,"span",33),t.nVh(2,sT,1,0,"img",34),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.eq3(4,KG,i.gameManager.game.levelAdjustment+2==n)),t.R7$(),t.Y8G("ngClass",t.ziG(6,WG,0==n,1==n,3==n,4==n))("ghs-label","game.level.bb.monsterDifficulty."+n),t.R7$(),t.vxM(i.gameManager.game.levelAdjustment+2==n?2:-1)}}function cT(a,r){1&a&&(t.j41(0,"div",2)(1,"span",30),t.nrm(2,"img",31)(3,"span",4),t.EFF(4,":"),t.k0s(),t.Z7z(5,rT,3,11,"span",27,t.fX1),t.nI1(7,"ghsRange"),t.k0s()),2&a&&(t.R7$(3),t.Y8G("ghs-label","game.level.bb.monsterDifficulty"),t.R7$(2),t.Dyx(t.i5U(7,1,t.lJ4(4,HG),5)))}let lT=(()=>{class a{ghsManager;gameManager=s.E;settingsManager=p.f;trap=0;experience=0;loot=0;hazardousTerrain=0;levels=[0,1,2,3,4,5,6,7];constructor(n){this.ghsManager=n}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.calculateValues()}}),this.calculateValues()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}setLevelCalculation(n){s.E.stateManager.before(n?"enableAutomaticLevel":"disabledAutomaticLevel"),s.E.game.levelCalculation=n,s.E.game.levelCalculation&&s.E.levelManager.calculateScenarioLevel(),s.E.stateManager.after()}setLevelAdjustment(n){s.E.stateManager.before("updateLevelAdjustment",(0,F.n1)(n)),s.E.game.levelAdjustment=n,s.E.game.levelCalculation&&s.E.levelManager.calculateScenarioLevel(),s.E.stateManager.after()}setBbMonsterDifficutly(n){s.E.stateManager.before("updateLevelAdjustmentBb",n),s.E.game.levelAdjustment=n-2;const i=s.E.editionData.find(e=>"bb"==e.edition&&e.monsterAmTables&&e.monsterAmTables.length);if(i){const e=s.E.levelManager.bbMonsterDifficutly();s.E.game.monsterAttackModifierDeck.attackModifiers=i.monsterAmTables[e].map(o=>new w.uU(o)),s.E.game.monsterAttackModifierDeck.cards=i.monsterAmTables[e].map(o=>new w.uU(o))}s.E.game.monsterAttackModifierDeck.bb=p.f.settings.bbAm,s.E.stateManager.after()}setBonusAdjustment(n){s.E.stateManager.before("updateBonusAdjustment",(0,F.n1)(n)),s.E.game.bonusAdjustment=n,s.E.game.levelCalculation&&s.E.levelManager.calculateScenarioLevel(),s.E.stateManager.after()}setGe5Player(n){s.E.stateManager.before(n?"enabledGe5Player":"disabledGe5Player"),s.E.game.ge5Player=n,s.E.game.levelCalculation&&s.E.levelManager.calculateScenarioLevel(),s.E.stateManager.after()}ge5Player(){return s.E.game.playerCount<1&&s.E.characterManager.characterCount()>4}togglePlayerCount(n){s.E.stateManager.before(n.target.checked?"enabledManualPlayerCount":"disabledManualPlayerCount"),s.E.game.playerCount=n.target.checked?2:-1,n.target.checked?s.E.game.levelCalculation=!1:s.E.game.levelCalculation&&s.E.levelManager.calculateScenarioLevel(),s.E.stateManager.after()}setPlayerCount(n){s.E.stateManager.before("updateManualPlayerCount",n),s.E.game.playerCount=n,s.E.game.levelCalculation&&s.E.levelManager.calculateScenarioLevel(),s.E.stateManager.after()}setLevel(n){s.E.stateManager.before("setScenarioLevel",""+n),s.E.levelManager.setLevel(n),s.E.game.levelCalculation=!1,s.E.stateManager.after()}setSolo(n){s.E.stateManager.before(n?"enableSolo":"disableSolo"),s.E.game.solo=n,s.E.stateManager.after()}calculateValues(){this.trap=s.E.levelManager.trap(),this.experience=s.E.levelManager.experience(),this.loot=s.E.levelManager.loot(),this.hazardousTerrain=s.E.levelManager.terrain(),s.E.trialsManager.activeFavor("fh","wealth")&&(this.loot+=s.E.trialsManager.activeFavor("fh","wealth"))}static \u0275fac=function(i){return new(i||a)(t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-level-dialog"]],standalone:!1,decls:3,vars:5,consts:[["playerCount",""],[1,"level-dialog",3,"ngClass"],[1,"bb"],[1,"menu"],[3,"ghs-label"],[3,"modelChange","model","min","max"],[1,"level-container",3,"ngClass"],[1,"item"],["src","./assets/images/level.svg"],[1,"solo"],["tabclick","","type","checkbox",3,"change","checked"],[1,"values"],[1,"loot"],[1,"icon"],[1,"ghs-svg",3,"src"],[1,"value"],[1,"hint"],[3,"ghs-label","ghs-label-args"],[1,"trap"],["src","./assets/images/trap.svg",1,"ghs-svg"],[1,"experience"],["src","./assets/images/experience.svg",1,"ghs-svg"],[1,"terrain"],["src","./assets/images/terrain.svg",1,"ghs-svg"],[1,"player-count"],["tabclick","","type","number","min","1",3,"value","size","ghs-label","ghs-label-attribute"],["tabclick","",1,"level",3,"ngClass"],[1,"level",3,"ngClass"],["tabclick","",1,"level",3,"click","ngClass"],["tabclick","","type","number","min","1",3,"keyup","change","value","size","ghs-label","ghs-label-attribute"],[1,"title"],["src","./assets/images/bb/monster.svg",1,"ghs-svg"],[1,"level",3,"click","ngClass"],[1,"scenario-level",3,"ngClass","ghs-label"],["src","./assets/images/check.svg",1,"ghs-svg"]],template:function(i,e){1&i&&(t.j41(0,"div",1),t.nVh(1,oT,56,25),t.nVh(2,cT,8,5,"div",2),t.k0s()),2&i&&(t.Y8G("ngClass",t.eq3(3,zG,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.level)),t.R7$(),t.vxM(e.gameManager.bbRules()?-1:1),t.R7$(),t.vxM(e.gameManager.bbRules()?2:-1))},dependencies:[N.YU,it,NG,Ft,At],styles:['.level-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column}.level-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;margin-bottom:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.level-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{width:2em}.level-dialog[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline)}.level-dialog[_ngcontent-%COMP%]   label.player-count[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor))}.level-dialog[_ngcontent-%COMP%]   span.item[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.level-dialog[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:auto}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor)));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) auto}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .level.scenariolevel[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) / 4) var(--ghs-color-darkgray) solid;border-radius:100%}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .level.active[_ngcontent-%COMP%]{pointer-events:none;border:calc(var(--ghs-unit) / 4) var(--ghs-color-white) solid;border-radius:100%}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.level-dialog[_ngcontent-%COMP%]   .level-container.disabled[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}.level-dialog[_ngcontent-%COMP%]   .level-container.disabled[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{pointer-events:none}.level-dialog[_ngcontent-%COMP%]   .level-container.disabled[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:not(.active){color:var(--ghs-color-darkgray)}.level-dialog[_ngcontent-%COMP%]   .solo[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.level-dialog[_ngcontent-%COMP%]   .solo[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.level-dialog[_ngcontent-%COMP%]   .solo[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{cursor:pointer;appearance:none;background-color:var(--form-background);width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));border-width:calc(var(--ghs-unit) * .3);border-style:solid;display:grid;place-content:center;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.level-dialog[_ngcontent-%COMP%]   .solo[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before{left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));position:relative;content:" ";width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));transform:scale(0);transform-origin:bottom left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;clip-path:polygon(14% 44%,0 65%,50% 100%,100% 16%,80% 0%,43% 62%);color:var(--ghs-color-gray);background-color:var(--ghs-color-gray)}.level-dialog[_ngcontent-%COMP%]   .solo[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked:before{transform:scale(1)}.level-dialog[_ngcontent-%COMP%]   .solo[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover:before{background-color:var(--ghs-color-white)}.level-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]{display:flex;flex-direction:column;color:var(--ghs-color-gray);font-size:1.6em;font-family:var(--ghs-font-normal)}.level-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:grid;grid-template-columns:.2fr .2fr 1fr;align-items:center;justify-content:center;margin-bottom:.2em}.level-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{text-align:center}.level-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{text-align:left}.level-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.level-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:1.3em;height:auto;filter:var(--ghs-filter-gray)}.level-dialog[_ngcontent-%COMP%]   .bb[_ngcontent-%COMP%]{display:flex;flex-direction:column;color:var(--ghs-color-gray);font-size:1.6em;font-family:var(--ghs-font-normal)}.level-dialog[_ngcontent-%COMP%]   .bb[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;align-items:center}.level-dialog[_ngcontent-%COMP%]   .bb[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-right:.5em;width:1.3em;height:auto;filter:var(--ghs-filter-gray)}.level-dialog[_ngcontent-%COMP%]   .bb[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;font-size:.8em;margin:.2em}.level-dialog[_ngcontent-%COMP%]   .bb[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{float:left;margin-left:.2em;width:1em;height:auto;filter:var(--ghs-filter-white)}.level-dialog[_ngcontent-%COMP%]   .bb[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]   .scenario-level[_ngcontent-%COMP%]{width:10em;text-align:center}.level-dialog[_ngcontent-%COMP%]   .bb[_ngcontent-%COMP%]   .level.current[_ngcontent-%COMP%]   .scenario-level[_ngcontent-%COMP%]{width:8.8em}.level-dialog[_ngcontent-%COMP%]   .bb[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover{opacity:.7}']})}return a})();const gT=["levelButton"];function dT(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",3),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.open())}),t.j41(1,"span",4),t.nrm(2,"img",5),t.EFF(3),t.k0s(),t.j41(4,"span",6),t.nrm(5,"img",7),t.EFF(6),t.k0s(),t.j41(7,"span",8),t.nrm(8,"img",9),t.EFF(9),t.k0s(),t.j41(10,"span",10),t.nrm(11,"img",11),t.EFF(12),t.k0s(),t.j41(13,"span",12),t.nrm(14,"img",13),t.j41(15,"span"),t.EFF(16),t.k0s()()()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","game.level")("ghs-label-attribute","title"),t.R7$(2),t.SpI(" ",n.gameManager.game.level),t.R7$(),t.Y8G("ghs-label","game.level.loot")("ghs-label-attribute","title"),t.R7$(),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/loot.svg",t.B4B),t.R7$(),t.SpI(" x",n.loot),t.R7$(),t.Y8G("ghs-label","game.level.trap")("ghs-label-attribute","title"),t.R7$(2),t.SpI(" ",n.trap),t.R7$(),t.Y8G("ghs-label","game.level.experience")("ghs-label-attribute","title"),t.R7$(2),t.SpI(" +",n.experience),t.R7$(),t.Y8G("ghs-label","game.level.hazardousTerrain")("ghs-label-attribute","title"),t.R7$(3),t.JRh(n.hazardousTerrain)}}function hT(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",3),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.open())}),t.j41(1,"span",14),t.nrm(2,"img",15)(3,"span",16),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","game.level.bb.monsterDifficulty")("ghs-label-attribute","title"),t.R7$(2),t.Y8G("ghs-label","game.level.bb.monsterDifficulty."+n.monsterDifficulty)}}let _T=(()=>{class a{dialog;overlay;ghsManager;levelButton;gameManager=s.E;settingsManager=p.f;trap=0;experience=0;loot=0;hazardousTerrain=0;monsterDifficulty=0;constructor(n,i,e){this.dialog=n,this.overlay=i,this.ghsManager=e}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.calculateValues()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}open(){const n=[new qt.uH({originX:"center",originY:"top"},{overlayX:"center",overlayY:"bottom"}),new qt.uH({originX:"start",originY:"top"},{overlayX:"start",overlayY:"bottom"}),new qt.uH({originX:"end",originY:"top"},{overlayX:"end",overlayY:"bottom"})];this.dialog.open(lT,{panelClass:["dialog"],positionStrategy:this.overlay.position().flexibleConnectedTo(this.levelButton).withPositions(n).withDefaultOffsetY(-10)})}calculateValues(){this.trap=s.E.levelManager.trap(),this.experience=s.E.levelManager.experience(),this.loot=s.E.levelManager.loot(),this.hazardousTerrain=s.E.levelManager.terrain(),this.monsterDifficulty=s.E.levelManager.bbMonsterDifficutly(),s.E.trialsManager.activeFavor("fh","wealth")&&(this.loot+=s.E.trialsManager.activeFavor("fh","wealth"))}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG),t.rXU(qt.hJ),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-level"]],viewQuery:function(i,e){if(1&i&&t.GBs(gT,5),2&i){let o;t.mGM(o=t.lsd())&&(e.levelButton=o.first)}},standalone:!1,decls:4,vars:2,consts:[["levelButton",""],[1,"level-status"],[1,"values"],[1,"values",3,"click"],[1,"level",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/level.svg",1,"ghs-svg"],[1,"loot",3,"ghs-label","ghs-label-attribute"],[1,"ghs-svg",3,"src"],[1,"trap",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/trap.svg",1,"ghs-svg"],[1,"experience",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/experience.svg",1,"ghs-svg"],[1,"terrain",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/terrain.svg",1,"ghs-svg"],[3,"ghs-label","ghs-label-attribute"],["src","./assets/images/bb/monster.svg",1,"ghs-svg"],[3,"ghs-label"]],template:function(i,e){1&i&&(t.j41(0,"div",1,0),t.nVh(2,dT,17,16,"div",2),t.nVh(3,hT,4,3,"div",2),t.k0s()),2&i&&(t.R7$(2),t.vxM(e.gameManager.bbRules()?-1:2),t.R7$(),t.vxM(e.gameManager.bbRules()?3:-1))},dependencies:[it],styles:[".level-status[_ngcontent-%COMP%]{position:relative;display:flex;height:100%;align-items:center;flex-direction:column;justify-content:space-evenly;text-align:center}.level-status[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]{cursor:pointer;display:flex;flex-wrap:wrap;align-items:center;width:100%;justify-content:center}.level-status[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-barsize));color:var(--ghs-color-gray);margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-barsize));text-shadow:var(--ghs-outline-thin)}.level-status[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-barsize));width:calc(var(--ghs-unit) * 3 * var(--ghs-barsize));height:auto;display:inline-block;filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.level-status[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.level-status[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}"]})}return a})();var bt=v(7114),oe=v(8635);const mT=(a,r)=>({narrative:a,fh:r}),pT=(a,r)=>({"text-white":a,debug:r}),Er=(a,r)=>({"text-white":a,disabled:r}),uT=(a,r,n,i)=>({"text-white":a,inline:r,lowercase:n,disabled:i}),Fa=a=>({"text-white":a}),fT=a=>[0,a],CT=()=>[];function MT(a,r){if(1&a&&(t.j41(0,"span",1),t.nrm(1,"span",3),t.k0s()),2&a){const n=t.XpG();t.Y8G("ngClass",t.l_i(3,pT,n.light,n.debug)),t.R7$(),t.Y8G("ngClass",t.l_i(6,Er,n.light,n.selected&&n.disabled))("ghs-label",n.conditionString)}}function vT(a,r){if(1&a&&t.nrm(0,"span",5),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(4,Fa,n.light))("ghs-label","game.events.conditions."+n.conditionObject.type)("ghs-label-args",n.labelArgs)("slice",n.inline?t.eq3(6,fT,-1):t.lJ4(8,CT))}}function OT(a,r){if(1&a&&t.nrm(0,"span",3),2&a){const n=t.XpG(4);t.Y8G("ngClass",t.eq3(2,Fa,n.light))("ghs-label","game.events.conditions.and")}}function PT(a,r){if(1&a&&(t.nVh(0,OT,1,4,"span",3),t.nrm(1,"ghs-event-card-condition",8)),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.vxM(i>0?0:-1),t.R7$(),t.Y8G("condition",n)("edition",e.edition)("eventType",e.eventType)("light",e.light)("inline",!0)("disabled",e.selected&&e.disabledConditions[i])("selected",e.selected)}}function bT(a,r){if(1&a&&(t.j41(0,"span",6),t.Z7z(1,PT,2,8,null,null,t.fX1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Dyx(n.conditions)}}function kT(a,r){if(1&a&&t.nrm(0,"span",9),2&a){const n=t.XpG().$index,i=t.XpG(3);t.Y8G("ngClass",t.l_i(2,Er,i.light,i.selected&&(i.disabledConditions[n-1]||i.disabledConditions[n])))("ghs-label","game.events.conditions.payCollectiveGoldConditional.connector")}}function yT(a,r){if(1&a&&(t.nVh(0,kT,1,5,"span",9),t.nrm(1,"ghs-event-card-condition",10)),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.vxM(i>0?0:-1),t.R7$(),t.Y8G("condition",n)("edition",e.edition)("eventType",e.eventType)("light",e.light)("inline",!0)("lowercase",!0)("disabled",e.selected&&e.disabledConditions[i])("selected",e.selected)}}function xT(a,r){if(1&a&&(t.j41(0,"span",7),t.nrm(1,"span",3),t.Z7z(2,yT,2,9,null,null,t.fX1),t.nrm(4,"span",3),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(4,Fa,n.light))("ghs-label","game.events.conditions.payCollectiveGoldConditional.prefix"),t.R7$(),t.Dyx(n.conditions),t.R7$(2),t.Y8G("ngClass",t.eq3(6,Fa,n.light))("ghs-label","game.events.conditions.payCollectiveGoldConditional.suffix")}}function ET(a,r){if(1&a&&(t.j41(0,"span",4),t.nVh(1,vT,1,9,"span",5),t.nVh(2,bT,3,0,"span",6),t.nVh(3,xT,5,8,"span",7),t.k0s()),2&a){const n=t.XpG();t.HbH(t.VkB("text ","condition-"+n.conditionObject.type)),t.Y8G("ngClass",t.ziG(7,uT,n.light,n.inline,n.lowercase,n.disabled)),t.R7$(),t.vxM(n.conditionObject.type&&!n.special.includes(n.conditionObject.type)?1:-1),t.R7$(),t.vxM("and"==n.conditionObject.type?2:-1),t.R7$(),t.vxM("payCollectiveGoldConditional"==n.conditionObject.type?3:-1)}}let Ki=(()=>{class a{condition;edition;eventType;disabled=!1;narrative=!1;light=!0;inline=!1;lowercase=!1;selected=!1;debug=!1;conditionString;conditionObject;labelArgs=[];conditions=[];disabledConditions=[];special=[bt.iH.and,bt.iH.payCollectiveGoldConditional];ngOnInit(){if("string"==typeof this.condition)this.conditionString=this.condition;else if(this.condition){this.conditionObject=this.condition,this.labelArgs=this.conditionObject.values?this.conditionObject.values.filter(i=>"number"==typeof i||"string"==typeof i):[],this.conditions=this.conditionObject.values?this.conditionObject.values.filter(i=>"number"!=typeof i):[],this.conditions.forEach((i,e)=>{this.disabledConditions[e]=!s.E.eventCardManager.resolvableCondition(i)});const n=this.conditionObject.type;if(n===bt.iH.character&&(this.labelArgs=[this.labelArgs.map(i=>"%game.characterIcon."+i+"%").join("")]),n==bt.iH.building){let i="";this.conditionObject.values.filter(e=>"string"==typeof e).map(e=>"%game.fhIcon:"+e+"%").forEach((e,o,g)=>{i+=e,g.length>1&&(o<g.length-2?i+=", ":o<g.length-1&&(i+=" %and% "))}),this.labelArgs=[i]}if(n==bt.iH.traits||n==bt.iH.traitsAll){let i="";this.conditionObject.values.filter(e=>"string"==typeof e).map(e=>e in oe.iq?"%character.class."+e+"%":"%data.character.traits."+e+"%").forEach((e,o,g)=>{i+=e,g.length>1&&(o<g.length-2?i+=", ":o<g.length-1&&(i+=n==bt.iH.traits?" %or% ":" %and% "))}),this.labelArgs=[i]}this.labelArgs.push(this.edition)}}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-event-card-condition"]],inputs:{condition:"condition",edition:"edition",eventType:"eventType",disabled:"disabled",narrative:"narrative",light:"light",inline:"inline",lowercase:"lowercase",selected:"selected",debug:"debug"},standalone:!1,decls:3,vars:6,consts:[[1,"condition",3,"ngClass"],[1,"text",3,"ngClass"],[1,"condition-object",3,"class","ngClass"],[3,"ngClass","ghs-label"],[1,"condition-object",3,"ngClass"],[3,"ngClass","ghs-label","ghs-label-args","slice"],[1,"and-container"],[1,"conditional-container"],[3,"condition","edition","eventType","light","inline","disabled","selected"],[1,"inline",3,"ngClass","ghs-label"],[3,"condition","edition","eventType","light","inline","lowercase","disabled","selected"]],template:function(i,e){1&i&&(t.j41(0,"span",0),t.nVh(1,MT,2,9,"span",1),t.nVh(2,ET,4,12,"span",2),t.k0s()),2&i&&(t.Y8G("ngClass",t.l_i(3,mT,e.narrative,"fh"==e.edition)),t.R7$(),t.vxM(e.conditionString?1:-1),t.R7$(),t.vxM(e.conditionObject?2:-1))},dependencies:[N.YU,a,it],styles:[".condition[_ngcontent-%COMP%]{font-family:var(--ghs-font-text)}.condition.fh[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-normal)}.condition[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{opacity:.4}.condition[_ngcontent-%COMP%]   .text.debug[_ngcontent-%COMP%]{color:red}.condition.narrative[_ngcontent-%COMP%]{font-style:italic;text-transform:uppercase}.condition.narrative[_ngcontent-%COMP%]   .condition-character[_ngcontent-%COMP%]{font-size:1.1em}.condition.narrative[_ngcontent-%COMP%]   .lowercase[_ngcontent-%COMP%]{text-transform:initial}.condition[_ngcontent-%COMP%]   .condition-object[_ngcontent-%COMP%]   .and-container[_ngcontent-%COMP%]   ghs-event-card-condition[_ngcontent-%COMP%], .condition[_ngcontent-%COMP%]   .condition-object[_ngcontent-%COMP%]   .conditional-container[_ngcontent-%COMP%]   ghs-event-card-condition[_ngcontent-%COMP%]{margin:0 .2em}"]})}return a})();const wT=(a,r,n,i)=>({fh:a,city:r,disabled:n,selected:i}),RT=(a,r,n)=>({concatenated:a,inline:r,debug:n}),Ge=a=>({"text-white":a}),jT=(a,r)=>({light:a,inline:r}),GT=(a,r)=>({"text-white":a,concatenated:r}),TT=a=>[0,a],ST=()=>[],DT=a=>({"has-value":a}),$T=(a,r)=>({checked:a,light:r}),IT=a=>({light:a}),wr=(a,r)=>("object"==typeof r?r.type:r)+""+a,AT=(a,r)=>("object"==typeof r?r.type:r)+a;function VT(a,r){if(1&a&&(t.j41(0,"span",1),t.nrm(1,"span",3),t.k0s()),2&a){const n=t.XpG();t.Y8G("ngClass",t.sMw(3,RT,n.concatenated,n.inline,n.debug)),t.R7$(),t.Y8G("ngClass",t.eq3(7,Ge,n.light))("ghs-label",n.effectString)}}function FT(a,r){if(1&a&&t.nrm(0,"ghs-event-card-condition",4),2&a){const n=t.XpG(2);t.Y8G("condition",n.effectObject.condition)("edition",n.edition)("eventType",n.eventType)("light",n.light)}}function XT(a,r){1&a&&(t.j41(0,"span",5),t.EFF(1,":"),t.k0s())}function BT(a,r){if(1&a&&t.nrm(0,"span",6),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.l_i(4,GT,n.light,n.concatenated))("ghs-label","game.events.effects."+n.effectObject.type+(n.effectObject.alt?"."+n.effectObject.alt:""))("ghs-label-args",n.labelArgs)("slice",n.concatenated?t.eq3(7,TT,-1):t.lJ4(9,ST))}}function YT(a,r){if(1&a&&t.nrm(0,"span",3),2&a){const n=t.XpG(4);t.Y8G("ngClass",t.eq3(2,Ge,n.light))("ghs-label","game.events.effects.choose.connector")}}function UT(a,r){if(1&a&&(t.nVh(0,YT,1,4,"span",3),t.nrm(1,"ghs-event-card-effect",12)),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.vxM(i>0?0:-1),t.R7$(),t.Y8G("effect",n)("edition",e.edition)("eventType",e.eventType)("light",e.light)("concatenated",!0)}}function NT(a,r){if(1&a&&(t.j41(0,"span",7),t.nrm(1,"span",3),t.Z7z(2,UT,2,6,null,null,wr),t.nrm(4,"span",3),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(4,Ge,n.light))("ghs-label","game.events.effects.choose.prefix"),t.R7$(),t.Dyx(n.effects),t.R7$(2),t.Y8G("ngClass",t.eq3(6,Ge,n.light))("ghs-label","game.events.effects.choose.suffix")}}function zT(a,r){if(1&a&&t.nrm(0,"ghs-event-card-effect",13),2&a){const n=t.XpG(3);t.Y8G("effect",n.effects[0])("edition",n.edition)("eventType",n.eventType)("light",n.light)("inline",!0)("concatenated",!0)("selected",n.selected)}}function LT(a,r){if(1&a&&(t.j41(0,"span",8),t.nrm(1,"span",3),t.nVh(2,zT,1,7,"ghs-event-card-effect",13),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(3,Ge,n.light))("ghs-label","game.events.effects.additionally"),t.R7$(),t.vxM(1==n.effects.length?2:-1)}}function qT(a,r){if(1&a&&t.nrm(0,"span",3),2&a){const n=t.XpG(4);t.Y8G("ngClass",t.eq3(2,Ge,n.light))("ghs-label","game.events.effects.and")}}function HT(a,r){if(1&a&&(t.nVh(0,qT,1,4,"span",3),t.nrm(1,"ghs-event-card-effect",14)),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.vxM(i>0?0:-1),t.R7$(),t.Y8G("effect",n)("edition",e.edition)("eventType",e.eventType)("light",e.light)("concatenated",!0)("selected",e.selected)}}function KT(a,r){if(1&a&&(t.j41(0,"span",9),t.Z7z(1,HT,2,7,null,null,wr),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Dyx(n.effects)}}function WT(a,r){if(1&a&&t.nrm(0,"ghs-event-card-effect",17),2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG(3);t.Y8G("effect",i)("edition",o.edition)("eventType",o.eventType)("light",o.light)("inline",!0)("selected",o.checks>e)}}function ZT(a,r){if(1&a){const n=t.RV6();t.j41(0,"label",15)(1,"span",16),t.bIt("singleClick",function(){const e=c.eBV(n).$index,o=t.XpG(3);return c.Njj(o.check(e))}),t.k0s(),t.nVh(2,WT,1,6,"ghs-event-card-effect",17),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.Y8G("ngClass",t.eq3(3,DT,n)),t.R7$(),t.Y8G("ngClass",t.l_i(5,$T,e.checks>i,e.light)),t.R7$(),t.vxM(n?2:-1)}}function JT(a,r){if(1&a&&(t.j41(0,"span",10),t.Z7z(1,ZT,3,8,"label",15,AT),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Dyx(n.effects)}}function QT(a,r){if(1&a&&(t.j41(0,"span",11),t.nrm(1,"img",18),t.k0s()),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(2,IT,n.light))("ghs-tooltip","game.events.effects.automation")}}function t8(a,r){if(1&a&&(t.j41(0,"span",2),t.nVh(1,FT,1,4,"ghs-event-card-condition",4),t.nVh(2,XT,2,0,"span",5),t.nVh(3,BT,1,10,"span",6),t.nVh(4,NT,5,8,"span",7),t.nVh(5,LT,3,5,"span",8),t.nVh(6,KT,3,0,"span",9),t.nVh(7,JT,3,0,"span",10),t.nVh(8,QT,2,4,"span",11),t.k0s()),2&a){const n=t.XpG();t.Y8G("ngClass",t.l_i(9,jT,n.light,n.inline||n.concatenated)),t.R7$(),t.vxM(n.effectObject.condition?1:-1),t.R7$(),t.vxM(n.effectObject.condition?2:-1),t.R7$(),t.vxM(n.effectObject.type&&!n.special.includes(n.effectObject.type)?3:-1),t.R7$(),t.vxM("choose"==n.effectObject.type?4:-1),t.R7$(),t.vxM("additionally"==n.effectObject.type?5:-1),t.R7$(),t.vxM("and"==n.effectObject.type?6:-1),t.R7$(),t.vxM("checkbox"==n.effectObject.type?7:-1),t.R7$(),t.vxM(!n.concatenated&&n.settingsManager.settings.eventsApply&&n.applicable?8:-1)}}let Wi=(()=>{class a{effect;edition;eventType;light=!0;concatenated=!1;inline=!1;selected=!1;checks=0;debug=!1;onCheck=new t.bkB;effectString;effectObject;labelArgs=[];effects=[];disabled=!1;applicable=!1;settingsManager=p.f;special=[bt.Yj.additionally,bt.Yj.and,bt.Yj.checkbox,bt.Yj.choose];ngOnInit(){if("string"==typeof this.effect)this.effectString=this.effect;else if(this.effect){if(this.effectObject=this.effect,this.labelArgs=this.effectObject.values?this.effectObject.values.filter(n=>"number"==typeof n||"string"==typeof n):[],this.effects=this.effectObject.values?this.effectObject.values.filter(n=>"number"!=typeof n):[],this.applicable=s.E.eventCardManager.applicableEffect(this.effectObject),(this.effectObject.type==bt.Yj.and||this.effectObject.type==bt.Yj.additionally||this.effectObject.type==bt.Yj.checkbox)&&(this.applicable=this.effects.some(n=>"object"==typeof n&&s.E.eventCardManager.applicableEffect(n))),this.disabled=this.effectObject.condition&&!s.E.eventCardManager.resolvableCondition(this.effectObject.condition)||!1,this.effectObject.type==bt.Yj.scenarioCondition||this.effectObject.type==bt.Yj.traitScenarioCondition){let n="",i=this.effectObject.values||[];this.effectObject.type==bt.Yj.traitScenarioCondition&&(i=i.slice(1)),i.filter(e=>"string"==typeof e).map(e=>{const o=e.split(":");return 2==o.length?"%game.condition."+o[0]+"% x"+o[1]:"%game.condition."+o[0]+"%"}).forEach((e,o,g)=>{n+=e,g.length>1&&(o<g.length-2?n+=", ":o<g.length-1&&(n+=" %and% "))}),this.labelArgs=[n],this.effectObject.type==bt.Yj.traitScenarioCondition&&"string"==typeof this.effectObject.values[0]&&this.labelArgs.unshift(this.effectObject.values[0])}this.labelArgs.push(this.edition)}}check(n){this.selected&&(this.checks=this.checks==n+1?n:n+1,this.onCheck.emit(this.checks))}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-event-card-effect"]],inputs:{effect:"effect",edition:"edition",eventType:"eventType",light:"light",concatenated:"concatenated",inline:"inline",selected:"selected",checks:"checks",debug:"debug"},outputs:{onCheck:"onCheck"},standalone:!1,decls:3,vars:8,consts:[[1,"effect",3,"ngClass"],[1,"text",3,"ngClass"],[1,"effect-object",3,"ngClass"],[3,"ngClass","ghs-label"],[3,"condition","edition","eventType","light"],[1,"condition-spacer"],[1,"text",3,"ngClass","ghs-label","ghs-label-args","slice"],[1,"choose-container"],[1,"additional-container"],[1,"and-container"],[1,"checkbox-container"],[1,"automation-icon",3,"ngClass","ghs-tooltip"],[3,"effect","edition","eventType","light","concatenated"],[3,"effect","edition","eventType","light","inline","concatenated","selected"],[3,"effect","edition","eventType","light","concatenated","selected"],[3,"ngClass"],["ghs-pointer-input","",1,"checkbox",3,"singleClick","ngClass"],[3,"effect","edition","eventType","light","inline","selected"],["src","./assets/images/automation.svg",1,"hint-trigger","ghs-svg"]],template:function(i,e){1&i&&(t.j41(0,"span",0),t.nVh(1,VT,2,9,"span",1),t.nVh(2,t8,9,12,"span",2),t.k0s()),2&i&&(t.Y8G("ngClass",t.ziG(3,wT,"fh"==e.edition,"city"==e.eventType,e.disabled,e.selected)),t.R7$(),t.vxM(e.effectString?1:-1),t.R7$(),t.vxM(e.effectObject?2:-1))},dependencies:[N.YU,Ki,a,it,Mt,dt],styles:['.effect[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-weight:700;opacity:.7}.effect.selected[_ngcontent-%COMP%]{opacity:1}.effect.city[_ngcontent-%COMP%]{font-weight:400}.effect.fh[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-normal)}.effect.fh[_ngcontent-%COMP%]   ghs-event-card-condition[_ngcontent-%COMP%]{font-weight:400;font-style:italic;text-transform:uppercase}.effect.disabled[_ngcontent-%COMP%]{opacity:.5}.effect[_ngcontent-%COMP%]   .text.concatenated[_ngcontent-%COMP%]{display:inline}.effect[_ngcontent-%COMP%]   .text.concatenated[_ngcontent-%COMP%]:first-letter{text-transform:lowercase}.effect[_ngcontent-%COMP%]   .text.debug[_ngcontent-%COMP%]{color:red}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]{position:relative;display:block}.effect[_ngcontent-%COMP%]   .effect-object.inline[_ngcontent-%COMP%]{display:inline;margin-left:.1em}.effect[_ngcontent-%COMP%]   .effect-object.inline[_ngcontent-%COMP%]   .automation-icon[_ngcontent-%COMP%]{position:relative;top:.2em;left:initial;margin:0 .1em;transform:none}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .automation-icon[_ngcontent-%COMP%]{position:absolute;top:50%;left:-1.1em;display:inline-flex;width:.9em;height:.9em;transform:translateY(-50%)}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .automation-icon[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:100%;height:auto;filter:var(--ghs-filter-black);margin-left:0}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .automation-icon.light[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .automation-icon.light[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .condition-spacer[_ngcontent-%COMP%]{margin-right:.2em}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .choose-container[_ngcontent-%COMP%]   ghs-event-card-effect[_ngcontent-%COMP%]{font-size:.834em;margin:0 .2em}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .choose-container[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]:last-child{margin-left:-.2em}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .and-container[_ngcontent-%COMP%]   ghs-event-card-effect[_ngcontent-%COMP%]{margin:0 .2em}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .and-container[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]:last-child{margin-left:-.2em}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]{display:inline-flex;flex-wrap:wrap}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;justify-content:center;align-items:center;width:.8em;height:.8em;border:.15em solid var(--ghs-color-black);background-color:var(--ghs-color-white);border-radius:.1em;box-shadow:.15em .15em var(--ghs-color-gray);z-index:2;margin-right:.4em}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:before{content:" ";position:absolute;left:50%;top:50%;width:115%;height:115%;transform:scale(0);transform-origin:top left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;z-index:1;background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;filter:var(--ghs-filter-darkgray)}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .checkbox.checked[_ngcontent-%COMP%]:before{transform:scale(1) translate(-50%,-50%)}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .checkbox.checked.check[_ngcontent-%COMP%]:before{transform:scale(1)}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .checkbox.light[_ngcontent-%COMP%]{border:.1em solid var(--ghs-color-white);background-color:transparent}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .checkbox.light[_ngcontent-%COMP%]:before{filter:var(--ghs-filter-white)}']})}return a})();const n8=a=>({selected:a}),e8=a=>({light:a}),Zi=a=>({"text-white":a});function a8(a,r){if(1&a&&t.nrm(0,"span",6),2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(2,Zi,n.light))("ghs-label",n.attack.targetDescription)}}function i8(a,r){if(1&a&&t.nrm(0,"span",8),2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(2,Zi,n.light))("ghs-label",n.attack.narrative)}}function o8(a,r){if(1&a&&t.nrm(0,"ghs-event-card-effect",10),2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("effect",n)("edition",i.edition)("eventType",i.eventType)("light",i.light)("selected",!0)("debug",i.debug)}}function s8(a,r){if(1&a&&(t.j41(0,"div",9),t.Z7z(1,o8,1,6,"ghs-event-card-effect",10,t.fX1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(n.attack.effects)}}let Ji=(()=>{class a{attack;edition;eventType;selected=!1;targetDescription=!0;narrative=!0;effects=!0;disabled=!1;light=!1;onToggle=new t.bkB;debug=!1;toggleSelected(){this.disabled||(this.selected=!this.selected,this.onToggle.emit(this.selected))}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-event-card-attack"]],inputs:{attack:"attack",edition:"edition",eventType:"eventType",selected:"selected",targetDescription:"targetDescription",narrative:"narrative",effects:"effects",disabled:"disabled",light:"light",debug:"debug"},outputs:{onToggle:"onToggle"},standalone:!1,decls:12,vars:14,consts:[["ghs-pointer-input","",1,"attack",3,"doubleClick","ngClass"],[1,"main",3,"ngClass"],[1,"attack-value"],["src","./assets/images/fh/action/attack.svg"],[1,"target-number"],["src","./assets/images/fh/action/target.svg"],[1,"target-description",3,"ngClass","ghs-label"],[1,"text",3,"ngClass"],[1,"text",3,"ngClass","ghs-label"],[1,"effects"],[3,"effect","edition","eventType","light","selected","debug"]],template:function(i,e){1&i&&(t.j41(0,"span",0),t.bIt("doubleClick",function(){return e.toggleSelected()}),t.j41(1,"div",1)(2,"span",2),t.nrm(3,"img",3),t.EFF(4),t.k0s(),t.j41(5,"span",4),t.nrm(6,"img",5),t.EFF(7),t.k0s()(),t.nVh(8,a8,1,4,"span",6),t.j41(9,"span",7),t.nVh(10,i8,1,4,"span",8),t.k0s(),t.nVh(11,s8,3,0,"div",9),t.k0s()),2&i&&(t.Y8G("ngClass",t.eq3(8,n8,e.selected)),t.R7$(),t.Y8G("ngClass",t.eq3(10,e8,e.light)),t.R7$(3),t.JRh(e.attack.attackValue),t.R7$(3),t.JRh(e.attack.targetNumber),t.R7$(),t.vxM(e.targetDescription&&e.attack.targetDescription?8:-1),t.R7$(),t.Y8G("ngClass",t.eq3(12,Zi,e.light)),t.R7$(),t.vxM(e.narrative&&e.attack.narrative?10:-1),t.R7$(),t.vxM(e.effects&&e.attack.effects?11:-1))},dependencies:[N.YU,Wi,it,dt],styles:[".attack[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;opacity:.5}.attack.selected[_ngcontent-%COMP%]{opacity:1}.attack[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.attack[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .attack-value[_ngcontent-%COMP%], .attack[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .target-number[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-fh-normal);font-weight:700;margin:.3em}.attack[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .attack-value[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .attack[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .target-number[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:.9em;width:auto}.attack[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .attack-value.attack-value[_ngcontent-%COMP%], .attack[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .target-number.attack-value[_ngcontent-%COMP%]{font-size:2.5em}.attack[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .attack-value.target-number[_ngcontent-%COMP%], .attack[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .target-number.target-number[_ngcontent-%COMP%]{font-size:1.6em}.attack[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .attack-value.target-number[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .attack[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .target-number.target-number[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-right:.1em}.attack[_ngcontent-%COMP%]   .main.light[_ngcontent-%COMP%]   .attack-value[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .attack[_ngcontent-%COMP%]   .main.light[_ngcontent-%COMP%]   .target-number[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.attack[_ngcontent-%COMP%]   .target-description[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-normal);font-weight:700;text-align:center}.attack[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-normal);font-style:italic;margin:.5em 0}.attack[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]{align-self:flex-start}"]})}return a})();const r8=(a,r,n)=>({flipped:a,disabled:r,"show-debug":n}),Rr=a=>({gh2e:a}),c8=a=>({spoiler:a}),l8=a=>({single:a}),Qi=a=>[a],to=a=>({light:a}),g8=a=>({"no-label":a}),d8=(a,r,n,i)=>({selected:a,single:r,"no-label":n,attack:i}),h8=(a,r,n,i)=>({selected:a,disabled:r,"expand-to-bottom":n,margin:i}),_8=(a,r)=>({"text-white":a,inline:r}),m8=a=>({inline:a}),no=(a,r)=>r._trackUUID,p8=(a,r)=>("object"==typeof r?r.type:r)+""+a;function u8(a,r){if(1&a&&t.nrm(0,"span",14),2&a){const n=t.XpG(2).$implicit;t.Y8G("ghs-label","game.events.option")("ghs-label-args",t.eq3(2,Qi,n.label))}}function f8(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",13),t.bIt("singleClick",function(e){c.eBV(n);const o=t.XpG().$index,g=t.XpG(2);return c.Njj(g.selectOption(o,!1,e))}),t.nVh(1,u8,1,4,"span",14),t.nrm(2,"span",15),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.Y8G("ngClass",t.eq3(3,l8,1==i.event.options.length||!n.label)),t.R7$(),t.vxM(n.label?1:-1),t.R7$(),t.Y8G("ghs-label",n.narrative)}}function C8(a,r){1&a&&t.nVh(0,f8,3,5,"div",12),2&a&&t.vxM(r.$implicit.narrative?0:-1)}function M8(a,r){if(1&a&&t.nrm(0,"div",8),2&a){const n=t.XpG(2);t.Y8G("ghs-label",n.event.footer)}}function v8(a,r){if(1&a&&(t.j41(0,"div",9),t.nrm(1,"span",16)(2,"span",16),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","game.events.requirements")("ghs-label-args",t.eq3(4,Qi,n.event.requirement.partyAchievement)),t.R7$(),t.Y8G("ghs-label","game.events.requirements.partyAchievement")("ghs-label-args",t.eq3(6,Qi,n.event.requirement.partyAchievement))}}function O8(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",10)(1,"a",17),t.bIt("singleClick",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.setSpoilerFree(!1,e))}),t.EFF(2),t.k0s()()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(2,to,n.light)),t.R7$(2),t.JRh(n.event.cardId)}}function P8(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",4)(1,"div",5),t.nrm(2,"div",6),t.j41(3,"div",7),t.Z7z(4,C8,1,1,null,null,no),t.nI1(6,"trackUUID"),t.k0s(),t.nVh(7,M8,1,1,"div",8),t.k0s(),t.nVh(8,v8,3,8,"div",9),t.k0s(),t.nVh(9,O8,3,4,"div",10),t.j41(10,"div",11),t.bIt("singleClick",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setSpoilerFree(!0,e))}),t.EFF(11),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(8,c8,n.spoilerFree)),t.R7$(2),t.Y8G("ghs-label",n.event.narrative),t.R7$(2),t.Dyx(t.bMT(6,6,n.event.options)),t.R7$(3),t.vxM(n.event.footer?7:-1),t.R7$(),t.vxM(n.event.requirement&&n.event.requirement.partyAchievement?8:-1),t.R7$(),t.vxM(n.spoilerFree?9:-1),t.R7$(2),t.SpI("",n.event.cardId," ")}}function b8(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",18),t.bIt("singleClick",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.toggleShowDebug(e))}),t.nrm(1,"img",19),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(1,to,n.light))}}function k8(a,r){if(1&a&&t.nrm(0,"ghs-event-card-condition",26),2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG().$index,g=t.XpG(2);t.Y8G("condition",i.condition)("narrative",!0)("edition",g.event.edition)("eventType",g.event.type)("light",g.light)("selected",-1==g.selected&&g.flipped||g.selected==o&&g.subSelections.includes(e))("debug",g.debug)}}function y8(a,r){1&a&&(t.j41(0,"span",27),t.EFF(1,":"),t.k0s())}function x8(a,r){if(1&a&&t.nrm(0,"span",28),2&a){const n=t.XpG().$implicit,i=t.XpG(3);t.Y8G("ngClass",t.l_i(2,_8,i.light,n.inlineEffects&&n.effects.length))("ghs-label",n.narrative)}}function E8(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-event-card-effect",33),t.bIt("onCheck",function(e){const o=c.eBV(n).$index,g=t.XpG(5);return c.Njj(g.onCheck(o,e))}),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2),o=e.$implicit,g=e.$index,m=t.XpG().$index,k=t.XpG(2);t.Y8G("effect",n)("edition",k.event.edition)("eventType",k.event.type)("light",k.light)("selected",-1==k.selected&&k.flipped||k.selected==m&&k.subSelections.includes(g))("inline",o.inlineEffects||!1)("checks",!!k.checks&&k.checks[i]||0)("debug",k.debug)}}function w8(a,r){if(1&a&&(t.j41(0,"div",29),t.Z7z(1,E8,1,8,"ghs-event-card-effect",32,p8),t.k0s()),2&a){const n=t.XpG().$implicit;t.Y8G("ngClass",t.eq3(1,m8,n.inlineEffects)),t.R7$(),t.Dyx(n.effects)}}function R8(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-event-card-attack",34),t.bIt("onToggle",function(e){c.eBV(n);const o=t.XpG(4);return c.Njj(o.toggleAttack(e))}),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG(3);t.Y8G("attack",n.attack)("edition",i.event.edition)("eventType",i.event.type)("light",i.light)("selected",i.attack)("debug",i.debug)}}function j8(a,r){1&a&&t.nrm(0,"img",35)}function G8(a,r){1&a&&t.nrm(0,"img",36)}function T8(a,r){if(1&a&&(t.j41(0,"div",31),t.nVh(1,j8,1,0,"img",35),t.nVh(2,G8,1,0,"img",36),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG().$implicit;t.R7$(),t.vxM(n.returnToDeck||i.returnToDeck?1:-1),t.R7$(),t.vxM(n.removeFromDeck||i.removeFromDeck?2:-1)}}function S8(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",25),t.bIt("singleClick",function(e){const o=c.eBV(n).$index,g=t.XpG().$index,m=t.XpG(2);return c.Njj(m.selectSub(g,o,e))})("doubleClick",function(e){const o=c.eBV(n).$index,g=t.XpG().$index,m=t.XpG(2);return c.Njj(m.selectSub(g,o,!0,e))}),t.nVh(1,k8,1,7,"ghs-event-card-condition",26),t.nVh(2,y8,2,0,"span",27),t.nVh(3,x8,1,5,"span",28),t.nVh(4,w8,3,3,"div",29),t.nVh(5,R8,1,6,"ghs-event-card-attack",30),t.nVh(6,T8,3,2,"div",31),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(),o=e.$implicit,g=e.$index,m=t.XpG(2);t.Y8G("ngClass",t.ziG(7,h8,m.subSelections.includes(i)||-1==m.selected&&m.flipped||!o.label&&n.attack,m.resolvable[g]&&0==m.resolvable[g][i]&&!m.subSelections.includes(i)&&-1!=m.selected,i==o.outcomes.length-1&&(o.returnToDeck||o.removeFromDeck),n.condition||n.narrative)),t.R7$(),t.vxM(n.condition?1:-1),t.R7$(),t.vxM(n.condition?2:-1),t.R7$(),t.vxM(n.narrative?3:-1),t.R7$(),t.vxM(n.effects&&n.effects.length?4:-1),t.R7$(),t.vxM(n.attack?5:-1),t.R7$(),t.vxM(n.returnToDeck||n.removeFromDeck||i==o.outcomes.length-1&&(o.returnToDeck||o.removeFromDeck)?6:-1)}}function D8(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",23),t.bIt("doubleClick",function(e){const o=c.eBV(n).$index,g=t.XpG(2);return c.Njj(g.selectOption(g.selected==o?-1:o,!1,e))}),t.Z7z(1,S8,7,12,"div",24,no),t.nI1(3,"trackUUID"),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.HbH(t.ai1("option ","option-"+(n.label||"no-label")," ","option-bg-"+(e.event.options.length-i))),t.Y8G("ngClass",t.ziG(7,d8,!n.label||e.selected==i||-1==e.selected&&e.flipped,1==e.event.options.length,!n.label,e.attackIndex==i)),t.R7$(),t.Dyx(t.bMT(3,5,n.outcomes))}}function $8(a,r){if(1&a&&(t.j41(0,"div",20),t.Z7z(1,D8,4,12,"div",21,no),t.nI1(3,"trackUUID"),t.k0s(),t.j41(4,"div",22),t.EFF(5),t.k0s()),2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(4,g8,n.noLabel)),t.R7$(),t.Dyx(t.bMT(3,2,n.event.options)),t.R7$(4),t.JRh(n.event.cardId)}}function I8(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",18),t.bIt("singleClick",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.toggleShowDebug(e))}),t.nrm(1,"img",19),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(1,to,n.light))}}let Xa=(()=>{class a{gameManager=s.E;settingsManager=p.f;event;identifier;select=-1;subSelect=[];checks=[];flipped=!1;disabled=!1;spoiler=!1;debug=!1;onSelect=new t.bkB;selected=-1;subSelections=[];attackIndex=-1;attack=!1;light=!1;spoilerFree=!1;noLabel=!1;resolvable=[];showDebug=!1;ngOnInit(){if(this.event){this.event.options.forEach((i,e)=>{i.outcomes&&(this.resolvable[e]=this.resolvable[e]||[],i.outcomes.forEach((o,g)=>{this.resolvable[e][g]=!o.condition||!!o.condition&&s.E.eventCardManager.resolvableCondition(o.condition),o.attack&&(this.attackIndex=e,this.attack=!0)}))}),this.noLabel=this.event.options.every(i=>!i.label);const n=this.identifier||s.E.game.party.eventCards.find(i=>this.event&&i.cardId==this.event.cardId&&i.type==this.event.type&&i.edition==this.event.edition);n&&n.checks&&(this.checks=[...n.checks])}this.spoilerFree=this.spoiler,this.selected=this.select,this.subSelections=this.subSelect}ngOnChanges(n){n.identifier&&n.identifier.previousValue!=n.identifier.currentValue?!this.event&&this.identifier&&(this.event=s.E.eventCardManager.getEventCardForEdition(this.identifier.edition,this.identifier.type,this.identifier.cardId),this.event&&(this.selected=this.identifier.selected,this.subSelections=this.identifier.subSelections),this.identifier.checks&&(this.checks=[...this.identifier.checks])):n.select&&n.select.previousValue!=n.select.currentValue&&this.selected!=this.select?this.selectOption(this.select,!0):n.spoiler&&n.spoiler.previousValue!=n.spoiler.currentValue&&(this.spoilerFree=this.spoiler),this.light=this.event&&["city"].includes(this.event.type)||!1}selectOption(n,i,e=void 0){-1!=this.attackIndex&&this.attackIndex==n||(this.event&&!this.disabled&&this.selected!=n&&(this.attack=-1!=this.attackIndex,this.selected=n,this.subSelections=[],this.selected<-1&&(this.selected=-1),this.subSelections=[],n>-1&&this.event.options[n]&&this.event.options[n].outcomes.forEach((o,g)=>{this.resolvable[n]&&this.resolvable[n][g]&&("string"!=typeof o.condition&&o.condition&&o.condition.type===bt.iH.otherwise&&this.resolvable[n].some((m,k)=>this.event&&m&&k<g&&!!this.event.options[n].outcomes[k].condition)||this.subSelections.push(g),this.subSelections.includes(g)&&o.effects&&o.effects.some(m=>"object"==typeof m&&m.type==bt.Yj.skipThreat)&&(this.attack=!1))}),i||this.onSelect.emit(new bt.Qc(this.event.cardId,this.event.edition,this.event.type,this.selected,this.subSelections,this.checks,this.attack,!1)),this.event.options[n]&&!this.event.options[n].label&&(this.flipped=!0,this.selected=-1)),e&&e.preventDefault())}selectSub(n,i,e=!1,o=void 0){if(-1==this.attackIndex||this.attackIndex!=i){if(this.event&&!this.disabled&&this.selected==n){if(this.subSelections.includes(i))this.subSelections.splice(this.subSelections.indexOf(i),1);else if((this.resolvable[this.selected]&&this.resolvable[this.selected][i]||e)&&(this.subSelections.push(i),!e)){const g=this.event.options[this.selected].outcomes[i].condition;if(g&&"string"!=typeof g&&g.type==bt.iH.otherwise)this.subSelections=[i];else{const m=this.event.options[this.selected].outcomes.find(k=>k.condition&&"string"!=typeof k.condition&&k.condition.type==bt.iH.otherwise);m&&(this.subSelections=this.subSelections.splice(this.event.options[this.selected].outcomes.indexOf(m),1))}}this.onSelect.emit(new bt.Qc(this.event.cardId,this.event.edition,this.event.type,this.selected,this.subSelections,this.checks,this.attack,!1))}else e&&this.selectOption(n,!1);o&&o.preventDefault()}}onCheck(n,i){this.checks=this.checks||[],this.checks[n]=i,this.event&&this.onSelect.emit(new bt.Qc(this.event.cardId,this.event.edition,this.event.type,this.selected,this.subSelections,this.checks,this.attack,!1))}toggleAttack(n){this.attack=n,this.event&&this.onSelect.emit(new bt.Qc(this.event.cardId,this.event.edition,this.event.type,this.selected,this.subSelections,this.checks,this.attack,!1))}setSpoilerFree(n,i=void 0){this.spoilerFree=n,i&&i.preventDefault()}toggleShowDebug(n=void 0){this.showDebug=!this.showDebug,n&&n.preventDefault()}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-event-card"]],inputs:{event:"event",identifier:"identifier",select:"select",subSelect:"subSelect",checks:"checks",flipped:"flipped",disabled:"disabled",spoiler:"spoiler",debug:"debug"},outputs:{onSelect:"onSelect"},standalone:!1,features:[t.OA$],decls:9,vars:30,consts:[["container",""],[1,"event-card-container"],[3,"ngClass"],["ghs-pointer-input","",1,"show-debug-toggle",3,"ngClass"],[1,"wrapper",3,"ngClass"],[1,"content"],[1,"text","placeholder",3,"ghs-label"],[1,"options"],[1,"footer",3,"ghs-label"],[1,"requirement","party-achievement"],[1,"spoiler-free",3,"ngClass"],["ghs-pointer-input","",1,"card-id",3,"singleClick"],["ghs-pointer-input","",1,"option",3,"ngClass"],["ghs-pointer-input","",1,"option",3,"singleClick","ngClass"],[1,"title",3,"ghs-label","ghs-label-args"],[1,"choice",3,"ghs-label"],[3,"ghs-label","ghs-label-args"],["ghs-pointer-input","",3,"singleClick"],["ghs-pointer-input","",1,"show-debug-toggle",3,"singleClick","ngClass"],["src","./assets/images/debug.svg"],[1,"options",3,"ngClass"],["ghs-pointer-input","",3,"class","ngClass"],[1,"card-id"],["ghs-pointer-input","",3,"doubleClick","ngClass"],["ghs-pointer-input","",1,"outcome",3,"ngClass"],["ghs-pointer-input","",1,"outcome",3,"singleClick","doubleClick","ngClass"],[3,"condition","narrative","edition","eventType","light","selected","debug"],[1,"condition-spacer"],[1,"text",3,"ngClass","ghs-label"],[1,"effects",3,"ngClass"],[3,"attack","edition","eventType","light","selected","debug"],[1,"card-action"],[3,"effect","edition","eventType","light","selected","inline","checks","debug"],[3,"onCheck","effect","edition","eventType","light","selected","inline","checks","debug"],[3,"onToggle","attack","edition","eventType","light","selected","debug"],["src","./assets/images/eventcards/return.svg",1,"ghs-svg"],["src","./assets/images/eventcards/remove.svg",1,"ghs-svg"]],template:function(i,e){if(1&i&&(t.j41(0,"div",1,0)(2,"div",2)(3,"div",2),t.nVh(4,P8,12,10),t.nVh(5,b8,2,3,"div",3),t.k0s(),t.j41(6,"div",2),t.nVh(7,$8,6,6),t.nVh(8,I8,2,3,"div",3),t.k0s()()()),2&i){const o=t.sdS(1);t.R7$(2),t.HbH(t.VkB("card vertical reverse event ",e.selected)),t.xc7("font-size",.07*o.offsetWidth+"px"),t.Y8G("ngClass",t.sMw(22,r8,-1!=e.selected||e.flipped&&!e.spoilerFree,e.disabled,e.showDebug)),t.R7$(),t.HbH(t.VkB("card-back ",e.event?e.event.type:"")),t.xc7("background-image",e.showDebug&&e.event?"url('./assets/artwork/events/debug/"+e.event.edition+"/"+e.event.type+"/"+e.event.cardId+"-back.png')":""),t.Y8G("ngClass",t.eq3(26,Rr,!!e.event&&"gh2e"==e.event.edition)),t.R7$(),t.vxM(e.event?4:-1),t.R7$(),t.vxM(e.settingsManager.settings.debugEventCards?5:-1),t.R7$(),t.HbH(t.VkB("card-front ",e.event?e.event.type:"")),t.xc7("background-image",e.showDebug&&e.event?"url('./assets/artwork/events/debug/"+e.event.edition+"/"+e.event.type+"/"+e.event.cardId+"-front.png')":""),t.Y8G("ngClass",t.eq3(28,Rr,!!e.event&&"gh2e"==e.event.edition)),t.R7$(),t.vxM(e.event?7:-1),t.R7$(),t.vxM(e.settingsManager.settings.debugEventCards?8:-1)}},dependencies:[N.YU,Ji,Ki,Wi,it,dt,ct],styles:['.event-card-container[_ngcontent-%COMP%]{position:relative;width:100%;padding-bottom:147%}.event[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;border:.2em solid transparent;border-radius:.5em}.event.show-debug[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%], .event.show-debug[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event.show-debug[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%], .event.show-debug[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%], .event.show-debug[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event.show-debug[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]{display:none}.event[_ngcontent-%COMP%]   .show-debug-toggle[_ngcontent-%COMP%]{display:block;position:absolute;bottom:.1em;left:50%;transform:translate(-50%);width:.8em;height:.8em;cursor:help;z-index:999}.event[_ngcontent-%COMP%]   .show-debug-toggle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:block;width:100%;height:auto}.event[_ngcontent-%COMP%]   .show-debug-toggle.light[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]{background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:.5em;background-color:var(--ghs-color-lightgray)}.event[_ngcontent-%COMP%]   .card-front.city[_ngcontent-%COMP%]{background-image:url(city-front.72f7a8a684e5519e.png);color:var(--ghs-color-white)}.event[_ngcontent-%COMP%]   .card-front.city[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.event[_ngcontent-%COMP%]   .card-front.city[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.event[_ngcontent-%COMP%]   .card-front.road[_ngcontent-%COMP%]{background-image:url(road-front.b4152d88c7f5410f.png);color:var(--ghs-color-darkgray)}.event[_ngcontent-%COMP%]   .card-front.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before{color:var(--ghs-color-brown)}.event[_ngcontent-%COMP%]   .card-front.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(2):before{filter:grayscale(.7)}.event[_ngcontent-%COMP%]   .card-front.rift[_ngcontent-%COMP%]{background-image:url(rift-front.958e71aca4e5e468.png);color:var(--ghs-color-darkgray)}.event[_ngcontent-%COMP%]   .card-front.rift[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before{color:var(--ghs-color-purple);filter:brightness(.5)}.event[_ngcontent-%COMP%]   .card-front.rift[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(2):before{filter:brightness(.5) grayscale(.6)}.event[_ngcontent-%COMP%]   .card-front.rift[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-black)}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]{padding-left:2.5em;padding-right:1em;padding-top:.5em;font-size:.65em;max-height:initial}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before{z-index:1;font-family:var(--ghs-font-fh-text);font-size:1.6em;left:.5em;top:.7em}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:first-child, .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:first-child, .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:first-child, .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:first-child, .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:first-child, .event[_ngcontent-%COMP%]   .card-front.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:first-child{padding-top:1em}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(2):before, .event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(3):before, .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(2):before, .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(3):before, .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(2):before, .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(3):before, .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(2):before, .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(3):before, .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(2):before, .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(3):before, .event[_ngcontent-%COMP%]   .card-front.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(2):before, .event[_ngcontent-%COMP%]   .card-front.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(3):before{top:.4em}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.no-label[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.no-label[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.no-label[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.no-label[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.no-label[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.no-label[_ngcontent-%COMP%]:before{display:none}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:-1em;left:0;width:100%;height:calc(100% + 1em);background-color:#c5cdcc;-webkit-mask:url(fh-option-2-mask.29440ac7bef2beb4.png) no-repeat;mask:url(fh-option-2-mask.29440ac7bef2beb4.png) no-repeat;-webkit-mask-size:100% auto;mask-size:100% auto;-webkit-mask-position:center bottom;mask-position:center bottom;z-index:0;filter:brightness(1.2)}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]{padding-bottom:.5em}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%]{top:-1em;padding-top:1.5em;padding-bottom:.5em}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%]:before{top:1em}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%] + .option-bg-1[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%] + .option-bg-1[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%] + .option-bg-1[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%] + .option-bg-1[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%] + .option-bg-1[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%] + .option-bg-1[_ngcontent-%COMP%]{margin-top:-1.5em}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:0;left:0;width:100%;height:100%;background-color:#9ea5a4;-webkit-mask:url(fh-option-3-mask.d56ca294e38ee47b.png) no-repeat;mask:url(fh-option-3-mask.d56ca294e38ee47b.png) no-repeat;-webkit-mask-size:100% auto;mask-size:100% auto;-webkit-mask-position:center bottom;mask-position:center bottom;z-index:0;filter:brightness(1.4)}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected.option-bg-3[_ngcontent-%COMP%]:after{filter:none}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]{z-index:1}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-normal)}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   ghs-event-card-effect[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   ghs-event-card-effect[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   ghs-event-card-effect[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   ghs-event-card-effect[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   ghs-event-card-effect[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   ghs-event-card-effect[_ngcontent-%COMP%]{font-size:.96em;margin-bottom:.1em}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%]{right:-.5em;bottom:-.5em}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options.no-label[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options.no-label[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options.no-label[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options.no-label[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options.no-label[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.gh2e[_ngcontent-%COMP%]   .options.no-label[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]{padding-left:1.5em}.event[_ngcontent-%COMP%]   .card-front.boat.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.gh2e.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after{background-color:#d1ded8}.event[_ngcontent-%COMP%]   .card-front.boat.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.gh2e.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after{background-color:#a3bdb1}.event[_ngcontent-%COMP%]   .card-front.boat.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.boat.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.gh2e.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.gh2e.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after{background-color:#e5ded3}.event[_ngcontent-%COMP%]   .card-front.boat.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.boat.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.gh2e.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.gh2e.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after{background-color:#b5a281}.event[_ngcontent-%COMP%]   .card-front.boat.city[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road.city[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road.city[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost.city[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost.city[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.gh2e.city[_ngcontent-%COMP%]{background-image:none;background-color:#434448;background:linear-gradient(0deg,#3c3d3f,#292d36)}.event[_ngcontent-%COMP%]   .card-front.boat.road[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road.road[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road.road[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost.road[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost.road[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.gh2e.road[_ngcontent-%COMP%]{background-image:none;background-color:#f1ddc2;color:var(--ghs-color-darkgray)}.event[_ngcontent-%COMP%]   .card-front.boat.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.winter-road.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.summer-road.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.winter-outpost.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.summer-outpost.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.gh2e.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before{color:var(--ghs-color-darkgray)}.event[_ngcontent-%COMP%]   .card-front.boat.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(2):before, .event[_ngcontent-%COMP%]   .card-front.winter-road.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(2):before, .event[_ngcontent-%COMP%]   .card-front.summer-road.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(2):before, .event[_ngcontent-%COMP%]   .card-front.winter-outpost.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(2):before, .event[_ngcontent-%COMP%]   .card-front.summer-outpost.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(2):before, .event[_ngcontent-%COMP%]   .card-front.gh2e.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(2):before{filter:grayscale(.7)}.event[_ngcontent-%COMP%]   .card-front.boat.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.gh2e.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.boat.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.gh2e.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]{padding-bottom:2em}.event[_ngcontent-%COMP%]   .card-front.boat.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.gh2e.gh2e[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%]{padding-bottom:1.5em}.event[_ngcontent-%COMP%]   .card-front.boat.city[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road.city[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road.city[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost.city[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost.city[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.gh2e.city[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after{background:linear-gradient(0deg,#354360,#2f3e5d)}.event[_ngcontent-%COMP%]   .card-front.boat.city[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road.city[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road.city[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost.city[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost.city[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.gh2e.city[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]{background:#2f3e5d}.event[_ngcontent-%COMP%]   .card-front.boat.city[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road.city[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road.city[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost.city[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost.city[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.gh2e.city[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after{background:linear-gradient(0deg,#38454d,#284555)}.event[_ngcontent-%COMP%]   .card-front.boat.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.gh2e.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after{-webkit-mask-image:url(fh-option-3-mask.d56ca294e38ee47b.png);mask-image:url(fh-option-3-mask.d56ca294e38ee47b.png);background:linear-gradient(0deg,#805245,#daa895 2.5em,#f0e9cd)}.event[_ngcontent-%COMP%]   .card-front.boat.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.gh2e.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]{background:#f1ddc2}.event[_ngcontent-%COMP%]   .card-front.boat.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.gh2e.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after{background:linear-gradient(0deg,#805245,#daa895 2.5em,#f0e9cd)}.event[_ngcontent-%COMP%]   .card-front.boat.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.gh2e.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%]:after{background:linear-gradient(0deg,#ba917b,#e4bea9 2.5em,#f5e9d9)}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:flex-start;width:100%;height:100%}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;font-size:.6em;line-height:.9em;letter-spacing:-.01em;padding-top:1.5em;padding-left:4em;padding-right:2em;overflow:auto;max-height:50%;flex:1 1 auto}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.single[_ngcontent-%COMP%]{max-height:100%;padding-left:2em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.single[_ngcontent-%COMP%]:before{display:none}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:first-child{padding-top:2em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before{position:absolute;left:1em;top:1.5em;font-family:var(--ghs-font-title);font-size:2em;opacity:.3}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-A[_ngcontent-%COMP%]{z-index:3}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-A[_ngcontent-%COMP%]:before{content:"A."}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-B[_ngcontent-%COMP%]{z-index:2}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-B[_ngcontent-%COMP%]:before{content:"B.";top:1em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-C[_ngcontent-%COMP%]{z-index:1}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-C[_ngcontent-%COMP%]:before{content:"C.";top:1em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]{position:relative;filter:grayscale(.7);opacity:.3}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome.margin[_ngcontent-%COMP%]{margin-bottom:.5em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome.expand-to-bottom[_ngcontent-%COMP%]{flex-grow:1}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   ghs-event-card-condition[_ngcontent-%COMP%]{margin-right:.1em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .condition-spacer[_ngcontent-%COMP%]{margin-right:.2em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-style:italic;margin-bottom:.5em;letter-spacing:-.03em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .text.inline[_ngcontent-%COMP%]{margin-right:.2em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin-top:.5em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   ghs-event-card-effect[_ngcontent-%COMP%]{font-size:1.2em;display:flex;position:relative;width:100%;margin-bottom:.4em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .effects.inline[_ngcontent-%COMP%]{display:inline;margin-top:0}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .effects.inline[_ngcontent-%COMP%]   ghs-event-card-effect[_ngcontent-%COMP%]{display:inline;width:auto;margin-bottom:0}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%]{position:absolute;bottom:0;right:-1em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:2em;height:auto}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:hover:not(.selected):before, .event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:hover:not(.selected)   .outcome[_ngcontent-%COMP%]{opacity:.7}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected[_ngcontent-%COMP%]{filter:none}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected[_ngcontent-%COMP%]:before{opacity:1}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]{filter:none;cursor:pointer;opacity:1}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected[_ngcontent-%COMP%]   .outcome.selected[_ngcontent-%COMP%]{opacity:1}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected[_ngcontent-%COMP%]   .outcome.disabled[_ngcontent-%COMP%]{opacity:.5;cursor:not-allowed}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]:hover{opacity:.8}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.attack[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]{cursor:initial}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.attack[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]:hover{opacity:initial}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{position:absolute;font-size:.5em;bottom:0;right:.5em}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]{background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:.5em;background-color:var(--ghs-color-lightgray)}.event[_ngcontent-%COMP%]   .card-back.city[_ngcontent-%COMP%]{background-image:url(city-back.76f420e28fe4e8ae.png);color:var(--ghs-color-white)}.event[_ngcontent-%COMP%]   .card-back.city[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before{filter:none}.event[_ngcontent-%COMP%]   .card-back.city[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.event[_ngcontent-%COMP%]   .card-back.road[_ngcontent-%COMP%]{background-image:url(road-back.1c00d9852038e905.png);color:var(--ghs-color-darkgray)}.event[_ngcontent-%COMP%]   .card-back.road[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.event[_ngcontent-%COMP%]   .card-back.rift[_ngcontent-%COMP%]{background-image:url(rift-back.726d02a7f4704dce.png);color:var(--ghs-color-darkgray)}.event[_ngcontent-%COMP%]   .card-back.rift[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .requirement[_ngcontent-%COMP%]{background-image:url(rift-requirement.134b7a3d05ada5e4.png)}.event[_ngcontent-%COMP%]   .card-back.rift[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.event[_ngcontent-%COMP%]   .card-back.boat[_ngcontent-%COMP%]{background-image:url(boat-back.a728bbf99ac0d75a.png)}.event[_ngcontent-%COMP%]   .card-back.winter-road[_ngcontent-%COMP%]{background-image:url(winter-road-back.4f4ee110f797d4c6.png)}.event[_ngcontent-%COMP%]   .card-back.summer-road[_ngcontent-%COMP%]{background-image:url(summer-road-back.5cc710f4ef0f36c9.png)}.event[_ngcontent-%COMP%]   .card-back.summer-outpost[_ngcontent-%COMP%]{background-image:url(summer-outpost-back.8c9fa7a4ca8bc325.png)}.event[_ngcontent-%COMP%]   .card-back.winter-outpost[_ngcontent-%COMP%]{background-image:url(winter-outpost-back.16845c4c5fde4961.png)}.event[_ngcontent-%COMP%]   .card-back.boat[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.winter-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.summer-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]:before{display:none}.event[_ngcontent-%COMP%]   .card-back.boat[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:5% 10% 0}.event[_ngcontent-%COMP%]   .card-back.boat[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.winter-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.summer-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]:before{display:none}.event[_ngcontent-%COMP%]   .card-back.boat[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-normal)}.event[_ngcontent-%COMP%]   .card-back.boat[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.winter-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.summer-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before{left:0;width:100%}.event[_ngcontent-%COMP%]   .card-back.boat[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-normal)}.event[_ngcontent-%COMP%]   .card-back.boat.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.boat.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-road.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-road.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-road.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-road.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-outpost.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-outpost.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-outpost.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-outpost.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.gh2e.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.gh2e.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding-top:0}.event[_ngcontent-%COMP%]   .card-back.boat[_ngcontent-%COMP%]   .spoiler-free[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-road[_ngcontent-%COMP%]   .spoiler-free[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-road[_ngcontent-%COMP%]   .spoiler-free[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-outpost[_ngcontent-%COMP%]   .spoiler-free[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-outpost[_ngcontent-%COMP%]   .spoiler-free[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.gh2e[_ngcontent-%COMP%]   .spoiler-free[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-title)}.event[_ngcontent-%COMP%]   .card-back.boat[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-road[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-road[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-outpost[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-outpost[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.gh2e[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-title);transform:rotate(90deg);font-size:.8em;left:initial;right:-8%;width:22%;height:6%;top:78%;background-size:100% 100%;background-position:top left;background-repeat:no-repeat;background-image:url(fh-card-id.ed6ecd3d94902ee6.png);filter:var(--ghs-filter-shadow)}.event[_ngcontent-%COMP%]   .card-back.boat.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-road.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-road.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-outpost.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-outpost.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.gh2e.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{min-height:initial}.event[_ngcontent-%COMP%]   .card-back.boat.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-road.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-road.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-outpost.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-outpost.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.gh2e.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]{margin-top:1em}.event[_ngcontent-%COMP%]   .card-back.boat.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.winter-road.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.summer-road.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.winter-outpost.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.summer-outpost.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.gh2e.gh2e[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before{left:5%;width:90%;height:.14em;top:-.3em}.event[_ngcontent-%COMP%]   .card-back.boat.city[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-road.city[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-road.city[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-outpost.city[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-outpost.city[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.gh2e.city[_ngcontent-%COMP%]{background-image:url(city-gh2e-back.033daf2856a9e828.png);color:var(--ghs-color-black)}.event[_ngcontent-%COMP%]   .card-back.boat.city[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.winter-road.city[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.summer-road.city[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.winter-outpost.city[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.summer-outpost.city[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.gh2e.city[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before{filter:brightness(0)}.event[_ngcontent-%COMP%]   .card-back.boat.city[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-road.city[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-road.city[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-outpost.city[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-outpost.city[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.gh2e.city[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{color:var(--ghs-color-black);background-image:none;top:80%;right:-7%;filter:none}.event[_ngcontent-%COMP%]   .card-back.boat.road[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-road.road[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-road.road[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-outpost.road[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-outpost.road[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.gh2e.road[_ngcontent-%COMP%]{background-image:url(road-gh2e-back.981d1fb631ece34e.png);color:var(--ghs-color-darkgray)}.event[_ngcontent-%COMP%]   .card-back.boat.road[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-road.road[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-road.road[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-outpost.road[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-outpost.road[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.gh2e.road[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{color:var(--ghs-color-brown);background-image:none;filter:brightness(.4);top:81%;right:-6%}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]{position:absolute;top:12%;width:100%;height:88%;margin:0;z-index:1;opacity:1;transition:opacity calc(var(--ghs-animation-speed) * .75s) ease-in-out}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]:before{content:" ";float:left;height:100%;width:50%;shape-outside:polygon(100% 7%,100% 0%,0% 0%,0% 100%,22% 100%,22% 28%,30% 18%,38% 11%,70% 5.5%);shape-margin:3%}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper.spoiler[_ngcontent-%COMP%]{opacity:0}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{width:100%;height:100%}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]:before{content:" ";float:right;height:100%;width:50%;shape-outside:polygon(0% 7%,0% 0%,100% 0%,100% 100%,78% 100%,78% 28%,70% 18%,62% 11%,30% 5.5%);shape-margin:3%}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:.6em;line-height:.9em;letter-spacing:-.01em;font-style:italic;min-height:65%;text-align:justify}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]{position:relative;margin-top:.5em;padding-top:.1em}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:-.1em;left:12%;height:.1em;width:76%;background-size:100% 100%;background-image:url(divider.3702ad44044cacd0.png);filter:brightness(0)}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]{cursor:pointer;margin-top:.4em;font-family:var(--ghs-font-text);font-size:.6em;line-height:.9em;letter-spacing:-.01em}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:700;margin-right:.3em}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:hover{opacity:.7}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.single[_ngcontent-%COMP%]{font-weight:700}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.single[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:none}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{position:relative;width:106%;left:-3%}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .requirement[_ngcontent-%COMP%]{position:absolute;right:-88%;bottom:-15%;width:100%;height:11%;transform:rotate(-90deg);transform-origin:left top;display:flex;align-items:center;justify-content:center;color:var(--ghs-color-white);font-size:.6em;background-size:100% 100%;background-position:top left;background-repeat:no-repeat;background-image:url(city-requirement.c033e246fae6b4e4.png)}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .requirement[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:.1em}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .spoiler-free[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;z-index:3}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .spoiler-free[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:zoom-in;text-transform:uppercase;font-family:var(--ghs-font-title);font-size:3em;color:var(--ghs-color-darkgray)}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .spoiler-free.light[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--ghs-color-gray)}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{position:absolute;top:89%;left:50%;width:60%;height:10%;display:flex;justify-content:center;align-items:center;text-align:center;text-transform:uppercase;transform:translate(-50%);font-family:var(--ghs-font-title);font-size:.6em;padding-top:.1em;z-index:2;cursor:zoom-out}.event.disabled[_ngcontent-%COMP%]{cursor:initial}']})}return a})();const A8=(a,r)=>({closed:a,opened:r}),jr=()=>[];let Gr=(()=>{class a{dialogRef;eventCard;interactive;spoiler;id;opened=!1;gameManager=s.E;constructor(n,i){this.dialogRef=i,this.eventCard=n.eventCard,this.interactive=n.interactive,this.spoiler=n.spoiler,this.id=n.id}ngOnInit(){this.opened=!0}close(){this.opened=!1,setTimeout(()=>{this.dialogRef.close()},p.f.settings.animations?1e3*p.f.settings.animationSpeed:0)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-event-card-dialog"]],standalone:!1,decls:4,vars:12,consts:[["ghs-pointer-input","",1,"event-card-dialog",3,"singleClick","ngClass"],[1,"event-card-container"],[3,"event","spoiler","disabled","select","subSelect","checks"],[1,"close-container",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.bIt("singleClick",function(){return e.close()}),t.j41(1,"div",1),t.nrm(2,"ghs-event-card",2),t.k0s()(),t.j41(3,"div",3),t.bIt("click",function(){return e.close()}),t.k0s()),2&i&&(t.Y8G("ngClass",t.l_i(7,A8,!e.opened,e.opened)),t.R7$(2),t.Y8G("event",e.eventCard)("spoiler",e.spoiler)("disabled",!e.interactive)("select",e.id?e.id.selected:-1)("subSelect",e.id?e.id.subSelections:t.lJ4(10,jr))("checks",e.id?e.id.checks:t.lJ4(11,jr)))},dependencies:[N.YU,Xa,dt],styles:["[_nghost-%COMP%]{background-color:transparent;padding:0;margin:0;border:0}.event-card-dialog[_ngcontent-%COMP%]{position:relative;width:100vw;height:100vh;border-image:none;background:none;transition:transform calc(var(--ghs-animation-speed) * .15s) ease-in-out;transform:scale(0);z-index:2;overflow:auto;display:flex;justify-content:center;align-items:center;-ms-overflow-style:none;scrollbar-width:none}.event-card-dialog[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.event-card-dialog.opened[_ngcontent-%COMP%]{transform:scale(1)}.event-card-dialog.closed[_ngcontent-%COMP%]{transform:scale(0);transition-delay:.8s}.event-card-dialog[_ngcontent-%COMP%]   .event-card-container[_ngcontent-%COMP%]{overflow:visible;width:100vw;max-width:600px;max-height:100vh}.event-card-dialog[_ngcontent-%COMP%]   .event-card-container[_ngcontent-%COMP%]   ghs-event-card[_ngcontent-%COMP%]{height:150vw;max-height:900px}.close-container[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1}"]})}return a})();const V8=a=>({disabled:a});function F8(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",6)(1,"a",11),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.drawNew())}),t.k0s()()}2&a&&(t.R7$(),t.Y8G("ghs-label","game.events.requirements.warning"))}function X8(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",11),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.accept(!1))}),t.k0s()}2&a&&t.Y8G("ghs-label","game.events.accept.notApply")}function B8(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"ghs-event-card",3),t.bIt("onSelect",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.select(e))}),t.k0s(),t.j41(4,"a",4),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.showEventCard(e.event))}),t.nrm(5,"img",5),t.k0s()()(),t.nVh(6,F8,2,1,"div",6),t.j41(7,"div",7)(8,"a",8),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.cancel())}),t.k0s(),t.nVh(9,X8,1,1,"a",9),t.j41(10,"a",10),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.accept())}),t.k0s()()()}if(2&a){const n=t.XpG();t.R7$(3),t.Y8G("event",n.event),t.R7$(),t.Y8G("ghs-tooltip","game.events.deck.show"),t.R7$(2),t.vxM(n.requirementWarning?6:-1),t.R7$(2),t.Y8G("ghs-label","cancel"),t.R7$(),t.vxM(n.settingsManager.settings.eventsApply?9:-1),t.R7$(),t.Y8G("ngClass",t.eq3(7,V8,-1==n.selected))("ghs-label","game.events.accept")}}let Ba=(()=>{class a{dialogRef;dialog;ghsManager;event;selected=-1;subSelections=[];checks=[];globalDraw=!1;requirementWarning=!1;attack=!1;settingsManager=p.f;constructor(n,i,e,o){this.dialogRef=i,this.dialog=e,this.ghsManager=o;const g=s.E.game.party.eventDecks[n.type];this.globalDraw=null!=s.E.game.eventDraw,g&&(this.event=s.E.eventCardManager.getEventCardForEdition(n.edition,n.type,n.cardId||g[0])),this.event||(console.debug("No event card found for",n.edition,n.type),this.dialogRef.close()),this.event&&this.event.requirement&&this.event.requirement.partyAchievement&&(this.requirementWarning=!s.E.game.party.achievementsList.includes(this.event.requirement.partyAchievement)),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.globalDraw&&!s.E.game.eventDraw&&this.dialogRef.close()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}select(n){this.selected=n.selected,this.subSelections=n.subSelections,this.checks=n.checks,this.attack=n.attack}cancel(){s.E.stateManager.before("eventDraw.cancel"),s.E.game.eventDraw=void 0,s.E.stateManager.after(),(0,F.co)(this.dialogRef)}accept(n=!0){if(this.event&&(-1!=this.selected||!n)){s.E.stateManager.before("eventDraw.accept"),s.E.game.eventDraw=void 0;const i=s.E.eventCardManager.applyEvent(this.event,this.selected,this.subSelections,this.checks,null!=s.E.game.scenario&&s.E.roundManager.firstRound,this.attack,n);s.E.stateManager.after(p.f.settings.animations?1e3:250),(0,F.co)(this.dialogRef,i.length?i:void 0)}}drawNew(){if(this.event){const n=this.event.edition,i=this.event.type,e=this.event.cardId;s.E.stateManager.before("eventDraw.new"),s.E.eventCardManager.removeEvent(i,e);const o=s.E.game.party.eventDecks[i];o&&(this.event=s.E.eventCardManager.getEventCardForEdition(n,i,o[0]),this.event&&(this.requirementWarning=!1,this.event.requirement&&this.event.requirement.partyAchievement&&(this.requirementWarning=!s.E.game.party.achievementsList.includes(this.event.requirement.partyAchievement)))),s.E.eventCardManager.addEvent(i,e),s.E.stateManager.after()}}showEventCard(n){this.dialog.open(Gr,{panelClass:["fullscreen-panel"],disableClose:!0,data:{eventCard:n,interactive:!0,id:-1!=this.selected?new bt.Qc(n.cardId,n.edition,n.type,this.selected,this.subSelections,this.checks,this.attack,!1):void 0}})}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-event-card-draw"]],standalone:!1,decls:1,vars:1,consts:[[1,"event-card-dialog"],[1,"scroll-container","event-card-container"],[1,"event-card"],[3,"onSelect","event"],[1,"open",3,"click","ghs-tooltip"],["src","./assets/images/fullscreen.svg",1,"ghs-svg"],[1,"warning"],[1,"menu"],[1,"cancel",3,"click","ghs-label"],[3,"ghs-label"],[1,"accept",3,"click","ngClass","ghs-label"],[3,"click","ghs-label"]],template:function(i,e){1&i&&t.nVh(0,B8,11,9,"div",0),2&i&&t.vxM(e.event?0:-1)},dependencies:[N.YU,Xa,it,Mt],styles:[".event-card-dialog[_ngcontent-%COMP%]{position:relative}.event-card-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{text-align:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.event-card-dialog[_ngcontent-%COMP%]   .event-card-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.event-card-dialog[_ngcontent-%COMP%]   .event-card-container[_ngcontent-%COMP%]   .event-card[_ngcontent-%COMP%]{position:relative;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 45 * var(--ghs-dialog-factor))}.event-card-dialog[_ngcontent-%COMP%]   .event-card-container[_ngcontent-%COMP%]   .event-card[_ngcontent-%COMP%]   ghs-event-card[_ngcontent-%COMP%]{display:block;width:100%}.event-card-dialog[_ngcontent-%COMP%]   .event-card-container[_ngcontent-%COMP%]   .event-card[_ngcontent-%COMP%]   .open[_ngcontent-%COMP%]{z-index:1;position:absolute;display:flex;cursor:pointer;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-filter-white) var(--ghs-filter-shadow)}.event-card-dialog[_ngcontent-%COMP%]   .event-card-container[_ngcontent-%COMP%]   .event-card[_ngcontent-%COMP%]   .open[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.event-card-dialog[_ngcontent-%COMP%]   .event-card-container[_ngcontent-%COMP%]   .event-card[_ngcontent-%COMP%]   .open[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.event-card-dialog[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.event-card-dialog[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;color:var(--ghs-color-yellow);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor))}.event-card-dialog[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}.event-card-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor)) 0;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly;align-items:center}.event-card-dialog[_ngcontent-%COMP%]   .menu.small[_ngcontent-%COMP%]{justify-content:center;margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor)) 0;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.7 * var(--ghs-dialog-factor))}.event-card-dialog[_ngcontent-%COMP%]   .menu.small[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{min-width:auto}.event-card-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;display:flex;flex-grow:1;justify-content:center;margin:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.event-card-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.event-card-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.accept[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.event-card-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.event-card-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-darkgray)}"]})}return a})();const Y8=a=>({resolved:a}),U8=(a,r,n)=>({fh:a,modern:r,resolved:n}),Tr=(a,r)=>[a,r],Ya=a=>[a],N8=a=>({active:a}),eo=(a,r)=>r._trackUUID;function z8(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",18),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.selectType(e))}),t.nrm(1,"span",19),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(2,N8,i.type==n)),t.R7$(),t.Y8G("ghs-label","game.events.type."+n)}}function L8(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",20),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.drawEvent())}),t.nrm(1,"span",12),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","scenario.eventEffects.drawEvent")("ghs-label-args",t.eq3(2,Ya,n.type))}}function q8(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",21),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleAllTypes())}),t.k0s(),t.nrm(2,"span",19),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("checked",n.allTypes),t.R7$(),t.Y8G("ghs-label","game.events.deck.allTypes")}}function H8(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",22),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.resolved,e)||(o.resolved=e),c.Njj(e)}),t.k0s(),t.nrm(2,"span",19),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.R50("ngModel",n.resolved),t.R7$(),t.Y8G("ghs-label","game.events.deck.resolved")}}function K8(a,r){1&a&&t.nrm(0,"div",15)}function W8(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",23),t.nrm(1,"ghs-event-card",24),t.j41(2,"a",25),t.nrm(3,"img",26),t.k0s(),t.j41(4,"a",27),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.showEventCard(e))}),t.nrm(5,"img",28),t.k0s(),t.j41(6,"a",29),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.removeCard(e))}),t.nrm(7,"img",30),t.k0s(),t.j41(8,"a",31),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.drawEvent(e.cardId))}),t.nrm(9,"span",32),t.k0s()()}if(2&a){const n=t.XpG().$implicit;t.R7$(),t.Y8G("event",n)("spoiler",!0),t.R7$(3),t.Y8G("ghs-tooltip","game.events.deck.show"),t.R7$(2),t.Y8G("ghs-tooltip","game.events.deck.removeCard"),t.R7$(2),t.Y8G("ghs-tooltip","game.events.deck.draw"),t.R7$(),t.Y8G("ghs-label","%action.card.recover%")}}function Z8(a,r){if(1&a&&t.nVh(0,W8,10,6,"div",23),2&a){const n=r.$implicit,i=t.XpG();t.vxM(!i.filter||n.cardId.includes(i.filter)?0:-1)}}function J8(a,r){1&a&&t.nrm(0,"div",15)}function Q8(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",23),t.nrm(1,"ghs-event-card",24),t.j41(2,"a",25),t.nrm(3,"img",26),t.k0s(),t.j41(4,"a",27),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.showEventCard(e))}),t.nrm(5,"img",28),t.k0s(),t.j41(6,"a",33),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.addCard(e))}),t.nrm(7,"img",34),t.k0s(),t.j41(8,"a",31),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.drawEvent(e.cardId))}),t.nrm(9,"span",32),t.k0s()()}if(2&a){const n=t.XpG().$implicit;t.R7$(),t.Y8G("event",n)("spoiler",!0),t.R7$(3),t.Y8G("ghs-tooltip","game.events.deck.show"),t.R7$(2),t.Y8G("ghs-tooltip","game.events.deck.addCard"),t.R7$(2),t.Y8G("ghs-tooltip","game.events.deck.draw"),t.R7$(),t.Y8G("ghs-label","%action.card.recover%")}}function tS(a,r){if(1&a&&t.nVh(0,Q8,10,6,"div",23),2&a){const n=r.$implicit,i=t.XpG();t.vxM(!i.filter||n.cardId.includes(i.filter)?0:-1)}}function nS(a,r){1&a&&t.nrm(0,"div",15)}function eS(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",27),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2).$implicit,o=t.XpG();return c.Njj(o.showEventCard(e.card,e.identifier))}),t.nrm(1,"img",28),t.k0s()}2&a&&t.Y8G("ghs-tooltip","game.events.deck.show")}function aS(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",41),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2).$implicit,o=t.XpG();return c.Njj(o.updateDrawnSelect(e.identifier))}),t.nrm(1,"img",42),t.k0s()}2&a&&t.Y8G("ghs-tooltip","game.events.deck.removeSelection")}function iS(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",43),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2).$implicit,o=t.XpG();return c.Njj(o.addCard(e.card))}),t.nrm(1,"img",44),t.k0s()}2&a&&t.Y8G("ghs-tooltip","game.events.deck.addCard")}function oS(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",35)(1,"ghs-event-card",36),t.bIt("onSelect",function(e){c.eBV(n);const o=t.XpG().$implicit,g=t.XpG();return c.Njj(g.updateDrawnSelect(o.identifier,e))}),t.k0s(),t.nVh(2,eS,2,1,"a",37),t.nVh(3,aS,2,1,"a",38),t.j41(4,"a",29),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.removeDrawn(e.identifier))}),t.nrm(5,"img",39),t.k0s(),t.nVh(6,iS,2,1,"a",40),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(),t.Y8G("event",n.card)("select",n.identifier.selected)("identifier",n.identifier)("subSelect",n.identifier.subSelections),t.R7$(),t.vxM(n.card?2:-1),t.R7$(),t.vxM(-1!=n.identifier.selected?3:-1),t.R7$(),t.Y8G("ghs-tooltip","game.events.deck.removeDrawn"),t.R7$(2),t.vxM(!n.card||i.upcomingCards.includes(n.card)||i.newCards.includes(n.card)?-1:6)}}function sS(a,r){if(1&a&&t.nVh(0,oS,7,8,"div",35),2&a){const n=r.$implicit,i=t.XpG();t.vxM(!i.filter||n.identifier.cardId.includes(i.filter)?0:-1)}}let ao=(()=>{class a{dialogRef;dialog;ghsManager;edition;type;types=[];upcomingCards=[];newCards=[];drawnCards=[];filter="";allTypes=!1;allTypesToggle=!1;resolved=!1;settingsManager=p.f;constructor(n,i,e,o){this.dialogRef=i,this.dialog=e,this.ghsManager=o,this.edition=n.edition,this.types=s.E.eventCardManager.getEventTypesForEdition(this.edition).filter(g=>this.allTypes||s.E.game.party.eventDecks[g]&&s.E.game.party.eventDecks[g].length),this.allTypesToggle=s.E.eventCardManager.getEventTypesForEdition(this.edition).length!=this.types.length,this.type=n.type||this.types[0],this.update(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.update()})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){const n=s.E.eventCardManager.getEventCardsForEdition(this.edition,this.type),i=s.E.game.party.eventDecks[this.type]||[];this.upcomingCards=i.map(e=>n.find(o=>o.cardId==e)).filter(e=>e).map(e=>e),this.newCards=n.filter(e=>!i.includes(e.cardId)&&!s.E.game.party.eventCards.find(o=>o.type==this.type&&o.cardId==e.cardId)),this.drawnCards=s.E.game.party.eventCards.filter(e=>n.find(o=>o.edition==e.edition&&o.type==e.type&&o.cardId==e.cardId)).map(e=>({identifier:e,card:n.find(o=>o.cardId==e.cardId)}))}selectType(n){this.type=n,this.update()}toggleAllTypes(){this.allTypes=!this.allTypes,this.types=s.E.eventCardManager.getEventTypesForEdition(this.edition).filter(n=>this.allTypes||s.E.game.party.eventDecks[n]&&s.E.game.party.eventDecks[n].length)}shuffle(){s.E.stateManager.before("events.deck.shuffle",this.type),s.E.eventCardManager.shuffleEvents(this.type),s.E.stateManager.after()}dropUpcoming(n){s.E.stateManager.before("events.deck.reorder",this.type),n.container==n.previousContainer?(0,V.HD)(s.E.game.party.eventDecks[this.type]||[],n.previousIndex,n.currentIndex):(s.E.game.party.eventDecks[this.type]||[]).splice(n.currentIndex<0?0:n.currentIndex,0,this.newCards[n.previousIndex].cardId),s.E.stateManager.after()}dropNew(n){s.E.stateManager.before("events.deck.reorder",this.type),n.container==n.previousContainer?(0,V.HD)(this.newCards,n.previousIndex,n.currentIndex):(s.E.game.party.eventDecks[this.type]||[]).splice(n.previousIndex,1),s.E.stateManager.after()}dropDrawn(n){let i;"new-list"==n.previousContainer.id?i=this.newCards[n.previousIndex]:"upcoming-list"==n.previousContainer.id&&(i=this.upcomingCards[n.previousIndex]),i&&(s.E.stateManager.before("events.deck.markDrawn",i.type,i.cardId),s.E.game.party.eventCards.splice(n.currentIndex,0,new bt.Qc(i.cardId,i.edition,i.type,-1,[],[],!1,!1)),s.E.stateManager.after())}removeCard(n){s.E.stateManager.before("events.deck.removeEvent",this.type,n.cardId),s.E.eventCardManager.removeEvent(n.type,n.cardId),s.E.stateManager.after()}addCard(n){s.E.stateManager.before("events.deck.addEvent",this.type,n.cardId),s.E.eventCardManager.addEvent(n.type,n.cardId),s.E.stateManager.after()}removeDrawn(n){const i=s.E.game.party.eventCards.indexOf(n);-1!=i&&(s.E.stateManager.before("events.deck.removeDrawn",this.type,n.cardId),s.E.game.party.eventCards.splice(i,1),s.E.stateManager.after())}updateDrawnSelect(n,i=void 0){const e=i?i.selected:-1,o=i?i.subSelections:[];(n.selected!=e||n.subSelections.length!=o.length||n.subSelections.some(g=>!o.includes(g)))&&(s.E.stateManager.before("events.deck.changeSelection",this.type,n.cardId),n.selected=e,n.subSelections=o,s.E.stateManager.after(i?0:750))}showEventCard(n,i=void 0){this.dialog.open(Gr,{panelClass:["fullscreen-panel"],disableClose:!0,data:{eventCard:n,interactive:!0,id:i}})}drawEvent(n=void 0){this.dialog.open(Ba,{panelClass:["dialog"],data:{edition:this.edition,type:this.type,cardId:n}}).closed.subscribe({next:i=>{p.f.settings.eventsApply&&i&&i.length&&this.dialog.open(ra,{panelClass:["dialog"],data:{eventResults:i}})}})}close(){(0,F.co)(this.dialogRef)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-event-card-deck"]],standalone:!1,decls:38,vars:47,consts:[["menu",""],["upcomingList","cdkDropList"],["newList","cdkDropList"],["drawnList","cdkDropList"],[1,"events-dialog"],[1,"menu",3,"ngClass"],[1,"event-type",3,"ngClass"],["type","text",3,"ngModelChange","ngModel","ghs-label","ghs-label-attribute"],[1,"scroll-container"],[1,"events-container",3,"ngClass"],["id","upcoming-list","cdkDropList","",1,"upcoming","drop-list",3,"cdkDropListDropped","cdkDropListConnectedTo","cdkDropListAutoScrollStep"],[1,"title"],[3,"ghs-label","ghs-label-args"],[3,"click","ghs-tooltip"],["src","./assets/images/shuffle.svg",1,"ghs-svg"],[1,"empty"],["id","new-list","cdkDropList","",1,"new","drop-list",3,"cdkDropListDropped","cdkDropListConnectedTo","cdkDropListAutoScrollStep"],["cdkDropList","",1,"drawn","drop-list",3,"cdkDropListDropped","cdkDropListAutoScrollStep"],[1,"event-type",3,"click","ngClass"],[3,"ghs-label"],[3,"click"],["type","checkbox",3,"click","checked"],["type","checkbox",3,"ngModelChange","ngModel"],["cdkDrag","",1,"container","drag-hidden"],[3,"event","spoiler"],["cdkDragHandle","",1,"button","drag-handle"],["src","./assets/images/menu.svg",1,"ghs-svg"],[1,"button","open",3,"click","ghs-tooltip"],["src","./assets/images/fullscreen.svg",1,"ghs-svg"],[1,"button","remove",3,"click","ghs-tooltip"],["src","./assets/images/eventcards/remove.svg",1,"ghs-svg"],[1,"button","draw",3,"click","ghs-tooltip"],[1,"text-white",3,"ghs-label"],[1,"button","add",3,"click","ghs-tooltip"],["src","./assets/images/eventcards/return.svg",1,"ghs-svg"],["drag-hidden","","cdkDrag","",1,"container"],[3,"onSelect","event","select","identifier","subSelect"],[1,"button","open",3,"ghs-tooltip"],[1,"button","reset",3,"ghs-tooltip"],["src","./assets/images/minus.svg",1,"ghs-svg"],[1,"button","add","restore",3,"ghs-tooltip"],[1,"button","reset",3,"click","ghs-tooltip"],["src","./assets/images/long-rest.svg",1,"ghs-svg"],[1,"button","add","restore",3,"click","ghs-tooltip"],["src","./assets/images/plus.svg",1,"ghs-svg"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",4)(1,"div",5,0),t.Z7z(3,z8,2,4,"a",6,t.fX1),t.nVh(5,L8,2,4,"a"),t.nVh(6,q8,3,2,"label"),t.nVh(7,H8,3,2,"label"),t.j41(8,"label")(9,"input",7),t.mxI("ngModelChange",function(m){return c.eBV(o),t.DH7(e.filter,m)||(e.filter=m),c.Njj(m)}),t.bIt("ngModelChange",function(){return c.eBV(o),c.Njj(e.update())}),t.k0s()()(),t.j41(10,"div",8)(11,"div",9)(12,"div",10,1),t.bIt("cdkDropListDropped",function(m){return c.eBV(o),c.Njj(e.dropUpcoming(m))}),t.j41(14,"div",11),t.nrm(15,"span",12),t.j41(16,"a",13),t.bIt("click",function(){return c.eBV(o),c.Njj(e.shuffle())}),t.nrm(17,"img",14),t.k0s()(),t.nVh(18,K8,1,0,"div",15),t.Z7z(19,Z8,1,1,null,null,eo),t.nI1(21,"trackUUID"),t.k0s(),t.j41(22,"div",16,2),t.bIt("cdkDropListDropped",function(m){return c.eBV(o),c.Njj(e.dropNew(m))}),t.j41(24,"div",11),t.nrm(25,"span",12),t.k0s(),t.nVh(26,J8,1,0,"div",15),t.Z7z(27,tS,1,1,null,null,eo),t.nI1(29,"trackUUID"),t.k0s(),t.j41(30,"div",17,3),t.bIt("cdkDropListDropped",function(m){return c.eBV(o),c.Njj(e.dropDrawn(m))}),t.j41(32,"div",11),t.nrm(33,"span",12),t.k0s(),t.nVh(34,nS,1,0,"div",15),t.Z7z(35,sS,1,1,null,null,eo),t.nI1(37,"trackUUID"),t.k0s()()()()}if(2&i){const o=t.sdS(13),g=t.sdS(23),m=t.sdS(31);t.R7$(),t.Y8G("ngClass",t.eq3(29,Y8,e.resolved)),t.R7$(2),t.Dyx(e.types),t.R7$(2),t.vxM(e.upcomingCards.length?5:-1),t.R7$(),t.vxM(e.allTypesToggle?6:-1),t.R7$(),t.vxM(e.drawnCards.length||e.resolved?7:-1),t.R7$(2),t.R50("ngModel",e.filter),t.Y8G("ghs-label","game.events.deck.filter")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ngClass",t.sMw(31,U8,"fh"==e.settingsManager.settings.theme,"modern"==e.settingsManager.settings.theme,e.resolved)),t.R7$(),t.Y8G("cdkDropListConnectedTo",t.l_i(35,Tr,g,m))("cdkDropListAutoScrollStep",20),t.R7$(3),t.Y8G("ghs-label","game.events.deck.upcoming")("ghs-label-args",t.eq3(38,Ya,e.upcomingCards.length)),t.R7$(),t.Y8G("ghs-tooltip","game.events.deck.shuffle"),t.R7$(2),t.vxM(0==e.upcomingCards.length?18:-1),t.R7$(),t.Dyx(t.bMT(21,23,e.upcomingCards)),t.R7$(3),t.Y8G("cdkDropListConnectedTo",t.l_i(40,Tr,o,m))("cdkDropListAutoScrollStep",20),t.R7$(3),t.Y8G("ghs-label","game.events.deck.new")("ghs-label-args",t.eq3(43,Ya,e.newCards.length)),t.R7$(),t.vxM(0==e.newCards.length?26:-1),t.R7$(),t.Dyx(t.bMT(29,25,e.newCards)),t.R7$(3),t.Y8G("cdkDropListAutoScrollStep",20),t.R7$(3),t.Y8G("ghs-label","game.events.deck.drawn")("ghs-label-args",t.eq3(45,Ya,e.drawnCards.length)),t.R7$(),t.vxM(0==e.drawnCards.length?34:-1),t.R7$(),t.Dyx(t.bMT(37,27,e.drawnCards))}},dependencies:[N.YU,E.me,E.Zm,E.BC,E.vS,V.O7,V.T1,V.Fb,Xa,it,Mt,ct],styles:[".events-dialog[_ngcontent-%COMP%]{position:relative}.events-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;flex-wrap:wrap;max-width:calc(var(--ghs-unit) * 80 * var(--ghs-text-factor))}.events-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);margin:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.events-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.event-type[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label.event-type[_ngcontent-%COMP%]{font-family:var(--ghs-font-text)}.events-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .events-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .events-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label.active[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.events-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));min-width:initial}.events-dialog[_ngcontent-%COMP%]   .menu.resolved[_ngcontent-%COMP%]{max-width:calc(var(--ghs-unit) * 120 * var(--ghs-text-factor))}.events-dialog[_ngcontent-%COMP%]   .drop-list[_ngcontent-%COMP%]{position:relative}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]{display:flex;margin:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 78 * var(--ghs-text-factor));max-height:80vh}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;margin:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 38 * var(--ghs-text-factor))}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming.drawn[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new.drawn[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn.drawn[_ngcontent-%COMP%]{display:none}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 36.5 * var(--ghs-dialog-factor));min-height:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);z-index:2}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-white)}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{opacity:.7}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));flex-grow:1;text-align:center}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 36 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 54 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));flex-shrink:0;flex-grow:0}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ghs-event-card[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ghs-event-card[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ghs-event-card[_ngcontent-%COMP%]{display:block;width:100%;height:100%}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{z-index:1;position:absolute;display:flex;cursor:pointer;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-filter-white) var(--ghs-filter-shadow)}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-shadow)}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.add[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.add[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.add[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-green) var(--ghs-filter-shadow)}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.drag-handle[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.drag-handle[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.drag-handle[_ngcontent-%COMP%]{cursor:grab;right:initial;left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.open[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.open[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.open[_ngcontent-%COMP%]{cursor:nesw-resize;right:50%;transform:translate(50%)}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.reset[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.reset[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.reset[_ngcontent-%COMP%]{right:initial;left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.reset[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.reset[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.reset[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow) var(--ghs-filter-shadow)}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.restore[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.restore[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.restore[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor))}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.draw[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.draw[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.draw[_ngcontent-%COMP%]{top:initial;left:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));right:initial;bottom:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 5.5 * var(--ghs-text-factor));left:calc(var(--ghs-unit) * .3 * var(--ghs-text-factor));display:block;margin:calc(var(--ghs-unit) * .7 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 35 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 51.7 * var(--ghs-text-factor));border-radius:calc(var(--ghs-unit) * 1);border-style:dashed;border-width:calc(var(--ghs-unit) * .2);border-color:var(--ghs-color-white)}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming.upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.add[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming.upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.remove[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming.new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.add[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming.new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.remove[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new.upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.add[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new.upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.remove[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new.new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.add[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new.new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.remove[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn.upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.add[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn.upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.remove[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn.new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.add[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn.new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.remove[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.events-dialog[_ngcontent-%COMP%]   .events-container.resolved[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 117 * var(--ghs-text-factor))}.events-dialog[_ngcontent-%COMP%]   .events-container.resolved[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]{display:flex}.events-dialog[_ngcontent-%COMP%]   .events-container.fh[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container.fh[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container.fh[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.events-dialog[_ngcontent-%COMP%]   .events-container.modern[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container.modern[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container.modern[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.events-dialog[_ngcontent-%COMP%]   .cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.5}.events-dialog[_ngcontent-%COMP%]   .cdk-drag-animating[_ngcontent-%COMP%]{transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}.events-dialog[_ngcontent-%COMP%]   .cdk-drop-list-dragging[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}"]})}return a})();var Ua=v(1891),Bn=v(1270),se=v(8826),rS=v(6367);class ta{label;value;revelead;group;constructor(r,n="",i=!1,e=""){this.label=r,this.value=n,this.revelead=i,this.group=e}}let cS=(()=>{class a{el;values=[];spoiler=!1;emptyLabel="";select=new t.bkB;constructor(n){this.el=n}ngOnInit(){let n=document.createElement("div");this.el.nativeElement.after(n);const i=this.select;(0,rS.A)({input:this.el.nativeElement,container:n,emptyMsg:this.emptyLabel?p.f.getLabel(this.emptyLabel):"",minLength:3,disableAutoSelect:!0,fetch:(e,o)=>{o(this.values.filter(g=>g.label&&g.label.toLowerCase().startsWith(e.toLowerCase())).sort((g,m)=>g.revelead&&!m.revelead?-1:m.revelead&&!g.revelead?1:0))},onSelect:e=>{this.el.nativeElement.value=e.label||"",i.emit(e.label)},render:(e,o,g)=>{const m=document.createElement("div");return m.textContent=e.label,e.revelead&&m.classList.add("revealed"),m},customize:()=>{if(this.spoiler&&(n.children.length>1||this.el.nativeElement.value.length<6))for(let e=0;e<n.children.length;e++){const o=n.children[e];o.classList.contains("selected")?o.classList.remove("spoiler"):(o.classList.add("spoiler"),o.addEventListener("touchstart",g=>{o.classList.contains("spoiler")&&(g.preventDefault(),g.stopPropagation())}),o.addEventListener("touchend",g=>{if(o.classList.contains("spoiler")){g.preventDefault(),g.stopPropagation(),o.classList.remove("spoiler");for(let m=0;m<n.children.length;m++)n.children[m]!=o&&n.children[m].classList.add("spoiler")}}))}else for(let e=0;e<n.children.length;e++)n.children[e].classList.remove("spoiler")},keyup:e=>{switch(e.event.key){case"ArrowUp":case"ArrowDown":case"Escape":case"Backspace":if(this.spoiler&&(n.children.length>1||this.el.nativeElement.value.length<6))for(let g=0;g<n.children.length;g++){const m=n.children[g];m.classList.contains("selected")?m.classList.remove("spoiler"):m.classList.add("spoiler")}else for(let g=0;g<n.children.length;g++)n.children[g].classList.remove("spoiler")}}})}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT))};static \u0275dir=t.FsC({type:a,selectors:[["","autocomplete",""]],inputs:{values:[0,"autocomplete","values"],spoiler:"spoiler",emptyLabel:"emptyLabel"},outputs:{select:"keyup.enter"},standalone:!1})}return a})();const lS=(a,r)=>({fh:a,modern:r}),qn=a=>[a],Sr=a=>({force:a}),gS=a=>({active:a}),dS=(a,r,n,i)=>({first:a,costs:r,some:n,full:i}),hS=a=>({absent:a}),_S=(a,r)=>({some:a,full:r}),Qt=a=>({disabled:a}),io=(a,r,n)=>({costs:a,some:r,full:n}),na=(a,r)=>r._trackUUID;function mS(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.SpI("(",n.building.data.id,")")}}function pS(a,r){if(1&a&&(t.j41(0,"span",2),t.nrm(1,"span",11),t.nVh(2,mS,2,1,"span"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","data.buildings."+n.building.data.name),t.R7$(),t.vxM(n.building.data.id?2:-1)}}function uS(a,r){if(1&a&&(t.j41(0,"span",3),t.nrm(1,"img",14)(2,"span",15),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("src","./assets/images/fh/buildings/"+n.action+".svg",t.B4B),t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.buildings."+n.action+".action")("ghs-label-args",t.eq3(3,qn,""+(n.building.model.level+(n.rewardsOnly?0:1))))}}function fS(a,r){1&a&&(t.j41(0,"span",2),t.nrm(1,"span",11),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","data.buildings.barracks.soldiers"))}function CS(a,r){if(1&a&&(t.j41(0,"span",16),t.nrm(1,"img",17),t.EFF(2),t.k0s()),2&a){const n=t.XpG(2);t.R7$(2),t.SpI(" ",n.costs.lumber)}}function MS(a,r){if(1&a&&(t.j41(0,"span",16),t.nrm(1,"img",18),t.EFF(2),t.k0s()),2&a){const n=t.XpG(2);t.R7$(2),t.SpI(" ",n.costs.metal)}}function vS(a,r){if(1&a&&(t.j41(0,"span",16),t.nrm(1,"img",19),t.EFF(2),t.k0s()),2&a){const n=t.XpG(2);t.R7$(2),t.SpI(" ",n.costs.hide)}}function OS(a,r){if(1&a&&(t.j41(0,"span",16),t.nrm(1,"img",20),t.EFF(2),t.k0s()),2&a){const n=t.XpG(2);t.R7$(2),t.SpI(" ",n.costs.gold)}}function PS(a,r){if(1&a&&(t.j41(0,"span",4),t.nVh(1,CS,3,1,"span",16),t.nVh(2,MS,3,1,"span",16),t.nVh(3,vS,3,1,"span",16),t.nVh(4,OS,3,1,"span",16),t.k0s()),2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(5,Sr,n.force)),t.R7$(),t.vxM(!n.repair&&n.costs.lumber?1:-1),t.R7$(),t.vxM(!n.repair&&n.costs.metal?2:-1),t.R7$(),t.vxM(!n.repair&&n.costs.hide?3:-1),t.R7$(),t.vxM(n.costs.gold?4:-1)}}function bS(a,r){if(1&a&&(t.j41(0,"span",4),t.nrm(1,"span",15),t.j41(2,"span",16),t.nrm(3,"img",21),t.k0s(),t.j41(4,"span",16),t.nrm(5,"img",22),t.k0s(),t.j41(6,"span",16),t.nrm(7,"img",23),t.k0s()()),2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(3,Sr,n.force)),t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.buildings.repair.costs")("ghs-label-args",t.eq3(5,qn,n.repair))}}function kS(a,r){1&a&&(t.j41(0,"div",5),t.nrm(1,"span",24),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.buildings.discount"))}function yS(a,r){if(1&a&&t.nrm(0,"span",6),2&a){const n=t.XpG();t.Y8G("ghs-label","party.campaign.sheet.buildings.rewards.loseMorale")("ghs-label-args",t.eq3(2,qn,""+n.rewards.loseMorale))}}function xS(a,r){if(1&a&&t.nrm(0,"span",25),2&a){const n=t.XpG(2);t.Y8G("ghs-label","party.campaign.sheet.buildings.rewards.prosperity")("ghs-label-args",t.eq3(2,qn,""+n.rewards.prosperity))}}function ES(a,r){if(1&a&&t.nrm(0,"span",26),2&a){const n=t.XpG(2);t.Y8G("ghs-label","party.campaign.sheet.buildings.rewards.defense")("ghs-label-args",t.eq3(2,qn,""+n.rewards.defense))}}function wS(a,r){if(1&a&&t.nrm(0,"span",27),2&a){const n=t.XpG(2);t.Y8G("ghs-label","party.campaign.sheet.buildings.rewards.soldiers")("ghs-label-args",t.eq3(2,qn,""+n.rewards.soldiers))}}function RS(a,r){if(1&a&&t.nrm(0,"span",28),2&a){const n=t.XpG(2);t.Y8G("ghs-label","party.campaign.sheet.buildings.rewards.plot"+(n.rewards.plots>0?"s":""))("ghs-label-args",t.eq3(2,qn,""+n.rewards.plots))}}function jS(a,r){if(1&a&&t.nrm(0,"span",29),2&a){const n=t.XpG(2);t.Y8G("ghs-label","party.campaign.sheet.buildings.rewards.items")("ghs-label-args",n.rewards.items.split("-"))}}function GS(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",32),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.sectionRewards(e.rewards.section))}),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(3,gS,n.rewardsOnly))("ghs-label","party.campaign.sheet.buildings.rewards.section")("ghs-label-args",t.eq3(5,qn,n.rewards.section))}}function TS(a,r){if(1&a&&(t.j41(0,"span",31),t.nrm(1,"span",11),t.EFF(2,":\xa0"),t.nrm(3,"span",33),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","errata"),t.R7$(2),t.Y8G("ghs-label","data.custom."+n.building.data.edition+".errata."+n.rewards.errata)}}function SS(a,r){if(1&a&&(t.j41(0,"div",7),t.nVh(1,xS,1,4,"span",25),t.nVh(2,ES,1,4,"span",26),t.nVh(3,wS,1,4,"span",27),t.nVh(4,RS,1,4,"span",28),t.nVh(5,jS,1,2,"span",29),t.nVh(6,GS,1,7,"span",30),t.nVh(7,TS,4,2,"span",31),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.vxM(n.rewards.prosperity?1:-1),t.R7$(),t.vxM(n.rewards.defense?2:-1),t.R7$(),t.vxM(n.rewards.soldiers?3:-1),t.R7$(),t.vxM(n.rewards.plots?4:-1),t.R7$(),t.vxM(n.rewards.items?5:-1),t.R7$(),t.vxM(n.rewards.section?6:-1),t.R7$(),t.vxM(n.building&&n.rewards.errata?7:-1)}}function DS(a,r){if(1&a&&(t.j41(0,"span",5)(1,"span",37),t.EFF(2),t.k0s(),t.EFF(3),t.k0s()),2&a){const n=t.XpG(2);t.R7$(2),t.JRh(n.paidResources||"-"),t.R7$(),t.SpI(" / ",n.repair||"-"," ")}}function $S(a,r){1&a&&t.nrm(0,"span",11),2&a&&t.Y8G("ghs-label","party.campaign.sheet.buildings.costs")}function IS(a,r){if(1&a&&(t.j41(0,"span",36),t.nrm(1,"img",38),t.j41(2,"span",39),t.EFF(3),t.k0s()()),2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(),t.Y8G("src",n.iconUrl,t.B4B),t.R7$(),t.Y8G("ngClass",t.eq3(3,hS,n.absent)),t.R7$(),t.SpI(" ",i.gameManager.characterManager.characterName(n,n.absent)," ")}}function AS(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",43),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG(3);return c.Njj(o.changeValue("gold",o.characterSpent[e],-1))}),t.nrm(1,"img",44),t.k0s(),t.j41(2,"span",45),t.EFF(3),t.k0s(),t.j41(4,"a",43),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG(3);return c.Njj(o.changeValue("gold",o.characterSpent[e],1))}),t.nrm(5,"img",46),t.k0s()}if(2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG(3);t.Y8G("ngClass",t.eq3(6,Qt,0==o.characterSpent[e].gold)),t.R7$(2),t.Y8G("ghs-label","game.loot.")("ghs-label-attribute","title"),t.R7$(),t.Lme(" ",o.characterSpent[e].gold||"-"," / ",i.progress.gold," "),t.R7$(),t.Y8G("ngClass",t.eq3(8,Qt,0==i.progress.gold||i.progress.gold==o.characterSpent[e].gold||o.spent.gold==o.costs.gold))}}function VS(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function FS(a,r){if(1&a&&(t.j41(0,"span",42),t.nVh(1,AS,6,10),t.nVh(2,VS,2,0,"span"),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.vxM(n.progress.gold?1:-1),t.R7$(),t.vxM(n.progress.gold?-1:2)}}function XS(a,r){if(1&a&&(t.j41(0,"span",40),t.nrm(1,"img",41),t.j41(2,"span",16)(3,"span",37),t.EFF(4),t.k0s(),t.EFF(5),t.k0s()(),t.j41(6,"span",42),t.EFF(7," - "),t.k0s(),t.Z7z(8,FS,3,2,"span",42,na),t.nI1(10,"trackUUID")),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.l_i(6,_S,n.spent.gold,n.spent.gold==n.costs.gold)),t.R7$(),t.Y8G("src","./assets/images/"+(n.settingsManager.settings.fhStyle?"fh/":"")+"loot.svg",t.B4B),t.R7$(3),t.JRh(n.spent.gold||"-"),t.R7$(),t.SpI(" / ",n.costs.gold),t.R7$(3),t.Dyx(t.bMT(10,4,n.characters))}}function BS(a,r){if(1&a&&(t.j41(0,"span",16)(1,"span",37),t.EFF(2),t.k0s(),t.EFF(3),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.JRh(n.spent.lumber||"-"),t.R7$(),t.SpI(" / ",n.costs.lumber)}}function YS(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",43),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.changeValue("lumber",e.fhSupportSpent,-1))}),t.nrm(1,"img",44),t.k0s(),t.j41(2,"span",45),t.EFF(3),t.k0s(),t.j41(4,"a",43),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.changeValue("lumber",e.fhSupportSpent,1))}),t.nrm(5,"img",46),t.k0s()}if(2&a){const n=t.XpG(3);t.Y8G("ngClass",t.eq3(6,Qt,0==n.fhSupportSpent.lumber)),t.R7$(2),t.Y8G("ghs-label","game.loot.")("ghs-label-attribute","title"),t.R7$(),t.Lme(" ",n.fhSupportSpent.lumber||"-"," / ",n.gameManager.game.party.loot.lumber||0," "),t.R7$(),t.Y8G("ngClass",t.eq3(8,Qt,!n.gameManager.game.party.loot.lumber||n.gameManager.game.party.loot.lumber==n.fhSupportSpent.lumber||n.spent.lumber==n.costs.lumber||n.repair&&n.paidResources==n.repair))}}function US(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function NS(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",43),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG(3);return c.Njj(o.changeValue("lumber",o.characterSpent[e],-1))}),t.nrm(1,"img",44),t.k0s(),t.j41(2,"span",45),t.EFF(3),t.k0s(),t.j41(4,"a",43),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG(3);return c.Njj(o.changeValue("lumber",o.characterSpent[e],1))}),t.nrm(5,"img",46),t.k0s()}if(2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG(3);t.Y8G("ngClass",t.eq3(6,Qt,0==o.characterSpent[e].lumber)),t.R7$(2),t.Y8G("ghs-label","game.loot.")("ghs-label-attribute","title"),t.R7$(),t.Lme(" ",o.characterSpent[e].lumber||"-"," / ",i.progress.loot.lumber||0," "),t.R7$(),t.Y8G("ngClass",t.eq3(8,Qt,!i.progress.loot.lumber||i.progress.loot.lumber==o.characterSpent[e].lumber||o.spent.lumber==o.costs.lumber||o.repair&&o.paidResources==o.repair))}}function zS(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function LS(a,r){if(1&a&&(t.j41(0,"span",42),t.nVh(1,NS,6,10),t.nVh(2,zS,2,0,"span"),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.vxM(n.progress.loot.lumber?1:-1),t.R7$(),t.vxM(n.progress.loot.lumber?-1:2)}}function qS(a,r){if(1&a&&(t.j41(0,"span",47),t.nrm(1,"img",17),t.nVh(2,BS,4,2,"span",16),t.k0s(),t.j41(3,"span",42),t.nVh(4,YS,6,10),t.nVh(5,US,2,0,"span"),t.k0s(),t.Z7z(6,LS,3,2,"span",42,na),t.nI1(8,"trackUUID")),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.sMw(6,io,!n.repair,n.spent.lumber,n.spent.lumber==n.costs.lumber||n.requiredResources-(n.discount?1:0)==n.paidResources)),t.R7$(2),t.vxM(n.repair?-1:2),t.R7$(2),t.vxM(n.gameManager.game.party.loot.lumber?4:-1),t.R7$(),t.vxM(n.gameManager.game.party.loot.lumber?-1:5),t.R7$(),t.Dyx(t.bMT(8,4,n.characters))}}function HS(a,r){if(1&a&&(t.j41(0,"span",16)(1,"span",37),t.EFF(2),t.k0s(),t.EFF(3),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.JRh(n.spent.metal||"-"),t.R7$(),t.SpI(" / ",n.costs.metal)}}function KS(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",43),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.changeValue("metal",e.fhSupportSpent,-1))}),t.nrm(1,"img",44),t.k0s(),t.j41(2,"span",45),t.EFF(3),t.k0s(),t.j41(4,"a",43),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.changeValue("metal",e.fhSupportSpent,1))}),t.nrm(5,"img",46),t.k0s()}if(2&a){const n=t.XpG(3);t.Y8G("ngClass",t.eq3(6,Qt,0==n.fhSupportSpent.metal)),t.R7$(2),t.Y8G("ghs-label","game.loot.")("ghs-label-attribute","title"),t.R7$(),t.Lme(" ",n.fhSupportSpent.metal||"-"," / ",n.gameManager.game.party.loot.metal||0," "),t.R7$(),t.Y8G("ngClass",t.eq3(8,Qt,!n.gameManager.game.party.loot.metal||n.gameManager.game.party.loot.metal==n.fhSupportSpent.metal||n.spent.metal==n.costs.metal||n.repair&&n.paidResources==n.repair))}}function WS(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function ZS(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",43),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG(3);return c.Njj(o.changeValue("metal",o.characterSpent[e],-1))}),t.nrm(1,"img",44),t.k0s(),t.j41(2,"span",45),t.EFF(3),t.k0s(),t.j41(4,"a",43),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG(3);return c.Njj(o.changeValue("metal",o.characterSpent[e],1))}),t.nrm(5,"img",46),t.k0s()}if(2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG(3);t.Y8G("ngClass",t.eq3(6,Qt,0==o.characterSpent[e].metal)),t.R7$(2),t.Y8G("ghs-label","game.loot.")("ghs-label-attribute","title"),t.R7$(),t.Lme(" ",o.characterSpent[e].metal||"-"," / ",i.progress.loot.metal||0," "),t.R7$(),t.Y8G("ngClass",t.eq3(8,Qt,!i.progress.loot.metal||i.progress.loot.metal==o.characterSpent[e].metal||o.spent.metal==o.costs.metal||o.repair&&o.paidResources==o.repair))}}function JS(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function QS(a,r){if(1&a&&(t.j41(0,"span",42),t.nVh(1,ZS,6,10),t.nVh(2,JS,2,0,"span"),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.vxM(n.progress.loot.metal?1:-1),t.R7$(),t.vxM(n.progress.loot.metal?-1:2)}}function tD(a,r){if(1&a&&(t.j41(0,"span",47),t.nrm(1,"img",18),t.nVh(2,HS,4,2,"span",16),t.k0s(),t.j41(3,"span",42),t.nVh(4,KS,6,10),t.nVh(5,WS,2,0,"span"),t.k0s(),t.Z7z(6,QS,3,2,"span",42,na),t.nI1(8,"trackUUID")),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.sMw(6,io,!n.repair,n.spent.metal,n.spent.metal==n.costs.metal||n.requiredResources-(n.discount?1:0)==n.paidResources)),t.R7$(2),t.vxM(n.repair?-1:2),t.R7$(2),t.vxM(n.gameManager.game.party.loot.metal?4:-1),t.R7$(),t.vxM(n.gameManager.game.party.loot.metal?-1:5),t.R7$(),t.Dyx(t.bMT(8,4,n.characters))}}function nD(a,r){if(1&a&&(t.j41(0,"span",16)(1,"span",37),t.EFF(2),t.k0s(),t.EFF(3),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.JRh(n.spent.hide||"-"),t.R7$(),t.SpI(" / ",n.costs.hide)}}function eD(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",43),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.changeValue("hide",e.fhSupportSpent,-1))}),t.nrm(1,"img",44),t.k0s(),t.j41(2,"span",45),t.EFF(3),t.k0s(),t.j41(4,"a",43),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.changeValue("hide",e.fhSupportSpent,1))}),t.nrm(5,"img",46),t.k0s()}if(2&a){const n=t.XpG(3);t.Y8G("ngClass",t.eq3(6,Qt,0==n.fhSupportSpent.hide)),t.R7$(2),t.Y8G("ghs-label","game.loot.")("ghs-label-attribute","title"),t.R7$(),t.Lme(" ",n.fhSupportSpent.hide||"-"," / ",n.gameManager.game.party.loot.hide||0," "),t.R7$(),t.Y8G("ngClass",t.eq3(8,Qt,!n.gameManager.game.party.loot.hide||n.gameManager.game.party.loot.hide==n.fhSupportSpent.hide||n.spent.hide==n.costs.hide||n.repair&&n.paidResources==n.repair))}}function aD(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function iD(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",43),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG(3);return c.Njj(o.changeValue("hide",o.characterSpent[e],-1))}),t.nrm(1,"img",44),t.k0s(),t.j41(2,"span",45),t.EFF(3),t.k0s(),t.j41(4,"a",43),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG(3);return c.Njj(o.changeValue("hide",o.characterSpent[e],1))}),t.nrm(5,"img",46),t.k0s()}if(2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG(3);t.Y8G("ngClass",t.eq3(6,Qt,0==o.characterSpent[e].hide)),t.R7$(2),t.Y8G("ghs-label","game.loot.")("ghs-label-attribute","title"),t.R7$(),t.Lme(" ",o.characterSpent[e].hide||"-"," / ",i.progress.loot.hide||0," "),t.R7$(),t.Y8G("ngClass",t.eq3(8,Qt,!i.progress.loot.hide||i.progress.loot.hide==o.characterSpent[e].hide||o.spent.hide==o.costs.hide||o.repair&&o.paidResources==o.repair))}}function oD(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function sD(a,r){if(1&a&&(t.j41(0,"span",42),t.nVh(1,iD,6,10),t.nVh(2,oD,2,0,"span"),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.vxM(n.progress.loot.hide?1:-1),t.R7$(),t.vxM(n.progress.loot.hide?-1:2)}}function rD(a,r){if(1&a&&(t.j41(0,"span",47),t.nrm(1,"img",19),t.nVh(2,nD,4,2,"span",16),t.k0s(),t.j41(3,"span",42),t.nVh(4,eD,6,10),t.nVh(5,aD,2,0,"span"),t.k0s(),t.Z7z(6,sD,3,2,"span",42,na),t.nI1(8,"trackUUID")),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.sMw(6,io,!n.repair,n.spent.hide,n.spent.hide==n.costs.hide||n.requiredResources-(n.discount?1:0)==n.paidResources)),t.R7$(2),t.vxM(n.repair?-1:2),t.R7$(2),t.vxM(n.gameManager.game.party.loot.hide?4:-1),t.R7$(),t.vxM(n.gameManager.game.party.loot.hide?-1:5),t.R7$(),t.Dyx(t.bMT(8,4,n.characters))}}function cD(a,r){if(1&a&&(t.j41(0,"div",34)(1,"span",35),t.nVh(2,DS,4,2,"span",5),t.nVh(3,$S,1,1,"span",11),t.k0s(),t.j41(4,"span",36),t.nrm(5,"span",11),t.k0s(),t.Z7z(6,IS,4,5,"span",36,na),t.nI1(8,"trackUUID"),t.nVh(9,XS,11,9),t.nVh(10,qS,9,10),t.nVh(11,tD,9,10),t.nVh(12,rD,9,10),t.k0s()),2&a){const n=t.XpG();t.xc7("--ghs-summary-columns",2+n.characters.length),t.R7$(),t.Y8G("ngClass",t.ziG(12,dS,!n.repair,n.repair,n.paidResources,n.requiredResources-(n.discount?1:0)<=n.paidResources)),t.R7$(),t.vxM(n.repair?2:-1),t.R7$(),t.vxM(n.repair?-1:3),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.supply"),t.R7$(),t.Dyx(t.bMT(8,10,n.characters)),t.R7$(3),t.vxM(n.costs.gold?9:-1),t.R7$(),t.vxM(n.costs.lumber?10:-1),t.R7$(),t.vxM(n.costs.metal?11:-1),t.R7$(),t.vxM(n.costs.hide?12:-1)}}function lD(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",48),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.confirm(!0))}),t.nrm(1,"span",11),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.buildings.selectResources.morale"))}function gD(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",49),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.confirm())}),t.nrm(1,"span",11),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(2,Qt,!n.force&&(n.requiredResources-(n.discount?1:0)>n.paidResources||n.costs.gold&&n.costs.gold>n.spent.gold||!1))),t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.buildings.selectResources.confirm")}}let ea=(()=>{class a{data;dialogRef;dialog;gameManager=s.E;settingsManager=p.f;building;action;costs;requiredResources;paidResources=0;repair;force;characters=[];characterSpent=[];fhSupportSpent={gold:0,hide:0,lumber:0,metal:0,prosperity:0,manual:0};spent={gold:0,hide:0,lumber:0,metal:0,prosperity:0,manual:0};rewards;rewardsOnly;discount;constructor(n,i,e){if(this.data=n,this.dialogRef=i,this.dialog=e,this.repair=n.repair||0,this.requiredResources=this.repair,this.building=n.building,this.action=n.action,this.force=n.force||!1,this.rewardsOnly="rewards"==this.action,this.discount=null!=s.E.game.party.buildings.find(o=>"carpenter"==o.name&&o.level>0&&"wrecked"!=o.state)&&!this.repair,!this.repair&&this.building){this.costs=n.costs||{gold:0,hide:0,lumber:0,metal:0,prosperity:0,manual:0},this.costs.gold=this.costs.gold||0,this.costs.hide=this.costs.hide||0,this.costs.lumber=this.costs.lumber||0,this.costs.metal=this.costs.metal||0,this.requiredResources=this.costs.hide+this.costs.lumber+this.costs.metal;let o=this.discount;this.fhSupportSpent.lumber=Math.max(0,this.costs.lumber-(o?1:0)),o=!1,this.fhSupportSpent.lumber>(s.E.game.party.loot[rt.r6.lumber]||0)&&(this.fhSupportSpent.lumber=s.E.game.party.loot[rt.r6.lumber]||0,o=this.discount),this.spent[rt.r6.lumber]=this.fhSupportSpent.lumber,this.paidResources+=this.fhSupportSpent.lumber,this.fhSupportSpent.metal=Math.max(0,this.costs.metal-(o?1:0)),o=!1,this.fhSupportSpent.metal>(s.E.game.party.loot[rt.r6.metal]||0)&&(this.fhSupportSpent.metal=s.E.game.party.loot[rt.r6.metal]||0,o=this.discount),this.spent[rt.r6.metal]=this.fhSupportSpent.metal,this.paidResources+=this.fhSupportSpent.metal,this.fhSupportSpent.hide=Math.max(0,this.costs.hide-(o?1:0)),o=!1,this.fhSupportSpent.hide>(s.E.game.party.loot[rt.r6.hide]||0)&&(this.fhSupportSpent.hide=s.E.game.party.loot[rt.r6.hide]||0,o=this.discount),this.spent[rt.r6.hide]=this.fhSupportSpent.hide,this.paidResources+=this.fhSupportSpent.hide,("build"==this.action||"upgrade"==this.action)&&this.building.data.rewards&&this.building.data.rewards[this.building.model.level]?this.rewards=this.building.data.rewards[this.building.model.level]:"rewards"==this.action&&this.building.data.rewards&&this.building.data.rewards[this.building.model.level-1]&&(this.rewards=this.building.data.rewards[this.building.model.level-1])}else this.costs={gold:n.costs&&n.costs.gold||0,hide:this.repair,lumber:this.repair,metal:this.repair,prosperity:0,manual:0};this.characters=s.E.game.figures.filter(o=>o instanceof H.K).map(o=>o),this.characters.forEach((o,g)=>{this.characterSpent[g]={gold:0,hide:0,lumber:0,metal:0,prosperity:0,manual:0}})}ngOnInit(){this.force&&(!p.f.settings.applyBuildingRewards||!s.E.game.party.campaignMode)&&this.dialogRef.close(!0)}changeValue(n,i,e){i[n]+=e,this.spent[n]+=e,"gold"!=n&&"prosperity"!=n&&(this.paidResources+=e)}sectionRewards(n,i=""){const e=s.E.sectionData(i||s.E.currentEdition()).find(o=>o.index==n);if(this.rewardsOnly&&e){const o=s.E.buildingsManager.rewardSection(e),g=s.E.sectionData(e.edition).filter(m=>m.conclusion&&!m.parent&&m.parentSections&&m.parentSections.find(k=>1==k.length&&k.includes(e.index))&&0==s.E.scenarioManager.getRequirements(m).length);if(o||0==g.length){const m=new ut.Nz(o||e);this.close(),this.dialog.open(zt,{panelClass:["dialog"],data:{scenario:m,success:!0,conclusionOnly:!0,rewardsOnly:null!=o}})}else g.length>0&&this.dialog.open(Xn,{panelClass:["dialog"],data:{conclusions:g,parent:e}}).closed.subscribe({next:m=>{m&&this.sectionRewards(m.index,m.edition)}})}}confirm(n=!1){this.force?(0,F.co)(this.dialogRef,!0):n?(0,F.co)(this.dialogRef,new Bn.CS(this.characters,this.characterSpent,this.fhSupportSpent,1)):this.paidResources>=this.requiredResources-(this.discount?1:0)&&(!this.costs.gold||this.costs.gold==this.spent.gold)&&(0,F.co)(this.dialogRef,new Bn.CS(this.characters,this.characterSpent,this.fhSupportSpent))}close(){(0,F.co)(this.dialogRef)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-buildings-upgrade-dialog"]],standalone:!1,decls:16,vars:16,consts:[[1,"move-resources-dialog",3,"ngClass"],[1,"title"],[1,"name"],[1,"building"],[1,"costs",3,"ngClass"],[1,"costs"],[1,"lose-morale",3,"ghs-label","ghs-label-args"],[1,"rewards"],[1,"table",3,"--ghs-summary-columns"],[1,"menu"],[1,"cancel",3,"click"],[3,"ghs-label"],[1,"morale"],[1,"apply",3,"ngClass"],[1,"action",3,"src"],[3,"ghs-label","ghs-label-args"],[1,"cost"],["src","./assets/images/fh/loot/lumber.svg",1,"ghs-svg"],["src","./assets/images/fh/loot/metal.svg",1,"ghs-svg"],["src","./assets/images/fh/loot/hide.svg",1,"ghs-svg"],["src","./assets/images/fh/loot.svg",1,"ghs-svg"],["src","./assets/images/fh/loot/lumber.svg"],["src","./assets/images/fh/loot/metal.svg"],["src","./assets/images/fh/loot/hide.svg"],[1,"cost",3,"ghs-label"],[1,"text-white","prosperity",3,"ghs-label","ghs-label-args"],[1,"text-white","defense",3,"ghs-label","ghs-label-args"],[1,"text-white","soldiers",3,"ghs-label","ghs-label-args"],[1,"text-white","plots",3,"ghs-label","ghs-label-args"],[1,"text-white","items",3,"ghs-label","ghs-label-args"],[1,"text-white","section",3,"ngClass","ghs-label","ghs-label-args"],[1,"text-white","errata"],[1,"text-white","section",3,"click","ngClass","ghs-label","ghs-label-args"],[1,"text",3,"ghs-label"],[1,"table"],[1,"head-col",3,"ngClass"],[1,"first"],[1,"current"],[1,"icon","character-icon",3,"src"],[1,"name",3,"ngClass"],[1,"head-col","calc-col","costs",3,"ngClass"],[1,"ghs-svg",3,"src"],[1,"calc-col"],[1,"button",3,"click","ngClass"],["src","./assets/images/minus.svg",1,"ghs-svg"],[1,"value",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg",1,"ghs-svg"],[1,"head-col","calc-col",3,"ngClass"],[1,"morale",3,"click"],[1,"apply",3,"click","ngClass"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"label",1),t.nVh(2,pS,3,2,"span",2),t.nVh(3,uS,3,5,"span",3),t.nVh(4,fS,2,1,"span",2),t.nVh(5,PS,5,7,"span",4),t.nVh(6,bS,8,7,"span",4),t.nVh(7,kS,2,1,"div",5),t.nVh(8,yS,1,4,"span",6),t.nVh(9,SS,8,7,"div",7),t.k0s(),t.nVh(10,cD,13,17,"div",8),t.j41(11,"div",9)(12,"a",10),t.bIt("click",function(){return e.close()}),t.nrm(13,"span",11),t.k0s(),t.nVh(14,lD,2,1,"a",12),t.nVh(15,gD,2,4,"a",13),t.k0s()()),2&i&&(t.Y8G("ngClass",t.l_i(13,lS,"fh"==e.settingsManager.settings.theme,"modern"==e.settingsManager.settings.theme)),t.R7$(2),t.vxM(e.building?2:-1),t.R7$(),t.vxM(e.building?3:-1),t.R7$(),t.vxM(e.building||"soldiers"!=e.action?-1:4),t.R7$(),t.vxM(e.rewardsOnly?-1:5),t.R7$(),t.vxM(e.repair&&!e.rewardsOnly?6:-1),t.R7$(),t.vxM(e.discount&&!e.force?7:-1),t.R7$(),t.vxM(e.rewards&&e.rewards.loseMorale?8:-1),t.R7$(),t.vxM(e.rewards?9:-1),t.R7$(),t.vxM(!(e.costs.gold||e.costs.hide||e.costs.lumber||e.costs.metal)||e.force||e.rewardsOnly?-1:10),t.R7$(3),t.Y8G("ghs-label",e.rewardsOnly?"close":"cancel"),t.R7$(),t.vxM(!e.rewardsOnly&&e.repair&&e.gameManager.game.party.morale>0?14:-1),t.R7$(),t.vxM(e.rewardsOnly?-1:15))},dependencies:[N.YU,it,ct],styles:[".move-resources-dialog[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto;margin:0 .3em}.move-resources-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline);margin-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   img.action[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2.6 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor))}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]   .cost[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]   .cost[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .costs.force[_ngcontent-%COMP%]   .cost[_ngcontent-%COMP%]{color:var(--ghs-color-gray);text-shadow:none;opacity:.5}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .costs.force[_ngcontent-%COMP%]   .cost[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .lose-morale[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));color:#000;text-shadow:none;padding:.1em 1em;margin-top:.5em;background:radial-gradient(ellipse at center,#98c2c0,#4b9490 75%);clip-path:polygon(100% 0%,93% 50%,100% 100%,0 100%,7% 50%,0 0%)}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .rewards[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;min-width:calc(var(--ghs-unit) * 35 * var(--ghs-dialog-factor));margin-top:.5em;padding-top:.5em;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));border-top:.1em solid var(--ghs-color-gray)}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .rewards[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{cursor:pointer}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .rewards[_ngcontent-%COMP%]   .errata[_ngcontent-%COMP%]{text-align:justify;max-width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor))}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .rewards[_ngcontent-%COMP%]   .errata[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-style:italic}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]{--ghs-summary-columns: 5;font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));display:grid;grid-template-columns:repeat(var(--ghs-summary-columns),auto);padding-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));color:var(--ghs-color-white);overflow:auto}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-white)}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;text-align:center;padding:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));border-bottom:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-white);border-right:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-darkgray)}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-weight:700;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));flex-direction:row;justify-content:flex-end;background-image:url(dialog_background.fa4ff388462f6a00.png);position:sticky;left:0;z-index:1}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col.calc-col[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:.6}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col.costs[_ngcontent-%COMP%]   .cost[_ngcontent-%COMP%]{white-space:nowrap}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col.costs[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-red)}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col.costs[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col.costs.some[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col.costs.some[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col.costs.full[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col.costs.full[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .calc-col[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:.6}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .first[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);border-top:none}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--ghs-color-white);display:flex;justify-content:center;align-items:center;padding:0 .15em;white-space:nowrap}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;padding:0 .15em}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .button.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important;opacity:.6}.move-resources-dialog.fh[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.move-resources-dialog.modern[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:2em;padding:.3em}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.morale[_ngcontent-%COMP%]{color:var(--ghs-color-blue)}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}"]})}return a})();const Dr=a=>({disabled:a}),oo=a=>({total:a}),Na=(a,r)=>r._trackUUID;function dD(a,r){if(1&a&&(t.j41(0,"th")(1,"span",10),t.nrm(2,"img",11),t.j41(3,"span",12),t.EFF(4),t.k0s()()()),2&a){const n=r.$implicit,i=t.XpG();t.R7$(2),t.Y8G("src",n.iconUrl,t.B4B),t.R7$(2),t.SpI(" ",i.gameManager.characterManager.characterName(n,!0)," ")}}function hD(a,r){if(1&a&&(t.j41(0,"span",7),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.JRh(n.progress.gold||"-")}}function _D(a,r){if(1&a){const n=t.RV6();t.j41(0,"input",14),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG().$implicit;return t.DH7(o.progress.gold,e)||(o.progress.gold=e),c.Njj(e)}),t.bIt("change",function(e){c.eBV(n);const o=t.XpG().$implicit,g=t.XpG();return c.Njj(g.changeGold(o,e))}),t.k0s()}if(2&a){const n=t.XpG().$implicit;t.R50("ngModel",n.progress.gold)}}function mD(a,r){if(1&a&&(t.j41(0,"td"),t.nVh(1,hD,2,1,"span",7),t.nVh(2,_D,1,1,"input",13),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.vxM(n.edit?-1:1),t.R7$(),t.vxM(n.edit?2:-1)}}function pD(a,r){if(1&a&&(t.j41(0,"span",7),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.JRh(n.progress.experience||"-")}}function uD(a,r){if(1&a){const n=t.RV6();t.j41(0,"input",14),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG().$implicit;return t.DH7(o.progress.experience,e)||(o.progress.experience=e),c.Njj(e)}),t.bIt("change",function(e){c.eBV(n);const o=t.XpG().$implicit,g=t.XpG();return c.Njj(g.changeXP(o,e))}),t.k0s()}if(2&a){const n=t.XpG().$implicit;t.R50("ngModel",n.progress.experience)}}function fD(a,r){if(1&a&&(t.j41(0,"td"),t.nVh(1,pD,2,1,"span",7),t.nVh(2,uD,1,1,"input",13),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.vxM(n.edit?-1:1),t.R7$(),t.vxM(n.edit?2:-1)}}function CD(a,r){if(1&a&&(t.j41(0,"span",7),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(),t.JRh(i.party.loot[n]||"-")}}function MD(a,r){if(1&a){const n=t.RV6();t.j41(0,"input",14),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG().$implicit,g=t.XpG();return t.DH7(g.party.loot[o],e)||(g.party.loot[o]=e),c.Njj(e)}),t.bIt("change",function(e){c.eBV(n);const o=t.XpG().$implicit,g=t.XpG();return c.Njj(g.changeLoot(void 0,o,e))}),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG();t.R50("ngModel",i.party.loot[n])}}function vD(a,r){if(1&a&&(t.j41(0,"span",7),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG().$implicit;t.R7$(),t.JRh(n.progress.loot[i]||"-")}}function OD(a,r){if(1&a){const n=t.RV6();t.j41(0,"input",14),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG().$implicit,g=t.XpG().$implicit;return t.DH7(o.progress.loot[g],e)||(o.progress.loot[g]=e),c.Njj(e)}),t.bIt("change",function(e){c.eBV(n);const o=t.XpG().$implicit,g=t.XpG().$implicit,m=t.XpG();return c.Njj(m.changeLoot(o,g,e))}),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG().$implicit;t.R50("ngModel",n.progress.loot[i])}}function PD(a,r){if(1&a&&(t.j41(0,"td"),t.nVh(1,vD,2,1,"span",7),t.nVh(2,OD,1,1,"input",13),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.vxM(n.edit?-1:1),t.R7$(),t.vxM(n.edit?2:-1)}}function bD(a,r){if(1&a&&(t.j41(0,"tr")(1,"th",5),t.nrm(2,"img",6),t.k0s(),t.j41(3,"td"),t.nVh(4,CD,2,1,"span",7),t.nVh(5,MD,1,1,"input",13),t.k0s(),t.Z7z(6,PD,3,2,"td",null,Na),t.nI1(8,"trackUUID"),t.j41(9,"td")(10,"span",8),t.EFF(11),t.k0s()()()),2&a){const n=r.$implicit,i=t.XpG();t.R7$(),t.Y8G("ghs-tooltip","game.loot."+n),t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+n+".svg",t.B4B),t.R7$(2),t.vxM(i.edit?-1:4),t.R7$(),t.vxM(i.edit?5:-1),t.R7$(),t.Dyx(t.bMT(8,6,i.characters)),t.R7$(4),t.Y8G("ngClass",t.eq3(8,oo,i.total[n])),t.R7$(),t.JRh(i.total[n]||"-")}}function kD(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",9)(1,"a",15),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.close())}),t.nrm(2,"span",3),t.k0s(),t.j41(3,"a",16),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.apply())}),t.nrm(4,"span",3),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","cancel"),t.R7$(),t.Y8G("ngClass",t.eq3(3,Dr,!n.edited)),t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.supply.apply")}}let $r=(()=>{class a{dialogRef;dialog;gameManager=s.E;party=new Ua.r;characters=[];total={};totalGold=0;totalXP=0;lootColumns=rt.s$;edit=!1;edited=!1;constructor(n,i){this.dialogRef=n,this.dialog=i,this.edit=n.disableClose||!1}ngOnInit(){this.party=JSON.parse(JSON.stringify(s.E.game.party)),this.characters=s.E.game.figures.filter(n=>n instanceof H.K).map(n=>JSON.parse(JSON.stringify(n))),this.update()}toggleEdit(){this.dialogRef.close(),this.dialog.open(a,this.edit?{panelClass:["dialog","no-open-animation"]}:{panelClass:["dialog","no-open-animation"],disableClose:!0})}update(){this.lootColumns.forEach(n=>{this.total[n]=s.E.game.party.loot[n]||0,this.characters.length>0&&(this.total[n]=(this.total[n]||0)+this.characters.map(i=>i.progress.loot[n]||0).reduce((i,e)=>i+e))}),this.characters.length&&(this.totalGold=this.characters.map(n=>n.progress.gold||0).reduce((n,i)=>n+i),this.totalXP=this.characters.map(n=>n.progress.experience||0).reduce((n,i)=>n+i))}changeLoot(n,i,e){n?n.progress.loot[i]=+e.target.value||void 0:this.party.loot[i]=+e.target.value||void 0,this.update(),this.edited=!0}changeGold(n,i){n.progress.gold=+i.target.value,this.update(),this.edited=!0}changeXP(n,i){n.progress.experience=+i.target.value,this.update(),this.edited=!0}apply(){s.E.stateManager.before("applyResourceChange"),s.E.game.party.loot=this.party.loot,s.E.game.figures.filter(n=>n instanceof H.K).forEach(n=>{const i=this.characters.find(e=>e.edition==n.edition&&e.name==n.name);i&&(n.progress=i.progress)}),s.E.stateManager.after(),(0,F.co)(this.dialogRef)}close(){(0,F.co)(this.dialogRef)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.ce),t.rXU(O.lG))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-party-resources"]],standalone:!1,decls:44,vars:26,consts:[[1,"resources-dialog"],[1,"scroll-container"],[3,"click","ngClass"],[3,"ghs-label"],["type","checkbox",3,"checked"],[3,"ghs-tooltip"],[1,"ghs-svg",3,"src"],[1,"loot"],[1,"loot",3,"ngClass"],[1,"buttons"],[1,"character"],[1,"icon","character-icon",3,"src"],[1,"name"],["type","number","min","0",3,"ngModel"],["type","number","min","0",3,"ngModelChange","change","ngModel"],[1,"cancel",3,"click"],[1,"apply",3,"click","ngClass"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"table")(3,"thead")(4,"tr")(5,"th")(6,"label",2),t.bIt("click",function(){return e.toggleEdit()}),t.nrm(7,"span",3)(8,"input",4),t.k0s()(),t.j41(9,"th"),t.nrm(10,"span",3),t.k0s(),t.Z7z(11,dD,5,2,"th",null,Na),t.nI1(13,"trackUUID"),t.j41(14,"th"),t.nrm(15,"span",3),t.k0s()()(),t.j41(16,"tbody")(17,"tr")(18,"th",5),t.nrm(19,"img",6),t.k0s(),t.j41(20,"td")(21,"span",7),t.EFF(22,"-"),t.k0s()(),t.Z7z(23,mD,3,2,"td",null,Na),t.nI1(25,"trackUUID"),t.j41(26,"td")(27,"span",8),t.EFF(28),t.k0s()()(),t.j41(29,"tr")(30,"th",5),t.nrm(31,"img",6),t.k0s(),t.j41(32,"td")(33,"span",7),t.EFF(34,"-"),t.k0s()(),t.Z7z(35,fD,3,2,"td",null,Na),t.nI1(37,"trackUUID"),t.j41(38,"td")(39,"span",8),t.EFF(40),t.k0s()()(),t.Z7z(41,bD,12,10,"tr",null,t.fX1),t.k0s()()(),t.nVh(43,kD,5,5,"div",9),t.k0s()),2&i&&(t.R7$(6),t.Y8G("ngClass",t.eq3(20,Dr,e.edited)),t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.supply.edit"),t.R7$(),t.Y8G("checked",e.edit),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.supply"),t.R7$(),t.Dyx(t.bMT(13,14,e.characters)),t.R7$(4),t.Y8G("ghs-label","party.campaign.sheet.supply.total"),t.R7$(3),t.Y8G("ghs-tooltip","character.progress.gold"),t.R7$(),t.Y8G("src","./assets/images/loot.svg",t.B4B),t.R7$(4),t.Dyx(t.bMT(25,16,e.characters)),t.R7$(4),t.Y8G("ngClass",t.eq3(22,oo,e.totalGold)),t.R7$(),t.JRh(e.totalGold||"-"),t.R7$(2),t.Y8G("ghs-tooltip","game.experience"),t.R7$(),t.Y8G("src","./assets/images/experience.svg",t.B4B),t.R7$(4),t.Dyx(t.bMT(37,18,e.characters)),t.R7$(4),t.Y8G("ngClass",t.eq3(24,oo,e.totalXP)),t.R7$(),t.JRh(e.totalXP||"-"),t.R7$(),t.Dyx(e.lootColumns),t.R7$(2),t.vxM(e.edit||e.edited?43:-1))},dependencies:[N.YU,E.me,E.Q0,E.BC,E.VZ,E.vS,it,Mt,ct],styles:['.resources-dialog[_ngcontent-%COMP%]{position:relative;color:var(--ghs-color-white)}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{border-collapse:collapse;width:100%;margin:0;padding:0;font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor))}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{margin:0;padding:0;border-bottom:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-darkgray)}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));display:flex;justify-content:flex-end;align-items:center}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.5}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:relative;z-index:1}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:relative;z-index:2}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));max-width:100%;text-align:center;border:none;outline:none}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(odd)   td[_ngcontent-%COMP%]:before, .resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(odd)   th[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:0;background-color:var(--ghs-color-darkgray);opacity:.3;z-index:0}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]:before, .resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   th[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:0;background-color:var(--ghs-color-yellow);opacity:.5;z-index:0}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle;padding:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));border-right:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-darkgray)}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:right;font-family:var(--ghs-font-title);font-weight:initial}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);text-align:center}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-white)}.resources-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-between;align-items:center}.resources-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;min-width:33%;display:flex;justify-content:center}.resources-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.resources-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.resources-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.resources-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}']})}return a})();var Ir=v(7381),re=v.n(Ir);const yD=(a,r)=>({looted:a,highlight:r}),xD=(a,r)=>({selected:a,disabled:r}),ED=(a,r)=>[a,r],so=a=>[a],wD=(a,r)=>r._trackUUID;function RD(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function jD(a,r){if(1&a&&(t.j41(0,"span"),t.nVh(1,RD,2,0,"span"),t.EFF(2),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.vxM(!(""+n).startsWith("G")&&+n<10&&+n>=0?1:-1),t.R7$(),t.JRh(n)}}function GD(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"???"),t.k0s())}function TD(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",8),t.bIt("click",function(){const e=c.eBV(n).$index,o=t.XpG();return c.Njj(o.toggleTreasure(e))}),t.nVh(1,jD,3,2,"span"),t.nVh(2,GD,2,0,"span"),t.nrm(3,"img",9),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG();t.Y8G("ngClass",t.l_i(3,yD,e.looted.includes(i),i==e.treasureIndex)),t.R7$(),t.vxM((""+n).startsWith("G")||+n>=0?1:-1),t.R7$(),t.vxM(!(""+n).startsWith("G")&&+n<0?2:-1)}}function SD(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function DD(a,r){if(1&a&&(t.j41(0,"span"),t.nVh(1,SD,2,0,"span"),t.EFF(2),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.vxM(!(""+n).startsWith("G")&&+n<10&&+n>=0?1:-1),t.R7$(),t.SpI(" ",(""+n).startsWith("G-")?"G":(""+n).split(":")[0]," ")}}function $D(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"???"),t.k0s())}function ID(a,r){if(1&a&&t.nrm(0,"ghs-treasure-label",16),2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.Y8G("edition",i.edition)("index",+(""+n).split(":")[0]-1)("rewardResults",i.gameManager.scenarioManager.treasureRewardsFromString(""+n))}}function AD(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",13)(1,"div",14),t.bIt("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG().$implicit,g=t.XpG();return c.Njj(g.removeTreasure(o,e))}),t.nVh(2,DD,3,2,"span"),t.nVh(3,$D,2,0,"span"),t.k0s(),t.j41(4,"span",15),t.nVh(5,ID,1,3,"ghs-treasure-label",16),t.k0s()()}if(2&a){const n=r.$implicit;t.R7$(2),t.vxM((""+n).startsWith("G")||+(""+n).split(":")[0]>=0?2:-1),t.R7$(),t.vxM(!(""+n).startsWith("G")&&+(""+n).split(":")[0]<0?3:-1),t.R7$(2),t.vxM((""+n).startsWith("G-")?-1:5)}}function VD(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",10),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.toggleCharacter(e))}),t.nrm(1,"img",11),t.j41(2,"span",12),t.EFF(3),t.k0s(),t.j41(4,"div",3),t.Z7z(5,AD,6,3,"div",13,t.fX1),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.l_i(3,xD,i.character==n,i.treasures.length==i.looted.length)),t.R7$(),t.Y8G("src",n.iconUrl,t.B4B),t.R7$(2),t.SpI(" ",i.gameManager.characterManager.characterName(n,!0)," "),t.R7$(2),t.Dyx(n.treasures)}}function FD(a,r){if(1&a){const n=t.RV6();t.j41(0,"p"),t.nrm(1,"span",17),t.k0s(),t.j41(2,"div",18),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.lootTreasure())}),t.nrm(3,"span",2),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","game.loot.lootTreasure")("ghs-label-args",t.l_i(3,ED,n.character.title||"%data.character."+n.character.edition+"."+n.character.name+"%",(""+n.treasures[n.treasureIndex]).startsWith("G")||+n.treasures[n.treasureIndex]>=0?n.treasures[n.treasureIndex]:"'???'")),t.R7$(2),t.Y8G("ghs-label","game.loot.lootTreasure.confirm")}}function XD(a,r){if(1&a&&(t.j41(0,"p"),t.nrm(1,"span",17),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","game.loot.lootTreasure.selectTreasure")("ghs-label-args",t.eq3(2,so,n.character.title||"%data.character."+n.character.edition+"."+n.character.name+"%"))}}function BD(a,r){if(1&a&&(t.j41(0,"p"),t.nrm(1,"span",17),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","game.loot.lootTreasure.selectCharacter")("ghs-label-args",t.eq3(2,so,(""+n.treasures[n.treasureIndex]).startsWith("G-")?"G":+n.treasures[n.treasureIndex]>=0?""+n.treasures[n.treasureIndex]:"'???'"))}}function YD(a,r){1&a&&(t.j41(0,"span"),t.nrm(1,"span",2),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","game.loot.treasures.rewards.goal"))}function UD(a,r){if(1&a&&t.nrm(0,"ghs-treasure-label",19),2&a){const n=t.XpG(2);t.Y8G("edition",n.edition)("index",+n.treasures[n.treasureIndex]-1)("rewardResults",n.rewardResults)("itemCards",!0)}}function ND(a,r){if(1&a&&(t.j41(0,"p"),t.nrm(1,"span",17),t.k0s(),t.nVh(2,YD,2,1,"span"),t.nVh(3,UD,1,4,"ghs-treasure-label",19)),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","game.loot.lootTreasure.looted")("ghs-label-args",t.eq3(4,so,n.character.title||"%data.character."+n.character.edition+"."+n.character.name+"%")),t.R7$(),t.vxM("G"==n.treasures[n.treasureIndex]?2:-1),t.R7$(),t.vxM("G"!=n.treasures[n.treasureIndex]?3:-1)}}let ro=(()=>{class a{data;ghsManager;gameManager=s.E;scenario;characters=[];character;treasures=[];treasureIndex=-1;edition="";looted=[];rewardResults=[];init=!0;constructor(n,i,e){this.data=n,this.ghsManager=e,s.E.game.scenario||n.treasures&&n.edition?n&&n.treasures&&n.edition?(this.treasures=n.treasures,this.edition=n.edition):s.E.game.scenario&&(this.scenario=s.E.game.scenario||s.E.scenarioManager.createScenario(),this.edition=this.scenario.edition):(0,F.co)(i)}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.update()}}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.scenario=s.E.game.scenario||s.E.scenarioManager.createScenario(),this.characters=s.E.game.figures.filter(i=>i instanceof H.K&&!i.absent&&s.E.entityManager.isAlive(i)).map(i=>i),this.scenario&&(!this.data||!this.data.treasures)&&(this.edition=this.scenario.edition,this.treasures=s.E.scenarioManager.getTreasures(this.scenario,s.E.game.sections)),this.looted=[];let n=-1;this.treasures.forEach((i,e)=>{this.looted.includes(e)||!this.characters.find(o=>s.E.lootManager.hasTreasure(o,i,e))&&!s.E.game.party.treasures.find(o=>o.name==""+i&&o.edition==this.edition)?n=e:this.looted.push(e)}),this.init&&this.treasures.length==this.looted.length+1&&this.treasureIndex!=n&&!this.looted.includes(n)&&(this.treasureIndex=n),!this.character&&this.treasures.length!=this.looted.length&&(this.character=this.characters.find(i=>i.active)||this.characters.length>0&&this.characters[0]||void 0)}toggleCharacter(n){this.character!=n&&this.treasures.length!=this.looted.length?(this.character=n,-1!=this.treasureIndex&&this.looted.includes(this.treasureIndex)&&(this.treasureIndex=-1)):this.character=void 0}toggleTreasure(n){this.treasureIndex=this.treasureIndex!=n?n:-1}removeTreasure(n,i){"number"==typeof i?(s.E.stateManager.before("removeCharTresure",i>=0?""+i:"???",this.edition,s.E.characterManager.characterName(n)),this.looted.splice(this.treasures.indexOf(i),1)):(s.E.stateManager.before("removeCharTresure","G",this.edition),this.looted.splice(+i.replace("G-",""),1)),n.treasures.splice(n.treasures.indexOf(i),1),"number"==typeof i&&(s.E.game.party.treasures=s.E.game.party.treasures.filter(e=>e.edition!=this.edition||e.name!=""+i)),s.E.stateManager.after()}lootTreasure(){if(-1!=this.treasureIndex){this.init=!1,this.rewardResults=[];const n=this.treasures[this.treasureIndex];this.character&&n&&!this.character.treasures.includes("G"==n?"G-"+this.treasureIndex:n)&&(s.E.stateManager.before("lootCharTreasure",(""+n).startsWith("G")||+n>=0?""+n:"???",this.edition,s.E.characterManager.characterName(this.character)),this.looted.push(this.treasureIndex),"G"!=n&&p.f.settings.treasuresLoot&&(this.rewardResults=s.E.lootManager.lootTreasure(this.character,n-1,this.edition)),this.character.treasures=this.character.treasures||[],this.character.treasures.push("G"==n?"G-"+this.treasureIndex:this.rewardResults.some(i=>i.length>0)?n+":"+this.rewardResults.map(i=>i.join("+")).join("|"):n),"number"==typeof n&&s.E.game.party.treasures.push(new yt.gw(""+n,this.edition)),s.E.stateManager.after())}}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-scenario-treasures-dialog"]],standalone:!1,decls:15,vars:7,consts:[[1,"treasures-popup"],[1,"title"],[3,"ghs-label"],[1,"treasures"],[1,"treasure",3,"ngClass"],[1,"characters"],[1,"character",3,"ngClass"],[1,"loot"],[1,"treasure",3,"click","ngClass"],["src","./assets/images/check.svg",1,"overlay","check"],[1,"character",3,"click","ngClass"],[1,"icon",3,"src"],[1,"name"],[1,"hint-container"],["ghs-pointer-input","",1,"treasure","hint-trigger",3,"doubleClick"],[1,"hint","center"],[1,"text","placeholder","text-white",3,"edition","index","rewardResults"],[3,"ghs-label","ghs-label-args"],[1,"button",3,"click"],[1,"placeholder","text-white",3,"edition","index","rewardResults","itemCards"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"span",2),t.k0s(),t.j41(3,"div",3),t.Z7z(4,TD,4,6,"div",4,t.fX1),t.k0s(),t.j41(6,"div",5),t.Z7z(7,VD,7,6,"div",6,wD),t.nI1(9,"trackUUID"),t.k0s(),t.j41(10,"div",7),t.nVh(11,FD,4,6),t.nVh(12,XD,2,4,"p"),t.nVh(13,BD,2,4,"p"),t.nVh(14,ND,4,6),t.k0s()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","game.loot.treasures"),t.R7$(2),t.Dyx(e.treasures),t.R7$(3),t.Dyx(t.bMT(9,5,e.characters)),t.R7$(4),t.vxM(e.character&&-1!=e.treasureIndex&&!e.gameManager.lootManager.hasTreasure(e.character,e.treasures[e.treasureIndex],e.treasureIndex)?11:-1),t.R7$(),t.vxM(e.character&&-1==e.treasureIndex?12:-1),t.R7$(),t.vxM(e.character||-1==e.treasureIndex?-1:13),t.R7$(),t.vxM(e.character&&-1!=e.treasureIndex&&e.gameManager.lootManager.hasTreasure(e.character,e.treasures[e.treasureIndex],e.treasureIndex)?14:-1))},dependencies:[N.YU,it,dt,Pe,ct],styles:[".treasures-popup[_ngcontent-%COMP%]{text-align:center;color:var(--ghs-color-white);padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 35 * var(--ghs-dialog-factor))}.treasures-popup[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;justify-content:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.treasures-popup[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap}.treasures-popup[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;justify-content:center;background-image:url(treasure.0792d529e76ec279.png);background-size:contain;background-repeat:no-repeat;background-position:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-black);width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));transition:translate calc(var(--ghs-animation-speed) * .5s) ease-in-out}.treasures-popup[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{display:none;position:absolute;top:30%;left:50%;transform:translate(-50%);height:50%;width:auto}.treasures-popup[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .overlay.check[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.treasures-popup[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]:hover{opacity:.8;transform:scale(1.1)}.treasures-popup[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.looted[_ngcontent-%COMP%]{pointer-events:none;opacity:.4}.treasures-popup[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.looted[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .treasures-popup[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.highlight[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{display:block}.treasures-popup[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.treasures-popup[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;margin:.25em;padding:.25em;border:1px solid transparent}.treasures-popup[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline)}.treasures-popup[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:1.5em;height:auto;margin-right:.2em;filter:grayscale(.7)}.treasures-popup[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]:hover{color:var(--ghs-color-darkgray);border-color:var(--ghs-color-darkgray)}.treasures-popup[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]:hover   .icon[_ngcontent-%COMP%]{filter:grayscale(.3)}.treasures-popup[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character.disabled[_ngcontent-%COMP%]{cursor:initial!important;border-color:transparent}.treasures-popup[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character.selected[_ngcontent-%COMP%]{color:var(--ghs-color-white);border-color:var(--ghs-color-gray)}.treasures-popup[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character.selected[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{filter:none}.treasures-popup[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]{position:relative}.treasures-popup[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]{cursor:help!important;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.treasures-popup[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));min-height:calc(var(--ghs-unit) * 10 * var(--ghs-dialog-factor))}.treasures-popup[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:0;margin:0}.treasures-popup[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));color:var(--ghs-color-green)}.treasures-popup[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{opacity:.6}"]})}return a})();const zD=["treasureIndex"],LD=(a,r)=>({looted:a,highlight:r}),Ar=a=>({disabled:a}),qD=(a,r)=>r._trackUUID;function HD(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",11),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.batchSelect,e)||(o.batchSelect=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.update())}),t.k0s(),t.nrm(2,"span",4),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.R50("ngModel",n.batchSelect),t.R7$(),t.Y8G("ghs-label","party.campaign.treasures.batchSelect")}}function KD(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function WD(a,r){if(1&a&&(t.j41(0,"span",18),t.nrm(1,"ghs-treasure-label",19),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG().$implicit;t.R7$(),t.Y8G("edition",i.edition)("index",n)}}function ZD(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",14)(1,"div",15),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.toggleTreasure(e))}),t.nVh(2,KD,2,0,"span"),t.EFF(3),t.nrm(4,"img",16)(5,"img",17),t.k0s(),t.nVh(6,WD,2,2,"span",18),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.l_i(4,LD,i.looted.includes(n),i.selected.includes(n))),t.R7$(),t.vxM(n<10?2:-1),t.R7$(),t.SpI("",n," "),t.R7$(3),t.vxM(i.looted.includes(n)?6:-1)}}function JD(a,r){if(1&a&&(t.j41(0,"div",6)(1,"div",2),t.nrm(2,"span",12)(3,"span",12),t.k0s(),t.j41(4,"div",13),t.Z7z(5,ZD,7,7,"div",14,t.fX1),t.k0s()()),2&a){const n=r.$implicit,i=t.XpG();t.R7$(2),t.Y8G("ghs-label","%data.scenarioNumber:"+n.index+"%"),t.R7$(),t.Y8G("ghs-label",i.gameManager.scenarioManager.scenarioTitle(n)),t.R7$(2),t.Dyx(i.treasures[n.index])}}function QD(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",20),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleTreasure(e.selected[0],!0))}),t.nrm(1,"span",4),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(2,Ar,0==n.selected.length)),t.R7$(),t.Y8G("ghs-label","party.campaign.treasures.loot")}}function t$(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",21),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.apply())}),t.nrm(1,"span",4),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(2,Ar,0==n.selected.length)),t.R7$(),t.Y8G("ghs-label","party.campaign.treasures.applySelect")}}let Vr=(()=>{class a{data;dialogRef;dialog;ghsManager;treasureIndex;gameManager=s.E;edition;scenarios=[];treasures={};looted=[];selected=[];batchSelect=!0;constructor(n,i,e,o){this.data=n,this.dialogRef=i,this.dialog=e,this.ghsManager=o,this.edition=n.edition,this.batchSelect=null==n.scenario}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.update()}}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.scenarios=[],this.treasures={},this.looted=[],this.selected=[],s.E.scenarioManager.scenarioData(this.edition).filter(n=>!this.data.scenario&&(s.E.scenarioManager.isSuccess(n)||s.E.game.party.casualScenarios.find(i=>n.index==i.index&&n.edition==i.edition&&n.group==i.group))||this.data.scenario&&n.edition==this.data.scenario.edition&&n.index==this.data.scenario.index&&n.group==this.data.scenario.group).forEach(n=>{let i=s.E.scenarioManager.getAllTreasures(n).filter(e=>"number"==typeof e).map(e=>+e);this.batchSelect||(i=i.filter(e=>!this.hasTreasure(""+e,this.edition))),i.length>0&&(this.scenarios.push(n),this.treasures[n.index]=i,i.forEach(e=>{this.hasTreasure(""+e,this.edition)&&this.looted.push(e)}))})}toggleTreasure(n,i=!1){this.batchSelect&&!i?this.selected.includes(n)?this.selected.splice(this.selected.indexOf(n),1):this.selected.push(n):this.data.scenario&&!i?this.selected.includes(n)?this.selected.splice(this.selected.indexOf(n),1):(this.selected=[],this.selected.push(n)):this.looted.includes(n)||this.dialog.open(ro,{panelClass:["dialog"],data:{treasures:[n],edition:this.edition}})}hasTreasure(n,i){return s.E.game.party.treasures&&s.E.game.party.treasures.some(e=>e.name==n&&e.edition==i)}apply(){const n=this.selected.filter(e=>this.looted.includes(e)),i=this.selected.filter(e=>!this.looted.includes(e));n.length>0&&(s.E.stateManager.before("removeTreasures",this.edition,"["+n.join(",")+"]"),s.E.game.party.treasures=s.E.game.party.treasures.filter(e=>e.edition!=this.edition||isNaN(+e.name)||!n.includes(+e.name)),s.E.stateManager.after()),i.length>0&&(s.E.stateManager.before("addTreasures",this.edition,"["+i.join(",")+"]"),s.E.game.party.treasures.push(...i.map(e=>new yt.gw(""+e,this.edition))),s.E.stateManager.after()),this.update()}close(){(0,F.co)(this.dialogRef)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-treasures-dialog"]],viewQuery:function(i,e){if(1&i&&t.GBs(zD,5),2&i){let o;t.mGM(o=t.lsd())&&(e.treasureIndex=o.first)}},standalone:!1,decls:15,vars:7,consts:[[1,"treasures-dialog"],[1,"header"],[1,"title"],["src","./assets/images/scenario/treasure.svg",1,"icon"],[3,"ghs-label"],[1,"scenarios"],[1,"scenario"],[1,"buttons"],[1,"cancel",3,"click"],[1,"loot",3,"ngClass"],[1,"apply",3,"ngClass"],["type","checkbox",3,"ngModelChange","change","ngModel"],[1,"text-white",3,"ghs-label"],[1,"treasures"],[1,"hint-container"],[1,"treasure","hint-trigger",3,"click","ngClass"],["src","./assets/images/check.svg",1,"overlay","check"],["src","./assets/images/close.svg",1,"overlay","uncheck"],[1,"hint","center"],[1,"text","placeholder","text-white",3,"edition","index"],[1,"loot",3,"click","ngClass"],[1,"apply",3,"click","ngClass"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.nrm(3,"img",3)(4,"span",4),t.k0s(),t.nVh(5,HD,3,2,"label"),t.k0s(),t.j41(6,"div",5),t.Z7z(7,JD,7,2,"div",6,qD),t.nI1(9,"trackUUID"),t.k0s(),t.j41(10,"div",7)(11,"a",8),t.bIt("click",function(){return e.close()}),t.nrm(12,"span",4),t.k0s(),t.nVh(13,QD,2,4,"a",9),t.nVh(14,t$,2,4,"a",10),t.k0s()()),2&i&&(t.R7$(4),t.Y8G("ghs-label","party.campaign.treasures"),t.R7$(),t.vxM(e.data.scenario?-1:5),t.R7$(2),t.Dyx(t.bMT(9,5,e.scenarios)),t.R7$(5),t.Y8G("ghs-label","cancel"),t.R7$(),t.vxM(e.data.scenario?13:-1),t.R7$(),t.vxM(e.batchSelect||e.data.scenario?14:-1))},dependencies:[N.YU,E.Zm,E.BC,E.vS,it,Pe,ct],styles:[".treasures-dialog[_ngcontent-%COMP%]{color:var(--ghs-color-white);min-width:25vw}.treasures-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.treasures-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-yellow)}.treasures-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));width:auto;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));filter:var(--ghs-filter-yellow)}.treasures-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer;color:var(--ghs-color-white);margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow:auto;max-height:70vh}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;margin:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;justify-content:center;background-image:url(treasure.0792d529e76ec279.png);background-size:contain;background-repeat:no-repeat;background-position:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-black);width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));transition:translate calc(var(--ghs-animation-speed) * .5s) ease-in-out}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{display:none;position:absolute;top:30%;left:50%;transform:translate(-50%);height:50%;width:auto}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .overlay.check[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .overlay.uncheck[_ngcontent-%COMP%]{filter:var(--ghs-filter-red)}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]:hover{opacity:.8;transform:scale(1.1)}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.looted[_ngcontent-%COMP%]{cursor:initial;opacity:.4}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.looted[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.highlight[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{display:block}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.highlight.looted[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{display:none}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.highlight.looted[_ngcontent-%COMP%]   .uncheck[_ngcontent-%COMP%]{display:block}.treasures-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-between;align-items:center}.treasures-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;min-width:33%;display:flex;justify-content:center}.treasures-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.treasures-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.treasures-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.treasures-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.treasures-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.treasures-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .loot.disabled[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray)}"]})}return a})();const n$=(a,r)=>({fh:a,modern:r}),e$=a=>({"bottom-actions":a}),a$=(a,r)=>r._trackUUID;function i$(a,r){if(1&a&&t.nrm(0,"img",8),2&a){const n=t.XpG();t.Y8G("src",n.gameManager.monsterManager.monsterThumbnail(n.monster),t.B4B)}}function o$(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.JRh(n[0])}}function s$(a,r){if(1&a&&(t.j41(0,"span",9),t.Z7z(1,o$,2,1,"span",null,t.fX1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(n.settingsManager.getLabel("data.monster."+n.monster.name).split(" "))}}function r$(a,r){1&a&&(t.j41(0,"span",10),t.nrm(1,"img",18),t.k0s())}function c$(a,r){1&a&&(t.j41(0,"span",11),t.EFF(1,"*"),t.k0s())}function l$(a,r){if(1&a&&t.nrm(0,"p",14),2&a){const n=t.XpG();t.Y8G("ghs-label",n.statEffectNote)}}function g$(a,r){if(1&a&&(t.j41(0,"div",16),t.nrm(1,"ghs-monster-stats",19),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("monster",n.monster)("forceStats",!0)}}function d$(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",20),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.close())})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.openAbility(e))}),t.nrm(1,"ghs-ability",21),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(7,e$,i.gameManager.hasBottomAbility(n))),t.R7$(),t.Y8G("ability",n)("monster",i.monster)("flipped",!0)("reveal",!0)("relative",!0)("statsCalculation",!1)}}let co=(()=>{class a{data;dialogRef;dialog;gameManager=s.E;settingsManager=p.f;monster;abilities=[];hideStats;statEffectNote;constructor(n,i,e){this.data=n,this.dialogRef=i,this.dialog=e,this.monster=n.monster,this.hideStats=n.hideStats,this.statEffectNote=n.statEffectNote||"",this.abilities=s.E.deckData(this.monster).abilities}openAbility(n){this.dialog.open(Di,{panelClass:["fullscreen-panel"],disableClose:!0,data:{ability:n,monster:this.monster,relative:!0}})}close(){(0,F.co)(this.dialogRef)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-stats-list"]],standalone:!1,decls:21,vars:13,consts:[[1,"stats-dialog"],[1,"scroll-container"],[1,"header",3,"ngClass"],[1,"title"],[1,"image"],[1,"outer-border"],[1,"inner-border"],[1,"image-container"],[3,"src"],[1,"letter"],[1,"boss"],[1,"custom"],[1,"name"],[3,"ghs-label"],[1,"stat-effect","text-white",3,"ghs-label"],[1,"container"],[1,"stats"],["ghs-pointer-input","",1,"ability",3,"ngClass"],["src","./assets/images/monster/enemy.png"],[3,"monster","forceStats"],["ghs-pointer-input","",1,"ability",3,"singleClick","doubleClick","ngClass"],[3,"ability","monster","flipped","reveal","relative","statsCalculation"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7),t.nVh(8,i$,1,1,"img",8),t.nVh(9,s$,3,0,"span",9),t.k0s()()(),t.nVh(10,r$,2,0,"span",10),t.nVh(11,c$,2,0,"span",11),t.k0s(),t.j41(12,"div",12),t.nrm(13,"span",13),t.k0s()(),t.nVh(14,l$,1,1,"p",14),t.k0s(),t.j41(15,"div",15),t.nVh(16,g$,2,2,"div",16),t.k0s(),t.j41(17,"div",15),t.Z7z(18,d$,2,9,"div",17,a$),t.nI1(20,"trackUUID"),t.k0s()()()),2&i&&(t.R7$(2),t.Y8G("ngClass",t.l_i(10,n$,"fh"==e.settingsManager.settings.theme,"modern"==e.settingsManager.settings.theme)),t.R7$(6),t.vxM(!e.monster.noThumbnail&&e.settingsManager.settings.artwork?8:-1),t.R7$(),t.vxM(e.monster.noThumbnail||!e.settingsManager.settings.artwork?9:-1),t.R7$(),t.vxM(e.monster.boss||e.monster.tags.includes("boss")?10:-1),t.R7$(),t.vxM(e.monster.standeeShare||e.monster.statEffect||e.statEffectNote?11:-1),t.R7$(2),t.Y8G("ghs-label","data.monster."+e.monster.name),t.R7$(),t.vxM(e.statEffectNote?14:-1),t.R7$(2),t.vxM(e.hideStats?-1:16),t.R7$(2),t.Dyx(t.bMT(20,8,e.abilities)))},styles:[".stats-dialog[_ngcontent-%COMP%]{position:relative}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{position:sticky;top:0;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:999;background-image:url(dialog_background.fa4ff388462f6a00.png)}.stats-dialog[_ngcontent-%COMP%]   .header.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.stats-dialog[_ngcontent-%COMP%]   .header.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{position:relative}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 11 * .866025 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 11 * var(--ghs-dialog-factor));background-color:var(--ghs-color-white);clip-path:polygon(50% 0,100% 25%,100% 75%,50% 100%,0 75%,0 25%)}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 10.3 * .866025 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 10.3 * var(--ghs-dialog-factor));background-color:var(--ghs-color-red);clip-path:polygon(50% 0,100% 25%,100% 75%,50% 100%,0 75%,0 25%)}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 9 * .866025 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 9 * var(--ghs-dialog-factor));background-color:var(--ghs-color-darkgray);clip-path:polygon(50% 0,100% 25%,100% 75%,50% 100%,0 75%,0 25%)}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 9 * var(--ghs-dialog-factor));height:auto}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .letter[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-white);font-family:var(--ghs-font-title)}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .boss[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));position:absolute;top:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * -1 * var(--ghs-dialog-factor));background-color:var(--ghs-color-darkred);border:2px solid var(--ghs-color-gray);border-radius:100%}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .boss[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.7 * var(--ghs-dialog-factor));height:auto}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .custom[_ngcontent-%COMP%]{display:flex;justify-content:center;width:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));position:absolute;bottom:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * -1 * var(--ghs-dialog-factor));font-family:var(--ghs-font-gh-title);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 9 * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 9 * var(--ghs-text-factor));background-color:var(--ghs-color-darkgray);border:2px solid var(--ghs-color-gray);border-radius:100%}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{color:var(--ghs-color-gray);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));padding:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]{color:var(--ghs-color-white);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));max-width:calc(var(--ghs-unit) * 42 * var(--ghs-dialog-factor));text-align:center}.stats-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;min-width:calc(var(--ghs-unit) * 42 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.stats-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{cursor:pointer;position:relative;width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor));min-height:calc(var(--ghs-unit) * 21.5 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.stats-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   ghs-monster-stats[_ngcontent-%COMP%]{display:block;width:100%;height:auto}.stats-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .ability[_ngcontent-%COMP%]{cursor:pointer!important;position:relative;width:calc(var(--ghs-unit) * 33.55 * var(--ghs-dialog-factor));min-height:calc(var(--ghs-unit) * 21.5 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));flex-shrink:0;flex-grow:0}.stats-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .ability.bottom-actions[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 49.95 * var(--ghs-dialog-factor))}.stats-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .ability[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:auto}"]})}return a})();const h$=(a,r)=>({ally:a,allied:r}),_$=(a,r)=>({current:a,active:r});function m$(a,r){1&a&&(t.j41(0,"span",4),t.nrm(1,"span",3),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","game.ally"))}function p$(a,r){1&a&&(t.j41(0,"span",5),t.nrm(1,"span",3),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","game.allied"))}function u$(a,r){if(1&a&&(t.j41(0,"span",6),t.EFF(1,"["),t.nrm(2,"span",3),t.EFF(3,"]"),t.k0s()),2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","data.edition."+n.getEdition())}}function f$(a,r){if(1&a){const n=t.RV6();t.j41(0,"span")(1,"a",12),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.setLevel(e))}),t.EFF(2),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG();t.R7$(),t.Y8G("ngClass",t.l_i(2,_$,n==i.gameManager.game.level,n==i.monster.level)),t.R7$(),t.JRh(n)}}let C$=(()=>{class a{monster;dialogRef;levels=[0,1,2,3,4,5,6,7];gameManager=s.E;constructor(n,i){this.monster=n,this.dialogRef=i}setLevel(n){(0,F.co)(this.dialogRef,n)}getEdition(){return s.E.getEdition(this.monster)}toggleAlly(){s.E.stateManager.before(this.monster.isAlly?"unsetAlly":"setAlly","data.monster."+this.monster.name),this.monster.isAlly=!this.monster.isAlly,s.E.stateManager.after()}toggleallied(){s.E.stateManager.before(this.monster.isAllied?"unsetAllied":"setAllied","data.monster."+this.monster.name),this.monster.isAllied=!this.monster.isAllied,s.E.stateManager.after()}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-monster-level-dialog"]],standalone:!1,decls:15,vars:9,consts:[[1,"level-dialog"],[1,"title"],[1,"name"],[3,"ghs-label"],[1,"ally"],[1,"allied"],[1,"edition"],[1,"level-container"],[1,"item"],["src","./assets/images/status/level.svg"],["ghs-pointer-input","",1,"toggle-ally",3,"singleClick","doubleClick","ngClass"],["src","./assets/images/monster/enemy.png"],[1,"level",3,"click","ngClass"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"span",1)(2,"span",2),t.nrm(3,"span",3),t.nVh(4,m$,2,1,"span",4),t.nVh(5,p$,2,1,"span",5),t.nVh(6,u$,4,1,"span",6),t.k0s(),t.nrm(7,"span",3),t.k0s(),t.j41(8,"div",7)(9,"span",8),t.nrm(10,"img",9),t.k0s(),t.Z7z(11,f$,3,5,"span",null,t.fX1),t.j41(13,"span",10),t.bIt("singleClick",function(){return e.toggleAlly()})("doubleClick",function(){return e.toggleallied()}),t.nrm(14,"img",11),t.k0s()()()),2&i&&(t.R7$(3),t.Y8G("ghs-label","data.monster."+e.monster.name),t.R7$(),t.vxM(e.monster.isAlly?4:-1),t.R7$(),t.vxM(e.monster.isAllied?5:-1),t.R7$(),t.vxM(e.getEdition()?6:-1),t.R7$(),t.Y8G("ghs-label","game.level"),t.R7$(4),t.Dyx(e.levels),t.R7$(2),t.Y8G("ngClass",t.l_i(6,h$,e.monster.isAlly,e.monster.isAllied)))},dependencies:[N.YU,it,dt],styles:['.level-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column}.level-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-family:var(--ghs-font-title);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));text-align:center;width:100%}.level-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{color:var(--ghs-color-gray);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor)));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   span.item[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:auto}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover, .level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .level.current[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .level.active[_ngcontent-%COMP%]{pointer-events:none;border:calc(var(--ghs-unit) / 4) var(--ghs-color-white) solid;border-radius:100%}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .max-health[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .toggle-ally[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));cursor:pointer;display:flex;justify-content:center;align-items:center;z-index:4}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .toggle-ally[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:auto}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .toggle-ally.ally[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:50%;left:50%;width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));transform:translate(-50%,-50%);background-color:var(--ghs-color-red);clip-path:polygon(10% 0,0 10%,40% 50%,0 90%,10% 100%,50% 60%,90% 100%,100% 90%,60% 50%,100% 10%,90% 0,50% 40%)}']})}return a})();const M$=(a,r)=>({closed:a,opened:r}),v$=a=>({flipped:a});let lo=(()=>{class a{data;dialogRef;opened=!1;monster;forceStats;constructor(n,i){this.data=n,this.dialogRef=i,this.monster=n.monster,this.forceStats=n.forceStats}ngOnInit(){this.opened=!0}close(){this.opened=!1,setTimeout(()=>{this.dialogRef.close()},p.f.settings.animations?1e3*p.f.settings.animationSpeed:0)}getBackside(){let n=new b.R(this.monster);return n.boss?s.E.monsterManager.addMonsterEntity(n,1,S.N.boss):(s.E.monsterManager.addMonsterEntity(n,1,S.N.normal),s.E.monsterManager.addMonsterEntity(n,1,S.N.elite)),n.isAlly=this.monster.isAlly,n.isAllied=this.monster.isAllied,n.level=this.monster.level<4?this.monster.level+4:this.monster.level-4,n.errors=this.monster.errors,n}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-stat-dialog"]],standalone:!1,decls:9,vars:15,consts:[[1,"stat-dialog",3,"click","ngClass"],[1,"stat-container"],[1,"card-container"],[1,"card","reverse",3,"ngClass"],[1,"card-back"],[3,"monster","noClick","disablePoup","forceStats"],[1,"card-front"],[1,"close-container",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.bIt("click",function(){return e.close()}),t.j41(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),t.nrm(5,"ghs-monster-stats",5),t.k0s(),t.j41(6,"div",6),t.nrm(7,"ghs-monster-stats",5),t.k0s()()()()(),t.j41(8,"div",7),t.bIt("click",function(){return e.close()}),t.k0s()),2&i&&(t.Y8G("ngClass",t.l_i(10,M$,!e.opened,e.opened)),t.R7$(3),t.Y8G("ngClass",t.eq3(13,v$,e.opened)),t.R7$(2),t.Y8G("monster",e.getBackside())("noClick",!0)("disablePoup",!0)("forceStats",e.forceStats),t.R7$(2),t.Y8G("monster",e.monster)("noClick",!0)("disablePoup",!0)("forceStats",e.forceStats))},styles:["[_nghost-%COMP%]{background-color:transparent;padding:0;margin:0;border:0}.stat-dialog[_ngcontent-%COMP%]{position:relative;width:100vw;height:100vh;border-image:none;background:none;transition:transform calc(var(--ghs-animation-speed) * .15s) ease-in-out;transform:scale(0);z-index:2;overflow:auto;display:flex;justify-content:center;align-items:center;-ms-overflow-style:none;scrollbar-width:none}.stat-dialog[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.stat-dialog.opened[_ngcontent-%COMP%]{transform:scale(1)}.stat-dialog.closed[_ngcontent-%COMP%]{transform:scale(0);transition-delay:.8s}.stat-dialog[_ngcontent-%COMP%]   .stat-container[_ngcontent-%COMP%]{overflow:visible;width:100vw;max-width:600px;max-height:100vh}.stat-dialog[_ngcontent-%COMP%]   .stat-container[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]{width:100%;height:100%;margin:1vh 0}.close-container[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1}"]})}return a})();const O$=(a,r)=>({fh:a,modern:r}),P$=a=>[a],b$=(a,r)=>r._trackUUID;function k$(a,r){1&a&&(t.j41(0,"span",3),t.nrm(1,"span",2),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","game.ally"))}function y$(a,r){1&a&&(t.j41(0,"span",4),t.nrm(1,"span",2),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","game.allied"))}function x$(a,r){if(1&a&&(t.j41(0,"span",5),t.EFF(1,"["),t.nrm(2,"span",2),t.EFF(3,"]"),t.k0s()),2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","data.edition."+n.edition)}}function E$(a,r){if(1&a&&(t.j41(0,"span",19)(1,"span",20),t.nrm(2,"img",21),t.k0s(),t.nrm(3,"span",22),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/stats/hp.svg",t.B4B),t.R7$(),t.Y8G("value-sign",n.EntityValueFunction(n.monster.statEffect.health))}}function w$(a,r){if(1&a&&(t.j41(0,"span",19)(1,"span",20),t.nrm(2,"img",21),t.k0s(),t.nrm(3,"span",22),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/stats/"+(n.monster.flying?"fly":"move")+".svg",t.B4B),t.R7$(),t.Y8G("value-sign",n.EntityValueFunction(n.monster.statEffect.movement))}}function R$(a,r){if(1&a&&(t.j41(0,"span",19)(1,"span",20),t.nrm(2,"img",21),t.k0s(),t.nrm(3,"span",22),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/stats/attack.svg",t.B4B),t.R7$(),t.Y8G("value-sign",n.EntityValueFunction(n.monster.statEffect.attack))}}function j$(a,r){if(1&a&&(t.j41(0,"span",19)(1,"span",20),t.nrm(2,"img",21),t.k0s(),t.nrm(3,"span",22),t.k0s()),2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/stats/range.svg",t.B4B),t.R7$(),t.Y8G("value-sign",n.EntityValueFunction(n.monster.statEffect.range))}}function G$(a,r){if(1&a&&(t.nVh(0,E$,4,2,"span",19),t.nVh(1,w$,4,2,"span",19),t.nVh(2,R$,4,2,"span",19),t.nVh(3,j$,4,2,"span",19)),2&a){const n=t.XpG(2);t.vxM(n.monster.statEffect.health?0:-1),t.R7$(),t.vxM(n.monster.statEffect.movement?1:-1),t.R7$(),t.vxM(n.monster.statEffect.attack?2:-1),t.R7$(),t.vxM(n.monster.statEffect.range?3:-1)}}function T$(a,r){if(1&a&&(t.j41(0,"span",19)(1,"span",20),t.nrm(2,"img",21),t.k0s(),t.j41(3,"span"),t.EFF(4,"= "),t.nrm(5,"span",2),t.k0s()()),2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/stats/hp.svg",t.B4B),t.R7$(3),t.Y8G("ghs-label",n.monster.statEffect.health)}}function S$(a,r){if(1&a&&(t.j41(0,"span",19)(1,"span",20),t.nrm(2,"img",21),t.k0s(),t.j41(3,"span"),t.EFF(4,"= "),t.nrm(5,"span",2),t.k0s()()),2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/stats/"+(n.monster.flying?"fly":"move")+".svg",t.B4B),t.R7$(3),t.Y8G("ghs-label",n.monster.statEffect.movement)}}function D$(a,r){if(1&a&&(t.j41(0,"span",19)(1,"span",20),t.nrm(2,"img",21),t.k0s(),t.j41(3,"span"),t.EFF(4,"= "),t.nrm(5,"span",2),t.k0s()()),2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/stats/attack.svg",t.B4B),t.R7$(3),t.Y8G("ghs-label",n.monster.statEffect.attack)}}function $$(a,r){if(1&a&&(t.j41(0,"span",19)(1,"span",20),t.nrm(2,"img",21),t.k0s(),t.j41(3,"span"),t.EFF(4,"= "),t.nrm(5,"span",2),t.k0s()()),2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/stats/range.svg",t.B4B),t.R7$(3),t.Y8G("ghs-label",n.monster.statEffect.range)}}function I$(a,r){if(1&a&&(t.nVh(0,T$,6,2,"span",19),t.nVh(1,S$,6,2,"span",19),t.nVh(2,D$,6,2,"span",19),t.nVh(3,$$,6,2,"span",19)),2&a){const n=t.XpG(2);t.vxM(n.monster.statEffect.health?0:-1),t.R7$(),t.vxM(n.monster.statEffect.movement?1:-1),t.R7$(),t.vxM(n.monster.statEffect.attack?2:-1),t.R7$(),t.vxM(n.monster.statEffect.range?3:-1)}}function A$(a,r){if(1&a&&t.nrm(0,"ghs-actions",15),2&a){const n=t.XpG(2);t.Y8G("actions",n.monster.statEffect.actions)("relative",!0)("inline",!0)("statsCalculation",!1)}}function V$(a,r){if(1&a&&(t.j41(0,"span",23),t.nrm(1,"img",24),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(3);t.R7$(),t.Y8G("src","./assets/images"+(i.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+n+".svg",t.B4B)}}function F$(a,r){if(1&a&&(t.j41(0,"div",16),t.Z7z(1,V$,2,1,"span",23,t.fX1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Dyx(n.monster.statEffect.immunities)}}function X$(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",25),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openAbilities())}),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","monster.statEffect.deck")("ghs-label-args",t.eq3(2,P$,n.monster.statEffect.note))}}function B$(a,r){if(1&a&&t.nrm(0,"span",18),2&a){const n=t.XpG(2);t.Y8G("ghs-label",n.monster.statEffect.note)}}function Y$(a,r){if(1&a&&(t.j41(0,"div",10),t.nrm(1,"div",13),t.j41(2,"div",14),t.nVh(3,G$,4,4),t.nVh(4,I$,4,4),t.k0s(),t.nVh(5,A$,1,4,"ghs-actions",15),t.nVh(6,F$,3,0,"div",16),t.nVh(7,X$,1,4,"span",17),t.nVh(8,B$,1,1,"span",18),t.k0s()),2&a){const n=t.XpG();t.Y8G("ngClass",t.l_i(8,O$,"fh"==n.settingsManager.settings.theme,"modern"==n.settingsManager.settings.theme)),t.R7$(),t.Y8G("ghs-label","monster.statEffect"),t.R7$(2),t.vxM(n.monster.statEffect.absolute?-1:3),t.R7$(),t.vxM(n.monster.statEffect.absolute?4:-1),t.R7$(),t.vxM(n.monster.statEffect.actions?5:-1),t.R7$(),t.vxM(n.monster.statEffect.immunities?6:-1),t.R7$(),t.vxM(n.monster.statEffect.deck?7:-1),t.R7$(),t.vxM(n.monster.statEffect.initiative?8:-1)}}function U$(a,r){if(1&a&&(t.j41(0,"div",12),t.nrm(1,"ghs-monster-stats",26),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.Y8G("monster",n)("forceStats",!0)("noClick",!0)}}let Fr=(()=>{class a{monster;dialogRef;dialog;settingsManager=p.f;levels=[0,1,2,3,4,5,6,7];monsters=[];edition="";EntityValueFunction=A.hZ;dormant=!1;constructor(n,i,e){this.monster=n,this.dialogRef=i,this.dialog=e,this.levels.forEach(o=>{this.monsters.push(this.getMonsterForLevel(o))}),this.edition=s.E.getEdition(this.monster),this.dormant=this.monster.entities.every(o=>o.dormant)}getMonsterForLevel(n){let i=new b.R(this.monster,n);return i.isAlly=this.monster.isAlly,i.isAllied=this.monster.isAllied,i.errors=this.monster.errors,i.statEffect=this.monster.statEffect,i.flying=this.monster.flying&&(!this.monster.statEffect||"disabled"!=this.monster.statEffect.flying)||null!=this.monster.statEffect&&1==this.monster.statEffect.flying,i}toggleAlly(){s.E.stateManager.before(this.monster.isAlly?"unsetAlly":"setAlly","data.monster."+this.monster.name),this.monster.isAlly=!this.monster.isAlly,s.E.stateManager.after()}toggleDormant(){s.E.stateManager.before(this.dormant?"unsetDormant":"setDormant","data.monster."+this.monster.name),this.dormant=!this.dormant,this.monster.entities.forEach(n=>n.dormant=this.dormant),s.E.stateManager.after()}toggleAllied(){s.E.stateManager.before(this.monster.isAllied?"unsetAllied":"setAllied","data.monster."+this.monster.name),this.monster.isAllied=!this.monster.isAllied,s.E.stateManager.after()}openStatPopup(n){const i=new b.R(this.monster,n);this.dialog.open(lo,{panelClass:["fullscreen-panel"],disableClose:!0,data:{monster:i,forceStats:!0}})}openAbilities(){const n=new b.R(this.monster,this.monster.level);n.statEffect=this.monster.statEffect,s.E.monsterManager.resetMonsterAbilities(n),n.statEffect&&this.dialog.open(co,{panelClass:["dialog"],data:{monster:n,hideStats:!0,statEffectNote:n.statEffect.note}})}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-monster-stats-popup"]],standalone:!1,decls:16,vars:10,consts:[[1,"stats-dialog"],[1,"name"],[3,"ghs-label"],[1,"ally"],[1,"allied"],[1,"edition"],[1,"menu"],[1,"toggle-dormant",3,"click","ghs-label"],[1,"toggle-ally",3,"click","ghs-label"],[1,"toggle-allied",3,"click","ghs-label"],[1,"stat-effect",3,"ngClass"],[1,"stats-container"],[1,"stats"],[1,"title",3,"ghs-label"],[1,"stat-changes"],[3,"actions","relative","inline","statsCalculation"],[1,"immunities"],[1,"deck","text-white",3,"ghs-label","ghs-label-args"],[1,"deck","text-white",3,"ghs-label"],[1,"stat"],[1,"type"],[3,"src"],[3,"value-sign"],[1,"condition","immunity"],[1,"icon",3,"src"],[1,"deck","text-white",3,"click","ghs-label","ghs-label-args"],[3,"monster","forceStats","noClick"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"span",1),t.nrm(2,"span",2),t.nVh(3,k$,2,1,"span",3),t.nVh(4,y$,2,1,"span",4),t.nVh(5,x$,4,1,"span",5),t.k0s(),t.j41(6,"div",6)(7,"a",7),t.bIt("click",function(){return e.toggleDormant()}),t.k0s()(),t.j41(8,"div",6)(9,"a",8),t.bIt("click",function(){return e.toggleAlly()}),t.k0s(),t.j41(10,"a",9),t.bIt("click",function(){return e.toggleAllied()}),t.k0s()(),t.nVh(11,Y$,9,11,"div",10),t.j41(12,"div",11),t.Z7z(13,U$,2,3,"div",12,b$),t.nI1(15,"trackUUID"),t.k0s()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","data.monster."+e.monster.name),t.R7$(),t.vxM(e.monster.isAlly?3:-1),t.R7$(),t.vxM(e.monster.isAllied?4:-1),t.R7$(),t.vxM(e.edition?5:-1),t.R7$(2),t.Y8G("ghs-label","monster.toggleDormant."+(e.dormant?"off":"on")),t.R7$(2),t.Y8G("ghs-label","monster.toggleAlly."+(e.monster.isAlly?"off":"on")),t.R7$(),t.Y8G("ghs-label","monster.toggleAllied."+(e.monster.isAllied?"off":"on")),t.R7$(),t.vxM(e.monster.statEffect?11:-1),t.R7$(2),t.Dyx(t.bMT(15,8,e.monsters)))},styles:[".stats-dialog[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 46 * var(--ghs-dialog-factor));display:flex;flex-direction:column}.stats-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap;font-family:var(--ghs-font-title);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));text-align:center;width:100%}.stats-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;align-items:center}.stats-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-family:var(--ghs-font-text);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.stats-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ally[_ngcontent-%COMP%]{text-decoration:line-through}.stats-dialog[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;align-items:center;color:var(--ghs-color-white);z-index:2;overflow:auto;max-height:calc(var(--ghs-unit) * 20 * var(--ghs-dialog-factor))}.stats-dialog[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{position:sticky;top:0;font-size:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:2;text-align:center;width:100%;padding-bottom:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.stats-dialog[_ngcontent-%COMP%]   .stat-effect.fh[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.stats-dialog[_ngcontent-%COMP%]   .stat-effect.modern[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.stats-dialog[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]   .stat-changes[_ngcontent-%COMP%]{z-index:1;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;max-width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor))}.stats-dialog[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]   .stat-changes[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor)) 0}.stats-dialog[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]   .stat-changes[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:1.5em;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.stats-dialog[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]   .stat-changes[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1.2em;width:auto;filter:var(--ghs-filter-white)}.stats-dialog[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]{z-index:1;display:flex;flex-wrap:wrap;justify-content:center;align-items:center}.stats-dialog[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:1.5em;height:1.5em;margin:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor))}.stats-dialog[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.stats-dialog[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]{z-index:1;cursor:pointer;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));text-align:center}.stats-dialog[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]{position:relative;text-align:initial;display:flex;flex-direction:column;align-items:center;margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));max-height:calc(var(--ghs-unit) * 55 * var(--ghs-dialog-factor));overflow-y:auto;overflow-x:hidden}.stats-dialog[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{cursor:pointer;position:relative;width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor));height:auto;margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));z-index:1}.stats-dialog[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   ghs-monster-stats[_ngcontent-%COMP%]{display:block;position:relative;top:0;left:0;width:100%;height:100%;transform-origin:top left}"]})}return a})();const N$=["levelButton"],z$=(a,r,n,i,e)=>({boss:a,bb:r,fh:n,"no-click":i,denied:e}),L$=(a,r,n)=>({"is-ally":a,"is-allied":r,bb:n}),q$=a=>({catched:a}),H$=(a,r)=>({hidden:a,range:r}),tn=a=>({hidden:a}),go=(a,r)=>({hidden:a,bordered:r}),K$=a=>({boss:a}),W$=a=>({range:a});function Z$(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",23,1),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openLevelDialog())}),t.EFF(2),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ghs-label","game.level")("ghs-label-attribute","title"),t.R7$(2),t.SpI("",n.monster.level," ")}}function J$(a,r){1&a&&t.nrm(0,"div",4)}function Q$(a,r){1&a&&t.nrm(0,"div",5)}function tI(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1,"\xa0("),t.nrm(2,"span",8),t.EFF(3,")"),t.k0s()),2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","data.monster."+n.monster.name)}}function nI(a,r){1&a&&(t.j41(0,"span",9),t.EFF(1,"\xa0"),t.nrm(2,"span",8),t.k0s()),2&a&&(t.R7$(2),t.Y8G("ghs-label","%game.monsterType.elite%"))}function eI(a,r){1&a&&(t.j41(0,"span",10),t.EFF(1,"*"),t.k0s())}function aI(a,r){1&a&&(t.j41(0,"span",11),t.nrm(1,"span",8),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","game.ally"))}function iI(a,r){1&a&&(t.j41(0,"span",12),t.nrm(1,"span",8),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","game.allied"))}function oI(a,r){if(1&a&&(t.j41(0,"span",13),t.nrm(1,"img",17),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/action/fly.svg",t.B4B)}}function sI(a,r){if(1&a&&(t.j41(0,"span",14),t.EFF(1,"["),t.nrm(2,"span",8),t.EFF(3,"]"),t.k0s()),2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","data.edition."+n.edition)}}function rI(a,r){if(1&a&&(t.j41(0,"span",15),t.nrm(1,"img",24),t.k0s()),2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(1,q$,n.catched))}}function cI(a,r){if(1&a&&(t.j41(0,"span",28),t.nrm(1,"span",26),t.k0s(),t.j41(2,"span",27),t.nrm(3,"img",17),t.k0s()),2&a){const n=t.XpG(3);t.Y8G("ngClass",t.eq3(5,tn,n.hideStats)),t.R7$(),t.Y8G("value-calc",n.stats.range)("level",n.monster.level)("empty",!0),t.R7$(2),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/stats/range.svg",t.B4B)}}function lI(a,r){if(1&a&&(t.j41(0,"span",25),t.nrm(1,"span",26),t.k0s(),t.j41(2,"span",27),t.nrm(3,"img",17),t.k0s(),t.j41(4,"span",28),t.nrm(5,"span",26),t.k0s(),t.j41(6,"span",27),t.nrm(7,"img",17),t.k0s(),t.nVh(8,cI,4,7)),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(11,tn,n.hideStats)),t.R7$(),t.Y8G("value-calc",n.stats.movement)("level",n.monster.level)("empty",!0),t.R7$(2),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/stats/"+(n.flying?"fly":"move")+".svg",t.B4B),t.R7$(),t.Y8G("ngClass",t.l_i(13,go,n.hideStats,n.hideStats||n.stats.range)),t.R7$(),t.Y8G("value-calc",n.stats.attack)("level",n.monster.level)("empty",!0),t.R7$(2),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/stats/attack.svg",t.B4B),t.R7$(),t.vxM(n.hideStats||n.stats.range?8:-1)}}function gI(a,r){if(1&a&&(t.j41(0,"div",18)(1,"span",25),t.nrm(2,"span",26),t.k0s(),t.j41(3,"span",27),t.nrm(4,"img",17),t.k0s(),t.nVh(5,lI,9,16),t.k0s()),2&a){const n=t.XpG();t.Y8G("ngClass",t.l_i(7,H$,n.hideStats,n.hideStats||n.stats.range)),t.R7$(),t.Y8G("ngClass",t.eq3(10,tn,n.hideStats)),t.R7$(),t.Y8G("value-calc",n.stats.health)("level",n.monster.level)("empty",!0),t.R7$(2),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/stats/hp.svg",t.B4B),t.R7$(),t.vxM(n.monster.boss?5:-1)}}function dI(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-pointer-input",29),t.bIt("singleClick",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.openEntityMenu(e))}),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(1,K$,n.monster.boss))}}function hI(a,r){if(1&a&&(t.j41(0,"span",32),t.nrm(1,"span",26),t.k0s(),t.j41(2,"span",27),t.nrm(3,"img",17),t.k0s(),t.j41(4,"span",33),t.nrm(5,"span",26),t.k0s()),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(9,tn,n.hideStats)),t.R7$(),t.Y8G("value-calc",n.stats.range)("level",n.monster.level)("empty",!0),t.R7$(2),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/stats/range.svg",t.B4B),t.R7$(),t.Y8G("ngClass",t.eq3(11,tn,n.hideEliteStats)),t.R7$(),t.Y8G("value-calc",n.eliteStats.range)("level",n.monster.level)("empty",!0)}}function _I(a,r){if(1&a&&(t.j41(0,"div",20)(1,"span",30),t.nrm(2,"span",26),t.k0s(),t.j41(3,"span",27),t.nrm(4,"img",17),t.k0s(),t.j41(5,"span",31),t.nrm(6,"span",26),t.k0s(),t.j41(7,"span",30),t.nrm(8,"span",26),t.k0s(),t.j41(9,"span",27),t.nrm(10,"img",17),t.k0s(),t.j41(11,"span",31),t.nrm(12,"span",26),t.k0s(),t.j41(13,"span",32),t.nrm(14,"span",26),t.k0s(),t.j41(15,"span",27),t.nrm(16,"img",17),t.k0s(),t.j41(17,"span",33),t.nrm(18,"span",26),t.k0s(),t.nVh(19,hI,6,13),t.k0s()),2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(29,W$,n.hideStats&&n.hideEliteStats||n.stats.range||n.eliteStats.range)),t.R7$(),t.Y8G("ngClass",t.eq3(31,tn,n.hideStats)),t.R7$(),t.Y8G("value-calc",n.stats.health)("level",n.monster.level)("empty",!0),t.R7$(2),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/stats/hp.svg",t.B4B),t.R7$(),t.Y8G("ngClass",t.eq3(33,tn,n.hideEliteStats)),t.R7$(),t.Y8G("value-calc",n.eliteStats.health)("level",n.monster.level)("empty",!0),t.R7$(),t.Y8G("ngClass",t.eq3(35,tn,n.hideStats)),t.R7$(),t.Y8G("value-calc",n.stats.movement)("level",n.monster.level)("empty",!0),t.R7$(2),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/stats/"+(n.flying?"fly":"move")+".svg",t.B4B),t.R7$(),t.Y8G("ngClass",t.eq3(37,tn,n.hideEliteStats)),t.R7$(),t.Y8G("value-calc",n.eliteStats.movement)("level",n.monster.level)("empty",!0),t.R7$(),t.Y8G("ngClass",t.l_i(39,go,n.hideStats,n.hideStats&&n.hideStats||n.stats.range||n.eliteStats.range)),t.R7$(),t.Y8G("value-calc",n.stats.attack)("level",n.monster.level)("empty",!0),t.R7$(2),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/stats/attack.svg",t.B4B),t.R7$(),t.Y8G("ngClass",t.l_i(42,go,n.hideEliteStats,n.hideStats&&n.hideStats||n.stats.range||n.eliteStats.range)),t.R7$(),t.Y8G("value-calc",n.eliteStats.attack)("level",n.monster.level)("empty",!0),t.R7$(),t.vxM(n.hideStats&&n.hideEliteStats||n.stats.range||n.eliteStats.range?19:-1)}}function mI(a,r){if(1&a&&(t.j41(0,"div",38)(1,"span",45),t.EFF(2),t.k0s(),t.nrm(3,"ghs-actions",46),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.R7$(2),t.SpI("",i+1,":"),t.R7$(),t.Y8G("actions",n)("inline",!0)("statsCalculation",e.settingsManager.settings.calculate)("right",!0)("hexSize",.5)("monster",e.monsterCopy)("monsterType",e.MonsterType.normal)}}function pI(a,r){if(1&a&&(t.j41(0,"span",40),t.nrm(1,"img",47),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(),t.Y8G("src","./assets/images"+(i.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+n+".svg",t.B4B)}}function uI(a,r){if(1&a&&(t.j41(0,"div",38)(1,"span",45),t.EFF(2),t.k0s(),t.nrm(3,"ghs-actions",48),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.R7$(2),t.SpI("",i+1,":"),t.R7$(),t.Y8G("actions",n)("inline",!0)("statsCalculation",e.settingsManager.settings.calculate)("hexSize",.5)("monster",e.monsterCopy)("monsterType",e.MonsterType.elite)}}function fI(a,r){if(1&a&&(t.j41(0,"span",40),t.nrm(1,"img",47),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(),t.Y8G("src","./assets/images"+(i.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+n+".svg",t.B4B)}}function CI(a,r){if(1&a&&(t.j41(0,"div",34),t.nrm(1,"div",35),t.j41(2,"div",36),t.nrm(3,"ghs-actions",37),t.k0s(),t.Z7z(4,mI,4,8,"div",38,t.Vm6),t.k0s(),t.j41(6,"div",39),t.Z7z(7,pI,2,1,"span",40,t.fX1),t.k0s(),t.j41(9,"div",41),t.nrm(10,"div",42),t.j41(11,"div",36),t.nrm(12,"ghs-actions",43),t.k0s(),t.Z7z(13,uI,4,7,"div",38,t.Vm6),t.k0s(),t.j41(15,"div",44),t.Z7z(16,fI,2,1,"span",40,t.fX1),t.k0s()),2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(21,tn,n.hideStats)),t.R7$(),t.Y8G("ghs-label",n.stats.note),t.R7$(2),t.Y8G("actions",n.stats.actions)("inline",!0)("statsCalculation",n.settingsManager.settings.calculate)("right",!0)("hexSize",.5)("highlightActions",n.highlightActions)("monster",n.monsterCopy)("monsterType",n.MonsterType.normal),t.R7$(),t.Dyx(n.stats.special),t.R7$(2),t.Y8G("ngClass",t.eq3(23,tn,n.hideStats)),t.R7$(),t.Dyx(n.stats.immunities),t.R7$(2),t.Y8G("ngClass",t.eq3(25,tn,n.hideEliteStats)),t.R7$(),t.Y8G("ghs-label",n.eliteStats.note),t.R7$(2),t.Y8G("actions",n.eliteStats.actions)("inline",!0)("statsCalculation",n.settingsManager.settings.calculate)("hexSize",.5)("highlightActions",n.highlightActions)("monster",n.monsterCopy)("monsterType",n.MonsterType.elite),t.R7$(),t.Dyx(n.eliteStats.special),t.R7$(2),t.Y8G("ngClass",t.eq3(27,tn,n.hideEliteStats)),t.R7$(),t.Dyx(n.eliteStats.immunities)}}function MI(a,r){if(1&a&&(t.j41(0,"div",38)(1,"span",45),t.EFF(2),t.k0s(),t.nrm(3,"ghs-actions",48),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.R7$(2),t.SpI("",i+1,":"),t.R7$(),t.Y8G("actions",n)("inline",!0)("statsCalculation",e.settingsManager.settings.calculate)("hexSize",.5)("monster",e.monsterCopy)("monsterType",e.MonsterType.boss)}}function vI(a,r){if(1&a&&(t.j41(0,"div",21),t.nrm(1,"div",42),t.j41(2,"div",36),t.nrm(3,"ghs-actions",43),t.k0s(),t.Z7z(4,MI,4,7,"div",38,t.Vm6),t.k0s()),2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(9,tn,n.hideStats)),t.R7$(),t.Y8G("ghs-label",n.stats.note),t.R7$(2),t.Y8G("actions",n.stats.actions)("inline",!0)("statsCalculation",n.settingsManager.settings.calculate)("hexSize",.5)("highlightActions",n.highlightActions)("monster",n.monsterCopy)("monsterType",n.MonsterType.boss),t.R7$(),t.Dyx(n.stats.special)}}function OI(a,r){if(1&a&&(t.j41(0,"span",40),t.nrm(1,"img",47),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(),t.Y8G("src","./assets/images"+(i.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+n+".svg",t.B4B)}}function PI(a,r){if(1&a&&(t.j41(0,"div",22),t.Z7z(1,OI,2,1,"span",40,t.fX1),t.k0s()),2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(1,tn,n.hideStats)),t.R7$(),t.Dyx(n.stats.immunities)}}let Te=(()=>{class a{dialog;overlay;element;ghsManager;monster;forceStats=!1;relative=!1;noClick=!1;disablePoup=!1;MonsterType=S.N;gameManager=s.E;settingsManager=p.f;stats=new Kt.f(S.N.normal);hideStats=!1;eliteStats=new Kt.f(S.N.elite);hideEliteStats=!1;statOverview=!1;highlightActions=[];edition="";catching=!1;catched=!1;flying=!1;monsterCopy;levelButton;constructor(n,i,e,o){this.dialog=n,this.overlay=i,this.element=e,this.ghsManager=o}ngOnInit(){this.monsterCopy=JSON.parse(JSON.stringify(this.monster)),this.update(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.highlightActions=p.f.settings.statAnimations?[$.X2.shield,$.X2.retaliate,$.X2.custom]:[],this.edition=s.E.getEdition(this.monster),this.catching=null!=this.monster.pet&&s.E.buildingsManager.petsAvailable,this.catched=this.catching&&s.E.buildingsManager.petsEnabled&&null!=s.E.game.party.pets.find(n=>n.edition==this.monster.edition&&n.name==this.monster.pet),this.setStats(),this.flying=this.monster.flying&&(!this.monster.statEffect||"disabled"!=this.monster.statEffect.flying)||null!=this.monster.statEffect&&1==this.monster.statEffect.flying}setStats(){if(this.monster.boss)this.stats=s.E.monsterManager.getStat(this.monster,S.N.boss),this.hideStats=!this.forceStats&&p.f.settings.hideStats&&this.monster.entities.every(n=>n.dead||n.type!=S.N.boss);else{const n=this.monster.bb&&this.monster.tags.includes("bb-elite")?S.N.elite:S.N.normal;this.stats=s.E.monsterManager.getStat(this.monster,n),this.hideStats=!this.forceStats&&p.f.settings.hideStats&&this.monster.entities.every(i=>i.dead||i.type!=n),this.monster.bb||(this.eliteStats=s.E.monsterManager.getStat(this.monster,S.N.elite),this.hideEliteStats=!this.forceStats&&p.f.settings.hideStats&&this.monster.entities.every(i=>i.dead||i.type!=S.N.elite))}}statsForType(n){return s.E.monsterManager.getStat(this.monster,n)}setLevel(n){n!=this.monster.level&&(s.E.stateManager.before("setLevel","data.monster."+this.monster.name,n),s.E.monsterManager.setLevel(this.monster,n),s.E.monsterManager.setLevel(this.monsterCopy,n),this.setStats(),s.E.stateManager.after())}openLevelDialog(){this.dialog.open(C$,{panelClass:["dialog"],data:this.monster,positionStrategy:this.overlay.position().flexibleConnectedTo(this.levelButton).withPositions((0,F.yE)())}).closed.subscribe({next:i=>{"number"==typeof i&&this.setLevel(i)}})}openStatsPopup(){this.noClick||this.monster.bb?this.disablePoup||this.openStatPopup():this.dialog.open(Fr,{panelClass:["dialog"],data:this.monster})}openStatPopup(){!this.noClick&&!this.disablePoup&&this.dialog.open(lo,{panelClass:["fullscreen-panel"],disableClose:!0,data:{monster:this.monster,forceStats:this.forceStats}})}openEntityMenu(n){this.noClick||this.dialog.open(ze,{panelClass:["dialog"],data:{entity:void 0,figure:this.monster},positionStrategy:this.overlay.position().flexibleConnectedTo(this.element).withPositions((0,F.yE)())})}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG),t.rXU(qt.hJ),t.rXU(t.aKT),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-monster-stats"]],viewQuery:function(i,e){if(1&i&&t.GBs(N$,5,t.aKT),2&i){let o;t.mGM(o=t.lsd())&&(e.levelButton=o.first)}},inputs:{monster:"monster",forceStats:"forceStats",relative:"relative",noClick:"noClick",disablePoup:"disablePoup"},standalone:!1,decls:24,vars:33,consts:[["card",""],["levelButton",""],[1,"stats-container",3,"ngClass"],[1,"level",3,"ghs-label","ghs-label-attribute"],[1,"filter-stats","normal"],[1,"filter-stats","elite"],["ghs-pointer-input","",1,"name-container",3,"singleClick","doubleClick"],[1,"name"],[3,"ghs-label"],[1,"elite"],[1,"stat-effect"],[1,"ally"],[1,"allied"],[1,"flying"],[1,"edition"],[1,"catching",3,"ngClass"],[1,"toggle-ally",3,"ngClass"],[3,"src"],[1,"stats","boss",3,"ngClass"],[1,"entity-menu",3,"ngClass"],[1,"stats",3,"ngClass"],[1,"extra","boss",3,"ngClass"],[1,"immunities","boss",3,"ngClass"],[1,"level",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/fh/catching.svg",1,"ghs-svg"],[1,"stat","boss","bordered",3,"ngClass"],[1,"value",3,"value-calc","level","empty"],[1,"stat-icon"],[1,"stat","boss",3,"ngClass"],[1,"entity-menu",3,"singleClick","ngClass"],[1,"stat","normal","bordered",3,"ngClass"],[1,"stat","elite","bordered",3,"ngClass"],[1,"stat","normal",3,"ngClass"],[1,"stat","elite",3,"ngClass"],[1,"extra","normal",3,"ngClass"],[1,"notes",3,"ghs-label"],[1,"additional"],[3,"actions","inline","statsCalculation","right","hexSize","highlightActions","monster","monsterType"],[1,"specials"],[1,"immunities","normal",3,"ngClass"],[1,"immunity"],[1,"extra","elite",3,"ngClass"],[1,"notes","text-white",3,"ghs-label"],[3,"actions","inline","statsCalculation","hexSize","highlightActions","monster","monsterType"],[1,"immunities","elite",3,"ngClass"],[1,"special"],[3,"actions","inline","statsCalculation","right","hexSize","monster","monsterType"],[1,"icon",3,"src"],[3,"actions","inline","statsCalculation","hexSize","monster","monsterType"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",2,0),t.nVh(2,Z$,3,3,"div",3),t.nVh(3,J$,1,0,"div",4),t.nVh(4,Q$,1,0,"div",5),t.j41(5,"div",6),t.bIt("singleClick",function(){return c.eBV(o),c.Njj(e.openStatsPopup())})("doubleClick",function(){return c.eBV(o),c.Njj(e.openStatPopup())}),t.j41(6,"span",7),t.nrm(7,"span",8),t.nVh(8,tI,4,1,"span"),t.nVh(9,nI,3,1,"span",9),t.nVh(10,eI,2,0,"span",10),t.nVh(11,aI,2,1,"span",11),t.nVh(12,iI,2,1,"span",12),t.k0s(),t.nVh(13,oI,2,1,"span",13),t.nVh(14,sI,4,1,"span",14),t.nVh(15,rI,2,3,"span",15),t.k0s(),t.j41(16,"span",16),t.nrm(17,"img",17),t.k0s(),t.nVh(18,gI,6,12,"div",18),t.nVh(19,dI,1,3,"ghs-pointer-input",19),t.nVh(20,_I,20,45,"div",20),t.nVh(21,CI,18,29),t.nVh(22,vI,6,11,"div",21),t.nVh(23,PI,3,3,"div",22),t.k0s()}if(2&i){const o=t.sdS(1);t.xc7("font-size",.03*o.offsetWidth+"px"),t.Y8G("ngClass",t.s1E(23,z$,e.monster.boss,e.monster.bb,e.settingsManager.settings.fhStyle,e.noClick,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.monsterPermissions[e.monster.name+"|"+e.monster.edition])),t.R7$(2),t.vxM(e.monster.bb?-1:2),t.R7$(),t.vxM(!e.settingsManager.settings.standees&&e.hideStats?3:-1),t.R7$(),t.vxM(!e.settingsManager.settings.standees&&e.hideEliteStats?4:-1),t.R7$(3),t.Y8G("ghs-label","data.monster."+(e.monster.statEffect&&e.monster.statEffect.name?e.monster.statEffect.name:e.monster.name)),t.R7$(),t.vxM(e.monster.statEffect&&e.monster.statEffect.name?8:-1),t.R7$(),t.vxM(e.monster.tags.includes("bb-elite")?9:-1),t.R7$(),t.vxM(e.monster.statEffect?10:-1),t.R7$(),t.vxM(e.monster.isAlly?11:-1),t.R7$(),t.vxM(e.monster.isAllied?12:-1),t.R7$(),t.vxM(e.flying?13:-1),t.R7$(),t.vxM(e.edition?14:-1),t.R7$(),t.vxM(e.catching?15:-1),t.R7$(),t.Y8G("ngClass",t.sMw(29,L$,e.monster.isAlly,e.monster.isAllied,e.monster.bb)),t.R7$(),t.Y8G("src",e.monster.bb?"./assets/images/bb/monster.svg":"./assets/images/monster/enemy.png",t.B4B),t.R7$(),t.vxM(e.monster.boss||e.monster.bb?18:-1),t.R7$(),t.vxM(!e.settingsManager.settings.standees&&e.gameManager.gameplayFigure(e.monster)?19:-1),t.R7$(),t.vxM(e.monster.boss||e.monster.bb?-1:20),t.R7$(),t.vxM(e.monster.boss||e.monster.bb?-1:21),t.R7$(),t.vxM(e.monster.boss||e.monster.bb?22:-1),t.R7$(),t.vxM(e.monster.boss||e.monster.bb?23:-1)}},dependencies:[N.YU,ve,it,dt,nn],styles:['.stats-container[_ngcontent-%COMP%]{width:100%;height:100%;position:relative;display:flex;border-radius:1em}.stats-container[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:opacity calc(var(--ghs-animation-speed) * 1s) ease-in-out}.stats-container[_ngcontent-%COMP%]   .hidden[_ngcontent-%COMP%]{opacity:0}.stats-container[_ngcontent-%COMP%]:before{content:" ";position:absolute;width:100%;height:100%;background-image:url(standard.826804da11e7fa51.png);background-position:top;background-size:100% auto;background-repeat:no-repeat;border-radius:1em;z-index:0}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]{position:absolute;top:.4em;right:1.8em;width:11.3em;display:flex;font-family:var(--ghs-font-title);color:var(--ghs-color-white);font-size:2.1em;filter:drop-shadow(.1em .1em .1em var(--ghs-color-black));text-align:left;white-space:nowrap;overflow-x:auto;overflow-y:hidden;z-index:4}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{display:flex;align-items:center}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]{margin-left:.1em}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]   .flying[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:auto;margin-left:.3em}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]   .flying[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]   .catching[_ngcontent-%COMP%]{position:absolute;right:1em;top:50%;width:1.2em;height:auto;filter:var(--ghs-filter-white);transform:translateY(-50%)}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]   .catching.catched[_ngcontent-%COMP%]{filter:var(--ghs-filter-green) brightness(.7)}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]{display:flex;justify-content:center;width:calc(var(--ghs-unit) * 2);height:calc(var(--ghs-unit) * 2);position:relative;top:calc(var(--ghs-unit) * -.6);left:calc(var(--ghs-unit) * -.3);font-family:var(--ghs-font-gh-title);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 4.5);line-height:calc(var(--ghs-unit) * 4);background-color:var(--ghs-color-darkgray);border:2px solid var(--ghs-color-gray);border-radius:100%}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]:hover{cursor:pointer;color:var(--ghs-color-gray)}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]:hover   .flying[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]:hover   .catching[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]:hover   .catching.catched[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]:hover   .stat-effect[_ngcontent-%COMP%]{filter:brightness(.4)}.stats-container[_ngcontent-%COMP%]   .entity-menu[_ngcontent-%COMP%]{position:absolute;inset:0 38%;z-index:3}.stats-container[_ngcontent-%COMP%]   .entity-menu.boss[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .entity-menu.bb[_ngcontent-%COMP%]{left:25%;right:55%}.stats-container[_ngcontent-%COMP%]   .toggle-ally[_ngcontent-%COMP%]{position:absolute;top:.2em;right:.8em;height:3.4em;width:2.4em;cursor:pointer;display:flex;justify-content:center;align-items:center;z-index:4}.stats-container[_ngcontent-%COMP%]   .toggle-ally[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.stats-container[_ngcontent-%COMP%]   .toggle-ally.is-ally[_ngcontent-%COMP%]:after{content:" ";position:absolute;inset:.5em .1em;background-color:var(--ghs-color-red);clip-path:polygon(10% 0,0 10%,40% 50%,0 90%,10% 100%,50% 60%,90% 100%,100% 90%,60% 50%,100% 10%,90% 0,50% 40%)}.stats-container[_ngcontent-%COMP%]   .toggle-ally.bb[_ngcontent-%COMP%]{top:.1em;left:1em;right:initial}.stats-container[_ngcontent-%COMP%]   .toggle-ally.bb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow) brightness(.8)}.stats-container[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{position:absolute;top:.2em;left:.7em;font-family:var(--ghs-font-gh-title);font-size:3em;text-shadow:var(--ghs-outline);color:var(--ghs-color-gray);cursor:pointer;z-index:4}.stats-container[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover, .stats-container[_ngcontent-%COMP%]   .level.active-button[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{position:absolute;top:4.8em;left:16.5em;width:calc(8.4em * var(--ghs-fontsize));height:11.4em;display:grid;grid-template-columns:50% 0 50%;grid-template-rows:repeat(3,33%);filter:drop-shadow(.01em .01em .01em var(--ghs-color-black));z-index:1;transform:translate(-50%)}.stats-container[_ngcontent-%COMP%]   .stats.boss[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .stats.bb[_ngcontent-%COMP%]{top:5.2em;left:9.6em;grid-template-columns:8em 0}.stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{position:relative;font-size:2.4em;line-height:1.7em;padding-top:0;width:100%;display:flex}.stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:calc(1em * var(--ghs-fontsize));display:block;width:100%;white-space:nowrap;overflow-x:auto;overflow-y:hidden}.stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.normal[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.boss[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.bb[_ngcontent-%COMP%]{justify-self:end;justify-content:flex-end;filter:drop-shadow(.01em .01em .01em var(--ghs-color-white));padding-right:.8em}.stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.normal[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.boss[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.bb[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{text-align:right}.stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.normal.bordered[_ngcontent-%COMP%]:before, .stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.boss.bordered[_ngcontent-%COMP%]:before, .stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.bb.bordered[_ngcontent-%COMP%]:before{content:" ";position:absolute;bottom:0;right:0;height:1px;width:calc(100% / var(--ghs-fontsize));background:linear-gradient(to right,transparent,var(--ghs-color-darkred))}.stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.elite[_ngcontent-%COMP%]{justify-self:start;color:var(--ghs-color-white);filter:drop-shadow(.01em .01em .01em var(--ghs-color-black));padding-left:.8em}.stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.elite.bordered[_ngcontent-%COMP%]:before{content:" ";position:absolute;bottom:0;left:0;height:1px;width:calc(100% / var(--ghs-fontsize));background:linear-gradient(to right,var(--ghs-color-white),transparent)}.stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{position:relative;justify-self:center;align-self:center;width:2.5em;height:2.5em;display:flex;justify-content:center;align-items:center;z-index:1}.stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:50%;left:50%;width:2em;height:2em;background-color:var(--ghs-color-darkgray);border:.25em solid var(--ghs-color-white);z-index:1;transform:translate(-50%,-50%) rotate(45deg);filter:var(--ghs-filter-outline-thin)}.stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white);height:1.4em;width:auto;z-index:2}.stats-container[_ngcontent-%COMP%]   .stats.range[_ngcontent-%COMP%]{grid-template-rows:repeat(4,25%)}.stats-container[_ngcontent-%COMP%]   .stats.range.boss[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .stats.range.bb[_ngcontent-%COMP%]{top:29%}.stats-container[_ngcontent-%COMP%]   .stats.range[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{line-height:1.3em}.stats-container[_ngcontent-%COMP%]   .stats.range[_ngcontent-%COMP%]   .stat.normal[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .stats.range[_ngcontent-%COMP%]   .stat.boss[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .stats.range[_ngcontent-%COMP%]   .stat.bb[_ngcontent-%COMP%]{padding-right:.7em}.stats-container[_ngcontent-%COMP%]   .stats.range[_ngcontent-%COMP%]   .stat.elite[_ngcontent-%COMP%]{padding-left:.6em}.stats-container[_ngcontent-%COMP%]   .stats.range[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]:before{width:1.4em;height:1.4em}.stats-container[_ngcontent-%COMP%]   .stats.range[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em}.stats-container.boss[_ngcontent-%COMP%]:before{background-image:url(boss.b5e82e30b65c018f.png)}.stats-container.bb[_ngcontent-%COMP%]:before{background-image:url(bb-standard.fc2741f757bfac9f.png)}.stats-container[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]{position:relative;margin-top:3em;padding-bottom:.4em;width:7em;display:flex;flex-direction:column;font-size:1.6em;min-height:8.2em;z-index:2;overflow:auto}.stats-container[_ngcontent-%COMP%]   .extra.normal[_ngcontent-%COMP%]{left:.5em;text-align:right}.stats-container[_ngcontent-%COMP%]   .extra.normal[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{justify-content:end}.stats-container[_ngcontent-%COMP%]   .extra.normal[_ngcontent-%COMP%]   .placeholder[_ngcontent-%COMP%]{filter:drop-shadow(.01em .01em .01em var(--ghs-color-gray))}.stats-container[_ngcontent-%COMP%]   .extra.elite[_ngcontent-%COMP%]{left:6.2em;color:var(--ghs-color-white)}.stats-container[_ngcontent-%COMP%]   .extra.boss[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .extra.bb[_ngcontent-%COMP%]{width:10.7em;height:auto;left:10em;color:var(--ghs-color-white)}.stats-container[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]{margin-top:2.3%;line-height:.8em;filter:drop-shadow(.01em .01em .01em var(--ghs-color-black))}.stats-container[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .additional[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .specials[_ngcontent-%COMP%]{display:flex;align-items:baseline;font-size:calc(1em * var(--ghs-fontsize))}.stats-container[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .additional[_ngcontent-%COMP%]   ghs-actions[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .specials[_ngcontent-%COMP%]   ghs-actions[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.stats-container[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .additional[_ngcontent-%COMP%]   ghs-actions[_ngcontent-%COMP%]:first-child, .stats-container[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .specials[_ngcontent-%COMP%]   ghs-actions[_ngcontent-%COMP%]:first-child{margin-top:2.3%}.stats-container[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .additional.specials[_ngcontent-%COMP%]   .special[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .specials.specials[_ngcontent-%COMP%]   .special[_ngcontent-%COMP%]{margin-right:.5%}.stats-container[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]{position:absolute;top:calc(7.85em - 2.25em * var(--ghs-fontsize));left:calc(2.525em - 1.125em * var(--ghs-fontsize));display:grid;justify-items:center;align-items:center;grid-template-columns:repeat(5,calc(2.25em * var(--ghs-fontsize)));grid-template-rows:repeat(8,calc(1.125em * var(--ghs-fontsize)));column-gap:calc(.4em * var(--ghs-fontsize));row-gap:calc(.2em * var(--ghs-fontsize));z-index:0}.stats-container[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]{position:relative;display:block;width:calc(2.25em * var(--ghs-fontsize));height:calc(2.25em * var(--ghs-fontsize))}.stats-container[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;width:100%;z-index:1}.stats-container[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(odd){grid-column:1/3}.stats-container[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(2n){grid-column:1}.stats-container[_ngcontent-%COMP%]   .immunities.elite[_ngcontent-%COMP%]{left:initial;right:1.4em}.stats-container[_ngcontent-%COMP%]   .immunities.elite[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(odd){grid-column:4/6}.stats-container[_ngcontent-%COMP%]   .immunities.elite[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(2n){grid-column:5}.stats-container[_ngcontent-%COMP%]   .immunities.boss[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .immunities.bb[_ngcontent-%COMP%]{z-index:1}.stats-container.no-click[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%], .stats-container.no-click[_ngcontent-%COMP%]   .toggle-ally[_ngcontent-%COMP%]{pointer-events:none}.stats-container.no-click[_ngcontent-%COMP%]   .entity-menu[_ngcontent-%COMP%]{display:none}.stats-container[_ngcontent-%COMP%]   .filter-stats[_ngcontent-%COMP%]{display:none;position:absolute;inset:0;background-color:var(--ghs-color-darkgray);opacity:.4;z-index:3}.stats-container[_ngcontent-%COMP%]   .filter-stats.normal[_ngcontent-%COMP%]{right:50%}.stats-container[_ngcontent-%COMP%]   .filter-stats.elite[_ngcontent-%COMP%]{left:50%;right:0}.stats-editor[_nghost-%COMP%]   .extra[_ngcontent-%COMP%], .stats-editor[_nghost-%COMP%]   .name-container[_ngcontent-%COMP%]{display:none!important}']})}return a})();const bI=a=>({detailed:a}),kI=a=>({checked:a}),Xr=(a,r)=>r._trackUUID;function yI(a,r){1&a&&(t.j41(0,"span",1)(1,"span"),t.nrm(2,"span",8),t.k0s()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","scenario.setup"))}function xI(a,r){if(1&a){const n=t.RV6();t.j41(0,"label",3)(1,"input",9),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.detailed,e)||(o.detailed=e),c.Njj(e)}),t.k0s(),t.nrm(2,"span",8),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.R50("ngModel",n.detailed),t.R7$(),t.Y8G("ghs-label","scenario.setup.detailed")}}function EI(a,r){if(1&a){const n=t.RV6();t.j41(0,"label",3)(1,"input",10),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.spoiler,e)||(o.spoiler=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.updateMonster())}),t.k0s(),t.nrm(2,"span",8),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.R50("ngModel",n.spoiler),t.R7$(),t.Y8G("ghs-label","scenario.setup.spoiler")}}function wI(a,r){1&a&&t.nrm(0,"span",13)}function RI(a,r){if(1&a&&t.nrm(0,"span",14),2&a){const n=t.XpG(3);t.Y8G("ngClass",t.eq3(1,kI,n.lootRandomItem))}}function jI(a,r){if(1&a&&(t.j41(0,"div",12),t.nVh(1,wI,1,0,"span",13),t.nVh(2,RI,1,3,"span",14),t.nrm(3,"img",15),t.j41(4,"span",16),t.EFF(5,"x"),t.k0s(),t.EFF(6),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.vxM("random_item"!=n.type?1:-1),t.R7$(),t.vxM("random_item"==n.type?2:-1),t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+n.type+".svg",t.B4B),t.R7$(3),t.SpI("",n.value," ")}}function GI(a,r){if(1&a&&(t.j41(0,"div",5),t.nrm(1,"div",11),t.Z7z(2,jI,7,4,"div",12,Xr),t.nI1(4,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","game.loot"),t.R7$(),t.Dyx(t.bMT(4,1,n.lootConfig))}}function TI(a,r){if(1&a&&t.nrm(0,"img",22),2&a){const n=t.XpG().$implicit,i=t.XpG();t.Y8G("src",i.gameManager.monsterManager.monsterThumbnail(n),t.B4B)}}function SI(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.JRh(n[0])}}function DI(a,r){if(1&a&&(t.j41(0,"span",23),t.Z7z(1,SI,2,1,"span",null,t.fX1),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(),t.Dyx(i.settingsManager.getLabel("data.monster."+n.name).split(" "))}}function $I(a,r){1&a&&(t.j41(0,"span",24),t.nrm(1,"img",28),t.k0s())}function II(a,r){1&a&&(t.j41(0,"span",25),t.EFF(1,"*"),t.k0s())}function AI(a,r){if(1&a&&t.nrm(0,"ghs-monster-stats",27),2&a){const n=t.XpG().$implicit;t.Y8G("monster",n)("forceStats",!0)("noClick",!0)("disablePoup",!0)}}function VI(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",17),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.openStats(e))}),t.j41(1,"div",18)(2,"div",19)(3,"div",20)(4,"div",21),t.nVh(5,TI,1,1,"img",22),t.nVh(6,DI,3,0,"span",23),t.k0s()()(),t.nVh(7,$I,2,0,"span",24),t.nVh(8,II,2,0,"span",25),t.k0s(),t.j41(9,"div",26),t.nrm(10,"span",8),t.k0s(),t.nVh(11,AI,1,4,"ghs-monster-stats",27),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.R7$(5),t.vxM(!n.noThumbnail&&i.settingsManager.settings.artwork?5:-1),t.R7$(),t.vxM(n.noThumbnail||!i.settingsManager.settings.artwork?6:-1),t.R7$(),t.vxM(n.boss||n.tags.includes("boss")?7:-1),t.R7$(),t.vxM(n.standeeShare||n.statEffect?8:-1),t.R7$(2),t.Y8G("ghs-label","data.monster."+n.name),t.R7$(),t.vxM(i.detailed?11:-1)}}let Br=(()=>{class a{dialog;scenario;spoiler=!1;title=!0;details=!0;gameManager=s.E;settingsManager=p.f;monsters=[];lootConfig=[];lootRandomItem=!1;hasSpoiler=!1;detailed=!1;constructor(n){this.dialog=n}ngOnInit(){if(this.updateMonster(),this.scenario.lootDeckConfig)for(let n in rt.r6){const i=n;this.scenario.lootDeckConfig[i]&&(this.lootConfig.push({type:i,value:this.scenario.lootDeckConfig[i]||0}),i==rt.r6.random_item&&s.E.game.party.randomItemLooted.find(e=>e.edition==this.scenario.edition&&e.group==this.scenario.group&&e.index==this.scenario.index)&&(this.lootRandomItem=!0))}}updateMonster(){this.monsters=[];const n=s.E.editionRules("cs"),i=!s.E.editionRules("fc")||this.spoiler;this.hasSpoiler=!1,!i&&s.E.scenarioManager.getMonsters(this.scenario,!1,this.scenario.custom).length!=s.E.scenarioManager.getMonsters(this.scenario,!0,this.scenario.custom).length&&(this.hasSpoiler=!0),s.E.scenarioManager.getMonsters(this.scenario,i,this.scenario.custom).forEach(e=>{let o=new b.R(e,s.E.game.level);if(this.spoiler||!o.standeeShare||s.E.scenarioManager.openRooms().find(k=>k.initial&&k.monster.find(X=>X.name.split(":")[0]==o.name))||s.E.game.figures.some(k=>k instanceof b.R&&k.name==o.name&&k.edition==o.edition))this.monsters.find(k=>k.edition==o.edition&&k.name==o.name)||(o.tags=[],this.monsters.push(o));else{const k=s.E.monstersData().find(X=>X.name==o.standeeShare&&X.edition==(o.standeeShareEdition||o.edition));if(k){const X=new b.R(JSON.parse(JSON.stringify(k)));X.tags=X.tags||[],n&&o.boss&&X.tags.push("boss");const at=this.monsters.find(tt=>tt.name==X.name&&tt.edition==X.edition);at?!this.spoiler&&n&&(at.tags=at.tags||[],o.boss&&(this.hasSpoiler=!0,at.tags.push("boss"))):(this.hasSpoiler=!0,this.monsters.push(X))}}let g=this.scenario.rules?this.scenario.rules.filter(k=>k.statEffects).flatMap(k=>k.statEffects):[],m=g.find(k=>s.E.figuresByIdentifier(k.identifier,!1,[o]).length);m||s.E.scenarioManager.getSections(this.scenario).forEach(k=>{!m&&k.rules&&(g=k.rules.filter(X=>X.statEffects).flatMap(X=>X.statEffects),m=g.find(X=>s.E.figuresByIdentifier(X.identifier,!1,[o]).length))}),m&&(this.hasSpoiler=!0,this.spoiler&&(o.statEffect=m.statEffect,o.statEffect.note=m.note))}),this.monsters=this.monsters.filter((e,o,g)=>!g.find(m=>e.standeeShare==m.edition&&e.standeeShareEdition==m.name)).sort((e,o)=>p.f.getLabel("data.monster."+e.name).toLowerCase()<p.f.getLabel("data.monster."+o.name).toLowerCase()?-1:1)}openStats(n){this.dialog.open(co,{panelClass:["dialog"],data:{monster:n,statEffectNote:n.statEffect?n.statEffect.note:""}})}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-scenario-setup"]],inputs:{scenario:"scenario",spoiler:"spoiler",title:"title",details:"details"},standalone:!1,decls:11,vars:9,consts:[[1,"setup"],[1,"title"],[1,"setup-container"],[1,"checkbox"],[1,"setup-container",3,"ngClass"],[1,"loot-config"],[1,"monsters"],["tabclick","",1,"monster"],[3,"ghs-label"],["tabclick","","type","checkbox",3,"ngModelChange","ngModel"],["tabclick","","type","checkbox",3,"ngModelChange","change","ngModel"],[1,"title",3,"ghs-label"],[1,"loot"],[1,"spacer"],["tabclick","",1,"checkbox",3,"ngClass"],[1,"ghs-svg",3,"src"],[1,"sign"],["tabclick","",1,"monster",3,"click"],[1,"image"],[1,"outer-border"],[1,"inner-border"],[1,"image-container"],[3,"src"],[1,"letter"],[1,"boss"],[1,"custom"],[1,"name"],[3,"monster","forceStats","noClick","disablePoup"],["src","./assets/images/monster/enemy.png"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nVh(1,yI,3,1,"span",1),t.j41(2,"div",2),t.nVh(3,xI,3,2,"label",3),t.nVh(4,EI,3,2,"label",3),t.k0s(),t.j41(5,"div",4),t.nVh(6,GI,5,3,"div",5),t.j41(7,"div",6),t.Z7z(8,VI,12,6,"div",7,Xr),t.nI1(10,"trackUUID"),t.k0s()()()),2&i&&(t.R7$(),t.vxM(e.title?1:-1),t.R7$(2),t.vxM(e.details?3:-1),t.R7$(),t.vxM(e.hasSpoiler||e.spoiler?4:-1),t.R7$(),t.Y8G("ngClass",t.eq3(7,bI,e.detailed)),t.R7$(),t.vxM(e.lootConfig.length>0?6:-1),t.R7$(2),t.Dyx(t.bMT(10,5,e.monsters)))},dependencies:[N.YU,E.Zm,E.BC,E.vS,it,Te,Ft,ct],styles:['.setup[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;color:var(--ghs-color-white);margin-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.setup[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;text-align:center;color:var(--ghs-color-gray);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor))}.setup[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{cursor:pointer;display:flex;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.setup[_ngcontent-%COMP%]   .loot-config[_ngcontent-%COMP%]{display:flex;flex-direction:column;background-color:var(--ghs-color-gray);margin-right:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));border-top-left-radius:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));border-top-right-radius:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));border-bottom-left-radius:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));border-bottom-right-radius:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));padding-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.setup[_ngcontent-%COMP%]   .loot-config[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;justify-content:center;color:var(--ghs-color-white);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));background-color:var(--ghs-color-darkgray);padding:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));border-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor)) solid var(--ghs-color-black);border-top-left-radius:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));border-top-right-radius:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.setup[_ngcontent-%COMP%]   .loot-config[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--ghs-color-black);font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor))}.setup[_ngcontent-%COMP%]   .loot-config[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{cursor:initial;display:inline-block;position:relative;width:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));color:var(--ghs-color-black);border:calc(var(--ghs-unit) * .4 * var(--ghs-text-factor)) solid var(--ghs-color-black);background-color:var(--ghs-color-white);margin:0;margin-top:calc(var(--ghs-unit) * .2 * var(--ghs-text-factor));margin-right:calc(var(--ghs-unit) * -.2 * var(--ghs-text-factor))}.setup[_ngcontent-%COMP%]   .loot-config[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:before{position:absolute;left:-10%;top:-56%;content:" ";width:150%;height:160%;transform:scale(0);transform-origin:bottom left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;clip-path:polygon(14% 44%,0 65%,50% 100%,100% 16%,80% 0%,43% 62%);color:var(--ghs-color-gray);background-color:var(--ghs-color-gray)}.setup[_ngcontent-%COMP%]   .loot-config[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]   .checkbox.checked[_ngcontent-%COMP%]:before{transform:scale(1);color:var(--ghs-color-black);background-color:var(--ghs-color-black)}.setup[_ngcontent-%COMP%]   .loot-config[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]   .sign[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.7 * var(--ghs-text-factor))}.setup[_ngcontent-%COMP%]   .loot-config[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1.3em;width:auto;filter:var(--ghs-filter-black);margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:flex-start;flex-wrap:wrap;height:100%}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;flex-direction:column;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 13 * var(--ghs-dialog-factor))}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]:hover{opacity:.7}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{position:relative}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 11 * .866025 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 11 * var(--ghs-dialog-factor));background-color:var(--ghs-color-white);clip-path:polygon(50% 0,100% 25%,100% 75%,50% 100%,0 75%,0 25%)}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 10.3 * .866025 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 10.3 * var(--ghs-dialog-factor));background-color:var(--ghs-color-red);clip-path:polygon(50% 0,100% 25%,100% 75%,50% 100%,0 75%,0 25%)}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 9 * .866025 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 9 * var(--ghs-dialog-factor));background-color:var(--ghs-color-darkgray);clip-path:polygon(50% 0,100% 25%,100% 75%,50% 100%,0 75%,0 25%)}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 9 * var(--ghs-dialog-factor));height:auto}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .letter[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-white);font-family:var(--ghs-font-title)}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .boss[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));position:absolute;top:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * -1 * var(--ghs-dialog-factor));background-color:var(--ghs-color-darkred);border:2px solid var(--ghs-color-gray);border-radius:100%}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .boss[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.7 * var(--ghs-dialog-factor));height:auto}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .custom[_ngcontent-%COMP%]{display:flex;justify-content:center;width:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));position:absolute;bottom:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * -1 * var(--ghs-dialog-factor));font-family:var(--ghs-font-gh-title);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 9 * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 9 * var(--ghs-text-factor));background-color:var(--ghs-color-darkgray);border:2px solid var(--ghs-color-gray);border-radius:100%}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{text-align:center;color:var(--ghs-color-gray);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));padding:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.setup[_ngcontent-%COMP%]   .setup-container[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));display:flex;align-items:center}.setup[_ngcontent-%COMP%]   .setup-container.detailed[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor))}.setup[_ngcontent-%COMP%]   .setup-container.detailed[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   ghs-monster-stats[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 21.5 * var(--ghs-dialog-factor))}']})}return a})();const Yr=a=>({visible:a}),FI=(a,r,n,i)=>({casual:a,success:r,locked:n,blocked:i}),XI=a=>({looted:a}),BI=(a,r)=>r._trackUUID;function YI(a,r){if(1&a&&t.nrm(0,"span",2),2&a){const n=t.XpG();t.Y8G("ghs-label","data.custom."+n.scenario.edition+".flowChartGroup."+n.scenario.flowChartGroup)}}function UI(a,r){if(1&a&&(t.j41(0,"div",6),t.nrm(1,"label",10)(2,"ghs-requirements",17)(3,"div",18),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","scenario.requirements"),t.R7$(),t.Y8G("scenarioData",n.scenarioData)("all",!0)("allToggle",!1)}}function NI(a,r){1&a&&t.nrm(0,"label",10),2&a&&t.Y8G("ghs-label","scenario.chart.setup")}function zI(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function LI(a,r){if(1&a&&(t.j41(0,"span"),t.nVh(1,zI,2,0,"span"),t.EFF(2),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.vxM(!(""+n).startsWith("G")&&+n<10&&+n>=0?1:-1),t.R7$(),t.SpI(" ",(""+n).startsWith("G-")?"G":(""+n).split(":")[0]," ")}}function qI(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"???"),t.k0s())}function HI(a,r){if(1&a&&t.nrm(0,"ghs-treasure-label",22),2&a){const n=t.XpG().$implicit,i=t.XpG();t.Y8G("edition",i.scenario.edition)("index",+(""+n).split(":")[0]-1)("rewardResults",i.gameManager.scenarioManager.treasureRewardsFromString(""+n))}}function KI(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",12)(1,"div",19),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.openTreasureDialog(+e.split(":")[0]))}),t.nVh(2,LI,3,2,"span"),t.nVh(3,qI,2,0,"span"),t.nrm(4,"img",20),t.k0s(),t.j41(5,"span",21),t.nVh(6,HI,1,3,"ghs-treasure-label",22),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(4,XI,-1!=i.lootedTreasures.indexOf(+n.split(":")[0]))),t.R7$(),t.vxM((""+n).startsWith("G")||+(""+n).split(":")[0]>=0?2:-1),t.R7$(),t.vxM(!(""+n).startsWith("G")&&+(""+n).split(":")[0]<0?3:-1),t.R7$(3),t.vxM((""+n).startsWith("G-")?-1:6)}}function WI(a,r){1&a&&t.nrm(0,"label",10),2&a&&t.Y8G("ghs-label","scenario.chart.treasures.empty")}function ZI(a,r){1&a&&t.nrm(0,"label",10),2&a&&t.Y8G("ghs-label","scenario.chart.treasures")}function JI(a,r){1&a&&t.nrm(0,"img",23)}function QI(a,r){if(1&a&&(t.nVh(0,JI,1,0,"img",23),t.nrm(1,"span",24)),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.vxM(i>0&&i<e.predecessors.length?0:-1),t.R7$(),t.Y8G("ghs-label","%game.scenarioNumber:"+n.index+"%")}}function t6(a,r){if(1&a&&(t.j41(0,"span",13),t.Z7z(1,QI,2,2,null,null,BI),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(t.bMT(3,0,n.predecessors))}}function n6(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",25),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.addSuccess())}),t.k0s()}2&a&&t.Y8G("ghs-label","scenario.chart.success")}let Ur=(()=>{class a{scenarioData;dialogRef;dialog;ghsManager;gameManager=s.E;scenario;isSuccess=!1;showSetup=!1;showTreasures=!1;hasRequirements=!1;hasMissingRequirements=!1;allRequirements=!1;predecessors=[];treasures=[];lootedTreasures=[];constructor(n,i,e,o){this.scenarioData=n,this.dialogRef=i,this.dialog=e,this.ghsManager=o,this.scenario=new ut.Nz(n),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.isSuccess=s.E.scenarioManager.isSuccess(this.scenario),this.showSetup=this.isSuccess,this.hasRequirements=s.E.scenarioManager.getRequirements(this.scenario,!0).length>0,this.hasMissingRequirements=s.E.scenarioManager.getRequirements(this.scenario).length>0,this.lootedTreasures=[],this.treasures=s.E.scenarioManager.getTreasures(this.scenario,s.E.scenarioManager.getSections(this.scenario).map(i=>new ut.Nz(i)),!1,!0).filter(i=>"G"!=i).map(i=>{i=+i;const e=s.E.game.party.treasures.find(o=>o.edition==this.scenario.edition&&(o.name==""+i||o.name.startsWith(i+":")));return e?(this.lootedTreasures.push(i),e.name):""+i}),this.showTreasures=this.treasures.length>0&&this.treasures.length==this.lootedTreasures.length||this.showSetup,this.predecessors=[];let n=s.E.scenarioManager.scenarioData(this.scenario.edition).find(i=>i.group==this.scenario.group&&i.unlocks&&i.unlocks.includes(this.scenario.index)&&(!s.E.game.party.campaignMode||s.E.scenarioManager.isSuccess(i)));for(n||(n=s.E.sectionData(this.scenario.edition).find(i=>i.conclusion&&i.group==this.scenario.group&&i.parent&&i.unlocks&&i.unlocks.includes(this.scenario.index)&&s.E.game.party.conclusions.find(e=>e.edition==i.edition&&e.group==i.group&&e.index==i.index)),n&&(n=s.E.scenarioManager.scenarioData(n.edition).find(i=>n&&i.group==n.group&&i.index==n.parent&&(!s.E.game.party.campaignMode||s.E.scenarioManager.isSuccess(i)))));n;){this.predecessors.unshift(n);let i=s.E.scenarioManager.scenarioData(n.edition).find(e=>n&&e.group==n.group&&e.unlocks&&e.unlocks.includes(n.index)&&(!s.E.game.party.campaignMode||s.E.scenarioManager.isSuccess(e)));i||(i=s.E.sectionData(n.edition).find(e=>n&&e.conclusion&&e.group==n.group&&e.parent&&e.unlocks&&e.unlocks.includes(n.index)&&s.E.game.party.conclusions.find(o=>o.edition==e.edition&&o.group==e.group&&o.index==e.index)),i&&(i=s.E.scenarioManager.scenarioData(n.edition).find(e=>i&&e.group==i.group&&e.index==i.parent&&(!s.E.game.party.campaignMode||s.E.scenarioManager.isSuccess(e))))),n=i,n&&this.predecessors.includes(n)&&(n=void 0)}}setScenario(){s.E.scenarioManager.isCurrent(this.scenario)||(s.E.scenarioManager.isLocked(this.scenario)?this.dialog.open(Ra,{panelClass:["dialog"],data:{scenarioData:this.scenario}}).closed.subscribe({next:n=>{n&&this.dialogRef.close(n)}}):(s.E.stateManager.before("setScenario",...s.E.scenarioManager.scenarioUndoArgs(new ut.Nz(this.scenario))),s.E.scenarioManager.setScenario(new ut.Nz(this.scenario)),s.E.stateManager.after(),(0,F.co)(this.dialogRef,!0)))}openTreasureDialog(n){this.lootedTreasures.includes(n)||this.dialog.open(Vr,{panelClass:["dialog"],data:{edition:this.scenario.edition,scenario:this.scenario}})}addSuccess(){const n=s.E.sectionData(this.scenario.edition).filter(i=>i.edition==this.scenario.edition&&i.parent==this.scenario.index&&i.group==this.scenario.group&&i.conclusion&&0==s.E.scenarioManager.getRequirements(i).length);0==n.length?this.addSuccessIntern():this.dialog.open(Xn,{panelClass:["dialog"],data:{conclusions:n,parent:this.scenario}}).closed.subscribe({next:i=>{i&&this.addSuccessIntern(i)}})}addSuccessIntern(n=void 0){s.E.stateManager.before("finishScenario.success",...s.E.scenarioManager.scenarioUndoArgs(new ut.Nz(this.scenario))),s.E.scenarioManager.finishScenario(new ut.Nz(this.scenario),!0,n,!1,!1,!1,s.E.game.party.campaignMode&&0==this.countFinished(),!0),s.E.stateManager.after(),this.update()}countFinished(){return(s.E.game.party.campaignMode?s.E.game.party.scenarios:s.E.game.party.casualScenarios).filter(n=>this.scenario.index==n.index&&this.scenario.edition==n.edition&&this.scenario.group==n.group).length}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-scenario-chart-popup"]],standalone:!1,decls:22,vars:26,consts:[[1,"scenario-chart-popup","scroll-container"],[1,"header"],[1,"subtitle",3,"ghs-label"],[1,"title"],[1,"number","text-white",3,"ghs-label"],[1,"name","text-white",3,"ghs-label"],[1,"spoiler-block","visible"],[1,"spoiler-block",3,"ngClass"],[3,"scenario","details","title","spoiler"],[1,"background",3,"click"],[3,"ghs-label"],[1,"treasures"],[1,"hint-container"],[1,"predecessors"],[1,"buttons"],[1,"play",3,"click","ngClass","ghs-label"],[1,"success",3,"ghs-label"],[3,"scenarioData","all","allToggle"],[1,"background"],[1,"treasure","hint-trigger",3,"click","ngClass"],["src","./assets/images/check.svg",1,"overlay","check"],[1,"hint","above","center"],[1,"text","placeholder","text-white",3,"edition","index","rewardResults"],["src","./assets/images/arrow-up.svg",1,"ghs-svg"],[1,"text-white",3,"ghs-label"],[1,"success",3,"click","ghs-label"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.nVh(2,YI,1,1,"span",2),t.j41(3,"span",3),t.nrm(4,"span",4)(5,"span",5),t.k0s()(),t.nVh(6,UI,4,4,"div",6),t.j41(7,"div",7),t.nrm(8,"ghs-scenario-setup",8),t.j41(9,"div",9),t.bIt("click",function(){return e.showSetup=!0}),t.nVh(10,NI,1,1,"label",10),t.k0s()(),t.j41(11,"div",7)(12,"div",11),t.Z7z(13,KI,7,6,"div",12,t.fX1),t.k0s(),t.nVh(15,WI,1,1,"label",10),t.j41(16,"div",9),t.bIt("click",function(){return e.showTreasures=!0}),t.nVh(17,ZI,1,1,"label",10),t.k0s()(),t.nVh(18,t6,4,2,"span",13),t.j41(19,"div",14)(20,"a",15),t.bIt("click",function(){return e.setScenario()}),t.k0s(),t.nVh(21,n6,1,1,"a",16),t.k0s()()),2&i&&(t.R7$(2),t.vxM(e.scenario.flowChartGroup?2:-1),t.R7$(2),t.Y8G("ghs-label","%game.scenarioNumber:"+e.scenario.index+"%"),t.R7$(),t.Y8G("ghs-label",e.gameManager.scenarioManager.scenarioTitle(e.scenarioData)),t.R7$(),t.vxM(e.hasRequirements?6:-1),t.R7$(),t.Y8G("ngClass",t.eq3(17,Yr,e.showSetup)),t.R7$(),t.Y8G("scenario",e.scenario)("details",!1)("title",!1)("spoiler",e.gameManager.scenarioManager.isSuccess(e.scenario)),t.R7$(2),t.vxM(e.showSetup?-1:10),t.R7$(),t.Y8G("ngClass",t.eq3(19,Yr,e.showTreasures)),t.R7$(2),t.Dyx(e.treasures),t.R7$(2),t.vxM(e.showTreasures&&0==e.treasures.length?15:-1),t.R7$(2),t.vxM(e.showTreasures?-1:17),t.R7$(),t.vxM(e.predecessors.length?18:-1),t.R7$(2),t.Y8G("ngClass",t.ziG(21,FI,!e.gameManager.game.party.campaignMode,e.gameManager.scenarioManager.isSuccess(e.scenario),e.gameManager.scenarioManager.isLocked(e.scenario),e.gameManager.scenarioManager.isBlocked(e.scenario)))("ghs-label","scenario.chart.start"),t.R7$(),t.vxM(e.isSuccess?-1:21))},dependencies:[N.YU,it,vs,Br,Pe,ct],styles:['.scenario-chart-popup[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.scenario-chart-popup[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-family:var(--ghs-font-normal);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor))}.scenario-chart-popup[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center}.scenario-chart-popup[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.scenario-chart-popup[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor))}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:center;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));padding:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor))}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   ghs-scenario-setup[_ngcontent-%COMP%]{visibility:hidden;z-index:2}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]{visibility:hidden;display:flex;justify-content:center;align-items:center;flex-wrap:wrap;z-index:2;min-height:calc(var(--ghs-unit) * 10 * var(--ghs-dialog-factor))}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;background-image:url(treasure.0792d529e76ec279.png);background-size:contain;background-repeat:no-repeat;background-position:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-black);width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));transition:translate calc(var(--ghs-animation-speed) * .5s) ease-in-out}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{display:none;position:absolute;top:30%;left:50%;transform:translate(-50%);height:50%;width:auto}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .overlay.check[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%] + .hint[_ngcontent-%COMP%]{display:none}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.looted[_ngcontent-%COMP%]{cursor:pointer}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.looted[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{display:block}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.looted[_ngcontent-%COMP%]:hover{opacity:.8;transform:scale(1.1)}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.looted[_ngcontent-%COMP%] + .hint[_ngcontent-%COMP%]{display:block}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .background[_ngcontent-%COMP%]{cursor:pointer;position:absolute;inset:0;z-index:1}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .background[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;position:absolute;inset:0;display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));color:var(--ghs-color-white);z-index:2}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .background[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:0;background-color:var(--ghs-color-darkgray);border-radius:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));opacity:.3;z-index:0}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .background[_ngcontent-%COMP%]:hover   label[_ngcontent-%COMP%]{opacity:.7}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .background[_ngcontent-%COMP%]:hover:before{opacity:.5}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block.visible[_ngcontent-%COMP%]   ghs-scenario-setup[_ngcontent-%COMP%], .scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block.visible[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]{visibility:visible}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block.visible[_ngcontent-%COMP%]   .background[_ngcontent-%COMP%]{pointer-events:none}.scenario-chart-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly;align-items:center}.scenario-chart-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.scenario-chart-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.scenario-chart-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .play[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.scenario-chart-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .play.casual[_ngcontent-%COMP%]{color:var(--ghs-color-gray)}.scenario-chart-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .play[_ngcontent-%COMP%]:not(.casual).success{cursor:initial;color:var(--ghs-color-darkgray)}.scenario-chart-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .play[_ngcontent-%COMP%]:not(.casual).locked:not(.blocked){cursor:initial;color:var(--ghs-color-yellow)}.scenario-chart-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .play[_ngcontent-%COMP%]:not(.casual).blocked{cursor:initial;color:var(--ghs-color-red)}.scenario-chart-popup[_ngcontent-%COMP%]   .predecessors[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.scenario-chart-popup[_ngcontent-%COMP%]   .predecessors[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white);transform:rotate(90deg);height:1em;width:auto;margin:0 .1em}']})}return a})();const e6=a=>({highlighting:a});let aa=(()=>{class a{edition;dialogRef;dialog;ghsManager;gameManager=s.E;settingsManager=p.f;map;worldMap;mapEdition;scenarios=[];conclusions=[];buildings=[];columns=[];rows=[];offsetX=[];offsetY=[];success=[];scale=1;zooming=!1;showExtended=!1;campaignSheet=!1;constructor(n,i,e,o){this.edition=n,this.dialogRef=i,this.dialog=e,this.ghsManager=o;const g=p.f.settings.pinchZoom;p.f.settings.pinchZoom=!1,this.mapEdition=this.edition,this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.updateMap()}),this.update(),this.dialogRef.closed.subscribe({next:()=>{p.f.settings.pinchZoom=g}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){let n=s.E.editionData.find(i=>i.edition==this.edition);n&&!n.worldMap&&n.extendWorldMap&&(n=s.E.editionData.find(i=>n&&i.edition==n.extendWorldMap&&i.worldMap)),n&&n.worldMap&&(this.worldMap=n.worldMap,this.mapEdition=n.edition,this.worldMap&&(this.scenarios=s.E.scenarioManager.scenarioData(this.edition).filter(i=>i.coordinates),this.mapEdition!=this.edition&&this.showExtended&&this.scenarios.push(...s.E.scenarioManager.scenarioData(this.mapEdition).filter(i=>i.coordinates)),s.E.sectionData(this.edition).filter(i=>i.conclusion&&i.coordinates&&i.unlocks&&i.unlocks.length).forEach(i=>{(!s.E.game.party.campaignMode||s.E.game.party.conclusions.find(o=>o.edition==i.edition&&o.index==i.index&&o.group==i.group))&&i.unlocks.forEach(o=>{let g=s.E.scenarioData(i.edition).find(m=>m.edition==i.edition&&m.group==i.group&&m.index==o&&!m.coordinates);if(g){const m=new Ue.tB(g);m.coordinates=i.coordinates,this.scenarios.push(m)}})}),this.conclusions=s.E.sectionData(this.edition).filter(i=>i.conclusion&&i.rewards&&(i.rewards.overlayCampaignSticker||i.rewards.overlaySticker)),this.mapEdition!=this.edition&&this.showExtended&&this.conclusions.push(...s.E.sectionData(this.mapEdition).filter(i=>i.conclusion&&i.rewards&&(i.rewards.overlayCampaignSticker||i.rewards.overlaySticker))),n.campaign&&n.campaign.buildings&&(this.buildings=n.campaign.buildings.filter(i=>i.coordinates&&i.coordinates.length))))}updateMap(){this.update(),this.map&&this.map.remove(),this.ngAfterViewInit()}ngAfterViewInit(){if(this.worldMap){const i=this.worldMap.width,e=this.worldMap.height;this.map=re().map("map",{crs:re().CRS.Simple,maxBounds:[[-.5*e,-.5*i],[1.5*e,1.5*i]],minZoom:-4,zoomDelta:.25,zoomSnap:.25,wheelPxPerZoomLevel:240,attributionControl:!1});var n=[[0,0],[e,i]];re().imageOverlay("./assets/images/world-map/"+this.mapEdition+"/map.jpg",n).addTo(this.map),this.map.fitBounds(n),this.map.zoomIn(),this.scenarios.forEach((o,g)=>{if(o.coordinates){const m=s.E.scenarioManager.isSuccess(o);m&&(this.success[g]=!0);let k=o.index.replaceAll(/[a-zA-Z]+/g,"");for(;k.length<3;)k="0"+k;if(m&&o.rewards&&o.rewards.overlayCampaignSticker){const J=o.rewards.overlayCampaignSticker.coordinates.image||o.edition+"-"+o.rewards.overlayCampaignSticker.name.toLowerCase(),et=this.placeOverlay("./assets/images/world-map/"+o.edition+"/overlays/"+J+".png",o.rewards.overlayCampaignSticker.coordinates,e,g+3);et.addTo(this.map);const ot=et.getElement();ot&&ot.classList.add("building")}if((!s.E.game.party.campaignMode||m)&&o.rewards&&o.rewards.overlaySticker){const J=o.rewards.overlaySticker.coordinates.image||o.edition+"-"+o.rewards.overlaySticker.name.toLowerCase(),et=this.placeOverlay("./assets/images/world-map/"+o.edition+"/overlays/"+J+".png",o.rewards.overlaySticker.coordinates,e,-1);et.addTo(this.map);const ot=et.getElement();ot&&ot.classList.add("overlay")}const at=this.placeOverlay("./assets/images/world-map/"+o.edition+"/scenarios/"+(o.coordinates.image||o.edition+"-"+k)+".png",o.coordinates,e,g);at.on("mouseover",J=>{J.target.setZIndex(this.scenarios.length+2)}),at.on("mouseout",J=>{J.target.setZIndex(g+2)}),at.on("click",()=>{p.f.settings.debugEditWorldMap||s.E.stateManager.permissions&&!s.E.stateManager.permissions.scenario||this.dialog.open(Ur,{panelClass:["dialog"],data:this.scenarios[g]}).closed.subscribe({next:et=>{et&&this.dialogRef.close()}})}),at.addTo(this.map);const tt=at.getElement();if(tt){let J=["scenario"];m&&J.push("success"),s.E.scenarioManager.isBlocked(o)?J.push("blocked"):s.E.scenarioManager.isLocked(o)&&J.push("locked"),J.forEach(et=>tt.classList.add(et))}}}),this.conclusions.forEach((o,g)=>{const m=s.E.game.party.conclusions.find(k=>k.edition==o.edition&&k.index==o.index&&k.group==o.group);if(!s.E.game.party.campaignMode||m){if(o.rewards&&o.rewards.overlayCampaignSticker){const k=o.rewards.overlayCampaignSticker.coordinates.image||o.edition+"-"+o.rewards.overlayCampaignSticker.name.toLowerCase(),X=this.placeOverlay("./assets/images/world-map/"+o.edition+"/overlays/"+k+".png",o.rewards.overlayCampaignSticker.coordinates,e,-1);X.addTo(this.map);const at=X.getElement();at&&at.classList.add("building"),X.on("click",()=>{const tt=this.conclusions[g];let J;tt.parent&&(J=s.E.scenarioData(tt.edition).find(et=>et.edition==tt.edition&&et.group==tt.group&&et.index==tt.parent)),this.dialog.open(zt,{panelClass:["dialog"],data:{scenario:new ut.Nz(J||tt),conclusion:tt,conclusionOnly:!0}})})}if(o.rewards&&o.rewards.overlaySticker){const k=o.rewards.overlaySticker.coordinates.image||o.edition+"-"+o.rewards.overlaySticker.name.toLowerCase(),X=this.placeOverlay("./assets/images/world-map/"+o.edition+"/overlays/"+k+".png",o.rewards.overlaySticker.coordinates,e,-1);X.addTo(this.map);const at=X.getElement();at&&at.classList.add("overlay")}}}),this.buildings.forEach(o=>{const g=s.E.game.party.buildings.find(k=>k.name==o.name),m=g?g.level:s.E.buildingsManager.initialBuilding(o)?1:s.E.buildingsManager.availableBuilding(o)?0:void 0;if(null!=m&&o.coordinates&&o.coordinates.length){const k=o.coordinates[m||0];if(k){const at=this.placeOverlay("./assets/images/world-map/"+o.edition+"/buildings/"+(k.image||o.edition+"-"+(o.id?o.id+"-":"")+o.name+(o.upgrades.length?"-"+(m??"0"):""))+".png",k,e,-1);at.addTo(this.map);const tt=at.getElement();tt&&tt.classList.add("building")}}})}}placeOverlay(n,i,e,o){let g=re().imageOverlay(n,[[e-i.y,i.x],[e-i.y-i.height,i.x+i.width]],{interactive:!0});return g.setZIndex(o+2),g.on("mousedown",m=>this.editStartDrag(m)),g.on("mouseleave",m=>this.editStopDrag(m)),g.on("mousemove",m=>this.editMoveDrag(m)),g}editStartDrag(n){if(p.f.settings.debugEditWorldMap){const i=n.target,e=i.getElement();e&&!e.getAttribute("drag")?(this.map.dragging.disable(),e.setAttribute("drag","true"),e.setAttribute("dragLat",""+n.latlng.lat),e.setAttribute("dragLng",""+n.latlng.lng),i.setOpacity(.5)):this.editStopDrag(n)}}editStopDrag(n){if(p.f.settings.debugEditWorldMap){const i=n.target,e=i.getElement();e&&e.getAttribute("drag")&&(this.map.dragging.enable(),this.worldMap&&console.debug('"x": '+i.getBounds().getSouthWest().lng+',\n"y": '+(this.worldMap.height-i.getBounds().getNorthEast().lat)+","),e.removeAttribute("drag"),e.removeAttribute("dragLat"),e.removeAttribute("dragLng"),i.setOpacity(1))}}editMoveDrag(n){if(p.f.settings.debugEditWorldMap){const i=n.target,e=i.getElement();if(e&&e.getAttribute("drag")){let o,g;if(o=+(e.getAttribute("dragLat")||0),g=+(e.getAttribute("dragLng")||0),o&&g){o=n.latlng.lat-o,g=n.latlng.lng-g;const m=new Ir.LatLngBounds([i.getBounds().getSouthWest().lat+o,i.getBounds().getSouthWest().lng+g],[i.getBounds().getNorthEast().lat+o,i.getBounds().getNorthEast().lng+g]);i.setBounds(m),n.target.getElement().setAttribute("dragLat",""+n.latlng.lat),n.target.getElement().setAttribute("dragLng",""+n.latlng.lng),n.originalEvent.preventDefault(),n.originalEvent.stopPropagation()}}}}keyboardShortcuts(n){p.f.settings.keyboardShortcuts&&!this.campaignSheet&&(n.ctrlKey||n.shiftKey||"p"!==n.key.toLowerCase()||!p.f.settings.partySheet?n.ctrlKey||n.shiftKey||"c"!==n.key.toLowerCase()||!s.E.game.edition?!n.ctrlKey&&!n.shiftKey&&"h"===n.key.toLowerCase()&&(p.f.toggle("globalMapHighlighting"),n.stopPropagation(),n.preventDefault()):(this.openFlowChart(),n.stopPropagation(),n.preventDefault()):(this.openCampaignSheet(),n.stopPropagation(),n.preventDefault()))}openFlowChart(){this.dialogRef.close(),setTimeout(()=>{this.dialog.open(ia,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:{edition:this.edition}})},1)}openCampaignSheet(){this.campaignSheet||(this.campaignSheet=!0,this.dialog.open(Hn,{panelClass:["dialog-invert"],data:{disableShortcuts:!0}}).closed.subscribe({next:()=>this.campaignSheet=!1}))}close(){(0,F.co)(this.dialogRef)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-world-map"]],hostBindings:function(i,e){1&i&&t.bIt("keydown",function(g){return e.keyboardShortcuts(g)},t.EBC)},standalone:!1,decls:11,vars:11,consts:[["map",""],[1,"world-map-container"],["id","map",1,"world-map",3,"ngClass"],[1,"menu"],[3,"click","ghs-tooltip","originY","overlayY"],["src","./assets/images/chart.svg"],["src","./assets/images/sheet.svg"],["type","checkbox",3,"click","checked"],[3,"ghs-label"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",1),t.nrm(1,"div",2,0),t.j41(3,"div",3)(4,"a",4),t.bIt("click",function(){return c.eBV(o),c.Njj(e.openFlowChart())}),t.nrm(5,"img",5),t.k0s(),t.j41(6,"a",4),t.bIt("click",function(){return c.eBV(o),c.Njj(e.openCampaignSheet())}),t.nrm(7,"img",6),t.k0s(),t.j41(8,"label")(9,"input",7),t.bIt("click",function(){return c.eBV(o),c.Njj(e.settingsManager.toggle("globalMapHighlighting"))}),t.k0s(),t.nrm(10,"span",8),t.k0s()()()}2&i&&(t.R7$(),t.Y8G("ngClass",t.eq3(9,e6,e.settingsManager.settings.globalMapHighlighting)),t.R7$(3),t.Y8G("ghs-tooltip","scenario.chart")("originY","top")("overlayY","bottom"),t.R7$(2),t.Y8G("ghs-tooltip","party.campaign.manage")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("checked",e.settingsManager.settings.globalMapHighlighting),t.R7$(),t.Y8G("ghs-label","campaign.map.highlighting"))},dependencies:[N.YU,it,Mt],styles:[".world-map-container{position:absolute;top:0;left:0;width:100vw;height:100vh}.world-map-container .world-map{position:relative;width:100%;height:100%;max-width:100%;max-height:100%;overflow:auto;background:none;z-index:1}.world-map-container .world-map .scenario{z-index:2}.world-map-container .world-map .scenario:hover{cursor:pointer;filter:brightness(1.1);opacity:.9}.world-map-container .world-map .building:hover,.world-map-container .world-map.highlighting .scenario{filter:brightness(1.2) drop-shadow(4px 4px 4px var(--ghs-color-darkgray)) drop-shadow(-4px -4px 4px var(--ghs-color-darkgray))}.world-map-container .world-map.highlighting .scenario:hover{cursor:pointer;filter:brightness(1.1);opacity:.9}.world-map-container .world-map.highlighting .scenario.success{cursor:initial;z-index:2;filter:brightness(.8) hue-rotate(30deg)}.world-map-container .world-map.highlighting .scenario.success:hover{cursor:initial;filter:none}.world-map-container .world-map.highlighting .scenario.locked:not(.blocked){cursor:initial;z-index:1;filter:brightness(1)}.world-map-container .world-map.highlighting .scenario.locked:not(.blocked):hover{cursor:initial;filter:brightness(.8) grayscale(.8)}.world-map-container .world-map.highlighting .scenario.blocked{cursor:initial;z-index:1;filter:brightness(.8) sepia(3) hue-rotate(340deg)}.world-map-container .world-map.highlighting .scenario.blocked:hover{cursor:initial;filter:brightness(.8) grayscale(.8)}.world-map-container .world-map.highlighting .scenario.blocked.success{filter:brightness(.8) hue-rotate(30deg) grayscale(.6)}.world-map-container .world-map.highlighting .scenario.blocked.success:hover{filter:brightness(.6) hue-rotate(30deg) grayscale(.6)}.world-map-container .menu{position:absolute;left:0;bottom:0;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);display:flex;align-items:center;z-index:2;background-color:var(--ghs-color-darkgray);border-top-right-radius:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.world-map-container .menu a,.world-map-container .menu label{cursor:pointer;display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.world-map-container .menu a img,.world-map-container .menu label img{filter:var(--ghs-filter-gray);height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));width:auto}.world-map-container .menu a:hover,.world-map-container .menu label:hover{color:var(--ghs-color-white)}.world-map-container .menu a:hover img,.world-map-container .menu label:hover img{filter:var(--ghs-filter-white)}\n"],encapsulation:2})}return a})();const a6=a=>({open:a});function i6(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",10),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openWorldMap())}),t.nrm(1,"img",11),t.k0s()}2&a&&t.Y8G("ghs-tooltip","party.campaign.map")("originY","top")("overlayY","bottom")}function o6(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",10),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openCampaignSheet())}),t.nrm(1,"img",12),t.k0s()}2&a&&t.Y8G("ghs-tooltip","party.campaign.manage")("originY","top")("overlayY","bottom")}function s6(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",13),t.bIt("singleClick",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.toggleCampaignMode(e))})("doubleClick",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.toggleCampaignMode(e,!0))}),t.nrm(1,"input",14)(2,"span",8),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ghs-tooltip","scenario.chart.campaign."+(n.campaignMode?"force":"back"))("originY","top")("overlayY","bottom"),t.R7$(),t.Y8G("checked",n.campaignMode)("disabled",n.campaignMode),t.R7$(),t.Y8G("ghs-label","scenario.chart.campaign")}}function r6(a,r){1&a&&(t.j41(0,"ul")(1,"li",4)(2,"span",15),t.EFF(3,"U"),t.k0s(),t.nrm(4,"span",8),t.k0s(),t.j41(5,"li",4)(6,"span",16),t.EFF(7,"S"),t.k0s(),t.nrm(8,"span",8),t.k0s(),t.j41(9,"li",4)(10,"span",17),t.EFF(11,"L"),t.k0s(),t.nrm(12,"span",8),t.k0s(),t.j41(13,"li",4)(14,"span",18),t.EFF(15,"B"),t.k0s(),t.nrm(16,"span",8),t.k0s(),t.j41(17,"li",4)(18,"span",19),t.EFF(19,"SL"),t.k0s(),t.nrm(20,"span",8),t.k0s(),t.j41(21,"li",4)(22,"span",20),t.EFF(23,"SB"),t.k0s(),t.nrm(24,"span",8),t.k0s(),t.j41(25,"li",4)(26,"span",21),t.EFF(27,"NC"),t.k0s(),t.nrm(28,"span",8),t.k0s(),t.j41(29,"li",4)(30,"span",22),t.EFF(31,"NU"),t.k0s(),t.nrm(32,"span",8),t.k0s()()),2&a&&(t.R7$(),t.Y8G("ghs-tooltip","scenario.chart.legend.unplayed.hint")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("ghs-label","scenario.chart.legend.unplayed"),t.R7$(),t.Y8G("ghs-tooltip","scenario.chart.legend.success.hint")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("ghs-label","scenario.chart.legend.success"),t.R7$(),t.Y8G("ghs-tooltip","scenario.chart.legend.locked.hint")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("ghs-label","scenario.chart.legend.locked"),t.R7$(),t.Y8G("ghs-tooltip","scenario.chart.legend.blocked.hint")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("ghs-label","scenario.chart.legend.blocked"),t.R7$(),t.Y8G("ghs-tooltip","scenario.chart.legend.success-locked.hint")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("ghs-label","scenario.chart.legend.success-locked"),t.R7$(),t.Y8G("ghs-tooltip","scenario.chart.legend.success-blocked.hint")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("ghs-label","scenario.chart.legend.success-blocked"),t.R7$(),t.Y8G("ghs-tooltip","scenario.chart.legend.not-campaign.hint")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("ghs-label","scenario.chart.legend.not-campaign"),t.R7$(),t.Y8G("ghs-tooltip","scenario.chart.legend.not-unlocked.hint")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("ghs-label","scenario.chart.legend.not-unlocked"))}let ia=(()=>{class a{data;dialogRef;dialog;overlay;ghsManager;flow=[];flowString="";edition;group;worldMap=!1;campaignSheet=!1;campaignMode=!0;legend=!1;chart;mermaid=null;initializing=!1;gameManager=s.E;constructor(n,i,e,o,g){this.data=n,this.dialogRef=i,this.dialog=e,this.overlay=o,this.ghsManager=g,this.edition=n.edition,this.group=n.group,this.campaignMode=s.E.game.party.campaignMode}ngOnInit(){var n=this;return(0,I.A)(function*(){if(!n.mermaid){const i=yield v.e(839).then(v.bind(v,1839));n.mermaid=i.default,n.mermaid.initialize({startOnLoad:!1,flowchart:{useMaxWidth:!0,htmlLabels:!0,curve:"linear",subGraphTitleMargin:{bottom:10}},theme:"base",themeVariables:{fontSize:"calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))",fontFamily:"var(--ghs-font-text)",darkMode:!0,primaryColor:"#202830",secondaryColor:"transparent",tertiaryColor:"#52565f",tertiaryBorderColor:"#202830",tertiaryTextColor:"#eeeeee"},wrap:!1,securityLevel:"loose",logLevel:5})}n.uiChangeSubscription=n.ghsManager.onUiChange().subscribe({next:()=>n.updateMap()}),n.update()})()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){let i;this.flow=["flowchart LR","classDef default stroke-width:4, r:32px;","classDef success stroke:#7da82a;","classDef unplayed stroke:#56c8ef;","classDef blocked stroke:#e2421f;","classDef locked stroke:#eca610;","classDef success-blocked fill:#7da82a,stroke:#e2421f;","classDef success-locked fill:#7da82a,stroke:#eca610;","linkStyle default stroke-width:5"],this.worldMap=!1;const e=s.E.editionData.find(m=>this.edition&&m.edition==this.edition);e&&(e.worldMap||e.extendWorldMap)&&(this.worldMap=!0);const o=s.E.scenarioManager.scenarioData(this.edition,!this.campaignMode).filter(m=>m.group==this.group).sort(s.E.scenarioManager.sortScenarios).sort((m,k)=>m.flowChartGroup==k.flowChartGroup?0:!m.flowChartGroup&&k.flowChartGroup?-1:m.flowChartGroup&&!k.flowChartGroup?1:m.flowChartGroup&&k.flowChartGroup?m.flowChartGroup<k.flowChartGroup?-1:1:0);o.forEach(m=>{let k=":::unplayed";const X=this.campaignMode&&s.E.scenarioManager.isSuccess(m);if(X&&(k=":::success"),this.campaignMode&&s.E.scenarioManager.isBlocked(m)?k=X?":::success-blocked":":::blocked":this.campaignMode&&s.E.scenarioManager.isLocked(m)&&(k=X?":::success-locked":":::locked"),m.flowChartGroup&&m.flowChartGroup!=i||!m.flowChartGroup&&m.group&&m.group!=i)if(i&&this.flow.push("end"),m.flowChartGroup)if(o.find(tt=>tt!=m&&tt.flowChartGroup==m.flowChartGroup)){const tt=""+p.f.getLabel("data.custom."+this.edition+".flowChartGroup."+m.flowChartGroup);this.flow.push("subgraph "+tt),i=m.flowChartGroup}else i=void 0;else o.find(tt=>tt!=m&&!tt.flowChartGroup&&tt.group==m.group)?(this.flow.push('subgraph "'+p.f.getLabel("data.scenario.group."+m.group)+'"'),i=m.group):i=void 0;const at=m.index.match(/\d+/g)?("000"+m.index).slice(-3):m.index;this.flow.push("\t"+m.index+"(("+at+"))"+k)}),i&&this.flow.push("end");let g=[];o.forEach(m=>{const k=this.campaignMode&&s.E.scenarioManager.isSuccess(m),X=!this.campaignMode||k;let at=[],tt=[];X&&(m.unlocks&&m.unlocks.forEach(J=>{let et=" --\x3e ";const ot=s.E.scenarioManager.getScenario(J,m.edition,m.group);ot&&(s.E.scenarioManager.isBlocked(ot)?(et=" --x ",this.flow.push("\t"+m.index+et+ot.index)):s.E.scenarioManager.isLocked(ot)?(et=" --o ",this.flow.push("\t"+m.index+et+ot.index)):g.find(lt=>lt.a==m.index&&lt.b==ot.index)||(g.push({a:m.index,b:ot.index}),this.flow.push("\t"+m.index+et+ot.index)))}),m.links&&m.links.forEach(J=>{let et=" .->|\u{1f517}| ";const ot=s.E.scenarioManager.getScenario(J,m.edition,m.group);ot&&!at.includes(J)&&o.find(lt=>lt.edition==ot.edition&&lt.group==ot.group&&lt.index==ot.index)&&(s.E.scenarioManager.isBlocked(ot)?et=" .-x|\u{1f517}| ":s.E.scenarioManager.isLocked(ot)&&(et=" .-o|\u{1f517}| "),this.flow.push("\t"+m.index+et+J),at.push(J))}),m.forcedLinks&&m.forcedLinks.forEach(J=>{let et=" .->|\u2757\u{1f517}| ";const ot=s.E.scenarioManager.getScenario(J,m.edition,m.group);ot&&!tt.includes(J)&&(s.E.scenarioManager.isBlocked(ot)?et=" .-x|\u2757\u{1f517}| ":s.E.scenarioManager.isLocked(ot)&&(et=" .-o|\u2757\u{1f517}| "),this.flow.push("\t"+m.index+et+J),tt.push(J))})),X&&s.E.scenarioManager.getSections(m).filter(J=>J.unlocks&&J.unlocks.length).forEach(J=>{const et=this.campaignMode&&null!=s.E.game.party.conclusions.find(lt=>lt.edition==J.edition&&lt.group==J.group&&lt.index==J.index);(!this.campaignMode||et)&&J.unlocks&&(J.unlocks.forEach(lt=>{const Ct=s.E.scenarioManager.getScenario(lt,m.edition,m.group);Ct&&(g.find(sn=>sn.a==m.index&&sn.b==Ct.index)||(g.push({a:m.index,b:Ct.index}),this.flow.push("\t"+m.index+" --\x3e "+Ct.index)))}),J.links&&J.links.forEach(lt=>{let St=" .->|\u{1f517}| ";const Ct=s.E.scenarioManager.getScenario(lt,m.edition,m.group);Ct&&!at.includes(lt)&&(s.E.scenarioManager.isBlocked(Ct)?St=" .-x|\u{1f517}| ":s.E.scenarioManager.isLocked(Ct)&&(St=" .-o|\u{1f517}| "),this.flow.push("\t"+m.index+St+lt),at.push(lt))}),J.forcedLinks&&J.forcedLinks.forEach(lt=>{let St=" .->|\u2757\u{1f517}| ";const Ct=s.E.scenarioManager.getScenario(lt,m.edition,m.group);Ct&&!tt.includes(lt)&&(s.E.scenarioManager.isBlocked(Ct)?St=" .-x|\u2757\u{1f517}| ":s.E.scenarioManager.isLocked(Ct)&&(St=" .-o|\u2757\u{1f517}| "),this.flow.push("\t"+m.index+St+lt),tt.push(lt))}))})}),this.flowString=this.flow.join("\n")}updateMap(){this.update(),this.chart&&this.chart.remove(),this.initMap()}initMap(){var n=this;return(0,I.A)(function*(){if(n.initializing)return;if(n.initializing=!0,!n.mermaid){const Mn=yield v.e(839).then(v.bind(v,1839));n.mermaid=Mn.default}const{svg:i,bindFunctions:e}=yield n.mermaid.render("graphDiv",n.flowString);var g=(new DOMParser).parseFromString(i,"image/svg+xml").lastChild;let m=g.getElementsByClassName("clusters").length?g.getElementsByClassName("clusters")[0].getElementsByTagName("rect"):[];for(let Mn=0;Mn<m.length;Mn++){const vn=m[Mn];vn&&(vn.setAttribute("rx","20"),vn.setAttribute("ry","20"))}const X=(g.getAttribute("viewBox")||"0 0 600 600").split(/\s+|,/),at=+X[2],tt=+X[3],J=Math.max(at,600),et=Math.max(tt,600),ot=J>at?(J-at)/2:0,lt=et>tt?et-tt:0;n.chart=re().map("chart",{crs:re().CRS.Simple,maxBounds:[[-.5*et,-.5*J],[1.5*et,1.5*J]],minZoom:-4,zoomDelta:.25,zoomSnap:.25,wheelPxPerZoomLevel:240,attributionControl:!1}),n.chart.fitBounds([[0,0],[1.5*et,1.5*J]]),n.chart.zoomIn();const Ct=re().svgOverlay(g,[[tt+lt,ot],[lt,at+ot]],{interactive:!0});g.addEventListener("pointerdown",Mn=>{if("mouse"===Mn.pointerType&&0!==Mn.button)return;let vn=Mn.target;if("P"==vn.tagName.toUpperCase()&&vn.parentElement&&(vn=vn.parentElement),vn&&vn.classList.contains("nodeLabel")){let Un=vn.parentElement;for(;Un&&!Un.classList.contains("node");)Un=Un.parentElement;if(Un&&"id"in Un){const Uc=Un.id.split("-").length>1?Un.id.split("-")[1]:"";if(Uc){const Nc=s.E.scenarioData(n.edition).find(oi=>Un&&oi.group==n.group&&oi.index==Uc);Nc&&n.dialog.open(Ur,{panelClass:["dialog"],data:Nc,positionStrategy:n.overlay.position().flexibleConnectedTo(vn).withPositions((0,F.yE)())}).closed.subscribe({next:oi=>{oi&&n.dialogRef.close()}})}}}}),Ct.addTo(n.chart);const sn=n.chart.getContainer();e&&e(sn),n.initializing=!1})()}ngAfterViewInit(){var n=this;return(0,I.A)(function*(){n.initMap()})()}keyboardShortcuts(n){p.f.settings.keyboardShortcuts&&!this.campaignSheet&&(n.ctrlKey||n.shiftKey||"p"!==n.key.toLowerCase()||!p.f.settings.partySheet?!n.ctrlKey&&!n.shiftKey&&"g"===n.key.toLowerCase()&&this.worldMap&&(this.openWorldMap(),n.stopPropagation(),n.preventDefault()):(this.openCampaignSheet(),n.stopPropagation(),n.preventDefault()))}toggleCampaignMode(n,i=!1){(!this.campaignMode||i)&&(this.campaignMode=!this.campaignMode,this.updateMap()),n.preventDefault(),n.stopPropagation()}openWorldMap(){this.worldMap&&(this.dialogRef.close(),setTimeout(()=>{this.dialog.open(aa,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:this.edition})},1))}openCampaignSheet(){this.campaignSheet||(this.campaignSheet=!0,this.dialog.open(Hn,{panelClass:["dialog-invert"],data:{disableShortcuts:!0}}).closed.subscribe({next:()=>this.campaignSheet=!1}))}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG),t.rXU(qt.hJ),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-scenario-chart"]],hostBindings:function(i,e){1&i&&t.bIt("keydown",function(g){return e.keyboardShortcuts(g)},t.EBC)},standalone:!1,decls:13,vars:8,consts:[["chart",""],[1,"scenario-chart-container"],["id","chart",1,"scenario-chart"],[1,"menu"],[3,"ghs-tooltip","originY","overlayY"],["ghs-pointer-input","",1,"checkbox-container",3,"ghs-tooltip","originY","overlayY"],[1,"menu","right"],[1,"legend",3,"click","ngClass"],[3,"ghs-label"],["src","./assets/images/select-arrow.svg",1,"ghs-svg"],[3,"click","ghs-tooltip","originY","overlayY"],["src","./assets/images/map.svg"],["src","./assets/images/sheet.svg"],["ghs-pointer-input","",1,"checkbox-container",3,"singleClick","doubleClick","ghs-tooltip","originY","overlayY"],["type","checkbox",3,"checked","disabled"],[1,"symbol","unplayed"],[1,"symbol","success"],[1,"symbol","locked"],[1,"symbol","blocked"],[1,"symbol","success-locked"],[1,"symbol","success-blocked"],[1,"symbol","not-campaign"],[1,"symbol","not-unlocked"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",1),t.nrm(1,"div",2,0),t.j41(3,"div",3),t.nVh(4,i6,2,3,"a",4),t.nVh(5,o6,2,3,"a",4),t.nVh(6,s6,3,6,"div",5),t.k0s(),t.j41(7,"div",6)(8,"div",7),t.bIt("click",function(){return c.eBV(o),c.Njj(e.legend=!e.legend)}),t.j41(9,"a"),t.nrm(10,"span",8)(11,"img",9),t.k0s(),t.nVh(12,r6,33,32,"ul"),t.k0s()()()}2&i&&(t.R7$(4),t.vxM(e.worldMap?4:-1),t.R7$(),t.vxM(e.gameManager.bbRules()?-1:5),t.R7$(),t.vxM(e.gameManager.game.party.campaignMode?6:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(6,a6,e.legend)),t.R7$(2),t.Y8G("ghs-label","scenario.chart.legend"),t.R7$(2),t.vxM(e.legend?12:-1))},dependencies:[N.YU,it,Mt,dt],styles:['.scenario-chart-container{position:absolute;top:0;left:0;width:100vw;height:100vh}.scenario-chart-container .scenario-chart{position:relative;width:100%;height:100%;max-width:100%;max-height:100%;overflow:auto;background:none;line-height:initial!important;z-index:1}.scenario-chart-container .scenario-chart svg{cursor:grab}.scenario-chart-container .scenario-chart svg .node{cursor:pointer}.scenario-chart-container .scenario-chart svg .node:hover{opacity:.7}.scenario-chart-container .scenario-chart svg .node.success,.scenario-chart-container .scenario-chart svg .node.locked:not(.blocked),.scenario-chart-container .scenario-chart svg .node.blocked{cursor:initial}.scenario-chart-container .scenario-chart svg .node.locked:before{content:"!";position:absolute;top:-1em;left:-1em;color:var(--ghs-color-yellow)}.scenario-chart-container .scenario-chart svg .node.blocked:before{content:"x";position:absolute;top:-1em;left:-1em;color:var(--ghs-color-red)}.scenario-chart-container .scenario-chart svg .labelBkg{background:none!important}.scenario-chart-container .scenario-chart svg .edge-pattern-dotted{stroke-width:3!important;stroke-dasharray:5!important}.scenario-chart-container .menu{position:absolute;left:0;bottom:0;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);display:flex;align-items:center;background-color:var(--ghs-color-darkgray);border-top-right-radius:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));z-index:2}.scenario-chart-container .menu a,.scenario-chart-container .menu .checkbox-container{cursor:pointer;display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.scenario-chart-container .menu a img,.scenario-chart-container .menu .checkbox-container img{filter:var(--ghs-filter-gray);height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));width:auto}.scenario-chart-container .menu a:hover,.scenario-chart-container .menu .checkbox-container:hover{color:var(--ghs-color-white)}.scenario-chart-container .menu a:hover img,.scenario-chart-container .menu .checkbox-container:hover img{filter:var(--ghs-filter-white)}.scenario-chart-container .menu a input[type=checkbox]:disabled,.scenario-chart-container .menu .checkbox-container input[type=checkbox]:disabled{cursor:initial;color:var(--ghs-color-gray);border-width:initial}.scenario-chart-container .menu a input[type=checkbox]:disabled:before,.scenario-chart-container .menu .checkbox-container input[type=checkbox]:disabled:before{color:var(--ghs-color-gray);background-color:var(--ghs-color-gray)}.scenario-chart-container .menu .legend{display:flex;flex-direction:column;justify-content:center;align-items:flex-start;cursor:zoom-in}.scenario-chart-container .menu .legend.open{cursor:zoom-out}.scenario-chart-container .menu .legend.open a img{transform:rotate(180deg)}.scenario-chart-container .menu .legend ul{margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));padding:0}@media (max-width: 600px),(orientation: portrait){.scenario-chart-container .menu .legend ul{margin-bottom:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor))}}.scenario-chart-container .menu .legend ul li{display:flex;justify-content:flex-start;align-items:center;margin-bottom:.2em}.scenario-chart-container .menu .legend ul li .symbol{display:inline-flex;justify-content:center;align-items:center;width:2.3em;height:2.3em;border:.2em solid var(--ghs-color-gray);border-radius:100%;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray);margin-right:1em;font-family:var(--ghs-font-gh-title);font-size:.6em}.scenario-chart-container .menu .legend ul li .symbol.unplayed{border-color:var(--ghs-color-blue)}.scenario-chart-container .menu .legend ul li .symbol.success{border-color:var(--ghs-color-green)}.scenario-chart-container .menu .legend ul li .symbol.locked{border-color:var(--ghs-color-yellow)}.scenario-chart-container .menu .legend ul li .symbol.blocked{border-color:var(--ghs-color-red)}.scenario-chart-container .menu .legend ul li .symbol.success-locked{border-color:var(--ghs-color-yellow);background-color:var(--ghs-color-green)}.scenario-chart-container .menu .legend ul li .symbol.success-blocked{border-color:var(--ghs-color-red);background-color:var(--ghs-color-green)}.scenario-chart-container .menu .legend ul li .symbol.not-unlocked{border-radius:0}.scenario-chart-container .menu.right{left:initial;right:0;border-top-right-radius:initial;border-top-left-radius:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));z-index:1}\n'],encapsulation:2})}return a})();const Nr=a=>[a],c6=a=>({finish:a});function l6(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",12),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.openConclusions(e))}),t.nrm(1,"img",13)(2,"span",14),t.k0s()}2&a&&(t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.weekSections.openConclusion"))}function g6(a,r){if(1&a&&(t.j41(0,"span",6),t.nrm(1,"img",10),t.EFF(2),t.nVh(3,l6,3,1,"a",11),t.k0s()),2&a){const n=r.$implicit,i=t.XpG();t.R7$(),t.Y8G("src","./assets/images/"+(i.isSolved(n)?"scenario/conclusion.svg":"fh/party/section.svg"),t.B4B),t.R7$(),t.SpI(" ",n," "),t.R7$(),t.vxM(i.hasConclusions(n)?3:-1)}}function d6(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",12),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.openConclusions(e))}),t.nrm(1,"img",13)(2,"span",14),t.k0s()}2&a&&(t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.weekSections.openConclusion"))}function h6(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",6)(1,"span",15),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.finishConclusion(e))}),t.nrm(2,"img",10),t.EFF(3),t.k0s(),t.nVh(4,d6,3,1,"a",11),t.nrm(5,"span",16),t.j41(6,"img",17),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.removeSection(e))}),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(4,c6,i.isConclusion(n))),t.R7$(),t.Y8G("src","./assets/images/"+(i.isSolved(n)?"scenario/conclusion.svg":"fh/party/section.svg"),t.B4B),t.R7$(),t.SpI(" ",n," "),t.R7$(),t.vxM(i.hasConclusions(n)?4:-1)}}let _6=(()=>{class a{week;dialog;gameManager=s.E;constructor(n,i){this.week=n,this.dialog=i}sectionsFixed(){const n=s.E.campaignData();return n.weeks&&n.weeks[this.week]&&n.weeks[this.week]||[]}sections(){return s.E.game.party.weekSections[this.week]||[]}isConclusion(n){return null!=s.E.sectionData(s.E.currentEdition()).find(i=>i.index==n&&!i.group&&i.conclusion)}isSolved(n){return null!=s.E.game.party.conclusions.find(i=>i.edition==s.E.game.edition&&i.index==n)}hasConclusions(n){const i=s.E.sectionData(s.E.game.edition).filter(e=>e.conclusion&&!e.parent&&e.parentSections&&1==e.parentSections.length&&e.parentSections.find(o=>1==o.length&&o.includes(n)));return i.length>0&&i.every(e=>!s.E.game.party.conclusions.find(o=>o.edition==e.edition&&o.index==e.index&&o.group==e.group))}finishConclusion(n){const i=s.E.sectionData(s.E.currentEdition()).find(e=>e.index==n&&e.conclusion);if(i){const e=new ut.Nz(i),o=this.isSolved(n);this.dialog.open(zt,{panelClass:["dialog"],data:{scenario:e,conclusionOnly:!0,rewardsOnly:o,success:o}})}}openConclusions(n){let i=s.E.sectionData(s.E.game.edition).filter(e=>e.conclusion&&!e.parent&&e.parentSections&&1==e.parentSections.length&&e.parentSections.find(o=>1==o.length&&o.includes(n))&&0==s.E.scenarioManager.getRequirements(e).length).map(e=>(e.name="",e));i.length>0&&this.dialog.open(Xn,{panelClass:["dialog"],data:{conclusions:i,parent:s.E.sectionData(s.E.game.edition).find(e=>e.index==n&&!e.group)}}).closed.subscribe({next:e=>{if(e){const o=new ut.Nz(e);s.E.stateManager.before("finishConclusion",...s.E.scenarioManager.scenarioUndoArgs(o)),s.E.scenarioManager.finishScenario(o,!0,void 0,!1,!1,!1,s.E.game.party.campaignMode,!0),o.repeatable||(s.E.game.party.weekSections[this.week]=[...s.E.game.party.weekSections[this.week]||[],o.index]),s.E.stateManager.after(),this.dialog.open(zt,{panelClass:["dialog"],data:{scenario:o,conclusionOnly:!0}})}}})}addSection(n){n.classList.add("error"),(!s.E.game.party.weekSections[this.week]||!s.E.game.party.weekSections[this.week]?.includes(n.value))&&(s.E.stateManager.before("addPartyWeekSection",s.E.game.party.name,this.week,n.value),s.E.game.party.weekSections[this.week]=[...s.E.game.party.weekSections[this.week]||[],n.value],n.classList.remove("error"),n.value="",s.E.stateManager.after())}removeSection(n){s.E.game.party.weekSections[this.week]&&s.E.game.party.weekSections[this.week]?.includes(n)&&(s.E.stateManager.before("removePartyWeekSection",s.E.game.party.name,this.week,n),s.E.game.party.weekSections[this.week]?.splice(s.E.game.party.weekSections[this.week]?.indexOf(n)||-1,1),0==s.E.game.party.weekSections[this.week]?.length&&delete s.E.game.party.weekSections[this.week],this.isSolved(n)&&(s.E.game.party.conclusions=s.E.game.party.conclusions.filter(i=>i.edition!=s.E.game.edition||i.index!=n)),s.E.stateManager.after())}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.lG))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-party-week-dialog"]],standalone:!1,decls:14,vars:12,consts:[["scenario",""],[1,"week-dialog"],[1,"title"],[3,"ghs-label","ghs-label-args"],[1,"sub-title"],[1,"sections"],[1,"section"],[1,"add-section"],[3,"keyup","keyup.enter","ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg",1,"button",3,"click","ghs-label","ghs-label-attribute"],[3,"src"],[1,"conclusion"],[1,"conclusion",3,"click"],["src","./assets/images/hint.svg"],[3,"ghs-label"],[1,"index",3,"click","ngClass"],[1,"spacer"],["src","./assets/images/close.svg",1,"button",3,"click"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",1)(1,"div",2),t.nrm(2,"span",3),t.j41(3,"span",4),t.nrm(4,"span",3),t.k0s()(),t.j41(5,"div",5),t.Z7z(6,g6,4,3,"span",6,t.fX1),t.Z7z(8,h6,7,6,"span",6,t.fX1),t.k0s(),t.j41(10,"div",7)(11,"input",8,0),t.bIt("keyup",function(){c.eBV(o);const m=t.sdS(12);return m.classList.remove("error"),c.Njj(m.classList.remove("error"))})("keyup.enter",function(){c.eBV(o);const m=t.sdS(12);return c.Njj(e.addSection(m))}),t.k0s(),t.j41(13,"img",9),t.bIt("click",function(){c.eBV(o);const m=t.sdS(12);return c.Njj(e.addSection(m))}),t.k0s()()()}2&i&&(t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.weekSections")("ghs-label-args",t.eq3(8,Nr,e.week+"")),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.weekSections.calc")("ghs-label-args",t.eq3(10,Nr,e.week-e.gameManager.game.party.weeks+"")),t.R7$(2),t.Dyx(e.sectionsFixed()),t.R7$(2),t.Dyx(e.sections()),t.R7$(3),t.Y8G("ghs-label","party.campaign.sheet.weekSections.section")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.weekSections.addSection")("ghs-label-attribute","title"))},dependencies:[N.YU,it],styles:[".week-dialog[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.week-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.week-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .sub-title[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.week-dialog[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));width:auto;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.week-dialog[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{cursor:pointer}.week-dialog[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{opacity:.8}.week-dialog[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]{display:flex;flex-direction:column}.week-dialog[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%], .week-dialog[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{display:flex;align-items:center}.week-dialog[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{filter:var(--ghs-filter-red)}.week-dialog[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .finish[_ngcontent-%COMP%]{cursor:pointer}.week-dialog[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .conclusion[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;color:var(--ghs-color-black)}.week-dialog[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .conclusion[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto;margin-right:.3em}.week-dialog[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .conclusion[_ngcontent-%COMP%]:hover{opacity:.7}.week-dialog[_ngcontent-%COMP%]   .add-section[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.week-dialog[_ngcontent-%COMP%]   .add-section[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .05 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray);outline:none}"]})}return a})(),zr=(()=>{class a{ghsManager;party;gameManager=s.E;settingsManager=p.f;buildings=[];constructor(n){this.ghsManager=n}ngOnInit(){this.updateBuildings(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.party=s.E.game.party,this.updateBuildings()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}updateBuildings(){this.buildings=[];const n=s.E.campaignData();n.buildings.filter(i=>s.E.buildingsManager.initialBuilding(i)).forEach(i=>{this.party.buildings.find(e=>i.name==e.name)||(this.party.buildings.push(new Fn.k(i.name,1)),i.rewards[0]&&s.E.buildingsManager.applyRewards(i.rewards[0]))}),n.buildings.filter(i=>i.prosperityUnlock&&i.costs.prosperity<=s.E.prosperityLevel()).forEach(i=>{this.party.buildings.find(e=>i.name==e.name)||(!i.requires||this.party.buildings.find(e=>e.name==i.requires&&e.level))&&this.party.buildings.push(new Fn.k(i.name,0))}),this.party.buildings.forEach(i=>{const e=n.buildings.find(o=>o.name==i.name);e&&this.buildings.push({model:i,data:e})}),this.buildings.sort((i,e)=>i.model.level&&!e.model.level?-1:!i.model.level&&e.model.level?1:i.data.id&&e.data.id?i.data.id<e.data.id?-1:1:i.data.id?-1:e.data.id?1:i.model.level==e.model.level?i.data.name<e.data.name?-1:1:e.model.level-i.model.level)}unlockBuilding(n){const i=n.value;this.party.buildings=this.party.buildings||[];const e=s.E.campaignData();if(e.buildings&&i){const o=e.buildings.find(g=>g.name==i.toLowerCase().replaceAll(" ","-")||g.id==i||!isNaN(+g.id)&&!isNaN(+i)&&+g.id==+i);o&&!this.party.buildings.find(g=>g.name==o.name)&&(s.E.stateManager.before("addBuilding",o.id,o.name),this.party.buildings.push(new Fn.k(o.name,0)),this.updateBuildings(),n.value="",s.E.stateManager.after())}}static \u0275fac=function(i){return new(i||a)(t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-party-buildings"]],inputs:{party:"party"},standalone:!1,decls:9,vars:4,consts:[["building",""],[1,"buildings-container"],[1,"header",3,"submit"],["src","./assets/images/fh/buildings/build.svg"],[3,"ghs-label"],["type","text",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg",3,"click"],[3,"change","buildings"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",1)(1,"form",2),t.bIt("submit",function(){c.eBV(o);const m=t.sdS(6);return c.Njj(e.unlockBuilding(m))}),t.j41(2,"label"),t.nrm(3,"img",3)(4,"span",4),t.k0s(),t.nrm(5,"input",5,0),t.j41(7,"img",6),t.bIt("click",function(){c.eBV(o);const m=t.sdS(6);return c.Njj(e.unlockBuilding(m))}),t.k0s()(),t.j41(8,"ghs-buildings-list",7),t.bIt("change",function(){return c.eBV(o),c.Njj(e.updateBuildings())}),t.k0s()()}2&i&&(t.R7$(4),t.Y8G("ghs-label","party.campaign.sheet.buildings"),t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.buildings.unlock")("ghs-label-attribute","placeholder"),t.R7$(3),t.Y8G("buildings",e.buildings))},styles:[".buildings-container[_ngcontent-%COMP%]{flex-direction:column;display:flex}.buildings-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex}.buildings-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor))}.buildings-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:.8em;width:auto;margin:0 calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.buildings-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{cursor:pointer;height:1.2em;width:auto}.buildings-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:0;min-width:initial;max-width:initial;margin:0;color:var(--ghs-color-black);background-color:var(--form-background);border:none;border-bottom-width:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor));border-bottom-style:solid;border-bottom-color:var(--ghs-color-gray);user-select:auto;-webkit-user-select:auto;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));flex-grow:1;margin-left:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor))}"]})}return a})();const m6=["itemIndex"],p6=["treasureIndex"],oa=a=>({denied:a}),u6=(a,r,n)=>({"fh-container":a,"gh2e-container":r,"campaign-container":n}),Lr=a=>({"fh-sheet":a}),Ut=()=>[],on=a=>({checked:a}),qr=a=>({active:a}),Gn=a=>({highlight:a}),f6=a=>({permissive:a}),C6=(a,r,n)=>({checked:a,section:r,locked:n}),za=a=>({disabled:a}),Hr=a=>({conclusion:a}),M6=(a,r)=>({checked:a,disabled:r}),v6=(a,r)=>({collapsed:a,full:r}),O6=a=>({locked:a}),P6=(a,r)=>[a,r],b6=(a,r,n,i)=>[a,r,n,i],Kr=(a,r)=>({section:a,"prosperity-tick":r}),k6=(a,r,n)=>({large:a,section:r,break:n}),Wr=(a,r)=>({checked:a,highlight:r}),y6=a=>[a],x6=(a,r)=>({blocked:a,locked:r}),E6=(a,r)=>({fh:a,wrapped:r}),w6=(a,r)=>({large:a,section:r}),R6=(a,r)=>({checked:a,prosperity:r}),Zr=a=>({edition:a}),dn=(a,r)=>r._trackUUID,j6=(a,r)=>r+a;function G6(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.JRh(n.name)}}function T6(a,r){if(1&a&&(t.j41(0,"span"),t.nrm(1,"span",21),t.EFF(2),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.Y8G("ghs-label","party.campaign"),t.R7$(),t.SpI("\xa0",n.id)}}function S6(a,r){if(1&a&&(t.j41(0,"option",52),t.nVh(1,G6,2,1,"span"),t.nVh(2,T6,3,2,"span"),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(3);t.Y8G("value",t.mNQ(n.id))("selected",n.id==i.party.id)("disabled",n.id==i.party.id),t.R7$(),t.vxM(n.name?1:-1),t.R7$(),t.vxM(n.name?-1:2)}}function D6(a,r){if(1&a){const n=t.RV6();t.j41(0,"select",51),t.bIt("change",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.selectParty(e))}),t.Z7z(1,S6,3,6,"option",52,dn),t.nI1(3,"trackUUID"),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ghs-label","party.change")("ghs-label-attribute","title"),t.R7$(),t.Dyx(t.bMT(3,2,n.gameManager.game.parties))}}function $6(a,r){if(1&a){const n=t.RV6();t.j41(0,"img",55),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openMap())}),t.k0s()}2&a&&t.Y8G("ghs-tooltip","party.campaign.map")}function I6(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",25)(1,"img",53),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openFlowChart())}),t.k0s(),t.nVh(2,$6,1,1,"img",54),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-tooltip","scenario.chart"),t.R7$(),t.vxM(n.worldMap?2:-1)}}function A6(a,r){if(1&a){const n=t.RV6();t.j41(0,"img",58),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.removeParty())}),t.k0s()}2&a&&t.Y8G("ghs-label","party.remove")("ghs-label-attribute","title")}function V6(a,r){if(1&a){const n=t.RV6();t.nVh(0,A6,1,2,"img",56),t.nrm(1,"span",24),t.j41(2,"img",57),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.newParty())}),t.k0s()}if(2&a){const n=t.XpG(2);t.vxM(n.gameManager.game.parties.length>1?0:-1),t.R7$(2),t.Y8G("ghs-label","party.new")("ghs-label-attribute","title")}}function F6(a,r){1&a&&(t.j41(0,"div",28),t.nrm(1,"img",59),t.j41(2,"span",60)(3,"span",61),t.nrm(4,"span",21),t.k0s()()()),2&a&&(t.R7$(4),t.Y8G("ghs-label","party.new.hint"))}function X6(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.SpI(" ",n.split(":")[1],"x\xa0 ")}}function B6(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",34),t.nVh(1,X6,2,1,"span"),t.nrm(2,"span",21)(3,"span",24),t.j41(4,"span",62),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.removeAchievement(e))}),t.nrm(5,"img",63),t.k0s()()}if(2&a){const n=r.$implicit;t.R7$(),t.vxM(n.split(":").length>0&&"1"!=n.split(":")[1]?1:-1),t.R7$(),t.Y8G("ghs-label","data.partyAchievements."+n.split(":")[0])}}function Y6(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",64),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.setReputation(40-e-20))}),t.k0s(),t.j41(1,"span",65),t.EFF(2),t.nI1(3,"ghsValueSign"),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.eq3(4,on,i.party.reputation==40-n-20)),t.R7$(2),t.JRh(t.bMT(3,2,40-n-20))}}function U6(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.JRh(t.bMT(2,1,-5+n))}}function N6(a,r){1&a&&(t.j41(0,"span"),t.nrm(1,"span",21),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","party.shop.none"))}function z6(a,r){if(1&a&&(t.j41(0,"div",44),t.nVh(1,U6,3,3,"span"),t.nVh(2,N6,2,1,"span"),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.eq3(3,qr,i.priceModifier==-5+n)),t.R7$(),t.vxM(5!=n?1:-1),t.R7$(),t.vxM(5==n?2:-1)}}function L6(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",11)(1,"div",16)(2,"div",17)(3,"div",18)(4,"span",19),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.campaign=!0)}),t.nrm(5,"img",20)(6,"span",21),t.k0s(),t.j41(7,"label",22),t.nrm(8,"span",21),t.k0s(),t.nVh(9,D6,4,4,"select",23),t.nrm(10,"span",24),t.nVh(11,I6,3,2,"span",25),t.k0s(),t.j41(12,"div",26)(13,"label"),t.nrm(14,"span",21),t.EFF(15,":"),t.k0s(),t.j41(16,"input",27),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setName(e))}),t.k0s(),t.nVh(17,V6,3,3),t.nVh(18,F6,5,1,"div",28),t.k0s(),t.j41(19,"div",29)(20,"label"),t.nrm(21,"span",21),t.EFF(22,":"),t.k0s(),t.j41(23,"input",27),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setLocation(e))}),t.k0s()(),t.j41(24,"div",30)(25,"label"),t.nrm(26,"span",21),t.EFF(27,":"),t.k0s(),t.j41(28,"textarea",27),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setNotes(e))}),t.k0s()(),t.j41(29,"div",31)(30,"label"),t.nrm(31,"span",21),t.EFF(32,":"),t.k0s(),t.j41(33,"div",32)(34,"div",33),t.Z7z(35,B6,6,2,"div",34,t.fX1),t.k0s(),t.j41(37,"div",35)(38,"input",36,0),t.bIt("keyup.enter",function(){c.eBV(n);const e=t.sdS(39),o=t.XpG();return c.Njj(o.addAchievement(e))}),t.k0s(),t.j41(40,"a",37),t.bIt("click",function(){c.eBV(n);const e=t.sdS(39),o=t.XpG();return c.Njj(o.addAchievement(e))}),t.nrm(41,"img",38),t.k0s()()()()(),t.j41(42,"div",39)(43,"div",16)(44,"div",40)(45,"label"),t.nrm(46,"span",21),t.k0s(),t.j41(47,"div",41),t.Z7z(48,Y6,4,6,null,null,t.fX1),t.nI1(50,"ghsRange"),t.k0s()(),t.j41(51,"div",42)(52,"label"),t.nrm(53,"span",21),t.k0s(),t.j41(54,"div",43),t.Z7z(55,z6,3,5,"div",44,t.fX1),t.nI1(57,"ghsRange"),t.k0s()()(),t.j41(58,"div",45)(59,"label",46),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.exportParty())}),t.nrm(60,"img",47),t.j41(61,"span"),t.nrm(62,"span",21),t.k0s()(),t.j41(63,"label",48),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.ghsInputFullScreenCheck())}),t.j41(64,"input",49),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.importParty(e))}),t.k0s(),t.nrm(65,"img",50),t.j41(66,"span"),t.nrm(67,"span",21),t.k0s()()()()()()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(41,Lr,n.fhSheet)),t.R7$(6),t.Y8G("ghs-label","party.campaign"),t.R7$(2),t.Y8G("ghs-label","party.sheet"),t.R7$(),t.vxM(n.gameManager.game.parties.length>1&&!n.gameManager.game.scenario?9:-1),t.R7$(2),t.vxM(n.disableShortcuts?-1:11),t.R7$(3),t.Y8G("ghs-label","party.name"),t.R7$(2),t.Y8G("value",n.party.name)("ghs-label","party.name")("ghs-label-attribute","placeholder"),t.R7$(),t.vxM(n.gameManager.game.scenario?-1:17),t.R7$(),t.vxM(n.gameManager.game.scenario?18:-1),t.R7$(3),t.Y8G("ghs-label","party.location"),t.R7$(2),t.Y8G("value",n.party.location)("ghs-label","party.location")("ghs-label-attribute","placeholder"),t.R7$(3),t.Y8G("ghs-label","party.notes"),t.R7$(2),t.Y8G("value",n.party.notes)("ghs-label","party.notes")("ghs-label-attribute","placeholder"),t.R7$(3),t.Y8G("ghs-label","party.achievements"),t.R7$(4),t.Dyx(n.partyAchievementsList),t.R7$(3),t.Y8G("autocomplete",n.partyAchievements)("spoiler",!0)("emptyLabel","party.addPartyAchievement.empty")("ghs-label","party.addPartyAchievement")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","party.addPartyAchievement")("ghs-label-attribute","title"),t.R7$(6),t.Y8G("ghs-label","party.reputation"),t.R7$(2),t.Dyx(t.i5U(50,35,t.lJ4(43,Ut),41)),t.R7$(5),t.Y8G("ghs-label","party.shop"),t.R7$(2),t.Dyx(t.i5U(57,38,t.lJ4(44,Ut),11)),t.R7$(4),t.Y8G("ghs-label","party.export")("ghs-label-attribute","title"),t.R7$(3),t.Y8G("ghs-label","party.export"),t.R7$(),t.Y8G("ghs-label","party.import")("ghs-label-attribute","title"),t.R7$(4),t.Y8G("ghs-label","party.import")}}function q6(a,r){if(1&a){const n=t.RV6();t.j41(0,"img",55),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openMap())}),t.k0s()}2&a&&t.Y8G("ghs-tooltip","party.campaign.map")}function H6(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",25)(1,"img",53),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openFlowChart())}),t.k0s(),t.nVh(2,q6,1,1,"img",54),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-tooltip","scenario.chart"),t.R7$(),t.vxM(n.worldMap?2:-1)}}function K6(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",131),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.setWeek(e.party.weeks+1))}),t.nrm(1,"span",21)(2,"img",132),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.nextWeek"))}function W6(a,r){if(1&a&&(t.j41(0,"div",134),t.nrm(1,"img",75),t.EFF(2),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(3);t.R7$(),t.Y8G("src","./assets/images/"+(i.hasConclusions(n)?"hint.svg":i.isConclusion(n)?"scenario/conclusion.svg":"fh/party/section.svg"),t.B4B),t.R7$(),t.SpI(" ",n," ")}}function Z6(a,r){if(1&a&&(t.j41(0,"div",135),t.nrm(1,"img",75),t.EFF(2),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(3);t.R7$(),t.Y8G("src","./assets/images/"+(i.hasConclusions(n)?"hint.svg":i.isConclusion(n)?"scenario/conclusion.svg":"fh/party/section.svg"),t.B4B),t.R7$(),t.SpI(" ",n," ")}}function J6(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",133),t.bIt("singleClick",function(){const e=c.eBV(n).$index,o=t.XpG(2);return c.Njj(o.setWeek(e+1+80*o.calendarSheet))})("doubleClick",function(){const e=c.eBV(n).$index,o=t.XpG(2);return c.Njj(o.setWeekSection(e+1+80*o.calendarSheet))}),t.Z7z(1,W6,3,2,"div",134,t.fX1),t.Z7z(3,Z6,3,2,"div",135,t.fX1),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.Y8G("ghs-tooltip","party.campaign.sheet.weekSections.hint")("ngClass",t.sMw(2,C6,e.party.weeks>i+80*e.calendarSheet,e.sectionsForWeekFixed(n+80*e.calendarSheet).length>0||e.sectionsForWeek(n+80*e.calendarSheet).length>0,e.settingsManager.settings.calendarLocked&&("permissive"!=e.settingsManager.settings.calendarLocked||e.party.weeks!=i+80*e.calendarSheet&&e.party.weeks!=i+80*e.calendarSheet+1))),t.R7$(),t.Dyx(e.sectionsForWeekFixed(n+80*e.calendarSheet)),t.R7$(2),t.Dyx(e.sectionsForWeek(n+80*e.calendarSheet))}}function Q6(a,r){if(1&a){const n=t.RV6();t.j41(0,"img",58),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.removeParty())}),t.k0s()}2&a&&t.Y8G("ghs-label","party.remove")("ghs-label-attribute","title")}function tA(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.JRh(n.name)}}function nA(a,r){if(1&a&&(t.j41(0,"span"),t.nrm(1,"span",21),t.EFF(2),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.Y8G("ghs-label","party.campaign"),t.R7$(),t.SpI("\xa0",n.id)}}function eA(a,r){if(1&a&&(t.j41(0,"option",52),t.nVh(1,tA,2,1,"span"),t.nVh(2,nA,3,2,"span"),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(4);t.Y8G("value",t.mNQ(n.id))("selected",n.id==i.party.id)("disabled",n.id==i.party.id),t.R7$(),t.vxM(n.name?1:-1),t.R7$(),t.vxM(n.name?-1:2)}}function aA(a,r){if(1&a){const n=t.RV6();t.j41(0,"select",51),t.bIt("change",function(e){c.eBV(n);const o=t.XpG(3);return c.Njj(o.selectParty(e))}),t.Z7z(1,eA,3,6,"option",52,dn),t.nI1(3,"trackUUID"),t.k0s()}if(2&a){const n=t.XpG(3);t.Y8G("ghs-label","party.change")("ghs-label-attribute","title"),t.R7$(),t.Dyx(t.bMT(3,2,n.gameManager.game.parties))}}function iA(a,r){if(1&a){const n=t.RV6();t.nVh(0,Q6,1,2,"img",56),t.nVh(1,aA,4,4,"select",23),t.j41(2,"img",57),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.newParty())}),t.k0s()}if(2&a){const n=t.XpG(2);t.vxM(n.gameManager.game.parties.length>1?0:-1),t.R7$(),t.vxM(n.gameManager.game.parties.length>1&&!n.gameManager.game.scenario?1:-1),t.R7$(),t.Y8G("ghs-label","party.new")("ghs-label-attribute","title")}}function oA(a,r){1&a&&(t.j41(0,"div",28),t.nrm(1,"img",59),t.j41(2,"span",60)(3,"span",61),t.nrm(4,"span",21),t.k0s()()()),2&a&&(t.R7$(4),t.Y8G("ghs-label","party.new.hint"))}function sA(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",139),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.moveResources(e))}),t.nrm(1,"img",75),t.k0s()}if(2&a){const n=r.$implicit;t.R7$(),t.Y8G("src",n.iconUrl,t.B4B)}}function rA(a,r){if(1&a&&(t.j41(0,"div",83)(1,"span",136),t.nrm(2,"span",21),t.EFF(3,":"),t.k0s(),t.j41(4,"div",137),t.Z7z(5,sA,2,1,"span",138,dn),t.nI1(7,"trackUUID"),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","character.progress.resources.move"),t.R7$(3),t.Dyx(t.bMT(7,1,n.characters))}}function cA(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",142),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG().$implicit,g=t.XpG(2);return c.Njj(g.setSoldiers(e+(o>0?2+2*o:0)+1))})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG().$implicit,g=t.XpG(2);return c.Njj(g.setSoldiers(e+(o>0?2+2*o:0)+1,!0))}),t.nrm(1,"img",143)(2,"div",144),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG().$implicit,e=t.XpG(2);t.Y8G("ngClass",t.eq3(2,za,n+(i>0?2+2*i:0)>=e.party.soldiers+(e.soldierAvailable()?1:0))),t.R7$(2),t.Y8G("ngClass",t.eq3(4,on,n+(i>0?2+2*i:0)<e.party.soldiers))}}function lA(a,r){if(1&a&&(t.j41(0,"div",111)(1,"label")(2,"span",61),t.nrm(3,"span",21),t.k0s(),t.j41(4,"span"),t.EFF(5),t.k0s()(),t.j41(6,"div",140),t.Z7z(7,cA,3,6,"div",141,t.fX1),t.nI1(9,"ghsRange"),t.k0s()()),2&a){const n=r.$implicit;t.R7$(3),t.Y8G("ghs-label","party.campaign.sheet.soldierLevel"),t.R7$(2),t.JRh(n+1),t.R7$(2),t.Dyx(t.i5U(9,2,t.lJ4(5,Ut),n>0?2:4))}}function gA(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",64),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.setMorale(20-e))}),t.j41(1,"span",65),t.EFF(2),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.eq3(2,on,i.party.morale==20-n)),t.R7$(2),t.JRh(20-n)}}function dA(a,r){if(1&a&&(t.j41(0,"span",117),t.nrm(1,"img",145),t.EFF(2),t.k0s()),2&a){const n=r.$index,i=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Hr,i.isConclusion(i.gameManager.campaignData().highMorale[n]))),t.R7$(2),t.SpI(" ",i.gameManager.campaignData().highMorale[n]||""," ")}}function hA(a,r){if(1&a&&(t.j41(0,"span",117),t.nrm(1,"img",145),t.EFF(2),t.k0s()),2&a){const n=r.$index,i=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Hr,i.isConclusion(i.gameManager.campaignData().lowMorale[n]))),t.R7$(2),t.SpI(" ",i.gameManager.campaignData().lowMorale[n]||""," ")}}function _A(a,r){1&a&&(t.j41(0,"span",146),t.nrm(1,"img",148),t.EFF(2,":"),t.k0s())}function mA(a,r){if(1&a){const n=t.RV6();t.nVh(0,_A,3,0,"span",146),t.j41(1,"span",147),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.setTownGuardPerks(e+1))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.vxM(n%3==0?0:-1),t.R7$(),t.Y8G("ngClass",t.eq3(2,on,i.party.townGuardPerks>=n+1))}}function pA(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",152),t.nI1(1,"ghsFloor"),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.toggleTownGuardPerkSection(e))})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.toggleTownGuardPerkSection(e,!0))}),t.nrm(2,"img",145),t.EFF(3),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(3);t.Y8G("ngClass",t.l_i(4,M6,i.party.townGuardPerkSections.includes(n),!i.party.townGuardPerkSections.includes(n)&&i.party.townGuardPerkSections.length>=t.bMT(1,2,i.party.townGuardPerks/3))),t.R7$(3),t.SpI(" ",n," ")}}function uA(a,r){if(1&a&&(t.j41(0,"div",121)(1,"div",149),t.Z7z(2,pA,4,7,"div",150,t.fX1),t.k0s(),t.nrm(4,"ghs-perk-label",151),t.k0s()),2&a){const n=r.$implicit;t.R7$(2),t.Dyx(n.sections),t.R7$(2),t.Y8G("perk",n.perk)}}function fA(a,r){1&a&&(t.j41(0,"div",122),t.nrm(1,"img",153)(2,"span",21),t.k0s()),2&a&&(t.Y8G("ghs-label","game.attackModifiers.perks.warning")("ghs-label-attribute","title"),t.R7$(2),t.Y8G("ghs-label","game.attackModifiers.perks.warning"))}function CA(a,r){if(1&a&&t.nrm(0,"span",154),2&a){const n=t.XpG().$implicit;t.Y8G("ghs-label","data.campaignSticker."+n)}}function MA(a,r){if(1&a&&t.nrm(0,"img",155),2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG(2);t.Y8G("src",o.campaignStickerImage(i,e),t.B4B)("ghs-tooltip","data.campaignSticker."+i)}}function vA(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",128),t.nVh(1,CA,1,1,"span",154),t.nVh(2,MA,1,2,"img",155),t.j41(3,"img",156),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.removeCampaignSticker(e))}),t.k0s()()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.R7$(),t.vxM(e.campaignStickerImage(n,i)?-1:1),t.R7$(),t.vxM(e.campaignStickerImage(n,i)?2:-1)}}function OA(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",130)(1,"div",157)(2,"ghs-attackmodifier-deck",158),t.bIt("before",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.beforeTownGuardDeck(e))})("after",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.afterTownGuardDeck(e))}),t.k0s(),t.j41(3,"div",159),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.toggleTownGuardDeck())}),t.nrm(4,"span",160),t.k0s()()()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(4,qr,n.townGuardDeck.active)),t.R7$(),t.Y8G("ngClass",t.l_i(6,v6,!n.townGuardDeck.active,n.townGuardDeck.active)),t.R7$(),t.Y8G("deck",n.townGuardDeck)("townGuard",!0)}}function PA(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",12)(1,"div",66)(2,"label",67),t.nrm(3,"img",68)(4,"span",21),t.k0s(),t.j41(5,"label",69),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.campaign=!0)}),t.nrm(6,"span",21),t.j41(7,"span",70),t.nrm(8,"img",20)(9,"span",21),t.k0s()(),t.j41(10,"label",71),t.nrm(11,"span",21)(12,"img",72),t.k0s()(),t.j41(13,"div",73)(14,"a",74),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.settingsManager.toggle("calendarLocked"))})("doubleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.settingsManager.set("calendarLocked","permissive"==e.settingsManager.settings.calendarLocked||"permissive"))}),t.nrm(15,"img",75),t.k0s()(),t.nVh(16,H6,3,2,"span",25),t.nVh(17,K6,3,1,"span",76),t.j41(18,"div",77),t.Z7z(19,J6,5,6,"div",78,t.fX1),t.nI1(21,"ghsRange"),t.k0s(),t.j41(22,"div",79)(23,"label"),t.nrm(24,"span",21),t.k0s(),t.j41(25,"input",27),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setName(e))}),t.k0s(),t.nVh(26,iA,3,4),t.nVh(27,oA,5,1,"div",28),t.k0s(),t.j41(28,"div",80)(29,"div",81)(30,"label",82),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openResources())}),t.nrm(31,"span",21),t.EFF(32,":"),t.k0s(),t.nrm(33,"span",24),t.nVh(34,rA,8,3,"div",83),t.k0s(),t.j41(35,"div",84)(36,"div",85)(37,"div",86),t.nrm(38,"img",87),t.j41(39,"input",88),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setResource(o.LootType.lumber,e))}),t.k0s()(),t.j41(40,"div",89),t.nrm(41,"img",90),t.j41(42,"input",88),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setResource(o.LootType.metal,e))}),t.k0s()(),t.j41(43,"div",91),t.nrm(44,"img",92),t.j41(45,"input",88),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setResource(o.LootType.hide,e))}),t.k0s()()(),t.j41(46,"div",93)(47,"div",94),t.nrm(48,"img",95),t.j41(49,"input",88),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setResource(o.LootType.arrowvine,e))}),t.k0s()(),t.j41(50,"div",96),t.nrm(51,"img",97),t.j41(52,"input",88),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setResource(o.LootType.axenut,e))}),t.k0s()(),t.j41(53,"div",98),t.nrm(54,"img",99),t.j41(55,"input",88),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setResource(o.LootType.corpsecap,e))}),t.k0s()(),t.j41(56,"div",100),t.nrm(57,"img",101),t.j41(58,"input",88),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setResource(o.LootType.flamefruit,e))}),t.k0s()(),t.j41(59,"div",102),t.nrm(60,"img",103),t.j41(61,"input",88),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setResource(o.LootType.rockroot,e))}),t.k0s()(),t.j41(62,"div",104),t.nrm(63,"img",105),t.j41(64,"input",88),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setResource(o.LootType.snowthistle,e))}),t.k0s()()()()(),t.j41(65,"div",106)(66,"label"),t.nrm(67,"span",21),t.EFF(68,":"),t.k0s(),t.j41(69,"input",107),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setInspiration(e))}),t.k0s()(),t.j41(70,"div",108)(71,"label"),t.nrm(72,"span",21),t.EFF(73,":"),t.k0s(),t.j41(74,"input",107),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setTotalDefense(e))}),t.k0s()(),t.j41(75,"div",109)(76,"label"),t.nrm(77,"span",21),t.EFF(78,":"),t.k0s(),t.j41(79,"div",110),t.Z7z(80,lA,10,6,"div",111,t.fX1),t.nI1(82,"ghsRange"),t.k0s()(),t.j41(83,"div",112)(84,"label"),t.nrm(85,"span",21),t.k0s(),t.j41(86,"div",113),t.Z7z(87,gA,3,4,"span",44,t.fX1),t.nI1(89,"ghsRange"),t.k0s()(),t.j41(90,"div",114)(91,"label"),t.nrm(92,"span",21),t.k0s(),t.j41(93,"div",115)(94,"span",116),t.Z7z(95,dA,3,4,"span",117,t.fX1),t.nI1(97,"slice"),t.k0s(),t.j41(98,"span",44),t.EFF(99,"+15"),t.k0s(),t.j41(100,"span",44),t.EFF(101,"+10"),t.k0s(),t.j41(102,"span",44),t.EFF(103,"+5"),t.k0s(),t.j41(104,"span",44),t.EFF(105,"0"),t.k0s(),t.j41(106,"span",44),t.EFF(107,"-5"),t.k0s(),t.j41(108,"span",44),t.EFF(109,"-10"),t.k0s(),t.j41(110,"span",116),t.Z7z(111,hA,3,4,"span",117,t.fX1),t.nI1(113,"slice"),t.k0s()()(),t.j41(114,"div",118)(115,"label"),t.nrm(116,"span",21),t.k0s(),t.j41(117,"div",119),t.Z7z(118,mA,2,4,null,null,t.fX1),t.nI1(120,"ghsRange"),t.k0s(),t.j41(121,"div",120),t.Z7z(122,uA,5,1,"div",121,dn),t.nI1(124,"trackUUID"),t.k0s(),t.nVh(125,fA,3,3,"div",122),t.nI1(126,"ghsFloor"),t.k0s(),t.j41(127,"div",123)(128,"form",124),t.bIt("submit",function(){c.eBV(n);const e=t.sdS(132),o=t.XpG();return c.Njj(o.addCampaignSticker(e))}),t.j41(129,"label"),t.nrm(130,"span",21),t.k0s(),t.j41(131,"input",125,1),t.bIt("keyup.enter",function(){c.eBV(n);const e=t.sdS(132),o=t.XpG();return c.Njj(o.addCampaignSticker(e))}),t.k0s(),t.j41(133,"img",126),t.bIt("click",function(){c.eBV(n);const e=t.sdS(132),o=t.XpG();return c.Njj(o.addCampaignSticker(e))}),t.k0s()(),t.j41(134,"div",127),t.Z7z(135,vA,4,2,"div",128,j6),t.k0s()(),t.nrm(137,"ghs-party-buildings",129),t.nVh(138,OA,5,9,"div",130),t.k0s()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("ngClass",t.eq3(81,Gn,n.summer)),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.summer"),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet"),t.R7$(3),t.Y8G("ghs-label","party.campaign.manage"),t.R7$(),t.Y8G("ngClass",t.eq3(83,Gn,!n.summer)),t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.winter"),t.R7$(2),t.Y8G("ghs-tooltip","party.campaign.sheet.weekSections.lock")("ngClass",t.eq3(85,f6,"permissive"==n.settingsManager.settings.calendarLocked)),t.R7$(2),t.Y8G("src","./assets/images/lock"+(n.settingsManager.settings.calendarLocked?"":"-open")+".svg",t.B4B),t.R7$(),t.vxM(n.disableShortcuts?-1:16),t.R7$(),t.vxM(n.party.weeks==80+80*n.calendarSheet?17:-1),t.R7$(2),t.Dyx(t.i5U(21,57,t.lJ4(87,Ut),80)),t.R7$(5),t.Y8G("ghs-label","party.campaign.sheet.name"),t.R7$(),t.Y8G("value",n.party.name)("ghs-label","party.campaign.sheet.name")("ghs-label-attribute","placeholder"),t.R7$(),t.vxM(n.gameManager.game.scenario?-1:26),t.R7$(),t.vxM(n.gameManager.game.scenario?27:-1),t.R7$(4),t.Y8G("ghs-label","party.campaign.sheet.supply"),t.R7$(3),t.vxM(n.characters.length>0?34:-1),t.R7$(5),t.Y8G("value",n.party.loot.lumber||0),t.R7$(3),t.Y8G("value",n.party.loot.metal||0),t.R7$(3),t.Y8G("value",n.party.loot.hide||0),t.R7$(4),t.Y8G("value",n.party.loot.arrowvine||0),t.R7$(3),t.Y8G("value",n.party.loot.axenut||0),t.R7$(3),t.Y8G("value",n.party.loot.corpsecap||0),t.R7$(3),t.Y8G("value",n.party.loot.flamefruit||0),t.R7$(3),t.Y8G("value",n.party.loot.rockroot||0),t.R7$(3),t.Y8G("value",n.party.loot.snowthistle||0),t.R7$(3),t.Y8G("ghs-label","party.inspiration"),t.R7$(2),t.Y8G("value",n.party.inspiration||0)("ghs-label","party.inspiration")("ghs-label-attribute","placeholder"),t.R7$(3),t.Y8G("ghs-label","party.campaign.sheet.totalDefense"),t.R7$(2),t.Y8G("value",(n.party.defense||0)+n.moraleDefense)("ghs-label","party.campaign.sheet.totalDefense")("ghs-label-attribute","placeholder"),t.R7$(3),t.Y8G("ghs-label","party.campaign.sheet.soldiers"),t.R7$(3),t.Dyx(t.i5U(82,60,t.lJ4(88,Ut),4)),t.R7$(5),t.Y8G("ghs-label","party.morale"),t.R7$(2),t.Dyx(t.i5U(89,63,t.lJ4(89,Ut),21)),t.R7$(5),t.Y8G("ghs-label","party.campaign.sheet.defense"),t.R7$(2),t.Y8G("ngClass",t.eq3(90,Gn,n.party.morale>19)),t.R7$(),t.Dyx(t.brH(97,66,n.gameManager.campaignData().highMorale||t.lJ4(92,Ut),0,n.highMoraleSolved+1)),t.R7$(3),t.Y8G("ngClass",t.eq3(93,Gn,15==n.moraleDefense)),t.R7$(2),t.Y8G("ngClass",t.eq3(95,Gn,10==n.moraleDefense)),t.R7$(2),t.Y8G("ngClass",t.eq3(97,Gn,5==n.moraleDefense)),t.R7$(2),t.Y8G("ngClass",t.eq3(99,Gn,0==n.moraleDefense)),t.R7$(2),t.Y8G("ngClass",t.eq3(101,Gn,-5==n.moraleDefense)),t.R7$(2),t.Y8G("ngClass",t.eq3(103,Gn,-10==n.moraleDefense)),t.R7$(2),t.Y8G("ngClass",t.eq3(105,Gn,n.party.morale<1)),t.R7$(),t.Dyx(t.brH(113,70,n.gameManager.campaignData().lowMorale||t.lJ4(107,Ut),0,n.lowMoraleSolved+1)),t.R7$(5),t.Y8G("ghs-label","party.campaign.sheet.townGuardPerks"),t.R7$(2),t.Dyx(t.i5U(120,74,t.lJ4(108,Ut),45)),t.R7$(4),t.Dyx(t.bMT(124,77,n.gameManager.campaignData().townGuardPerks)),t.R7$(3),t.vxM(n.party.townGuardPerkSections.length>t.bMT(126,79,n.party.townGuardPerks/3)?125:-1),t.R7$(5),t.Y8G("ghs-label","party.campaign.sheet.campaignStickers"),t.R7$(),t.Y8G("autocomplete",n.campaignStickers)("emptyLabel","party.campaign.sheet.campaignStickers.empty")("ghs-label","party.campaign.sheet.campaignStickers")("ghs-label-attribute","placeholder"),t.R7$(3),t.Y8G("ngClass",t.eq3(109,oa,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.party)),t.R7$(),t.Dyx(n.party.campaignStickers),t.R7$(2),t.Y8G("party",n.party),t.R7$(),t.vxM(n.townGuardDeck&&n.townGuardDeck.cards.length>0?138:-1)}}function bA(a,r){if(1&a){const n=t.RV6();t.j41(0,"img",58),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.removeParty())}),t.k0s()}2&a&&t.Y8G("ghs-label","party.remove")("ghs-label-attribute","title")}function kA(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.JRh(n.name)}}function yA(a,r){if(1&a&&(t.j41(0,"span"),t.nrm(1,"span",21),t.EFF(2),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.Y8G("ghs-label","party.campaign"),t.R7$(),t.SpI("\xa0",n.id)}}function xA(a,r){if(1&a&&(t.j41(0,"option",52),t.nVh(1,kA,2,1,"span"),t.nVh(2,yA,3,2,"span"),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(4);t.Y8G("value",t.mNQ(n.id))("selected",n.id==i.party.id)("disabled",n.id==i.party.id),t.R7$(),t.vxM(n.name?1:-1),t.R7$(),t.vxM(n.name?-1:2)}}function EA(a,r){if(1&a){const n=t.RV6();t.j41(0,"select",51),t.bIt("change",function(e){c.eBV(n);const o=t.XpG(3);return c.Njj(o.selectParty(e))}),t.Z7z(1,xA,3,6,"option",52,dn),t.nI1(3,"trackUUID"),t.k0s()}if(2&a){const n=t.XpG(3);t.Y8G("ghs-label","party.change")("ghs-label-attribute","title"),t.R7$(),t.Dyx(t.bMT(3,2,n.gameManager.game.parties))}}function wA(a,r){if(1&a){const n=t.RV6();t.nVh(0,bA,1,2,"img",56),t.nVh(1,EA,4,4,"select",23),t.j41(2,"img",57),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.newParty())}),t.k0s()}if(2&a){const n=t.XpG(2);t.vxM(n.gameManager.game.parties.length>1?0:-1),t.R7$(),t.vxM(n.gameManager.game.parties.length>1&&!n.gameManager.game.scenario?1:-1),t.R7$(),t.Y8G("ghs-label","party.new")("ghs-label-attribute","title")}}function RA(a,r){1&a&&(t.j41(0,"div",28),t.nrm(1,"img",59),t.j41(2,"span",60)(3,"span",61),t.nrm(4,"span",21),t.k0s()()()),2&a&&(t.R7$(4),t.Y8G("ghs-label","party.new.hint"))}function jA(a,r){if(1&a){const n=t.RV6();t.nrm(0,"span",179),t.j41(1,"span",180),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG().$implicit,g=t.XpG(2);return c.Njj(g.unlockConclusion(g.reputationSectionsMapped[o][e].section,(g.party.factionReputation[o]||0)>=30-e-10))})("doubleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG().$implicit,g=t.XpG(2);return c.Njj(g.unlockConclusion(g.reputationSectionsMapped[o][e].section,(g.party.factionReputation[o]||0)>=30-e-10,!0))}),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG().$implicit,e=t.XpG(2);t.Y8G("ngClass",t.eq3(2,on,e.isConclusion(e.reputationSectionsMapped[i][n].section))),t.R7$(),t.Y8G("ghs-label","%game.section:"+e.reputationSectionsMapped[i][n].section+"%")}}function GA(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",175)(1,"span",177),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG().$implicit,g=t.XpG(2);return c.Njj(g.setFactionReputation(o,30-e-10))})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG().$implicit,g=t.XpG(2);return c.Njj(g.setFactionReputation(o,30-e-10,!0))}),t.k0s(),t.j41(2,"span",178),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG().$implicit,g=t.XpG(2);return c.Njj(g.setFactionReputation(o,30-e-10))})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG().$implicit,g=t.XpG(2);return c.Njj(g.setFactionReputation(o,30-e-10,!0))}),t.EFF(3),t.k0s(),t.j41(4,"span",134),t.nVh(5,jA,2,4),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG().$implicit,e=t.XpG(2);t.Y8G("ngClass",t.eq3(4,O6,30-n-10>12&&!e.factionUnlocks.includes(i))),t.R7$(),t.Y8G("ngClass",t.eq3(6,on,e.party.factionReputation[i]==30-n-10)),t.R7$(2),t.JRh(30-n-10),t.R7$(2),t.vxM(e.reputationSectionsMapped[i]&&e.reputationSectionsMapped[i][n]?5:-1)}}function TA(a,r){if(1&a&&(t.j41(0,"div",162)(1,"label"),t.nrm(2,"img",75)(3,"span",21),t.k0s(),t.j41(4,"div",41),t.Z7z(5,GA,6,8,"div",175,t.fX1),t.nI1(7,"ghsRange"),t.k0s(),t.nrm(8,"span",176),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(2),t.Y8G("src","./assets/images/gh2e/faction/"+n+".svg",t.B4B),t.R7$(),t.Y8G("ghs-label","party.reputation"),t.R7$(2),t.Dyx(t.i5U(7,3,t.lJ4(6,Ut),31)),t.R7$(3),t.Y8G("ngClass",t.eq3(7,on,(i.party.factionReputation[n]||0)>12))}}function SA(a,r){if(1&a&&(t.j41(0,"div",134),t.nrm(1,"span",179)(2,"span",181),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(3,on,i.isConclusion(n.section)||i.additionalReputation(n))),t.R7$(),t.Y8G("ghs-label","party.reputation.additional.special."+n.section.split(":")[0])("ghs-label-args",t.l_i(5,P6,n.section.split(":")[1],n.value))}}function DA(a,r){1&a&&t.nVh(0,SA,3,8,"div",134),2&a&&t.vxM("special"==r.$implicit.faction?0:-1)}function $A(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",134),t.nrm(1,"span",179),t.j41(2,"span",182),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(3);return c.Njj(o.unlockConclusion(e.section,o.additionalReputation(e)))})("doubleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(3);return c.Njj(o.unlockConclusion(e.section,o.additionalReputation(e),!0))}),t.k0s()()}if(2&a){const n=t.XpG().$implicit,i=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(3,on,i.isConclusion(n.section)||i.additionalReputation(n))),t.R7$(),t.Y8G("ghs-label","party.reputation.additional.sectionRequires"+(n.requires.length>1?".multiple":""))("ghs-label-args",t.ziG(5,b6,n.section,n.value,n.faction,n.requires.join(" & ")))}}function IA(a,r){if(1&a&&t.nVh(0,$A,3,10,"div",134),2&a){const n=r.$implicit,i=t.XpG().$implicit;t.vxM(n.faction==i&&n.requires&&n.requires.length?0:-1)}}function AA(a,r){if(1&a&&(t.j41(0,"div",162)(1,"div",81),t.nrm(2,"img",75),t.k0s(),t.Z7z(3,IA,1,1,null,null,dn),t.nI1(5,"trackUUID"),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(2),t.Y8G("src","./assets/images/gh2e/faction/"+n+".svg",t.B4B),t.R7$(),t.Dyx(t.bMT(5,1,i.reputationSections))}}function VA(a,r){1&a&&(t.j41(0,"span",134),t.EFF(1," +1 "),t.nrm(2,"img",186),t.k0s())}function FA(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",187),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG().$implicit,g=t.XpG(2);return c.Njj(g.unlockConclusion(g.imbuementSections[10*o+e+1],g.party.imbuement>=10*o+e+1))})("doubleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG().$implicit,g=t.XpG(2);return c.Njj(g.unlockConclusion(g.imbuementSections[10*o+e+1],g.party.imbuement>=10*o+e+1,!0))}),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG().$implicit,e=t.XpG(2);t.Y8G("ghs-label","%game.section:"+e.imbuementSections[10*i+n+1]+"%")}}function XA(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",183)(1,"div",179)(2,"span",184),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG().$implicit,g=t.XpG(2);return c.Njj(g.setImbuement(10*o+e+1))}),t.k0s(),t.nVh(3,VA,3,0,"span",134),t.nVh(4,FA,1,1,"span",185),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG().$implicit,e=t.XpG(2);t.Y8G("ngClass",t.l_i(4,Kr,n%10==4||e.imbuementSections[10*i+n+1],n%10==4)),t.R7$(),t.Y8G("ngClass",t.eq3(7,on,e.party.imbuement>=10*i+n+1)),t.R7$(2),t.vxM(n%10==4?3:-1),t.R7$(),t.vxM(e.imbuementSections[10*i+n+1]?4:-1)}}function BA(a,r){1&a&&(t.j41(0,"div",165)(1,"div",168),t.Z7z(2,XA,5,9,"div",183,t.fX1),t.nI1(4,"ghsRange"),t.k0s()()),2&a&&(t.R7$(2),t.Dyx(t.i5U(4,0,t.lJ4(3,Ut),10)))}function YA(a,r){1&a&&(t.j41(0,"div",134),t.EFF(1," +1 "),t.nrm(2,"img",186),t.k0s())}function UA(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",183)(1,"div",188),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG().$implicit,g=t.XpG(2);return c.Njj(g.setDonations(10*o+e+1))}),t.nVh(2,YA,3,0,"div",134),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG().$implicit,e=t.XpG(2);t.Y8G("ngClass",t.l_i(3,Kr,n%5==4,n%5==4)),t.R7$(),t.Y8G("ngClass",t.eq3(6,on,e.party.donations>=10*i+n+1)),t.R7$(),t.vxM(n%5==4?2:-1)}}function NA(a,r){1&a&&(t.j41(0,"div",165)(1,"div",168),t.Z7z(2,UA,3,8,"div",183,t.fX1),t.nI1(4,"ghsRange"),t.k0s()()),2&a&&(t.R7$(2),t.Dyx(t.i5U(4,0,t.lJ4(3,Ut),10)))}function zA(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",189),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG(2);return c.Njj(o.setProsperity(e+1))}),t.EFF(1),t.k0s()}if(2&a){const n=t.XpG().$index,i=t.XpG(2);t.R7$(),t.SpI(" ",i.prosperitySteps.indexOf(n)+2," ")}}function LA(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",187),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG(2);return c.Njj(o.unlockConclusion(o.prosperitySections[e],o.gameManager.prosperityTicks()>e))})("doubleClick",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG(2);return c.Njj(o.unlockConclusion(o.prosperitySections[e],o.gameManager.prosperityTicks()>e,!0))}),t.k0s()}if(2&a){const n=t.XpG().$index,i=t.XpG(2);t.Y8G("ghs-label","%game.section:"+i.prosperitySections[n]+"%")}}function qA(a,r){1&a&&t.nrm(0,"div",24)}function HA(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",183),t.nVh(1,zA,2,1,"div",173),t.j41(2,"div",179)(3,"span",184),t.bIt("singleClick",function(){const e=c.eBV(n).$index,o=t.XpG(2);return c.Njj(o.setProsperity(e+1))}),t.k0s(),t.nVh(4,LA,1,1,"span",185),t.k0s()(),t.nVh(5,qA,1,0,"div",24)}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.Y8G("ngClass",t.sMw(5,k6,e.prosperitySteps.includes(i),e.prosperitySections[i],33==n)),t.R7$(),t.vxM(e.prosperitySteps.includes(i)?1:-1),t.R7$(),t.Y8G("ngClass",t.l_i(9,Wr,e.gameManager.prosperityTicks()>i,!e.prosperitySteps.includes(i)&&e.prosperityHighlightSteps.includes(i))),t.R7$(2),t.vxM(e.prosperitySections[i]?4:-1),t.R7$(),t.vxM(32==n?5:-1)}}function KA(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",13)(1,"div",66)(2,"label",69),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.campaign=!0)}),t.nrm(3,"span",21),t.j41(4,"span",70),t.nrm(5,"img",20)(6,"span",21),t.k0s()()(),t.j41(7,"div",79)(8,"label"),t.nrm(9,"span",21),t.k0s(),t.j41(10,"input",27),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setName(e))}),t.k0s(),t.nVh(11,wA,3,4),t.nVh(12,RA,5,1,"div",28),t.k0s(),t.j41(13,"div",106)(14,"label"),t.nrm(15,"span",21),t.EFF(16,":"),t.k0s(),t.j41(17,"input",107),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setInspiration(e))}),t.k0s()(),t.j41(18,"div",161),t.Z7z(19,TA,9,9,"div",162,t.fX1),t.k0s(),t.j41(21,"div",163)(22,"label"),t.nrm(23,"span",21),t.k0s(),t.j41(24,"div",162),t.Z7z(25,DA,1,1,null,null,dn),t.nI1(27,"trackUUID"),t.k0s(),t.Z7z(28,AA,6,3,"div",162,t.fX1),t.k0s(),t.j41(30,"div",30)(31,"label"),t.nrm(32,"span",21),t.EFF(33,":"),t.k0s(),t.j41(34,"textarea",27),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.setNotes(e))}),t.k0s()(),t.j41(35,"div",164)(36,"label"),t.nrm(37,"span",21),t.k0s(),t.Z7z(38,BA,5,4,"div",165,t.fX1),t.nI1(40,"ghsRange"),t.k0s(),t.j41(41,"div",166)(42,"label"),t.nrm(43,"span",21),t.k0s(),t.Z7z(44,NA,5,4,"div",165,t.fX1),t.nI1(46,"ghsRange"),t.k0s(),t.j41(47,"div",167)(48,"div",168)(49,"div",169)(50,"span",170),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.setProsperity(0))}),t.k0s(),t.nrm(51,"img",171),t.j41(52,"span"),t.EFF(53,":"),t.k0s()(),t.j41(54,"div",172),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.setProsperity(0))}),t.j41(55,"div",173),t.EFF(56,"1"),t.k0s(),t.nrm(57,"div",174),t.k0s(),t.Z7z(58,HA,6,12,null,null,t.fX1),t.nI1(60,"ghsRange"),t.k0s()()()}if(2&a){const n=t.XpG();t.R7$(3),t.Y8G("ghs-label","party.campaign.sheet"),t.R7$(3),t.Y8G("ghs-label","party.campaign.manage"),t.R7$(3),t.Y8G("ghs-label","party.campaign.sheet.name"),t.R7$(),t.Y8G("value",n.party.name)("ghs-label","party.campaign.sheet.name")("ghs-label-attribute","placeholder"),t.R7$(),t.vxM(n.gameManager.game.scenario?-1:11),t.R7$(),t.vxM(n.gameManager.game.scenario?12:-1),t.R7$(3),t.Y8G("ghs-label","party.inspiration"),t.R7$(2),t.Y8G("value",n.party.inspiration||0)("ghs-label","party.inspiration")("ghs-label-attribute","placeholder"),t.R7$(2),t.Dyx(n.factions),t.R7$(4),t.Y8G("ghs-label","party.reputation.additional"),t.R7$(2),t.Dyx(t.bMT(27,23,n.reputationSections)),t.R7$(3),t.Dyx(n.factions),t.R7$(4),t.Y8G("ghs-label","party.notes"),t.R7$(2),t.Y8G("value",n.party.notes)("ghs-label","party.notes")("ghs-label-attribute","placeholder"),t.R7$(3),t.Y8G("ghs-label","party.imbuement"),t.R7$(),t.Dyx(t.i5U(40,25,t.lJ4(34,Ut),8)),t.R7$(5),t.Y8G("ghs-label","party.greatOak"),t.R7$(),t.Dyx(t.i5U(46,28,t.lJ4(35,Ut),10)),t.R7$(6),t.Y8G("ghs-label","party.prosperity")("ghs-tooltip","party.prosperity.reset"),t.R7$(),t.Y8G("ghs-tooltip","party.prosperity.reset"),t.R7$(3),t.Y8G("ghs-tooltip","party.prosperity.reset"),t.R7$(4),t.Dyx(t.i5U(60,31,t.lJ4(36,Ut),n.prosperitySteps[n.prosperitySteps.length-1]+1))}}function WA(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",190),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleFhSheet())}),t.nrm(1,"span",21),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","party.campaign.sheet."+(n.fhSheet?"disable":"enable"))}}function ZA(a,r){if(1&a){const n=t.RV6();t.j41(0,"img",55),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openMap())}),t.k0s()}2&a&&t.Y8G("ghs-tooltip","party.campaign.map")}function JA(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",25)(1,"img",53),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openFlowChart())}),t.k0s(),t.nVh(2,ZA,1,1,"img",54),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-tooltip","scenario.chart"),t.R7$(),t.vxM(n.worldMap?2:-1)}}function QA(a,r){if(1&a&&(t.j41(0,"option",194),t.nrm(1,"span",21),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("selected",n==i.partyEdition)("value",n),t.R7$(),t.Y8G("ghs-label","data.edition."+n)}}function tV(a,r){1&a&&t.nrm(0,"div",227)}function nV(a,r){if(1&a&&(t.j41(0,"div",228)(1,"span",231),t.nrm(2,"span",21),t.k0s()()),2&a){const n=t.XpG().$implicit;t.R7$(2),t.Y8G("ghs-label","data.edition."+n)}}function eV(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function aV(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function iV(a,r){if(1&a&&(t.EFF(0," #"),t.nVh(1,eV,2,0,"span"),t.nVh(2,aV,2,0,"span"),t.EFF(3)),2&a){const n=t.XpG().$implicit,i=t.XpG().$implicit,e=t.XpG(2);t.R7$(),t.vxM(e.maxScenario(e.scenarios[i])>2&&n.index.length<3?1:-1),t.R7$(),t.vxM(e.maxScenario(e.scenarios[i])>1&&n.index.length<2?2:-1),t.R7$(),t.SpI("",n.index," ")}}function oV(a,r){if(1&a&&t.nrm(0,"img",232),2&a){const n=t.XpG().$implicit,i=t.XpG(3);t.Y8G("src",i.characterIcon(n.solo),t.B4B)}}function sV(a,r){if(1&a&&t.nrm(0,"span",21),2&a){const n=t.XpG().$implicit;t.Y8G("ghs-label","data.scenario.group."+n.group)}}function rV(a,r){1&a&&t.nrm(0,"img",148)}function cV(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",239),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(3);return c.Njj(o.removeManual(e))}),t.nrm(1,"img",240)(2,"img",241),t.k0s()}2&a&&t.Y8G("ghs-label","party.campaign.scenarios.removeManual")("ghs-label-attribute","title")}function lV(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",242),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(3);return c.Njj(o.scenarioRequirements(e))}),t.nrm(1,"img",153),t.k0s()}2&a&&t.Y8G("ghs-tooltip","scenario.locked")}function gV(a,r){1&a&&(t.j41(0,"span",236),t.nrm(1,"img",243),t.k0s()),2&a&&t.Y8G("ghs-tooltip","scenario.summary.randomItemLooted")}function dV(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",244),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(3);return c.Njj(o.scenarioRewards(e))}),t.nrm(1,"img",245),t.k0s()}2&a&&t.Y8G("ghs-tooltip","scenario.summary.rewards")}function hV(a,r){if(1&a){const n=t.RV6();t.j41(0,"span")(1,"a",246),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(3);return c.Njj(o.removeSuccess(e))}),t.nrm(2,"img",247)(3,"img",241),t.k0s()()}2&a&&(t.R7$(),t.Y8G("ghs-label","party.campaign.scenarios.removeSuccess")("ghs-label-attribute","title"))}function _V(a,r){if(1&a){const n=t.RV6();t.j41(0,"span")(1,"a",248),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(3);return c.Njj(o.removeSuccess(e,!0))}),t.nrm(2,"img",247)(3,"img",241),t.k0s()()}2&a&&(t.R7$(),t.Y8G("ghs-label","party.campaign.scenarios.removeSuccessCasual")("ghs-label-attribute","title"))}function mV(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",229)(1,"span"),t.nVh(2,iV,4,3),t.nVh(3,oV,1,1,"img",232),t.k0s(),t.j41(4,"span"),t.nVh(5,sV,1,1,"span",21),t.k0s(),t.j41(6,"span",233),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.scenarioRequirements(e))}),t.nVh(7,rV,1,0,"img",148),t.nrm(8,"span",21),t.k0s(),t.j41(9,"span"),t.nrm(10,"span",24),t.nVh(11,cV,3,2,"a",234),t.nVh(12,lV,2,1,"span",235),t.nVh(13,gV,2,1,"span",236),t.nVh(14,dV,2,1,"span",236),t.Z7z(15,hV,4,2,"span",null,t.fX1),t.nI1(17,"ghsRange"),t.Z7z(18,_V,4,2,"span",null,t.fX1),t.nI1(20,"ghsRange"),t.j41(21,"a",237),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.addSuccess(e))})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.addSuccess(e,!0))}),t.nrm(22,"img",238),t.k0s()()()}if(2&a){const n=r.$implicit,i=t.XpG(3);t.R7$(2),t.vxM(n.solo?-1:2),t.R7$(),t.vxM(n.solo?3:-1),t.R7$(2),t.vxM(n.group?5:-1),t.R7$(),t.Y8G("ngClass",t.l_i(21,x6,n.isBlocked,!n.isBlocked&&n.isLocked))("ghs-tooltip",n.isBlocked?"scenario.blocked":n.isLocked?"scenario.locked":"")("toggable",!1),t.R7$(),t.vxM(n.isBlocked||n.isLocked?7:-1),t.R7$(),t.Y8G("ghs-label",i.gameManager.scenarioManager.scenarioTitle(n)),t.R7$(3),t.vxM(i.isManual(n)&&i.countFinished(n)<1?11:-1),t.R7$(),t.vxM(n.isLocked?12:-1),t.R7$(),t.vxM(i.hasRandomItemLooted(n)?13:-1),t.R7$(),t.vxM(i.countFinished(n)?14:-1),t.R7$(),t.Dyx(t.i5U(17,15,t.lJ4(24,Ut),i.countFinished(n))),t.R7$(3),t.Dyx(t.i5U(20,18,t.lJ4(25,Ut),i.countFinished(n,!0))),t.R7$(3),t.Y8G("ghs-label",n.isBlocked?"scenario.blocked":n.isLocked?"scenario.locked":"party.campaign.scenarios.addSuccess")("ghs-label-attribute","title")("ngClass",t.eq3(26,za,n.isBlocked||n.isLocked))}}function pV(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",230)(1,"input",249,4),t.bIt("keyup",function(){c.eBV(n);const e=t.sdS(2),o=t.sdS(4);return e.classList.remove("error"),c.Njj(o.classList.remove("error"))})("keyup.enter",function(){c.eBV(n);const e=t.sdS(2),o=t.sdS(4),g=t.XpG().$implicit,m=t.XpG(2);return c.Njj(m.unlockScenario(e,o,g))}),t.k0s(),t.j41(3,"input",249,5),t.bIt("keyup",function(){c.eBV(n);const e=t.sdS(2),o=t.sdS(4);return e.classList.remove("error"),c.Njj(o.classList.remove("error"))})("keyup.enter",function(){c.eBV(n);const e=t.sdS(2),o=t.sdS(4),g=t.XpG().$implicit,m=t.XpG(2);return c.Njj(m.unlockScenario(e,o,g))}),t.k0s(),t.j41(5,"a",37),t.bIt("click",function(){c.eBV(n);const e=t.sdS(2),o=t.sdS(4),g=t.XpG().$implicit,m=t.XpG(2);return c.Njj(m.unlockScenario(e,o,g))}),t.nrm(6,"span",21),t.EFF(7,"\xa0"),t.nrm(8,"img",38),t.k0s()()}2&a&&(t.R7$(),t.Y8G("ghs-label","party.campaign.scenarios.index")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","party.campaign.scenarios.group")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","party.campaign.scenarios.unlock")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","party.campaign.scenarios.unlock"))}function uV(a,r){if(1&a&&(t.nVh(0,tV,1,0,"div",227),t.nVh(1,nV,3,1,"div",228),t.Z7z(2,mV,23,28,"div",229,dn),t.nI1(4,"trackUUID"),t.nVh(5,pV,9,7,"div",230)),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.vxM(i>0?0:-1),t.R7$(),t.vxM(e.scenarioEditions.length>1?1:-1),t.R7$(),t.Dyx(t.bMT(4,3,e.scenarios[n])),t.R7$(3),t.vxM(1==e.scenarioEditions.length?5:-1)}}function fV(a,r){1&a&&t.nrm(0,"div",227)}function CV(a,r){if(1&a&&(t.j41(0,"div",228)(1,"span",231),t.nrm(2,"span",21),t.k0s()()),2&a){const n=t.XpG().$implicit;t.R7$(2),t.Y8G("ghs-label","data.edition."+n)}}function MV(a,r){1&a&&t.nrm(0,"div",227)}function vV(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function OV(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function PV(a,r){if(1&a&&t.nrm(0,"span",21),2&a){const n=t.XpG().$implicit;t.Y8G("ghs-label","data.scenario.group."+n.group)}}function bV(a,r){if(1&a&&t.nrm(0,"span",21),2&a){const n=t.XpG().$implicit,i=t.XpG(5);t.Y8G("ghs-label",i.gameManager.scenarioManager.scenarioTitle(n,!0))}}function kV(a,r){if(1&a&&t.nrm(0,"span",21),2&a){const n=t.XpG().$implicit;t.Y8G("ghs-label","%data.scenarioNumber:"+n.parent+"%")}}function yV(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",229)(1,"span"),t.EFF(2," #"),t.nVh(3,vV,2,0,"span"),t.nVh(4,OV,2,0,"span"),t.EFF(5),t.k0s(),t.j41(6,"span"),t.nVh(7,PV,1,1,"span",21),t.k0s(),t.j41(8,"span",250),t.nVh(9,bV,1,1,"span",21),t.nVh(10,kV,1,1,"span",21),t.k0s(),t.j41(11,"span"),t.nrm(12,"span",24),t.j41(13,"span",244),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(5);return c.Njj(o.scenarioRewards(e,!0))}),t.nrm(14,"img",245),t.k0s(),t.j41(15,"a",246),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2).$implicit,g=t.XpG(3);return c.Njj(g.removeConclusion(e.index,o))}),t.nrm(16,"img",247)(17,"img",241),t.k0s()()()}if(2&a){const n=r.$implicit,i=t.XpG(2).$implicit,e=t.XpG(3);t.R7$(3),t.vxM(e.maxScenario(e.conclusions[i])>2&&n.index.length<3?3:-1),t.R7$(),t.vxM(e.maxScenario(e.conclusions[i])>1&&n.index.length<2?4:-1),t.R7$(),t.SpI("",n.index," "),t.R7$(2),t.vxM(n.group?7:-1),t.R7$(2),t.vxM(n.named?9:-1),t.R7$(),t.vxM(n.parent?10:-1),t.R7$(3),t.Y8G("ghs-tooltip","scenario.summary.rewards"),t.R7$(2),t.Y8G("ghs-label","party.campaign.scenarios.removeSuccess")("ghs-label-attribute","title")}}function xV(a,r){if(1&a&&(t.nVh(0,MV,1,0,"div",227),t.j41(1,"div",228)(2,"span",231),t.nrm(3,"span",21),t.k0s()(),t.Z7z(4,yV,18,9,"div",229,dn),t.nI1(6,"trackUUID")),2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG(3);t.vxM(e>0?0:-1),t.R7$(3),t.Y8G("ghs-label","party.campaign.scenarios.conclusions"),t.R7$(),t.Dyx(t.bMT(6,2,o.conclusions[i]))}}function EV(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",230),t.nrm(1,"img",245),t.EFF(2," / "),t.nrm(3,"img",251),t.j41(4,"input",249,6),t.bIt("keyup",function(){c.eBV(n);const e=t.sdS(5);return c.Njj(e.classList.remove("error"))})("keyup.enter",function(){c.eBV(n);const e=t.sdS(5),o=t.XpG(4);return c.Njj(o.selectFinishConclusion(e))}),t.k0s(),t.j41(6,"a",37),t.bIt("click",function(){c.eBV(n);const e=t.sdS(5),o=t.XpG(4);return c.Njj(o.selectFinishConclusion(e))}),t.nrm(7,"span",21),t.EFF(8,"\xa0"),t.nrm(9,"img",38),t.k0s()()}2&a&&(t.R7$(4),t.Y8G("ghs-label","party.campaign.scenarios.index")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","party.campaign.scenarios.addConclusion")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","party.campaign.scenarios.addConclusion"))}function wV(a,r){if(1&a&&(t.nVh(0,fV,1,0,"div",227),t.nVh(1,CV,3,1,"div",228),t.nVh(2,xV,7,4),t.nVh(3,EV,10,5,"div",230)),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(3);t.vxM(i>0?0:-1),t.R7$(),t.vxM(e.scenarioEditions.length>1?1:-1),t.R7$(),t.vxM(e.conclusions[n]&&e.conclusions[n].length>0?2:-1),t.R7$(),t.vxM(1==e.scenarioEditions.length?3:-1)}}function RV(a,r){if(1&a&&(t.j41(0,"div",195)(1,"div",195),t.Z7z(2,wV,4,4,null,null,t.fX1),t.k0s()()),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(2,oa,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.party)),t.R7$(),t.Y8G("ngClass",t.eq3(4,oa,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.party)),t.R7$(),t.Dyx(n.scenarioEditions)}}function jV(a,r){if(1&a){const n=t.RV6();t.j41(0,"img",255),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.setProsperity(0))}),t.k0s()}2&a&&t.Y8G("ghs-tooltip","party.prosperity.reset")}function GV(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",256),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.setProsperity(0))}),t.nrm(1,"span",174),t.j41(2,"span"),t.EFF(3,":"),t.k0s()()}2&a&&t.Y8G("ghs-tooltip","party.prosperity.reset")}function TV(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",189),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG(3);return c.Njj(o.setProsperity(e+1))}),t.EFF(1),t.k0s()}if(2&a){const n=t.XpG().$index,i=t.XpG(3);t.R7$(),t.SpI(" ",i.prosperitySteps.indexOf(n)+2," ")}}function SV(a,r){if(1&a&&t.nrm(0,"span",257),2&a){const n=t.XpG().$index,i=t.XpG(3);t.Y8G("ghs-label","%game.section:"+i.prosperitySections[n]+"%")}}function DV(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",254),t.nVh(1,TV,2,1,"div",173),t.j41(2,"div",188),t.bIt("click",function(){const e=c.eBV(n).$index,o=t.XpG(3);return c.Njj(o.setProsperity(e+1))}),t.nVh(3,SV,1,1,"span",257),t.k0s()()}if(2&a){const n=r.$index,i=t.XpG(3);t.Y8G("autoscroll",i.gameManager.prosperityTicks()==n+1||0==i.gameManager.prosperityTicks()&&0==n)("ngClass",t.l_i(5,w6,i.prosperitySteps.includes(n),i.prosperitySections[n])),t.R7$(),t.vxM(i.prosperitySteps.includes(n)?1:-1),t.R7$(),t.Y8G("ngClass",t.l_i(8,Wr,i.gameManager.prosperityTicks()>n,i.prosperityHighlightSteps.includes(n))),t.R7$(),t.vxM(i.prosperitySections[n]?3:-1)}}function $V(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",197)(1,"div",169)(2,"div",173)(3,"span",170),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.setProsperity(0))}),t.k0s(),t.nVh(4,jV,1,1,"img",171),t.j41(5,"span"),t.EFF(6,":"),t.k0s(),t.j41(7,"img",252),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.settingsManager.toggle("wrapProsperity"))}),t.k0s()(),t.nVh(8,GV,4,1,"div",253),t.k0s(),t.j41(9,"div",168),t.Z7z(10,DV,4,11,"div",254,t.fX1),t.nI1(12,"ghsRange"),t.k0s()()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.l_i(10,E6,n.fhSheet,n.settingsManager.settings.wrapProsperity)),t.R7$(3),t.Y8G("ghs-label","party.prosperity")("ghs-tooltip","party.prosperity.reset"),t.R7$(),t.vxM(n.fhSheet?4:-1),t.R7$(3),t.Y8G("ghs-tooltip","party.prosperity.wrap."+(n.settingsManager.settings.wrapProsperity?"shrink":"expand"))("src","./assets/images/"+(n.settingsManager.settings.wrapProsperity?"shrink":"expand")+".svg",t.B4B),t.R7$(),t.vxM(n.fhSheet?-1:8),t.R7$(2),t.Dyx(t.i5U(12,7,t.lJ4(13,Ut),n.prosperitySteps[n.prosperitySteps.length-1]+1))}}function IV(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",258)(1,"div",259)(2,"div",188),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.setDonations(e+1))}),t.k0s(),t.nrm(3,"img",260),t.j41(4,"span",261),t.EFF(5,"+10g"),t.k0s()()()}if(2&a){const n=r.$implicit,i=t.XpG(3);t.R7$(2),t.Y8G("ngClass",t.eq3(1,on,i.party.donations>n))}}function AV(a,r){1&a&&(t.j41(0,"div",198)(1,"label"),t.nrm(2,"span",21),t.EFF(3,":"),t.k0s(),t.j41(4,"div",168),t.Z7z(5,IV,6,3,"div",258,t.fX1),t.nI1(7,"ghsRange"),t.k0s()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","party.campaign.donations"),t.R7$(3),t.Dyx(t.i5U(7,1,t.lJ4(4,Ut),10)))}function VV(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",264)(1,"span",265),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG().$implicit,g=t.XpG(4);return c.Njj(g.setDonations(10+e+18*o+1))}),t.k0s(),t.j41(2,"span",261),t.EFF(3),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG().$implicit,e=t.XpG(4);t.R7$(),t.Y8G("ngClass",t.l_i(2,R6,e.party.donations>10+n+18*i,10+n+18*i<40?(10+n+18*i)%5==4:(10+n+18*i)%10==9)),t.R7$(2),t.JRh(10*(11+n+18*i))}}function FV(a,r){1&a&&(t.j41(0,"div",111),t.Z7z(1,VV,4,5,"div",264,t.fX1),t.nI1(3,"ghsRange"),t.k0s()),2&a&&(t.R7$(),t.Dyx(t.i5U(3,0,t.lJ4(3,Ut),18)))}function XV(a,r){1&a&&(t.j41(0,"div",263),t.Z7z(1,FV,4,4,"div",111,t.fX1),t.nI1(3,"ghsRange"),t.k0s()),2&a&&(t.R7$(),t.Dyx(t.i5U(3,0,t.lJ4(3,Ut),5)))}function BV(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",199)(1,"label",262),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.toggleEnvelopeB())}),t.nrm(2,"div",179)(3,"span",21),t.k0s(),t.nVh(4,XV,4,4,"div",263),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ngClass",t.eq3(3,on,n.party.envelopeB)),t.R7$(),t.Y8G("ghs-label","party.campaign.envelopeB"),t.R7$(),t.vxM(n.party.envelopeB?4:-1)}}function YV(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.SpI(" ",n.split(":")[1],"x\xa0 ")}}function UV(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",34),t.nVh(1,YV,2,1,"span"),t.nrm(2,"span",21)(3,"span",24),t.j41(4,"span",62),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.removeGlobalAchievement(e))}),t.nrm(5,"img",63),t.k0s()()}if(2&a){const n=r.$implicit;t.R7$(),t.vxM(n.split(":").length>0&&"1"!=n.split(":")[1]?1:-1),t.R7$(),t.Y8G("ghs-label","data.globalAchievements."+n.split(":")[0])}}function NV(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",201)(1,"label"),t.nrm(2,"span",21),t.EFF(3,":"),t.k0s(),t.j41(4,"div",32)(5,"div",33),t.Z7z(6,UV,6,2,"div",34,t.fX1),t.k0s(),t.j41(8,"div",35)(9,"input",125,7),t.bIt("keyup.enter",function(){c.eBV(n);const e=t.sdS(10),o=t.XpG(2);return c.Njj(o.addGlobalAchievement(e))}),t.k0s(),t.j41(11,"a",37),t.bIt("click",function(){c.eBV(n);const e=t.sdS(10),o=t.XpG(2);return c.Njj(o.addGlobalAchievement(e))}),t.nrm(12,"img",38),t.k0s()()()()}if(2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","party.campaign.achievements"),t.R7$(4),t.Dyx(n.globalAchievementsList),t.R7$(3),t.Y8G("autocomplete",n.globalAchievements)("emptyLabel","party.addGlobalAchievement.empty")("ghs-label","party.addGlobalAchievement")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","party.addGlobalAchievement")("ghs-label-attribute","title")}}function zV(a,r){if(1&a&&(t.j41(0,"option",193),t.nrm(1,"span",21),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("value",n)("selected",n==i.itemEdition),t.R7$(),t.Y8G("ghs-label","data.edition."+n)}}function LV(a,r){if(1&a&&(t.j41(0,"span",275),t.EFF(1,"["),t.nrm(2,"span",21),t.EFF(3,"]"),t.k0s()),2&a){const n=t.XpG(2).$implicit;t.R7$(2),t.Y8G("ghs-label","data.edition."+n.edition)}}function qV(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",266),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(2);return c.Njj(o.openItem(e))}),t.nrm(1,"img",267),t.j41(2,"span",268),t.EFF(3),t.k0s()(),t.j41(4,"span",269),t.EFF(5,":"),t.k0s(),t.j41(6,"span",270),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(2);return c.Njj(o.removeItem(e))}),t.nrm(7,"img",271)(8,"img",272),t.k0s(),t.j41(9,"span",273),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(2);return c.Njj(o.openItem(e))}),t.k0s(),t.j41(10,"span",274),t.bIt("click",function(){c.eBV(n);const e=t.XpG(),o=e.$implicit,g=e.$index,m=t.XpG(2);return c.Njj(m.incItemCount(o,m.itemIdentifier[g]))}),t.EFF(11),t.k0s(),t.nVh(12,LV,4,1,"span",275)}if(2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG(2);t.R7$(),t.Y8G("src",i.slot?"./assets/images/items/slots/"+i.slot+".svg":"",t.B4B),t.R7$(2),t.JRh(i.id),t.R7$(6),t.Y8G("ghs-label","data.items."+i.edition+"-"+i.id),t.R7$(2),t.SpI(" ",o.itemIdentifier[e].count>0?o.itemIdentifier[e].count:"-"," "),t.R7$(),t.vxM(o.partyEdition&&o.itemEdition?-1:12)}}function HV(a,r){if(1&a&&(t.j41(0,"label",209),t.nVh(1,qV,13,5),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Zr,!i.partyEdition||!i.itemEdition)),t.R7$(),t.vxM(n?1:-1)}}function KV(a,r){if(1&a&&(t.j41(0,"option",193),t.nrm(1,"span",21),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("value",n)("selected",n==i.treasureEdition),t.R7$(),t.Y8G("ghs-label","data.edition."+n)}}function WV(a,r){if(1&a&&(t.j41(0,"span",61),t.EFF(1,"["),t.nrm(2,"span",21),t.EFF(3,"]"),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(2),t.Y8G("ghs-label","data.edition."+n.edition)}}function ZV(a,r){if(1&a){const n=t.RV6();t.j41(0,"label",215)(1,"span",276),t.nrm(2,"img",212),t.j41(3,"span",268),t.EFF(4),t.k0s()(),t.j41(5,"span",269),t.EFF(6,":"),t.k0s(),t.j41(7,"span",270),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.removeTreasure(e))}),t.nrm(8,"img",271)(9,"img",272),t.k0s(),t.j41(10,"span",61),t.nrm(11,"ghs-treasure-label",277),t.k0s(),t.nrm(12,"span"),t.nVh(13,WV,4,1,"span",61),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.eq3(5,Zr,!i.treasureEdition)),t.R7$(4),t.JRh(n.name),t.R7$(7),t.Y8G("edition",n.edition)("index",+n.name-1),t.R7$(2),t.vxM(i.treasureEdition?-1:13)}}function JV(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",281),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(4);return c.Njj(o.openCharacterSheet(e))})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(4);return c.Njj(o.replayCharacter(e))}),t.nrm(1,"img",75),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(4);t.Y8G("ghs-tooltip","character.replay.hint"),t.R7$(),t.Y8G("src",i.gameManager.characterManager.characterIcon(n.name,n.edition),t.B4B)}}function QV(a,r){if(1&a&&(t.j41(0,"div",279),t.Z7z(1,JV,2,2,"a",280,dn),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.R7$(),t.Dyx(t.bMT(3,0,i.availableCharacters[n]))}}function tF(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",218)(1,"span",268),t.EFF(2),t.k0s(),t.j41(3,"input",278),t.bIt("change",function(e){const o=c.eBV(n).$implicit,g=t.XpG(2);return c.Njj(g.changePlayer(e,o))}),t.k0s(),t.nVh(4,QV,4,2,"div",279),t.j41(5,"a",62),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.removePlayer(e))}),t.nrm(6,"img",148),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(2),t.SpI("#",n+1),t.R7$(),t.Y8G("value",i.party.players[n]),t.R7$(),t.vxM(i.availableCharacters[n]?4:-1)}}function nF(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",220)(1,"a",262),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.setupEvents())}),t.nrm(2,"span",21),t.k0s()()}2&a&&(t.R7$(2),t.Y8G("ghs-label","game.events.deck.setup"))}function eF(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",221)(1,"a",262),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.battleGoalSetup())}),t.nrm(2,"span",21),t.k0s()()}2&a&&(t.R7$(2),t.Y8G("ghs-label","game.battleGoals.setup"))}function aF(a,r){1&a&&(t.j41(0,"div",200)(1,"label"),t.nrm(2,"span",21),t.EFF(3,":"),t.k0s()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","party.campaign.retirements"))}function iF(a,r){1&a&&(t.j41(0,"span"),t.nrm(1,"span",21),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","party.campaign.retirements.masteries"))}function oF(a,r){1&a&&(t.j41(0,"span"),t.nrm(1,"img",247),t.k0s())}function sF(a,r){if(1&a&&t.Z7z(0,oF,2,0,"span",null,t.fX1),2&a){const n=t.XpG(2).$implicit;t.Dyx(n.progress.masteries)}}function rF(a,r){if(1&a&&(t.j41(0,"span"),t.nVh(1,sF,2,0),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.vxM(n.progress?1:-1)}}function cF(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",138)(1,"span"),t.EFF(2," #"),t.j41(3,"input",284),t.bIt("change",function(e){const o=c.eBV(n).$implicit,g=t.XpG(3);return c.Njj(g.setPlayerNumber(o,e))})("keyup",function(e){const o=c.eBV(n).$implicit,g=t.XpG(3);return c.Njj(g.setPlayerNumber(o,e))}),t.k0s()(),t.j41(4,"span",285),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.openCharacterSheet(e))})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.openCharacterSheet(e,!1))}),t.EFF(5),t.k0s(),t.j41(6,"span",286),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.openCharacterSheet(e))})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.openCharacterSheet(e,!1))}),t.k0s(),t.j41(7,"span"),t.EFF(8),t.k0s(),t.j41(9,"span"),t.EFF(10),t.k0s(),t.nVh(11,rF,2,1,"span"),t.j41(12,"span",287),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.reactivateCharacter(e))}),t.nrm(13,"img",288),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG(3);t.R7$(3),t.Y8G("value",n.number),t.R7$(2),t.JRh(n.title),t.R7$(),t.Y8G("ghs-label","data.character."+n.edition+"."+n.name),t.R7$(2),t.JRh(n.level),t.R7$(2),t.JRh(i.characterPerks(n)||"/"),t.R7$(),t.vxM(i.fhSheet?11:-1),t.R7$(),t.Y8G("ghs-label","party.campaign.retirements.reactivate")("ghs-label-attribute","title")}}function lF(a,r){if(1&a&&(t.j41(0,"div",222)(1,"div",282)(2,"div",283)(3,"span"),t.nrm(4,"span",21),t.k0s(),t.j41(5,"span"),t.nrm(6,"span",21),t.k0s(),t.j41(7,"span"),t.nrm(8,"span",21),t.k0s(),t.j41(9,"span"),t.nrm(10,"span",21),t.k0s(),t.j41(11,"span"),t.nrm(12,"span",21),t.k0s(),t.nVh(13,iF,2,1,"span"),t.nrm(14,"span"),t.k0s(),t.Z7z(15,cF,14,8,"div",138,dn),t.nI1(17,"trackUUID"),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(9,Lr,n.fhSheet)),t.R7$(3),t.Y8G("ghs-label","party.campaign.retirements.player"),t.R7$(2),t.Y8G("ghs-label","party.campaign.retirements.character"),t.R7$(2),t.Y8G("ghs-label","party.campaign.retirements.class"),t.R7$(2),t.Y8G("ghs-label","party.campaign.retirements.level"),t.R7$(2),t.Y8G("ghs-label","party.campaign.retirements.perks"),t.R7$(),t.vxM(n.fhSheet?13:-1),t.R7$(2),t.Dyx(t.bMT(17,7,n.party.retirements))}}function gF(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",15)(1,"div",18)(2,"span",19),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.campaign=!1)}),t.nrm(3,"img",20)(4,"span",21),t.k0s(),t.j41(5,"label",22),t.nrm(6,"span",21),t.k0s(),t.j41(7,"span",191),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleCampaignMode())}),t.nrm(8,"span",179)(9,"span",21),t.k0s(),t.nVh(10,JA,3,2,"span",25),t.k0s(),t.j41(11,"div",18)(12,"label",22),t.nrm(13,"span",21),t.k0s(),t.j41(14,"select",192),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.changeEdition(e))}),t.j41(15,"option",193),t.nrm(16,"span",21),t.k0s(),t.Z7z(17,QA,2,3,"option",194,t.fX1),t.k0s()(),t.j41(19,"div",195)(20,"div",196)(21,"span"),t.nrm(22,"span",21),t.k0s(),t.j41(23,"span"),t.nrm(24,"span",21),t.k0s(),t.j41(25,"span"),t.nrm(26,"span",21),t.k0s(),t.j41(27,"span"),t.nrm(28,"span",21),t.k0s()(),t.Z7z(29,uV,6,5,null,null,t.fX1),t.k0s(),t.nVh(31,RV,4,6,"div",195),t.nVh(32,$V,13,14,"div",197),t.nVh(33,AV,8,5,"div",198),t.nVh(34,BV,5,5,"div",199),t.j41(35,"div",200),t.nVh(36,NV,13,7,"div",201),t.k0s(),t.j41(37,"div",200)(38,"div",202)(39,"label"),t.nrm(40,"span",21),t.EFF(41,":"),t.k0s(),t.j41(42,"div",203)(43,"input",204,2),t.bIt("focus",function(){c.eBV(n);const e=t.sdS(44);return c.Njj(e.select())})("keyup",function(){c.eBV(n);const e=t.sdS(44);return e.classList.remove("error"),c.Njj(e.classList.remove("warning"))})("keyup.enter",function(){c.eBV(n);const e=t.sdS(44),o=t.XpG();return c.Njj(o.addItem(e,o.itemEdition||""))}),t.k0s(),t.j41(45,"a",205),t.bIt("click",function(){c.eBV(n);const e=t.sdS(44),o=t.XpG();return c.Njj(o.addItem(e,o.itemEdition||""))}),t.nrm(46,"img",38),t.k0s(),t.j41(47,"select",206),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.itemEdition,e)||(o.itemEdition=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.update())}),t.j41(48,"option",207),t.nrm(49,"span",21),t.k0s(),t.Z7z(50,zV,2,3,"option",193,t.fX1),t.k0s()(),t.j41(52,"div",208),t.Z7z(53,HV,2,4,"label",209,dn),t.nI1(55,"trackUUID"),t.k0s()()(),t.j41(56,"div",200)(57,"div",210)(58,"label",211),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.treasuresDialog())}),t.nrm(59,"img",212)(60,"span",21),t.EFF(61,":"),t.k0s(),t.j41(62,"div",213)(63,"input",204,3),t.bIt("focus",function(){c.eBV(n);const e=t.sdS(64);return c.Njj(e.select())})("keyup",function(){c.eBV(n);const e=t.sdS(64);return e.classList.remove("error"),c.Njj(e.classList.remove("warning"))})("keyup.enter",function(){c.eBV(n);const e=t.sdS(64),o=t.XpG();return c.Njj(o.addTreasure(e,o.treasureEdition))}),t.k0s(),t.j41(65,"a",205),t.bIt("click",function(){c.eBV(n);const e=t.sdS(64),o=t.XpG();return c.Njj(o.addTreasure(e,o.treasureEdition))}),t.nrm(66,"img",38),t.k0s(),t.j41(67,"select",206),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.treasureEdition,e)||(o.treasureEdition=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.update())}),t.j41(68,"option",207),t.nrm(69,"span",21),t.k0s(),t.Z7z(70,KV,2,3,"option",193,t.fX1),t.k0s()(),t.j41(72,"div",214),t.Z7z(73,ZV,14,7,"label",215,dn),t.nI1(75,"trackUUID"),t.k0s()()(),t.j41(76,"div",16)(77,"div",216)(78,"div",200)(79,"label"),t.nrm(80,"span",21),t.EFF(81,":"),t.k0s()(),t.j41(82,"div",217),t.Z7z(83,tF,7,3,"div",218,t.fX1),t.nI1(85,"ghsRange"),t.j41(86,"a",219),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.party.players[e.party.players.length]="")}),t.nrm(87,"img",38)(88,"span",21),t.k0s()()(),t.j41(89,"div",216),t.nVh(90,nF,3,1,"div",220),t.nVh(91,eF,3,1,"div",221),t.k0s()(),t.nVh(92,aF,4,1,"div",200),t.nVh(93,lF,18,11,"div",222),t.j41(94,"div",223),t.nrm(95,"span",224),t.nI1(96,"ghsDurationLabel"),t.nrm(97,"span",24),t.j41(98,"a",225),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.statistics())}),t.nrm(99,"img",226),t.k0s()()()}if(2&a){const n=t.sdS(44),i=t.sdS(64),e=t.XpG();t.R7$(4),t.Y8G("ghs-label","party.sheet"),t.R7$(2),t.Y8G("ghs-label","party.campaign"),t.R7$(2),t.Y8G("ngClass",t.eq3(48,on,e.party.campaignMode)),t.R7$(),t.Y8G("ghs-label","party.campaignMode"),t.R7$(),t.vxM(e.disableShortcuts?-1:10),t.R7$(3),t.Y8G("ghs-label","party.campaign.scenarios"),t.R7$(2),t.Y8G("value",void 0)("selected",!e.partyEdition),t.R7$(),t.Y8G("ghs-label","edition.all"),t.R7$(),t.Dyx(e.gameManager.editions()),t.R7$(2),t.Y8G("ngClass",t.eq3(50,oa,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.party)),t.R7$(3),t.Y8G("ghs-label","party.campaign.scenarios.index"),t.R7$(2),t.Y8G("ghs-label","party.campaign.scenarios.group"),t.R7$(2),t.Y8G("ghs-label","party.campaign.scenarios.name"),t.R7$(2),t.Y8G("ghs-label","party.campaign.scenarios.finished"),t.R7$(),t.Dyx(e.scenarioEditions),t.R7$(2),t.vxM(e.manualConclusions?31:-1),t.R7$(),t.vxM(e.gameManager.fhRules()||e.gameManager.editionRules("gh")?32:-1),t.R7$(),t.vxM(!e.fhSheet&&e.gameManager.editionRules("gh")?33:-1),t.R7$(),t.vxM(!e.fhSheet&&e.party.donations>9&&e.gameManager.editionRules("gh")?34:-1),t.R7$(2),t.vxM(e.gameManager.editionRules("gh")||e.gameManager.gh2eRules()?36:-1),t.R7$(4),t.Y8G("ghs-label","party.campaign.items"),t.R7$(5),t.Y8G("ngClass",t.eq3(52,za,!e.itemEdition||!n.value||+n.value<1||e.hasItem(n.value,e.itemEdition))),t.R7$(2),t.R50("ngModel",e.itemEdition),t.R7$(),t.Y8G("selected",!e.itemEdition),t.R7$(),t.Y8G("ghs-label","edition.all"),t.R7$(),t.Dyx(e.gameManager.editions()),t.R7$(3),t.Dyx(t.bMT(55,38,e.items)),t.R7$(7),t.Y8G("ghs-label","party.campaign.treasures"),t.R7$(5),t.Y8G("ngClass",t.eq3(54,za,!e.treasureEdition||!i.value||+i.value<1||e.hasTreasure(i.value,e.treasureEdition))),t.R7$(2),t.R50("ngModel",e.treasureEdition),t.R7$(),t.Y8G("selected",!e.treasureEdition),t.R7$(),t.Y8G("ghs-label","edition.all"),t.R7$(),t.Dyx(e.gameManager.editions()),t.R7$(3),t.Dyx(t.bMT(75,40,e.treasures())),t.R7$(7),t.Y8G("ghs-label","party.campaign.players"),t.R7$(3),t.Dyx(t.i5U(85,42,t.lJ4(56,Ut),e.party.players.length)),t.R7$(5),t.Y8G("ghs-label","party.campaign.players.add"),t.R7$(2),t.vxM(e.settingsManager.settings.events?90:-1),t.R7$(),t.vxM(e.settingsManager.settings.battleGoals?91:-1),t.R7$(),t.vxM(e.party.retirements&&e.party.retirements.length>0?92:-1),t.R7$(),t.vxM(e.party.retirements&&e.party.retirements.length>0?93:-1),t.R7$(2),t.Y8G("ghs-label","party.campaign.totalTime")("ghs-label-args",t.eq3(57,y6,t.i5U(96,45,e.gameManager.game.totalSeconds,!0))),t.R7$(3),t.Y8G("ghs-tooltip","scenario.stats")}}let Hn=(()=>{class a{data;dialogRef;dialog;ghsManager;gameManager=s.E;settingsManager=p.f;ghsInputFullScreenCheck=F.It;party;prosperitySteps=se.yF;prosperityHighlightSteps=se.yF;prosperitySections={};imbuementSections={};factions=[];factionUnlocks=[];reputationSections=[];reputationSectionsMapped={};priceModifier=0;moraleDefense=0;campaign=!1;partyEdition="";scenarioEditions=[];scenarios={};conclusions={};characters=[];worldMap=!1;items=[];itemIdentifier=[];itemEdition="";treasureEdition="";partyAchievements=[];globalAchievements=[];campaignStickers=[];manualConclusions=!1;partyAchievementsList=[];globalAchievementsList=[];availableCharacters=[];fhSheet=!1;gh2eSheet=!1;csSheet=!1;disableShortcuts=!1;LootType=rt.r6;townGuardDeck;calendarSheet=0;summer=!1;lowMoraleSolved=0;highMoraleSolved=0;itemIndex;treasureIndex;constructor(n,i,e,o){this.data=n,this.dialogRef=i,this.dialog=e,this.ghsManager=o,this.campaign=n&&n.campaign,this.party=s.E.game.party,this.disableShortcuts=n&&n.disableShortcuts,s.E.game.edition&&!this.party.edition&&(this.party.edition=s.E.game.edition),this.party.edition&&(this.partyEdition=this.party.edition),this.party.casualScenarios=this.party.casualScenarios||[],this.party.scenarios=this.party.scenarios||[],this.party.availableCharacters=this.party.availableCharacters||[],this.campaign||n&&n.partySheet||"jotl"!=this.partyEdition||(this.campaign=!0),s.E.game.conditions&&!this.party.conditions&&(this.party.conditions=s.E.game.conditions),s.E.game.battleGoalEditions&&!this.party.battleGoalEditions&&(this.party.battleGoalEditions=s.E.game.battleGoalEditions),s.E.game.filteredBattleGoals&&!this.party.filteredBattleGoals&&(this.party.filteredBattleGoals=s.E.game.filteredBattleGoals),s.E.game.unlockedCharacters&&!this.party.unlockedCharacters&&(this.party.unlockedCharacters=s.E.game.unlockedCharacters),s.E.game.lootDeckEnhancements&&!this.party.lootDeckEnhancements&&(this.party.lootDeckEnhancements=s.E.game.lootDeckEnhancements),s.E.game.lootDeckFixed&&!this.party.lootDeckFixed&&(this.party.lootDeckFixed=s.E.game.lootDeckFixed),s.E.game.lootDeckSections&&!this.party.lootDeckSections&&(this.party.lootDeckSections=s.E.game.lootDeckSections),s.E.game.figures.filter(g=>g instanceof H.K).map(g=>g).forEach(g=>{this.party.players[g.number-1]||(this.party.players[g.number-1]="")}),this.party.availableCharacters.forEach(g=>{this.party.players[g.number-1]||(this.party.players[g.number-1]="")}),this.itemEdition=this.partyEdition,this.treasureEdition=this.partyEdition}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:n=>{this.party!=s.E.game.party?(this.party=s.E.game.party,this.update()):this.updateAlways(),n&&this.townGuardDeck&&this.party.townGuardDeck&&s.E.attackModifierManager.fromModel(this.townGuardDeck,this.party.townGuardDeck)}}),this.update(),this.dialogRef.closed.subscribe({next:()=>{s.E.trialsManager.applyTrialCards()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}keyboardShortcuts(n){p.f.settings.keyboardShortcuts&&!this.disableShortcuts&&(!window.document.activeElement||"INPUT"!=window.document.activeElement.tagName&&"SELECT"!=window.document.activeElement.tagName&&"TEXTAREA"!=window.document.activeElement.tagName)&&(n.ctrlKey||n.shiftKey||"g"!==n.key.toLowerCase()||!this.worldMap?!n.ctrlKey&&!n.shiftKey&&"c"===n.key.toLowerCase()&&s.E.game.edition&&(this.openFlowChart(),n.stopPropagation(),n.preventDefault()):(this.openMap(),n.stopPropagation(),n.preventDefault()))}close(){(0,F.co)(this.dialogRef)}toggleCampaignMode(){s.E.stateManager.before(this.party.campaignMode?"disablePartyCampaignMode":"enablePartyCampaignMode"),this.party.campaignMode=!this.party.campaignMode,s.E.stateManager.after(),this.update()}openMap(){this.worldMap&&(this.dialogRef.close(),this.dialog.open(aa,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:this.partyEdition}))}openFlowChart(){this.dialogRef.close(),this.dialog.open(ia,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:{edition:this.partyEdition}})}changePlayer(n,i){s.E.stateManager.before("setPlayer",n.target.value,i+1),this.party.players[i]=n.target.value,s.E.stateManager.after()}removePlayer(n){s.E.stateManager.before("removePlayer",this.party.players[n],n+1),this.party.players.splice(n,1),s.E.stateManager.after()}unlockScenario(n,i,e){let o=n.value,g=i.value||void 0;const m=s.E.scenarioManager.scenarioData(e,!0).find(k=>k.index==o&&k.group==g);n.classList.add("error"),i.classList.add("error"),m&&!this.scenarios[e].find(k=>k.edition==m.edition&&k.group==m.group&&k.index==m.index)&&!this.party.manualScenarios.some(k=>k.index==m.index&&k.edition==m.edition&&k.group==m.group&&!k.isCustom)&&(s.E.stateManager.before("addManualScenario",...s.E.scenarioManager.scenarioUndoArgs(new ut.Nz(m))),s.E.game.party.manualScenarios.push(new ut.Ag(m.index,m.edition,m.group)),s.E.stateManager.after(),n.classList.remove("error"),n.value="",i.classList.remove("error"),i.value="",this.update())}setName(n){this.party.name!=n.target.value&&(s.E.stateManager.before("setPartyName",n.target.value),this.party.name=n.target.value,s.E.stateManager.after())}setLocation(n){this.party.location!=n.target.value&&(s.E.stateManager.before("setPartyLocation",n.target.value),this.party.location=n.target.value,s.E.stateManager.after())}setNotes(n){this.party.notes!=n.target.value&&(s.E.stateManager.before("setPartyNotes",n.target.value),this.party.notes=n.target.value,s.E.stateManager.after())}addAchievement(n){if(n.value){let i=n.value;Object.keys(p.f.label.data.partyAchievements).forEach(e=>{p.f.label.data.partyAchievements[e].toLowerCase()==i.toLowerCase()&&(i=e)}),s.E.stateManager.before("addPartyAchievement",i),this.party.achievementsList.push(i),s.E.stateManager.after(),n.value="",this.update()}}removeAchievement(n){const i=n.split(":")[0];s.E.stateManager.before("removePartyAchievement",i),this.party.achievementsList.splice(this.party.achievementsList.lastIndexOf(i),1),s.E.stateManager.after(),this.update()}addGlobalAchievement(n){if(n.value){let i=n.value;Object.keys(p.f.label.data.globalAchievements).forEach(e=>{p.f.label.data.globalAchievements[e].toLowerCase()==i.toLowerCase()&&(i=e)}),s.E.stateManager.before("addGlobalAchievement",i),this.party.globalAchievementsList.push(i),s.E.stateManager.after(),n.value="",this.update()}}removeGlobalAchievement(n){const i=n.split(":")[0];s.E.stateManager.before("removeGlobalAchievement",i),this.party.globalAchievementsList.splice(this.party.globalAchievementsList.lastIndexOf(i),1),s.E.stateManager.after(),this.update()}setReputation(n){this.party.reputation!=n&&(s.E.stateManager.before("setPartyReputation",n),n>20?n=20:n<-20&&(n=-20),this.party.reputation=n,s.E.stateManager.after(),this.update())}setFactionReputation(n,i,e=!1){!e&&i>12&&!this.factionUnlocks.includes(n)||this.party.factionReputation[n]!=i&&(s.E.stateManager.before("setFactionReputation",n,i),i>20?i=20:i<-10&&(i=-10),this.party.factionReputation[n]=i,s.E.stateManager.after(),this.reputationSections.filter(o=>o.faction==n&&i>=o.value&&!this.party.conclusions.find(g=>g.edition==s.E.game.edition&&g.index==o.section)&&(!o.requires||0==o.requires.length||o.requires.every(g=>this.party.scenarios.find(m=>m.edition==s.E.game.edition&&m.index==g)))).reverse().forEach(o=>{this.unlockConclusion(o.section,!0)}),this.update())}additionalReputation(n){return"special"!=n.faction||n.requires&&0!=n.requires.length?(this.party.factionReputation[n.faction]||0)>=n.value&&null!=n.requires&&n.requires.every(i=>null!=this.party.scenarios.find(e=>e.edition==s.E.currentEdition()&&e.index==i&&!e.group)):Object.keys(this.party.factionReputation).some(i=>(this.party.factionReputation[i]||0)>n.value)}unlockConclusion(n,i,e=!1){this.party.conclusions.find(o=>o.edition==s.E.game.edition&&o.index==n)?s.E.game.edition&&e?this.removeConclusion(n,s.E.game.edition):this.finishConclusion(n,!0):(i||e)&&this.finishConclusion(n,e)}characterPerks(n){return n.progress&&n.progress.perks&&n.progress.perks.length>0?n.progress.perks.reduce((i,e)=>i+e):0}setPlayerNumber(n,i){!isNaN(+i.target.value)&&n.number!=+i.target.value&&+i.target.value>0&&(s.E.stateManager.before("setPlayerNumber","data.character."+n.edition+"."+n.name,i.target.value),n.number=+i.target.value,s.E.stateManager.after())}reactivateCharacter(n){if(!s.E.game.figures.find(i=>i instanceof H.K&&i.name==n.name&&i.edition==n.edition)&&!s.E.game.party.availableCharacters.find(i=>i.name==n.name&&i.edition==n.edition)){s.E.stateManager.before("unsetRetired","data.character."+n.edition+"."+n.name);let i=new H.K(s.E.getCharacterData(n.name,n.edition),n.level);i.fromModel(n),i.progress.retired=!1,i.progress.personalQuestProgress=[],s.E.game.figures.push(i),this.party.retirements.splice(this.party.retirements.indexOf(n),1),s.E.stateManager.after()}}replayCharacter(n){let i=new H.K(s.E.getCharacterData(n.name,n.edition),n.level);i.fromModel(n),s.E.stateManager.before("characterReplay",s.E.characterManager.characterName(i,!0,!0),this.party.players[n.number-1]?this.party.players[n.number-1]:""+n.number),s.E.game.party.availableCharacters=s.E.game.party.availableCharacters.filter(e=>e.name!=i.name||e.edition!=i.edition||e.number!=i.number),s.E.game.figures.forEach(e=>{e instanceof H.K&&e.number==i.number&&(s.E.game.party.availableCharacters.push(e.toModel()),s.E.characterManager.removeCharacter(e))}),s.E.game.figures.push(i),s.E.stateManager.after(),this.update()}openCharacterSheet(n,i=!0){let e=new H.K(s.E.getCharacterData(n.name,n.edition),n.level);e.fromModel(n),this.dialog.open(An,{panelClass:["dialog-invert"],data:{character:e,viewOnly:i}}).closed.subscribe({next:()=>{if(n.progress&&JSON.stringify(n.progress.enhancements)!=JSON.stringify(e.progress.enhancements)){s.E.stateManager.before("changeRetiredCharacterEnhancements",s.E.characterManager.characterName(e,!0)),n.progress.enhancements=e.progress.enhancements;const o=s.E.game.figures.find(g=>g instanceof H.K&&g.edition==e.edition&&g.name==e.name);o&&s.E.characterManager.previousEnhancements(o,s.E.enhancementsManager.temporary),s.E.stateManager.after()}}})}removeParty(){s.E.game.parties.length>1&&(s.E.stateManager.before("removeParty",this.party.name||"%party% "+this.party.id),s.E.game.parties.splice(s.E.game.parties.indexOf(this.party),1),this.changeParty(s.E.game.parties[0]),s.E.stateManager.after())}newParty(){let n=new Ua.r;s.E.stateManager.before("addParty",n.name||"%party% "+n.id),this.addParty(n),s.E.stateManager.after()}addParty(n){let i=0;for(;s.E.game.parties.some(e=>e.id==i);)i++;n.id=i,s.E.game.parties.push(n),this.changeParty(n)}selectParty(n){const i=s.E.game.parties.find(e=>e.id==n.target.value);i&&(s.E.stateManager.before("changeParty",i.name||"%party% "+i.id),this.changeParty(i),s.E.stateManager.after())}changeParty(n){s.E.changeParty(n),this.update()}setDonations(n){this.party.donations==n&&n--,n<0&&(n=0),s.E.stateManager.before("setPartyDonations",""+n),this.party.donations=n,n<10&&(this.party.envelopeB=!1),s.E.stateManager.after()}toggleEnvelopeB(){s.E.stateManager.before(this.party.envelopeB?"disableEnvelopeB":"enableEnvelopeB"),this.party.envelopeB=!this.party.envelopeB,this.party.donations>10&&(this.party.donations=10),s.E.stateManager.after()}setProsperity(n){n-=s.E.prosperityTicks()-this.party.prosperity,this.party.prosperity==n&&n--,n>this.prosperitySteps[this.prosperitySteps.length-1]+1?n=this.prosperitySteps[this.prosperitySteps.length-1]+1:n<0&&(n=0),s.E.stateManager.before("setPartyProsperity",""+n),this.party.prosperity=n,s.E.stateManager.after(),Object.keys(this.prosperitySections).reverse().forEach(i=>{n>=+i&&!this.party.conclusions.find(e=>e.edition==s.E.game.edition&&e.index==this.prosperitySections[+i])&&this.unlockConclusion(this.prosperitySections[+i],!0)})}setImbuement(n){this.party.imbuement==n&&n--,n<0&&(n=0),s.E.stateManager.before("setPartyImbuement",""+n),this.party.imbuement=n,s.E.stateManager.after(),Object.keys(this.imbuementSections).reverse().forEach(i=>{n>=+i&&!this.party.conclusions.find(e=>e.edition==s.E.game.edition&&e.index==this.imbuementSections[+i])&&this.unlockConclusion(this.imbuementSections[+i],!0)})}exportParty(){const n=document.createElement("a");n.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(this.party))),n.setAttribute("download",(this.party.name?this.party.name+"_":"")+"campaign.json"),document.body.appendChild(n),n.click(),document.body.removeChild(n)}importParty(n){const i=n.target.parentElement;i.classList.remove("error");try{const e=new FileReader;e.addEventListener("load",o=>{const g=Object.assign(new Ua.r,JSON.parse(o.target.result));g?(s.E.stateManager.before("importParty"),g.id==this.party.id&&g.name&&g.name==this.party.name?s.E.game.party=g:this.addParty(g),this.party=s.E.game.party,s.E.stateManager.after()):i.classList.add("error")}),e.readAsText(n.target.files[0])}catch(e){console.warn(e),i.classList.add("error")}}countFinished(n,i=!1){return(i?this.party.casualScenarios:this.party.scenarios).filter(e=>n.index==e.index&&n.edition==e.edition&&n.group==e.group).length}hasRandomItemLooted(n){return null!=s.E.game.party.randomItemLooted.find(i=>i.edition==n.edition&&i.group==n.group&&i.index==n.index)}isManual(n){return null!=this.party.manualScenarios.find(i=>n.index==i.index&&n.edition==i.edition&&n.group==i.group)}addSuccess(n,i=!1){if(!s.E.scenarioManager.isBlocked(n)&&!s.E.scenarioManager.isLocked(n)||i){const e=s.E.sectionData(n.edition).filter(o=>o.edition==n.edition&&o.parent==n.index&&o.group==n.group&&o.conclusion&&0==s.E.scenarioManager.getRequirements(o).length);0==e.length?this.addSuccessIntern(n):this.dialog.open(Xn,{panelClass:["dialog"],data:{conclusions:e,parent:n}}).closed.subscribe({next:o=>{o&&this.addSuccessIntern(n,o)}})}}addSuccessIntern(n,i=void 0){s.E.stateManager.before("finishScenario.success",...s.E.scenarioManager.scenarioUndoArgs(new ut.Nz(n))),s.E.scenarioManager.finishScenario(new ut.Nz(n),!0,i,!1,!1,!1,s.E.game.party.campaignMode&&0==this.countFinished(n),!0),s.E.stateManager.after(),this.update()}removeSuccess(n,i=!1){const e=i?this.party.casualScenarios:this.party.scenarios,o=e.find(g=>g.index==n.index&&g.edition==n.edition&&g.group==n.group);o&&(s.E.stateManager.before("finishScenario.remove"+(i?"Casual":""),...s.E.scenarioManager.scenarioUndoArgs(new ut.Nz(n))),e.splice(e.indexOf(o),1),s.E.stateManager.after()),this.update()}removeManual(n){const i=this.party.manualScenarios.find(e=>e.index==n.index&&e.edition==n.edition&&e.group==n.group);i&&(s.E.stateManager.before("removeManualScenario",...s.E.scenarioManager.scenarioUndoArgs(new ut.Nz(n))),this.party.manualScenarios.splice(this.party.manualScenarios.indexOf(i),1),s.E.stateManager.after()),this.update()}scenarioRewards(n,i=!1){const e=this.party.conclusions.filter(o=>o.edition==n.edition).map(o=>s.E.sectionData(n.edition).find(g=>g.index==o.index&&g.edition==o.edition&&g.group==o.group)).find(o=>o.parent==n.index&&o.group==n.group);this.dialog.open(zt,{panelClass:["dialog"],data:{scenario:new ut.Nz(n),conclusion:e,success:!0,rewardsOnly:!0,conclusionOnly:i}})}scenarioRequirements(n){s.E.scenarioManager.isLocked(n)&&this.dialog.open(Ra,{panelClass:["dialog"],data:{scenarioData:n,hideMenu:!0}})}maxScenario(n){return Math.max(...n.map(i=>i.index.length))}changeEdition(n){this.partyEdition="undefined"!=n.target.value&&n.target.value||"",this.itemEdition=this.partyEdition,this.treasureEdition=this.partyEdition,this.update()}toggleFhSheet(){this.fhSheet=!this.fhSheet,this.fhSheet&&(this.csSheet=!1,this.gh2eSheet=!1),this.update(!this.fhSheet&&!s.E.fhRules())}update(n=!0){n&&(this.fhSheet=s.E.fhRules(),this.csSheet=!this.fhSheet&&s.E.editionRules("cs"),this.gh2eSheet=!this.csSheet&&s.E.gh2eRules());const i=this.partyEdition&&[this.partyEdition]||s.E.editions();this.scenarioEditions=[],i.forEach(g=>{let m=s.E.scenarioManager.scenarioData(g).filter(k=>!k.hideIndex&&(!k.spoiler||p.f.settings.spoilers.includes(k.name)||k.solo&&s.E.game.unlockedCharacters.includes(k.edition+":"+k.solo))).map(k=>new ut.jW(k,this.countFinished(k)>0,s.E.scenarioManager.isBlocked(k),s.E.scenarioManager.isLocked(k)));m.length>0&&(this.scenarios[g]=m.sort((k,X)=>k.group&&!X.group?1:!k.group&&X.group?-1:k.group&&X.group&&k.group!=X.group?k.group<X.group?-1:1:isNaN(+k.index)||isNaN(+X.index)?k.index.toLowerCase()<X.index.toLowerCase()?-1:1:+k.index-+X.index),this.scenarioEditions.push(g)),this.conclusions[g]=this.party.conclusions.filter(k=>k.edition==g).map(k=>s.E.sectionData(g).find(X=>X.index==k.index&&X.edition==k.edition&&X.group==k.group)).filter(k=>k&&!this.party.scenarios.find(X=>X.edition==k.edition&&X.group==k.group&&X.index==k.parent))}),this.manualConclusions=this.partyEdition&&null!=s.E.sectionData(this.partyEdition).find(g=>g.conclusion&&!g.parent)||!1,this.priceModifier=this.party.reputation>=0?-1*Math.ceil((this.party.reputation-2)/4):-1*Math.floor((this.party.reputation+2)/4),this.moraleDefense=this.party.morale<3?-10:this.party.morale<5?-5:this.party.morale<8?0:this.party.morale<11?5:this.party.morale<14?10:15;const e=s.E.campaignData();if(e.townGuardPerks&&(this.townGuardDeck=s.E.attackModifierManager.buildTownGuardAttackModifierDeck(this.party,e),this.party.townGuardDeck?s.E.attackModifierManager.fromModel(this.townGuardDeck,this.party.townGuardDeck):(s.E.attackModifierManager.shuffleModifiers(this.townGuardDeck),this.townGuardDeck.active=!1,this.party.townGuardDeck=this.townGuardDeck.toModel())),e.factions&&(this.factions=e.factions,this.factions.forEach(g=>{this.party.factionReputation[g]||(this.party.factionReputation[g]=0)}),this.factionUnlocks=s.E.gh2eFactionUnlocks()),e.reputationSections&&(this.reputationSections=e.reputationSections,this.reputationSectionsMapped={},this.reputationSections.forEach(g=>{this.reputationSectionsMapped[g.faction]=this.reputationSectionsMapped[g.faction]||[],(!g.requires||0==g.requires.length)&&(this.reputationSectionsMapped[g.faction][30-g.value-10]=g)})),this.calendarSheet=Math.floor(Math.max(this.party.weeks-1,0)/80),this.characters=s.E.game.figures.filter(g=>g instanceof H.K&&Object.keys(g.progress.loot).some(m=>g.progress.loot[m])).map(g=>g),this.prosperitySteps=this.fhSheet?se.b9:this.gh2eSheet?se.fH:se.yF,this.fhSheet&&(this.prosperityHighlightSteps=[],this.prosperitySteps.forEach((g,m)=>{const k=m>0?this.prosperitySteps[m-1]+1:0;for(let X=k;X<g;X++)(X-k)%5==4&&this.prosperityHighlightSteps.push(X)})),this.gh2eSheet){this.prosperityHighlightSteps=[];for(let g=0;g<=Math.max(...this.prosperitySteps);g++)g%5==3&&this.prosperityHighlightSteps.push(g)}else this.prosperityHighlightSteps=this.prosperitySteps;e&&e.prosperitySections&&(this.prosperitySections=e.prosperitySections),e&&e.imbuementSections&&(this.imbuementSections=e.imbuementSections),this.partyAchievements=[],this.globalAchievements=[],this.campaignStickers=[],this.worldMap=!1;const o=s.E.editionData.find(g=>this.partyEdition&&g.edition==this.partyEdition);if(o&&((o.worldMap||o.extendWorldMap)&&(this.worldMap=!0),this.updateAchievements(o),!o.additional&&o.extensions&&o.extensions.forEach(g=>{const m=s.E.editionData.find(k=>k.edition==g);m&&this.updateAchievements(m)})),this.partyAchievementsList=this.party.achievementsList.map((g,m,k)=>g+":"+k.filter(X=>X==g).length).filter((g,m,k)=>k.indexOf(g)==m),this.globalAchievementsList=this.party.globalAchievementsList.map((g,m,k)=>g+":"+k.filter(X=>X==g).length).filter((g,m,k)=>k.indexOf(g)==m),this.itemIdentifier=this.party.unlockedItems.filter(g=>!this.itemEdition||g.edition==this.itemEdition).sort((g,m)=>this.partyEdition||g.edition==m.edition?+g.name-+m.name:s.E.editions().indexOf(g.edition)-s.E.editions().indexOf(m.edition)),this.items=this.itemIdentifier.map(g=>s.E.itemManager.getItem(g.name,g.edition,!0)).filter(g=>!!g),this.summer=Math.max(this.party.weeks,0)%20<10,e){if(e.lowMorale&&e.lowMorale.length)for(this.lowMoraleSolved=0;this.isConclusion(e.lowMorale[this.lowMoraleSolved])&&this.lowMoraleSolved<e.lowMorale.length;)this.lowMoraleSolved++;if(e.highMorale&&e.highMorale.length)for(this.highMoraleSolved=0;this.isConclusion(e.highMorale[this.highMoraleSolved])&&this.highMoraleSolved<e.highMorale.length;)this.highMoraleSolved++}this.updateAlways()}updateAchievements(n){n.label&&n.label[p.f.settings.locale]&&n.label[p.f.settings.locale].partyAchievements?this.partyAchievements.push(...Object.keys(n.label[p.f.settings.locale].partyAchievements).map(i=>new ta(n.label[p.f.settings.locale].partyAchievements[i],i,this.party.achievementsList.includes(i)))):n.label&&n.label.en&&n.label.en.partyAchievements&&this.partyAchievements.push(...Object.keys(n.label.en.partyAchievements).map(i=>new ta(n.label.en.partyAchievements[i],i,this.party.achievementsList.includes(i)))),n.label&&n.label[p.f.settings.locale]&&n.label[p.f.settings.locale].globalAchievements&&this.globalAchievements.push(...Object.keys(n.label[p.f.settings.locale].globalAchievements).map(i=>new ta(n.label[p.f.settings.locale].globalAchievements[i],i,this.party.globalAchievementsList.includes(i)))),n.label&&n.label.en&&n.label.en.globalAchievements&&Object.keys(n.label.en.globalAchievements).map(i=>new ta(n.label.en.globalAchievements[i],i,this.party.globalAchievementsList.includes(i))).forEach(i=>{this.globalAchievements.every(e=>i.value!=e.value)&&this.globalAchievements.push(i)}),n.campaign&&n.campaign.campaignStickers&&this.campaignStickers.push(...n.campaign.campaignStickers.map(i=>(i=i.split(":")[0],new ta(p.f.getLabel("data.campaignSticker."+i),i,this.party.campaignStickers.includes(i)))))}updateAlways(){this.availableCharacters=[],this.party.availableCharacters.forEach(n=>{this.availableCharacters[n.number-1]=this.availableCharacters[n.number-1]||[],this.availableCharacters[n.number-1].push(n)})}characterIcon(n){return s.E.characterManager.characterIcon(n)}addItem(n,i){const e=n.value;if(e&&i)if(this.hasItem(e,i))n.classList.add("warning");else{n.classList.add("error");const o=s.E.itemManager.getItems(i,!0).find(g=>e==""+g.id);o&&(s.E.stateManager.before("addUnlockedItem",i,e,o.name),this.party.unlockedItems=this.party.unlockedItems||[],this.party.unlockedItems.push(new yt.VP(e,i)),this.itemIndex.nativeElement.value="",n.classList.remove("error"),s.E.stateManager.after(),this.update())}}hasItem(n,i){return this.party.unlockedItems&&this.party.unlockedItems.some(e=>e.name==n&&e.edition==i)}removeItem(n){const i=this.party.unlockedItems.find(e=>e.name==""+n.id&&e.edition==n.edition);i&&(s.E.stateManager.before("removeUnlockedItem",n.edition,n.id,n.name),this.party.unlockedItems.splice(this.party.unlockedItems.indexOf(i),1),s.E.stateManager.after(),this.update())}openItem(n){this.dialog.open(fn,{panelClass:["fullscreen-panel"],disableClose:!0,data:{item:n}})}incItemCount(n,i){s.E.stateManager.before("updateUnlockedItemCount",n.edition,n.id,n.name),i.count<0?i.count=1:(i.count+=1,i.count>=n.count&&(i.count=-1)),s.E.stateManager.after()}treasuresDialog(){this.dialog.open(Vr,{panelClass:["dialog"],data:{party:this.party,edition:this.treasureEdition}})}treasures(){return this.party.treasures.filter(n=>!this.treasureEdition||n.edition==this.treasureEdition).sort((n,i)=>this.treasureEdition||n.edition==i.edition?+n.name-+i.name:s.E.editions().indexOf(n.edition)-s.E.editions().indexOf(i.edition))}addTreasure(n,i){const e=n.value;if(e&&!isNaN(+e)&&i)if(this.hasTreasure(e,i))n.classList.add("warning");else{n.classList.add("error");const o=s.E.editionData.find(g=>g.edition==i);if(o&&o.treasures){const g=+e-(o.treasureOffset||0)-1;g>=0&&g<o.treasures.length&&(s.E.stateManager.before("addTreasure",i,e),this.party.treasures=this.party.treasures||[],this.party.treasures.push(new yt.gw(e,i)),this.treasureIndex.nativeElement.value="",n.classList.remove("error"),s.E.stateManager.after())}}}hasTreasure(n,i){return this.party.treasures&&this.party.treasures.some(e=>e.name==n&&e.edition==i)}removeTreasure(n){s.E.stateManager.before("removeTreasure",n.edition,n.name),this.party.treasures.splice(this.party.treasures.indexOf(n),1),s.E.stateManager.after()}sectionsForWeekFixed(n){const i=s.E.campaignData();return i.weeks&&i.weeks[n+1]&&i.weeks[n+1]||[]}sectionsForWeek(n){return this.party.weekSections&&this.party.weekSections[n+1]&&this.party.weekSections[n+1]||[]}isConclusion(n){return!!n&&null!=this.party.conclusions.find(i=>i.edition==s.E.game.edition&&i.index==n)}hasConclusions(n){const i=s.E.sectionData(s.E.game.edition).filter(e=>e.conclusion&&!e.parent&&e.parentSections&&e.parentSections.find(o=>1==o.length&&o.includes(n)));return i.length>0&&i.every(e=>!s.E.game.party.conclusions.find(o=>o.edition==e.edition&&o.index==e.index&&o.group==e.group))}openConclusions(n,i=-1){let e=s.E.sectionData(s.E.game.edition).filter(o=>o.conclusion&&!o.parent&&o.parentSections&&o.parentSections.find(g=>1==g.length&&g.includes(n))&&0==s.E.scenarioManager.getRequirements(o).length).map(o=>o);e.length>0&&this.dialog.open(Xn,{panelClass:["dialog"],data:{conclusions:e,parent:s.E.sectionData(s.E.game.edition).find(o=>o.index==n&&!o.group)}}).closed.subscribe({next:o=>{if(o){const g=new ut.Nz(o);-1!=i?(s.E.stateManager.before("finishConclusion",...s.E.scenarioManager.scenarioUndoArgs(g)),s.E.scenarioManager.finishScenario(g,!0,g,!1,!1,!1,s.E.game.party.campaignMode,!0),g.repeatable||(this.party.weekSections[i]=[...this.party.weekSections[i]||[],g.index]),s.E.stateManager.after(),this.dialog.open(zt,{panelClass:["dialog"],data:{scenario:g,conclusionOnly:!0}})):this.finishConclusion(g.index)}}})}selectFinishConclusion(n,i=!1){let e=n.value;n.classList.add("error");const o=s.E.sectionData(this.partyEdition||s.E.currentEdition()).find(g=>g.index==e);o&&(n.classList.remove("error"),i||!this.party.conclusions.find(g=>g.edition==o.edition&&g.group==o.group&&g.index==o.index)?(n.value="",this.finishConclusion(e,i)):n.classList.add("warning"))}finishConclusion(n,i=!1){const e=s.E.sectionData(this.partyEdition||s.E.currentEdition()).find(o=>o.index==n);if(e&&(i||!this.party.conclusions.find(o=>o.edition==e.edition&&o.group==e.group&&o.index==e.index))){const o=new ut.Nz(e);this.hasConclusions(o.index)?this.openConclusions(o.index):this.dialog.open(zt,{panelClass:["dialog"],data:{scenario:o,conclusionOnly:!0}}).closed.subscribe({next:()=>this.update()})}}removeConclusion(n,i){s.E.stateManager.before("removeConclusion",s.E.game.party.name,n),s.E.game.party.conclusions=s.E.game.party.conclusions.filter(e=>e.edition!=i||e.index!=n),s.E.stateManager.after(),this.update()}setWeek(n){if(p.f.settings.calendarLocked&&("permissive"!=p.f.settings.calendarLocked||this.party.weeks!=n-1&&this.party.weeks!=n))return;this.party.weeks==n&&n--,n<0&&(n=0);let i=[];for(let e=this.party.weeks;e<n;e++)this.sectionsForWeekFixed(e).forEach(o=>{this.hasConclusions(o)&&!i.includes(o)&&i.push(o)}),this.sectionsForWeek(e).forEach(o=>{this.hasConclusions(o)&&!i.includes(o)&&i.push(o)});i.forEach(e=>{this.openConclusions(e,n)}),s.E.stateManager.before("setPartyWeeks",""+n);for(let e=this.party.weeks;e<n;e++)[...this.sectionsForWeekFixed(e),...this.sectionsForWeek(e)].forEach(g=>{const m=s.E.sectionData(s.E.game.edition).find(k=>k.index==g&&k.conclusion);m&&!s.E.game.party.conclusions.find(k=>k.edition==m.edition&&k.index==m.index&&k.group==m.group)&&s.E.scenarioManager.finishScenario(new ut.Nz(m),!0,void 0,!1,!1,!1,s.E.game.party.campaignMode,!0)});this.party.weeks=n,s.E.stateManager.after(),this.update()}setWeekSection(n){this.dialog.open(_6,{panelClass:["dialog-invert"],data:n})}setResource(n,i){isNaN(+i.target.value)||(s.E.stateManager.before("setPartyResource",this.party.name,"game.loot."+n,i.target.value),this.party.loot[n]=+i.target.value,s.E.stateManager.after())}moveResources(n){this.dialog.open(Ni,{panelClass:["dialog"],data:{character:n}}).closed.subscribe({next:()=>this.update()})}openResources(){this.dialog.open($r,{panelClass:["dialog"]})}setInspiration(n){!isNaN(+n.target.value)&&this.party.inspiration!=+n.target.value&&(s.E.stateManager.before("setPartyInspiration",this.party.name,n.target.value),this.party.inspiration=+n.target.value,s.E.stateManager.after())}setTotalDefense(n){if(!isNaN(+n.target.value)){const i=+n.target.value-this.moraleDefense;this.party.defense!=i&&(s.E.stateManager.before("setPartyTotalDefense",this.party.name,i),this.party.defense=i,s.E.stateManager.after())}}setSoldiers(n,i=!1){this.party.soldiers==n&&n--,n<0&&(n=0),n<this.party.soldiers||i?(s.E.stateManager.before("setPartySoldiers",""+n),this.party.soldiers=n,s.E.stateManager.after()):this.soldierAvailable()&&n==this.party.soldiers+1&&this.dialog.open(ea,{panelClass:["dialog"],data:{costs:{gold:3},repair:1,action:"soldiers"}}).closed.subscribe({next:e=>{e&&(s.E.stateManager.before("setPartySoldiers",""+n),this.party.soldiers=n,e instanceof Bn.CS&&s.E.lootManager.applySelectResources(e),s.E.stateManager.after())}})}soldierAvailable(){if(!this.party.campaignMode)return!0;const n=this.party.buildings.find(i=>"barracks"==i.name&&i.level>0&&"normal"==i.state);if(n&&this.party.soldiers<2+2*n.level){const i=s.E.game.figures.filter(e=>e instanceof H.K).map(e=>e);if(i.length>0){const e=i.map(m=>m.progress.gold).reduce((m,k)=>m+k),o=i.map(m=>(m.progress.loot.hide||0)+(m.progress.loot.lumber||0)+(m.progress.loot.metal||0)).reduce((m,k)=>m+k);if(e>3&&o+((this.party.loot.hide||0)+(this.party.loot.lumber||0)+(this.party.loot.metal||0))>0)return!0}}return!1}setMorale(n){this.party.morale==n&&n--,n<0&&(n=0),n>20&&(n=20),s.E.stateManager.before("setPartyMorale",""+n),this.party.morale=n;const i=s.E.campaignData();0==n&&i&&i.lowMorale&&this.lowMoraleSolved<=i.lowMorale.length?this.lowMoraleSolved<i.lowMorale.length?this.finishConclusion(i.lowMorale[this.lowMoraleSolved]):(this.party.conclusions=this.party.conclusions.filter(e=>e.edition!=s.E.game.edition||e.index!=i.lowMorale[this.lowMoraleSolved-1]),this.finishConclusion(i.lowMorale[this.lowMoraleSolved-1])):20==n&&i&&i.highMorale&&this.highMoraleSolved<i.highMorale.length&&this.finishConclusion(i.highMorale[this.highMoraleSolved]),s.E.stateManager.after(),this.update()}setTownGuardPerks(n){this.party.townGuardPerks==n&&n--,n<0&&(n=0),s.E.stateManager.before("setPartyTownGuardPerks",""+n),this.party.townGuardPerks=n,s.E.stateManager.after()}toggleTownGuardPerkSection(n,i=!1){this.party.townGuardPerkSections=this.party.townGuardPerkSections||[];const e=this.party.townGuardPerkSections.indexOf(n);if(-1!=e||this.party.townGuardPerkSections.length<Math.floor(this.party.townGuardPerks/3)||i){s.E.stateManager.before(-1==e?"addPartyTownGuardPerkSection":"removePartyTownGuardPerkSection",n),-1==e?(this.party.townGuardPerkSections.push(n),this.finishConclusion(n)):this.party.townGuardPerkSections.splice(e,1);const o=this.townGuardDeck&&this.townGuardDeck.active||!1;this.townGuardDeck=s.E.attackModifierManager.buildTownGuardAttackModifierDeck(this.party,s.E.campaignData()),this.townGuardDeck.active=o,s.E.attackModifierManager.shuffleModifiers(this.townGuardDeck),this.party.townGuardDeck=this.townGuardDeck.toModel(),s.E.stateManager.after()}}addCampaignSticker(n){const i=n.value,e=this.campaignStickers.find(o=>o.label==i);if(e){this.party.campaignStickers=this.party.campaignStickers||[];let o=0;const g=s.E.campaignData();if(g.campaignStickers){const k=g.campaignStickers.find(X=>X.startsWith(e.value));k&&(o=k.includes(":")?+k.split(":")[1]:1)}this.party.campaignStickers.filter(k=>k.toLowerCase()==e.value).length<o&&(s.E.stateManager.before("addCampaignSticker",e.label),this.party.campaignStickers.push(e.value),n.value="",s.E.stateManager.after(),this.update())}}removeCampaignSticker(n){const i=this.party.campaignStickers.indexOf(n);-1!=i&&(s.E.stateManager.before("removeCampaignSticker",n),this.party.campaignStickers.splice(i,1),s.E.stateManager.after(),this.update())}campaignStickerImage(n,i){const e=s.E.campaignData();let o=0;if(e.campaignStickers){const g=e.campaignStickers.find(m=>m==n||m.startsWith(n));g&&(o=g.includes(":")?+g.split(":")[1]:1)}if(1==o)return"./assets/images/fh/party/campaign-stickers/"+n+".png";if(o>1){const m=this.party.campaignStickers.map((k,X)=>({sticker:k.toLowerCase().replaceAll(" ","-"),origIndex:X})).filter(k=>k.sticker==n).map((k,X)=>({sticker:k.sticker,origIndex:k.origIndex,index:X+1})).find(k=>k.origIndex==i);if(m)return"./assets/images/fh/party/campaign-stickers/"+n+"-"+m.index+".png"}}beforeTownGuardDeck(n){s.E.stateManager.before("updateAttackModifierDeck."+n.type,"party.campaign.townGuard",...n.values)}afterTownGuardDeck(n){this.townGuardDeck=n.deck,this.party.townGuardDeck=this.townGuardDeck.toModel(),s.E.stateManager.after()}toggleTownGuardDeck(){this.townGuardDeck&&(this.beforeTownGuardDeck(new mt(this.townGuardDeck,this.townGuardDeck.active&&!s.E.game.lootDeck.active?"amDeckHide":"amDeckShow")),this.townGuardDeck.active=!this.townGuardDeck.active,this.afterTownGuardDeck(new mt(this.townGuardDeck,this.townGuardDeck.active?"amDeckShow":"amDeckHide")))}battleGoalSetup(){this.dialog.open(Oa,{panelClass:["dialog"]})}setupEvents(n=""){this.dialog.open(ao,{panelClass:["dialog"],data:{type:n,edition:s.E.game.edition||s.E.currentEdition()}})}statistics(){this.dialog.open(sr,{panelClass:["dialog-invert"]})}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-party-sheet-dialog"]],viewQuery:function(i,e){if(1&i&&(t.GBs(m6,5),t.GBs(p6,5)),2&i){let o;t.mGM(o=t.lsd())&&(e.itemIndex=o.first),t.mGM(o=t.lsd())&&(e.treasureIndex=o.first)}},hostBindings:function(i,e){1&i&&t.bIt("keydown",function(g){return e.keyboardShortcuts(g)},t.EBC)},standalone:!1,decls:8,vars:13,consts:[["partyAchievementInput",""],["campaignStickerEl",""],["itemIndex",""],["treasureIndex",""],["unlockScenarioIndex",""],["unlockScenarioGroup",""],["unlockConclusionIndex",""],["globalAchievementInput",""],[1,"light","party-sheet-dialog"],[1,"scroll-container",3,"ngClass"],[1,"container",3,"ngClass"],[1,"sheet",3,"ngClass"],[1,"sheet","fh-sheet"],[1,"sheet","gh2e-sheet"],[1,"toggle-fh-sheet","ignore-denied"],[1,"campaign"],[1,"columns"],[1,"column","column-left"],[1,"row","title"],[1,"campaign-toggle","ignore-denied",3,"click"],["src","./assets/images/left.svg"],[3,"ghs-label"],[1,"headline"],[1,"select-party",3,"ghs-label","ghs-label-attribute"],[1,"spacer"],[1,"map","ignore-denied"],[1,"row","name"],["type","text",3,"change","value","ghs-label","ghs-label-attribute"],[1,"hint-container","new-party-hint"],[1,"row","location"],[1,"row","notes"],[1,"row","achievements"],[1,"achievements-container"],[1,"list"],[1,"achievement"],[1,"form"],["type","text",3,"keyup.enter","autocomplete","spoiler","emptyLabel","ghs-label","ghs-label-attribute"],[1,"addScenario",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg"],[1,"column","column-right"],[1,"column","reputation"],[1,"grid"],[1,"column","shop"],[1,"table"],[1,"value",3,"ngClass"],[1,"import-export"],[1,"export",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/export.svg"],[1,"import",3,"click","ghs-label","ghs-label-attribute"],["type","file","accept","application/json",3,"change"],["src","./assets/images/import.svg"],[1,"select-party",3,"change","ghs-label","ghs-label-attribute"],[3,"selected","disabled","value"],["src","./assets/images/chart.svg",3,"click","ghs-tooltip"],["src","./assets/images/map.svg",3,"ghs-tooltip"],["src","./assets/images/map.svg",3,"click","ghs-tooltip"],["src","./assets/images/minus.svg",1,"remove-party",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg",1,"new-party",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/minus.svg",1,"remove-party",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg",1,"hint-trigger","ghs-svg"],[1,"hint"],[1,"text"],[1,"remove",3,"click"],["src","./assets/images/close.svg",1,"ghs-svg"],[1,"value",3,"click","ngClass"],[1,"key"],[1,"title"],[1,"summer",3,"ngClass"],["src","./assets/images/fh/party/summer.svg"],[1,"headline","ignore-denied",3,"click"],[1,"management"],[1,"winter",3,"ngClass"],["src","./assets/images/fh/party/winter.svg"],[1,"calendar-lock-toggle",3,"ghs-tooltip","ngClass"],["ghs-pointer-input","",3,"singleClick","doubleClick"],[3,"src"],[1,"next"],[1,"weeks"],["ghs-pointer-input","",1,"week",3,"ghs-tooltip","ngClass"],[1,"name"],[1,"resources"],[1,"header"],[1,"supply",3,"click"],[1,"move-resources"],[1,"resource-table"],[1,"materials"],[1,"resource","lumber"],["src","./assets/images/fh/loot/lumber.svg"],["type","number","min","0",3,"change","value"],[1,"resource","metal"],["src","./assets/images/fh/loot/metal.svg"],[1,"resource","hide"],["src","./assets/images/fh/loot/hide.svg"],[1,"herbs"],[1,"resource","arrowvine"],["src","./assets/images/fh/loot/arrowvine.svg"],[1,"resource","axenut"],["src","./assets/images/fh/loot/axenut.svg"],[1,"resource","corpsecap"],["src","./assets/images/fh/loot/corpsecap.svg"],[1,"resource","flamefruit"],["src","./assets/images/fh/loot/flamefruit.svg"],[1,"resource","rockroot"],["src","./assets/images/fh/loot/rockroot.svg"],[1,"resource","snowthistle"],["src","./assets/images/fh/loot/snowthistle.svg"],[1,"inspiration"],["type","number",3,"change","value","ghs-label","ghs-label-attribute"],[1,"total-defense"],[1,"soldiers"],[1,"soldier-table"],[1,"line"],[1,"morale"],[1,"grid","morale-grid"],[1,"defense"],[1,"grid","defense-grid"],[1,"sections",3,"ngClass"],[1,"section",3,"ngClass"],[1,"town-guard-perks"],[1,"town-guard-perks-grid"],[1,"perk-list"],[1,"perk"],[1,"warning",3,"ghs-label","ghs-label-attribute"],[1,"campaign-stickers"],[1,"header",3,"submit"],["type","text",3,"keyup.enter","autocomplete","emptyLabel","ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg",3,"click"],[1,"stickers","ignore-denied",3,"ngClass"],[1,"sticker"],[3,"party"],[1,"town-guard-deck-container",3,"ngClass"],[1,"next",3,"click"],["src","./assets/images/right.svg"],["ghs-pointer-input","",1,"week",3,"singleClick","doubleClick","ghs-tooltip","ngClass"],[1,"section"],[1,"section","manual"],[1,"label"],[1,"characters"],[1,"character"],[1,"character",3,"click"],[1,"soldiers-line"],["ghs-pointer-input","",1,"soldier",3,"ngClass"],["ghs-pointer-input","",1,"soldier",3,"singleClick","doubleClick","ngClass"],["src","./assets/images/fh/party/soldier.svg"],[1,"check",3,"ngClass"],["src","./assets/images/fh/party/section.svg"],[1,"checkmark"],[1,"townguard-perk","checkbox",3,"click","ngClass"],["src","./assets/images/close.svg"],[1,"sections"],["ghs-pointer-input","",1,"section",3,"ngClass"],[3,"perk"],["ghs-pointer-input","",1,"section",3,"singleClick","doubleClick","ngClass"],["src","./assets/images/warning.svg",1,"ghs-svg"],[1,"text",3,"ghs-label"],[1,"image",3,"src","ghs-tooltip"],["src","./assets/images/minus.svg",1,"remove",3,"click"],[1,"town-guard-deck",3,"ngClass"],[3,"before","after","deck","townGuard"],[1,"active-toggle",3,"click"],[1,"numeration"],[1,"factions"],[1,"faction-reputation"],[1,"additional-factions"],[1,"imbuement"],[1,"checklist-container"],[1,"donations"],[1,"prosperity","gh2e","wrapped"],[1,"checklist"],[1,"legend"],[3,"click","ghs-label","ghs-tooltip"],["src","./assets/images/fh/prosperity.svg",3,"ghs-tooltip"],[1,"tick","large",3,"click","ghs-tooltip"],[1,"level"],[1,"checkbox","checked","disabled"],[1,"row",3,"ngClass"],[1,"checkbox","limit",3,"ngClass"],["ghs-pointer-input","",1,"value",3,"singleClick","doubleClick","ngClass"],["ghs-pointer-input","",1,"key",3,"singleClick","doubleClick"],[1,"checkbox",3,"ngClass"],["ghs-pointer-input","",1,"text",3,"singleClick","doubleClick","ghs-label"],[1,"text",3,"ghs-label","ghs-label-args"],["ghs-pointer-input","",1,"text",3,"singleClick","doubleClick","ghs-label","ghs-label-args"],[1,"tick",3,"ngClass"],["ghs-pointer-input","",1,"click",3,"singleClick"],["ghs-pointer-input","",1,"section",3,"ghs-label"],["src","./assets/images/fh/prosperity.svg"],["ghs-pointer-input","",1,"section",3,"singleClick","doubleClick","ghs-label"],[1,"checkbox",3,"click","ngClass"],[1,"level",3,"click"],[1,"toggle-fh-sheet","ignore-denied",3,"click"],[1,"campaign-mode",3,"click"],[3,"change"],[3,"value","selected"],[3,"selected","value"],[1,"row","scenarios","ignore-denied",3,"ngClass"],[1,"scenario","header","legend","seperator"],[1,"prosperity",3,"ngClass"],[1,"row","donations"],[1,"row","envelope-b"],[1,"row"],[1,"achievements"],[1,"items"],[1,"item-add"],["min","1","type","number","value","",3,"focus","keyup","keyup.enter"],[3,"click","ngClass"],[3,"ngModelChange","change","ngModel"],["value","",3,"selected"],[1,"item-list"],[1,"item",3,"ngClass"],[1,"treasures"],[1,"treasures-title",3,"click"],["src","./assets/images/scenario/treasure.svg",1,"icon"],[1,"treasure-add"],[1,"treasure-list"],[1,"treasure",3,"ngClass"],[1,"column"],[1,"row","players"],[1,"player"],[1,"add",3,"click"],[1,"row","events"],[1,"row","battle-goals"],[1,"row","retirements"],[1,"row","bottom-sheet"],[3,"ghs-label","ghs-label-args"],[3,"click","ghs-tooltip"],["src","./assets/images/stats.svg",1,"ghs-svg"],[1,"scenario","seperator"],[1,"scenario","header"],[1,"scenario"],[1,"scenario","unlock"],[1,"span"],[1,"ghs-svg","solo",3,"src"],[1,"scenario-title",3,"click","ngClass","ghs-tooltip","toggable"],[1,"toggle-manual",3,"ghs-label","ghs-label-attribute"],[1,"locked",3,"ghs-tooltip"],[1,"rewards",3,"ghs-tooltip"],["ghs-pointer-input","",1,"add-success",3,"singleClick","doubleClick","ghs-label","ghs-label-attribute","ngClass"],["src","./assets/images/check.svg"],[1,"toggle-manual",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/hint.svg",1,"manual"],["src","./assets/images/close.svg",1,"remove"],[1,"locked",3,"click","ghs-tooltip"],["src","./assets/images/fh/loot/random_item.svg",1,"ghs-svg"],[1,"rewards",3,"click","ghs-tooltip"],["src","./assets/images/scenario/conclusion.svg",1,"ghs-svg"],[1,"toggle-success",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/check.svg",1,"success"],[1,"toggle-success","casual",3,"click","ghs-label","ghs-label-attribute"],[3,"keyup","keyup.enter","ghs-label","ghs-label-attribute"],[1,"scenario-title"],["src","./assets/images/fh/puzzle.svg",1,"ghs-svg"],[1,"toggle-wrapped",3,"click","ghs-tooltip","src"],[1,"check",3,"ghs-tooltip"],[1,"tick",3,"autoscroll","ngClass"],["src","./assets/images/fh/prosperity.svg",3,"click","ghs-tooltip"],[1,"check",3,"click","ghs-tooltip"],[1,"section",3,"ghs-label"],[1,"tick"],[1,"donation"],["src","./assets/images/coin.png"],[1,"value"],[3,"click"],[1,"lines"],[1,"item"],[1,"checkpoint",3,"click","ngClass"],[1,"item-index","open-item",3,"click"],[1,"icon",3,"src"],[1,"index"],[1,"separator"],[1,"checkbox",3,"click"],["src","./assets/images/check.svg",1,"check"],["src","./assets/images/close.svg",1,"close"],[1,"text","open-item",3,"click","ghs-label"],[1,"count",3,"click"],[1,"text","edition"],[1,"treasure-index"],[3,"edition","index"],["type","text",3,"change","value"],[1,"available-characters"],["ghs-pointer-input","",1,"available-character",3,"ghs-tooltip"],["ghs-pointer-input","",1,"available-character",3,"singleClick","doubleClick","ghs-tooltip"],[1,"list",3,"ngClass"],[1,"character","header","legend","seperator"],["type","number","min","1",3,"change","keyup","value"],["ghs-pointer-input","",1,"link",3,"singleClick","doubleClick"],["ghs-pointer-input","",1,"link",3,"singleClick","doubleClick","ghs-label"],[1,"reactivate",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/long-rest.svg",1,"ghs-svg"]],template:function(i,e){1&i&&(t.j41(0,"div",8)(1,"div",9)(2,"div",10),t.nVh(3,L6,68,45,"div",11),t.nVh(4,PA,139,111,"div",12),t.nVh(5,KA,61,37,"div",13),t.nVh(6,WA,2,1,"span",14),t.nVh(7,gF,100,59,"div",15),t.k0s()()()),2&i&&(t.R7$(),t.Y8G("ngClass",t.eq3(7,oa,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.party)),t.R7$(),t.Y8G("ngClass",t.sMw(9,u6,!e.campaign&&e.fhSheet,!e.campaign&&e.gh2eSheet,e.campaign)),t.R7$(),t.vxM(e.campaign||e.fhSheet||e.gh2eSheet?-1:3),t.R7$(),t.vxM(!e.campaign&&e.fhSheet?4:-1),t.R7$(),t.vxM(!e.campaign&&e.gh2eSheet?5:-1),t.R7$(),t.vxM(e.campaign?-1:6),t.R7$(),t.vxM(e.campaign?7:-1))},dependencies:[N.YU,E.qT,E.xH,E.y7,E.wz,E.BC,E.cb,E.vS,E.cV,ye,cS,zo,it,Mt,zr,gr,dt,Pe,N.P9,Mi,Jo,At,Me,ct],styles:['.party-sheet-dialog[_ngcontent-%COMP%]{position:relative;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;width:calc(var(--ghs-unit) * 62 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .campaign-toggle[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .campaign-toggle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .campaign-toggle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{filter:var(--ghs-filter-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));justify-content:center;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{z-index:99}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));height:auto;margin:0 calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   label.headline[_ngcontent-%COMP%]{width:100%;justify-content:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   img.new-party[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   img.remove-party[_ngcontent-%COMP%]{cursor:pointer;height:1.2em;width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   select.select-party[_ngcontent-%COMP%]{cursor:pointer;position:relative;width:20px;appearance:none;color:transparent;border:none;background:transparent url(select-arrow.ed190f6187dac3c2.svg) no-repeat right center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);border-radius:calc(var(--ghs-unit) * .15 * var(--ghs-dialog-factor));box-shadow:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * .15 * var(--ghs-dialog-factor)) var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:before{content:" ";position:absolute;left:50%;top:50%;width:110%;height:110%;transform:scale(0);transform-origin:top left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;z-index:1;background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;filter:var(--ghs-filter-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .checkbox.checked[_ngcontent-%COMP%]:before{transform:scale(1) translate(-50%,-50%)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .checkbox.check[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));box-shadow:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor)) var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .checkbox.check[_ngcontent-%COMP%]:before{left:calc(var(--ghs-unit) * -.1 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));background-image:url(check.9a2e06a3b28f9de1.svg);transform-origin:bottom left}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .checkbox.checked.check[_ngcontent-%COMP%]:before{transform:scale(1)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .checkbox.highlight[_ngcontent-%COMP%]{background-color:var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .checkbox.disabled[_ngcontent-%COMP%]{pointer-events:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .checkbox.checked[_ngcontent-%COMP%]:hover:before{opacity:.6}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:not(.checked):hover:before{transform:scale(1) translate(-50%,-50%);opacity:.6}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{margin:0;color:var(--ghs-color-black);background-color:transparent;border:none;border-bottom-width:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor));border-bottom-style:solid;border-bottom-color:var(--ghs-color-gray);user-select:auto;-webkit-user-select:auto;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));flex-grow:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{margin:0;color:var(--ghs-color-black);background-color:transparent;border:none;user-select:auto;-webkit-user-select:auto;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));width:100%}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{color:var(--ghs-color-black);background-color:transparent;border:none;user-select:auto;-webkit-user-select:auto;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));width:100%;height:100%}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{display:flex;border:none;background:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:calc(var(--ghs-unit) * 27 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;column-gap:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 24 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor));overflow:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .achievement[_ngcontent-%COMP%]{display:flex}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .achievement[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{min-width:0;border:none;outline:none;flex-shrink:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .achievement[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]{cursor:pointer;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .achievement[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]:hover{opacity:.7}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]{position:relative;display:flex;font-family:var(--ghs-font-text);align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);width:100%;min-width:0;margin:0}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);display:flex;cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-green);width:auto;height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 62 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 76 * var(--ghs-dialog-factor));background-image:url(party-sheet.44d63853d27ff30a.svg);background-position:top center;background-repeat:no-repeat;background-size:contain;padding-left:calc(var(--ghs-unit) * 1.2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.column-left[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.column-right[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 17 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]{flex-grow:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{display:flex;height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .location[_ngcontent-%COMP%]{display:flex;height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:calc(var(--ghs-unit) * 25 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop[_ngcontent-%COMP%]{display:flex;flex-direction:column}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 5.6 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * .01 * var(--ghs-dialog-factor));display:grid;grid-template-columns:repeat(2,calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor)))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:flex;justify-content:center;position:relative;font-family:var(--ghs-font-normal);height:calc(var(--ghs-unit) * 1.635 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 2.1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .value.checked[_ngcontent-%COMP%]:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:hover:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .value.checked[_ngcontent-%COMP%]:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:hover:before{content:" ";position:absolute;top:0;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;filter:var(--ghs-filter-red);z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:hover:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:hover:before{opacity:.5}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.shop[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.shop[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]{display:flex;flex-direction:column}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));width:100%;height:calc(var(--ghs-unit) * 6.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(1), .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(1){height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(6), .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(6){height:calc(var(--ghs-unit) * 8.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(11), .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(11){height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value.active[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value.active[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .column-right[_ngcontent-%COMP%]{position:relative}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .column-right[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .column-right[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:0;height:calc(var(--ghs-unit) * 73 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 14 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));background:linear-gradient(transparent 0%,var(--ghs-color-darkgray) 100%);opacity:.2;z-index:0}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .import-export[_ngcontent-%COMP%]{display:flex;justify-content:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .import-export[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .import-export[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .import-export[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{width:0;height:0;margin:0;padding:0;visibility:hidden}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .import-export[_ngcontent-%COMP%]   label.error[_ngcontent-%COMP%]{animation:shake calc(var(--ghs-animation-speed) * .5s) linear;color:var(--ghs-color-red)!important}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 120.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 98.5 * var(--ghs-dialog-factor));background-image:url(party-sheet.0bbd7284c0358ddf.svg)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .checkbox.checked[_ngcontent-%COMP%]:before{clip-path:none;background-color:transparent;background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;z-index:1;filter:var(--ghs-filter-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-top:0;display:flex;position:absolute;justify-content:space-between;top:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor));left:0;width:calc(var(--ghs-unit) * 120.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]{cursor:pointer;display:flex;flex-direction:column;justify-content:center;align-items:center;margin-left:calc(var(--ghs-unit) * -4 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2.4 * var(--ghs-dialog-factor));text-transform:uppercase;flex-grow:initial}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]:hover{color:var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]   .management[_ngcontent-%COMP%]{display:flex;align-items:center;font-family:var(--ghs-font-text)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]   .management[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .summer[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .winter[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * -1.8 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .summer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .winter[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1.2em;width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .summer.summer[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .winter.summer[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .summer.summer.highlight[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .winter.summer.highlight[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .summer.summer.highlight[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .winter.summer.highlight[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .summer.winter[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .winter.winter[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .summer.winter.highlight[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .winter.winter.highlight[_ngcontent-%COMP%]{color:var(--ghs-color-blue)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .summer.winter.highlight[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .winter.winter.highlight[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-blue)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .calendar-lock-toggle[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * .6 * var(--ghs-dialog-factor));z-index:2}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .calendar-lock-toggle[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 3.8 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .calendar-lock-toggle[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .calendar-lock-toggle.permissive[_ngcontent-%COMP%]{opacity:.6}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .next[_ngcontent-%COMP%]{cursor:pointer;position:absolute;right:calc(var(--ghs-unit) * 11.5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2.4 * var(--ghs-dialog-factor));display:flex;justify-content:center;align-items:center;background:var(--ghs-color-white);width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor));border-bottom-right-radius:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .next[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto;margin-left:.2em}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .next[_ngcontent-%COMP%]:hover{color:var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .next[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 6.3 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 118.9 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 18.7 * var(--ghs-dialog-factor));display:grid;grid-template-columns:repeat(20,1fr);z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]   .week[_ngcontent-%COMP%]{position:relative;cursor:pointer;width:calc(var(--ghs-unit) * 5.9 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4.6 * var(--ghs-dialog-factor));padding:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor));display:flex;flex-direction:column;overflow-x:hidden;overflow-y:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]   .week.locked[_ngcontent-%COMP%]{cursor:initial}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]   .week.checked[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:10%;left:10%;width:80%;height:80%;background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]   .week.section.checked[_ngcontent-%COMP%]:after{top:initial;bottom:0;left:20%;width:60%;height:60%;filter:var(--ghs-filter-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]   .week[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));z-index:2;color:var(--ghs-color-darkgray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]   .week[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1.2em;width:auto;margin-right:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]   .week[_ngcontent-%COMP%]   .section.manual[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);color:var(--ghs-color-black)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]   .week[_ngcontent-%COMP%]   .section.manual[_ngcontent-%COMP%]   .manual-icon[_ngcontent-%COMP%]{height:.9em;width:auto;margin-right:0;margin-left:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]   .week[_ngcontent-%COMP%]:hover ~ [_ngcontent-%COMP%]:after{display:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]   .week[_ngcontent-%COMP%]:hover ~ .checked[_ngcontent-%COMP%]:after{display:block;opacity:.3}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]:hover   .week[_ngcontent-%COMP%]:not(.locked):after{content:" ";position:absolute;top:10%;left:10%;width:80%;height:80%;background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;z-index:1;opacity:.7}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 26.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 59 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-top:0;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 7.5 * var(--ghs-dialog-factor));justify-content:flex-end}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-align:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex:1 1 auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 32 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 61 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 19 * var(--ghs-dialog-factor));display:flex;flex-direction:column}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .supply[_ngcontent-%COMP%]{cursor:help;min-width:calc(var(--ghs-unit) * 24 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .move-resources[_ngcontent-%COMP%]{display:flex;height:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .move-resources[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));white-space:nowrap}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .move-resources[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]{display:flex}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .move-resources[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .move-resources[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource-table[_ngcontent-%COMP%]{display:flex;flex-direction:column}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource-table[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]{display:flex;margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource-table[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource-table[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));min-width:0;flex-grow:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource-table[_ngcontent-%COMP%]   .materials[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr;padding-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource-table[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .inspiration[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .total-defense[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 51 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 20 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 21 * var(--ghs-dialog-factor));margin-top:0;display:flex;flex-direction:column}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .inspiration[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .total-defense[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:center;align-self:center;font-size:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .inspiration.total-defense[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .total-defense.total-defense[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 24 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .inspiration.total-defense[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .total-defense.total-defense[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .soldiers[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 51 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 46 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 15 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 21 * var(--ghs-dialog-factor));margin-top:0;display:flex;flex-direction:column}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .soldiers[_ngcontent-%COMP%]   .soldier-table[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:calc(var(--ghs-unit) * -.3 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .soldiers[_ngcontent-%COMP%]   .soldier-table[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;margin-top:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .soldiers[_ngcontent-%COMP%]   .soldier-table[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);display:flex;flex-direction:column;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .soldiers[_ngcontent-%COMP%]   .soldier-table[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .soldiers[_ngcontent-%COMP%]   .soldier-table[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .soldiers-line[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-grow:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .soldiers[_ngcontent-%COMP%]   .soldier-table[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .soldiers-line[_ngcontent-%COMP%]   .soldier[_ngcontent-%COMP%]{position:relative}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .soldiers[_ngcontent-%COMP%]   .soldier-table[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .soldiers-line[_ngcontent-%COMP%]   .soldier[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2.6 * var(--ghs-dialog-factor));height:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .soldiers[_ngcontent-%COMP%]   .soldier-table[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .soldiers-line[_ngcontent-%COMP%]   .soldier[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{cursor:pointer;position:relative;width:calc(var(--ghs-unit) * 2.6 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.6 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) dashed var(--ghs-color-black);border-radius:100%}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .soldiers[_ngcontent-%COMP%]   .soldier-table[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .soldiers-line[_ngcontent-%COMP%]   .soldier[_ngcontent-%COMP%]   .check.checked[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:10%;left:10%;width:80%;height:80%;background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;z-index:1;filter:var(--ghs-filter-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .soldiers[_ngcontent-%COMP%]   .soldier-table[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .soldiers-line[_ngcontent-%COMP%]   .soldier.disabled[_ngcontent-%COMP%]{cursor:initial;opacity:.7}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 26.5 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 64 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 10.8 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 43.2 * var(--ghs-dialog-factor));display:flex;flex-direction:column;z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));justify-content:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale.defense[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense.defense[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 75.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.morale-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.morale-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{position:relative;cursor:pointer;display:flex;justify-content:center;align-items:center;width:100%;height:calc(var(--ghs-unit) * 1.92 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.morale-grid[_ngcontent-%COMP%]   .value.checked[_ngcontent-%COMP%]:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.morale-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:hover:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.morale-grid[_ngcontent-%COMP%]   .value.checked[_ngcontent-%COMP%]:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.morale-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:hover:before{content:" ";position:absolute;top:0;left:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));background-image:url(checkmark.437dd8c56b3be0e8.svg);background-position:center center;background-repeat:no-repeat;z-index:1;filter:var(--ghs-filter-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.morale-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:hover:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.morale-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:hover:before{opacity:.5}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;flex-wrap:wrap;width:100%;height:calc(var(--ghs-unit) * 1.92 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor));z-index:2}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{display:flex;align-items:center;margin-left:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section.conclusion[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section.conclusion[_ngcontent-%COMP%]{text-decoration:line-through}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:100%;height:calc(var(--ghs-unit) * 5.7 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(2), .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(2){height:calc(var(--ghs-unit) * 11.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(6), .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(7), .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(6), .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(7){height:calc(var(--ghs-unit) * 3.9 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .highlight[_ngcontent-%COMP%]:after, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .highlight[_ngcontent-%COMP%]:after{content:" ";position:absolute;inset:0;opacity:.3;background-color:var(--ghs-color-gray);z-index:-1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 26.2 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 90 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 28 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 72 * var(--ghs-dialog-factor));flex-direction:column;display:flex;z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.4 * var(--ghs-dialog-factor));justify-content:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .town-guard-perks-grid[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor));display:grid;grid-template-columns:repeat(12,1fr);align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .town-guard-perks-grid[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));height:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .town-guard-perks-grid[_ngcontent-%COMP%]   .town-guard-perk[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .town-guard-perks-grid[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));display:flex;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .perk-list[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-top:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor));display:flex;flex-direction:column;height:calc(var(--ghs-unit) * 54.5 * var(--ghs-dialog-factor));overflow-y:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .perk-list[_ngcontent-%COMP%]   .perk[_ngcontent-%COMP%]{display:grid;grid-template-columns:calc(var(--ghs-unit) * 6.2 * var(--ghs-dialog-factor)) auto;margin-bottom:calc(var(--ghs-unit) * .57 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .perk-list[_ngcontent-%COMP%]   .perk[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .perk-list[_ngcontent-%COMP%]   .perk[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;align-items:center;margin-top:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1.4 * var(--ghs-dialog-factor));background-color:var(--ghs-color-white)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .perk-list[_ngcontent-%COMP%]   .perk[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:.9em;width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .perk-list[_ngcontent-%COMP%]   .perk[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:hover{background-color:var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .perk-list[_ngcontent-%COMP%]   .perk[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section.disabled[_ngcontent-%COMP%]{pointer-events:initial;cursor:not-allowed;border-color:var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .perk-list[_ngcontent-%COMP%]   .perk[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section.disabled[_ngcontent-%COMP%]:hover{background-color:transparent}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .perk-list[_ngcontent-%COMP%]   .perk[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section.checked[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:10%;left:calc(var(--ghs-unit) * -1.2 * var(--ghs-dialog-factor));width:80%;height:80%;background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;z-index:1;filter:var(--ghs-filter-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .campaign-stickers[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * 70.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 86.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 28 * var(--ghs-dialog-factor));flex-direction:column;display:flex}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .campaign-stickers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .campaign-stickers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{cursor:pointer;height:1.2em;width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .campaign-stickers[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));width:0;flex-grow:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .campaign-stickers[_ngcontent-%COMP%]   .stickers[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;width:100%;height:calc(var(--ghs-unit) * 25 * var(--ghs-dialog-factor));overflow-y:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .campaign-stickers[_ngcontent-%COMP%]   .stickers[_ngcontent-%COMP%]   .sticker[_ngcontent-%COMP%]{position:relative;height:calc(var(--ghs-unit) * 14 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .campaign-stickers[_ngcontent-%COMP%]   .stickers[_ngcontent-%COMP%]   .sticker[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .campaign-stickers[_ngcontent-%COMP%]   .stickers[_ngcontent-%COMP%]   .sticker[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{height:100%;width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .campaign-stickers[_ngcontent-%COMP%]   .stickers[_ngcontent-%COMP%]   .sticker[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:0;right:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .campaign-stickers[_ngcontent-%COMP%]   .stickers[_ngcontent-%COMP%]   .sticker[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]:hover{opacity:.5}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]{position:absolute;z-index:3;left:calc(var(--ghs-unit) * 115 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * 19 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));height:0;transition:top calc(var(--ghs-animation-speed) * .5s) ease-in-out,width calc(var(--ghs-animation-speed) * .5s) ease-in-out,left calc(var(--ghs-animation-speed) * .5s) ease-in-out;overflow:visible}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]:before{content:" ";position:sticky;display:block;top:0;left:0;width:calc(var(--ghs-unit) * 119.5 * var(--ghs-dialog-factor));height:0;background-color:var(--ghs-color-darkgray);opacity:0;transition:opacity calc(var(--ghs-animation-speed) * .5s) ease-in-out,height calc(var(--ghs-animation-speed) * .5s) ease-in-out;z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container.active[_ngcontent-%COMP%]{z-index:3;top:calc(var(--ghs-unit) * 6.3 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 119.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 19 * var(--ghs-dialog-factor));overflow:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container.active[_ngcontent-%COMP%]:before{height:calc(var(--ghs-unit) * 19 * var(--ghs-dialog-factor));opacity:.5}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]   .town-guard-deck[_ngcontent-%COMP%]{position:absolute;right:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 37.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 10 * var(--ghs-dialog-factor));transition:transform calc(var(--ghs-animation-speed) * .5s) ease-in-out;z-index:2}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]   .town-guard-deck[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * -2.5 * var(--ghs-dialog-factor));bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * -5 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray);background-color:var(--ghs-color-darkgray);border-radius:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]   .town-guard-deck[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{position:relative;z-index:2}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]   .town-guard-deck.full[_ngcontent-%COMP%]{transform:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]   .town-guard-deck.collapsed[_ngcontent-%COMP%]{transform:translate(calc(var(--ghs-unit) * 41.5 * var(--ghs-dialog-factor)))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]   .town-guard-deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]{cursor:pointer;position:absolute;left:calc(var(--ghs-unit) * -5.5 * var(--ghs-dialog-factor) * var(--ghs-barsize));top:50%;transform:translateY(-50%);width:13%;height:50%;z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]   .town-guard-deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]:hover{filter:brightness(.7) grayscale(.3)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]   .town-guard-deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]:active, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]   .town-guard-deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]:focus{filter:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]   .town-guard-deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]   .numeration[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);display:flex;justify-content:center;position:absolute;color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor) * var(--ghs-barsize));line-height:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor) * var(--ghs-barsize));width:100%;height:100%;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(icon.5a11343c46ebf913.png)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   ghs-party-buildings[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * 101.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 118.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 28 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 120.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 94 * var(--ghs-dialog-factor));background-image:url(party-sheet.e3d7a607caf90387.svg)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-title)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-top:0;display:flex;position:absolute;justify-content:center;top:calc(var(--ghs-unit) * -.4 * var(--ghs-dialog-factor));left:0;width:calc(var(--ghs-unit) * 120.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]{cursor:pointer;display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2.4 * var(--ghs-dialog-factor));text-transform:uppercase;flex-grow:initial}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]:hover{color:var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]   .management[_ngcontent-%COMP%]{display:flex;align-items:center;font-family:var(--ghs-font-text);font-size:.65em;margin-top:calc(var(--ghs-unit) * -.8 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]   .management[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 3.7 * var(--ghs-dialog-factor));left:0;width:calc(var(--ghs-unit) * 58 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-top:0;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 7.5 * var(--ghs-dialog-factor));justify-content:flex-end}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-align:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex:1 1 auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .inspiration[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 3.2 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 62 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 56 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));margin-top:0;display:flex;flex-direction:row;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .inspiration[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));text-align:center;align-self:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 12 * var(--ghs-dialog-factor));left:0;display:flex}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 17 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 67 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * 1.7 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]:last-child{margin-right:0}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2.1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1.2 * var(--ghs-dialog-factor));display:flex;flex-direction:column}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:grid;grid-template-columns:calc(var(--ghs-unit) * 2.8 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * 12 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;position:relative;font-family:var(--ghs-font-fh-text);height:calc(var(--ghs-unit) * 2.02 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 2.1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 2.8 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.02 * var(--ghs-dialog-factor));display:flex;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{pointer-events:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row.locked[_ngcontent-%COMP%]{opacity:.7}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row.locked[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row.locked[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{cursor:not-allowed}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]:hover:not(.locked).checked:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]:hover:not(.locked)   .value[_ngcontent-%COMP%]:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .value.checked.checked[_ngcontent-%COMP%]:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .value.checked[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:0;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;filter:var(--ghs-filter-red);z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]:hover:not(.locked)   .value[_ngcontent-%COMP%]:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .value.checked[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:before{opacity:.5}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .limit[_ngcontent-%COMP%]{pointer-events:none;position:absolute;top:calc(var(--ghs-unit) * 19.6 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 13 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .additional-factions[_ngcontent-%COMP%]{position:absolute;display:flex;flex-direction:column;top:calc(var(--ghs-unit) * 12.2 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 56 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 35 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 48 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .additional-factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:calc(var(--ghs-unit) * .7 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .additional-factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]:first-of-type{margin-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .additional-factions[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{justify-content:center;margin-bottom:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .additional-factions[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{position:relative}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .additional-factions[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .additional-factions[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:calc(var(--ghs-unit) * .6 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 31 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));background-image:url(reputation-separator.86318fdb72c86cd2.svg);background-size:100% 100%;background-repeat:no-repeat}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .additional-factions[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{display:flex;align-items:center;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * -1 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .additional-factions[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:last-child{margin-bottom:0}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .additional-factions[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{pointer-events:none;margin-right:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));min-height:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .additional-factions[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 61 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 57.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 32 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 18 * var(--ghs-dialog-factor));margin-top:0}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .imbuement[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .donations[_ngcontent-%COMP%]{position:absolute;display:flex;flex-direction:column;top:calc(var(--ghs-unit) * 12.2 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 93 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 26.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 33 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .imbuement[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .donations[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{justify-content:center;margin-bottom:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .imbuement.donations[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .donations.donations[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 50.8 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 42 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1.7 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]:first-of-type{margin-top:0}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]{display:flex;align-items:center;height:100%}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]:not(:first-child){margin-left:calc(var(--ghs-unit) * -.2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));box-shadow:none;z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .click[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * -.1 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:before{top:0;left:0;transform:scale(0) translate(-37%,-10%)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox.checked[_ngcontent-%COMP%]:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover:before{transform:scale(1) translate(-37%,-10%)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * -.1 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor));display:flex;justify-content:flex-end;align-items:center;font-family:var(--ghs-font-fh-text);font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor));z-index:2}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * -.6 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));background-size:100% 100%;background-image:url(right.237a6836b42aa12a.svg)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section.prosperity-tick[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section.prosperity-tick[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section.prosperity-tick[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-title);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * -.1 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section.prosperity-tick[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section.prosperity-tick[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:before{margin-top:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 82 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 90 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-title);flex-direction:row;align-self:flex-start;font-size:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));align-items:center;width:auto;margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));height:auto;align-self:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]{position:relative;margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]:not(:first-child){margin-left:calc(var(--ghs-unit) * -.2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.break[_ngcontent-%COMP%]{margin-left:0}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));box-shadow:none;z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .click[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-normal);position:absolute;top:calc(var(--ghs-unit) * 1.9 * var(--ghs-dialog-factor));left:0;right:initial;z-index:2;color:var(--ghs-color-white);background:var(--ghs-color-darkgray);width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.1 * var(--ghs-dialog-factor));clip-path:polygon(0% 0%,0% 65%,50% 100%,100% 65%,100% 0%)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.large[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * -.1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.large[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-bottom:calc(var(--ghs-unit) * -.2 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 8.5 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 8.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:before{top:0;left:0;transform:scale(0) translate(-37%,-10%)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox.checked[_ngcontent-%COMP%]:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover:before{transform:scale(1) translate(-37%,-10%)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * -.1 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor));display:flex;justify-content:flex-end;align-items:center;z-index:2}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * -.6 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));background-size:100% 100%;background-image:url(right.237a6836b42aa12a.svg)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{flex-basis:100%}.party-sheet-dialog[_ngcontent-%COMP%]   .container.fh-container[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 120.5 * var(--ghs-dialog-factor));overflow-x:hidden}.party-sheet-dialog[_ngcontent-%COMP%]   .container.gh2e-container[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 120.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .toggle-fh-sheet[_ngcontent-%COMP%]{cursor:pointer;position:relative;bottom:0;left:49%;transform:translate(-50%);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .wip[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));display:flex;justify-content:center;align-items:center;height:100%;color:var(--ghs-color-red);flex-basis:0}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .wip.warning[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .warning.warning[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .wip[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:auto;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));filter:var(--ghs-filter-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .wip.warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .warning.warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]{display:flex;width:calc(var(--ghs-unit) * 62 * var(--ghs-dialog-factor));max-width:100%;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-end;align-items:flex-end;width:calc(var(--ghs-unit) * 12 * var(--ghs-dialog-factor));height:100%;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   .toggle-wrapped[_ngcontent-%COMP%]{cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{display:flex;height:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]{display:flex;align-items:flex-end;height:100%;overflow:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity.fh[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity.fh[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]{flex-direction:row;align-items:center;justify-content:flex-start}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity.fh[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity.fh[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]{position:relative}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity.fh[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]:not(:first-child){margin-left:calc(var(--ghs-unit) * -.1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity.fh[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);box-shadow:none;z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity.fh[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor));font-family:var(--ghs-font-normal);position:absolute;top:0;left:0;right:0;z-index:2}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity.fh[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.large[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity.fh[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.large[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-bottom:calc(var(--ghs-unit) * -.3 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity.wrapped[_ngcontent-%COMP%]{height:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity.wrapped[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]{flex-wrap:wrap}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 62 * var(--ghs-dialog-factor));max-width:100%}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]{width:100%}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{justify-content:space-between}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .campaign-mode[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .campaign-mode[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow-y:auto;max-height:30vh}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]{position:relative;display:grid;grid-template-columns:.7fr .7fr 2fr 1fr;text-align:left;width:calc(var(--ghs-unit) * 62 * var(--ghs-dialog-factor));max-width:100%;padding:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-bottom:calc(var(--ghs-unit) * .05 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario.header[_ngcontent-%COMP%]{font-weight:700;border-bottom:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario.header.legend[_ngcontent-%COMP%]{position:sticky;top:0;background-color:var(--ghs-color-white);z-index:1;padding:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario.header.legend[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(4){justify-content:flex-start}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]:not(.header):nth-child(odd):before{content:" ";position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--ghs-color-lightgray);z-index:-1}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:1/span 4;text-align:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .scenario-title[_ngcontent-%COMP%]{position:relative}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .blocked[_ngcontent-%COMP%]{text-decoration:line-through}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .blocked[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .locked[_ngcontent-%COMP%]{color:var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .locked[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario.seperator[_ngcontent-%COMP%]{border-bottom:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) solid var(--ghs-color-black)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   img.ghs-svg.solo[_ngcontent-%COMP%]{filter:none;height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2), .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(4){justify-content:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-manual[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-manual[_ngcontent-%COMP%]   img.manual[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-manual[_ngcontent-%COMP%]   img.remove[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-shadow);height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));display:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-manual[_ngcontent-%COMP%]:hover   img.remove[_ngcontent-%COMP%]{display:inline-block}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-manual[_ngcontent-%COMP%]:hover   img.manual[_ngcontent-%COMP%]{display:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .locked[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .locked[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:auto;filter:var(--ghs-filter-yellow)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .rewards[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .rewards[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-success[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-success[_ngcontent-%COMP%]   img.success[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 1.3 * var(--ghs-dialog-factor));filter:var(--ghs-filter-green)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-success[_ngcontent-%COMP%]   img.remove[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 1.3 * var(--ghs-dialog-factor));filter:var(--ghs-filter-red) var(--ghs-filter-shadow);display:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-success.casual[_ngcontent-%COMP%]   img.success[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));filter:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-success.casual[_ngcontent-%COMP%]   img.remove[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-success[_ngcontent-%COMP%]:hover   img.remove[_ngcontent-%COMP%]{display:inline-block}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-success[_ngcontent-%COMP%]:hover   img.success[_ngcontent-%COMP%]{display:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .add-success[_ngcontent-%COMP%]{position:relative;cursor:pointer;border:calc(var(--ghs-unit) * .05 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .add-success[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:none;position:absolute}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .add-success[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{display:inline-block}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .add-success.disabled[_ngcontent-%COMP%]{pointer-events:initial;cursor:not-allowed;border-color:var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .add-success.disabled[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{display:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario.unlock[_ngcontent-%COMP%]{position:sticky;bottom:0;display:flex;align-items:center;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .05 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray);background-color:var(--ghs-color-white)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario.unlock[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 1.4 * var(--ghs-dialog-factor));width:auto;margin:0 calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario.unlock[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) * .05 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray);outline:none;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));width:0;flex-grow:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario.unlock[_ngcontent-%COMP%]   .addScenario[_ngcontent-%COMP%]{color:var(--ghs-color-black);cursor:pointer;display:flex;justify-content:flex-end;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario.unlock[_ngcontent-%COMP%]   .addScenario[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 1.3 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario.unlock[_ngcontent-%COMP%]   .addScenario[_ngcontent-%COMP%]:hover{opacity:.7}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]{display:flex;flex-direction:column}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .player[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .player[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{padding-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));border-right:2px solid var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .player[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex-grow:1;font-size:1em;line-height:.7em;margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .player[_ngcontent-%COMP%]   .available-characters[_ngcontent-%COMP%]{display:flex}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .player[_ngcontent-%COMP%]   .available-characters[_ngcontent-%COMP%]   .available-character[_ngcontent-%COMP%]{cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .player[_ngcontent-%COMP%]   .available-characters[_ngcontent-%COMP%]   .available-character[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .player[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .player[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));filter:var(--ghs-filter-red) var(--ghs-filter-shadow)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .player[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]:hover{opacity:.7}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;color:var(--ghs-color-black);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]:hover{opacity:.7}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .battle-goals[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .events[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;color:var(--ghs-color-black);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow-y:auto;max-height:30vh}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{position:relative;display:grid;grid-template-columns:1fr 2fr 1.8fr 1fr 1fr .5fr;text-align:left;width:calc(var(--ghs-unit) * 62 * var(--ghs-dialog-factor));max-width:100%;padding:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-bottom:calc(var(--ghs-unit) * .05 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character.header[_ngcontent-%COMP%]{font-weight:700;border-bottom:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character.header.legend[_ngcontent-%COMP%]{position:sticky;top:0;background-color:var(--ghs-color-white);z-index:1;padding:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character.header.legend[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{overflow:hidden;justify-content:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:1/span 4;text-align:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:center;border:none;outline:none;min-width:0}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character.seperator[_ngcontent-%COMP%]{border-bottom:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) solid var(--ghs-color-black)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{display:flex;align-items:center;padding:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   span.link[_ngcontent-%COMP%]{cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   span.link[_ngcontent-%COMP%]:hover{opacity:.7}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]:not(.separator) > span[_ngcontent-%COMP%]{border-bottom:calc(var(--ghs-unit) * .05 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray);border-right:calc(var(--ghs-unit) * .05 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:none;height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(1), .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(4), .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(5), .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(6), .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(7){justify-content:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .reactivate[_ngcontent-%COMP%]{cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list.fh-sheet[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{grid-template-columns:1fr 2fr 1.8fr 1fr 1fr 1.4fr .5fr}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .bottom-sheet[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .bottom-sheet[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .bottom-sheet[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]{height:auto;display:flex;flex-direction:column;margin-top:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .treasures-title[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasures-title[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .treasures-title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasures-title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]{height:auto;width:100%}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{width:initial}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);display:grid;grid-template-columns:.5fr .2fr 2fr;border-bottom:calc(var(--ghs-unit) * .05 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);width:100%;min-width:0;margin:0;text-align:right}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);display:flex;cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-green);width:auto;height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]{max-height:calc(var(--ghs-unit) * 20 * var(--ghs-dialog-factor));overflow-y:auto;font-size:.9em}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]{display:grid;grid-template-columns:.3fr .2fr .2fr 2fr .2fr;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%] > *[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%] > *[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%] > *[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%] > *[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%] > *[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%] > *[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%] > *[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:100%}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item.edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure.edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item.edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure.edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item.edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure.edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item.edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure.edition[_ngcontent-%COMP%]{grid-template-columns:.3fr .2fr .2fr 2fr .2fr 1fr}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:.9em;justify-self:end}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;justify-self:initial}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%]{cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%]:hover{opacity:.7}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{cursor:crosshair;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));text-align:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]:hover{opacity:.7}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]{text-align:right}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:.9em;justify-self:start}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{cursor:pointer;justify-self:start;position:relative;border:calc(var(--ghs-unit) * .05 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{position:absolute}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{top:0;left:calc(var(--ghs-unit) * -.8 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));filter:var(--ghs-filter-red);display:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover{border:none;box-shadow:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .check[_ngcontent-%COMP%]{display:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .close[_ngcontent-%COMP%]{display:inline-block}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:.9em;justify-self:start;white-space:nowrap;overflow-x:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .donations[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:calc(var(--ghs-unit) * 10 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .donations[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]{display:flex;align-items:center;height:100%;overflow:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .donations[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .donation[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 6.2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 6.2 * var(--ghs-dialog-factor));overflow:hidden}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .donations[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .donation[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{position:absolute;left:0;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));z-index:2}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .donations[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .donation[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{z-index:2}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .donations[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .donation[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:0;left:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor));width:100%;height:100%;z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .envelope-b[_ngcontent-%COMP%]{display:flex;flex-direction:column}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .envelope-b[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .envelope-b[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * .5)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .envelope-b[_ngcontent-%COMP%]   .lines[_ngcontent-%COMP%]{display:flex;flex-direction:column}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .envelope-b[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .envelope-b[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;margin:calc(var(--ghs-unit) * .5);font-size:.8em;font-family:var(--ghs-font-gh-title)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .envelope-b[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkpoint[_ngcontent-%COMP%]{display:block;position:relative;border-radius:100%;width:calc(var(--ghs-unit) * 2.3);height:calc(var(--ghs-unit) * 2.3);cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .envelope-b[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkpoint[_ngcontent-%COMP%]:after{content:" ";position:absolute;inset:0;border-radius:100%;background-color:var(--ghs-color-gray);-webkit-mask-image:url(env-b.4ee9bb75787ae4e2.svg);mask-image:url(env-b.4ee9bb75787ae4e2.svg);-webkit-mask-size:100% 100%;mask-size:100% 100%}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .envelope-b[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkpoint.prosperity[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-yellow);-webkit-mask-image:url(env-b-prosp.fe4db76e5ece856d.svg);mask-image:url(env-b-prosp.fe4db76e5ece856d.svg)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .envelope-b[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkpoint[_ngcontent-%COMP%]:before{content:" ";position:absolute;left:50%;top:50%;width:110%;height:110%;transform:scale(0);transform-origin:top left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;z-index:1;background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;filter:var(--ghs-filter-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .envelope-b[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkpoint.checked[_ngcontent-%COMP%]:before{transform:scale(1) translate(-50%,-50%)}.party-sheet-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%}.party-sheet-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;margin-left:calc(var(--ghs-unit) * -4 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2.4 * var(--ghs-dialog-factor));text-transform:uppercase;flex-basis:initial}.party-sheet-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]:hover{color:var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.party-sheet-dialog[_ngcontent-%COMP%]   .scroll-container.denied[_ngcontent-%COMP%]   .campaign-toggle[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .scroll-container.denied[_ngcontent-%COMP%]   .campaign-toggle[_ngcontent-%COMP%]   *[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .scroll-container.denied[_ngcontent-%COMP%]   .export[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .scroll-container.denied[_ngcontent-%COMP%]   .export[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{pointer-events:initial}']})}return a})();const ho=a=>({disabled:a}),dF=(a,r,n)=>[a,r,n],hF=()=>[],_F=(a,r)=>({none:a,manual:r}),mF=(a,r)=>r._trackUUID;function pF(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",15),t.bIt("singleClick",function(){const e=c.eBV(n).$index,o=t.XpG();return c.Njj(o.unspentPoints(e))})("doubleClick",function(){const e=c.eBV(n).$index,o=t.XpG();return c.Njj(o.unspentPoints(e,!0))}),t.nrm(1,"span",16),t.k0s()}if(2&a){const n=r.$implicit;t.R7$(),t.Y8G("ghs-placeholder","game.attackmodifier.minus"+n)}}function uF(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",17),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.addSpentPoints(e))})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.addSpentPoints(e,!0))}),t.nrm(1,"span",16),t.k0s()}if(2&a){const n=r.$implicit;t.R7$(),t.Y8G("ghs-placeholder","game.attackmodifier.minus"+n)}}function fF(a,r){if(1&a&&(t.j41(0,"div",19),t.nrm(1,"img",25),t.j41(2,"span",21)(3,"div",22),t.nrm(4,"span",5),t.k0s()()()),2&a){const n=t.XpG().$implicit;t.R7$(),t.Y8G("ngClass",t.l_i(2,_F,!n.automation,"manual"==n.automation)),t.R7$(3),t.Y8G("ghs-label","game.data.favors."+n.edition+"."+n.name+".automation")}}function CF(a,r){1&a&&t.nrm(0,"span")}function MF(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",26),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.unselectFavor(e))})("doubleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.unselectFavor(e,!0))}),t.nrm(1,"img",27),t.k0s()}}function vF(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",10)(1,"label",18),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.selectFavor(e))})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.selectFavor(e,!0))}),t.k0s(),t.j41(2,"div",19),t.nrm(3,"img",20),t.j41(4,"span",21)(5,"div",22),t.nrm(6,"span",5),t.k0s()()(),t.nVh(7,fF,5,5,"div",19),t.nVh(8,CF,1,0,"span"),t.j41(9,"div",23),t.Z7z(10,MF,2,0,"span",24,t.fX1),t.nI1(12,"ghsRange"),t.k0s()()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG();t.Y8G("ngClass",t.eq3(9,ho,e.availablePoints<n.points)),t.R7$(),t.Y8G("ghs-label","scenario.favors.label"+(n.points>1?".multiple":""))("ghs-label-args",t.sMw(11,dF,n.edition,n.name,""+n.points)),t.R7$(5),t.Y8G("ghs-label","game.data.favors."+n.edition+"."+n.name+".text"),t.R7$(),t.vxM(e.settingsManager.settings.fhTrialsApply?7:-1),t.R7$(),t.vxM(e.settingsManager.settings.fhTrialsApply?-1:8),t.R7$(2),t.Dyx(t.i5U(12,6,t.lJ4(15,hF),e.activeFavors[i]))}}let Jr=(()=>{class a{dialogRef;favors=[];activeFavors=[];availablePoints=0;spentPoints=0;leftPoints=[];gameFavors=[];gameFavorPoints=[];change=!1;disabled=!1;gameManager=s.E;settingsManager=p.f;constructor(n){this.dialogRef=n}ngOnInit(){const n=s.E.editionData.find(i=>i.edition==s.E.currentEdition()&&i.favors);n&&(this.favors=n.favors),this.gameFavors=s.E.game.favors.map(i=>new yt.gw(i.name,i.edition)),this.gameFavorPoints=s.E.game.favorPoints.map(i=>+i),this.update(!1)}update(n=!0){this.change=n,this.disabled=!s.E.roundManager.firstRound,this.activeFavors=[],this.favors.forEach((i,e)=>{this.activeFavors[e]=this.gameFavors.filter(o=>o.edition==i.edition&&o.name==i.name).length}),this.spentPoints=this.activeFavors.length?this.activeFavors.map((i,e)=>i*this.favors[e].points).reduce((i,e)=>i+e):0,this.availablePoints=Math.min(Math.max((this.gameFavorPoints.length?this.gameFavorPoints.reduce((i,e)=>i+e):0)-this.spentPoints,0),7),this.leftPoints=s.E.game.monsterAttackModifierDeck.cards.filter(i=>i.type==w.Yn.minus1||i.type==w.Yn.minus2).map(i=>i.type==w.Yn.minus1?1:2),this.gameFavorPoints.forEach(i=>{this.leftPoints.splice(this.leftPoints.indexOf(i),1)})}toggleKeep(){s.E.stateManager.before(s.E.game.keepFavors?"favorKeepOff":"favorKeepOn"),s.E.game.keepFavors=!s.E.game.keepFavors,s.E.stateManager.after()}addSpentPoints(n,i=!1){(!this.disabled&&this.leftPoints.includes(n)&&(!this.gameFavorPoints.length||this.gameFavorPoints.reduce((e,o)=>e+o)+n<=7)||i)&&(this.gameFavorPoints.push(n),this.update())}unspentPoints(n,i=!1){(!this.disabled&&this.gameFavorPoints.reduce((e,o)=>e+o)-this.gameFavorPoints[n]>=this.spentPoints||i)&&(this.gameFavorPoints.splice(n,1),this.update())}selectFavor(n,i=!1){(!this.disabled&&this.availablePoints>=n.points||i)&&(this.gameFavors.push(new yt.gw(n.name,n.edition)),this.update())}unselectFavor(n,i=!1){const e=this.gameFavors.find(o=>o.edition==n.edition&&o.name==n.name);e&&(!this.disabled||i)&&(this.gameFavors.splice(this.gameFavors.indexOf(e),1),this.update())}close(){this.dialogRef.close()}apply(){if(this.change){for(s.E.stateManager.before("applyFavorSelection");this.availablePoints;)this.availablePoints>2&&this.gameFavorPoints.includes(2)?(this.gameFavorPoints.splice(this.gameFavorPoints.indexOf(2),1),this.availablePoints-=2):(this.gameFavorPoints.splice(this.gameFavorPoints.indexOf(1),1),this.availablePoints--);s.E.game.favors=this.gameFavors,s.E.game.favorPoints=this.gameFavorPoints,s.E.stateManager.after(),this.dialogRef.close()}}confirm(n){p.f.settings.keyboardShortcuts&&"Enter"===n.key&&(this.apply(),n.preventDefault(),n.stopPropagation())}static \u0275fac=function(i){return new(i||a)(t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-favors"]],hostBindings:function(i,e){1&i&&t.bIt("keydown",function(g){return e.confirm(g)},t.EBC)},standalone:!1,decls:22,vars:13,consts:[[1,"favors-container",3,"ngClass"],[1,"header"],[1,"title",3,"ghs-label"],[1,"header-menu"],["tabclick","","type","checkbox",3,"change","checked"],[3,"ghs-label"],[1,"points"],["ghs-pointer-input","",1,"point","spent"],["ghs-pointer-input","",1,"point","left"],[1,"favors"],[1,"favor",3,"ngClass"],[1,"buttons"],[1,"cancel",3,"click"],[1,"spacer"],["ghs-pointer-input","",1,"apply",3,"singleClick","ngClass"],["ghs-pointer-input","",1,"point","spent",3,"singleClick","doubleClick"],[3,"ghs-placeholder"],["ghs-pointer-input","",1,"point","left",3,"singleClick","doubleClick"],["ghs-pointer-input","",1,"text-white",3,"singleClick","doubleClick","ghs-label","ghs-label-args"],[1,"hint-container"],["src","./assets/images/hint.svg",1,"hint-trigger","ghs-svg"],[1,"hint"],[1,"text"],[1,"checks"],["ghs-pointer-input","",1,"check"],["src","./assets/images/automation.svg",1,"hint-trigger","automation","ghs-svg",3,"ngClass"],["ghs-pointer-input","",1,"check",3,"singleClick","doubleClick"],["src","./assets/images/check.svg",1,"ghs-svg"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"span",2),t.k0s(),t.j41(3,"div",3)(4,"label")(5,"input",4),t.bIt("change",function(){return e.toggleKeep()}),t.k0s(),t.nrm(6,"span",5),t.k0s()(),t.j41(7,"div",6),t.Z7z(8,pF,2,1,"div",7,t.fX1),t.Z7z(10,uF,2,1,"div",8,t.fX1),t.k0s(),t.j41(12,"div",9),t.Z7z(13,vF,13,16,"div",10,mF),t.nI1(15,"trackUUID"),t.k0s(),t.j41(16,"div",11)(17,"a",12),t.bIt("click",function(){return e.close()}),t.nrm(18,"span",5),t.k0s(),t.nrm(19,"span",13),t.j41(20,"a",14),t.bIt("singleClick",function(){return e.apply()}),t.nrm(21,"span",5),t.k0s()()()),2&i&&(t.Y8G("ngClass",t.eq3(9,ho,e.disabled)),t.R7$(2),t.Y8G("ghs-label","scenario.favors"),t.R7$(3),t.Y8G("checked",e.gameManager.game.keepFavors),t.R7$(),t.Y8G("ghs-label","scenario.favors.keep"),t.R7$(2),t.Dyx(e.gameFavorPoints),t.R7$(2),t.Dyx(e.leftPoints),t.R7$(3),t.Dyx(t.bMT(15,7,e.favors)),t.R7$(5),t.Y8G("ghs-label","cancel"),t.R7$(2),t.Y8G("ngClass",t.eq3(11,ho,!e.change)),t.R7$(),t.Y8G("ghs-label","scenario.favors.apply"))},dependencies:[N.YU,it,xg,dt,Ft,At,ct],styles:[".favors-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;color:var(--ghs-color-white)}.favors-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;justify-content:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.favors-container[_ngcontent-%COMP%]   .points[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.favors-container[_ngcontent-%COMP%]   .points[_ngcontent-%COMP%]   .point[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));margin:0 calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor))}.favors-container[_ngcontent-%COMP%]   .points[_ngcontent-%COMP%]   .point.spent[_ngcontent-%COMP%]{filter:grayscale(.5) brightness(.5)}.favors-container[_ngcontent-%COMP%]   .header-menu[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.favors-container[_ngcontent-%COMP%]   .header-menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));display:flex;justify-content:center;align-items:center}.favors-container[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));display:flex;flex-direction:column}.favors-container[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]   .favor[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr .5fr .5fr 1fr;font-family:var(--ghs-font-text);width:calc(var(--ghs-unit) * 35 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.favors-container[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]   .favor[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer}.favors-container[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]   .favor.disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{opacity:.5}.favors-container[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]   .favor[_ngcontent-%COMP%]   .automation[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.favors-container[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]   .favor[_ngcontent-%COMP%]   .automation.manual[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.favors-container[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]   .favor[_ngcontent-%COMP%]   .automation.none[_ngcontent-%COMP%]{filter:var(--ghs-filter-red)}.favors-container[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]   .favor[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;flex-wrap:wrap}.favors-container[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]   .favor[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{cursor:zoom-out;display:flex;justify-content:center;align-items:center;margin:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor))}.favors-container[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]   .favor[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:auto;filter:var(--ghs-filter-white)}.favors-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly}.favors-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}.favors-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.favors-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.favors-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.favors-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-darkgray)}.favors-container.disabled[_ngcontent-%COMP%]   .points[_ngcontent-%COMP%]   .point[_ngcontent-%COMP%], .favors-container.disabled[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]   .favor[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .favors-container.disabled[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{cursor:initial}"]})}return a})();const Qr=a=>({disabled:a}),_o=(a,r)=>({active:a,disabled:r}),OF=(a,r,n,i)=>({"level-1":a,"level-2":r,"level-3":n,"level-4":i}),PF=()=>[],bF=(a,r,n)=>({harvest:a,plant:r,disabled:n}),kF=(a,r)=>r._trackUUID;function yF(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",21),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.harvest())}),t.k0s()}2&a&&t.Y8G("ghs-label","data.buildings.garden.plots.harvest")}function xF(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",22),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.setActive(e))})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.setActive(e,!0))}),t.nrm(1,"img",23),t.j41(2,"span",17),t.EFF(3),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.l_i(3,_o,i.activeHerb==n,i.activeHerb!=n&&!i.resources[n]||i.garden.flipped)),t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+n+".svg",t.B4B),t.R7$(2),t.JRh(i.resources[n])}}function EF(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",16),t.bIt("click",function(){const e=c.eBV(n).$index,o=t.XpG();return c.Njj(o.selectSource(e))}),t.nrm(1,"img",24),t.j41(2,"span",17),t.EFF(3),t.k0s()()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG();t.Y8G("ngClass",t.l_i(3,_o,e.currentSource==i,!e.currentResources[i])),t.R7$(),t.Y8G("src",n.iconUrl,t.B4B),t.R7$(2),t.JRh(e.currentResources[i])}}function wF(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",25),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.plantHerb(e))})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.plantHerb(e,!0))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.HbH("plot-"+(n+1)+(i.garden.plots[n]?" "+i.garden.plots[n]:"")+(i.activeHerb?" plant-"+i.activeHerb:"")),t.Y8G("ngClass",t.sMw(3,bF,i.garden.plots[n],!i.garden.plots[n],i.garden.plots[n]==i.activeHerb||i.disabled))}}let RF=(()=>{class a{ghsManager;level=0;slots=0;garden;herbs=rt.Pr;activeHerb;disabled=!1;resources={};currentResources=[];characters=[];currentSource=-1;harvested=!1;flipAction=new $.rc($.X2.card,"flip");settingsManager=p.f;constructor(n){this.ghsManager=n}ngOnInit(){this.update(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.update()})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.garden=s.E.game.party.garden||new Fn.j;const n=s.E.game.party.buildings.find(i=>"garden"==i.name&&i.level);if(n){switch(this.level=n.level,this.level){case 1:this.slots=1;break;case 2:case 3:this.slots=2;break;case 4:this.slots=3}n.level>2&&this.garden.flipped&&(this.garden.flipped=!1)}this.disabled=null!=s.E.game.scenario,this.resources={},this.characters=s.E.game.figures.filter(i=>i instanceof H.K).map(i=>i),this.herbs.forEach(i=>{this.resources[i]=s.E.game.party.loot[i]||0,this.characters.forEach(e=>{this.resources[i]=(this.resources[i]||0)+(e.progress.loot[i]||0)}),!this.activeHerb&&this.resources[i]&&(this.activeHerb=i)}),this.activeHerb&&(this.currentResources=[],this.currentSource=-1,this.characters.forEach((i,e)=>{this.activeHerb&&(this.currentResources[e]=i.progress.loot[this.activeHerb]||0,this.currentResources[e]&&-1==this.currentSource&&(this.currentSource=e))}),this.currentResources[this.characters.length]=s.E.game.party.loot[this.activeHerb]||0,this.currentResources[this.characters.length]&&(this.currentSource=this.characters.length))}setActive(n,i=!1){(this.activeHerb==n||this.resources[n]||i)&&(this.activeHerb=this.activeHerb==n?void 0:n),this.update()}selectSource(n){this.currentResources[n]&&(this.currentSource=n)}plantHerb(n,i=!1){if(this.activeHerb&&(!this.disabled&&(this.level>2||!this.garden.flipped)&&-1!=this.currentSource&&this.currentResources[this.currentSource]||i)&&n>=0&&n<this.slots&&this.herbs.includes(this.activeHerb)&&this.garden.plots[n]!=this.activeHerb){if(s.E.stateManager.before("buildings.garden.plant",this.activeHerb,n),this.garden.plots=this.garden.plots||[],this.garden.plots[n]=this.activeHerb,!i)if(this.currentSource==this.characters.length)s.E.game.party.loot[this.activeHerb]=(s.E.game.party.loot[this.activeHerb]||1)-1;else{const e=this.characters[this.currentSource];e&&(e.progress.loot[this.activeHerb]=(e.progress.loot[this.activeHerb]||1)-1)}s.E.game.party.garden=Object.assign(new Fn.j,this.garden),s.E.stateManager.after()}}flipGarden(n=!1){(!this.disabled||n)&&this.level&&this.level<3&&(s.E.stateManager.before("buildings.garden."+(this.garden.flipped?"flipPlant":"flipHarvest")),this.garden.flipped=!this.garden.flipped,s.E.game.party.garden=Object.assign(new Fn.j,this.garden),s.E.stateManager.after())}toggleAutomation(){p.f.settings.automaticPassTime&&(s.E.stateManager.before("buildings.garden."+(this.garden.automated?"automationOff":"automationOn")),this.garden.automated=!this.garden.automated,s.E.game.party.garden=Object.assign(new Fn.j,this.garden),s.E.stateManager.after())}harvest(){s.E.stateManager.before("buildings.garden.harvest"),this.garden.plots.forEach(n=>{s.E.game.party.loot[n]=(s.E.game.party.loot[n]||0)+1}),this.harvested=!0,this.update(),s.E.stateManager.after()}static \u0275fac=function(i){return new(i||a)(t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-garden"]],standalone:!1,decls:30,vars:33,consts:[[1,"garden-container"],[1,"menu"],[1,"title",3,"ghs-label"],[1,"state-menu"],["ghs-pointer-input","",1,"state",3,"doubleClick","ghs-label"],[1,"hint-container"],["ghs-pointer-input","",1,"flip",3,"singleClick","doubleClick","ngClass","action","ghs-tooltip"],[3,"ngClass"],["type","checkbox",3,"change","checked","disabled"],[3,"ghs-label"],["src","./assets/images/hint.svg",1,"hint-trigger","ghs-svg"],[1,"hint"],[1,"text",3,"ghs-label"],[1,"herbs"],["ghs-pointer-input","",1,"herb",3,"ngClass"],[1,"sources"],[1,"source",3,"click","ngClass"],[1,"value"],[1,"source",3,"ngClass"],[1,"garden",3,"ngClass"],["ghs-pointer-input","",1,"plot",3,"class","ngClass"],[3,"click","ghs-label"],["ghs-pointer-input","",1,"herb",3,"singleClick","doubleClick","ngClass"],[1,"ghs-svg",3,"src"],[1,"character-icon",3,"src"],["ghs-pointer-input","",1,"plot",3,"singleClick","doubleClick","ngClass"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"div",2),t.j41(3,"div",3)(4,"div",4),t.bIt("doubleClick",function(){return e.flipGarden(!0)}),t.k0s(),t.j41(5,"div",5)(6,"ghs-action",6),t.bIt("singleClick",function(){return e.flipGarden()})("doubleClick",function(){return e.flipGarden(!0)}),t.k0s(),t.j41(7,"label",7)(8,"input",8),t.bIt("change",function(){return e.toggleAutomation()}),t.k0s(),t.nrm(9,"span",9),t.k0s(),t.nrm(10,"img",10),t.j41(11,"span",11),t.nrm(12,"span",12),t.k0s()(),t.nVh(13,yF,1,1,"a",9),t.k0s(),t.j41(14,"div",13),t.Z7z(15,xF,4,6,"a",14,t.fX1),t.k0s(),t.j41(17,"div",15)(18,"a",16),t.bIt("click",function(){return e.selectSource(e.characters.length)}),t.nrm(19,"span",9),t.EFF(20,":\xa0 "),t.j41(21,"span",17),t.EFF(22),t.k0s()(),t.Z7z(23,EF,4,6,"a",18,kF),t.nI1(25,"trackUUID"),t.k0s()(),t.j41(26,"div",19),t.Z7z(27,wF,1,7,"div",20,t.fX1),t.nI1(29,"ghsRange"),t.k0s()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","data.buildings.garden.plots"),t.R7$(2),t.Y8G("ghs-label",e.level<3?e.garden.flipped?"data.buildings.garden.plots.state.harvest":"data.buildings.garden.plots.state.plant":"data.buildings.garden.plots.state.both"),t.R7$(2),t.Y8G("ngClass",t.eq3(20,Qr,e.disabled))("action",e.flipAction)("ghs-tooltip","data.buildings.garden.plots.state.toggle"),t.R7$(),t.Y8G("ngClass",t.eq3(22,Qr,!e.settingsManager.settings.automaticPassTime)),t.R7$(),t.Y8G("checked",e.garden.automated&&e.settingsManager.settings.automaticPassTime)("disabled",!e.settingsManager.settings.automaticPassTime),t.R7$(),t.Y8G("ghs-label","data.buildings.garden.plots.automated"),t.R7$(3),t.Y8G("ghs-label","data.buildings.garden.plots.automated.hint"),t.R7$(),t.vxM(e.garden.automated&&e.settingsManager.settings.automaticPassTime||e.harvested?-1:13),t.R7$(2),t.Dyx(e.herbs),t.R7$(3),t.Y8G("ngClass",t.l_i(24,_o,e.currentSource==e.characters.length,!e.currentResources[e.characters.length])),t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.supply"),t.R7$(3),t.JRh(e.currentResources[e.characters.length]),t.R7$(),t.Dyx(t.bMT(25,15,e.characters)),t.R7$(3),t.Y8G("ngClass",t.ziG(27,OF,1==e.level,2==e.level,3==e.level,4==e.level)),t.R7$(),t.Dyx(t.i5U(29,17,t.lJ4(32,PF),e.slots)))},dependencies:[N.YU,en,it,Mt,dt,At,ct],styles:[".garden-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;color:var(--ghs-color-white)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;flex-direction:column}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{text-align:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .state-menu[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .state-menu[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{font-size:1.3em;display:flex;flex-direction:column;justify-content:center;align-items:center}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .state-menu[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .state-menu[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]{cursor:pointer;font-size:1.6em;margin-right:.5em}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .state-menu[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   ghs-action.disabled[_ngcontent-%COMP%]{cursor:initial;filter:grayscale(.5)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .state-menu[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .state-menu[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]{cursor:not-allowed}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .state-menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:space-evenly;align-items:center;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:auto}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]   img.character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]   img.character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]   img.character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]   img.character-icon[_ngcontent-%COMP%]{filter:grayscale(.2) brightness(.6)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb.active[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source.active[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb.active[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source.active[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb.active[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source.active[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb.active[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source.active[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb.active[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source.active[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb.active[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source.active[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%]{filter:none}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]:hover, .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]:hover, .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]:hover, .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]:hover   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]:hover   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]:hover   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]:hover   .character-icon[_ngcontent-%COMP%]{filter:none}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-darkgray)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-darkgray)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%]:hover   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%]:hover   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%]:hover   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%]:hover   .character-icon[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-darkgray)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%]:hover   .value[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%]:hover   .value[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%]:hover   .value[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%]:hover   .value[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray)}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]{position:relative;display:block;width:calc(var(--ghs-unit) * 31 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 27.1 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));background-repeat:no-repeat;background-size:contain}.garden-container[_ngcontent-%COMP%]   .garden.level-1[_ngcontent-%COMP%]{background-image:url(fh-24-garden-1.9156a2b827c26633.png)}.garden-container[_ngcontent-%COMP%]   .garden.level-2[_ngcontent-%COMP%]{background-image:url(fh-24-garden-2.f4c51e673dc61afd.png)}.garden-container[_ngcontent-%COMP%]   .garden.level-3[_ngcontent-%COMP%]{background-image:url(fh-24-garden-3.c3ac289e59e46fea.png)}.garden-container[_ngcontent-%COMP%]   .garden.level-4[_ngcontent-%COMP%]{background-image:url(fh-24-garden-4.37718a973baa6031.png)}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot[_ngcontent-%COMP%]{position:absolute;display:block;width:calc(var(--ghs-unit) * 5.7 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 9.9 * var(--ghs-dialog-factor));background-repeat:no-repeat;background-size:0;transform:rotate(-45deg);cursor:pointer}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot[_ngcontent-%COMP%]:hover{background-size:contain;filter:brightness(1.2)}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.disabled[_ngcontent-%COMP%]{cursor:initial}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.disabled[_ngcontent-%COMP%]:hover{filter:brightness(.7) grayscale(.3)}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.arrowvine[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.plant-arrowvine[_ngcontent-%COMP%]:hover{background-image:url(fh-24-garden-arrowvine.5c560f7204eeeb02.png)}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.axenut[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.plant-axenut[_ngcontent-%COMP%]:hover{background-image:url(fh-24-garden-axenut.6052f52ce4efb6d2.png)}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.corpsecap[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.plant-corpsecap[_ngcontent-%COMP%]:hover{background-image:url(fh-24-garden-corpsecap.5c223c12cf589bbe.png)}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.flamefruit[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.plant-flamefruit[_ngcontent-%COMP%]:hover{background-image:url(fh-24-garden-flamefruit.c0ef615e88b2f29c.png)}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.rockroot[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.plant-rockroot[_ngcontent-%COMP%]:hover{background-image:url(fh-24-garden-rockroot.bbb895ccd29d00d4.png)}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.snowthistle[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.plant-snowthistle[_ngcontent-%COMP%]:hover{background-image:url(fh-24-garden-snowthistle.4c3f99f6db17caf8.png)}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.harvest[_ngcontent-%COMP%]{background-size:contain}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.plot-1[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 14.3 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 12.5 * var(--ghs-dialog-factor))}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.plot-2[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 7.2 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 5.5 * var(--ghs-dialog-factor))}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.plot-3[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 3.6 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 10.5 * var(--ghs-dialog-factor))}"]})}return a})();const jF=a=>({flipped:a});function GF(a,r){if(1&a&&(t.j41(0,"div",13),t.nrm(1,"ghs-action",17),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Aen("fh"),t.Y8G("action",n.petCard.action)("textBlack",!0)}}function TF(a,r){1&a&&(t.j41(0,"div",14),t.nrm(1,"span",18),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","%game.card.round%"))}function SF(a,r){1&a&&(t.j41(0,"div",15),t.nrm(1,"span",18),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","%game.card.lost%"))}function DF(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function $F(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",2),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.revealed.emit(e))}),t.j41(1,"div",3)(2,"span",4),t.nrm(3,"span",5),t.k0s(),t.j41(4,"div",6)(5,"span"),t.EFF(6),t.k0s()()(),t.j41(7,"div",7),t.nrm(8,"img",8)(9,"div",9),t.j41(10,"div",10),t.nrm(11,"span",11),t.EFF(12,": "),t.j41(13,"span",12),t.EFF(14),t.nrm(15,"br"),t.k0s()(),t.nVh(16,GF,2,4,"div",13),t.nVh(17,TF,2,1,"div",14),t.nVh(18,SF,2,1,"div",15),t.j41(19,"div",16),t.nVh(20,DF,2,0,"span"),t.j41(21,"span"),t.EFF(22),t.k0s()()()()}if(2&a){const n=t.XpG();t.xc7("font-size",n.fontsize),t.Y8G("ngClass",t.eq3(15,jF,n.flipped))("disabled",!n.reveal||!1),t.R7$(3),t.Y8G("ghs-label","data.buildings.stables.pets.confirmAdd"),t.R7$(3),t.JRh(n.petCard.id),t.R7$(2),t.Y8G("src","./assets/artwork/pets/"+n.petCard.edition+"-"+n.petCard.id+".png",t.B4B),t.R7$(),t.Y8G("ghs-label","data.pets."+n.petCard.edition+"-"+n.petCard.id),t.R7$(2),t.Y8G("ghs-label","data.buildings.stables.pets.name"),t.R7$(3),t.JRh(n.name),t.R7$(2),t.vxM(n.petCard.action?16:-1),t.R7$(),t.vxM(n.petCard.round?17:-1),t.R7$(),t.vxM(n.petCard.lost?18:-1),t.R7$(2),t.vxM(n.petCard.cardId<1e3?20:-1),t.R7$(2),t.JRh(n.petCard.cardId)}}let IF=(()=>{class a{elementRef;ghsManager;petCard;flipped=!1;reveal=!1;name="";revealed=new t.bkB;settingsManager=p.f;gameManager=s.E;fontsize="1em";constructor(n,i){this.elementRef=n,this.ghsManager=i}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.fontsize=.072*this.elementRef.nativeElement.offsetWidth+"px"}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}ngAfterViewInit(){setTimeout(()=>{this.fontsize=.072*this.elementRef.nativeElement.offsetWidth+"px"},1)}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-pet-card"]],inputs:{petCard:"petCard",flipped:"flipped",reveal:"reveal",name:"name"},outputs:{revealed:"revealed"},standalone:!1,decls:2,vars:1,consts:[[1,"pet-container"],["card-reveal","",1,"card","vertical","reverse","pet",3,"ngClass","fontSize","disabled"],["card-reveal","",1,"card","vertical","reverse","pet",3,"change","ngClass","disabled"],[1,"card-back","back"],[1,"revealed"],[1,"text",3,"ghs-label"],[1,"id"],[1,"card-front","front"],[1,"artwork",3,"src"],[1,"title",3,"ghs-label"],[1,"name-container"],[1,"label",3,"ghs-label"],[1,"name"],[1,"action"],[1,"round"],["ghs-pointer-input","",1,"lost"],[1,"card-id"],[3,"action","textBlack"],[1,"placeholder","text-white",3,"ghs-label"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nVh(1,$F,23,17,"div",1),t.k0s()),2&i&&(t.R7$(),t.vxM(e.petCard?1:-1))},dependencies:[N.YU,en,Nn,it,dt],styles:[".pet-container[_ngcontent-%COMP%]{position:relative;width:100%;padding-bottom:147%}.pet[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%}.pet[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]{background-image:url(pets-card-front.8af176984078531e.png);background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:.5em;background-clip:padding-box}.pet[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .artwork[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;-webkit-mask-image:url(pets-card-front-mask.ab630ec0123dc838.png);mask-image:url(pets-card-front-mask.ab630ec0123dc838.png);-webkit-mask-size:100% 100%;mask-size:100% 100%;-webkit-mask-position:center center;mask-position:center center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat}.pet[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{position:absolute;top:4%;left:0;width:100%;height:10%;display:flex;color:var(--ghs-color-white);justify-content:center;align-items:center;font-family:var(--ghs-font-fh-title);font-size:1.3em;filter:var(--ghs-filter-outline-thin)}.pet[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]{position:absolute;top:14%;left:5%;width:95%;height:8%;color:var(--ghs-color-white);font-size:.8em;font-family:var(--ghs-font-fh-normal);filter:var(--ghs-filter-outline-thin);display:flex;align-items:center}.pet[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-extra);font-size:1.05em;margin-left:3%;flex-grow:1}.pet[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{position:absolute;top:74%;left:5%;width:75%;height:26%;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;font-family:var(--ghs-font-fh-normal);font-size:1.25em;line-height:.8em}.pet[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round[_ngcontent-%COMP%], .pet[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .lost[_ngcontent-%COMP%]{position:absolute;top:72%;left:80%;width:20%;height:13%;display:flex;justify-content:center;align-items:center;text-align:center;font-size:1.8em}.pet[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round.lost[_ngcontent-%COMP%], .pet[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .lost.lost[_ngcontent-%COMP%]{top:83%}.pet[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{position:absolute;bottom:0;left:78%;width:15%;height:6%;display:flex;justify-content:flex-end;align-items:center;font-family:var(--ghs-font-gh-normal);font-size:.65em}.pet[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%]{background-image:url(pets-card-back.79996ec51190a1bf.png);background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:.5em;background-clip:padding-box}.pet[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{position:absolute;top:0;left:40%;width:20%;height:7%;display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-fh-title);font-size:1.2em}.pet.confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]{position:relative;top:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;text-align:center;color:var(--ghs-color-white);font-size:1.5em;filter:drop-shadow(calc(var(--ghs-unit) * .2) calc(var(--ghs-unit) * .2) calc(var(--ghs-unit) * .2) var(--ghs-color-black))}.pet.confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{text-align:center}"]})}return a})();const AF=(a,r)=>({full:a,warning:r}),VF=(a,r,n)=>({selected:a,unavailable:r,disabled:n}),FF=(a,r)=>r._trackUUID;function XF(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",7),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.edit,e)||(o.edit=e),c.Njj(e)}),t.k0s(),t.nrm(2,"span",8),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.R50("ngModel",n.edit),t.R7$(),t.Y8G("ghs-label","data.buildings.stables.pets.edit")}}function BF(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",9),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.showAll,e)||(o.showAll=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.update())}),t.k0s(),t.nrm(2,"span",8),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.R50("ngModel",n.showAll),t.R7$(),t.Y8G("ghs-label","data.buildings.stables.pets.showAll")}}function YF(a,r){1&a&&(t.j41(0,"div",5),t.nrm(1,"span",8),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","data.buildings.stables.pets.empty"))}function UF(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-pet-card",15),t.bIt("revealed",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.addPet(e))}),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG();t.Y8G("petCard",n.card)("flipped",null!=n.model)("reveal",null==n.model)("name",!i.edit&&n.model?n.model.petname:"")("ngClass",t.sMw(5,VF,(i.select||i.running)&&n.model&&n.model.active,n.model&&n.model.active&&n.model.lost,(!n.model||!n.model.active)&&!i.select&&i.running))}}function NF(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",16),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.toggleActive(e.model))})("doubleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.toggleActive(e.model,!0))}),t.k0s()}}function zF(a,r){if(1&a){const n=t.RV6();t.j41(0,"input",17),t.bIt("change",function(e){c.eBV(n);const o=t.XpG().$implicit,g=t.XpG();return c.Njj(g.updatePet(e,o.model))}),t.k0s()}if(2&a){const n=t.XpG().$implicit;t.Y8G("value",n.model.petname)}}function LF(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",18),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.removePet(e.model))}),t.nrm(1,"img",19),t.k0s()}}function qF(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",20),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.toggleLost(e.model))})("doubleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.toggleLost(e.model,!0))}),t.k0s()}}function HF(a,r){if(1&a&&(t.j41(0,"div",6),t.nVh(1,UF,1,9,"ghs-pet-card",10),t.nVh(2,NF,1,0,"div",11),t.nVh(3,zF,1,1,"input",12),t.nVh(4,LF,2,0,"a",13),t.nVh(5,qF,1,0,"a",14),t.k0s()),2&a){const n=r.$implicit,i=t.XpG();t.R7$(),t.vxM(n.card?1:-1),t.R7$(),t.vxM(!i.edit&&n.model&&(i.select||i.running)?2:-1),t.R7$(),t.vxM(i.edit&&n.model?3:-1),t.R7$(),t.vxM(i.edit&&n.model?4:-1),t.R7$(),t.vxM(!i.edit&&i.running&&n.model&&n.model.active?5:-1)}}let tc=(()=>{class a{ghsManager;pets=[];edit=!1;select=!1;running=!1;showAll=!1;capacity=0;used=0;active=0;constructor(n){this.ghsManager=n}ngOnInit(){this.update(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.updateState()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.select=null!=s.E.game.scenario&&s.E.roundManager.firstRound,this.running=null!=s.E.game.scenario&&!this.select,this.used=0,this.pets=[];const n=s.E.game.party.buildings.find(i=>"stables"==i.name&&i.level);if(n&&(this.active=n.level<3?1:2,this.capacity=4+4*Math.floor(n.level/2)),this.showAll){const i=s.E.editionData.find(e=>e.edition==s.E.currentEdition());i&&i.pets&&i.pets.forEach(e=>{const o=s.E.game.party.pets.find(g=>g.edition==e.edition&&g.name==e.id);o&&this.used++,this.pets.push({card:e,model:o})})}s.E.game.party.pets.forEach(i=>{if(null==this.pets.find(e=>e.model&&e.model.edition&&i.edition&&e.model.name==i.name)){const e=s.E.editionData.find(o=>o.edition==i.edition);if(e&&e.pets){const o=e.pets.find(g=>g.edition==i.edition&&g.id==i.name);this.pets.push({card:o,model:i})}else this.pets.push({card:void 0,model:i});this.used++}}),this.pets.sort((i,e)=>i.model&&!e.model?-1:!i.model&&e.model?1:i.model&&e.model&&i.model.active!=e.model.active?i.model.active?-1:1:i.card&&e.card?i.card.id<e.card.id?-1:1:i.model&&e.model?i.model.name<e.model.name?-1:1:0)}updateState(){s.E.game.party.pets.forEach(n=>{const i=this.pets.find(e=>e.model&&e.model.edition&&n.edition&&e.model.name==n.name);i&&i.model&&(i.model.active=n.active,i.model.lost=n.lost,i.model.petname=n.petname)})}addPet(n){if(n.card&&null==s.E.game.party.pets.find(i=>n.card&&i.edition==n.card.edition&&i.name==n.card.id)){const i=new as.j(n.card.id,n.card.edition);s.E.stateManager.before("buildings.stables.pets.add",i.edition,i.name),s.E.game.party.pets.push(i),n.model=i,this.used++,s.E.stateManager.after()}}updatePet(n,i){if(i&&n.target){const e=n.target.value;s.E.stateManager.before(e?"buildings.stables.pets.setName":"buildings.stables.pets.unsetName",i.edition,i.name,e),i.petname=e,s.E.stateManager.after()}}removePet(n){n&&(s.E.stateManager.before("buildings.stables.pets.remove",n.edition,n.name),s.E.game.party.pets=s.E.game.party.pets.filter(i=>i.edition!=n.edition||i.name!=n.name),this.update(),s.E.stateManager.after())}toggleLost(n,i=!1){n&&(!n.lost||i)&&(s.E.stateManager.before(n.lost?"buildings.stables.pets.restore":"buildings.stables.pets.play",n.edition,n.name),n.lost=!n.lost,s.E.stateManager.after())}toggleActive(n,i=!1){if(n&&!this.edit&&(this.select||i)){s.E.stateManager.before(n.active?"buildings.stables.pets.setInactive":"buildings.stables.pets.setActive",n.edition,n.name,n.petname),n.active=!n.active;const e=s.E.game.party.buildings.find(o=>"stables"==o.name&&o.level);for(;!i&&e&&s.E.game.party.pets.filter(o=>o.active).length>(e.level<3?1:2);){const o=s.E.game.party.pets.find(g=>g.active&&g!=n);o&&(o.active=!1)}s.E.stateManager.after()}}static \u0275fac=function(i){return new(i||a)(t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-stables"]],standalone:!1,decls:13,vars:11,consts:[[1,"stables-container"],[1,"menu"],[1,"capacity"],[1,"used",3,"ngClass"],[1,"scroll-container","pet-list"],[1,"empty"],[1,"pet"],["type","checkbox",3,"ngModelChange","ngModel"],[3,"ghs-label"],["type","checkbox",3,"ngModelChange","change","ngModel"],[3,"petCard","flipped","reveal","name","ngClass"],["ghs-pointer-input","",1,"toggle-active"],["type","text",1,"name",3,"value"],[1,"button-remove"],["ghs-pointer-input","",1,"button-lost"],[3,"revealed","petCard","flipped","reveal","name","ngClass"],["ghs-pointer-input","",1,"toggle-active",3,"singleClick","doubleClick"],["type","text",1,"name",3,"change","value"],[1,"button-remove",3,"click"],["src","./assets/images/minus.svg",1,"ghs-svg"],["ghs-pointer-input","",1,"button-lost",3,"singleClick","doubleClick"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"span",2)(3,"span",3),t.EFF(4),t.k0s(),t.EFF(5),t.k0s(),t.nVh(6,XF,3,2,"label"),t.nVh(7,BF,3,2,"label"),t.k0s(),t.j41(8,"div",4),t.nVh(9,YF,2,1,"div",5),t.Z7z(10,HF,6,5,"div",6,FF),t.nI1(12,"trackUUID"),t.k0s()()),2&i&&(t.R7$(3),t.Y8G("ngClass",t.l_i(8,AF,e.used==e.capacity,e.used>e.capacity)),t.R7$(),t.JRh(e.used),t.R7$(),t.SpI("/",e.capacity),t.R7$(),t.vxM(e.running?-1:6),t.R7$(),t.vxM(e.running?-1:7),t.R7$(2),t.vxM(e.pets.length?-1:9),t.R7$(),t.Dyx(t.bMT(12,6,e.pets)))},dependencies:[N.YU,E.Zm,E.BC,E.vS,it,IF,dt,ct],styles:[".stables-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;color:var(--ghs-color-white)}.stables-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:center;align-items:center;z-index:1}.stables-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .capacity[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.stables-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .capacity[_ngcontent-%COMP%]   .used.full[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.stables-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .capacity[_ngcontent-%COMP%]   .used.warning[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.stables-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer;color:var(--ghs-color-white);margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]{position:relative;display:flex;flex-wrap:wrap;justify-content:center;margin:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor)) 0;min-height:calc(var(--ghs-unit) * 40.5 * var(--ghs-dialog-factor))}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-yellow)}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]{position:relative;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 27 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 40.5 * var(--ghs-dialog-factor))}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   ghs-pet-card[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;border:calc(var(--ghs-unit) * .35 * var(--ghs-dialog-factor)) solid transparent;border-radius:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));overflow:hidden}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   ghs-pet-card.unavailable[_ngcontent-%COMP%]{cursor:initial;border-color:var(--ghs-color-darkgray);filter:grayscale(.7)}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   ghs-pet-card.disabled[_ngcontent-%COMP%]{cursor:not-allowed;opacity:.5}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   ghs-pet-card.edit[_ngcontent-%COMP%]{cursor:initial}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   ghs-pet-card.selectable[_ngcontent-%COMP%]{cursor:pointer}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   ghs-pet-card.selected[_ngcontent-%COMP%]{border-color:var(--ghs-color-green);opacity:1}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   .toggle-active[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;z-index:2}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   input.name[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 6.2 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 5.35 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 21 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);font-family:var(--ghs-font-fh-extra);filter:var(--ghs-filter-outline-thin);font-size:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor))}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]{z-index:1;position:absolute;display:flex;cursor:pointer;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-filter-white) var(--ghs-filter-shadow)}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-shadow)}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   .button-lost[_ngcontent-%COMP%]{z-index:1;position:absolute;display:block;cursor:pointer;bottom:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * 1.2 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}"]})}return a})();const KF=(a,r,n,i)=>({short:a,"visible-effects":r,"visible-interactions":n,invert:i}),WF=a=>({buildable:a}),sa=a=>({disabled:a}),ZF=a=>[a],JF=(a,r)=>r._trackUUID;function QF(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",9),t.nrm(1,"span",3),t.j41(2,"a",10),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.settingsManager.toggle("buildingEffectsVisible"))}),t.nrm(3,"img",11),t.k0s()(),t.j41(4,"span",12),t.nrm(5,"span",3),t.j41(6,"a",10),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.settingsManager.toggle("buildingInteractionsVisible"))}),t.nrm(7,"img",11),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.buildings.effects"),t.R7$(2),t.Y8G("src","./assets/images/"+(n.settingsManager.settings.buildingEffectsVisible?"wake-lock":"hidden")+".svg",t.B4B),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.buildings.interactions"),t.R7$(2),t.Y8G("src","./assets/images/"+(n.settingsManager.settings.buildingInteractionsVisible?"wake-lock":"hidden")+".svg",t.B4B)}}function tX(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.SpI("(",n.data.id,")")}}function nX(a,r){if(1&a&&(t.j41(0,"span",17)(1,"span",21),t.nrm(2,"img",22),t.k0s(),t.nrm(3,"span",23),t.k0s()),2&a){const n=t.XpG(2).$implicit;t.R7$(),t.Y8G("ghs-tooltip",n.data.effectNormal[n.model.level-1])("originY","top")("overlayY","bottom"),t.R7$(2),t.Y8G("ghs-label",n.data.effectNormal[n.model.level-1])}}function eX(a,r){if(1&a&&(t.j41(0,"span",17)(1,"span",24),t.nrm(2,"img",22),t.k0s(),t.nrm(3,"span",23),t.k0s()),2&a){const n=t.XpG(2).$implicit;t.R7$(),t.Y8G("ghs-tooltip",n.data.effectWrecked[n.model.level-1])("originY","top")("overlayY","bottom"),t.R7$(2),t.Y8G("ghs-label",n.data.effectWrecked[n.model.level-1])}}function aX(a,r){if(1&a&&(t.j41(0,"span",18)(1,"span",21),t.nrm(2,"img",25),t.k0s(),t.nrm(3,"span",23),t.k0s()),2&a){const n=t.XpG(2).$implicit;t.R7$(),t.Y8G("ghs-tooltip",n.data.interactionsAvailable[n.model.level-1])("originY","top")("overlayY","bottom"),t.R7$(2),t.Y8G("ghs-label",n.data.interactionsAvailable[n.model.level-1])}}function iX(a,r){if(1&a&&(t.j41(0,"span",18)(1,"span",24),t.nrm(2,"img",25),t.k0s(),t.nrm(3,"span",23),t.k0s()),2&a){const n=t.XpG(2).$implicit;t.R7$(),t.Y8G("ghs-tooltip",n.data.interactionsUnavailable[n.model.level-1])("originY","top")("overlayY","bottom"),t.R7$(2),t.Y8G("ghs-label",n.data.interactionsUnavailable[n.model.level-1])}}function oX(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",19)(1,"span",26),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openStables())}),t.nrm(2,"img",27),t.k0s(),t.j41(3,"span",28),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openStables())}),t.k0s()()}2&a&&(t.R7$(),t.Y8G("ghs-tooltip","data.buildings.stables.pets.interaction"),t.R7$(2),t.Y8G("ghs-label","data.buildings.stables.pets.interaction"))}function sX(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",20)(1,"span",26),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openGarden())}),t.nrm(2,"img",29),t.k0s(),t.j41(3,"span",28),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openGarden())}),t.k0s()()}2&a&&(t.R7$(),t.Y8G("ghs-tooltip","data.buildings.garden.plots.interaction"),t.R7$(2),t.Y8G("ghs-label","data.buildings.garden.plots.interaction"))}function rX(a,r){if(1&a&&(t.j41(0,"span",9),t.nVh(1,nX,4,4,"span",17),t.nVh(2,eX,4,4,"span",17),t.k0s(),t.j41(3,"span",12),t.nVh(4,aX,4,4,"span",18),t.nVh(5,iX,4,4,"span",18),t.nVh(6,oX,4,2,"span",19),t.nVh(7,sX,4,2,"span",20),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(),t.vxM("normal"===n.model.state&&n.data.effectNormal&&n.data.effectNormal[n.model.level-1]?1:-1),t.R7$(),t.vxM("wrecked"===n.model.state&&n.data.effectWrecked&&n.data.effectWrecked[n.model.level-1]?2:-1),t.R7$(2),t.vxM("normal"===n.model.state&&n.data.interactionsAvailable&&n.data.interactionsAvailable[n.model.level-1]?4:-1),t.R7$(),t.vxM("wrecked"===n.model.state&&n.data.interactionsUnavailable&&n.data.interactionsUnavailable[n.model.level-1]?5:-1),t.R7$(),t.vxM(i.gameManager.buildingsManager.petsEnabled&&"stables"==n.data.name?6:-1),t.R7$(),t.vxM(i.gameManager.buildingsManager.gardenEnabled&&"garden"==n.data.name?7:-1)}}function cX(a,r){if(1&a&&(t.j41(0,"span",30),t.nrm(1,"img",31),t.EFF(2),t.k0s(),t.j41(3,"span",30),t.nrm(4,"img",32),t.EFF(5),t.k0s(),t.j41(6,"span",30),t.nrm(7,"img",33),t.EFF(8),t.k0s(),t.j41(9,"span",30),t.nrm(10,"img",34),t.EFF(11),t.k0s(),t.j41(12,"span",30),t.nrm(13,"img",35),t.EFF(14),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(2),t.SpI(" ",n.data.costs.prosperity||"-"),t.R7$(3),t.SpI(" ",n.data.costs.lumber||"-"),t.R7$(3),t.SpI(" ",n.data.costs.metal||"-"),t.R7$(3),t.SpI(" ",n.data.costs.hide||"-"),t.R7$(3),t.SpI(" ",n.data.costs.gold||"-")}}function lX(a,r){if(1&a&&(t.j41(0,"span",30),t.nrm(1,"img",31),t.EFF(2),t.k0s(),t.j41(3,"span",30),t.nrm(4,"img",32),t.EFF(5),t.k0s(),t.j41(6,"span",30),t.nrm(7,"img",33),t.EFF(8),t.k0s(),t.j41(9,"span",30),t.nrm(10,"img",34),t.EFF(11),t.k0s()),2&a){const n=t.XpG(2).$implicit;t.R7$(2),t.SpI(" ",n.data.upgrades[n.model.level-1].prosperity||"-"),t.R7$(3),t.SpI(" ",n.data.upgrades[n.model.level-1].lumber||"-"),t.R7$(3),t.SpI(" ",n.data.upgrades[n.model.level-1].metal||"-"),t.R7$(3),t.SpI(" ",n.data.upgrades[n.model.level-1].hide||"-")}}function gX(a,r){1&a&&t.nrm(0,"span",38),2&a&&t.Y8G("ghs-label","party.campaign.sheet.buildings.repair.morale")}function dX(a,r){if(1&a&&(t.j41(0,"span",36),t.nrm(1,"span",37),t.j41(2,"span",30),t.nrm(3,"img",32),t.k0s(),t.j41(4,"span",30),t.nrm(5,"img",33),t.k0s(),t.j41(6,"span",30),t.nrm(7,"img",34),t.k0s(),t.nVh(8,gX,1,1,"span",38),t.k0s()),2&a){const n=t.XpG(2).$implicit,i=t.XpG();t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.buildings.repair.costs")("ghs-label-args",t.eq3(3,ZF,""+n.data.repair[n.model.level-1])),t.R7$(7),t.vxM(i.gameManager.game.party.morale>0?8:-1)}}function hX(a,r){if(1&a&&(t.nrm(0,"span"),t.j41(1,"span",30),t.nrm(2,"img",32),t.EFF(3),t.k0s(),t.j41(4,"span",30),t.nrm(5,"img",33),t.EFF(6),t.k0s(),t.j41(7,"span",30),t.nrm(8,"img",34),t.EFF(9),t.k0s()),2&a){const n=t.XpG(2).$implicit;t.R7$(3),t.SpI(" ",n.data.rebuild[n.model.level-1].lumber||"-"),t.R7$(3),t.SpI(" ",n.data.rebuild[n.model.level-1].metal||"-"),t.R7$(3),t.SpI(" ",n.data.rebuild[n.model.level-1].hide||"-")}}function _X(a,r){if(1&a&&(t.nVh(0,lX,12,4),t.nVh(1,dX,9,5,"span",36),t.nVh(2,hX,10,3)),2&a){const n=t.XpG().$implicit;t.vxM("normal"==n.model.state&&n.model.level<n.data.upgrades.length+1&&!n.data.upgrades[n.model.level-1].manual?0:-1),t.R7$(),t.vxM("damaged"==n.model.state&&n.data.repair?1:-1),t.R7$(),t.vxM("wrecked"==n.model.state?2:-1)}}function mX(a,r){if(1&a&&t.nrm(0,"span",3),2&a){const n=t.XpG(2).$implicit;t.Y8G("ghs-label","party.campaign.sheet.buildings."+(n.model.level>0?"upgrade":"build"))}}function pX(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",39),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.upgrade(e))})("doubleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.upgrade(e,!0))}),t.nVh(1,mX,1,1,"span",3),t.nrm(2,"img",11),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(7,sa,!i.upgradeable(n)))("ghs-tooltip","party.campaign.sheet.buildings."+(n.model.level>0?"upgrade.hint":"build.hint"))("originX","end")("originY","bottom")("overlayX","end"),t.R7$(),t.vxM(i.short?-1:1),t.R7$(),t.Y8G("src","./assets/images/fh/buildings/"+(n.model.level>0?"upgrade":"build")+".svg",t.B4B)}}function uX(a,r){1&a&&t.nrm(0,"span",3),2&a&&t.Y8G("ghs-label","party.campaign.sheet.buildings.repair")}function fX(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",39),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.repair(e))})("doubleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.repair(e,!0))}),t.nVh(1,uX,1,1,"span",3),t.nrm(2,"img",40),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(6,sa,!i.upgradeable(n)))("ghs-tooltip","party.campaign.sheet.buildings.repair.hint")("originX","end")("originY","bottom")("overlayX","end"),t.R7$(),t.vxM(i.short?-1:1)}}function CX(a,r){1&a&&t.nrm(0,"span",3),2&a&&t.Y8G("ghs-label","party.campaign.sheet.buildings.rebuild")}function MX(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",39),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.rebuild(e))})("doubleClick",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.rebuild(e,!0))}),t.nVh(1,CX,1,1,"span",3),t.nrm(2,"img",41),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(6,sa,!i.upgradeable(n)))("ghs-tooltip","party.campaign.sheet.buildings.rebuild.hint")("originX","end")("originY","bottom")("overlayX","end"),t.R7$(),t.vxM(i.short?-1:1)}}function vX(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",8)(1,"span",13),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.toggleState(e))})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.toggleState(e,!0))}),t.nrm(2,"span")(3,"span",3),t.k0s(),t.j41(4,"span",4),t.nVh(5,tX,2,1,"span"),t.k0s(),t.j41(6,"span",14),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.rewardsDialog(e))})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.downgrade(e))}),t.EFF(7),t.k0s(),t.nVh(8,rX,8,6),t.j41(9,"span",15),t.nVh(10,cX,15,5),t.nVh(11,_X,3,3),t.k0s(),t.j41(12,"span",7),t.nVh(13,pX,3,9,"span",16),t.nVh(14,fX,3,8,"span",16),t.nVh(15,MX,3,8,"span",16),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(17,WF,!n.model.level)),t.R7$(),t.Y8G("ngClass",t.eq3(19,sa,!n.model.level||!n.data.repair)),t.R7$(),t.HbH(t.VkB("state ",n.model.state)),t.R7$(),t.Y8G("ghs-label","data.buildings."+n.model.name),t.R7$(2),t.vxM(n.data.id?5:-1),t.R7$(),t.Y8G("ghs-tooltip","party.campaign.sheet.buildings.level.hint")("originY","bottom"),t.R7$(),t.JRh(n.model.level||"-"),t.R7$(),t.vxM(i.short?-1:8),t.R7$(),t.Y8G("ngClass",t.eq3(21,sa,!i.upgradeable(n))),t.R7$(),t.vxM(n.model.level?-1:10),t.R7$(),t.vxM(n.model.level>0?11:-1),t.R7$(2),t.vxM(n.model.level<n.data.upgrades.length+1&&"normal"==n.model.state?13:-1),t.R7$(),t.vxM("damaged"==n.model.state?14:-1),t.R7$(),t.vxM("wrecked"==n.model.state?15:-1)}}let nc=(()=>{class a{dialog;buildings=[];short=!1;invert=!1;change=new t.bkB;gameManager=s.E;settingsManager=p.f;constructor(n){this.dialog=n}upgradeable(n){let i=n.model.level?n.data.upgrades[n.model.level-1]:n.data.costs;if(n.model.level&&!n.data.repair)return!1;if(n.data.repair&&"damaged"==n.model.state){const o=n.data.repair[n.model.level-1];return this.partyResource(rt.r6.lumber)+this.partyResource(rt.r6.metal)+this.partyResource(rt.r6.hide)>o||s.E.game.party.morale>0}let e=null!=s.E.game.party.buildings.find(o=>"carpenter"==o.name&&o.level>0&&"wrecked"!=o.state);if("wrecked"==n.model.state){if(i=n.data.rebuild[n.model.level-1],i.lumber>this.partyResource(rt.r6.lumber)){if(!e||i.lumber!=this.partyResource(rt.r6.lumber)+1)return!1;e=!1}if(i.metal>this.partyResource(rt.r6.metal)){if(!e||i.metal!=this.partyResource(rt.r6.metal)+1)return!1;e=!1}if(i.hide>this.partyResource(rt.r6.hide)){if(!e||i.hide!=this.partyResource(rt.r6.hide)+1)return!1;e=!1}return!0}if(n.model.level<n.data.upgrades.length+1){if(i.prosperity&&i.prosperity>s.E.prosperityLevel())return!1;if((i.lumber||0)>this.partyResource(rt.r6.lumber)){if(!e||i.lumber!=this.partyResource(rt.r6.lumber)+1)return!1;e=!1}if((i.metal||0)>this.partyResource(rt.r6.metal)){if(!e||i.metal!=this.partyResource(rt.r6.metal)+1)return!1;e=!1}if((i.hide||0)>this.partyResource(rt.r6.hide)){if(!e||i.hide!=this.partyResource(rt.r6.hide)+1)return!1;e=!1}const o=s.E.game.figures.filter(g=>g instanceof H.K).map(g=>g.progress.gold);return!(!o.length||(i.gold||0)>o.reduce((g,m)=>g+m))}return!1}partyResource(n){return(s.E.game.party.loot[n]||0)+(0==s.E.game.figures.filter(i=>i instanceof H.K).length?0:s.E.game.figures.filter(i=>i instanceof H.K).map(i=>i.progress.loot[n]||0).reduce((i,e)=>i+e))}upgrade(n,i=!1){n.model.level<n.data.upgrades.length+1&&(this.upgradeable(n)||i)&&this.dialog.open(ea,{panelClass:["dialog"],data:{costs:n.model.level?n.data.upgrades[n.model.level-1]:n.data.costs,building:n,action:n.model.level>0?"upgrade":"build",force:i}}).closed.subscribe({next:o=>{(i&&1==o||o instanceof Bn.CS)&&setTimeout(()=>{if(s.E.stateManager.before(n.model.level?"upgradeBuilding":"buildBuilding",n.data.id,n.model.name,n.model.level+1),!i&&o instanceof Bn.CS&&s.E.lootManager.applySelectResources(o),n.model.level++,s.E.game.party.campaignMode&&p.f.settings.applyBuildingRewards&&n.data.rewards&&n.data.rewards[n.model.level-1]){const g=n.data.rewards[n.model.level-1];s.E.buildingsManager.applyRewards(g),g.section&&this.openConclusion(g.section)}s.E.stateManager.after()},1)}})}openConclusion(n){const i=s.E.sectionData(s.E.currentEdition()).find(e=>e.index==n);if(i){const e=new ut.Nz(i);this.hasConclusions(e.index)?this.openConclusions(e.index):this.dialog.open(zt,{panelClass:["dialog"],data:{scenario:e,conclusionOnly:!0}})}}hasConclusions(n){const i=s.E.sectionData(s.E.game.edition).filter(e=>e.conclusion&&!e.parent&&e.parentSections&&e.parentSections.find(o=>1==o.length&&o.includes(n)));return i.length>0&&i.every(e=>!s.E.game.party.conclusions.find(o=>o.edition==e.edition&&o.index==e.index&&o.group==e.group))}openConclusions(n){let i=s.E.sectionData(s.E.game.edition).filter(e=>e.conclusion&&!e.parent&&e.parentSections&&e.parentSections.find(o=>1==o.length&&o.includes(n))&&0==s.E.scenarioManager.getRequirements(e).length).map(e=>e);i.length>0&&this.dialog.open(Xn,{panelClass:["dialog"],data:{conclusions:i,parent:s.E.sectionData(s.E.game.edition).find(e=>e.index==n&&!e.group)}}).closed.subscribe({next:e=>{if(e){const o=new ut.Nz(e);this.openConclusion(o.index)}}})}rebuild(n,i=!1){"wrecked"==n.model.state&&(this.upgradeable(n)||i)&&this.dialog.open(ea,{panelClass:["dialog"],data:{costs:n.data.rebuild[n.model.level-1],building:n,action:"rebuild",force:i}}).closed.subscribe({next:e=>{(i&&1==e||e instanceof Bn.CS)&&(s.E.stateManager.before("rebuildBuilding",n.data.id,n.model.name),!i&&e instanceof Bn.CS&&s.E.lootManager.applySelectResources(e),n.model.state="normal",s.E.stateManager.after())}})}repair(n,i=!1){"damaged"==n.model.state&&(this.upgradeable(n)||i)&&this.dialog.open(ea,{panelClass:["dialog"],data:{repair:n.data.repair&&n.data.repair[n.model.level-1],building:n,action:"repair",force:i}}).closed.subscribe({next:e=>{(i&&1==e||e instanceof Bn.CS)&&(s.E.stateManager.before("repairBuilding",n.data.id,n.data.name),!i&&e instanceof Bn.CS&&(e.morale?(s.E.game.party.morale-=e.morale,s.E.game.party.morale<0&&(s.E.game.party.morale=0)):s.E.lootManager.applySelectResources(e)),n.model.state="normal",s.E.stateManager.after())}})}rewardsDialog(n){if(n.data.rewards&&n.data.rewards[n.model.level-1]){const i=n.data.rewards[n.model.level-1];(i.defense||i.items||i.loseMorale||i.plots||i.prosperity||i.section||i.soldiers)&&this.dialog.open(ea,{panelClass:["dialog"],data:{building:n,action:"rewards"}})}}toggleState(n,i=!1){n.data.repair&&n.model.level>0&&("normal"==n.model.state?(s.E.stateManager.before("changeBuildingState",n.data.id,n.model.name,"damaged"),n.model.state="damaged",s.E.stateManager.after()):"damaged"==n.model.state?(s.E.stateManager.before("changeBuildingState",n.data.id,n.model.name,"wrecked"),n.model.state="wrecked",s.E.stateManager.after()):i&&"wrecked"==n.model.state&&(s.E.stateManager.before("changeBuildingState",n.data.id,n.model.name,"normal"),n.model.state="normal",s.E.stateManager.after()))}downgrade(n,i=!1){const e=s.E.game.party.buildings.indexOf(n.model);if(-1!=e){if(s.E.buildingsManager.initialBuilding(n.data)||s.E.buildingsManager.availableBuilding(n.data)||0!=n.model.level&&!i){if(!s.E.buildingsManager.initialBuilding(n.data)&&!s.E.buildingsManager.availableBuilding(n.data)||n.model.level>1){if(s.E.stateManager.before("downgradeBuilding",n.data.id,n.model.name,n.model.level-1),n.model.level--,0==n.model.level&&(n.model.state="normal"),s.E.game.party.campaignMode&&n.data.rewards&&n.data.rewards[n.model.level]&&n.data.rewards[n.model.level].section){const o=s.E.sectionData(s.E.currentEdition()).find(g=>g.index==n.data.rewards[n.model.level].section);if(o){const g=s.E.buildingsManager.rewardSection(o);g&&(s.E.game.party.conclusions=s.E.game.party.conclusions.filter(m=>m.edition!=g.edition||m.group!=g.group||m.index!=g.index))}}s.E.stateManager.after()}}else{if(s.E.stateManager.before("removeBuilding",n.data.id,n.model.name),n.model.state="normal",s.E.game.party.buildings.splice(e,1),s.E.game.party.campaignMode&&n.data.rewards&&n.data.rewards[0]&&n.data.rewards[0].section){const o=s.E.sectionData(s.E.currentEdition()).find(g=>g.index==n.data.rewards[0].section);if(o){const g=s.E.buildingsManager.rewardSection(o);g&&(s.E.game.party.conclusions=s.E.game.party.conclusions.filter(m=>m.edition!=g.edition||m.group!=g.group||m.index!=g.index))}}s.E.stateManager.after()}this.change.emit()}}openStables(){this.dialog.open(tc,{panelClass:["dialog"]})}openGarden(){this.dialog.open(RF,{panelClass:["dialog"]})}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-buildings-list"]],inputs:{buildings:"buildings",short:"short",invert:"invert"},outputs:{change:"change"},standalone:!1,decls:16,vars:14,consts:[[1,"buildings",3,"ngClass"],[1,"building","head"],[1,"name"],[3,"ghs-label"],[1,"id"],[1,"level"],[1,"costs"],[1,"action"],[1,"building",3,"ngClass"],[1,"effects"],[1,"toggle",3,"click"],[3,"src"],[1,"interactions"],["ghs-pointer-input","",1,"name",3,"singleClick","doubleClick","ngClass"],["ghs-pointer-input","",1,"level",3,"singleClick","doubleClick","ghs-tooltip","originY"],[1,"costs",3,"ngClass"],["ghs-pointer-input","",1,"button","upgrade",3,"ngClass","ghs-tooltip","originX","originY","overlayX"],[1,"effect"],[1,"interaction"],[1,"interaction","stables"],[1,"interaction","garden"],[1,"icon",3,"ghs-tooltip","originY","overlayY"],["src","./assets/images/fh/buildings/normal.svg"],[1,"text",3,"ghs-label"],[1,"icon","unavailable",3,"ghs-tooltip","originY","overlayY"],["src","./assets/images/fh/buildings/interaction.svg"],[1,"icon",3,"click","ghs-tooltip"],["src","./assets/images/fh/catching.svg"],[1,"text",3,"click","ghs-label"],["src","./assets/images/fh/buildings/garden.png"],[1,"cost"],["src","./assets/images/fh/buildings/prosperity.svg"],["src","./assets/images/fh/loot/lumber.svg"],["src","./assets/images/fh/loot/metal.svg"],["src","./assets/images/fh/loot/hide.svg"],["src","./assets/images/fh/loot.svg"],[1,"repair"],[3,"ghs-label","ghs-label-args"],[1,"morale",3,"ghs-label"],["ghs-pointer-input","",1,"button","upgrade",3,"singleClick","doubleClick","ngClass","ghs-tooltip","originX","originY","overlayX"],["src","./assets/images/fh/buildings/repair.svg"],["src","./assets/images/fh/buildings/rebuild.svg"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"span",2),t.nrm(3,"span",3),t.k0s(),t.j41(4,"span",4),t.nrm(5,"span",3),t.k0s(),t.j41(6,"span",5),t.nrm(7,"span",3),t.k0s(),t.nVh(8,QF,8,4),t.j41(9,"span",6),t.nrm(10,"span",3),t.k0s(),t.j41(11,"span",7),t.nrm(12,"span",3),t.k0s()(),t.Z7z(13,vX,16,23,"div",8,JF),t.nI1(15,"trackUUID"),t.k0s()),2&i&&(t.Y8G("ngClass",t.ziG(9,KF,e.short,!e.short&&e.settingsManager.settings.buildingEffectsVisible,!e.short&&e.settingsManager.settings.buildingInteractionsVisible,e.invert)),t.R7$(3),t.Y8G("ghs-label","party.campaign.sheet.buildings.name"),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.buildings.id"),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.buildings.level"),t.R7$(),t.vxM(e.short?-1:8),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.buildings.costs"),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.buildings.action"),t.R7$(),t.Dyx(t.bMT(15,7,e.buildings)))},dependencies:[N.YU,it,Mt,dt,ct],styles:['.buildings[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%;overflow-y:auto;margin-top:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor))}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]{position:relative;display:grid;grid-template-columns:30% 5% 5% 10% 10% 20% 20%;align-items:center;margin:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) 0;transition:calc(var(--ghs-animation-speed) * .3s)}.buildings[_ngcontent-%COMP%]   .building.buildable[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 2);border-top:solid calc(var(--ghs-unit) * .1) var(--ghs-color-darkgray)}.buildings[_ngcontent-%COMP%]   .building.buildable[_ngcontent-%COMP%] ~ .buildable[_ngcontent-%COMP%]{margin-top:0;border-top:none}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]:nth-child(odd):before{content:" ";position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--ghs-color-gray);opacity:.35;z-index:0}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]:hover:before{content:" ";position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--ghs-color-yellow);opacity:.35;z-index:1}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{z-index:2}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;padding:0 .2em}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{width:0;height:1em;background-size:auto 90%;background-repeat:no-repeat;background-position:center center;display:none}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .state.normal[_ngcontent-%COMP%]{width:1em;background-image:url(damaged.4f5e0cf68a1b64dd.svg)}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .state.damaged[_ngcontent-%COMP%]{width:1em;background-image:url(wrecked.a5fd49fad8c36290.svg)}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]:hover{opacity:.7}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]:hover   .state[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .name.disabled[_ngcontent-%COMP%]{pointer-events:none}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover{opacity:.7}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .level.disabled[_ngcontent-%COMP%]{pointer-events:none}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;z-index:1}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;margin:.1em}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]:hover, .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]:hover{opacity:.7}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{display:none}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{position:relative;cursor:help;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin:0 calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor))}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor));width:auto}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .icon.unavailable[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .icon.unavailable[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .icon.unavailable[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .icon.unavailable[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:auto}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .icon.unavailable[_ngcontent-%COMP%]:after, .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .icon.unavailable[_ngcontent-%COMP%]:after, .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .icon.unavailable[_ngcontent-%COMP%]:after, .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .icon.unavailable[_ngcontent-%COMP%]:after{content:" ";position:absolute;inset:0;background-image:url(unavailable.e8616ca33492ef0a.png);background-size:100% 100%;background-position:center center;background-repeat:no-repeat}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect.stables[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect.stables[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect.garden[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect.garden[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .interaction.stables[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .interaction.stables[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .interaction.garden[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .interaction.garden[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .effect.stables[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .effect.stables[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .effect.garden[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .effect.garden[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction.stables[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction.stables[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction.garden[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction.garden[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{cursor:pointer}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]{display:grid;justify-content:end;grid-template-columns:repeat(5,calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor)))}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]   .cost[_ngcontent-%COMP%]{display:flex;align-items:center}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]   .cost[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:.9em;width:auto;margin:0 calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor))}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor));padding-left:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor));border-left:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) solid var(--ghs-color-darkgray)}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]   .repair[_ngcontent-%COMP%]{grid-column:span 5;display:flex;align-items:center;justify-content:center}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]   .repair[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor))}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .costs.disabled[_ngcontent-%COMP%]{opacity:.7;color:var(--ghs-color-darkgray)}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .costs.disabled[_ngcontent-%COMP%]   .cost[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .upgrade[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;margin-left:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .upgrade[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto;margin:0 calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .upgrade[_ngcontent-%COMP%]:hover{opacity:.7}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .upgrade.disabled[_ngcontent-%COMP%]{color:var(--ghs-color-gray)}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .upgrade.disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}.buildings[_ngcontent-%COMP%]   .building.head[_ngcontent-%COMP%]{border-bottom:solid calc(var(--ghs-unit) * .1) var(--ghs-color-darkgray)}.buildings[_ngcontent-%COMP%]   .building.head[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building.head[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building.head[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{pointer-events:none}.buildings[_ngcontent-%COMP%]   .building.head[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding-right:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor))}.buildings[_ngcontent-%COMP%]   .building.head[_ngcontent-%COMP%]:before{opacity:.1}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]{cursor:pointer;width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-red)}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]:hover{opacity:.5}.buildings.visible-effects[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]{grid-template-columns:20% 5% 5% 30% 10% 15% 15%;align-items:start}.buildings.visible-effects[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%], .buildings.visible-effects[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]{justify-content:flex-start;align-items:flex-start}.buildings.visible-effects[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{display:inline-block}.buildings.visible-effects[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor))}.buildings.visible-interactions[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]{grid-template-columns:20% 5% 5% 10% 30% 15% 15%;align-items:start}.buildings.visible-interactions[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%], .buildings.visible-interactions[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]{justify-content:flex-start;align-items:flex-start}.buildings.visible-interactions[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{display:inline-block}.buildings.visible-interactions[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor))}.buildings.visible-effects.visible-interactions[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]{grid-template-columns:20% 5% 5% 20% 20% 15% 15%}.buildings.short[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]{grid-template-columns:25% 10% 10% 45% 10%}.buildings.invert[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.buildings.invert[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%], .buildings.invert[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings.invert[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings.invert[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings.invert[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings.invert[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .upgrade[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings.invert[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]   .cost[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.buildings.invert[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .costs.disabled[_ngcontent-%COMP%]   .cost[_ngcontent-%COMP%]{color:var(--ghs-color-gray)}.buildings.invert[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .costs.disabled[_ngcontent-%COMP%]   .cost[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}']})}return a})();const OX=(a,r)=>({fh:a,modern:r}),PX=()=>[],bX=a=>({checked:a}),kX=a=>({success:a}),yX=(a,r,n)=>[a,r,n],xX=a=>({disabled:a}),ec=(a,r)=>r._trackUUID;function EX(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",8)(1,"input",26),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.manualAttackValue,e)||(o.manualAttackValue=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.applyBaracks())}),t.k0s(),t.j41(2,"input",26),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.manualTargetNumber,e)||(o.manualTargetNumber=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.applyBaracks())}),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(),t.R50("ngModel",n.manualAttackValue),t.R7$(),t.R50("ngModel",n.manualTargetNumber)}}function wX(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",28),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.toggleSoldier(e+1))}),t.nrm(1,"img",29)(2,"div",30),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(2),t.Y8G("ngClass",t.eq3(1,bX,i.soldiers>=n+1))}}function RX(a,r){if(1&a&&(t.Z7z(0,wX,3,3,"div",27,t.fX1),t.nI1(2,"ghsRange")),2&a){const n=t.XpG();t.Dyx(t.i5U(2,0,t.lJ4(3,PX),n.gameManager.game.party.soldiers))}}function jX(a,r){1&a&&(t.j41(0,"div",18),t.nrm(1,"img",31),t.k0s()),2&a&&t.Y8G("ghs-tooltip","party.outpostAttack.advantage")}function GX(a,r){1&a&&(t.j41(0,"div",18),t.nrm(1,"img",32),t.k0s()),2&a&&t.Y8G("ghs-tooltip","party.outpostAttack.disadvantage")}function TX(a,r){1&a&&t.nrm(0,"span",42),2&a&&t.Y8G("ghs-label","party.outpostAttack.result.wreck")}function SX(a,r){1&a&&t.nrm(0,"span",43),2&a&&t.Y8G("ghs-label","party.outpostAttack.result.successfull")}function DX(a,r){if(1&a&&t.nrm(0,"span",44),2&a){const n=t.XpG(3);t.Y8G("ngClass",t.eq3(3,kX,n.attackResult.result>=n.EntityValueFunction(n.attack.attackValue)))("ghs-label","party.outpostAttack.result."+(n.attackResult.result>=n.EntityValueFunction(n.attack.attackValue)?"success":"damage"))("ghs-label-args",t.sMw(5,yX,n.attackResult.result,(n.gameManager.game.party.defense||0)+n.moraleDefense,n.EntityValueFunction(n.attack.attackValue)))}}function $X(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",45)(1,"ghs-attackmodifier",46),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.toggleAttackResult())}),t.k0s(),t.nrm(2,"ghs-attackmodifier",47),t.k0s()}if(2&a){const n=t.XpG(3);t.R7$(),t.Y8G("attackModifier",n.townGuardDeck.cards[n.attackResult.index+n.attackResult.chooseOffset])("townGuard",!0)("flipped",!0),t.R7$(),t.Y8G("attackModifier",n.townGuardDeck.cards[n.attackResult.index])("townGuard",!0)("flipped",!0)}}function IX(a,r){if(1&a&&(t.j41(0,"div",35),t.nVh(1,TX,1,1,"span",42),t.nVh(2,SX,1,1,"span",43),t.nVh(3,DX,1,9,"span",44),t.nVh(4,$X,3,6,"div",45),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.vxM("wreck"==n.townGuardDeck.cards[n.attackResult.index].type?1:-1),t.R7$(),t.vxM("success"==n.townGuardDeck.cards[n.attackResult.index].type?2:-1),t.R7$(),t.vxM("wreck"!=n.townGuardDeck.cards[n.attackResult.index].type&&"success"!=n.townGuardDeck.cards[n.attackResult.index].type?3:-1),t.R7$(),t.vxM(n.attackResult.chooseOffset?4:-1)}}function AX(a,r){1&a&&t.nrm(0,"img",52)}function VX(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.SpI("(",n.data.id,")")}}function FX(a,r){1&a&&(t.j41(0,"span",57),t.nrm(1,"img",59),t.k0s()),2&a&&t.Y8G("ghs-tooltip","party.outpostAttack.buildings.damaged")}function XX(a,r){1&a&&(t.j41(0,"span",58),t.nrm(1,"img",60),t.k0s()),2&a&&t.Y8G("ghs-tooltip","party.outpostAttack.buildings.wrecked")}function BX(a,r){if(1&a&&(t.j41(0,"tr",39)(1,"td",48)(2,"a",49),t.nrm(3,"img",50),t.k0s()(),t.j41(4,"td",51)(5,"span"),t.nVh(6,AX,1,0,"img",52),t.k0s()(),t.j41(7,"td",53),t.nrm(8,"span",15),t.k0s(),t.j41(9,"td",54),t.nVh(10,VX,2,1,"span"),t.k0s(),t.j41(11,"td",55)(12,"span"),t.EFF(13),t.k0s()(),t.j41(14,"td",56),t.nVh(15,FX,2,1,"span",57),t.nVh(16,XX,2,1,"span",58),t.k0s()()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.Y8G("ngClass",t.eq3(7,xX,n.model.attacked||"number"==typeof e.attack.targetNumber&&i>=e.attacks+e.attack.targetNumber)),t.R7$(6),t.vxM(i==e.attacks&&e.attack.targetNumber?6:-1),t.R7$(2),t.Y8G("ghs-label","data.buildings."+n.model.name),t.R7$(2),t.vxM(n.data.id?10:-1),t.R7$(3),t.JRh(n.model.level||"-"),t.R7$(2),t.vxM("damaged"==n.model.state?15:-1),t.R7$(),t.vxM("wrecked"==n.model.state?16:-1)}}function YX(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.SpI("(",n.data.id,")")}}function UX(a,r){1&a&&(t.j41(0,"span",61),t.nrm(1,"img",59),t.k0s()),2&a&&t.Y8G("ghs-tooltip","party.outpostAttack.buildings.damaged")}function NX(a,r){1&a&&(t.j41(0,"span",61),t.nrm(1,"img",60),t.k0s()),2&a&&t.Y8G("ghs-tooltip","party.outpostAttack.buildings.wrecked")}function zX(a,r){if(1&a&&(t.j41(0,"tr",41)(1,"td",48)(2,"a",49),t.nrm(3,"img",50),t.k0s()(),t.nrm(4,"td",51),t.j41(5,"td",53),t.nrm(6,"span",15),t.k0s(),t.j41(7,"td",54),t.nVh(8,YX,2,1,"span"),t.k0s(),t.j41(9,"td",55),t.EFF(10),t.k0s(),t.j41(11,"td",56),t.nVh(12,UX,2,1,"span",61),t.nVh(13,NX,2,1,"span",61),t.k0s()()),2&a){const n=r.$implicit;t.R7$(6),t.Y8G("ghs-label","data.buildings."+n.model.name),t.R7$(2),t.vxM(n.data.id?8:-1),t.R7$(2),t.JRh(n.model.level||"-"),t.R7$(2),t.vxM("damaged"==n.model.state?12:-1),t.R7$(),t.vxM("wrecked"==n.model.state?13:-1)}}function LX(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",33),t.nrm(1,"span",15),t.j41(2,"span",34),t.EFF(3),t.k0s()(),t.nVh(4,IX,5,4,"div",35),t.j41(5,"div",36)(6,"table",37,0),t.bIt("cdkDropListDropped",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.dropBuildings(e))}),t.j41(8,"thead")(9,"tr"),t.nrm(10,"th",38),t.k0s()(),t.j41(11,"tbody"),t.Z7z(12,BX,17,9,"tr",39,ec),t.nI1(14,"trackUUID"),t.k0s()(),t.j41(15,"table",40,1),t.bIt("cdkDropListDropped",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.dropDisabledBuildings(e))}),t.j41(17,"thead")(18,"tr"),t.nrm(19,"th",38),t.k0s()(),t.j41(20,"tbody"),t.Z7z(21,zX,14,5,"tr",41,ec),t.nI1(23,"trackUUID"),t.k0s()()()}if(2&a){const n=t.sdS(7),i=t.sdS(16),e=t.XpG();t.R7$(),t.Y8G("ghs-label","party.outpostAttack.defense"),t.R7$(2),t.JRh((e.gameManager.game.party.defense||0)+e.moraleDefense),t.R7$(),t.vxM(e.attackResult?4:-1),t.R7$(2),t.Y8G("cdkDropListConnectedTo",i),t.R7$(4),t.Y8G("ghs-label","party.outpostAttack.targets"),t.R7$(2),t.Dyx(t.bMT(14,7,e.buildings)),t.R7$(3),t.Y8G("cdkDropListConnectedTo",n),t.R7$(4),t.Y8G("ghs-label","party.outpostAttack.other"),t.R7$(2),t.Dyx(t.bMT(23,9,e.disabledBuildings))}}function qX(a,r){if(1&a&&t.nrm(0,"ghs-buildings-list",22),2&a){const n=t.XpG();t.Y8G("buildings",n.allBuildings)("short",!0)("invert",!0)}}function HX(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",62),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.nextTarget())}),t.k0s()}2&a&&t.Y8G("ghs-label","party.outpostAttack.next")}function KX(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",63),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.close(!0))}),t.k0s()}2&a&&t.Y8G("ghs-label","party.outpostAttack.finish")}let WX=(()=>{class a{data;dialogRef;dialog;ghsManager;settingsManager=p.f;gameManager=s.E;EntityValueFunction=A.hZ;attack;defaultAttack;manualAttackValue=50;manualTargetNumber=4;townGuardDeck=new w.J;allBuildings=[];buildings=[];disabledBuildings=[];parity=0;factor=!1;lowerBoundary=0;upperBoundary=0;desc=!1;barracks=!1;soldiers=0;baracksBonus=0;moraleDefense=0;attacks=0;attackResult;deckActive=!1;constructor(n,i,e,o){if(this.data=n,this.dialogRef=i,this.dialog=e,this.ghsManager=o,this.data.attack&&(this.defaultAttack=new bt.TH(n.attack.attackValue,n.attack.targetNumber,n.attack.targetDescription,n.attack.narrative,n.attack.effects)),this.defaultAttack&&n.effects){let g=0,m=0;n.effects.forEach(k=>{k.type==bt.Yj.outpostAttack&&k.values.length&&"object"!=typeof k.values[0]?g=(0,A.hZ)(k.values[0]):k.type==bt.Yj.outpostTarget&&k.values.length&&"object"!=typeof k.values[0]&&(m=(0,A.hZ)(k.values[0]))}),g&&(this.defaultAttack.attackValue="number"==typeof this.defaultAttack.attackValue?this.defaultAttack.attackValue+g:this.defaultAttack.attackValue+" "+(0,F.n1)(g)),m&&(this.defaultAttack.targetNumber="number"==typeof this.defaultAttack.targetNumber?this.defaultAttack.targetNumber+m:this.defaultAttack.targetNumber+" "+(0,F.n1)(m))}this.attack=this.defaultAttack||new bt.TH(this.manualAttackValue,this.manualTargetNumber,"","",[]),this.deckActive=!!s.E.game.party.townGuardDeck&&s.E.game.party.townGuardDeck.active}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.update()}),this.update(!0)}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe(),s.E.game.party.townGuardDeck&&(s.E.game.party.townGuardDeck.active=this.deckActive)}update(n=!1){this.allBuildings=[];const i=s.E.campaignData();i&&(s.E.game.party.buildings.forEach(e=>{const o=i.buildings.find(g=>g.name==e.name);o&&e.level&&o.id&&!isNaN(+o.id)&&(n&&(e.attacked=void 0),this.allBuildings.push({model:e,data:o}))}),i.townGuardPerks?(this.townGuardDeck=s.E.attackModifierManager.buildTownGuardAttackModifierDeck(s.E.game.party,i),s.E.game.party.townGuardDeck?s.E.attackModifierManager.fromModel(this.townGuardDeck,s.E.game.party.townGuardDeck):(s.E.attackModifierManager.shuffleModifiers(this.townGuardDeck),s.E.game.party.townGuardDeck=this.townGuardDeck.toModel()),this.townGuardDeck.active=!0):(console.warn("Invalid state, no Town Guard Deck found!"),this.dialogRef.close())),this.moraleDefense=s.E.game.party.morale<3?-10:s.E.game.party.morale<5?-5:s.E.game.party.morale<8?0:s.E.game.party.morale<11?5:s.E.game.party.morale<14?10:15,this.applyBaracks(),n&&this.applyFilter()}beforeTownGuardDeck(n){this.attackResult=void 0,s.E.stateManager.before("updateAttackModifierDeck."+n.type,"party.campaign.townGuard",...n.values)}afterTownGuardDeck(n){this.townGuardDeck=n.deck,s.E.game.party.townGuardDeck=this.townGuardDeck.toModel(),s.E.stateManager.after(),this.attackResult=s.E.attackModifierManager.calculateAttackResult(this.townGuardDeck,(s.E.game.party.defense||0)+this.moraleDefense)}toggleAttackResult(){this.attackResult&&this.attackResult.chooseOffset&&(this.attackResult=s.E.attackModifierManager.calculateAttackResult(this.townGuardDeck,(s.E.game.party.defense||0)+this.moraleDefense,this.attackResult.index+this.attackResult.chooseOffset))}nextTarget(){if(this.attacks<this.buildings.length&&this.attack.targetNumber){const n=this.buildings[this.attacks];let i=n.model.state;this.attackResult&&("wreck"==this.townGuardDeck.cards[this.attackResult.index].type?i="wrecked":"success"!=this.townGuardDeck.cards[this.attackResult.index].type&&this.attackResult.result<(0,A.hZ)(this.attack.attackValue)&&(i="damaged")),s.E.stateManager.before("buildingAttacked"+(i!=n.model.state?"."+i:""),n.data.id,n.data.name),s.E.game.party.soldiers-=this.soldiers,this.soldiers=0,n.model.attacked=!0,this.attacks++,n.model.state=i,this.attackResult=void 0,this.applyBaracks(),s.E.stateManager.after()}}toggleSoldier(n){this.soldiers==n?this.soldiers--:this.soldiers=n,this.applyBaracks()}applyBaracks(){const n=this.allBuildings.find(i=>"barracks"==i.model.name);if(n){if("wrecked"==n.model.state)this.barracks=!1,this.baracksBonus=0,this.soldiers=0,this.factor="disadvantage";else{switch(this.barracks=!0,this.factor=!1,n.model.level){case 1:this.baracksBonus=-5;break;case 2:this.baracksBonus=-15;break;case 3:this.baracksBonus=-25;break;case 4:this.baracksBonus=-35}this.soldiers&&(this.factor="advantage")}this.attack=new bt.TH((0,A.hZ)(this.defaultAttack?this.defaultAttack.attackValue:this.manualAttackValue)+this.soldiers*this.baracksBonus,(0,A.hZ)(this.defaultAttack?this.defaultAttack.targetNumber:this.manualTargetNumber)-this.attacks,this.defaultAttack?this.defaultAttack.targetDescription:"",this.defaultAttack?this.defaultAttack.narrative:"",this.defaultAttack?this.defaultAttack.effects:[])}else console.warn("No Barrack found!")}applyFilter(){this.buildings=this.allBuildings.filter(n=>{if(!n.data.id||isNaN(+n.data.id)||"wrecked"==n.model.state)return!1;const i=+n.data.id;return!(this.parity&&("even"==this.parity&&i%2==1||"odd"==this.parity&&i%2==0)||+this.lowerBoundary&&i<this.lowerBoundary||+this.upperBoundary&&i>this.upperBoundary)}).sort((n,i)=>+n.data.id-+i.data.id),this.desc&&this.buildings.reverse(),this.disabledBuildings=this.allBuildings.filter(n=>!this.buildings.includes(n))}randomize(){(0,F.Z)(this.buildings)}dropBuildings(n){if(n.container==n.previousContainer)(0,V.HD)(this.buildings,n.previousIndex,n.currentIndex);else{const i=this.disabledBuildings.splice(n.previousIndex,1)[0];this.buildings.splice(n.currentIndex,0,i)}}dropDisabledBuildings(n){if(n.container==n.previousContainer)(0,V.HD)(this.disabledBuildings,n.previousIndex,n.currentIndex);else{const i=this.buildings.splice(n.previousIndex,1)[0];this.disabledBuildings.splice(n.currentIndex,0,i)}}partySheet(){this.dialog.open(Hn,{panelClass:["dialog-invert"],data:s.E.currentEdition()})}worldMap(){this.dialog.open(aa,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:s.E.currentEdition()})}close(n=!1){(0,F.co)(this.dialogRef,n)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-outpost-attack"]],standalone:!1,decls:70,vars:59,consts:[["buildingsList","cdkDropList"],["disabledBuildingsList","cdkDropList"],[1,"outpost-attack-dialog",3,"ngClass"],[1,"header"],["src","./assets/images/sheet.svg",1,"party-sheet",3,"click","ghs-tooltip"],["src","./assets/images/map.svg",1,"world-map",3,"click","ghs-tooltip"],[1,"attack"],[3,"attack","selected","narrative","effects","disabled","light"],[1,"manual-attack"],[1,"filter"],[3,"ngModelChange","change","ngModel","ghs-tooltip"],[3,"value","ghs-label"],[3,"value"],[3,"ngModelChange","change","ngModel"],["type","checkbox",3,"ngModelChange","change","ngModel"],[3,"ghs-label"],[3,"click"],[1,"baracks-bonus"],[1,"factor",3,"ghs-tooltip"],[1,"town-guard-deck-container"],[1,"town-guard-deck"],[3,"before","after","deck","townGuard"],[3,"buildings","short","invert"],[1,"menu"],[1,"cancel",3,"click","ghs-label"],[1,"finish",3,"ghs-label"],["type","number","min","0",3,"ngModelChange","change","ngModel"],[1,"soldier"],[1,"soldier",3,"click"],["src","./assets/images/fh/party/soldier.svg"],[1,"check",3,"ngClass"],["src","./assets/images/fh/condition/strengthen.svg"],["src","./assets/images/fh/condition/muddle.svg"],[1,"defense"],[1,"value"],[1,"attack-result"],[1,"buildings"],["cdkDropList","",3,"cdkDropListDropped","cdkDropListConnectedTo"],["colspan","6",3,"ghs-label"],["cdkDrag","",3,"ngClass"],["cdkDropList","",1,"other",3,"cdkDropListDropped","cdkDropListConnectedTo"],["cdkDrag",""],[1,"result","wreck",3,"ghs-label"],[1,"result","successfull",3,"ghs-label"],[1,"result",3,"ngClass","ghs-label","ghs-label-args"],[1,"choose"],[3,"click","attackModifier","townGuard","flipped"],[3,"attackModifier","townGuard","flipped"],["cdkDragHandle","",1,"drag-handle"],[1,"button"],["src","./assets/images/menu.svg",1,"ghs-svg"],[1,"target"],["src","./assets/images/attackmodifier/target.svg",1,"ghs-svg"],[1,"name"],[1,"id"],[1,"level"],[1,"state"],[1,"damaged",3,"ghs-tooltip"],[1,"wrecked",3,"ghs-tooltip"],["src","./assets/images/fh/buildings/damaged.svg",1,"ghs-svg"],["src","./assets/images/fh/buildings/wrecked.svg",1,"ghs-svg"],[3,"ghs-tooltip"],[3,"click","ghs-label"],[1,"finish",3,"click","ghs-label"]],template:function(i,e){1&i&&(t.j41(0,"div",2)(1,"div",3)(2,"img",4),t.bIt("click",function(){return e.partySheet()}),t.k0s(),t.j41(3,"img",5),t.bIt("click",function(){return e.worldMap()}),t.k0s()(),t.j41(4,"div",6),t.nrm(5,"ghs-event-card-attack",7),t.k0s(),t.nVh(6,EX,3,2,"div",8),t.j41(7,"div",9)(8,"select",10),t.mxI("ngModelChange",function(g){return t.DH7(e.lowerBoundary,g)||(e.lowerBoundary=g),g}),t.bIt("change",function(){return e.applyFilter()}),t.nrm(9,"option",11),t.j41(10,"option",12),t.EFF(11,"10"),t.k0s(),t.j41(12,"option",12),t.EFF(13,"20"),t.k0s(),t.j41(14,"option",12),t.EFF(15,"30"),t.k0s(),t.j41(16,"option",12),t.EFF(17,"40"),t.k0s(),t.j41(18,"option",12),t.EFF(19,"50"),t.k0s(),t.j41(20,"option",12),t.EFF(21,"60"),t.k0s(),t.j41(22,"option",12),t.EFF(23,"70"),t.k0s(),t.j41(24,"option",12),t.EFF(25,"80"),t.k0s(),t.j41(26,"option",12),t.EFF(27,"90"),t.k0s()(),t.j41(28,"select",10),t.mxI("ngModelChange",function(g){return t.DH7(e.upperBoundary,g)||(e.upperBoundary=g),g}),t.bIt("change",function(){return e.applyFilter()}),t.nrm(29,"option",11),t.j41(30,"option",12),t.EFF(31,"10"),t.k0s(),t.j41(32,"option",12),t.EFF(33,"20"),t.k0s(),t.j41(34,"option",12),t.EFF(35,"30"),t.k0s(),t.j41(36,"option",12),t.EFF(37,"40"),t.k0s(),t.j41(38,"option",12),t.EFF(39,"50"),t.k0s(),t.j41(40,"option",12),t.EFF(41,"60"),t.k0s(),t.j41(42,"option",12),t.EFF(43,"70"),t.k0s(),t.j41(44,"option",12),t.EFF(45,"80"),t.k0s(),t.j41(46,"option",12),t.EFF(47,"90"),t.k0s()(),t.j41(48,"select",13),t.mxI("ngModelChange",function(g){return t.DH7(e.parity,g)||(e.parity=g),g}),t.bIt("change",function(){return e.applyFilter()}),t.nrm(49,"option",11)(50,"option",11)(51,"option",11),t.k0s(),t.j41(52,"label")(53,"input",14),t.mxI("ngModelChange",function(g){return t.DH7(e.desc,g)||(e.desc=g),g}),t.bIt("change",function(){return e.applyFilter()}),t.k0s(),t.nrm(54,"span",15),t.k0s(),t.j41(55,"a",16),t.bIt("click",function(){return e.randomize()}),t.nrm(56,"span",15),t.k0s()(),t.j41(57,"div",17),t.nVh(58,RX,3,4),t.nVh(59,jX,2,1,"div",18),t.nVh(60,GX,2,1,"div",18),t.k0s(),t.j41(61,"div",19)(62,"div",20)(63,"ghs-attackmodifier-deck",21),t.bIt("before",function(g){return e.beforeTownGuardDeck(g)})("after",function(g){return e.afterTownGuardDeck(g)}),t.k0s()()(),t.nVh(64,LX,24,11),t.nVh(65,qX,1,3,"ghs-buildings-list",22),t.j41(66,"div",23)(67,"a",24),t.bIt("click",function(){return e.close()}),t.k0s(),t.nVh(68,HX,1,1,"a",15),t.nVh(69,KX,1,1,"a",25),t.k0s()()),2&i&&(t.Y8G("ngClass",t.l_i(56,OX,"fh"==e.settingsManager.settings.theme,"modern"==e.settingsManager.settings.theme)),t.R7$(2),t.Y8G("ghs-tooltip","party.outpostAttack.sheet"),t.R7$(),t.Y8G("ghs-tooltip","party.outpostAttack.map"),t.R7$(2),t.Y8G("attack",e.attack)("selected",!0)("narrative",!1)("effects",!1)("disabled",!0)("light",!0),t.R7$(),t.vxM(e.defaultAttack?-1:6),t.R7$(2),t.R50("ngModel",e.lowerBoundary),t.Y8G("ghs-tooltip","party.outpostAttack.filter.lowerBoundary"),t.R7$(),t.Y8G("value",0)("ghs-label","party.outpostAttack.filter.lowerBoundary"),t.R7$(),t.Y8G("value",10),t.R7$(2),t.Y8G("value",20),t.R7$(2),t.Y8G("value",30),t.R7$(2),t.Y8G("value",40),t.R7$(2),t.Y8G("value",50),t.R7$(2),t.Y8G("value",60),t.R7$(2),t.Y8G("value",70),t.R7$(2),t.Y8G("value",80),t.R7$(2),t.Y8G("value",90),t.R7$(2),t.R50("ngModel",e.upperBoundary),t.Y8G("ghs-tooltip","party.outpostAttack.filter.upperBoundary"),t.R7$(),t.Y8G("value",0)("ghs-label","party.outpostAttack.filter.upperBoundary"),t.R7$(),t.Y8G("value",10),t.R7$(2),t.Y8G("value",20),t.R7$(2),t.Y8G("value",30),t.R7$(2),t.Y8G("value",40),t.R7$(2),t.Y8G("value",50),t.R7$(2),t.Y8G("value",60),t.R7$(2),t.Y8G("value",70),t.R7$(2),t.Y8G("value",80),t.R7$(2),t.Y8G("value",90),t.R7$(2),t.R50("ngModel",e.parity),t.R7$(),t.Y8G("value",0)("ghs-label","party.outpostAttack.filter.parity"),t.R7$(),t.Y8G("value","even")("ghs-label","party.outpostAttack.filter.even"),t.R7$(),t.Y8G("value","odd")("ghs-label","party.outpostAttack.filter.odd"),t.R7$(2),t.R50("ngModel",e.desc),t.R7$(),t.Y8G("ghs-label","party.outpostAttack.filter.desc"),t.R7$(2),t.Y8G("ghs-label","party.outpostAttack.filter.randomize"),t.R7$(2),t.vxM(e.barracks?58:-1),t.R7$(),t.vxM("advantage"==e.factor?59:-1),t.R7$(),t.vxM("disadvantage"==e.factor?60:-1),t.R7$(3),t.Y8G("deck",e.townGuardDeck)("townGuard",!0),t.R7$(),t.vxM(e.EntityValueFunction(e.attack.targetNumber)>0&&e.attacks<e.buildings.length?64:-1),t.R7$(),t.vxM(0==e.attack.targetNumber||e.attacks>=e.buildings.length?65:-1),t.R7$(2),t.Y8G("ghs-label","cancel"),t.R7$(),t.vxM(+e.attack.targetNumber>0&&e.attacks<e.buildings.length?68:-1),t.R7$(),t.vxM(0==e.attack.targetNumber||e.attacks>=e.buildings.length?69:-1))},dependencies:[N.YU,E.xH,E.y7,E.me,E.Q0,E.Zm,E.wz,E.BC,E.VZ,E.vS,V.O7,V.T1,V.Fb,We,ye,nc,Ji,it,Mt,At,ct],styles:['.outpost-attack-dialog[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.outpost-attack-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%;margin-bottom:calc(var(--ghs-unit) * -5.5 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{cursor:pointer;width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));filter:var(--ghs-filter-white)}.outpost-attack-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{opacity:.6}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack[_ngcontent-%COMP%]   ghs-event-card-attack[_ngcontent-%COMP%]{display:block;width:calc(var(--ghs-unit) * 35 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .manual-attack[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.outpost-attack-dialog[_ngcontent-%COMP%]   .manual-attack[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor)) 0}.outpost-attack-dialog[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .outpost-attack-dialog[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .outpost-attack-dialog[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .outpost-attack-dialog[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.outpost-attack-dialog[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-family:var(--ghs-font-title);color:var(--ghs-color-white)}.outpost-attack-dialog[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.outpost-attack-dialog[_ngcontent-%COMP%]   .baracks-bonus[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.outpost-attack-dialog[_ngcontent-%COMP%]   .baracks-bonus[_ngcontent-%COMP%]   .soldier[_ngcontent-%COMP%]{position:relative}.outpost-attack-dialog[_ngcontent-%COMP%]   .baracks-bonus[_ngcontent-%COMP%]   .soldier[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3.6 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-white)}.outpost-attack-dialog[_ngcontent-%COMP%]   .baracks-bonus[_ngcontent-%COMP%]   .soldier[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{cursor:pointer;position:relative;width:calc(var(--ghs-unit) * 3.6 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3.6 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) dashed var(--ghs-color-white);border-radius:100%}.outpost-attack-dialog[_ngcontent-%COMP%]   .baracks-bonus[_ngcontent-%COMP%]   .soldier[_ngcontent-%COMP%]   .check.checked[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:10%;left:10%;width:80%;height:80%;background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;z-index:1;filter:var(--ghs-filter-red)}.outpost-attack-dialog[_ngcontent-%COMP%]   .baracks-bonus[_ngcontent-%COMP%]   .factor[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .baracks-bonus[_ngcontent-%COMP%]   .factor[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:auto}.outpost-attack-dialog[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:1.5em;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));font-size:1.5em}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack-result[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack-result[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]{font-size:1.5em;text-align:center;color:var(--ghs-color-black);filter:var(--ghs-filter-red)}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack-result[_ngcontent-%COMP%]   .result.wreck[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack-result[_ngcontent-%COMP%]   .result.success[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack-result[_ngcontent-%COMP%]   .result.successfull[_ngcontent-%COMP%]{filter:var(--ghs-filter-blue)}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack-result[_ngcontent-%COMP%]   .choose[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:row-reverse}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack-result[_ngcontent-%COMP%]   .choose[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%]{display:block;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 12 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));transition:transform calc(var(--ghs-animation-speed) * .15s) cubic-bezier(.75,0,.85,1);transform-origin:center center}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack-result[_ngcontent-%COMP%]   .choose[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%]:first-child{width:calc(var(--ghs-unit) * 9 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));opacity:.5;cursor:pointer}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack-result[_ngcontent-%COMP%]   .choose[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%]:first-child:hover{transform:scale(1.3333);opacity:1}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack-result[_ngcontent-%COMP%]   .choose[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%]:first-child:hover + ghs-attackmodifier[_ngcontent-%COMP%]{transform:scale(.75);opacity:.5}.outpost-attack-dialog[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]{display:flex;justify-content:center;min-width:calc(var(--ghs-unit) * 55 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 20 * var(--ghs-dialog-factor));overflow-x:auto;overflow-y:visible}.outpost-attack-dialog[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]   .town-guard-deck[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 37.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 10 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:flex-start;font-size:1.5em}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   table.other[_ngcontent-%COMP%]{opacity:.6}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{opacity:.5}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   td.name[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{justify-content:flex-start}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:grab;width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:100%;height:auto;filter:var(--ghs-filter-white)}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   .target[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:auto}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;align-items:center}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));width:auto;filter:var(--ghs-filter-white)}.outpost-attack-dialog[_ngcontent-%COMP%]   ghs-buildings-list[_ngcontent-%COMP%]{display:block;min-width:calc(var(--ghs-unit) * 55 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor)) 0;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly;align-items:center}.outpost-attack-dialog[_ngcontent-%COMP%]   .menu.small[_ngcontent-%COMP%]{justify-content:center;margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor)) 0;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.7 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .menu.small[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{min-width:auto}.outpost-attack-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;display:flex;flex-grow:1;justify-content:center;margin:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.outpost-attack-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.outpost-attack-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.finish[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.outpost-attack-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.outpost-attack-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-darkgray)}.cdk-drag-preview[_ngcontent-%COMP%]{opacity:0;cursor:grabbing;z-index:999}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.5;cursor:grabbing}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}']})}return a})();const ZX=(a,r)=>({fh:a,modern:r});let JX=(()=>{class a{data;dialogRef;dialog;settingsManager=p.f;gameManager=s.E;item;blueprint=!1;constructor(n,i,e){this.data=n,this.dialogRef=i,this.dialog=e,this.item=n.item,this.blueprint=n.blueprint}close(){(0,F.co)(this.dialogRef)}openDialog(){this.dialog.open(fn,{panelClass:["fullscreen-panel"],disableClose:!0,data:{item:this.item}})}apply(){(0,F.co)(this.dialogRef,this.item)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-event-random-item-dialog"]],standalone:!1,decls:10,vars:10,consts:[[1,"random-item-dialog",3,"ngClass"],[1,"scroll-container"],[1,"title",3,"ghs-label"],[1,"item"],[3,"click","item","flipped","editionLabel"],[1,"menu"],[1,"cancel",3,"click"],[3,"ghs-label"],[1,"apply",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"span",2),t.j41(3,"div",3)(4,"ghs-item",4),t.bIt("click",function(){return e.openDialog()}),t.k0s()(),t.j41(5,"div",5)(6,"a",6),t.bIt("click",function(){return e.close()}),t.nrm(7,"span",7),t.k0s(),t.j41(8,"a",8),t.bIt("click",function(){return e.apply()}),t.nrm(9,"span",7),t.k0s()()()()),2&i&&(t.Y8G("ngClass",t.l_i(7,ZX,"fh"==e.settingsManager.settings.theme,"modern"==e.settingsManager.settings.theme)),t.R7$(2),t.Y8G("ghs-label","scenario.eventEffects.drawRandomItem"+(e.blueprint?".blueprint":"")),t.R7$(2),t.Y8G("item",e.item)("flipped",!0)("editionLabel",e.gameManager.currentEdition()),t.R7$(3),t.Y8G("ghs-label","cancel"),t.R7$(2),t.Y8G("ghs-label","scenario.eventEffects.drawRandomItem.apply"))},dependencies:[N.YU,it,Vn],styles:[".random-item-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;justify-content:center;font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline);margin-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.random-item-dialog.fh[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.random-item-dialog.modern[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.random-item-dialog[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:100%}.random-item-dialog[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ghs-item[_ngcontent-%COMP%]{display:block;width:calc(var(--ghs-unit) * 27 * var(--ghs-dialog-factor));height:auto}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:2em;padding:.3em}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}"]})}return a})();const QX=(a,r)=>({fh:a,modern:r}),tB=(a,r,n)=>[a,r,n];let nB=(()=>{class a{data;dialogRef;settingsManager=p.f;gameManager=s.E;scenario;section=!1;unlocks="";constructor(n,i){this.data=n,this.dialogRef=i,this.scenario=n.scenario,this.section=n.section,this.section&&(this.unlocks=this.scenario.unlocks?this.scenario.unlocks.map(e=>"%data.scenarioNumber:"+e+"%").join(", "):"")}close(){(0,F.co)(this.dialogRef)}apply(){(0,F.co)(this.dialogRef,this.scenario)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-event-random-scenario-dialog"]],standalone:!1,decls:10,vars:13,consts:[[1,"random-scenario-dialog",3,"ngClass"],[1,"scroll-container"],[1,"title",3,"ghs-label"],[1,"scenario"],[1,"text-white",3,"ghs-label","ghs-label-args"],[1,"menu"],[1,"cancel",3,"click"],[3,"ghs-label"],[1,"apply",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"span",2),t.j41(3,"div",3),t.nrm(4,"span",4),t.k0s(),t.j41(5,"div",5)(6,"a",6),t.bIt("click",function(){return e.close()}),t.nrm(7,"span",7),t.k0s(),t.j41(8,"a",8),t.bIt("click",function(){return e.apply()}),t.nrm(9,"span",7),t.k0s()()()()),2&i&&(t.Y8G("ngClass",t.l_i(6,QX,"fh"==e.settingsManager.settings.theme,"modern"==e.settingsManager.settings.theme)),t.R7$(2),t.Y8G("ghs-label","scenario.eventEffects.drawRandomScenario"),t.R7$(2),t.Y8G("ghs-label","scenario.eventEffects.drawRandomScenario."+(e.section?"section":"scenario"))("ghs-label-args",t.sMw(9,tB,e.scenario.index,e.gameManager.scenarioManager.scenarioTitle(e.scenario,e.section),e.unlocks)),t.R7$(3),t.Y8G("ghs-label","cancel"),t.R7$(2),t.Y8G("ghs-label","scenario.eventEffects.drawRandomScenario.apply"))},dependencies:[N.YU,it],styles:[".random-scenario-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;justify-content:center;font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline);margin-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.random-scenario-dialog.fh[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.random-scenario-dialog.modern[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.random-scenario-dialog[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:100%;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.random-scenario-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center}.random-scenario-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:2em;padding:.3em}.random-scenario-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.random-scenario-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.random-scenario-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.random-scenario-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}.random-scenario-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}"]})}return a})();const ac=a=>({denied:a}),eB=a=>({inactive:a}),aB=(a,r)=>({inactive:a,thumbnail:r}),iB=a=>({fh:a}),ic=a=>({checked:a}),Pn=(a,r)=>({"negative-value":a,"positive-value":r}),oB=a=>({gold:a}),sB=a=>[a],ce=a=>({disabled:a}),mo=(a,r)=>r._trackUUID,oc=(a,r)=>("object"==typeof r?r.type:r)+a;function rB(a,r){1&a&&(t.j41(0,"div",5),t.nrm(1,"span",4),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","scenario.eventEffects.hint"))}function cB(a,r){1&a&&t.nrm(0,"img",17)}function lB(a,r){if(1&a&&t.nrm(0,"img",21),2&a){const n=t.XpG().$implicit;t.Y8G("src",t.VkB("./assets/images/summons/",n.color,".png"),t.B4B)}}function gB(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function dB(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.JRh(n.number)}}function hB(a,r){if(1&a&&t.nrm(0,"div",24),2&a){const n=t.XpG().$implicit;t.xc7("background-image",n.thumbnailUrl?"url("+n.thumbnailUrl+")":"url(./assets/images/summons/thumbnail/"+n.thumbnail+".png)")}}function _B(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",19),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.toggleSummon(e))}),t.j41(1,"span",20),t.nVh(2,lB,1,2,"img",21),t.j41(3,"span",22),t.nVh(4,gB,2,0,"span"),t.nVh(5,dB,2,1,"span"),t.k0s()(),t.nVh(6,hB,1,2,"div",23),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(3);t.Y8G("ngClass",t.l_i(6,aB,!i.activeSummons.includes(n),i.settingsManager.settings.artwork&&(n.thumbnail&&!n.noThumbnail||n.thumbnailUrl))),t.R7$(),t.Y8G("ngClass",t.eq3(9,iB,n.color==i.SummonColor.fh)),t.R7$(),t.vxM(n.color!=i.SummonColor.fh?2:-1),t.R7$(2),t.vxM(0==n.number?4:-1),t.R7$(),t.vxM(n.number>0?5:-1),t.R7$(),t.vxM(i.settingsManager.settings.artwork&&(n.thumbnail&&!n.noThumbnail||n.thumbnailUrl)?6:-1)}}function mB(a,r){if(1&a&&(t.Z7z(0,_B,7,11,"a",18,mo),t.nI1(2,"trackUUID")),2&a){const n=t.XpG().$implicit;t.Dyx(t.bMT(2,0,n.summons))}}function pB(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",7)(1,"a",15),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.toggleCharacter(e))})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.openCharacterSheet(e))}),t.nrm(2,"img",16),t.nVh(3,cB,1,0,"img",17),t.k0s(),t.nVh(4,mB,3,2),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(4,eB,!i.activeCharacters.includes(n))),t.R7$(),t.Y8G("src",n.iconUrl,t.B4B),t.R7$(),t.vxM(n.absent?3:-1),t.R7$(),t.vxM(i.gameManager.roundManager.firstRound?-1:4)}}function uB(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",25),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openFavors())}),t.nrm(1,"span",4),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","scenario.favors"))}function fB(a,r){if(1&a){const n=t.RV6();t.j41(0,"label",28),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.toggleImbuement())}),t.nrm(1,"span",29)(2,"span",4),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(2,ic,1==n.gameManager.imbuementManager.imbuement)),t.R7$(),t.Y8G("ghs-label","scenario.gh2eImbuement.imbuement")}}function CB(a,r){if(1&a){const n=t.RV6();t.j41(0,"label",28),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.toggleImbuement(!0))}),t.nrm(1,"span",29)(2,"span",4),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(2,ic,"advanced"==n.gameManager.imbuementManager.imbuement)),t.R7$(),t.Y8G("ghs-label","scenario.gh2eImbuement.advancedImbuement")}}function MB(a,r){if(1&a&&(t.j41(0,"div",9),t.nrm(1,"span",26),t.j41(2,"div",27),t.nVh(3,fB,3,4,"label"),t.nVh(4,CB,3,4,"label"),t.k0s()()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","scenario.gh2eImbuement"),t.R7$(2),t.vxM("advanced"!=n.gameManager.imbuementManager.imbuement?3:-1),t.R7$(),t.vxM("advanced"==n.gameManager.imbuementManager.available&&1!=n.gameManager.imbuementManager.imbuement?4:-1)}}function vB(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",11)(1,"span",30)(2,"ghs-pointer-input",31),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeHealth(-1))}),t.nrm(3,"img",32),t.k0s()(),t.j41(4,"span",33),t.nrm(5,"img",34),t.j41(6,"span",35),t.EFF(7),t.nI1(8,"ghsValueSign"),t.k0s()(),t.j41(9,"span",30)(10,"ghs-pointer-input",31),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeHealth(1))}),t.nrm(11,"img",36),t.k0s()(),t.j41(12,"span",30)(13,"ghs-pointer-input",31),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeBless(-1))}),t.nrm(14,"img",32),t.k0s()(),t.j41(15,"span",37),t.nrm(16,"img",38),t.j41(17,"span",35),t.EFF(18),t.nI1(19,"ghsValueSign"),t.k0s()(),t.j41(20,"span",30)(21,"ghs-pointer-input",31),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeBless(1))}),t.nrm(22,"img",36),t.k0s()(),t.j41(23,"span",30)(24,"ghs-pointer-input",31),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeCurse(-1))}),t.nrm(25,"img",32),t.k0s()(),t.j41(26,"span",37),t.nrm(27,"img",39),t.j41(28,"span",35),t.EFF(29),t.nI1(30,"ghsValueSign"),t.k0s()(),t.j41(31,"span",30)(32,"ghs-pointer-input",31),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeCurse(1))}),t.nrm(33,"img",36),t.k0s()()()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-label","game.health")("ghs-label-attribute","title"),t.R7$(2),t.Y8G("ngClass",t.l_i(30,Pn,n.minHealth()<0,n.maxHealth()>0)),t.R7$(),t.JRh(t.bMT(8,24,n.minHealth()<0?n.minHealth():n.maxHealth())),t.R7$(3),t.Y8G("repeat",!0),t.R7$(3),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-tooltip","game.condition.bless.hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom"),t.R7$(2),t.Y8G("ngClass",t.l_i(33,Pn,n.bless<0,n.bless>0)),t.R7$(),t.JRh(t.bMT(19,26,n.bless)),t.R7$(3),t.Y8G("repeat",!0),t.R7$(3),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-tooltip","game.condition.curse.hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom"),t.R7$(2),t.Y8G("ngClass",t.l_i(36,Pn,n.curse<0,n.curse>0)),t.R7$(),t.JRh(t.bMT(30,28,n.curse)),t.R7$(3),t.Y8G("repeat",!0)}}function OB(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-conditions",40),t.bIt("conditionChange",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.changeConditions(e))}),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("entities",n.activeCharacters)("entityConditions",n.entityConditions)("immunities",n.newImmunities)("type","character")}}function PB(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",30)(1,"ghs-pointer-input",31),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.changeLoot(e,-1))}),t.nrm(2,"img",32),t.k0s()(),t.j41(3,"span",33),t.nrm(4,"img",3),t.j41(5,"span",35),t.EFF(6),t.nI1(7,"ghsValueSign"),t.k0s()(),t.j41(8,"span",30)(9,"ghs-pointer-input",31),t.bIt("singleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.changeLoot(e,1))}),t.nrm(10,"img",36),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-label","game.loot."+n)("ghs-label-attribute","title"),t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+n+".svg",t.B4B),t.R7$(),t.Y8G("ngClass",t.l_i(9,Pn,i.minLoot(n)<0,i.maxLoot(n)>0)),t.R7$(),t.JRh(t.bMT(7,7,i.minLoot(n)<0?i.minLoot(n):i.maxLoot(n))),t.R7$(3),t.Y8G("repeat",!0)}}function bB(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",11)(1,"span",41),t.nrm(2,"span",4),t.k0s(),t.j41(3,"span",30)(4,"ghs-pointer-input",31),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeExperience(-1))}),t.nrm(5,"img",32),t.k0s()(),t.j41(6,"span",33),t.nrm(7,"img",42),t.j41(8,"span",35),t.EFF(9),t.nI1(10,"ghsValueSign"),t.k0s()(),t.j41(11,"span",30)(12,"ghs-pointer-input",31),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeExperience(1))}),t.nrm(13,"img",36),t.k0s()(),t.j41(14,"span",30)(15,"ghs-pointer-input",31),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeGold(-1))}),t.nrm(16,"img",32),t.k0s()(),t.j41(17,"span",33),t.nrm(18,"img",43),t.j41(19,"span",35),t.EFF(20),t.nI1(21,"ghsValueSign"),t.k0s()(),t.j41(22,"span",30)(23,"ghs-pointer-input",31),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeGold(1))}),t.nrm(24,"img",36),t.k0s()(),t.j41(25,"span",30)(26,"ghs-pointer-input",31),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeBattleGoals(-1))}),t.nrm(27,"img",32),t.k0s()(),t.j41(28,"span",33),t.nrm(29,"input",44),t.j41(30,"span",35),t.EFF(31),t.nI1(32,"ghsValueSign"),t.k0s()(),t.j41(33,"span",30)(34,"ghs-pointer-input",31),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.changeBattleGoals(1))}),t.nrm(35,"img",36),t.k0s()(),t.Z7z(36,PB,11,12,null,null,t.fX1),t.k0s()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","scenario.eventEffects.progress"),t.R7$(2),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-label","game.experience")("ghs-label-attribute","title"),t.R7$(2),t.Y8G("ngClass",t.l_i(27,Pn,n.minExperience()<0,n.maxExperience()>0)),t.R7$(),t.JRh(t.bMT(10,21,n.minExperience()<0?n.minExperience():n.maxExperience())),t.R7$(3),t.Y8G("repeat",!0),t.R7$(3),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-label","character.progress.gold")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ngClass",t.eq3(30,oB,!n.gameManager.fhRules()))("src","./assets/images/"+(n.gameManager.fhRules()?"fh/":"")+"loot.svg",t.B4B),t.R7$(),t.Y8G("ngClass",t.l_i(32,Pn,n.minGold()<0,n.maxGold()>0)),t.R7$(),t.JRh(t.bMT(21,23,n.minGold()<0?n.minGold():n.maxGold())),t.R7$(3),t.Y8G("repeat",!0),t.R7$(3),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-label","game.battleGoals")("ghs-label-attribute","title"),t.R7$(2),t.Y8G("ngClass",t.l_i(35,Pn,n.minBattleGoals()<0,n.maxBattleGoals()>0)),t.R7$(),t.JRh(t.bMT(32,25,n.minBattleGoals()<0?n.minBattleGoals():n.maxBattleGoals())),t.R7$(3),t.Y8G("repeat",!0),t.R7$(2),t.Dyx(n.lootColumns)}}function kB(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",47)(1,"a",48),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.drawEvent(e))}),t.k0s(),t.j41(2,"img",49),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.setupEvents(e))}),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.eventEffects.drawEvent")("ghs-label-args",t.eq3(4,sB,n))("ngClass",t.eq3(6,ce,!i.gameManager.game.party.eventDecks[n]||0==i.gameManager.game.party.eventDecks[n].length)),t.R7$(),t.Y8G("ghs-tooltip","game.events.deck.setup")}}function yB(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",45),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openOutpostAttack())}),t.k0s()}2&a&&t.Y8G("ghs-label","scenario.eventEffects.outpostAttack")}function xB(a,r){if(1&a&&(t.Z7z(0,kB,3,8,"span",47,t.fX1),t.nVh(2,yB,1,1,"span",46)),2&a){const n=t.XpG(2);t.Dyx(n.eventTypes),t.R7$(2),t.vxM(n.gameManager.fhRules()&&!n.eventAttack?2:-1)}}function EB(a,r){1&a&&t.nrm(0,"img",50)}function wB(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",30)(1,"ghs-pointer-input",51),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.changeReputation(-1))}),t.nrm(2,"img",32),t.k0s()(),t.j41(3,"span",33),t.nrm(4,"span",4),t.j41(5,"span",35),t.EFF(6),t.nI1(7,"ghsValueSign"),t.k0s()(),t.j41(8,"span",30)(9,"ghs-pointer-input",51),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.changeReputation(1))}),t.nrm(10,"img",36),t.k0s()()}if(2&a){const n=t.XpG(3);t.R7$(),t.Y8G("repeat",!0)("ngClass",t.eq3(11,ce,n.gameManager.game.party.reputation+n.reputation<=-20)),t.R7$(2),t.Y8G("ghs-label","party.reputation")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","party.reputation"),t.R7$(),t.Y8G("ngClass",t.l_i(13,Pn,n.reputation<0,n.reputation>0)),t.R7$(),t.JRh(t.bMT(7,9,n.reputation)),t.R7$(3),t.Y8G("repeat",!0)("ngClass",t.eq3(16,ce,n.gameManager.game.party.reputation+n.reputation>=20))}}function RB(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",30)(1,"ghs-pointer-input",51),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.changeMorale(-1))}),t.nrm(2,"img",32),t.k0s()(),t.j41(3,"span",33),t.nrm(4,"span",4),t.j41(5,"span",35),t.EFF(6),t.nI1(7,"ghsValueSign"),t.k0s()(),t.j41(8,"span",30)(9,"ghs-pointer-input",51),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.changeMorale(1))}),t.nrm(10,"img",36),t.k0s()()}if(2&a){const n=t.XpG(3);t.R7$(),t.Y8G("repeat",!0)("ngClass",t.eq3(11,ce,n.gameManager.game.party.morale+n.morale<=0)),t.R7$(2),t.Y8G("ghs-label","party.morale")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","party.morale"),t.R7$(),t.Y8G("ngClass",t.l_i(13,Pn,n.morale<0,n.morale>0)),t.R7$(),t.JRh(t.bMT(7,9,n.morale)),t.R7$(3),t.Y8G("repeat",!0)("ngClass",t.eq3(16,ce,n.gameManager.game.party.morale+n.morale>=20))}}function jB(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",30)(1,"ghs-pointer-input",51),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.changeInspiration(-1))}),t.nrm(2,"img",32),t.k0s()(),t.j41(3,"span",33),t.nrm(4,"span",4),t.j41(5,"span",35),t.EFF(6),t.nI1(7,"ghsValueSign"),t.k0s()(),t.j41(8,"span",30)(9,"ghs-pointer-input",51),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.changeInspiration(1))}),t.nrm(10,"img",36),t.k0s()()}if(2&a){const n=t.XpG(3);t.R7$(),t.Y8G("repeat",!0)("ngClass",t.eq3(11,ce,n.gameManager.game.party.inspiration+n.inspiration<=0)),t.R7$(2),t.Y8G("ghs-label","party.inspiration")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","party.inspiration"),t.R7$(),t.Y8G("ngClass",t.l_i(13,Pn,n.inspiration<0,n.inspiration>0)),t.R7$(),t.JRh(t.bMT(7,9,n.inspiration)),t.R7$(3),t.Y8G("repeat",!0)("ngClass",t.eq3(16,ce,n.gameManager.game.party.inspiration+n.inspiration>=20))}}function GB(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",30)(1,"ghs-pointer-input",31),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeProsperity(-1))}),t.nrm(2,"img",32),t.k0s()(),t.j41(3,"span",33),t.nVh(4,EB,1,0,"img",50),t.nrm(5,"span",4),t.j41(6,"span",35),t.EFF(7),t.nI1(8,"ghsValueSign"),t.k0s()(),t.j41(9,"span",30)(10,"ghs-pointer-input",31),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.changeProsperity(1))}),t.nrm(11,"img",36),t.k0s()(),t.nVh(12,wB,11,18),t.nVh(13,RB,11,18),t.nVh(14,jB,11,18)}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-label","party.prosperity")("ghs-label-attribute","title"),t.R7$(),t.vxM(n.gameManager.fhRules()?4:-1),t.R7$(),t.Y8G("ghs-label","party.prosperity"),t.R7$(),t.Y8G("ngClass",t.l_i(13,Pn,n.prosperity<0,n.prosperity>0)),t.R7$(),t.JRh(t.bMT(8,11,n.prosperity)),t.R7$(3),t.Y8G("repeat",!0),t.R7$(2),t.vxM(n.gameManager.fhRules()?-1:12),t.R7$(),t.vxM(n.gameManager.fhRules()?13:-1),t.R7$(),t.vxM(n.gameManager.fhRules()?14:-1)}}function TB(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",45),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.drawRandomItem(!0))}),t.k0s()}2&a&&t.Y8G("ghs-label","scenario.eventEffects.drawRandomItem.blueprint")}function SB(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",13)(1,"span",41),t.nrm(2,"span",4),t.k0s(),t.nVh(3,xB,3,1),t.nVh(4,GB,15,16),t.j41(5,"span",45),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.drawRandomItem())}),t.k0s(),t.nVh(6,TB,1,1,"span",46),t.j41(7,"span",45),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.drawRandomScenario(e.gameManager.fhRules()))}),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","scenario.eventEffects.campaign"),t.R7$(),t.vxM(n.settingsManager.settings.events?3:-1),t.R7$(),t.vxM(n.gameManager.roundManager.firstRound?4:-1),t.R7$(),t.Y8G("ghs-label","scenario.eventEffects.drawRandomItem"),t.R7$(),t.vxM(n.gameManager.fhRules()?6:-1),t.R7$(),t.Y8G("ghs-label","scenario.eventEffects.drawRandomScenario")}}function DB(a,r){1&a&&t.nrm(0,"span",26),2&a&&t.Y8G("ghs-label","game.events.applyManually")}function $B(a,r){1&a&&t.nrm(0,"ghs-event-card-condition",52),2&a&&t.Y8G("condition",r.$implicit)("light",!0)("selected",!0)}function IB(a,r){1&a&&t.nrm(0,"ghs-event-card-effect",53),2&a&&t.Y8G("effect",r.$implicit)("light",!0)("selected",!0)}function AB(a,r){1&a&&t.nrm(0,"span",54),2&a&&t.Y8G("ghs-label","game.events.outpostAttack")}function VB(a,r){1&a&&t.nrm(0,"span",26),2&a&&t.Y8G("ghs-label","game.events.outpostAttack.effects")}function FB(a,r){1&a&&t.nrm(0,"ghs-event-card-effect",53),2&a&&t.Y8G("effect",r.$implicit)("light",!0)("selected",!0)}function XB(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-event-card-attack",57),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openOutpostAttack())}),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("attack",n.eventAttack)("light",!0)("selected",!0)("narrative",!1)("effects",!1)("disabled",!0)}}function BB(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",14),t.nVh(1,DB,1,1,"span",26),t.Z7z(2,$B,1,3,"ghs-event-card-condition",52,mo),t.nI1(4,"trackUUID"),t.Z7z(5,IB,1,3,"ghs-event-card-effect",53,oc),t.nVh(7,AB,1,1,"span",54),t.nVh(8,VB,1,1,"span",26),t.Z7z(9,FB,1,3,"ghs-event-card-effect",53,oc),t.nVh(11,XB,1,6,"ghs-event-card-attack",55),t.j41(12,"a",56),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openPartySheet())}),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(),t.vxM(n.eventEffectsManual.length||n.eventConditionManual.length?1:-1),t.R7$(),t.Dyx(t.bMT(4,5,n.eventConditionManual)),t.R7$(3),t.Dyx(n.eventEffectsManual),t.R7$(2),t.vxM(n.eventAttack?7:-1),t.R7$(),t.vxM(n.eventOutpostAttackEffects.length?8:-1),t.R7$(),t.Dyx(n.eventOutpostAttackEffects),t.R7$(2),t.vxM(n.eventAttack?11:-1),t.R7$(),t.Y8G("ghs-label","campaign.party")}}let ra=(()=>{class a{dialog;ghsManager;gameManager=s.E;settingsManager=p.f;menu=!1;characters=[];activeCharacters=[];activeSummons=[];entityConditions=[];immunities=[];newImmunities=[];health=[];experience=[];gold=[];battleGoals=[];bless=0;curse=0;prosperity=0;reputation=0;morale=0;inspiration=0;loot=[];lootColumns=[];SummonColor=_t.rX;eventTypes=[];eventEffectsManual=[];eventOutpostAttackEffects=[];eventConditionManual=[];eventAttack;constructor(n,i,e){this.dialog=i,this.ghsManager=e,this.menu=n&&n.menu||!1,this.createEventResults(n&&n.eventResults||[],!0)}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.close(),this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(n=!1){n||(this.characters=s.E.game.figures.filter(i=>i instanceof H.K).map(i=>i),this.activeCharacters=this.characters.filter(i=>!i.absent&&!i.exhausted),this.activeSummons=s.E.roundManager.firstRound?[]:this.activeCharacters.map(i=>i.summons).flat(),this.lootColumns=s.E.fhRules()?[rt.r6.lumber,rt.r6.metal,rt.r6.hide,rt.r6.arrowvine,rt.r6.axenut,rt.r6.corpsecap,rt.r6.flamefruit,rt.r6.rockroot,rt.r6.snowthistle]:[]),this.entityConditions=[],this.immunities=[],this.newImmunities=[],this.activeCharacters.forEach((i,e,o)=>{i.entityConditions.forEach(g=>{!this.entityConditions.find(m=>m.name==g.name)&&o.every(m=>m.entityConditions.find(k=>k.name==g.name&&k.state==g.state))&&this.entityConditions.push(JSON.parse(JSON.stringify(g)))}),i.immunities.forEach(g=>{!this.immunities.find(m=>m==g)&&o.every(m=>m.immunities.find(k=>k==g))&&(this.immunities.push(g),this.newImmunities.push(g))})}),this.activeSummons.forEach((i,e,o)=>{i.entityConditions.forEach(g=>{!this.entityConditions.find(m=>m.name==g.name)&&o.every(m=>m.entityConditions.find(k=>k.name==g.name&&k.state==g.state))&&this.entityConditions.push(JSON.parse(JSON.stringify(g)))}),i.immunities.forEach(g=>{!this.immunities.find(m=>m==g)&&o.every(m=>m.immunities.find(k=>k==g))&&(this.immunities.push(g),this.newImmunities.push(g))})}),this.eventTypes=Object.keys(s.E.game.party.eventDecks),"fh"==s.E.game.edition&&(this.eventTypes=Math.max(s.E.game.party.weeks,0)%20<10?this.eventTypes.filter(i=>!i.startsWith("winter-")):this.eventTypes.filter(i=>!i.startsWith("summer-")))}toggleCharacter(n){this.activeCharacters.includes(n)?(this.activeCharacters.splice(this.activeCharacters.indexOf(n),1),n.summons.forEach(i=>{const e=this.activeSummons.indexOf(i);-1!=e&&this.activeSummons.splice(e,1)})):(this.activeCharacters.push(n),n.summons.forEach(i=>{this.activeSummons.includes(i)||this.activeSummons.push(i)})),this.update(!0)}toggleSummon(n){this.activeSummons.includes(n)?this.activeSummons.splice(this.activeSummons.indexOf(n),1):this.activeSummons.push(n),this.update(!0)}changeHealth(n){this.activeCharacters.forEach((i,e)=>{this.health[e]=this.health[e]||0,this.health[e]+=n;let o=(0,A.hZ)(i.maxHealth);"lightning"==i.name&&i.tags.find(g=>"unbridled-power"===g)&&(o=Math.max(o,26)),i.health+this.health[e]>o?this.health[e]=o-i.health:i.health+this.health[e]<0&&(this.health[e]=-i.health)}),this.activeSummons.forEach((i,e)=>{const o=this.activeCharacters.length+e;this.health[o]=this.health[o]||0,this.health[o]+=n;const g=(0,A.hZ)(i.maxHealth);i.health+this.health[o]>g?this.health[o]=g-i.health:i.health+this.health[o]<0&&(this.health[o]=-i.health)})}minHealth(){return 0==this.health.length&&(this.health[0]=0),this.health.reduce((n,i)=>Math.min(n,i))}maxHealth(){return 0==this.health.length&&(this.health[0]=0),this.health.reduce((n,i)=>Math.max(n,i))}changeExperience(n){this.activeCharacters.forEach((i,e)=>{this.experience[e]=this.experience[e]||0,this.experience[e]+=n,i.progress.experience+this.experience[e]<0&&(this.experience[e]=-i.progress.experience)})}minExperience(){return 0==this.experience.length&&(this.experience[0]=0),this.experience.reduce((n,i)=>Math.min(n,i))}maxExperience(){return 0==this.experience.length&&(this.experience[0]=0),this.experience.reduce((n,i)=>Math.max(n,i))}changeGold(n){this.activeCharacters.forEach((i,e)=>{this.gold[e]=this.gold[e]||0,this.gold[e]+=n,i.progress.gold+this.gold[e]<0&&(this.gold[e]=-i.progress.gold)})}minGold(){return 0==this.gold.length&&(this.gold[0]=0),this.gold.reduce((n,i)=>Math.min(n,i))}maxGold(){return 0==this.gold.length&&(this.gold[0]=0),this.gold.reduce((n,i)=>Math.max(n,i))}changeBattleGoals(n){this.activeCharacters.forEach((i,e)=>{this.battleGoals[e]=this.battleGoals[e]||0,this.battleGoals[e]+=n,i.progress.battleGoals+this.battleGoals[e]<0&&(this.battleGoals[e]=-i.progress.battleGoals),this.battleGoals[e]<-i.progress.battleGoals%3&&(this.battleGoals[e]=-i.progress.battleGoals%3)})}minBattleGoals(){return 0==this.battleGoals.length&&(this.battleGoals[0]=0),this.battleGoals.reduce((n,i)=>Math.min(n,i))}maxBattleGoals(){return 0==this.battleGoals.length&&(this.battleGoals[0]=0),this.battleGoals.reduce((n,i)=>Math.max(n,i))}changeBless(n){this.bless+=n;const i=s.E.attackModifierManager.countUpcomingBlesses();i+this.bless<0?this.bless=-i:i+this.bless>10&&(this.bless=10-i)}changeCurse(n){this.curse+=n;const i=s.E.attackModifierManager.countUpcomingCurses(!1);i+this.curse<0?this.curse=-i:i+this.curse>10&&(this.curse=10-i)}changeConditions(n){this.entityConditions=n}changeProsperity(n){this.prosperity+=n,s.E.game.party.prosperity+this.prosperity<0&&(this.prosperity=-s.E.game.party.prosperity)}changeReputation(n){this.reputation+=n,s.E.game.party.reputation+this.reputation<-20?this.reputation=-s.E.game.party.reputation-20:s.E.game.party.reputation+this.reputation>20&&(this.reputation=20-s.E.game.party.reputation)}changeMorale(n){this.morale+=n,s.E.game.party.morale+this.morale<0?this.morale=-s.E.game.party.morale:s.E.game.party.morale+this.morale>20&&(this.morale=20-s.E.game.party.morale)}changeInspiration(n){this.inspiration+=n,s.E.game.party.inspiration+this.inspiration<0&&(this.inspiration=-s.E.game.party.inspiration)}changeLoot(n,i){this.activeCharacters.forEach((e,o)=>{this.loot[o]=this.loot[o]||{},this.loot[o][n]=(this.loot[o][n]||0)+i,(e.progress.loot[n]||0)+(this.loot[o][n]||0)<0&&(this.loot[o][n]=-(e.progress.loot[n]||0))})}minLoot(n){return 0==this.loot.length&&(this.loot[0]={},this.loot[0][n]=0),this.loot.map(i=>i[n]||0).reduce((i,e)=>Math.min(i,e))}maxLoot(n){return 0==this.loot.length&&(this.loot[0]={},this.loot[0][n]=0),this.loot.map(i=>i[n]||0).reduce((i,e)=>Math.max(i,e))}drawRandomItem(n=!1){let i=s.E.itemManager.drawRandomItem(s.E.currentEdition(),n);i?this.dialog.open(JX,{panelClass:["dialog"],data:{item:i,blueprint:n}}).closed.subscribe({next:e=>{if(e){const o=e;s.E.stateManager.before("eventEffect.drawRandomItem"+(n?"Blueprint":""),o.id,o.edition,o.name),s.E.game.party.unlockedItems.push(new yt.VP(""+o.id,o.edition)),s.E.stateManager.after()}}}):n&&this.inspiration++}drawRandomScenario(n=!1){let i=n?s.E.scenarioManager.drawRandomScenarioSection(s.E.currentEdition()):s.E.scenarioManager.drawRandomScenario(s.E.currentEdition());i?this.dialog.open(nB,{panelClass:["dialog"],data:{scenario:i,section:n}}).closed.subscribe({next:e=>{if(e){const o=e;if(n){const g=o.unlocks?o.unlocks.map(m=>"%data.scenarioNumber:"+m+"%").join(", "):"";s.E.stateManager.before("eventEffect.drawRandomScenarioSection",o.index,o.edition,o.name,g),s.E.game.party.conclusions.push(new ut.Ag(""+o.index,o.edition,o.group)),s.E.stateManager.after()}else s.E.stateManager.before("eventEffect.drawRandomScenario",o.index,o.edition,o.name),s.E.game.party.manualScenarios.push(new ut.Ag(o.index,o.edition,o.group)),s.E.stateManager.after()}}}):n&&this.inspiration++}drawEvent(n){this.dialog.open(Ba,{panelClass:["dialog"],data:{edition:s.E.game.party.edition||s.E.currentEdition(),type:n}}).closed.subscribe({next:i=>{p.f.settings.eventsApply&&i&&this.createEventResults(i)}})}createEventResults(n,i=!1){this.eventEffectsManual=[],this.eventOutpostAttackEffects=[],this.eventConditionManual=[],this.eventAttack=void 0,n.forEach(e=>{"type"in e&&e.type in bt.Yj?e.type==bt.Yj.outpostAttack||e.type==bt.Yj.outpostTarget?this.eventOutpostAttackEffects.push(e):this.eventEffectsManual.push(e):"type"in e&&e.type in bt.iH?this.eventConditionManual.push(e):"type"in e||(this.eventAttack=e)})}openOutpostAttack(){this.dialog.open(WX,{panelClass:["dialog"],data:{attack:this.eventAttack,effects:this.eventOutpostAttackEffects}}).closed.subscribe({next:n=>{n&&(this.eventAttack=void 0,this.eventOutpostAttackEffects=[])}})}close(){const n=this.activeCharacters.map(i=>"%game.characterIconColored."+i.name+"%").join(",");if(this.entityConditions.filter(i=>i.state==Q.mg.new||i.state==Q.mg.removed).forEach(i=>{s.E.stateManager.before(i.state==Q.mg.removed?"eventEffect.removeCondition":"eventEffect.addCondition",i.name,n),this.activeCharacters.forEach(e=>{i.state==Q.mg.removed?s.E.entityManager.removeCondition(e,e,i,i.permanent):s.E.entityManager.addCondition(e,e,i,i.permanent)}),this.characters.forEach(e=>{e.summons.forEach(o=>{this.activeSummons.includes(o)&&(i.state==Q.mg.removed?s.E.entityManager.removeCondition(o,e,i,i.permanent):s.E.entityManager.addCondition(o,e,i,i.permanent))})}),s.E.stateManager.after()}),this.entityConditions.forEach(i=>{this.activeCharacters.find(e=>e.entityConditions.find(o=>o.name==i.name&&!o.expired&&o.value!=i.value))&&(s.E.stateManager.before("eventEffect.setConditionValue",i.name,""+i.value,n),this.activeCharacters.forEach(e=>{const o=e.entityConditions.find(g=>g.name==i.name&&!g.expired);o&&o.value!=i.value&&(o.value=i.value)}),this.characters.forEach(e=>{e.summons.forEach(o=>{if(this.activeSummons.includes(o)){const g=o.entityConditions.find(m=>m.name==i.name&&!m.expired);g&&g.value!=i.value&&(g.value=i.value)}})}),s.E.stateManager.after())}),this.immunities.forEach(i=>{this.newImmunities.includes(i)||(s.E.stateManager.before("eventEffect.removeImmunity",i,n),this.activeCharacters.forEach(e=>{e.immunities=e.immunities.filter(o=>o!=i)}),this.characters.forEach(e=>{e.summons.forEach(o=>{this.activeSummons.includes(o)&&(o.immunities=o.immunities.filter(g=>g!=i))})}),s.E.stateManager.after())}),this.newImmunities.forEach(i=>{this.immunities.includes(i)||(s.E.stateManager.before("eventEffect.addImmunity",i,n),this.activeCharacters.find(e=>{e.immunities.push(i)}),this.characters.find(e=>{e.summons.forEach(o=>{this.activeSummons.includes(o)&&o.immunities.push(i)})}),s.E.stateManager.after())}),(0!=this.minHealth()||0!=this.maxHealth())&&(s.E.stateManager.before("eventEffect.changeCharacterHP",(0,F.n1)(0!=this.minHealth()?this.minHealth():this.maxHealth()),n),this.activeCharacters.forEach((i,e)=>{this.health[e]&&0!=this.health[e]&&(s.E.entityManager.changeHealth(i,i,this.health[e]),this.health[e]=0),(i.maxHealth>0&&i.health<=0||i.exhausted)&&(i.exhausted=!0)}),this.characters.forEach(i=>{i.summons.forEach(e=>{const o=this.activeSummons.indexOf(e);if(-1!=o){const g=this.activeCharacters.length+o;this.health[g]&&0!=this.health[g]&&(s.E.entityManager.changeHealth(e,i,this.health[g]),this.health[g]=0),(e.maxHealth>0&&e.health<=0||e.dead)&&(e.dead=!0)}})}),s.E.stateManager.after()),(0!=this.minExperience()||0!=this.maxExperience())&&(s.E.stateManager.before("eventEffect.changeCharacterXP",(0,F.n1)(0!=this.minExperience()?this.minExperience():this.maxExperience()),n),this.activeCharacters.forEach((i,e)=>{this.experience[e]&&0!=this.experience[e]&&(i.progress.experience+=this.experience[e],this.experience[e]=0)}),s.E.stateManager.after()),(0!=this.minGold()||0!=this.maxGold())&&(s.E.stateManager.before("eventEffect.changeCharacterGold",(0,F.n1)(0!=this.minGold()?this.minGold():this.maxGold()),n),this.activeCharacters.forEach((i,e)=>{this.gold[e]&&0!=this.gold[e]&&(i.progress.gold+=this.gold[e],this.gold[e]=0)}),s.E.stateManager.after()),(0!=this.minBattleGoals()||0!=this.maxBattleGoals())&&(s.E.stateManager.before("eventEffect.changeCharacterBattleGoals",(0,F.n1)(0!=this.minBattleGoals()?this.minBattleGoals():this.maxBattleGoals()),n),this.activeCharacters.forEach((i,e)=>{this.battleGoals[e]&&0!=this.battleGoals[e]&&(i.progress.battleGoals+=this.battleGoals[e],this.battleGoals[e]=0)}),s.E.stateManager.after()),0!=this.bless){s.E.stateManager.before("eventEffect.changeCharacterBless",(0,F.n1)(this.bless),n);let i=Math.abs(this.bless),e=0;for(;i>0;){const o=this.activeCharacters[e%this.activeCharacters.length];if(this.bless<0){let g=o.attackModifierDeck.cards.find((m,k)=>m.type==w.Yn.bless&&k>o.attackModifierDeck.current);g&&(o.attackModifierDeck.cards.splice(o.attackModifierDeck.cards.indexOf(g),1),i--)}else s.E.attackModifierManager.addModifier(o.attackModifierDeck,new w.uU(w.Yn.bless)),i--;e++}s.E.stateManager.after()}if(0!=this.curse){s.E.stateManager.before("eventEffect.changeCharacterCurse",(0,F.n1)(this.curse),n);let i=Math.abs(this.curse),e=0;for(;i>0;){const o=this.activeCharacters[e%this.activeCharacters.length];if(this.curse<0){let g=o.attackModifierDeck.cards.find((m,k)=>m.type==w.Yn.curse&&k>o.attackModifierDeck.current);g&&(o.attackModifierDeck.cards.splice(o.attackModifierDeck.cards.indexOf(g),1),i--)}else s.E.attackModifierManager.addModifier(o.attackModifierDeck,new w.uU(w.Yn.curse)),i--;e++}s.E.stateManager.after()}0!=this.prosperity&&(s.E.stateManager.before("eventEffect.prosperity",(0,F.n1)(this.prosperity)),s.E.game.party.prosperity+=this.prosperity,s.E.stateManager.after()),0!=this.reputation&&(s.E.stateManager.before("eventEffect.reputation",(0,F.n1)(this.reputation)),s.E.game.party.reputation+=this.reputation,s.E.stateManager.after()),0!=this.morale&&(s.E.stateManager.before("eventEffect.morale",(0,F.n1)(this.morale)),s.E.game.party.morale+=this.morale,s.E.stateManager.after()),0!=this.inspiration&&(s.E.stateManager.before("eventEffect.inspiration",(0,F.n1)(this.inspiration)),s.E.game.party.inspiration+=this.inspiration,s.E.stateManager.after()),this.lootColumns.forEach(i=>{(0!=this.minLoot(i)||0!=this.maxLoot(i))&&(s.E.stateManager.before("eventEffect.changeCharacterResource",i,(0,F.n1)(0!=this.minLoot(i)?this.minLoot(i):this.maxLoot(i)),n),this.activeCharacters.forEach((e,o)=>{this.loot[o]&&this.loot[o][i]&&(e.progress.loot[i]=(e.progress.loot[i]||0)+(this.loot[o][i]||0),this.loot[o][i]=0)}),s.E.stateManager.after())})}openFavors(){this.dialog.open(Jr,{panelClass:["dialog"]})}toggleImbuement(n=!1){s.E.imbuementManager.imbuement?(s.E.stateManager.before("gh2eImbuement.disable"),s.E.imbuementManager.disable(s.E.game.monsterAttackModifierDeck)):n?(s.E.stateManager.before("gh2eImbuement.advanced"),s.E.imbuementManager.advanced(s.E.game.monsterAttackModifierDeck)):(s.E.stateManager.before("gh2eImbuement"),s.E.imbuementManager.enable(s.E.game.monsterAttackModifierDeck)),s.E.stateManager.after()}setupEvents(n){this.dialog.open(ao,{panelClass:["dialog"],data:{type:n,edition:s.E.game.edition||s.E.currentEdition()}})}openPartySheet(){this.dialog.open(Hn,{panelClass:["dialog-invert"],data:{partySheet:!0}})}openCharacterSheet(n){this.dialog.open(An,{panelClass:["dialog-invert"],data:{character:n}})}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-event-effects"]],standalone:!1,decls:18,vars:18,consts:[[1,"event-effects-dialog"],[1,"header"],[1,"name"],[1,"ghs-svg",3,"src"],[3,"ghs-label"],[1,"text"],[1,"characters",3,"ngClass"],[1,"character-container"],[1,"favors"],[1,"imbuement"],[1,"scroll-container","container",3,"ngClass"],[1,"entity-container"],[3,"entities","entityConditions","immunities","type"],[1,"entity-container","campaign"],[1,"entity-container","event-outcomes"],["tabclick","","ghs-pointer-input","",1,"character",3,"singleClick","doubleClick","ngClass"],[1,"icon",3,"src"],["src","./assets/images/status/absent.svg",1,"absent"],["tabclick","",1,"summon",3,"ngClass"],["tabclick","",1,"summon",3,"click","ngClass"],[1,"summon-state",3,"ngClass"],[3,"src"],[1,"summon-number"],[1,"background-image",3,"background-image"],[1,"background-image"],[1,"favors",3,"click"],[1,"title",3,"ghs-label"],[1,"checkboxes"],[3,"click"],[1,"input-checkbox",3,"ngClass"],[1,"item"],["tabclick","",1,"button",3,"singleClick","repeat"],["src","./assets/images/minus.svg",1,"ghs-svg"],[1,"item",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/status/health.svg"],[1,"badge",3,"ngClass"],["src","./assets/images/plus.svg",1,"ghs-svg"],[1,"item",3,"ghs-tooltip","originX","overlayX","originY","overlayY"],["src","./assets/images/status/bless.svg"],["src","./assets/images/status/curse.svg"],[3,"conditionChange","entities","entityConditions","immunities","type"],[1,"progress"],["src","./assets/images/status/experience.svg"],[1,"ghs-svg",3,"ngClass","src"],["type","checkbox","disabled","true","checked","true"],["tabclick","",1,"action",3,"click","ghs-label"],["tabclick","",1,"action",3,"ghs-label"],[1,"event-deck-container"],["tabclick","",1,"action",3,"click","ghs-label","ghs-label-args","ngClass"],["src","./assets/images/settings.svg",1,"ghs-svg",3,"click","ghs-tooltip"],["src","./assets/images/fh/prosperity.svg",1,"ghs-svg"],["tabclick","",1,"button",3,"singleClick","repeat","ngClass"],[3,"condition","light","selected"],[3,"effect","light","selected"],[1,"title","outpost",3,"ghs-label"],[3,"attack","light","selected","narrative","effects","disabled"],[1,"action",3,"click","ghs-label"],[3,"click","attack","light","selected","narrative","effects","disabled"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.nrm(3,"img",3)(4,"span",4),t.k0s(),t.nVh(5,rB,2,1,"div",5),t.j41(6,"div",6),t.Z7z(7,pB,5,6,"div",7,mo),t.nI1(9,"trackUUID"),t.nVh(10,uB,2,1,"a",8),t.nVh(11,MB,5,3,"div",9),t.k0s()(),t.j41(12,"div",10),t.nVh(13,vB,34,39,"div",11),t.nVh(14,OB,1,4,"ghs-conditions",12),t.nVh(15,bB,38,38,"div",11),t.nVh(16,SB,8,6,"div",13),t.nVh(17,BB,13,7,"div",14),t.k0s()()),2&i&&(t.R7$(3),t.Y8G("src","./assets/images/event"+(e.menu?"-effects":"")+".svg",t.B4B),t.R7$(),t.Y8G("ghs-label","scenario.eventEffects"+(e.menu?".hint":"")),t.R7$(),t.vxM(!e.menu&&e.characters.length?5:-1),t.R7$(),t.Y8G("ngClass",t.eq3(14,ac,e.gameManager.stateManager.permissions&&(!e.gameManager.stateManager.permissions.characters||!e.gameManager.stateManager.permissions.party))),t.R7$(),t.Dyx(t.bMT(9,12,e.characters)),t.R7$(3),t.vxM(e.gameManager.trialsManager.favorsEnabled?10:-1),t.R7$(),t.vxM(e.gameManager.imbuementManager.enabled?11:-1),t.R7$(),t.Y8G("ngClass",t.eq3(16,ac,e.gameManager.stateManager.permissions&&(!e.gameManager.stateManager.permissions.characters||!e.gameManager.stateManager.permissions.party))),t.R7$(),t.vxM(e.gameManager.game.scenario&&e.characters.length?13:-1),t.R7$(),t.vxM(e.gameManager.game.scenario&&e.characters.length?14:-1),t.R7$(),t.vxM(e.characters.length?15:-1),t.R7$(),t.vxM(e.settingsManager.settings.partySheet?16:-1),t.R7$(),t.vxM(e.eventEffectsManual.length||e.eventConditionManual.length||e.eventAttack||e.eventOutpostAttackEffects.length?17:-1))},dependencies:[N.YU,Pa,Ji,Ki,Wi,it,Mt,dt,Ft,Me,ct],styles:[".event-effects-dialog[_ngcontent-%COMP%]{position:relative}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-barsize))}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:flex-start;flex-wrap:wrap;margin:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor)) 0}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:flex-start;flex-wrap:wrap}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]{position:relative;cursor:pointer;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 6.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 6.5 * var(--ghs-dialog-factor));margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-white);border-radius:100%}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));width:auto}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .absent[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]   .absent[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0;height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));width:auto;filter:var(--ghs-filter-white)}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character.inactive[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon.inactive[_ngcontent-%COMP%]{filter:grayscale(.7);border-color:transparent}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]:hover, .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]:hover{filter:none;opacity:.7;border-color:var(--ghs-color-gray)}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character.summon[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon.summon[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 4);height:calc(var(--ghs-unit) * 4)}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character.summon[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon.summon[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character.summon[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon.summon[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%]{position:absolute;display:flex;justify-content:center;align-items:center;top:0;left:calc(var(--ghs-unit) * -.1);height:calc(var(--ghs-unit) * 4);width:calc(var(--ghs-unit) * 2);font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5);color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray);border-top-left-radius:calc(var(--ghs-unit) * 4);border-bottom-left-radius:calc(var(--ghs-unit) * 4);z-index:3;opacity:.9;transition:top calc(var(--ghs-animation-speed) * .5s) ease-out,left calc(var(--ghs-animation-speed) * .5s) ease-out}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character.summon[_ngcontent-%COMP%]   .summon-state.fh[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon.summon[_ngcontent-%COMP%]   .summon-state.fh[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5);height:calc(var(--ghs-unit) * 3.5)}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character.summon[_ngcontent-%COMP%]   .summon-state.fh[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon.summon[_ngcontent-%COMP%]   .summon-state.fh[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5);height:calc(var(--ghs-unit) * 3.5);font-family:var(--ghs-font-gh-title);font-size:calc(var(--ghs-unit) * 2.5);color:var(--ghs-color-white);border:calc(var(--ghs-unit) * .3) solid var(--ghs-color-white);border-radius:100%}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character.summon.inactive[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon.summon.inactive[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%]{filter:brightness(.7);color:var(--ghs-color-gray);border-color:var(--ghs-color-gray)}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character.summon.thumbnail[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon.summon.thumbnail[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]{position:absolute;top:70%;left:60%;transform:translateY(-50%);z-index:2}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character.summon.thumbnail[_ngcontent-%COMP%]   .background-image[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon.summon.thumbnail[_ngcontent-%COMP%]   .background-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:150%;background-size:100% AUTO;background-color:transparent;background-repeat:no-repeat;z-index:1}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character.summon.thumbnail.inactive[_ngcontent-%COMP%]   .background-image[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon.summon.thumbnail.inactive[_ngcontent-%COMP%]   .background-image[_ngcontent-%COMP%]{filter:brightness(.7) grayscale(.5)}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));cursor:pointer;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .imbuement[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));font-family:var(--ghs-font-text);color:var(--ghs-color-gray);display:flex;flex-direction:column}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .imbuement[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .imbuement[_ngcontent-%COMP%]   .checkboxes[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .imbuement[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));display:flex;align-items:center;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));cursor:pointer}.event-effects-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{display:flex;max-height:calc(90vh - var(--ghs-unit) * 25 * var(--ghs-dialog-factor))}.event-effects-dialog[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]{display:flex;justify-content:center;grid-column:span 3;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor)));align-content:start;margin:0 auto}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   span.item[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   span.item[_ngcontent-%COMP%]   img.gold[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   ghs-pointer-input[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   a.button[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   ghs-pointer-input.button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   a.button[_ngcontent-%COMP%]:hover, .event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   ghs-pointer-input.button[_ngcontent-%COMP%]:hover{opacity:.4}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   ghs-pointer-input.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   ghs-pointer-input.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:auto}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0;color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));text-shadow:var(--ghs-outline);text-align:center}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;grid-column:span 3;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]:hover{opacity:.7}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   .action.disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.5}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container.campaign[_ngcontent-%COMP%]{grid-template-columns:repeat(3,auto)}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container.campaign[_ngcontent-%COMP%]   span.item[_ngcontent-%COMP%]{color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));width:auto;padding:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container.campaign[_ngcontent-%COMP%]   .event-deck-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;grid-column:span 3}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container.campaign[_ngcontent-%COMP%]   .event-deck-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{cursor:pointer;height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));filter:var(--ghs-filter-gray)}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container.campaign[_ngcontent-%COMP%]   .event-deck-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{opacity:.7}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container.event-outcomes[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));color:var(--ghs-color-white);display:flex;flex-direction:column;padding:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));max-width:calc(var(--ghs-unit) * 35 * var(--ghs-dialog-factor))}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container.event-outcomes[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container.event-outcomes[_ngcontent-%COMP%]   .title.outpost[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));font-family:var(--ghs-font-normal)}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container.event-outcomes[_ngcontent-%COMP%]   ghs-event-card-attack[_ngcontent-%COMP%]{cursor:pointer}"]})}return a})();const YB=(a,r)=>({flipped:a,fh:r}),sc=()=>[],po=(a,r)=>({normal:a,elite:r}),UB=(a,r,n,i,e,o)=>({obstacle:a,"difficult-terrain":r,"hazardous-terrain":n,trap:i,treasure:e,loot:o});function NB(a,r){if(1&a&&(t.j41(0,"div",7),t.nrm(1,"img",10),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("src","./assets/images/"+(n.fh?"fh/":"")+"element/"+n.element+".svg",t.B4B)}}function zB(a,r){if(1&a&&(t.j41(0,"div",11)(1,"div",13)(2,"div",14)(3,"div",15)(4,"div",16),t.nrm(5,"img",10),t.k0s()()()(),t.j41(6,"span",17),t.nrm(7,"span",15),t.k0s(),t.j41(8,"span",18),t.nrm(9,"span",15),t.k0s(),t.j41(10,"span",19),t.nrm(11,"span",15),t.k0s()()),2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(5),t.Y8G("src",i.gameManager.monsterManager.monsterThumbnail(i.monster[n]),t.B4B),t.R7$(),t.Y8G("ngClass",t.l_i(4,po,"normal"==i.standees[n].type||"normal"==i.standees[n].player2,"elite"==i.standees[n].type||"elite"==i.standees[n].player2)),t.R7$(2),t.Y8G("ngClass",t.l_i(7,po,"normal"==i.standees[n].type||"normal"==i.standees[n].player3,"elite"==i.standees[n].type||"elite"==i.standees[n].player3)),t.R7$(2),t.Y8G("ngClass",t.l_i(10,po,"normal"==i.standees[n].type||"normal"==i.standees[n].player4,"elite"==i.standees[n].type||"elite"==i.standees[n].player4))}}function LB(a,r){if(1&a&&(t.j41(0,"div",22)(1,"span",23),t.EFF(2,":"),t.k0s(),t.nrm(3,"span",24),t.k0s()),2&a){const n=t.XpG(2).$implicit,i=t.XpG();t.R7$(3),t.Y8G("ghs-label","scenario.random.treasure."+i.overlays[n].value)("ghs-label-args",i.overlays[n].values||t.lJ4(2,sc))}}function qB(a,r){if(1&a&&t.nrm(0,"img",10),2&a){const n=r.$implicit,i=t.XpG(4);t.Y8G("src","./assets/images/"+(i.fh?"fh/":"")+"condition/"+n+".svg",t.B4B)}}function HB(a,r){if(1&a&&(t.j41(0,"div",22)(1,"span",23),t.EFF(2,":"),t.k0s(),t.j41(3,"span",25),t.Z7z(4,qB,1,1,"img",10,t.fX1),t.k0s()()),2&a){const n=t.XpG(2).$implicit,i=t.XpG();t.R7$(4),t.Dyx(i.overlays[n].values)}}function KB(a,r){if(1&a&&(t.j41(0,"div",12)(1,"div",20)(2,"div",21)(3,"div",16),t.nrm(4,"img",10),t.k0s()()(),t.nVh(5,LB,4,3,"div",22),t.nVh(6,HB,6,0,"div",22),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(),t.Y8G("ngClass",t.l4e(4,UB,"obstacle"==i.overlays[n].type,"difficultTerrain"==i.overlays[n].type,"hazardousTerrain"==i.overlays[n].type,"trap"==i.overlays[n].type,"treasure"==i.overlays[n].type,"loot"==i.overlays[n].type)),t.R7$(3),t.Y8G("src","./assets/images/scenario/random/overlays/"+(i.fh?"fh/":"")+("loot"==i.overlays[n].type||"treasure"==i.overlays[n].type?i.overlays[n].type:i.overlays[n].value)+".png",t.B4B),t.R7$(),t.vxM("treasure"==i.overlays[n].type&&i.overlays[n].value?5:-1),t.R7$(),t.vxM("treasure"!=i.overlays[n].type&&i.overlays[n].values?6:-1)}}function WB(a,r){if(1&a&&(t.j41(0,"div",9)(1,"label"),t.EFF(2),t.k0s(),t.nVh(3,zB,12,13,"div",11),t.nVh(4,KB,7,11,"div",12),t.k0s()),2&a){const n=r.$implicit,i=t.XpG();t.R7$(2),t.JRh(n+1),t.R7$(),t.vxM(i.monster[n]?3:-1),t.R7$(),t.vxM(i.overlays[n]?4:-1)}}let rc=(()=>{class a{section;flipped=!1;standees=[];monster=[];overlays=[];fh=!1;element;gameManager=s.E;ngOnInit(){this.update()}update(){this.fh="fh"==this.section.edition||s.E.editionExtensions(this.section.edition).includes("fh"),this.element=this.section.rules&&this.section.rules.find(n=>n.elements&&n.elements.length)?.elements[0].type||void 0,this.standees=[],this.section.rooms.length&&this.section.rooms[0]&&this.section.rooms[0].monster&&this.section.rooms[0].monster.forEach(n=>{if(!isNaN(+n.marker)){this.standees[+n.marker-1]=n;const i=s.E.monstersData().find(e=>e.name==n.name&&(e.edition==this.section.edition||s.E.editionExtensions(this.section.edition).includes(e.edition)));i&&(this.monster[+n.marker-1]=i)}}),this.overlays=[],this.section.overlays&&this.section.overlays.forEach(n=>{isNaN(+n.marker)||(this.overlays[+n.marker-1]=n)})}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-random-monster-card"]],inputs:{section:"section",flipped:"flipped"},standalone:!1,decls:13,vars:13,consts:[["container",""],[1,"random-monster-card-container"],[1,"card","vertical","random-monster-card",3,"ngClass"],[1,"card-back","random-monster-card-back"],[1,"card-front","random-monster-card-front"],[1,"name",3,"ghs-label"],[1,"index"],[1,"element"],[1,"slots"],[1,"slot-container"],[3,"src"],[1,"slot","monster"],[1,"slot","overlay"],[1,"image"],[1,"outer-border"],[1,"inner-border"],[1,"image-container"],[1,"type","player2",3,"ngClass"],[1,"type","player3",3,"ngClass"],[1,"type","player4",3,"ngClass"],[1,"image",3,"ngClass"],[1,"border"],[1,"value"],[1,"separator"],[1,"values",3,"ghs-label","ghs-label-args"],[1,"values"]],template:function(i,e){if(1&i&&(t.j41(0,"div",1,0)(2,"div",2),t.nrm(3,"div",3),t.j41(4,"div",4),t.nrm(5,"div",5),t.j41(6,"div",6),t.EFF(7),t.k0s(),t.nVh(8,NB,2,1,"div",7),t.j41(9,"div",8),t.Z7z(10,WB,5,3,"div",9,t.fX1),t.nI1(12,"ghsRange"),t.k0s()()()()),2&i){const o=t.sdS(1);t.R7$(2),t.xc7("font-size",.05*o.offsetWidth+"px"),t.Y8G("ngClass",t.l_i(9,YB,e.flipped,e.fh)),t.R7$(3),t.Y8G("ghs-label","data.section.title."+e.section.name),t.R7$(2),t.JRh(e.section.index),t.R7$(),t.vxM(e.element?8:-1),t.R7$(2),t.Dyx(t.i5U(12,6,t.lJ4(12,sc),12))}},dependencies:[N.YU,it,At],styles:['.random-monster-card-container[_ngcontent-%COMP%]{position:relative;width:100%;padding-bottom:150%}.random-monster-card[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-back[_ngcontent-%COMP%], .random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]{min-height:16em;display:flex;flex-direction:column;justify-content:center;text-align:center;border-radius:3.5%}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]{position:relative;z-index:1}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]:before{content:" ";position:absolute;width:100%;height:100%;background-image:url(random-monster-card-front.c61145f8bd93b116.png);background-position:center;background-size:100% auto;background-repeat:no-repeat;z-index:0}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;top:6%;left:15%;width:70%;display:flex;justify-content:center;color:var(--ghs-color-brown);font-size:1.3em;font-family:var(--ghs-font-gh-title)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%]{position:absolute;top:4%;left:7%;width:2.6em;height:2.6em;display:flex;justify-content:center;align-items:center;border:.1em solid var(--ghs-color-brown);border-radius:100%;background-image:url(random-monster-card-front.c61145f8bd93b116.png);background-position:center}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:82%;height:auto}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{position:absolute;bottom:5.5%;left:15%;width:70%;display:flex;justify-content:center;color:var(--ghs-color-brown);font-size:.75em;font-family:var(--ghs-font-gh-normal);font-weight:700}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;position:absolute;top:13%;left:10%;width:80%;height:80%}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]{position:relative}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{position:absolute;top:0;left:0;display:flex;justify-content:center;align-items:center;border:.1em solid var(--ghs-color-brown);border-radius:100%;color:var(--ghs-color-brown);font-size:1em;width:1.3em;height:1.3em;font-family:var(--ghs-font-gh-title)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]{position:absolute;top:0;left:15%;width:85%;height:100%}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{position:relative}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:4em;height:3.68em;background-color:var(--ghs-color-white);clip-path:polygon(0 50%,25% 0%,75% 0%,100% 50%,75% 100%,25% 100%)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:3.7em;height:3.404em;background-color:var(--ghs-color-red);clip-path:polygon(0 50%,25% 0%,75% 0%,100% 50%,75% 100%,25% 100%)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:3.2em;height:2.944em;background-color:var(--ghs-color-darkgray);clip-path:polygon(0 50%,25% 0%,75% 0%,100% 50%,75% 100%,25% 100%);overflow:hidden}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:3.2em;height:auto}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{position:absolute;bottom:.2em;left:1.24em;width:1.5em;height:.5em;clip-path:polygon(0 100%,0% 30%,50% 0%,100% 30%,100% 100%);background-color:var(--ghs-color-white)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]{position:absolute;bottom:10%;left:5%;width:90%;height:75%;clip-path:polygon(0 100%,0% 30%,50% 0%,100% 30%,100% 100%);background-color:var(--ghs-color-black)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type.normal[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]{background-color:var(--ghs-color-white)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type.elite[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]{background-color:var(--ghs-color-yellow)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type.player2[_ngcontent-%COMP%]{transform:rotate(118deg);left:0;bottom:initial;top:1em}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type.player3[_ngcontent-%COMP%]{transform:rotate(-118deg);left:2.5em;bottom:initial;top:1em}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;margin-left:.3em}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{position:relative}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:3.2042925em;height:3.7em;background-color:var(--ghs-color-darkgray);clip-path:polygon(50% 0,100% 25%,100% 75%,50% 100%,0 75%,0 25%)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:2.77128em;height:3.2em;clip-path:polygon(50% 0,100% 25%,100% 75%,50% 100%,0 75%,0 25%);overflow:hidden}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:4em;height:auto}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image.obstacle[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{background-color:var(--ghs-color-green)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image.difficult-terrain[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{background-color:var(--ghs-color-purple)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image.hazardous-terrain[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{background-color:var(--ghs-color-orange)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image.trap[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{background-color:var(--ghs-color-red)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image.treasure[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{background-color:var(--ghs-color-yellow)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image.loot[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{clip-path:none;background-color:var(--ghs-color-white);border-radius:100%;width:2.7em;height:2.7em}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image.loot[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{clip-path:none;background-color:var(--ghs-color-yellow);border-radius:100%;width:2.3em;height:2.3em}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:flex;align-items:center;height:100%}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{font-size:1.3em;font-family:var(--ghs-font-gh-title)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:.7em;font-family:var(--ghs-font-gh-title)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:1.8em;height:auto;margin:.05em}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{position:relative}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]{clip-path:none;background-color:transparent}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]{width:3.2042925em;height:3.7em;background-color:var(--ghs-color-black);clip-path:polygon(50% 0,100% 25%,100% 75%,50% 100%,0 75%,0 25%)}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{width:2.944485em;height:3.4em;clip-path:polygon(50% 0,100% 25%,100% 75%,50% 100%,0 75%,0 25%)}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:3.5em;height:auto}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{position:absolute;bottom:.6em;left:.5em;width:.8em;height:1.1em;clip-path:polygon(0% 0%,100% 44%,100% 100%,0% 56%);background-color:var(--ghs-color-black)}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]{position:absolute;bottom:7%;left:5%;width:90%;height:85%;clip-path:polygon(0% 0%,100% 44%,100% 100%,0% 56%);background-color:var(--ghs-color-darkgray);filter:brightness(1.4)}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type.normal[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]{background-color:var(--ghs-color-gray)}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type.elite[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]{background-color:var(--ghs-color-yellow);filter:brightness(1)}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type.player2[_ngcontent-%COMP%]{top:initial;transform:none;bottom:1.8em;left:.5em}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type.player3[_ngcontent-%COMP%]{top:initial;transform:none;bottom:1.2em;left:.5em}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:3em;width:auto}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image.treasure[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:3em;height:auto}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image.loot[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{border-radius:0;background-color:transparent}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image.loot[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{border-radius:0;background-color:transparent;overflow:visible}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image.loot[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:3.5em;height:auto}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-back[_ngcontent-%COMP%]{background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(random-monster-card-back.fefa4f425fbb0fa2.png);z-index:1}']})}return a})();const ZB=(a,r)=>({closed:a,opened:r});let cc=(()=>{class a{dialogRef;section;opened=!1;gameManager=s.E;constructor(n,i){this.dialogRef=i,this.section=n}ngOnInit(){this.opened=!0}close(){this.opened=!1,setTimeout(()=>{this.dialogRef.close()},p.f.settings.animations?1e3*p.f.settings.animationSpeed:0)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-random-monster-card-dialog"]],standalone:!1,decls:4,vars:6,consts:[["ghs-pointer-input","",1,"random-monster-card-dialog",3,"singleClick","ngClass"],[1,"random-monster-card-container"],[3,"section","flipped"],[1,"close-container",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.bIt("singleClick",function(){return e.close()}),t.j41(1,"div",1),t.nrm(2,"ghs-random-monster-card",2),t.k0s()(),t.j41(3,"div",3),t.bIt("click",function(){return e.close()}),t.k0s()),2&i&&(t.Y8G("ngClass",t.l_i(3,ZB,!e.opened,e.opened)),t.R7$(2),t.Y8G("section",e.section)("flipped",e.opened))},dependencies:[N.YU,dt,rc],styles:["[_nghost-%COMP%]{background-color:transparent;padding:0;margin:0;border:0}.random-monster-card-dialog[_ngcontent-%COMP%]{position:relative;width:100vw;height:100vh;border-image:none;background:none;transition:transform calc(var(--ghs-animation-speed) * .15s) ease-in-out;transform:scale(0);z-index:2;overflow:auto;display:flex;justify-content:center;align-items:center;-ms-overflow-style:none;scrollbar-width:none}.random-monster-card-dialog[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.random-monster-card-dialog.opened[_ngcontent-%COMP%]{transform:scale(1)}.random-monster-card-dialog.closed[_ngcontent-%COMP%]{transform:scale(0);transition-delay:.8s}.random-monster-card-dialog[_ngcontent-%COMP%]   .random-monster-card-container[_ngcontent-%COMP%]{overflow:visible;width:100vw;max-width:500px;max-height:100vh}.random-monster-card-dialog[_ngcontent-%COMP%]   .random-monster-card-container[_ngcontent-%COMP%]   ghs-random-monster-card[_ngcontent-%COMP%]{display:block;margin:1vh 0;height:150vw;max-height:750px}.close-container[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1}"]})}return a})();var lc=v(436);const JB=(a,r,n,i,e,o)=>({new:a,full:r,half:n,inert:i,always:e,consumed:o});let gc=(()=>{class a{sanitizer;type;element;ElementState=Tt.e_;svg="";constructor(n){this.sanitizer=n}ngOnInit(){this.type&&!this.element&&(this.element=new Tt.em(this.type),this.element.state=Tt.e_.strong),fetch("./assets/images/element/"+this.element.type+".svg").then(n=>n.text()).then(n=>{this.svg=this.sanitizer.bypassSecurityTrustHtml(n)}).catch(n=>{console.error("Invalid src: ./assets/images/element/"+this.element.type+".svg")})}static \u0275fac=function(i){return new(i||a)(t.rXU(lc.up))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-element-icon"]],inputs:{type:"type",element:"element"},standalone:!1,decls:1,vars:13,consts:[[1,"element-svg",3,"innerHTML","ghs-label","ghs-label-attribute","ngClass"]],template:function(i,e){1&i&&t.nrm(0,"span",0),2&i&&(t.HbH(e.element.type),t.Y8G("innerHTML",e.svg,t.npT)("ghs-label","game.element."+e.element.type)("ghs-label-attribute","title")("ngClass",t.l4e(6,JB,e.element.state==e.ElementState.new,e.element.state==e.ElementState.strong,e.element.state==e.ElementState.waning,e.element.state==e.ElementState.inert,e.element.state==e.ElementState.always,e.element.state==e.ElementState.consumed||e.element.state==e.ElementState.partlyConsumed)))},dependencies:[N.YU,it],styles:[".element-svg{display:flex;justify-content:center;align-items:center;width:100%;height:100%}.element-svg svg{width:100%;height:100%}.element-svg #bg{transition:clip-path calc(var(--ghs-animation-speed) * 1s)}.element-svg.inert #bg{clip-path:inset(100% 0px 0px 0px)}.element-svg.full #bg,.element-svg.always #bg,.element-svg.new #bg{clip-path:inset(0% 0px 0px 0px)}.element-svg.new{opacity:.7}.element-svg.consumed #bg{opacity:.3!important}.element-svg.half #bg{clip-path:inset(50% 0px 0px 0px)}\n"],encapsulation:2})}return a})();const QB=(a,r,n,i)=>[a,r,n,i],uo=(a,r,n)=>[a,r,n],tY=a=>[a],nY=(a,r,n,i,e,o)=>[a,r,n,i,e,o],dc=(a,r)=>[a,r],Se=(a,r)=>r._trackUUID;function eY(a,r){if(1&a&&t.nrm(0,"p",1),2&a){const n=t.XpG();t.Y8G("ghs-label",n.rule.noteTop)}}function aY(a,r){1&a&&t.nrm(0,"span",10),2&a&&t.Y8G("ghs-label","and")}function iY(a,r){if(1&a){const n=t.RV6();t.j41(0,"input",13),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG().$implicit;return t.DH7(o.count,e)||(o.count=e),c.Njj(e)}),t.k0s()}if(2&a){const n=t.XpG().$implicit;t.R50("ngModel",n.count),t.Y8G("min",n.manualMin||0)("max",n.manualMax||"")}}function oY(a,r){if(1&a&&(t.nVh(0,aY,1,1,"span",10),t.nrm(1,"span",11),t.nVh(2,iY,1,3,"input",12)),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.vxM(i>0?0:-1),t.R7$(),t.Y8G("ghs-label","scenario.rules.spawn"+(n.marker?"Marker":""))("ghs-label-args",t.ziG(4,QB,n.monster.name,e.gameManager.scenarioRulesManager.spawnType(n.monster)||"",n.count?e.gameManager.scenarioRulesManager.spawnCount(e.rule,n)+" ":"",n.marker)),t.R7$(),t.vxM(n.manual?2:-1)}}function sY(a,r){if(1&a&&(t.j41(0,"div",2),t.Z7z(1,oY,3,9,null,null,Se),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(t.bMT(3,0,n.gameManager.scenarioRulesManager.spawns(n.rule)))}}function rY(a,r){1&a&&t.nrm(0,"span",10),2&a&&t.Y8G("ghs-label","and")}function cY(a,r){if(1&a){const n=t.RV6();t.j41(0,"input",15),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG().$implicit;return t.DH7(o.count,e)||(o.count=e),c.Njj(e)}),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.R50("ngModel",n.count),t.Y8G("min",n.manualMin||0)("max",n.manualMax||"")("value",i.EntityValueFunction(n.count||1))}}function lY(a,r){if(1&a&&(t.nVh(0,rY,1,1,"span",10),t.nrm(1,"span",11),t.nVh(2,cY,1,4,"input",14)),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.vxM(i>0?0:-1),t.R7$(),t.Y8G("ghs-label","scenario.rules.spawnObjective"+(e.EntityValueFunction(n.count||1)>1?"s":"")+(n.objective.escort?"Escort":"")+(n.marker?"Marker":""))("ghs-label-args",t.sMw(4,uo,n.objective.name?"data.objective."+n.objective.name:"",e.EntityValueFunction(n.count||1)+" ",n.marker)),t.R7$(),t.vxM(n.manual?2:-1)}}function gY(a,r){if(1&a&&(t.j41(0,"div",3),t.Z7z(1,lY,3,8,null,null,Se),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(t.bMT(3,0,n.rule.objectiveSpawns))}}function dY(a,r){1&a&&(t.j41(0,"span",16),t.EFF(1,","),t.k0s())}function hY(a,r){if(1&a&&(t.nVh(0,dY,2,0,"span",16),t.j41(1,"span",17),t.nrm(2,"ghs-element-icon",18),t.j41(3,"span"),t.nrm(4,"span",19),t.k0s(),t.j41(5,"span"),t.nrm(6,"span",19),t.k0s()()),2&a){const n=r.$implicit;t.vxM(r.$index>0?0:-1),t.R7$(2),t.Y8G("element",n),t.R7$(2),t.Y8G("ghs-label","game.element."+n.type),t.R7$(2),t.Y8G("ghs-label","game.element.state."+n.state)}}function _Y(a,r){if(1&a&&(t.j41(0,"div",4),t.Z7z(1,hY,7,4,null,null,t.fX1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(n.rule.elements)}}function mY(a,r){if(1&a&&(t.j41(0,"span",20),t.nrm(1,"img",21)(2,"span",22),t.k0s()),2&a){const n=r.$implicit;t.R7$(2),t.Y8G("ghs-label",n.marker?"scenario.rules.openRoomMarker":"scenario.rules.openRoom")("ghs-label-args",t.eq3(2,tY,n.marker||""))}}function pY(a,r){if(1&a&&(t.j41(0,"div",5),t.Z7z(1,mY,3,4,"span",20,Se),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(t.bMT(3,0,n.rooms()))}}function uY(a,r){1&a&&(t.j41(0,"span",16),t.EFF(1,","),t.k0s())}function fY(a,r){if(1&a&&t.nrm(0,"span",22),2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.Y8G("ghs-label",(n.marker?"scenario.rules.addSectionMarker":"scenario.rules.addSection")+(n.hideIndex?"":"Index"))("ghs-label-args",t.sMw(2,uo,n.index,i.gameManager.scenarioManager.scenarioTitle(n,!0),n.marker||""))}}function CY(a,r){if(1&a&&t.nrm(0,"span",22),2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.Y8G("ghs-label","scenario.rules.finishWithConclusion")("ghs-label-args",t.sMw(2,uo,n.index,i.gameManager.scenarioManager.scenarioTitle(n,!0),n.marker||""))}}function MY(a,r){if(1&a&&(t.nVh(0,uY,2,0,"span",16),t.j41(1,"span",23),t.nrm(2,"img",24),t.nVh(3,fY,1,6,"span",22),t.nVh(4,CY,1,6,"span",22),t.k0s()),2&a){const n=r.$implicit;t.vxM(r.$index>0?0:-1),t.R7$(3),t.vxM(n.conclusion?-1:3),t.R7$(),t.vxM(n.conclusion?4:-1)}}function vY(a,r){if(1&a&&(t.j41(0,"div",6),t.Z7z(1,MY,5,3,null,null,Se),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(t.bMT(3,0,n.sections()))}}function OY(a,r){1&a&&(t.j41(0,"span",26),t.nrm(1,"span",19),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","scenario.rules.figures.scenarioEffect"))}function PY(a,r){if(1&a&&(t.j41(0,"span",25),t.nrm(1,"span",22),t.nVh(2,OY,2,1,"span",26),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.rules.figures."+n.type)("ghs-label-args",t.l4e(3,nY,i.figureNames(n),n.value||"",i.settingsManager.settings.calculate&&("damage"==n.type&&n.value&&!n.value.includes("H")||("setHp"==n.type||"heal"==n.type)&&n.value&&!n.value.includes("H"))?i.EntityValueFunction(n.value||""):n.value||"","amAdd"==n.type||"amRemove"==n.type?n.value.split(":")[0]:"","amAdd"==n.type||"amRemove"==n.type||"transfer"==n.type&&n.value&&n.value.split(":").length>1?n.value.split(":")[1]:"","transferEntities"==n.type&&n.identifier&&n.identifier.number?n.identifier.number:"")),t.R7$(),t.vxM(n.scenarioEffect?2:-1)}}function bY(a,r){if(1&a&&(t.j41(0,"div",7),t.Z7z(1,PY,3,10,"span",25,Se),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(t.bMT(3,0,n.figureRules()))}}function kY(a,r){if(1&a&&t.nrm(0,"p",22),2&a){const n=t.XpG(2);t.Y8G("ghs-label","scenario.rules.randomDungeon.dungeon"+(n.rule.randomDungeon.dungeonCards&&n.rule.randomDungeon.dungeonCards.length?".cards":""))("ghs-label-args",t.l_i(2,dc,n.rule.randomDungeon.dungeonCount,n.randomDungeonsDungeonLabel().toString()))}}function yY(a,r){1&a&&t.nrm(0,"br")}function xY(a,r){if(1&a&&t.nrm(0,"p",22),2&a){const n=t.XpG(2);t.Y8G("ghs-label","scenario.rules.randomDungeon.monster"+(n.rule.randomDungeon.monsterCards&&n.rule.randomDungeon.monsterCards.length?".cards":""))("ghs-label-args",t.l_i(2,dc,n.rule.randomDungeon.monsterCount,n.randomDungeonsMonsterLabel(n.rule).toString()))}}function EY(a,r){if(1&a&&(t.j41(0,"div",8),t.nVh(1,kY,1,5,"p",22),t.nVh(2,yY,1,0,"br"),t.nVh(3,xY,1,5,"p",22),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.vxM(n.rule.randomDungeon.dungeonCount?1:-1),t.R7$(),t.vxM(n.rule.randomDungeon.dungeonCount&&n.rule.randomDungeon.monsterCount?2:-1),t.R7$(),t.vxM(n.rule.randomDungeon.monsterCount?3:-1)}}function wY(a,r){1&a&&t.nrm(0,"div",27),2&a&&t.Y8G("ghs-label",r.$implicit.note)}function RY(a,r){if(1&a&&(t.j41(0,"div",9),t.Z7z(1,wY,1,1,"div",27,Se),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(t.bMT(3,0,n.rule.statEffects))}}function jY(a,r){if(1&a&&t.nrm(0,"p",1),2&a){const n=t.XpG();t.Y8G("ghs-label","scenario.rules.finish."+n.rule.finish)}}function GY(a,r){if(1&a&&t.nrm(0,"p",1),2&a){const n=t.XpG();t.Y8G("ghs-label",n.rule.note)}}function TY(a,r){if(1&a&&t.nrm(0,"p",1),2&a){const n=t.XpG();t.Y8G("ghs-label","scenario.rules.alwaysApplyTurn."+n.rule.alwaysApplyTurn)}}let hc=(()=>{class a{rule;identifier;gameManager=s.E;settingsManager=p.f;EntityValueFunction=A.hZ;ngOnInit(){this.rule.figures&&this.rule.figures.forEach(n=>{n.value&&(n.value=""+n.value)})}randomDungeonsMonsterLabel(n){return n.randomDungeon&&n.randomDungeon.monsterCards&&n.randomDungeon.monsterCards.length?n.randomDungeon.monsterCards.filter(i=>!s.E.game.scenario||!s.E.game.scenario.additionalSections||!s.E.game.scenario.additionalSections.includes(i)).map(i=>{if(s.E.game.scenario){const e=s.E.sectionData(s.E.game.scenario.edition,!0).find(o=>o.index==i&&"randomMonsterCard"==o.group);if(e)return"&nbsp%"+s.E.scenarioManager.scenarioTitle(e,!0)+"% (#"+e.index+")"}return"&nbsp"+i}):[]}randomDungeonsDungeonLabel(){return this.rule.randomDungeon&&this.rule.randomDungeon.dungeonCards&&this.rule.randomDungeon.dungeonCards.length?this.rule.randomDungeon.dungeonCards.filter(n=>!s.E.game.scenario||!s.E.game.scenario.additionalSections||!s.E.game.scenario.additionalSections.includes(n)).map(n=>{if(s.E.game.scenario){const i=s.E.sectionData(s.E.game.scenario.edition,!0).find(e=>e.index==n&&"randomDungeonCard"==e.group);if(i)return"&nbsp%"+s.E.scenarioManager.scenarioTitle(i,!0)+"% (#"+i.index+")"}return"&nbsp"+n}):[]}prevent(n){n.preventDefault(),n.stopPropagation()}sections(){const n=s.E.scenarioRulesManager.getScenarioForRule(this.identifier).scenario;return n&&this.rule.sections?s.E.sectionData(n.edition).filter(i=>!s.E.game.sections.find(e=>e.edition==i.edition&&e.group==n.group&&e.index==i.index)&&i.group==n.group&&this.rule.sections.includes(i.index)):[]}rooms(){let n=[];if(this.rule.rooms){const i=s.E.scenarioRulesManager.getScenarioForRule(this.identifier).scenario;this.rule.rooms.forEach(e=>{if(i){const o=i.rooms.find(g=>g.roomNumber==e);o&&s.E.game.scenario&&!s.E.game.scenario.revealedRooms.includes(e)&&n.push(o)}})}return n}figureRules(){return this.rule.figures&&this.rule.figures.filter(n=>{if(Ta.uh.includes(n.type))return!1;const i=s.E.scenarioRulesManager.figuresByFigureRule(n,this.rule);return 0!=i.length&&("gainCondition"==n.type||"permanentCondition"==n.type||"loseCondition"==n.type?i.some(e=>{if("gainCondition"==n.type){let o=s.E.entityManager.entities(e),g=new Q.kW(n.value);if(o.every(m=>s.E.entityManager.hasCondition(m,g)))return!1}else if("permanentCondition"==n.type){let o=s.E.entityManager.entities(e),g=new Q.kW(n.value);if(o.every(m=>s.E.entityManager.hasCondition(m,g,!0)))return!1}else if("loseCondition"==n.type){let o=s.E.entityManager.entities(e),g=new Q.kW(n.value);if(o.every(m=>!s.E.entityManager.hasCondition(m,g)))return!1}return!0}):"toggleOn"!=n.type&&"toggleOff"!=n.type||i.some(e=>e.off==("toggleOn"==n.type)))})||[]}figureNames(n){let i="";return n.identifier&&(i="all"==n.identifier.type?p.f.getLabel("scenario.rules.figures.all"):s.E.scenarioRulesManager.figuresByFigureRule(n,this.rule).filter(e=>{if("gainCondition"==n.type){let o=s.E.entityManager.entities(e),g=new Q.kW(n.value);if(o.every(m=>s.E.entityManager.hasCondition(m,g)))return!1}else if("permanentCondition"==n.type){let o=s.E.entityManager.entities(e),g=new Q.kW(n.value);if(o.every(m=>s.E.entityManager.hasCondition(m,g,!0)))return!1}else if("loseCondition"==n.type){let o=s.E.entityManager.entities(e),g=new Q.kW(n.value);if(o.every(m=>!s.E.entityManager.hasCondition(m,g)))return!1}else if("toggleOn"==n.type||"toggleOff"==n.type)return e.off==("toggleOn"==n.type);return!0}).map(e=>{if(e instanceof H.K)return p.f.getLabel("%game.characterIconColored."+e.name+"%")+s.E.characterManager.characterName(e);if(e instanceof ft.$e)return(e.title||p.f.getLabel("data.objective."+e.name))+(e.marker?" %game.mapMarker."+e.marker+"%":"")+(n.identifier&&n.identifier.marker?" %game.mapMarker."+n.identifier.marker+"%":"");if(e instanceof b.R){const o=e.statEffect&&e.statEffect.name?e.statEffect.name:e.name;return"removeEntity"==n.type?p.f.getLabel("data.monster."+o)+" ["+s.E.scenarioRulesManager.entitiesByFigureRule(n,this.rule).filter(g=>g instanceof Dt.I&&e.entities.includes(g)).map(g=>""+g.number).join(", ")+"]":p.f.getLabel("data.monster."+o)}return e.name}).join(", ")),i}figureNamesByIdenfifier(n){return s.E.figuresByIdentifier(n).map(i=>i instanceof H.K?p.f.getLabel("%game.characterIconColored."+i.name+"%")+s.E.characterManager.characterName(i):i instanceof ft.$e?(i.title||p.f.getLabel("data.objective."+i.name))+(i.marker?" %game.mapMarker."+i.marker+"%":"")+(n.marker?" %game.mapMarker."+n.marker+"%":""):i instanceof b.R?p.f.getLabel("data.monster."+(i.statEffect&&i.statEffect.name?i.statEffect.name:i.name)):i.name).join(", ")}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-scenario-rule"]],inputs:{rule:"rule",identifier:"identifier"},standalone:!1,decls:13,vars:12,consts:[[1,"rule"],[1,"text-white",3,"ghs-label"],[1,"spawns"],[1,"objective-spawns"],[1,"elements"],[1,"sections","rooms"],[1,"sections"],[1,"figures"],[1,"random-dungeon"],[1,"stat-effects"],[1,"and",3,"ghs-label"],[1,"text-white","text",3,"ghs-label","ghs-label-args"],["type","number",3,"ngModel","min","max"],["type","number",3,"ngModelChange","ngModel","min","max"],["type","number",3,"ngModel","min","max","value"],["type","number",3,"ngModelChange","ngModel","min","max","value"],[1,"and"],[1,"element"],[3,"element"],[3,"ghs-label"],[1,"section","room"],["src","./assets/images/scenario/door.svg",1,"ghs-svg"],[1,"text-white",3,"ghs-label","ghs-label-args"],[1,"section"],["src","./assets/images/lock.svg",1,"ghs-svg"],[1,"figure"],[1,"text-white"],[1,"text","text-white",3,"ghs-label"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nVh(1,eY,1,1,"p",1),t.nVh(2,sY,4,2,"div",2),t.nVh(3,gY,4,2,"div",3),t.nVh(4,_Y,3,0,"div",4),t.nVh(5,pY,4,2,"div",5),t.nVh(6,vY,4,2,"div",6),t.nVh(7,bY,4,2,"div",7),t.nVh(8,EY,4,3,"div",8),t.nVh(9,RY,4,2,"div",9),t.nVh(10,jY,1,1,"p",1),t.nVh(11,GY,1,1,"p",1),t.nVh(12,TY,1,1,"p",1),t.k0s()),2&i&&(t.R7$(),t.vxM(e.rule.noteTop?1:-1),t.R7$(),t.vxM(e.gameManager.scenarioRulesManager.spawns(e.rule).length>0?2:-1),t.R7$(),t.vxM(e.rule.objectiveSpawns&&e.rule.objectiveSpawns.length>0?3:-1),t.R7$(),t.vxM(e.rule.elements&&e.rule.elements.length>0?4:-1),t.R7$(),t.vxM(e.rooms().length>0?5:-1),t.R7$(),t.vxM(e.sections().length>0?6:-1),t.R7$(),t.vxM(e.figureRules().length>0?7:-1),t.R7$(),t.vxM(e.rule.randomDungeon?8:-1),t.R7$(),t.vxM(e.rule.statEffects&&e.rule.statEffects.length?9:-1),t.R7$(),t.vxM(e.rule.finish?10:-1),t.R7$(),t.vxM(e.rule.note?11:-1),t.R7$(),t.vxM(e.rule.alwaysApplyTurn?12:-1))},dependencies:[E.me,E.Q0,E.BC,E.VZ,E.zX,E.vS,gc,it,ct],styles:[".rule[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor))}.rule[_ngcontent-%COMP%]   .and[_ngcontent-%COMP%]{margin:0 .2em}.rule[_ngcontent-%COMP%]   .spawns[_ngcontent-%COMP%], .rule[_ngcontent-%COMP%]   .objective-spawns[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;padding:.5em}.rule[_ngcontent-%COMP%]   .spawns[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .rule[_ngcontent-%COMP%]   .objective-spawns[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:nowrap}.rule[_ngcontent-%COMP%]   .spawns[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .rule[_ngcontent-%COMP%]   .objective-spawns[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));font-family:var(--ghs-font-text);width:2em;background-color:transparent;z-index:1;margin:0 .2em}.rule[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.rule[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%] > .element[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.rule[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%] > .element[_ngcontent-%COMP%]   ghs-element-icon[_ngcontent-%COMP%]{width:2em;height:2em;margin-right:.15em}.rule[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%] > .element[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:0 .2em}.rule[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.rule[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]{display:inline-flex}.rule[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.rule[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap}.rule[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{padding:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.rule[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:not(:first-child){border-left:calc(var(--ghs-unit) * .1 * var(--ghs-barsize)) solid var(--ghs-color-white)}.rule[_ngcontent-%COMP%]   .figures[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column}.rule[_ngcontent-%COMP%]   .figures[_ngcontent-%COMP%]   .figure[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:0 .1em}.rule[_ngcontent-%COMP%]   .stat-effects[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor)) 0}.rule[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor))}"]})}return a})();const _c=(a,r)=>r._trackUUID;function SY(a,r){1&a&&t.nrm(0,"h2",1),2&a&&t.Y8G("ghs-label","scenario.rules.show.applied")}function DY(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-scenario-rule",6),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.discardScenarioRule(e))}),t.k0s()}if(2&a){const n=r.$implicit;t.Y8G("rule",n.rule)("identifier",n.identifier)}}function $Y(a,r){if(1&a&&t.nrm(0,"ghs-scenario-rule",3),2&a){const n=r.$implicit;t.Y8G("rule",n.rule)("identifier",n.identifier)}}function IY(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",7),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.clearDiscardedScenarioRules())}),t.k0s()}2&a&&t.Y8G("ghs-label","scenario.rules.clearDiscarded")}let AY=(()=>{class a{dialogRef;ghsManager;gameManager=s.E;appliedScenarioRules=[];discardedScenarioRules=[];constructor(n,i){this.dialogRef=n,this.ghsManager=i}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.update()}}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.appliedScenarioRules=[],s.E.game.appliedScenarioRules.forEach(n=>{const i=s.E.scenarioRulesManager.getScenarioForRule(n).scenario;i&&i.rules&&i.rules.length>n.index&&n.index>=0&&(i.rules[n.index].spawns&&i.rules[n.index].spawns.forEach(e=>{e.manual&&!e.count&&(e.count="1")}),this.appliedScenarioRules.push({identifier:n,rule:i.rules[n.index]}))}),this.discardedScenarioRules=[],s.E.game.discardedScenarioRules.forEach(n=>{const i=s.E.scenarioRulesManager.getScenarioForRule(n).scenario;i&&i.rules&&i.rules.length>n.index&&n.index>=0&&(i.rules[n.index].spawns&&i.rules[n.index].spawns.forEach(e=>{e.manual&&!e.count&&(e.count="1")}),this.discardedScenarioRules.push({identifier:n,rule:i.rules[n.index]}))}),!this.appliedScenarioRules.length&&!this.discardedScenarioRules.length&&(0,F.co)(this.dialogRef)}clearDiscardedScenarioRules(){s.E.stateManager.before("clearDiscardedScenarioRules"),s.E.game.discardedScenarioRules=[],s.E.stateManager.after()}discardScenarioRule(n){s.E.stateManager.before("removeScenarioRule"),s.E.game.appliedScenarioRules.splice(s.E.game.appliedScenarioRules.indexOf(n.identifier),1),(n.rule.once||n.rule.alwaysApplyTurn)&&s.E.game.discardedScenarioRules.push(n.identifier),s.E.stateManager.after()}static \u0275fac=function(i){return new(i||a)(t.rXU(O.ce),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-scenario-rules-dialog"]],standalone:!1,decls:13,vars:7,consts:[[1,"scenario-rules-dialog"],[3,"ghs-label"],[1,"applied"],[3,"rule","identifier"],[1,"discarded"],[1,"menu"],[3,"click","rule","identifier"],[3,"click","ghs-label"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nVh(1,SY,1,1,"h2",1),t.j41(2,"div",2),t.Z7z(3,DY,1,2,"ghs-scenario-rule",3,_c),t.nI1(5,"trackUUID"),t.k0s(),t.nrm(6,"h2",1),t.j41(7,"div",4),t.Z7z(8,$Y,1,2,"ghs-scenario-rule",3,_c),t.nI1(10,"trackUUID"),t.k0s(),t.j41(11,"div",5),t.nVh(12,IY,1,1,"a",1),t.k0s()()),2&i&&(t.R7$(),t.vxM(e.appliedScenarioRules.length?1:-1),t.R7$(2),t.Dyx(t.bMT(5,3,e.appliedScenarioRules)),t.R7$(3),t.Y8G("ghs-label","scenario.rules.show.discarded"),t.R7$(2),t.Dyx(t.bMT(10,5,e.discardedScenarioRules)),t.R7$(4),t.vxM(e.discardedScenarioRules.length?12:-1))},dependencies:[it,hc,ct],styles:["h2[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));color:var(--ghs-color-darkgray);margin:0;padding:0}.applied[_ngcontent-%COMP%]   ghs-scenario-rule[_ngcontent-%COMP%]{cursor:zoom-out}.applied[_ngcontent-%COMP%]   ghs-scenario-rule[_ngcontent-%COMP%]:hover{opacity:.6}.menu[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}"]})}return a})();const VY=(a,r)=>[a,r],FY=a=>[a];function XY(a,r){if(1&a&&t.nrm(0,"p",1),2&a){const n=t.XpG();t.Y8G("ghs-label",(n.sectionData.marker?"scenario.section.addMarker":"scenario.section.add")+(n.sectionData.hideIndex?"":"Index"))("ghs-label-args",t.l_i(2,VY,n.sectionData.index,n.sectionData.marker||""))}}function BY(a,r){if(1&a&&t.nrm(0,"p",1),2&a){const n=t.XpG();t.Y8G("ghs-label","scenario.section.conclusion")("ghs-label-args",t.eq3(2,FY,n.sectionData.name?n.gameManager.scenarioManager.scenarioTitle(n.sectionData,!0):"%scenario.section% #"+n.sectionData.index))}}let mc=(()=>{class a{sectionData;dialog;dialogRef;gameManager=s.E;constructor(n,i,e){this.sectionData=n,this.dialog=i,this.dialogRef=e}addSection(){this.sectionData.conclusion?(this.dialog.open(zt,{panelClass:["dialog"],data:{scenario:s.E.game.scenario,success:!0,conclusion:this.sectionData}}),this.close(!0)):(s.E.stateManager.before("addSection",this.sectionData.index,s.E.scenarioManager.scenarioTitle(this.sectionData,!0),"data.edition."+this.sectionData.edition),s.E.scenarioManager.addSection(this.sectionData),s.E.stateManager.after(),this.close(!0))}close(n){(0,F.co)(this.dialogRef,n)}confirm(n){p.f.settings.keyboardShortcuts&&"Enter"===n.key&&(this.addSection(),n.preventDefault(),n.stopPropagation())}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.lG),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-section-dialog"]],hostBindings:function(i,e){1&i&&t.bIt("keydown",function(g){return e.confirm(g)},t.EBC)},standalone:!1,decls:9,vars:4,consts:[[1,"section-popup"],[3,"ghs-label","ghs-label-args"],[1,"buttons"],[1,"cancel",3,"click"],[3,"ghs-label"],[1,"spacer"],[1,"add",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nVh(1,XY,1,5,"p",1),t.nVh(2,BY,1,4,"p",1),t.j41(3,"div",2)(4,"a",3),t.bIt("click",function(){return e.close(!1)}),t.nrm(5,"span",4),t.k0s(),t.nrm(6,"span",5),t.j41(7,"a",6),t.bIt("click",function(){return e.addSection()}),t.nrm(8,"span",4),t.k0s()()()),2&i&&(t.R7$(),t.vxM(e.sectionData.conclusion?-1:1),t.R7$(),t.vxM(e.sectionData.conclusion?2:-1),t.R7$(3),t.Y8G("ghs-label","scenario.section.cancel"),t.R7$(3),t.Y8G("ghs-label","scenario.section.confirm"))},dependencies:[it],styles:[".section-popup[_ngcontent-%COMP%]{text-align:center;color:var(--ghs-color-white);min-width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor));padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.section-popup[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.section-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly}.section-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}.section-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.section-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.section-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{color:var(--ghs-color-green)}"]})}return a})();const YY=["setupComponent"],UY=a=>({denied:a}),NY=a=>[a],zY=a=>({"random-monster-card":a}),LY=(a,r)=>[a,r],La=(a,r)=>r._trackUUID;function qY(a,r){if(1&a&&(t.j41(0,"span",4),t.EFF(1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.SpI("#",n.scenario.index)}}function HY(a,r){if(1&a&&(t.j41(0,"span",7),t.nrm(1,"span",27),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","scenario.level")("ghs-label-args",t.eq3(3,NY,n.scenario.level+""))("ngClass","level-"+n.scenario.level)}}function KY(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",28),t.bIt("click",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.openTreasures(e))}),t.nrm(1,"img",29),t.k0s()}}function WY(a,r){if(1&a&&t.nrm(0,"ghs-scenario-setup",9,0),2&a){const n=t.XpG();t.Y8G("scenario",n.scenario)}}function ZY(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",30),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openFavors())}),t.nrm(1,"span",6),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","scenario.favors"))}function JY(a,r){if(1&a&&t.nrm(0,"span",32),2&a){const n=t.XpG().$implicit;t.Y8G("ghs-label","%game.mapMarker."+n.marker+"%")}}function QY(a,r){if(1&a&&(t.j41(0,"span",12),t.nrm(1,"img",31),t.EFF(2),t.nVh(3,JY,1,1,"span",32),t.k0s()),2&a){const n=r.$implicit;t.R7$(2),t.SpI(" ",n.ref," "),t.R7$(),t.vxM(n.marker?3:-1)}}function t9(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1," \xa0"),t.nrm(2,"span",6),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(2),t.Y8G("ghs-label",i.gameManager.scenarioManager.scenarioTitle(n,!0))}}function n9(a,r){if(1&a&&t.nrm(0,"span",32),2&a){const n=t.XpG().$implicit;t.Y8G("ghs-label","%game.mapMarker."+n.marker+"%")}}function e9(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",33),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.openRandomMonsterCard(e))}),t.EFF(1),t.nVh(2,t9,3,1,"span"),t.nVh(3,n9,1,1,"span",32),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(4,zY,"randomMonsterCard"==n.group)),t.R7$(),t.SpI(" #",n.index," "),t.R7$(),t.vxM(i.scenario&&n.name==i.scenario.name?-1:2),t.R7$(),t.vxM(n.marker?3:-1)}}function a9(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",34),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.openRoom(e))}),t.nrm(1,"img",35)(2,"span",36),t.k0s()}if(2&a){const n=r.$implicit;t.R7$(2),t.Y8G("ghs-label",n.marker?"scenario.openRoomMarkerRef":"scenario.openRoomRef")("ghs-label-args",t.l_i(2,LY,n.ref,n.marker||""))}}function i9(a,r){1&a&&t.nrm(0,"img",38)}function o9(a,r){1&a&&t.nrm(0,"img",39)}function s9(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.SpI("#",n.index)}}function r9(a,r){if(1&a&&t.nrm(0,"span",32),2&a){const n=t.XpG().$implicit;t.Y8G("ghs-label","%game.mapMarker."+n.marker+"%")}}function c9(a,r){if(1&a&&(t.j41(0,"span",5),t.EFF(1," \xa0"),t.nrm(2,"span",6),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(2),t.Y8G("ghs-label",i.gameManager.scenarioManager.scenarioTitle(n,!0))}}function l9(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",37),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.addSection(e))}),t.nVh(1,i9,1,0,"img",38),t.nVh(2,o9,1,0,"img",39),t.nVh(3,s9,2,1,"span"),t.nVh(4,r9,1,1,"span",32),t.nVh(5,c9,3,1,"span",5),t.k0s()}if(2&a){const n=r.$implicit;t.R7$(),t.vxM(n.conclusion?-1:1),t.R7$(),t.vxM(n.conclusion?2:-1),t.R7$(),t.vxM(n.conclusion&&n.name?-1:3),t.R7$(),t.vxM(n.marker?4:-1),t.R7$(),t.vxM(n.conclusion&&n.name?5:-1)}}function g9(a,r){if(1&a){const n=t.RV6();t.j41(0,"label",17)(1,"input",40),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.setup,e)||(o.setup=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.setupComponent&&e.setupComponent.updateMonster())}),t.k0s(),t.nrm(2,"span",6),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.R50("ngModel",n.setup),t.R7$(),t.Y8G("ghs-label","scenario.setup")}}function d9(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",30),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openFavors())}),t.nrm(1,"span",6),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","scenario.favors"))}function h9(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",41),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.showScenarioRules())}),t.nrm(1,"span",6),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","scenario.rules.show"))}function _9(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",26)(1,"a",25),t.bIt("click",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.openEventEffects(e))}),t.nrm(2,"img",42)(3,"span",6),t.k0s()()}2&a&&(t.R7$(3),t.Y8G("ghs-label","scenario.eventEffects"))}let m9=(()=>{class a{scenario;dialogRef;dialog;gameManager=s.E;settingsManager=p.f;setupComponent;setup=!1;openRooms=[];closedRooms=[];availableSections=[];constructor(n,i,e){this.scenario=n,this.dialogRef=i,this.dialog=e,this.openRooms=s.E.scenarioManager.openRooms(),this.closedRooms=s.E.scenarioManager.closedRooms(),this.availableSections=s.E.scenarioManager.availableSections()}finishScenario(n){this.close();const i=s.E.scenarioManager.availableSections(!0).filter(e=>e.edition==this.scenario.edition&&e.parent==this.scenario.index&&e.group==this.scenario.group&&e.conclusion&&0==s.E.scenarioManager.getRequirements(e).length);i.length<2||!n?this.dialog.open(zt,{panelClass:["dialog"],data:{scenario:this.scenario,conclusion:1==i.length?i[0]:void 0,success:n}}):this.dialog.open(Xn,{panelClass:["dialog"],data:{conclusions:i,parent:this.scenario}}).closed.subscribe({next:e=>{e&&this.dialog.open(zt,{panelClass:["dialog"],data:{scenario:this.scenario,conclusion:e,success:n}})}})}resetScenario(){this.close(),s.E.stateManager.before("resetScenario",...s.E.scenarioManager.scenarioUndoArgs()),s.E.roundManager.resetScenario(),s.E.scenarioManager.setScenario(this.scenario,!0),s.E.stateManager.after()}cancelScenario(){this.close(),s.E.stateManager.before("cancelScenario",...s.E.scenarioManager.scenarioUndoArgs()),s.E.scenarioManager.setScenario(void 0),s.E.stateManager.after(1e3)}showScenarioRules(){this.dialog.open(AY,{panelClass:["dialog"]}),this.close()}openTreasures(n){this.dialog.open(ro,{panelClass:["dialog"]})}openEventEffects(n){this.dialog.open(ra,{panelClass:["dialog"]}),this.close()}openRoom(n){s.E.editionData.find(e=>e.edition==this.scenario.edition)?(s.E.stateManager.before(n.marker?"openRoomMarker":"openRoom",this.scenario.index,s.E.scenarioManager.scenarioTitle(this.scenario),n.ref,n.marker||""),s.E.scenarioManager.openRoom(n,this.scenario,!1),s.E.stateManager.after(),this.setupComponent&&this.setupComponent.updateMonster()):console.error("Could not find edition data!")}addSection(n){this.dialog.open(mc,{panelClass:["dialog"],data:n}).closed.subscribe({next:i=>{i&&this.close()}})}openFavors(){this.dialog.open(Jr,{panelClass:["dialog"]})}openRandomMonsterCard(n){"randomMonsterCard"==n.group&&this.dialog.open(cc,{panelClass:["fullscreen-panel"],disableClose:!0,data:n})}close(){(0,F.co)(this.dialogRef)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(O.lG))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-scenario-dialog"]],viewQuery:function(i,e){if(1&i&&t.GBs(YY,5),2&i){let o;t.mGM(o=t.lsd())&&(e.setupComponent=o.first)}},standalone:!1,decls:43,vars:26,consts:[["setupComponent",""],[1,"scenario-popup",3,"ngClass"],[1,"scroll-container"],[1,"title"],[1,"index"],[1,"name"],[3,"ghs-label"],[1,"scenario-level-container"],["tabclick","",1,"treasures"],[3,"scenario"],[1,"favors"],[1,"sections"],[1,"section","room"],[1,"section",3,"ngClass"],[1,"open-sections"],["tabclick","",1,"section","room","available"],["tabclick","",1,"section","available"],[1,"setup-checkbox"],[1,"additional"],[1,"menu"],[1,"buttons"],["tabclick","",1,"failure",3,"click"],[1,"spacer"],["tabclick","",1,"success",3,"click"],[1,"cancel"],["tabclick","",3,"click"],[1,"event-effects"],[1,"scenario-level",3,"ghs-label","ghs-label-args","ngClass"],["tabclick","",1,"treasures",3,"click"],["src","./assets/images/scenario/treasure.svg",1,"ghs-svg"],[1,"favors",3,"click"],["src","./assets/images/scenario/door-open.svg",1,"ghs-svg"],[1,"marker",3,"ghs-label"],[1,"section",3,"click","ngClass"],["tabclick","",1,"section","room","available",3,"click"],["src","./assets/images/scenario/door.svg",1,"ghs-svg"],[3,"ghs-label","ghs-label-args"],["tabclick","",1,"section","available",3,"click"],["src","./assets/images/lock.svg",1,"ghs-svg"],["src","./assets/images/scenario/conclusion.svg",1,"ghs-svg"],["type","checkbox",3,"ngModelChange","change","ngModel"],[3,"click"],["src","./assets/images/event.svg",1,"ghs-svg"]],template:function(i,e){1&i&&(t.j41(0,"div",1)(1,"div",2)(2,"div",3),t.nVh(3,qY,2,1,"span",4),t.j41(4,"span",5),t.nrm(5,"span",6),t.k0s(),t.nVh(6,HY,2,5,"span",7),t.nVh(7,KY,2,0,"span",8),t.k0s(),t.nVh(8,WY,2,1,"ghs-scenario-setup",9),t.nVh(9,ZY,2,1,"a",10),t.j41(10,"div",11),t.Z7z(11,QY,4,2,"span",12,La),t.nI1(13,"trackUUID"),t.Z7z(14,e9,4,6,"span",13,La),t.nI1(16,"trackUUID"),t.k0s(),t.j41(17,"div",14),t.Z7z(18,a9,3,5,"span",15,La),t.nI1(20,"trackUUID"),t.Z7z(21,l9,6,5,"span",16,La),t.nI1(23,"trackUUID"),t.k0s(),t.nVh(24,g9,3,2,"label",17),t.nVh(25,d9,2,1,"a",10),t.j41(26,"div",18),t.nVh(27,h9,2,1,"a"),t.k0s(),t.j41(28,"div",19)(29,"label"),t.nrm(30,"span",6),t.k0s(),t.j41(31,"div",20)(32,"a",21),t.bIt("click",function(){return e.finishScenario(!1)}),t.nrm(33,"span",6),t.k0s(),t.nrm(34,"span",22),t.j41(35,"a",23),t.bIt("click",function(){return e.finishScenario(!0)}),t.nrm(36,"span",6),t.k0s()(),t.j41(37,"div",24)(38,"a",25),t.bIt("click",function(){return e.cancelScenario()}),t.nrm(39,"span",6),t.k0s(),t.j41(40,"a",25),t.bIt("click",function(){return e.resetScenario()}),t.nrm(41,"span",6),t.k0s()()(),t.nVh(42,_9,4,1,"div",26),t.k0s()()),2&i&&(t.Y8G("ngClass",t.eq3(24,UY,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.scenario)),t.R7$(3),t.vxM(e.scenario.index&&!e.scenario.hideIndex?3:-1),t.R7$(2),t.Y8G("ghs-label",e.scenario.name?e.gameManager.scenarioManager.scenarioTitle(e.scenario):e.scenario.custom?"scenario.custom":"scenario"),t.R7$(),t.vxM(e.scenario.level?6:-1),t.R7$(),t.vxM(e.settingsManager.settings.scenarioRooms&&e.settingsManager.settings.treasures&&e.gameManager.scenarioManager.getTreasures(e.scenario,e.gameManager.game.sections).length>0?7:-1),t.R7$(),t.vxM(e.setup||e.gameManager.game.round<1?8:-1),t.R7$(),t.vxM(e.gameManager.game.round<1&&e.gameManager.trialsManager.favorsEnabled?9:-1),t.R7$(2),t.Dyx(t.bMT(13,16,e.openRooms)),t.R7$(3),t.Dyx(t.bMT(16,18,e.gameManager.game.sections)),t.R7$(4),t.Dyx(t.bMT(20,20,e.closedRooms)),t.R7$(3),t.Dyx(t.bMT(23,22,e.availableSections)),t.R7$(3),t.vxM(e.gameManager.game.round>0?24:-1),t.R7$(),t.vxM(e.gameManager.game.round>0&&e.gameManager.trialsManager.favorsEnabled?25:-1),t.R7$(2),t.vxM(e.gameManager.game.appliedScenarioRules.length||e.gameManager.game.discardedScenarioRules.length?27:-1),t.R7$(3),t.Y8G("ghs-label","scenario.finish"),t.R7$(3),t.Y8G("ghs-label","scenario.finish.failure"),t.R7$(3),t.Y8G("ghs-label","scenario.finish.success"),t.R7$(3),t.Y8G("ghs-label","scenario.cancel"),t.R7$(2),t.Y8G("ghs-label","scenario.reset"),t.R7$(),t.vxM(e.settingsManager.settings.partySheet||e.gameManager.characterManager.characterCount(!0)>0?42:-1))},dependencies:[N.YU,E.Zm,E.BC,E.vS,it,Br,Ft,ct],styles:[".scenario-popup[_ngcontent-%COMP%]{position:relative;text-align:center;color:var(--ghs-color-white);min-width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%]{padding:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;justify-content:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;height:1em;width:auto;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow);height:.8em;width:auto}.scenario-popup[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .scenario-level-container[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * .7 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]{cursor:pointer;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.scenario-popup[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.scenario-popup[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));display:flex;justify-content:center;flex-wrap:wrap}.scenario-popup[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{padding:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:not(:first-child){border-left:calc(var(--ghs-unit) * .1 * var(--ghs-barsize)) solid var(--ghs-color-white)}.scenario-popup[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section.random-monster-card[_ngcontent-%COMP%]{cursor:pointer}.scenario-popup[_ngcontent-%COMP%]   .open-sections[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));display:flex;flex-direction:column}.scenario-popup[_ngcontent-%COMP%]   .open-sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:hover{cursor:pointer;color:var(--ghs-color-white);text-shadow:var(--ghs-outline-thin)}.scenario-popup[_ngcontent-%COMP%]   .open-sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.scenario-popup[_ngcontent-%COMP%]   .open-sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:hover   .marker[_ngcontent-%COMP%]{filter:grayscale(.3)}.scenario-popup[_ngcontent-%COMP%]   .setup-checkbox[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;margin-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .setup-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .setup-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before{left:calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * -.25 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .additional[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.scenario-popup[_ngcontent-%COMP%]   .additional[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .additional[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.scenario-popup[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .2 * var(--ghs-barsize)) solid var(--ghs-color-white);margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));padding-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}.scenario-popup[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.scenario-popup[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex}.scenario-popup[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .failure[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.scenario-popup[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .success[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.scenario-popup[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:not(:first-child){margin-left:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .event-effects[_ngcontent-%COMP%]{cursor:pointer;font-family:var(--ghs-font-title);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-barsize));padding-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-barsize));border-top:calc(var(--ghs-unit) * .2 * var(--ghs-barsize)) solid var(--ghs-color-white)}.scenario-popup[_ngcontent-%COMP%]   .event-effects[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.scenario-popup[_ngcontent-%COMP%]   .event-effects[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-barsize))}"]})}return a})();const p9=a=>({setup:a}),u9=a=>({denied:a}),f9=a=>[a],C9=a=>({unlooted:a}),M9=(a,r)=>[a,r],qa=(a,r)=>r._trackUUID;function v9(a,r){if(1&a&&(t.j41(0,"span",7),t.EFF(1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.SpI("#",n.gameManager.game.scenario.index)}}function O9(a,r){if(1&a&&(t.j41(0,"span",8),t.nrm(1,"span",11),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label",n.gameManager.game.scenario.name?n.gameManager.scenarioManager.scenarioTitle(n.gameManager.game.scenario):n.gameManager.game.scenario.custom?"scenario.custom":"scenario.set")}}function P9(a,r){if(1&a&&(t.j41(0,"span",9),t.nrm(1,"span",12),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.level")("ghs-label-args",t.eq3(3,f9,n.gameManager.game.scenario.level+""))("ngClass","level-"+n.gameManager.game.scenario.level)}}function b9(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",13),t.bIt("click",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.openTreasures(e))}),t.nrm(1,"img",14),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(1,C9,n.gameManager.scenarioManager.getTreasures(n.gameManager.game.scenario,n.gameManager.game.sections,!0).length>0))}}function k9(a,r){if(1&a&&(t.j41(0,"div",2),t.nVh(1,v9,2,1,"span",7),t.nVh(2,O9,2,1,"span",8),t.nVh(3,P9,2,5,"span",9),t.nVh(4,b9,2,3,"span",10),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.vxM(n.gameManager.game.scenario.index&&!n.gameManager.game.scenario.hideIndex?1:-1),t.R7$(),t.vxM(n.gameManager.game.scenario?2:-1),t.R7$(),t.vxM(n.gameManager.game.scenario.level?3:-1),t.R7$(),t.vxM(n.settingsManager.settings.scenarioRooms&&n.settingsManager.settings.treasures&&n.gameManager.scenarioManager.getTreasures(n.gameManager.game.scenario,n.gameManager.game.sections).length>0?4:-1)}}function y9(a,r){1&a&&(t.j41(0,"div",3),t.nrm(1,"img",15)(2,"span",11),t.k0s()),2&a&&(t.R7$(2),t.Y8G("ghs-label","scenario.eventEffects"))}function x9(a,r){if(1&a&&t.nrm(0,"span",19),2&a){const n=t.XpG().$implicit;t.Y8G("ghs-label","%game.mapMarker."+n.marker+"%")}}function E9(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",17),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.open())}),t.nrm(1,"img",18),t.EFF(2),t.nVh(3,x9,1,1,"span",19),t.k0s()}if(2&a){const n=r.$implicit;t.R7$(2),t.SpI(" ",n.ref," "),t.R7$(),t.vxM(n.marker?3:-1)}}function w9(a,r){if(1&a&&(t.Z7z(0,E9,4,2,"span",16,qa),t.nI1(2,"trackUUID")),2&a){const n=t.XpG();t.Dyx(t.bMT(2,0,n.gameManager.scenarioManager.openRooms()))}}function R9(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.SpI("#",n.index)}}function j9(a,r){if(1&a&&(t.j41(0,"span",8),t.EFF(1," \xa0"),t.nrm(2,"span",11),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(2),t.Y8G("ghs-label",i.gameManager.scenarioManager.scenarioTitle(n,!0))}}function G9(a,r){if(1&a&&t.nrm(0,"span",19),2&a){const n=t.XpG().$implicit;t.Y8G("ghs-label","%game.mapMarker."+n.marker+"%")}}function T9(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",20),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.open())})("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.openRandomMonsterCard(e))}),t.nrm(1,"img",21),t.nVh(2,R9,2,1,"span"),t.nVh(3,j9,3,1,"span",8),t.nVh(4,G9,1,1,"span",19),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.R7$(2),t.vxM(n.hideIndex?-1:2),t.R7$(),t.vxM(i.gameManager.game.scenario&&n.name==i.gameManager.game.scenario.name?-1:3),t.R7$(),t.vxM(n.marker?4:-1)}}function S9(a,r){if(1&a&&t.nrm(0,"span",19),2&a){const n=t.XpG().$implicit;t.Y8G("ghs-label","%game.mapMarker."+n.marker+"%")}}function D9(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",23),t.bIt("click",function(e){const o=c.eBV(n).$implicit,g=t.XpG(2);return c.Njj(g.openRoom(o,e))}),t.nrm(1,"img",24),t.j41(2,"span",25),t.EFF(3),t.k0s(),t.nVh(4,S9,1,1,"span",19),t.k0s()}if(2&a){const n=r.$implicit;t.Y8G("ghs-tooltip",(n.marker?"scenario.openRoomMarker":"scenario.openRoom")+(n.ref?"Ref":""))("ghs-label-args",t.l_i(8,M9,n.ref||"",n.marker||""))("originX","center")("overlayY","center")("originY","top")("overlayY","bottom"),t.R7$(3),t.JRh(n.ref),t.R7$(),t.vxM(n.marker?4:-1)}}function $9(a,r){if(1&a&&(t.Z7z(0,D9,5,11,"span",22,qa),t.nI1(2,"trackUUID")),2&a){const n=t.XpG();t.Dyx(t.bMT(2,0,n.gameManager.scenarioManager.closedRooms()))}}function I9(a,r){1&a&&t.nrm(0,"img",27)}function A9(a,r){1&a&&t.nrm(0,"img",28)}function V9(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.SpI("#",n.index)}}function F9(a,r){if(1&a&&t.nrm(0,"span",19),2&a){const n=t.XpG().$implicit;t.Y8G("ghs-label","%game.mapMarker."+n.marker+"%")}}function X9(a,r){if(1&a&&(t.j41(0,"span",8),t.EFF(1," \xa0"),t.nrm(2,"span",11),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(2),t.Y8G("ghs-label",i.gameManager.scenarioManager.scenarioTitle(n,!0))}}function B9(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",26),t.bIt("click",function(e){const o=c.eBV(n).$implicit,g=t.XpG();return c.Njj(g.addSection(o,e))}),t.nVh(1,I9,1,0,"img",27),t.nVh(2,A9,1,0,"img",28),t.nVh(3,V9,2,1,"span"),t.nVh(4,F9,1,1,"span",19),t.nVh(5,X9,3,1,"span",8),t.k0s()}if(2&a){const n=r.$implicit;t.R7$(),t.vxM(n.conclusion?-1:1),t.R7$(),t.vxM(n.conclusion?2:-1),t.R7$(),t.vxM(n.conclusion&&n.name||n.hideIndex?-1:3),t.R7$(),t.vxM(n.marker?4:-1),t.R7$(),t.vxM((n.conclusion||n.named)&&n.name?5:-1)}}let Y9=(()=>{class a{dialog;ghsManager;gameManager=s.E;settingsManager=p.f;constructor(n,i){this.dialog=n,this.ghsManager=i}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{if(s.E.game.scenario&&s.E.game.finish&&!s.E.stateManager.scenarioSummary){const n=s.E.game.finish.conclusion?s.E.sectionData(s.E.game.finish.conclusion.edition).find(i=>s.E.game.finish&&s.E.game.finish.conclusion&&i.index==s.E.game.finish.conclusion.index&&i.group==s.E.game.finish.conclusion.group&&i.conclusion):void 0;this.dialog.open(zt,{panelClass:["dialog"],disableClose:!0,data:{scenario:s.E.game.scenario,conclusion:n,success:s.E.game.finish.success}})}else s.E.game.eventDraw&&p.f.settings.eventsDraw&&!this.dialog.openDialogs.find(n=>n.componentInstance&&n.componentInstance instanceof Ba)&&this.dialog.open(Ba,{panelClass:["dialog"],disableClose:!0,data:{edition:s.E.game.edition||s.E.currentEdition(),type:s.E.game.eventDraw}}).closed.subscribe({next:n=>{p.f.settings.eventsApply&&n&&n.length&&this.dialog.open(ra,{panelClass:["dialog"],data:{eventResults:n}})}})}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}open(){s.E.game.scenario?this.dialog.open(m9,{data:s.E.game.scenario,panelClass:["dialog"]}):this.dialog.open(ra,{panelClass:["dialog"]})}openTreasures(n){n.preventDefault(),n.stopPropagation(),s.E.game.scenario&&this.dialog.open(ro,{panelClass:["dialog"]})}openRandomMonsterCard(n){"randomMonsterCard"==n.group?this.dialog.open(cc,{panelClass:["fullscreen-panel"],disableClose:!0,data:n}):this.open()}availableSections(){return s.E.scenarioManager.availableSections().sort((n,i)=>n.marker&&i.marker&&!n.marker.startsWith("element")&&!i.marker.startsWith("element")?n.marker<i.marker?-1:1:0)}openRoom(n,i){i.preventDefault(),i.stopPropagation();const e=s.E.game.scenario;if(e)if(s.E.roundManager.firstRound)this.open();else{if(!s.E.editionData.find(g=>s.E.game.scenario&&g.edition==s.E.game.scenario.edition))return void console.error("Could not find edition data!");s.E.stateManager.before(n.marker?"openRoomMarker":"openRoom",e.index,s.E.scenarioManager.scenarioTitle(e),n.ref,n.marker||""),s.E.scenarioManager.openRoom(n,e,!1),s.E.stateManager.after()}}addSection(n,i){i.preventDefault(),i.stopPropagation(),s.E.roundManager.firstRound?this.open():this.dialog.open(mc,{panelClass:["dialog"],data:n})}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-scenario"]],standalone:!1,decls:13,vars:14,consts:[[1,"scenario-container",3,"ngClass"],[1,"button",3,"click"],[1,"scenario"],[1,"event-effects"],[1,"sections","rooms",3,"ngClass"],["ghs-pointer-input","",1,"section"],[1,"section","available"],[1,"index"],[1,"name"],[1,"scenario-level-container"],[1,"treasures",3,"ngClass"],[3,"ghs-label"],[1,"scenario-level",3,"ghs-label","ghs-label-args","ngClass"],[1,"treasures",3,"click","ngClass"],["src","./assets/images/scenario/treasure.svg",1,"ghs-svg"],["src","./assets/images/event.svg",1,"ghs-svg"],[1,"section","room"],[1,"section","room",3,"click"],["src","./assets/images/scenario/door-open.svg",1,"ghs-svg"],[1,"marker",3,"ghs-label"],["ghs-pointer-input","",1,"section",3,"singleClick","doubleClick"],["src","./assets/images/lock-open.svg",1,"ghs-svg"],[1,"section","room","available",3,"ghs-tooltip","ghs-label-args","originX","overlayY","originY"],[1,"section","room","available",3,"click","ghs-tooltip","ghs-label-args","originX","overlayY","originY"],["src","./assets/images/scenario/door.svg",1,"ghs-svg"],[1,"ref"],[1,"section","available",3,"click"],["src","./assets/images/lock.svg",1,"ghs-svg"],["src","./assets/images/scenario/conclusion.svg",1,"ghs-svg"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.bIt("click",function(){return e.open()}),t.nVh(2,k9,5,4,"div",2),t.nVh(3,y9,3,1,"div",3),t.k0s(),t.j41(4,"div",4),t.nVh(5,w9,3,2),t.Z7z(6,T9,5,3,"span",5,qa),t.nI1(8,"trackUUID"),t.nVh(9,$9,3,2),t.Z7z(10,B9,6,5,"span",6,qa),t.nI1(12,"trackUUID"),t.k0s()()),2&i&&(t.Y8G("ngClass",t.eq3(10,p9,e.gameManager.game.round<1)),t.R7$(2),t.vxM(e.gameManager.game.scenario?2:-1),t.R7$(),t.vxM(e.gameManager.bbRules()||e.gameManager.game.scenario||!(e.gameManager.characterManager.characterCount(!0)>0||e.settingsManager.settings.partySheet)?-1:3),t.R7$(),t.Y8G("ngClass",t.eq3(12,u9,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.scenario)),t.R7$(),t.vxM(e.settingsManager.settings.scenarioRooms?5:-1),t.R7$(),t.Dyx(t.bMT(8,6,e.gameManager.game.sections)),t.R7$(3),t.vxM(e.settingsManager.settings.scenarioRooms?9:-1),t.R7$(),t.Dyx(t.bMT(12,8,e.availableSections())))},dependencies:[N.YU,it,Mt,dt,ct],styles:[".scenario-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-barsize));margin-bottom:calc(var(--ghs-unit) * -1 * var(--ghs-barsize));color:var(--ghs-color-gray)}.scenario-container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{cursor:pointer;display:flex;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.8 * var(--ghs-barsize) * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 2.3 * var(--ghs-barsize) * var(--ghs-text-factor));text-shadow:var(--ghs-outline-thin)}.scenario-container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-barsize))}.scenario-container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.scenario-container[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap}.scenario-container[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;height:1em;width:auto;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-barsize))}.scenario-container[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray);height:.8em;width:auto}.scenario-container[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .treasures.unlooted[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.scenario-container[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .scenario-level-container[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-barsize) * var(--ghs-text-factor));margin-top:calc(var(--ghs-unit) * -.2 * var(--ghs-barsize));margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-barsize))}.scenario-container[_ngcontent-%COMP%]   .event-effects[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.scenario-container[_ngcontent-%COMP%]   .event-effects[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-barsize))}.scenario-container[_ngcontent-%COMP%]   .event-effects[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.scenario-container[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-barsize) * var(--ghs-text-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline-thin);max-height:calc(var(--ghs-unit) * 3.5 * var(--ghs-barsize) * var(--ghs-text-factor));overflow:auto}.scenario-container[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;padding:0 calc(var(--ghs-unit) * .5 * var(--ghs-barsize))}.scenario-container[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:not(:first-child){border-left:calc(var(--ghs-unit) * .1 * var(--ghs-barsize)) solid var(--ghs-color-gray)}.scenario-container[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.scenario-container[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:not(.available)   .marker[_ngcontent-%COMP%]{filter:grayscale(.9);opacity:.8}.scenario-container[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section.available[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white);text-shadow:var(--ghs-outline-thin)}.scenario-container[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section.available[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.scenario-container[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section.available[_ngcontent-%COMP%]:hover   .marker[_ngcontent-%COMP%]{filter:grayscale(.3)}@media (max-width: 791px){.scenario-container[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]{max-height:calc(var(--ghs-unit) * 7 * var(--ghs-barsize))}.scenario-container[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{display:none}}"]})}return a})();const U9=a=>({denied:a}),N9=(a,r)=>r._trackUUID;function z9(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",8)(1,"a",10),t.bIt("click",function(){c.eBV(n),t.XpG();const e=t.sdS(1),o=t.XpG().$index,g=t.XpG();return c.Njj(g.applyRule(e,o))}),t.nrm(2,"span",5)(3,"img",11),t.k0s()()}if(2&a){const n=t.XpG(2).$implicit;t.R7$(2),t.Y8G("ghs-label",n.rule.alwaysApply||n.rule.alwaysApplyTurn?"scenario.rules.alwaysApply":"scenario.rules.apply")}}function L9(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",2,0)(2,"div",3)(3,"div",4),t.bIt("click",function(){c.eBV(n);const e=t.sdS(1),o=t.XpG().$index,g=t.XpG();return c.Njj(g.hideRule(e,o))}),t.nrm(4,"span",5)(5,"img",6),t.k0s(),t.nrm(6,"ghs-scenario-rule",7),t.nVh(7,z9,4,1,"div",8),t.j41(8,"div",9),t.bIt("click",function(){c.eBV(n);const e=t.sdS(1),o=t.XpG().$index,g=t.XpG();return c.Njj(g.close(e,o))}),t.k0s()()()}if(2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(4),t.Y8G("ghs-label","scenario.rules.hide"),t.R7$(2),t.Y8G("rule",n.rule)("identifier",n.identifier),t.R7$(),t.vxM(i.apply(n.rule)?7:-1),t.R7$(),t.Y8G("ghs-label","scenario.rules.dismiss")("ghs-label-attribute","title")}}function q9(a,r){if(1&a&&t.nVh(0,L9,9,6,"div",2),2&a){const n=r.$index,i=t.XpG();t.vxM(i.visible(n)?0:-1)}}let H9=(()=>{class a{dialog;gameManager=s.E;settingsManager=p.f;EntityValueFunction=A.hZ;constructor(n){this.dialog=n}randomDungeonsMonsterLabel(n){return n.randomDungeon&&n.randomDungeon.monsterCards&&n.randomDungeon.monsterCards.length?n.randomDungeon.monsterCards.filter(i=>!s.E.game.scenario||!s.E.game.scenario.additionalSections||!s.E.game.scenario.additionalSections.includes(i)).map(i=>{if(s.E.game.scenario){const e=s.E.sectionData(s.E.game.scenario.edition,!0).find(o=>o.index==i&&"randomMonsterCard"==o.group);if(e)return"&nbsp%"+s.E.scenarioManager.scenarioTitle(e,!0)+"% (#"+e.index+")"}return"&nbsp"+i}):[]}randomDungeonsDungeonLabel(n){return n.randomDungeon&&n.randomDungeon.dungeonCards&&n.randomDungeon.dungeonCards.length?n.randomDungeon.dungeonCards.filter(i=>!s.E.game.scenario||!s.E.game.scenario.additionalSections||!s.E.game.scenario.additionalSections.includes(i)).map(i=>{if(s.E.game.scenario){const e=s.E.sectionData(s.E.game.scenario.edition,!0).find(o=>o.index==i&&"randomDungeonCard"==o.group);if(e)return"&nbsp%"+s.E.scenarioManager.scenarioTitle(e,!0)+"% (#"+e.index+")"}return"&nbsp"+i}):[]}prevent(n){n.preventDefault(),n.stopPropagation()}sections(n){if(s.E.game.scenarioRules[n]){const i=s.E.scenarioRulesManager.getScenarioForRule(s.E.game.scenarioRules[n].identifier).scenario;if(i){const e=s.E.game.scenarioRules[n].rule;if(e&&e.sections)return s.E.sectionData(i.edition).filter(o=>!s.E.game.sections.find(g=>g.edition==o.edition&&g.group==i.group&&g.index==o.index)&&o.group==i.group&&e.sections.includes(o.index))}}return[]}rooms(n){let i=[];if(s.E.game.scenarioRules[n]){const e=s.E.scenarioRulesManager.getScenarioForRule(s.E.game.scenarioRules[n].identifier).scenario;if(e){const o=s.E.game.scenarioRules[n].rule;o&&o.rooms&&o.rooms.forEach(g=>{const m=e.rooms.find(k=>k.roomNumber==g);m&&s.E.game.scenario&&!s.E.game.scenario.revealedRooms.includes(g)&&i.push(m)})}}return i}figureRules(n){return n.figures&&n.figures.filter(i=>{if(Ta.uh.includes(i.type))return!1;const e=s.E.scenarioRulesManager.figuresByFigureRule(i,n);return 0!=e.length&&("gainCondition"==i.type||"permanentCondition"==i.type||"loseCondition"==i.type?e.some(o=>{if("gainCondition"==i.type){let g=s.E.entityManager.entities(o),m=new Q.kW(i.value);if(g.every(k=>s.E.entityManager.hasCondition(k,m)))return!1}else if("permanentCondition"==i.type){let g=s.E.entityManager.entities(o),m=new Q.kW(i.value);if(g.every(k=>s.E.entityManager.hasCondition(k,m,!0)))return!1}else if("loseCondition"==i.type){let g=s.E.entityManager.entities(o),m=new Q.kW(i.value);if(g.every(k=>!s.E.entityManager.hasCondition(k,m)))return!1}return!0}):"toggleOn"!=i.type&&"toggleOff"!=i.type||e.some(o=>o.off==("toggleOn"==i.type)))})||[]}visible(n){if(s.E.game.scenarioRules[n]){const i=s.E.game.scenarioRules[n].rule;if(i.disablingRules&&i.disablingRules.length>0&&i.disablingRules.some(e=>s.E.game.scenarioRules.find((o,g)=>n!=g&&e.edition==o.identifier.edition&&e.group==o.identifier.group&&(e.index==o.identifier.index||-1==e.index)&&e.scenario==o.identifier.scenario&&e.section==o.identifier.section&&this.visible(g))))return!1;if(s.E.scenarioRulesManager.spawns(i).length>0||i.objectiveSpawns&&i.objectiveSpawns.length>0||i.elements&&i.elements.length>0&&i.elements.some(e=>s.E.game.elementBoard.find(o=>o.type==e.type)?.state!=e.state)||this.sections(n).length>0||this.rooms(n).length>0||this.figureRules(i).length>0||i.note||i.finish||i.randomDungeon||i.statEffects&&i.statEffects.length)return!0}return!1}apply(n){return s.E.scenarioRulesManager.spawns(n).length>0||n.objectiveSpawns&&n.objectiveSpawns.length>0||n.elements&&n.elements.length>0||n.finish||p.f.settings.scenarioRooms&&n.rooms&&n.rooms.length>0||n.sections&&n.sections.length>0||n.randomDungeon||n.figures&&n.figures.length>0&&n.figures.some(i=>!Ta.uh.includes(i.type))||n.statEffects&&n.statEffects.length}applyRule(n,i){if(s.E.game.scenarioRules[i]){const e=s.E.game.scenarioRules[i].rule,o=s.E.game.scenarioRules[i].identifier,g=s.E.scenarioRulesManager.getScenarioForRule(o).scenario;g&&(s.E.stateManager.before("applyScenarioRule"),e.alwaysApplyTurn||(s.E.scenarioRulesManager.applyRule(e,o),e.rooms&&this.rooms(i).forEach(m=>{s.E.scenarioManager.openRoom(m,g,s.E.game.scenarioRules[i].identifier.section)}),e.sections&&this.sections(i).forEach(m=>{m.conclusion?this.dialog.open(zt,{panelClass:["dialog"],data:{scenario:s.E.game.scenario,success:!0,conclusion:m}}):s.E.scenarioManager.addSection(m)}),e.finish&&["won","lost"].includes(e.finish)&&this.dialog.open(zt,{panelClass:["dialog"],data:{scenario:g,success:"won"==e.finish}})),n.classList.add("closed"),setTimeout(()=>{(e.once||e.alwaysApply||e.alwaysApplyTurn)&&s.E.game.appliedScenarioRules.push(o),s.E.game.scenarioRules.splice(i,1),"round"==e.finish&&s.E.roundManager.nextGameState(),s.E.stateManager.after()},p.f.settings.animations?100*p.f.settings.animationSpeed:0))}}hideRule(n,i){n.classList.add("closed"),setTimeout(()=>{s.E.stateManager.before("hideScenarioRule");const e=s.E.game.scenarioRules.splice(i,1)[0];s.E.game.discardedScenarioRules.push(e.identifier),s.E.stateManager.after()},p.f.settings.animations?100*p.f.settings.animationSpeed:0)}close(n,i){n.classList.add("closed"),setTimeout(()=>{s.E.stateManager.before("removeScenarioRule");const e=s.E.game.scenarioRules.splice(i,1)[0];(e.rule.once||e.rule.alwaysApplyTurn||e.rule.alwaysApply)&&s.E.game.discardedScenarioRules.push(e.identifier),s.E.stateManager.after()},p.f.settings.animations?100*p.f.settings.animationSpeed:0)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-scenario-rules"]],standalone:!1,decls:4,vars:5,consts:[["ruleElement",""],[1,"rules-dialog",3,"ngClass"],[1,"rule-dialog","dialog"],[1,"dialog-container"],[1,"hide",3,"click"],[3,"ghs-label"],["src","./assets/images/close.svg"],[3,"rule","identifier"],[1,"menu"],[1,"close",3,"click","ghs-label","ghs-label-attribute"],[1,"apply",3,"click"],["src","./assets/images/check.svg"]],template:function(i,e){1&i&&(t.j41(0,"div",1),t.Z7z(1,q9,1,1,null,null,N9),t.nI1(3,"trackUUID"),t.k0s()),2&i&&(t.Y8G("ngClass",t.eq3(3,U9,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.scenario)),t.R7$(),t.Dyx(t.bMT(3,1,e.gameManager.game.scenarioRules)))},dependencies:[N.YU,it,hc,ct],styles:[".rules-dialog[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));color:var(--ghs-color-gray);font-family:var(--ghs-font-text);text-align:center}.rules-dialog[_ngcontent-%COMP%]   .hide[_ngcontent-%COMP%]{position:relative;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));color:var(--ghs-color-darkgray);cursor:pointer;display:flex;justify-content:flex-end;align-items:center;z-index:1;margin-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.rules-dialog[_ngcontent-%COMP%]   .hide[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto;margin:0 .2em;filter:var(--ghs-filter-darkgray)}.rules-dialog[_ngcontent-%COMP%]   .hide[_ngcontent-%COMP%]:hover{color:var(--ghs-color-gray)}.rules-dialog[_ngcontent-%COMP%]   .hide[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}.rules-dialog[_ngcontent-%COMP%]   .rule-dialog[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;min-height:calc(var(--ghs-unit) * 6 * var(--ghs-text-factor));margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));transition:all calc(var(--ghs-animation-speed) * .1s) ease-in-out;overflow:hidden;width:100%}.rules-dialog[_ngcontent-%COMP%]   .rule-dialog[_ngcontent-%COMP%]   .dialog-container[_ngcontent-%COMP%]{padding-bottom:0}.rules-dialog[_ngcontent-%COMP%]   .rule-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.rules-dialog[_ngcontent-%COMP%]   .rule-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;z-index:1;flex-grow:1;padding-bottom:calc(var(--ghs-unit) * 2)}.rules-dialog[_ngcontent-%COMP%]   .rule-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}.rules-dialog[_ngcontent-%COMP%]   .rule-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));height:auto;margin:0 .2em}.rules-dialog[_ngcontent-%COMP%]   .rule-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.rules-dialog[_ngcontent-%COMP%]   .rule-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.rules-dialog[_ngcontent-%COMP%]   .rule-dialog[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 2);left:calc(var(--ghs-unit) * 2);right:calc(var(--ghs-unit) * 2);bottom:calc(var(--ghs-unit) * 2);z-index:0;cursor:zoom-out}.rules-dialog[_ngcontent-%COMP%]   .rule-dialog.closed[_ngcontent-%COMP%]{padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;height:0;min-height:initial;width:100%}"]})}return a})();const K9=["nextButton"],W9=["monsterDeck"],Z9=["ghsLevel"],J9=["ghsScenario"],Q9=["monsterAttackModifierDeck"],tU=["allyAttackModifierDeck"],nU=["lootDeck"],eU=a=>({compact:a}),aU=a=>({denied:a}),iU=a=>({disabled:a}),oU=(a,r,n,i,e,o,g)=>({collapsed:a,initial:r,partial:n,full:i,"no-ally-deck":e,"no-monster-deck":o,"fade-out":g}),ca=(a,r)=>({inactive:a,denied:r}),sU=(a,r,n,i,e)=>({collapsed:a,initial:r,partial:n,full:i,"no-monster-deck":e}),pc=(a,r,n,i)=>({collapsed:a,initial:r,partial:n,full:i}),rU=(a,r,n,i,e)=>({collapsed:a,initial:r,partial:n,"partial-2":i,full:e});function cU(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.JRh(n.round())}}function lU(a,r){if(1&a&&(t.j41(0,"span",13),t.EFF(1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.SpI("\xa0(",n.totalRounds(),")")}}function gU(a,r){if(1&a&&(t.j41(0,"span",14),t.EFF(1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.JRh(n.currentTime)}}function dU(a,r){1&a&&t.nrm(0,"ghs-scenario-rules")}function hU(a,r){1&a&&t.nrm(0,"div",17)}function _U(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",23)(1,"ghs-attackmodifier-deck",24,4),t.bIt("before",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.beforeCharacterAttackModifierDeck(o.activeCharacter,e))})("after",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.afterCharacterAttackModifierDeck(o.activeCharacter,e))}),t.k0s(),t.j41(3,"div",25)(4,"span",26),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleActiveCharacterAttackModifierDeck())}),t.nrm(5,"img",27),t.k0s()()()}if(2&a){const n=t.XpG();t.xc7("width",n.activeCharacter.attackModifierDeck.active&&n.activeCharacter.attackModifierDeck.current-n.activeCharacter.attackModifierDeck.lastVisible>0?"calc(var(--ghs-unit) * "+(45+10*(n.activeCharacter.attackModifierDeck.current-n.activeCharacter.attackModifierDeck.lastVisible-1))+" * var(--ghs-text-factor) * var(--ghs-barsize))":"auto"),t.Y8G("ngClass",t.sGs(8,oU,!n.activeCharacter.attackModifierDeck.active||n.compact&&(n.gameManager.game.lootDeck.active||n.gameManager.game.challengeDeck.active),n.activeCharacter.attackModifierDeck.active&&n.activeCharacter.attackModifierDeck.current<0,n.activeCharacter.attackModifierDeck.active&&(n.activeCharacter.attackModifierDeck.current>=0&&n.activeCharacter.attackModifierDeck.current==n.activeCharacter.attackModifierDeck.lastVisible||n.activeCharacter.attackModifierDeck.bb&&n.activeCharacter.attackModifierDeck.current>=0&&!n.activeCharacter.attackModifierDeck.state),n.activeCharacter.attackModifierDeck.active&&(!n.activeCharacter.attackModifierDeck.bb&&n.activeCharacter.attackModifierDeck.current>=0&&n.activeCharacter.attackModifierDeck.current!=n.activeCharacter.attackModifierDeck.lastVisible||n.activeCharacter.attackModifierDeck.bb&&n.activeCharacter.attackModifierDeck.current>=0&&n.activeCharacter.attackModifierDeck.state),!n.hasAllyAttackModifierDeck,!n.settingsManager.settings.monsterAttackModifierDeck,n.activeCharacterFade)),t.R7$(),t.Y8G("character",n.activeCharacter)("bottom",!0)("battleGoals",!1),t.R7$(2),t.Y8G("ngClass",t.l_i(16,ca,!n.activeCharacter.attackModifierDeck.active,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.character)),t.R7$(2),t.Y8G("src",n.gameManager.characterManager.characterIcon(n.activeCharacter),t.B4B)}}function mU(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",19)(1,"ghs-attackmodifier-deck",28,5),t.bIt("before",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.beforeAllyAttackModifierDeck(e))})("after",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.afterAllyAttackModifierDeck(e))}),t.k0s(),t.j41(3,"div",25)(4,"span",26),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleActiveAllyAttackModifierDeck())}),t.EFF(5,"A"),t.k0s()()()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.s1E(5,sU,!n.gameManager.game.allyAttackModifierDeck.active||n.compact&&(n.gameManager.game.lootDeck.active||n.gameManager.game.challengeDeck.active),n.gameManager.game.allyAttackModifierDeck.active&&n.gameManager.game.allyAttackModifierDeck.current<0,n.gameManager.game.allyAttackModifierDeck.active&&n.gameManager.game.allyAttackModifierDeck.current>=0&&n.gameManager.game.allyAttackModifierDeck.current==n.gameManager.game.allyAttackModifierDeck.lastVisible,n.gameManager.game.allyAttackModifierDeck.active&&n.gameManager.game.allyAttackModifierDeck.current>=0&&n.gameManager.game.allyAttackModifierDeck.current!=n.gameManager.game.allyAttackModifierDeck.lastVisible,!n.settingsManager.settings.monsterAttackModifierDeck)),t.R7$(),t.Y8G("deck",n.gameManager.game.allyAttackModifierDeck)("ally",!0)("bottom",!0),t.R7$(2),t.Y8G("ngClass",t.l_i(11,ca,!n.gameManager.game.allyAttackModifierDeck.active,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.attackModifiers))}}function pU(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",20,6)(2,"ghs-attackmodifier-deck",29,7),t.bIt("before",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.beforeMonsterAttackModifierDeck(e))})("after",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.afterMonsterAttackModifierDeck(e))}),t.k0s(),t.j41(4,"div",25)(5,"span",26),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleActiveMonsterAttackModifierDeck())}),t.EFF(6,"m"),t.k0s()()()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.ziG(4,pc,!n.gameManager.game.monsterAttackModifierDeck.active||n.compact&&(n.gameManager.game.lootDeck.active||n.gameManager.game.challengeDeck.active),n.gameManager.game.monsterAttackModifierDeck.active&&n.gameManager.game.monsterAttackModifierDeck.current<0,n.gameManager.game.monsterAttackModifierDeck.active&&(n.gameManager.game.monsterAttackModifierDeck.current>=0&&n.gameManager.game.monsterAttackModifierDeck.current==n.gameManager.game.monsterAttackModifierDeck.lastVisible||n.gameManager.game.monsterAttackModifierDeck.bb&&n.gameManager.game.monsterAttackModifierDeck.current>=0),n.gameManager.game.monsterAttackModifierDeck.active&&(!n.gameManager.game.monsterAttackModifierDeck.bb&&n.gameManager.game.monsterAttackModifierDeck.current>=0&&n.gameManager.game.monsterAttackModifierDeck.current!=n.gameManager.game.monsterAttackModifierDeck.lastVisible||n.gameManager.game.monsterAttackModifierDeck.bb&&n.gameManager.game.monsterAttackModifierDeck.current>=0&&n.gameManager.game.monsterAttackModifierDeck.state))),t.R7$(2),t.Y8G("deck",n.gameManager.game.monsterAttackModifierDeck)("bottom",!0),t.R7$(2),t.Y8G("ngClass",t.l_i(9,ca,!n.gameManager.game.monsterAttackModifierDeck.active,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.attackModifiers))}}function uU(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",21)(1,"ghs-loot-deck",30,8),t.bIt("before",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.beforeLootDeck(e))})("after",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.afterLootDeck(e))}),t.k0s(),t.j41(3,"div",25)(4,"span",26),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleLootDeck())}),t.nrm(5,"img",31),t.k0s()()()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.ziG(4,pc,!n.gameManager.game.lootDeck.active,n.gameManager.game.lootDeck.active&&n.gameManager.game.lootDeck.current<0,n.gameManager.game.lootDeck.active&&0==n.gameManager.game.lootDeck.current,n.gameManager.game.lootDeck.active&&n.gameManager.game.lootDeck.current>0)),t.R7$(),t.Y8G("deck",n.gameManager.game.lootDeck)("bottom",!0),t.R7$(2),t.Y8G("ngClass",t.l_i(9,ca,!n.gameManager.game.lootDeck.active,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.attackModifiers))}}function fU(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",22)(1,"ghs-challenge-deck",30),t.bIt("before",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.beforeChallengeDeck(e))})("after",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.afterChallengeDeck(e))}),t.k0s(),t.j41(2,"div",25)(3,"span",26),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleChallengeDeck())}),t.nrm(4,"img",32),t.k0s()()()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.s1E(4,rU,!n.gameManager.game.challengeDeck.active,n.gameManager.game.challengeDeck.active&&n.gameManager.game.challengeDeck.current<=n.gameManager.game.challengeDeck.finished,n.gameManager.game.challengeDeck.current>n.gameManager.game.challengeDeck.finished,n.gameManager.game.challengeDeck.current>n.gameManager.game.challengeDeck.finished+1,n.gameManager.game.challengeDeck.active&&n.gameManager.game.challengeDeck.current>n.gameManager.game.challengeDeck.finished+2)),t.R7$(),t.Y8G("deck",n.gameManager.game.challengeDeck)("bottom",!0),t.R7$(),t.Y8G("ngClass",t.l_i(10,ca,!n.gameManager.game.challengeDeck.active,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.scenario))}}let CU=(()=>{class a{elementRef;dialog;overlay;ghsManager;nextButton;monsterDeck;ghsLevel;ghsScenario;monsterAttackModifierDeck;allyAttackModifierDeck;lootDeck;gameManager=s.E;settingsManager=p.f;GameState=D.mk;currentTime="";hasAllyAttackModifierDeck=!1;lootDeckEnabeld=!1;activeCharacter;activeCharacterFade=!1;compact=!1;nextHint=!1;constructor(n,i,e,o){this.elementRef=n,this.dialog=i,this.overlay=e,this.ghsManager=o}ngOnInit(){this.hasAllyAttackModifierDeck=p.f.settings.allyAttackModifierDeck&&(p.f.settings.alwaysAllyAttackModifierDeck||s.E.fhRules()&&s.E.game.figures.some(n=>n instanceof b.R&&(n.isAlly||n.isAllied)||n instanceof ft.$e&&n.objectiveId&&s.E.objectiveManager.objectiveDataByObjectiveIdentifier(n.objectiveId)?.allyDeck)||s.E.game.scenario&&s.E.game.scenario.allyDeck)||!1,this.lootDeckEnabeld=p.f.settings.lootDeck&&Object.keys(s.E.game.lootDeck.cards).length>0,this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.hasAllyAttackModifierDeck=p.f.settings.allyAttackModifierDeck&&(p.f.settings.alwaysAllyAttackModifierDeck||s.E.fhRules()&&s.E.game.figures.some(i=>i instanceof b.R&&(i.isAlly||i.isAllied)||i instanceof ft.$e&&i.objectiveId&&s.E.objectiveManager.objectiveDataByObjectiveIdentifier(i.objectiveId)?.allyDeck)||s.E.game.scenario&&s.E.game.scenario.allyDeck)||!1,this.lootDeckEnabeld=p.f.settings.lootDeck&&Object.keys(s.E.game.lootDeck.cards).length>0;const n=p.f.settings.characterAttackModifierDeckActiveBottom?s.E.game.figures.find(i=>i instanceof H.K&&(i.attackModifierDeckVisible||s.E.bbRules())):void 0;p.f.settings.animations&&(this.activeCharacter&&!n||!this.activeCharacter&&n)?(this.activeCharacterFade=!0,n&&(this.activeCharacter=n),setTimeout(()=>{n?this.activeCharacterFade=!1:this.activeCharacter=n},n?1:500*p.f.settings.animationSpeed)):(this.activeCharacter=n,this.activeCharacterFade=!n&&p.f.settings.animations)}}),setInterval(()=>{s.E.game.playSeconds++;let n=s.E.game.playSeconds;this.currentTime="",n/3600>=1&&(this.currentTime+=Math.floor(n/3600)+"h ",n%=3600),n/60>=1&&(this.currentTime+=(this.currentTime&&this.currentTime&&Math.floor(n/60)<10?"0":"")+Math.floor(n/60)+"m ",n%=60),this.currentTime+=(this.currentTime&&n<10?"0":"")+Math.floor(n)+"s",(new Date).getTime()/1e3-s.E.stateManager.lastSaveTimestamp/1e3>30&&s.E.stateManager.saveLocal()},1e3),setTimeout(()=>{this.compact=this.monsterDeck&&this.monsterDeck.nativeElement.clientWidth>.3*this.elementRef.nativeElement.clientWidth},100),window.addEventListener("resize",n=>{this.compact=this.monsterDeck&&this.monsterDeck.nativeElement.clientWidth>.3*this.elementRef.nativeElement.clientWidth})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}next(n=!1){!n&&this.disabled()?(this.nextHint=!0,this.dialog.open(VG,{panelClass:["dialog"],positionStrategy:this.overlay.position().flexibleConnectedTo(this.nextButton).withPositions([new qt.uH({originX:"end",originY:"bottom"},{overlayX:"start",overlayY:"bottom"})]).withDefaultOffsetX(10).withDefaultOffsetY(-10)}).closed.subscribe({next:e=>{this.nextHint=!1,e&&this.nextState()}})):this.nextState()}nextState(){var n=this;return(0,I.A)(function*(){if(s.E.stateManager.before(s.E.game.state==D.mk.next?"nextRound":"draw"),s.E.game.state==D.mk.next)if(p.f.settings.turnConfirmation){const i=s.E.game.figures.find(e=>e.active&&!e.off);!n.activeHint()&&i&&s.E.roundManager.afterTurn(i)}else{let i=s.E.game.figures.find(e=>s.E.gameplayFigure(e)&&!e.off);for(;i;)s.E.roundManager.toggleFigure(i),i=s.E.game.figures.find(e=>s.E.gameplayFigure(e)&&!e.off)}s.E.roundManager.nextGameState(),s.E.stateManager.after(1e3)})()}beforeMonsterAttackModifierDeck(n){s.E.stateManager.before("updateAttackModifierDeck."+n.type,"monster",...n.values)}afterMonsterAttackModifierDeck(n){s.E.game.monsterAttackModifierDeck=n.deck,s.E.stateManager.after()}beforeAllyAttackModifierDeck(n){s.E.stateManager.before("updateAttackModifierDeck."+n.type,"ally",...n.values)}afterAllyAttackModifierDeck(n){s.E.game.allyAttackModifierDeck=n.deck,s.E.stateManager.after()}beforeCharacterAttackModifierDeck(n,i){s.E.stateManager.before("updateAttackModifierDeck."+i.type,s.E.characterManager.characterName(n),...i.values)}afterCharacterAttackModifierDeck(n,i){n.attackModifierDeck=i.deck,s.E.stateManager.after()}beforeLootDeck(n){s.E.stateManager.before(n.type,...n.values)}afterLootDeck(n){s.E.game.lootDeck=n.deck,s.E.stateManager.after()}beforeChallengeDeck(n){s.E.stateManager.before(n.type,...n.values)}afterChallengeDeck(n){s.E.game.challengeDeck=n.deck,s.E.stateManager.after()}confirmTurns(){s.E.game.figures.forEach(n=>s.E.roundManager.afterTurn(n)),this.next(!0)}finishScenario(n){if(s.E.game.scenario){const i=s.E.sectionData(s.E.game.scenario.edition).filter(e=>!!s.E.game.scenario&&e.edition==s.E.game.scenario.edition&&e.parent==s.E.game.scenario.index&&e.group==s.E.game.scenario.group&&e.conclusion&&0==s.E.scenarioManager.getRequirements(e).length);0!=i.length&&n?this.dialog.open(Xn,{panelClass:["dialog"],data:{conclusions:i,parent:s.E.game.scenario}}).closed.subscribe({next:e=>{e&&this.dialog.open(zt,{panelClass:["dialog"],data:{scenario:s.E.game.scenario,conclusion:e,success:n}})}}):this.dialog.open(zt,{panelClass:["dialog"],data:{scenario:s.E.game.scenario,success:n}})}}resetScenario(){s.E.stateManager.before("resetScenario",...s.E.scenarioManager.scenarioUndoArgs()),s.E.roundManager.resetScenario(),s.E.stateManager.after(1e3)}empty(){return 0==s.E.game.figures.length}round(){const n=(s.E.game.round>0||s.E.game.roundResets.length>0||s.E.game.roundResetsHidden.length>0)&&s.E.game.state==D.mk.draw?1:0;return 0==s.E.game.roundResetsHidden.length?s.E.game.round+n:s.E.game.round+n+s.E.game.roundResetsHidden.reduce((i,e)=>(i||0)+(e||0))}totalRounds(){return 0==s.E.game.roundResets.length?0:s.E.game.roundResets.reduce((n,i)=>(n||0)+(i||0))+this.round()}missingInitiative(){return s.E.game.figures.some(n=>p.f.settings.initiativeRequired&&(n instanceof H.K&&s.E.entityManager.isAlive(n)&&!n.absent||n instanceof ft.$e)&&n.getInitiative()<=0)}active(){return null!=s.E.game.figures.find(n=>n.active&&!n.off&&(!(n instanceof H.K)||!n.absent))}battleGoals(){return!this.missingInitiative()&&p.f.settings.battleGoals&&p.f.settings.battleGoalsReminder&&null!=s.E.game.scenario&&s.E.roundManager.firstRound&&!s.E.game.figures.every(n=>!(n instanceof H.K)||n.battleGoal||n.absent)&&!s.E.bbRules()}eventDraw(){return!this.missingInitiative()&&!p.f.settings.eventsDraw&&p.f.settings.eventsDrawReminder&&null!=s.E.game.scenario&&s.E.roundManager.firstRound&&null!=s.E.game.eventDraw}activeHint(){return this.active()&&p.f.settings.turnConfirmation&&(p.f.settings.expireConditions||p.f.settings.applyConditions)}finish(){return!1}failed(){return!this.active()&&!this.empty()&&s.E.game.figures.some(n=>n instanceof H.K)&&s.E.game.figures.every(n=>!(n instanceof H.K)||n instanceof H.K&&(n.exhausted||n.health<=0||n.absent))}disabled(){return s.E.game.state==D.mk.draw&&this.drawDisabled()||s.E.game.state==D.mk.next&&this.nextDisabled()}drawDisabled(){return this.empty()||this.missingInitiative()||this.battleGoals()||this.finish()||this.failed()||this.eventDraw()}nextDisabled(){return this.activeHint()||this.finish()||this.failed()}toggleActiveCharacterAttackModifierDeck(){this.activeCharacter&&(this.beforeCharacterAttackModifierDeck(this.activeCharacter,new mt(this.activeCharacter.attackModifierDeck,!this.activeCharacter.attackModifierDeck.active||this.compact&&s.E.game.lootDeck.active?"amDeckShow":"amDeckHide")),this.compact&&(s.E.game.lootDeck.active||s.E.game.challengeDeck.active)?(s.E.game.lootDeck.active=!1,s.E.game.challengeDeck.active=!1,this.activeCharacter.attackModifierDeck.active=!0):this.activeCharacter.attackModifierDeck.active=!this.activeCharacter.attackModifierDeck.active,this.afterCharacterAttackModifierDeck(this.activeCharacter,new mt(this.activeCharacter.attackModifierDeck,this.activeCharacter.attackModifierDeck.active?"amDeckShow":"amDeckHide")))}toggleActiveAllyAttackModifierDeck(){this.beforeAllyAttackModifierDeck(new mt(s.E.game.allyAttackModifierDeck,!s.E.game.allyAttackModifierDeck.active||this.compact&&s.E.game.lootDeck.active?"amDeckShow":"amDeckHide")),this.compact&&(s.E.game.lootDeck.active||s.E.game.challengeDeck.active)?(s.E.game.lootDeck.active=!1,s.E.game.challengeDeck.active=!1,s.E.game.allyAttackModifierDeck.active=!0):s.E.game.allyAttackModifierDeck.active=!s.E.game.allyAttackModifierDeck.active,this.afterAllyAttackModifierDeck(new mt(s.E.game.allyAttackModifierDeck,s.E.game.allyAttackModifierDeck.active?"amDeckShow":"amDeckHide"))}toggleActiveMonsterAttackModifierDeck(){this.beforeMonsterAttackModifierDeck(new mt(s.E.game.monsterAttackModifierDeck,!s.E.game.monsterAttackModifierDeck.active||this.compact&&s.E.game.lootDeck.active?"amDeckShow":"amDeckHide")),this.compact&&(s.E.game.lootDeck.active||s.E.game.challengeDeck.active)?(s.E.game.lootDeck.active=!1,s.E.game.challengeDeck.active=!1,s.E.game.monsterAttackModifierDeck.active=!0):s.E.game.monsterAttackModifierDeck.active=!s.E.game.monsterAttackModifierDeck.active,this.afterMonsterAttackModifierDeck(new mt(s.E.game.monsterAttackModifierDeck,s.E.game.monsterAttackModifierDeck.active?"amDeckShow":"amDeckHide"))}toggleLootDeck(){this.beforeLootDeck(new Lt(s.E.game.lootDeck,s.E.game.lootDeck.active?"lootDeckHide":"lootDeckShow")),s.E.game.lootDeck.active=!s.E.game.lootDeck.active,this.afterLootDeck(new Lt(s.E.game.lootDeck,s.E.game.lootDeck.active?"lootDeckShow":"lootDeckHide"))}toggleChallengeDeck(){this.beforeChallengeDeck(new Bt(s.E.game.challengeDeck,s.E.game.challengeDeck.active?"challengeDeck.hide":"challengeDeck.show")),s.E.game.challengeDeck.active=!s.E.game.challengeDeck.active,this.afterChallengeDeck(new Bt(s.E.game.challengeDeck,s.E.game.challengeDeck.active?"challengeDeck.show":"challengeDeck.hide"))}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT),t.rXU(O.lG),t.rXU(qt.hJ),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-footer"]],viewQuery:function(i,e){if(1&i&&(t.GBs(K9,5),t.GBs(W9,5),t.GBs(Z9,5),t.GBs(J9,5),t.GBs(Q9,5),t.GBs(tU,5),t.GBs(nU,5)),2&i){let o;t.mGM(o=t.lsd())&&(e.nextButton=o.first),t.mGM(o=t.lsd())&&(e.monsterDeck=o.first),t.mGM(o=t.lsd())&&(e.ghsLevel=o.first),t.mGM(o=t.lsd())&&(e.ghsScenario=o.first),t.mGM(o=t.lsd())&&(e.monsterAttackModifierDeck=o.first),t.mGM(o=t.lsd())&&(e.allyAttackModifierDeck=o.first),t.mGM(o=t.lsd())&&(e.lootDeck=o.first)}},standalone:!1,decls:26,vars:23,consts:[["nextButton",""],["button",""],["ghsScenario",""],["ghsLevel",""],["characterAttackModifierDeckElement",""],["allyAttackModifierDeck",""],["monsterDeck",""],["monsterAttackModifierDeck",""],["lootDeck",""],[3,"ngClass"],["tabclick","",1,"round-container",3,"click","autoBlur","ngClass"],[3,"ghs-label"],[1,"round"],[1,"total-rounds"],[1,"time"],[1,"flex-shrink"],[1,"level-container"],[1,"attack-modifier-spacer"],[1,"deck","am-deck","character-deck",3,"ngClass","width"],[1,"deck","am-deck","ally-deck",3,"ngClass"],[1,"deck","am-deck","monster-deck",3,"ngClass"],[1,"deck","loot-deck",3,"ngClass"],[1,"deck","challenge-deck",3,"ngClass"],[1,"deck","am-deck","character-deck",3,"ngClass"],[3,"before","after","character","bottom","battleGoals"],[1,"active-toggle",3,"ngClass"],[1,"numeration",3,"click"],[3,"src"],["numeration","A",3,"before","after","deck","ally","bottom"],["numeration","m",3,"before","after","deck","bottom"],[3,"before","after","deck","bottom"],["src","./assets/images/fh/loot-token.png"],["src","./assets/images/fh/challenges/challenge.png"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"footer",9)(1,"div",9)(2,"div",10,0),t.bIt("click",function(){return c.eBV(o),c.Njj(e.next())}),t.j41(4,"a"),t.nrm(5,"span",11),t.k0s(),t.j41(6,"span",12),t.nVh(7,cU,2,1,"span"),t.nVh(8,lU,2,1,"span",13),t.k0s(),t.nVh(9,gU,2,1,"span",14),t.nrm(10,"span",null,1),t.k0s()(),t.nrm(12,"div",15),t.j41(13,"div",16),t.nrm(14,"ghs-scenario",null,2)(16,"ghs-level",null,3),t.k0s(),t.nVh(18,dU,1,0,"ghs-scenario-rules"),t.nrm(19,"div",15),t.nVh(20,hU,1,0,"div",17),t.nVh(21,_U,6,19,"div",18),t.nVh(22,mU,6,14,"div",19),t.nVh(23,pU,7,12,"div",20),t.nVh(24,uU,6,12,"div",21),t.nVh(25,fU,5,13,"div",22),t.k0s()}2&i&&(t.HbH(e.settingsManager.settings.theme),t.Y8G("ngClass",t.eq3(17,eU,e.compact)),t.R7$(),t.Y8G("ngClass",t.eq3(19,aU,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.round)),t.R7$(),t.Y8G("autoBlur",!0)("ngClass",t.eq3(21,iU,e.disabled())),t.R7$(3),t.Y8G("ghs-label",e.gameManager.game.state==e.GameState.next?"round.next":"round.draw"),t.R7$(2),t.vxM(e.round()>0?7:-1),t.R7$(),t.vxM(e.totalRounds()>0?8:-1),t.R7$(),t.vxM(e.gameManager.game.scenario?9:-1),t.R7$(9),t.vxM(e.settingsManager.settings.scenarioRules?18:-1),t.R7$(2),t.vxM(e.settingsManager.settings.monsterAttackModifierDeck||e.hasAllyAttackModifierDeck?20:-1),t.R7$(),t.vxM(e.activeCharacter?21:-1),t.R7$(),t.vxM(e.hasAllyAttackModifierDeck?22:-1),t.R7$(),t.vxM(e.settingsManager.settings.monsterAttackModifierDeck?23:-1),t.R7$(),t.vxM(e.settingsManager.settings.lootDeck&&(e.lootDeckEnabeld||e.settingsManager.settings.alwaysLootDeck||e.gameManager.fhRules())?24:-1),t.R7$(),t.vxM(e.settingsManager.settings.fhChallenges&&e.gameManager.challengesManager.enabled?25:-1))},dependencies:[N.YU,ye,Mr,it,_T,Hi,Y9,H9,Ft],styles:['footer[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 11 * var(--ghs-text-factor) * var(--ghs-barsize));display:flex;position:relative}footer[_ngcontent-%COMP%]   .flex-shrink[_ngcontent-%COMP%]{flex-basis:100%;flex-shrink:1}footer[_ngcontent-%COMP%]   .attack-modifier-spacer[_ngcontent-%COMP%]{height:100%;width:calc(var(--ghs-unit) * 38 * var(--ghs-text-factor) * var(--ghs-barsize));flex-shrink:0}footer[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]{transition:transform calc(var(--ghs-animation-speed) * .5s) ease-in-out;min-width:calc(var(--ghs-unit) * 50 * var(--ghs-text-factor) * var(--ghs-barsize));max-width:95vw;height:calc(var(--ghs-unit) * 16 * var(--ghs-text-factor) * var(--ghs-barsize));display:flex;justify-content:flex-start;align-items:flex-start}footer[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor) * var(--ghs-barsize));left:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor) * var(--ghs-barsize));height:calc(var(--ghs-unit) * 8 * var(--ghs-text-factor) * var(--ghs-barsize));right:0;border:calc(var(--ghs-unit) * .3 * var(--ghs-text-factor) * var(--ghs-barsize)) solid var(--ghs-color-gray);background-color:var(--ghs-color-darkgray);border-radius:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor) * var(--ghs-barsize))}footer[_ngcontent-%COMP%]   .deck.initial[_ngcontent-%COMP%]{transform:translate(58%)}footer[_ngcontent-%COMP%]   .deck.partial[_ngcontent-%COMP%]{transform:translate(26.5%)}footer[_ngcontent-%COMP%]   .deck.full[_ngcontent-%COMP%]{transform:translate(3%)}footer[_ngcontent-%COMP%]   .deck.collapsed[_ngcontent-%COMP%]{transform:translate(calc(100% - var(--ghs-unit) * 5 * var(--ghs-text-factor) * var(--ghs-barsize)));overflow:visible}footer[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor) * var(--ghs-barsize));margin-left:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor) * var(--ghs-barsize));width:calc(var(--ghs-unit) * 37.5 * var(--ghs-text-factor) * var(--ghs-barsize));height:calc(var(--ghs-unit) * 10 * var(--ghs-text-factor) * var(--ghs-barsize));z-index:1}footer[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]{cursor:pointer;position:absolute;left:0;top:calc(var(--ghs-unit) * 3.75 * var(--ghs-text-factor) * var(--ghs-barsize));width:calc(var(--ghs-unit) * 5.5 * var(--ghs-text-factor) * var(--ghs-barsize));height:calc(var(--ghs-unit) * 5.5 * var(--ghs-text-factor) * var(--ghs-barsize));z-index:2;transition:transform calc(var(--ghs-animation-speed) * .5s) ease-in-out;transform:scale(1)}footer[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   .active-toggle.inactive[_ngcontent-%COMP%]{transform:scale(1.3)}footer[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]:hover{filter:brightness(.7) grayscale(.3)}footer[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]:active, footer[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]:focus{filter:none}footer[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]   .numeration[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);display:flex;justify-content:center;position:absolute;color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor) * var(--ghs-barsize));line-height:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor) * var(--ghs-barsize));width:100%;height:100%;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-character-icon.83c1ab396221d56b.png)}footer[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]   .numeration[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:60%;width:auto;align-self:center}footer[_ngcontent-%COMP%]   .character-deck[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .ally-deck[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .monster-deck[_ngcontent-%COMP%]{position:fixed;right:0}footer[_ngcontent-%COMP%]   .character-deck[_ngcontent-%COMP%]{bottom:calc(var(--ghs-unit) * 24.5 * var(--ghs-text-factor) * var(--ghs-barsize));z-index:1}footer[_ngcontent-%COMP%]   .character-deck.fade-out[_ngcontent-%COMP%]{transform:translate(120%)}footer[_ngcontent-%COMP%]   .ally-deck[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .character-deck.no-ally-deck[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .character-deck.no-monster-deck[_ngcontent-%COMP%]{bottom:calc(var(--ghs-unit) * 11 * var(--ghs-text-factor) * var(--ghs-barsize));z-index:2}footer[_ngcontent-%COMP%]   .monster-deck[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .ally-deck.no-monster-deck[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .character-deck.no-monster-deck.no-ally-deck[_ngcontent-%COMP%]{bottom:calc(var(--ghs-unit) * -2.5 * var(--ghs-text-factor) * var(--ghs-barsize));z-index:3}footer[_ngcontent-%COMP%]   .loot-deck[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck[_ngcontent-%COMP%]{position:fixed;left:0;bottom:calc(var(--ghs-unit) * 8.5 * var(--ghs-text-factor) * var(--ghs-barsize));z-index:2;justify-content:flex-end;overflow:visible;min-width:calc(var(--ghs-unit) * 40 * var(--ghs-text-factor) * var(--ghs-barsize))}footer[_ngcontent-%COMP%]   .loot-deck[_ngcontent-%COMP%]:before, footer[_ngcontent-%COMP%]   .challenge-deck[_ngcontent-%COMP%]:before{right:calc(var(--ghs-unit) * -2.5 * var(--ghs-text-factor) * var(--ghs-barsize));left:calc(var(--ghs-unit) * -5 * var(--ghs-text-factor) * var(--ghs-barsize))}footer[_ngcontent-%COMP%]   .loot-deck.initial[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck.initial[_ngcontent-%COMP%]{transform:translate(-59%)}footer[_ngcontent-%COMP%]   .loot-deck.partial[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck.partial[_ngcontent-%COMP%]{transform:translate(-17%)}footer[_ngcontent-%COMP%]   .loot-deck.full[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck.full[_ngcontent-%COMP%]{transform:none}footer[_ngcontent-%COMP%]   .loot-deck.collapsed[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck.collapsed[_ngcontent-%COMP%]{transform:translate(-100%)}footer[_ngcontent-%COMP%]   .loot-deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]{left:initial;right:calc(var(--ghs-unit) * -5 * var(--ghs-text-factor) * var(--ghs-barsize));z-index:3}footer[_ngcontent-%COMP%]   .loot-deck.loot-deck[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck.loot-deck[_ngcontent-%COMP%]{z-index:2}footer[_ngcontent-%COMP%]   .loot-deck.challenge-deck[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck.challenge-deck[_ngcontent-%COMP%]{bottom:calc(var(--ghs-unit) * 32.5 * var(--ghs-text-factor) * var(--ghs-barsize));z-index:1}footer[_ngcontent-%COMP%]   .loot-deck.challenge-deck.initial[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck.challenge-deck.initial[_ngcontent-%COMP%]{transform:translate(-69.5%)}footer[_ngcontent-%COMP%]   .loot-deck.challenge-deck.partial[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck.challenge-deck.partial[_ngcontent-%COMP%]{transform:translate(-37.5%)}footer[_ngcontent-%COMP%]   .loot-deck.challenge-deck.partial-2[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck.challenge-deck.partial-2[_ngcontent-%COMP%]{transform:translate(-17%)}footer[_ngcontent-%COMP%]   .loot-deck.challenge-deck.full[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck.challenge-deck.full[_ngcontent-%COMP%]{transform:none}footer[_ngcontent-%COMP%]   .loot-deck.challenge-deck.collapsed[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck.challenge-deck.collapsed[_ngcontent-%COMP%]{transform:translate(-100%)}footer[_ngcontent-%COMP%]   ghs-loot-deck[_ngcontent-%COMP%]{position:relative;margin-top:calc(var(--ghs-unit) * 1.9 * var(--ghs-text-factor) * var(--ghs-barsize));width:calc(var(--ghs-unit) * 37.5 * var(--ghs-text-factor) * var(--ghs-barsize));height:calc(var(--ghs-unit) * 10 * var(--ghs-text-factor) * var(--ghs-barsize));z-index:1}footer[_ngcontent-%COMP%]   ghs-challenge-deck[_ngcontent-%COMP%]{position:relative;margin-top:calc(var(--ghs-unit) * 1.6 * var(--ghs-text-factor) * var(--ghs-barsize));width:calc(var(--ghs-unit) * 50 * var(--ghs-text-factor) * var(--ghs-barsize));height:calc(var(--ghs-unit) * 10 * var(--ghs-text-factor) * var(--ghs-barsize));z-index:1}footer[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:0;left:0;width:100%;height:100%;background-image:url(bar.e331a4ef847b1c19.jpg);background-size:100% 105%;background-position:bottom right;background-repeat:no-repeat;transform:scale(-1);z-index:-1}footer.fh[_ngcontent-%COMP%]:before{background-image:url(bar.56898105bfacea25.jpg)}footer.modern[_ngcontent-%COMP%]:before{background-image:url(dialog_background_modern.c233015926c13e5e.png)}footer.bb[_ngcontent-%COMP%]:before{background-image:url(bar.aaa276b0e222bb54.jpg)}footer.modern[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:0;left:0;width:100%;height:4%;background:linear-gradient(90deg,var(--ghs-color-darkgray) 0%,var(--ghs-color-white) 35%,var(--ghs-color-white) 65%,var(--ghs-color-darkgray) 100%);opacity:.2}footer[_ngcontent-%COMP%]   .round-container[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;align-items:center;justify-content:center;width:calc(var(--ghs-unit) * 15 * var(--ghs-text-factor) * var(--ghs-barsize));word-wrap:break-word;text-align:center}footer[_ngcontent-%COMP%]   .round-container[_ngcontent-%COMP%]:focus-visible{border:none;outline:none}footer[_ngcontent-%COMP%]   .round-container[_ngcontent-%COMP%]:focus-visible   a[_ngcontent-%COMP%]{filter:var(--ghs-outline);color:var(--ghs-color-white)}footer[_ngcontent-%COMP%]   .round-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor) * var(--ghs-barsize));line-height:calc(var(--ghs-unit) * 3.4 * var(--ghs-text-factor) * var(--ghs-barsize));display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 11 * var(--ghs-text-factor) * var(--ghs-barsize));width:calc(var(--ghs-unit) * 12 * var(--ghs-text-factor) * var(--ghs-barsize))}footer[_ngcontent-%COMP%]   .round-container[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);position:absolute;font-size:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor) * var(--ghs-barsize));left:50%;transform:translate(-50%);bottom:calc(var(--ghs-unit) * .2 * var(--ghs-text-factor) * var(--ghs-barsize))}footer[_ngcontent-%COMP%]   .round-container[_ngcontent-%COMP%]   .round[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);position:absolute;font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor) * var(--ghs-barsize));left:calc(var(--ghs-unit) * 12 * var(--ghs-text-factor) * var(--ghs-barsize));bottom:0}footer[_ngcontent-%COMP%]   .round-container[_ngcontent-%COMP%]   .round[_ngcontent-%COMP%]   .total-rounds[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor) * var(--ghs-barsize))}footer[_ngcontent-%COMP%]   .round-container[_ngcontent-%COMP%]:hover   a[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .round-container[_ngcontent-%COMP%]:hover   .round[_ngcontent-%COMP%]{color:var(--ghs-color-white)}footer[_ngcontent-%COMP%]   .round-container.disabled[_ngcontent-%COMP%]{cursor:help}footer[_ngcontent-%COMP%]   ghs-scenario-rules[_ngcontent-%COMP%]{position:absolute;left:50%;bottom:calc(var(--ghs-unit) * 11 * var(--ghs-text-factor) * var(--ghs-barsize));transform:translate(-50%);z-index:3}footer[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;flex-shrink:0;max-width:calc(100% - var(--ghs-unit) * 15 * var(--ghs-text-factor) * var(--ghs-barsize) - var(--ghs-unit) * 38 * var(--ghs-text-factor) * var(--ghs-barsize))}footer[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   ghs-scenario[_ngcontent-%COMP%]{height:100%}footer[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   ghs-level[_ngcontent-%COMP%]{height:100%;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor) * var(--ghs-barsize));margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor) * var(--ghs-barsize))}footer.compact[_ngcontent-%COMP%]   .attack-modifier-spacer[_ngcontent-%COMP%]{display:none}footer.compact[_ngcontent-%COMP%]   .character-deck[_ngcontent-%COMP%]{bottom:calc(var(--ghs-unit) * 35.4 * var(--ghs-text-factor) * var(--ghs-barsize))}footer.compact[_ngcontent-%COMP%]   .ally-deck[_ngcontent-%COMP%], footer.compact[_ngcontent-%COMP%]   .character-deck.no-ally-deck[_ngcontent-%COMP%], footer.compact[_ngcontent-%COMP%]   .character-deck.no-monster-deck[_ngcontent-%COMP%]{bottom:calc(var(--ghs-unit) * 22 * var(--ghs-text-factor) * var(--ghs-barsize))}footer.compact[_ngcontent-%COMP%]   .monster-deck[_ngcontent-%COMP%], footer.compact[_ngcontent-%COMP%]   .ally-deck.no-monster-deck[_ngcontent-%COMP%], footer.compact[_ngcontent-%COMP%]   .character-deck.no-monster-deck.no-ally-deck[_ngcontent-%COMP%]{bottom:calc(var(--ghs-unit) * 9.5 * var(--ghs-text-factor) * var(--ghs-barsize))}footer.compact[_ngcontent-%COMP%]   ghs-scenario-rules[_ngcontent-%COMP%]{width:100%}footer.compact[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]{--ghs-text-factor: 1.6;max-width:initial;flex-grow:1;max-width:calc(100% - var(--ghs-unit) * 12.5 * var(--ghs-text-factor) * var(--ghs-barsize))}footer.compact[_ngcontent-%COMP%]   .flex-shrink[_ngcontent-%COMP%]{flex-basis:0}']})}return a})();const uc=a=>({"has-more":a}),fc=a=>[a],MU=(a,r)=>[a,r],vU=(a,r)=>r._trackUUID;function OU(a,r){if(1&a&&(t.j41(0,"div",6),t.nrm(1,"span",9),t.nI1(2,"ghsDurationLabel"),t.k0s()),2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(5,uc,n.gameClock.length>1)),t.R7$(),t.Y8G("ghs-label","duration.gameClock.current")("ghs-label-args",t.eq3(7,fc,t.bMT(2,3,n.current)))}}function PU(a,r){if(1&a&&(t.j41(0,"div",6),t.nrm(1,"span",9),t.nI1(2,"ghsDurationLabel"),t.k0s()),2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(5,uc,n.gameClock.length>1)),t.R7$(),t.Y8G("ghs-label","duration.gameClock.total")("ghs-label-args",t.eq3(7,fc,t.bMT(2,3,n.total)))}}function bU(a,r){if(1&a&&(t.nrm(0,"span",9),t.nI1(1,"date"),t.nI1(2,"ghsDurationLabel")),2&a){const n=t.XpG().$implicit,i=t.XpG();t.Y8G("ghs-label","duration.gameClock.timestamp")("ghs-label-args",t.l_i(9,MU,t.ii3(1,2,n.clockIn,"short",i.timeZone,i.settingsManager.settings.locale)||"",t.bMT(2,7,(n.clockOut-n.clockIn)/1e3)))}}function kU(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",10),t.bIt("doubleClick",function(){const e=c.eBV(n).$index,o=t.XpG();return c.Njj(o.merge(e))}),t.nVh(1,bU,3,12,"span",9),t.k0s()}if(2&a){const n=r.$implicit;t.R7$(),t.vxM(n.clockOut?1:-1)}}function yU(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",11),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.more())}),t.k0s()}2&a&&t.Y8G("ghs-label","duration.gameClock.more")}let xU=(()=>{class a{gameManager=s.E;settingsManager=p.f;timeZone=Intl.DateTimeFormat().resolvedOptions().timeZone;gameClock=[];current;total=0;currentIntervall;constructor(){this.more()}ngOnInit(){this.currentIntervall=setInterval(()=>this.update(),1e3)}update(){this.current=this.gameClock.length&&!this.gameClock[0].clockOut?((new Date).getTime()-this.gameClock[0].clockIn)/1e3:void 0,this.total=s.E.game.gameClock.length?s.E.game.gameClock.map(n=>((n.clockOut||(new Date).getTime())-n.clockIn)/1e3).reduce((n,i)=>n+i,0):0}ngOnDestroy(){this.currentIntervall&&clearInterval(this.currentIntervall)}more(){this.gameClock.length<s.E.game.gameClock.length&&(this.gameClock=s.E.game.gameClock.slice(0,this.gameClock.length+10)),this.update()}merge(n){n>0&&(s.E.stateManager.before("gameClock.merge"),s.E.game.gameClock[n-1].clockIn=s.E.game.gameClock[n].clockIn,s.E.game.gameClock.splice(n,1),this.gameClock=s.E.game.gameClock.slice(0,this.gameClock.length-1),this.update(),s.E.stateManager.after())}toggleGameClock(){s.E.stateManager.before("gameClock."+(this.current?"clockOut":"clockIn")),s.E.toggleGameClock(),this.gameClock=s.E.game.gameClock.slice(0,this.gameClock.length+(this.current?1:0)),this.update(),s.E.stateManager.after()}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-game-clock-dialog"]],standalone:!1,decls:12,vars:8,consts:[[1,"game-clock-dialog"],[1,"title",3,"ghs-label"],[1,"control",3,"click"],[1,"ghs-svg",3,"src"],[3,"ghs-label"],[1,"timestamps"],[1,"timestamp","current",3,"ngClass"],["ghs-pointer-input","",1,"timestamp"],[1,"more",3,"ghs-label"],[3,"ghs-label","ghs-label-args"],["ghs-pointer-input","",1,"timestamp",3,"doubleClick"],[1,"more",3,"click","ghs-label"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nrm(1,"div",1),t.j41(2,"div",2),t.bIt("click",function(){return e.toggleGameClock()}),t.nrm(3,"img",3)(4,"span",4),t.k0s(),t.j41(5,"div",5),t.nVh(6,OU,3,9,"div",6),t.nVh(7,PU,3,9,"div",6),t.Z7z(8,kU,2,1,"div",7,vU),t.nI1(10,"trackUUID"),t.nVh(11,yU,1,1,"span",8),t.k0s()()),2&i&&(t.R7$(),t.Y8G("ghs-label","duration.gameClock"),t.R7$(2),t.Y8G("src","./assets/images/"+(e.current?"clock-out":"clock-in")+".svg",t.B4B),t.R7$(),t.Y8G("ghs-label","duration.gameClock."+(e.current?"clockOut":"clockIn")),t.R7$(2),t.vxM(e.current?6:-1),t.R7$(),t.vxM(e.gameManager.game.gameClock.length>1?7:-1),t.R7$(),t.Dyx(t.bMT(10,6,e.gameClock)),t.R7$(3),t.vxM(e.gameClock.length<e.gameManager.game.gameClock.length?11:-1))},dependencies:[N.YU,it,dt,N.vh,Mi,ct],styles:[".game-clock-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column}.game-clock-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;justify-content:center;color:var(--ghs-color-gray);font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.game-clock-dialog[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor)) 0;border-bottom:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray)}.game-clock-dialog[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:auto;filter:var(--ghs-filter-white);margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.game-clock-dialog[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%]:hover{opacity:.7}.game-clock-dialog[_ngcontent-%COMP%]   .timestamps[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor));overflow:auto;color:var(--ghs-color-gray);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.game-clock-dialog[_ngcontent-%COMP%]   .timestamps[_ngcontent-%COMP%]   .timestamp[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) 0}.game-clock-dialog[_ngcontent-%COMP%]   .timestamps[_ngcontent-%COMP%]   .timestamp.current[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) 0;padding:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) 0;border-bottom:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid transparent}.game-clock-dialog[_ngcontent-%COMP%]   .timestamps[_ngcontent-%COMP%]   .timestamp.current.has-more[_ngcontent-%COMP%]{border-color:var(--ghs-color-gray)}.game-clock-dialog[_ngcontent-%COMP%]   .timestamps[_ngcontent-%COMP%]   .more[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer;color:var(--ghs-color-gray)}"]})}return a})();const EU=a=>({consume:a});let wU=(()=>{class a{element;gameManager=s.E;settingsManager=p.f;GameState=D.mk;ElementState=Tt.e_;toggleElement(n=!1){const i=s.E.nextElementState(this.element,n);s.E.stateManager.before("updateElement","game.element."+this.element.type,"game.element.state."+i),this.element.state=i,s.E.stateManager.after()}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-element"]],inputs:{element:"element"},standalone:!1,decls:3,vars:4,consts:[[1,"element",3,"ngClass"],[3,"element"],[3,"singleClick","doubleClick"]],template:function(i,e){1&i&&(t.j41(0,"span",0),t.nrm(1,"ghs-element-icon",1),t.j41(2,"ghs-pointer-input",2),t.bIt("singleClick",function(){return e.toggleElement()})("doubleClick",function(){return e.toggleElement(!0)}),t.k0s()()),2&i&&(t.Y8G("ngClass",t.eq3(2,EU,e.element.state==e.ElementState.consumed||e.element.state==e.ElementState.partlyConsumed)),t.R7$(),t.Y8G("element",e.element))},dependencies:[N.YU,gc,dt],styles:["ghs-element .element{display:flex;justify-content:center;align-items:center;position:relative;width:calc(var(--ghs-unit) * 6.4 * var(--ghs-barsize));height:calc(var(--ghs-unit) * 6.4 * var(--ghs-barsize));margin:calc(var(--ghs-unit) * .5 * var(--ghs-barsize))}ghs-element .element:hover{width:calc(var(--ghs-unit) * 7.4 * var(--ghs-barsize));height:calc(var(--ghs-unit) * 7.4 * var(--ghs-barsize));margin:0}ghs-element .element ghs-pointer-input{position:absolute;top:0;left:0;width:100%;height:100%}ghs-element .element ghs-element-icon{position:absolute;top:0;left:0;width:100%;height:100%}ghs-element .element .element-svg #outline{display:none}ghs-element .element .element-svg #outline path,ghs-element .element .element-svg #symbol path{fill:var(--ghs-color-gray)!important}ghs-element .element .element-svg.dark #bg{fill:#203184!important}ghs-element .element:hover .element-svg #outline,ghs-element .element:hover .element-svg #symbol,ghs-element .element .element-svg.new #outline,ghs-element .element .element-svg.new #symbol,ghs-element .element .element-svg.full #outline,ghs-element .element .element-svg.full #symbol,ghs-element .element .element-svg.always #outline,ghs-element .element .element-svg.always #symbol,ghs-element .element .element-svg.half #outline,ghs-element .element .element-svg.half #symbol{display:inherit}ghs-element .element:hover .element-svg #outline path,ghs-element .element:hover .element-svg #symbol path,ghs-element .element .element-svg.new #outline path,ghs-element .element .element-svg.new #symbol path,ghs-element .element .element-svg.full #outline path,ghs-element .element .element-svg.full #symbol path,ghs-element .element .element-svg.always #outline path,ghs-element .element .element-svg.always #symbol path,ghs-element .element .element-svg.half #outline path,ghs-element .element .element-svg.half #symbol path{fill:var(--ghs-color-white)!important}ghs-element .element:hover .element-svg.new #outline path,ghs-element .element .element-svg.new.new #outline path,ghs-element .element .element-svg.full.new #outline path,ghs-element .element .element-svg.always.new #outline path,ghs-element .element .element-svg.half.new #outline path{fill:var(--ghs-color-gray)!important}ghs-element .element:hover .element-svg{opacity:1!important}ghs-element .element:hover .element-svg #bg{opacity:1!important}ghs-element .element:hover .element-svg.new #outline path{fill:var(--ghs-color-white)!important}ghs-element .element.consume:before{opacity:.3}ghs-element .element.consume.fh:before{left:55%;top:55%;width:50%;height:50%}\n"],encapsulation:2})}return a})(),RU=(()=>{class a{dialog;gameManager=s.E;constructor(n){this.dialog=n}open(){this.dialog.open(Hn,{panelClass:["dialog-invert"]})}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-party-sheet"]],standalone:!1,decls:2,vars:3,consts:[[1,"button",3,"click","ghs-label","ghs-label-attribute"],[3,"ghs-label"]],template:function(i,e){1&i&&(t.j41(0,"a",0),t.bIt("click",function(){return e.open()}),t.nrm(1,"span",1),t.k0s()),2&i&&(t.Y8G("ghs-label","party.sheet")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label",e.gameManager.game.party.name||"party.sheet"))},dependencies:[it],styles:[".button[_ngcontent-%COMP%]{cursor:pointer;height:100%;display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-title);color:var(--ghs-color-gray);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-small-text-factor) * var(--ghs-barsize));text-shadow:var(--ghs-outline)}.button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}"]})}return a})();const jU=["mainMenuButton"],GU=["partySheet"],la=a=>({denied:a}),TU=a=>({visible:a}),SU=(a,r)=>[a,r],DU=(a,r)=>r._trackUUID;function $U(a,r){if(1&a&&t.nrm(0,"img",6),2&a){const n=t.XpG(2);t.Y8G("ghs-tooltip",n.gameManager.stateManager.serverError)("ghs-label","server.error")("ghs-label-attribute","title")}}function IU(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",10),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openMenu(e.SubMenu.server))}),t.nrm(1,"img",11),t.k0s()}2&a&&(t.Y8G("ghs-label","server.connected")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","server.connected")("ghs-label-attribute","title"))}function AU(a,r){1&a&&t.nrm(0,"img",8),2&a&&t.Y8G("ghs-label","server.connecting")("ghs-label-attribute","title")}function VU(a,r){1&a&&t.nrm(0,"img",9),2&a&&t.Y8G("ghs-label","server.closing")("ghs-label-attribute","title")}function FU(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",10),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.settingsManager.settings.serverAutoconnect?e.gameManager.stateManager.connect():e.openMenu(e.SubMenu.server))}),t.nrm(1,"img",12)(2,"img",13),t.k0s()}2&a&&(t.Y8G("ghs-label","server.reconnected")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","server.closed")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","server.closed")("ghs-label-attribute","title"))}function XU(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",10),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.settingsManager.settings.serverAutoconnect?e.gameManager.stateManager.connect():e.openMenu(e.SubMenu.server))}),t.nrm(1,"img",14),t.k0s()}2&a&&(t.Y8G("ghs-label","server.reconnected")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","server.disconnected")("ghs-label-attribute","title"))}function BU(a,r){if(1&a&&(t.nVh(0,$U,1,3,"img",6),t.nVh(1,IU,2,4,"a",7)(2,AU,1,2,"img",8)(3,VU,1,2,"img",9)(4,FU,3,6,"a",7)(5,XU,2,4,"a",7)),2&a){let n;const i=t.XpG();t.vxM(i.gameManager.stateManager.serverError?0:-1),t.R7$(),t.vxM((n=i.gameManager.stateManager.wsState())===i.WebSocket.OPEN?1:n===i.WebSocket.CONNECTING?2:n===i.WebSocket.CLOSING?3:n===i.WebSocket.CLOSED?4:-1===n?5:-1)}}function YU(a,r){1&a&&t.nrm(0,"img",15)}function UU(a,r){1&a&&(t.j41(0,"span",16),t.EFF(1,"\xb0"),t.k0s())}function NU(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",26),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openMenu(e.SubMenu.character_add))}),t.nrm(1,"span",27),t.k0s()}if(2&a){const n=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(2,la,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.characters))("ghs-label","hints.addCharacters")}}function zU(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",28)(1,"span",29),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openMenu(e.SubMenu.scenario))}),t.k0s()(),t.nrm(2,"span",25),t.j41(3,"a",28)(4,"span",29),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openMenu(e.SubMenu.monster_add))}),t.k0s()()}if(2&a){const n=t.XpG(3);t.Y8G("ngClass",t.eq3(5,la,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.scenario)),t.R7$(),t.Y8G("ghs-label","hints.setScenario"),t.R7$(),t.Y8G("ghs-label","or"),t.R7$(),t.Y8G("ngClass",t.eq3(7,la,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.monsters)),t.R7$(),t.Y8G("ghs-label","hints.addMonsters")}}function LU(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",26),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openMenu(e.SubMenu.monster_add))}),t.nrm(1,"span",27),t.k0s()}if(2&a){const n=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(2,la,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.monsters))("ghs-label","hints.addMonsters")}}function qU(a,r){if(1&a&&t.nrm(0,"span",25),2&a){const n=t.XpG(3);t.Y8G("ghs-label","hints."+n.hintState)}}function HU(a,r){if(1&a&&(t.j41(0,"div",17),t.nVh(1,NU,2,4,"a",24)(2,zU,5,9)(3,LU,2,4,"a",24)(4,qU,1,1,"span",25),t.k0s()),2&a){let n;const i=t.XpG(2);t.Y8G("ngClass",t.eq3(2,TU,i.init)),t.R7$(),t.vxM("characters"===(n=i.hintState)?1:"scenario"===n?2:"monsters"===n?3:4)}}function KU(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",30),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openEventEffects())}),t.nrm(1,"img",31),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("src","./assets/images/event"+(n.gameManager.game.round>0||n.gameManager.game.state==n.GameState.next?"-effects":"")+".svg",t.B4B)}}function WU(a,r){1&a&&t.nrm(0,"ghs-party-sheet",null,1)}function ZU(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",32),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openPets())}),t.nrm(1,"img",33),t.k0s()}}function JU(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",34),t.nI1(1,"ghsDurationLabel"),t.nI1(2,"ghsDurationLabel"),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openGameClockDialog())})("doubleClick",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.toggleGameClock())}),t.nrm(3,"img",31),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ghs-tooltip","duration.gameClock."+(n.lastGameClockTimestamp&&!n.lastGameClockTimestamp.clockOut?n.currentGameClock==n.overallGameClock?"running":"runningTotal":n.overallGameClock?"paused":"off"))("ghs-label-args",t.l_i(8,SU,n.overallGameClock?t.bMT(1,4,n.overallGameClock):"",n.currentGameClock?t.bMT(2,6,n.currentGameClock):""))("overlayX","center"),t.R7$(3),t.Y8G("src","./assets/images/"+(n.lastGameClockTimestamp&&!n.lastGameClockTimestamp.clockOut?"clock-out":"clock-in")+".svg",t.B4B)}}function QU(a,r){1&a&&t.nrm(0,"ghs-element",23),2&a&&t.Y8G("element",r.$implicit)}function tN(a,r){if(1&a&&(t.nVh(0,YU,1,0,"img",15),t.nVh(1,UU,2,0,"span",16),t.nVh(2,HU,5,4,"div",17),t.nrm(3,"span",18),t.nVh(4,KU,2,1,"div",19),t.nVh(5,WU,2,0,"ghs-party-sheet"),t.nVh(6,ZU,2,0,"div",20),t.nVh(7,JU,4,11,"div",21),t.nrm(8,"span",18),t.j41(9,"div",22),t.Z7z(10,QU,1,1,"ghs-element",23,DU),t.nI1(12,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.vxM(n.syncing()?0:-1),t.R7$(),t.vxM(!n.syncing()&&-99!=n.gameManager.stateManager.wsState()&&n.gameManager.game.server?1:-1),t.R7$(),t.vxM(n.settingsManager.settings.hints?2:-1),t.R7$(2),t.vxM(!n.gameManager.bbRules()&&n.gameManager.game.scenario&&(n.gameManager.characterManager.characterCount(!0)>0||n.settingsManager.settings.partySheet)?4:-1),t.R7$(),t.vxM(!n.gameManager.bbRules()&&n.settingsManager.settings.partySheet?5:-1),t.R7$(),t.vxM(n.gameManager.buildingsManager.petsEnabled?6:-1),t.R7$(),t.vxM(n.settingsManager.settings.gameClock?7:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(10,la,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.elements)),t.R7$(),t.Dyx(t.bMT(12,8,n.gameManager.game.elementBoard))}}let Cn=(()=>{class a{dialog;overlay;ghsManager;standalone=!1;connection=!1;mainMenuButton;partySheet;gameManager=s.E;settingsManager=p.f;GameState=D.mk;WebSocket=WebSocket;SubMenu=In;menuState=In.main;elements=[Tt.Hg.fire,Tt.Hg.ice,Tt.Hg.air,Tt.Hg.earth,Tt.Hg.light,Tt.Hg.dark];init=!1;hintState="";lastGameClockTimestamp;overallGameClock=0;currentGameClock=0;gameClockInterval;constructor(n,i,e){this.dialog=n,this.overlay=i,this.ghsManager=e}ngOnInit(){setTimeout(()=>{this.init=!0},p.f.settings.animations?1500*p.f.settings.animationSpeed:0),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.hintStateValue()!=this.hintState&&(this.init=!1,setTimeout(()=>{this.hintState=this.hintStateValue(),this.init=!0},p.f.settings.animations?500*p.f.settings.animationSpeed:0)),this.updateClock()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe(),this.gameClockInterval&&clearInterval(this.gameClockInterval)}syncing(){return window.document.body.classList.contains("server-sync")}hintStateValue(){return s.E.game.playerCount<1&&s.E.game.figures.every(n=>!(n instanceof H.K||n instanceof b.R))?"characters":!s.E.game.scenario&&s.E.game.figures.every(n=>!(n instanceof b.R))?"scenario":s.E.game.figures.every(n=>!(n instanceof b.R))?"monsters":s.E.game.figures.every(n=>!(n instanceof b.R)||0==n.entities.length)?"addMonsterEntities":s.E.game.figures.some(n=>n.active)?s.E.game.round<3?"active-full":"active":s.E.game.state==D.mk.draw?s.E.game.figures.some(n=>n instanceof H.K&&!n.absent&&s.E.entityManager.isAlive(n)&&p.f.settings.initiativeRequired&&n.initiative<=0)?s.E.game.round<3?"draw-full":"draw-short":"draw":s.E.game.state==D.mk.next?"next":""}openMenu(n=void 0){this.dialog.open(Zo,{panelClass:["dialog"],data:{subMenu:n??In.main,standalone:this.standalone},maxWidth:"90vw",positionStrategy:this.overlay.position().flexibleConnectedTo(this.mainMenuButton).withPositions([new qt.uH({originX:"end",originY:"top"},{overlayX:"start",overlayY:"top"})]).withDefaultOffsetX(10)})}openEventEffects(){this.dialog.open(ra,{panelClass:["dialog"],data:{menu:s.E.game.round>0||s.E.game.state==D.mk.next}})}openPets(){this.dialog.open(tc,{panelClass:["dialog"]})}updateClock(){this.lastGameClockTimestamp=s.E.game.gameClock.length?s.E.game.gameClock[0]:void 0,this.overallGameClock=s.E.game.gameClock.length?s.E.game.gameClock.map(n=>((n.clockOut||(new Date).getTime())-n.clockIn)/1e3).reduce((n,i)=>n+i,0):0,this.currentGameClock=this.lastGameClockTimestamp&&!this.lastGameClockTimestamp.clockOut?((new Date).getTime()-this.lastGameClockTimestamp.clockIn)/1e3:0,this.gameClockInterval||(this.gameClockInterval=setInterval(()=>{this.updateClock()},1e3))}openGameClockDialog(){this.dialog.open(xU,{panelClass:["dialog"]})}toggleGameClock(){s.E.stateManager.before("gameClock."+(this.lastGameClockTimestamp&&!this.lastGameClockTimestamp.clockOut?"clockOut":"clockIn")),s.E.toggleGameClock(),s.E.stateManager.after()}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG),t.rXU(qt.hJ),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-header"]],viewQuery:function(i,e){if(1&i&&(t.GBs(jU,5),t.GBs(GU,5)),2&i){let o;t.mGM(o=t.lsd())&&(e.mainMenuButton=o.first),t.mGM(o=t.lsd())&&(e.partySheet=o.first)}},inputs:{standalone:"standalone",connection:"connection"},standalone:!1,decls:7,vars:5,consts:[["mainMenuButton",""],["partySheet",""],[3,"ngClass"],[1,"main-menu"],[1,"menu-button","active-outline",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/menu.svg",1,"ghs-svg"],["src","./assets/images/warning.svg",1,"ghs-svg","server-connection","closed",3,"ghs-tooltip","ghs-label","ghs-label-attribute"],[1,"server-connection-status",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/server-connection.svg",1,"ghs-svg","server-connection","connecting",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/server-connection.svg",1,"ghs-svg","server-connection","closing",3,"ghs-label","ghs-label-attribute"],[1,"server-connection-status",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/server-connection.svg",1,"ghs-svg","server-connection","connected",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/warning.svg",1,"ghs-svg","server-connection","closed",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/server-connection.svg",1,"ghs-svg","server-connection","closed",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/server-connection.svg",1,"ghs-svg","server-connection","disconnected",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/shuffle.svg",1,"server-connection","syncing"],[1,"game-server"],[1,"hints",3,"ngClass"],[1,"spacer"],[1,"event-effects"],[1,"pets"],["ghs-pointer-input","",1,"game-clock",3,"ghs-tooltip","ghs-label-args","overlayX"],[1,"elements",3,"ngClass"],[3,"element"],[1,"menu-hint"],[3,"ghs-label"],[1,"menu-hint",3,"click"],[3,"ngClass","ghs-label"],[1,"menu-hint",3,"ngClass"],[3,"click","ghs-label"],[1,"event-effects",3,"click"],[1,"ghs-svg",3,"src"],[1,"pets",3,"click"],["src","./assets/images/fh/catching.svg",1,"ghs-svg"],["ghs-pointer-input","",1,"game-clock",3,"singleClick","doubleClick","ghs-tooltip","ghs-label-args","overlayX"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"header",2)(1,"div",3)(2,"a",4,0),t.bIt("click",function(){return c.eBV(o),c.Njj(e.openMenu())}),t.nrm(4,"img",5),t.k0s()(),t.nVh(5,BU,6,2),t.nVh(6,tN,13,12),t.k0s()}2&i&&(t.Y8G("ngClass",e.settingsManager.settings.theme),t.R7$(2),t.Y8G("ghs-label","menu.main")("ghs-label-attribute","title"),t.R7$(3),t.vxM(!e.standalone||e.connection?5:-1),t.R7$(),t.vxM(e.standalone?-1:6))},dependencies:[N.YU,wU,it,Mt,RU,dt,Mi,ct],styles:['header[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 8 * var(--ghs-text-factor) * var(--ghs-barsize));display:flex;position:relative;overflow:hidden}header[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:0;left:0;width:100%;height:100%;background-image:url(bar.e331a4ef847b1c19.jpg);background-size:100% 105%;background-position:bottom left;background-repeat:no-repeat;z-index:-1}header.fh[_ngcontent-%COMP%]:before{background-image:url(bar.56898105bfacea25.jpg)}header.modern[_ngcontent-%COMP%]:before{background-image:url(dialog_background_modern.c233015926c13e5e.png)}header.bb[_ngcontent-%COMP%]:before{background-image:url(bar.aaa276b0e222bb54.jpg)}header.modern[_ngcontent-%COMP%]:after{content:" ";position:absolute;bottom:0;left:0;width:100%;height:4%;background:linear-gradient(90deg,var(--ghs-color-darkgray) 0%,var(--ghs-color-white) 35%,var(--ghs-color-white) 65%,var(--ghs-color-darkgray) 100%);opacity:.2}header[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:relative;font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor) * var(--ghs-barsize));text-shadow:var(--ghs-outline);color:var(--ghs-color-gray);filter:var(--ghs-filter-gray);width:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor) * var(--ghs-barsize));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor) * var(--ghs-barsize));margin:calc(var(--ghs-unit) * 2.2 * var(--ghs-text-factor) * var(--ghs-barsize));cursor:pointer}header[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]:hover, header[_ngcontent-%COMP%]   .menu-button.active-button[_ngcontent-%COMP%]{color:var(--ghs-color-white);filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}header[_ngcontent-%COMP%]   a.server-connection-status[_ngcontent-%COMP%]{display:flex;cursor:pointer}header[_ngcontent-%COMP%]   .game-server[_ngcontent-%COMP%]{color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor) * var(--ghs-barsize));align-self:center;margin-top:calc(var(--ghs-unit) * -.75 * var(--ghs-text-factor) * var(--ghs-barsize));margin-left:calc(var(--ghs-unit) * -1.2 * var(--ghs-text-factor) * var(--ghs-barsize));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor) * var(--ghs-barsize))}header[_ngcontent-%COMP%]   .server-connection[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor) * var(--ghs-barsize));height:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor) * var(--ghs-barsize));margin-right:calc(var(--ghs-unit) * 1);align-self:center}header[_ngcontent-%COMP%]   .server-connection.connected[_ngcontent-%COMP%]{filter:var(--ghs-filter-green) var(--ghs-filter-shadow)}header[_ngcontent-%COMP%]   .server-connection.connecting[_ngcontent-%COMP%]{filter:var(--ghs-filter-blue) var(--ghs-filter-shadow)}header[_ngcontent-%COMP%]   .server-connection.closing[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow) var(--ghs-filter-shadow)}header[_ngcontent-%COMP%]   .server-connection.closed[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-shadow)}header[_ngcontent-%COMP%]   .server-connection.disconnected[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}header[_ngcontent-%COMP%]   .server-connection.syncing[_ngcontent-%COMP%]{filter:var(--ghs-filter-white);animation:ghs-spinning calc(var(--ghs-animation-speed) * 1.5s) linear infinite}header[_ngcontent-%COMP%]   .hints[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--ghs-color-gray);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-small-text-factor) * var(--ghs-barsize));opacity:0;transition:opacity calc(var(--ghs-animation-speed) * .5s) ease-in-out}header[_ngcontent-%COMP%]   .hints.visible[_ngcontent-%COMP%]{opacity:1}header[_ngcontent-%COMP%]   .hints[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor) * var(--ghs-barsize))}header[_ngcontent-%COMP%]   .hints[_ngcontent-%COMP%]   .menu-hint[_ngcontent-%COMP%]{cursor:pointer;font-family:var(--ghs-font-title);color:var(--ghs-color-gray);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-small-text-factor) * var(--ghs-barsize));text-shadow:var(--ghs-outline)}header[_ngcontent-%COMP%]   .hints[_ngcontent-%COMP%]   .menu-hint[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}@media (max-width: 600px),(orientation: portrait){header[_ngcontent-%COMP%]   .hints[_ngcontent-%COMP%]{flex-direction:column;justify-content:center}}header[_ngcontent-%COMP%]   .event-effects[_ngcontent-%COMP%], header[_ngcontent-%COMP%]   .pets[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;justify-content:center;height:100%;margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor) * var(--ghs-barsize))}header[_ngcontent-%COMP%]   .event-effects[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], header[_ngcontent-%COMP%]   .pets[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray);height:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor) * var(--ghs-barsize));width:auto}header[_ngcontent-%COMP%]   .event-effects[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%], header[_ngcontent-%COMP%]   .pets[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}header[_ngcontent-%COMP%]   .game-clock[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;height:100%;margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor) * var(--ghs-barsize))}header[_ngcontent-%COMP%]   .game-clock[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray);height:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor) * var(--ghs-barsize));width:auto}header[_ngcontent-%COMP%]   .game-clock[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}header[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]{display:flex;height:100%;align-items:center}header[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]   ghs-element[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * .25 * var(--ghs-barsize));width:calc(var(--ghs-unit) * 7.4 * var(--ghs-barsize));height:calc(var(--ghs-unit) * 7.4 * var(--ghs-barsize))}']})}return a})(),Ha=(()=>{class a{dialog;ghsManager;header;footer;allowed=["undo","zoom","menu"];scrollTimeout=null;zoomInterval=null;currentZoom=0;dialogOpen=!1;dialogClosing=!1;keydown;keyup;timeout;constructor(n,i){this.dialog=n,this.ghsManager=i,this.dialog.afterOpened.subscribe({next:()=>{this.dialogOpen=!0,this.dialogClosing=!1}}),this.dialog.afterAllClosed.subscribe({next:()=>{this.dialogClosing=!0,setTimeout(()=>{this.dialogClosing&&(this.dialogOpen=!1)},250)}})}applySelect(){const n=s.E.entityManager.getIndexedEntities("w"===s.E.stateManager.keyboardSelecting);s.E.stateManager.keyboardSelect>0&&s.E.stateManager.keyboardSelect<=n.length&&(this.dialog.open(ze,{panelClass:["dialog"],data:{entity:n[s.E.stateManager.keyboardSelect-1].entity,figure:n[s.E.stateManager.keyboardSelect-1].figure,entityIndexKey:!0}}),s.E.stateManager.keyboardSelecting=!1),s.E.stateManager.keyboardSelect=-1}ngOnInit(){this.currentZoom=p.f.settings.zoom,this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.currentZoom=p.f.settings.zoom}),this.keydown=window.addEventListener("keydown",n=>{if(p.f.settings.keyboardShortcuts&&(0,F.bb)(n))if(s.E.stateManager.keyboardSelecting){if("Escape"===n.key||"Backspace"===n.key||"s"===n.key||"w"===n.key)s.E.stateManager.keyboardSelect=-1,s.E.stateManager.keyboardSelecting=!1;else if("Enter"===n.key)this.applySelect();else if(n.key in["0","1","2","3","4","5","6","7","8","9"]){const i=s.E.entityManager.getIndexedEntities("w"===s.E.stateManager.keyboardSelecting),e=+n.key;this.timeout?(clearTimeout(this.timeout),this.timeout=void 0,s.E.stateManager.keyboardSelect=10*s.E.stateManager.keyboardSelect+e,this.applySelect()):10*e<i.length?(s.E.stateManager.keyboardSelect=e,this.timeout=setTimeout(()=>{this.applySelect()},1e3)):(s.E.stateManager.keyboardSelect=e,this.applySelect())}n.preventDefault(),n.stopPropagation()}else if(!this.dialogOpen||!(0,F.bb)(n)||"Backspace"!==n.key||n.ctrlKey||n.altKey||n.shiftKey)if(this.dialogOpen&&!this.allowed.includes("undo")||!n.ctrlKey||n.altKey||n.shiftKey||"z"!==n.key.toLowerCase())if((!this.dialogOpen||this.allowed.includes("undo"))&&n.ctrlKey&&!n.altKey&&!n.shiftKey&&"y"===n.key||n.ctrlKey&&n.shiftKey&&"z"===n.key.toLowerCase())s.E.stateManager.redo(),n.preventDefault();else if(this.dialogOpen&&!this.allowed.includes("zoom")||n.ctrlKey||n.altKey||n.shiftKey||this.zoomInterval||"ArrowUp"!==n.key&&"+"!==n.key)if(this.dialogOpen&&!this.allowed.includes("zoom")||n.ctrlKey||n.altKey||n.shiftKey||this.zoomInterval||"ArrowDown"!==n.key&&"-"!==n.key)if(this.dialogOpen&&!this.allowed.includes("zoom")||!n.ctrlKey||n.altKey||n.shiftKey||this.zoomInterval||"r"!==n.key.toLowerCase())if(this.dialogOpen&&!this.allowed.includes("round")||!this.footer||n.ctrlKey||n.altKey||n.shiftKey||this.zoomInterval||"n"!==n.key.toLowerCase())if(this.dialogOpen&&!this.allowed.includes("am")||n.ctrlKey||n.altKey||n.shiftKey||this.zoomInterval||s.E.game.state!=D.mk.next||"m"!==n.key.toLowerCase()&&(!p.f.settings.amAdvantage||"a"!==n.key.toLowerCase()&&"d"!==n.key.toLowerCase()))if((!this.dialogOpen||this.allowed.includes("loot"))&&s.E.game.state==D.mk.next&&!n.ctrlKey&&!n.altKey&&!n.shiftKey&&!this.zoomInterval&&"l"===n.key.toLowerCase()&&p.f.settings.lootDeck&&s.E.game.lootDeck.cards.length>0&&this.footer&&this.footer.lootDeck)this.footer.lootDeck.deck.active||this.footer.toggleLootDeck(),this.footer.lootDeck.draw(n,!0),n.preventDefault();else if(!this.dialogOpen&&!n.ctrlKey&&!n.altKey&&"Tab"===n.key&&s.E.game.figures.length>0){if(s.E.game.state==D.mk.next)this.toggleEntity(n.shiftKey);else{let i=!0;if(s.E.game.figures.filter(e=>e instanceof H.K&&!e.absent).forEach((e,o)=>{const g=document.getElementById("initiative-input-"+o);document.activeElement==g&&(i=!1)}),i){const e=document.getElementById("initiative-input-0");e&&e.focus()}n.stopPropagation()}n.preventDefault()}else if(this.dialogOpen&&!this.allowed.includes("level")||!this.footer||n.ctrlKey||n.altKey||n.shiftKey||"x"!==n.key.toLowerCase()||!this.footer.ghsLevel)if(this.dialogOpen&&!this.allowed.includes("scenario")||n.ctrlKey||n.altKey||n.shiftKey||"e"!==n.key.toLowerCase())if(this.dialogOpen&&!this.allowed.includes("scenario")||!this.footer||n.ctrlKey||n.altKey||n.shiftKey||"f"!==n.key.toLowerCase())if((!this.dialogOpen||this.allowed.includes("scenario"))&&this.footer&&!n.ctrlKey&&!n.altKey&&n.shiftKey&&"f"===n.key.toLowerCase()&&this.footer.ghsScenario&&s.E.game.scenario)this.footer.ghsScenario.open();else if(this.dialogOpen&&!this.allowed.includes("party")||n.ctrlKey||n.altKey||n.shiftKey||"p"!==n.key.toLowerCase()||!p.f.settings.partySheet)if(this.dialogOpen&&!this.allowed.includes("map")||n.ctrlKey||n.altKey||n.shiftKey||"g"!==n.key.toLowerCase()||!s.E.game.edition)if(this.dialogOpen&&!this.allowed.includes("chart")||n.ctrlKey||n.altKey||n.shiftKey||"c"!==n.key.toLowerCase()||!s.E.game.edition)if(this.dialogOpen||n.ctrlKey||n.altKey||!this.header||"Escape"!==n.key&&"Backspace"!==n.key)if(this.dialogOpen&&!this.allowed.includes("element")||n.ctrlKey||n.altKey||n.shiftKey||!["1","2","3","4","5","6"].includes(n.key))if(this.dialogOpen&&!this.allowed.includes("absent")||n.ctrlKey||n.altKey||n.shiftKey||"h"!==n.key)if(this.dialogOpen&&!this.allowed.includes("handSize")||n.ctrlKey||n.altKey||!n.shiftKey||"H"!==n.key)if(this.dialogOpen&&!this.allowed.includes("traits")||n.ctrlKey||n.altKey||n.shiftKey||"t"!==n.key)if(this.dialogOpen&&!this.allowed.includes("playerNumber")||n.ctrlKey||n.altKey||"#"!==n.key)if(this.dialogOpen&&!this.allowed.includes("damageHP")||n.ctrlKey||n.altKey||n.shiftKey||"i"!==n.key)if(this.dialogOpen&&!this.allowed.includes("select")||n.ctrlKey||n.altKey||n.shiftKey||"s"!==n.key&&"w"!==n.key)if(this.dialogOpen||n.ctrlKey||n.altKey||"?"!==n.key)if(this.dialogOpen||n.ctrlKey||!(n.altKey&&"x"===n.key||n.shiftKey&&"X"===n.key)){if(!this.dialogOpen&&!n.ctrlKey&&("l"===n.key||n.shiftKey&&"L"===n.key)){const i=s.E.game.figures.find(e=>e instanceof H.K&&e.active);if(i&&!s.E.fhRules())switch(n.key){case"l":s.E.stateManager.before("changeLoot",s.E.characterManager.characterName(i),(0,F.n1)(1)),i.loot+=1,s.E.stateManager.after();break;case"L":s.E.stateManager.before("changeLoot",s.E.characterManager.characterName(i),(0,F.n1)(-1)),i.loot-=1,i.loot<0&&(i.loot=0),s.E.stateManager.after()}}}else{const i=s.E.game.figures.find(e=>e instanceof H.K&&e.active);if(i)switch(n.key){case"x":s.E.stateManager.before("changeXP",s.E.characterManager.characterName(i),(0,F.n1)(1)),i.experience+=1,s.E.stateManager.after();break;case"X":s.E.stateManager.before("changeXP",s.E.characterManager.characterName(i),(0,F.n1)(-1)),i.experience-=1,i.experience<0&&(i.experience=0),s.E.stateManager.after()}}else this.dialog.open(No,{panelClass:["dialog"]}),n.preventDefault();else s.E.stateManager.keyboardSelecting=n.key,this.ghsManager.triggerUiChange();else p.f.toggle("damageHP"),n.preventDefault();else p.f.toggle("playerNumber"),n.preventDefault();else p.f.toggle("characterTraits"),n.preventDefault();else p.f.toggle("characterHandSize"),n.preventDefault();else p.f.toggle("hideAbsent"),n.preventDefault();else{const e=s.E.game.elementBoard[+n.key-1],o=s.E.nextElementState(e,!1,!0);s.E.stateManager.before("updateElement","game.element."+e.type,"game.element.state."+o),e.state=o,s.E.stateManager.after(),n.preventDefault()}else this.header.openMenu(),n.stopPropagation(),n.preventDefault();else this.dialogOpen&&this.dialog.closeAll(),this.dialog.open(ia,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:{edition:s.E.game.edition}}),n.stopPropagation(),n.preventDefault();else{const i=s.E.editionData.find(e=>e.edition==s.E.game.edition);i&&(i.worldMap||i.extendWorldMap)&&(this.dialogOpen&&this.dialog.closeAll(),this.dialog.open(aa,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:s.E.game.edition}),n.stopPropagation(),n.preventDefault())}else this.dialog.open(Hn,{panelClass:["dialog-invert"],data:{partySheet:!0}}),n.stopPropagation(),n.preventDefault();else p.f.toggle("fullscreen");else(p.f.settings.partySheet||s.E.characterManager.characterCount(!0)>0)&&(s.E.game.scenario&&this.header?this.header.openEventEffects():!s.E.game.scenario&&this.footer&&this.footer.ghsScenario&&this.footer.ghsScenario.open());else this.footer.ghsLevel.open();else{const i=s.E.game.figures.find(g=>g.active);let e;const o=p.f.settings.amAdvantage&&"a"===n.key.toLowerCase()?"advantage":p.f.settings.amAdvantage&&"d"===n.key.toLowerCase()?"disadvantage":void 0;if(!i||i instanceof b.R&&(!i.isAlly&&!i.isAllied||!s.E.fhRules()&&!p.f.settings.alwaysAllyAttackModifierDeck||!p.f.settings.allyAttackModifierDeck))s.E.stateManager.before("updateAttackModifierDeck.draw"+(o||""),"monster"),e=s.E.game.monsterAttackModifierDeck;else if(i instanceof b.R)s.E.stateManager.before("updateAttackModifierDeck.draw"+(o||""),"ally"),e=s.E.game.allyAttackModifierDeck;else if(i instanceof H.K)if(p.f.settings.characterAttackModifierDeck)if(p.f.settings.characterAttackModifierDeckActiveBottom&&null!=s.E.game.figures.find(g=>g instanceof H.K&&g.attackModifierDeckVisible)){const g=s.E.game.figures.find(m=>m instanceof H.K&&m.attackModifierDeckVisible);s.E.stateManager.before("updateAttackModifierDeck.draw"+(o||""),s.E.characterManager.characterName(g)),e=g.attackModifierDeck}else i.attackModifierDeckVisible?(s.E.stateManager.before("updateAttackModifierDeck.draw"+(o||""),s.E.characterManager.characterName(i)),e=i.attackModifierDeck):i.attackModifierDeckVisible=!0;else s.E.stateManager.before("updateAttackModifierDeck.draw"+(o||""),"monster"),e=s.E.game.monsterAttackModifierDeck;else if(i instanceof ft.$e)if("M"!=i.amDeck&&("A"!=i.amDeck||(s.E.fhRules(!0)||p.f.settings.alwaysAllyAttackModifierDeck)&&p.f.settings.allyAttackModifierDeck)){if("A"==i.amDeck&&p.f.settings.allyAttackModifierDeck&&(s.E.fhRules(!0)||p.f.settings.alwaysAllyAttackModifierDeck))s.E.stateManager.before("updateAttackModifierDeck.draw"+(o||""),"ally"),e=s.E.game.allyAttackModifierDeck;else if(i.amDeck){const g=s.E.game.figures.find(m=>m instanceof H.K&&m.name==i.amDeck);g&&p.f.settings.characterAttackModifierDeck?g.attackModifierDeckVisible?(s.E.stateManager.before("updateAttackModifierDeck.draw"+(o||""),s.E.characterManager.characterName(g)),e=g.attackModifierDeck):g.attackModifierDeckVisible=!0:(s.E.stateManager.before("updateAttackModifierDeck.draw"+(o||""),"monster"),e=s.E.game.monsterAttackModifierDeck)}}else s.E.stateManager.before("updateAttackModifierDeck.draw"+(o||""),"monster"),e=s.E.game.monsterAttackModifierDeck;e&&(e.active=!0,s.E.attackModifierManager.drawModifier(e,o),s.E.stateManager.after()),n.preventDefault()}else this.footer.next();else this.currentZoom=100,p.f.setZoom(this.currentZoom),document.body.style.setProperty("--ghs-factor",this.currentZoom+""),n.preventDefault();else this.zoom(1),this.zoomInterval=setInterval(()=>{this.zoom(1)},30),n.preventDefault();else this.zoom(-1),this.zoomInterval=setInterval(()=>{this.zoom(-1)},30),n.preventDefault();else s.E.stateManager.undo(),n.preventDefault();else(0,F.co)(this.dialog.openDialogs[this.dialog.openDialogs.length-1]),n.preventDefault()}),this.keyup=window.addEventListener("keyup",n=>{p.f.settings.keyboardShortcuts&&(0,F.bb)(n)&&this.zoomInterval&&("ArrowUp"===n.key||"+"===n.key||"ArrowDown"===n.key||"-"===n.key)&&(clearInterval(this.zoomInterval),this.zoomInterval=null,p.f.settings.zoom!=this.currentZoom&&p.f.setZoom(this.currentZoom),n.preventDefault())})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe(),window.removeEventListener("keydown",this.keydown),window.removeEventListener("keyup",this.keyup)}zoom(n){this.currentZoom+=n,document.body.style.setProperty("--ghs-factor",this.currentZoom+"");const i=+window.getComputedStyle(document.body).getPropertyValue("min-width").replace("px","");n<0&&i>=window.innerWidth&&(this.currentZoom-=n,document.body.style.setProperty("--ghs-factor",this.currentZoom+""))}toggleEntity(n){const i=s.E.game.figures.filter(o=>s.E.gameplayFigure(o));let e=i.find(o=>o.active);if(!e&&n)e=i[i.length-1];else if(e&&n&&i.indexOf(e)>0)if(e instanceof H.K){const o=e.summons.filter(m=>s.E.entityManager.isAlive(m)&&m.state!=_t.N5.new);let g=o.find(m=>m.active);(!g||g&&0==o.indexOf(g))&&(e.summons.forEach(m=>m.active=!1),e=i[i.indexOf(e)-1])}else e=i[i.indexOf(e)-1];if(e){if(e instanceof H.K){const g=e.summons.find(k=>k.active),m=e.summons.filter(k=>k.tags.includes("cs-skull-spirit"));p.f.settings.activeSummons&&!g&&e.active&&m.length&&!m.find(k=>k.active)?(s.E.stateManager.before("summonInactive",s.E.characterManager.characterName(e),"data.summon."+m[0].name),m.forEach(k=>k.tags.push("cs-skull-spirit-turn"))):p.f.settings.activeSummons&&e.active&&g?s.E.stateManager.before("summonInactive",s.E.characterManager.characterName(e),"data.summon."+g.name):s.E.stateManager.before(e.active?"unsetActive":"setActive",s.E.characterManager.characterName(e)),s.E.roundManager.toggleFigure(e),s.E.stateManager.after()}else if(e instanceof b.R){let g=!0;const m=e.entities.filter(k=>s.E.entityManager.isAlive(k)&&k.summon!=_t.N5.new).sort(s.E.monsterManager.sortEntities);if(p.f.settings.activeStandees){let k=m.find(X=>X.active);!k&&m.length>0&&n&&e.active?(k=m[m.length-1],s.E.stateManager.before(k?"unsetEntityActive":"setEntityActive","data.monster."+e.name,"monster."+k.type,""+k.number),s.E.monsterManager.toggleActive(e,k),k.active=!0,g=!1,s.E.stateManager.after()):k&&!n&&(s.E.stateManager.before(k?"unsetEntityActive":"setEntityActive","data.monster."+e.name,"monster."+k.type,""+k.number),s.E.monsterManager.toggleActive(e,k),m.indexOf(k)<m.length-1&&(m[m.indexOf(k)+1].active=!0),g=!1,s.E.stateManager.after())}g&&(s.E.stateManager.before(e.active?"unsetActive":"setActive","data.monster."+e.name),n&&!e.active&&p.f.settings.activeStandees&&e.entities.forEach(k=>{s.E.entityManager.isAlive(k)&&(k.active=!0,k.off=!1)}),s.E.roundManager.toggleFigure(e),s.E.stateManager.after())}else e instanceof ft.$e&&(s.E.stateManager.before(e.active?"unsetActive":"setActive",e.title||e.name),s.E.roundManager.toggleFigure(e),s.E.stateManager.after());const o=document.querySelector(".round-container");o&&(null==i.find(g=>g.active)?o.focus():o.blur())}}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG),t.rXU(st))};static \u0275dir=t.FsC({type:a,selectors:[["","ghs-keyboard-shortcuts",""]],inputs:{header:"header",footer:"footer",allowed:"allowed"},standalone:!1})}return a})();const nN=["menu"],eN=a=>({edit:a}),aN=a=>({denied:a}),iN=a=>({"has-deleted":a}),oN=(a,r,n)=>({"expanded-ability":a,"bottom-actions":r,drawn:n}),Cc=(a,r)=>({"expanded-ability":a,"bottom-actions":r}),fo=(a,r)=>r._trackUUID;function sN(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",5),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.draw())}),t.nrm(1,"span",6),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","game.cards.drawAnother"))}function rN(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",5),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.restoreDefault())}),t.nrm(1,"span",6),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","game.cards.restore"))}function cN(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",5),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.defaultSort())}),t.nrm(1,"span",6),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","game.cards.defaultSort"))}function lN(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",8),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleDrawExtra())}),t.k0s(),t.nrm(2,"span",6),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("checked",n.monster.drawExtra),t.R7$(),t.Y8G("ghs-label","game.cards.drawExtra")}}function gN(a,r){1&a&&t.nrm(0,"div",13)}function dN(a,r){1&a&&t.nrm(0,"div",18)}function hN(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",20),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG();return c.Njj(o.remove(e+o.monster.ability+1))}),t.nrm(1,"img",21),t.k0s()}}function _N(a,r){if(1&a&&(t.j41(0,"div",14),t.nrm(1,"ghs-ability",17),t.nVh(2,dN,1,0,"div",18),t.nVh(3,hN,2,0,"a",19),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG();t.Y8G("ngClass",t.sMw(7,oN,e.settingsManager.settings.showExpandedAbilityCard&&(2==e.reveal||n.revealed),e.gameManager.hasBottomAbility(n),i<e.gameManager.monsterManager.drawnAbilities(e.monster)-e.monster.ability-1)),t.R7$(),t.Y8G("ability",n)("monster",e.monster)("flipped",2==e.reveal||i<e.gameManager.monsterManager.drawnAbilities(e.monster)-e.monster.ability-1)("reveal",!0),t.R7$(),t.vxM(e.edit?2:-1),t.R7$(),t.vxM(e.edit?3:-1)}}function mN(a,r){1&a&&t.nrm(0,"div",18)}function pN(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",20),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$index,o=t.XpG();return c.Njj(o.remove(o.discardedCards.length-e-1))}),t.nrm(1,"img",21),t.k0s()}}function uN(a,r){if(1&a&&(t.j41(0,"div",14),t.nrm(1,"ghs-ability",22),t.nVh(2,mN,1,0,"div",18),t.nVh(3,pN,2,0,"a",19),t.k0s()),2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.l_i(6,Cc,i.settingsManager.settings.showExpandedAbilityCard,i.gameManager.hasBottomAbility(n))),t.R7$(),t.Y8G("ability",n)("monster",i.monster)("flipped",!0),t.R7$(),t.vxM(i.edit?2:-1),t.R7$(),t.vxM(i.edit?3:-1)}}function fN(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",25),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(2);return c.Njj(o.restore(e))}),t.nrm(1,"img",26),t.k0s()}}function CN(a,r){if(1&a&&(t.j41(0,"div",23),t.nrm(1,"ghs-ability",22),t.nVh(2,fN,2,0,"a",24),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.l_i(5,Cc,i.settingsManager.settings.showExpandedAbilityCard,i.gameManager.hasBottomAbility(n))),t.R7$(),t.Y8G("ability",n)("monster",i.monster)("flipped",!0),t.R7$(),t.vxM(i.edit?2:-1)}}function MN(a,r){if(1&a&&(t.j41(0,"div",16),t.Z7z(1,CN,3,8,"div",23,fo),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(t.bMT(3,0,n.deletedCards))}}let vN=(()=>{class a{monster;dialogRef;ghsManager;menuElement;reveal=0;gameManager=s.E;settingsManager=p.f;GameState=D.mk;edit=!1;maxHeight="";bottomActions=!1;upcomingCards=[];discardedCards=[];deletedCards=[];constructor(n,i,e){this.monster=n,this.dialogRef=i,this.ghsManager=e}ngOnInit(){setTimeout(()=>{this.menuElement&&(this.maxHeight="calc(80vh - "+this.menuElement.nativeElement.offsetHeight+"px)")},p.f.settings.animations?250*p.f.settings.animationSpeed:0),this.bottomActions=s.E.monsterManager.hasBottomActions(this.monster),this.update(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.update()})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}toggleEdit(){this.edit=!this.edit,setTimeout(()=>{this.maxHeight="calc(80vh - "+this.menuElement.nativeElement.offsetHeight+"px)"},0)}update(){let n=this.monster.ability;this.upcomingCards=this.monster.abilities.filter((i,e)=>e>n).map(i=>s.E.abilities(this.monster)[i]),this.discardedCards=this.monster.abilities.filter((i,e)=>e<=n).map(i=>s.E.abilities(this.monster)[i]).reverse(),this.deletedCards=s.E.deckData(this.monster).abilities.filter((i,e)=>!this.monster.abilities.includes(e))}abilityIndex(n){return s.E.abilities(this.monster).indexOf(n)}shuffle(n=!1){s.E.stateManager.before("shuffleAbilityDeck"+(n?"Upcoming":""),"data.monster."+this.monster.name),s.E.monsterManager.shuffleAbilities(this.monster,n),s.E.sortFigures(),s.E.stateManager.after(),this.update()}draw(){s.E.stateManager.before("drawAbility","data.monster."+this.monster.name),s.E.monsterManager.drawAbility(this.monster),s.E.sortFigures(),s.E.stateManager.after(),this.update()}toggleDrawExtra(){this.monster.drawExtra?(s.E.stateManager.before("unsetDrawExtraAbility","data.monster."+this.monster.name),this.monster.drawExtra=!1,s.E.monsterManager.applySameDeck(this.monster),s.E.stateManager.after()):s.E.monsterManager.applySameDeck(this.monster)&&(s.E.stateManager.before("setDrawExtraAbility","data.monster."+this.monster.name),this.monster.drawExtra=!0,s.E.game.state==D.mk.next&&s.E.monsterManager.drawExtra(this.monster),s.E.sortFigures(),s.E.stateManager.after()),this.update()}dropUpcoming(n){if(s.E.stateManager.before("reorderAbilities","data.monster."+this.monster.name),n.container==n.previousContainer){const e=this.monster.ability+1;(0,V.HD)(this.monster.abilities,n.previousIndex+e,n.currentIndex+e)}else{const e=this.monster.ability;(0,V.HD)(this.monster.abilities,e-n.previousIndex,n.currentIndex+e),this.monster.ability=this.monster.ability-1}const i=s.E.monsterManager.getSameDeckMonster(this.monster);i&&s.E.monsterManager.applySameDeck(i),s.E.stateManager.after(),this.update()}dropDiscarded(n){if(s.E.stateManager.before("reorderAbilities","data.monster."+this.monster.name),n.container==n.previousContainer)(0,V.HD)(this.monster.abilities,this.monster.ability-n.previousIndex,this.monster.ability-n.currentIndex);else{this.monster.ability=this.monster.ability+1;const e=this.monster.ability;(0,V.HD)(this.monster.abilities,n.previousIndex+e,e-n.currentIndex)}const i=s.E.monsterManager.getSameDeckMonster(this.monster);i&&s.E.monsterManager.applySameDeck(i),s.E.sortFigures(),s.E.stateManager.after(),this.update()}restoreDefault(){s.E.stateManager.before("restoreDefaultAbilities","data.monster."+this.monster.name),s.E.monsterManager.restoreDefaultAbilities(this.monster),s.E.stateManager.after(),this.update()}remove(n){const i=s.E.abilities(this.monster)[this.monster.abilities[n]];s.E.stateManager.before("removeAbility","data.monster."+this.monster.name,i.name?this.abilityLabel(i):""+i.cardId),s.E.monsterManager.removeAbility(this.monster,n),s.E.stateManager.after(),this.update()}restore(n){s.E.stateManager.before("restoreAbility","data.monster."+this.monster.name,n.name?this.abilityLabel(n):""+n.cardId),s.E.monsterManager.restoreAbility(this.monster,n),s.E.stateManager.after(),this.update()}abilityLabel(n){let i="data.monster."+this.monster.name;return n&&n.name?i="data.ability."+n.name:this.monster.deck!=this.monster.name&&(i="data.deck."+this.monster.deck,i.split(".")[i.split(".").length-1]===te(p.f.getLabel(i))&&this.monster.deck&&(i="data.monster."+this.monster.deck)),te(p.f.getLabel(i))}defaultSort(){this.monster.abilities=this.monster.abilities.sort((n,i)=>n-i),this.update()}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-abilities-dialog"]],viewQuery:function(i,e){if(1&i&&t.GBs(nN,5),2&i){let o;t.mGM(o=t.lsd())&&(e.menuElement=o.first)}},standalone:!1,decls:30,vars:33,consts:[["menu",""],["upcomingList","cdkDropList"],["discardedList","cdkDropList"],[1,"abilities-dialog",3,"ngClass"],[1,"menu",3,"ngClass"],[3,"click"],[3,"ghs-label"],["ghs-pointer-input","",3,"singleClick","doubleClick","ghs-tooltip","overlayX"],["type","checkbox",3,"click","checked"],[1,"insert-menu"],[1,"scroll-container"],[1,"abilities-container",3,"ngClass"],["cdkDropList","",1,"upcoming","drop-list",3,"cdkDropListDropped","cdkDropListDisabled","cdkDropListConnectedTo","cdkDropListAutoScrollStep"],[1,"empty"],["cdkDrag","",1,"container","drag-hidden",3,"ngClass"],["cdkDropList","",1,"discarded","drop-list",3,"cdkDropListDropped","cdkDropListDisabled","cdkDropListConnectedTo","cdkDropListAutoScrollStep"],[1,"deleted","drop-list"],[3,"ability","monster","flipped","reveal"],["cdkDragHandle","",1,"drag-handle"],[1,"button-remove"],[1,"button-remove",3,"click"],["src","./assets/images/minus.svg",1,"ghs-svg"],[3,"ability","monster","flipped"],[1,"container",3,"ngClass"],[1,"button-restore"],[1,"button-restore",3,"click"],["src","./assets/images/plus.svg",1,"ghs-svg"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",3)(1,"div",4,0)(3,"a",5),t.bIt("click",function(){return c.eBV(o),c.Njj(e.reveal=(e.reveal+1)%3)}),t.nrm(4,"span",6),t.k0s(),t.j41(5,"a",7),t.bIt("singleClick",function(){return c.eBV(o),c.Njj(e.shuffle())})("doubleClick",function(){return c.eBV(o),c.Njj(e.shuffle(!0))}),t.nrm(6,"span",6),t.k0s(),t.j41(7,"label")(8,"input",8),t.bIt("click",function(){return c.eBV(o),c.Njj(e.toggleEdit())}),t.k0s(),t.nrm(9,"span",6),t.k0s(),t.j41(10,"div",9),t.nVh(11,sN,2,1,"a"),t.nVh(12,rN,2,1,"a"),t.nVh(13,cN,2,1,"a"),t.nVh(14,lN,3,2,"label"),t.k0s()(),t.j41(15,"div",10)(16,"div",11)(17,"div",12,1),t.bIt("cdkDropListDropped",function(m){return c.eBV(o),c.Njj(e.dropUpcoming(m))}),t.nVh(19,gN,1,0,"div",13),t.Z7z(20,_N,4,11,"div",14,fo),t.nI1(22,"trackUUID"),t.k0s(),t.j41(23,"div",15,2),t.bIt("cdkDropListDropped",function(m){return c.eBV(o),c.Njj(e.dropDiscarded(m))}),t.nrm(25,"div",13),t.Z7z(26,uN,4,9,"div",14,fo),t.nI1(28,"trackUUID"),t.k0s(),t.nVh(29,MN,4,2,"div",16),t.k0s()()()}if(2&i){const o=t.sdS(18),g=t.sdS(24);t.Y8G("ngClass",t.eq3(27,eN,e.edit)),t.R7$(),t.Y8G("ngClass",t.eq3(29,aN,e.monster&&e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.monsterPermissions[e.monster.name+"|"+e.monster.edition])),t.R7$(3),t.Y8G("ghs-label",2==e.reveal?"game.cards.coverAll":0==e.reveal?"game.cards.revealAll":"game.cards.revealAllConfirm"),t.R7$(),t.Y8G("ghs-tooltip","game.cards.shuffle.upcomingHint")("overlayX","center"),t.R7$(),t.Y8G("ghs-label","game.cards.shuffle"),t.R7$(2),t.Y8G("checked",e.edit),t.R7$(),t.Y8G("ghs-label","game.cards.edit"),t.R7$(2),t.vxM(e.edit||e.bottomActions?11:-1),t.R7$(),t.vxM(e.edit?12:-1),t.R7$(),t.vxM(e.edit?13:-1),t.R7$(),t.vxM(e.gameManager.monsterManager.getSameDeckMonster(e.monster)?14:-1),t.R7$(2),t.xc7("max-height",e.maxHeight),t.Y8G("ngClass",t.eq3(31,iN,e.edit&&e.deletedCards.length)),t.R7$(),t.Y8G("cdkDropListDisabled",!e.edit)("cdkDropListConnectedTo",g)("cdkDropListAutoScrollStep",20),t.R7$(2),t.vxM(0==e.upcomingCards.length?19:-1),t.R7$(),t.Dyx(t.bMT(22,23,e.upcomingCards)),t.R7$(3),t.Y8G("cdkDropListDisabled",!e.edit)("cdkDropListConnectedTo",o)("cdkDropListAutoScrollStep",20),t.R7$(3),t.Dyx(t.bMT(28,25,e.discardedCards)),t.R7$(3),t.vxM(e.edit&&e.deletedCards.length?29:-1)}},dependencies:[N.YU,V.O7,V.T1,V.Fb,ee,it,Mt,dt,ct],styles:['.abilities-dialog[_ngcontent-%COMP%]{position:relative}.abilities-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;flex-wrap:wrap}.abilities-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline)}.abilities-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .abilities-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.abilities-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{cursor:pointer;appearance:none;background-color:var(--form-background);width:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));border-width:calc(var(--ghs-unit) * .3);border-style:solid;display:grid;place-content:center;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));color:var(--ghs-color-gray)}.abilities-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before{left:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));top:calc(var(--ghs-unit) * -.5 * var(--ghs-text-factor));position:relative;content:" ";width:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));transform:scale(0);transform-origin:bottom left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;clip-path:polygon(14% 44%,0 65%,50% 100%,100% 16%,80% 0%,43% 62%);color:var(--ghs-color-gray);background-color:var(--ghs-color-gray)}.abilities-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked:before{transform:scale(1)}.abilities-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover:before{background-color:var(--ghs-color-white)}.abilities-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .insert-menu[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-evenly;flex-basis:100%;flex-shrink:0}.abilities-dialog[_ngcontent-%COMP%]   .drop-list[_ngcontent-%COMP%]{position:relative}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]{display:flex;margin:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 80 * var(--ghs-text-factor));max-height:80vh}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;padding:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 40 * var(--ghs-text-factor))}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 37 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 23.7 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));flex-shrink:0;flex-grow:0}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container.expanded-ability[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container.expanded-ability[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container.expanded-ability[_ngcontent-%COMP%]{height:auto;min-height:calc(var(--ghs-unit) * 23.7 * var(--ghs-text-factor))}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container.drawn[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container.drawn[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container.drawn[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{opacity:.5}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container.bottom-actions[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container.bottom-actions[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container.bottom-actions[_ngcontent-%COMP%]{min-height:initial;height:calc(var(--ghs-unit) * 49.95 * var(--ghs-text-factor))}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{display:block;width:100%;height:100%}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{position:absolute;cursor:grab;left:50%;top:50%;width:50%;height:70%;transform:translate(-50%,-50%)}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]{z-index:1;position:absolute;display:flex;cursor:pointer;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-filter-white) var(--ghs-filter-shadow)}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-shadow)}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-green) var(--ghs-filter-shadow)}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming.deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded.deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted.deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{opacity:.5}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * .9 * var(--ghs-text-factor));display:block;margin:calc(var(--ghs-unit) * .7 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 36.6 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 23.3 * var(--ghs-text-factor));border-radius:calc(var(--ghs-unit) * 1);border-style:dashed;border-width:calc(var(--ghs-unit) * .2);border-color:var(--ghs-color-white)}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container.has-deleted[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 120 * var(--ghs-text-factor))}.abilities-dialog[_ngcontent-%COMP%]   .cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.5}.abilities-dialog[_ngcontent-%COMP%]   .cdk-drag-animating[_ngcontent-%COMP%]{transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}.abilities-dialog[_ngcontent-%COMP%]   .cdk-drop-list-dragging[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}']})}return a})();const ON=(a,r,n,i,e,o,g,m)=>({flipped:a,"full-ability":r,"expanded-ability":n,"bottom-actions":i,"second-ability":e,fh:o,disabled:g,denied:m});function PN(a,r){1&a&&t.nrm(0,"div",1)}function bN(a,r){1&a&&t.nrm(0,"div",2)}function kN(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-ability",3),t.bIt("singleClick",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.openAbilities(e))})("doubleClick",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.openAbility(e))}),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ability",n.secondAbility)("monster",n.monster)("flipped",n.flipped)("activeActions",!!n.monster.firstActiveAction&&("bottom"==n.monster.firstActiveAction?"top":"bottom"))("interactiveAbilities",n.settingsManager.settings.interactiveAbilities)}}function yN(a,r){if(1&a&&(t.j41(0,"span",5),t.EFF(1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Lme(" ",n.monster.abilities.length-n.drawnAbilities,"/",n.monster.abilities.length,"\n")}}let xN=(()=>{class a{dialog;ghsManager;monster;index=-1;ability=void 0;secondAbility=void 0;gameManager=s.E;settingsManager=p.f;flipped=!1;hasBottomActions=!1;drawnAbilities=0;constructor(n,i){this.dialog=n,this.ghsManager=i}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.hasBottomActions=s.E.monsterManager.hasBottomActions(this.monster),this.drawnAbilities=s.E.monsterManager.drawnAbilities(this.monster),this.flipped=this.calcFlipped()}calcFlipped(){if(!p.f.settings.abilities||s.E.game.state==D.mk.draw||(this.ability=-1==this.index?s.E.monsterManager.getAbility(this.monster):s.E.abilities(this.monster)[this.index],!this.ability))return!1;s.E.hasBottomAbility(this.ability)&&(this.ability=s.E.monsterManager.getAbility(this.monster,!0),this.secondAbility=s.E.monsterManager.getAbility(this.monster));let n=!s.E.roundManager.working&&s.E.game.state==D.mk.next&&s.E.gameplayFigure(this.monster),i=p.f.settings.abilityReveal||this.monster.active||this.monster.off&&(s.E.game.figures.some((e,o,g)=>e.active&&o>g.indexOf(this.monster))||s.E.game.figures.every(e=>!e.active));return s.E.game.state==D.mk.next&&i&&(n=n||s.E.game.state==D.mk.next&&this.monster.lastDraw==s.E.game.round),n&&i}openAbilities(n){p.f.settings.abilities&&(!n.srcEvent||!n.srcEvent.defaultPrevented)&&this.dialog.open(vN,{panelClass:["dialog"],data:this.monster})}openAbility(n){p.f.settings.abilities&&(this.flipped?this.dialog.open(Di,{panelClass:["fullscreen-panel"],disableClose:!0,data:{monster:this.monster,interactive:p.f.settings.interactiveAbilities}}):this.openAbilities(n))}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-monster-ability-card"]],inputs:{monster:"monster",index:"index"},standalone:!1,decls:6,vars:19,consts:[[1,"container",3,"ngClass"],[1,"hover-effect","initiative"],[1,"hover-effect","title"],["ghs-pointer-input","",3,"singleClick","doubleClick","ability","monster","flipped","activeActions","interactiveAbilities"],["ghs-pointer-input","",3,"ability","monster","flipped","activeActions","interactiveAbilities"],[1,"left-abilities"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nVh(1,PN,1,0,"div",1),t.nVh(2,bN,1,0,"div",2),t.j41(3,"ghs-ability",3),t.bIt("singleClick",function(g){return e.openAbilities(g)})("doubleClick",function(g){return e.openAbility(g)}),t.k0s(),t.nVh(4,kN,1,5,"ghs-ability",4),t.k0s(),t.nVh(5,yN,2,2,"span",5)),2&i&&(t.Y8G("ngClass",t.lV(10,ON,e.flipped,e.settingsManager.settings.showFullAbilityCard||e.settingsManager.settings.showExpandedAbilityCard,e.settingsManager.settings.showExpandedAbilityCard&&e.flipped,e.hasBottomActions&&e.ability&&e.secondAbility,e.secondAbility,e.settingsManager.settings.fhStyle,!e.settingsManager.settings.abilities,e.monster&&e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.monsterPermissions[e.monster.name+"|"+e.monster.edition])),t.R7$(),t.vxM(e.secondAbility||e.settingsManager.settings.showFullAbilityCard||e.settingsManager.settings.showExpandedAbilityCard?-1:1),t.R7$(),t.vxM(e.secondAbility||e.settingsManager.settings.showFullAbilityCard||e.settingsManager.settings.showExpandedAbilityCard?-1:2),t.R7$(),t.Y8G("ability",e.ability)("monster",e.monster)("flipped",e.flipped)("activeActions",!!e.monster.firstActiveAction&&("bottom"==e.monster.firstActiveAction?"bottom":"top"))("interactiveAbilities",e.settingsManager.settings.interactiveAbilities),t.R7$(),t.vxM(e.secondAbility?4:-1),t.R7$(),t.vxM(e.settingsManager.settings.abilities?5:-1))},dependencies:[N.YU,ee,dt],styles:['[_nghost-%COMP%]{position:relative}.container[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 40);height:calc(var(--ghs-unit) * 21.5);overflow:hidden;border-radius:calc(var(--ghs-unit) * 1);cursor:help}.container[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{display:inline-block;position:relative;top:calc(var(--ghs-unit) * -3);left:0;width:calc(var(--ghs-unit) * 40);height:calc(var(--ghs-unit) * 25.5);transition:top calc(var(--ghs-animation-speed) * .25s) ease-in-out;z-index:3}.container[_ngcontent-%COMP%]   ghs-pointer-input[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:2}.container.disabled[_ngcontent-%COMP%]{pointer-events:none}.container.flipped[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * -4)}.container.flipped.fh[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * -3.5)}.container.flipped[_ngcontent-%COMP%]   .hover-effect[_ngcontent-%COMP%]{content:" ";display:block;position:absolute;top:0;left:0;z-index:4}.container.flipped[_ngcontent-%COMP%]   .hover-effect.initiative[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 8.5);height:calc(var(--ghs-unit) * 5)}.container.flipped[_ngcontent-%COMP%]   .hover-effect.title[_ngcontent-%COMP%]{width:100%;height:calc(var(--ghs-unit) * 1.5)}.container.flipped[_ngcontent-%COMP%]   .hover-effect[_ngcontent-%COMP%]:hover.initiative{height:calc(var(--ghs-unit) * 9)}.container.flipped[_ngcontent-%COMP%]   .hover-effect[_ngcontent-%COMP%]:hover.title{height:calc(var(--ghs-unit) * 4)}.container.flipped[_ngcontent-%COMP%]   .hover-effect[_ngcontent-%COMP%]:hover ~ ghs-ability[_ngcontent-%COMP%]{top:0}.container.second-ability[_ngcontent-%COMP%]{display:flex}.container.second-ability[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{top:0;width:calc(var(--ghs-unit) * 20);height:calc(var(--ghs-unit) * 10.75)}.container.second-ability[_ngcontent-%COMP%]   ghs-pointer-input[_ngcontent-%COMP%]{position:absolute;inset:0 50% 0 0}.container.second-ability[_ngcontent-%COMP%]   ghs-pointer-input[_ngcontent-%COMP%]:nth-of-type(2){left:50%;right:0}.container.bottom-actions[_ngcontent-%COMP%]{overflow-y:auto}.container.bottom-actions[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{top:0;height:calc(var(--ghs-unit) * 54)}.container.bottom-actions.second-ability[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 27)}.container.full-ability[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 37);height:calc(var(--ghs-unit) * 24)}.container.full-ability[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{top:0;width:calc(var(--ghs-unit) * 37);height:calc(var(--ghs-unit) * 24)}.container.full-ability.fh[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{top:0}.container.full-ability.second-ability[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 18.5);height:calc(var(--ghs-unit) * 12)}.container.full-ability.bottom-actions[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 38.2)}.container.full-ability.bottom-actions.second-ability[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 25)}.container.expanded-ability[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 37);height:auto;min-height:calc(var(--ghs-unit) * 24)}.container.expanded-ability[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{top:0;width:calc(var(--ghs-unit) * 37);height:auto;min-height:calc(var(--ghs-unit) * 24)}.container.expanded-ability.fh[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{top:0}.container.expanded-ability.bottom-actions[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 38.2)}.container.expanded-ability.bottom-actions[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 38.2)}.container.expanded-ability.bottom-actions.second-ability[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 25)}.container.expanded-ability.second-ability[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 25)}.container.expanded-ability.second-ability[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 18.5);height:calc(var(--ghs-unit) * 12);min-height:initial}.left-abilities[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2);position:absolute;color:var(--ghs-color-gray);right:calc(var(--ghs-unit) * .5);bottom:calc(var(--ghs-unit) * 0);z-index:4}']})}return a})();const EN=(a,r,n)=>({disabled:a,"full-ability":r,modern:n}),wN=a=>({"active-border":a}),RN=(a,r)=>({"active-border":a,off:r});function jN(a,r){if(1&a&&t.nrm(0,"img",1),2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(2,wN,n.monster.active))("src",n.gameManager.monsterManager.monsterThumbnail(n.monster),t.B4B)}}function GN(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.JRh(n[0])}}function TN(a,r){if(1&a&&(t.j41(0,"span",2)(1,"span",3),t.Z7z(2,GN,2,1,"span",null,t.fX1),t.k0s(),t.j41(4,"span",4),t.nrm(5,"span",5),t.k0s()()),2&a){const n=t.XpG();t.Y8G("ngClass",t.l_i(2,RN,n.monster.active,n.monster.off)),t.R7$(2),t.Dyx(n.settingsManager.getLabel("data.monster."+n.monster.name).split(" ")),t.R7$(3),t.Y8G("ghs-label","data.monster."+n.monster.name)}}const SN=(a,r)=>({closed:a,opened:r});let DN=(()=>{class a{dialog;monster;gameManager=s.E;settingsManager=p.f;GameState=D.mk;constructor(n){this.dialog=n}toggleFigure(){s.E.game.state==D.mk.next&&s.E.monsterManager.monsterEntityCount(this.monster)?(s.E.stateManager.before(this.monster.active?"unsetActive":"setActive","data.monster."+this.monster.name),s.E.roundManager.toggleFigure(this.monster),s.E.stateManager.after()):this.imageDialog()}imageDialog(){p.f.settings.artwork&&(!this.monster.noArtwork||!this.monster.noThumbnail)&&this.dialog.open($N,{data:this.monster})}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-monster-image"]],inputs:{monster:"monster"},standalone:!1,decls:3,vars:10,consts:[["ghs-pointer-input","",1,"image",3,"singleClick","doubleClick","onRelease","ngClass","ghs-label","ghs-label-attribute"],[3,"ngClass","src"],[1,"no-artwork",3,"ngClass"],[1,"letter"],[1,"name"],[3,"ghs-label"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.bIt("singleClick",function(){return e.toggleFigure()})("doubleClick",function(){return e.imageDialog()}),t.nVh(1,jN,1,4,"img",1),t.nVh(2,TN,6,5,"span",2),t.k0s()),2&i&&(t.Y8G("onRelease",!0)("ngClass",t.sMw(6,EN,e.gameManager.game.state==e.GameState.draw||0==e.monster.entities.length,e.settingsManager.settings.showFullAbilityCard,"modern"==e.settingsManager.settings.theme))("ghs-label",e.gameManager.game.state==e.GameState.next?e.monster.active?"game.figure.endTurn":"game.figure.startTurn":"")("ghs-label-attribute","title"),t.R7$(),t.vxM(!e.monster.noThumbnail&&e.settingsManager.settings.artwork?1:-1),t.R7$(),t.vxM(e.monster.noThumbnail||!e.settingsManager.settings.artwork?2:-1))},dependencies:[N.YU,it,dt],styles:[".image[_ngcontent-%COMP%]{position:relative;display:flex;width:calc(var(--ghs-unit) * 16);height:calc(var(--ghs-unit) * 16);flex-direction:column;justify-content:center;align-items:center;text-align:center;cursor:pointer}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto;border-radius:100%;transition:box-shadow calc(var(--ghs-animation-speed) * .1s) ease-in-out}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:not(.active-border){box-shadow:0 0 calc(var(--ghs-unit) * .5) calc(var(--ghs-unit) * .1) var(--ghs-color-darkgray)}.image[_ngcontent-%COMP%]   .no-artwork[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;font-family:var(--ghs-font-title);width:100%;height:100%;border-radius:100%;transition:box-shadow calc(var(--ghs-animation-speed) * .1s) ease-in-out;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray);border-color:var(--ghs-character-color)}.image[_ngcontent-%COMP%]   .no-artwork.off[_ngcontent-%COMP%]{color:var(--ghs-color-gray)}.image[_ngcontent-%COMP%]   .no-artwork[_ngcontent-%COMP%]:not(.active-border){box-shadow:0 0 calc(var(--ghs-unit) * .5) calc(var(--ghs-unit) * .1) var(--ghs-color-darkgray)}.image[_ngcontent-%COMP%]   .no-artwork[_ngcontent-%COMP%]   .letter[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 6)}.image[_ngcontent-%COMP%]   .no-artwork[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * -1);font-size:calc(var(--ghs-unit) * 2)}.image.disabled[_ngcontent-%COMP%]{cursor:initial}.image.full-ability[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 17.5);height:calc(var(--ghs-unit) * 17.5)}.image.modern[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:not(.active-border){box-shadow:none}"]})}return a})(),$N=(()=>{class a{monster;dialogRef;gameManager=s.E;opened=!1;constructor(n,i){this.monster=n,this.dialogRef=i}ngOnInit(){this.opened=!0}close(){this.opened=!1,setTimeout(()=>{(0,F.co)(this.dialogRef)},400)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.Qs),t.rXU(O.ce))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-monster-image-dialog"]],standalone:!1,decls:3,vars:5,consts:[[1,"monster-image-dialog",3,"ngClass"],[3,"src"],[1,"close-container",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nrm(1,"img",1),t.k0s(),t.j41(2,"div",2),t.bIt("click",function(){return e.close()}),t.k0s()),2&i&&(t.Y8G("ngClass",t.l_i(2,SN,!e.opened,e.opened)),t.R7$(),t.Y8G("src",e.gameManager.monsterManager.monsterArtwork(e.monster),t.B4B))},dependencies:[N.YU],styles:["[_nghost-%COMP%]{background-color:transparent;padding:0;margin:0;border:0}.monster-image-dialog[_ngcontent-%COMP%]{width:100vw;max-width:600px;height:100vw;max-height:600px;border-image:none;background:none;transition:transform calc(var(--ghs-animation-speed) * .25s) ease-in-out;transform:scale(0);display:flex;justify-content:center;align-items:center}.monster-image-dialog[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80%;height:auto;border-radius:2%;filter:var(--ghs-filter-shadow)}.monster-image-dialog.opened[_ngcontent-%COMP%]{transform:scale(1)}.monster-image-dialog.closed[_ngcontent-%COMP%]{transform:scale(0);transition-delay:.1s}.close-container[_ngcontent-%COMP%]{cursor:zoom-out;position:absolute;inset:0}"]})}return a})();const IN=a=>({disabled:a});function AN(a,r){1&a&&t.nrm(0,"img",2)}function VN(a,r){1&a&&t.nrm(0,"img",3)}let FN=(()=>{class a{elementRef;dialog;overlay;ghsManager;monster;type;range=[];nonDead=0;count=0;settingsManager=p.f;maxStandees=0;usedStandees=0;constructor(n,i,e,o){this.elementRef=n,this.dialog=i,this.overlay=e,this.ghsManager=o}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.maxStandees=s.E.monsterManager.monsterStandeeMax(this.monster),this.usedStandees=s.E.monsterManager.monsterStandeeCount(this.monster)}hasEntity(){return null!=this.monster.entities.find(n=>s.E.entityManager.isAlive(n)&&n.type==this.type)}open(){if(!p.f.settings.standees)return this.hasEntity()?this.monster.entities=this.monster.entities.filter(n=>n.type!=this.type):this.nextStandee(),void this.ghsManager.triggerUiChange();if(!(this.nonDead>=this.count))if(this.maxStandees==this.count&&this.nonDead==this.count-1&&this.monster.entities.every(n=>n.number>0))for(let n=0;n<this.count;n++)this.monster.entities.some(i=>s.E.entityManager.isAlive(i)&&i.number==n+1)||this.pickNumber(n+1);else p.f.settings.randomStandees?this.randomStandee():this.dialog.open(ua,{panelClass:["dialog"],data:{monster:this.monster,type:this.type,range:this.range},positionStrategy:this.overlay.position().flexibleConnectedTo(this.elementRef).withPositions((0,F.yE)(this.type==S.N.elite?"left":"right"))})}randomStandee(){const n=s.E.monsterManager.monsterRandomStandee(this.monster);this.pickNumber(n,!0,!1)}nextStandee(){let n=1;for(;this.monster.entities.some(i=>i.number==n);)n+=1;this.pickNumber(n,!0,!0)}pickNumber(n,i=!1,e=!1){if(!s.E.monsterManager.monsterStandeeUsed(this.monster,n)&&this.type){let o="addStandee";i&&!e?o="addRandomStandee":i&&(o="addNextStandee"),s.E.stateManager.before(o,"data.monster."+this.monster.name,"monster."+this.type,""+n);const g=this.monster.entities.find(k=>k.number==n);g&&s.E.monsterManager.removeMonsterEntity(this.monster,g);const m=s.E.monsterManager.addMonsterEntity(this.monster,n,this.monster.bb&&this.monster.tags.includes("bb-elite")?S.N.elite:this.type,!1);s.E.game.state==D.mk.next&&m&&(this.monster.active=!s.E.game.figures.some(k=>k.active),this.monster.active&&(s.E.sortFigures(this.monster),m.active=!0)),s.E.stateManager.after()}}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT),t.rXU(O.lG),t.rXU(qt.hJ),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-monster-numberpicker"]],inputs:{monster:"monster",type:"type",range:"range",nonDead:"nonDead",count:"count"},standalone:!1,decls:4,vars:10,consts:[["button",""],["ghs-pointer-input","",3,"singleClick","ngClass","ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg",1,"ghs-svg"],["src","./assets/images/minus.svg",1,"ghs-svg"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"a",1,0),t.bIt("singleClick",function(){return c.eBV(o),c.Njj(e.open())}),t.nVh(2,AN,1,0,"img",2),t.nVh(3,VN,1,0,"img",3),t.k0s()}2&i&&(t.HbH(t.VkB("button active-outline ",e.type)),t.Y8G("ngClass",t.eq3(8,IN,e.settingsManager.settings.standees&&(e.nonDead>=e.count||e.usedStandees>=e.maxStandees)))("ghs-label","monster.addEntity."+e.type)("ghs-label-attribute","title"),t.R7$(2),t.vxM(e.settingsManager.settings.standees||!e.hasEntity()?2:-1),t.R7$(),t.vxM(!e.settingsManager.settings.standees&&e.hasEntity()?3:-1))},dependencies:[N.YU,it,dt],styles:[".button[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;cursor:pointer;color:var(--ghs-color-gray);filter:var(--ghs-filter-gray) var(--ghs-filter-shadow);text-shadow:var(--ghs-outline);font-weight:700;width:calc(var(--ghs-unit) * 6 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 6 * var(--ghs-text-factor));text-align:center;stroke:var(--ghs-color-black);stroke-width:calc(var(--ghs-unit) * 2)}.button[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));height:auto}.button.elite[_ngcontent-%COMP%]{color:var(--ghs-color-yellow);filter:var(--ghs-filter-yellow) var(--ghs-filter-shadow)}.button.boss[_ngcontent-%COMP%]{color:var(--ghs-color-red);filter:var(--ghs-filter-red) var(--ghs-filter-shadow)}.button[_ngcontent-%COMP%]:hover, .button.active-button[_ngcontent-%COMP%]{color:var(--ghs-color-white);filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray);filter:var(--ghs-filter-gray) var(--ghs-filter-shadow);opacity:.5}.number-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor)))}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.number-container[_ngcontent-%COMP%]   .number-button.elite[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.number-container[_ngcontent-%COMP%]   .number-button.boss[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.number-container[_ngcontent-%COMP%]   .number-button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-darkgray)}.number-container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.number-container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]   img.summon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.number-container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.number-container[_ngcontent-%COMP%]   .summon-button.active[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) / 5) var(--ghs-color-white) solid;border-radius:100%}"]})}return a})();const XN=(a,r,n,i,e,o,g)=>({off:a,"full-ability":r,"full-stats":n,modern:i,short:e,"short-abilities":o,"short-stats":g}),BN=a=>({denied:a}),YN=(a,r)=>({"full-ability":a,"full-stats":r}),Co=(a,r)=>({disabled:a,denied:r}),UN=(a,r,n)=>({empty:a,"full-ability":r,denied:n}),NN=a=>({disabled:a}),zN=(a,r)=>r._trackUUID;function LN(a,r){if(1&a&&t.nrm(0,"ghs-monster-ability-card",2),2&a){const n=t.XpG();t.Y8G("monster",n.monster)}}function qN(a,r){if(1&a&&t.nrm(0,"ghs-monster-stats",2),2&a){const n=t.XpG();t.Y8G("monster",n.monster)}}function HN(a,r){if(1&a&&t.nrm(0,"ghs-monster-numberpicker",4),2&a){const n=t.XpG();t.Y8G("monster",n.monster)("type",n.MonsterType.normal)("nonDead",n.nonDead)("count",n.count)("ngClass",t.l_i(5,Co,n.settingsManager.settings.standees&&n.nonDead>=n.count,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.monsterPermissions[n.monster.name+"|"+n.monster.edition]))}}function KN(a,r){if(1&a&&t.nrm(0,"ghs-monster-numberpicker",5),2&a){const n=t.XpG();t.Y8G("monster",n.monster)("type",n.MonsterType.elite)("nonDead",n.nonDead)("count",n.count)("ngClass",t.l_i(5,Co,n.settingsManager.settings.standees&&n.nonDead>=n.count,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.monsterPermissions[n.monster.name+"|"+n.monster.edition]))}}function WN(a,r){if(1&a&&t.nrm(0,"ghs-monster-numberpicker",6),2&a){const n=t.XpG();t.Y8G("monster",n.monster)("type",n.MonsterType.boss)("nonDead",n.nonDead)("count",n.count)("ngClass",t.l_i(5,Co,n.settingsManager.settings.standees&&n.nonDead>=n.count,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.monsterPermissions[n.monster.name+"|"+n.monster.edition]))}}function ZN(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",17),t.bIt("click",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.entitiesMenu(e,o.MonsterType.boss))}),t.nrm(1,"img",11),t.k0s()}2&a&&t.Y8G("ghs-label","game.monster.selectStandees.boss")("ghs-label-attribute","title")}function JN(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",18),t.bIt("click",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.entitiesMenu(e,o.MonsterType.elite))}),t.nrm(1,"img",11),t.k0s()}2&a&&t.Y8G("ghs-label","game.monster.selectStandees.elite")("ghs-label-attribute","title")}function QN(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",19),t.bIt("click",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.entitiesMenu(e,o.MonsterType.normal))}),t.nrm(1,"img",11),t.k0s()}2&a&&t.Y8G("ghs-label","game.monster.selectStandees.normal")("ghs-label-attribute","title")}function tz(a,r){if(1&a&&t.nrm(0,"ghs-standee",16),2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("figure",i.monster)("entity",n)}}function nz(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",8)(1,"div",9)(2,"a",10),t.bIt("click",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.entitiesMenu(e))}),t.nrm(3,"img",11),t.k0s(),t.nVh(4,ZN,2,2,"a",12),t.nVh(5,JN,2,2,"a",13),t.nVh(6,QN,2,2,"a",14),t.k0s(),t.j41(7,"div",15),t.Z7z(8,tz,1,2,"ghs-standee",16,zN),t.nI1(10,"trackUUID"),t.k0s()()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.sMw(9,UN,0==n.nonDead,n.settingsManager.settings.showFullAbilityCard||n.settingsManager.settings.showExpandedAbilityCard,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.monsterPermissions[n.monster.name+"|"+n.monster.edition])),t.R7$(),t.Y8G("ngClass",t.eq3(13,NN,n.nonDead<2)),t.R7$(),t.Y8G("ghs-label","game.monster.selectStandees.all")("ghs-label-attribute","title"),t.R7$(2),t.vxM(n.entityTypeCount(n.MonsterType.boss)?4:-1),t.R7$(),t.vxM(n.entityTypeCount(n.MonsterType.elite)?5:-1),t.R7$(),t.vxM(n.entityTypeCount(n.MonsterType.normal)?6:-1),t.R7$(2),t.Dyx(t.bMT(10,7,n.sortedEntites))}}let ez=(()=>{class a{dialog;overlay;ghsManager;monster;MonsterType=S.N;gameManager=s.E;settingsManager=p.f;nonDead=0;count=0;sortedEntites=[];constructor(n,i,e){this.dialog=n,this.overlay=i,this.ghsManager=e}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.nonDead=s.E.monsterManager.monsterEntityCount(this.monster),this.count=s.E.monsterManager.monsterStandeeMax(this.monster),this.sortedEntites=this.monster.entities.sort(p.f.settings.eliteFirst?s.E.monsterManager.sortEntities:s.E.monsterManager.sortEntitiesByNumber)}isNormal(){return this.monster.stats.some(n=>n.type==S.N.normal||n.type==S.N.elite)}getEntities(n){return this.monster.entities.filter(i=>i.type==n).sort((i,e)=>i.number-e.number)}getEdition(){return s.E.getEdition(this.monster)}entityTypeCount(n){const i=this.monster.entities.filter(e=>e.type==n).length;return i>1&&i<this.nonDead}entitiesMenu(n,i=void 0){this.dialog.open(bi,{panelClass:["dialog"],data:{monster:this.monster,type:i},positionStrategy:this.overlay.position().flexibleConnectedTo(n.target).withPositions((0,F.yE)())})}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG),t.rXU(qt.hJ),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-monster"]],inputs:{monster:"monster"},standalone:!1,decls:10,vars:24,consts:[[1,"monster",3,"ngClass"],[3,"monster","ngClass"],[3,"monster"],[1,"stats-container",3,"ngClass"],[1,"normal",3,"monster","type","nonDead","count","ngClass"],[1,"elite",3,"monster","type","nonDead","count","ngClass"],[1,"boss",3,"monster","type","nonDead","count","ngClass"],[3,"figure"],[1,"entities-container",3,"ngClass"],[1,"spacer",3,"ngClass"],[1,"entities-menu","all",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/up.svg"],[1,"entities-menu","boss",3,"ghs-label","ghs-label-attribute"],[1,"entities-menu","elite",3,"ghs-label","ghs-label-attribute"],[1,"entities-menu","normal",3,"ghs-label","ghs-label-attribute"],[1,"entities"],[3,"figure","entity"],[1,"entities-menu","boss",3,"click","ghs-label","ghs-label-attribute"],[1,"entities-menu","elite",3,"click","ghs-label","ghs-label-attribute"],[1,"entities-menu","normal",3,"click","ghs-label","ghs-label-attribute"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nrm(1,"ghs-monster-image",1),t.nVh(2,LN,1,1,"ghs-monster-ability-card",2),t.j41(3,"div",3),t.nVh(4,qN,1,1,"ghs-monster-stats",2),t.nVh(5,HN,1,8,"ghs-monster-numberpicker",4),t.nVh(6,KN,1,8,"ghs-monster-numberpicker",5),t.nVh(7,WN,1,8,"ghs-monster-numberpicker",6),t.k0s(),t.nrm(8,"ghs-figure-errors",7),t.k0s(),t.nVh(9,nz,11,15,"div",8)),2&i&&(t.Y8G("ngClass",t.sGs(11,XN,e.monster.off||0==e.nonDead,e.settingsManager.settings.showFullAbilityCard||e.settingsManager.settings.showExpandedAbilityCard,e.settingsManager.settings.showExpandedStatCard,"modern"==e.settingsManager.settings.theme,!e.settingsManager.settings.abilities||!e.settingsManager.settings.stats,!e.settingsManager.settings.stats,!e.settingsManager.settings.abilities)),t.R7$(),t.Y8G("monster",e.monster)("ngClass",t.eq3(19,BN,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.round&&!e.gameManager.stateManager.monsterPermissions[e.monster.name+"|"+e.monster.edition])),t.R7$(),t.vxM(e.settingsManager.settings.abilities?2:-1),t.R7$(),t.Y8G("ngClass",t.l_i(21,YN,e.settingsManager.settings.showFullAbilityCard||e.settingsManager.settings.showExpandedAbilityCard,e.settingsManager.settings.showExpandedStatCard)),t.R7$(),t.vxM(e.settingsManager.settings.stats?4:-1),t.R7$(),t.vxM(e.monster.boss?-1:5),t.R7$(),t.vxM(e.monster.boss||e.monster.bb?-1:6),t.R7$(),t.vxM(e.monster.boss?7:-1),t.R7$(),t.Y8G("figure",e.monster),t.R7$(),t.vxM(e.settingsManager.settings.standees?9:-1))},dependencies:[N.YU,Qs,it,xN,DN,FN,Te,Aa,ct],styles:[".monster[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 98);z-index:1}.monster[_ngcontent-%COMP%]   ghs-monster-ability-card[_ngcontent-%COMP%], .monster[_ngcontent-%COMP%]   ghs-monster-stats[_ngcontent-%COMP%], .monster[_ngcontent-%COMP%]   ghs-monster-image[_ngcontent-%COMP%]{transition:filter calc(var(--ghs-animation-speed) * .15s) ease-in-out}.monster[_ngcontent-%COMP%]   ghs-monster-ability-card[_ngcontent-%COMP%]:not(ghs-monster-image), .monster[_ngcontent-%COMP%]   ghs-monster-stats[_ngcontent-%COMP%]:not(ghs-monster-image), .monster[_ngcontent-%COMP%]   ghs-monster-image[_ngcontent-%COMP%]:not(ghs-monster-image){filter:var(--ghs-filter-outline)}.monster.off[_ngcontent-%COMP%]   ghs-monster-ability-card[_ngcontent-%COMP%], .monster.off[_ngcontent-%COMP%]   ghs-monster-stats[_ngcontent-%COMP%], .monster.off[_ngcontent-%COMP%]   ghs-monster-image[_ngcontent-%COMP%]{filter:grayscale(.7)}.monster.off[_ngcontent-%COMP%]   ghs-monster-ability-card[_ngcontent-%COMP%]:not(ghs-monster-image), .monster.off[_ngcontent-%COMP%]   ghs-monster-stats[_ngcontent-%COMP%]:not(ghs-monster-image), .monster.off[_ngcontent-%COMP%]   ghs-monster-image[_ngcontent-%COMP%]:not(ghs-monster-image){filter:grayscale(1) var(--ghs-filter-outline)}.monster[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 40);height:calc(var(--ghs-unit) * 21.5)}.monster[_ngcontent-%COMP%]   .stats-container.full-ability[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 24)}.monster[_ngcontent-%COMP%]   .stats-container.full-stats[_ngcontent-%COMP%]{height:100%}.monster[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   ghs-monster-stats[_ngcontent-%COMP%]{display:block;width:100%;height:100%}.monster[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   ghs-monster-numberpicker[_ngcontent-%COMP%]{position:absolute;z-index:2}.monster[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   ghs-monster-numberpicker.normal[_ngcontent-%COMP%], .monster[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   ghs-monster-numberpicker.boss[_ngcontent-%COMP%]{bottom:0;left:0}.monster[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   ghs-monster-numberpicker.elite[_ngcontent-%COMP%]{bottom:0;left:initial;right:0}.monster[_ngcontent-%COMP%]   ghs-figure-errors[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 14.5);top:50%;transform:translateY(-50%)}.monster[_ngcontent-%COMP%]   ghs-monster-image[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * -.5);margin-right:calc(var(--ghs-unit) * .5)}.monster[_ngcontent-%COMP%]   ghs-monster-ability-card[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * .5);overflow:hidden;border-radius:calc(var(--ghs-unit) * 1)}.monster.full-ability[_ngcontent-%COMP%]   ghs-monster-ability-card[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * 1.25)}.monster.full-ability[_ngcontent-%COMP%]   ghs-monster-numberpicker.normal[_ngcontent-%COMP%], .monster.full-ability[_ngcontent-%COMP%]   ghs-monster-numberpicker.boss[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 57.5)}.monster.full-ability[_ngcontent-%COMP%]   ghs-monster-numberpicker.elite[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * 2.5)}.monster.modern[_ngcontent-%COMP%]   ghs-monster-ability-card[_ngcontent-%COMP%], .monster.modern[_ngcontent-%COMP%]   ghs-monster-stats[_ngcontent-%COMP%], .monster.modern[_ngcontent-%COMP%]   ghs-monster-image[_ngcontent-%COMP%]{filter:none}.monster.modern.off[_ngcontent-%COMP%]   ghs-monster-ability-card[_ngcontent-%COMP%], .monster.modern.off[_ngcontent-%COMP%]   ghs-monster-stats[_ngcontent-%COMP%], .monster.modern.off[_ngcontent-%COMP%]   ghs-monster-image[_ngcontent-%COMP%]{filter:grayscale(.7)}.monster.short[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 57)}.monster.short.short-abilities[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]{position:absolute;left:0;bottom:0;width:calc(var(--ghs-unit) * 15.4);height:calc(var(--ghs-unit) * 5)}.monster.short.short-abilities[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   ghs-monster-numberpicker[_ngcontent-%COMP%]{bottom:calc(var(--ghs-unit) * .5)}.monster.short.short-abilities[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   ghs-monster-numberpicker.normal[_ngcontent-%COMP%], .monster.short.short-abilities[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   ghs-monster-numberpicker.boss[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 0)}.monster.short.short-abilities[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   ghs-monster-numberpicker.elite[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 11);right:initial}.monster.short.short-stats.short-abilities[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 17);float:left}.monster.short.short-stats.short-abilities[_ngcontent-%COMP%] + .entities-container[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 40)}.monster.short.short-stats.short-abilities[_ngcontent-%COMP%] + .entities-container[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{width:auto}.entities-container[_ngcontent-%COMP%]{position:relative;display:flex;transition:max-height calc(var(--ghs-animation-speed) * 1s) ease-out;max-height:100%;max-width:calc(var(--ghs-unit) * 96);margin-top:calc(var(--ghs-unit) * .25 * var(--ghs-text-factor));z-index:2}.entities-container.empty[_ngcontent-%COMP%]{max-height:0}.entities-container[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{flex:none;width:calc(var(--ghs-unit) * 17.5);min-height:100%;display:flex;justify-content:center;align-items:center}.entities-container[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer;margin:0 calc(var(--ghs-unit) * .8)}.entities-container[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{opacity:.5;width:calc(var(--ghs-unit) * 3.7 * var(--ghs-text-factor));height:auto;filter:var(--ghs-filter-darkgray)}.entities-container[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]   .entities-menu.normal[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.entities-container[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]   .entities-menu.elite[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.entities-container[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]   .entities-menu.boss[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red)}.entities-container[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{opacity:1}.entities-container[_ngcontent-%COMP%]   .spacer.disabled[_ngcontent-%COMP%]{pointer-events:none}.entities-container[_ngcontent-%COMP%]   .spacer.disabled[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]{display:none}.entities-container[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;max-width:calc(var(--ghs-unit) * 77.5)}.entities-container[_ngcontent-%COMP%]   .entities.normal[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 0)}.entities-container[_ngcontent-%COMP%]   .entities.elite[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * 0)}.entities-container[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   ghs-standee[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * .5);transition:all calc(var(--ghs-animation-speed) * 1s) ease-out}.entities-container.full-ability[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 19.5)}.entities-container.full-ability[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]{max-width:calc(var(--ghs-unit) * 75.5)}ghs-monster-numberpicker.disabled[_ngcontent-%COMP%]{pointer-events:none;display:none}.modern.short.short-stats.short-abilities[_ngcontent-%COMP%] + .entities-container[_ngcontent-%COMP%]{width:auto}"]})}return a})();const az=["objectiveTitle"],iz=(a,r,n,i,e,o,g)=>({off:a,escort:r,denied:n,compact:i,short:e,menu:o,actions:g}),oz=a=>({entity:a}),sz=a=>({"outer-denied":a}),rz=a=>({empty:a}),cz=(a,r)=>({empty:a,disabled:r}),Mo=a=>({"active-border":a}),lz=a=>({damage:a}),gz=a=>({fh:a}),dz=()=>[],Ka=(a,r)=>r._trackUUID;function hz(a,r){if(1&a&&(t.j41(0,"span",2),t.EFF(1),t.k0s()),2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Mo,n.objective.active)),t.R7$(),t.JRh(n.entity.marker)}}function _z(a,r){if(1&a&&(t.nVh(0,hz,2,4,"span",2),t.j41(1,"span",24),t.EFF(2),t.k0s()),2&a){const n=t.XpG();t.vxM(n.entity.marker?0:-1),t.R7$(2),t.SpI(" ",n.entity.number," ")}}function mz(a,r){if(1&a&&(t.j41(0,"span",2),t.EFF(1),t.k0s()),2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(2,Mo,n.objective.active)),t.R7$(),t.JRh(n.marker)}}function pz(a,r){if(1&a&&(t.j41(0,"span",3),t.nrm(1,"img",18),t.k0s()),2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(2,Mo,n.objective.active)),t.R7$(),t.Y8G("src","./assets/images/objective/"+(n.objective.escort?"escort":"objective")+".svg",t.B4B)}}function uz(a,r){if(1&a&&t.nrm(0,"ghs-character-initiative",5),2&a){const n=t.XpG();t.Y8G("figure",n.objective)}}function fz(a,r){if(1&a&&t.nrm(0,"ghs-highlight-conditions",6),2&a){const n=t.XpG();t.Y8G("entity",n.entity)}}function Cz(a,r){if(1&a&&t.nrm(0,"ghs-character-initiative",27),2&a){const n=t.XpG(2);t.Y8G("figure",n.objective)}}function Mz(a,r){if(1&a&&t.nrm(0,"img",31),2&a){const n=t.XpG(2);t.Y8G("src","./assets/images/objective/"+(n.objective.escort?"escort":"objective")+".svg",t.B4B)}}function vz(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.SpI(" ",n.objective.title)}}function Oz(a,r){if(1&a&&t.nrm(0,"span",32),2&a){const n=t.XpG(2);t.Y8G("ghs-label",n.objective.name?"data.objective."+n.objective.name:n.objective.escort?"escort":"objective")}}function Pz(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",42),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openEntityMenu())})("doubleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.removeShield())}),t.nrm(1,"ghs-action",43),t.k0s()}if(2&a){const n=t.XpG(3);t.R7$(),t.Aen("fh"),t.Y8G("action",n.entity.shield)}}function bz(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",42),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openEntityMenu())})("doubleClick",function(){const e=c.eBV(n).$index,o=t.XpG(3);return c.Njj(o.removeRetaliate(e))}),t.nrm(1,"ghs-action",43),t.k0s()}if(2&a){const n=r.$implicit;t.R7$(),t.Aen("fh"),t.Y8G("action",n)}}function kz(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",42),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openEntityMenu())})("doubleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.removeShieldPersistent())}),t.j41(1,"span",44),t.nrm(2,"span",45),t.k0s(),t.nrm(3,"ghs-action",43),t.k0s()}if(2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","%game.card.persistent%"),t.R7$(),t.Aen("fh"),t.Y8G("action",n.entity.shieldPersistent)}}function yz(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",42),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.openEntityMenu())})("doubleClick",function(){const e=c.eBV(n).$index,o=t.XpG(3);return c.Njj(o.removeRetaliatePersistent(e))}),t.j41(1,"span",44),t.nrm(2,"span",45),t.k0s(),t.nrm(3,"ghs-action",43),t.k0s()}if(2&a){const n=r.$implicit;t.R7$(2),t.Y8G("ghs-label","%game.card.persistent%"),t.R7$(),t.Aen("fh"),t.Y8G("action",n)}}function xz(a,r){if(1&a&&(t.j41(0,"span",33),t.nVh(1,Pz,2,3,"span",41),t.Z7z(2,bz,2,3,"span",41,Ka),t.nI1(4,"trackUUID"),t.nVh(5,kz,4,4,"span",41),t.Z7z(6,yz,4,4,"span",41,Ka),t.nI1(8,"trackUUID"),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.vxM(n.entity.shield?1:-1),t.R7$(),t.Dyx(t.bMT(4,2,n.entity.retaliate)),t.R7$(3),t.vxM(n.entity.shieldPersistent?5:-1),t.R7$(),t.Dyx(t.bMT(8,4,n.entity.retaliatePersistent))}}function Ez(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsMinZero"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Lme(" ",t.bMT(2,2,n.entity.health+n.health),"/",n.entity.maxHealth," ")}}function wz(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsMinZero"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Lme(" ",n.entity.maxHealth,"/",t.bMT(2,2,n.entity.maxHealth-(n.entity.health+n.health))," ")}}function Rz(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsMinZero"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.SpI(" ",t.bMT(2,1,n.entity.health+n.health)," ")}}function jz(a,r){if(1&a&&(t.nVh(0,Ez,3,4,"span"),t.nVh(1,wz,3,4,"span"),t.nVh(2,Rz,3,3,"span"),t.nrm(3,"span",46)),2&a){const n=t.XpG(2);t.vxM(n.settingsManager.settings.damageHP||n.objectiveData&&n.objectiveData.trackDamage?-1:0),t.R7$(),t.vxM(n.settingsManager.settings.damageHP?1:-1),t.R7$(),t.vxM(n.objectiveData&&n.objectiveData.trackDamage?2:-1),t.R7$(),t.Y8G("value-sign",n.health)("hideEmpty",!0)("reverse",n.settingsManager.settings.damageHP)("container",!0)("invert",!!n.objectiveData&&n.objectiveData.trackDamage)}}function Gz(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function Tz(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",47),t.bIt("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.removeMarker(e))}),t.nrm(1,"img",18),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(),t.Y8G("src",i.gameManager.characterManager.characterIcon(n),t.B4B)}}function Sz(a,r){if(1&a&&t.nrm(0,"img",53),2&a){const n=r.$implicit,i=t.XpG(2),e=i.$implicit,o=i.$index,g=t.XpG(2);t.xc7("z-index",10*o+e.value-n-1),t.Y8G("src","./assets/images"+(g.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+e.name+".svg",t.B4B)}}function Dz(a,r){if(1&a&&(t.Z7z(0,Sz,1,3,"img",52,t.fX1),t.nI1(2,"ghsRange")),2&a){const n=t.XpG().$implicit;t.Dyx(t.i5U(2,0,t.lJ4(3,dz),n.value-1))}}function $z(a,r){if(1&a&&(t.j41(0,"span",54),t.EFF(1),t.k0s()),2&a){const n=t.XpG(),i=n.$implicit;t.xc7("z-index",10*n.$index+i.value+1),t.R7$(),t.JRh(i.value)}}function Iz(a,r){if(1&a&&t.nrm(0,"span",55),2&a){const n=t.XpG();t.xc7("z-index",10*n.$index+n.$implicit.value+2)}}function Az(a,r){if(1&a&&t.nrm(0,"span",56),2&a){const n=t.XpG();t.xc7("z-index",10*n.$index+n.$implicit.value+3)}}function Vz(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",48),t.bIt("doubleClick",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.removeCondition(e))}),t.nrm(1,"img",18),t.nVh(2,Dz,3,4),t.nVh(3,$z,2,3,"span",49),t.nVh(4,Iz,1,2,"span",50),t.nVh(5,Az,1,2,"span",51),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.Y8G("ngClass",t.eq3(8,gz,e.settingsManager.settings.fhStyle)),t.R7$(),t.xc7("z-index",10*i+n.value),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+n.name+".svg",t.B4B),t.R7$(),t.vxM(n.types.includes(e.ConditionType.stack)?2:-1),t.R7$(),t.vxM(n.types.includes(e.ConditionType.value)&&!n.types.includes(e.ConditionType.stack)?3:-1),t.R7$(),t.vxM(e.entity.immunities.includes(n.name)?4:-1),t.R7$(),t.vxM(n.permanent?5:-1)}}function Fz(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",25),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openEntityMenu())}),t.k0s(),t.j41(1,"div",26)(2,"div",25),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openEntityMenu())}),t.k0s(),t.nVh(3,Cz,1,1,"ghs-character-initiative",27),t.j41(4,"div",28)(5,"div",29),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openEntityMenu())}),t.j41(6,"div",30),t.nVh(7,Mz,1,1,"img",31),t.nVh(8,vz,2,1,"span"),t.nVh(9,Oz,1,1,"span",32),t.nrm(10,"ghs-entity-index-key",6),t.k0s(),t.nVh(11,xz,9,6,"span",33),t.k0s(),t.j41(12,"div",34)(13,"div",35),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openEntityMenu())})("doubleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.toggleDamageHP())})("dragMove",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.dragHpMove(e))})("dragEnd",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.dragHpEnd(e))})("dragCancel",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.dragHpCancel(e))}),t.nrm(14,"img",36),t.nVh(15,jz,4,8),t.nVh(16,Gz,2,0,"span"),t.k0s(),t.j41(17,"div",37),t.Z7z(18,Tz,2,1,"span",38,t.fX1),t.k0s(),t.j41(20,"div",39),t.Z7z(21,Vz,6,10,"span",40,Ka),t.nI1(23,"trackUUID"),t.k0s()()()()}if(2&a){const n=t.XpG();t.R7$(3),t.vxM(n.short?3:-1),t.R7$(4),t.vxM(n.entity.marker?7:-1),t.R7$(),t.vxM(n.objective.title?8:-1),t.R7$(),t.vxM(n.objective.title?-1:9),t.R7$(),t.Y8G("entity",n.entity),t.R7$(),t.vxM(n.settingsManager.settings.characterShieldRetaliate?11:-1),t.R7$(2),t.Y8G("draggingDisabled",!n.settingsManager.settings.dragValuesHp)("relative",!0)("screenWidth",!0)("fastShift",!0),t.R7$(),t.Y8G("ngClass",t.eq3(16,lz,n.objectiveData&&n.objectiveData.trackDamage||n.settingsManager.settings.damageHP))("src","./assets/images/"+(n.objectiveData&&n.objectiveData.trackDamage||n.settingsManager.settings.damageHP?"action/damage.svg":"status/health.svg"),t.B4B),t.R7$(),t.vxM(n.objectiveData&&n.objectiveData.trackDamage||n.entity.maxHealth>0?15:-1),t.R7$(),t.vxM(n.objectiveData&&n.objectiveData.trackDamage||0!=n.entity.maxHealth?-1:16),t.R7$(2),t.Dyx(n.entity.markers),t.R7$(3),t.Dyx(t.bMT(23,14,n.activeConditions))}}function Xz(a,r){if(1&a&&t.nrm(0,"ghs-character-initiative",27),2&a){const n=t.XpG(2);t.Y8G("figure",n.objective)}}function Bz(a,r){if(1&a&&t.nrm(0,"img",31),2&a){const n=t.XpG(2);t.Y8G("src","./assets/images/objective/"+(n.objective.escort?"escort":"objective")+".svg",t.B4B)}}function Yz(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.SpI(" ",n.objective.title)}}function Uz(a,r){if(1&a&&t.nrm(0,"span",32),2&a){const n=t.XpG(2);t.Y8G("ghs-label",n.objective.name?"data.objective."+n.objective.name:n.objective.escort?"escort":"objective")}}function Nz(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",25),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openEntityMenu())}),t.k0s(),t.j41(1,"div",26)(2,"div",25),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openEntityMenu())}),t.k0s(),t.nVh(3,Xz,1,1,"ghs-character-initiative",27),t.j41(4,"div",28)(5,"div",29),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openEntityMenu())}),t.j41(6,"div",30),t.nVh(7,Bz,1,1,"img",31),t.nVh(8,Yz,2,1,"span"),t.nVh(9,Uz,1,1,"span",32),t.k0s()()()()}if(2&a){const n=t.XpG();t.R7$(3),t.vxM(n.short?3:-1),t.R7$(4),t.vxM(n.objective.marker?7:-1),t.R7$(),t.vxM(n.objective.title?8:-1),t.R7$(),t.vxM(n.objective.title?-1:9)}}function zz(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",57),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openEntityMenu())}),t.j41(1,"ghs-actions",58),t.bIt("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.onInteractiveActionsChange(e))}),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("objective",n.objective)("actions",n.objectiveData.actions)("interactiveActions",n.interactiveActions)}}function Lz(a,r){1&a&&t.nrm(0,"div",10)}function qz(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-interactive-actions",59),t.mxI("interactiveActionsChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.interactiveActions,e)||(o.interactiveActions=e),c.Njj(e)}),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("figure",n.objective)("actions",n.objectiveData.actions),t.R50("interactiveActions",n.interactiveActions)}}function Hz(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",13)(1,"div",25),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openEntityMenu())}),t.k0s(),t.j41(2,"a",60),t.bIt("singleClick",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.shortMenu=!e.shortMenu)}),t.nrm(3,"img",61),t.k0s()()}}function Kz(a,r){if(1&a&&t.nrm(0,"ghs-standee",62),2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("figure",i.objective)("entity",n)}}function Wz(a,r){if(1&a&&(t.j41(0,"div",23),t.Z7z(1,Kz,1,2,"ghs-standee",62,Ka),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(t.bMT(3,0,n.objective.entities))}}let Zz=(()=>{class a{dialog;overlay;elementRef;ghsManager;objective;titleInput;characterManager=s.E.characterManager;gameManager=s.E;settingsManager=p.f;GameState=D.mk;ConditionType=Q.GV;objectiveData;entity;activeConditions=[];initiative=-1;health=0;marker="";compact=!1;short=!1;shortMenu=!1;nonDead=0;interactiveActions=[];interactiveActionsChange=new t.bkB;constructor(n,i,e,o){this.dialog=n,this.overlay=i,this.elementRef=e,this.ghsManager=o}ngOnInit(){this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.nonDead=this.objective.entities.filter(n=>s.E.entityManager.isAlive(n)).length,this.activeConditions=[],this.entity=void 0,this.marker="",1==this.nonDead?(this.entity=this.objective.entities.find(n=>s.E.entityManager.isAlive(n)),this.entity&&(this.activeConditions=s.E.entityManager.activeConditions(this.entity),this.entity.immunities.forEach(n=>{this.activeConditions.find(i=>i.name==n)||this.activeConditions.push(new Q.BR(n))}))):this.objective.entities.flatMap(n=>n.marker).every((n,i,e)=>0==e.indexOf(n))&&(this.marker=this.objective.entities.flatMap(n=>n.marker)[0]),this.objective.objectiveId&&(this.objectiveData=s.E.objectiveManager.objectiveDataByObjectiveIdentifier(this.objective.objectiveId)),this.compact=p.f.settings.characterCompact&&"modern"!=p.f.settings.theme,this.short=!(p.f.settings.abilities&&p.f.settings.stats||"modern"==p.f.settings.theme)}toggleFigure(n){s.E.game.state==D.mk.draw||p.f.settings.initiativeRequired&&this.objective.initiative<=0?this.openInitiativeDialog(n):(s.E.stateManager.before(this.objective.active?"unsetActive":"setActive",s.E.objectiveManager.objectiveName(this.objective)),s.E.roundManager.toggleFigure(this.objective),s.E.stateManager.after())}openInitiativeDialog(n){this.dialog.open(ji,{panelClass:["dialog"],data:this.objective,positionStrategy:this.overlay.position().flexibleConnectedTo(n.target).withPositions((0,F.yE)())})}dragInitiativeMove(n){n>99?n=99:n<0&&(n=0),0==n&&p.f.settings.initiativeRequired&&(n=1),-1==this.initiative&&(this.initiative=this.objective.initiative),this.objective.initiative=n}dragInitiativeEnd(n){n>99?n=99:n<0&&(n=0),0==n&&p.f.settings.initiativeRequired&&(n=1),this.objective.initiative!=this.initiative&&(this.objective.initiative=this.initiative,s.E.stateManager.before("setObjectiveInitiative",s.E.objectiveManager.objectiveName(this.objective),""+n),this.objective.initiative=n,this.initiative=-1,s.E.game.state==D.mk.next&&s.E.sortFigures(this.objective),s.E.stateManager.after())}dragHpMove(n){this.health=n,(!this.objectiveData||!this.objectiveData.trackDamage)&&this.entity&&this.entity.health+this.health>(0,A.hZ)(this.entity.maxHealth)&&(this.health=(0,A.hZ)(this.entity.maxHealth)-this.entity.health)}dragHpEnd(n){0!=this.health&&this.entity&&(s.E.stateManager.before("changeObjectiveEntityHP",s.E.objectiveManager.objectiveName(this.objective),(0,F.n1)(this.health),this.entity.number),s.E.entityManager.changeHealth(this.entity,this.objective,this.health),this.entity.health<=0&&this.entity.maxHealth>0&&s.E.objectiveManager.removeObjective(this.objective),this.health=0,s.E.stateManager.after())}dragHpCancel(n){this.health=0}openEntityMenu(){this.dialog.open(ze,{panelClass:["dialog"],data:{entity:this.entity,figure:this.objective},positionStrategy:this.overlay.position().flexibleConnectedTo(this.elementRef.nativeElement.querySelector(".image-container")).withPositions((0,F.yE)())})}toggleDamageHP(){p.f.toggle("damageHP")}openEntitiesMenu(n){this.dialog.open(bi,{panelClass:["dialog"],data:{objective:this.objective},positionStrategy:this.overlay.position().flexibleConnectedTo(n.target).withPositions((0,F.yE)())})}addEntity(){const n=this.objective.entities.filter(o=>s.E.entityManager.isAlive(o)).length;let i=n%12;if(this.objective.entities.find(o=>o.number==i)&&(i=n%12,n<12))for(;this.objective.entities.find(o=>o.number-1==i);)i++;let e=this.objective.name;e||(e=this.objective.title,e||(e=this.objective.escort?"%escort%":"%objective%")),s.E.stateManager.before("addObjective.entity",i+1,e),s.E.objectiveManager.addObjectiveEntity(this.objective,i),s.E.stateManager.after()}removeCondition(n){this.entity&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.objective,"removeCondition"),n.name),n.types.indexOf(Q.GV.stackable)&&n.value>1?n.value--:s.E.entityManager.removeCondition(this.entity,this.objective,n,n.permanent),s.E.stateManager.after())}removeMarker(n){if(this.entity){const i=new H.K(s.E.getCharacterData(n),1),e=s.E.characterManager.characterName(i),o=i.name;s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.objective,"removeMarker"),e,o),this.entity.markers=this.entity.markers.filter(g=>g!=n),s.E.stateManager.after()}}onInteractiveActionsChange(n){this.interactiveActionsChange.emit(n),this.interactiveActions=n}removeShield(){this.entity&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.objective,"removeEntityShield")),this.entity.shield=void 0,s.E.stateManager.after())}removeShieldPersistent(){this.entity&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.objective,"removeEntityShieldPersistent")),this.entity.shieldPersistent=void 0,s.E.stateManager.after())}removeRetaliate(n){if(this.entity){let i=JSON.parse(JSON.stringify(this.entity.retaliate));i.splice(n,1),i.length>0?s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.objective,"setEntityRetaliate"),i.map(e=>"%game.action.retaliate% "+(0,A.hZ)(e.value)+(e.subActions&&e.subActions[0]&&e.subActions[0].type==$.X2.range&&(0,A.hZ)(e.subActions[0].value)>1?" %game.action.range% "+(0,A.hZ)(e.subActions[0].value):"")).join(", ")):s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.objective,"removeEntityRetaliate")),this.entity.retaliate=i,s.E.stateManager.after()}}removeRetaliatePersistent(n){if(this.entity){let i=JSON.parse(JSON.stringify(this.entity.retaliatePersistent));i.splice(n,1),i.length>0?s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.objective,"setEntityRetaliatePersistent"),i.map(e=>"%game.action.retaliate% "+(0,A.hZ)(e.value)+(e.subActions&&e.subActions[0]&&e.subActions[0].type==$.X2.range&&(0,A.hZ)(e.subActions[0].value)>1?" %game.action.range% "+(0,A.hZ)(e.subActions[0].value):"")).join(", ")):s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.objective,"removeEntityRetaliatePersistent")),this.entity.retaliatePersistent=i,s.E.stateManager.after()}}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG),t.rXU(qt.hJ),t.rXU(t.aKT),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-objective-container"]],viewQuery:function(i,e){if(1&i&&t.GBs(az,5),2&i){let o;t.mGM(o=t.lsd())&&(e.titleInput=o.first)}},inputs:{objective:"objective"},standalone:!1,decls:27,vars:39,consts:[[1,"objective",3,"ngClass"],[1,"image-container",3,"ngClass"],[1,"map-marker",3,"ngClass"],[1,"objective-icon",3,"ngClass"],[1,"drag-initiative",3,"dragMove","dragEnd","singleClick","doubleClick","draggingDisabled","ngClass"],[3,"figure"],[3,"entity"],[1,"stats"],[1,"actions-container"],["ghs-pointer-input","",1,"actions"],[1,"bottom-spacer"],[3,"figure","actions","interactiveActions"],[1,"spacer",3,"click"],[1,"short-menu"],[1,"add-entity"],["ghs-pointer-input","",1,"add-entity-button",3,"singleClick","ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg",1,"ghs-svg"],[1,"icon-container",3,"click"],[3,"src"],[1,"entities-container",3,"ngClass"],[1,"spacer"],[1,"entities-menu",3,"click","ngClass","entityAnimation"],["src","./assets/images/up.svg",1,"menu"],[1,"entities"],[1,"objective-marker"],["ghs-pointer-input","",1,"entity-menu-container",3,"singleClick"],[1,"column","col-1"],[1,"initiative",3,"figure"],[1,"bar-container"],["ghs-pointer-input","",1,"title-container",3,"singleClick"],[1,"title"],[1,"icon",3,"src"],[3,"ghs-label"],[1,"actions"],[1,"status-bar"],["ghs-pointer-input","",1,"health",3,"singleClick","doubleClick","dragMove","dragEnd","dragCancel","draggingDisabled","relative","screenWidth","fastShift"],[3,"ngClass","src"],[1,"markers"],["ghs-pointer-input","",1,"marker"],[1,"conditions"],["ghs-pointer-input","",1,"condition",3,"ngClass"],["ghs-pointer-input","",1,"action"],["ghs-pointer-input","",1,"action",3,"singleClick","doubleClick"],[3,"action"],[1,"action-overlay"],[1,"text-white",3,"ghs-label"],[1,"value-overlay",3,"value-sign","hideEmpty","reverse","container","invert"],["ghs-pointer-input","",1,"marker",3,"doubleClick"],["ghs-pointer-input","",1,"condition",3,"doubleClick","ngClass"],[1,"value",3,"z-index"],[1,"condition","immunity","condition-overlay",3,"z-index"],[1,"condition","permanent","condition-overlay",3,"z-index"],[1,"stack",3,"z-index","src"],[1,"stack",3,"src"],[1,"value"],[1,"condition","immunity","condition-overlay"],[1,"condition","permanent","condition-overlay"],["ghs-pointer-input","",1,"actions",3,"singleClick"],[3,"interactiveActionsChange","objective","actions","interactiveActions"],[3,"interactiveActionsChange","figure","actions","interactiveActions"],["ghs-pointer-input","",1,"toggle-menu",3,"singleClick"],["src","./assets/images/menu.svg",1,"ghs-svg"],[3,"figure","entity"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"a",1),t.nVh(2,_z,3,2),t.nVh(3,mz,2,4,"span",2),t.nVh(4,pz,2,4,"span",3),t.k0s(),t.j41(5,"ghs-pointer-input",4),t.bIt("dragMove",function(g){return(!e.gameManager.stateManager.permissions||e.gameManager.stateManager.permissions.characters)&&e.dragInitiativeMove(g)})("dragEnd",function(g){return(!e.gameManager.stateManager.permissions||e.gameManager.stateManager.permissions.characters)&&e.dragInitiativeEnd(g)})("singleClick",function(g){return e.toggleFigure(g)})("doubleClick",function(g){return(!e.gameManager.stateManager.permissions||e.gameManager.stateManager.permissions.characters)&&e.openInitiativeDialog(g)}),t.k0s(),t.nVh(6,uz,1,1,"ghs-character-initiative",5),t.nVh(7,fz,1,1,"ghs-highlight-conditions",6),t.j41(8,"div",7),t.nVh(9,Fz,24,18),t.nVh(10,Nz,10,4),t.j41(11,"div",8),t.nVh(12,zz,2,3,"div",9),t.nVh(13,Lz,1,0,"div",10),t.k0s(),t.nVh(14,qz,1,3,"ghs-interactive-actions",11),t.j41(15,"span",12),t.bIt("click",function(){return e.openEntityMenu()}),t.k0s(),t.nVh(16,Hz,4,0,"div",13),t.j41(17,"div",14)(18,"a",15),t.bIt("singleClick",function(){return e.addEntity()}),t.nrm(19,"img",16),t.k0s()(),t.j41(20,"div",17),t.bIt("click",function(){return e.openEntityMenu()}),t.nrm(21,"img",18),t.k0s()()(),t.j41(22,"div",19),t.nrm(23,"span",20),t.j41(24,"span",21),t.bIt("click",function(g){return e.openEntitiesMenu(g)}),t.nrm(25,"img",22),t.k0s(),t.nVh(26,Wz,4,2,"div",23),t.k0s()),2&i&&(t.Y8G("ngClass",t.sGs(22,iz,e.objective.off,e.objective.escort,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.characters,e.compact,e.short,e.shortMenu,!!e.objectiveData&&e.objectiveData.actions)),t.R7$(),t.Y8G("ngClass",t.eq3(30,oz,e.entity)),t.R7$(),t.vxM(e.entity?2:-1),t.R7$(),t.vxM(e.marker?3:-1),t.R7$(),t.vxM(e.marker||e.entity&&e.entity.marker?-1:4),t.R7$(),t.Y8G("draggingDisabled",!e.settingsManager.settings.dragValuesInitiative)("ngClass",t.eq3(32,sz,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.round)),t.R7$(),t.vxM(e.short?-1:6),t.R7$(),t.vxM(e.entity?7:-1),t.R7$(2),t.vxM(e.entity?9:-1),t.R7$(),t.vxM(e.entity?-1:10),t.R7$(2),t.vxM(e.objectiveData&&e.objectiveData.actions?12:-1),t.R7$(),t.vxM(e.interactiveActions.length?13:-1),t.R7$(),t.vxM(e.objectiveData&&e.objectiveData.actions?14:-1),t.R7$(2),t.vxM(e.compact&&e.short?16:-1),t.R7$(2),t.Y8G("ghs-label","objective.addEntity")("ghs-label-attribute","title"),t.R7$(3),t.Y8G("src","./assets/images/objective/"+(e.objective.escort?"escort":"objective")+".svg",t.B4B),t.R7$(),t.Y8G("ngClass",t.eq3(34,rz,e.nonDead<2)),t.R7$(2),t.Y8G("ngClass",t.l_i(36,cz,0==e.nonDead,e.nonDead<2))("entityAnimation",0==e.nonDead),t.R7$(2),t.vxM(e.nonDead>1?26:-1))},dependencies:[N.YU,en,ve,Yi,$a,ba,it,Ia,xs,dt,Aa,Ne,Ma,At,ct],styles:['.objective[_ngcontent-%COMP%]{position:relative;z-index:1;height:100%;width:calc(var(--ghs-unit) * 98);height:calc(var(--ghs-unit) * 14);background-color:var(--ghs-color-green);background-image:url(char-mat.5a0fee77df1ff44e.png),url(char-mat.5a0fee77df1ff44e.png);background-blend-mode:multiply,overlay;background-size:100% 100%;display:flex;border-radius:calc(var(--ghs-unit) * .5);transition:background-color calc(var(--ghs-animation-speed) * .15s) ease-in-out,background-image calc(var(--ghs-animation-speed) * .15s) ease-in-out,background-blend-mode calc(var(--ghs-animation-speed) * .15s) ease-in-out}.objective.escort[_ngcontent-%COMP%]{background-color:var(--ghs-color-red)}.objective[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .objective[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%], .objective[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%], .objective[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]{transition:filter calc(var(--ghs-animation-speed) * .15s) ease-in-out}.objective.off[_ngcontent-%COMP%]{background-color:var(--ghs-color-gray);background-image:url(char-mat.5a0fee77df1ff44e.png);background-blend-mode:multiply}.objective.off[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .objective.off[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%], .objective.off[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]{filter:grayscale(100%)}.objective[_ngcontent-%COMP%]   ghs-character-initiative[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 1)}.objective[_ngcontent-%COMP%]   ghs-highlight-conditions[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 10.5);bottom:calc(var(--ghs-unit) * 2.5);z-index:20}.objective[_ngcontent-%COMP%]   .entity-menu-container[_ngcontent-%COMP%]{cursor:pointer;position:absolute;inset:0}.objective[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 2.1);left:calc(var(--ghs-unit) * 6);width:calc(var(--ghs-unit) * 9.5);height:calc(var(--ghs-unit) * 9.5);z-index:4}.objective[_ngcontent-%COMP%]   .drag-initiative.dragging[_ngcontent-%COMP%]{left:0!important;width:100%!important}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{height:100%;display:flex;flex-basis:100%;cursor:pointer}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:flex-start;z-index:2}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 24);overflow:visible}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .bar-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:flex-start}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-2[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 8);justify-content:space-evenly}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]{display:flex;align-items:center;overflow:visible}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]   ghs-entity-index-key[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1)}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{position:relative;display:flex;margin-left:calc(var(--ghs-unit) * .5);font-size:calc(var(--ghs-unit) * 2)}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{position:relative;margin-left:calc(var(--ghs-unit) * .5)}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]:hover{transform:translate(50%,50%) scale(2);transform-origin:center center;z-index:999}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]:hover:before{content:" ";position:absolute;top:calc(var(--ghs-unit) * -1);left:calc(var(--ghs-unit) * -1);right:calc(var(--ghs-unit) * -1);bottom:calc(var(--ghs-unit) * -1);background-color:var(--ghs-color-darkgray);opacity:.5;border-radius:calc(var(--ghs-unit) * 1)}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .action-overlay[_ngcontent-%COMP%]{position:absolute;z-index:1;top:calc(var(--ghs-unit) * 1);left:calc(var(--ghs-unit) * -.5)}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{pointer-events:none;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5);color:var(--ghs-color-white);text-shadow:var(--ghs-outline);display:flex;align-items:center;white-space:nowrap}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 5);width:auto;margin-left:calc(var(--ghs-unit) * -1);margin-right:calc(var(--ghs-unit) * .5)}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .status-bar[_ngcontent-%COMP%]{display:flex;align-items:center;z-index:2;touch-action:none}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline);width:calc(var(--ghs-unit) * 11 * var(--ghs-text-factor))}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));width:auto}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]   img.damage[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) brightness(.7) var(--ghs-filter-outline-thin-black)}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]   .value-overlay[_ngcontent-%COMP%]{z-index:1000}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 12);display:flex;justify-content:center;align-items:center;margin-right:calc(var(--ghs-unit) * 4)}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 8);width:auto}.objective[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]{display:flex;margin:calc(var(--ghs-unit) * 1.5) 0;margin-left:calc(var(--ghs-unit) * 1);position:relative;overflow:auto}.objective[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 28);display:flex;justify-content:center;font-size:calc(var(--ghs-unit) * 2.5)}.objective[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]   .bottom-spacer[_ngcontent-%COMP%]{display:block;position:relative;margin-top:2em}.objective[_ngcontent-%COMP%]   ghs-interactive-actions[_ngcontent-%COMP%]{position:absolute;font-size:calc(var(--ghs-unit) * 1.5);left:0;width:100%;bottom:0;z-index:999;border-bottom-left-radius:calc(var(--ghs-unit) * .5);border-bottom-right-radius:calc(var(--ghs-unit) * .5);overflow:hidden}.objective[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 9.5);height:calc(var(--ghs-unit) * 9.5);margin:calc(var(--ghs-unit) * 2.1) calc(var(--ghs-unit) * 3.4);left:calc(var(--ghs-unit) * 2.4);cursor:pointer;border-radius:calc(var(--ghs-unit) * 1);flex-shrink:0}.objective[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .objective-icon[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 9.5);height:calc(var(--ghs-unit) * 9.5);border-radius:100%;background-color:var(--ghs-color-darkgray);background:radial-gradient(circle,var(--ghs-color-black) 0%,var(--ghs-color-darkgray) 70%,var(--ghs-color-gray) 100%)}.objective[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .objective-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 8);width:auto}.objective[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .map-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 6.5)}.objective[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{position:absolute;bottom:calc(var(--ghs-unit) * -1);right:calc(var(--ghs-unit) * -1);font-size:calc(var(--ghs-unit) * 2.1);z-index:1}.objective[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;max-height:calc(var(--ghs-unit) * 7 * var(--ghs-text-factor));padding:0 calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.objective[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));background-color:var(--ghs-color-darkgray);border-radius:100%;height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));margin-right:calc(var(--ghs-unit) * -1 * var(--ghs-text-factor));border-width:calc(var(--ghs-unit) * .4);border-style:solid;border-color:var(--ghs-color-gray)}.objective[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.7 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 2.7 * var(--ghs-text-factor))}.objective[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]{position:relative;display:flex}.objective[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;margin-right:calc(var(--ghs-unit) * -.5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));overflow:visible}.objective[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));margin:0}.objective[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img.stack[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * -2 * var(--ghs-text-factor))}.objective[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition.condition-overlay[_ngcontent-%COMP%]{position:absolute;width:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));top:0;left:0;pointer-events:none;z-index:2}.objective[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));color:var(--ghs-color-white);position:absolute;top:calc(var(--ghs-unit) * 2.1 * var(--ghs-text-factor));left:50%;text-shadow:none;transform:translate(-50%)}.objective[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:hover{transform:scale(2);transform-origin:center center;z-index:999}.objective[_ngcontent-%COMP%]   .add-entity[_ngcontent-%COMP%], .objective[_ngcontent-%COMP%]   .short-menu[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.objective[_ngcontent-%COMP%]   .add-entity-button[_ngcontent-%COMP%], .objective[_ngcontent-%COMP%]   .toggle-menu[_ngcontent-%COMP%]{position:relative;display:flex;width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));cursor:pointer;font-size:calc(var(--ghs-unit) * 10 * var(--ghs-text-factor));color:var(--ghs-color-gray);filter:var(--ghs-filter-gray);stroke:var(--ghs-color-black);stroke-width:calc(var(--ghs-unit) * 1.5)}.objective[_ngcontent-%COMP%]   .add-entity-button[_ngcontent-%COMP%]:hover, .objective[_ngcontent-%COMP%]   .toggle-menu[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white);filter:var(--ghs-filter-white)}.objective[_ngcontent-%COMP%]   .add-entity-button.toggle-menu[_ngcontent-%COMP%], .objective[_ngcontent-%COMP%]   .toggle-menu.toggle-menu[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor))}.objective.denied[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{pointer-events:initial}.objective.short[_ngcontent-%COMP%]:not(.compact){width:calc(var(--ghs-unit) * 57);height:calc(var(--ghs-unit) * 28);background-image:url(char-mat-short.a094776e83c7bcfc.png),url(char-mat-short.a094776e83c7bcfc.png)}.objective.short[_ngcontent-%COMP%]:not(.compact)   .image-container[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * 2.8) calc(var(--ghs-unit) * 2)}.objective.short[_ngcontent-%COMP%]:not(.compact)   ghs-highlight-conditions[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 9);bottom:calc(var(--ghs-unit) * 16)}.objective.short[_ngcontent-%COMP%]:not(.compact)   .drag-initiative[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 2.8);left:calc(var(--ghs-unit) * 4.3)}.objective.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 2);right:calc(var(--ghs-unit) * 2);height:calc(var(--ghs-unit) * 26.5);flex-wrap:wrap}.objective.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 12);width:100%;max-width:initial;flex-direction:row;justify-content:flex-start;align-items:center}.objective.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   ghs-character-initiative[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 10);margin-top:calc(var(--ghs-unit) * 1);margin-left:initial}.objective.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 2)}.objective.compact[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 10.25);background-image:url(char-mat_compact.b0d0dd33f05dffe7.png),url(char-mat_compact.b0d0dd33f05dffe7.png)}.objective.compact[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 2.5);left:calc(var(--ghs-unit) * 6.5);width:calc(var(--ghs-unit) * 5);height:calc(var(--ghs-unit) * 5)}.objective.compact[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%], .objective.compact[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .objective-icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 6.5);height:calc(var(--ghs-unit) * 6.5)}.objective.compact[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .objective-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 8);width:auto}.objective.compact[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .map-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 5.2)}.objective.compact[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 1.8)}.objective.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%], .objective.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .bar-container[_ngcontent-%COMP%]{flex-direction:row;justify-content:flex-start;align-items:center}.objective.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{display:none}.objective.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]{width:auto;height:calc(var(--ghs-unit) * 7 * var(--ghs-text-factor));padding-top:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.objective.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .add-entity[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 6 * var(--ghs-text-factor))}.objective.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]{display:none}.objective.compact.short[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 57)}.objective.compact.short[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 1);width:calc(var(--ghs-unit) * 4.5);height:calc(var(--ghs-unit) * 4.5);margin:calc(var(--ghs-unit) * 2.1) calc(var(--ghs-unit) * .5)}.objective.compact.short[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .objective-icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4.5);height:calc(var(--ghs-unit) * 4.5)}.objective.compact.short[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .objective-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 6);width:auto}.objective.compact.short[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .map-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3.2)}.objective.compact.short[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 1.2)}.objective.compact.short[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 2)}.objective.compact.short[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * .5)}.objective.compact.short[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3);white-space:initial}.objective.compact.short[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .status-bar[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{width:auto}.objective.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1.5)}.objective.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .short-menu[_ngcontent-%COMP%]{display:none}.objective.compact.short.actions[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .short-menu[_ngcontent-%COMP%]{display:flex;position:absolute;top:0;right:calc(var(--ghs-unit) * 6);bottom:0}.objective.compact.short.actions[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%], .objective.compact.short.actions[_ngcontent-%COMP%]   .add-entity[_ngcontent-%COMP%], .objective.compact.short.actions[_ngcontent-%COMP%]   .column.col-2[_ngcontent-%COMP%]{display:none}.objective.compact.short.menu[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%], .objective.compact.short.menu[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%], .objective.compact.short.menu[_ngcontent-%COMP%]   ghs-highlight-conditions[_ngcontent-%COMP%]{display:none}.objective.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 4.5)}.objective.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{display:none}.objective.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%], .objective.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .add-entity[_ngcontent-%COMP%], .objective.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-2[_ngcontent-%COMP%]{display:inherit}.entities-container[_ngcontent-%COMP%]{position:relative;z-index:2;display:flex;transition:max-height calc(var(--ghs-animation-speed) * 1s) ease-out;max-height:100%;max-width:calc(var(--ghs-unit) * 96);margin-top:calc(var(--ghs-unit) * .25 * var(--ghs-text-factor))}.entities-container.empty[_ngcontent-%COMP%]{max-height:0}.entities-container[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{flex:none;width:calc(var(--ghs-unit) * 17.5);min-height:100%}.entities-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:block;width:auto;height:calc(var(--ghs-unit) * 8.5);margin-right:calc(var(--ghs-unit) * 1)}.entities-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]   img.menu[_ngcontent-%COMP%]{position:absolute;top:50%;left:calc(var(--ghs-unit) * -4);transform:translateY(-50%);width:calc(var(--ghs-unit) * 3.7 * var(--ghs-text-factor));height:auto;filter:var(--ghs-filter-darkgray);opacity:.5}.entities-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]:not(.empty){opacity:1;transform:translate(0)}.entities-container[_ngcontent-%COMP%]   .entities-menu.empty[_ngcontent-%COMP%]{opacity:0;height:0;max-width:0;transform:translateY(100%)}.entities-container[_ngcontent-%COMP%]   .entities-menu.disabled[_ngcontent-%COMP%]{cursor:initial;pointer-events:none}.entities-container[_ngcontent-%COMP%]   .entities-menu.disabled[_ngcontent-%COMP%]   img.menu[_ngcontent-%COMP%]{display:none}.entities-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]:hover   img.icon[_ngcontent-%COMP%]{opacity:.5}.entities-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]:hover   img.menu[_ngcontent-%COMP%]{opacity:1}.entities-container[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;max-width:calc(var(--ghs-unit) * 77.5)}.entities-container[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   ghs-standee[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * .5);transition:all calc(var(--ghs-animation-speed) * 1s) ease-out}']})}return a})();const Jz=["footer"],Qz=(a,r)=>({compact:a,modern:r}),Mc=a=>[a],tL=(a,r)=>({fh:a,modern:r}),vc=a=>({small:a}),nL=(a,r,n,i)=>({"loot-deck":a,"ally-deck":r,"drag-disabled":n,"backup-hint-spacer":i}),eL=(a,r)=>({last:a,short:r}),aL=a=>({enabled:a}),Oc=(a,r,n,i,e,o,g)=>({character:a,monster:r,"objective-container":n,"monster-full":i,"permanent-am":e,compact:o,short:g}),Pc=(a,r)=>r._trackUUID;function iL(a,r){if(1&a&&(t.j41(0,"span",16),t.nrm(1,"span",18),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","server.connectionTries")("ghs-label-args",t.eq3(2,Mc,n.gameManager.stateManager.connectionTries))}}function oL(a,r){1&a&&(t.j41(0,"span",17),t.nrm(1,"span",11),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","server.connectionTries.hint"))}function sL(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",4)(1,"div",10),t.nrm(2,"span",11),t.j41(3,"div",12)(4,"a",13),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.gameManager.stateManager.forceUpdateState())}),t.nrm(5,"span",11),t.j41(6,"span",14),t.nrm(7,"span",11),t.k0s()(),t.j41(8,"a",15),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.gameManager.stateManager.connect())}),t.nrm(9,"span",11),t.nVh(10,iL,2,4,"span",16),t.nVh(11,oL,2,1,"span",17),t.k0s()()()()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","server.blocked"),t.R7$(3),t.Y8G("ghs-label","server.force"),t.R7$(2),t.Y8G("ghs-label","server.forceHint"),t.R7$(2),t.Y8G("ghs-label","server.connect"),t.R7$(),t.vxM(n.gameManager.stateManager.connectionTries>0?10:-1),t.R7$(),t.vxM(n.gameManager.stateManager.connectionTries>4?11:-1)}}function rL(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",25),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.gameManager.stateManager.install())}),t.nrm(1,"img",26)(2,"span",11),t.k0s()}2&a&&(t.R7$(2),t.Y8G("ghs-label","app.install"))}function cL(a,r){if(1&a&&t.nrm(0,"img",31),2&a){const n=t.XpG().$implicit;t.Y8G("src",n.logoUrl,t.B4B)("ghs-tooltip","data.edition."+n.edition)}}function lL(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",30),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.startCampaign(e.edition))}),t.nVh(1,cL,1,2,"img",31),t.j41(2,"span",32),t.nrm(3,"span",11),t.k0s()()}if(2&a){const n=r.$implicit;t.R7$(),t.vxM(n.logoUrl?1:-1),t.R7$(),t.Y8G("ngClass",t.eq3(3,vc,n.logoUrl)),t.R7$(),t.Y8G("ghs-label","data.edition."+n.edition)}}function gL(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",33),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3),o=t.sdS(1);return c.Njj(o.openMenu(e.SubMenu.editions))}),t.nrm(1,"img",34)(2,"span",11),t.k0s()}2&a&&(t.R7$(2),t.Y8G("ghs-label","hints.addAdditionalContent"))}function dL(a,r){if(1&a&&(t.j41(0,"div",21),t.nrm(1,"p",11),t.j41(2,"div",27),t.Z7z(3,lL,4,5,"a",28,Pc),t.nI1(5,"trackUUID"),t.nVh(6,gL,3,1,"a",29),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","welcome.chooseEdition"),t.R7$(2),t.Dyx(t.bMT(5,2,n.gameManager.editionsData())),t.R7$(3),t.vxM(!n.gameManager.game.edition&&n.welcomeOtherEditions?6:-1)}}function hL(a,r){if(1&a&&t.nrm(0,"img",31),2&a){const n=t.XpG(3);t.Y8G("src",n.gameManager.editionLogo(n.gameManager.game.edition),t.B4B)("ghs-tooltip","data.edition."+n.gameManager.game.edition)}}function _L(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",36)(1,"div",39)(2,"label")(3,"input",38),t.bIt("change",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.settingsManager.toggle("fhSecondEdition"))}),t.k0s(),t.nrm(4,"span",11),t.k0s(),t.nrm(5,"img",40),t.j41(6,"span",41)(7,"div",42),t.nrm(8,"span",11),t.k0s()()()()}if(2&a){const n=t.XpG(3);t.R7$(3),t.Y8G("checked",n.settingsManager.settings.fhSecondEdition),t.R7$(),t.Y8G("ghs-label","settings.fhSecondEdition"),t.R7$(4),t.Y8G("ghs-label","settings.fhSecondEdition.hint")}}function mL(a,r){if(1&a&&t.nrm(0,"p",11),2&a){const n=t.XpG(3);t.Y8G("ghs-label","data.edition."+n.gameManager.game.edition+".hint")}}function pL(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",21)(1,"div",27)(2,"a",35),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.cancelCampaign(e.gameManager.game.edition))}),t.nVh(3,hL,1,2,"img",31),t.j41(4,"span",32),t.nrm(5,"span",11),t.k0s()()(),t.nVh(6,_L,9,3,"div",36),t.j41(7,"div",37),t.nVh(8,mL,1,1,"p",11),t.j41(9,"label")(10,"input",38),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.toggleCampaignMode())}),t.k0s(),t.nrm(11,"span",11),t.k0s()()()}if(2&a){const n=t.XpG(2);t.R7$(3),t.vxM(n.gameManager.editionLogo(n.gameManager.game.edition)?3:-1),t.R7$(),t.Y8G("ngClass",t.eq3(7,vc,n.gameManager.editionLogo(n.gameManager.game.edition))),t.R7$(),t.Y8G("ghs-label","data.edition."+n.gameManager.game.edition),t.R7$(),t.vxM("fh"==n.gameManager.game.edition?6:-1),t.R7$(2),t.vxM(n.welcomeEditionHint?8:-1),t.R7$(2),t.Y8G("checked",n.gameManager.game.party.campaignMode),t.R7$(),t.Y8G("ghs-label","party.campaignMode")}}function uL(a,r){1&a&&t.nrm(0,"p",11),2&a&&t.Y8G("ghs-label","welcome.orChooseCharacters")}function fL(a,r){1&a&&t.nrm(0,"p",11),2&a&&t.Y8G("ghs-label","welcome.chooseCharacters")}function CL(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",46),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.loading=!1)}),t.nrm(1,"span",11),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","app.loading.cancel"))}function ML(a,r){if(1&a&&(t.j41(0,"span"),t.nrm(1,"span",11),t.k0s(),t.j41(2,"div",43),t.nrm(3,"div",44),t.k0s(),t.nVh(4,CL,2,1,"a",45)),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","app.loading"),t.R7$(3),t.vxM(n.cancelLoading?4:-1)}}function vL(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",5),t.nrm(1,"img",19),t.nVh(2,rL,3,1,"a",20),t.j41(3,"h2"),t.nrm(4,"span",11),t.k0s(),t.nVh(5,dL,7,4,"div",21),t.nVh(6,pL,12,9,"div",21),t.j41(7,"div",21),t.nVh(8,uL,1,1,"p",11),t.nVh(9,fL,1,1,"p",11),t.j41(10,"a",22),t.bIt("click",function(){c.eBV(n);const e=t.XpG(),o=t.sdS(1);return c.Njj(o.openMenu(e.SubMenu.character_add))}),t.nrm(11,"span",11),t.k0s()(),t.j41(12,"div",23),t.nrm(13,"p",11),t.j41(14,"a",24),t.bIt("click",function(){c.eBV(n);const e=t.XpG(),o=t.sdS(1);return c.Njj(o.openMenu(e.SubMenu.settings))}),t.nrm(15,"span",11),t.k0s()(),t.nVh(16,ML,5,2),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.l_i(11,tL,"fh"==n.settingsManager.settings.theme,"modern"==n.settingsManager.settings.theme)),t.R7$(2),t.vxM(n.gameManager.stateManager.installPrompt?2:-1),t.R7$(2),t.Y8G("ghs-label","welcome"),t.R7$(),t.vxM(n.gameManager.game.edition?-1:5),t.R7$(),t.vxM(n.gameManager.game.edition?6:-1),t.R7$(2),t.vxM(n.gameManager.game.edition?-1:8),t.R7$(),t.vxM(n.gameManager.game.edition?9:-1),t.R7$(2),t.Y8G("ghs-label","hints.addCharacters"),t.R7$(2),t.Y8G("ghs-label","welcome.settings.text"),t.R7$(2),t.Y8G("ghs-label","welcome.settings"),t.R7$(),t.vxM(n.loading?16:-1)}}function OL(a,r){if(1&a&&t.nrm(0,"div",51),2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.Y8G("ngClass",t.sGs(2,Oc,i.gameManager.isCharacter(n),i.gameManager.isMonster(n),i.gameManager.isObjectiveContainer(n),i.settingsManager.settings.showFullAbilityCard,i.gameManager.isCharacter(n)&&i.gameManager.toCharacter(n).attackModifierDeckVisible&&i.settingsManager.settings.characterAttackModifierDeckPermanent,i.gameManager.isCharacter(n)&&i.settingsManager.settings.characterCompact,!(i.settingsManager.settings.abilities&&i.settingsManager.settings.stats||"modern"==i.settingsManager.settings.theme)))("clickBehind",!0)}}function PL(a,r){if(1&a&&t.nrm(0,"ghs-character",9),2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.Y8G("character",i.gameManager.toCharacter(n))}}function bL(a,r){if(1&a&&t.nrm(0,"ghs-monster",52),2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.Y8G("monster",i.gameManager.toMonster(n))}}function kL(a,r){if(1&a&&t.nrm(0,"ghs-objective-container",53),2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.Y8G("objective",i.gameManager.toObjectiveContainer(n))}}function yL(a,r){if(1&a&&t.nrm(0,"div",54),2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.Y8G("ngClass",t.sGs(2,Oc,i.gameManager.isCharacter(n),i.gameManager.isMonster(n),i.gameManager.isObjectiveContainer(n),i.settingsManager.settings.showFullAbilityCard,i.gameManager.isCharacter(n)&&i.gameManager.toCharacter(n).attackModifierDeckVisible&&i.settingsManager.settings.characterAttackModifierDeckPermanent,i.gameManager.isCharacter(n)&&i.settingsManager.settings.characterCompact,!(i.settingsManager.settings.abilities&&i.settingsManager.settings.stats||"modern"==i.settingsManager.settings.theme)))("clickBehind",!0)}}function xL(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",49),t.bIt("cdkDropListDropped",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.drop(e))})("cdkDropListEntered",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.entered(e))})("cdkDropListExited",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.exited(e))}),t.j41(1,"div",50,2),t.bIt("cdkDragStarted",function(e){c.eBV(n);const o=t.sdS(2),g=t.XpG(2);return c.Njj(g.startedDrag(e,o))})("cdkDragReleased",function(e){c.eBV(n);const o=t.sdS(2),g=t.XpG(2);return c.Njj(g.releasedDrag(e,o))}),t.nVh(3,OL,1,10,"div",51),t.nVh(4,PL,1,1,"ghs-character",9),t.nVh(5,bL,1,1,"ghs-monster",52),t.nVh(6,kL,1,1,"ghs-objective-container",53),t.nVh(7,yL,1,10,"div",54),t.k0s()()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.Y8G("figure-autoscroll",n)("block",i==e.lastScroll||i==e.lastScrollColumn?"end":"center")("cdkDropListData",i)("cdkDropListDisabled",!e.settingsManager.settings.dragFigures||e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.characters&&!e.gameManager.stateManager.permissions.monsters)("ngClass",t.l_i(12,eL,e.grid.includes(i+1)&&e.grid.indexOf(i+1)!=e.grid.length-1||i==e.figures.length-1,!(e.settingsManager.settings.abilities&&e.settingsManager.settings.stats||"modern"==e.settingsManager.settings.theme))),t.R7$(),t.Y8G("cdkDragStartDelay",e.isTouch?250:0)("ngClass",t.eq3(15,aL,e.draggingEnabled)),t.R7$(2),t.vxM(!e.gameManager.stateManager.permissions||e.gameManager.stateManager.permissions.characters||e.gameManager.stateManager.permissions.monsters?3:-1),t.R7$(),t.vxM(e.gameManager.isCharacter(n)?4:-1),t.R7$(),t.vxM(e.gameManager.isMonster(n)?5:-1),t.R7$(),t.vxM(e.gameManager.isObjectiveContainer(n)?6:-1),t.R7$(),t.vxM(!e.gameManager.stateManager.permissions||e.gameManager.stateManager.permissions.characters||e.gameManager.stateManager.permissions.monsters?7:-1)}}function EL(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",47),t.bIt("scroll",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.onFigureScroll(e))}),t.Z7z(1,xL,8,17,"div",48,Pc),t.nI1(3,"trackUUID"),t.k0s()}if(2&a){const n=t.XpG(),i=t.sdS(10);t.Y8G("ngClass",t.ziG(3,nL,i.lootDeckEnabeld,i.hasAllyAttackModifierDeck,!n.settingsManager.settings.dragFigures,n.showBackupHint)),t.R7$(),t.Dyx(t.bMT(3,1,n.figures))}}function wL(a,r){if(1&a&&t.nrm(0,"p",18),2&a){const n=t.XpG(2);t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrl.error.status")("ghs-label-args",t.eq3(2,Mc,n.gameManager.stateManager.backupError))}}function RL(a,r){1&a&&t.nrm(0,"p",11),2&a&&t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrl.error.unknown")}function jL(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",55),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.gameManager.stateManager.backupError=0)}),t.j41(1,"div",10),t.nrm(2,"h2",11),t.nVh(3,wL,1,4,"p",18),t.nVh(4,RL,1,1,"p",11),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrl.error"),t.R7$(),t.vxM(n.gameManager.stateManager.backupError>0?3:-1),t.R7$(),t.vxM(-1==n.gameManager.stateManager.backupError?4:-1)}}function GL(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",8)(1,"div",10)(2,"div",56),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.settingsManager.set("backupHint",!1))}),t.nrm(3,"span",11)(4,"img",57),t.k0s(),t.nrm(5,"h2",11)(6,"p",58),t.j41(7,"a",59),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.exportDataDump())}),t.nrm(8,"img",60)(9,"span",11),t.k0s(),t.j41(10,"label")(11,"input",61),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.settingsManager.setAutoBackupFinish(!e.settingsManager.settings.autoBackupFinish))}),t.k0s(),t.nrm(12,"span",11),t.k0s()()()}if(2&a){const n=t.XpG();t.R7$(3),t.Y8G("ghs-label","datamanagement.backup.download.hint.hide"),t.R7$(2),t.Y8G("ghs-label","datamanagement.backup"),t.R7$(),t.Y8G("ghs-label","datamanagement.backup.download.hint")("ghs-tooltip","datamanagement.backup.download.hint.text")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("ghs-label","datamanagement.backup.download"),t.R7$(2),t.Y8G("checked",n.settingsManager.settings.autoBackupFinish),t.R7$(),t.Y8G("ghs-label","datamanagement.backup.download.onFinish")}}function TL(a,r){if(1&a&&t.nrm(0,"ghs-character-fullview",9),2&a){const n=t.XpG();t.Y8G("character",n.fullviewChar)}}let SL=(()=>{class a{element;swUpdate;dialog;pointerInputService;ghsManager;gameManager=s.E;settingsManager=p.f;GameState=D.mk;figures=[];grid=[];SubMenu=In;initialized=!1;loading=!0;cancelLoading=!1;welcome=!1;welcomeOtherEditions=!1;welcomeEditionHint=!1;fullviewChar;showBackupHint=!1;draggingEnabled=!1;draggingeTimeout=null;isTouch=!1;lastScroll=-1;lastScrollColumn=-1;currentZoom=0;zoomDiff=-1;standeeDialog;standeeDialogSubscription;serverPing=0;serverPingInterval;initiativeSetDialog=!1;footer;constructor(n,i,e,o,g){var m=this;this.element=n,this.swUpdate=i,this.dialog=e,this.pointerInputService=o,this.ghsManager=g,this.ghsManager.onUiChange().subscribe({next:()=>{if(this.figures=s.E.game.figures.filter(k=>(p.f.settings.monsters||!(k instanceof b.R))&&(!(k instanceof H.K)||!k.absent||!p.f.settings.hideAbsent)),this.initialized){const k=s.E.game.figures.find(X=>X instanceof H.K&&X.fullview);k?(this.fullviewChar=k,this.welcome=!1):0==s.E.game.figures.length?(this.welcome=!0,this.welcomeOtherEditions=p.f.settings.editions.length<s.E.editionData.length,this.welcomeEditionHint=s.E.game.edition&&"hint"!=p.f.getLabel("data.edition."+s.E.game.edition+".hint")||!1):(this.fullviewChar=void 0,this.welcome=!1,this.calcColumns(),p.f.settings.automaticStandeesDialog&&p.f.settings.automaticStandees&&p.f.settings.standees&&!p.f.settings.randomStandees&&p.f.settings.scenarioRooms&&(this.standeeDialog&&"undo"==s.E.stateManager.lastAction&&this.standeeDialog.close(),0==this.dialog.openDialogs.length?this.automaticStandeeDialogs():this.standeeDialogSubscription||(this.standeeDialogSubscription=this.dialog.afterAllClosed.subscribe({next:()=>{this.automaticStandeeDialogs()}}))),this.showBackupHint=p.f.settings.backupHint&&!this.loading&&!s.E.game.scenario&&(s.E.game.party.scenarios.length>0||s.E.game.party.casualScenarios.length>0||s.E.game.parties.some(X=>X.casualScenarios.length>0)),p.f.settings.initiativeRequired&&p.f.settings.initiativeRoundConfirm&&s.E.game.state==D.mk.draw&&s.E.game.scenario?null!=s.E.game.figures.find(X=>X instanceof H.K&&s.E.entityManager.isAlive(X)&&!X.absent)&&s.E.game.figures.every(X=>!(X instanceof H.K)||!s.E.entityManager.isAlive(X)||X.absent||X.getInitiative()>0)?this.initiativeSetDialog||(this.initiativeSetDialog=this.dialog.open(fi,{panelClass:["dialog"],data:{label:"round.hint.initiativeRoundConfirm"}}),this.initiativeSetDialog.closed.subscribe({next:X=>{this.initiativeSetDialog="discard",X&&(this.initiativeSetDialog=!1,this.footer.next())}})):(this.initiativeSetDialog instanceof O.ce&&this.initiativeSetDialog.close(),this.initiativeSetDialog=!1):s.E.game.state==D.mk.next&&(this.initiativeSetDialog=!1))}this.serverPing!=p.f.settings.serverPing&&(this.serverPingInterval&&(clearInterval(this.serverPingInterval),this.serverPingInterval=null),this.serverPing=p.f.settings.serverPing,this.serverPing>0&&(this.serverPingInterval=setInterval(()=>{s.E.stateManager.sendPing()},1e3*this.serverPing)))}}),this.swUpdate.versionUpdates.subscribe(k=>{this.loading=!1,"VERSION_READY"==k.type?s.E.stateManager.hasUpdate=!0:"VERSION_INSTALLATION_FAILED"==k.type&&console.error(`Failed to install version '${k.version.hash}': ${k.error}`)}),this.swUpdate.unrecoverable.subscribe(k=>{this.loading=!1}),this.swUpdate.isEnabled?(this.swUpdate.checkForUpdate(),setInterval(()=>{this.swUpdate.checkForUpdate()},3e4)):this.loading=!1,setInterval(()=>{this.cancelLoading=!0},1e4),window.addEventListener("beforeinstallprompt",k=>{k.preventDefault(),s.E.stateManager.installPrompt=k}),window.addEventListener("appinstalled",()=>{s.E.stateManager.installPrompt=null}),window.addEventListener("visibilitychange",(0,I.A)(function*(){"hidden"===document.visibilityState&&p.f.settings.gameClock&&p.f.settings.automaticGameClock&&!s.E.stateManager.storageBlocked&&(yield m.automaticClockOut())})),window.addEventListener("blur",(0,I.A)(function*(){p.f.settings.gameClock&&p.f.settings.automaticGameClock&&p.f.settings.automaticGameClockFocus&&!s.E.stateManager.storageBlocked&&(yield m.automaticClockOut())}))}onFigureScroll(n){this.pointerInputService.cancel()}ngOnInit(){var n=this;return(0,I.A)(function*(){n.isTouch=window.matchMedia("(pointer: coarse)").matches,document.body.classList.add("no-select");try{yield G.n.init()}catch{}yield p.f.init(!1),n.initialized=!0,yield s.E.stateManager.init(),n.currentZoom=p.f.settings.zoom,document.body.style.setProperty("--ghs-factor",p.f.settings.zoom+""),document.body.style.setProperty("--ghs-barsize",p.f.settings.barsize+""),document.body.style.setProperty("--ghs-fontsize",p.f.settings.fontsize+""),document.body.style.setProperty("--ghs-global-fontsize",p.f.settings.globalFontsize+""),document.body.style.setProperty("--ghs-animation-speed",p.f.settings.animationSpeed+""),p.f.settings.gameClock&&p.f.settings.automaticGameClock&&n.automaticClockIn();const i=n.figures.find(e=>e instanceof H.K&&e.fullview);if(i?n.fullviewChar=i:(n.fullviewChar=void 0,n.calcColumns()),(n.swUpdate.isEnabled||n.isAppDevMode())&&document.body.addEventListener("click",e=>{p.f.settings.fullscreen&&(n.swUpdate.isEnabled||n.isAppDevMode())&&!document.body.classList.contains("fullscreen")&&document.body.requestFullscreen&&document.body.requestFullscreen()}),window.addEventListener("resize",e=>{n.fullviewChar||n.calcColumns()}),window.addEventListener("fullscreenchange",e=>{n.fullviewChar||n.calcColumns()}),window.addEventListener("focus",e=>{p.f.settings.serverAutoconnect&&s.E.stateManager.wsState()!=WebSocket.OPEN&&s.E.stateManager.connect(),p.f.settings.gameClock&&p.f.settings.automaticGameClock&&p.f.settings.automaticGameClockFocus&&n.automaticClockIn()}),p.f.settings.wakeLock&&"wakeLock"in navigator){try{s.E.stateManager.wakeLock=yield navigator.wakeLock.request("screen")}catch(e){console.error(e)}document.addEventListener("visibilitychange",(0,I.A)(function*(){null!==s.E.stateManager.wakeLock&&"visible"===document.visibilityState&&(s.E.stateManager.wakeLock=yield navigator.wakeLock.request("screen"))}))}n.debugTesting()})()}automaticClockIn(){const n=s.E.game.gameClock.length?s.E.game.gameClock[0]:void 0;(!n||n.clockOut)&&(n&&n.clockOut&&(new Date).getTime()-n.clockOut<7e3?n.clockOut=void 0:s.E.toggleGameClock())}automaticClockOut(){return(0,I.A)(function*(){const n=s.E.game.gameClock.length?s.E.game.gameClock[0]:void 0;n&&!n.clockOut&&(s.E.stateManager.before("gameClock.automaticGameClockOut"),s.E.toggleGameClock(),yield s.E.stateManager.after())})()}zoom(n){this.currentZoom+=n,document.body.style.setProperty("--ghs-factor",this.currentZoom+"")}touchmove(n){if(p.f.settings.pinchZoom&&2===n.touches.length){const i=Math.abs(n.touches[0].clientX-n.touches[1].clientX);this.zoomDiff>0&&(i>this.zoomDiff&&this.zoom(-1),i<this.zoomDiff&&this.zoom(1)),this.zoomDiff=i}}touchend(n){p.f.settings.pinchZoom&&n.touches.length<2&&this.zoomDiff>-1&&(this.zoomDiff=-1,p.f.setZoom(this.currentZoom))}startCampaign(n){s.E.stateManager.before("startCampaign","data.edition."+n),s.E.game.edition=n,p.f.settings.automaticTheme&&"modern"!=p.f.settings.theme&&(p.f.set("theme","fh"==n||"bb"==n?n:"default"),"gh2e"==n&&p.f.set("fhStyle",!0)),s.E.game.party.campaignMode=!0,s.E.game.party.edition=n,this.welcomeEditionHint=n&&"hint"!=p.f.getLabel("data.edition."+n+".hint")||!1,s.E.game.party.eventDecks={},s.E.eventCardManager.buildPartyDeckMigration(n),s.E.stateManager.after()}cancelCampaign(n){s.E.stateManager.before("cancelCampaign","data.edition."+n),s.E.game.edition=void 0,s.E.game.party.campaignMode=!1,s.E.game.party.eventDecks={},s.E.stateManager.after()}toggleCampaignMode(){s.E.stateManager.before(s.E.game.party.campaignMode?"disablePartyCampaignMode":"enablePartyCampaignMode"),s.E.game.party.campaignMode=!s.E.game.party.campaignMode,s.E.stateManager.after()}calcColumns(n=void 0,i=!1){this.grid=[999],p.f.settings.columns?setTimeout(()=>{const e=this.element.nativeElement.getElementsByClassName("figures")[0];if(e){this.lastScroll=this.lastActive();const o=Array.from(e.getElementsByClassName("figure"));if(o.length>0){const g=o[0].firstChild.clientWidth;if(Math.floor(e.clientWidth/(1.025*g))>1){const k=o.slice(0,this.lastScroll+1).map(at=>at.clientHeight),X=this.calcColumnsHelper(k,e.clientHeight,e.clientWidth,1.025*g).filter(at=>at.length);this.grid=X.map((at,tt,J)=>J.map(et=>et.length).slice(0,tt+1).reduce((et,ot)=>et+ot),0)}}this.lastScrollColumn=this.grid.length>1?this.grid.length-1:-1,this.translate(n,i)}},1):setTimeout(()=>{this.element.nativeElement.getElementsByClassName("figures")[0]&&this.translate(n,i)},1)}calcColumnsHelper(n,i,e,o){if(!n||0===n.length)return[];const g=n.reduce((ot,lt)=>ot+lt,0),m=Math.floor(e/o);if(!Number.isFinite(m)||m<=0||m>Number.MAX_SAFE_INTEGER)return[n];const k=Math.max(g/m,p.f.settings.columnsForce?0:i);let X=Array.from({length:m},()=>[]),at=Array(m).fill(0),tt=0;n.forEach(ot=>{at[tt]+ot>k&&tt<m-1&&tt++,X[tt].push(ot),at[tt]+=ot}),X=X.filter(ot=>ot.length),at=at.filter(ot=>ot);let J=!0,et=0;for(;J;){let ot=-1,lt=-1,St=0;for(let Ct=0;Ct<at.length;Ct++)Math.abs(at[Ct]-at[Ct+1])>St&&(St=Math.abs(at[Ct]-at[Ct+1]),at[Ct]<at[Ct+1]?(lt=Ct,ot=Ct+1):(lt=Ct+1,ot=Ct));if(St<=et){J=!1;break}if(-1==lt||-1==ot){J=!1;break}{const Ct=X[ot].splice(ot>lt?0:X[ot].length-1,1)[0];X[lt].push(Ct),at[lt]+=Ct,at[ot]-=Ct,et=St}}return X}lastActive(){let n=0;return this.figures.forEach((i,e)=>{e>n&&s.E.gameplayFigure(i)&&(n=e)}),n}translate(n=void 0,i=!1){setTimeout(()=>{const e=this.element.nativeElement.getElementsByClassName("figures")[0];if(e){i&&e.classList.add("no-animations");const o=e.getElementsByClassName("figure"),g=Math.ceil(this.grid.length/2);for(let m=0;m<o.length;m++){let k=0,X="0",at=this.grid.length-1,tt=0;for(let et=this.grid.length;et>0;et--)m<this.grid[et-1]&&(at=et-1);tt=at-g,this.grid.length%2==1&&(tt+=.5),X="calc(100% * "+tt+")",k=0==at?0:this.grid[at-1];let J=0;for(let et=k;et<m;et++)J+=o[et].clientHeight;o[m].style.transform="scale(1) translate("+X+","+J+"px)",n?setTimeout(()=>{n.scrollIntoView({behavior:p.f.settings.animations?"smooth":"auto",block:m==this.lastScroll||m==this.lastScrollColumn?"end":"center",inline:"center"}),i&&e.classList.remove("no-animations")},!p.f.settings.animations||i?0:250*p.f.settings.animationSpeed):i&&setTimeout(()=>{e.classList.remove("no-animations")},p.f.settings.animations?250*p.f.settings.animationSpeed:0)}}},1)}startedDrag(n,i){this.pointerInputService.cancel(),this.draggingEnabled=!0,i.classList.add("dragging"),n.source.getPlaceholderElement().classList.add("dragging"),window.document.body.classList.add("dragging"),this.draggingeTimeout&&clearTimeout(this.draggingeTimeout)}releasedDrag(n,i){this.draggingEnabled=!1,i.classList.remove("dragging"),window.document.body.classList.remove("dragging"),n.source.getPlaceholderElement().classList.remove("dragging"),this.draggingeTimeout&&clearTimeout(this.draggingeTimeout)}drop(n){if(n.previousContainer!=n.container&&(0==n.currentIndex&&n.container.data!=n.previousContainer.data+1||0!=n.currentIndex&&n.container.data!=n.previousContainer.data-n.currentIndex)){let i=n.previousContainer.data,e=n.container.data;n.currentIndex>0&&n.previousContainer.data>n.container.data?e++:0==n.currentIndex&&n.previousContainer.data<n.container.data&&e--,s.E.stateManager.before("reorder"),(0,V.HD)(s.E.game.figures,i,e),s.E.stateManager.after(),this.calcColumns(n.item.element.nativeElement,!0)}else this.translate(void 0,!0);this.draggingEnabled=!1}entered(n){this.translate()}exited(n){this.translate()}automaticStandeeDialogs(){if(!s.E.stateManager.standeeDialogCanceled&&0==this.dialog.openDialogs.length&&0==s.E.game.scenarioRules.length){const n=s.E.game.figures.find(i=>i instanceof b.R&&i.entities.find(e=>e.number<1&&s.E.entityManager.isAlive(e)));if(n){const i=n;let e=i.entities.find(o=>o.number<1&&s.E.entityManager.isAlive(o)&&(p.f.settings.eliteFirst&&o.type==S.N.elite||!p.f.settings.eliteFirst&&o.type==S.N.normal));e||(e=i.entities.find(o=>o.number<1&&s.E.entityManager.isAlive(o))),this.standeeDialog=this.dialog.open(ua,{panelClass:["dialog"],disableClose:!0,data:{monster:i,type:e&&e.type,entity:e,range:[],entities:i.entities,automatic:!0}}),this.standeeDialog.closed.subscribe({next:o=>{o&&(s.E.stateManager.standeeDialogCanceled=!0),this.standeeDialog=void 0,this.standeeDialogSubscription&&(this.standeeDialogSubscription.unsubscribe(),this.standeeDialogSubscription=void 0),this.ghsManager.triggerUiChange()}})}}}exportDataDump(){return(0,I.A)(function*(){try{let n=yield G.n.datadump(),i=document.createElement("a");i.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(n))),i.setAttribute("download","ghs-data-dump_"+(new Date).toISOString()+".json"),document.body.appendChild(i),i.click(),document.body.removeChild(i)}catch{console.warn("Could not read datadump")}})()}isAppDevMode(){return(0,x.naY)()}debugTesting(){}static \u0275fac=function(i){return new(i||a)(t.rXU(t.aKT),t.rXU(R.EI),t.rXU(O.lG),t.rXU(Fo),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-main"]],viewQuery:function(i,e){if(1&i&&t.GBs(Jz,5),2&i){let o;t.mGM(o=t.lsd())&&(e.footer=o.first)}},standalone:!1,decls:11,vars:12,consts:[["header",""],["footer",""],["figureDrag",""],["ghs-keyboard-shortcuts","",3,"ngClass","header","footer"],[1,"dialog","blocked"],[1,"welcome",3,"ngClass"],["cdkDropListGroup","",1,"figures",3,"ngClass"],[1,"dialog","backup-error"],[1,"dialog","backup-hint"],[3,"character"],[1,"dialog-container"],[3,"ghs-label"],[1,"buttons"],[1,"force",3,"click"],[1,"force-hint"],[1,"connect",3,"click"],[1,"tries"],[1,"tries-hint"],[3,"ghs-label","ghs-label-args"],["src","./assets/images/logo-transparent.svg",1,"ghs-logo"],[1,"install"],[1,"container-row","bordered"],["tabclick","",1,"add-characters",3,"click"],[1,"container-row","settings"],["tabclick","",1,"settings-menu",3,"click"],[1,"install",3,"click"],["src","./assets/images/install.svg",1,"ghs-svg"],[1,"editions"],["tabclick","",1,"edition"],["tabclick","",1,"edition","add-additional-content"],["tabclick","",1,"edition",3,"click"],[3,"src","ghs-tooltip"],[1,"text",3,"ngClass"],["tabclick","",1,"edition","add-additional-content",3,"click"],["src","./assets/images/plus.svg",1,"ghs-svg"],["tabclick","",1,"edition","selected",3,"click"],[1,"fh-second-edition"],[1,"edition-hint"],["tabclick","","type","checkbox",3,"change","checked"],[1,"hint-container"],["src","./assets/images/hint.svg",1,"hint-trigger","ghs-svg"],[1,"hint"],[1,"text"],[1,"loading-bar-container"],[1,"loading-bar"],[1,"loading-cancel"],[1,"loading-cancel",3,"click"],["cdkDropListGroup","",1,"figures",3,"scroll","ngClass"],["cdkDropList","","cdkDropListAutoScrollStep","20",1,"figure",3,"figure-autoscroll","block","cdkDropListData","cdkDropListDisabled","ngClass"],["cdkDropList","","cdkDropListAutoScrollStep","20",1,"figure",3,"cdkDropListDropped","cdkDropListEntered","cdkDropListExited","figure-autoscroll","block","cdkDropListData","cdkDropListDisabled","ngClass"],["cdkDrag","",3,"cdkDragStarted","cdkDragReleased","cdkDragStartDelay","ngClass"],["cdkDragHandle","","ghs-pointer-input","",1,"handle",3,"ngClass","clickBehind"],[3,"monster"],[3,"objective"],["cdkDragHandle","","ghs-pointer-input","",1,"handle","right",3,"ngClass","clickBehind"],[1,"dialog","backup-error",3,"click"],[1,"hide",3,"click"],["src","./assets/images/close.svg"],[3,"ghs-label","ghs-tooltip","originY","overlayY"],[3,"click"],["src","./assets/images/export.svg",1,"ghs-svg"],["type","checkbox",3,"change","checked"]],template:function(i,e){if(1&i&&(t.nrm(0,"ghs-header",null,0),t.j41(2,"main",3),t.nVh(3,sL,12,6,"div",4),t.nVh(4,vL,17,14,"div",5),t.nVh(5,EL,4,8,"div",6),t.nVh(6,jL,5,3,"div",7),t.nVh(7,GL,13,9,"div",8),t.nVh(8,TL,1,1,"ghs-character-fullview",9),t.k0s(),t.nrm(9,"ghs-footer",null,1)),2&i){const o=t.sdS(1),g=t.sdS(10);t.R7$(2),t.Y8G("ngClass",t.l_i(9,Qz,g.compact,"modern"==e.settingsManager.settings.theme))("header",o)("footer",g),t.R7$(),t.vxM(e.gameManager.stateManager.updateBlocked&&e.settingsManager.settings.serverUrl&&e.settingsManager.settings.serverPort&&e.settingsManager.settings.serverCode?3:-1),t.R7$(),t.vxM(!e.fullviewChar&&e.welcome?4:-1),t.R7$(),t.vxM(e.fullviewChar||e.welcome?-1:5),t.R7$(),t.vxM(e.gameManager.stateManager.backupError?6:-1),t.R7$(),t.vxM(e.showBackupHint?7:-1),t.R7$(),t.vxM(e.fullviewChar?8:-1)}},dependencies:[N.YU,V.O7,V.RK,V.T1,V.Fb,or,r5,kd,CU,it,Mt,Cn,Ha,ez,Zz,dt,Ft,ct],styles:['[_nghost-%COMP%]{overflow:hidden}ghs-header[_ngcontent-%COMP%], ghs-footer[_ngcontent-%COMP%]{position:fixed;left:0;right:0;z-index:2;flex-shrink:0}ghs-header[_ngcontent-%COMP%]{top:0;height:calc(var(--ghs-unit) * 8 * var(--ghs-text-factor) * var(--ghs-barsize))}ghs-footer[_ngcontent-%COMP%]{bottom:0;height:calc(var(--ghs-unit) * 11 * var(--ghs-text-factor) * var(--ghs-barsize))}main[_ngcontent-%COMP%]{position:fixed;left:0;right:0;top:calc(var(--ghs-unit) * 8 * var(--ghs-text-factor) * var(--ghs-barsize));bottom:calc(var(--ghs-unit) * 11 * var(--ghs-text-factor) * var(--ghs-barsize));display:flex;flex-direction:column;align-items:center;z-index:1}.loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%;height:100%;overflow:auto;color:var(--ghs-color-darkgray);font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.loading[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-width:calc(var(--ghs-unit) * 30 * var(--ghs-text-factor));border-radius:5px}.loading[_ngcontent-%COMP%]   .ghs-logo[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));filter:var(--ghs-filter-outline)}.blocked[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:999;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));text-align:center;color:var(--ghs-color-white)}.blocked[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly;align-items:flex-start}.blocked[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;min-width:33%;display:flex;justify-content:center}.blocked[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.blocked[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;color:var(--ghs-color-green)}.blocked[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%]   .tries[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.blocked[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%]   .tries-hint[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));color:var(--ghs-color-yellow-light)}.blocked[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .force[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;color:var(--ghs-color-yellow)}.blocked[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .force[_ngcontent-%COMP%]   .force-hint[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));color:var(--ghs-color-yellow-light)}.welcome[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:center;width:100%;height:100%;overflow:auto}.welcome[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-width:calc(var(--ghs-unit) * 35 * var(--ghs-text-factor));border-radius:5px;filter:var(--ghs-filter-shadow)}.welcome[_ngcontent-%COMP%]   .ghs-logo[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));max-width:calc(var(--ghs-unit) * 25 * var(--ghs-text-factor));filter:var(--ghs-filter-outline)}.welcome[_ngcontent-%COMP%]   .loading-bar-container[_ngcontent-%COMP%]{height:2px;width:100%;max-width:calc(var(--ghs-unit) * 30 * var(--ghs-text-factor));overflow:hidden;position:relative;background-color:var(--ghs-color-gray);border-radius:2px}.welcome[_ngcontent-%COMP%]   .loading-bar-container[_ngcontent-%COMP%]   .loading-bar[_ngcontent-%COMP%]{height:100%;width:50%;background-color:var(--ghs-color-darkgray);position:absolute;left:-50%;animation:_ngcontent-%COMP%_loading calc(var(--ghs-animation-speed) * .2s) ease-in calc(var(--ghs-animation-speed) * .5s) infinite;border-radius:2px}@keyframes _ngcontent-%COMP%_loading{0%{transform:translate(0)}to{transform:translate(400%)}}.welcome[_ngcontent-%COMP%]   .loading-cancel[_ngcontent-%COMP%]{cursor:pointer;margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));color:var(--ghs-color-darkgray);font-family:var(--ghs-font-text)}.welcome[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray);font-size:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor));text-align:center;margin-top:calc(var(--ghs-unit) * -7 * var(--ghs-text-factor));margin-bottom:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));text-shadow:var(--ghs-outline-white-thin)}.welcome[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray);font-family:var(--ghs-font-text);margin:calc(var(--ghs-unit) * .2 * var(--ghs-text-factor));font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));text-align:center}.welcome[_ngcontent-%COMP%]   .container-row[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;padding-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 80 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .container-row.bordered[_ngcontent-%COMP%]{border-bottom:calc(var(--ghs-unit) * .3 * var(--ghs-text-factor)) solid var(--ghs-color-darkgray)}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;max-width:calc(var(--ghs-unit) * 80 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;cursor:pointer;max-width:calc(var(--ghs-unit) * 40 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor)) calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));text-shadow:var(--ghs-outline)}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]   .text.small[_ngcontent-%COMP%]{display:none;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));color:var(--ghs-color-darkgray);text-shadow:none}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.selected[_ngcontent-%COMP%], .welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.selected[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:calc(var(--ghs-unit) * 50 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.selected[_ngcontent-%COMP%]   .text.small[_ngcontent-%COMP%]{display:block}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]:hover{filter:brightness(.8) grayscale(.4)}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]:hover   .text[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.add-additional-content[_ngcontent-%COMP%]{flex-direction:row;color:var(--ghs-color-darkgray);font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.add-additional-content[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1.2em;width:auto;margin:0 .2em;filter:var(--ghs-filter-darkgray)}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.add-additional-content[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.add-additional-content[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}@media (orientation: portrait){.welcome[_ngcontent-%COMP%]   .ghs-logo[_ngcontent-%COMP%]{max-width:calc(var(--ghs-unit) * 20 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%], .welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:calc(var(--ghs-unit) * 50 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]   .text.small[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.selected[_ngcontent-%COMP%], .welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.selected[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:calc(var(--ghs-unit) * 60 * var(--ghs-text-factor))}}.welcome[_ngcontent-%COMP%]   .fh-second-edition[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .fh-second-edition[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{color:var(--ghs-color-black)}.welcome[_ngcontent-%COMP%]   .fh-second-edition[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before{color:var(--ghs-color-black);background-color:var(--ghs-color-black)}.welcome[_ngcontent-%COMP%]   .fh-second-edition[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover:before{background-color:var(--ghs-color-darkgray)}.welcome[_ngcontent-%COMP%]   .fh-second-edition[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center}.welcome[_ngcontent-%COMP%]   .fh-second-edition[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   .hint-trigger.ghs-svg[_ngcontent-%COMP%]{width:auto;filter:var(--ghs-filter-black) var(--ghs-filter-shadow)}.welcome[_ngcontent-%COMP%]   .edition-hint[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.welcome[_ngcontent-%COMP%]   .edition-hint[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));color:var(--ghs-color-darkgray);text-align:justify}.welcome[_ngcontent-%COMP%]   .edition-hint[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));color:var(--ghs-color-black);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .edition-hint[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{color:var(--ghs-color-black)}.welcome[_ngcontent-%COMP%]   .edition-hint[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before{color:var(--ghs-color-black);background-color:var(--ghs-color-black)}.welcome[_ngcontent-%COMP%]   .edition-hint[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover:before{background-color:var(--ghs-color-darkgray)}.welcome[_ngcontent-%COMP%]   .settings-menu[_ngcontent-%COMP%], .welcome[_ngcontent-%COMP%]   .add-characters[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray);cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .settings-menu[_ngcontent-%COMP%]:hover, .welcome[_ngcontent-%COMP%]   .add-characters[_ngcontent-%COMP%]:hover{opacity:.6}.welcome[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]   .settings-menu[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * .2 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .install[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;justify-content:center;color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor) * var(--ghs-barsize));z-index:2}.welcome[_ngcontent-%COMP%]   .install[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:.9em;height:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.welcome[_ngcontent-%COMP%]   .install[_ngcontent-%COMP%]:hover{color:var(--ghs-color-darkgray)}.welcome[_ngcontent-%COMP%]   .install[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)}.welcome.fh[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .welcome.fh[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .welcome.fh[_ngcontent-%COMP%]   .install[_ngcontent-%COMP%]{color:var(--ghs-color-black)}.welcome.fh[_ngcontent-%COMP%]   .install[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-black)}.welcome.fh[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%], .welcome.fh[_ngcontent-%COMP%]   .add-characters[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray);filter:none}.columns[_ngcontent-%COMP%]{display:flex;width:100%;overflow:auto;-ms-overflow-style:none;scrollbar-width:none}.columns[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.figures[_ngcontent-%COMP%]{display:flex;height:100%;max-height:100%;width:100%;max-width:100%;overflow:auto;transform:translateZ(0);scroll-behavior:smooth;transform-style:preserve-3d;scrollbar-width:none;-ms-overflow-style:none}.figures[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.figures[_ngcontent-%COMP%]   .figure[_ngcontent-%COMP%]{position:absolute;top:0;left:50%;transition:transform calc(var(--ghs-animation-speed) * .25s) ease-in-out,width calc(var(--ghs-animation-speed) * .1s) ease-in-out,height calc(var(--ghs-animation-speed) * .25s) ease-in-out;transform:scale(0);overflow:unset}.figures[_ngcontent-%COMP%]   .figure[_ngcontent-%COMP%]   .cdk-drag[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 98);margin:calc(var(--ghs-unit) * .8) calc(var(--ghs-unit) * 1)}.figures[_ngcontent-%COMP%]   .figure[_ngcontent-%COMP%]   .cdk-drag[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(2){position:relative;display:block}.figures[_ngcontent-%COMP%]   .figure[_ngcontent-%COMP%]   .cdk-drag.enabled[_ngcontent-%COMP%]{cursor:grabbing}.figures[_ngcontent-%COMP%]   .figure[_ngcontent-%COMP%]   .cdk-drag.dragging[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:calc(var(--ghs-unit) * -1);left:calc(var(--ghs-unit) * -1);bottom:calc(var(--ghs-unit) * -1);right:calc(var(--ghs-unit) * -1);border-radius:calc(var(--ghs-unit) * 1);background-color:var(--ghs-color-darkgray);opacity:.5}.figures[_ngcontent-%COMP%]   .figure.short[_ngcontent-%COMP%]   .cdk-drag[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 57)}.figures.ally-deck[_ngcontent-%COMP%]   .figure.last[_ngcontent-%COMP%]{padding-bottom:calc(var(--ghs-unit) * 14.5 * var(--ghs-text-factor) * var(--ghs-barsize))}.figures.loot-deck[_ngcontent-%COMP%]   .figure.last[_ngcontent-%COMP%]{padding-bottom:calc(var(--ghs-unit) * 25.5 * var(--ghs-text-factor) * var(--ghs-barsize))}.figures.backup-hint-spacer[_ngcontent-%COMP%]   .figure.last[_ngcontent-%COMP%]{padding-bottom:50%!important}.figures.drag-disabled[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{display:none}.compact[_ngcontent-%COMP%]   .figures[_ngcontent-%COMP%]   .figure.last[_ngcontent-%COMP%]{padding-bottom:calc(var(--ghs-unit) * 13.5 * var(--ghs-text-factor) * var(--ghs-barsize))}.compact[_ngcontent-%COMP%]   .figures.ally-deck[_ngcontent-%COMP%]   .figure.last[_ngcontent-%COMP%], .compact[_ngcontent-%COMP%]   .figures.loot-deck[_ngcontent-%COMP%]   .figure.last[_ngcontent-%COMP%]{padding-bottom:calc(var(--ghs-unit) * 26.5 * var(--ghs-text-factor) * var(--ghs-barsize))}.handle[_ngcontent-%COMP%]{position:absolute;cursor:grab;top:0;left:calc(var(--ghs-unit) * (-2 + var(--ghs-text-factor)));width:calc(var(--ghs-unit) * 8);height:100%;z-index:2}.handle[_ngcontent-%COMP%]:hover:before{display:block;content:" ";position:absolute;left:calc(var(--ghs-unit) * -.5);width:calc(var(--ghs-unit) * 1);height:100%;background-color:var(--ghs-color-darkgray);opacity:.5;border-radius:calc(var(--ghs-unit) * 1)}.handle.enabled[_ngcontent-%COMP%]{cursor:grabbing}.handle.short[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4)}.handle.character[_ngcontent-%COMP%], .handle.objective-container[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 14)}.handle.character.character.compact[_ngcontent-%COMP%], .handle.objective-container.character.compact[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 10.25)}.handle.monster[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 21.5)}.handle.monster.monster-full[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 24)}.handle.right[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * (-2 + var(--ghs-text-factor)));left:auto}.handle.right[_ngcontent-%COMP%]:hover:before{right:calc(var(--ghs-unit) * -.5);left:auto}.handle.right.character.compact[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4)}.modern[_ngcontent-%COMP%]   .handle.character[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 16)}.modern[_ngcontent-%COMP%]   .handle.character.character.permanent-am[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 28)}.cdk-drag-preview[_ngcontent-%COMP%]{padding:calc(var(--ghs-unit) * .5) calc(var(--ghs-unit) * 1)}.cdk-drag-preview[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{display:none}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.8;transform:initial;margin-bottom:calc(var(--ghs-unit) * .5)}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%], .cdk-drop-list-receiving[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{display:none}.cdk-drop-list-dragging[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}.backup-error[_ngcontent-%COMP%]{cursor:zoom-out;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center}.backup-error[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--ghs-color-yellow);font-size:2em;padding:0;margin:calc(var(--ghs-unit) * .5) 0}.backup-error[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ghs-color-white);font-size:1.5em}.backup-hint[_ngcontent-%COMP%]{position:absolute;bottom:0;display:flex;flex-direction:column;align-items:center;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));color:var(--ghs-color-white)}.backup-hint[_ngcontent-%COMP%]   .hide[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));color:var(--ghs-color-darkgray);cursor:pointer;display:flex;justify-content:flex-end;align-items:center;z-index:1;margin-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.backup-hint[_ngcontent-%COMP%]   .hide[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto;margin:0 .2em;filter:var(--ghs-filter-darkgray)}.backup-hint[_ngcontent-%COMP%]   .hide[_ngcontent-%COMP%]:hover{color:var(--ghs-color-gray)}.backup-hint[_ngcontent-%COMP%]   .hide[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}.backup-hint[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2em;padding:0;margin:calc(var(--ghs-unit) * .5) 0}.backup-hint[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1em;padding:0;margin:calc(var(--ghs-unit) * .5) 0}.backup-hint[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer;font-size:1.5em;color:var(--ghs-color-gray);margin:calc(var(--ghs-unit) * 1.5) 0}.backup-hint[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}.backup-hint[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-gray)}.backup-hint[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer}.backup-hint[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{color:var(--ghs-color-gray);width:1.2em;height:1.2em;border-width:.1em;margin-right:.3em}.backup-hint[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before{color:var(--ghs-color-gray);background-color:var(--ghs-color-gray)}']})}return a})();var Ht=v(5474);const vo=(a,r)=>r._trackUUID;function DL(a,r){if(1&a&&(t.j41(0,"option",5),t.nrm(1,"span",3),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n),t.R7$(),t.Y8G("ghs-label","data.edition."+n)}}function $L(a,r){if(1&a&&(t.j41(0,"option",5),t.nrm(1,"span",3),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n.name),t.R7$(),t.Y8G("ghs-label","data.character."+n.edition+"."+n.name)}}function IL(a,r){if(1&a&&t.nrm(0,"ghs-attackmodifier",9),2&a){const n=r.$implicit,i=t.XpG(2).$implicit,e=t.XpG();t.Y8G("attackModifier",n)("flipped",!0)("characterIcon",e.gameManager.characterManager.characterIcon(i))("newStyle",e.settingsManager.settings.fhStyle||e.gameManager.newAmStyle(i.edition))}}function AL(a,r){if(1&a&&(t.j41(0,"div",8)(1,"h1"),t.nrm(2,"span",3),t.EFF(3),t.k0s(),t.Z7z(4,IL,1,4,"ghs-attackmodifier",9,vo),t.nI1(6,"trackUUID"),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(2),t.Y8G("ghs-label","data.character."+n.edition+"."+n.name),t.R7$(),t.SpI(" [",n.attackModifierDeck.cards.length,"] "),t.R7$(),t.Dyx(t.bMT(6,2,n.attackModifierDeck.cards))}}function VL(a,r){if(1&a&&t.nVh(0,AL,7,4,"div",8),2&a){const n=r.$implicit;t.vxM(n&&n.attackModifierDeck.cards.length>0?0:-1)}}let FL=(()=>{class a{route;router;gameManager=s.E;settingsManager=p.f;characterName=[];characters=[];filteredCharacters=[];edition;constructor(n,i){this.route=n,this.router=i}ngOnInit(){var n=this;return(0,I.A)(function*(){yield p.f.init(!1),s.E.stateManager.init(!0),n.edition=s.E.editions(!0)[0],n.update(),n.route.queryParams.subscribe({next:i=>{let e=!1;i.edition&&(n.edition=i.edition,n.edition&&s.E.editions(!1).includes(n.edition),e=!0),i.characters&&(n.characterName="string"==typeof i.characters?[i.characters]:i.characters,e=!0),e&&n.update()}})})()}update(){this.characters=[],s.E.charactersData(this.edition).forEach(n=>{let i=new H.K(n,0);i.attackModifierDeck.cards=[];let e=0;i.perks.forEach(o=>{o.cards&&o.cards.forEach((g,m)=>{if(o.type==we.RU.add||o.type==we.RU.replace){let k=Object.assign(new w.uU(g.attackModifier.type),g.attackModifier);if(k.id="perk"+e,(!s.E.attackModifierManager.findByAttackModifier(w.zs,k)||o.type==we.RU.add||m>0)&&(k.character=!0),k.character){s.E.attackModifierManager.findByAttackModifier(i.attackModifierDeck.cards,k)||e++;for(let X=0;X<g.count*o.count;X++)i.attackModifierDeck.cards=[...i.attackModifierDeck.cards,k]}}})}),this.characters.push(i)}),this.characters.sort((n,i)=>n.edition!=i.edition?n.edition<i.edition?-1:1:p.f.getLabel("data.character."+n.edition+"."+n.name).toLowerCase()<p.f.getLabel("data.character."+i.edition+"."+i.name).toLowerCase()?-1:1),this.filteredCharacters=[],this.characterName.forEach(n=>{const i=this.characters.find(e=>e.name==n);i&&this.filteredCharacters.push(i)})}updateQueryParams(){this.router.navigate([],{relativeTo:this.route,queryParams:{edition:this.edition||void 0,characters:this.characterName||void 0},queryParamsHandling:"merge"})}static \u0275fac=function(i){return new(i||a)(t.rXU(Ht.nX),t.rXU(Ht.Ix))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-attackmodifier-tool"]],standalone:!1,decls:18,vars:9,consts:[[1,"container"],[3,"standalone"],[1,"menu"],[3,"ghs-label"],[3,"ngModelChange","change","ngModel"],[3,"value"],["multiple","",3,"ngModelChange","change","ngModel"],[1,"characters"],[1,"character"],[3,"attackModifier","flipped","characterIcon","newStyle"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nrm(1,"ghs-header",1),t.j41(2,"div",2)(3,"label"),t.nrm(4,"span",3),t.j41(5,"select",4),t.mxI("ngModelChange",function(g){return t.DH7(e.edition,g)||(e.edition=g),g}),t.bIt("change",function(){return e.update(),e.updateQueryParams()}),t.Z7z(6,DL,2,2,"option",5,t.fX1),t.k0s()(),t.j41(8,"label"),t.nrm(9,"span",3),t.j41(10,"select",6),t.mxI("ngModelChange",function(g){return t.DH7(e.characterName,g)||(e.characterName=g),g}),t.bIt("change",function(){return e.update(),e.updateQueryParams()}),t.Z7z(11,$L,2,2,"option",5,vo),t.nI1(13,"trackUUID"),t.k0s()()(),t.j41(14,"div",7),t.Z7z(15,VL,1,1,null,null,vo),t.nI1(17,"trackUUID"),t.k0s()()),2&i&&(t.R7$(),t.Y8G("standalone",!0),t.R7$(3),t.Y8G("ghs-label","settings.edition"),t.R7$(),t.R50("ngModel",e.edition),t.R7$(),t.Dyx(e.gameManager.editions(!0)),t.R7$(3),t.Y8G("ghs-label","settings.character"),t.R7$(),t.R50("ngModel",e.characterName),t.R7$(),t.Dyx(t.bMT(13,5,e.characters)),t.R7$(4),t.Dyx(t.bMT(17,7,e.filteredCharacters)))},dependencies:[E.xH,E.y7,E.wz,E.W0,E.BC,E.vS,We,it,Cn,ct],styles:[".container[_ngcontent-%COMP%]{width:100vw;height:100vh;display:flex;flex-direction:column}.container[_ngcontent-%COMP%]   ghs-header[_ngcontent-%COMP%]{z-index:2}.characters[_ngcontent-%COMP%]{display:flex;overflow:auto}.characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{display:flex;flex-direction:column}.characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%]{width:300px;min-width:300px;height:200px;min-height:200px;margin:10px}"]})}return a})();const XL=a=>({"bottom-actions":a}),Wa=(a,r)=>r._trackUUID;function BL(a,r){if(1&a&&(t.j41(0,"option",5),t.nrm(1,"span",3),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n),t.R7$(),t.Y8G("ghs-label","data.edition."+n)}}function YL(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",7),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return e.settingsManager.toggle("calculateStats"),c.Njj(e.update())}),t.k0s(),t.nrm(2,"span",3),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("checked",n.settingsManager.settings.calculateStats),t.R7$(),t.Y8G("ghs-label","settings.calcStats")}}function UL(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",6),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.entity,e)||(o.entity=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return e.update(),c.Njj(e.updateQueryParams())}),t.k0s(),t.nrm(2,"span",3),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.R50("ngModel",n.entity),t.R7$(),t.Y8G("ghs-label","tools.decks.entity")}}function NL(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",6),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.elite,e)||(o.elite=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.update())}),t.k0s(),t.nrm(2,"span",3),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.R50("ngModel",n.elite),t.R7$(),t.Y8G("ghs-label","tools.decks.elite")}}function zL(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",9),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.level,e)||(o.level=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.update())}),t.k0s(),t.nrm(2,"span",3),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.R50("ngModel",n.level),t.R7$(),t.Y8G("ghs-label","tools.decks.level")}}function LL(a,r){if(1&a&&(t.j41(0,"small"),t.nrm(1,"span",3),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.R7$(),t.Y8G("ghs-label","data.deck."+i.deck(n).name)}}function qL(a,r){if(1&a&&t.nrm(0,"ghs-ability",11),2&a){const n=r.$implicit,i=t.XpG(),e=i.$implicit,o=i.$index,g=t.XpG(2);t.Y8G("ability",n)("abilities",g.deck(e).abilities)("character",g.characters[o])("flipped",!0)}}function HL(a,r){if(1&a&&(t.j41(0,"div",10)(1,"h2"),t.nrm(2,"span",3),t.nVh(3,LL,2,1,"small"),t.k0s(),t.Z7z(4,qL,1,4,"ghs-ability",11,Wa),t.nI1(6,"trackUUID"),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","data.character."+n.edition+"."+n.name),t.R7$(),t.vxM(n.name!=i.deck(n).name?3:-1),t.R7$(),t.Dyx(t.bMT(6,2,i.deck(n).abilities))}}function KL(a,r){if(1&a&&(t.Z7z(0,HL,7,4,"div",10,Wa),t.nI1(2,"trackUUID")),2&a){const n=t.XpG();t.Dyx(t.bMT(2,0,n.characters))}}function WL(a,r){if(1&a&&(t.j41(0,"small"),t.nrm(1,"span",3),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.R7$(),t.Y8G("ghs-label","data.deck."+i.deck(n).name)}}function ZL(a,r){if(1&a&&t.nrm(0,"ghs-ability",12),2&a){const n=r.$implicit,i=t.XpG(),e=i.$implicit,o=i.$index,g=t.XpG(2);t.Y8G("ability",n)("abilities",g.deck(e).abilities)("monster",g.monsters[o])("flipped",!0)("ngClass",t.eq3(5,XL,n.bottomActions&&n.bottomActions.length>0))}}function JL(a,r){if(1&a&&(t.j41(0,"div",10)(1,"h2"),t.nrm(2,"span",3),t.nVh(3,WL,2,1,"small"),t.k0s(),t.Z7z(4,ZL,1,7,"ghs-ability",12,Wa),t.nI1(6,"trackUUID"),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","data.monster."+n.name),t.R7$(),t.vxM(n.name!=i.deck(n).name?3:-1),t.R7$(),t.Dyx(t.bMT(6,2,i.deck(n).abilities))}}function QL(a,r){if(1&a&&(t.Z7z(0,JL,7,4,"div",10,Wa),t.nI1(2,"trackUUID")),2&a){const n=t.XpG();t.Dyx(t.bMT(2,0,n.monsters))}}let tq=(()=>{class a{route;router;ghsManager;gameManager=s.E;settingsManager=p.f;edition;monsters=[];characters=[];character=!1;entity=!0;elite=!0;level=1;constructor(n,i,e){this.route=n,this.router=i,this.ghsManager=e}ngOnInit(){var n=this;return(0,I.A)(function*(){yield p.f.init(!1),s.E.stateManager.init(!0),n.edition=s.E.editions(!0)[0],n.update(),n.route.queryParams.subscribe({next:i=>{i.edition&&(n.edition=i.edition,n.edition&&s.E.editions(!1).includes(n.edition),n.update())}})})()}update(){if(this.monsters=[],this.characters=[],this.character){const n=s.E.editionData.filter(i=>i.edition==this.edition).map(i=>i.characters).flat().filter(i=>s.E.decksData().some(e=>e.name==i.deck||e.name==i.name));this.characters=n.sort((i,e)=>i.name.toLowerCase()<e.name.toLowerCase()?-1:1).map(i=>new H.K(i,this.level))}else{const n=s.E.editionData.filter(i=>i.edition==this.edition).map(i=>i.monsters).flat().filter((i,e,o)=>i.replace||!i.replace&&!o.find(g=>g.replace&&g.name==i.name&&g.edition==i.edition));this.monsters=n.sort((i,e)=>i.name.toLowerCase()<e.name.toLowerCase()?-1:1).map(i=>{let e=new b.R(i,this.level);return e.boss&&this.entity&&s.E.monsterManager.addMonsterEntity(e,1,S.N.boss),!e.boss&&this.elite&&s.E.monsterManager.addMonsterEntity(e,1,S.N.elite),!e.boss&&this.entity&&s.E.monsterManager.addMonsterEntity(e,2,S.N.normal),e})}this.ghsManager.triggerUiChange()}deck(n){return s.E.deckData(n)}updateQueryParams(){this.router.navigate([],{relativeTo:this.route,queryParams:{edition:this.edition||void 0},queryParamsHandling:"merge"})}static \u0275fac=function(i){return new(i||a)(t.rXU(Ht.nX),t.rXU(Ht.Ix),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-decks-tool"]],standalone:!1,decls:24,vars:15,consts:[[1,"container"],[3,"standalone"],[1,"menu"],[3,"ghs-label"],[3,"ngModelChange","change","ngModel"],[3,"value"],["type","checkbox",3,"ngModelChange","change","ngModel"],["type","checkbox",3,"change","checked"],[1,"decks"],["type","number","min","0","max","7",3,"ngModelChange","change","ngModel"],[1,"deck"],[1,"bottom-actions",3,"ability","abilities","character","flipped"],[3,"ability","abilities","monster","flipped","ngClass"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nrm(1,"ghs-header",1),t.j41(2,"div",2)(3,"label"),t.nrm(4,"span",3),t.j41(5,"select",4),t.mxI("ngModelChange",function(g){return t.DH7(e.edition,g)||(e.edition=g),g}),t.bIt("change",function(){return e.update(),e.updateQueryParams()}),t.Z7z(6,BL,2,2,"option",5,t.fX1),t.k0s()(),t.j41(8,"label")(9,"input",6),t.mxI("ngModelChange",function(g){return t.DH7(e.character,g)||(e.character=g),g}),t.bIt("change",function(){return e.update()}),t.k0s(),t.nrm(10,"span",3),t.k0s(),t.j41(11,"label")(12,"input",7),t.bIt("change",function(){return e.settingsManager.toggle("calculate"),e.update()}),t.k0s(),t.nrm(13,"span",3),t.k0s(),t.nVh(14,YL,3,2,"label"),t.nVh(15,UL,3,2,"label"),t.nVh(16,NL,3,2,"label"),t.nVh(17,zL,3,2,"label"),t.j41(18,"label")(19,"input",7),t.bIt("change",function(){return e.settingsManager.toggle("fhStyle")}),t.k0s(),t.nrm(20,"span",3),t.k0s()(),t.j41(21,"div",8),t.nVh(22,KL,3,2),t.nVh(23,QL,3,2),t.k0s()()),2&i&&(t.R7$(),t.Y8G("standalone",!0),t.R7$(3),t.Y8G("ghs-label","settings.edition"),t.R7$(),t.R50("ngModel",e.edition),t.R7$(),t.Dyx(e.gameManager.editions(!0)),t.R7$(3),t.R50("ngModel",e.character),t.R7$(),t.Y8G("ghs-label","tools.decks.character"),t.R7$(2),t.Y8G("checked",e.settingsManager.settings.calculate),t.R7$(),t.Y8G("ghs-label","settings.calc"),t.R7$(),t.vxM(e.settingsManager.settings.calculate?14:-1),t.R7$(),t.vxM(e.settingsManager.settings.calculate&&!e.character?15:-1),t.R7$(),t.vxM(e.settingsManager.settings.calculate&&!e.character?16:-1),t.R7$(),t.vxM(e.settingsManager.settings.calculate?17:-1),t.R7$(2),t.Y8G("checked",e.settingsManager.settings.fhStyle),t.R7$(),t.Y8G("ghs-label","settings.fhStyle"),t.R7$(2),t.vxM(e.characters.length>0?22:-1),t.R7$(),t.vxM(e.monsters.length>0?23:-1))},dependencies:[N.YU,E.xH,E.y7,E.me,E.Q0,E.Zm,E.wz,E.BC,E.VZ,E.zX,E.vS,ee,it,Cn,ct],styles:[".container[_ngcontent-%COMP%]{width:100vw;height:100vh;display:flex;flex-direction:column}.container[_ngcontent-%COMP%]   ghs-header[_ngcontent-%COMP%]{z-index:2}.menu[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex}.decks[_ngcontent-%COMP%]{flex:1 1 auto;width:100%;overflow:auto;display:flex;margin-top:20px}.decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]{display:flex;flex-direction:column}.decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;margin:0}.decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{flex-shrink:0;width:400px;height:255px;margin:10px}.decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   ghs-ability.bottom-actions[_ngcontent-%COMP%]{height:540px}"]})}return a})();var Za=v(7017),Ja=v(8374),Oo=v(9039);const nq=["inputDeckData"],eq=(a,r,n)=>({"bottom-actions":a,"character-actions":r,fh:n}),Po=a=>({"bottom-actions":a}),Tn=a=>({enabled:a}),Qa=(a,r)=>r._trackUUID;function aq(a,r){1&a&&t.nrm(0,"ghs-header",3),2&a&&t.Y8G("standalone",!0)}function iq(a,r){if(1&a){const n=t.RV6();t.j41(0,"label"),t.nrm(1,"span",7),t.k0s(),t.j41(2,"input",22),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2);return t.DH7(o.abilityColor,e)||(o.abilityColor=e),c.Njj(e)}),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","editor.character.data.color"),t.R7$(),t.R50("ngModel",n.abilityColor),t.Y8G("ghs-label","editor.character.data.color")("ghs-label-attribute","placeholder")}}function oq(a,r){if(1&a){const n=t.RV6();t.j41(0,"label"),t.nrm(1,"span",7),t.k0s(),t.j41(2,"input",21),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.deckData.character,e)||(o.deckData.character=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.deckDataToJson())}),t.k0s(),t.nVh(3,iq,3,4)}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","editor.deck.character"),t.R7$(),t.R50("ngModel",n.deckData.character),t.R7$(),t.vxM(n.deckData.character?3:-1)}}function sq(a,r){if(1&a){const n=t.RV6();t.j41(0,"input",43),t.bIt("ngModelChange",function(e){c.eBV(n);const o=t.XpG().$implicit,g=t.XpG();return c.Njj(o.level=g.valueChange(e))})("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.deckDataToJson())}),t.k0s()}if(2&a){const n=t.XpG().$implicit;t.Y8G("ngModel",n.level)}}function rq(a,r){1&a&&t.nrm(0,"div",44)}function cq(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",31),t.nVh(1,rq,1,0,"div",44),t.j41(2,"span",45),t.nrm(3,"img",46),t.k0s(),t.j41(4,"ghs-action",47),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG().$implicit,g=t.XpG();return c.Njj(g.editAbilityAction(o,e))}),t.k0s()()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG().$implicit,o=t.XpG();t.R7$(),t.vxM(o.divider(e.actions,i)?1:-1),t.R7$(3),t.Y8G("action",n)("relative",!0)("character",o.getCharacter())("cardId",e.cardId)}}function lq(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",63),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2).$implicit,o=t.XpG();return e.shuffle=!e.shuffle,c.Njj(o.deckDataToJson())}),t.nrm(1,"img",64),t.k0s()}if(2&a){const n=t.XpG(2).$implicit;t.Y8G("ngClass",t.eq3(1,Tn,n.shuffle))}}function gq(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",32)(1,"div",48)(2,"input",49),t.bIt("ngModelChange",function(e){c.eBV(n);const o=t.XpG().$implicit;return c.Njj(o.xp=+e)})("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.deckDataToJson())}),t.k0s()(),t.j41(3,"a",50),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return e.lost=!e.lost,c.Njj(o.deckDataToJson())}),t.nrm(4,"img",51)(5,"img",52),t.k0s(),t.j41(6,"a",53),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return e.round=!e.round,c.Njj(o.deckDataToJson())}),t.nrm(7,"img",54)(8,"img",55),t.k0s(),t.j41(9,"a",56),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return e.loss=!e.loss,c.Njj(o.deckDataToJson())}),t.nrm(10,"img",57)(11,"img",58),t.k0s(),t.j41(12,"a",59),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return e.persistent=!e.persistent,c.Njj(o.deckDataToJson())}),t.nrm(13,"img",60)(14,"img",61),t.k0s(),t.nVh(15,lq,2,3,"a",62),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(2),t.Y8G("ngModel",n.xp),t.R7$(),t.Y8G("ngClass",t.eq3(6,Tn,n.lost)),t.R7$(3),t.Y8G("ngClass",t.eq3(8,Tn,n.round)),t.R7$(3),t.Y8G("ngClass",t.eq3(10,Tn,n.loss)),t.R7$(3),t.Y8G("ngClass",t.eq3(12,Tn,n.persistent)),t.R7$(3),t.vxM(i.deckData.character?-1:15)}}function dq(a,r){1&a&&t.nrm(0,"div",44)}function hq(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",31),t.nVh(1,dq,1,0,"div",44),t.j41(2,"span",45),t.nrm(3,"img",46),t.k0s(),t.j41(4,"ghs-action",47),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2).$implicit,g=t.XpG();return c.Njj(g.editAbilityActionBottom(o,e))}),t.k0s()()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2).$implicit,o=t.XpG();t.R7$(),t.vxM(o.divider(e.bottomActions,i)?1:-1),t.R7$(3),t.Y8G("action",n)("relative",!0)("character",o.getCharacter())("cardId",e.cardId)}}function _q(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",33)(1,"div",30),t.bIt("cdkDropListDropped",function(e){c.eBV(n);const o=t.XpG().$implicit,g=t.XpG();return c.Njj(g.dropAction(o.bottomActions,e))}),t.Z7z(2,hq,5,5,"div",31,Qa),t.nI1(4,"trackUUID"),t.k0s()()}if(2&a){const n=t.XpG().$implicit;t.R7$(2),t.Dyx(t.bMT(4,0,n.bottomActions))}}function mq(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",63),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2).$implicit,o=t.XpG();return e.bottomShuffle=!e.bottomShuffle,c.Njj(o.deckDataToJson())}),t.nrm(1,"img",64),t.k0s()}if(2&a){const n=t.XpG(2).$implicit;t.Y8G("ngClass",t.eq3(1,Tn,n.bottomShuffle))}}function pq(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",34)(1,"div",48)(2,"input",49),t.bIt("ngModelChange",function(e){c.eBV(n);const o=t.XpG().$implicit;return c.Njj(o.bottomXp=+e)})("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.deckDataToJson())}),t.k0s()(),t.j41(3,"a",50),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return e.bottomLost=!e.bottomLost,c.Njj(o.deckDataToJson())}),t.nrm(4,"img",51)(5,"img",52),t.k0s(),t.j41(6,"a",53),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return e.bottomRound=!e.bottomRound,c.Njj(o.deckDataToJson())}),t.nrm(7,"img",54)(8,"img",55),t.k0s(),t.j41(9,"a",56),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return e.bottomLoss=!e.bottomLoss,c.Njj(o.deckDataToJson())}),t.nrm(10,"img",57)(11,"img",58),t.k0s(),t.j41(12,"a",59),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return e.bottomPersistent=!e.bottomPersistent,c.Njj(o.deckDataToJson())}),t.nrm(13,"img",60)(14,"img",61),t.k0s(),t.nVh(15,mq,2,3,"a",62),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(2),t.Y8G("ngModel",n.bottomXp),t.R7$(),t.Y8G("ngClass",t.eq3(6,Tn,n.bottomLost)),t.R7$(3),t.Y8G("ngClass",t.eq3(8,Tn,n.bottomRound)),t.R7$(3),t.Y8G("ngClass",t.eq3(10,Tn,n.bottomLoss)),t.R7$(3),t.Y8G("ngClass",t.eq3(12,Tn,n.bottomPersistent)),t.R7$(3),t.vxM(i.deckData.character?-1:15)}}function uq(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",11)(1,"div",23)(2,"div",24,1)(4,"input",25),t.mxI("ngModelChange",function(e){const o=c.eBV(n).$implicit;return t.DH7(o.name,e)||(o.name=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.deckDataToJson())})("keyup",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.deckDataToJson())}),t.k0s(),t.j41(5,"span",26),t.nVh(6,sq,1,1,"input",27),t.k0s(),t.j41(7,"input",28),t.bIt("change",function(e){const o=c.eBV(n).$implicit,g=t.XpG();return c.Njj(g.changeInitiative(e,o))}),t.k0s(),t.j41(8,"div",29)(9,"div",30),t.bIt("cdkDropListDropped",function(e){const o=c.eBV(n).$implicit,g=t.XpG();return c.Njj(g.dropAction(o.actions,e))}),t.Z7z(10,cq,5,5,"div",31,Qa),t.nI1(12,"trackUUID"),t.k0s()(),t.nVh(13,gq,16,14,"div",32),t.nVh(14,_q,5,2,"div",33),t.nVh(15,pq,16,14,"div",34),t.j41(16,"input",35),t.bIt("change",function(e){const o=c.eBV(n).$implicit,g=t.XpG();return c.Njj(g.changeCardId(e,o))}),t.k0s(),t.j41(17,"a",36),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.removeAbility(e))}),t.nrm(18,"img",37),t.k0s()(),t.j41(19,"div",38)(20,"a",39),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.addAbilityAction(e))}),t.nrm(21,"img",13)(22,"span",7),t.k0s(),t.j41(23,"a",40),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.addAbilityActionBottom(e))}),t.nrm(24,"img",13)(25,"span",7),t.k0s()(),t.nrm(26,"ghs-ability",41),t.k0s(),t.nrm(27,"ghs-ability",42),t.k0s()}if(2&a){let n;const i=r.$implicit,e=t.sdS(3),o=t.XpG();t.R7$(2),t.xc7("font-size",.04*e.offsetWidth+"px")("--ghs-ability-color",o.getCharacter()&&(null==(n=o.getCharacter())?null:n.color)),t.Y8G("ngClass",t.sMw(33,eq,o.deckData.character||i.bottomActions&&i.bottomActions.length>0,o.deckData.character,o.settingsManager.settings.fhStyle)),t.R7$(2),t.R50("ngModel",i.name),t.Y8G("ghs-label",i.name||"editor.deck.abilityName")("ghs-label-attribute","placeholder"),t.R7$(2),t.vxM(o.deckData.character||i.bottomActions&&i.bottomActions.length>0?6:-1),t.R7$(),t.Y8G("value",i.initiative&&(i.initiative<10?"0":"")+i.initiative),t.R7$(3),t.Dyx(t.bMT(12,31,i.actions)),t.R7$(3),t.vxM(o.deckData.character||i.bottomActions&&i.bottomActions.length>0?13:-1),t.R7$(),t.vxM(o.deckData.character||i.bottomActions&&i.bottomActions.length>0?14:-1),t.R7$(),t.vxM(o.deckData.character||i.bottomActions&&i.bottomActions.length>0?15:-1),t.R7$(),t.Y8G("value",i.cardId&&(i.cardId<100?"0":"")+(i.cardId<10?"0":"")+i.cardId),t.R7$(3),t.Y8G("ngClass",t.eq3(37,Po,o.deckData.character||i.bottomActions&&i.bottomActions.length>0)),t.R7$(3),t.Y8G("ghs-label","editor.action.add"),t.R7$(3),t.Y8G("ghs-label","editor.action.addBottom"),t.R7$(),t.Y8G("ngClass",t.eq3(39,Po,o.deckData.character||i.bottomActions&&i.bottomActions.length>0))("character",o.getCharacter())("monster",o.monster)("relative",!0)("flipped",!0)("statsCalculation",!1),t.R7$(),t.Y8G("ngClass",t.eq3(41,Po,o.deckData.character||i.bottomActions&&i.bottomActions.length>0))("ability",i)("abilities",o.deckData.abilities)("character",o.getCharacter())("monster",o.monster)("relative",!0)("flipped",!0)("statsCalculation",!1)}}function fq(a,r){if(1&a&&(t.j41(0,"option",17),t.EFF(1),t.nrm(2,"span",7),t.EFF(3,") "),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG();t.Y8G("value",i)("selected",n.edition==e.deckData.edition&&n.name==e.deckData.name),t.R7$(),t.SpI(" ",n.name," ("),t.R7$(),t.Y8G("ghs-label","data.edition."+n.edition)}}function Cq(a,r){if(1&a&&(t.j41(0,"option",16),t.nrm(1,"span",7),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n),t.R7$(),t.Y8G("ghs-label","data.edition."+n)}}function Yn(a){if(a.valueType&&a.valueType==$.iQ.fixed&&(a.valueType=void 0),a.subActions&&0==a.subActions.length?a.subActions=void 0:a.subActions&&a.subActions.forEach(r=>{Yn(r)}),a.type==$.X2.summon)try{let r=JSON.parse(a.value);"string"!=typeof r&&(Object.keys(r).forEach(n=>{(!r[n]||0==r[n])&&(r[n]=void 0)}),r.action&&Yn(r.action),r.additionalAction&&Yn(r.additionalAction)),a.value=JSON.stringify(r)}catch{}!a.value&&0!=a.value&&(a.value=void 0),a.small||(a.small=void 0)}let bo=(()=>{class a{dialog;route;router;ghsManager;inputDeckData;character;monster;edition;standalone=!0;gameManager=s.E;settingsManager=p.f;ActionType=$.X2;ActionValueType=$.iQ;encodeURIComponent=encodeURIComponent;deckData;decksData=[];editions=[];deckError;abilityColor="#aaaaaa";constructor(n,i,e,o){this.dialog=n,this.route=i,this.router=e,this.ghsManager=o,this.deckData=new Oo.m,this.deckData.abilities.push(new Ja.T)}ngOnInit(){var n=this;return(0,I.A)(function*(){n.standalone&&(yield p.f.init(!1)),n.character&&(n.deckData.character=!0),n.deckDataToJson(),n.updateDecksData(),n.inputDeckData.nativeElement.addEventListener("change",i=>{n.deckDataFromJson()}),n.editions=s.E.editions(!0),n.route.queryParams.subscribe({next:i=>{if(i.edition&&(n.edition=i.edition,n.edition&&s.E.editions(!1).includes(n.edition)),i.deck){const e=n.decksData.find(o=>o.name==i.deck);e&&(n.deckData=e,n.deckDataToJson())}!n.deckData.edition&&n.edition&&(n.deckData.edition=n.edition)}})})()}updateQueryParams(){!this.deckData.edition&&this.edition&&(this.deckData.edition=this.edition),this.router.navigate([],{relativeTo:this.route,queryParams:{edition:this.edition||void 0,monster:this.monster&&this.monster.name||void 0,character:this.character&&this.character.name||void 0,deck:this.deckData.name||void 0},queryParamsHandling:"merge"}),this.updateDecksData()}updateDecksData(){this.decksData=s.E.decksData(this.edition).filter(n=>this.character?n.character:!this.monster||!n.character)}deckDataToJson(){let n=JSON.parse(JSON.stringify(this.deckData));Object.keys(n).forEach(i=>{(!n[i]||0==n[i])&&(n[i]=void 0)}),n.abilities&&n.abilities.forEach(i=>{Object.keys(i).forEach(e=>{(!i[e]&&0!=i[e]||"boolean"==typeof i[e]&&0==i[e])&&(i[e]=void 0),i.revealed=void 0,"level"==e&&0==i[e]&&(i[e]=void 0),"xp"==e&&0==i[e]&&(i[e]=void 0),"bottomXp"==e&&0==i[e]&&(i[e]=void 0),i.actions&&0==i.actions.length?i.actions=void 0:i.actions&&i.actions.forEach(o=>{Yn(o)}),i.bottomActions&&0==i.bottomActions.length?i.bottomActions=void 0:i.bottomActions&&i.bottomActions.forEach(o=>{Yn(o)})})}),this.inputDeckData.nativeElement.value=JSON.stringify(n,null,2)}deckDataFromJson(){if(this.deckError="",this.inputDeckData.nativeElement.value)try{return void(this.deckData=JSON.parse(this.inputDeckData.nativeElement.value))}catch(n){this.deckData=new Oo.m,this.deckData.abilities.push(new Ja.T),this.deckError=n}}valueChange(n){return n&&!isNaN(+n)?+n:n}changeInitiative(n,i){i.initiative=n.target.value?+n.target.value:0,n.target.value=(i.initiative<10?"0":"")+i.initiative,this.deckDataToJson()}changeCardId(n,i){n.target.value?(i.cardId=+n.target.value,n.target.value=(i.cardId<100?"0":"")+(i.cardId<10?"0":"")+i.cardId):i.cardId=void 0,this.deckDataToJson()}addAbility(){this.deckData.abilities.push(new Ja.T),this.deckDataToJson()}removeAbility(n){this.deckData.abilities.splice(this.deckData.abilities.indexOf(n),1),this.deckDataToJson()}addAbilityAction(n){let i=new $.rc($.X2.attack);n.actions||(n.actions=[]),n.actions.push(i),this.dialog.open(wn,{panelClass:["dialog"],data:{action:i,character:this.getCharacter(),cardId:n.cardId}}).closed.subscribe({next:o=>{0==o&&n.actions.splice(n.actions.indexOf(i),1),this.deckDataToJson()}})}editAbilityAction(n,i){this.dialog.open(wn,{panelClass:["dialog"],data:{action:i,character:this.getCharacter(),cardId:n.cardId}}).closed.subscribe({next:o=>{0==o&&n.actions.splice(n.actions.indexOf(i),1),this.deckDataToJson()}})}dropAction(n,i){(0,V.HD)(n,i.previousIndex,i.currentIndex),this.ghsManager.triggerUiChange()}addAbilityActionBottom(n){let i=new $.rc($.X2.move);n.bottomActions||(n.bottomActions=[]),n.bottomActions.push(i),this.dialog.open(wn,{panelClass:["dialog"],data:{action:i,character:this.getCharacter(),cardId:n.cardId}}).closed.subscribe({next:o=>{0==o&&n.bottomActions.splice(n.bottomActions.indexOf(i),1),this.deckDataToJson()}})}editAbilityActionBottom(n,i){this.dialog.open(wn,{panelClass:["dialog"],data:{action:i,character:this.getCharacter(),cardId:n.cardId}}).closed.subscribe({next:o=>{0==o&&n.bottomActions.splice(n.actions.indexOf(i),1),this.deckDataToJson()}})}divider(n,i){if(i<1)return!1;const e=n[i];return!(!e||(e.type==$.X2.element||e.type==$.X2.elementHalf)&&e.valueType!=$.iQ.minus||e.type==$.X2.card||n[i-1].type==$.X2.box||e.type==$.X2.concatenation&&e.subActions.every(o=>o.type==$.X2.card||o.type==$.X2.element||o.type==$.X2.elementHalf))}getCharacter(){if(this.character)return this.character;if(this.deckData.character){const n=new oe.qS;n.iconUrl="./assets/images/warning.svg";for(let i=0;i<9;i++)n.stats.push(new Za.s(i,i));return n.color=this.abilityColor,this.edition&&(n.edition=this.edition),new H.K(n,1)}}loadDeckData(n){const i=+n.target.value;-1==i?(this.deckData=new Oo.m,this.deckData.abilities.push(new Ja.T),this.character&&(this.deckData.character=!0)):this.deckData=this.decksData[i],this.deckDataToJson(),this.updateQueryParams()}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG),t.rXU(Ht.nX),t.rXU(Ht.Ix),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-deck-editor"]],viewQuery:function(i,e){if(1&i&&t.GBs(nq,7),2&i){let o;t.mGM(o=t.lsd())&&(e.inputDeckData=o.first)}},inputs:{character:"character",monster:"monster",edition:"edition",standalone:"standalone"},standalone:!1,decls:44,vars:26,consts:[["inputDeckData",""],["card",""],[1,"container"],[3,"standalone"],[1,"columns"],[1,"input"],[1,"deck"],[3,"ghs-label"],[1,"base-data","dialog"],[1,"dialog-container"],[3,"ngModelChange","change","keyup","ngModel","ghs-label","ghs-label-attribute"],[1,"abilities-container"],[1,"button",3,"click"],["src","./assets/images/plus.svg",1,"ghs-icon"],[1,"output"],[3,"change"],[3,"value"],[3,"value","selected"],[3,"ngModelChange","change","ngModel"],[1,"button",3,"href","download"],["src","./assets/images/export.svg",1,"ghs-icon"],["type","checkbox",3,"ngModelChange","change","ngModel"],["type","color",3,"ngModelChange","ngModel","ghs-label","ghs-label-attribute"],[1,"ability-input"],[1,"ability-edit",3,"ngClass"],[1,"name",3,"ngModelChange","change","keyup","ngModel","ghs-label","ghs-label-attribute"],[1,"level"],[1,"text",3,"ngModel"],["min","0","max","100","type","number",1,"initiative",3,"change","value"],[1,"actions-container"],["cdkDropList","",1,"actions",3,"cdkDropListDropped"],["cdkDrag","",1,"action-container"],[1,"required-container"],[1,"actions-container","bottom"],[1,"required-container","bottom"],["type","number",1,"card-id",3,"change","value"],[1,"remove",3,"click"],["src","./assets/images/minus.svg",1,"ghs-icon"],[1,"buttons",3,"ngClass"],[1,"button","add",3,"click"],[1,"button","add","bottom",3,"click"],[3,"ngClass","character","monster","relative","flipped","statsCalculation"],[3,"ngClass","ability","abilities","character","monster","relative","flipped","statsCalculation"],[1,"text",3,"ngModelChange","change","ngModel"],[1,"divider"],["cdkDragHandle","",1,"handle"],["src","./assets/images/menu.svg",1,"ghs-icon"],[3,"click","action","relative","character","cardId"],[1,"xp"],["type","number","min","0",3,"ngModelChange","change","ngModel"],[1,"lost",3,"click","ngClass"],["src","./assets/images/action/card/lost.svg"],["src","./assets/images/action/card/overlay/lost.svg",1,"overlay"],[1,"round",3,"click","ngClass"],["src","./assets/images/action/card/round.svg"],["src","./assets/images/action/card/overlay/round.svg",1,"overlay"],[1,"loss",3,"click","ngClass"],["src","./assets/images/action/card/loss.svg"],["src","./assets/images/action/card/overlay/loss.svg",1,"overlay"],[1,"persistent",3,"click","ngClass"],["src","./assets/images/action/card/persistent.svg"],["src","./assets/images/action/card/overlay/persistent.svg",1,"overlay"],[1,"shuffle",3,"ngClass"],[1,"shuffle",3,"click","ngClass"],["src","./assets/images/shuffle.svg"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",2),t.nVh(1,aq,1,1,"ghs-header",3),t.j41(2,"div",4)(3,"div",5)(4,"div",6)(5,"h2"),t.nrm(6,"span",7),t.k0s(),t.j41(7,"div",8)(8,"div",9)(9,"label"),t.nrm(10,"span",7),t.k0s(),t.j41(11,"input",10),t.mxI("ngModelChange",function(m){return c.eBV(o),t.DH7(e.deckData.name,m)||(e.deckData.name=m),c.Njj(m)}),t.bIt("change",function(){return c.eBV(o),c.Njj(e.deckDataToJson())})("keyup",function(){return c.eBV(o),c.Njj(e.deckDataToJson())}),t.k0s(),t.j41(12,"label"),t.nrm(13,"span",7),t.k0s(),t.j41(14,"input",10),t.mxI("ngModelChange",function(m){return c.eBV(o),t.DH7(e.deckData.edition,m)||(e.deckData.edition=m),c.Njj(m)}),t.bIt("change",function(){return c.eBV(o),c.Njj(e.deckDataToJson())})("keyup",function(){return c.eBV(o),c.Njj(e.deckDataToJson())}),t.k0s(),t.nVh(15,oq,4,3),t.k0s()(),t.Z7z(16,uq,28,43,"div",11,Qa),t.nI1(18,"trackUUID"),t.j41(19,"a",12),t.bIt("click",function(){return c.eBV(o),c.Njj(e.addAbility())}),t.nrm(20,"img",13)(21,"span",7),t.k0s()()(),t.j41(22,"div",14)(23,"h2"),t.nrm(24,"span",7),t.j41(25,"select",15),t.bIt("change",function(m){return c.eBV(o),c.Njj(e.loadDeckData(m))}),t.j41(26,"option",16),t.EFF(27,"<"),t.nrm(28,"span",7),t.EFF(29,">"),t.k0s(),t.Z7z(30,fq,4,4,"option",17,Qa),t.nI1(32,"trackUUID"),t.k0s(),t.j41(33,"select",18),t.mxI("ngModelChange",function(m){return c.eBV(o),t.DH7(e.edition,m)||(e.edition=m),c.Njj(m)}),t.bIt("change",function(){return c.eBV(o),c.Njj(e.updateQueryParams())}),t.nrm(34,"option"),t.Z7z(35,Cq,2,2,"option",16,t.fX1),t.k0s()(),t.j41(37,"div"),t.EFF(38),t.k0s(),t.nrm(39,"textarea",null,0),t.j41(41,"a",19),t.nrm(42,"img",20)(43,"span",7),t.k0s()()()()}if(2&i){const o=t.sdS(40);t.xc7("--ghs-ability-color",e.abilityColor),t.R7$(),t.vxM(e.standalone?1:-1),t.R7$(5),t.Y8G("ghs-label","editor.deck"),t.R7$(4),t.Y8G("ghs-label","editor.deck.name"),t.R7$(),t.R50("ngModel",e.deckData.name),t.Y8G("ghs-label","editor.deck.name")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","editor.deck.edition"),t.R7$(),t.R50("ngModel",e.deckData.edition),t.Y8G("ghs-label","editor.deck.edition")("ghs-label-attribute","placeholder"),t.R7$(),t.vxM(e.character||e.monster?-1:15),t.R7$(),t.Dyx(t.bMT(18,22,e.deckData.abilities)),t.R7$(5),t.Y8G("ghs-label","editor.deck.addAbility"),t.R7$(3),t.Y8G("ghs-label","editor.deck.json"),t.R7$(2),t.Y8G("value",-1),t.R7$(2),t.Y8G("ghs-label","editor.deck.new"),t.R7$(2),t.Dyx(t.bMT(32,24,e.decksData)),t.R7$(3),t.R50("ngModel",e.edition),t.R7$(2),t.Dyx(e.editions),t.R7$(3),t.SpI(" ",e.deckError," "),t.R7$(3),t.Y8G("href","data:application/json;charset=utf-8,"+e.encodeURIComponent(o.value),t.B4B)("download",e.deckData.name+".json"),t.R7$(2),t.Y8G("ghs-label","editor.deck.json.download")}},dependencies:[N.YU,E.xH,E.y7,E.me,E.Q0,E.Zm,E.wz,E.BC,E.VZ,E.vS,V.O7,V.T1,V.Fb,ee,en,it,Cn,ct],styles:["h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{text-align:center;margin-top:calc(var(--ghs-unit) * .7);margin-bottom:calc(var(--ghs-unit) * .2)}input[_ngcontent-%COMP%]:not([type=checkbox]), textarea[_ngcontent-%COMP%]{width:100%;min-width:initial;color:var(--ghs-color-black);background-color:var(--ghs-color-white);border:1px solid var(--ghs-color-gray)}input[_ngcontent-%COMP%]:not([type=checkbox]):hover, textarea[_ngcontent-%COMP%]:hover{border:1px solid var(--ghs-color-gray)}select[_ngcontent-%COMP%]{max-width:100%}textarea[_ngcontent-%COMP%]{width:100%;min-width:calc(var(--ghs-unit) * 20);min-height:calc(var(--ghs-unit) * 50)}.ghs-icon[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}a[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center}a[_ngcontent-%COMP%]:hover{opacity:.7}a.button[_ngcontent-%COMP%]{justify-content:center;font-family:var(--ghs-font-gh-normal);font-size:calc(var(--ghs-unit) * 3);color:var(--ghs-color-white);padding:calc(var(--ghs-unit) * 1);margin:calc(var(--ghs-unit) * 1) auto;border:1px solid var(--ghs-color-gray);background-color:var(--ghs-color-darkgray);text-decoration:none}a.button[_ngcontent-%COMP%]:hover{opacity:1;color:var(--ghs-color-gray)}a.button[_ngcontent-%COMP%]:hover   .ghs-icon[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}a[_ngcontent-%COMP%]   .ghs-icon[_ngcontent-%COMP%]:nth-child(1){margin-right:.2em}.base-data[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5);color:var(--ghs-color-white);width:70%;min-width:300px;display:grid;grid-template-columns:auto auto;grid-gap:calc(var(--ghs-unit) * 2);margin:calc(var(--ghs-unit) * 1) auto;flex-shrink:1;overflow:auto}.columns[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;max-width:100%;justify-content:space-evenly}.output[_ngcontent-%COMP%]{max-width:100%}.input[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 2)}",'.container[_ngcontent-%COMP%]{width:100vw;height:100vh;display:flex;flex-direction:column}.container[_ngcontent-%COMP%]   ghs-header[_ngcontent-%COMP%]{z-index:2}.deck[_ngcontent-%COMP%]{display:flex;flex-direction:column}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:space-around;align-items:flex-start;margin-top:calc(var(--ghs-unit) * 3);min-width:calc(var(--ghs-unit) * 82)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{display:block;width:calc(var(--ghs-unit) * 40);min-height:calc(var(--ghs-unit) * 25.5)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   ghs-ability.bottom-actions[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 54)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]{position:relative}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{position:relative;margin-top:calc(var(--ghs-unit) * -2);display:flex;justify-content:space-evenly}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2);color:var(--ghs-color-black);background-color:var(--ghs-color-gray);border-color:var(--ghs-color-darkgray);z-index:2}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:none}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]:hover{color:var(--ghs-color-darkgray)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .add.bottom[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 1.5);padding:calc(var(--ghs-unit) * .1);margin:calc(var(--ghs-unit) * 2) auto;opacity:.7}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .add.bottom[_ngcontent-%COMP%]:hover{opacity:1}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .buttons.bottom-actions[_ngcontent-%COMP%]{position:absolute;left:-3%;top:49%;z-index:2;flex-direction:column;align-items:flex-start}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .buttons.bottom-actions[_ngcontent-%COMP%]:before{background-position:top}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .buttons.bottom-actions[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .buttons.bottom-actions[_ngcontent-%COMP%]   .bottom[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2);padding:calc(var(--ghs-unit) * .2);margin:calc(var(--ghs-unit) * .5) 0;opacity:1}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;text-align:center;background-position:center;background-size:100% auto;background-repeat:no-repeat;border-radius:3.5%;width:calc(var(--ghs-unit) * 40);height:calc(var(--ghs-unit) * 25.5);z-index:2}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]:before{content:" ";position:absolute;width:100%;height:100%;z-index:0}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]:after{content:" ";position:absolute;width:100%;height:100%;z-index:-1}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * .5);right:calc(var(--ghs-unit) * 1);width:calc(var(--ghs-unit) * 3)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow);width:100%;height:auto}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);position:absolute;font-size:1.7em;top:calc(var(--ghs-unit) * .5);left:calc(var(--ghs-unit) * 7);width:calc(var(--ghs-unit) * 26);color:var(--ghs-color-white);background-color:transparent;border:1px solid var(--ghs-color-gray);z-index:2;text-align:center}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]:hover{border:1px solid var(--ghs-color-gray)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);position:absolute;font-size:2.4em;top:calc(var(--ghs-unit) * 4.5);left:calc(var(--ghs-unit) * 2);width:calc(var(--ghs-unit) * 6);color:var(--ghs-color-white);background-color:transparent;border:none;z-index:3}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]:hover{border:none}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{position:absolute;font-family:var(--ghs-font-normal);font-size:1em;filter:drop-shadow(calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) var(--ghs-color-black));bottom:calc(var(--ghs-unit) * 1);left:calc(var(--ghs-unit) * 2);width:calc(var(--ghs-unit) * 6);color:var(--ghs-color-white);background-color:transparent;border:none;z-index:3}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]:hover{border:none}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .shuffle[_ngcontent-%COMP%]{position:absolute;bottom:calc(var(--ghs-unit) * .5);right:calc(var(--ghs-unit) * .5);width:calc(var(--ghs-unit) * 3);height:calc(var(--ghs-unit) * 3);z-index:3;cursor:pointer}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .shuffle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;width:calc(var(--ghs-unit) * 3);height:calc(var(--ghs-unit) * 3);margin:0}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .shuffle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:before{width:calc(var(--ghs-unit) * 3);height:calc(var(--ghs-unit) * 3)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .shuffle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow);width:100%;height:auto}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .shuffle.enabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 4.5);height:calc(var(--ghs-unit) * 21);width:100%;z-index:1;overflow:auto}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%;min-height:100%;font-size:calc(1.7em * var(--ghs-fontsize))}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action-container[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]{width:100%;display:inline-flex;cursor:pointer}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action-container[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{width:15%;border-top:.11em var(--ghs-color-white) dotted;margin:.2em}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action-container[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{position:absolute;left:-3%;top:0;z-index:2;cursor:grab;opacity:.7}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action-container[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]:hover{opacity:1}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 54)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions.character-actions[_ngcontent-%COMP%]{overflow-x:unset;overflow-y:auto}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{top:4.5%;left:calc(var(--ghs-unit) * 7)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]{top:49%;left:52.5%;transform:translate(-50%);width:calc(var(--ghs-unit) * 6)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{left:18%;bottom:7%}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]{top:17%;left:10.6%;width:78.3%;height:30%;min-height:30%}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .actions-container.bottom[_ngcontent-%COMP%]{top:59%}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]{display:flex;z-index:3;position:absolute;bottom:49%;height:6%;right:1%}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container.bottom[_ngcontent-%COMP%]{bottom:9%}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%;width:auto;margin:.1em;filter:grayscale(.7);opacity:.5}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:hover, .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   a.enabled[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   div.enabled[_ngcontent-%COMP%]{filter:grayscale(0);opacity:1}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   a.enabled[_ngcontent-%COMP%]:hover, .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   div.enabled[_ngcontent-%COMP%]:hover{filter:grayscale(.7);opacity:.5}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   a.xp[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   div.xp[_ngcontent-%COMP%]{display:none}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:relative;top:0;left:0;height:100%;width:auto}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:nth-child(1), .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:nth-child(1){filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:nth-child(2), .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:nth-child(2){position:absolute}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{position:absolute;top:11%;left:45%;width:10%;height:6%;font-size:1.2em;font-family:var(--ghs-font-gh-title);display:flex;justify-content:center;align-items:center;background-color:var(--ghs-ability-color);-webkit-mask-image:url(level.38e1f58a07dc5898.svg);mask-image:url(level.38e1f58a07dc5898.svg);-webkit-mask-size:115% 170%;mask-size:115% 170%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-position:60% 66%;mask-position:60% 66%}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{background:inherit;-webkit-background-clip:text;background-clip:text;color:transparent;filter:invert(1) grayscale(1) contrast(100);font-family:var(--ghs-font-title);text-align:center;font-size:1em}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]:hover{border:none!important}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{left:58%}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.character-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.bottom-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{top:5%;left:5%;background:none;-webkit-mask:none;mask:none}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.character-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.bottom-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{color:var(--ghs-color-black);filter:none}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.character-actions[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.bottom-actions[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{left:10%;bottom:5%}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.character-actions[_ngcontent-%COMP%]   .required-container.bottom[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.bottom-actions[_ngcontent-%COMP%]   .required-container.bottom[_ngcontent-%COMP%]{bottom:5%}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.character-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .xp[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .xp[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;font-size:1em;background-color:var(--ghs-color-white);-webkit-mask-image:url(experience.6b7246e7470a4898.svg);mask-image:url(experience.6b7246e7470a4898.svg);-webkit-mask-size:100% 100%;mask-size:100% 100%;position:relative;width:3.5em;margin-left:-1em}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.character-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .xp[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .xp[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;width:2em;font-size:1em;font-family:var(--ghs-font-title);background-color:transparent;border:none}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:0}']})}return a})();const Mq=["inputCharacterData"],vq=()=>[],Oq=(a,r)=>r._trackUUID;function Pq(a,r){if(1&a&&(t.j41(0,"option",14),t.nrm(1,"span",4),t.k0s()),2&a){const n=r.$implicit,i=t.XpG();t.Y8G("value",n)("selected",i.characterData.characterClass==n),t.R7$(),t.Y8G("ghs-label","character.class."+n)}}function bq(a,r){if(1&a&&(t.j41(0,"option",16),t.nrm(1,"span",4),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n-1),t.R7$(),t.Y8G("ghs-label","editor.character.data.hp."+(n-1))}}function kq(a,r){if(1&a){const n=t.RV6();t.j41(0,"input",25),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG().$implicit;return t.DH7(o.health,e)||(o.health=e),c.Njj(e)}),t.k0s()}if(2&a){const n=t.XpG().$implicit;t.R50("ngModel",n.health)}}function yq(a,r){if(1&a){const n=t.RV6();t.j41(0,"input",26),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG().$implicit;return t.DH7(o.health,e)||(o.health=e),c.Njj(e)}),t.k0s()}if(2&a){const n=t.XpG().$implicit;t.R50("ngModel",n.health)}}function xq(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s(),t.nVh(2,kq,1,1,"input",23),t.nVh(3,yq,1,1,"input",24)),2&a){const n=r.$implicit,i=t.XpG();t.R7$(),t.JRh(n.level),t.R7$(),t.vxM(-1!=i.hpIndex?2:-1),t.R7$(),t.vxM(-1==i.hpIndex?3:-1)}}function Eq(a,r){if(1&a&&t.nrm(0,"span",4),2&a){const n=t.XpG().$implicit;t.Y8G("ghs-label","data.character."+n.edition+"."+n.name)}}function wq(a,r){if(1&a&&(t.j41(0,"option",14),t.nVh(1,Eq,1,1,"span",4),t.EFF(2),t.nrm(3,"span",4),t.EFF(4),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG();t.Y8G("value",i)("selected",n.edition==e.characterData.edition&&n.name==e.characterData.name),t.R7$(),t.vxM(e.isSpoiled(n)?1:-1),t.R7$(),t.SpI(" ",n.name," ("),t.R7$(),t.Y8G("ghs-label","data.edition."+n.edition),t.R7$(),t.SpI(") [",n.name,"] ")}}function Rq(a,r){if(1&a&&(t.j41(0,"option",16),t.nrm(1,"span",4),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n),t.R7$(),t.Y8G("ghs-label","data.edition."+n)}}function jq(a,r){if(1&a&&t.nrm(0,"ghs-deck-editor",22),2&a){const n=t.XpG();t.Y8G("character",n.getCharacter())("standalone",!1)("edition",n.edition)}}let Gq=(()=>{class a{route;router;inputCharacterData;gameManager=s.E;encodeURIComponent=encodeURIComponent;isSpoiled=F.DJ;characterData;characterError;edition;init=!1;hpIndex=0;CharacterClasses=Object.values(oe.iq);hpValues=[[6,7,8,9,10,11,12,13,14],[8,9,11,12,14,15,17,18,20],[10,12,14,16,18,20,22,24,26]];editions=[];charactersData=[];constructor(n,i){this.route=n,this.router=i,this.characterData=new oe.qS,this.characterData.iconUrl="./assets/images/warning.svg";for(let e=0;e<9;e++)this.characterData.stats.push(new Za.s(e+1,e+6))}ngOnInit(){var n=this;return(0,I.A)(function*(){yield p.f.init(!1),n.characterDataToJson(),n.inputCharacterData.nativeElement.addEventListener("change",i=>{n.characterDataFromJson()}),n.editions=s.E.editions(!0),n.charactersData=s.E.charactersData(n.edition),n.route.queryParams.subscribe({next:i=>{if(i.edition&&(n.edition=i.edition,n.edition&&s.E.editions(!1).includes(n.edition),n.charactersData=s.E.charactersData(n.edition)),i.character){const e=s.E.charactersData(n.edition).find(o=>o.name==i.character);e&&(n.characterData=e,n.characterDataToJson())}!n.characterData.edition&&n.edition&&(n.characterData.edition=n.edition)}}),n.init=!0})()}getCharacter(){return new H.K(this.characterData,1)}changeHpIndex(){(this.hpIndex<-1||this.hpIndex>2)&&(this.hpIndex=-1),-1!=this.hpIndex&&this.characterData.stats.forEach(n=>{n.health=this.hpValues[this.hpIndex][n.level-1]}),this.characterDataToJson()}characterDataToJson(){this.characterData.stats.sort((i,e)=>i.level-e.level);let n=JSON.parse(JSON.stringify(this.characterData));this.inputCharacterData.nativeElement.value=JSON.stringify(n,null,2)}characterDataFromJson(){if(this.characterError="",this.inputCharacterData.nativeElement.value)try{return void(this.characterData=JSON.parse(this.inputCharacterData.nativeElement.value))}catch(n){this.characterData=new oe.qS,this.characterData.iconUrl="./assets/images/warning.svg";for(let i=0;i<9;i++)this.characterData.stats.push(new Za.s(i,i));this.characterError=n}}selectEdition(n){this.edition=this.editions.includes(n.target.value)?n.target.value:void 0,this.charactersData=s.E.charactersData(this.edition)}loadCharacterData(n){const i=+n.target.value;if(-1!=i)this.characterData=s.E.charactersData(this.edition)[i];else{this.characterData=new oe.qS,this.characterData.iconUrl="./assets/images/warning.svg";for(let e=0;e<9;e++)this.characterData.stats.push(new Za.s(e+1,e+6))}this.hpIndex=-1,this.hpValues.forEach((e,o)=>{e.every((g,m)=>this.characterData.stats.find(k=>k.level==m+1&&k.health==g))&&(this.hpIndex=o)}),this.characterDataToJson(),this.updateQueryParams()}updateQueryParams(){!this.characterData.edition&&this.edition&&(this.characterData.edition=this.edition),this.router.navigate([],{relativeTo:this.route,queryParams:{edition:this.edition||void 0,character:this.characterData&&this.characterData.name||void 0},queryParamsHandling:"merge"})}static \u0275fac=function(i){return new(i||a)(t.rXU(Ht.nX),t.rXU(Ht.Ix))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-character-editor"]],viewQuery:function(i,e){if(1&i&&t.GBs(Mq,7),2&i){let o;t.mGM(o=t.lsd())&&(e.inputCharacterData=o.first)}},standalone:!1,decls:68,vars:40,consts:[["inputCharacterData",""],[1,"container"],[3,"standalone"],[1,"character-editor"],[3,"ghs-label"],[1,"columns"],[1,"input"],[1,"character-data"],[1,"base-data","dialog"],[1,"dialog-container"],[3,"ngModelChange","change","keyup","ngModel","ghs-label","ghs-label-attribute"],["type","color",3,"ngModelChange","change","keyup","ngModel","ghs-label","ghs-label-attribute"],["type","checkbox",3,"ngModelChange","change","ngModel"],[3,"ngModelChange","change","ngModel"],[3,"value","selected"],[1,"hp-container"],[3,"value"],[1,"hp-grid"],[1,"output"],[3,"change"],[1,"button",3,"href","download"],["src","./assets/images/export.svg",1,"ghs-icon"],[3,"character","standalone","edition"],["disabled","",3,"ngModel"],["type","number",3,"ngModel"],["disabled","",3,"ngModelChange","ngModel"],["type","number",3,"ngModelChange","ngModel"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",1),t.nrm(1,"ghs-header",2),t.j41(2,"div",3)(3,"h1"),t.nrm(4,"span",4),t.EFF(5," ("),t.nrm(6,"span",4),t.EFF(7,")"),t.k0s(),t.j41(8,"div",5)(9,"div",6)(10,"div",7)(11,"h2"),t.nrm(12,"span",4),t.k0s(),t.j41(13,"div",8)(14,"div",9)(15,"label"),t.nrm(16,"span",4),t.k0s(),t.j41(17,"input",10),t.mxI("ngModelChange",function(m){return c.eBV(o),t.DH7(e.characterData.name,m)||(e.characterData.name=m),c.Njj(m)}),t.bIt("change",function(){return c.eBV(o),c.Njj(e.characterDataToJson())})("keyup",function(){return c.eBV(o),c.Njj(e.characterDataToJson())}),t.k0s(),t.j41(18,"label"),t.nrm(19,"span",4),t.k0s(),t.j41(20,"input",10),t.mxI("ngModelChange",function(m){return c.eBV(o),t.DH7(e.characterData.edition,m)||(e.characterData.edition=m),c.Njj(m)}),t.bIt("change",function(){return c.eBV(o),c.Njj(e.characterDataToJson())})("keyup",function(){return c.eBV(o),c.Njj(e.characterDataToJson())}),t.k0s(),t.j41(21,"label"),t.nrm(22,"span",4),t.k0s(),t.j41(23,"input",11),t.mxI("ngModelChange",function(m){return c.eBV(o),t.DH7(e.characterData.color,m)||(e.characterData.color=m),c.Njj(m)}),t.bIt("change",function(){return c.eBV(o),c.Njj(e.characterDataToJson())})("keyup",function(){return c.eBV(o),c.Njj(e.characterDataToJson())}),t.k0s(),t.j41(24,"label"),t.nrm(25,"span",4),t.k0s(),t.j41(26,"input",12),t.mxI("ngModelChange",function(m){return c.eBV(o),t.DH7(e.characterData.spoiler,m)||(e.characterData.spoiler=m),c.Njj(m)}),t.bIt("change",function(){return c.eBV(o),c.Njj(e.characterDataToJson())}),t.k0s(),t.j41(27,"label"),t.nrm(28,"span",4),t.k0s(),t.j41(29,"input",10),t.mxI("ngModelChange",function(m){return c.eBV(o),t.DH7(e.characterData.deck,m)||(e.characterData.deck=m),c.Njj(m)}),t.bIt("change",function(){return c.eBV(o),c.Njj(e.characterDataToJson())})("keyup",function(){return c.eBV(o),c.Njj(e.characterDataToJson())}),t.k0s(),t.j41(30,"label"),t.nrm(31,"span",4),t.k0s(),t.j41(32,"select",13),t.mxI("ngModelChange",function(m){return c.eBV(o),t.DH7(e.characterData.characterClass,m)||(e.characterData.characterClass=m),c.Njj(m)}),t.bIt("change",function(){return c.eBV(o),c.Njj(e.characterDataToJson())}),t.Z7z(33,Pq,2,3,"option",14,t.fX1),t.k0s(),t.j41(35,"label"),t.nrm(36,"span",4),t.k0s(),t.j41(37,"div",15)(38,"select",13),t.mxI("ngModelChange",function(m){return c.eBV(o),t.DH7(e.hpIndex,m)||(e.hpIndex=m),c.Njj(m)}),t.bIt("change",function(){return c.eBV(o),c.Njj(e.changeHpIndex())}),t.Z7z(39,bq,2,2,"option",16,t.fX1),t.nI1(41,"ghsRange"),t.k0s(),t.j41(42,"div",17),t.Z7z(43,xq,4,3,null,null,t.fX1),t.k0s()()()()()(),t.j41(45,"div",18)(46,"h2"),t.nrm(47,"span",4),t.j41(48,"select",19),t.bIt("change",function(m){return c.eBV(o),c.Njj(e.loadCharacterData(m))}),t.j41(49,"option",16),t.EFF(50,"<"),t.nrm(51,"span",4),t.EFF(52,">"),t.k0s(),t.Z7z(53,wq,5,6,"option",14,Oq),t.nI1(55,"trackUUID"),t.k0s(),t.j41(56,"select",19),t.bIt("change",function(m){return c.eBV(o),c.Njj(e.selectEdition(m))}),t.nrm(57,"option"),t.Z7z(58,Rq,2,2,"option",16,t.fX1),t.k0s()(),t.j41(60,"div"),t.EFF(61),t.k0s(),t.nrm(62,"textarea",null,0),t.j41(64,"a",20),t.nrm(65,"img",21)(66,"span",4),t.k0s()()(),t.nVh(67,jq,1,3,"ghs-deck-editor",22),t.k0s()()}if(2&i){const o=t.sdS(63);t.R7$(),t.Y8G("standalone",!0),t.R7$(3),t.Y8G("ghs-label","editor.character"),t.R7$(2),t.Y8G("ghs-label","wip"),t.R7$(6),t.Y8G("ghs-label","editor.character.data"),t.R7$(4),t.Y8G("ghs-label","editor.character.data.name"),t.R7$(),t.R50("ngModel",e.characterData.name),t.Y8G("ghs-label","editor.character.data.name")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","edition"),t.R7$(),t.R50("ngModel",e.characterData.edition),t.Y8G("ghs-label","edition")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","editor.character.data.color"),t.R7$(),t.R50("ngModel",e.characterData.color),t.Y8G("ghs-label","editor.character.data.color")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","editor.character.data.spoiler"),t.R7$(),t.R50("ngModel",e.characterData.spoiler),t.R7$(2),t.Y8G("ghs-label","editor.character.data.deck"),t.R7$(),t.R50("ngModel",e.characterData.deck),t.Y8G("ghs-label","editor.character.data.deck")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","editor.character.data.class"),t.R7$(),t.R50("ngModel",e.characterData.characterClass),t.R7$(),t.Dyx(e.CharacterClasses),t.R7$(3),t.Y8G("ghs-label","editor.character.data.hp"),t.R7$(2),t.R50("ngModel",e.hpIndex),t.R7$(),t.Dyx(t.i5U(41,34,t.lJ4(39,vq),4)),t.R7$(4),t.Dyx(e.characterData.stats),t.R7$(4),t.Y8G("ghs-label","editor.character.data.json"),t.R7$(2),t.Y8G("value",-1),t.R7$(2),t.Y8G("ghs-label","editor.character.new"),t.R7$(2),t.Dyx(t.bMT(55,37,e.charactersData)),t.R7$(5),t.Dyx(e.editions),t.R7$(3),t.SpI(" ",e.characterError," "),t.R7$(3),t.Y8G("href","data:application/json;charset=utf-8,"+e.encodeURIComponent(o.value),t.B4B)("download",e.characterData.name+".json"),t.R7$(2),t.Y8G("ghs-label","editor.character.data.json.download"),t.R7$(),t.vxM(e.init?67:-1)}},dependencies:[E.xH,E.y7,E.me,E.Q0,E.Zm,E.wz,E.BC,E.vS,bo,it,Cn,At,ct],styles:["h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{text-align:center;margin-top:calc(var(--ghs-unit) * .7);margin-bottom:calc(var(--ghs-unit) * .2)}input[_ngcontent-%COMP%]:not([type=checkbox]), textarea[_ngcontent-%COMP%]{width:100%;min-width:initial;color:var(--ghs-color-black);background-color:var(--ghs-color-white);border:1px solid var(--ghs-color-gray)}input[_ngcontent-%COMP%]:not([type=checkbox]):hover, textarea[_ngcontent-%COMP%]:hover{border:1px solid var(--ghs-color-gray)}select[_ngcontent-%COMP%]{max-width:100%}textarea[_ngcontent-%COMP%]{width:100%;min-width:calc(var(--ghs-unit) * 20);min-height:calc(var(--ghs-unit) * 50)}.ghs-icon[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}a[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center}a[_ngcontent-%COMP%]:hover{opacity:.7}a.button[_ngcontent-%COMP%]{justify-content:center;font-family:var(--ghs-font-gh-normal);font-size:calc(var(--ghs-unit) * 3);color:var(--ghs-color-white);padding:calc(var(--ghs-unit) * 1);margin:calc(var(--ghs-unit) * 1) auto;border:1px solid var(--ghs-color-gray);background-color:var(--ghs-color-darkgray);text-decoration:none}a.button[_ngcontent-%COMP%]:hover{opacity:1;color:var(--ghs-color-gray)}a.button[_ngcontent-%COMP%]:hover   .ghs-icon[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}a[_ngcontent-%COMP%]   .ghs-icon[_ngcontent-%COMP%]:nth-child(1){margin-right:.2em}.base-data[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5);color:var(--ghs-color-white);width:70%;min-width:300px;display:grid;grid-template-columns:auto auto;grid-gap:calc(var(--ghs-unit) * 2);margin:calc(var(--ghs-unit) * 1) auto;flex-shrink:1;overflow:auto}.columns[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;max-width:100%;justify-content:space-evenly}.output[_ngcontent-%COMP%]{max-width:100%}.input[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 2)}",".container[_ngcontent-%COMP%]{width:100vw;height:100vh;display:flex;flex-direction:column}.container[_ngcontent-%COMP%]   ghs-header[_ngcontent-%COMP%]{z-index:2}.character-editor[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * 2)}.character-data[_ngcontent-%COMP%]{display:flex;flex-direction:column}.character-data[_ngcontent-%COMP%]   .hp-grid[_ngcontent-%COMP%]{max-width:600px;display:grid;grid-auto-flow:column;grid-template-rows:1fr 1fr}.character-data[_ngcontent-%COMP%]   .hp-grid[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .character-data[_ngcontent-%COMP%]   .hp-grid[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:center}.character-data[_ngcontent-%COMP%]   .hp-grid[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background-color:transparent;border:1px solid var(--ghs-color-red);color:var(--ghs-color-red);min-width:40px;font-size:1em}"]})}return a})();const Tq=["inputEditionData"],Sq=()=>["X"],ga=(a,r)=>r._trackUUID;function Dq(a,r){if(1&a&&(t.j41(0,"option",12),t.nrm(1,"span",3),t.EFF(2),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n.edition),t.R7$(),t.Y8G("ghs-label","data.edition."+n.edition),t.R7$(),t.SpI(" [",n.edition,"] ")}}function $q(a,r){if(1&a&&(t.j41(0,"option",12),t.nrm(1,"span",25),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n),t.R7$(),t.Y8G("ghs-label","game.condition."+n)("ghs-label-args",t.lJ4(3,Sq))}}function Iq(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",26),t.bIt("click",function(){const e=c.eBV(n).$index,o=t.XpG();return c.Njj(o.removeCharacter(e))}),t.nrm(1,"span",3),t.EFF(2),t.k0s()}if(2&a){const n=r.$implicit;t.Y8G("ghs-label","editor.edition.character.remove")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","data.character."+n.edition+"."+n.name),t.R7$(),t.SpI(" [",n.name,"]")}}function Aq(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",26),t.bIt("click",function(){const e=c.eBV(n).$index,o=t.XpG();return c.Njj(o.removeMonster(e))}),t.nrm(1,"span",3),t.EFF(2),t.k0s()}if(2&a){const n=r.$implicit;t.Y8G("ghs-label","editor.edition.monster.remove")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","data.monster."+n.name),t.R7$(),t.SpI(" [",n.name,"]")}}function Vq(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",26),t.bIt("click",function(){const e=c.eBV(n).$index,o=t.XpG();return c.Njj(o.removeDeck(e))}),t.nrm(1,"span",3),t.EFF(2),t.k0s()}if(2&a){const n=r.$implicit;t.Y8G("ghs-label","editor.edition.decks.remove")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","data.deck."+n.name),t.R7$(),t.SpI(" [",n.name,"]")}}function Fq(a,r){if(1&a&&(t.j41(0,"option",12),t.nrm(1,"span",3),t.EFF(2),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",r.$index),t.R7$(),t.Y8G("ghs-label","data.edition."+n.edition),t.R7$(),t.SpI(" [",n.edition,"] ")}}let Xq=(()=>{class a{inputEditionData;gameManager=s.E;encodeURIComponent=encodeURIComponent;Conditions=Object.values(Q.r5).filter(n=>n!=Q.r5.bless&&n!=Q.r5.curse);editionData;editionError;constructor(){this.editionData=new se.le("",[],[],[],[],[],[])}ngOnInit(){var n=this;return(0,I.A)(function*(){yield p.f.init(!1),n.editionDataToJson()})()}editionDataToJson(){let n=JSON.parse(JSON.stringify(this.editionData));Object.keys(n).forEach(i=>{n[i]||(n[i]=void 0)}),this.inputEditionData.nativeElement.value=JSON.stringify(n,null,2)}jsonDownload(){let n=JSON.parse(JSON.stringify(this.editionData));return Object.keys(n).forEach(i=>{n[i]||(n[i]=void 0)}),this.encodeURIComponent(JSON.stringify(n))}loadEditionData(n){const i=+n.target.value;this.editionData=-1!=i?s.E.editionData[i]:new se.le("",[],[],[],[],[],[]),this.editionDataToJson()}toggleAllConditions(n){this.editionData.conditions.length==this.Conditions.length?(this.editionData.conditions=[],n.blur()):(this.editionData.conditions=JSON.parse(JSON.stringify(this.Conditions)),n.focus()),this.editionDataToJson()}addCharacterJson(n){if(n.target.files)for(let i=0;i<n.target.files.length;i++){const e=new FileReader;e.onload=()=>{try{let o=JSON.parse(e.result);return void(o&&(this.editionData.characters.find(g=>o.name==g.name&&o.edition==g.edition)||(this.editionData.characters.push(new oe.qS(o)),this.editionDataToJson())))}catch(o){console.error(o)}},e.readAsText(n.target.files[i])}n.target.value=""}removeCharacter(n){this.editionData.characters.splice(n,1),this.editionDataToJson()}addMonsterJson(n){if(n.target.files)for(let i=0;i<n.target.files.length;i++){const e=new FileReader;e.onload=()=>{try{const o=JSON.parse(e.result);return void(o&&(this.editionData.monsters.find(g=>o.name==g.name&&o.edition==g.edition)||(this.editionData.monsters.push(new pe.f(o)),this.editionDataToJson())))}catch(o){console.error(o)}},e.readAsText(n.target.files[i])}n.target.value=""}removeMonster(n){this.editionData.monsters.splice(n,1),this.editionDataToJson()}addDeckJson(n){if(n.target.files)for(let i=0;i<n.target.files.length;i++){const e=new FileReader;e.onload=()=>{try{const o=JSON.parse(e.result);return void(o&&(this.editionData.decks.find(g=>o.name==g.name&&o.edition==g.edition)||(this.editionData.decks.push(o),this.editionDataToJson())))}catch(o){console.error(o)}},e.readAsText(n.target.files[i])}n.target.value=""}removeDeck(n){this.editionData.decks.splice(n,1),this.editionDataToJson()}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-edition-editor"]],viewQuery:function(i,e){if(1&i&&t.GBs(Tq,7),2&i){let o;t.mGM(o=t.lsd())&&(e.inputEditionData=o.first)}},standalone:!1,decls:75,vars:34,consts:[["conditionSelect",""],["inputEditionData",""],[1,"back",3,"routerLink"],[3,"ghs-label"],[1,"edition-editor"],[1,"columns"],[1,"input"],[1,"edition-base"],[1,"base-data","dialog"],[1,"dialog-container"],[3,"ngModelChange","change","keyup","ngModel","ghs-label","ghs-label-attribute"],["multiple","",3,"ngModelChange","change","ngModel"],[3,"value"],[1,"conditions"],[3,"click"],[1,"files"],[1,"file-list","characters"],[1,"file",3,"ghs-label","ghs-label-attribute"],["type","file","multiple","","accept","application/json",3,"change"],[1,"file-list","monsters"],[1,"file-list","decks"],[1,"output"],[3,"change"],[1,"button",3,"href","download"],["src","./assets/images/export.svg",1,"ghs-icon"],[3,"ghs-label","ghs-label-args"],[1,"file",3,"click","ghs-label","ghs-label-attribute"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"a",2),t.nrm(1,"span",3),t.k0s(),t.j41(2,"div",4)(3,"h1"),t.nrm(4,"span",3),t.EFF(5," ("),t.nrm(6,"span",3),t.EFF(7,")"),t.k0s(),t.j41(8,"div",5)(9,"div",6)(10,"div",7)(11,"h2"),t.nrm(12,"span",3),t.k0s(),t.j41(13,"div",8)(14,"div",9)(15,"label"),t.nrm(16,"span",3),t.k0s(),t.j41(17,"input",10),t.mxI("ngModelChange",function(m){return c.eBV(o),t.DH7(e.editionData.edition,m)||(e.editionData.edition=m),c.Njj(m)}),t.bIt("change",function(){return c.eBV(o),c.Njj(e.editionDataToJson())})("keyup",function(){return c.eBV(o),c.Njj(e.editionDataToJson())}),t.k0s(),t.j41(18,"label"),t.nrm(19,"span",3),t.k0s(),t.j41(20,"select",11),t.mxI("ngModelChange",function(m){return c.eBV(o),t.DH7(e.editionData.extensions,m)||(e.editionData.extensions=m),c.Njj(m)}),t.bIt("change",function(){return c.eBV(o),c.Njj(e.editionDataToJson())}),t.Z7z(21,Dq,3,3,"option",12,ga),t.nI1(23,"trackUUID"),t.k0s(),t.j41(24,"label"),t.nrm(25,"span",3),t.k0s(),t.j41(26,"div",13)(27,"a",14),t.bIt("click",function(){c.eBV(o);const m=t.sdS(30);return c.Njj(e.toggleAllConditions(m))}),t.nrm(28,"span",3),t.k0s(),t.j41(29,"select",11,0),t.mxI("ngModelChange",function(m){return c.eBV(o),t.DH7(e.editionData.conditions,m)||(e.editionData.conditions=m),c.Njj(m)}),t.bIt("change",function(){return c.eBV(o),c.Njj(e.editionDataToJson())}),t.Z7z(31,$q,2,4,"option",12,t.fX1),t.k0s()()()()(),t.j41(33,"div",15)(34,"h2"),t.nrm(35,"span",3),t.k0s(),t.j41(36,"div",16),t.Z7z(37,Iq,3,4,"span",17,ga),t.nI1(39,"trackUUID"),t.k0s(),t.j41(40,"input",18),t.bIt("change",function(m){return c.eBV(o),c.Njj(e.addCharacterJson(m))}),t.k0s()(),t.j41(41,"div",15)(42,"h2"),t.nrm(43,"span",3),t.k0s(),t.j41(44,"div",19),t.Z7z(45,Aq,3,4,"span",17,ga),t.nI1(47,"trackUUID"),t.k0s(),t.j41(48,"input",18),t.bIt("change",function(m){return c.eBV(o),c.Njj(e.addMonsterJson(m))}),t.k0s()(),t.j41(49,"div",15)(50,"h2"),t.nrm(51,"span",3),t.k0s(),t.j41(52,"div",20),t.Z7z(53,Vq,3,4,"span",17,ga),t.nI1(55,"trackUUID"),t.k0s(),t.j41(56,"input",18),t.bIt("change",function(m){return c.eBV(o),c.Njj(e.addDeckJson(m))}),t.k0s()()(),t.j41(57,"div",21)(58,"h2"),t.nrm(59,"span",3),t.j41(60,"select",22),t.bIt("change",function(m){return c.eBV(o),c.Njj(e.loadEditionData(m))}),t.j41(61,"option",12),t.EFF(62,"<"),t.nrm(63,"span",3),t.EFF(64,">"),t.k0s(),t.Z7z(65,Fq,3,3,"option",12,ga),t.nI1(67,"trackUUID"),t.k0s()(),t.j41(68,"div"),t.EFF(69),t.k0s(),t.nrm(70,"textarea",null,1),t.j41(72,"a",23),t.nrm(73,"img",24)(74,"span",3),t.k0s()()()()}2&i&&(t.Y8G("routerLink","/"),t.R7$(),t.Y8G("ghs-label","tools.backToGhs"),t.R7$(3),t.Y8G("ghs-label","editor.edition"),t.R7$(2),t.Y8G("ghs-label","wip"),t.R7$(6),t.Y8G("ghs-label","editor.edition.base"),t.R7$(4),t.Y8G("ghs-label","editor.edition.edition"),t.R7$(),t.R50("ngModel",e.editionData.edition),t.Y8G("ghs-label","editor.edition.edition")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","editor.edition.extensions"),t.R7$(),t.R50("ngModel",e.editionData.extensions),t.R7$(),t.Dyx(t.bMT(23,24,e.gameManager.editionData)),t.R7$(4),t.Y8G("ghs-label","editor.edition.conditions"),t.R7$(3),t.Y8G("ghs-label",e.editionData.conditions.length!=e.Conditions.length?"editor.edition.conditions.allSelected":"editor.edition.conditions.allHint"),t.R7$(),t.R50("ngModel",e.editionData.conditions),t.R7$(2),t.Dyx(e.Conditions),t.R7$(4),t.Y8G("ghs-label","editor.edition.character"),t.R7$(2),t.Dyx(t.bMT(39,26,e.editionData.characters)),t.R7$(6),t.Y8G("ghs-label","editor.edition.monster"),t.R7$(2),t.Dyx(t.bMT(47,28,e.editionData.monsters)),t.R7$(6),t.Y8G("ghs-label","editor.edition.decks"),t.R7$(2),t.Dyx(t.bMT(55,30,e.editionData.decks)),t.R7$(6),t.Y8G("ghs-label","editor.edition.json"),t.R7$(2),t.Y8G("value",-1),t.R7$(2),t.Y8G("ghs-label","editor.edition.new"),t.R7$(2),t.Dyx(t.bMT(67,32,e.gameManager.editionData)),t.R7$(4),t.SpI(" ",e.editionError," "),t.R7$(3),t.Y8G("href","data:application/json;charset=utf-8,"+e.jsonDownload(),t.B4B)("download",e.editionData.edition+".json"),t.R7$(2),t.Y8G("ghs-label","editor.edition.json.download"))},dependencies:[q.Wk,E.xH,E.y7,E.me,E.W0,E.BC,E.vS,it,ct],styles:["h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{text-align:center;margin-top:calc(var(--ghs-unit) * .7);margin-bottom:calc(var(--ghs-unit) * .2)}input[_ngcontent-%COMP%]:not([type=checkbox]), textarea[_ngcontent-%COMP%]{width:100%;min-width:initial;color:var(--ghs-color-black);background-color:var(--ghs-color-white);border:1px solid var(--ghs-color-gray)}input[_ngcontent-%COMP%]:not([type=checkbox]):hover, textarea[_ngcontent-%COMP%]:hover{border:1px solid var(--ghs-color-gray)}select[_ngcontent-%COMP%]{max-width:100%}textarea[_ngcontent-%COMP%]{width:100%;min-width:calc(var(--ghs-unit) * 20);min-height:calc(var(--ghs-unit) * 50)}.ghs-icon[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}a[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center}a[_ngcontent-%COMP%]:hover{opacity:.7}a.button[_ngcontent-%COMP%]{justify-content:center;font-family:var(--ghs-font-gh-normal);font-size:calc(var(--ghs-unit) * 3);color:var(--ghs-color-white);padding:calc(var(--ghs-unit) * 1);margin:calc(var(--ghs-unit) * 1) auto;border:1px solid var(--ghs-color-gray);background-color:var(--ghs-color-darkgray);text-decoration:none}a.button[_ngcontent-%COMP%]:hover{opacity:1;color:var(--ghs-color-gray)}a.button[_ngcontent-%COMP%]:hover   .ghs-icon[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}a[_ngcontent-%COMP%]   .ghs-icon[_ngcontent-%COMP%]:nth-child(1){margin-right:.2em}.base-data[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5);color:var(--ghs-color-white);width:70%;min-width:300px;display:grid;grid-template-columns:auto auto;grid-gap:calc(var(--ghs-unit) * 2);margin:calc(var(--ghs-unit) * 1) auto;flex-shrink:1;overflow:auto}.columns[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;max-width:100%;justify-content:space-evenly}.output[_ngcontent-%COMP%]{max-width:100%}.input[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 2)}",".files[_ngcontent-%COMP%]   .file-list[_ngcontent-%COMP%]{display:flex;flex-direction:column}.files[_ngcontent-%COMP%]   .file-list[_ngcontent-%COMP%]   .file[_ngcontent-%COMP%]{font-size:1.5em;cursor:pointer}.files[_ngcontent-%COMP%]   .file-list[_ngcontent-%COMP%]   .file[_ngcontent-%COMP%]:hover{text-decoration:line-through}.conditions[_ngcontent-%COMP%]{display:flex;flex-direction:column}.conditions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:.7em}"]})}return a})();var ti=v(4786);const Bq=["inputMonsterData"],Yq=["monsterStats"],Uq=["deckEditor"],bc=()=>[],kc=a=>({current:a}),Nq=a=>[a],De=(a,r)=>r._trackUUID;function zq(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",17),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return o.level=e,c.Njj(o.updateQueryParams())}),t.EFF(1),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(2,kc,i.level==n)),t.R7$(),t.SpI(" ",n)}}function Lq(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",32)(1,"input",35),t.bIt("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2).$implicit,g=t.XpG();return c.Njj(g.statsForType(g.MonsterType.normal,o).health=g.valueChange(e))})("change",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())})("keyup",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())}),t.k0s(),t.j41(2,"input",36),t.bIt("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2).$implicit,g=t.XpG();return c.Njj(g.statsForType(g.MonsterType.elite,o).health=g.valueChange(e))})("change",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())})("keyup",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())}),t.k0s(),t.j41(3,"input",37),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2).$implicit,g=t.XpG();return t.DH7(g.statsForType(g.MonsterType.normal,o).movement,e)||(g.statsForType(g.MonsterType.normal,o).movement=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())})("keyup",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())}),t.k0s(),t.j41(4,"input",38),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2).$implicit,g=t.XpG();return t.DH7(g.statsForType(g.MonsterType.elite,o).movement,e)||(g.statsForType(g.MonsterType.elite,o).movement=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())})("keyup",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())}),t.k0s(),t.j41(5,"input",35),t.bIt("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2).$implicit,g=t.XpG();return c.Njj(g.statsForType(g.MonsterType.normal,o).attack=g.valueChange(e))})("change",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())})("keyup",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())}),t.k0s(),t.j41(6,"input",36),t.bIt("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2).$implicit,g=t.XpG();return c.Njj(g.statsForType(g.MonsterType.elite,o).attack=g.valueChange(e))})("change",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())})("keyup",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())}),t.k0s(),t.j41(7,"input",37),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2).$implicit,g=t.XpG();return t.DH7(g.statsForType(g.MonsterType.normal,o).range,e)||(g.statsForType(g.MonsterType.normal,o).range=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())})("keyup",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())}),t.k0s(),t.j41(8,"input",38),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2).$implicit,g=t.XpG();return t.DH7(g.statsForType(g.MonsterType.elite,o).range,e)||(g.statsForType(g.MonsterType.elite,o).range=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())})("keyup",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())}),t.k0s()()}if(2&a){const n=t.XpG(2).$implicit,i=t.XpG();t.R7$(),t.Y8G("ngModel",i.statsForType(i.MonsterType.normal,n).health),t.R7$(),t.Y8G("ngModel",i.statsForType(i.MonsterType.elite,n).health),t.R7$(),t.R50("ngModel",i.statsForType(i.MonsterType.normal,n).movement),t.R7$(),t.R50("ngModel",i.statsForType(i.MonsterType.elite,n).movement),t.R7$(),t.Y8G("ngModel",i.statsForType(i.MonsterType.normal,n).attack),t.R7$(),t.Y8G("ngModel",i.statsForType(i.MonsterType.elite,n).attack),t.R7$(),t.R50("ngModel",i.statsForType(i.MonsterType.normal,n).range),t.R7$(),t.R50("ngModel",i.statsForType(i.MonsterType.elite,n).range)}}function qq(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",33)(1,"input",35),t.bIt("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2).$implicit,g=t.XpG();return c.Njj(g.statsForType(g.MonsterType.boss,o).health=g.valueChange(e))})("change",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())})("keyup",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())}),t.k0s(),t.j41(2,"input",37),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2).$implicit,g=t.XpG();return t.DH7(g.statsForType(g.MonsterType.boss,o).movement,e)||(g.statsForType(g.MonsterType.boss,o).movement=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())})("keyup",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())}),t.k0s(),t.j41(3,"input",35),t.bIt("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2).$implicit,g=t.XpG();return c.Njj(g.statsForType(g.MonsterType.boss,o).attack=g.valueChange(e))})("change",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())})("keyup",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())}),t.k0s(),t.j41(4,"input",37),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2).$implicit,g=t.XpG();return t.DH7(g.statsForType(g.MonsterType.boss,o).range,e)||(g.statsForType(g.MonsterType.boss,o).range=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())})("keyup",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.monsterDataToJson())}),t.k0s()()}if(2&a){const n=t.XpG(2).$implicit,i=t.XpG();t.R7$(),t.Y8G("ngModel",i.statsForType(i.MonsterType.boss,n).health),t.R7$(),t.R50("ngModel",i.statsForType(i.MonsterType.boss,n).movement),t.R7$(),t.Y8G("ngModel",i.statsForType(i.MonsterType.boss,n).attack),t.R7$(),t.R50("ngModel",i.statsForType(i.MonsterType.boss,n).range)}}function Hq(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",42)(1,"span",46),t.nrm(2,"img",47),t.k0s(),t.j41(3,"ghs-action",48),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(3).$implicit,g=t.XpG();return c.Njj(g.editMonsterAction(g.MonsterType.normal,e,o))}),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG(3).$implicit,e=t.XpG();t.R7$(3),t.Y8G("action",n)("monster",e.getMonsterForLevel(i))("inline",!0)("right",!0)("hexSize",.5)("relative",!0)}}function Kq(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",42)(1,"ghs-action",49),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(3).$implicit,g=t.XpG();return c.Njj(g.editMonsterAction(g.MonsterType.elite,e,o))}),t.k0s(),t.j41(2,"span",46),t.nrm(3,"img",47),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG(3).$implicit,e=t.XpG();t.R7$(),t.Y8G("action",n)("monster",e.getMonsterForLevel(i))("inline",!0)("hexSize",.5)("relative",!0)}}function Wq(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",39),t.nrm(1,"div",40),t.j41(2,"div",41),t.bIt("cdkDropListDropped",function(e){c.eBV(n);const o=t.XpG(2).$implicit,g=t.XpG();return c.Njj(g.dropMonsterAction(g.MonsterType.normal,o,e))}),t.Z7z(3,Hq,4,6,"div",42,De),t.nI1(5,"trackUUID"),t.j41(6,"a",43),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2).$implicit,o=t.XpG();return c.Njj(o.addMonsterAction(o.MonsterType.normal,e))}),t.nrm(7,"img",44)(8,"span",5),t.k0s()()(),t.j41(9,"div",45),t.nrm(10,"div",40),t.j41(11,"div",41),t.bIt("cdkDropListDropped",function(e){c.eBV(n);const o=t.XpG(2).$implicit,g=t.XpG();return c.Njj(g.dropMonsterAction(g.MonsterType.elite,o,e))}),t.Z7z(12,Kq,4,5,"div",42,De),t.nI1(14,"trackUUID"),t.j41(15,"a",43),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2).$implicit,o=t.XpG();return c.Njj(o.addMonsterAction(o.MonsterType.elite,e))}),t.nrm(16,"img",44)(17,"span",5),t.k0s()()()}if(2&a){const n=t.XpG(2).$implicit,i=t.XpG();t.R7$(),t.Y8G("ghs-label",i.statsForType(i.MonsterType.normal,n).note),t.R7$(2),t.Dyx(t.bMT(5,4,i.statsForType(i.MonsterType.normal,n).actions)),t.R7$(5),t.Y8G("ghs-label","editor.action.add"),t.R7$(2),t.Y8G("ghs-label",i.statsForType(i.MonsterType.elite,n).note),t.R7$(2),t.Dyx(t.bMT(14,6,i.statsForType(i.MonsterType.elite,n).actions)),t.R7$(5),t.Y8G("ghs-label","editor.action.add")}}function Zq(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",42)(1,"ghs-action",49),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(3).$implicit,g=t.XpG();return c.Njj(g.editMonsterAction(g.MonsterType.boss,e,o))}),t.k0s(),t.j41(2,"span",46),t.nrm(3,"img",47),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG(3).$implicit,e=t.XpG();t.R7$(),t.Y8G("action",n)("monster",e.getMonsterForLevel(i))("inline",!0)("hexSize",.5)("relative",!0)}}function Jq(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-action",49),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG().$index,g=t.XpG(3).$implicit,m=t.XpG();return c.Njj(m.editSpecialAction(m.MonsterType.boss,o,e,g))}),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(4).$implicit,e=t.XpG();t.Y8G("action",n)("monster",e.getMonsterForLevel(i))("inline",!0)("hexSize",.5)("relative",!0)}}function Qq(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",51)(1,"span",52),t.EFF(2),t.k0s(),t.j41(3,"div",53),t.Z7z(4,Jq,1,5,"ghs-action",54,De),t.nI1(6,"trackUUID"),t.j41(7,"a",43),t.bIt("click",function(){const e=c.eBV(n).$index,o=t.XpG(3).$implicit,g=t.XpG();return c.Njj(g.addSpecialAction(g.MonsterType.boss,e,o))}),t.nrm(8,"img",44)(9,"span",5),t.k0s()()()}if(2&a){const n=r.$index,i=t.XpG(3).$implicit,e=t.XpG();t.R7$(2),t.SpI("",n+1,":"),t.R7$(2),t.Dyx(t.bMT(6,2,e.statsForType(e.MonsterType.boss,i).special[n])),t.R7$(5),t.Y8G("ghs-label","editor.action.add")}}function tH(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",34),t.nrm(1,"div",40),t.j41(2,"div",41),t.bIt("cdkDropListDropped",function(e){c.eBV(n);const o=t.XpG(2).$implicit,g=t.XpG();return c.Njj(g.dropMonsterAction(g.MonsterType.boss,o,e))}),t.Z7z(3,Zq,4,5,"div",42,De),t.nI1(5,"trackUUID"),t.j41(6,"a",43),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2).$implicit,o=t.XpG();return c.Njj(o.addMonsterAction(o.MonsterType.boss,e))}),t.nrm(7,"img",44)(8,"span",5),t.k0s()(),t.j41(9,"div",50),t.Z7z(10,Qq,10,4,"div",51,De),t.nI1(12,"trackUUID"),t.j41(13,"a",43),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2).$implicit,o=t.XpG();return c.Njj(o.addSpecialAction(o.MonsterType.boss,o.statsForType(o.MonsterType.boss,e).special.length,e))}),t.nrm(14,"img",44)(15,"span",5),t.k0s()()()}if(2&a){const n=t.XpG(2).$implicit,i=t.XpG();t.R7$(),t.Y8G("ghs-label",i.statsForType(i.MonsterType.boss,n).note),t.R7$(2),t.Dyx(t.bMT(5,3,i.statsForType(i.MonsterType.boss,n).actions)),t.R7$(5),t.Y8G("ghs-label","editor.action.add"),t.R7$(2),t.Dyx(t.bMT(12,5,i.statsForType(i.MonsterType.boss,n).special)),t.R7$(5),t.Y8G("ghs-label","editor.monster.stats.addSpecial")}}function nH(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",28),t.nrm(1,"ghs-monster-stats",30),t.j41(2,"input",31),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG(2);return t.DH7(o.monsterData.name,e)||(o.monsterData.name=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.monsterDataToJson())})("keyup",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.monsterDataToJson())}),t.k0s(),t.nVh(3,Lq,9,8,"div",32),t.nVh(4,qq,5,4,"div",33),t.nVh(5,Wq,18,8),t.nVh(6,tH,16,7,"div",34),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(),t.Y8G("monster",i.getMonsterForLevel(n))("noClick",!0),t.R7$(),t.R50("ngModel",i.monsterData.name),t.R7$(),t.vxM(i.monsterData.boss?-1:3),t.R7$(),t.vxM(i.monsterData.boss?4:-1),t.R7$(),t.vxM(i.monsterData.boss?-1:5),t.R7$(),t.vxM(i.monsterData.boss?6:-1)}}function eH(a,r){if(1&a&&(t.j41(0,"div",18),t.nVh(1,nH,7,7,"div",28),t.nrm(2,"ghs-monster-stats",29),t.k0s()),2&a){const n=r.$implicit,i=t.XpG();t.R7$(),t.vxM(-1!=n?1:-1),t.R7$(),t.Y8G("monster",i.getMonsterForLevel(n))("forceStats",!0)("relative",!0)("noClick",!0)}}function aH(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",55),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.applyToAllLevel(e.level))}),t.nrm(1,"span",5),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","editor.monster.stats.applyAll"))}function iH(a,r){if(1&a&&(t.j41(0,"option",23),t.nrm(1,"span",5),t.EFF(2," ("),t.nrm(3,"span",5),t.EFF(4),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG();t.Y8G("value",i)("selected",n.edition==e.monsterData.edition&&n.name==e.monsterData.name),t.R7$(),t.Y8G("ghs-label","data.monster."+n.name),t.R7$(2),t.Y8G("ghs-label","data.edition."+n.edition),t.R7$(),t.SpI(") [",n.name,"] ")}}function oH(a,r){if(1&a&&(t.j41(0,"option",22),t.nrm(1,"span",5),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n),t.R7$(),t.Y8G("ghs-label","data.edition."+n)}}function sH(a,r){if(1&a&&t.nrm(0,"ghs-deck-editor",27,1),2&a){const n=t.XpG();t.Y8G("monster",n.getMonsterForLevel(n.level))("standalone",!1)("edition",n.edition)}}const ko='{"name": "new-monster", "thumbnail" : "", "edition": "", "deck": "", "boss": false, "flying" : false, "hidden":false, "count": 10, "baseStat" : {}, "stats": []}';let rH=(()=>{class a{dialog;route;router;ghsManager;inputMonsterData;monsterStats;deckEditor;gameManager=s.E;MonsterType=S.N;monsterData;ActionType=$.X2;ActionValueType=$.iQ;encodeURIComponent=encodeURIComponent;levels=[0,1,2,3,4,5,6,7];level=-1;monsterError;edition;init=!1;monstersData=[];editions=[];constructor(n,i,e,o){this.dialog=n,this.route=i,this.router=e,this.ghsManager=o,this.monsterData=JSON.parse(ko),this.updateType(!1)}ngOnInit(){var n=this;return(0,I.A)(function*(){yield p.f.init(!1),n.monsterDataToJson(),n.inputMonsterData.nativeElement.addEventListener("change",i=>{n.monsterDataFromJson()}),n.editions=s.E.editions(!0),n.monstersData=s.E.monstersData(n.edition),n.route.queryParams.subscribe({next:i=>{if(i.edition&&(n.edition=i.edition,n.edition&&s.E.editions(!1).includes(n.edition)),n.monstersData=s.E.monstersData(n.edition),i.monster){const e=n.monstersData.find(o=>o.name==i.monster);e&&(n.monsterData=e,n.monsterDataToJson())}i.level&&(n.level=+i.level,-1!=n.level&&!n.levels.includes(n.level)&&(n.level=1)),!n.monsterData.edition&&n.edition&&(n.monsterData.edition=n.edition)}}),n.init=!0})()}monsterDataToJson(){this.monsterData.stats.sort((i,e)=>i.level-e.level!=0?i.level-e.level:i.type==S.N.normal&&e.type==S.N.elite?-1:1);let n=JSON.parse(JSON.stringify(this.monsterData));if(n.baseStat.actions=n.baseStat.actions||void 0,n.baseStat.immunities=n.baseStat.immunities||void 0,n.baseStat.special=n.baseStat.special||void 0,Object.keys(n.stats[0]).forEach(i=>{n.stats.every(e=>JSON.stringify(e[i])==JSON.stringify(n.stats[0][i]))&&(n.baseStat[i]=n.stats[0][i],n.stats.forEach(e=>{e[i]=void 0}))}),!n.boss){n.baseStat.type="normal",n.stats.filter(g=>"normal"==g.type).forEach(g=>{g.type=void 0});let i=[];const e=n.stats.filter(g=>!g.type)[0];e&&Object.keys(e).forEach(g=>{e[g]&&n.stats.filter(m=>!m.type).every(m=>JSON.stringify(m[g])==JSON.stringify(e[g]))&&"type"!=g&&(n.baseStat[g]=e[g],i.push(g),n.stats.filter(m=>!m.type).forEach(m=>{m[g]=void 0}))});const o=n.stats.filter(g=>"elite"==g.type)[0];o&&Object.keys(o).forEach(g=>{o[g]&&n.stats.filter(m=>"elite"==m.type).every(m=>JSON.stringify(m[g])==JSON.stringify(o[g]))&&!i.includes(g)&&"type"!=g&&(n.baseStat[g]=o[g],n.stats.filter(m=>"elite"==m.type).forEach(m=>{m[g]=void 0}))})}Object.keys(n).forEach(i=>{n[i]||(n[i]=void 0)}),n.stats.forEach(i=>{Object.keys(i).forEach(e=>{!i[e]&&"level"!=e&&(i[e]=void 0)}),i.immunities&&0==i.immunities.length&&(i.immunities=void 0),i.actions&&0==i.actions.length?i.actions=void 0:i.actions&&i.actions.forEach(e=>Yn(e)),i.special&&0==i.special.length?i.special=void 0:i.special&&i.special.forEach(e=>{e.forEach(o=>Yn(o))})}),Object.keys(n.baseStat).forEach(i=>{n.baseStat[i]||(n.baseStat[i]=void 0)}),n.baseStat.actions&&0==n.baseStat.actions.length?n.baseStat.actions=void 0:n.baseStat.actions&&n.baseStat.actions.forEach(i=>Yn(i)),n.baseStat.special&&n.baseStat.special.forEach(i=>{i.forEach(e=>Yn(e))}),this.inputMonsterData.nativeElement.value=JSON.stringify(n,null,2)}monsterDataFromJson(){if(this.monsterError="",this.inputMonsterData.nativeElement.value)try{return this.monsterData=JSON.parse(this.inputMonsterData.nativeElement.value),void(this.monsterData&&this.updateType(!1))}catch(n){this.monsterData=JSON.parse(ko),this.monsterError=n}}valueChange(n){return n&&!isNaN(+n)?+n:n}statsForType(n,i){let e=this.monsterData.stats.find(o=>this.monsterData&&o.level==i&&o.type==n);return e||(this.monsterData.errors=this.monsterData.errors||[],!this.monsterData.errors.find(o=>o.type==ti.H.unknown)&&!this.monsterData.errors.find(o=>o.type==ti.H.stat)&&(console.error("Could not find '"+n+"' stats for monster: "+this.monsterData.name+" level: "+i),this.monsterData.errors.push(new ti.h(ti.H.stat,"monster",this.monsterData.name,this.monsterData.edition,n,""+i))),e=new Kt.f(n,i),this.monsterData.stats.push(e)),e}setLevel(n){this.monsterStats.setLevel(n)}getMonsterForLevel(n){let i=new b.R(this.monsterData);return i.level=-1!=n?n:1,i}applyToAllLevel(n){this.monsterData.stats=this.monsterData.stats.filter(i=>i.level==n);for(let i of this.levels)if(i!=n)if(this.monsterData.boss){let e=JSON.parse(JSON.stringify(this.statsForType(S.N.boss,n)));e.level=i,this.monsterData.stats.push(e)}else{let e=JSON.parse(JSON.stringify(this.statsForType(S.N.normal,n)));e.level=i,this.monsterData.stats.push(e),e=JSON.parse(JSON.stringify(this.statsForType(S.N.elite,n))),e.level=i,this.monsterData.stats.push(e)}this.monsterDataToJson()}updateType(n=!0){if(this.monsterData)if(this.monsterData.boss){this.monsterData.stats=this.monsterData.stats.filter(i=>!i.type||i.type==S.N.boss);for(let i of this.levels)this.monsterData.stats.some(e=>e.level==i)||this.monsterData.stats.push(new Kt.f(S.N.boss,i))}else{this.monsterData.stats=this.monsterData.stats.filter(i=>i.type!=S.N.boss);for(let i of this.levels)this.monsterData.stats.some(e=>e.level==i&&(!e.type||e.type==S.N.normal))||this.monsterData.stats.push(new Kt.f(S.N.normal,i)),this.monsterData.stats.some(e=>e.level==i&&e.type==S.N.elite)||this.monsterData.stats.push(new Kt.f(S.N.elite,i))}n&&this.monsterDataToJson()}toggleBoss(){this.monsterData.count=this.monsterData.boss?1:10,this.updateType()}addMonsterAction(n,i){let e=new $.rc($.X2.attack);const o=this.statsForType(n,i);o.actions.push(e),this.dialog.open(wn,{panelClass:["dialog"],data:{action:e,monster:this.getMonsterForLevel(i)}}).closed.subscribe({next:m=>{0==m&&o.actions.splice(o.actions.indexOf(e),1),this.monsterDataToJson()}})}editMonsterAction(n,i,e){this.dialog.open(wn,{panelClass:["dialog"],data:{action:i,monster:this.getMonsterForLevel(e)}}).closed.subscribe({next:g=>{if(0==g){const m=this.statsForType(n,e);m.actions.splice(m.actions.indexOf(i),1)}this.monsterDataToJson()}})}dropMonsterAction(n,i,e){const o=this.statsForType(n,i);(0,V.HD)(o.actions,e.previousIndex,e.currentIndex),this.ghsManager.triggerUiChange(),this.monsterDataToJson()}addSpecialAction(n,i,e){let o=new $.rc($.X2.attack);const g=this.statsForType(n,e);g.special||(g.special=[]),g.special.length<=i&&(g.special[i]=[]),g.special[i].push(o),this.dialog.open(wn,{panelClass:["dialog"],data:{action:o,monster:this.getMonsterForLevel(e)}}).closed.subscribe({next:k=>{0==k&&(g.special[i].splice(g.special[i].indexOf(o),1),0==g.special[i].length&&g.special.splice(i,1)),this.monsterDataToJson()}})}editSpecialAction(n,i,e,o){this.dialog.open(wn,{panelClass:["dialog"],data:{action:e,monster:this.getMonsterForLevel(o)}}).closed.subscribe({next:m=>{if(0==m){const k=this.statsForType(n,o);k.special||(k.special=[]),k.special.length<=i&&(k.special[i]=[]),k.special[i].splice(k.special[i].indexOf(e),1),0==k.special[i].length&&k.special.splice(i,1)}this.monsterDataToJson()}})}loadMonsterData(n){const i=+n.target.value;this.monsterData=-1!=i?this.monstersData[i]:JSON.parse(ko),this.updateType(),this.monsterDataToJson(),this.updateQueryParams()}updateQueryParams(){!this.monsterData.edition&&this.edition&&(this.monsterData.edition=this.edition),this.router.navigate([],{relativeTo:this.route,queryParams:{edition:this.edition||void 0,monster:this.monsterData&&this.monsterData.name||void 0,level:1!=this.level?this.level:void 0},queryParamsHandling:"merge"})}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG),t.rXU(Ht.nX),t.rXU(Ht.Ix),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-monster-editor"]],viewQuery:function(i,e){if(1&i&&(t.GBs(Bq,7),t.GBs(Yq,5),t.GBs(Uq,5)),2&i){let o;t.mGM(o=t.lsd())&&(e.inputMonsterData=o.first),t.mGM(o=t.lsd())&&(e.monsterStats=o.first),t.mGM(o=t.lsd())&&(e.deckEditor=o.first)}},standalone:!1,decls:69,vars:49,consts:[["inputMonsterData",""],["deckEditor",""],[1,"container"],[3,"standalone"],[1,"monster-editor"],[3,"ghs-label"],[1,"columns"],[1,"input"],[1,"monster-stats"],[1,"base-data","dialog"],[1,"dialog-container"],[3,"ngModelChange","change","keyup","ngModel","ghs-label","ghs-label-attribute"],["type","checkbox",3,"ngModelChange","change","ngModel"],["type","number","min","1","max","10",3,"ngModelChange","change","keyup","ngModel","ghs-label","ghs-label-attribute"],[1,"level-select"],[1,"select"],[1,"level",3,"ngClass"],[1,"level",3,"click","ngClass"],[1,"stats-container"],[1,"button"],[1,"output"],[3,"change"],[3,"value"],[3,"value","selected"],[3,"ngModelChange","change","ngModel"],[1,"button",3,"href","download"],["src","./assets/images/export.svg",1,"ghs-icon"],[3,"monster","standalone","edition"],[1,"stats-input"],[1,"stats-preview",3,"monster","forceStats","relative","noClick"],[1,"stats-editor",3,"monster","noClick"],[1,"name",3,"ngModelChange","change","keyup","ngModel"],[1,"stats"],[1,"stats","boss"],[1,"extra","boss"],[1,"stat","end",3,"ngModelChange","change","keyup","ngModel"],[1,"stat","start",3,"ngModelChange","change","keyup","ngModel"],["type","number",1,"stat","end",3,"ngModelChange","change","keyup","ngModel"],["type","number",1,"stat","start",3,"ngModelChange","change","keyup","ngModel"],[1,"extra","normal"],[1,"notes",3,"ghs-label"],["cdkDropList","",1,"additional",3,"cdkDropListDropped"],["cdkDrag","",1,"monster-action"],[3,"click"],["src","./assets/images/plus.svg",1,"ghs-icon"],[1,"extra","elite"],["cdkDragHandle","",1,"handle"],["src","./assets/images/menu.svg",1,"ghs-icon"],[3,"click","action","monster","inline","right","hexSize","relative"],[3,"click","action","monster","inline","hexSize","relative"],[1,"specials"],[1,"special"],[1,"index"],[1,"actions"],[3,"action","monster","inline","hexSize","relative"],[1,"button",3,"click"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",2),t.nrm(1,"ghs-header",3),t.j41(2,"div",4)(3,"h1"),t.nrm(4,"span",5),t.EFF(5," ("),t.nrm(6,"span",5),t.EFF(7,")"),t.k0s(),t.j41(8,"div",6)(9,"div",7)(10,"div",8)(11,"h2"),t.nrm(12,"span",5),t.k0s(),t.j41(13,"div",9)(14,"div",10)(15,"label"),t.nrm(16,"span",5),t.k0s(),t.j41(17,"input",11),t.mxI("ngModelChange",function(m){return c.eBV(o),t.DH7(e.monsterData.edition,m)||(e.monsterData.edition=m),c.Njj(m)}),t.bIt("change",function(){return c.eBV(o),c.Njj(e.monsterDataToJson())})("keyup",function(){return c.eBV(o),c.Njj(e.monsterDataToJson())}),t.k0s(),t.j41(18,"label"),t.nrm(19,"span",5),t.k0s(),t.j41(20,"input",11),t.mxI("ngModelChange",function(m){return c.eBV(o),t.DH7(e.monsterData.deck,m)||(e.monsterData.deck=m),c.Njj(m)}),t.bIt("change",function(){return c.eBV(o),c.Njj(e.monsterDataToJson())})("keyup",function(){return c.eBV(o),c.Njj(e.monsterDataToJson())}),t.k0s(),t.j41(21,"label"),t.nrm(22,"span",5),t.k0s(),t.j41(23,"input",12),t.mxI("ngModelChange",function(m){return c.eBV(o),t.DH7(e.monsterData.boss,m)||(e.monsterData.boss=m),c.Njj(m)}),t.bIt("change",function(){return c.eBV(o),c.Njj(e.toggleBoss())}),t.k0s(),t.j41(24,"label"),t.nrm(25,"span",5),t.k0s(),t.j41(26,"input",12),t.mxI("ngModelChange",function(m){return c.eBV(o),t.DH7(e.monsterData.flying,m)||(e.monsterData.flying=m),c.Njj(m)}),t.bIt("change",function(){return c.eBV(o),c.Njj(e.updateType())}),t.k0s(),t.j41(27,"label"),t.nrm(28,"span",5),t.k0s(),t.j41(29,"input",12),t.mxI("ngModelChange",function(m){return c.eBV(o),t.DH7(e.monsterData.hidden,m)||(e.monsterData.hidden=m),c.Njj(m)}),t.bIt("change",function(){return c.eBV(o),c.Njj(e.updateType())}),t.k0s(),t.j41(30,"label"),t.nrm(31,"span",5),t.k0s(),t.j41(32,"input",13),t.mxI("ngModelChange",function(m){return c.eBV(o),t.DH7(e.monsterData.count,m)||(e.monsterData.count=m),c.Njj(m)}),t.bIt("change",function(){return c.eBV(o),c.Njj(e.monsterDataToJson())})("keyup",function(){return c.eBV(o),c.Njj(e.monsterDataToJson())}),t.k0s()()(),t.j41(33,"div",14)(34,"span",15),t.nrm(35,"span",5),t.EFF(36,":"),t.k0s(),t.Z7z(37,zq,2,4,"div",16,t.fX1),t.nI1(39,"ghsRange"),t.j41(40,"div",17),t.bIt("click",function(){return c.eBV(o),e.level=-1,c.Njj(e.updateQueryParams())}),t.nrm(41,"span",5),t.k0s()(),t.Z7z(42,eH,3,5,"div",18,t.fX1),t.nI1(44,"ghsRange"),t.nVh(45,aH,2,1,"a",19),t.k0s()(),t.j41(46,"div",20)(47,"h2"),t.nrm(48,"span",5),t.j41(49,"select",21),t.bIt("change",function(m){return c.eBV(o),c.Njj(e.loadMonsterData(m))}),t.j41(50,"option",22),t.EFF(51,"<"),t.nrm(52,"span",5),t.EFF(53,">"),t.k0s(),t.Z7z(54,iH,5,5,"option",23,De),t.nI1(56,"trackUUID"),t.k0s(),t.j41(57,"select",24),t.mxI("ngModelChange",function(m){return c.eBV(o),t.DH7(e.edition,m)||(e.edition=m),c.Njj(m)}),t.bIt("change",function(){return c.eBV(o),c.Njj(e.updateQueryParams())}),t.nrm(58,"option"),t.Z7z(59,oH,2,2,"option",22,t.fX1),t.k0s()(),t.j41(61,"div"),t.EFF(62),t.k0s(),t.nrm(63,"textarea",null,0),t.j41(65,"a",25),t.nrm(66,"img",26)(67,"span",5),t.k0s()()(),t.nVh(68,sH,2,3,"ghs-deck-editor",27),t.k0s()()}if(2&i){const o=t.sdS(64);t.R7$(),t.Y8G("standalone",!0),t.R7$(3),t.Y8G("ghs-label","editor.monster"),t.R7$(2),t.Y8G("ghs-label","wip"),t.R7$(6),t.Y8G("ghs-label","editor.monster.stats"),t.R7$(4),t.Y8G("ghs-label","edition"),t.R7$(),t.R50("ngModel",e.monsterData.edition),t.Y8G("ghs-label","edition")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","editor.monster.stats.deck"),t.R7$(),t.R50("ngModel",e.monsterData.deck),t.Y8G("ghs-label","editor.monster.stats.deck")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","editor.monster.stats.boss"),t.R7$(),t.R50("ngModel",e.monsterData.boss),t.R7$(2),t.Y8G("ghs-label","editor.monster.stats.flying"),t.R7$(),t.R50("ngModel",e.monsterData.flying),t.R7$(2),t.Y8G("ghs-label","editor.monster.stats.hidden"),t.R7$(),t.R50("ngModel",e.monsterData.hidden),t.R7$(2),t.Y8G("ghs-label","editor.monster.stats.count"),t.R7$(),t.R50("ngModel",e.monsterData.count),t.Y8G("ghs-label","editor.monster.count")("ghs-label-attribute","placeholder"),t.R7$(3),t.Y8G("ghs-label","editor.monster.stats.levelSelect"),t.R7$(2),t.Dyx(t.i5U(39,35,t.lJ4(43,bc),8)),t.R7$(3),t.Y8G("ngClass",t.eq3(44,kc,-1==e.level)),t.R7$(),t.Y8G("ghs-label","editor.monster.stats.allLevel"),t.R7$(),t.Dyx(-1==e.level?t.i5U(44,38,t.lJ4(46,bc),8):t.eq3(47,Nq,e.level)),t.R7$(3),t.vxM(-1!=e.level?45:-1),t.R7$(3),t.Y8G("ghs-label","editor.monster.stats.json"),t.R7$(2),t.Y8G("value",-1),t.R7$(2),t.Y8G("ghs-label","editor.monster.new"),t.R7$(2),t.Dyx(t.bMT(56,41,e.monstersData)),t.R7$(3),t.R50("ngModel",e.edition),t.R7$(2),t.Dyx(e.editions),t.R7$(3),t.SpI(" ",e.monsterError," "),t.R7$(3),t.Y8G("href","data:application/json;charset=utf-8,"+e.encodeURIComponent(o.value),t.B4B)("download",e.monsterData.name+".json"),t.R7$(2),t.Y8G("ghs-label","editor.monster.stats.json.download"),t.R7$(),t.vxM(e.init?68:-1)}},dependencies:[N.YU,E.xH,E.y7,E.me,E.Q0,E.Zm,E.wz,E.BC,E.VZ,E.zX,E.vS,V.O7,V.T1,V.Fb,en,bo,it,Cn,Te,At,ct],styles:["h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{text-align:center;margin-top:calc(var(--ghs-unit) * .7);margin-bottom:calc(var(--ghs-unit) * .2)}input[_ngcontent-%COMP%]:not([type=checkbox]), textarea[_ngcontent-%COMP%]{width:100%;min-width:initial;color:var(--ghs-color-black);background-color:var(--ghs-color-white);border:1px solid var(--ghs-color-gray)}input[_ngcontent-%COMP%]:not([type=checkbox]):hover, textarea[_ngcontent-%COMP%]:hover{border:1px solid var(--ghs-color-gray)}select[_ngcontent-%COMP%]{max-width:100%}textarea[_ngcontent-%COMP%]{width:100%;min-width:calc(var(--ghs-unit) * 20);min-height:calc(var(--ghs-unit) * 50)}.ghs-icon[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}a[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center}a[_ngcontent-%COMP%]:hover{opacity:.7}a.button[_ngcontent-%COMP%]{justify-content:center;font-family:var(--ghs-font-gh-normal);font-size:calc(var(--ghs-unit) * 3);color:var(--ghs-color-white);padding:calc(var(--ghs-unit) * 1);margin:calc(var(--ghs-unit) * 1) auto;border:1px solid var(--ghs-color-gray);background-color:var(--ghs-color-darkgray);text-decoration:none}a.button[_ngcontent-%COMP%]:hover{opacity:1;color:var(--ghs-color-gray)}a.button[_ngcontent-%COMP%]:hover   .ghs-icon[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}a[_ngcontent-%COMP%]   .ghs-icon[_ngcontent-%COMP%]:nth-child(1){margin-right:.2em}.base-data[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5);color:var(--ghs-color-white);width:70%;min-width:300px;display:grid;grid-template-columns:auto auto;grid-gap:calc(var(--ghs-unit) * 2);margin:calc(var(--ghs-unit) * 1) auto;flex-shrink:1;overflow:auto}.columns[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;max-width:100%;justify-content:space-evenly}.output[_ngcontent-%COMP%]{max-width:100%}.input[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 2)}",".container[_ngcontent-%COMP%]{width:100vw;height:100vh;display:flex;flex-direction:column}.container[_ngcontent-%COMP%]   ghs-header[_ngcontent-%COMP%]{z-index:2}.monster-editor[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * 2)}.monster-stats[_ngcontent-%COMP%]{display:flex;flex-direction:column}.monster-stats[_ngcontent-%COMP%]   .level-select[_ngcontent-%COMP%]{display:flex;grid-gap:calc(var(--ghs-unit) * 2);margin:0 auto;margin-top:calc(var(--ghs-unit) * 3)}.monster-stats[_ngcontent-%COMP%]   .level-select[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);font-size:calc(var(--ghs-unit) * 3);text-shadow:var(--ghs-outline);color:var(--ghs-color-gray);cursor:pointer}.monster-stats[_ngcontent-%COMP%]   .level-select[_ngcontent-%COMP%]   .level.current[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-darkgray)}.monster-stats[_ngcontent-%COMP%]   .level-select[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]{pointer-events:none;font-size:calc(var(--ghs-unit) * 3);color:var(--ghs-color-black)}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:space-around;align-items:center;margin-top:calc(var(--ghs-unit) * 3);min-width:calc(var(--ghs-unit) * 82)}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   ghs-monster-stats[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 40);height:calc(var(--ghs-unit) * 21.5)}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 40);height:calc(var(--ghs-unit) * 21.5)}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 6.2);left:calc(var(--ghs-unit) * 15);width:calc(var(--ghs-unit) * 9.5);display:grid;grid-template-columns:1fr 1fr;column-gap:calc(var(--ghs-unit) * 2);filter:drop-shadow(calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) var(--ghs-color-black));z-index:1}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.7 * var(--ghs-fontsize));padding:0;width:calc(var(--ghs-unit) * 4 * var(--ghs-fontsize));min-width:auto;color:var(--ghs-color-black);background-color:var(--ghs-color-white);height:calc(var(--ghs-unit) * 2.9 * var(--ghs-fontsize));border:none;margin:calc(var(--ghs-unit) * .2 * var(--ghs-fontsize)) 0}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.end[_ngcontent-%COMP%]{justify-self:end}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.start[_ngcontent-%COMP%]{justify-self:start;text-align:left}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .stats.boss[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 6.5);left:calc(var(--ghs-unit) * 4.5);grid-template-columns:1fr}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .stats.boss[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 6 * var(--ghs-fontsize))}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 6.5);width:calc(var(--ghs-unit) * 14);height:calc(100% - var(--ghs-unit) * 6.5);overflow-y:auto;display:flex;flex-direction:column;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-fontsize))}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .monster-action[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .monster-action[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{cursor:grab}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]{cursor:pointer}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]:hover{opacity:.7}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ghs-icon[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra.normal[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * 25.5);text-align:right}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra.normal[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{justify-content:end}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra.normal[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--ghs-color-black);justify-content:flex-end}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra.normal[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ghs-icon[_ngcontent-%COMP%]{filter:none}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra.elite[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * .5);color:var(--ghs-color-white)}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra.boss[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 21);right:calc(var(--ghs-unit) * .5);color:var(--ghs-color-white)}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .special[_ngcontent-%COMP%]{display:flex;align-items:baseline}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .special[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;flex-direction:column}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .special[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .special[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]:first-child{margin-top:calc(var(--ghs-unit) * .5)}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .special[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * .2)}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);position:absolute;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));top:calc(var(--ghs-unit) * .5);left:calc(var(--ghs-unit) * 7);width:calc(var(--ghs-unit) * 26);color:var(--ghs-color-white);background-color:transparent;border:1px solid var(--ghs-color-gray)}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]:hover{border:1px solid var(--ghs-color-gray)}"]})}return a})();const cH=(a,r)=>r._trackUUID;function lH(a,r){if(1&a&&(t.j41(0,"option",5),t.nrm(1,"span",3),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n),t.R7$(),t.Y8G("ghs-label","data.edition."+n)}}function gH(a,r){if(1&a&&(t.j41(0,"option",5),t.nrm(1,"span",3),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n),t.R7$(),t.Y8G("ghs-label","game.events.type."+n)}}function dH(a,r){if(1&a&&t.nrm(0,"ghs-event-card",10),2&a){const n=r.$implicit,i=t.XpG();t.Y8G("event",n)("select",-1!=i.selected?i.selected-1:-1)("flipped",0==i.selected)("spoiler",i.spoiler)("debug",i.debug)}}let hH=(()=>{class a{route;router;gameManager=s.E;settingsManager=p.f;events=[];edition;types=[];type="";selected=-1;iterator=-1;spoiler=!1;debug=!0;constructor(n,i){this.route=n,this.router=i}ngOnInit(){var n=this;return(0,I.A)(function*(){yield p.f.init(!1),s.E.stateManager.init(!0),n.edition=s.E.editions(!0)[0],n.update(),n.route.queryParams.subscribe({next:i=>{let e=!1;i.edition&&(n.edition=i.edition,n.edition&&s.E.editions(!1).includes(n.edition),e=!0),i.type&&(n.type=i.type,e=!0),null!=i.selected&&(n.selected=+i.selected),i.iterator&&(n.iterator=+i.iterator),e&&n.update()}})})()}changeIterator(n){this.iterator+=n,this.update(),this.updateQueryParams()}update(){this.events=[],this.edition&&(this.types=s.E.eventCardManager.getEventTypesForEdition(this.edition,!1),(!this.type||!this.types.includes(this.type))&&(this.type=this.types[0]),this.events=s.E.eventCardManager.getEventCardsForEdition(this.edition,this.type,!1).filter((n,i)=>-1==this.iterator||this.iterator==i))}updateQueryParams(){this.router.navigate([],{relativeTo:this.route,queryParams:{edition:this.edition||void 0,type:this.type||void 0,selected:this.selected,iterator:-1!=this.iterator?this.iterator:void 0},queryParamsHandling:"merge"})}static \u0275fac=function(i){return new(i||a)(t.rXU(Ht.nX),t.rXU(Ht.Ix))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-event-cards-tool"]],standalone:!1,decls:40,vars:19,consts:[[1,"container"],[3,"standalone"],[1,"menu"],[3,"ghs-label"],[3,"ngModelChange","change","ngModel"],[3,"value"],[3,"click","disabled"],[3,"click"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"events"],[3,"event","select","flipped","spoiler","debug"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nrm(1,"ghs-header",1),t.j41(2,"div",2)(3,"label"),t.nrm(4,"span",3),t.j41(5,"select",4),t.mxI("ngModelChange",function(g){return t.DH7(e.edition,g)||(e.edition=g),g}),t.bIt("change",function(){return e.update(),e.updateQueryParams()}),t.Z7z(6,lH,2,2,"option",5,t.fX1),t.k0s()(),t.j41(8,"label"),t.nrm(9,"span",3),t.j41(10,"select",4),t.mxI("ngModelChange",function(g){return t.DH7(e.type,g)||(e.type=g),g}),t.bIt("change",function(){return e.update(),e.updateQueryParams()}),t.Z7z(11,gH,2,2,"option",5,t.fX1),t.k0s()(),t.j41(13,"label"),t.nrm(14,"span",3),t.j41(15,"select",4),t.mxI("ngModelChange",function(g){return t.DH7(e.selected,g)||(e.selected=g),g}),t.bIt("change",function(){return e.updateQueryParams()}),t.j41(16,"option",5),t.EFF(17,"none"),t.k0s(),t.j41(18,"option",5),t.EFF(19,"flip"),t.k0s(),t.j41(20,"option",5),t.EFF(21,"A."),t.k0s(),t.j41(22,"option",5),t.EFF(23,"B."),t.k0s(),t.j41(24,"option",5),t.EFF(25,"C."),t.k0s()()(),t.j41(26,"button",6),t.bIt("click",function(){return e.changeIterator(-1)}),t.EFF(27,"-"),t.k0s(),t.j41(28,"button",7),t.bIt("click",function(){return e.changeIterator(1)}),t.EFF(29,"+"),t.k0s(),t.j41(30,"label")(31,"input",8),t.mxI("ngModelChange",function(g){return t.DH7(e.spoiler,g)||(e.spoiler=g),g}),t.k0s(),t.nrm(32,"span",3),t.k0s(),t.j41(33,"label")(34,"input",8),t.mxI("ngModelChange",function(g){return t.DH7(e.debug,g)||(e.debug=g),g}),t.k0s(),t.nrm(35,"span",3),t.k0s()(),t.j41(36,"div",9),t.Z7z(37,dH,1,5,"ghs-event-card",10,cH),t.nI1(39,"trackUUID"),t.k0s()()),2&i&&(t.R7$(),t.Y8G("standalone",!0),t.R7$(3),t.Y8G("ghs-label","settings.edition"),t.R7$(),t.R50("ngModel",e.edition),t.R7$(),t.Dyx(e.gameManager.editions(!0)),t.R7$(3),t.Y8G("ghs-label","game.events.type"),t.R7$(),t.R50("ngModel",e.type),t.R7$(),t.Dyx(e.types),t.R7$(3),t.Y8G("ghs-label","game.events.select"),t.R7$(),t.R50("ngModel",e.selected),t.R7$(),t.Y8G("value",-1),t.R7$(2),t.Y8G("value",0),t.R7$(2),t.Y8G("value",1),t.R7$(2),t.Y8G("value",2),t.R7$(2),t.Y8G("value",3),t.R7$(2),t.Y8G("disabled",-1==e.iterator),t.R7$(5),t.R50("ngModel",e.spoiler),t.R7$(),t.Y8G("ghs-label","game.events.spoiler"),t.R7$(2),t.R50("ngModel",e.debug),t.R7$(),t.Y8G("ghs-label","game.events.debug"),t.R7$(2),t.Dyx(t.bMT(39,17,e.events)))},dependencies:[E.xH,E.y7,E.Zm,E.wz,E.BC,E.vS,Xa,it,Cn,ct],styles:[".menu[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex}.container[_ngcontent-%COMP%]{width:100vw;height:100vh;display:flex;flex-direction:column}.container[_ngcontent-%COMP%]   ghs-header[_ngcontent-%COMP%]{z-index:2}.events[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;overflow:auto}.events[_ngcontent-%COMP%]   ghs-event-card[_ngcontent-%COMP%]{width:400px;min-width:400px;height:600px;min-height:600px;margin:10px}"]})}return a})();const _H=(a,r)=>r._trackUUID;function mH(a,r){if(1&a&&(t.j41(0,"option",5),t.nrm(1,"span",3),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n),t.R7$(),t.Y8G("ghs-label","data.edition."+n)}}function pH(a,r){if(1&a&&(t.j41(0,"div",7),t.nrm(1,"ghs-random-monster-card",8),t.k0s()),2&a){const n=r.$implicit;t.R7$(),t.Y8G("section",n)("flipped",!0)}}function uH(a,r){if(1&a&&(t.j41(0,"div",6),t.Z7z(1,pH,2,2,"div",7,_H),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(t.bMT(3,0,n.sections))}}let fH=(()=>{class a{route;router;gameManager=s.E;sections=[];edition;constructor(n,i){this.route=n,this.router=i}ngOnInit(){var n=this;return(0,I.A)(function*(){yield p.f.init(!1),s.E.stateManager.init(!0),n.edition=s.E.editions(!0)[0],n.update(),n.route.queryParams.subscribe({next:i=>{i.edition&&(n.edition=i.edition,n.edition&&s.E.editions(!1).includes(n.edition),n.update())}})})()}update(){this.sections=[];const n=s.E.editionData.find(i=>i.edition==this.edition);n&&n.sections&&(this.sections=n.sections.filter(i=>"randomMonsterCard"==i.group).sort((i,e)=>i.name<e.name?-1:1))}updateQueryParams(){this.router.navigate([],{relativeTo:this.route,queryParams:{edition:this.edition||void 0},queryParamsHandling:"merge"})}static \u0275fac=function(i){return new(i||a)(t.rXU(Ht.nX),t.rXU(Ht.Ix))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-random-monster-cards-tool"]],standalone:!1,decls:9,vars:4,consts:[[1,"container"],[3,"standalone"],[1,"menu"],[3,"ghs-label"],[3,"ngModelChange","change","ngModel"],[3,"value"],[1,"sections"],[1,"section"],[3,"section","flipped"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nrm(1,"ghs-header",1),t.j41(2,"div",2)(3,"label"),t.nrm(4,"span",3),t.j41(5,"select",4),t.mxI("ngModelChange",function(g){return t.DH7(e.edition,g)||(e.edition=g),g}),t.bIt("change",function(){return e.update(),e.updateQueryParams()}),t.Z7z(6,mH,2,2,"option",5,t.fX1),t.k0s()()(),t.nVh(8,uH,4,2,"div",6),t.k0s()),2&i&&(t.R7$(),t.Y8G("standalone",!0),t.R7$(3),t.Y8G("ghs-label","settings.edition"),t.R7$(),t.R50("ngModel",e.edition),t.R7$(),t.Dyx(e.gameManager.editions(!0)),t.R7$(2),t.vxM(e.edition?8:-1))},dependencies:[E.xH,E.y7,E.wz,E.BC,E.vS,it,Cn,rc,ct],styles:[".container[_ngcontent-%COMP%]{width:100vw;height:100vh;display:flex;flex-direction:column}.container[_ngcontent-%COMP%]   ghs-header[_ngcontent-%COMP%]{z-index:2}.sections[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{display:flex;margin:10px;padding:10px;background-color:var(--ghs-color-darkgray)}.sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   ghs-random-monster-card[_ngcontent-%COMP%]{display:block;width:calc(var(--ghs-unit) * 40);height:calc(var(--ghs-unit) * 60)}"]})}return a})();const CH=["header"],MH=(a,r)=>({vertical:a,modern:r}),yo=a=>({active:a}),vH=(a,r)=>r._trackUUID;function OH(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",10),t.bIt("singleClick",function(){const e=c.eBV(n).$index,o=t.XpG();return c.Njj(o.selectCharacterDeck(e))})("doubleClick",function(){const e=c.eBV(n).$index,o=t.XpG();return c.Njj(o.removeCharacter(e))}),t.nrm(1,"img",11),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG();t.Y8G("ngClass",t.eq3(2,yo,e.activeDeckIndex==i+1)),t.R7$(),t.Y8G("src",n.iconUrl,t.B4B)}}function PH(a,r){if(1&a){const n=t.RV6();t.j41(0,"ghs-attackmodifier-deck",12),t.bIt("before",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.beforeAttackModifierDeck(e))})("after",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.afterAttackModifierDeck(e))}),t.k0s()}if(2&a){const n=t.XpG();t.Y8G("deck",n.activeDeckIndex>0?n.characters[n.activeDeckIndex-1].attackModifierDeck:0==n.activeDeckIndex?n.gameManager.game.allyAttackModifierDeck:n.gameManager.game.monsterAttackModifierDeck)("numeration",n.activeDeckIndex>0?"":0==n.activeDeckIndex?"A":"m")("standalone",!0)("fullscreen",!1)("vertical",n.vertical())("ally",0==n.activeDeckIndex)("character",n.activeDeckIndex>0?n.characters[n.activeDeckIndex-1]:void 0)("battleGoals",!1)}}function bH(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",16),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.openCharacterSheet())}),t.nrm(1,"img",11),t.j41(2,"span",17),t.EFF(3),t.k0s()()}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("src",n.characters[n.activeDeckIndex-1].iconUrl,t.B4B),t.R7$(2),t.JRh(n.gameManager.characterManager.characterName(n.characters[n.activeDeckIndex-1]))}}function kH(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",9),t.nVh(1,bH,4,2,"a",13),t.j41(2,"a",14),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.next())}),t.nrm(3,"span",15),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(),t.vxM(n.activeDeckIndex>0?1:-1),t.R7$(2),t.Y8G("ghs-label","round.next")}}let yH=(()=>{class a{route;router;dialog;ghsManager;gameManager=s.E;settingsManager=p.f;characters=[];characterWarning=!1;init=!1;activeDeckIndex=-1;header;constructor(n,i,e,o){this.route=n,this.router=i,this.dialog=e,this.ghsManager=o}ngOnInit(){var n=this;return(0,I.A)(function*(){try{yield G.n.init()}catch{}yield p.f.init(!1),yield s.E.stateManager.init(!0),s.E.game.figures.forEach(i=>i.active=!1),n.characters=s.E.game.figures.filter(i=>i instanceof H.K).map(i=>i),n.ghsManager.triggerUiChange(),s.E.game.state!=D.mk.next&&s.E.roundManager.nextGameState(!0),n.route.queryParams.subscribe({next:i=>{if(n.characterWarning=!1,i.e&&i.c){let e=s.E.game.figures.find(o=>o instanceof H.K&&o.edition==i.e&&o.name==i.c);if(!e){const o=s.E.charactersData(i.e).find(g=>g.edition==i.e&&g.name==i.c);o&&(s.E.stateManager.before("addChar","data.character."+o.edition+"."+o.name),s.E.characterManager.addCharacter(o,1),s.E.stateManager.after(),e=s.E.game.figures.find(g=>g instanceof H.K&&g.edition==i.e&&g.name==i.c))}e?(n.activeDeckIndex=n.characters.indexOf(e)+1,n.updateQueryParams()):(n.characterWarning=!0,console.warn("No character available for edition '"+i.e+"' with name '"+i.c+"'!"))}else null!=i.a&&(n.activeDeckIndex=0,n.updateQueryParams());n.init=!0}}),n.uiChangeSubscription=n.ghsManager.onUiChange().subscribe({next:()=>{n.characters=s.E.game.figures.filter(i=>i instanceof H.K).map(i=>i),n.activeDeckIndex>n.characters.length+1&&(n.activeDeckIndex=-1,n.updateQueryParams())}})})()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}vertical(){return window.innerWidth<800}selectMonsterDeck(){-1!=this.activeDeckIndex&&(this.activeDeckIndex=-1,this.updateQueryParams(),s.E.game.monsterAttackModifierDeck.active=!1,setTimeout(()=>{s.E.game.monsterAttackModifierDeck.active=!0},1))}selectAllyDeck(){0!=this.activeDeckIndex&&(this.activeDeckIndex=0,this.updateQueryParams(),s.E.game.allyAttackModifierDeck.active=!1,setTimeout(()=>{s.E.game.allyAttackModifierDeck.active=!0},1))}selectCharacterDeck(n){this.activeDeckIndex!=n+1&&(this.activeDeckIndex=n+1,this.updateQueryParams(),this.characters[n].attackModifierDeck.active=!1,setTimeout(()=>{this.characters[n].attackModifierDeck.active=!0},1))}removeCharacter(n){this.activeDeckIndex==n+1&&(this.activeDeckIndex--,this.updateQueryParams()),s.E.stateManager.before("addChar","data.character."+this.characters[n].edition+"."+this.characters[n].name),s.E.characterManager.removeCharacter(this.characters[n]),s.E.stateManager.after()}addCharacter(){this.header.openMenu(In.character_add)}beforeAttackModifierDeck(n){s.E.stateManager.before("updateAttackModifierDeck."+n.type,this.activeDeckIndex>0?s.E.characterManager.characterName(this.characters[this.activeDeckIndex-1]):0==this.activeDeckIndex?"ally":"monster",...n.values)}afterAttackModifierDeck(n){this.activeDeckIndex>0?this.characters[this.activeDeckIndex-1].attackModifierDeck=n.deck:0==this.activeDeckIndex?s.E.game.allyAttackModifierDeck=n.deck:s.E.game.monsterAttackModifierDeck=n.deck,s.E.stateManager.after()}next(){s.E.stateManager.before("draw"),s.E.game.state==D.mk.next&&s.E.roundManager.nextGameState(!0),s.E.roundManager.nextGameState(!0),s.E.game.figures.forEach(n=>n.active=!1),s.E.stateManager.after()}openCharacterSheet(){s.E.stateManager.updatePermissions(),this.dialog.open(An,{panelClass:["dialog-invert"],data:{character:this.characters[this.activeDeckIndex-1],forceEdit:!0}})}updateQueryParams(){let n,i,e;0==this.activeDeckIndex?n=!0:this.activeDeckIndex>0&&(i=this.characters[this.activeDeckIndex-1].edition,e=this.characters[this.activeDeckIndex-1].name),this.router.navigate([],{relativeTo:this.route,queryParams:{a:n,e:i,c:e},queryParamsHandling:"merge"})}static \u0275fac=function(i){return new(i||a)(t.rXU(Ht.nX),t.rXU(Ht.Ix),t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-attackmodifier-standalone"]],viewQuery:function(i,e){if(1&i&&t.GBs(CH,5),2&i){let o;t.mGM(o=t.lsd())&&(e.header=o.first)}},standalone:!1,decls:15,vars:15,consts:[["header",""],["ghs-keyboard-shortcuts","",1,"attackmodifier-standalone",3,"ngClass"],[3,"standalone"],[1,"decks"],[1,"deck",3,"click","ngClass"],["ghs-pointer-input","",1,"deck",3,"ngClass"],[1,"add-character",3,"click"],["src","./assets/images/plus.svg"],[3,"deck","numeration","standalone","fullscreen","vertical","ally","character","battleGoals"],[1,"menu"],["ghs-pointer-input","",1,"deck",3,"singleClick","doubleClick","ngClass"],[3,"src"],[3,"before","after","deck","numeration","standalone","fullscreen","vertical","ally","character","battleGoals"],[1,"character"],[1,"next",3,"click"],[3,"ghs-label"],[1,"character",3,"click"],[1,"title"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",1),t.nrm(1,"ghs-header",2,0),t.j41(3,"div",3)(4,"span",4),t.bIt("click",function(){return c.eBV(o),c.Njj(e.selectMonsterDeck())}),t.EFF(5,"m"),t.k0s(),t.j41(6,"span",4),t.bIt("click",function(){return c.eBV(o),c.Njj(e.selectAllyDeck())}),t.EFF(7,"A"),t.k0s(),t.Z7z(8,OH,2,4,"span",5,vH),t.nI1(10,"trackUUID"),t.j41(11,"a",6),t.bIt("click",function(){return c.eBV(o),c.Njj(e.addCharacter())}),t.nrm(12,"img",7),t.k0s()(),t.nVh(13,PH,1,8,"ghs-attackmodifier-deck",8),t.nVh(14,kH,4,2,"div",9),t.k0s()}2&i&&(t.Y8G("ngClass",t.l_i(8,MH,e.vertical(),"modern"==e.settingsManager.settings.theme)),t.R7$(),t.Y8G("standalone",!0),t.R7$(3),t.Y8G("ngClass",t.eq3(11,yo,-1==e.activeDeckIndex)),t.R7$(2),t.Y8G("ngClass",t.eq3(13,yo,0==e.activeDeckIndex)),t.R7$(2),t.Dyx(t.bMT(10,6,e.characters)),t.R7$(5),t.vxM(e.init?13:-1),t.R7$(),t.vxM(e.init?14:-1))},dependencies:[N.YU,ye,it,Cn,Ha,dt,ct],styles:[".attackmodifier-standalone[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100vw;height:100vh}.attackmodifier-standalone[_ngcontent-%COMP%]   ghs-header[_ngcontent-%COMP%]{z-index:2}.attackmodifier-standalone[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:calc(var(--ghs-unit) * 1) 0}.attackmodifier-standalone[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);display:flex;justify-content:center;z-index:2;width:calc(var(--ghs-unit) * 5);height:calc(var(--ghs-unit) * 5);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 3.5);line-height:calc(var(--ghs-unit) * 4.5);background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-character-icon.83c1ab396221d56b.png);margin:calc(var(--ghs-unit) * 1);cursor:pointer}.attackmodifier-standalone[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * .8);filter:grayscale(100%) brightness(100) contrast(100%);height:70%;width:auto}.attackmodifier-standalone[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]:hover{filter:brightness(.7)}.attackmodifier-standalone[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .deck.active[_ngcontent-%COMP%]{cursor:initial;filter:grayscale(.5) brightness(.5)}.attackmodifier-standalone[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .add-character[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 5);height:calc(var(--ghs-unit) * 5);margin:calc(var(--ghs-unit) * 1)}.attackmodifier-standalone[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .add-character[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5);height:auto;filter:var(--ghs-filter-grayscale)}.attackmodifier-standalone[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .add-character[_ngcontent-%COMP%]:hover{opacity:.7}.attackmodifier-standalone[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{display:flex;width:calc(var(--ghs-unit) * 80);height:calc(var(--ghs-unit) * 21);z-index:1;margin-top:calc(var(--ghs-unit) * 5);margin-left:calc(var(--ghs-unit) * 7)}.attackmodifier-standalone[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 5);display:flex;justify-content:flex-start;align-items:center}.attackmodifier-standalone[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 4);margin:calc(var(--ghs-unit) * 1);color:var(--ghs-color-darkgray)}.attackmodifier-standalone[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}.attackmodifier-standalone[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:nth-child(1){margin-right:calc(var(--ghs-unit) * 4)}.attackmodifier-standalone[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4.5);width:auto;margin-right:calc(var(--ghs-unit) * 1)}.attackmodifier-standalone[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:brightness(1.3)}.attackmodifier-standalone.vertical[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden}.attackmodifier-standalone.vertical[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 10);height:calc(var(--ghs-unit) * 10);font-size:calc(var(--ghs-unit) * 7);line-height:calc(var(--ghs-unit) * 9)}.attackmodifier-standalone.vertical[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1.5)}.attackmodifier-standalone.vertical[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .add-character[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 10);height:calc(var(--ghs-unit) * 10)}.attackmodifier-standalone.vertical[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .add-character[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 7)}.attackmodifier-standalone.vertical[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 94);margin-left:calc(var(--ghs-unit) * 1);margin-right:calc(var(--ghs-unit) * 5);height:0;max-height:initial;transform:none}.attackmodifier-standalone.vertical[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{flex-direction:column;align-items:end}.attackmodifier-standalone.vertical[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 5)}.attackmodifier-standalone.vertical[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:nth-child(1){margin-right:calc(var(--ghs-unit) * 1)}.attackmodifier-standalone.vertical[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 5.5)}.attackmodifier-standalone.modern[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--ghs-color-gray)}"]})}return a})();const xH=(a,r,n)=>({vertical:a,fh:r,modern:n}),EH=(a,r)=>({error:a,warn:r}),wH=()=>[1,2,3,4,5,6,7,8,9],xo=a=>({active:a}),RH=(a,r)=>r._trackUUID;function jH(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1,"\xa0("),t.nrm(2,"span",19),t.EFF(3,")"),t.k0s()),2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","data.character."+n.character.edition+"."+n.character.name)}}function GH(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function TH(a,r){if(1&a&&(t.j41(0,"span",12),t.nVh(1,GH,2,0,"span"),t.j41(2,"span"),t.EFF(3),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(),t.vxM(n.character.initiative<10?1:-1),t.R7$(2),t.JRh(n.character.initiative)}}function SH(a,r){1&a&&(t.j41(0,"span",12),t.EFF(1," ?? "),t.k0s())}function DH(a,r){1&a&&(t.j41(0,"span",12),t.EFF(1," -- "),t.k0s())}function $H(a,r){1&a&&t.nrm(0,"img",13)}function IH(a,r){if(1&a){const n=t.RV6();t.nrm(0,"span",20),t.j41(1,"span",21),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.setLongRest())}),t.nrm(2,"img",13)(3,"span",19),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(2,xo,n.longRest)),t.R7$(2),t.Y8G("ghs-label","game.figure.longRest"+(n.longRest?"Off":""))}}function AH(a,r){1&a&&t.nrm(0,"img",13)}function VH(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",16),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.pickNumber(e))}),t.j41(1,"span",17),t.EFF(2),t.k0s()()}if(2&a){const n=r.$implicit;t.R7$(2),t.JRh(n)}}function FH(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",21),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.setLongRest())}),t.nrm(1,"img",13)(2,"span",19),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(2,xo,n.longRest)),t.R7$(2),t.Y8G("ghs-label","game.figure.longRest"+(n.longRest?"Off":""))}}function XH(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",4)(1,"div",7)(2,"div",8)(3,"span",9),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openCharacterSheet())}),t.nrm(4,"img",10),t.EFF(5),t.nVh(6,jH,4,1,"span"),t.k0s(),t.j41(7,"div",11),t.nVh(8,TH,4,2,"span",12),t.nVh(9,SH,2,0,"span",12),t.nVh(10,DH,2,0,"span",12),t.nVh(11,$H,1,0,"img",13),t.k0s(),t.nVh(12,IH,4,4),t.k0s(),t.j41(13,"div",14),t.nrm(14,"span"),t.j41(15,"span",12),t.EFF(16),t.nVh(17,AH,1,0,"img",13),t.k0s(),t.nrm(18,"span"),t.Z7z(19,VH,3,1,"span",15,t.fX1),t.j41(21,"span",16),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.value="__")}),t.j41(22,"span",17),t.EFF(23,"*"),t.k0s()(),t.j41(24,"span",16),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.pickNumber(0))}),t.j41(25,"span",17),t.EFF(26,"0"),t.k0s()(),t.j41(27,"span",16),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.setCurrentValue())}),t.j41(28,"span",17),t.EFF(29,"#"),t.k0s()()(),t.nVh(30,FH,3,4,"span",18),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(4),t.Y8G("src",n.character.iconUrl,t.B4B),t.R7$(),t.SpI(" ",n.gameManager.characterManager.characterName(n.character)," "),t.R7$(),t.vxM(n.character.title?6:-1),t.R7$(),t.Y8G("ngClass",t.l_i(12,EH,200!=n.statusCode&&403!=n.statusCode,403==n.statusCode)),t.R7$(),t.vxM(n.character.initiative&&(n.character.initiativeVisible||"next"==n.gameManager.game.state)?8:-1),t.R7$(),t.vxM(n.character.initiative&&!n.character.initiativeVisible&&"next"!=n.gameManager.game.state?9:-1),t.R7$(),t.vxM(n.character.initiative?-1:10),t.R7$(),t.vxM(n.character.initiativeVisible&&99==n.character.initiative&&n.character.longRest?11:-1),t.R7$(),t.vxM(n.vertical()?-1:12),t.R7$(4),t.SpI("",n.value," "),t.R7$(),t.vxM(n.longRest?17:-1),t.R7$(2),t.Dyx(t.lJ4(15,wH)),t.R7$(11),t.vxM(n.vertical()?30:-1)}}function BH(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",22),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.selectCharacter(e))}),t.nrm(1,"img",23),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(2,xo,i.character==n)),t.R7$(),t.Y8G("src",n.iconUrl,t.B4B)}}function YH(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",24),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.settingsManager.toggle("standaloneInitiativeAutomatic"))}),t.k0s(),t.nrm(2,"span",19),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("checked",n.settingsManager.settings.standaloneInitiativeAutomatic),t.R7$(),t.Y8G("ghs-label","Automatic")}}let UH=(()=>{class a{dialog;ghsManager;gameManager=s.E;settingsManager=p.f;characters=[];character;value="__";longRest=!1;statusCode=200;constructor(n,i){this.dialog=n,this.ghsManager=i}ngOnInit(){var n=this;return(0,I.A)(function*(){try{yield G.n.init()}catch{}yield p.f.init(!1),yield s.E.stateManager.init(!0),n.update(),n.ghsManager.triggerUiChange(),n.uiChangeSubscription=n.ghsManager.onUiChange().subscribe({next:()=>n.update()}),window.addEventListener("focus",i=>{p.f.settings.serverAutoconnect&&s.E.stateManager.wsState()!=WebSocket.OPEN&&s.E.stateManager.connect()})})()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.characters=s.E.game.figures.filter(n=>n instanceof H.K).map(n=>n),this.character=this.characters.find(n=>n.fullview)||this.characters.length&&this.characters[0]||void 0,this.statusCode=200}vertical(){return window.innerWidth<800}selectCharacter(n){this.character==n?this.openCharacterSheet():(this.characters.forEach(i=>i.fullview=!1),this.character=n,this.character.fullview=!0,s.E.stateManager.saveLocal())}onKeyPress(n){p.f.settings.keyboardShortcuts&&(0,F.bb)(n)&&0==this.dialog.openDialogs.length&&n.key in["0","1","2","3","4","5","6","7","8","9"]&&(this.pickNumber(+n.key),n.preventDefault(),n.stopPropagation())}pickNumber(n){this.value.includes("_")||(this.value="__",this.longRest=!1),"__"==this.value?(this.value=n+"_",this.longRest=!1):(this.value=this.value[0]+n,p.f.settings.standaloneInitiativeAutomatic&&this.updateInitiative(+this.value))}updateInitiative(n){this.character&&(this.character.initiative!=n||this.longRest!=this.character.longRest)&&(n>=0&&n<100?this.setInitiative(n):s.E.game.state==D.mk.draw&&(this.character.initiative=0))}setInitiative(n){var i=this;return(0,I.A)(function*(){if(i.character&&((s.E.game.state==D.mk.draw||!p.f.settings.initiativeRequired)&&n>=0||n>=0)&&n<100&&(n!=i.character.initiative||i.longRest!=i.character.longRest)){if(i.statusCode=200,s.E.stateManager.wsState()==WebSocket.OPEN&&p.f.settings.serverUrl){let e=p.f.settings.serverWss?"https://":"http://";const o=p.f.settings.serverUrl.split("/");e+=o[0],(p.f.settings.serverWss&&443!=p.f.settings.serverPort||!p.f.settings.serverWss&&80!=p.f.settings.serverPort)&&(e+=":"+p.f.settings.serverPort),o.length>1&&(e+="/"+o.slice(1).join("/")),e+="/game/initiative";const g=yield fetch(e,{method:"POST",body:JSON.stringify({playerNumber:i.character.number,initiative:n,longRest:i.longRest}),headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:p.f.settings.serverCode||""}});i.statusCode=g.status}200==i.statusCode&&(i.character.initiativeVisible=!0,i.character.initiative=n,i.character.longRest=i.longRest,99!=i.character.initiative&&(i.character.longRest=!1),i.value="__",i.longRest=!1,s.E.stateManager.saveLocal())}})()}setLongRest(){this.character&&(this.longRest=!this.longRest,this.value="99",p.f.settings.standaloneInitiativeAutomatic&&this.updateInitiative(+this.value))}openCharacterSheet(){this.character&&(s.E.stateManager.updatePermissions(),this.dialog.open(An,{panelClass:["dialog-invert"],data:{character:this.character}}))}setCurrentValue(){this.value=this.value.replaceAll("_",""),this.setInitiative(this.value&&+this.value||0)}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-initiative-standalone"]],hostBindings:function(i,e){1&i&&t.bIt("keydown",function(g){return e.onKeyPress(g)},t.EBC)},standalone:!1,decls:10,vars:11,consts:[["header",""],["ghs-keyboard-shortcuts","",1,"initiative-standalone",3,"ngClass"],[3,"standalone","connection"],[1,"scroll-container"],[1,"dialog"],[1,"characters"],[1,"character",3,"ngClass"],[1,"dialog-container","initiative-dialog"],[1,"title"],[1,"character",3,"click"],[1,"icon",3,"src"],[1,"initiative",3,"ngClass"],[1,"value"],["src","./assets/images/long-rest.svg",1,"ghs-svg"],[1,"number-container"],[1,"number-button"],[1,"number-button",3,"click"],[1,"number"],[1,"long-rest-button",3,"ngClass"],[3,"ghs-label"],[1,"spacer"],[1,"long-rest-button",3,"click","ngClass"],[1,"character",3,"click","ngClass"],[3,"src"],["type","checkbox",3,"change","checked"]],template:function(i,e){1&i&&(t.j41(0,"div",1),t.nrm(1,"ghs-header",2,0),t.j41(3,"div",3),t.nVh(4,XH,31,16,"div",4),t.j41(5,"div",5),t.Z7z(6,BH,2,4,"span",6,RH),t.nI1(8,"trackUUID"),t.nVh(9,YH,3,2,"label"),t.k0s()()()),2&i&&(t.Y8G("ngClass",t.sMw(7,xH,e.vertical(),"fh"==e.settingsManager.settings.theme,"modern"==e.settingsManager.settings.theme)),t.R7$(),t.Y8G("standalone",!0)("connection",!0),t.R7$(3),t.vxM(e.character?4:-1),t.R7$(2),t.Dyx(t.bMT(8,5,e.characters)),t.R7$(3),t.vxM(e.character?9:-1))},dependencies:[N.YU,it,Cn,Ha,ct],styles:[".initiative-standalone[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100vw;height:100vh}.initiative-standalone[_ngcontent-%COMP%]   ghs-header[_ngcontent-%COMP%]{z-index:2}.initiative-standalone[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.initiative-standalone[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:calc(var(--ghs-unit) * 1) 0}.initiative-standalone[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);display:flex;justify-content:center;z-index:2;width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(token.d1b1e1243b98d66e.png);margin:calc(var(--ghs-unit) * 1);cursor:pointer;filter:grayscale(.5) brightness(.5)}.initiative-standalone[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * .8);height:70%;width:auto}.initiative-standalone[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]:hover{filter:brightness(.7)}.initiative-standalone[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character.active[_ngcontent-%COMP%]{filter:none}.initiative-standalone[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.initiative-standalone[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{border-color:var(--ghs-color-black)}.initiative-standalone[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before{color:var(--ghs-color-black);background-color:var(--ghs-color-black)}.initiative-standalone[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover:before{background-color:var(--ghs-color-darkgray)}.initiative-standalone[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 50 * var(--ghs-dialog-factor));max-width:calc(50vw - var(--ghs-unit) * 4);margin:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.initiative-standalone[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.initiative-standalone[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 32 * var(--ghs-dialog-factor))}.initiative-standalone[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{cursor:pointer;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.initiative-standalone[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]{display:flex;align-items:center}.initiative-standalone[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);font-size:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor))}.initiative-standalone[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white);height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:auto;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.initiative-standalone[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .long-rest-button[_ngcontent-%COMP%]{margin-top:auto}.initiative-standalone[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]   .number-container[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:flex;align-items:center}.initiative-standalone[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]   .number-container[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white);height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:auto;margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.initiative-standalone.vertical[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden}.initiative-standalone.vertical[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%]{flex-direction:column}.initiative-standalone.vertical[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor));max-width:calc(100vw - var(--ghs-unit) * 4)}.initiative-standalone.vertical[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]{flex-direction:column}.initiative-standalone.vertical[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{height:auto}.initiative-standalone.vertical[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{margin-top:initial}.initiative-standalone.vertical[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 10 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 10 * var(--ghs-text-factor));font-size:calc(var(--ghs-unit) * 7 * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 9 * var(--ghs-text-factor))}.initiative-standalone.vertical[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1.5)}.initiative-standalone.modern[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--ghs-color-gray)}.initiative-standalone.fh[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{background-image:url(token.9002cdeea8845c1f.png)}.initiative-standalone.fh[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:brightness(1.3)}",".initiative-dialog[_ngcontent-%COMP%]{position:relative}.initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));width:auto;margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.initiative-dialog[_ngcontent-%COMP%]   .number-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor) * var(--ghs-text-factor)))}.initiative-dialog[_ngcontent-%COMP%]   .number-container[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor) * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.initiative-dialog[_ngcontent-%COMP%]   .number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor) * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor) * var(--ghs-text-factor));cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor) * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline)}.initiative-dialog[_ngcontent-%COMP%]   .number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray);margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button.active[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button.active[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button.active[_ngcontent-%COMP%]:hover{color:var(--ghs-color-darkgray)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button.active[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)}"]})}return a})();const NH=a=>({vertical:a});let zH=(()=>{class a{ghsManager;gameManager=s.E;configuration=!1;constructor(n){this.ghsManager=n}ngOnInit(){var n=this;return(0,I.A)(function*(){try{yield G.n.init()}catch{}yield p.f.init(!1),yield s.E.stateManager.init(!0),n.ghsManager.triggerUiChange(),s.E.game.state!=D.mk.next&&s.E.roundManager.nextGameState(!0),0==s.E.game.lootDeck.cards.length&&(n.configuration=!0)})()}vertical(){return window.innerWidth<800}beforeLootDeck(n){s.E.stateManager.before(n.type,...n.values)}afterLootDeck(n){s.E.game.lootDeck=n.deck,s.E.stateManager.after()}static \u0275fac=function(i){return new(i||a)(t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-loot-deck-standalone"]],standalone:!1,decls:3,vars:9,consts:[["ghs-keyboard-shortcuts","",1,"loot-deck-standalone",3,"ngClass"],[3,"standalone"],[3,"before","after","deck","fullscreen","standalone","vertical","characters"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nrm(1,"ghs-header",1),t.j41(2,"ghs-loot-deck",2),t.bIt("before",function(g){return e.beforeLootDeck(g)})("after",function(g){return e.afterLootDeck(g)}),t.k0s()()),2&i&&(t.Y8G("ngClass",t.eq3(7,NH,e.vertical())),t.R7$(),t.Y8G("standalone",!0),t.R7$(),t.Y8G("deck",e.gameManager.game.lootDeck)("fullscreen",!1)("standalone",!0)("vertical",e.vertical())("characters",!1))},dependencies:[N.YU,Cn,Ha,Hi],styles:[".loot-deck-standalone[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100vw;height:100vh}.loot-deck-standalone[_ngcontent-%COMP%]   ghs-header[_ngcontent-%COMP%]{z-index:2;width:100%}.loot-deck-standalone[_ngcontent-%COMP%]   ghs-loot-deck[_ngcontent-%COMP%]{display:flex;width:99vw;max-width:600px;height:100vw;max-height:420px;z-index:1;margin-top:2em}.loot-deck-standalone.vertical[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden}.loot-deck-standalone.vertical[_ngcontent-%COMP%]   ghs-loot-deck[_ngcontent-%COMP%]{width:98vw;margin-right:1%;height:132vw;max-height:800px;transform:none}"]})}return a})();const LH=(a,r)=>r._trackUUID;function qH(a,r){if(1&a&&(t.j41(0,"option",5),t.nrm(1,"span",3),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n),t.R7$(),t.Y8G("ghs-label","data.edition."+n)}}function HH(a,r){if(1&a&&(t.j41(0,"div",7)(1,"span",8),t.EFF(2),t.k0s(),t.nrm(3,"ghs-treasure-label",9),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(2),t.JRh(n.index),t.R7$(),t.Y8G("treasure",n)("edition",i.edition)}}function KH(a,r){if(1&a&&(t.j41(0,"div",6),t.Z7z(1,HH,4,3,"div",7,LH),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Dyx(t.bMT(3,0,n.treasures))}}const WH=[{path:"editor/edition",component:Xq},{path:"editor/deck",component:bo},{path:"editor/monster",component:rH},{path:"editor/character",component:Gq},{path:"tools/attackmodifier",component:FL},{path:"tools/decks",component:tq},{path:"tools/events",component:hH},{path:"tools/treasures",component:(()=>{class a{route;router;gameManager=s.E;treasures=[];edition;constructor(n,i){this.route=n,this.router=i}ngOnInit(){var n=this;return(0,I.A)(function*(){yield p.f.init(!1),s.E.stateManager.init(!0),n.edition=s.E.editions(!0)[0],n.update(),n.route.queryParams.subscribe({next:i=>{i.edition&&(n.edition=i.edition,n.edition&&s.E.editions(!1).includes(n.edition),n.update())}})})()}update(){this.treasures=[];const n=s.E.editionData.find(i=>i.edition==this.edition);n&&n.treasures&&n.treasures.forEach((i,e)=>{this.treasures.push(new Pt.Ah(i,e+1+(n.treasureOffset||0)))})}updateQueryParams(){this.router.navigate([],{relativeTo:this.route,queryParams:{edition:this.edition||void 0},queryParamsHandling:"merge"})}static \u0275fac=function(i){return new(i||a)(t.rXU(Ht.nX),t.rXU(Ht.Ix))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-treasures-tool"]],standalone:!1,decls:9,vars:4,consts:[[1,"container"],[3,"standalone"],[1,"menu"],[3,"ghs-label"],[3,"ngModelChange","change","ngModel"],[3,"value"],[1,"treasures"],[1,"treasure"],[1,"index"],[1,"placeholder","text-white",3,"treasure","edition"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nrm(1,"ghs-header",1),t.j41(2,"div",2)(3,"label"),t.nrm(4,"span",3),t.j41(5,"select",4),t.mxI("ngModelChange",function(g){return t.DH7(e.edition,g)||(e.edition=g),g}),t.bIt("change",function(){return e.update(),e.updateQueryParams()}),t.Z7z(6,qH,2,2,"option",5,t.fX1),t.k0s()()(),t.nVh(8,KH,4,2,"div",6),t.k0s()),2&i&&(t.R7$(),t.Y8G("standalone",!0),t.R7$(3),t.Y8G("ghs-label","settings.edition"),t.R7$(),t.R50("ngModel",e.edition),t.R7$(),t.Dyx(e.gameManager.editions(!0)),t.R7$(2),t.vxM(e.edition?8:-1))},dependencies:[E.xH,E.y7,E.wz,E.BC,E.vS,it,Cn,Pe,ct],styles:[".container[_ngcontent-%COMP%]{width:100vw;height:100vh;display:flex;flex-direction:column}.container[_ngcontent-%COMP%]   ghs-header[_ngcontent-%COMP%]{z-index:2}.treasures[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;overflow:auto}.treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]{display:flex;margin:10px;padding:10px;background-color:var(--ghs-color-darkgray);color:var(--ghs-color-white);font-size:2em}.treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{margin-right:5px}"]})}return a})()},{path:"tools/random-monster-cards",component:fH},{path:"loot",component:zH},{path:"am",component:yH},{path:"initiative",component:UH},{path:"**",component:SL}];let ZH=(()=>{class a{static \u0275fac=function(i){return new(i||a)};static \u0275mod=t.$C({type:a});static \u0275inj=c.G2t({imports:[q.iI.forRoot(WH,{}),q.iI]})}return a})(),JH=(()=>{class a{meta;dialog;title="gloomhavensecretariat";theme="";locale="";constructor(n,i){this.meta=n,this.dialog=i,this.dialog.afterOpened.subscribe({next:e=>{if(e.overlayRef.backdropElement&&i.openDialogs.length>1&&!e.overlayRef.backdropElement.classList.contains("fullscreen-backdrop")&&(e.overlayRef.backdropElement.style.opacity="0"),!e.disableClose){let o=document.createElement("img");o.src="./assets/images/close_dialog.svg";let g=document.createElement("a");g.classList.add("dialog-close-button"),g.appendChild(o),g.addEventListener("pointerdown",()=>{(0,F.co)(e)}),g.title=p.f.getLabel("close"),e.overlayRef.hostElement&&e.overlayRef.hostElement.appendChild(g),e.overlayRef.backdropElement&&(e.disableClose=!0,e.overlayRef.backdropElement.addEventListener("pointerdown",()=>{(0,F.co)(e)})),e.keydownEvents.subscribe(m=>{p.f.settings.keyboardShortcuts&&!m.ctrlKey&&!m.shiftKey&&!m.altKey&&("Escape"===m.key||(0,F.bb)(m)&&"Backspace"===m.key)&&(0,F.co)(e)})}}})}ngOnInit(){this.applyStyle(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.applyStyle(),this.applyAnimations()}});const n=i=>i.preventDefault();document.addEventListener("gesturestart",n),document.addEventListener("gesturechange",n),document.addEventListener("gestureend",n)}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}applyStyle(){this.theme=p.f.settings.theme,"fh"==this.theme?(document.body.classList.remove("modern"),document.body.classList.remove("bb"),document.body.classList.add("fh"),this.meta.updateTag({name:"theme-color",content:"#a2bbd1"})):"modern"==this.theme?(document.body.classList.remove("fh"),document.body.classList.remove("bb"),document.body.classList.add("modern"),this.meta.updateTag({name:"theme-color",content:"#0e1f1f"})):"bb"==this.theme?(document.body.classList.remove("modern"),document.body.classList.remove("fh"),document.body.classList.add("bb"),this.meta.updateTag({name:"theme-color",content:"#0e1f1f"})):(document.body.classList.remove("fh"),document.body.classList.remove("modern"),document.body.classList.remove("bb"),this.meta.updateTag({name:"theme-color",content:"#936658"})),p.f.settings.portraitMode?document.body.classList.add("portrait-mode"):document.body.classList.remove("portrait-mode"),this.isAppDevMode()||p.f.settings.debugRightClick?document.body.classList.contains("disable-context-menu-touch")&&document.body.classList.remove("disable-context-menu-touch"):document.body.classList.contains("disable-context-menu-touch")||document.body.classList.add("disable-context-menu-touch"),this.locale=p.f.settings.locale;for(let n=document.body.classList.length-1;n>=0;n--){const i=document.body.classList[n];i.startsWith("locale-")&&document.body.classList.remove(i)}document.body.classList.add("locale-"+this.locale)}applyAnimations(){p.f.settings.animations?document.body.classList.remove("no-animations"):document.body.classList.add("no-animations")}isAppDevMode(){return(0,x.naY)()}onRightClick(){return!(!this.isAppDevMode()&&!p.f.settings.debugRightClick)}static \u0275fac=function(i){return new(i||a)(t.rXU(lc.W8),t.rXU(O.lG))};static \u0275cmp=t.VBU({type:a,selectors:[["app-root"]],standalone:!1,decls:2,vars:1,consts:[[1,"container",3,"contextmenu","ngClass"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.bIt("contextmenu",function(){return e.onRightClick()}),t.nrm(1,"router-outlet"),t.k0s()),2&i&&t.Y8G("ngClass",e.theme)},dependencies:[N.YU,Ht.n3],styles:[".container[_ngcontent-%COMP%]{position:relative;width:100vw;max-width:100vw;height:100vh;max-height:100vh;background-image:url(bg.21a3b4d9cc4773f5.jpg);background-size:cover;overflow:auto}.container.fh[_ngcontent-%COMP%]{background-image:url(bg.b402b1d465a94b7a.jpg)}.container.modern[_ngcontent-%COMP%]{background-image:url(bg.cca7e4a6587b5386.jpg)}.container.bb[_ngcontent-%COMP%]{background-image:url(bg.e816b4b333daa495.jpg)}"]})}return a})();const QH=(a,r)=>({edit:a,fh:r}),tK=a=>({enhance:a}),nK=(a,r)=>r+a;function eK(a,r){if(1&a&&t.nrm(0,"img",3),2&a){const n=t.XpG().$implicit,i=t.XpG();t.Y8G("src",i.gameManager.enhancementsManager.fh&&"any"!=n?"./assets/images/fh/character/abilities/enhancements/"+n+".svg":"./assets/images/character/abilities/enhancements/circle.svg",t.B4B)}}function aK(a,r){1&a&&(t.j41(0,"span",5),t.EFF(1,"+1"),t.k0s())}function iK(a,r){1&a&&(t.j41(0,"span",6),t.nrm(1,"img",10),t.k0s())}function oK(a,r){1&a&&(t.j41(0,"span",7),t.nrm(1,"span",11),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","%game.actionIcon.jump%"))}function sK(a,r){if(1&a&&(t.j41(0,"span",8),t.nrm(1,"span",12),t.k0s()),2&a){const n=t.XpG(2).$index,i=t.XpG();t.R7$(),t.Y8G("ghs-label","%game.element."+i.enhancements[null!=i.slotIndex?i.slotIndex:n]+"%")}}function rK(a,r){if(1&a&&(t.j41(0,"span",9),t.nrm(1,"span",12),t.k0s()),2&a){const n=t.XpG(2).$index,i=t.XpG();t.R7$(),t.Y8G("ghs-label","%game.conditionIcon."+i.enhancements[null!=i.slotIndex?i.slotIndex:n]+"%")}}function cK(a,r){if(1&a&&(t.j41(0,"span",4),t.nVh(1,aK,2,0,"span",5),t.nVh(2,iK,2,0,"span",6),t.nVh(3,oK,2,1,"span",7),t.nVh(4,sK,2,1,"span",8),t.nVh(5,rK,2,1,"span",9),t.k0s()),2&a){const n=t.XpG().$index,i=t.XpG();t.R7$(),t.vxM("plus1"==i.enhancements[null!=i.slotIndex?i.slotIndex:n]?1:-1),t.R7$(),t.vxM("hex"==i.enhancements[null!=i.slotIndex?i.slotIndex:n]?2:-1),t.R7$(),t.vxM("jump"==i.enhancements[null!=i.slotIndex?i.slotIndex:n]?3:-1),t.R7$(),t.vxM(i.Elements.includes(i.enhancements[null!=i.slotIndex?i.slotIndex:n])?4:-1),t.R7$(),t.vxM(i.Conditions.includes(i.enhancements[null!=i.slotIndex?i.slotIndex:n])?5:-1)}}function lK(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",2),t.bIt("singleClick",function(e){const o=c.eBV(n).$index,g=t.XpG();return c.Njj(g.enhance(null!=g.slotIndex?g.slotIndex:o,e))})("doubleClick",function(e){const o=c.eBV(n).$index,g=t.XpG();return c.Njj(g.removeEnhancement(g.slotIndex?g.slotIndex:o,e))}),t.nVh(1,eK,1,1,"img",3),t.nVh(2,cK,6,5,"span",4),t.k0s()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG();t.HbH(t.VkB("slot ",n)),t.Y8G("ngClass",t.eq3(7,tK,!e.enhancements[null!=e.slotIndex?e.slotIndex:i]))("ghs-tooltip",e.edit&&"character.abilities.enhancements.hint.enhance"+(e.enhancements[null!=e.slotIndex?e.slotIndex:i]?"d":e.wipSpecialIndex?".wipSpecial":"")||""),t.R7$(),t.vxM(e.enhancements[null!=e.slotIndex?e.slotIndex:i]?-1:1),t.R7$(),t.vxM(e.enhancements[null!=e.slotIndex?e.slotIndex:i]?2:-1)}}let Eo=(()=>{class a{dialog;ghsManager;action;actionIndex="";cardId;character;slotIndex;summon;Elements=Object.values(Tt.Hg);Conditions=Object.values(Q.r5);slots=[];enhancements=[];wipSpecialIndex="";edit=!1;gameManager=s.E;settingsManager=p.f;constructor(n,i){this.dialog=n,this.ghsManager=i}ngOnInit(){this.update(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.slots=[],this.action.enhancementTypes&&(this.slots=null!=this.slotIndex?[this.action.enhancementTypes[this.slotIndex]]:[...this.action.enhancementTypes],this.wipSpecialIndex=this.slots[0]==$t.J.any?this.actionIndex.includes("bottom")?"custom-bottom":"custom":"",this.enhancements=[],this.character&&this.cardId&&this.character.progress&&this.character.progress.enhancements&&this.character.progress.enhancements.filter(n=>n.cardId==this.cardId&&(!this.wipSpecialIndex&&n.actionIndex==this.actionIndex||this.wipSpecialIndex&&n.actionIndex==this.wipSpecialIndex)).forEach(n=>{this.enhancements[n.index]=n.action,this.wipSpecialIndex&&(this.slots[n.index]=$t.J.any)}),this.wipSpecialIndex&&this.enhancements.length>0&&(this.slots[this.enhancements.length]=$t.J.any)),this.edit=this.character&&this.character.tags.includes("edit-abilities")||!1}enhance(n,i){this.edit&&(this.enhancements[null!=this.slotIndex?this.slotIndex:n]||this.dialog.open(Vi,{panelClass:["dialog"],data:{action:this.action,actionIndex:this.wipSpecialIndex||this.actionIndex,cardId:this.cardId,enhancementIndex:n,character:this.character,summon:this.summon}}),i.stopPropagation(),i.preventDefault())}removeEnhancement(n,i){if(this.edit){if(this.character&&this.cardId&&this.enhancements[null!=this.slotIndex?this.slotIndex:n]){const e=this.character.progress.enhancements.find(o=>o.cardId==this.cardId&&(!this.wipSpecialIndex&&o.actionIndex==this.actionIndex||this.wipSpecialIndex&&o.actionIndex==this.wipSpecialIndex)&&o.index==n);e&&!e.inherited&&(s.E.stateManager.before("removeEnhancement",s.E.characterManager.characterName(this.character),this.cardId),this.character.progress.enhancements=this.character.progress.enhancements.filter(o=>o!=e),s.E.stateManager.after())}else this.wipSpecialIndex&&this.slots.push($t.J.any);i.stopPropagation(),i.preventDefault()}}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-action-enhancements"]],inputs:{action:"action",actionIndex:[0,"index","actionIndex"],cardId:"cardId",character:"character",slotIndex:[0,"slot","slotIndex"],summon:"summon"},standalone:!1,decls:3,vars:4,consts:[[1,"enhancements",3,"ngClass"],["ghs-pointer-input","",3,"class","ngClass","ghs-tooltip"],["ghs-pointer-input","",3,"singleClick","doubleClick","ngClass","ghs-tooltip"],[1,"type",3,"src"],[1,"enhancement"],[1,"plus1"],[1,"hex"],[1,"jump"],[1,"element"],[1,"condition"],["src","./assets/images/action/hex/target.svg"],[1,"text-white",3,"ghs-label"],[3,"ghs-label"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.Z7z(1,lK,3,9,"div",1,nK),t.k0s()),2&i&&(t.Y8G("ngClass",t.l_i(1,QH,e.edit,e.settingsManager.settings.fhStyle)),t.R7$(),t.Dyx(e.slots))},dependencies:[N.YU,it,Mt,dt],styles:[".enhancements[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;margin-top:-.1em}.enhancements[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]{position:relative;display:block;width:.7em;height:.7em;margin-left:.3em;margin-right:.1em}.enhancements[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], .enhancements[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;position:absolute;top:0;left:0;height:100%;filter:none;box-shadow:none}.enhancements[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .plus1[_ngcontent-%COMP%], .enhancements[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .jump[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:.7em;display:flex;justify-content:center;align-items:center;width:1.4em;height:1.4em;border:.1em solid var(--ghs-color-white);border-radius:100%;background-color:var(--ghs-color-black)}.enhancements[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .plus1.jump[_ngcontent-%COMP%]   .text-white[_ngcontent-%COMP%], .enhancements[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .jump.jump[_ngcontent-%COMP%]   .text-white[_ngcontent-%COMP%]{font-size:.8em;display:flex;margin-left:-.3em}.enhancements[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .hex[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.enhancements[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .hex[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:1em;height:auto}.enhancements[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{font-size:1em;margin-left:-.5em;filter:brightness(1.1)}.enhancements[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%]{font-size:1.1em;filter:brightness(1.1);margin-top:-.4em;margin-left:-.1em}.enhancements.edit[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]{cursor:initial}.enhancements.edit[_ngcontent-%COMP%]   .slot.enhance[_ngcontent-%COMP%]{cursor:pointer}.enhancements.edit[_ngcontent-%COMP%]   .slot.enhance[_ngcontent-%COMP%]:hover{transform:scale(1.7);transform-origin:center center}.enhancements.edit[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]:hover{transform:scale(1.3);transform-origin:center center}.enhancements.fh[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .plus1[_ngcontent-%COMP%], .enhancements.fh[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .jump[_ngcontent-%COMP%]{font-size:.6em;border-radius:10%;align-items:center}.enhancements.fh[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{font-size:.8em;margin-top:.1em}.enhancements.fh[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%]{font-size:.9em;margin-top:0}"]})}return a})();const gK=()=>["<a href='https://cephalofair.com' target='_blank'>Cephalofair Games</a>"],dK=()=>["<a href='https://github.com/Lurkars/gloomhavensecretariat/blob/main/LICENSE'  target='_blank'> AGPL3</a>"],hK=(a,r)=>[a,r];function _K(a,r){1&a&&(t.j41(0,"span",6),t.nrm(1,"span",13),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","about.version.unknown"))}function mK(a,r){1&a&&(t.j41(0,"span",7),t.nrm(1,"span",13),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","about.version.latest"))}function pK(a,r){if(1&a&&(t.j41(0,"span",8),t.nrm(1,"span",2),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ghs-label","about.version.update")("ghs-label-args",t.l_i(2,hK,n.updateVersion.version,n.updateVersion.url))}}function uK(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",15),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.forceUpdate())}),t.nrm(1,"span",13),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","about.forceUpdate"))}let fK=(()=>{class a{close=new t.bkB;version="0.145.1";updateVersion;ngOnInit(){var n=this;return(0,I.A)(function*(){yield fetch("https://api.github.com/repos/lurkars/gloomhavensecretariat/releases/latest").then(i=>{if(!i.ok)throw Error();return i.json()}).then(i=>{n.updateVersion={latest:i.tag_name==n.version||i.tag_name=="v"+n.version,version:i.tag_name,url:i.html_url}})})()}forceUpdate(){return(0,I.A)(function*(){if("serviceWorker"in navigator){const n=yield navigator.serviceWorker.getRegistrations();yield Promise.all(n.map(i=>i.unregister()))}if("caches"in window){const n=yield caches.keys();yield Promise.all(n.map(function(){var i=(0,I.A)(function*(e){return yield caches.delete(e)});return function(e){return i.apply(this,arguments)}}()))}window.location.reload()})()}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-about-menu"]],outputs:{close:"close"},standalone:!1,decls:23,vars:14,consts:[[1,"menu-container","about"],[1,"line"],[3,"ghs-label","ghs-label-args"],[1,"line","version"],["target","_blank",3,"href"],[1,"version-info"],[1,"unknown"],[1,"latest"],[1,"update"],[1,"force"],[1,"columns"],[1,"column"],["href","https://ko-fi.com/lurkars","target","_blank"],[3,"ghs-label"],["href","https://github.com/Lurkars/gloomhavensecretariat","target","_blank"],[1,"force",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"p",2),t.k0s(),t.j41(3,"div",3)(4,"a",4),t.EFF(5),t.k0s(),t.j41(6,"div",5),t.nVh(7,_K,2,1,"span",6),t.nVh(8,mK,2,1,"span",7),t.nVh(9,pK,2,5,"span",8),t.nVh(10,uK,2,1,"a",9),t.k0s()(),t.j41(11,"div",1)(12,"div",10)(13,"div",11)(14,"p")(15,"a",12),t.nrm(16,"span",13),t.k0s()()(),t.j41(17,"div",11)(18,"p")(19,"a",14),t.nrm(20,"span",13),t.k0s()()(),t.j41(21,"div",11),t.nrm(22,"p",2),t.k0s()()()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","about.ip")("ghs-label-args",t.lJ4(12,gK)),t.R7$(2),t.Y8G("href","https://github.com/Lurkars/gloomhavensecretariat/releases/tag/v"+e.version,t.B4B),t.R7$(),t.SpI("Gloomhaven Secretariat v",e.version),t.R7$(2),t.vxM(e.updateVersion?-1:7),t.R7$(),t.vxM(e.updateVersion&&e.updateVersion.latest?8:-1),t.R7$(),t.vxM(e.updateVersion&&!e.updateVersion.latest?9:-1),t.R7$(),t.vxM(e.updateVersion&&e.updateVersion.latest?-1:10),t.R7$(6),t.Y8G("ghs-label","about.support"),t.R7$(4),t.Y8G("ghs-label","about.sourceCode"),t.R7$(2),t.Y8G("ghs-label","about.license")("ghs-label-args",t.lJ4(13,dK)))},dependencies:[it],styles:['[_nghost-%COMP%]{position:relative;z-index:9999}.hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:break-spaces}.back[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled[_ngcontent-%COMP%]{pointer-events:none}.back.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container[_ngcontent-%COMP%]{z-index:1}.menu-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.no-grow[_ngcontent-%COMP%]{flex-grow:0}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container.inline[_ngcontent-%COMP%]{width:initial;margin-right:1em}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex-wrap:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-gray)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{filter:grayscale(1)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm-delete[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]{align-items:flex-start}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]   .undo-text[_ngcontent-%COMP%]{display:flex;align-items:center}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.redo[_ngcontent-%COMP%]{align-items:flex-end}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]:hover{opacity:.7}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover{cursor:pointer}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog.disabled[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)!important}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]{border-bottom:none;margin-bottom:0}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container[_ngcontent-%COMP%]   .line.sticky.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container[_ngcontent-%COMP%]   .line.sticky.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .add[_ngcontent-%COMP%]{display:inherit}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%] ~ .spoiler[_ngcontent-%COMP%]{margin-top:0;border-top:none}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]{display:flex;cursor:pointer}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]   .span-xs[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns.columns-break[_ngcontent-%COMP%]{flex-wrap:wrap}}',".version-info[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.version-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.version-info[_ngcontent-%COMP%]   span.unknown[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));color:var(--ghs-color-darkgray)}.version-info[_ngcontent-%COMP%]   span.latest[_ngcontent-%COMP%]{color:var(--ghs-color-darkgreen)}.version-info[_ngcontent-%COMP%]   span.update[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.version-info[_ngcontent-%COMP%]   .force[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}"]})}return a})();const Kn=a=>({disabled:a}),yc=(a,r)=>({disabled:a,confirm:r}),xc=(a,r)=>({disabled:a,active:r}),CK=a=>[a],ni=(a,r)=>r._trackUUID;function MK(a,r){1&a&&(t.j41(0,"div",17),t.nrm(1,"div",18),t.k0s())}function vK(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",5)(1,"label",2)(2,"input",3),t.bIt("change",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.setEdition(e))}),t.k0s(),t.nrm(3,"span",4),t.k0s(),t.nVh(4,MK,2,0,"div",17),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(4,Kn,i.gameManager.game.edition==n||i.gameManager.stateManager.permissions&&!i.gameManager.stateManager.permissions.party)),t.R7$(),t.Y8G("checked",i.gameManager.game.edition==n),t.R7$(),t.Y8G("ghs-label","data.edition."+n),t.R7$(),t.vxM("fh"==n&&i.gameManager.game.edition==n?4:-1)}}function OK(a,r){1&a&&(t.j41(0,"div",7)(1,"label"),t.nrm(2,"span",4),t.k0s()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","campaign"))}function PK(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",5)(1,"a",8),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openPartySheet())}),t.k0s()()}2&a&&(t.R7$(),t.Y8G("ghs-label","campaign.party"))}function bK(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",5)(1,"a",8),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openResources())}),t.k0s()()}2&a&&(t.R7$(),t.Y8G("ghs-label","campaign.resources"))}function kK(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",5)(1,"a",8),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openCampaignSheet())}),t.k0s()()}2&a&&(t.R7$(),t.Y8G("ghs-label","campaign.sheet"))}function yK(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",5)(1,"a",8),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openMap())}),t.k0s()()}2&a&&(t.R7$(),t.Y8G("ghs-label","campaign.map"))}function xK(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",5)(1,"a",8),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openItems())}),t.k0s()()}2&a&&(t.R7$(),t.Y8G("ghs-label","campaign.items"))}function EK(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",9)(1,"a",8),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openBattleGoalsSetup())}),t.k0s()()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(2,Kn,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.party)),t.R7$(),t.Y8G("ghs-label","campaign.battleGoals")}}function wK(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",5)(1,"a",8),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.openEventDeckSetup())}),t.k0s()()}2&a&&(t.R7$(),t.Y8G("ghs-label","game.events.deck.setup"))}function RK(a,r){1&a&&(t.j41(0,"div",7)(1,"label"),t.nrm(2,"span",4),t.k0s()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","campaign.character"))}function jK(a,r){if(1&a&&(t.j41(0,"span",21),t.EFF(1,"\xa0 "),t.j41(2,"span"),t.EFF(3,"["),t.k0s(),t.nrm(4,"span",4),t.j41(5,"span"),t.EFF(6,"]"),t.k0s()()),2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.R7$(4),t.Y8G("ghs-label","data.edition."+i.gameManager.getEdition(n))}}function GK(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",5)(1,"a",19),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.openCharacterSheet(e))}),t.nrm(2,"img",20),t.j41(3,"span"),t.EFF(4),t.k0s(),t.nVh(5,jK,7,1,"span",21),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(2),t.Y8G("src",n.iconUrl,t.B4B),t.R7$(2),t.JRh(i.gameManager.characterManager.characterName(n,!0)),t.R7$(),t.vxM(i.gameManager.getEdition(n)?5:-1)}}function TK(a,r){if(1&a&&(t.Z7z(0,GK,6,3,"div",5,ni),t.nI1(2,"trackUUID")),2&a){const n=t.XpG();t.Dyx(t.bMT(2,0,n.characters))}}function SK(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",11)(1,"span",22),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.toggleCondition(e.name))}),t.nrm(2,"img",23),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(8,Kn,i.gameManager.stateManager.permissions&&!i.gameManager.stateManager.permissions.party)),t.R7$(),t.Y8G("ghs-tooltip","game.condition."+n.name+".hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom")("ngClass",t.l_i(10,xc,i.editionConditions.includes(n.name),!i.editionConditions.includes(n.name)&&i.gameManager.game.conditions.includes(n.name))),t.R7$(),t.Y8G("src","./assets/images"+(i.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+n.name+".svg",t.B4B)}}function DK(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",11)(1,"span",22),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.toggleCondition(e.name))}),t.nrm(2,"img",23),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(8,Kn,i.gameManager.stateManager.permissions&&!i.gameManager.stateManager.permissions.party)),t.R7$(),t.Y8G("ghs-tooltip","game.condition."+n.name+".hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom")("ngClass",t.l_i(10,xc,i.editionConditions.includes(n.name),!i.editionConditions.includes(n.name)&&i.gameManager.game.conditions.includes(n.name))),t.R7$(),t.Y8G("src","./assets/images"+(i.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+n.name+".svg",t.B4B)}}function $K(a,r){1&a&&(t.nrm(0,"img",24),t.j41(1,"span",25),t.nrm(2,"span",26),t.k0s()),2&a&&(t.R7$(2),t.Y8G("ghs-label","campaign.campaignManagement.hint"))}function IK(a,r){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const n=t.XpG(2).$implicit;t.R7$(),t.JRh(n.name)}}function AK(a,r){if(1&a&&(t.j41(0,"span"),t.nrm(1,"span",4),t.EFF(2),t.k0s()),2&a){const n=t.XpG(2).$implicit;t.R7$(),t.Y8G("ghs-label","party.campaign"),t.R7$(),t.SpI("\xa0",n.id)}}function VK(a,r){if(1&a){const n=t.RV6();t.j41(0,"label",2)(1,"input",3),t.bIt("change",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.changeParty(e))}),t.k0s(),t.nVh(2,IK,2,1,"span"),t.nVh(3,AK,3,2,"span"),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG();t.Y8G("ngClass",t.eq3(4,Kn,1==i.gameManager.game.parties.length||i.gameManager.game.scenario||i.gameManager.stateManager.permissions&&!i.gameManager.stateManager.permissions.party)),t.R7$(),t.Y8G("checked",i.gameManager.game.party==n),t.R7$(),t.vxM(n.name?2:-1),t.R7$(),t.vxM(n.name?-1:3)}}function FK(a,r){if(1&a){const n=t.RV6();t.j41(0,"label"),t.nrm(1,"input",29),t.j41(2,"input",30),t.bIt("change",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.setName(e))}),t.k0s()()}if(2&a){const n=t.XpG().$implicit;t.R7$(2),t.Y8G("value",n.name)("ghs-label","campaign.campaignManagement.name")("ghs-label-args",t.eq3(4,CK,n.id))("ghs-label-attribute","placeholder")}}function XK(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",5),t.nVh(1,VK,4,6,"label",2),t.nVh(2,FK,3,6,"label"),t.nrm(3,"span",27),t.j41(4,"a",28),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.removeParty(e))})("mouseleave",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.cancelRemoveParty())}),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG();t.R7$(),t.vxM(i.gameManager.game.party!=n?1:-1),t.R7$(),t.vxM(i.gameManager.game.party==n?2:-1),t.R7$(2),t.Y8G("ngClass",t.l_i(3,yc,1==i.gameManager.game.parties.length||i.gameManager.game.scenario,i.confirmPartyDelete==n.id))}}let BK=(()=>{class a{dialog;close=new t.bkB;gameManager=s.E;settingsManager=p.f;GameState=D.mk;conditions=[];amConditions=[];editionConditions=[];characters=[];confirmPartyDelete=-1;confirmResetCampaign=!1;worldMap=!1;constructor(n){this.dialog=n}ngOnInit(){this.update()}update(){this.characters=s.E.game.figures.filter(i=>i instanceof H.K).map(i=>i).sort((i,e)=>{const o=s.E.characterManager.characterName(i).toLowerCase(),g=s.E.characterManager.characterName(e).toLowerCase();return o>g?1:o<g?-1:0}),this.conditions=Object.values(Q.r5).map(i=>new Q.kW(i)).filter(i=>!i.types.includes(Q.GV.hidden)&&!i.types.includes(Q.GV.special)),this.amConditions=Object.values(Q.r5).map(i=>new Q.kW(i)).filter(i=>i.types.includes(Q.GV.amDeck)),this.editionConditions=s.E.conditions(s.E.game.edition,!0).map(i=>i.name),this.worldMap=!1;const n=s.E.editionData.find(i=>i.edition==s.E.game.edition);n&&(n.worldMap||n.extendWorldMap)&&(this.worldMap=!0)}setEdition(n=void 0){s.E.stateManager.before(n?"setEdition":"setEditionAll",n?"data.edition."+n:""),p.f.settings.automaticTheme&&"modern"!=p.f.settings.theme&&(p.f.set("theme","fh"==n||"bb"==n?n:"default"),"gh2e"==n&&p.f.set("fhStyle",!0)),s.E.game.edition=n,s.E.game.party.edition=n,this.update(),s.E.stateManager.after()}toggleCampaignMode(){s.E.stateManager.before(s.E.game.party.campaignMode?"disablePartyCampaignMode":"enablePartyCampaignMode"),s.E.game.party.campaignMode=!s.E.game.party.campaignMode,s.E.stateManager.after()}toggleCondition(n){this.editionConditions.includes(n)||(s.E.stateManager.before(s.E.game.conditions.includes(n)?"removeGameCondition":"addGameCondition",n),s.E.game.conditions.includes(n)?s.E.game.conditions=s.E.game.conditions.filter(i=>n!=i):s.E.game.conditions.push(n),s.E.stateManager.after())}openCharacterSheet(n){this.dialog.open(An,{panelClass:["dialog-invert"],data:{character:n}}),this.close.emit()}openPartySheet(){this.dialog.open(Hn,{panelClass:["dialog-invert"],data:{partySheet:!0}}),this.close.emit()}openCampaignSheet(){this.dialog.open(Hn,{panelClass:["dialog-invert"],data:{campaign:!0}}),this.close.emit()}openMap(){this.dialog.open(aa,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:s.E.game.edition}),this.close.emit()}openFlowChart(){this.dialog.open(ia,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:{edition:s.E.game.edition}}),this.close.emit()}openEnhancementDialog(){this.dialog.open(Vi,{panelClass:["dialog"]}),this.close.emit()}openEventDeckSetup(){this.dialog.open(ao,{panelClass:["dialog"],data:{edition:s.E.game.edition}}),this.close.emit()}openBattleGoalsSetup(){this.dialog.open(Oa,{panelClass:["dialog"]}),this.close.emit()}openItems(){this.dialog.open(Le,{panelClass:["dialog"],data:{edition:s.E.game.edition}}),this.close.emit()}openResources(){this.dialog.open($r,{panelClass:["dialog"]}),this.close.emit()}addParty(){let n=new Ua.r,i=0;for(;s.E.game.parties.some(e=>e.id==i);)i++;n.id=i,s.E.stateManager.before("addParty",n.name||"%party% "+n.id),s.E.game.parties.push(n),s.E.changeParty(n),this.update(),s.E.stateManager.after()}changeParty(n){s.E.stateManager.before("changeParty",n.name||"%party% "+n.id),s.E.changeParty(n),this.update(),s.E.stateManager.after()}removeParty(n){s.E.game.parties.length>1&&(this.confirmPartyDelete!=n.id?this.confirmPartyDelete=n.id:(s.E.stateManager.before("removeParty",n.name||"%party% "+n.id),s.E.game.parties.splice(s.E.game.parties.indexOf(n),1),s.E.game.party.id==n.id&&s.E.changeParty(s.E.game.parties[0]),this.update(),s.E.stateManager.after(),this.cancelRemoveParty()))}cancelRemoveParty(){this.confirmPartyDelete=-1}setName(n){s.E.game.party.name!=n.target.value&&(s.E.stateManager.before("setPartyName",n.target.value),s.E.game.party.name=n.target.value,s.E.stateManager.after())}resetCampaign(){this.confirmResetCampaign?(s.E.stateManager.before("resetCampaign"),s.E.resetCampaign(),s.E.stateManager.after(),this.close.emit()):this.confirmResetCampaign=!0}cancelResetCampaign(){this.confirmResetCampaign=!1}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-campaign-menu"]],outputs:{close:"close"},standalone:!1,decls:55,vars:40,consts:[[1,"menu-container","two-column","sheets"],[1,"line","span"],[3,"ngClass"],["tabclick","","type","checkbox",3,"change","checked"],[3,"ghs-label"],[1,"line"],[1,"line","separator"],[1,"line","title","span"],["tabclick","",3,"click","ghs-label"],[1,"line",3,"ngClass"],[1,"conditions"],[1,"item",3,"ngClass"],[1,"hint-container"],[1,"columns","span"],[1,"column"],["tabclick","",3,"click","ghs-label","ngClass"],["tabclick","",3,"click","mouseleave","ghs-label","ngClass"],[1,"fh-second-edition"],["ghs-setting-menu","fhSecondEdition"],["tabclick","",3,"click"],[1,"icon",3,"src"],[1,"edition"],["tabclick","",1,"condition",3,"click","ghs-tooltip","originX","overlayX","originY","overlayY","ngClass"],[3,"src"],["src","./assets/images/hint.svg",1,"hint-trigger","ghs-svg"],[1,"hint"],[1,"text",3,"ghs-label"],[1,"spacer"],["tabclick","",1,"remove",3,"click","mouseleave","ngClass"],["tabclick","","type","checkbox","checked","true","disabled","disabled"],["type","text",3,"change","value","ghs-label","ghs-label-args","ghs-label-attribute"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"label",2)(3,"input",3),t.bIt("change",function(){return e.setEdition()}),t.k0s(),t.EFF(4," <"),t.nrm(5,"span",4),t.EFF(6,"> "),t.k0s()(),t.Z7z(7,vK,5,6,"div",5,t.fX1),t.j41(9,"div",6)(10,"label",2)(11,"input",3),t.bIt("change",function(){return e.toggleCampaignMode()}),t.k0s(),t.nrm(12,"span",4),t.k0s()(),t.nVh(13,OK,3,1,"div",7),t.nVh(14,PK,2,1,"div",5),t.nVh(15,bK,2,1,"div",5),t.nVh(16,kK,2,1,"div",5),t.nVh(17,yK,2,1,"div",5),t.j41(18,"div",5)(19,"a",8),t.bIt("click",function(){return e.openFlowChart()}),t.k0s()(),t.nVh(20,xK,2,1,"div",5),t.nVh(21,EK,2,4,"div",9),t.nVh(22,wK,2,1,"div",5),t.nVh(23,RK,3,1,"div",7),t.nVh(24,TK,3,2),t.j41(25,"div",1)(26,"a",8),t.bIt("click",function(){return e.openEnhancementDialog()}),t.k0s()(),t.j41(27,"div",7)(28,"label"),t.nrm(29,"span",4),t.k0s()(),t.j41(30,"div",5)(31,"div",10),t.Z7z(32,SK,3,13,"span",11,ni),t.nI1(34,"trackUUID"),t.k0s()(),t.j41(35,"div",5)(36,"div",10),t.Z7z(37,DK,3,13,"span",11,ni),t.nI1(39,"trackUUID"),t.k0s()(),t.j41(40,"div",7)(41,"div",12)(42,"label"),t.nrm(43,"span",4),t.k0s(),t.nVh(44,$K,3,1),t.k0s()(),t.Z7z(45,XK,5,6,"div",5,ni),t.nI1(47,"trackUUID"),t.j41(48,"div",13)(49,"div",14)(50,"div",1)(51,"a",15),t.bIt("click",function(){return e.addParty()}),t.k0s()()(),t.j41(52,"div",14)(53,"div",1)(54,"a",16),t.bIt("click",function(){return e.resetCampaign()})("mouseleave",function(){return e.cancelResetCampaign()}),t.k0s()()()()()),2&i&&(t.R7$(2),t.Y8G("ngClass",t.eq3(31,Kn,!e.gameManager.game.edition||e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.party)),t.R7$(),t.Y8G("checked",!e.gameManager.game.edition),t.R7$(2),t.Y8G("ghs-label","edition.all"),t.R7$(2),t.Dyx(e.gameManager.editions()),t.R7$(3),t.Y8G("ngClass",t.eq3(33,Kn,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.party)),t.R7$(),t.Y8G("checked",e.gameManager.game.party.campaignMode),t.R7$(),t.Y8G("ghs-label","party.campaignMode"),t.R7$(),t.vxM(e.settingsManager.settings.partySheet||e.settingsManager.settings.characterSheet||e.settingsManager.settings.characterItems?13:-1),t.R7$(),t.vxM(e.settingsManager.settings.partySheet&&!e.gameManager.bbRules()?14:-1),t.R7$(),t.vxM(e.settingsManager.settings.partySheet&&e.gameManager.fhRules()?15:-1),t.R7$(),t.vxM(e.settingsManager.settings.partySheet&&!e.gameManager.bbRules()?16:-1),t.R7$(),t.vxM(e.worldMap?17:-1),t.R7$(2),t.Y8G("ghs-label","scenario.chart"),t.R7$(),t.vxM(e.settingsManager.settings.characterSheet||e.settingsManager.settings.characterItems?20:-1),t.R7$(),t.vxM(e.settingsManager.settings.battleGoals&&!e.gameManager.bbRules()?21:-1),t.R7$(),t.vxM(e.settingsManager.settings.partySheet&&e.settingsManager.settings.events&&e.gameManager.game.edition&&!e.gameManager.bbRules()?22:-1),t.R7$(),t.vxM(e.characters.length>0&&e.settingsManager.settings.characterSheet&&!e.gameManager.bbRules()?23:-1),t.R7$(),t.vxM(e.settingsManager.settings.characterSheet&&!e.gameManager.bbRules()?24:-1),t.R7$(2),t.Y8G("ghs-label","campaign.enhancements"),t.R7$(3),t.Y8G("ghs-label","edition.conditions"),t.R7$(3),t.Dyx(t.bMT(34,25,e.conditions)),t.R7$(5),t.Dyx(t.bMT(39,27,e.amConditions)),t.R7$(6),t.Y8G("ghs-label","campaign.campaignManagement"),t.R7$(),t.vxM(e.gameManager.game.scenario?44:-1),t.R7$(),t.Dyx(t.bMT(47,29,e.gameManager.game.parties)),t.R7$(6),t.Y8G("ghs-label","campaign.campaignManagement.add")("ngClass",t.eq3(35,Kn,e.gameManager.game.scenario||e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.party)),t.R7$(3),t.Y8G("ghs-label","campaign.campaignManagement.reset")("ngClass",t.l_i(37,yc,e.gameManager.game.scenario||e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.party,e.confirmResetCampaign)))},dependencies:[N.YU,it,Mt,fe,Ft,ct],styles:['[_nghost-%COMP%]{position:relative;z-index:9999}.hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:break-spaces}.back[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled[_ngcontent-%COMP%]{pointer-events:none}.back.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container[_ngcontent-%COMP%]{z-index:1}.menu-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.no-grow[_ngcontent-%COMP%]{flex-grow:0}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container.inline[_ngcontent-%COMP%]{width:initial;margin-right:1em}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex-wrap:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-gray)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{filter:grayscale(1)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm-delete[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]{align-items:flex-start}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]   .undo-text[_ngcontent-%COMP%]{display:flex;align-items:center}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.redo[_ngcontent-%COMP%]{align-items:flex-end}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]:hover{opacity:.7}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover{cursor:pointer}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog.disabled[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)!important}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]{border-bottom:none;margin-bottom:0}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container[_ngcontent-%COMP%]   .line.sticky.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container[_ngcontent-%COMP%]   .line.sticky.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .add[_ngcontent-%COMP%]{display:inherit}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%] ~ .spoiler[_ngcontent-%COMP%]{margin-top:0;border-top:none}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]{display:flex;cursor:pointer}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]   .span-xs[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns.columns-break[_ngcontent-%COMP%]{flex-wrap:wrap}}','.conditions[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(6,calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor)));column-gap:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));row-gap:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));align-items:center;justify-items:center;margin-bottom:auto}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{cursor:initial;position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor))}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{cursor:pointer;display:flex;position:relative;width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor))}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:after{pointer-events:none;content:" ";height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:auto}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);position:absolute;bottom:0;left:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));transform:translate(-50%)}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value.stack[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));bottom:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor))}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition.disabled[_ngcontent-%COMP%]:after{border:calc(var(--ghs-unit) / 4) var(--ghs-color-darkgray) solid;border-radius:100%}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition.active[_ngcontent-%COMP%]:after{border:calc(var(--ghs-unit) / 5) var(--ghs-color-green) solid;border-radius:100%}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:hover:after{border:calc(var(--ghs-unit) / 5) var(--ghs-color-green) solid;border-radius:100%}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition.active[_ngcontent-%COMP%]:hover:after{border:calc(var(--ghs-unit) / 5) var(--ghs-color-red) solid}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition.disabled[_ngcontent-%COMP%]{pointer-events:initial;cursor:initial}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition.disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{opacity:.7}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition.disabled[_ngcontent-%COMP%]:hover:after{border:calc(var(--ghs-unit) / 4) var(--ghs-color-darkgray) solid}.remove[_ngcontent-%COMP%]{cursor:pointer!important;display:flex;width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.remove[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 80%,30% 50%,0 20%,20% 0,50% 30%,80% 0,100% 20%,70% 50%,100% 80%,80% 100%,50% 70%,20% 100%);background-color:var(--ghs-color-gray)}.remove[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.remove.confirm[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-red)}.remove.disabled[_ngcontent-%COMP%]{pointer-events:none}.remove.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-darkgray)!important}.fh-second-edition[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:1 span}.conditions[_ngcontent-%COMP%]{grid-template-columns:repeat(4,calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor)))}}']})}return a})();const YK=(a,r)=>({fh:a,modern:r}),Ec=()=>[],UK=a=>({active:a}),NK=(a,r,n)=>({"hide-title":a,fh:r,modern:n}),wc=a=>({confirm:a}),zK=(a,r)=>({disabled:a,spoiler:r}),LK=(a,r)=>r._trackUUID;function qK(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",4)(1,"a",8),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.characterLevel=e+1)}),t.EFF(2),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(2,UK,n+1==i.characterLevel)),t.R7$(),t.JRh(n+1)}}function HK(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",9),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return e.allEditions=!e.allEditions,c.Njj(e.update())}),t.k0s(),t.nrm(2,"span",10),t.k0s()}if(2&a){const n=t.XpG(2);t.R7$(),t.Y8G("checked",n.allEditions),t.R7$(),t.Y8G("ghs-label","character.filter.allEditions")}}function KK(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",1)(1,"span",4),t.nrm(2,"img",5),t.k0s(),t.Z7z(3,qK,3,4,"span",4,t.fX1),t.nI1(5,"ghsRange"),t.j41(6,"div",6)(7,"input",7),t.mxI("ngModelChange",function(e){c.eBV(n);const o=t.XpG();return t.DH7(o.filter,e)||(o.filter=e),c.Njj(e)}),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.update())})("keyup",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.update())}),t.k0s(),t.nVh(8,HK,3,2,"label"),t.k0s()()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.l_i(8,YK,"fh"==n.settingsManager.settings.theme,"modern"==n.settingsManager.settings.theme)),t.R7$(3),t.Dyx(t.i5U(5,5,t.lJ4(11,Ec),9)),t.R7$(4),t.R50("ngModel",n.filter),t.Y8G("ghs-label","character.filter")("ghs-label-attribute","placeholder"),t.R7$(),t.vxM(n.gameManager.game.edition?8:-1)}}function WK(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",13)(1,"a",15),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2).$implicit,o=t.XpG();return c.Njj(o.unlockAll(e))})("mouseleave",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.cancelConfirm())}),t.nrm(2,"span",10),t.k0s()()}if(2&a){const n=t.XpG(2).$implicit,i=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(2,wc,i.confirm=="confirm-all-"+n)),t.R7$(),t.Y8G("ghs-label",i.confirm=="confirm-all-"+n?"character.unlockAll.confirm":"character.unlockAll")}}function ZK(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",18),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(3);return c.Njj(o.addCharacter(e))}),t.nrm(1,"img",19)(2,"span",10),t.k0s()}if(2&a){const n=t.XpG().$implicit;t.R7$(),t.Y8G("src",n.iconUrl,t.B4B),t.R7$(),t.Y8G("ghs-label","data.character."+n.edition+"."+n.name)}}function JK(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",20),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(3);return c.Njj(o.unlock(e))})("mouseleave",function(){c.eBV(n);const e=t.XpG(4);return c.Njj(e.cancelConfirm())}),t.nrm(1,"img",21),t.j41(2,"span",22),t.nrm(3,"span",10),t.k0s(),t.nrm(4,"span",23),t.k0s()}if(2&a){const n=t.XpG().$implicit,i=t.XpG(3);t.Y8G("ngClass",t.eq3(4,wc,i.confirm==n.name)),t.R7$(),t.Y8G("src",n.iconUrl,t.B4B),t.R7$(2),t.Y8G("ghs-label","spoiler.placeholder"),t.R7$(),t.Y8G("ghs-label",i.confirm==n.name?"character.unlock.confirm":"character.unlock")}}function QK(a,r){if(1&a&&(t.j41(0,"div",14),t.nVh(1,ZK,3,2,"a",16),t.nVh(2,JK,5,6,"a",17),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(3);t.Y8G("ngClass",t.l_i(3,zK,i.hasCharacter(n)&&i.unlocked(n),n.spoiler)),t.R7$(),t.vxM(i.unlocked(n)?1:-1),t.R7$(),t.vxM(i.unlocked(n)?-1:2)}}function tW(a,r){if(1&a&&(t.j41(0,"div",11)(1,"div",12)(2,"label"),t.nrm(3,"span",10),t.k0s()(),t.nVh(4,WK,3,4,"div",13),t.Z7z(5,QK,3,6,"div",14,LK),t.nI1(7,"trackUUID"),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(),t.Y8G("ngClass",t.sMw(5,NK,!i.allEditions&&1==i.gameManager.currentEditions().length,"fh"==i.settingsManager.settings.theme,"modern"==i.settingsManager.settings.theme)),t.R7$(2),t.Y8G("ghs-label","data.edition."+n),t.R7$(),t.vxM(i.locked(n)?4:-1),t.R7$(),t.Dyx(t.bMT(7,3,i.characterData[n]||t.lJ4(9,Ec)))}}function nW(a,r){if(1&a&&t.nVh(0,tW,8,10,"div",11),2&a){const n=r.$implicit,i=t.XpG();t.vxM(i.characterData[n]&&i.characterData[n].length>0?0:-1)}}function eW(a,r){1&a&&(t.j41(0,"div",3)(1,"div",24)(2,"label"),t.nrm(3,"span",10),t.k0s()()()),2&a&&(t.R7$(3),t.Y8G("ghs-label","character.filter.noResult"))}let aW=(()=>{class a{close=new t.bkB;gameManager=s.E;settingsManager=p.f;characterLevel=1;filter="";allEditions=!1;newUnlocks=[];confirm="";characterData={};ngOnInit(){this.characterLevel=s.E.fhRules(!0)?Math.ceil(s.E.prosperityLevel()/2):s.E.prosperityLevel(),this.update()}update(){this.characterData={},(this.allEditions?s.E.editions(!0,!0):s.E.currentEditions(!0)).forEach(n=>{this.characterData[n]=this.getCharacterData(this.filter,n)})}getCharacterData(n,i){return s.E.charactersData(i).filter(e=>(!e.locked||this.unlocked(e))&&((0,F.oB)(e.name,n)||this.unlocked(e)&&(0,F.oB)(p.f.getLabel("data.character."+e.edition+"."+e.name),n))||e.locked&&(0,F.oB)(p.f.getLabel("data.character."+e.edition+"."+e.name),n,!0)).sort((e,o)=>{const g=p.f.getLabel("data.character."+e.edition+"."+e.name).toLowerCase(),m=p.f.getLabel("data.character."+o.edition+"."+o.name).toLowerCase();if(e.spoiler&&!o.spoiler)return 1;if(!e.spoiler&&o.spoiler)return-1;if(e.spoiler&&o.spoiler){if(!this.unlocked(e)&&this.unlocked(o)&&!this.newUnlocks.includes(o.name))return 1;if(this.unlocked(e)&&!this.newUnlocks.includes(e.name)&&!this.unlocked(o))return-1;if(this.unlocked(e)&&this.newUnlocks.includes(e.name)&&this.unlocked(o)&&!this.newUnlocks.includes(o.name))return 1;if(this.unlocked(e)&&!this.newUnlocks.includes(e.name)&&this.unlocked(o)&&this.newUnlocks.includes(e.name))return-1;if(!this.unlocked(e)&&!this.unlocked(o))return o.name>e.name?-1:1}return m>g?-1:1})}unlocked(n){return!n.spoiler||s.E.game.unlockedCharacters.includes(n.edition+":"+n.name)}locked(n){return this.characterData[n]&&this.characterData[n].some(i=>i.spoiler&&!this.unlocked(i))}unlock(n){s.E.game.unlockedCharacters.includes(n.edition+":"+n.name)||(this.confirm==n.name?(s.E.stateManager.before("unlockChar","data.character."+n.edition+"."+n.name),s.E.game.unlockedCharacters.push(n.edition+":"+n.name),this.newUnlocks.push(n.name),p.f.settings.events&&n.unlockEvent&&n.unlockEvent.split("|").forEach(i=>{i.split(":").length>1?s.E.eventCardManager.addEvent(i.split(":")[0],i.split(":")[1],!0):(s.E.eventCardManager.addEvent("city",i,!0),s.E.eventCardManager.addEvent("road",i,!0))}),s.E.stateManager.after()):this.confirm=n.name)}cancelConfirm(){this.confirm=""}unlockAll(n){const i=s.E.charactersData(n).filter(e=>e.spoiler&&!this.unlocked(e)).map(e=>e.name);i.length>0&&(this.confirm=="confirm-all-"+n?(s.E.stateManager.before("unlockAllCharacters","data.edition."+n),s.E.game.unlockedCharacters.push(...i.map(e=>n+":"+e)),p.f.settings.events&&i.map(e=>s.E.getCharacterData(e,n)).forEach(e=>{e.unlockEvent&&e.unlockEvent.split("|").forEach(o=>{o.split(":").length>1?s.E.eventCardManager.addEvent(o.split(":")[0],o.split(":")[1],!0):(s.E.eventCardManager.addEvent("city",o,!0),s.E.eventCardManager.addEvent("road",o,!0))})}),s.E.stateManager.after()):this.confirm="confirm-all-"+n)}noResults(){return(this.allEditions?s.E.editions(!0,!0):s.E.currentEditions(!0)).every(i=>!this.characterData[i]||0==this.characterData[i].length)}addCharacter(n){s.E.stateManager.before("addChar","data.character."+n.edition+"."+n.name),s.E.characterManager.addCharacter(n,this.characterLevel),s.E.stateManager.after(),s.E.bbRules()&&this.close.emit()}hasCharacter(n){return s.E.game.figures.some(i=>i instanceof H.K&&n.name==i.name&&n.edition==i.edition)||s.E.game.party.availableCharacters&&s.E.game.party.availableCharacters.some(i=>n.name==i.name&&n.edition==i.edition)}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-character-menu"]],outputs:{close:"close"},standalone:!1,decls:6,vars:2,consts:[[1,"menu-container","character-add"],[1,"level-container",3,"ngClass"],[1,"columns"],[1,"column"],[1,"item"],["src","./assets/images/status/level.svg"],[1,"line","search"],["type","text",3,"ngModelChange","change","keyup","ngModel","ghs-label","ghs-label-attribute"],["tabclick","",1,"level",3,"click","ngClass"],["tabclick","","type","checkbox",3,"change","checked"],[3,"ghs-label"],[1,"column","spoilers"],[1,"line","title","sticky",3,"ngClass"],[1,"line","separator","reveal-all"],[1,"line",3,"ngClass"],[3,"click","mouseleave","ngClass"],["tabclick",""],["tabclick","",3,"ngClass"],["tabclick","",3,"click"],[1,"icon",3,"src"],["tabclick","",3,"click","mouseleave","ngClass"],[1,"icon","spoiler",3,"src"],[1,"name"],[1,"add",3,"ghs-label"],[1,"line"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.nVh(1,KK,9,12,"div",1),t.j41(2,"div",2),t.Z7z(3,nW,1,1,null,null,t.fX1),t.nVh(5,eW,4,1,"div",3),t.k0s()()),2&i&&(t.R7$(),t.vxM(e.gameManager.bbRules()?-1:1),t.R7$(2),t.Dyx(e.allEditions?e.gameManager.editions(!0,!0):e.gameManager.currentEditions(!0)),t.R7$(2),t.vxM(e.filter&&e.noResults()?5:-1))},dependencies:[N.YU,E.me,E.BC,E.vS,it,Ft,At,ct],styles:['[_nghost-%COMP%]{position:relative;z-index:9999}.hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:break-spaces}.back[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled[_ngcontent-%COMP%]{pointer-events:none}.back.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container[_ngcontent-%COMP%]{z-index:1}.menu-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.no-grow[_ngcontent-%COMP%]{flex-grow:0}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container.inline[_ngcontent-%COMP%]{width:initial;margin-right:1em}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex-wrap:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-gray)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{filter:grayscale(1)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm-delete[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]{align-items:flex-start}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]   .undo-text[_ngcontent-%COMP%]{display:flex;align-items:center}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.redo[_ngcontent-%COMP%]{align-items:flex-end}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]:hover{opacity:.7}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover{cursor:pointer}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog.disabled[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)!important}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]{border-bottom:none;margin-bottom:0}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container[_ngcontent-%COMP%]   .line.sticky.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container[_ngcontent-%COMP%]   .line.sticky.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .add[_ngcontent-%COMP%]{display:inherit}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%] ~ .spoiler[_ngcontent-%COMP%]{margin-top:0;border-top:none}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]{display:flex;cursor:pointer}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]   .span-xs[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns.columns-break[_ngcontent-%COMP%]{flex-wrap:wrap}}',".character-add[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 45 * var(--ghs-dialog-factor))}.level-container[_ngcontent-%COMP%]{position:fixed;top:0;display:grid;grid-template-columns:repeat(5,calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor)));margin:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:2}.level-container.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.level-container.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.level-container[_ngcontent-%COMP%]   span.item[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.level-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:auto}.level-container[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.level-container[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.level-container[_ngcontent-%COMP%]   .level.active[_ngcontent-%COMP%]{pointer-events:none;border:calc(var(--ghs-unit) / 4) var(--ghs-color-white) solid;border-radius:100%}.level-container[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{grid-column:5 span}.level-container[_ngcontent-%COMP%] + .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%], .level-container[_ngcontent-%COMP%] + .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]:not(sticky):first-child{padding-top:calc(var(--ghs-unit) * 20.5 * var(--ghs-dialog-factor))}.reveal-all[_ngcontent-%COMP%]{position:absolute;bottom:0;border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)!important;width:auto!important}.spoilers[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]:nth-child(2), .spoilers[_ngcontent-%COMP%]   .reveal-all[_ngcontent-%COMP%] + .line[_ngcontent-%COMP%]{border-top:none!important}.spoilers[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]:last-child{margin-bottom:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor))}"]})}return a})();var Rc=v(706);const wo=(a,r)=>({fh:a,modern:r}),ei=a=>({disabled:a}),da=a=>({"confirm-delete":a}),ha=a=>({hidden:a}),iW=a=>[a],oW=(a,r)=>r._trackUUID;function sW(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",16)(1,"div",26)(2,"label",33),t.nrm(3,"span",15),t.j41(4,"input",34,1),t.bIt("keyup",function(){return c.eBV(n),c.Njj(0)})("change",function(){c.eBV(n);const e=t.sdS(5),o=t.XpG(2);return c.Njj(o.settingsManager.set("autoBackup",+e.value))}),t.k0s()(),t.nrm(6,"img",29),t.j41(7,"div",30)(8,"div",35),t.nrm(9,"div",15),t.k0s()()()(),t.j41(10,"div",16)(11,"label")(12,"input",32),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.settingsManager.setAutoBackupFinish(!e.settingsManager.settings.autoBackupFinish))}),t.k0s(),t.nrm(13,"span",15),t.k0s()(),t.j41(14,"div",16)(15,"div",36)(16,"label",33),t.nrm(17,"span",15),t.k0s(),t.j41(18,"input",37,2),t.bIt("keyup",function(){return c.eBV(n),c.Njj(0)})("change",function(){c.eBV(n);const e=t.sdS(19),o=t.sdS(29),g=t.sdS(44),m=t.sdS(55),k=t.sdS(65),X=t.sdS(75),at=t.XpG(2);return c.Njj(at.settingsManager.setAutoBackupUrl({url:e.value,method:o.value,fileUpload:g.checked,username:k.value,password:X.value,authorization:m.value}))}),t.k0s(),t.nrm(20,"img",29),t.j41(21,"div",30)(22,"div",35),t.nrm(23,"div",15),t.k0s()()()(),t.j41(24,"div",38)(25,"div",36)(26,"label",33),t.nrm(27,"span",15),t.k0s(),t.j41(28,"select",39,3),t.bIt("change",function(){c.eBV(n);const e=t.sdS(19),o=t.sdS(29),g=t.sdS(44),m=t.sdS(55),k=t.sdS(65),X=t.sdS(75),at=t.XpG(2);return c.Njj(at.settingsManager.setAutoBackupUrl({url:e.value,method:o.value,fileUpload:g.checked,username:k.value,password:X.value,authorization:m.value}))}),t.j41(30,"option",40),t.nrm(31,"span",15),t.k0s(),t.j41(32,"option",41),t.nrm(33,"span",15),t.k0s(),t.j41(34,"option",42),t.nrm(35,"span",15),t.k0s()(),t.nrm(36,"img",29),t.j41(37,"div",30)(38,"div",35),t.nrm(39,"div",15),t.k0s()()()(),t.j41(40,"div",38)(41,"div",36)(42,"label",33)(43,"input",32,4),t.bIt("change",function(){c.eBV(n);const e=t.sdS(19),o=t.sdS(29),g=t.sdS(44),m=t.sdS(55),k=t.sdS(65),X=t.sdS(75),at=t.XpG(2);return c.Njj(at.settingsManager.setAutoBackupUrl({url:e.value,method:o.value,fileUpload:g.checked,username:k.value,password:X.value,authorization:m.value}))}),t.k0s(),t.nrm(45,"span",15),t.k0s(),t.nrm(46,"img",29),t.j41(47,"div",30)(48,"div",35),t.nrm(49,"div",15),t.k0s()()()(),t.j41(50,"div",38)(51,"div",36)(52,"label",33),t.nrm(53,"span",15),t.k0s(),t.j41(54,"input",37,5),t.bIt("keyup",function(){return c.eBV(n),c.Njj(0)})("change",function(){c.eBV(n);const e=t.sdS(19),o=t.sdS(29),g=t.sdS(44),m=t.sdS(55),k=t.sdS(65),X=t.sdS(75),at=t.XpG(2);return c.Njj(at.settingsManager.setAutoBackupUrl({url:e.value,method:o.value,fileUpload:g.checked,username:k.value,password:X.value,authorization:m.value}))}),t.k0s(),t.nrm(56,"img",29),t.j41(57,"div",30)(58,"div",35),t.nrm(59,"div",15),t.k0s()()()(),t.j41(60,"div",38)(61,"div",36)(62,"label",33),t.nrm(63,"span",15),t.k0s(),t.j41(64,"input",37,6),t.bIt("keyup",function(){return c.eBV(n),c.Njj(0)})("change",function(){c.eBV(n);const e=t.sdS(19),o=t.sdS(29),g=t.sdS(44),m=t.sdS(55),k=t.sdS(65),X=t.sdS(75),at=t.XpG(2);return c.Njj(at.settingsManager.setAutoBackupUrl({url:e.value,method:o.value,fileUpload:g.checked,username:k.value,password:X.value,authorization:m.value}))}),t.k0s(),t.nrm(66,"img",29),t.j41(67,"div",30)(68,"div",35),t.nrm(69,"div",15),t.k0s()()()(),t.j41(70,"div",38)(71,"div",36)(72,"label",33),t.nrm(73,"span",15),t.k0s(),t.j41(74,"input",37,7),t.bIt("keyup",function(){return c.eBV(n),c.Njj(0)})("change",function(){c.eBV(n);const e=t.sdS(19),o=t.sdS(29),g=t.sdS(44),m=t.sdS(55),k=t.sdS(65),X=t.sdS(75),at=t.XpG(2);return c.Njj(at.settingsManager.setAutoBackupUrl({url:e.value,method:o.value,fileUpload:g.checked,username:k.value,password:X.value,authorization:m.value}))}),t.k0s(),t.nrm(76,"img",29),t.j41(77,"div",30)(78,"div",35),t.nrm(79,"div",15),t.k0s()()()()}if(2&a){const n=t.sdS(5),i=t.sdS(19),e=t.XpG(2);t.R7$(3),t.Y8G("ghs-label","datamanagement.backup.auto.count"),t.R7$(),t.Y8G("value",e.settingsManager.settings.autoBackup)("size",n.value.length)("ghs-label","datamanagement.backup.auto.count")("ghs-label-attribute","placeholder"),t.R7$(5),t.Y8G("ghs-label","datamanagement.backup.auto.countHint"),t.R7$(3),t.Y8G("checked",e.settingsManager.settings.autoBackupFinish),t.R7$(),t.Y8G("ghs-label","datamanagement.backup.auto.onFinish"),t.R7$(4),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrl"),t.R7$(),t.Y8G("value",null==e.settingsManager.settings.autoBackupUrl?null:e.settingsManager.settings.autoBackupUrl.url)("ghs-label","datamanagement.backup.auto.uploadUrl")("ghs-label-attribute","placeholder"),t.R7$(5),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrl.hint"),t.R7$(),t.Y8G("ngClass",t.eq3(42,ha,!i.value)),t.R7$(3),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlMethod"),t.R7$(),t.Y8G("value",null==e.settingsManager.settings.autoBackupUrl?null:e.settingsManager.settings.autoBackupUrl.method),t.R7$(3),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlMethod.post"),t.R7$(2),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlMethod.put"),t.R7$(2),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlMethod.get"),t.R7$(4),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlMethod.hint"),t.R7$(),t.Y8G("ngClass",t.eq3(44,ha,!i.value)),t.R7$(3),t.Y8G("checked",null==e.settingsManager.settings.autoBackupUrl?null:e.settingsManager.settings.autoBackupUrl.fileUpload),t.R7$(2),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlFileUpload"),t.R7$(4),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlFileUpload.hint"),t.R7$(),t.Y8G("ngClass",t.eq3(46,ha,!i.value)),t.R7$(3),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlAuthorization"),t.R7$(),t.Y8G("value",null==e.settingsManager.settings.autoBackupUrl?null:e.settingsManager.settings.autoBackupUrl.authorization)("ghs-label","datamanagement.backup.auto.uploadUrlAuthorization")("ghs-label-attribute","placeholder"),t.R7$(5),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlAuthorization.hint"),t.R7$(),t.Y8G("ngClass",t.eq3(48,ha,!i.value)),t.R7$(3),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlUsername"),t.R7$(),t.Y8G("value",null==e.settingsManager.settings.autoBackupUrl?null:e.settingsManager.settings.autoBackupUrl.username)("ghs-label","datamanagement.backup.auto.uploadUrlUsername")("ghs-label-attribute","placeholder"),t.R7$(5),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlUsername.hint"),t.R7$(),t.Y8G("ngClass",t.eq3(50,ha,!i.value)),t.R7$(3),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlPassword"),t.R7$(),t.Y8G("value",null==e.settingsManager.settings.autoBackupUrl?null:e.settingsManager.settings.autoBackupUrl.password)("ghs-label","datamanagement.backup.auto.uploadUrlPassword")("ghs-label-attribute","placeholder"),t.R7$(5),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlPassword.hint")}}function rW(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",11)(1,"div",13)(2,"div",16)(3,"a",24),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.exportGame())}),t.nrm(4,"span",15),t.k0s()(),t.j41(5,"div",16)(6,"a",25),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.resetGame())})("mouseleave",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.cancelConfirm())}),t.EFF(7,"<"),t.nrm(8,"span",15),t.EFF(9,"(!)>"),t.k0s()(),t.j41(10,"div",16)(11,"div",26)(12,"label",27),t.bIt("click",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.importFileCheck(e))})("mouseleave",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.cancelConfirm())}),t.j41(13,"input",28),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.importFile(e))}),t.k0s(),t.EFF(14," <"),t.nrm(15,"span",15),t.EFF(16,"(!)> "),t.k0s(),t.nrm(17,"img",29),t.j41(18,"span",30),t.nrm(19,"span",31),t.k0s()()()(),t.j41(20,"div",13)(21,"div",16)(22,"a",24),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.exportSettings())}),t.nrm(23,"span",15),t.k0s()(),t.j41(24,"div",16)(25,"a",25),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.resetSettings())})("mouseleave",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.cancelConfirm())}),t.EFF(26,"<"),t.nrm(27,"span",15),t.EFF(28,"(!)>"),t.k0s()()(),t.j41(29,"div",13)(30,"div",16)(31,"a",24),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.exportDataDump())}),t.nrm(32,"span",15),t.k0s()(),t.j41(33,"div",16)(34,"a",25),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.clearAllData())})("mouseleave",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.cancelConfirm())}),t.EFF(35,"<"),t.nrm(36,"span",15),t.EFF(37,"(!)>"),t.k0s()(),t.j41(38,"div",16)(39,"label")(40,"input",32),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.settingsManager.settings.autoBackup=-1==e.settingsManager.settings.autoBackup?25:-1)}),t.k0s(),t.nrm(41,"span",15),t.k0s()(),t.nVh(42,sW,80,52),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(4),t.Y8G("ghs-label","datamanagement.exportGame"),t.R7$(2),t.Y8G("ngClass",t.eq3(17,da,"resetGame"==n.confirm)),t.R7$(2),t.Y8G("ghs-label","datamanagement.resetGame"),t.R7$(4),t.Y8G("ngClass",t.eq3(19,da,"importFile"==n.confirm)),t.R7$(),t.Y8G("ngClass",t.eq3(21,ei,"importFile"!=n.confirm))("disabled","importFile"!=n.confirm),t.R7$(2),t.Y8G("ghs-label","datamanagement.importFile"),t.R7$(4),t.Y8G("ghs-label","datamanagement.importFile.hint"),t.R7$(4),t.Y8G("ghs-label","datamanagement.exportSettings"),t.R7$(2),t.Y8G("ngClass",t.eq3(23,da,"resetSettings"==n.confirm)),t.R7$(2),t.Y8G("ghs-label","datamanagement.resetSettings"),t.R7$(5),t.Y8G("ghs-label","datamanagement.exportDataDump"),t.R7$(2),t.Y8G("ngClass",t.eq3(25,da,"clearAllData"==n.confirm)),t.R7$(2),t.Y8G("ghs-label","datamanagement.clearAll"),t.R7$(4),t.Y8G("checked",-1!=n.settingsManager.settings.autoBackup),t.R7$(),t.Y8G("ghs-label","datamanagement.backup.auto"),t.R7$(),t.vxM(-1!=n.settingsManager.settings.autoBackup?42:-1)}}function cW(a,r){1&a&&t.nrm(0,"div",12)}function lW(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",44),t.EFF(1),t.nrm(2,"span",22),t.j41(3,"span",45),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.removeUnlock(e))}),t.k0s()()}if(2&a){const n=r.$implicit;t.R7$(),t.SpI(" ",n," "),t.R7$(2),t.Y8G("ghs-label","datamanagement.removeUnlock")("ghs-label-attribute","title")}}function gW(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",23)(1,"a",24),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.removeAllUnlocks())}),t.nrm(2,"span",15),t.k0s()()}2&a&&(t.R7$(2),t.Y8G("ghs-label","datamanagement.removeAllUnlocks"))}function dW(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",44),t.EFF(1),t.nrm(2,"span",22),t.j41(3,"span",45),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.removeSpoiler(e))}),t.k0s()()}if(2&a){const n=r.$implicit;t.R7$(),t.SpI(" ",n," "),t.R7$(2),t.Y8G("ghs-label","datamanagement.removeSpoiler")("ghs-label-attribute","title")}}function hW(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",23)(1,"a",24),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.settingsManager.removeAllSpoilers())}),t.nrm(2,"span",15),t.k0s()()}2&a&&(t.R7$(2),t.Y8G("ghs-label","datamanagement.removeAllSpoilers"))}function _W(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",13)(1,"div",14)(2,"label"),t.nrm(3,"span",15),t.k0s()(),t.j41(4,"div",16)(5,"span",17)(6,"input",18,8),t.bIt("keyup.enter",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.addUnlock(e.target))})("keyup",function(){c.eBV(n);const e=t.sdS(7);return c.Njj(e.classList.remove("error"))}),t.k0s(),t.j41(8,"span",19),t.bIt("click",function(){c.eBV(n);const e=t.sdS(7),o=t.XpG();return c.Njj(o.addUnlock(e))}),t.k0s()()(),t.j41(9,"div",43),t.Z7z(10,lW,4,3,"a",44,t.fX1),t.k0s(),t.nrm(12,"div",22),t.nVh(13,gW,3,1,"div",23),t.j41(14,"div",14)(15,"label"),t.nrm(16,"span",15),t.k0s()(),t.j41(17,"div",16)(18,"span",17)(19,"input",18,9),t.bIt("keyup.enter",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.addSpoiler(e.target))})("keyup",function(){return c.eBV(n),c.Njj(0)}),t.k0s(),t.j41(21,"span",19),t.bIt("click",function(){c.eBV(n);const e=t.sdS(20),o=t.XpG();return c.Njj(o.addSpoiler(e))}),t.k0s()()(),t.j41(22,"div",43),t.Z7z(23,dW,4,3,"a",44,t.fX1),t.k0s(),t.nrm(25,"div",22),t.nVh(26,hW,3,1,"div",23),t.k0s()}if(2&a){const n=t.sdS(7),i=t.sdS(20),e=t.XpG();t.R7$(),t.Y8G("ngClass",t.l_i(12,wo,"fh"==e.settingsManager.settings.theme,"modern"==e.settingsManager.settings.theme)),t.R7$(2),t.Y8G("ghs-label","datamanagement.unlocks"),t.R7$(3),t.Y8G("ghs-label","datamanagement.addUnlock")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ngClass",t.eq3(15,ei,!n.value)),t.R7$(2),t.Dyx(e.gameManager.game.unlockedCharacters),t.R7$(3),t.vxM(e.gameManager.game.unlockedCharacters.length>0?13:-1),t.R7$(),t.Y8G("ngClass",t.l_i(17,wo,"fh"==e.settingsManager.settings.theme,"modern"==e.settingsManager.settings.theme)),t.R7$(2),t.Y8G("ghs-label","datamanagement.spoilers"),t.R7$(3),t.Y8G("ghs-label","datamanagement.addSpoiler")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ngClass",t.eq3(20,ei,!i.value)),t.R7$(2),t.Dyx(e.settingsManager.settings.spoilers),t.R7$(3),t.vxM(e.settingsManager.settings.spoilers.length>0?26:-1)}}function mW(a,r){if(1&a&&(t.j41(0,"span",47),t.nrm(1,"img",49),t.j41(2,"span",50),t.EFF(3),t.k0s()()),2&a){const n=t.XpG().$implicit;t.Y8G("ghs-label","datamanagement.editionDataUrls.custom")("ghs-label-attribute","title"),t.R7$(3),t.JRh(n.url)}}function pW(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",21)(1,"label",46)(2,"input",32),t.bIt("change",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.toggleEdition(e))}),t.k0s(),t.nrm(3,"span",15),t.k0s(),t.nVh(4,mW,4,3,"span",47),t.nrm(5,"span",22),t.j41(6,"span",48),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.removeEditionDataUrl(e.url))}),t.k0s()()}if(2&a){const n=r.$implicit,i=t.XpG();t.R7$(),t.Y8G("ghs-label",i.settingsManager.settings.editions.includes(n.edition)?"datamanagement.editionDataUrls.disable":"datamanagement.editionDataUrls.enable")("ghs-label-attribute","title"),t.R7$(),t.Y8G("checked",i.settingsManager.settings.editions.includes(n.edition)),t.R7$(),t.Y8G("ghs-label","data.edition."+n.edition),t.R7$(),t.vxM(i.settingsManager.defaultEditionDataUrls.includes(n.url)?-1:4),t.R7$(2),t.Y8G("ghs-label","datamanagement.editionDataUrls.remove")("ghs-label-attribute","title")}}function uW(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",23)(1,"a",24),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.settingsManager.restoreDefaultEditionDataUrls())}),t.nrm(2,"span",15),t.k0s()()}2&a&&(t.R7$(2),t.Y8G("ghs-label","datamanagement.restoreEditionDataUrls"))}function fW(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",16)(1,"a",24),t.bIt("click",function(){c.eBV(n);const e=t.XpG(3);return c.Njj(e.exportAllBackups())}),t.nrm(2,"span",52),t.k0s()()}if(2&a){const n=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","datamanagement.backup.all")("ghs-label-args",t.eq3(2,iW,n.backups))}}function CW(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",51)(1,"label"),t.nrm(2,"span",15),t.k0s()(),t.j41(3,"div",16)(4,"a",24),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.exportLatestBackup())}),t.nrm(5,"span",15),t.k0s()(),t.nVh(6,fW,3,4,"div",16),t.j41(7,"div",16)(8,"a",25),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.deleteBackups())})("mouseleave",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.cancelConfirm())}),t.EFF(9,"<"),t.nrm(10,"span",15),t.EFF(11,"(!)>"),t.k0s()()}if(2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","datamanagement.backup"),t.R7$(3),t.Y8G("ghs-label","datamanagement.backup.latest"),t.R7$(),t.vxM(n.backups>1?6:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(5,da,"deleteBackups"==n.confirm)),t.R7$(2),t.Y8G("ghs-label","datamanagement.backup.delete")}}function MW(a,r){if(1&a&&(t.j41(0,"div",13),t.nVh(1,CW,12,7),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.vxM(n.backups>0?1:-1)}}let vW=(()=>{class a{ghsManager;editionsOnly=!1;settingsManager=p.f;gameManager=s.E;backups=0;ghsInputFullScreenCheck=F.It;confirm="";working="";constructor(n){this.ghsManager=n}ngOnInit(){var n=this;return(0,I.A)(function*(){try{const i=yield G.n.readAll("game-backup");i&&i.length>0&&(n.backups=i.length)}catch{n.backups=0}})()}addEditionDataUrl(n){var i=this;return(0,I.A)(function*(){if(n.value){n.classList.remove("error"),n.disabled=!0;const e=yield p.f.addEditionDataUrl(n.value);e?(n.value="",n.disabled=!1,i.settingsManager.addEdition(e.edition)):setTimeout(()=>{n.classList.add("error"),n.disabled=!1},1)}})()}removeEditionDataUrl(n){n&&p.f.removeEditionDataUrl(n)}toggleEdition(n){var i=this;return(0,I.A)(function*(){i.settingsManager.settings.editions.includes(n.edition)?i.settingsManager.removeEdition(n.edition):(i.settingsManager.addEdition(n.edition),yield i.settingsManager.loadEditionData(n.url,!0),i.ghsManager.triggerUiChange())})()}drop(n){(0,V.HD)(p.f.settings.editionDataUrls,n.previousIndex,n.currentIndex),(0,V.HD)(s.E.editionData,n.previousIndex,n.currentIndex),p.f.storeSettings()}hasDefaultEditionData(){return this.settingsManager.defaultEditionDataUrls.every(n=>p.f.settings.editionDataUrls.includes(n))}addSpoiler(n){n.value&&(p.f.addSpoiler(n.value),n.value="")}removeSpoiler(n){n&&p.f.removeSpoiler(n)}addUnlock(n){if(n.value){let i=n.value,e="";i.includes(":")&&(e=n.value.split(":")[0],i=n.value.split(":")[1]),n.classList.remove("error"),n.disabled=!0;let o=s.E.getCharacterData(i,e||s.E.currentEdition());o||(o=s.E.getCharacterData(i)),o&&!s.E.game.unlockedCharacters.includes(o.edition+":"+o.name)?(s.E.stateManager.before("unlockChar","data.character."+o.edition+"."+o.name),s.E.game.unlockedCharacters.push(o.edition+":"+o.name),p.f.settings.events&&o.unlockEvent&&o.unlockEvent.split("|").forEach(g=>{g.split(":").length>1?s.E.eventCardManager.addEvent(g.split(":")[0],g.split(":")[1],!0):(s.E.eventCardManager.addEvent("city",g,!0),s.E.eventCardManager.addEvent("road",g,!0))}),s.E.stateManager.after(),n.value="",n.disabled=!1):setTimeout(()=>{n.classList.add("error"),n.disabled=!1},1)}}removeUnlock(n){if(n.split(":").length>1){const i=s.E.getCharacterData(n.split(":")[1],n.split(":")[0]);n&&s.E.game.unlockedCharacters.includes(n)&&i&&(s.E.stateManager.before("unlockChar","data.character."+i.edition+"."+i.name),s.E.game.unlockedCharacters.splice(s.E.game.unlockedCharacters.indexOf(n),1),s.E.stateManager.after())}}removeAllUnlocks(){s.E.stateManager.before("removeAllUnlocks"),s.E.game.unlockedCharacters=[],s.E.stateManager.after()}cancelConfirm(){this.confirm=""}exportGame(){return(0,I.A)(function*(){try{const n=yield G.n.readGameModel();if(n){const i=document.createElement("a");i.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(n))),i.setAttribute("download","ghs-game"+(n.party.name?"_"+n.party.name:"")+".json"),document.body.appendChild(i),i.click(),document.body.removeChild(i)}}catch{console.warn("No game found")}})()}exportLatestBackup(){return(0,I.A)(function*(){try{const n=yield G.n.readAll("game-backup");if(n&&n.length>0){const i=n[n.length-1],e=document.createElement("a");e.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(i))),e.setAttribute("download","ghs-game"+(i.party.name?"_"+i.party.name:"")+"-rev"+i.revision+".json"),document.body.appendChild(e),e.click(),document.body.removeChild(e)}}catch{console.warn("No backup found")}})()}exportAllBackups(){return(0,I.A)(function*(){try{const n=yield G.n.readAll("game-backup");n&&n.length>0&&n.forEach(i=>{const e=document.createElement("a");e.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(i))),e.setAttribute("download","ghs-game"+(i.party.name?"_"+i.party.name:"")+"-rev"+i.revision+".json"),document.body.appendChild(e),e.click(),document.body.removeChild(e)})}catch{console.warn("No backups found")}})()}deleteBackups(){"deleteBackups"!=this.confirm?this.confirm="deleteBackups":(G.n.clear("game-backup"),this.backups=0)}importFileCheck(n){n.target.classList.remove("warning"),n.target.parentElement.classList.remove("warning"),"importFile"!=this.confirm?setTimeout(()=>{this.confirm="importFile"},100):(0,F.It)()}importFile(n){var i=this;this.working="importFile",n.target.parentElement.classList.remove("warning");const e=new FileReader;try{e.addEventListener("load",function(){var o=(0,I.A)(function*(g){const m=JSON.parse(g.target.result);m.revision&&"number"==typeof m.revision?i.importGame(Object.assign(new D.u8,m)):m.zoom&&"number"==typeof m.zoom?i.importSettings(Object.assign(new Rc.w,m)):m.game&&m.settings||"object"==typeof m&&m["ghs-game"]&&m["ghs-settings"]?i.importDataDump(m):n.target.parentElement.classList.add("warning"),i.working=""});return function(g){return o.apply(this,arguments)}}()),n.target.files.length>0&&(e.readAsText(n.target.files[0]),n.target.value="")}catch(o){console.warn(o),n.target.parentElement.classList.add("warning"),this.working=""}}importGame(n){s.E.stateManager.before("loadGameFromFile"),n.revision<s.E.game.revision&&(G.n.addBackup(s.E.game.toModel()),n.revision=s.E.game.revision,n.revisionOffset=s.E.game.revisionOffset),s.E.game.fromModel(n),s.E.stateManager.after()}resetGame(){"resetGame"!=this.confirm?this.confirm="resetGame":(s.E.stateManager.reset(),s.E.stateManager.after(),window.location.reload())}exportSettings(){return(0,I.A)(function*(){try{const n=yield G.n.read("settings","default");if(n){const i=document.createElement("a");i.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(n))),i.setAttribute("download","ghs-settings.json"),document.body.appendChild(i),i.click(),document.body.removeChild(i)}}catch{console.warn("No settings found")}})()}importSettings(n){return(0,I.A)(function*(){p.f.settings=n,yield G.n.write("settings","default",p.f.settings)})()}resetSettings(){"resetSettings"!=this.confirm?this.confirm="resetSettings":(p.f.reset(),window.location.reload())}exportDataDump(){return(0,I.A)(function*(){yield s.E.stateManager.autoBackup("ghs-data-dump-"+(new Date).toISOString()+".json",!0)})()}importDataDump(n){return(0,I.A)(function*(){s.E.stateManager.errorLog=n.errorLog||[];const i=Object.keys(n);let e=!1;for(let o=0;o<i.length;o++){const g=i[o],m=g.startsWith("ghs-")?g.replace("ghs-",""):g;"game"===m?(yield G.n.write("game","default",n[g]),e=!0):"settings"===m?yield G.n.write("settings","default",Object.assign(new Rc.w,n[g])):"undo"===m?yield G.n.writeArray("undo",n[g]):"redo"===m?yield G.n.writeArray("redo",n[g]):"undo-infos"===m?yield G.n.writeArray("undo-infos",n[g]):"game-backup"===m&&(yield G.n.writeArray("game-backup",n[g]))}e&&window.location.reload()})()}clearAllData(){var n=this;return(0,I.A)(function*(){if("clearAllData"!=n.confirm)n.confirm="clearAllData";else try{console.warn("clear storage"),yield G.n.clear(),s.E.stateManager.storageBlocked=!0,console.info("Reload..."),window.location.reload()}catch{console.error("Could clear storage")}})()}static \u0275fac=function(i){return new(i||a)(t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-datamanagement-menu"]],inputs:{editionsOnly:"editionsOnly"},standalone:!1,decls:21,vars:17,consts:[["inputEditionDataUrl",""],["autoBackup",""],["autoBackupuploadUrl",""],["autoBackupPostMethod",""],["autoBackupPostFileUpload",""],["autoBackupPostAuthorization",""],["autoBackupPostUsername",""],["autoBackupPostPassword",""],["inputUnlock",""],["inputSpoiler",""],[1,"menu-container","data"],[1,"columns","columns-break"],[1,"separator"],[1,"column"],[1,"line","title","sticky",3,"ngClass"],[3,"ghs-label"],[1,"line"],[1,"input-button"],["tabclick","","type","text",3,"keyup.enter","keyup","ghs-label","ghs-label-attribute"],[1,"add-button",3,"click","ngClass"],["cdkDropList","",1,"line","editions",3,"cdkDropListDropped"],["cdkDrag","",1,"edition"],[1,"spacer"],[1,"line","separator"],["tabclick","",3,"click"],["tabclick","",3,"click","mouseleave","ngClass"],[1,"hint-container"],["tabclick","",1,"input-file","hint-trigger",3,"click","mouseleave","ngClass"],["type","file","accept","application/json",3,"change","ngClass","disabled"],["src","./assets/images/hint.svg",1,"hint-trigger","ghs-svg"],[1,"hint"],[1,"text",3,"ghs-label"],["tabclick","","type","checkbox",3,"change","checked"],[1,"label"],["tabclick","","type","number","min","0",3,"keyup","change","value","size","ghs-label","ghs-label-attribute"],[1,"text"],[1,"hint-container","input-container"],["tabclick","","type","text",3,"keyup","change","value","ghs-label","ghs-label-attribute"],[1,"line",3,"ngClass"],["tabclick","",3,"change","value"],["value","POST"],["value","PUT"],["value","GET"],[1,"line","spoilers"],[1,"spoiler-item"],["tabclick","",1,"remove",3,"click","ghs-label","ghs-label-attribute"],[3,"ghs-label","ghs-label-attribute"],[1,"custom",3,"ghs-label","ghs-label-attribute"],[1,"remove",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/hint.svg"],[1,"url"],[1,"line","title"],[3,"ghs-label","ghs-label-args"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",10),t.nVh(1,rW,43,27,"div",11),t.nVh(2,cW,1,0,"div",12),t.j41(3,"div",11),t.nVh(4,_W,27,22,"div",13),t.j41(5,"div",13)(6,"div",14)(7,"label"),t.nrm(8,"span",15),t.k0s()(),t.j41(9,"div",16)(10,"span",17)(11,"input",18,0),t.bIt("keyup.enter",function(m){return c.eBV(o),c.Njj(e.addEditionDataUrl(m.target))})("keyup",function(){c.eBV(o);const m=t.sdS(12);return c.Njj(m.classList.remove("error"))}),t.k0s(),t.j41(13,"span",19),t.bIt("click",function(){c.eBV(o);const m=t.sdS(12);return c.Njj(e.addEditionDataUrl(m))}),t.k0s()()(),t.j41(14,"div",20),t.bIt("cdkDropListDropped",function(m){return c.eBV(o),c.Njj(e.drop(m))}),t.Z7z(15,pW,7,7,"a",21,oW),t.nI1(17,"trackUUID"),t.k0s(),t.nrm(18,"div",22),t.nVh(19,uW,3,1,"div",23),t.k0s(),t.nVh(20,MW,2,1,"div",13),t.k0s()()}if(2&i){const o=t.sdS(12);t.R7$(),t.vxM(e.editionsOnly?-1:1),t.R7$(),t.vxM(e.editionsOnly?-1:2),t.R7$(2),t.vxM(e.editionsOnly?-1:4),t.R7$(2),t.Y8G("ngClass",t.l_i(12,wo,"fh"==e.settingsManager.settings.theme,"modern"==e.settingsManager.settings.theme)),t.R7$(2),t.Y8G("ghs-label","datamanagement.editionDataUrls"),t.R7$(3),t.Y8G("ghs-label","datamanagement.addEditionDataUrl")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ngClass",t.eq3(15,ei,!o.value)),t.R7$(2),t.Dyx(t.bMT(17,10,e.gameManager.editionData)),t.R7$(4),t.vxM(e.hasDefaultEditionData()?-1:19),t.R7$(),t.vxM(e.editionsOnly?-1:20)}},dependencies:[N.YU,E.xH,E.y7,V.O7,V.T1,it,Ft,ct],styles:['[_nghost-%COMP%]{position:relative;z-index:9999}.hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:break-spaces}.back[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled[_ngcontent-%COMP%]{pointer-events:none}.back.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container[_ngcontent-%COMP%]{z-index:1}.menu-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.no-grow[_ngcontent-%COMP%]{flex-grow:0}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container.inline[_ngcontent-%COMP%]{width:initial;margin-right:1em}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex-wrap:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-gray)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{filter:grayscale(1)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm-delete[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]{align-items:flex-start}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]   .undo-text[_ngcontent-%COMP%]{display:flex;align-items:center}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.redo[_ngcontent-%COMP%]{align-items:flex-end}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]:hover{opacity:.7}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover{cursor:pointer}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog.disabled[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)!important}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]{border-bottom:none;margin-bottom:0}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container[_ngcontent-%COMP%]   .line.sticky.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container[_ngcontent-%COMP%]   .line.sticky.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .add[_ngcontent-%COMP%]{display:inherit}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%] ~ .spoiler[_ngcontent-%COMP%]{margin-top:0;border-top:none}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]{display:flex;cursor:pointer}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]   .span-xs[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns.columns-break[_ngcontent-%COMP%]{flex-wrap:wrap}}','.editions[_ngcontent-%COMP%], .spoilers[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start!important;justify-content:center!important}.edition[_ngcontent-%COMP%], .spoiler-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) 0;width:100%}.edition[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%], .spoiler-item[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]{cursor:pointer!important;display:flex;width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.edition[_ngcontent-%COMP%]:hover   .remove[_ngcontent-%COMP%]:after, .spoiler-item[_ngcontent-%COMP%]:hover   .remove[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 80%,30% 50%,0 20%,20% 0,50% 30%,80% 0,100% 20%,70% 50%,100% 80%,80% 100%,50% 70%,20% 100%);background-color:var(--ghs-color-white)}.spoiler-item[_ngcontent-%COMP%]{cursor:initial!important}.working[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray);animation:ghs-spinning calc(var(--ghs-animation-speed) * 1.5s) linear infinite;margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.edition[_ngcontent-%COMP%]{cursor:grab!important;padding:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) 0}.edition[_ngcontent-%COMP%]   .custom[_ngcontent-%COMP%]{display:flex;align-items:center;filter:var(--ghs-filter-gray) var(--ghs-filter-shadow);margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.edition[_ngcontent-%COMP%]   .custom[_ngcontent-%COMP%]   .url[_ngcontent-%COMP%]{display:none;font-family:var(--ghs-font-normal);align-self:flex-end;font-size:.8em;margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));flex:1 1 auto;text-shadow:none}.edition[_ngcontent-%COMP%]:hover   .custom[_ngcontent-%COMP%]   .url[_ngcontent-%COMP%]{display:inline-block}.line[_ngcontent-%COMP%]   .input-file[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{width:0;height:0;margin:0;padding:0;visibility:hidden}.line[_ngcontent-%COMP%]   .input-file[_ngcontent-%COMP%]   input[type=file].disabled[_ngcontent-%COMP%]{pointer-events:none}.line[_ngcontent-%COMP%]   .input-file.error[_ngcontent-%COMP%]{animation:shake calc(var(--ghs-animation-speed) * .5s) linear;color:var(--ghs-color-red)!important}.line[_ngcontent-%COMP%]   .input-file.warning[_ngcontent-%COMP%]{animation:shake calc(var(--ghs-animation-speed) * .5s) linear;color:var(--ghs-color-yellow)!important}.line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   label.hint-trigger[_ngcontent-%COMP%]{margin-left:0}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:1 span}}']})}return a})(),OW=(()=>{class a{settingsManager=p.f;close=new t.bkB;setServerPing(n){p.f.settings.serverPing=n.target.value,p.f.storeSettings()}clearFeedbackErrors(){p.f.settings.feedbackErrorsIgnore=[],p.f.storeSettings(),this.close.emit()}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-debug-menu"]],outputs:{close:"close"},standalone:!1,decls:51,vars:26,consts:[["serverPing",""],[1,"menu-container","debug"],[1,"line"],["tabclick","","type","checkbox",3,"change","checked"],[3,"ghs-label"],[1,"separator"],[1,"line","ping"],[1,"label"],["type","number",3,"keyup","change","value","ghs-label","ghs-label-attribute"],["tabclick","",3,"click"],[1,"line","title","span"],["tabclick","",3,"routerLink"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"label")(3,"input",3),t.bIt("change",function(){return c.eBV(o),c.Njj(e.settingsManager.toggle("debugRightClick"))}),t.k0s(),t.nrm(4,"span",4),t.k0s()(),t.nrm(5,"div",5),t.j41(6,"div",2)(7,"label")(8,"input",3),t.bIt("change",function(){return c.eBV(o),c.Njj(e.settingsManager.toggle("logServerMessages"))}),t.k0s(),t.nrm(9,"span",4),t.k0s()(),t.j41(10,"div",6)(11,"label",7),t.nrm(12,"span",4),t.k0s(),t.j41(13,"input",8,0),t.bIt("keyup",function(){return c.eBV(o),c.Njj(0)})("change",function(m){return c.eBV(o),c.Njj(e.setServerPing(m))}),t.k0s()(),t.nrm(15,"div",5),t.j41(16,"div",2)(17,"a",9),t.bIt("click",function(){return c.eBV(o),c.Njj(e.clearFeedbackErrors())}),t.nrm(18,"span",4),t.k0s()(),t.j41(19,"div",10)(20,"label"),t.nrm(21,"span",4),t.k0s()(),t.j41(22,"div",2)(23,"a",11),t.nrm(24,"span",4),t.k0s()(),t.j41(25,"div",2)(26,"a",11),t.nrm(27,"span",4),t.k0s()(),t.j41(28,"div",2)(29,"a",11),t.nrm(30,"span",4),t.k0s()(),t.j41(31,"div",2)(32,"a",11),t.nrm(33,"span",4),t.k0s()(),t.j41(34,"div",10)(35,"label"),t.nrm(36,"span",4),t.k0s()(),t.j41(37,"div",2)(38,"a",11),t.nrm(39,"span",4),t.k0s()(),t.j41(40,"div",2)(41,"a",11),t.nrm(42,"span",4),t.k0s()(),t.nrm(43,"div",5),t.j41(44,"div",2)(45,"a",9),t.bIt("click",function(){return c.eBV(o),c.Njj(e.settingsManager.validateEditionData())}),t.nrm(46,"span",4),t.k0s()(),t.nrm(47,"div",5),t.j41(48,"div",2)(49,"a",11),t.nrm(50,"span",4),t.k0s()()()}2&i&&(t.R7$(3),t.Y8G("checked",e.settingsManager.settings.debugRightClick),t.R7$(),t.Y8G("ghs-label","settings.debug.rightClick"),t.R7$(4),t.Y8G("checked",e.settingsManager.settings.logServerMessages),t.R7$(),t.Y8G("ghs-label","settings.debug.logServerMessages"),t.R7$(3),t.Y8G("ghs-label","server.ping"),t.R7$(),t.Y8G("value",e.settingsManager.settings.serverPing||"0")("ghs-label","server.ping")("ghs-label-attribute","placeholder"),t.R7$(5),t.Y8G("ghs-label","settings.feedbackErrors.clear"),t.R7$(3),t.Y8G("ghs-label","editor"),t.R7$(2),t.Y8G("routerLink","/editor/monster"),t.R7$(),t.Y8G("ghs-label","editor.monster"),t.R7$(2),t.Y8G("routerLink","/editor/character"),t.R7$(),t.Y8G("ghs-label","editor.character"),t.R7$(2),t.Y8G("routerLink","/editor/deck"),t.R7$(),t.Y8G("ghs-label","editor.deck"),t.R7$(2),t.Y8G("routerLink","/editor/edition"),t.R7$(),t.Y8G("ghs-label","editor.edition"),t.R7$(3),t.Y8G("ghs-label","tools"),t.R7$(2),t.Y8G("routerLink","/tools/decks"),t.R7$(),t.Y8G("ghs-label","tools.decks"),t.R7$(2),t.Y8G("routerLink","/tools/attackmodifier"),t.R7$(),t.Y8G("ghs-label","tools.attackModifier"),t.R7$(4),t.Y8G("ghs-label","tools.validateEditionData"),t.R7$(3),t.Y8G("routerLink","/"),t.R7$(),t.Y8G("ghs-label","tools.backToGhs"))},dependencies:[q.Wk,it,Ft],styles:['[_nghost-%COMP%]{position:relative;z-index:9999}.hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:break-spaces}.back[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled[_ngcontent-%COMP%]{pointer-events:none}.back.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container[_ngcontent-%COMP%]{z-index:1}.menu-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.no-grow[_ngcontent-%COMP%]{flex-grow:0}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container.inline[_ngcontent-%COMP%]{width:initial;margin-right:1em}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex-wrap:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-gray)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{filter:grayscale(1)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm-delete[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]{align-items:flex-start}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]   .undo-text[_ngcontent-%COMP%]{display:flex;align-items:center}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.redo[_ngcontent-%COMP%]{align-items:flex-end}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]:hover{opacity:.7}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover{cursor:pointer}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog.disabled[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)!important}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]{border-bottom:none;margin-bottom:0}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container[_ngcontent-%COMP%]   .line.sticky.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container[_ngcontent-%COMP%]   .line.sticky.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .add[_ngcontent-%COMP%]{display:inherit}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%] ~ .spoiler[_ngcontent-%COMP%]{margin-top:0;border-top:none}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]{display:flex;cursor:pointer}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]   .span-xs[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns.columns-break[_ngcontent-%COMP%]{flex-wrap:wrap}}']})}return a})();const PW=(a,r,n)=>({fh:a,modern:r,"all-editions":n}),jc=a=>({disabled:a}),bW=(a,r,n)=>({"hide-title":a,fh:r,modern:n}),kW=(a,r,n,i)=>({disabled:a,spoiler:r,boss:n,"hidden-monster":i}),yW=(a,r)=>r._trackUUID;function xW(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",4),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.allEditions=!e.allEditions)}),t.k0s(),t.nrm(2,"span",5),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("checked",n.allEditions),t.R7$(),t.Y8G("ghs-label","character.filter.allEditions")}}function EW(a,r){1&a&&(t.j41(0,"span",14),t.nrm(1,"img",16),t.k0s())}function wW(a,r){1&a&&t.nrm(0,"img",15)}function RW(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",13),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(3);return c.Njj(o.addMonster(e))}),t.nVh(1,EW,2,0,"span",14),t.nrm(2,"span",5),t.nVh(3,wW,1,0,"img",15),t.k0s()}if(2&a){const n=t.XpG().$implicit;t.R7$(),t.vxM(n.boss?1:-1),t.R7$(),t.Y8G("ghs-label","data.monster."+n.name),t.R7$(),t.vxM(n.hidden?3:-1)}}function jW(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",13),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(3);return c.Njj(o.settingsManager.addSpoiler(e.name))}),t.j41(1,"span",17),t.nrm(2,"span",5),t.k0s(),t.j41(3,"span",18),t.nrm(4,"span",5),t.k0s()()}2&a&&(t.R7$(2),t.Y8G("ghs-label","spoiler.placeholder"),t.R7$(2),t.Y8G("ghs-label","spoiler.add"))}function GW(a,r){if(1&a&&(t.j41(0,"div",11),t.nVh(1,RW,4,3,"a",12),t.nVh(2,jW,5,2,"a",12),t.k0s()),2&a){const n=r.$implicit,i=t.XpG(3);t.Y8G("ngClass",t.ziG(3,kW,i.hasMonster(n),n.spoiler,n.boss,n.hidden)),t.R7$(),t.vxM(i.isSpoiled(n)?1:-1),t.R7$(),t.vxM(i.isSpoiled(n)?-1:2)}}function TW(a,r){if(1&a&&(t.j41(0,"div",9)(1,"div",10)(2,"label"),t.nrm(3,"span",5),t.k0s()(),t.Z7z(4,GW,3,8,"div",11,yW),t.nI1(6,"trackUUID"),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(),t.Y8G("ngClass",t.sMw(4,bW,!i.allEditions&&1==i.gameManager.currentEditions().length,"fh"==i.settingsManager.settings.theme,"modern"==i.settingsManager.settings.theme)),t.R7$(2),t.Y8G("ghs-label","data.edition."+n),t.R7$(),t.Dyx(t.bMT(6,2,i.monsterData(n,i.filter)))}}function SW(a,r){if(1&a&&t.nVh(0,TW,7,8,"div",9),2&a){const n=r.$implicit,i=t.XpG();t.vxM(i.monsterData(n,i.filter).length>0?0:-1)}}function DW(a,r){1&a&&(t.j41(0,"div",7)(1,"div",8)(2,"label"),t.nrm(3,"span",5),t.k0s()()()),2&a&&(t.R7$(3),t.Y8G("ghs-label","monster.filter.noResult"))}function $W(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",8)(1,"a",13),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.settingsManager.addSpoilers(e.notSpoiled(e.monsterData())))}),t.nrm(2,"span",5),t.k0s()()}2&a&&(t.R7$(2),t.Y8G("ghs-label","spoiler.all"))}let IW=(()=>{class a{gameManager=s.E;settingsManager=p.f;hasSpoilers=F.KZ;isSpoiled=F.DJ;notSpoiled=F.gP;filter="";allEditions=!1;hasMonster(n){return s.E.game.figures.some(i=>i instanceof b.R&&n.name==i.name&&n.edition==i.edition)}hasBossMonster(){return s.E.currentEditions().some(n=>s.E.monstersData(n).some(i=>i.boss))}hasHiddenMonster(){return s.E.currentEditions().some(n=>s.E.monstersData(n).some(i=>i.hidden))}monsterData(n=void 0,i=""){return s.E.monstersData(n).filter(e=>(!e.boss||e.boss==p.f.settings.showBossMonster)&&(!e.hidden||e.hidden==p.f.settings.showHiddenMonster)&&(!i||(0,F.oB)(e.name,i)||(0,F.oB)(p.f.getLabel("data.monster."+e.name),i))).sort((e,o)=>{const g=p.f.getLabel("data.monster."+e.name).toLowerCase(),m=p.f.getLabel("data.monster."+o.name).toLowerCase();if(e.spoiler&&!o.spoiler)return 1;if(!e.spoiler&&o.spoiler)return-1;if(e.boss&&!o.boss)return 1;if(!e.boss&&o.boss)return-1;if(e.hidden&&!o.hidden)return 1;if(!e.hidden&&o.hidden)return-1;if(e.spoiler&&o.spoiler){if(!this.isSpoiled(e)&&this.isSpoiled(o))return 1;if(this.isSpoiled(e)&&!this.isSpoiled(o))return-1}return g>m?1:g<m?-1:0})}addMonster(n){s.E.stateManager.before("addMonster","data.monster."+n.name),s.E.monsterManager.addMonster(n,s.E.game.level).tags.push("addedManually"),s.E.stateManager.after()}noResults(){return s.E.currentEditions().every(n=>0==this.monsterData(n,this.filter).length)}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-monster-menu"]],standalone:!1,decls:15,vars:21,consts:[[1,"menu-container","monster-add"],[1,"line","filter-monster-menu",3,"ngClass"],["type","text",3,"ngModelChange","ngModel","ghs-label","ghs-label-attribute"],[3,"ngClass"],["tabclick","","type","checkbox",3,"change","checked"],[3,"ghs-label"],[1,"columns"],[1,"column"],[1,"line"],[1,"column","spoilers","bosses"],[1,"line","title","sticky",3,"ngClass"],[1,"line",3,"ngClass"],["tabclick",""],["tabclick","",3,"click"],[1,"boss-icon"],["src","./assets/images/hidden.svg",1,"ghs-svg","hidden-icon"],["src","./assets/images/monster/enemy.png"],[1,"name"],[1,"add"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"input",2),t.mxI("ngModelChange",function(g){return t.DH7(e.filter,g)||(e.filter=g),g}),t.k0s(),t.nVh(3,xW,3,2,"label"),t.j41(4,"label",3)(5,"input",4),t.bIt("change",function(){return e.settingsManager.toggle("showBossMonster")}),t.k0s(),t.nrm(6,"span",5),t.k0s(),t.j41(7,"label",3)(8,"input",4),t.bIt("change",function(){return e.settingsManager.toggle("showHiddenMonster")}),t.k0s(),t.nrm(9,"span",5),t.k0s()(),t.j41(10,"div",6),t.Z7z(11,SW,1,1,null,null,t.fX1),t.nVh(13,DW,4,1,"div",7),t.k0s(),t.nVh(14,$W,3,1,"div",8),t.k0s()),2&i&&(t.R7$(),t.Y8G("ngClass",t.sMw(13,PW,"fh"==e.settingsManager.settings.theme,"modern"==e.settingsManager.settings.theme,e.gameManager.game.edition)),t.R7$(),t.R50("ngModel",e.filter),t.Y8G("ghs-label","monster.filter")("ghs-label-attribute","placeholder"),t.R7$(),t.vxM(e.gameManager.game.edition?3:-1),t.R7$(),t.Y8G("ngClass",t.eq3(17,jc,!e.hasBossMonster())),t.R7$(),t.Y8G("checked",e.settingsManager.settings.showBossMonster),t.R7$(),t.Y8G("ghs-label","monster.showBoss"),t.R7$(),t.Y8G("ngClass",t.eq3(19,jc,!e.hasHiddenMonster())),t.R7$(),t.Y8G("checked",e.settingsManager.settings.showHiddenMonster),t.R7$(),t.Y8G("ghs-label","monster.showHidden"),t.R7$(2),t.Dyx(e.allEditions?e.gameManager.editions(!0,!0):e.gameManager.currentEditions()),t.R7$(2),t.vxM(e.filter&&e.noResults()?13:-1),t.R7$(),t.vxM(e.hasSpoilers(e.monsterData())?14:-1))},dependencies:[N.YU,E.me,E.BC,E.vS,it,Ft,ct],styles:['[_nghost-%COMP%]{position:relative;z-index:9999}.hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:break-spaces}.back[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled[_ngcontent-%COMP%]{pointer-events:none}.back.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container[_ngcontent-%COMP%]{z-index:1}.menu-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.no-grow[_ngcontent-%COMP%]{flex-grow:0}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container.inline[_ngcontent-%COMP%]{width:initial;margin-right:1em}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex-wrap:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-gray)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{filter:grayscale(1)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm-delete[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]{align-items:flex-start}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]   .undo-text[_ngcontent-%COMP%]{display:flex;align-items:center}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.redo[_ngcontent-%COMP%]{align-items:flex-end}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]:hover{opacity:.7}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover{cursor:pointer}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog.disabled[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)!important}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]{border-bottom:none;margin-bottom:0}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container[_ngcontent-%COMP%]   .line.sticky.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container[_ngcontent-%COMP%]   .line.sticky.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .add[_ngcontent-%COMP%]{display:inherit}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%] ~ .spoiler[_ngcontent-%COMP%]{margin-top:0;border-top:none}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]{display:flex;cursor:pointer}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]   .span-xs[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns.columns-break[_ngcontent-%COMP%]{flex-wrap:wrap}}',".monster-add[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 70 * var(--ghs-dialog-factor))}.monster-add[_ngcontent-%COMP%]   .filter-monster-menu[_ngcontent-%COMP%]{position:fixed;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:2;width:inherit;display:flex;flex-direction:column;align-items:flex-start}.monster-add[_ngcontent-%COMP%]   .filter-monster-menu.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.monster-add[_ngcontent-%COMP%]   .filter-monster-menu.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.monster-add[_ngcontent-%COMP%]   .filter-monster-menu[_ngcontent-%COMP%] + .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%], .monster-add[_ngcontent-%COMP%]   .filter-monster-menu[_ngcontent-%COMP%] + .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]:not(sticky):first-child{padding-top:calc(var(--ghs-unit) * 14 * var(--ghs-dialog-factor))}.monster-add[_ngcontent-%COMP%]   .filter-monster-menu.all-editions[_ngcontent-%COMP%] + .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%], .monster-add[_ngcontent-%COMP%]   .filter-monster-menu.all-editions[_ngcontent-%COMP%] + .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]:not(sticky):first-child{padding-top:calc(var(--ghs-unit) * 17 * var(--ghs-dialog-factor))}.monster-add[_ngcontent-%COMP%]   .bosses[_ngcontent-%COMP%] > .boss[_ngcontent-%COMP%]:not(:nth-child(2)){margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray)}.monster-add[_ngcontent-%COMP%]   .bosses[_ngcontent-%COMP%] > .boss[_ngcontent-%COMP%] ~ .boss[_ngcontent-%COMP%]{margin-top:0;border-top:none}.monster-add[_ngcontent-%COMP%]   .bosses[_ngcontent-%COMP%]   .boss-icon[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));background-color:var(--ghs-color-darkred);border:2px solid var(--ghs-color-gray);border-radius:100%;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.monster-add[_ngcontent-%COMP%]   .bosses[_ngcontent-%COMP%]   .boss-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));height:auto}.monster-add[_ngcontent-%COMP%]   .bosses[_ngcontent-%COMP%]   .hidden-icon[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));filter:var(--ghs-filter-gray)}.monster-add[_ngcontent-%COMP%]   .hidden-monster[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-style:italic;font-size:calc(var(--ghs-unit) * 2.7 * var(--ghs-dialog-factor))}"]})}return a})();class Gc{name;spoiler=!0;constructor(r){this.name=r}}const AW=(a,r,n)=>({current:a,blocked:r,locked:n}),VW=a=>[a],Tc=()=>[],FW=a=>({disabled:a}),XW=(a,r)=>r._trackUUID;function BW(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",8)(1,"input",17),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.customScenarioName(e))}),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("value",n.gameManager.game.scenario.name)("ghs-label","scenario.title")("ghs-label-attribute","placeholder")}}function YW(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",9)(1,"div",8)(2,"a",18),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.resetScenario())}),t.EFF(3,"<"),t.nrm(4,"span",7),t.EFF(5,"!>"),t.k0s()()()}2&a&&(t.R7$(4),t.Y8G("ghs-label","scenario.reset"))}function UW(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",19),t.bIt("change",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.setEdition(e))}),t.k0s(),t.nrm(2,"span",7),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.R7$(),t.Y8G("value",n)("checked",i.edition==n),t.R7$(),t.Y8G("ghs-label","data.edition."+n)}}function NW(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",6),t.bIt("change",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.settingsManager.toggle("showOnlyUnfinishedScenarios"))}),t.k0s(),t.nrm(2,"span",7),t.k0s()}if(2&a){const n=t.XpG();t.R7$(),t.Y8G("checked",n.settingsManager.settings.showOnlyUnfinishedScenarios),t.R7$(),t.Y8G("ghs-label","scenario.filterSuccess")}}function zW(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",20),t.nrm(1,"label",7),t.j41(2,"a",13),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.scenarioChart(e))}),t.nrm(3,"img",14),t.k0s()()}if(2&a){const n=t.XpG().$implicit;t.R7$(),t.Y8G("ghs-label","data.scenario.group."+n),t.R7$(),t.Y8G("ghs-tooltip","scenario.chart")}}function LW(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function qW(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function HW(a,r){if(1&a&&(t.nVh(0,LW,2,0,"span"),t.nVh(1,qW,2,0,"span"),t.j41(2,"span",29),t.EFF(3),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG().$implicit,e=t.XpG();t.vxM(e.maxScenario(i)>2&&n.index.length<3?0:-1),t.R7$(),t.vxM(e.maxScenario(i)>1&&n.index.length<2?1:-1),t.R7$(2),t.JRh(n.index)}}function KW(a,r){1&a&&t.nrm(0,"img",30)}function WW(a,r){1&a&&t.nrm(0,"img",31)}function ZW(a,r){if(1&a&&(t.j41(0,"span",24),t.Z7z(1,KW,1,0,"img",30,t.fX1),t.nI1(3,"ghsRange"),t.Z7z(4,WW,1,0,"img",31,t.fX1),t.nI1(6,"ghsRange"),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.Dyx(t.i5U(3,0,t.lJ4(6,Tc),n.complexity)),t.R7$(3),t.Dyx(t.i5U(6,3,t.lJ4(7,Tc),3-n.complexity))}}function JW(a,r){if(1&a&&t.nrm(0,"img",25),2&a){const n=t.XpG().$implicit,i=t.XpG(2);t.Y8G("src",i.gameManager.characterManager.characterIcon(n.solo),t.B4B)}}function QW(a,r){1&a&&(t.j41(0,"span",26),t.nrm(1,"img",32),t.k0s())}function tZ(a,r){1&a&&(t.j41(0,"span",27),t.nrm(1,"img",33),t.k0s())}function nZ(a,r){1&a&&(t.j41(0,"span",28),t.nrm(1,"img",33),t.k0s())}function eZ(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",23),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(2);return c.Njj(o.setScenario(e))}),t.nVh(1,HW,4,3),t.nVh(2,ZW,7,8,"span",24),t.nVh(3,JW,1,1,"img",25),t.nVh(4,QW,2,0,"span",26),t.nVh(5,tZ,2,0,"span",27),t.nVh(6,nZ,2,0,"span",28),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.sMw(9,AW,i.gameManager.scenarioManager.isCurrent(n),n.isBlocked,n.isLocked))("ghs-tooltip","scenario.tooltip"+(n.isBlocked?".blocked":n.isLocked?".locked":""))("ghs-label-args",t.eq3(13,VW,i.gameManager.scenarioManager.scenarioTitle(n))),t.R7$(),t.vxM(n.solo?-1:1),t.R7$(),t.vxM(n.complexity?2:-1),t.R7$(),t.vxM(n.solo?3:-1),t.R7$(),t.vxM(i.gameManager.scenarioManager.isSuccess(n)?4:-1),t.R7$(),t.vxM(n.isBlocked?5:-1),t.R7$(),t.vxM(!n.isBlocked&&n.isLocked?6:-1)}}function aZ(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",8)(1,"a",18),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG();return c.Njj(o.settingsManager.addSpoilers(o.notSpoiled(e)))}),t.nrm(2,"span",7),t.k0s()()}2&a&&(t.R7$(2),t.Y8G("ghs-label","spoiler.all"))}function iZ(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",34)(1,"label"),t.nrm(2,"span",7),t.k0s()(),t.j41(3,"div",8)(4,"span",35)(5,"input",36,1),t.bIt("keyup",function(){c.eBV(n);const e=t.sdS(6);return c.Njj(e.classList.remove("error"))})("keyup.enter",function(){c.eBV(n);const e=t.sdS(6),o=t.XpG().$implicit,g=t.XpG();return c.Njj(g.manualScenario(e,o))}),t.k0s(),t.j41(7,"span",37),t.bIt("click",function(){c.eBV(n);const e=t.sdS(6),o=t.XpG().$implicit,g=t.XpG();return c.Njj(g.manualScenario(e,o))}),t.k0s()()()}if(2&a){const n=t.sdS(6);t.R7$(2),t.Y8G("ghs-label","scenario.manual.add"),t.R7$(3),t.Y8G("ghs-label","scenario.manual.index")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","scenario.manual.add")("ghs-label-attribute","title")("ngClass",t.eq3(6,FW,!n.value||n.classList.contains("error")))}}function oZ(a,r){if(1&a&&(t.nVh(0,zW,4,2,"div",20),t.j41(1,"div",21),t.Z7z(2,eZ,7,15,"span",22,XW),t.nI1(4,"ghsScenarioSearch"),t.nI1(5,"trackUUID"),t.k0s(),t.nVh(6,aZ,3,1,"div",8),t.nVh(7,iZ,8,8)),2&a){const n=r.$implicit,i=t.XpG(),e=t.sdS(16);t.vxM(n?0:-1),t.R7$(2),t.Dyx(t.bMT(5,6,t.i5U(4,3,i.scenarios(n,i.gameManager.game.party.campaignMode&&i.settingsManager.settings.showOnlyUnfinishedScenarios),e.value))),t.R7$(4),t.vxM(i.hasSpoilers(n)?6:-1),t.R7$(),t.vxM(i.gameManager.game.party.campaignMode&&i.scenarios(n).length<i.scenarios(n,!1,!0,!0).length?7:-1)}}let sZ=(()=>{class a{dialog;ghsManager;close=new t.bkB;gameManager=s.E;settingsManager=p.f;GameState=D.mk;edition="";editions=[];groups=[];hasRandom=!1;scenarioCache=[];constructor(n,i){this.dialog=n,this.ghsManager=i}ngOnInit(){this.edition=s.E.game.scenario&&!s.E.game.scenario.custom&&s.E.game.scenario.edition||!s.E.game.edition&&(!s.E.game.scenario||!s.E.game.scenario.custom)&&s.E.game.party.scenarios.length>0&&s.E.game.party.scenarios[s.E.game.party.scenarios.length-1].edition||s.E.currentEdition(),this.updateGroups(),this.setEditions(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.scenarioCache=[],this.setEditions()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}setEditions(){this.editions=s.E.game.edition?[s.E.game.edition,...s.E.editionExtensions(s.E.game.edition),...s.E.editionScenarioExtensions(s.E.game.edition)]:s.E.editionData.map(n=>n.edition),this.editions=this.editions.filter(n=>s.E.scenarioManager.scenarioData(n).length>0&&p.f.settings.editions.includes(n)),this.hasRandom=this.edition&&null!=s.E.sectionData(this.edition).find(n=>"randomMonsterCard"==n.group)||!1}setEdition(n){this.edition=n,this.updateGroups(),this.setEditions()}updateGroups(){this.edition||(this.groups=[]);const n=s.E.scenarioManager.scenarioData(this.edition,!0).map(i=>i.group).filter((i,e,o)=>i&&o.indexOf(i)===e).sort((i,e)=>i&&e&&(i.toLowerCase()<e.toLowerCase()?-1:1)||0);this.groups=[void 0,...n]}scenarios(n=void 0,i=!1,e=!1,o=!1){if(!this.edition)return[];let g=this.scenarioCache.find(m=>m.edition==this.edition&&m.group==n&&m.filterSuccess==i&&m.includeSpoiler==e&&m.all==o);return g||(g={edition:this.edition,group:n,filterSuccess:i,includeSpoiler:e,all:o,scenarios:[]},g.scenarios=s.E.scenarioManager.scenarioData(this.edition,o).filter(m=>m.group==n&&(e||!m.spoiler||s.E.game.unlockedCharacters.includes(m.edition+":"+m.name)||m.solo&&s.E.game.unlockedCharacters.includes(m.edition+":"+m.solo))&&(!i||!s.E.scenarioManager.isSuccess(m)&&!s.E.scenarioManager.isBlocked(m))).sort(s.E.scenarioManager.sortScenarios).map(m=>new ut.jW(m,s.E.scenarioManager.isSuccess(m),s.E.scenarioManager.isBlocked(m),s.E.scenarioManager.isLocked(m))),this.scenarioCache.push(g)),g.scenarios}maxScenario(n){return Math.max(...this.scenarios(n).map(i=>i.index.length))}setScenario(n){s.E.scenarioManager.isCurrent(n)||(s.E.scenarioManager.isLocked(n)?this.dialog.open(Ra,{panelClass:["dialog"],data:{scenarioData:n}}):(s.E.stateManager.before("setScenario",...s.E.scenarioManager.scenarioUndoArgs(new ut.Nz(n))),s.E.scenarioManager.setScenario(n),s.E.stateManager.after()),this.close.emit())}resetScenario(){s.E.game.scenario&&(s.E.stateManager.before("resetScenario",...s.E.scenarioManager.scenarioUndoArgs()),s.E.roundManager.resetScenario(),s.E.scenarioManager.setScenario(s.E.game.scenario),this.close.emit(),s.E.stateManager.after())}customScenario(){s.E.game.scenario&&s.E.game.scenario.custom?(s.E.stateManager.before("unsetCustomScenario"),s.E.scenarioManager.setScenario(void 0),this.edition=s.E.game.edition||s.E.editions()[0],s.E.stateManager.after()):(s.E.stateManager.before("setCustomScenario"),s.E.scenarioManager.setScenario(s.E.scenarioManager.createScenario()),s.E.stateManager.after())}customScenarioName(n){s.E.game.scenario&&s.E.game.scenario.custom&&(s.E.stateManager.before("changeCustomScenario",n.target.value),s.E.game.scenario.name=n.target.value,s.E.stateManager.after())}randomScenario(){const n=(0,F.Z)(s.E.sectionData(this.edition).filter(e=>"randomMonsterCard"==e.group));if(n.length<3)return;s.E.stateManager.before("setRandomScenario");const i=s.E.scenarioManager.createScenario();i.name="%scenario.random%",i.additionalSections=n.slice(0,3).map(e=>e.index),s.E.scenarioManager.setScenario(void 0),s.E.scenarioManager.setScenario(i),s.E.scenarioManager.addSection(n[0]),s.E.stateManager.after()}manualScenario(n,i){n.classList.add("error");const e=s.E.scenarioData(this.edition).filter(g=>g.group==i);let o=n.value.split(",");o.forEach(g=>g.trim()),n.value.split(",").forEach(g=>{const m=e.find(k=>k.index==g.trim()&&k.group==i);m?(this.scenarios(i).find(k=>k.edition==m.edition&&k.group==m.group&&k.index==m.index)||(s.E.stateManager.before("addManualScenario",...s.E.scenarioManager.scenarioUndoArgs(new ut.Nz(m))),s.E.game.party.manualScenarios.push(new ut.Ag(m.index,m.edition,m.group)),s.E.stateManager.after()),o=o.filter(k=>k.trim()!=g)):e.find(k=>k.index.substring(0,k.index.length-1)==g.trim()&&k.index.substring(k.index.length-1).match(/[A-B]/)&&k.group==i)&&(e.filter(k=>k.index.substring(0,k.index.length-1)==g.trim()&&k.index.substring(k.index.length-1).match(/[A-B]/)&&k.group==i).forEach(k=>{this.scenarios(i).find(X=>X.edition==k.edition&&X.group==k.group&&X.index==k.index)||(s.E.stateManager.before("addManualScenario",...s.E.scenarioManager.scenarioUndoArgs(new ut.Nz(k))),s.E.game.party.manualScenarios.push(new ut.Ag(k.index,k.edition,k.group)),s.E.stateManager.after())}),o=o.filter(k=>k.trim()!=g))}),0==o.length?(n.classList.remove("error"),n.value=""):n.value=o.join(","),this.scenarioCache=[]}hasSpoilers(n){return this.scenarios(n,!0).some(i=>i.spoiler&&(!i.solo&&!s.E.game.unlockedCharacters.includes(i.edition+":"+i.name)||i.solo&&!s.E.game.unlockedCharacters.includes(i.edition+":"+i.solo)))}notSpoiled(n){return this.scenarios(n,!0).filter(i=>i.spoiler&&(!s.E.game.unlockedCharacters.includes(i.edition+":"+i.name)||i.solo&&!s.E.game.unlockedCharacters.includes(i.edition+":"+i.solo))).map(i=>i.solo&&new Gc(i.solo)||new Gc(i.name))}toggleCampaignMode(){s.E.stateManager.before(s.E.game.party.campaignMode?"disablePartyCampaignMode":"enablePartyCampaignMode"),s.E.game.party.campaignMode=!s.E.game.party.campaignMode,this.scenarioCache=[],s.E.stateManager.after()}scenarioChart(n=void 0){this.dialog.open(ia,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:{edition:this.edition,group:n}}),this.close.emit()}static \u0275fac=function(i){return new(i||a)(t.rXU(O.lG),t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-scenario-menu"]],outputs:{close:"close"},standalone:!1,decls:26,vars:10,consts:[["search",""],["manualScenarioIndex",""],[1,"menu-container","scenario"],[1,"columns"],[1,"column","custom-container"],[1,"line","custom-check"],["tabclick","","type","checkbox",3,"change","checked"],[3,"ghs-label"],[1,"line"],[1,"column"],[1,"line","editions"],[1,"line","search"],["type","text",3,"ghs-label","ghs-label-attribute"],[3,"click","ghs-tooltip"],["src","./assets/images/chart.svg",1,"ghs-svg"],[1,"line","campaign"],["type","checkbox",3,"change","checked"],["type","text",3,"change","value","ghs-label","ghs-label-attribute"],["tabclick","",3,"click"],["tabclick","","type","radio","name","radio",3,"change","value","checked"],[1,"line","title","group"],[1,"line","scenarios"],["tabclick","",1,"scenario",3,"ngClass","ghs-tooltip","ghs-label-args"],["tabclick","",1,"scenario",3,"click","ngClass","ghs-tooltip","ghs-label-args"],[1,"complexity"],[1,"ghs-svg","solo",3,"src"],[1,"state","success"],[1,"state","blocked"],[1,"state","locked"],[1,"index"],["src","./assets/images/scenario/complexity-full.svg"],["src","./assets/images/scenario/complexity.svg"],["src","./assets/images/check.svg"],["src","./assets/images/close.svg"],[1,"line","title"],[1,"input-button"],["tabclick","","type","text",3,"keyup","keyup.enter","ghs-label","ghs-label-attribute"],["tabclick","",1,"add-button",3,"click","ghs-label","ghs-label-attribute","ngClass"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"label")(5,"input",6),t.bIt("change",function(){return c.eBV(o),c.Njj(e.customScenario())}),t.k0s(),t.EFF(6," <"),t.nrm(7,"span",7),t.EFF(8,"> "),t.k0s()(),t.nVh(9,BW,2,3,"div",8),t.k0s(),t.nVh(10,YW,6,1,"div",9),t.k0s(),t.j41(11,"div",10),t.Z7z(12,UW,3,3,"label",null,t.fX1),t.k0s(),t.j41(14,"div",11),t.nrm(15,"input",12,0),t.j41(17,"a",13),t.bIt("click",function(){return c.eBV(o),c.Njj(e.scenarioChart())}),t.nrm(18,"img",14),t.k0s()(),t.j41(19,"div",15),t.nVh(20,NW,3,2,"label"),t.j41(21,"label")(22,"input",16),t.bIt("change",function(){return c.eBV(o),c.Njj(e.toggleCampaignMode())}),t.k0s(),t.nrm(23,"span",7),t.k0s()(),t.Z7z(24,oZ,8,8,null,null,t.fX1),t.k0s()}2&i&&(t.R7$(5),t.Y8G("checked",!!e.gameManager.game.scenario&&e.gameManager.game.scenario.custom),t.R7$(2),t.Y8G("ghs-label","scenario.custom"),t.R7$(2),t.vxM(e.gameManager.game.scenario&&e.gameManager.game.scenario.custom?9:-1),t.R7$(),t.vxM(e.gameManager.game.scenario&&!e.gameManager.game.scenario.custom?10:-1),t.R7$(2),t.Dyx(e.editions),t.R7$(3),t.Y8G("ghs-label","scenario.filter")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-tooltip","scenario.chart"),t.R7$(3),t.vxM(e.gameManager.game.party.campaignMode?20:-1),t.R7$(2),t.Y8G("checked",e.gameManager.game.party.campaignMode),t.R7$(),t.Y8G("ghs-label","party.campaignMode"),t.R7$(),t.Dyx(e.groups))},dependencies:[N.YU,it,Mt,Ft,At,Xh,ct],styles:['[_nghost-%COMP%]{position:relative;z-index:9999}.hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:break-spaces}.back[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled[_ngcontent-%COMP%]{pointer-events:none}.back.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container[_ngcontent-%COMP%]{z-index:1}.menu-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.no-grow[_ngcontent-%COMP%]{flex-grow:0}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container.inline[_ngcontent-%COMP%]{width:initial;margin-right:1em}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex-wrap:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-gray)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{filter:grayscale(1)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm-delete[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]{align-items:flex-start}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]   .undo-text[_ngcontent-%COMP%]{display:flex;align-items:center}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.redo[_ngcontent-%COMP%]{align-items:flex-end}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]:hover{opacity:.7}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover{cursor:pointer}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog.disabled[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)!important}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]{border-bottom:none;margin-bottom:0}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container[_ngcontent-%COMP%]   .line.sticky.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container[_ngcontent-%COMP%]   .line.sticky.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .add[_ngcontent-%COMP%]{display:inherit}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%] ~ .spoiler[_ngcontent-%COMP%]{margin-top:0;border-top:none}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]{display:flex;cursor:pointer}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]   .span-xs[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns.columns-break[_ngcontent-%COMP%]{flex-wrap:wrap}}',".custom-container[_ngcontent-%COMP%]{display:flex}.custom-container[_ngcontent-%COMP%]   .custom-check[_ngcontent-%COMP%]{flex-basis:0}.editions[_ngcontent-%COMP%]{display:grid!important;grid-template-columns:1fr 1fr}.line.campaign[_ngcontent-%COMP%]{display:flex}.line.campaign[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.line.search[_ngcontent-%COMP%], .line.title.group[_ngcontent-%COMP%]{justify-content:space-between!important}.line.search[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%], .line.title.group[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}.line.search[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%], .line.title.group[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.scenarios[_ngcontent-%COMP%]{display:grid!important;grid-template-columns:repeat(6,1fr);column-gap:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));row-gap:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);border-radius:100%;border:calc(var(--ghs-unit) / 5) transparent solid}.scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-white) solid;color:var(--ghs-color-white)}.scenarios[_ngcontent-%COMP%]   .scenario.current[_ngcontent-%COMP%]{cursor:initial;border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;color:var(--ghs-color-disabled)}.scenarios[_ngcontent-%COMP%]   .scenario.blocked[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.scenarios[_ngcontent-%COMP%]   .scenario.blocked[_ngcontent-%COMP%]:hover{border-color:var(--ghs-color-darkred)}.scenarios[_ngcontent-%COMP%]   .scenario.locked[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.scenarios[_ngcontent-%COMP%]   .scenario.locked[_ngcontent-%COMP%]:hover{border-color:var(--ghs-color-yellow)}.scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   img.solo[_ngcontent-%COMP%]{filter:none}.scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;position:absolute;top:50%;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));transform:translateY(-50%)}.scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .state.success[_ngcontent-%COMP%]{left:0;filter:var(--ghs-filter-green) var(--ghs-filter-shadow)}.scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .state.blocked[_ngcontent-%COMP%]{right:0;filter:var(--ghs-filter-red) var(--ghs-filter-shadow)}.scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .state.locked[_ngcontent-%COMP%]{right:0;filter:var(--ghs-filter-yellow) var(--ghs-filter-shadow)}.scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .complexity[_ngcontent-%COMP%]{position:absolute;display:flex;justify-content:center;align-items:center;bottom:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor))}.scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .complexity[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));filter:var(--ghs-filter-gray)}.input-button[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}@media (max-width: 600px),(orientation: portrait){.editions[_ngcontent-%COMP%]{grid-template-columns:1fr}.scenarios[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}}"]})}return a})();const rZ=(a,r)=>({disabled:a,available:r}),cZ=a=>[a],lZ=(a,r)=>r._trackUUID;function gZ(a,r){if(1&a){const n=t.RV6();t.j41(0,"label")(1,"input",6),t.bIt("change",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.edition=e)}),t.k0s(),t.nrm(2,"span",4),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG();t.R7$(),t.Y8G("value",n)("checked",i.edition==n),t.R7$(),t.Y8G("ghs-label","data.edition."+n)}}function dZ(a,r){if(1&a&&(t.j41(0,"div",7),t.nrm(1,"label",4),t.k0s()),2&a){const n=t.XpG().$implicit;t.R7$(),t.Y8G("ghs-label","data.scenario.group."+n)}}function hZ(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function _Z(a,r){1&a&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function mZ(a,r){if(1&a){const n=t.RV6();t.j41(0,"span",10),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG(3);return c.Njj(o.addSection(e))}),t.nVh(1,hZ,2,0,"span"),t.nVh(2,_Z,2,0,"span"),t.EFF(3),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(3);t.Y8G("ngClass",t.l_i(6,rZ,n.isLocked,i.settingsManager.settings.showAllSections&&n.parent&&!!i.gameManager.game.scenario&&n.parent==i.gameManager.game.scenario.index&&n.group==i.gameManager.game.scenario.group&&n.edition==i.gameManager.game.scenario.edition))("ghs-tooltip","scenario.tooltip")("ghs-label-args",t.eq3(9,cZ,i.gameManager.scenarioManager.scenarioTitle(n,!0))),t.R7$(),t.vxM(i.maxSection()>2&&n.index.length<3?1:-1),t.R7$(),t.vxM(i.maxSection()>1&&n.index.length<2?2:-1),t.R7$(),t.SpI(" ",n.index," ")}}function pZ(a,r){if(1&a&&(t.j41(0,"div",8),t.Z7z(1,mZ,4,11,"span",9,lZ),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG();t.R7$(),t.Dyx(t.bMT(3,0,i.sections(n)))}}function uZ(a,r){if(1&a&&(t.nVh(0,dZ,2,1,"div",7),t.nVh(1,pZ,4,2,"div",8)),2&a){const n=r.$implicit,i=t.XpG();t.vxM(n&&i.sections(n).length>0?0:-1),t.R7$(),t.vxM(i.sections(n).length>0?1:-1)}}function fZ(a,r){1&a&&(t.j41(0,"div",5)(1,"label"),t.nrm(2,"span",4),t.k0s()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","monster.filter.noResult"))}let CZ=(()=>{class a{ghsManager;gameManager=s.E;settingsManager=p.f;GameState=D.mk;edition="";editions=[];sectionCache=[];constructor(n){this.ghsManager=n}ngOnInit(){this.edition=s.E.game.scenario&&!s.E.game.scenario.custom&&s.E.game.scenario.edition||!s.E.game.edition&&(!s.E.game.scenario||!s.E.game.scenario.custom)&&s.E.game.party.scenarios.length>0&&s.E.game.party.scenarios[s.E.game.party.scenarios.length-1].edition||s.E.currentEdition(),this.setEditions(),this.uiChangeSubscription=this.ghsManager.onUiChange().subscribe({next:()=>{this.setEditions(),this.sectionCache=[]}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}setEditions(){this.editions=s.E.game.edition?[s.E.game.edition,...s.E.editionExtensions(s.E.game.edition),...s.E.editionScenarioExtensions(s.E.game.edition)]:s.E.editionData.filter(n=>n.sections&&n.sections.filter(i=>i.edition==n.edition&&p.f.settings.editions.includes(i.edition)).length>0).map(n=>n.edition)}groups(){return this.edition?s.E.sectionData().filter(n=>n.edition==this.edition).map(n=>n.group).filter((n,i,e)=>e.indexOf(n)===i):[]}sections(n=void 0){if(!this.edition)return[];let i=this.sectionCache.find(e=>e.edition==this.edition&&e.group==n&&e.all==p.f.settings.showAllSections);return i||(i={edition:this.edition,group:n,all:p.f.settings.showAllSections,sections:[]},i.sections=s.E.sectionData().filter(e=>(p.f.settings.showAllSections||!e.parent&&(!s.E.game.scenario||s.E.game.scenario.custom)||s.E.game.scenario&&s.E.scenarioManager.availableSections(!1,!0).includes(e))&&e.edition==this.edition&&e.group==n&&!e.conclusion).sort(s.E.scenarioManager.sortScenarios).map(e=>new ut.jW(e,!1,!1,this.hasSection(e))),this.sectionCache.push(i)),i.sections}noResults(){return this.sectionCache.filter(n=>n.edition==this.edition).every(n=>0==n.sections.length)}maxSection(){return Math.max(...this.sections().map(n=>n.index.length))}hasSection(n){return s.E.game.sections&&s.E.game.sections.some(i=>i.edition==n.edition&&i.index==n.index&&i.group==n.group)}addSection(n){s.E.stateManager.before("addSection",n.index,s.E.scenarioManager.scenarioTitle(n,!0),"data.edition."+n.edition),s.E.scenarioManager.addSection(n),s.E.stateManager.after()}static \u0275fac=function(i){return new(i||a)(t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-section-menu"]],standalone:!1,decls:11,vars:3,consts:[[1,"menu-container","scenario"],[1,"line","editions"],[1,"line"],["tabclick","","type","checkbox",3,"change","checked"],[3,"ghs-label"],[1,"line","disabled"],["tabclick","","type","radio","name","radio",3,"change","value","checked"],[1,"line","title"],[1,"line","sections"],["tabclick","",1,"section",3,"ngClass","ghs-tooltip","ghs-label-args"],["tabclick","",1,"section",3,"click","ngClass","ghs-tooltip","ghs-label-args"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1),t.Z7z(2,gZ,3,3,"label",null,t.fX1),t.k0s(),t.j41(4,"div",2)(5,"label")(6,"input",3),t.bIt("change",function(){return e.settingsManager.toggle("showAllSections")}),t.k0s(),t.nrm(7,"span",4),t.k0s()(),t.Z7z(8,uZ,2,2,null,null,t.fX1),t.nVh(10,fZ,3,1,"div",5),t.k0s()),2&i&&(t.R7$(2),t.Dyx(e.editions),t.R7$(4),t.Y8G("checked",e.settingsManager.settings.showAllSections),t.R7$(),t.Y8G("ghs-label","scenario.showAllSections"),t.R7$(),t.Dyx(e.groups()),t.R7$(2),t.vxM(e.noResults()?10:-1))},dependencies:[N.YU,it,Mt,Ft,ct],styles:['[_nghost-%COMP%]{position:relative;z-index:9999}.hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:break-spaces}.back[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled[_ngcontent-%COMP%]{pointer-events:none}.back.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container[_ngcontent-%COMP%]{z-index:1}.menu-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.no-grow[_ngcontent-%COMP%]{flex-grow:0}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container.inline[_ngcontent-%COMP%]{width:initial;margin-right:1em}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex-wrap:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-gray)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{filter:grayscale(1)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm-delete[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]{align-items:flex-start}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]   .undo-text[_ngcontent-%COMP%]{display:flex;align-items:center}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.redo[_ngcontent-%COMP%]{align-items:flex-end}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]:hover{opacity:.7}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover{cursor:pointer}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog.disabled[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)!important}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]{border-bottom:none;margin-bottom:0}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container[_ngcontent-%COMP%]   .line.sticky.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container[_ngcontent-%COMP%]   .line.sticky.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .add[_ngcontent-%COMP%]{display:inherit}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%] ~ .spoiler[_ngcontent-%COMP%]{margin-top:0;border-top:none}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]{display:flex;cursor:pointer}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]   .span-xs[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns.columns-break[_ngcontent-%COMP%]{flex-wrap:wrap}}',".custom-container[_ngcontent-%COMP%]{display:flex}.custom-container[_ngcontent-%COMP%]   .custom-check[_ngcontent-%COMP%]{flex-basis:0}.editions[_ngcontent-%COMP%]{display:grid!important;grid-template-columns:1fr 1fr}.sections[_ngcontent-%COMP%]{display:grid!important;grid-template-columns:repeat(6,1fr);column-gap:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));row-gap:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);border-radius:100%}.sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-white) solid;color:var(--ghs-color-white)}.sections[_ngcontent-%COMP%]   .section.available[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) / 5) var(--ghs-color-disabled) solid}.sections[_ngcontent-%COMP%]   .section.disabled[_ngcontent-%COMP%]{pointer-events:none;border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;color:var(--ghs-color-disabled)}@media (max-width: 600px),(orientation: portrait){.editions[_ngcontent-%COMP%]{grid-template-columns:1fr}.sections[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}}"]})}return a})();var ai=v(3391);const Ro=a=>({hidden:a}),Sc=a=>({separator:a}),hn=a=>({disabled:a}),Dc=(a,r)=>[a,r],jo=(a,r)=>r._trackUUID;function MZ(a,r){1&a&&(t.j41(0,"p"),t.nrm(1,"span",9),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","server.connected"))}function vZ(a,r){1&a&&(t.j41(0,"p"),t.nrm(1,"span",9),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","server.connecting"))}function OZ(a,r){1&a&&(t.j41(0,"p"),t.nrm(1,"span",9),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","server.closing"))}function PZ(a,r){1&a&&(t.j41(0,"p"),t.nrm(1,"span",9),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","server.closed"))}function bZ(a,r){1&a&&(t.j41(0,"p"),t.nrm(1,"span",9),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","server.disconnected"))}function kZ(a,r){1&a&&(t.j41(0,"p"),t.nrm(1,"span",9),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","server.undefined"))}function yZ(a,r){if(1&a&&(t.j41(0,"option",28),t.EFF(1),t.k0s()),2&a){const n=r.$implicit,i=r.$index,e=t.XpG(2);t.Y8G("value",i)("selected",e.selectedServerIndex==i),t.R7$(),t.SpI(" ",n.url," ")}}function xZ(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",14)(1,"select",27),t.bIt("change",function(e){c.eBV(n);const o=t.XpG();return c.Njj(o.selectServer(e))}),t.j41(2,"option"),t.nrm(3,"span",9),t.k0s(),t.Z7z(4,yZ,2,3,"option",28,jo),t.nI1(6,"trackUUID"),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(3),t.Y8G("ghs-label","server.list."+(-1==n.selectedServerIndex?"select":"deselect")),t.R7$(),t.Dyx(t.bMT(6,1,n.publicServer))}}function EZ(a,r){if(1&a&&(t.j41(0,"label"),t.nrm(1,"span",9),t.k0s(),t.j41(2,"p")(3,"a",29),t.EFF(4),t.k0s()()),2&a){const n=r.$implicit;t.R7$(),t.Y8G("ghs-label","server.info."+n.key),t.R7$(2),t.Y8G("href",n.value,t.B4B),t.R7$(),t.JRh(n.value.replace("http://","").replace("https://",""))}}function wZ(a,r){1&a&&(t.j41(0,"span",31),t.nrm(1,"span",9),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","server.info.version.unknown"))}function RZ(a,r){1&a&&(t.j41(0,"span",32),t.nrm(1,"span",9),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","server.info.version.latest"))}function jZ(a,r){if(1&a&&(t.j41(0,"span",33),t.nrm(1,"span",34),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("ghs-label","server.info.version.update")("ghs-label-args",t.l_i(2,Dc,n.serverUpdateVersion.version,n.serverUpdateVersion.url))}}function GZ(a,r){if(1&a&&(t.j41(0,"label"),t.nrm(1,"span",9),t.k0s(),t.j41(2,"div",30)(3,"span"),t.EFF(4),t.k0s(),t.nVh(5,wZ,2,1,"span",31),t.nVh(6,RZ,2,1,"span",32),t.nVh(7,jZ,2,5,"span",33),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","server.info.version"),t.R7$(3),t.JRh(n.gameManager.stateManager.serverVersion),t.R7$(),t.vxM(n.serverUpdateVersion?-1:5),t.R7$(),t.vxM(n.serverUpdateVersion&&n.serverUpdateVersion.latest?6:-1),t.R7$(),t.vxM(n.serverUpdateVersion&&!n.serverUpdateVersion.latest?7:-1)}}function TZ(a,r){if(1&a&&(t.j41(0,"div",15)(1,"label"),t.nrm(2,"span",9),t.k0s(),t.j41(3,"p"),t.EFF(4),t.k0s(),t.j41(5,"label"),t.nrm(6,"span",9),t.k0s(),t.j41(7,"p"),t.EFF(8),t.k0s(),t.Z7z(9,EZ,5,3,null,null,t.fX1),t.nI1(11,"keyvalue"),t.j41(12,"label"),t.nrm(13,"span",9),t.k0s(),t.j41(14,"p"),t.EFF(15),t.k0s(),t.j41(16,"label"),t.nrm(17,"span",9),t.k0s(),t.j41(18,"p"),t.EFF(19),t.k0s(),t.nVh(20,GZ,8,5),t.k0s()),2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","server.url"),t.R7$(2),t.JRh(n.publicServer[n.selectedServerIndex].url),t.R7$(2),t.Y8G("ghs-label","server.port"),t.R7$(2),t.JRh(n.publicServer[n.selectedServerIndex].port),t.R7$(),t.Dyx(t.bMT(11,9,n.publicServer[n.selectedServerIndex].urls)),t.R7$(4),t.Y8G("ghs-label","server.info.description"),t.R7$(2),t.JRh(n.publicServer[n.selectedServerIndex].description),t.R7$(2),t.Y8G("ghs-label","server.info.location"),t.R7$(2),t.JRh(n.publicServer[n.selectedServerIndex].location),t.R7$(),t.vxM(n.gameManager.stateManager.serverVersion&&n.gameManager.stateManager.wsState()==n.WebSocket.OPEN?20:-1)}}function SZ(a,r){1&a&&(t.j41(0,"div",7)(1,"a",35),t.nrm(2,"span",9),t.k0s()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","server.how-to-run"))}function DZ(a,r){if(1&a){const n=t.RV6();t.j41(0,"a",36),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.createUUID())}),t.nrm(1,"span",9),t.k0s()}2&a&&(t.R7$(),t.Y8G("ghs-label","server.code.uuid"))}function $Z(a,r){if(1&a&&(t.j41(0,"div",5)(1,"div",7)(2,"a",29),t.nrm(3,"span",9),t.k0s()()()),2&a){const n=t.XpG(),i=t.sdS(30),e=t.sdS(35);t.R7$(2),t.Y8G("href",n.gameManager.stateManager.buildWsUrl("https://",i.value,e.value),t.B4B),t.R7$(),t.Y8G("ghs-label","server.wss.accept")}}function IZ(a,r){1&a&&(t.j41(0,"span",31),t.nrm(1,"span",9),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","server.info.version.unknown"))}function AZ(a,r){1&a&&(t.j41(0,"span",32),t.nrm(1,"span",9),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","server.info.version.latest"))}function VZ(a,r){if(1&a&&(t.j41(0,"span",33),t.nrm(1,"span",34),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ghs-label","server.info.version.update")("ghs-label-args",t.l_i(2,Dc,n.serverUpdateVersion.version,n.serverUpdateVersion.url))}}function FZ(a,r){if(1&a&&(t.j41(0,"div",15)(1,"label"),t.nrm(2,"span",9),t.k0s(),t.j41(3,"div",30)(4,"span"),t.EFF(5),t.k0s(),t.nVh(6,IZ,2,1,"span",31),t.nVh(7,AZ,2,1,"span",32),t.nVh(8,VZ,2,5,"span",33),t.k0s()()),2&a){const n=t.XpG();t.R7$(2),t.Y8G("ghs-label","server.info.version"),t.R7$(3),t.JRh(n.gameManager.stateManager.serverVersion),t.R7$(),t.vxM(n.serverUpdateVersion?-1:6),t.R7$(),t.vxM(n.serverUpdateVersion&&n.serverUpdateVersion.latest?7:-1),t.R7$(),t.vxM(n.serverUpdateVersion&&!n.serverUpdateVersion.latest?8:-1)}}function XZ(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",5)(1,"div",7)(2,"a",37),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.disconnect())}),t.nrm(3,"span",9),t.k0s()()()}2&a&&(t.R7$(3),t.Y8G("ghs-label","server.disconnect"))}function BZ(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",38)(1,"label"),t.nrm(2,"span",9),t.k0s()(),t.j41(3,"div",7)(4,"p"),t.nrm(5,"span",9),t.k0s()(),t.j41(6,"div",7)(7,"a",37),t.bIt("click",function(){c.eBV(n);const e=t.XpG();return c.Njj(e.createPermissions=!e.createPermissions)}),t.nrm(8,"span",9),t.k0s()()}2&a&&(t.R7$(2),t.Y8G("ghs-label","permissions"),t.R7$(3),t.Y8G("ghs-label","permissions.hasAll"),t.R7$(3),t.Y8G("ghs-label","permissions.create"))}function YZ(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",7)(1,"div",10)(2,"label")(3,"input",8),t.bIt("change",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.permissionsAll(e))}),t.k0s(),t.nrm(4,"span",9),t.k0s(),t.nrm(5,"img",11),t.j41(6,"span",12)(7,"span",39),t.nrm(8,"span",9),t.k0s()()()(),t.j41(9,"div",7)(10,"div",10)(11,"label")(12,"input",8),t.bIt("change",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.permissionsCustom(e))}),t.k0s(),t.nrm(13,"span",9),t.k0s(),t.nrm(14,"img",11),t.j41(15,"span",12)(16,"span",39),t.nrm(17,"span",9),t.k0s()()()()}if(2&a){const n=t.XpG(2);t.R7$(3),t.Y8G("checked",!n.permissions),t.R7$(),t.Y8G("ghs-label","permissions.all"),t.R7$(4),t.Y8G("ghs-label","permissions.all.hint"),t.R7$(4),t.Y8G("checked",n.permissions),t.R7$(),t.Y8G("ghs-label","permissions.custom"),t.R7$(4),t.Y8G("ghs-label","permissions.custom.hint")}}function UZ(a,r){if(1&a&&(t.j41(0,"span",44),t.EFF(1,"\xa0["),t.nrm(2,"span",9),t.EFF(3,"]"),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG(4);t.R7$(2),t.Y8G("ghs-label","data.edition."+i.gameManager.getEdition(n))}}function NZ(a,r){if(1&a){const n=t.RV6();t.j41(0,"label",40)(1,"input",8),t.bIt("change",function(){const e=c.eBV(n).$implicit,o=t.XpG(4);return c.Njj(o.toggleCharacter(e))}),t.k0s(),t.EFF(2),t.nVh(3,UZ,4,1,"span",44),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(4);t.Y8G("ngClass",t.eq3(4,hn,i.gameManager.stateManager.permissions)),t.R7$(),t.Y8G("checked",i.hasCharacter(n)),t.R7$(),t.SpI(" ",i.gameManager.characterManager.characterName(n,!0)," "),t.R7$(),t.vxM(i.gameManager.getEdition(n)?3:-1)}}function zZ(a,r){if(1&a&&(t.j41(0,"div",41),t.Z7z(1,NZ,4,6,"label",40,jo),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(3,0,n.characters()))}}function LZ(a,r){1&a&&(t.j41(0,"span",45),t.nrm(1,"span",9),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","game.ally"))}function qZ(a,r){1&a&&(t.j41(0,"span",46),t.nrm(1,"span",9),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","game.allied"))}function HZ(a,r){if(1&a&&(t.j41(0,"span",44),t.EFF(1,"\xa0["),t.nrm(2,"span",9),t.EFF(3,"]"),t.k0s()),2&a){const n=t.XpG().$implicit,i=t.XpG(4);t.R7$(2),t.Y8G("ghs-label","data.edition."+i.gameManager.getEdition(n))}}function KZ(a,r){if(1&a){const n=t.RV6();t.j41(0,"label",40)(1,"input",8),t.bIt("change",function(){const e=c.eBV(n).$implicit,o=t.XpG(4);return c.Njj(o.toggleMonster(e))}),t.k0s(),t.nrm(2,"span",9),t.nVh(3,LZ,2,1,"span",45),t.nVh(4,qZ,2,1,"span",46),t.nVh(5,HZ,4,1,"span",44),t.k0s()}if(2&a){const n=r.$implicit,i=t.XpG(4);t.Y8G("ngClass",t.eq3(6,hn,i.gameManager.stateManager.permissions)),t.R7$(),t.Y8G("checked",i.hasMonster(n)),t.R7$(),t.Y8G("ghs-label","data.monster."+n.name),t.R7$(),t.vxM(n.isAlly?3:-1),t.R7$(),t.vxM(n.isAllied?4:-1),t.R7$(),t.vxM(i.gameManager.getEdition(n)?5:-1)}}function WZ(a,r){if(1&a&&(t.j41(0,"div",43),t.Z7z(1,KZ,6,8,"label",40,jo),t.nI1(3,"trackUUID"),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Dyx(t.bMT(3,0,n.monsters()))}}function ZZ(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",19)(1,"div",10)(2,"label",40)(3,"input",8),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.permissions.characters=!e.permissions.characters)}),t.k0s(),t.nrm(4,"span",9),t.k0s(),t.nrm(5,"img",11),t.j41(6,"span",12)(7,"span",39),t.nrm(8,"span",9),t.k0s()()()(),t.nVh(9,zZ,4,2,"div",41),t.j41(10,"div",7)(11,"div",10)(12,"label",40)(13,"input",42),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.permissions.monsters=!e.permissions.monsters)}),t.k0s(),t.nrm(14,"span",9),t.k0s(),t.nrm(15,"img",11),t.j41(16,"span",12)(17,"span",39),t.nrm(18,"span",9),t.k0s()()()(),t.nVh(19,WZ,4,2,"div",43),t.j41(20,"div",7)(21,"div",10)(22,"label",40)(23,"input",8),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.permissions.scenario=!e.permissions.scenario)}),t.k0s(),t.nrm(24,"span",9),t.k0s(),t.nrm(25,"img",11),t.j41(26,"span",12)(27,"span",39),t.nrm(28,"span",9),t.k0s()()()(),t.j41(29,"div",7)(30,"div",10)(31,"label",40)(32,"input",8),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.permissions.party=!e.permissions.party)}),t.k0s(),t.nrm(33,"span",9),t.k0s(),t.nrm(34,"img",11),t.j41(35,"span",12)(36,"span",39),t.nrm(37,"span",9),t.k0s()()()(),t.j41(38,"div",7)(39,"div",10)(40,"label",40)(41,"input",8),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.permissions.elements=!e.permissions.elements)}),t.k0s(),t.nrm(42,"span",9),t.k0s(),t.nrm(43,"img",11),t.j41(44,"span",12)(45,"span",39),t.nrm(46,"span",9),t.k0s()()()(),t.j41(47,"div",7)(48,"div",10)(49,"label",40)(50,"input",8),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.permissions.round=!e.permissions.round)}),t.k0s(),t.nrm(51,"span",9),t.k0s(),t.nrm(52,"img",11),t.j41(53,"span",12)(54,"span",39),t.nrm(55,"span",9),t.k0s()()()(),t.j41(56,"div",7)(57,"div",10)(58,"label",40)(59,"input",8),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.permissions.level=!e.permissions.level)}),t.k0s(),t.nrm(60,"span",9),t.k0s(),t.nrm(61,"img",11),t.j41(62,"span",12)(63,"span",39),t.nrm(64,"span",9),t.k0s()()()(),t.j41(65,"div",7)(66,"div",10)(67,"label",40)(68,"input",8),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.permissions.attackModifiers=!e.permissions.attackModifiers)}),t.k0s(),t.nrm(69,"span",9),t.k0s(),t.nrm(70,"img",11),t.j41(71,"span",12)(72,"span",39),t.nrm(73,"span",9),t.k0s()()()(),t.j41(74,"div",7)(75,"div",10)(76,"label",40)(77,"input",8),t.bIt("change",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.permissions.lootDeck=!e.permissions.lootDeck)}),t.k0s(),t.nrm(78,"span",9),t.k0s(),t.nrm(79,"img",11),t.j41(80,"span",12)(81,"span",39),t.nrm(82,"span",9),t.k0s()()()()}if(2&a){const n=t.XpG(2);t.Y8G("ngClass",t.eq3(39,Sc,!n.gameManager.stateManager.permissions)),t.R7$(2),t.Y8G("ngClass",t.eq3(41,hn,n.gameManager.stateManager.permissions)),t.R7$(),t.Y8G("checked",n.permissions.characters),t.R7$(),t.Y8G("ghs-label","permissions.characters"),t.R7$(4),t.Y8G("ghs-label","permissions.characters.hint"),t.R7$(),t.vxM(n.permissions.characters?-1:9),t.R7$(3),t.Y8G("ngClass",t.eq3(43,hn,n.gameManager.stateManager.permissions)),t.R7$(),t.Y8G("checked",n.permissions.monsters),t.R7$(),t.Y8G("ghs-label","permissions.monsters"),t.R7$(4),t.Y8G("ghs-label","permissions.monsters.hint"),t.R7$(),t.vxM(n.permissions.monsters?-1:19),t.R7$(3),t.Y8G("ngClass",t.eq3(45,hn,n.gameManager.stateManager.permissions)),t.R7$(),t.Y8G("checked",n.permissions.scenario),t.R7$(),t.Y8G("ghs-label","permissions.scenario"),t.R7$(4),t.Y8G("ghs-label","permissions.scenario.hint"),t.R7$(3),t.Y8G("ngClass",t.eq3(47,hn,n.gameManager.stateManager.permissions)),t.R7$(),t.Y8G("checked",n.permissions.party),t.R7$(),t.Y8G("ghs-label","permissions.party"),t.R7$(4),t.Y8G("ghs-label","permissions.party.hint"),t.R7$(3),t.Y8G("ngClass",t.eq3(49,hn,n.gameManager.stateManager.permissions)),t.R7$(),t.Y8G("checked",n.permissions.elements),t.R7$(),t.Y8G("ghs-label","permissions.elements"),t.R7$(4),t.Y8G("ghs-label","permissions.elements.hint"),t.R7$(3),t.Y8G("ngClass",t.eq3(51,hn,n.gameManager.stateManager.permissions)),t.R7$(),t.Y8G("checked",n.permissions.round),t.R7$(),t.Y8G("ghs-label","permissions.round"),t.R7$(4),t.Y8G("ghs-label","permissions.round.hint"),t.R7$(3),t.Y8G("ngClass",t.eq3(53,hn,n.gameManager.stateManager.permissions)),t.R7$(),t.Y8G("checked",n.permissions.level),t.R7$(),t.Y8G("ghs-label","permissions.level"),t.R7$(4),t.Y8G("ghs-label","permissions.level.hint"),t.R7$(3),t.Y8G("ngClass",t.eq3(55,hn,n.gameManager.stateManager.permissions)),t.R7$(),t.Y8G("checked",n.permissions.attackModifiers),t.R7$(),t.Y8G("ghs-label","permissions.attackModifiers"),t.R7$(4),t.Y8G("ghs-label","permissions.attackModifiers.hint"),t.R7$(3),t.Y8G("ngClass",t.eq3(57,hn,n.gameManager.stateManager.permissions)),t.R7$(),t.Y8G("checked",n.permissions.lootDeck),t.R7$(),t.Y8G("ghs-label","permissions.lootDeck"),t.R7$(4),t.Y8G("ghs-label","permissions.lootDeck.hint")}}function JZ(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",7)(1,"label",17),t.nrm(2,"span",9),t.k0s(),t.j41(3,"input",47),t.bIt("keyup",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.setPermissionsCode(e))})("change",function(e){c.eBV(n);const o=t.XpG(2);return c.Njj(o.setPermissionsCode(e))}),t.k0s()(),t.j41(4,"div",7)(5,"a",26),t.bIt("click",function(){c.eBV(n);const e=t.XpG(2);return c.Njj(e.savePermissions())}),t.nrm(6,"span",9),t.k0s()()}if(2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","permissions.code"),t.R7$(),t.Y8G("value",n.code)("ghs-label","permissions.code")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ngClass",t.eq3(6,hn,!n.code)),t.R7$(),t.Y8G("ghs-label","permissions.save")}}function QZ(a,r){if(1&a&&(t.j41(0,"div",5)(1,"div",38)(2,"label"),t.nrm(3,"span",9),t.k0s()(),t.nVh(4,YZ,18,6),t.nVh(5,ZZ,83,59),t.nVh(6,JZ,7,8),t.k0s()),2&a){const n=t.XpG();t.R7$(3),t.Y8G("ghs-label",n.gameManager.stateManager.permissions?"permissions":"permissions.create"),t.R7$(),t.vxM(n.gameManager.stateManager.permissions?-1:4),t.R7$(),t.vxM(n.getPermissions()&&n.permissions?5:-1),t.R7$(),t.vxM(n.gameManager.stateManager.permissions?-1:6)}}let tJ=(()=>{class a{ghsManager;gameManager=s.E;settingsManager=p.f;tryConnect=!1;WebSocket=WebSocket;permissions=new ai.x;publicServer=[];selectedServerIndex=-1;code="";createPermissions=!1;serverUpdateVersion;constructor(n){this.ghsManager=n}ngOnInit(){var n=this;return(0,I.A)(function*(){try{yield fetch("./assets/server.json").then(i=>{if(!i.ok)throw Error();return i.json()}).then(i=>{n.publicServer=i})}catch{n.publicServer=[]}n.updateServer(),n.checkServerVersion(),n.uiChangeSubscription=n.ghsManager.onUiChange().subscribe({next:()=>{n.checkServerVersion()}})})()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}connect(n,i,e){n&&!isNaN(+i)&&e&&(p.f.setServer(n,+i,e),s.E.stateManager.connect(),this.tryConnect=!0)}getPermissions(){return s.E.stateManager.permissions&&(this.permissions=s.E.stateManager.permissions),this.permissions}createUUID(){p.f.settings.serverCode=(0,va.A)()}disconnect(){s.E.stateManager.disconnect(),this.permissions=s.E.stateManager.permissions}reconnect(){this.disconnect(),s.E.stateManager.connect(),this.tryConnect=!0}selectServer(n){if(this.selectedServerIndex=-1,!isNaN(+n.target.value)&&(s.E.stateManager.serverVersion="",this.selectedServerIndex=+n.target.value,this.selectedServerIndex>-1&&this.selectedServerIndex<this.publicServer.length)){const i=this.publicServer[this.selectedServerIndex];p.f.settings.serverUrl=i.url,p.f.settings.serverPort=i.port,p.f.settings.serverWss=i.secure}}updateServer(){this.selectedServerIndex=-1,this.publicServer.forEach((n,i)=>{p.f.settings.serverUrl!=n.url||p.f.settings.serverPort!=n.port||p.f.settings.serverWss!=n.secure||(this.selectedServerIndex=i)})}checkServerVersion(){var n=this;return(0,I.A)(function*(){n.serverUpdateVersion=void 0,s.E.stateManager.serverVersion&&(yield fetch("https://api.github.com/repos/lurkars/ghs-server/releases/latest").then(i=>{if(!i.ok)throw Error();return i.json()}).then(i=>{n.serverUpdateVersion={latest:i.tag_name==s.E.stateManager.serverVersion||i.tag_name=="v"+s.E.stateManager.serverVersion,version:i.tag_name,url:i.html_url}}))})()}setServerUrl(n){this.tryConnect=!1,p.f.settings.serverUrl=n.target.value,p.f.storeSettings(),this.updateServer()}setServerPort(n){this.tryConnect=!1,p.f.settings.serverPort=n.target.value,p.f.storeSettings(),this.updateServer()}setServerCode(n){this.tryConnect=!1,p.f.settings.serverCode=n.target.value,p.f.storeSettings(),this.updateServer()}permissionsAll(n){this.permissions=n.target.checked?void 0:new ai.x}permissionsCustom(n){this.permissions=n.target.checked?new ai.x:void 0}characters(){return s.E.game.figures.filter(n=>n instanceof H.K).map(n=>n)}hasCharacter(n){return null!=this.permissions&&this.permissions.character.some(i=>i.name==n.name&&i.edition==n.edition)}toggleCharacter(n){if(this.permissions){const i=this.permissions.character.find(e=>e.name==n.name&&e.edition==n.edition);i?this.permissions.character.splice(this.permissions.character.indexOf(i,1)):this.permissions.character.push(new yt.gw(n.name,n.edition))}}monsters(){return s.E.game.figures.filter(n=>n instanceof b.R).map(n=>n)}hasMonster(n){return null!=this.permissions&&this.permissions.monster.some(i=>i.name==n.name&&i.edition==n.edition)}toggleMonster(n){if(this.permissions){const i=this.permissions.monster.find(e=>e.name==n.name&&e.edition==n.edition);i?this.permissions.monster.splice(this.permissions.monster.indexOf(i,1)):this.permissions.monster.push(new yt.gw(n.name,n.edition))}}setPermissionsCode(n){this.code=n.target.value}savePermissions(){s.E.stateManager.savePermissions(this.code,this.permissions),this.code="",this.permissions=new ai.x}static \u0275fac=function(i){return new(i||a)(t.rXU(st))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-server-menu"]],standalone:!1,decls:65,vars:46,consts:[["serverFrom",""],["serverUrl",""],["serverPort",""],["serverCode",""],[1,"menu-container","two-column","server"],[1,"column"],[3,"ngSubmit"],[1,"line"],["tabclick","","type","checkbox",3,"change","checked"],[3,"ghs-label"],[1,"hint-container"],["src","./assets/images/hint.svg",1,"hint-trigger","ghs-svg"],[1,"hint"],[1,"text",3,"ghs-label"],[1,"line","separator"],[1,"server-info"],[1,"line","separator",3,"ngClass"],[1,"label"],["type","text",3,"keyup","change","value","ghs-label","ghs-label-attribute"],[1,"line",3,"ngClass"],["type","number",3,"keyup","change","value","ghs-label","ghs-label-attribute"],[1,"code-container"],[1,"spacer"],["type","text",3,"keyup","keydown.enter","change","value","ghs-label","ghs-label-attribute"],[1,"columns",3,"ngClass"],[1,"columns"],["tabclick","",3,"click","ngClass"],["tabclick","",3,"change"],[3,"value","selected"],["tabclick","","target","_blank",3,"href"],[1,"server-version"],[1,"unknown"],[1,"latest"],[1,"update"],[3,"ghs-label","ghs-label-args"],["href","https://github.com/Lurkars/ghs-server#how-to-run","target","_blank",1,"server-run"],[3,"click"],["tabclick","",3,"click"],[1,"line","title"],[1,"text"],[3,"ngClass"],[1,"line","characters"],["type","checkbox",3,"change","checked"],[1,"line","monsters"],[1,"edition"],[1,"ally"],[1,"allied"],["tabclick","","type","text",3,"keyup","change","value","ghs-label","ghs-label-attribute"]],template:function(i,e){if(1&i){const o=t.RV6();t.j41(0,"div",4)(1,"div",5)(2,"form",6,0),t.bIt("ngSubmit",function(){c.eBV(o);const m=t.sdS(30),k=t.sdS(35),X=t.sdS(45);return c.Njj(e.connect(m.value,k.value,X.value))}),t.j41(4,"div",7)(5,"label")(6,"input",8),t.bIt("change",function(){return c.eBV(o),c.Njj(e.settingsManager.toggle("serverAutoconnect"))}),t.k0s(),t.nrm(7,"span",9),t.k0s()(),t.j41(8,"div",7)(9,"label")(10,"div",10)(11,"input",8),t.bIt("change",function(){return c.eBV(o),c.Njj(e.settingsManager.setServerSettings(!e.settingsManager.settings.serverSettings))}),t.k0s(),t.nrm(12,"span",9)(13,"img",11),t.j41(14,"span",12),t.nrm(15,"span",13),t.k0s()()()(),t.j41(16,"div",7),t.nVh(17,MZ,2,1,"p")(18,vZ,2,1,"p")(19,OZ,2,1,"p")(20,PZ,2,1,"p")(21,bZ,2,1,"p")(22,kZ,2,1,"p"),t.k0s(),t.nVh(23,xZ,7,3,"div",14),t.nVh(24,TZ,21,11,"div",15),t.nVh(25,SZ,3,1,"div",7),t.j41(26,"div",16)(27,"label",17),t.nrm(28,"span",9),t.k0s(),t.j41(29,"input",18,1),t.bIt("keyup",function(){return c.eBV(o),c.Njj(0)})("change",function(m){return c.eBV(o),c.Njj(e.setServerUrl(m))}),t.k0s()(),t.j41(31,"div",19)(32,"label",17),t.nrm(33,"span",9),t.k0s(),t.j41(34,"input",20,2),t.bIt("keyup",function(){return c.eBV(o),c.Njj(0)})("change",function(m){return c.eBV(o),c.Njj(e.setServerPort(m))}),t.k0s()(),t.j41(36,"div",19)(37,"div",21)(38,"label",17),t.nrm(39,"span",9),t.k0s(),t.nrm(40,"span",22),t.nVh(41,DZ,2,1,"a"),t.k0s()(),t.j41(42,"div",7)(43,"div",10)(44,"input",23,3),t.bIt("keyup",function(){return c.eBV(o),c.Njj(0)})("keydown.enter",function(){c.eBV(o);const m=t.sdS(3);return c.Njj(m.submit())})("change",function(m){return c.eBV(o),c.Njj(e.setServerCode(m))}),t.k0s(),t.nrm(46,"img",11),t.j41(47,"span",12),t.nrm(48,"span",13),t.k0s()()(),t.j41(49,"div",24)(50,"div",5)(51,"div",7)(52,"label")(53,"input",8),t.bIt("change",function(){return c.eBV(o),e.settingsManager.toggle("serverWss"),c.Njj(e.updateServer())}),t.k0s(),t.nrm(54,"span",9),t.k0s()()(),t.nVh(55,$Z,4,2,"div",5),t.k0s(),t.nVh(56,FZ,9,5,"div",15),t.j41(57,"div",25)(58,"div",5)(59,"div",7)(60,"a",26),t.bIt("click",function(){return c.eBV(o),c.Njj(e.reconnect())}),t.nrm(61,"span",9),t.k0s()()(),t.nVh(62,XZ,4,1,"div",5),t.k0s()(),t.nVh(63,BZ,9,3),t.k0s(),t.nVh(64,QZ,7,4,"div",5),t.k0s()}if(2&i){let o;const g=t.sdS(30),m=t.sdS(35),k=t.sdS(45);t.R7$(6),t.Y8G("checked",e.settingsManager.settings.serverAutoconnect),t.R7$(),t.Y8G("ghs-label","server.autoconnect"),t.R7$(4),t.Y8G("checked",e.settingsManager.settings.serverSettings),t.R7$(),t.Y8G("ghs-label","server.settings"),t.R7$(3),t.Y8G("ghs-label","server.settings.hint"),t.R7$(2),t.vxM((o=e.gameManager.stateManager.wsState())===e.WebSocket.OPEN?17:o===e.WebSocket.CONNECTING?18:o===e.WebSocket.CLOSING?19:o===e.WebSocket.CLOSED?20:-1===o?21:22),t.R7$(6),t.vxM(e.publicServer?23:-1),t.R7$(),t.vxM(-1!=e.selectedServerIndex?24:-1),t.R7$(),t.vxM(-1!=e.selectedServerIndex||e.gameManager.stateManager.wsState()!=e.WebSocket.OPEN&&e.gameManager.stateManager.wsState()==e.WebSocket.CONNECTING?25:-1),t.R7$(),t.Y8G("ngClass",t.eq3(36,Ro,-1!=e.selectedServerIndex)),t.R7$(2),t.Y8G("ghs-label","server.url"),t.R7$(),t.Y8G("value",e.settingsManager.settings.serverUrl||"")("ghs-label","server.url")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ngClass",t.eq3(38,Ro,-1!=e.selectedServerIndex)),t.R7$(2),t.Y8G("ghs-label","server.port"),t.R7$(),t.Y8G("value",e.settingsManager.settings.serverPort||"")("ghs-label","server.port")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ngClass",t.eq3(40,Sc,-1!=e.selectedServerIndex)),t.R7$(3),t.Y8G("ghs-label","server.code"),t.R7$(2),t.vxM(e.settingsManager.settings.serverCode?-1:41),t.R7$(3),t.Y8G("value",e.settingsManager.settings.serverCode||"")("ghs-label","server.code")("ghs-label-attribute","placeholder"),t.R7$(4),t.Y8G("ghs-label","server.code.hint"),t.R7$(),t.Y8G("ngClass",t.eq3(42,Ro,-1!=e.selectedServerIndex)),t.R7$(4),t.Y8G("checked",e.settingsManager.settings.serverWss),t.R7$(),t.Y8G("ghs-label","server.wss"),t.R7$(),t.vxM(e.settingsManager.settings.serverWss&&g.value&&m.value&&k.value&&e.tryConnect&&e.gameManager.stateManager.wsState()!=e.WebSocket.OPEN?55:-1),t.R7$(),t.vxM(-1==e.selectedServerIndex&&e.gameManager.stateManager.serverVersion&&e.gameManager.stateManager.wsState()==e.WebSocket.OPEN?56:-1),t.R7$(4),t.Y8G("ngClass",t.eq3(44,hn,!g.value||!m.value||!k.value)),t.R7$(),t.Y8G("ghs-label",e.gameManager.stateManager.wsState()==e.WebSocket.OPEN?"server.reconnect":"server.connect"),t.R7$(),t.vxM(e.gameManager.stateManager.wsState()==e.WebSocket.OPEN?62:-1),t.R7$(),t.vxM(e.gameManager.stateManager.wsState()!=e.WebSocket.OPEN||e.gameManager.stateManager.permissions?-1:63),t.R7$(),t.vxM(e.createPermissions||e.gameManager.stateManager.permissions?64:-1)}},dependencies:[N.YU,E.qT,E.xH,E.y7,E.cb,E.cV,it,Ft,N.lG,ct],styles:['[_nghost-%COMP%]{position:relative;z-index:9999}.hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:break-spaces}.back[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled[_ngcontent-%COMP%]{pointer-events:none}.back.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container[_ngcontent-%COMP%]{z-index:1}.menu-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.no-grow[_ngcontent-%COMP%]{flex-grow:0}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container.inline[_ngcontent-%COMP%]{width:initial;margin-right:1em}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex-wrap:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-gray)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{filter:grayscale(1)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm-delete[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]{align-items:flex-start}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]   .undo-text[_ngcontent-%COMP%]{display:flex;align-items:center}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.redo[_ngcontent-%COMP%]{align-items:flex-end}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]:hover{opacity:.7}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover{cursor:pointer}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog.disabled[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)!important}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]{border-bottom:none;margin-bottom:0}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container[_ngcontent-%COMP%]   .line.sticky.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container[_ngcontent-%COMP%]   .line.sticky.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .add[_ngcontent-%COMP%]{display:inherit}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%] ~ .spoiler[_ngcontent-%COMP%]{margin-top:0;border-top:none}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]{display:flex;cursor:pointer}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]   .span-xs[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns.columns-break[_ngcontent-%COMP%]{flex-wrap:wrap}}',".server[_ngcontent-%COMP%]   .server-info[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;row-gap:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));column-gap:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.server[_ngcontent-%COMP%]   .server-info[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled);align-self:center;padding:0;margin:0;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.server[_ngcontent-%COMP%]   .server-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ghs-color-gray);align-self:center;padding:0;margin:0}.server[_ngcontent-%COMP%]   .server-info[_ngcontent-%COMP%]   .server-version[_ngcontent-%COMP%]{color:var(--ghs-color-gray);align-self:center;padding:0;margin:0;display:flex}.server[_ngcontent-%COMP%]   .server-info[_ngcontent-%COMP%]   .server-version[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.server[_ngcontent-%COMP%]   .server-info[_ngcontent-%COMP%]   .server-version[_ngcontent-%COMP%]   span.unknown[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));color:var(--ghs-color-darkgray)}.server[_ngcontent-%COMP%]   .server-info[_ngcontent-%COMP%]   .server-version[_ngcontent-%COMP%]   span.latest[_ngcontent-%COMP%]{color:var(--ghs-color-darkgreen)}.server[_ngcontent-%COMP%]   .server-info[_ngcontent-%COMP%]   .server-version[_ngcontent-%COMP%]   span.update[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.server[_ngcontent-%COMP%]   .server-info[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:underline;color:var(--ghs-color-gray);align-self:center;justify-self:center;padding:0;margin:0}.server[_ngcontent-%COMP%]   .server-info[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.server[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)!important;pointer-events:none}.server[_ngcontent-%COMP%]   .line.characters[_ngcontent-%COMP%], .server[_ngcontent-%COMP%]   .line.monsters[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));flex-direction:column;align-items:flex-start}.server[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .server-run[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.server[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .code-container[_ngcontent-%COMP%]{display:flex;width:100%}.server[_ngcontent-%COMP%]   .hidden[_ngcontent-%COMP%]{display:none!important}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:1 span}}"]})}return a})();var nJ=v(7579);const eJ=a=>({connected:a}),aJ=()=>["scenarioRooms"],iJ=()=>["partySheet"],Go=()=>["characterSheet"],oJ=()=>["scenarioRooms","treasures"],$c=()=>["characterItems"],sJ=()=>["characterIdentities"],To=()=>["battleGoals"],$e=()=>["standees"],rJ=()=>["standees","scenarioRooms"],Ic=a=>({disabled:a}),cJ=()=>["applyConditions"],Ac=()=>["lootDeck"],lJ=()=>["lootDeck","applyLoot","characterItems"],gJ=()=>["lootDeck","applyLoot"],dJ=()=>["characterItems","characterSheet"],hJ=()=>["amAdvantage"],_J=()=>["expireConditions","applyConditions"],mJ=()=>["scenarioRules"],Vc=()=>["events","partySheet"],pJ=()=>["!eventDraw"],So=()=>["characterSheet","characterAttackModifierDeck"],uJ=()=>["characterSheet","characterAttackModifierDeck","!characterAttackModifierDeckActiveBottom"],fJ=()=>["characterItems","characterItemsPermanent"],CJ=()=>["portraitMode"],ii=()=>["dragValues"],Fc=()=>["gameClock"],MJ=()=>["gameClock","automaticGameClock"],vJ=()=>["animations"],OJ=()=>["initiativeRequired"],PJ=()=>["columns"],bJ=()=>["default","fh","modern","bb"],Ie=()=>["abilities"],Xc=()=>["abilities","calculateStats"],kJ=()=>["abilities","interactiveAbilities"],yJ=()=>["abilities","!showExpandedAbilityCard"],Bc=()=>["stats"],xJ=()=>["standees","scenarioRooms","automaticStandees","!randomStandees"],EJ=a=>({immunity:a}),Do=a=>({right:a}),Yc=(a,r)=>({immunity:a,disabled:r}),wJ=()=>["amAdvantage","alwaysFhAdvantage"],RJ=()=>["fhChallenges"],jJ=()=>["fhTrials"],GJ=()=>["monsterAttackModifierDeck"],TJ=()=>["!initiativeRequired"],$o=(a,r)=>r._trackUUID;function SJ(a,r){if(1&a&&(t.j41(0,"div",4),t.nrm(1,"div",148)(2,"div",149)(3,"div",150)(4,"div",151)(5,"div",152)(6,"div",153)(7,"div",154)(8,"div",155),t.k0s(),t.j41(9,"div",4),t.nrm(10,"div",156)(11,"div",157)(12,"div",158)(13,"div",159)(14,"div",160)(15,"div",161)(16,"div",162)(17,"div",163),t.k0s()),2&a){const n=t.XpG();t.R7$(2),t.Y8G("requires",t.lJ4(13,Ie)),t.R7$(),t.Y8G("requires",t.lJ4(14,Ie)),t.R7$(),t.Y8G("requires",t.lJ4(15,Xc)),t.R7$(),t.Y8G("requires",t.lJ4(16,Xc)),t.R7$(),t.Y8G("requires",t.lJ4(17,Ie)),t.R7$(4),t.Y8G("requires",t.lJ4(18,Ie)),t.R7$(),t.Y8G("requires",t.lJ4(19,kJ)),t.R7$(),t.Y8G("requires",t.lJ4(20,Ie)),t.R7$(),t.Y8G("requires",t.lJ4(21,Ie)),t.R7$(),t.Y8G("requires",t.lJ4(22,yJ))("checked",n.settingsManager.settings.showExpandedAbilityCard),t.R7$(2),t.Y8G("requires",t.lJ4(23,Bc)),t.R7$(),t.Y8G("requires",t.lJ4(24,Bc))}}function DJ(a,r){1&a&&t.nrm(0,"div",36),2&a&&t.Y8G("requires",t.lJ4(1,$e))}function $J(a,r){1&a&&(t.j41(0,"div",4),t.nrm(1,"div",164)(2,"div",165)(3,"div",166)(4,"div",167),t.k0s()),2&a&&(t.R7$(),t.Y8G("requires",t.lJ4(3,xJ)),t.R7$(),t.Y8G("requires",t.lJ4(4,$e)),t.R7$(2),t.Y8G("requires",t.lJ4(5,$e)))}function IJ(a,r){1&a&&(t.j41(0,"span",170),t.EFF(1,"X"),t.k0s())}function AJ(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",45)(1,"div",168),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.toggleApplyConditionsExclude(e.name))}),t.nrm(2,"img",169),t.nVh(3,IJ,2,0,"span",170),t.k0s(),t.nrm(4,"img",171),t.j41(5,"span",172),t.nrm(6,"span",173),t.k0s()()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(5,EJ,e.settingsManager.settings.applyConditionsExcludes.includes(n.name))),t.R7$(),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+n.name+".svg",t.B4B),t.R7$(),t.vxM(n.types.includes(e.ConditionType.value)?3:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(7,Do,i>2)),t.R7$(),t.Y8G("ghs-label","settings.applyConditions.hint."+n.name)}}function VJ(a,r){1&a&&(t.j41(0,"span",170),t.EFF(1,"X"),t.k0s())}function FJ(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",45)(1,"div",168),t.bIt("click",function(){const e=c.eBV(n).$implicit,o=t.XpG();return c.Njj(o.toggleActiveApplyConditionsExclude(e.name))}),t.nrm(2,"img",169),t.nVh(3,VJ,2,0,"span",170),t.k0s(),t.nrm(4,"img",171),t.j41(5,"span",172),t.nrm(6,"span",173),t.k0s()()}if(2&a){const n=r.$implicit,i=r.$index,e=t.XpG();t.R7$(),t.Y8G("ngClass",t.l_i(5,Yc,e.settingsManager.settings.activeApplyConditionsExcludes.includes(n.name),!e.settingsManager.settings.applyConditions||!e.settingsManager.settings.activeApplyConditions)),t.R7$(),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+n.name+".svg",t.B4B),t.R7$(),t.vxM(n.types.includes(e.ConditionType.value)?3:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(8,Do,i>2)),t.R7$(),t.Y8G("ghs-label","settings.activeApplyConditions.hint."+n.name)}}function XJ(a,r){1&a&&(t.j41(0,"span",170),t.EFF(1,"X"),t.k0s())}function BJ(a,r){if(1&a){const n=t.RV6();t.j41(0,"div",45)(1,"div",168),t.bIt("click",function(){c.eBV(n);const e=t.XpG().$implicit,o=t.XpG(2);return c.Njj(o.toggleActiveApplyConditionsAuto(e.name))}),t.nrm(2,"img",169),t.nVh(3,XJ,2,0,"span",170),t.k0s(),t.nrm(4,"img",171),t.j41(5,"span",172),t.nrm(6,"span",173),t.k0s()()}if(2&a){const n=t.XpG(),i=n.$implicit,e=n.$index,o=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.l_i(5,Yc,!o.settingsManager.settings.activeApplyConditionsAuto.includes(i.name)||o.settingsManager.settings.activeApplyConditionsExcludes.includes(i.name),o.settingsManager.settings.activeApplyConditionsExcludes.includes(i.name))),t.R7$(),t.Y8G("src","./assets/images"+(o.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+i.name+".svg",t.B4B),t.R7$(),t.vxM(i.types.includes(o.ConditionType.value)?3:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(8,Do,e>2)),t.R7$(),t.Y8G("ghs-label","settings.activeApplyConditions.auto.hint."+i.name)}}function YJ(a,r){if(1&a&&t.nVh(0,BJ,7,10,"div",45),2&a){const n=r.$implicit,i=t.XpG(2);t.vxM(i.settingsManager.settings.activeApplyConditionsExcludes.includes(n.name)?-1:0)}}function UJ(a,r){if(1&a&&(t.j41(0,"div",4)(1,"div",43)(2,"div",174),t.nrm(3,"label",112)(4,"img",171),t.j41(5,"span",175),t.nrm(6,"span",173),t.k0s()(),t.j41(7,"div",44),t.Z7z(8,YJ,1,1,null,null,$o),t.nI1(10,"trackUUID"),t.k0s()()()),2&a){const n=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(5,Ic,!n.settingsManager.settings.applyConditions||!n.settingsManager.settings.activeApplyConditions)),t.R7$(2),t.Y8G("ghs-label","settings.activeApplyConditions.auto"),t.R7$(3),t.Y8G("ghs-label","settings.activeApplyConditions.auto.hint"),t.R7$(2),t.Dyx(t.bMT(10,3,n.activeApplyConditionsAuto))}}function NJ(a,r){if(1&a&&t.nrm(0,"div",58),2&a){const n=t.XpG();t.Y8G("disabled",!n.gameManager.fhRules())}}function zJ(a,r){if(1&a&&t.nrm(0,"div",59),2&a){const n=t.XpG();t.Y8G("disabled",!n.gameManager.fhRules())("labelSuffix",n.gameManager.trialsManager.favorsAvailable?"favors":"")}}function LJ(a,r){if(1&a&&t.nrm(0,"div",60),2&a){const n=t.XpG();t.Y8G("disabled",!n.gameManager.fhRules())}}function qJ(a,r){1&a&&t.nrm(0,"div",67),2&a&&t.Y8G("requires",t.lJ4(1,wJ))}function HJ(a,r){if(1&a&&t.nrm(0,"div",68),2&a){const n=t.XpG();t.Y8G("disabled",!n.gameManager.fhRules())("requires",t.lJ4(2,RJ))}}function KJ(a,r){if(1&a&&t.nrm(0,"div",69),2&a){const n=t.XpG();t.Y8G("disabled",!n.gameManager.fhRules()||!n.gameManager.trialsManager.trialsEnabled&&!n.gameManager.trialsManager.favorsEnabled)("requires",t.lJ4(3,jJ))("labelSuffix",n.gameManager.trialsManager.favorsAvailable?"favors":"")}}function WJ(a,r){if(1&a&&t.nrm(0,"div",71),2&a){const n=t.XpG();t.Y8G("disabled",n.settingsManager.settings.alwaysGh2eImbuement)}}function ZJ(a,r){1&a&&t.nrm(0,"div",73)}function JJ(a,r){1&a&&(t.nrm(0,"div",49)(1,"div",176),t.j41(2,"div",4),t.nrm(3,"div",177)(4,"div",178),t.k0s(),t.j41(5,"div",4),t.nrm(6,"div",179),t.k0s()),2&a&&(t.R7$(),t.Y8G("sync",!0),t.R7$(3),t.Y8G("requires",t.lJ4(3,GJ)),t.R7$(2),t.Y8G("requires",t.lJ4(4,$e)))}function QJ(a,r){1&a&&t.nrm(0,"div",76),2&a&&t.Y8G("requires",t.lJ4(1,TJ))}function tQ(a,r){1&a&&t.nrm(0,"div",131)}let nQ=(()=>{class a{platform;settingMenus;setMenu=new t.bkB;gameManager=s.E;settingsManager=p.f;storageManager=G.n;GameState=D.mk;SubMenu=In;wakeLock;applyConditionsExcludes=[];activeApplyConditionsAuto=[];activeApplyConditionsExcludes=[];WebSocket=WebSocket;ConditionType=Q.GV;filter="";constructor(n){this.platform=n,this.wakeLock="wakeLock"in navigator,Object.keys(Q.r5).forEach(i=>{const e=new Q.kW(i);(!s.E.game.edition||s.E.conditions(s.E.game.edition).map(o=>o.name).includes(e.name)||e.types.includes(Q.GV.hidden))&&((e.types.includes(Q.GV.turn)||e.types.includes(Q.GV.afterTurn)||e.types.includes(Q.GV.autoApply)&&!e.types.includes(Q.GV.apply))&&this.applyConditionsExcludes.push(e),e.types.includes(Q.GV.autoApply)&&this.activeApplyConditionsAuto.push(e),e.types.includes(Q.GV.apply)&&this.activeApplyConditionsExcludes.push(e))})}updateFilter(){this.settingMenus.forEach(n=>{this.filter?(0,F.oB)(n.setting,this.filter)||(0,F.oB)(p.f.getLabel("settings."+n.setting),this.filter)||(0,F.oB)(p.f.getLabel("settings."+n.setting+".hint"),this.filter)?n.elementRef.nativeElement.classList.remove("hidden"):n.elementRef.nativeElement.classList.add("hidden"):n.elementRef.nativeElement.classList.remove("hidden")})}doubleClick=null;toggleApplyConditionsExclude(n){let i=p.f.settings.applyConditionsExcludes.indexOf(n);-1==i?p.f.settings.applyConditionsExcludes.push(n):p.f.settings.applyConditionsExcludes.splice(i,1),p.f.storeSettings()}toggleActiveApplyConditionsAuto(n){let i=p.f.settings.activeApplyConditionsAuto.indexOf(n);-1==i?p.f.settings.activeApplyConditionsAuto.push(n):p.f.settings.activeApplyConditionsAuto.splice(i,1),p.f.storeSettings()}toggleActiveApplyConditionsExclude(n){let i=p.f.settings.activeApplyConditionsExcludes.indexOf(n);-1==i?p.f.settings.activeApplyConditionsExcludes.push(n):p.f.settings.activeApplyConditionsExcludes.splice(i,1),p.f.storeSettings()}zoomOut(n=!1){this.zoom(5,n)}zoomIn(n=!1){this.zoom(-5,n)}zoom(n,i){let e=+window.getComputedStyle(document.body).getPropertyValue("--ghs-factor");e+=n,this.setZoom(e,n,i)}setZoom(n,i,e){if(p.f.settings.zoom!=n){if(document.body.style.setProperty("--ghs-factor",n+""),!e){const o=+window.getComputedStyle(document.body).getPropertyValue("min-width").replace("px","");i<0&&o>=window.innerWidth&&(n-=i,document.body.style.setProperty("--ghs-factor",n+""))}p.f.setZoom(n)}}resetZoom(){this.setZoom(100,0,!0)}setTheme(n){p.f.set("theme",n.target.value)}helperDefaults(){p.f.settings.abilityNumbers=!1,p.f.settings.activeApplyConditions=!1,p.f.settings.activeStandees=!1,p.f.settings.activeSummons=!1,p.f.settings.applyConditions=!1,p.f.settings.applyLongRest=!1,p.f.settings.allyAttackModifierDeck=!1,p.f.settings.automaticUnlocking=!1,p.f.settings.automaticStandees=!1,p.f.settings.autoscroll=!1,p.f.settings.battleGoals=!1,p.f.settings.calculate=!0,p.f.settings.calculateStats=!1,p.f.settings.characterAttackModifierDeck=!1,p.f.settings.characterIdentities=!1,p.f.settings.characterItems=!1,p.f.settings.characterHandSize=!1,p.f.settings.characterSheet=!1,p.f.settings.disabledTurnConfirmation=!0,p.f.settings.disableStandees=!1,p.f.settings.dragValuesHp=!0,p.f.settings.dragValuesInitiative=!0,p.f.settings.dragValuesLoot=!0,p.f.settings.eliteFirst=!0,p.f.settings.expireConditions=!1,p.f.settings.fhStyle=!1,p.f.settings.hideAbsent=!1,p.f.settings.hideStats=!0,p.f.settings.hints=!0,p.f.settings.initiativeRequired=!0,p.f.settings.interactiveAbilities=!0,p.f.settings.lootDeck=!1,p.f.settings.moveElements=!0,p.f.settings.partySheet=!1,p.f.settings.randomStandees=!1,p.f.settings.scenarioRewards=!1,p.f.settings.scenarioRooms=!1,p.f.settings.scenarioRules=!1,p.f.settings.standees=!0,p.f.settings.standeeStats=!1,p.f.settings.treasures=!1,p.f.settings.treasuresLoot=!1,p.f.settings.turnConfirmation=!1,p.f.settings.theme="default",p.f.storeSettings()}xhaDefaults(){p.f.settings.abilityNumbers=!0,p.f.settings.activeApplyConditions=!1,p.f.settings.activeStandees=!1,p.f.settings.activeSummons=!1,p.f.settings.applyConditions=!1,p.f.settings.applyLongRest=!1,p.f.settings.allyAttackModifierDeck=!0,p.f.settings.automaticUnlocking=!1,p.f.settings.automaticStandees=!0,p.f.settings.automaticStandeesDialog=!0,p.f.settings.autoscroll=!0,p.f.settings.battleGoals=!1,p.f.settings.calculate=!0,p.f.settings.calculateStats=!0,p.f.settings.characterAttackModifierDeck=!1,p.f.settings.characterIdentities=!1,p.f.settings.characterItems=!1,p.f.settings.characterHandSize=!1,p.f.settings.characterSheet=!1,p.f.settings.disabledTurnConfirmation=!0,p.f.settings.disableStandees=!1,p.f.settings.dragValuesHp=!0,p.f.settings.dragValuesInitiative=!0,p.f.settings.dragValuesLoot=!0,p.f.settings.eliteFirst=!0,p.f.settings.expireConditions=!1,p.f.settings.fhStyle=!0,p.f.settings.hideAbsent=!1,p.f.settings.hideCharacterLoot=!0,p.f.settings.hideStats=!0,p.f.settings.hints=!0,p.f.settings.initiativeRequired=!0,p.f.settings.interactiveAbilities=!1,p.f.settings.lootDeck=!1,p.f.settings.moveElements=!0,p.f.settings.partySheet=!1,p.f.settings.randomStandees=!1,p.f.settings.scenarioRewards=!1,p.f.settings.scenarioRooms=!0,p.f.settings.scenarioRules=!0,p.f.settings.showFullAbilityCard=!0,p.f.settings.standees=!0,p.f.settings.standeeStats=!1,p.f.settings.statAnimations=!0,p.f.settings.treasures=!1,p.f.settings.treasuresLoot=!1,p.f.settings.turnConfirmation=!1,p.f.settings.theme="fh",p.f.storeSettings()}lurkarsDefaults(){p.f.settings.abilities=!0,p.f.settings.abilityNumbers=!0,p.f.settings.abilityReveal=!0,p.f.settings.activeApplyConditions=!0,p.f.settings.activeApplyConditionsExcludes=[Q.r5.shield,Q.r5.poison,Q.r5.poison_x],p.f.settings.activeStandees=!1,p.f.settings.activeSummons=!0,p.f.settings.addAllMonsters=!1,p.f.settings.allyAttackModifierDeck=!0,p.f.settings.alwaysAllyAttackModifierDeck=!1,p.f.settings.alwaysFhAdvantage=!0,p.f.settings.alwaysFhSolo=!1,p.f.settings.alwaysHazardousTerrain=!1,p.f.settings.alwaysLootApplyDialog=!1,p.f.settings.alwaysLootDeck=!1,p.f.settings.amAdvantage=!0,p.f.settings.amAdvantageHouseRule=!0,p.f.settings.animations=!0,p.f.settings.applyBuildingRewards=!0,p.f.settings.applyConditions=!0,p.f.settings.applyConditionsExcludes=[Q.r5.shield],p.f.settings.applyLongRest=!0,p.f.settings.applyLoot=!0,p.f.settings.applyLootRandomItem=!0,p.f.settings.applyRetirement=!0,p.f.settings.artwork=!0,p.f.settings.automaticAttackModifierFullscreen=!1,p.f.settings.automaticGameClock=!0,p.f.settings.automaticGameClockFocus=!1,p.f.settings.automaticPassTime=!0,p.f.settings.automaticStandees=!0,p.f.settings.automaticStandeesDialog=!1,p.f.settings.automaticTheme=!0,p.f.settings.automaticUnlocking=!0,p.f.settings.backupHint=!1,p.f.settings.battleGoals=!0,p.f.settings.battleGoalsCharacter=!1,p.f.settings.battleGoalsFh=!1,p.f.settings.battleGoalsReminder=!0,p.f.settings.calculate=!0,p.f.settings.calculateStats=!0,p.f.settings.calculateShieldStats=!1,p.f.settings.characterAttackModifierAnimate=!0,p.f.settings.characterAttackModifierDeck=!0,p.f.settings.characterAttackModifierDeckPermanent=!0,p.f.settings.characterAttackModifierDeckPermanentActive=!1,p.f.settings.characterCompact=!1,p.f.settings.characterHandSize=!0,p.f.settings.characterIdentities=!0,p.f.settings.characterIdentityHint=!0,p.f.settings.characterItems=!0,p.f.settings.characterItemsApply=!0,p.f.settings.characterItemsPermanent=!1,p.f.settings.characterSheet=!0,p.f.settings.characterSheetCompact=!1,p.f.settings.characterShieldRetaliate=!0,p.f.settings.characterTraits=!0,p.f.settings.columns=!0,p.f.settings.columnsForce=!0,p.f.settings.combineInteractiveAbilities=!1,p.f.settings.combineSummonAction=!0,p.f.settings.dragFigures=!0,p.f.settings.dragValuesHp=!0,p.f.settings.dragValuesInitiative=!0,p.f.settings.dragValuesLoot=!0,p.f.settings.drawRandomItem=!0,p.f.settings.drawRandomScenario=!0,p.f.settings.eliteFirst=!0,p.f.settings.errata=!0,p.f.settings.expireConditions=!0,p.f.settings.fhGhItems=!0,p.f.settings.fhStyle=!1,p.f.settings.hideCharacterHP=!1,p.f.settings.hideCharacterLoot=!1,p.f.settings.hideCharacterXP=!1,p.f.settings.hideStats=!1,p.f.settings.initiativeRequired=!0,p.f.settings.interactiveAbilities=!0,p.f.settings.lootDeck=!0,p.f.settings.portraitMode=!0,p.f.settings.monsters=!0,p.f.settings.monsterAttackModifierDeck=!0,p.f.settings.moveElements=!0,p.f.settings.partySheet=!0,p.f.settings.pinchZoom=!0,p.f.settings.pressDoubleClick=!0,p.f.settings.randomStandees=!0,p.f.settings.removeUnusedMonster=!0,p.f.settings.scenarioRewards=!0,p.f.settings.scenarioRooms=!0,p.f.settings.scenarioRules=!0,p.f.settings.showExpandedAbilityCard=!0,p.f.settings.showFullAbilityCard=!1,p.f.settings.sortFigures=!0,p.f.settings.standees=!0,p.f.settings.standeeStats=!0,p.f.settings.statAnimations=!1,p.f.settings.stats=!0,p.f.settings.summons=!0,p.f.settings.tooltips=!0,p.f.settings.treasures=!0,p.f.settings.treasuresLoot=!0,p.f.settings.turnConfirmation=!1,p.f.settings.unlockEnvelopeBuildings=!0}static \u0275fac=function(i){return new(i||a)(t.rXU(nJ.O))};static \u0275cmp=t.VBU({type:a,selectors:[["ghs-settings-menu"]],viewQuery:function(i,e){if(1&i&&t.GBs(fe,5),2&i){let o;t.mGM(o=t.lsd())&&(e.settingMenus=o)}},outputs:{setMenu:"setMenu"},standalone:!1,decls:208,vars:171,consts:[[1,"menu-container","two-column","settings",3,"ngClass"],[1,"line","hidden"],["type","text",3,"ngModelChange","change","keyup","ngModel","ghs-label","ghs-label-attribute"],["ghs-setting-title-menu","gameplay",1,"line","title","span",3,"sync"],[1,"column"],["ghs-setting-menu","scenarioRooms",1,"line"],["ghs-setting-menu","treasures",1,"line",3,"requires"],["ghs-setting-menu","scenarioRules",1,"line"],["ghs-setting-menu","battleGoals",1,"line"],["ghs-setting-menu","events",1,"line",3,"requires"],["ghs-setting-menu","partySheet",1,"line"],["ghs-setting-menu","characterSheet",1,"line"],["ghs-setting-menu","characterAttackModifierDeck",1,"line",3,"requires"],["ghs-setting-menu","characterItems",1,"line"],["ghs-setting-title-menu","character",1,"line","title","span",3,"sync"],["ghs-setting-menu","initiativeRequired",1,"line"],["ghs-setting-menu","hideAbsent",1,"line"],["ghs-setting-menu","treasuresLoot",1,"line",3,"requires"],["ghs-setting-menu","drawRandomItem",1,"line"],["ghs-setting-menu","drawRandomScenario",1,"line"],["ghs-setting-menu","applyLongRest",1,"line"],["ghs-setting-menu","applyRetirement",1,"line",3,"requires"],["ghs-setting-menu","characterItemsApply",1,"line",3,"requires"],["ghs-setting-menu","characterShieldRetaliate",1,"line"],["ghs-setting-menu","characterSortIndex",1,"line"],["ghs-setting-menu","activeSummons",1,"line"],["ghs-setting-menu","characterIdentities",1,"line"],["ghs-setting-menu","characterIdentityHint",1,"line",3,"requires"],["ghs-setting-menu","scenarioRewards",1,"line"],["ghs-setting-menu","battleGoalsReminder",1,"line",3,"requires"],["ghs-setting-menu","battleGoalsCharacter",1,"line",3,"requires"],["ghs-setting-menu","characterHandSize",1,"line"],["ghs-setting-menu","characterTraits",1,"line"],["ghs-setting-menu","scenarioStats",1,"line"],["ghs-setting-title-menu","monsters",1,"line","title","span",3,"sync"],["ghs-setting-title-menu","standees",1,"line","title","span",3,"sync"],["ghs-setting-menu","eliteFirst",1,"line",3,"requires"],["ghs-setting-menu","activeStandees",1,"line",3,"requires"],["ghs-setting-menu","automaticStandees",1,"line",3,"requires"],["ghs-setting-menu","standeeStats",1,"line",3,"requires"],["ghs-setting-title-menu","conditions",1,"line","title","span",3,"sync"],["ghs-setting-menu","expireConditions",1,"line"],["ghs-setting-menu","applyConditions",1,"line"],[1,"line",3,"ngClass"],[1,"condition-list"],[1,"hint-container"],["ghs-setting-menu","moveElements",1,"line"],["ghs-setting-menu","activeApplyConditions",1,"line",3,"requires"],[1,"line"],[1,"separator"],["ghs-setting-title-menu","fhRules",1,"line","title","span",3,"sync"],["ghs-setting-menu","applyLoot",1,"line",3,"requires"],["ghs-setting-menu","applyLootRandomItem",1,"line",3,"requires"],["ghs-setting-menu","alwaysLootApplyDialog",1,"line",3,"requires"],["ghs-setting-menu","automaticPassTime",1,"line",3,"disabled"],["ghs-setting-menu","applyBuildingRewards",1,"line",3,"disabled"],["ghs-setting-menu","unlockEnvelopeBuildings",1,"line",3,"disabled"],["ghs-setting-menu","fhGhItems",1,"line",3,"disabled","requiresOne"],["ghs-setting-menu","fhChallenges",1,"line",3,"disabled"],["ghs-setting-menu","fhTrials",1,"line",3,"disabled","labelSuffix"],["ghs-setting-menu","fhPets",1,"line",3,"disabled"],["ghs-setting-menu","alwaysLootDeck",1,"line",3,"disabled","requires","checked"],["ghs-setting-menu","battleGoalsFh",1,"line",3,"disabled","requires","checked"],["ghs-setting-menu","alwaysAllyAttackModifierDeck",1,"line",3,"disabled"],["ghs-setting-menu","alwaysHazardousTerrain",1,"line",3,"disabled","checked"],["ghs-setting-menu","alwaysFhSolo",1,"line",3,"disabled","checked"],["ghs-setting-menu","alwaysFhAdvantage",1,"line",3,"disabled","requires","checked"],["ghs-setting-menu","amAdvantageHouseRule",1,"line",3,"requires"],["ghs-setting-menu","fhChallengesApply",1,"line",3,"disabled","requires"],["ghs-setting-menu","fhTrialsApply",1,"line",3,"disabled","requires","labelSuffix"],["ghs-setting-title-menu","gh2eRules",1,"line","title","span",3,"sync"],["ghs-setting-menu","gh2eImbuement",1,"line",3,"disabled"],["ghs-setting-menu","alwaysGh2eImbuement",1,"line"],["ghs-setting-menu","gh2eImbuementKeep",1,"line"],["ghs-setting-title-menu","additional",1,"line","title","span",3,"sync"],["ghs-setting-menu","turnConfirmation",1,"line",3,"requiresOne"],["ghs-setting-menu","automaticFirstFigure",1,"line",3,"requires"],["ghs-setting-menu","scenarioRulesAutoapply",1,"line",3,"requires"],["ghs-setting-menu","automaticUnlocking",1,"line"],["ghs-setting-menu","summons",1,"line"],["ghs-setting-menu","eventsApply",1,"line",3,"requires"],["ghs-setting-menu","eventsDraw",1,"line",3,"requires"],["ghs-setting-menu","lootDeck",1,"line"],["ghs-setting-menu","allyAttackModifierDeck",1,"line"],["ghs-setting-menu","monsters",1,"line"],["ghs-setting-menu","monsterAttackModifierDeck",1,"line"],["ghs-setting-menu","amAdvantage",1,"line"],["ghs-setting-menu","damageHP",1,"line"],["ghs-setting-title-menu","interface",1,"line","title","span"],["ghs-setting-menu","fhStyle",1,"line"],["ghs-setting-menu","characterSheetCompact",1,"line",3,"requires"],["ghs-setting-menu","eventsDrawReminder",1,"line",3,"requires"],["ghs-setting-menu","damageHPToggle",1,"line"],["ghs-setting-menu","characterAttackModifierDeckActiveBottom",1,"line",3,"requires"],["ghs-setting-menu","characterAttackModifierDeckPermanent",1,"line",3,"requires","disabled"],["ghs-setting-menu","characterAttackModifierDeckPermanentActive",1,"line",3,"requires","disabled"],["ghs-setting-menu","characterItemsPermanent",1,"line",3,"requires"],["ghs-setting-menu","characterItemsPermanentActive",1,"line",3,"requires"],["ghs-setting-menu","characterAttackModifierAnimate",1,"line",3,"requires"],["ghs-setting-menu","automaticAttackModifierFullscreen",1,"line",3,"requires"],["ghs-setting-menu","pressDoubleClick",1,"line"],["ghs-setting-menu","dragFigures",1,"line"],["ghs-setting-menu","dragValues",1,"line"],["ghs-setting-menu","dragValuesHp",1,"line",3,"requires","hint"],["ghs-setting-menu","dragValuesInitiative",1,"line",3,"requires","hint"],["ghs-setting-menu","dragValuesLoot",1,"line",3,"requires","hint"],["ghs-setting-menu","dragValuesXp",1,"line",3,"requires","hint"],["ghs-setting-menu","gameClock",1,"line"],["ghs-setting-menu","gameClockMerge",1,"line",3,"requires"],["ghs-setting-menu","automaticGameClock",1,"line",3,"requires"],["ghs-setting-menu","automaticGameClockFocus",1,"line",3,"requires"],["ghs-pointer-input","",3,"singleClick","doubleClick"],[3,"ghs-label"],[3,"click"],["ghs-setting-menu","pinchZoom",1,"line"],["ghs-setting-menu","fullscreen",1,"line"],["ghs-setting-menu","autoscroll",1,"line"],["ghs-setting-menu","portraitMode",1,"line"],["ghs-setting-menu","animations",1,"line"],["ghs-setting-menu","statAnimations",1,"line"],["ghs-setting-menu","animationSpeed","type","range",1,"line",3,"min","max","requires"],["ghs-setting-menu","barsize","type","range",1,"line",3,"min","max"],["ghs-setting-menu","fontsize","type","range",1,"line",3,"min","max"],["ghs-setting-menu","hints",1,"line"],["ghs-setting-menu","tooltips",1,"line"],["ghs-setting-menu","backupHint",1,"line"],["ghs-setting-menu","initiativeRoundConfirm",1,"line",3,"requires"],["ghs-setting-menu","errata",1,"line"],["ghs-setting-menu","columns",1,"line"],["ghs-setting-menu","columnsForce",1,"line",3,"requires"],["ghs-setting-menu","artwork",1,"line"],["ghs-setting-menu","wakeLock",1,"line"],["ghs-setting-menu","maxUndo","type","number",1,"line",3,"min","max","hint","additionalHint"],["ghs-setting-menu","browserNavigation",1,"line",3,"disabled","hint"],["ghs-setting-title-menu","locale",1,"line","title",3,"sync"],["ghs-setting-menu","locale",3,"values"],["href","https://translate.gloomhaven-secretariat.de/","target","_blank",3,"ghs-tooltip","originY","overlayY"],["src","./assets/images/hint.svg",1,"ghs-svg"],["ghs-setting-title-menu","theme",1,"line","title"],["ghs-setting-menu","theme",3,"values"],["ghs-setting-menu","automaticTheme",1,"line"],["ghs-setting-menu","characterFullView",1,"line"],["ghs-setting-menu","characterCompact",1,"line",3,"disabled"],["ghs-setting-menu","playerNumber",1,"line"],["ghs-setting-menu","hideCharacterHP",1,"line"],["ghs-setting-menu","hideCharacterLoot",1,"line"],["ghs-setting-menu","hideCharacterXP",1,"line"],["tabclick","",3,"click"],["ghs-setting-menu","abilities",1,"line"],["ghs-setting-menu","calculate",1,"line",3,"requires"],["ghs-setting-menu","calculateStats",1,"line",3,"requires"],["ghs-setting-menu","calculateShieldStats",1,"line",3,"requires"],["ghs-setting-menu","calculateAdvantageStats",1,"line",3,"requires"],["ghs-setting-menu","abilityReveal",1,"line",3,"requires"],["ghs-setting-menu","removeUnusedMonster",1,"line"],["ghs-setting-menu","addAllMonsters",1,"line"],["ghs-setting-menu","interactiveAbilities",1,"line",3,"requires"],["ghs-setting-menu","combineInteractiveAbilities",1,"line",3,"requires"],["ghs-setting-menu","abilityNumbers",1,"line",3,"requires"],["ghs-setting-menu","showExpandedAbilityCard",1,"line",3,"requires"],["ghs-setting-menu","showFullAbilityCard",1,"line",3,"requires","checked"],["ghs-setting-menu","stats",1,"line"],["ghs-setting-menu","showExpandedStatCard",1,"line",3,"requires"],["ghs-setting-menu","hideStats",1,"line",3,"requires"],["ghs-setting-menu","automaticStandeesDialog",1,"line",3,"requires"],["ghs-setting-menu","randomStandees",1,"line",3,"requires"],["ghs-setting-menu","standees",1,"line"],["ghs-setting-menu","standeeShieldRetaliate",1,"line",3,"requires"],["tabclick","",1,"condition",3,"click","ngClass"],[3,"src"],[1,"value"],["src","./assets/images/hint.svg",1,"hint-trigger","ghs-svg"],[1,"hint",3,"ngClass"],[1,"text",3,"ghs-label"],[1,"hint-container","inline"],[1,"hint"],["ghs-setting-title-menu","bbRules",1,"line","title","span",3,"sync"],["ghs-setting-menu","bbChars",1,"line"],["ghs-setting-menu","bbAm",1,"line",3,"requires"],["ghs-setting-menu","bbStandeeLimit",1,"line",3,"requires"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"input",2),t.mxI("ngModelChange",function(g){return t.DH7(e.filter,g)||(e.filter=g),g}),t.bIt("change",function(){return e.updateFilter()})("keyup",function(){return e.updateFilter()}),t.k0s()(),t.nrm(3,"div",3),t.j41(4,"div",4),t.nrm(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),t.k0s(),t.j41(10,"div",4),t.nrm(11,"div",10)(12,"div",11)(13,"div",12)(14,"div",13),t.k0s(),t.nrm(15,"div",14),t.j41(16,"div",4),t.nrm(17,"div",15)(18,"div",16)(19,"div",17)(20,"div",18)(21,"div",19)(22,"div",20)(23,"div",21)(24,"div",22)(25,"div",23)(26,"div",24),t.k0s(),t.j41(27,"div",4),t.nrm(28,"div",25)(29,"div",26)(30,"div",27)(31,"div",28)(32,"div",29)(33,"div",30)(34,"div",31)(35,"div",32)(36,"div",33),t.k0s(),t.nrm(37,"div",34),t.nVh(38,SJ,18,25),t.nrm(39,"div",35),t.j41(40,"div",4),t.nVh(41,DJ,1,2,"div",36),t.nrm(42,"div",37)(43,"div",38)(44,"div",39),t.k0s(),t.nVh(45,$J,5,6,"div",4),t.nrm(46,"div",40),t.j41(47,"div",4),t.nrm(48,"div",41)(49,"div",42),t.j41(50,"div",4)(51,"div",43)(52,"div",44),t.Z7z(53,AJ,7,9,"div",45,$o),t.nI1(55,"trackUUID"),t.k0s()()()(),t.j41(56,"div",4),t.nrm(57,"div",46)(58,"div",47),t.j41(59,"div",4)(60,"div",48)(61,"div",44),t.Z7z(62,FJ,7,10,"div",45,$o),t.nI1(64,"trackUUID"),t.k0s()()(),t.nVh(65,UJ,11,7,"div",4),t.k0s(),t.nrm(66,"div",49)(67,"div",50),t.j41(68,"div",4),t.nrm(69,"div",51)(70,"div",52)(71,"div",53)(72,"div",54)(73,"div",55)(74,"div",56)(75,"div",57),t.nVh(76,NJ,1,1,"div",58),t.nVh(77,zJ,1,2,"div",59),t.nVh(78,LJ,1,1,"div",60),t.k0s(),t.j41(79,"div",4),t.nrm(80,"div",61)(81,"div",62)(82,"div",63)(83,"div",64)(84,"div",65)(85,"div",66),t.nVh(86,qJ,1,2,"div",67),t.nVh(87,HJ,1,3,"div",68),t.nVh(88,KJ,1,4,"div",69),t.k0s(),t.nrm(89,"div",49)(90,"div",70),t.j41(91,"div",4),t.nVh(92,WJ,1,1,"div",71),t.nrm(93,"div",72),t.k0s(),t.j41(94,"div",4),t.nVh(95,ZJ,1,0,"div",73),t.k0s(),t.nVh(96,JJ,7,5),t.nrm(97,"div",49)(98,"div",74),t.j41(99,"div",4),t.nrm(100,"div",75),t.nVh(101,QJ,1,2,"div",76),t.nrm(102,"div",77)(103,"div",78)(104,"div",79)(105,"div",80)(106,"div",81),t.k0s(),t.j41(107,"div",4),t.nrm(108,"div",82)(109,"div",83)(110,"div",84)(111,"div",85)(112,"div",86)(113,"div",87),t.k0s(),t.nrm(114,"div",88),t.j41(115,"div",4),t.nrm(116,"div",89)(117,"div",90)(118,"div",91)(119,"div",92)(120,"div",93)(121,"div",94)(122,"div",95)(123,"div",96)(124,"div",97)(125,"div",98),t.k0s(),t.j41(126,"div",4),t.nrm(127,"div",99)(128,"div",100)(129,"div",101)(130,"div",102)(131,"div",103)(132,"div",104)(133,"div",105)(134,"div",106),t.k0s(),t.nrm(135,"div",49),t.j41(136,"div",4),t.nrm(137,"div",107)(138,"div",108),t.k0s(),t.j41(139,"div",4),t.nrm(140,"div",109)(141,"div",110),t.k0s(),t.nrm(142,"div",49),t.j41(143,"div",4)(144,"div",48)(145,"a",111),t.bIt("singleClick",function(){return e.zoomOut()})("doubleClick",function(){return e.zoomOut(!0)}),t.nrm(146,"span",112),t.k0s()(),t.j41(147,"div",48)(148,"a",111),t.bIt("singleClick",function(){return e.zoomIn()})("doubleClick",function(){return e.zoomIn(!0)}),t.nrm(149,"span",112),t.k0s()(),t.j41(150,"div",48)(151,"a",113),t.bIt("click",function(){return e.resetZoom()}),t.nrm(152,"span",112),t.k0s()(),t.nrm(153,"div",114)(154,"div",115)(155,"div",116)(156,"div",117)(157,"div",118)(158,"div",119)(159,"div",120)(160,"div",121)(161,"div",122),t.k0s(),t.j41(162,"div",4),t.nrm(163,"div",123)(164,"div",124)(165,"div",125)(166,"div",126)(167,"div",127)(168,"div",128)(169,"div",129)(170,"div",130),t.nVh(171,tQ,1,0,"div",131),t.k0s(),t.nrm(172,"div",49)(173,"div",132)(174,"div",133),t.j41(175,"div",4),t.nrm(176,"div",134)(177,"div",135),t.j41(178,"div",48)(179,"a",136),t.nrm(180,"img",137),t.EFF(181,"\xa0 "),t.nrm(182,"span",112),t.k0s()()(),t.j41(183,"div",4),t.nrm(184,"div",138)(185,"div",139)(186,"div",49)(187,"div",140)(188,"div",141)(189,"div",142)(190,"div",143)(191,"div",144)(192,"div",145)(193,"div",146),t.k0s(),t.nrm(194,"div",49),t.j41(195,"div",48)(196,"a",147),t.bIt("click",function(){return e.helperDefaults()}),t.nrm(197,"span",112),t.k0s()(),t.j41(198,"div",48)(199,"a",147),t.bIt("click",function(){return e.lurkarsDefaults()}),t.nrm(200,"span",112),t.k0s()(),t.j41(201,"div",48)(202,"a",147),t.bIt("click",function(){return e.xhaDefaults()}),t.nrm(203,"span",112),t.k0s()(),t.nrm(204,"div",49),t.j41(205,"div",48)(206,"a",147),t.bIt("click",function(){return e.setMenu.emit(e.SubMenu.debug)}),t.nrm(207,"span",112),t.k0s()()()),2&i&&(t.Y8G("ngClass",t.eq3(123,eJ,e.gameManager.stateManager.wsState()==e.WebSocket.OPEN)),t.R7$(2),t.R50("ngModel",e.filter),t.Y8G("ghs-label","settings.filter")("ghs-label-attribute","placeholder"),t.R7$(),t.Y8G("sync",!0),t.R7$(3),t.Y8G("requires",t.lJ4(125,aJ)),t.R7$(3),t.Y8G("requires",t.lJ4(126,iJ)),t.R7$(4),t.Y8G("requires",t.lJ4(127,Go)),t.R7$(2),t.Y8G("sync",!0),t.R7$(4),t.Y8G("requires",t.lJ4(128,oJ)),t.R7$(4),t.Y8G("requires",t.lJ4(129,Go)),t.R7$(),t.Y8G("requires",t.lJ4(130,$c)),t.R7$(6),t.Y8G("requires",t.lJ4(131,sJ)),t.R7$(2),t.Y8G("requires",t.lJ4(132,To)),t.R7$(),t.Y8G("requires",t.lJ4(133,To)),t.R7$(4),t.Y8G("sync",!0),t.R7$(),t.vxM(e.settingsManager.settings.monsters?38:-1),t.R7$(),t.Y8G("sync",!0),t.R7$(2),t.vxM(e.settingsManager.settings.monsters?41:-1),t.R7$(),t.Y8G("requires",t.lJ4(134,$e)),t.R7$(),t.Y8G("requires",t.lJ4(135,rJ)),t.R7$(),t.Y8G("requires",t.lJ4(136,$e)),t.R7$(),t.vxM(e.settingsManager.settings.monsters?45:-1),t.R7$(),t.Y8G("sync",!0),t.R7$(5),t.Y8G("ngClass",t.eq3(137,Ic,!e.settingsManager.settings.applyConditions)),t.R7$(2),t.Dyx(t.bMT(55,119,e.applyConditionsExcludes)),t.R7$(5),t.Y8G("requires",t.lJ4(139,cJ)),t.R7$(4),t.Dyx(t.bMT(64,121,e.activeApplyConditionsExcludes)),t.R7$(3),t.vxM(e.settingsManager.settings.applyConditions&&e.settingsManager.settings.activeApplyConditions?65:-1),t.R7$(2),t.Y8G("sync",!0),t.R7$(2),t.Y8G("requires",t.lJ4(140,Ac)),t.R7$(),t.Y8G("requires",t.lJ4(141,lJ)),t.R7$(),t.Y8G("requires",t.lJ4(142,gJ)),t.R7$(),t.Y8G("disabled",!e.gameManager.fhRules()),t.R7$(),t.Y8G("disabled",!e.gameManager.fhRules()),t.R7$(),t.Y8G("disabled",!e.gameManager.fhRules()),t.R7$(),t.Y8G("disabled",!e.gameManager.fhRules())("requiresOne",t.lJ4(143,dJ)),t.R7$(),t.vxM(e.gameManager.challengesManager.available?76:-1),t.R7$(),t.vxM(e.gameManager.trialsManager.available?77:-1),t.R7$(),t.vxM(e.gameManager.buildingsManager.petsAvailable?78:-1),t.R7$(2),t.Y8G("disabled",e.gameManager.fhRules())("requires",t.lJ4(144,Ac))("checked",e.settingsManager.settings.lootDeck&&e.gameManager.fhRules()),t.R7$(),t.Y8G("disabled",e.gameManager.fhRules())("requires",t.lJ4(145,To))("checked",e.settingsManager.settings.battleGoals&&e.gameManager.fhRules()),t.R7$(),t.Y8G("disabled",!e.settingsManager.settings.allyAttackModifierDeck),t.R7$(),t.Y8G("disabled",e.gameManager.fhRules())("checked",e.gameManager.fhRules()),t.R7$(),t.Y8G("disabled",e.gameManager.fhRules())("checked",e.gameManager.fhRules()),t.R7$(),t.Y8G("disabled",e.gameManager.fhRules())("requires",t.lJ4(146,hJ))("checked",e.settingsManager.settings.amAdvantage&&e.gameManager.fhRules()),t.R7$(),t.vxM(e.settingsManager.settings.amAdvantage?86:-1),t.R7$(),t.vxM(e.gameManager.challengesManager.available?87:-1),t.R7$(),t.vxM(e.gameManager.trialsManager.available?88:-1),t.R7$(2),t.Y8G("sync",!0),t.R7$(2),t.vxM(!e.settingsManager.settings.alwaysGh2eImbuement&&e.gameManager.gh2eRules()&&e.gameManager.imbuementManager.available?92:-1),t.R7$(3),t.vxM(e.settingsManager.settings.alwaysGh2eImbuement||e.gameManager.gh2eRules()&&e.gameManager.imbuementManager.available?95:-1),t.R7$(),t.vxM(e.gameManager.bbRules()?96:-1),t.R7$(2),t.Y8G("sync",!0),t.R7$(2),t.Y8G("requiresOne",t.lJ4(147,_J)),t.R7$(),t.vxM(e.settingsManager.settings.initiativeRequired?-1:101),t.R7$(),t.Y8G("requires",t.lJ4(148,mJ)),t.R7$(3),t.Y8G("requires",t.lJ4(149,Vc)),t.R7$(),t.Y8G("requires",t.lJ4(150,Vc)),t.R7$(11),t.Y8G("requires",t.lJ4(151,Go)),t.R7$(),t.Y8G("requires",t.lJ4(152,pJ)),t.R7$(2),t.Y8G("requires",t.lJ4(153,So)),t.R7$(),t.Y8G("requires",t.lJ4(154,uJ))("disabled",e.settingsManager.settings.characterAttackModifierDeckActiveBottom),t.R7$(),t.Y8G("requires",t.lJ4(155,So))("disabled",!e.settingsManager.settings.characterAttackModifierDeckPermanent&&!e.settingsManager.settings.characterAttackModifierDeckActiveBottom),t.R7$(),t.Y8G("requires",t.lJ4(156,$c)),t.R7$(),t.Y8G("requires",t.lJ4(157,fJ)),t.R7$(),t.Y8G("requires",t.lJ4(158,So)),t.R7$(2),t.Y8G("requires",t.lJ4(159,CJ)),t.R7$(4),t.Y8G("requires",t.lJ4(160,ii))("hint",!1),t.R7$(),t.Y8G("requires",t.lJ4(161,ii))("hint",!1),t.R7$(),t.Y8G("requires",t.lJ4(162,ii))("hint",!1),t.R7$(),t.Y8G("requires",t.lJ4(163,ii))("hint",!1),t.R7$(4),t.Y8G("requires",t.lJ4(164,Fc)),t.R7$(2),t.Y8G("requires",t.lJ4(165,Fc)),t.R7$(),t.Y8G("requires",t.lJ4(166,MJ)),t.R7$(5),t.Y8G("ghs-label","settings.zoom.out"),t.R7$(3),t.Y8G("ghs-label","settings.zoom.in"),t.R7$(3),t.Y8G("ghs-label","settings.zoom.reset"),t.R7$(7),t.Y8G("min",.3)("max",2)("requires",t.lJ4(167,vJ)),t.R7$(),t.Y8G("min",.1)("max",2),t.R7$(),t.Y8G("min",.1)("max",2),t.R7$(5),t.Y8G("requires",t.lJ4(168,OJ)),t.R7$(3),t.Y8G("requires",t.lJ4(169,PJ)),t.R7$(2),t.vxM(e.wakeLock?171:-1),t.R7$(2),t.Y8G("min",0)("max",e.storageManager.db?"":50)("hint",!e.storageManager.db)("additionalHint",e.platform.FIREFOX?"settings.maxUndo.hint.firefox":""),t.R7$(),t.Y8G("disabled",!0)("hint",!1),t.R7$(2),t.Y8G("sync",!0),t.R7$(),t.Y8G("values",e.settingsManager.locales),t.R7$(2),t.Y8G("ghs-tooltip","settings.locale.help.hint")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("ghs-label","settings.locale.help"),t.R7$(3),t.Y8G("values",t.lJ4(170,bJ)),t.R7$(4),t.Y8G("disabled","modern"==e.settingsManager.settings.theme),t.R7$(8),t.Y8G("ghs-label","settings.helperDefaults"),t.R7$(3),t.Y8G("ghs-label","settings.lurkarsDefaults"),t.R7$(3),t.Y8G("ghs-label","settings.xhaDefaults"),t.R7$(4),t.Y8G("ghs-label","settings.debug"))},dependencies:[N.YU,E.me,E.BC,E.vS,it,Mt,dt,fe,fd,Ft,ct],styles:['[_nghost-%COMP%]{position:relative;z-index:9999}.hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:break-spaces}.back[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled[_ngcontent-%COMP%]{pointer-events:none}.back.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container[_ngcontent-%COMP%]{z-index:1}.menu-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.no-grow[_ngcontent-%COMP%]{flex-grow:0}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container.inline[_ngcontent-%COMP%]{width:initial;margin-right:1em}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex-wrap:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-gray)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{filter:grayscale(1)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm-delete[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]{align-items:flex-start}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]   .undo-text[_ngcontent-%COMP%]{display:flex;align-items:center}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.redo[_ngcontent-%COMP%]{align-items:flex-end}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]:hover{opacity:.7}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover{cursor:pointer}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog.disabled[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)!important}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]{border-bottom:none;margin-bottom:0}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container[_ngcontent-%COMP%]   .line.sticky.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container[_ngcontent-%COMP%]   .line.sticky.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .add[_ngcontent-%COMP%]{display:inherit}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%] ~ .spoiler[_ngcontent-%COMP%]{margin-top:0;border-top:none}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]{display:flex;cursor:pointer}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]   .span-xs[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns.columns-break[_ngcontent-%COMP%]{flex-wrap:wrap}}',"@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:1 span}}.line[_ngcontent-%COMP%]   .condition-list[_ngcontent-%COMP%]{display:flex;align-items:center}.line[_ngcontent-%COMP%]   .condition-list[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.line[_ngcontent-%COMP%]   .condition-list[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{cursor:pointer;width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));position:relative;display:flex}.line[_ngcontent-%COMP%]   .condition-list[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   .condition.immunity[_ngcontent-%COMP%]{opacity:.7;filter:grayscale(.3)}.line[_ngcontent-%COMP%]   .condition-list[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:hover{opacity:.6;filter:none}.line[_ngcontent-%COMP%]   .condition-list[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.line[_ngcontent-%COMP%]   .condition-list[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);position:absolute;bottom:0;left:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor));transform:translate(-50%)}.line[_ngcontent-%COMP%]   .condition-list[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   .condition.disabled[_ngcontent-%COMP%]{filter:grayscale(.6);pointer-events:none}.line[_ngcontent-%COMP%]   .condition-list[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   .hint-trigger[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.line[_ngcontent-%COMP%]   .condition-list[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   .hint.right[_ngcontent-%COMP%]{transform:translate(-50%)}.line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg.sync-settings[_ngcontent-%COMP%]{height:2em;width:auto;filter:var(--ghs-filter-disabled) var(--ghs-filter-outline-thin-black)}.menu-container.connected[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg.sync-settings[_ngcontent-%COMP%]{filter:var(--ghs-filter-green) var(--ghs-filter-outline-thin-black)}"]})}return a})();const eQ=["Failed to execute 'setItem' on 'Storage'","NG0100","Failed to execute 'transaction' on 'IDBDatabase': The database connection is closing"];let aQ=(()=>{class a extends c.zcH{dialog;constructor(n){super(),this.dialog=n}handleError(n){if(s.E.stateManager.errorLog.push(n),super.handleError(n),window.document.body.classList.contains("working")||window.document.body.classList.contains("server-sync")){window.document.body.classList.remove("working"),window.document.body.classList.remove("server-sync");const i=n.message+(n.stack?n.stack.split("\n")[0]:"");n.message&&n.message.trim()&&!n.message.toLowerCase().includes("leaflet")&&!eQ.some(e=>n.message.startsWith(e))&&(!p.f.settings.feedbackErrorsIgnore||!p.f.settings.feedbackErrorsIgnore.includes(i))&&this.dialog.open(Uo,{panelClass:["dialog"],data:n})}}static \u0275fac=function(i){return new(i||a)(c.KVO(O.lG))};static \u0275prov=c.jDH({token:a,factory:a.\u0275fac})}return a})(),iQ=(()=>{class a{static \u0275fac=function(i){return new(i||a)};static \u0275mod=t.$C({type:a,bootstrap:[JH]});static \u0275inj=c.G2t({providers:[{provide:O.Aq,useValue:{autoFocus:"dialog",hasBackdrop:!0}},{provide:c.zcH,useClass:aQ}],imports:[M.Bb,ZH,E.YN,V.ad,O.Ph,T.Q5,R.WJ.register("ngsw-worker.js",{enabled:true,registrationStrategy:"registerImmediately"})]})}return a})();t.wjB(en,function(){return[N.YU,en,Eo,Ga,Is,ve,it,Mt,dt,nn]},function(){return[N.P9,At,ct]}),t.wjB(Ga,function(){return[N.YU,Eo]},function(){return[ct]}),t.wjB(Ci,function(){return[N.YU,ye,it]},[]),t.wjB(Cr,function(){return[N.YU,Mr]},[]),t.wjB(An,function(){return[N.YU,mr,Mt,dt]},[]),t.wjB(br,function(){return[N.YU,Hi]},[]),t.wjB(Zo,function(){return[N.YU,q.Wk,fK,BK,aW,vW,it,Mt,IW,sZ,CZ,tJ,OW,nQ,Ft]},function(){return[N.P9,ct]}),t.wjB(lo,function(){return[N.YU,Te]},[]),t.wjB(Fr,function(){return[N.YU,ve,it,Te,Ne]},function(){return[ct]}),t.wjB(zr,function(){return[E.qT,E.cb,E.cV,nc,it]},[]),t.wjB(co,function(){return[N.YU,ee,it,Te,dt]},function(){return[ct]}),t.wjB($i,function(){return[N.YU,en,Eo,it,nn]},[]),(0,x.SmG)(),M.sG().bootstrapModule(iQ).catch(a=>console.error(a))},1270(u,y,v){v.d(y,{CS:()=>O,tY:()=>M});class M{id="";name="";costs={prosperity:0,lumber:0,metal:0,hide:0,gold:0,manual:0};upgrades=[];repair=void 0;rebuild=[];effectNormal=[];effectWrecked=[];interactionsAvailable=[];interactionsUnavailable=[];requires="";rewards=[];prosperityUnlock=!1;envelope=void 0;coordinates=[];edition=""}class O{characters;characterSpent;fhSupportSpent;morale;constructor(c,E,R,T=0){this.characters=c,this.characterSpent=E,this.fhSupportSpent=R,this.morale=T}}},1571(u,y,v){v.d(y,{j:()=>x,k:()=>M});class M{name;level;state;attacked;constructor(V="",c=1,E="normal"){this.name=V,this.level=c,this.state=E}}class x{flipped=!1;automated=!0;plots=[]}},1604(u,y,v){v.d(y,{Di:()=>q,G8:()=>s,Pr:()=>V,hM:()=>M,hV:()=>T,mn:()=>R,r6:()=>x,rz:()=>E,s$:()=>c,yX:()=>I});var M=function(D){return D.money="money",D.material_resources="material_resources",D.herb_resources="herb_resources",D.random_item="random_item",D.special="special",D}(M||{}),x=function(D){return D.money="money",D.lumber="lumber",D.metal="metal",D.hide="hide",D.arrowvine="arrowvine",D.axenut="axenut",D.corpsecap="corpsecap",D.flamefruit="flamefruit",D.rockroot="rockroot",D.snowthistle="snowthistle",D.random_item="random_item",D.special1="special1",D.special2="special2",D}(x||{});const V=[x.arrowvine,x.axenut,x.corpsecap,x.flamefruit,x.rockroot,x.snowthistle],c=[x.lumber,x.metal,x.hide,...V],E=[...c,x.money],R=[...E,x.special1,x.special2,x.random_item];function T(D){return D==x.money?M.money:D==x.random_item?M.random_item:D==x.special1||D==x.special2?M.special:[x.lumber,x.metal,x.hide].includes(D)?M.material_resources:M.herb_resources}class B{type;value4P;value3P;value2P;enhancements=0;cardId;value;constructor(p,G,H,b=-1,S=-1,A=void 0){this.type=p,this.cardId=G,this.value4P=H,this.value3P=H,this.value2P=H,-1!=b&&(this.value3P=b),-1!=S&&(this.value2P=S),this.value=A}}const q=[new B(x.money,1361,1),new B(x.money,1362,1),new B(x.money,1363,1),new B(x.money,1364,1),new B(x.money,1365,1),new B(x.money,1366,1),new B(x.money,1367,1),new B(x.money,1368,1),new B(x.money,1369,1),new B(x.money,1370,1),new B(x.money,1371,1),new B(x.money,1372,1),new B(x.money,1373,2),new B(x.money,1374,2),new B(x.money,1375,2),new B(x.money,1376,2),new B(x.money,1377,2),new B(x.money,1378,2),new B(x.money,1379,3),new B(x.money,1380,3),new B(x.arrowvine,1381,1),new B(x.arrowvine,1382,1),new B(x.axenut,1383,1),new B(x.axenut,1384,1),new B(x.corpsecap,1385,1),new B(x.corpsecap,1386,1),new B(x.flamefruit,1387,1),new B(x.flamefruit,1388,1),new B(x.rockroot,1389,1),new B(x.rockroot,1390,1),new B(x.snowthistle,1391,1),new B(x.snowthistle,1392,1),new B(x.hide,1393,1,2,2),new B(x.hide,1394,1,2,2),new B(x.hide,1395,1,2,2),new B(x.hide,1396,1,1,2),new B(x.hide,1397,1,1,2),new B(x.hide,1398,1,1,2),new B(x.hide,1399,1),new B(x.hide,1400,1),new B(x.lumber,1401,1,2,2),new B(x.lumber,1402,1,2,2),new B(x.lumber,1403,1,2,2),new B(x.lumber,1404,1,1,2),new B(x.lumber,1405,1,1,2),new B(x.lumber,1406,1,1,2),new B(x.lumber,1407,1),new B(x.lumber,1408,1),new B(x.metal,1408,1,2,2),new B(x.metal,1410,1,2,2),new B(x.metal,1411,1,2,2),new B(x.metal,1412,1,1,2),new B(x.metal,1413,1,1,2),new B(x.metal,1414,1,1,2),new B(x.metal,1415,1),new B(x.metal,1416,1),new B(x.random_item,1417,1),new B(x.special1,1418,1,-1,-1,"43.4|133.4|177.3|165.3|168.1|130.4|174.5|106.3|13.2|16.2"),new B(x.special2,1419,1,-1,-1,"36.4|29.1|188.2|182.3|85.1|11.1|128.5|153.4|193.5|9.3")];class I{current=-1;cards=[];active=!1;fromModel(p){this.current=p.current,this.cards=p.cards,s(this.cards),this.active=p.active}}function s(D){D.forEach((p,G,H)=>{if(!p.cardId){const b=q.find(S=>S.type==p.type&&S.value2P==p.value2P&&S.value3P==p.value3P&&S.value4P==p.value4P&&!H.find(A=>A.cardId==S.cardId));b?p.cardId=b.cardId:console.warn("Cannot map cardId for loot:",p)}})}},1619(u,y,v){v.d(y,{f:()=>G});var M=v(9204),x=v(316),O=v(3025),V=v(5846),c=v(1832),E=v(1824),R=v(706),T=v(1270),B=v(3812),q=v(8317);const s=new class I{checkDuplicates(){q.E.charactersData().forEach((b,S,A)=>{A.find(F=>!b.replace&&!F.replace&&A.indexOf(F)!=A.indexOf(b)&&b.name==F.name&&b.edition==F.edition)&&console.warn("Duplicate Character: "+b.name+" (Edition: "+b.edition+")")}),q.E.decksData().forEach((b,S,A)=>{A.find(F=>A.indexOf(F)!=A.indexOf(b)&&b.name==F.name&&b.edition==F.edition)&&console.warn("Duplicate Deck: "+b.name+" (Edition: "+b.edition+")")}),q.E.scenarioData().forEach((b,S,A)=>{A.find(F=>A.indexOf(F)!=A.indexOf(b)&&b.index==F.index&&b.edition==F.edition&&b.group==F.group)&&console.warn("Duplicate Scenario: "+b.index+" (Edition: "+b.edition+")")}),q.E.sectionData().forEach((b,S,A)=>{A.find(F=>A.indexOf(F)!=A.indexOf(b)&&b.index==F.index&&b.edition==F.edition&&b.group==F.group)&&console.warn("Duplicate Section: "+b.index+" (Edition: "+b.edition+")")}),q.E.itemData().forEach((b,S,A)=>{A.find(F=>A.indexOf(F)!=A.indexOf(b)&&b.id==F.id&&b.edition==F.edition)&&console.warn("Duplicate Item: "+b.id+" (Edition: "+b.edition+")")}),q.E.monstersData().forEach((b,S,A)=>{A.find(F=>!b.replace&&!F.replace&&A.indexOf(F)!=A.indexOf(b)&&b.name==F.name&&b.edition==F.edition)&&console.warn("Duplicate Monster: "+b.name+" (Edition: "+b.edition+")")}),q.E.battleGoalManager.getBattleGoals(void 0,!0).forEach((b,S,A)=>{if(!b.alias){const F=A.filter((t,N)=>N!=S&&(t.name==b.name||G.getLabel("data.battleGoals."+t.cardId)==G.getLabel("data.battleGoals."+b.cardId)));F.length>0&&F.find(t=>!t.alias)&&console.warn("BattleGoal doubles:",b.edition+" - "+b.name,F.map(t=>t.edition+" - "+t.name))}})}checkScenarioMonster(){q.E.scenarioData().forEach(b=>{b.monsters&&b.monsters.forEach(S=>{q.E.monstersData().find(A=>(A.edition==b.edition||q.E.editionExtensions(b.edition).includes(A.edition))&&A.name==S.split(":")[0])||console.warn("Invalid monster: "+S+" | scenario",b.edition,b.group||"",b.index)}),b.rooms&&b.rooms.forEach(S=>{S.monster&&S.monster.forEach(A=>{q.E.monstersData().find(F=>(F.edition==b.edition||q.E.editionExtensions(b.edition).includes(F.edition))&&F.name==A.name.split(":")[0])||console.warn("Invalid monster: "+A.name+" | scenario",b.edition,b.group||"",b.index)})})})}checkSectionMonster(){q.E.sectionData().forEach(b=>{b.monsters&&b.monsters.forEach(S=>{q.E.monstersData().find(A=>(A.edition==b.edition||q.E.editionExtensions(b.edition).includes(A.edition))&&A.name==S.split(":")[0])||console.warn("Invalid monster: "+S+" | section",b.edition,b.group||"",b.index)}),b.rooms&&b.rooms.forEach(S=>{S.monster&&S.monster.forEach(A=>{q.E.monstersData().find(F=>(F.edition==b.edition||q.E.editionExtensions(b.edition).includes(F.edition))&&F.name==A.name.split(":")[0])||console.warn("Invalid monster: "+A.name+" | section",b.edition,b.group||"",b.index)})})})}checkMissingScenarioMonster(){q.E.scenarioData().forEach(b=>{b.rooms&&b.rooms.forEach(S=>{S.monster&&S.monster.forEach(A=>{(!b.monsters||!b.monsters.find(F=>F==A.name||F.split(":")[0]==A.name))&&console.debug("Missing monster '"+A.name+"' from room '"+S.roomNumber+"' in monsters",b.edition,b.group||"",b.index)})})})}checkMissingSectionMonster(){q.E.sectionData().forEach(b=>{b.rooms&&b.rooms.forEach(S=>{S.monster&&S.monster.forEach(A=>{(!b.monsters||!b.monsters.find(F=>F==A.name||F.split(":")[0]==A.name))&&console.debug("Missing monster '"+A.name+"' from room '"+S.roomNumber+"' in monsters | section",b.edition,b.group||"",b.index)})})})}checkMonsterUsage(){q.E.monstersData().forEach(b=>{let S=!1;q.E.scenarioData().forEach(A=>{A.monsters&&A.monsters.some(F=>F.split(":")[0]==b.name)&&(S=!0),!S&&A.rooms&&A.rooms.forEach(F=>{F.monster&&F.monster.some(t=>t.name.split(":")[0]==b.name)&&(S=!0)})}),S||q.E.sectionData().forEach(A=>{A.monsters&&A.monsters.find(F=>F.split(":")[0]==b.name)&&(S=!0),!S&&A.rooms&&A.rooms.forEach(F=>{F.monster&&F.monster.some(t=>t.name.split(":")[0]==b.name)&&(S=!0)})}),S||console.warn("Could not find usage of '"+b.name+"'",b.edition)})}checkMonsterBossCount(){q.E.monstersData().forEach(b=>{b.boss&&(0,B.hZ)(b.count)>1&&console.warn("Boss count check: "+b.name+" (Edition: "+b.edition+")")})}checkCharacterCardIds(){q.E.decksData().filter(b=>{if(b.character)for(let S=0;S<b.abilities.length-1;S++){const A=b.abilities[S],F=b.abilities[S+1];if(null==A.cardId)console.warn(b.edition,b.name,S,A.name);else if(null!=A.cardId&&null!=F.cardId&&A.cardId+1!=F.cardId){console.warn(b.edition,b.name,S,A.cardId,A.name,S+1,F.cardId,F.name);break}}})}};var D=v(6484);const G=new class p{defaultLocale="en";defaultEditions=["gh","fh","jotl","fc","cs","toa","bb","gh2e","mp","solo"];defaultEditionDataUrls=["./assets/data/gh.json","./assets/data/fh.json","./assets/data/jotl.json","./assets/data/fc.json","./assets/data/cs.json","./assets/data/toa.json","./assets/data/bb.json","./assets/data/solo.json","./assets/data/fh-crossover.json","./assets/data/gh-envx.json","./assets/data/toa-envv.json","./assets/data/mp.json","./assets/data/ccug.json","./assets/data/sc.json","./assets/data/gh-solo-items.json","./assets/data/sox.json","./assets/data/bas.json","./assets/data/cc.json","./assets/data/gh2e.json","./assets/data/ir.json","./assets/data/r100kc.json","./assets/data/sits.json"];settings=new R.w;label={};locales=["en","de","fr","ko","es","it","zh_Hans","zh_Hant","ru","pt","pl"];developent=!1;debugManager=s;init(b){var S=this;return(0,M.A)(function*(){yield S.loadSettings(),S.developent=b;for(let A of S.defaultEditionDataUrls)!G.settings.editionDataUrls.includes(A)&&!G.settings.excludeEditionDataUrls.includes(A)&&G.settings.editionDataUrls.push(A);yield Promise.all(G.settings.editionDataUrls.map(A=>G.loadEditionData(A)))})()}loadSettings(){var b=this;return(0,M.A)(function*(){let S=!1;try{let A=yield D.n.read("settings","default");A?b.setSettings(Object.assign(new R.w,A)):S=!0}catch{S=!0}if(S)try{yield fetch("./ghs-settings-default.json").then(A=>{if(!A.ok)throw Error();return A.json()}).then(A=>{b.setSettings(Object.assign(new R.w,A))})}catch{b.setSettings(new R.w)}b.updateLocale(b.settings.locale)})()}setSettings(b){if(b.locale!=this.settings.locale&&this.updateLocale(b.locale),this.settings=b,(!this.settings.editions||0==this.settings.editions.length)&&this.settings.editions.push(...this.defaultEditions),!this.settings.editionDataUrls||0==this.settings.editionDataUrls.length)for(let S of this.defaultEditionDataUrls)!this.settings.editionDataUrls.includes(S)&&!this.settings.excludeEditionDataUrls.includes(S)&&this.settings.editionDataUrls.push(S);b.theme||(b.theme=b.fhStyle?"fh":"default"),b.disableAnimations&&(b.animations=!1,b.disableAnimations=!1),b.disableArtwork&&(b.artwork=!1,b.disableArtwork=!1),b.disableColumns&&(b.columns=!1,b.disableColumns=!1),b.disableDragFigures&&(b.dragFigures=!1,b.disableDragFigures=!1),b.disablePinchZoom&&(b.pinchZoom=!1,b.disablePinchZoom=!1),b.disabledTurnConfirmation&&(b.turnConfirmation=!1,b.disabledTurnConfirmation=!1),b.disableSortFigures&&(b.sortFigures=!1,b.disableSortFigures=!1),b.disableStandees&&(b.standees=!1,b.disableStandees=!1),b.disableWakeLock&&(b.wakeLock=!1,b.disableWakeLock=!1),b.serverPassword&&(b.serverCode=b.serverPassword,b.serverPassword=void 0),b.combineSummonAction||(b.combineInteractiveAbilities=!1,b.combineSummonAction=!0),b.treasuresLootItem||(b.drawRandomItem=!1),b.treasuresLootScenario||(b.drawRandomScenario=!1),this.sortSpoilers()}storeSettings(){D.n.write("settings","default",this.settings),this.settings.serverSettings&&q.E.stateManager.saveSettings(),q.E.uiChange.next(!1)}reset(){D.n.remove("settings"),this.loadSettings()}set(b,S){var A=this;return(0,M.A)(function*(F,t,N=!0){A.settings[F]=t,N&&(yield A.apply(F,t)),A.storeSettings()}).apply(this,arguments)}toggle(b){var S=this;return(0,M.A)(function*(){yield S.set(b,!S.settings[b])})()}apply(b,S){var A=this;return(0,M.A)(function*(){"fullscreen"===b?S?document.body.requestFullscreen&&document.body.requestFullscreen():document.exitFullscreen&&document.exitFullscreen():"locale"===b?yield A.updateLocale(S):"animationSpeed"===b?document.body.style.setProperty("--ghs-animation-speed",S+""):"fontsize"===b?document.body.style.setProperty("--ghs-fontsize",S+""):"barsize"===b?document.body.style.setProperty("--ghs-barsize",S+""):"globalFontsize"===b?document.body.style.setProperty("--ghs-global-fontsize",S+""):"portraitMode"===b?S?document.body.classList.add("portrait-mode"):document.body.classList.remove("portrait-mode"):"theme"===b&&A.settings.automaticTheme?A.settings.fhStyle="fh"==S||"bb"==S:"bbAm"===b?(q.E.game.monsterAttackModifierDeck.bb=S||!1,q.E.game.figures.forEach(F=>{F instanceof E.K&&(F.attackModifierDeck.bb=S||!1)})):"temporaryEnhancements"===b&&q.E.game.figures.forEach(F=>{F instanceof E.K&&q.E.characterManager.previousEnhancements(F,S)})})()}get(b){return this.settings[b]}setAutoBackupFinish(b){this.settings.autoBackupFinish=b,this.settings.autoBackupFinish&&this.settings.autoBackup<0?this.settings.autoBackup=0:!this.settings.autoBackupFinish&&0==this.settings.autoBackup&&(this.settings.autoBackup=-1),this.storeSettings()}setAutoBackupUrl(b){this.settings.autoBackupUrl=b,this.settings.autoBackupUrl&&!this.settings.autoBackupUrl.method&&(this.settings.autoBackupUrl.method="POST"),this.storeSettings()}setDisableWakeLock(b){var S=this;return(0,M.A)(function*(){S.settings.disableWakeLock=b,b&&q.E.stateManager.wakeLock?q.E.stateManager.wakeLock.release().then(()=>{q.E.stateManager.wakeLock=null}):!b&&!q.E.stateManager.wakeLock&&"wakeLock"in navigator&&(q.E.stateManager.wakeLock=yield navigator.wakeLock.request("screen")),S.storeSettings()})()}setWakeLock(b){var S=this;return(0,M.A)(function*(){S.settings.wakeLock=b,!b&&q.E.stateManager.wakeLock?q.E.stateManager.wakeLock.release().then(()=>{q.E.stateManager.wakeLock=null}):b&&!q.E.stateManager.wakeLock&&"wakeLock"in navigator&&(q.E.stateManager.wakeLock=yield navigator.wakeLock.request("screen")),S.storeSettings()})()}setServer(b,S,A){this.settings.serverUrl=b,this.settings.serverPort=S,this.settings.serverCode=A,this.storeSettings()}setServerSettings(b){this.settings.serverSettings=b,b?q.E.stateManager.requestSettings():this.storeSettings()}setZoom(b){this.settings.zoom=b,this.storeSettings()}addSpoiler(b){this.settings.spoilers.includes(b)||(this.settings.spoilers.push(b),this.sortSpoilers(),this.storeSettings())}addSpoilers(b){for(let S of b)this.settings.spoilers.includes(S.name)||this.settings.spoilers.push(S.name);this.storeSettings()}removeSpoiler(b){this.settings.spoilers.includes(b)&&(this.settings.spoilers.splice(this.settings.spoilers.indexOf(b),1),this.storeSettings())}removeAllSpoilers(){this.settings.spoilers=[],this.storeSettings()}addEdition(b){this.settings.editions.includes(b)||(this.settings.editions.push(b),q.E.resetEditionMapping(),this.storeSettings())}removeEdition(b){this.settings.editions.splice(this.settings.editions.indexOf(b),1),q.E.resetEditionMapping(),this.storeSettings()}sortSpoilers(){this.settings.spoilers.sort((b,S)=>b.toLowerCase()>S.toLowerCase()?1:b.toLowerCase()<S.toLowerCase()?-1:0)}cleanEditionData(){q.E.editionData=[]}loadEditionData(b){var S=this;return(0,M.A)(function*(A,F=!1){try{return yield fetch(A).then(N=>{if(N.ok)return N.json();console.warn("Invalid data url: "+A+" ["+N.statusText+"]")}).then(N=>{if(!q.E.editions(!0).includes(N.edition)||F)return F&&(q.E.editionData=q.E.editionData.filter(K=>K.url!=A)),N.characters=N.characters||[],N.monsters=N.monsters||[],N.decks=N.decks||[],N.scenarios=N.scenarios||[],N.sections=N.sections||[],N.items=N.items||[],N.conditions=N.conditions||[],N.battleGoals=N.battleGoals||[],N.events=N.events||[],N.challenges=N.challenges||[],N.trials=N.trials||[],N.favors=N.favors||[],N.pets=N.pets||[],N.personalQuests=N.personalQuests||[],N.label=N.label||{},N.labelSpoiler=N.labelSpoiler||{},N.url=A,N.logoUrl=N.logoUrl||"",N.additional=N.additional||!1,N.extensions=N.extensions||[],N.newAmStyle=N.newAmStyle||!1,N.newItemStyle=N.newItemStyle||!1,N.treasures=N.treasures||[],N.treasureOffset=N.treasureOffset||0,N.campaign&&N.campaign.buildings&&(N.campaign.buildings=N.campaign.buildings.map(K=>Object.assign(new T.tY,K))),N.battleGoals.map((K,w)=>(K.edition||(K.edition=N.edition),K.cardId||(K.cardId=K.edition+"-"+(w+1)),K)),N.events.map((K,w)=>(K.edition||(K.edition=N.edition),K.cardId||(K.cardId=""+(w+1)),K)),N.personalQuests.map((K,w)=>(K.edition||(K.edition=N.edition),K.cardId||(K.cardId=N.edition+"-"+(w+1)),K.requirements||(K.requirements=[]),K)),N.campaign&&N.campaign.buildings&&N.campaign.buildings.forEach(K=>{K.edition||(K.edition=N.edition)}),N.challenges.map((K,w)=>(K.edition||(K.edition=N.edition),K.cardId||(K.cardId=w+1),K)),N.trials.map((K,w)=>(K.edition||(K.edition=N.edition),K.cardId||(K.cardId=w+1),K)),N.favors.map((K,w)=>(K.edition||(K.edition=N.edition),K.name||(K.name="favor-"+(w+1)),K)),N.pets.map((K,w)=>(K.edition||(K.edition=N.edition),K.id||(K.id=(w<9?"0":"")+(w+1)),K)),q.E.editionData.push(N),q.E.editionData.sort((K,w)=>S.settings.editionDataUrls.indexOf(K.url)-S.settings.editionDataUrls.indexOf(w.url)),G.settings.editions.includes(N.edition)?S.loadDataLabel(N):S.loadEditionLabel(N),N;console.warn("Edition already exists: "+N.edition)})}catch(t){return void console.warn("Invalid data url: "+A+" ["+t+"]")}}).apply(this,arguments)}validateEditionData(){s.checkDuplicates(),s.checkScenarioMonster(),s.checkSectionMonster(),s.checkMissingScenarioMonster(),s.checkMissingSectionMonster(),s.checkMonsterUsage(),s.checkMonsterBossCount()}loadDataLabel(b){this.label.data||(this.label.data={}),b.label&&b.label[this.settings.locale]&&(this.label.data=this.merge(this.label.data,!0,b.label[this.settings.locale])),b.labelSpoiler&&b.labelSpoiler[this.settings.locale]&&(this.label.data=this.merge(this.label.data,!0,b.labelSpoiler[this.settings.locale])),this.settings.locale!=this.defaultLocale&&b.label&&b.label[this.defaultLocale]&&(this.label.data=this.merge(this.label.data,!1,b.label[this.defaultLocale]),b.labelSpoiler&&b.labelSpoiler[this.defaultLocale]&&(this.label.data=this.merge(this.label.data,!1,b.labelSpoiler[this.defaultLocale]))),this.label.data.edition||(this.label.data.edition={}),this.label.data.character||(this.label.data.character={}),this.label.data.monster||(this.label.data.monster={}),this.label.data.deck||(this.label.data.deck={}),this.label.data.ability||(this.label.data.ability={}),this.label.data.scenario||(this.label.data.scenario={}),this.label.data.partyAchievements||(this.label.data.partyAchievements={}),this.label.data.globalAchievements||(this.label.data.globalAchievements={}),this.label.data.campaignSticker||(this.label.data.campaignSticker={}),this.label.data.scenario.group||(this.label.data.scenario.group={}),this.label.data.section||(this.label.data.section={}),this.label.data.objective||(this.label.data.objective={}),this.label.data.summon||(this.label.data.summon={}),this.label.data.battleGoals||(this.label.data.battleGoals={}),this.label.data.personalQuest||(this.label.data.personalQuest={}),this.label.data.items||(this.label.data.items={})}loadEditionLabel(b){this.label.data||(this.label.data={}),this.label.data.edition||(this.label.data.edition={}),this.settings.locale!=this.defaultLocale&&b.label&&b.label[this.defaultLocale]&&b.label[this.defaultLocale].edition&&(this.label.data.edition=this.merge(this.label.data.edition,!1,b.label[this.defaultLocale].edition)),b.label&&b.label[this.settings.locale]&&b.label[this.settings.locale].edition&&(this.label.data.edition=this.merge(this.label.data.edition,!0,b.label[this.settings.locale].edition))}isObject(b){return b&&"object"==typeof b&&!Array.isArray(b)}merge(b,S,...A){if(!A.length)return b;const F=b;if(this.isObject(F))for(let t=0;t<A.length;t+=1){const N=A[t];if(this.isObject(N))for(const K in N)N.hasOwnProperty(K)&&(this.isObject(N[K])?(F[K]?this.isObject(F[K])||(F[K]={"":F[K]}):F[K]={},this.merge(F[K],S,N[K])):Array.isArray(F[K])&&Array.isArray(N[K])?F[K]=Array.from(new Set(F[K].concat(N[K]))):(S||!F[K])&&(F[K]=N[K]))}return F}getEditionByUrl(b){const S=q.E.editionData.find(A=>A.url==b);return S?S.url:(console.error("No edition data found for url '"+b+"'"),"")}addEditionDataUrl(b){var S=this;return(0,M.A)(function*(){if(!S.settings.editionDataUrls.includes(b)){const A=yield S.loadEditionData(b);if(A)return S.settings.editionDataUrls.push(b),q.E.editionData.sort((F,t)=>S.settings.editionDataUrls.indexOf(F.url)-S.settings.editionDataUrls.indexOf(t.url)),S.settings.excludeEditionDataUrls.includes(b)&&S.settings.excludeEditionDataUrls.splice(S.settings.excludeEditionDataUrls.indexOf(b),1),S.storeSettings(),A}})()}removeEditionDataUrl(b){var S=this;return(0,M.A)(function*(){S.settings.editionDataUrls.includes(b)&&(q.E.editionData=q.E.editionData.filter(A=>A.url!=b),S.settings.editionDataUrls.splice(S.settings.editionDataUrls.indexOf(b),1),S.defaultEditionDataUrls.includes(b)&&S.settings.excludeEditionDataUrls.push(b),S.storeSettings())})()}restoreDefaultEditionDataUrls(){var b=this;return(0,M.A)(function*(){for(let S of b.defaultEditionDataUrls)b.settings.editionDataUrls.includes(S)||(b.settings.editionDataUrls.push(S),yield b.loadEditionData(S));b.settings.editionDataUrls.sort((S,A)=>b.defaultEditionDataUrls.includes(S)&&b.defaultEditionDataUrls.includes(A)?b.defaultEditionDataUrls.indexOf(S)-b.defaultEditionDataUrls.indexOf(A):b.defaultEditionDataUrls.includes(S)&&!b.defaultEditionDataUrls.includes(A)?-1:!b.defaultEditionDataUrls.includes(S)&&b.defaultEditionDataUrls.includes(A)?1:b.settings.editionDataUrls.indexOf(S)-b.settings.editionDataUrls.indexOf(A)),q.E.editionData.sort((S,A)=>b.settings.editionDataUrls.indexOf(S.url)-b.settings.editionDataUrls.indexOf(A.url)),b.storeSettings()})()}updateLocale(b){var S=this;return(0,M.A)(function*(){S.label={},yield fetch("./assets/locales/"+b+".json").then(A=>A.json()).then(A=>{S.label=S.merge(S.label,!0,A)}).catch(A=>{console.error("Invalid locale: "+b,A)}),b!=S.defaultLocale&&(yield fetch("./assets/locales/"+S.defaultLocale+".json").then(A=>A.json()).then(A=>{S.label=S.merge(S.label,!1,A)}).catch(A=>{console.error("Invalid locale: "+b,A)})),S.label.data={};for(let A of q.E.editionData)S.loadDataLabel(A);switch(b){case"de":(0,x.EO)(O.A);break;case"fr":(0,x.EO)(V.A);break;case"ko":(0,x.EO)(c.A)}q.E.uiChange.next(!1)})()}getLabel(b,S=[],A=!0,F=!1,t="",N=this.label){if(b+="",!N)return F?this.emptyLabel(b,S,t):t&&b?this.getLabel(b):b||"";if(N[b])return"object"==typeof N[b]?N[b][""]?this.insertLabelArguments(N[b][""],S,A):F?this.emptyLabel(b,S,t):t&&b?this.getLabel(b):b||"":this.insertLabelArguments(N[b],S,A);{if("data.monster."==t){const w=b.match(/(.+)\-(scenario|section)\-(.+)/);if(w)return this.insertLabelArguments(N[b=w[1]],S,A)+" #"+w[3]}let K=b.split(".");if(N[K[0]])return b=K.slice(1,K.length).join("."),this.getLabel(b,S,A,F,t+K[0]+".",N[K[0]])}return F?this.emptyLabel(b,S,t):t&&b?this.getLabel(b):b||""}emptyLabel(b,S,A){return b+(S&&S.length>0?" ["+S+"]":"")}insertLabelArguments(b,S,A){if(S)for(let F in S)for(;b.includes(`{${F}}`);)if(b=b.replace(`{${F}}`,A?this.getLabel(S[F]):S[F]),S[F].includes(`{${F}}`)){console.warn("Loop for '"+b+"'",S[F]);break}return b}};window.settingsManager=G},1824(u,y,v){v.d(y,{K:()=>T});var M=v(8317),x=v(9819),O=v(8635),V=v(7017),c=v(2357),E=v(4786),R=v(8164);class T extends O.qS{title="";initiative=0;experience=0;loot=0;lootCards=[];treasures=[];exhausted=!1;stat;summons=[];identity=0;progress;donations=0;scenarioStats=new x.yn;initiativeVisible=!1;attackModifierDeckVisible=!1;lootCardsVisible=!1;itemsVisible=!1;fullview=!1;attackModifierDeck;token=0;tokenValues=[];absent=!1;longRest=!1;battleGoals=[];battleGoal=!1;shield;shieldPersistent;retaliate=[];retaliatePersistent=[];level;off=!1;active=!1;type="character";health;maxHealth;entityConditions=[];immunities=[];number=0;markers=[];tags=[];getInitiative(){return this.absent?200:this.exhausted||this.longRest&&("prism"!=this.name||!this.tags.includes("long_rest"))||this.health<=0||this.absent?100:M.E.challengesManager.apply&&M.E.challengesManager.isActive(1505,"fh")?this.initiative<90?this.initiative+10:99:this.initiative-.9}constructor(I,s){super(I),this.errors=I.errors||[],s<1?s=1:s>9&&(s=9);const D=this.stats.find(p=>p.level==s);D?(this.stat=D,this.level=s,this.maxHealth=this.stat.health):(!this.errors.find(p=>p.type==E.H.unknown)&&!this.errors.find(p=>p.type==E.H.stat)&&(console.error("No character stat found for level: "+s),this.errors.push(new E.h(E.H.stat,"character",I.name,I.edition,"",""+s))),this.stat=new V.s(s,0),this.level=0,this.maxHealth=0),this.health=this.maxHealth,this.progress=new x.lv,this.attackModifierDeck=M.E.attackModifierManager.buildCharacterAttackModifierDeck(this),this.tokens.forEach((p,G)=>{this.tokenValues[G]=this.tokenValues[G]||0}),this.availableSummons.forEach(p=>p.edition=this.edition)}toModel(){return new B(this.name,this.edition,this.marker,this.title,this.initiative,this.experience,this.loot,this.lootCards||[],this.treasures&&this.treasures.map(I=>""+I)||[],this.exhausted,this.level,this.off,this.active,this.health,this.maxHealth,this.entityConditions.map(I=>I.toModel()),this.immunities,this.markers,this.tags||[],this.identity,this.summons.map(I=>I.toModel()),this.progress,this.scenarioStats,this.initiativeVisible,this.attackModifierDeckVisible,this.lootCardsVisible,this.itemsVisible,this.number,this.attackModifierDeck.toModel(),this.donations,this.token,this.tokenValues,this.absent,this.longRest,this.battleGoals,this.battleGoal,this.shield,this.shieldPersistent,this.retaliate,this.retaliatePersistent,this.fullview)}fromModel(I){if(this.edition=I.edition,!this.edition){const D=M.E.charactersData().find(p=>p.name==I.name);this.edition=D?D.edition:""}if(this.marker=I.marker||this.marker,this.title=I.title,(!this.initiativeVisible||I.initiative<=0||this.initiative!=I.initiative)&&(this.initiativeVisible=I.initiativeVisible),I.number)this.number=I.number;else for(this.number=1;M.E.game.figures.some(D=>D instanceof T&&(D.name!=this.name||D.edition!=this.edition)&&D.number==this.number);)this.number++;this.initiative=I.initiative,this.experience=I.experience,this.loot=I.loot,this.lootCards=I.lootCards||[],this.treasures=I.treasures&&I.treasures.map(D=>isNaN(+D)?D:+D)||[],this.exhausted=I.exhausted,this.level=I.level,this.off=I.off,this.active=I.active,this.health=I.health,this.maxHealth=I.maxHealth,this.entityConditions=[],I.entityConditions&&(this.entityConditions=I.entityConditions.map(D=>{let p=new c.BR(D.name,D.value);return p.fromModel(D),p})),this.immunities=I.immunities||[],this.markers=I.markers||this.markers,this.tags=I.tags||this.tags,this.identity=I.identity||0,this.summons=this.summons.filter(D=>I.summons.some(p=>p.uuid&&p.uuid==D.uuid)),I.summons.forEach((D,p)=>{let G=this.summons.find(H=>D.uuid==H.uuid);G||(G=new R.up(D.uuid,D.name,D.cardId,D.level,D.number,D.color),this.summons.splice(p,0,G)),G.fromModel(D)}),this.summons.sort((D,p)=>I.summons.map(G=>G.uuid).indexOf(D.uuid)-I.summons.map(G=>G.uuid).indexOf(p.uuid)),this.progress=new x.lv,I.progress&&(this.progress=Object.assign(new x.lv,I.progress),this.progress.enhancements&&(Array.isArray(this.progress.enhancements)||(this.progress.enhancements=[])),M.E.characterManager.previousEnhancements(this,M.E.enhancementsManager.temporary)),this.scenarioStats=new x.yn,I.scenarioStats&&(this.scenarioStats=Object.assign(new x.yn,I.scenarioStats));let s=M.E.attackModifierManager.buildCharacterAttackModifierDeck(this);I.attackModifierDeck&&M.E.attackModifierManager.fromModel(s,I.attackModifierDeck),M.E.attackModifierManager.mergeAttackModifierDeck(this.attackModifierDeck,s),I.attackModifierDeckVisible&&(this.attackModifierDeckVisible=!0),I.lootCardsVisible&&(this.lootCardsVisible=!0),I.itemsVisible&&(this.itemsVisible=!0),this.donations=I.donations||0,this.token=I.token||0,this.tokenValues=I.tokenValues||[],this.tokens.forEach((D,p)=>{this.tokenValues[p]=this.tokenValues[p]||0}),this.absent=I.absent,this.longRest=I.longRest,this.battleGoals=I.battleGoals||[],this.battleGoal=I.battleGoal,this.shield=I.shield?JSON.parse(I.shield):void 0,this.shieldPersistent=I.shieldPersistent?JSON.parse(I.shieldPersistent):void 0,this.retaliate=(I.retaliate||[]).map(D=>JSON.parse(D)),this.retaliatePersistent=(I.retaliatePersistent||[]).map(D=>JSON.parse(D)),I.fullView&&(this.fullview=I.fullView)}}class B{name;edition;marker;title;initiative;experience;loot;lootCards;treasures;exhausted;level;off;active;health;maxHealth;entityConditions;immunities=[];markers;tags;identity;summons;progress;scenarioStats;initiativeVisible;attackModifierDeckVisible;lootCardsVisible;itemsVisible;number;attackModifierDeck;donations;token;tokenValues;absent;longRest;battleGoals;battleGoal;shield;shieldPersistent;retaliate;retaliatePersistent;fullView;constructor(I,s,D,p,G,H,b,S,A,F,t,N,K,w,Q,$,Kt,st,Wt,nn,Sn,_n,Yt,mn,bn,Zt,kn,Dn,Rt,Z,vt,rn,Wn,Zn,jt,pt,On,$n,Gt,Jn,Qn){this.name=I,this.edition=s,this.marker=D,this.title=p,this.initiative=G,this.experience=H,this.loot=b,this.lootCards=JSON.parse(JSON.stringify(S)),this.treasures=JSON.parse(JSON.stringify(A)),this.exhausted=F,this.level=t,this.off=N,this.active=K,this.health=w,this.maxHealth=Q,this.entityConditions=JSON.parse(JSON.stringify($)),this.immunities=JSON.parse(JSON.stringify(Kt)),this.markers=JSON.parse(JSON.stringify(st)),this.tags=JSON.parse(JSON.stringify(Wt)),this.identity=nn,this.summons=Sn,this.progress=JSON.parse(JSON.stringify(_n)),this.scenarioStats=JSON.parse(JSON.stringify(Yt)),this.initiativeVisible=mn,this.attackModifierDeckVisible=bn,this.lootCardsVisible=Zt,this.itemsVisible=kn,this.number=Dn,this.attackModifierDeck=Rt,this.donations=Z,this.token=vt,this.tokenValues=JSON.parse(JSON.stringify(rn)),this.absent=Wn,this.longRest=Zn,this.battleGoals=JSON.parse(JSON.stringify(jt)),this.battleGoal=pt,this.shield=On?JSON.stringify(On):"",this.shieldPersistent=$n?JSON.stringify($n):"",this.retaliate=Gt.map(yn=>JSON.stringify(yn)),this.retaliatePersistent=Jn.map(yn=>JSON.stringify(yn)),this.fullView=Qn}}},1891(u,y,v){v.d(y,{r:()=>V});var M=v(8317),x=v(1619),O=v(9733);class V{id=0;name="";edition;conditions=[];battleGoalEditions=[];filteredBattleGoals=[];location="";notes="";achievements="";achievementsList=[];reputation=0;prosperity=0;scenarios=[];conclusions=[];casualScenarios=[];manualScenarios=[];campaignMode=!1;globalAchievements="";globalAchievementsList=[];treasures=[];donations=0;players=[];characters=[];availableCharacters=[];retirements=[];unlockedItems=[];unlockedCharacters=[];level=1;levelCalculation=!0;levelAdjustment=0;bonusAdjustment=0;ge5Player=!0;playerCount=-1;solo=!1;envelopeB=!1;eventDecks={};eventCards=[];weeks=0;weekSections={};loot={};randomItemLooted=[];inspiration=0;defense=0;soldiers=0;morale=0;townGuardPerks=0;townGuardPerkSections=[];campaignStickers=[];townGuardDeck;buildings=[];pets=[];lootDeckEnhancements=[];lootDeckFixed=[];lootDeckSections=[];trials=-1;garden;factionReputation={};imbuement=0;migrate(){if(this.achievementsList){const E=x.f.label.data.partyAchievements;let R=x.f.label.data.globalAchievements;x.f.settings.locale!=x.f.defaultLocale&&(R=M.E.editionData.map(T=>T.label[x.f.defaultLocale]&&T.label[x.f.defaultLocale].globalAchievements||{}).reduce((T,B)=>Object.assign(T,B))),this.achievementsList=this.achievementsList.filter(T=>T),this.achievementsList=this.achievementsList.map(T=>{let B=T;return T.startsWith("!")&&(B=B.slice(1,B.length)),Object.keys(E).forEach(q=>{(E[q].toLowerCase()==B.toLowerCase()||R[q]&&R[q].toLowerCase()==B.toLowerCase())&&(B=q)}),T.startsWith("!")&&(B="!"+B),B})}if(this.globalAchievementsList){const E=x.f.label.data.globalAchievements;let R=x.f.label.data.globalAchievements;x.f.settings.locale!=x.f.defaultLocale&&(R=M.E.editionData.map(T=>T.label[x.f.defaultLocale]&&T.label[x.f.defaultLocale].globalAchievements||{}).reduce((T,B)=>Object.assign(T,B))),this.globalAchievementsList=this.globalAchievementsList.filter(T=>T),this.globalAchievementsList=this.globalAchievementsList.map(T=>{let B=T;return T.startsWith("!")&&(B=B.slice(1,B.length)),Object.keys(E).forEach(q=>{(E[q].toLowerCase()==B.toLowerCase()||R[q]&&R[q].toLowerCase()==B.toLowerCase())&&(B=q)}),T.startsWith("!")&&(B="!"+B),B})}if(this.campaignStickers&&(this.campaignStickers=this.campaignStickers.filter(E=>E).map(E=>{let R=E;return Object.keys(x.f.label.data.campaignSticker).forEach(T=>{x.f.label.data.campaignSticker[T]!=R||(R=T)}),R})),this.manualScenarios){let E=[];this.manualScenarios.forEach(R=>{if("fh"==R.edition&&!R.group&&!R.custom){const T=M.E.sectionData("fh").find(B=>B.random&&B.unlocks&&B.unlocks.includes(R.index));T&&(this.conclusions.find(B=>B.edition==T.edition&&B.group==T.group&&B.index==T.index)||(this.conclusions.push(new O.Ag(""+T.index,T.edition,T.group)),E.push(R)))}}),this.manualScenarios=this.manualScenarios.filter(R=>!E.includes(R))}this.players=this.players||[],this.casualScenarios=this.casualScenarios||[],this.pets=this.pets||[],this.eventDecks=this.eventDecks||{},this.eventCards=this.eventCards||[],this.campaignMode&&x.f.settings.events&&M.E.eventCardManager.buildPartyDeckMigration(this.edition||M.E.currentEdition()),this.eventCards.forEach(E=>{if(Object.keys(!E).includes("attack")){const R=M.E.eventCardManager.getEventCardForEdition(E.edition,E.type,E.cardId);E.attack=R&&R.options&&R.options.some(T=>T.outcomes&&T.outcomes.some(B=>B.attack))||!1}})}}},2e3(u,y,v){v.d(y,{$v:()=>O,Af:()=>c,tB:()=>M});class M{name="";index="";errata="";coordinates;unlocks=[];blocks=[];requires=[];requirements=[];links=[];forcedLinks=[];group;flowChartGroup;monsters=[];allies=[];allied=[];drawExtra=[];objectives=[];rooms=[]=[];marker="";rules=[];initial=!1;random=!1;solo;allyDeck=!1;eventType;lootDeckConfig={};parent;parentSections=[];blockedSections=[];resetRound;rewards;retirement="";conclusion=!1;repeatable=!1;named=!1;hideIndex=!1;complexity=0;level;overlays=[];spotlight=!1;edition="";spoiler=!1;constructor(T=void 0){T&&(this.name=T.name,this.errata=T.errata,this.index=T.index,this.unlocks=T.unlocks,this.blocks=T.blocks,this.requires=T.requires,this.requirements=T.requirements||[],this.links=T.links,this.forcedLinks=T.forcedLinks,this.group=T.group,this.flowChartGroup=T.flowChartGroup,this.monsters=T.monsters,this.allies=T.allies,this.allied=T.allied,this.drawExtra=T.drawExtra,this.objectives=T.objectives,this.rooms=T.rooms,this.marker=T.marker,this.rules=T.rules,this.initial=T.initial,this.random=T.random,this.solo=T.solo,this.allyDeck=T.allyDeck,this.lootDeckConfig=T.lootDeckConfig,this.parent=T.parent,this.parentSections=T.parentSections,this.blockedSections=T.blockedSections,this.resetRound=T.resetRound,this.rewards=T.rewards,this.retirement=T.retirement,this.conclusion=T.conclusion,this.repeatable=T.repeatable,this.edition=T.edition,this.spoiler=T.spoiler,this.named=T.named,this.hideIndex=T.hideIndex,this.complexity=T.complexity,this.level=T.level,this.overlays=T.overlays,this.spotlight=T.spotlight)}}class O{globalAchievements=[];partyAchievements=[];lostPartyAchievements=[];campaignSticker=[];envelopes=[];gold=0;experience=0;collectiveGold=0;reputation=0;prosperity=0;perks=0;battleGoals=0;items=[];chooseItem=[];chooseLocation=[];itemDesigns=[];events=[];eventDecks=[];removeEvents=[];itemBlueprints=[];randomItemBlueprint=0;randomItemBlueprints="";randomItem="";randomItems="";morale="";inspiration="";resources=[];collectiveResources=[];calendarSection=[];calendarSectionConditional=[];calendarSectionManual=[];calendarIgnore=!1;lootDeckCards=[];removeLootDeckCards=[];townGuardAm=[];unlockCharacter="";chooseUnlockCharacter=[];lootingGold=void 0;custom="";ignoredBonus=[];overlaySticker=void 0;overlayCampaignSticker=void 0;pet=void 0;repeatScenario=!1;reputationFactions=[];factionUnlock="";randomSideScenario=0;hints=void 0;valueMapping=void 0}class c{conclusion;success=!1;battleGoals=[];collectiveGold=[];collectiveResources=[];items=[];chooseLocation;chooseUnlockCharacter;challenges=0;calendarSectionConditional=[];calenderSectionManual=[];calendarSectionManual=[];randomItem=void 0;randomItemIndex=-1;randomItems=[];randomItemBlueprints=[];trials=[]}},2065(u,y,v){v.d(y,{R:()=>E});var M=v(8317),x=v(3812),O=v(6066),V=v(8164),c=v(3018);class E extends c.f{summonColor=V.rX.blue;statEffect;level;off=!1;active=!1;drawExtra=!1;lastDraw=0;type="monster";getInitiative(){const B=M.E.monsterManager.getAbility(this,M.E.monsterManager.hasBottomActions(this));let q=M.E.gameplayFigure(this)&&B&&B.initiative||100;return this.statEffect&&this.statEffect.initiative&&(q=this.statEffect.absolute?(0,x.hZ)(this.statEffect.initiative):q+(0,x.hZ)(this.statEffect.initiative)),M.E.challengesManager.apply&&M.E.challengesManager.isActive(1501,"fh")&&!this.isAlly&&(q-=10),Math.min(Math.max(q,1),100)}ability=-1;abilities=[];entities=[];isAlly=!1;isAllied=!1;tags=[];constructor(B,q=1){if(super(B),this.errors=B.errors,this.level=q,this.tags=[],B.baseStat&&B.stats)for(let I of B.stats){if(!I.health&&0!=I.health&&(I.health=B.baseStat.health||0),!I.movement&&0!=I.movement&&(I.movement=B.baseStat.movement||0),!I.attack&&0!=I.attack&&(I.attack=B.baseStat.attack||0),!I.range&&0!=I.range&&(I.range=B.baseStat.range||0),I.actions||(I.actions=Object.assign([],B.baseStat.actions)),I.immunities||(I.immunities=Object.assign([],B.baseStat.immunities)),!I.special&&(I.special=[],B.baseStat.special))for(let s of B.baseStat.special)I.special.push(Object.assign([],s));I.note||(I.note=B.baseStat.note),I.type||(I.type=B.baseStat.type)}}toModel(){return new R(this.name,this.edition,this.level,this.off,this.active,this.drawExtra,this.lastDraw,this.ability,this.abilities,this.entities.map(B=>B.toModel()),this.isAlly,this.isAllied,this.tags)}fromModel(B){if(this.edition=B.edition,!this.edition){const q=M.E.monstersData().find(I=>I.name==B.name);this.edition=q?q.edition:""}this.level=B.level,this.off=B.off,this.active=B.active,this.drawExtra=B.drawExtra,this.lastDraw=B.lastDraw,this.abilities=B.abilities&&B.abilities.length>0&&B.abilities||M.E.abilities(this)&&M.E.abilities(this).map((q,I)=>I)||[],this.ability=B.ability,this.entities=this.entities.filter(q=>B.entities.find(I=>I.number==q.number&&I.type==q.type)),B.entities.forEach((q,I)=>{let s=this.entities.find(D=>D.number==q.number&&D.type==q.type);s?I!=this.entities.indexOf(s)&&(this.entities.splice(this.entities.indexOf(s),1),this.entities.splice(I,0,s)):(s=new O.I(q.number,q.type,this),this.entities.splice(I,0,s)),s.fromModel(q)}),this.isAlly=B.isAlly,this.isAllied=B.isAllied,this.statEffect=void 0,this.tags=B.tags||[]}}class R{name;edition;level;off;active;drawExtra;lastDraw;ability;abilities;entities;isAlly;isAllied;tags;constructor(B,q,I,s,D,p,G,H,b,S,A,F,t){this.name=B,this.edition=q,this.level=I,this.off=s,this.active=D,this.drawExtra=p,this.lastDraw=G,this.ability=H,this.abilities=JSON.parse(JSON.stringify(b)),this.entities=JSON.parse(JSON.stringify(S)),this.isAlly=A,this.isAllied=F,this.tags=JSON.parse(JSON.stringify(t))}}},2120(u,y,v){v.d(y,{Gq:()=>M,dy:()=>O,mC:()=>V,wd:()=>x});var M=function(c){return c.active="active",c.target="target",c.conditional="conditional",c.ally="ally",c.blank="blank",c.enhance="enhance",c.invisible="invisible",c}(M||{});class x{x=0;y=0;type=M.active;value="";constructor(E,R,T,B){this.x=E,this.y=R,this.type=T,this.value=B}}function O(c){let E=new RegExp(/^\((\d+),(\d+),(active|target|conditional|ally|blank|enhance|invisible)(\:(\w*))?\)$/).exec(c);if(null==E)return null;let R="";return E.length>5&&E[5]&&(R=E[5]),new x(+E[1],+E[2],E[3],R)}function V(c){return"("+c.x+","+c.y+","+M[c.type]+(c.value?":"+c.value:"")+")"}},2357(u,y,v){v.d(y,{BR:()=>c,GV:()=>x,Xo:()=>R,kW:()=>V,mg:()=>O,r5:()=>M});var M=function(T){return T.stun="stun",T.immobilize="immobilize",T.disarm="disarm",T.wound="wound",T.muddle="muddle",T.poison="poison",T.strengthen="strengthen",T.invisible="invisible",T.curse="curse",T.bless="bless",T.regenerate="regenerate",T.ward="ward",T.bane="bane",T.brittle="brittle",T.impair="impair",T.chill="chill",T.infect="infect",T.rupture="rupture",T.dodge="dodge",T.empower="empower",T.enfeeble="enfeeble",T.poison_x="poison_x",T.wound_x="wound_x",T.heal="heal",T.shield="shield",T.retaliate="retaliate",T.safeguard="safeguard",T.plague="plague",T.invalid="invalid",T}(M||{}),x=function(T){return T.action="action",T.standard="standard",T.entity="entity",T.character="character",T.monster="monster",T.objective="objective",T.upgrade="upgrade",T.stack="stack",T.stackable="stackable",T.turn="turn",T.afterTurn="afterTurn",T.expire="expire",T.value="value",T.clearHeal="clearHeal",T.preventHeal="preventHeal",T.apply="apply",T.autoApply="autoApply",T.positive="positive",T.negative="negative",T.neutral="neutral",T.double="double",T.expiredIndicator="expiredIndicator",T.hidden="hidden",T.amDeck="amDeck",T.highlightOnly="highlightOnly",T.special="special",T}(x||{}),O=function(T){return T.new="new",T.normal="normal",T.expire="expire",T.removed="removed",T.turn="turn",T}(O||{});class V{name;types=[];value=1;constructor(B,q=1){"string"==typeof B&&Object.keys(!M).includes(B)?(console.warn("Invalid condition name: "+B),this.name=M.invalid):this.name=B,this.value=q,this.types.push(x.action),[M.stun,M.immobilize,M.disarm,M.wound,M.muddle,M.poison,M.invisible,M.strengthen,M.regenerate,M.infect,M.bane,M.brittle,M.chill,M.ward,M.rupture,M.poison_x,M.wound_x,M.safeguard].includes(this.name)&&this.types.push(x.entity),[M.stun,M.immobilize,M.disarm,M.wound,M.muddle,M.poison,M.invisible,M.strengthen,M.regenerate,M.infect,M.bane,M.brittle,M.impair,M.rupture,M.ward,M.dodge,M.safeguard].includes(this.name)&&this.types.push(x.standard),(this.types.includes(x.entity)||[M.impair,M.dodge].includes(this.name))&&this.types.push(x.character),(this.types.includes(x.entity)||[M.plague].includes(this.name))&&this.types.push(x.monster),[M.poison_x,M.wound_x].includes(this.name)&&(this.types.push(x.upgrade),this.types.push(x.value)),[M.chill,M.plague].includes(this.name)&&this.types.push(x.stack),[M.chill,M.plague,M.bless,M.curse,M.enfeeble,M.empower].includes(this.name)&&this.types.push(x.stackable),[M.wound,M.wound_x,M.regenerate].includes(this.name)&&this.types.push(x.turn),[M.bane].includes(this.name)&&this.types.push(x.afterTurn),[M.wound,M.wound_x,M.poison,M.poison_x,M.bane,M.brittle,M.infect,M.rupture].includes(this.name)&&this.types.push(x.clearHeal),[M.poison,M.poison_x,M.ward,M.brittle,M.heal,M.shield].includes(this.name)&&this.types.push(x.apply),[M.ward,M.brittle,M.heal,M.shield,M.safeguard].includes(this.name)&&this.types.push(x.autoApply),[M.poison,M.poison_x].includes(this.name)&&this.types.push(x.double),[M.poison,M.poison_x,M.infect].includes(this.name)&&this.types.push(x.preventHeal),[M.stun,M.immobilize,M.disarm,M.muddle,M.invisible,M.strengthen,M.impair].includes(this.name)&&this.types.push(x.expire),[M.regenerate,M.ward,M.invisible,M.strengthen,M.bless,M.dodge,M.safeguard].includes(this.name)&&this.types.push(x.positive),[M.stun].includes(this.name)&&this.types.push(x.expiredIndicator),[M.heal,M.shield,M.retaliate].includes(this.name)&&(this.types.push(x.positive),this.types.push(x.hidden),this.types.push(x.value)),[M.bless,M.curse,M.empower,M.enfeeble].includes(this.name)&&(this.types.push(x.hidden),this.types.push(x.amDeck)),[M.retaliate].includes(this.name)&&this.types.push(x.highlightOnly),[M.invalid].includes(this.name)&&this.types.push(x.hidden),[M.plague].includes(this.name)&&(this.types.push(x.neutral),this.types.push(x.objective),this.types.push(x.special)),!this.types.includes(x.positive)&&!this.types.includes(x.neutral)&&this.types.push(x.negative)}}class c extends V{state;lastState;permanent=!1;expired=!1;highlight=!1;constructor(B,q=1){super(B,q),this.state=O.normal,this.lastState=O.new}toModel(){return new E(this.name,this.value,this.state,this.lastState,this.permanent,this.expired,this.highlight)}fromModel(B){this.name=B.name,this.value=B.value,this.state=B.state,this.lastState=B.lastState,this.permanent=B.permanent,this.expired=B.expired,this.highlight=B.highlight}}class E{name;value;state;lastState;permanent;expired;highlight=!1;constructor(B,q,I,s,D,p,G){this.name=B,this.value=q,this.state=I,this.lastState=s,this.permanent=D,this.expired=p,this.highlight=G}}const R=Object.values(M).map(T=>new V(T))},2941(u,y,v){v.d(y,{TQ:()=>O,Tr:()=>c,o8:()=>x});var x=function(E){return E.head="head",E.body="body",E.legs="legs",E.onehand="onehand",E.twohand="twohand",E.small="small",E}(x||{}),O=function(E){return E.condition="condition",E.immune="immune",E.heal="heal",E.damage="damage",E.element="element",E.initiative="initiative",E.refreshSpent="refreshSpent",E.removeNegativeConditions="removeNegativeConditions",E}(O||{}),c=function(E){return E.spent="spent",E.consumed="consumed",E.flipped="flipped",E.persistent="persistent",E.slot="slot",E.slotBack="slotBack",E}(c||{})},3018(u,y,v){v.d(y,{f:()=>O});var M=v(392),x=v(6538);class O{name="";count=0;randomCount=0;standeeCount;standeeShare;standeeShareEdition;baseStat=new M.f(x.N.normal);stats=[];deck="";boss=!1;bb=!1;flying=!1;immortal=!1;thumbnail;thumbnailUrl;noThumbnail=!1;noArtwork=!1;pet="";firstActiveAction=!1;edition="";spoiler=!1;errors=[];hidden=!1;replace=!1;constructor(c=void 0){c&&(this.name=c.name,this.count=c.count,this.randomCount=c.randomCount,this.standeeCount=c.standeeCount,this.standeeShare=c.standeeShare,this.standeeShareEdition=c.standeeShareEdition,this.baseStat=c.baseStat,this.stats=c.stats||[],this.deck=c.deck,this.boss=c.boss,this.bb=c.bb,this.flying=c.flying,this.immortal=c.immortal,this.thumbnail=c.thumbnail,this.thumbnailUrl=c.thumbnailUrl,this.noThumbnail=c.noThumbnail,this.noArtwork=c.noArtwork,this.pet=c.pet,this.firstActiveAction=c.firstActiveAction,this.edition=c.edition,this.spoiler=c.spoiler,this.errors=c.errors||[],this.hidden=c.hidden,this.replace=c.replace)}}},3219(u,y,v){v.d(y,{IK:()=>B,J:()=>G,Yn:()=>M,_v:()=>T,bx:()=>D,hM:()=>c,hY:()=>V,iy:()=>I,oz:()=>E,qM:()=>H,qq:()=>q,tW:()=>x,u3:()=>s,uU:()=>O,vY:()=>p,zs:()=>R});var M=function(b){return b.plus="plus",b.plus0="plus0",b.plus1="plus1",b.plus2="plus2",b.plus3="plus3",b.plus4="plus4",b.plusX="plusX",b.minus="minus",b.minus1="minus1",b.minus2="minus2",b.null="null",b.double="double",b.bless="bless",b.curse="curse",b.minus1extra="minus1extra",b.empower="empower",b.enfeeble="enfeeble",b.invalid="invalid",b.townguard="townguard",b.wreck="wreck",b.success="success",b.imbue="imbue",b.advancedImbue="advancedImbue",b}(M||{}),x=function(b){return b.default="default",b.plus="plus",b.minus="minus",b.multiply="multiply",b}(x||{});class O{id;type;value=0;valueType;shuffle=!1;effects;rolling;active;revealed=!1;character=!1;constructor(S,A=0,F=x.plus,t=void 0,N=[],K=!1,w=!1,Q=void 0){switch(this.type=S,this.value=A,this.valueType=F,this.id=t||(S==M.townguard?"tg-"+F+A:S==M.wreck||S==M.success?"tg-"+S:S!=M.plus&&S!=M.minus?S:S+A),this.effects=N,this.rolling=K,this.active=w,this.shuffle=Q||!1,S){case M.plus0:this.value=0;break;case M.plus1:this.value=1;break;case M.plus2:this.value=2;break;case M.plus3:this.value=3;break;case M.plus4:this.value=4;break;case M.minus:this.valueType=x.minus;break;case M.minus1:this.valueType=x.minus,this.value=1;break;case M.minus2:this.valueType=x.minus,this.value=2;break;case M.null:this.valueType=x.multiply,this.value=0,null==Q&&(this.shuffle=!0);break;case M.double:this.valueType=x.multiply,this.value=2,null==Q&&(this.shuffle=!0);break;case M.bless:this.valueType=x.multiply,this.value=2;break;case M.curse:this.valueType=x.multiply,this.value=0;break;case M.minus1extra:this.valueType=x.minus,this.value=1;break;case M.wreck:this.valueType=x.minus,this.value=0;break;case M.success:this.value=0}}}var V=function(b){return b.area="area",b.changeType="changeType",b.condition="condition",b.custom="custom",b.element="element",b.elementConsume="elementConsume",b.elementHalf="elementHalf",b.heal="heal",b.pierce="pierce",b.pull="pull",b.push="push",b.range="range",b.recoverRandomDiscard="recoverRandomDiscard",b.refreshItem="refreshItem",b.refreshSpentItem="refreshSpentItem",b.required="required",b.retaliate="retaliate",b.shield="shield",b.specialTarget="specialTarget",b.summon="summon",b.swing="swing",b.target="target",b.attack="attack",b.or="or",b}(V||{});class c{type;value;hint;effects;icon=!1;constructor(S,A="",F="",t=[],N=!1){this.type=S,this.value=A,this.hint=F,this.effects=t,this.icon=N}}class E{index;chooseOffset;state;attack;stringified;result;effects;constructor(S,A,F,t,N,K,w){this.index=S,this.chooseOffset=A,this.state=F,this.attack=t,this.stringified=N,this.result=K,this.effects=w}}const R=[new O(M.plus0),new O(M.plus1),new O(M.minus1),new O(M.plus2),new O(M.minus2),new O(M.double),new O(M.null),new O(M.bless),new O(M.curse),new O(M.minus1extra)],T=[new O(M.plus0),new O(M.plus0),new O(M.plus0),new O(M.plus0),new O(M.plus0),new O(M.plus0),new O(M.plus1),new O(M.plus1),new O(M.plus1),new O(M.plus1),new O(M.plus1),new O(M.minus1),new O(M.minus1),new O(M.minus1),new O(M.minus1),new O(M.minus1),new O(M.plus2),new O(M.minus2),new O(M.double),new O(M.null)],B=[new O(M.townguard,0,x.default),new O(M.townguard,0,x.default),new O(M.townguard,0,x.default),new O(M.townguard,0,x.default),new O(M.townguard,0,x.default),new O(M.townguard,0,x.default),new O(M.townguard,10),new O(M.townguard,10),new O(M.townguard,10),new O(M.townguard,10),new O(M.townguard,10),new O(M.townguard,20),new O(M.townguard,10,x.minus),new O(M.townguard,10,x.minus),new O(M.townguard,10,x.minus),new O(M.townguard,10,x.minus),new O(M.townguard,10,x.minus),new O(M.townguard,20,x.minus),new O(M.wreck),new O(M.success)],q=[new O(M.townguard,0,x.default,"fh-tg-add-plus0"),new O(M.townguard,10,x.plus,"fh-tg-add-plus10"),new O(M.townguard,10,x.minus,"fh-tg-add-minus10"),new O(M.townguard,20,x.plus,"fh-tg-add-plus20"),new O(M.townguard,20,x.minus,"fh-tg-add-minus20"),new O(M.townguard,30,x.plus,"fh-tg-add-plus30"),new O(M.townguard,50,x.plus,"fh-tg-add-plus50"),new O(M.wreck,0,x.default,"fh-tg-add-wreck"),new O(M.success,0,x.default,"fh-tg-add-success"),new O(M.townguard,10,x.plus,"fh-tg-add-plus10-soldier",[new c(V.custom,"fh-soldier","",[],!0)],!0),new O(M.townguard,20,x.plus,"fh-tg-add-plus20-soldier",[new c(V.custom,"fh-soldier","",[],!0)]),new O(M.townguard,30,x.plus,"fh-tg-add-plus30-soldier",[new c(V.custom,"fh-soldier","",[],!0)]),new O(M.townguard,10,x.plus,"fh-tg-add-plus10-rolling",[],!0),new O(M.townguard,10,x.plus,"fh-tg-add-plus10-advantage",[new c(V.custom,"game.custom.advantage")],!0),new O(M.townguard,20,x.minus,"fh-tg-add-minus20-resource",[new c(V.custom,"+2 material resource")]),new O(M.townguard,0,x.default,"fh-tg-add-resource-hide",[new c(V.custom,"+1%game.resource.hide%","Gain one Hide")]),new O(M.townguard,0,x.default,"fh-tg-add-resource-lumber",[new c(V.custom,"+1%game.resource.lumber%","Gain one Lumber")]),new O(M.townguard,0,x.default,"fh-tg-add-resource-metal",[new c(V.custom,"+1%game.resource.metal%","Gain one Metal")]),new O(M.townguard,50,x.plus,"fh-tg-add-plus50-algox",[new c(V.custom,"fh-algox","",[],!0)]),new O(M.townguard,50,x.plus,"fh-tg-add-plus50-unfettered",[new c(V.custom,"fh-unfettered","",[],!0)]),new O(M.townguard,50,x.plus,"fh-tg-add-plus50-lurkers",[new c(V.custom,"fh-lurkers","",[],!0)])],I=[new O(M.imbue,1,x.plus,"gh2e-imbue-1"),new O(M.imbue,1,x.plus,"gh2e-imbue-2"),new O(M.imbue,1,x.plus,"gh2e-imbue-3"),new O(M.imbue,0,x.plus,"gh2e-imbue-4",[new c(V.condition,"poison")]),new O(M.imbue,2,x.plus,"gh2e-imbue-5",[new c(V.condition,"muddle")])],s=[new O(M.advancedImbue,3,x.plus,"gh2e-advancedImbue-1"),new O(M.advancedImbue,0,x.plus,"gh2e-advancedImbue-2",[new c(V.condition,"wound")]),new O(M.advancedImbue,1,x.plus,"gh2e-advancedImbue-3",[new c(V.condition,"curse")]),new O(M.advancedImbue,1,x.plus,"gh2e-advancedImbue-4",[new c(V.heal,"1","",[new c(V.specialTarget,"self")])]),new O(M.advancedImbue,1,x.plus,"gh2e-advancedImbue-5",[new c(V.heal,"1","",[new c(V.specialTarget,"self")])])],D=[new O(M.double,2,x.multiply,"cs-oak-527",[new c(V.condition,"bless","",[new c(V.specialTarget,"allyShort")])]),new O(M.double,2,x.multiply,"cs-oak-528",[new c(V.condition,"bless","",[new c(V.specialTarget,"allyShort")])]),new O(M.double,2,x.multiply,"cs-oak-529",[new c(V.heal,"2","",[new c(V.range,"2")])]),new O(M.double,2,x.multiply,"cs-oak-530",[new c(V.heal,"2","",[new c(V.range,"2")])]),new O(M.double,2,x.multiply,"cs-oak-531",[new c(V.element,"wild")]),new O(M.double,2,x.multiply,"cs-oak-532",[new c(V.element,"wild")]),new O(M.double,2,x.multiply,"cs-oak-533",[new c(V.custom,"All enemies adjacent to the target suffer %game.damage:1%")]),new O(M.double,2,x.multiply,"cs-oak-534",[new c(V.custom,"All enemies adjacent to the target suffer %game.damage:1%")]),new O(M.plus1,1,x.plus,"cs-oak-535",[new c(V.push,"2")],!0),new O(M.plus1,1,x.plus,"cs-oak-536",[new c(V.push,"2")],!0),new O(M.plus1,1,x.plus,"cs-oak-537",[new c(V.heal,"1","",[new c(V.range,"2")])],!0),new O(M.plus1,1,x.plus,"cs-oak-538",[new c(V.heal,"1","",[new c(V.range,"2")])],!0),new O(M.plus0,0,x.plus,"cs-oak-539",[new c(V.condition,"wound"),new c(V.condition,"muddle")],!0),new O(M.plus0,0,x.plus,"cs-oak-540",[new c(V.condition,"wound"),new c(V.condition,"muddle")],!0),new O(M.plus1,1,x.plus,"cs-oak-541",[new c(V.pierce,"3")],!0),new O(M.plus1,1,x.plus,"cs-oak-542",[new c(V.pierce,"3")],!0)],p=[new O(M.plus1,1,x.plus,"gh2e-military-1",[new c(V.condition,"strengthen","",[new c(V.specialTarget,"ally")])]),new O(M.plus1,1,x.plus,"gh2e-military-2",[new c(V.shield,"1")],!0),new O(M.plus1,1,x.plus,"gh2e-military-3",[new c(V.push,"2")],!0),new O(M.plus0,0,x.plus,"gh2e-military-4",[new c(V.custom,"%data.custom.gh2e.am.military-4%")],!0),new O(M.plus1,1,x.plus,"gh2e-merchant-guild-1",[new c(V.condition,"curse")]),new O(M.plus1,1,x.plus,"gh2e-merchant-guild-2",[new c(V.condition,"wound")]),new O(M.plus0,0,x.plus,"gh2e-merchant-guild-3",[new c(V.heal,"2")],!0),new O(M.plus1,1,x.plus,"gh2e-merchant-guild-4",[new c(V.custom,"%data.custom.gh2e.am.merchant-guild-4%")],!0),new O(M.plus1,1,x.plus,"gh2e-demons-1",[new c(V.element,"wild")]),new O(M.plus1,1,x.plus,"gh2e-demons-2",[new c(V.retaliate,"1")],!0),new O(M.plus0,0,x.plus,"gh2e-demons-3",[new c(V.condition,"ward","",[new c(V.specialTarget,"ally")])],!0),new O(M.plus1,1,x.plus,"gh2e-demons-4",[new c(V.custom,"%data.custom.gh2e.am.demons-4%")],!0)];class G{attackModifiers;current;cards;discarded=[];active=!0;lastVisible=0;state;bb;constructor(S=void 0,A=!1){this.bb=A,this.attackModifiers=(S?S.filter((F,t,N)=>this.bb||N.indexOf(F)==t):R).map(F=>Object.assign(new O(F.type),F)),this.current=-1,this.cards=(S||T).map(F=>Object.assign(new O(F.type),F))}toModel(){return new H(this.current,this.cards.map(S=>S&&S.id),this.discarded,this.active,this.lastVisible,this.state,this.bb)}merge(S){this.attackModifiers=S.attackModifiers,this.current=S.current,this.cards=S.cards,this.discarded=S.discarded,this.lastVisible=S.lastVisible,this.state=S.state,this.bb=S.bb}}class H{current;cards;discarded;active;lastVisible;state;bb;disgarded;constructor(S,A,F,t,N=0,K=void 0,w=!1){this.current=S,this.cards=A,this.discarded=JSON.parse(JSON.stringify(F)),this.active=t,this.lastVisible=N,this.state=K,this.bb=w,this.disgarded=JSON.parse(JSON.stringify(F))}}},3391(u,y,v){v.d(y,{x:()=>M});class M{characters=!1;character=[];monsters=!1;monster=[];scenario=!1;elements=!1;round=!1;level=!1;attackModifiers=!1;lootDeck=!1;party=!1}},3414(u,y,v){v.d(y,{_K:()=>O,lS:()=>x,uh:()=>E}),v(57);class x{round;start=!1;always=!1;alwaysApply=!1;alwaysApplyTurn=!1;once=!1;requiredRooms=[];requiredRules=[];disablingRules=[];requiredScenarios=[];note="";noteTop="";rooms=[];sections=[];figures=[];spawns=[];objectiveSpawns=[];elements=[];elementTrigger=[];disableRules=[];treasures=[];randomDungeon;statEffects=[];finish=void 0;constructor(s){this.round=s}}class O{monster;count;marker;summon;manual;manualMin;manualMax;constructor(s){this.monster=s.monster,this.count=s.count||1,this.marker=s.marker||"",this.summon=s.summon||!1,this.manual=s.manual||!1,this.manualMin=s.manualMin||0,this.manualMax=s.manualMax||0}}const E=["present","dead","killed","initiative","onTurn","afterTurn"]},3417(u,y,v){v.d(y,{RU:()=>V}),v(3219);var V=function(c){return c.add="add",c.remove="remove",c.replace="replace",c.custom="custom",c}(V||{})},3492(u,y,v){v.d(y,{U2:()=>c,W2:()=>O,lV:()=>V});var M=v(8317),x=v(57);class O{cardId=0;edition="";automation}class V{current=-1;finished=-1;keep=[];cards=[];active=!1;fromModel(R){this.current=R.current,this.finished=R.finished,this.keep=R.keep||[],this.cards=R.cards?R.cards.map(T=>M.E.challengesManager.getChallengeCard(T)).filter(T=>T).map(T=>T):[],this.active=R.active}toModel(){let R=new c;return R.current=this.current,R.finished=this.finished,R.keep=this.keep&&JSON.parse(JSON.stringify(this.keep))||[],R.cards=this.cards.map(T=>new x.gw(""+T.cardId,T.edition)),R.active=this.active,R}}class c{current=-1;finished=-1;keep=[];cards=[];active=!1}},3812(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{LK:()=>EntityValueRegexExtended,OD:()=>EntityValueRegex,hZ:()=>EntityValueFunction,p5:()=>EntityExpressionRegex});var _businesslogic_GameManager__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8317),_Game__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(9765);const EntityExpressionRegex=/^([xCL0-9\.\+\/\-\*\(\)\=\?\:\|\s\>\<]+)$/,EntityValueRegex=/\[([xCL0-9\.\+\/\-\*\(\)\=\?\:\|\s\>\<]+)(\{(.*)\})?\]/,EntityValueRegexExtended=/\[([a-zA-Z0-9\.\+\/\-\*\(\)\=\?\:\|\s\>\<]+)(\{(.*)\})?\]/;function EntityValueFunction(value,L=void 0){if(!value)return 0;if("number"==typeof value)return value;if("-"==value)return 0;let expression=value,func;const match=value.match(EntityValueRegex);match&&match[0].length==value.length&&(expression=match[1],func=match[3]),null==L&&(L=_businesslogic_GameManager__WEBPACK_IMPORTED_MODULE_0__.E.game.level),expression=expression.replace(/[x]/g,"*"),expression=expression.replace(/[C]/g,""+Math.max(2,_businesslogic_GameManager__WEBPACK_IMPORTED_MODULE_0__.E.characterManager.characterCount())),expression=expression.replace(/[L]/g,""+L),expression=expression.replace(/[P]/g,""+_businesslogic_GameManager__WEBPACK_IMPORTED_MODULE_0__.E.prosperityLevel()),expression=expression.replace(/[R]/g,""+(_businesslogic_GameManager__WEBPACK_IMPORTED_MODULE_0__.E.game.round+(_businesslogic_GameManager__WEBPACK_IMPORTED_MODULE_0__.E.game.state==_Game__WEBPACK_IMPORTED_MODULE_1__.mk.draw?1:0)));let result=0,funcValue;try{result=eval(expression)}catch(u){return console.warn("Could not evaluate expression: "+expression,u),0}if(func&&func.startsWith("$")&&(func=func.replace("$",""),func.includes(":")&&(funcValue=+func.split(":")[1],func=func.split(":")[0])),func)switch(!0){case"math.ceil"==func:result=Math.ceil(result);break;case"math.floor"==func:result=Math.floor(result);break;case"math.max"==func&&null!=funcValue:result=Math.min(result,funcValue);break;case"math.maxCeil"==func&&null!=funcValue:result=Math.ceil(Math.min(result,funcValue));break;case"math.maxFloor"==func&&null!=funcValue:result=Math.floor(Math.min(result,funcValue));break;case"math.min"==func&&null!=funcValue:result=Math.max(result,funcValue);break;case"math.minCeil"==func&&null!=funcValue:result=Math.ceil(Math.max(result,funcValue));break;case"math.minFloor"==func&&null!=funcValue:result=Math.floor(Math.max(result,funcValue));break;default:console.error("Unknown expression: "+func+"("+match+")")}return Math.round(result)}},4074(u,y,v){v.d(y,{J:()=>M,V:()=>x});var M=function(O){return O.square="square",O.circle="circle",O.diamond="diamond",O.diamond_plus="diamond_plus",O.hex="hex",O.any="any",O}(M||{});class x{cardId;actionIndex;index;action;inherited;constructor(V,c,E,R,T=!1){this.cardId=V,this.actionIndex=c,this.index=E,this.action=R,this.inherited=T}}},4670(u,y,v){v.d(y,{DJ:()=>E,It:()=>I,KZ:()=>c,L$:()=>p,T8:()=>q,Z:()=>V,bb:()=>D,co:()=>G,gP:()=>R,n1:()=>B,oB:()=>T,yE:()=>H});var M=v(2200),x=v(1619);function O(){return+window.getComputedStyle(document.body).getPropertyValue("--ghs-width").replace(/[^\d\+]/g,"")/+window.getComputedStyle(document.body).getPropertyValue("--ghs-factor")}function V(b){let A,S=b.length;for(;0!=S;)A=Math.floor(Math.random()*S),S--,[b[S],b[A]]=[b[A],b[S]];return b}function c(b,S=!1){return S?b.filter(A=>A.spoiler&&!x.f.settings.spoilers.includes(A.name)).length>1:b.some(A=>A.spoiler&&!x.f.settings.spoilers.includes(A.name))}function E(b){return!b.spoiler||x.f.settings.spoilers.includes("[ALL]")||x.f.settings.spoilers.includes(b.name)}function R(b){return b.filter(S=>!E(S))}function T(b,S,A=!1){return A?b.toLowerCase()==S.toLowerCase():S.split(" ").every(F=>-1!=b.toLowerCase().indexOf(F.toLowerCase()))}function B(b,S=!1){return b>0?"+"+b:S&&0==b?"-":""+b}function q(b,S=!1){let A=Math.floor(b);const F=Math.floor(A/86400);A-=86400*F;const t=Math.floor(A/3600);A-=3600*t;const N=Math.floor(A/60);A-=60*N;let K=x.f.getLabel("duration."+((F?"days":t&&"hours")||N&&"minutes"||"seconds"),[A,N,t,F].map(w=>""+w),!1);return S&&(K=x.f.getLabel("duration.totalHours",[K,(b/3600).toFixed(1)])),K}function I(){x.f.settings.fullscreen&&document.fullscreenElement&&(document.exitFullscreen&&document.exitFullscreen(),document.body.classList.add("fullscreen")),window.addEventListener("focus",s,!0)}function s(b){setTimeout(()=>{if(x.f.settings.fullscreen&&!document.fullscreenElement){try{document.body.requestFullscreen&&document.body.requestFullscreen()}catch{}document.body.classList.remove("fullscreen")}window.removeEventListener("focus",s,!0)})}function D(b){return!b.metaKey&&(!window.document.activeElement||"INPUT"!=window.document.activeElement.tagName&&"SELECT"!=window.document.activeElement.tagName&&"TEXTAREA"!=window.document.activeElement.tagName)}function p(b,S){return(b%S+S)%S}function G(b,S=void 0){x.f.settings.animations&&b.overlayRef.overlayElement?(b.overlayRef.overlayElement.classList.add("dialog-closing"),b.overlayRef.hostElement&&b.overlayRef.hostElement.getElementsByClassName("dialog-close-button")[0]&&b.overlayRef.hostElement.getElementsByClassName("dialog-close-button")[0].classList.add("closing"),b.overlayRef.backdropElement&&b.overlayRef.backdropElement.classList.add("backdrop-closing"),setTimeout(()=>b.close(S),250)):b.close(S)}function H(b="right"){const F=[new M.uH({originX:"end",originY:"top"},{overlayX:"start",overlayY:"top"},1.5*O(),-3*O()),new M.uH({originX:"end",originY:"center"},{overlayX:"start",overlayY:"center"}),new M.uH({originX:"end",originY:"bottom"},{overlayX:"start",overlayY:"bottom"},1.5*O(),3*O())],t=[new M.uH({originX:"start",originY:"top"},{overlayX:"end",overlayY:"top"},-1.5*O(),-3*O()),new M.uH({originX:"start",originY:"center"},{overlayX:"end",overlayY:"center"}),new M.uH({originX:"start",originY:"bottom"},{overlayX:"end",overlayY:"bottom"},-1.5*O(),3*O())],N=[new M.uH({originX:"center",originY:"bottom"},{overlayX:"center",overlayY:"top"},0,3*O()),new M.uH({originX:"center",originY:"center"},{overlayX:"center",overlayY:"center"}),new M.uH({originX:"center",originY:"top"},{overlayX:"center",overlayY:"bottom"},0,-3*O())];switch(b){case"right":return[...F,...t,...N];case"left":return[...t,...F,...N];case"center":return[...N,...t,...F]}}},4786(u,y,v){v.d(y,{H:()=>M,h:()=>x});var M=function(O){return O.deck="deck",O.monsterEdition="monsterEdition",O.monsterType="monsterType",O.stat="stat",O.unknown="unknown",O}(M||{});class x{type;args;constructor(V,...c){this.type=V,this.args=c}}},4933(u,y,v){v.d(y,{$e:()=>O,ZM:()=>c});var M=v(8317),x=v(6719);class O{uuid;marker="";title="";escort=!1;entities=[];amDeck;noThumbnail=!0;summonColor="";name="";level=0;off=!1;active=!1;edition="";health=7;initiative=99;type="objectiveContainer";objectiveId;constructor(R,T=void 0){this.uuid=R,this.objectiveId=T}getInitiative(){let R=.9;if(this.objectiveId){const T=M.E.objectiveManager.objectiveDataByObjectiveIdentifier(this.objectiveId);if(T&&T.initiativeShare&&T.initiativeShare.split(":").length>1){if(this.initiative<1)return 100;R=+T.initiativeShare.split(":")[1]}}return this.initiative+R}toModel(){return new V(this.uuid,this.marker,this.title,this.name,this.escort,this.entities.map(R=>R.toModel()),this.level,this.off,this.active,this.health,this.initiative,this.objectiveId&&"scenario"in this.objectiveId?this.objectiveId:void 0,this.objectiveId&&!("scenario"in this.objectiveId)?this.objectiveId:void 0,this.amDeck)}fromModel(R){this.marker=R.marker,this.title=R.title,this.name=R.name,this.escort=R.escort,this.edition=R.escort?"escort":"objective",this.entities=this.entities.filter(T=>R.entities.some(B=>B.uuid==T.uuid)),R.entities.forEach((T,B)=>{let q=this.entities.find(I=>T.uuid==I.uuid);q?B!=this.entities.indexOf(q)&&(this.entities.splice(this.entities.indexOf(q),1),this.entities.splice(B,0,q)):(q=new x.X(T.uuid,T.number,this,this.marker),this.entities.splice(B,0,q)),q.fromModel(T)}),this.entities.sort((T,B)=>R.entities.map(q=>q.uuid).indexOf(T.uuid)-R.entities.map(q=>q.uuid).indexOf(B.uuid)),this.level=R.level,this.off=R.off,this.active=R.active,this.health=R.health,this.initiative=R.initiative,this.objectiveId=R.additionalObjectiveId||R.objectiveId,this.amDeck=R.amDeck||void 0}}class V{uuid;marker;title;name;escort;entities;level;off;active;health;initiative;objectiveId;additionalObjectiveId;amDeck;constructor(R,T,B,q,I,s,D,p,G,H,b,S,A,F){this.uuid=R,this.marker=T,this.title=B,this.name=q,this.escort=I,this.entities=s,this.level=D,this.off=p,this.active=G,this.health=H,this.initiative=b,this.objectiveId=S&&JSON.parse(JSON.stringify(S))||void 0,this.additionalObjectiveId=A&&JSON.parse(JSON.stringify(A))||void 0,this.amDeck=F}}const c=["","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","A","B","C","D","E","F","G","H","I","J","K","L","M"]},5385(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{a:()=>MonsterManager});var src_app_game_model_data_Action__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(840),src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(4786),src_app_ui_helper_Static__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(4670),_model_Entity__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3812),_model_Game__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(9765),_model_Monster__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2065),_model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(6066),_model_Summon__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(8164),_model_data_Condition__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(2357),_model_data_MonsterData__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(3018),_model_data_MonsterStat__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(392),_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(6538),_GameManager__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(8317),_SettingsManager__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(1619);class MonsterManager{game;constructor(u){this.game=u}monsterThumbnail(u){if(u.thumbnailUrl)return u.thumbnailUrl;if(!u.thumbnail&&u.standeeShare){const y=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monstersData(u.standeeShareEdition||u.edition).find(v=>v.name==u.standeeShare);y&&(this.monsterThumbnail(y),y.thumbnail&&(u.thumbnail=y.thumbnail))}return u.thumbnail||(u.thumbnail=u.edition+"-"+u.name),"./assets/images/monster/thumbnail/"+u.thumbnail+".png"}monsterArtwork(u){return u.noArtwork?this.monsterThumbnail(u):(this.monsterThumbnail(u),"./assets/artwork/monster/"+u.thumbnail+".png")}getStat(u,y){let v=u.stats.find(M=>M.level==u.level&&M.type==y);if(u.bb&&(v=y==_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_11__.N.elite&&u.stats[0]&&u.stats[0].type==_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_11__.N.elite?u.stats[0]:Object.assign(new _model_data_MonsterStat__WEBPACK_IMPORTED_MODULE_10__.f(y),u.baseStat)),v||(u.errors=u.errors||[],!u.errors.find(M=>M.type==src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__.H.unknown)&&!u.errors.find(M=>M.type==src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__.H.stat)&&(console.error("Could not find '"+y+"' stats for monster: "+u.name+" level: "+u.level),u.errors.push(new src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__.h(src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__.H.stat,"monster",u.name,u.edition,y,""+u.level))),v=new _model_data_MonsterStat__WEBPACK_IMPORTED_MODULE_10__.f(y,u.level)),v=JSON.parse(JSON.stringify(v)),u.statEffect){let M=new _model_data_MonsterStat__WEBPACK_IMPORTED_MODULE_10__.M;M.name=u.statEffect.name;const x=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(v.health,u.level);M.health="string"==typeof u.statEffect.health?u.statEffect.health.replaceAll("H",""+v.health).replace("[","").replace("]",""):u.statEffect.health,M.movement="string"==typeof u.statEffect.movement?u.statEffect.movement.replaceAll("M",""+v.movement).replace("[","").replace("]",""):u.statEffect.movement,M.attack="string"==typeof u.statEffect.attack?u.statEffect.attack.replaceAll("A",""+v.attack).replace("[","").replace("]",""):u.statEffect.attack,M.range="string"==typeof u.statEffect.range?u.statEffect.range.replaceAll("R",""+v.range).replace("[","").replace("]",""):u.statEffect.range,M.initiative=u.statEffect.initiative,M.flying=u.statEffect.flying,M.actions=u.statEffect.actions,M.special=u.statEffect.special,M.immunities=u.statEffect.immunities,M.absolute=u.statEffect.absolute,M.note=u.statEffect.note,M.absolute?(M.health&&(v.health="["+M.health+"]"),M.movement&&(v.movement="["+M.movement+"]"),M.attack&&(v.attack="["+M.attack+"]"),M.range&&(v.range="["+M.range+"]"),M.actions&&(v.actions=M.actions),M.special&&(v.special=M.special),M.immunities&&(v.immunities=M.immunities)):(M.health&&(v.health="["+v.health+"+"+M.health+"]"),M.movement&&(v.movement="["+v.movement+"+"+M.movement+"]"),M.attack&&(v.attack="["+v.attack+"+"+M.attack+"]"),M.range&&(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(v.range)&&(v.range="["+v.range+"+"+M.range+"]"),M.actions&&(v.actions=v.actions||[],v.actions=[...v.actions,...M.actions]),M.immunities&&(v.immunities=v.immunities||[],v.immunities=[...v.immunities,...M.immunities])),M.health&&u.entities.forEach(O=>{v&&O.type==y&&O.maxHealth!=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(v.health,u.level)&&(O.maxHealth=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(v.health,u.level),(O.health==x||O.health>O.maxHealth)&&(O.health=O.maxHealth))})}return v}getSpawnMonsters(u){let y=[];return u.forEach(v=>{this.getMonsterSpawns(v).forEach(M=>{y.includes(M)||y.push(M)})}),y}getMonsterSpawns(u){let y=[];const v=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(new _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R(u));return v&&v.abilities&&v.abilities.forEach(M=>{M.actions.forEach(x=>{this.getActionSpawns(x,u.edition).forEach(V=>{y.includes(V)||y.push(V)})})}),u.baseStat.special&&u.baseStat.special.forEach(M=>{M.forEach(x=>{this.getActionSpawns(x,u.edition).forEach(V=>{y.includes(V)||y.push(V)})})}),u.stats&&u.stats.forEach(M=>{M.special&&M.special.forEach(x=>{x.forEach(O=>{this.getActionSpawns(O,u.edition).forEach(c=>{y.includes(c)||y.push(c)})})})}),y}getActionSpawns(u,y){if(u.type==src_app_game_model_data_Action__WEBPACK_IMPORTED_MODULE_0__.X2.summon||u.type==src_app_game_model_data_Action__WEBPACK_IMPORTED_MODULE_0__.X2.spawn)if("summonData"!=u.value&&"monsterStandee"!=u.value){const v=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monstersData(y).find(M=>M.name==(""+u.value).split(":")[0]);if(v)return[v]}else if("monsterStandee"==u.value&&u.valueObject){let v=[];return u.valueObject.forEach(M=>{const x=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monstersData(y).find(O=>O.name==M.monster.name);x&&v.push(x)}),v}return u.subActions?u.subActions.map(v=>this.getActionSpawns(v,y)).flat():[]}addMonsterByName(name,edition){let level=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.level;name.split(":").length>1&&(level=eval(_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.level+name.split(":")[1]),level<0?level=0:level>7&&(level=7),name.split(":").length>2&&(edition=name.split(":")[2]),name=name.split(":")[0]);let monsterData=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monstersData().find(u=>u.name==name&&(u.edition==edition||_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.editionExtensions(edition).includes(u.edition)));if(monsterData||(console.warn("Monster not found: '"+name+"' for edition :"+edition),monsterData=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monstersData().find(u=>u.name==name),monsterData&&(monsterData.errors=monsterData.errors||[],monsterData.errors.find(u=>u.type==src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__.H.monsterEdition)||monsterData.errors.push(new src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__.h(src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__.H.monsterEdition,"monster",monsterData.name,edition,monsterData.edition)))),monsterData)return this.addMonster(monsterData,level);console.error("Monster not found: '"+name+"'")}addMonster(u,y){this.game.scenario||_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.scenarioManager.setScenario(_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.scenarioManager.createScenario());let v=this.game.figures.find(M=>M instanceof _model_data_MonsterData__WEBPACK_IMPORTED_MODULE_9__.f&&M.name==u.name&&M.edition==u.edition);return v?y!=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.level&&v.level!=y&&this.setLevel(v,y):(v=new _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R(u),this.applySameDeck(v),this.setLevel(v,y),v.off=!0,this.resetMonsterAbilities(v),this.game.figures.push(v)),_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.state==_model_Game__WEBPACK_IMPORTED_MODULE_4__.mk.next&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.sortFigures(v),v}resetMonsterAbilities(u){if(!this.applySameDeck(u)){if(!u.abilities||0==u.abilities.length){const y=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.abilities(u);u.abilities=y.map(v=>y.indexOf(v)).filter(v=>!y[v].level||isNaN(+y[v].level)||(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(y[v].level)<=u.level)}this.shuffleAbilities(u)}}removeMonster(u){u.entities=[],this.game.figures.splice(this.game.figures.indexOf(u),1),u.drawExtra||this.game.figures.forEach(y=>{y instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&y.drawExtra&&(y.name!=u.name||y.edition!=u.edition)&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(y).name==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(u).name&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(y).edition==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(u).edition&&(this.getSameDeckMonster(y)||(y.drawExtra=!1))})}monsterEntityCount(u,y=!1,v=void 0){return u.entities.filter(M=>(_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.entityManager.isAlive(M,y)||M.dormant)&&(!y||M.number>0)&&(!v||M.type==v)).length}monsterEntityCountIdentifier(u,y){return"all"!=y.type&&(y.name!=u.name||y.edition!=u.edition)||"monster"!=y.type?0:u.entities.filter(v=>_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.entityManager.isAlive(v)&&(!y.marker||y.marker==v.marker)&&(!y.tags||0==y.tags.length||y.tags.every(M=>v.tags.includes(M)))).length}monsterEntityCountAll(u){return _GameManager__WEBPACK_IMPORTED_MODULE_12__.E.entityManager.entities(u).length}monsterStandeeShared(u,y){return u.bb?(this.game.figures.forEach(M=>{M instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&M.bb&&!y.includes(M)&&y.push(M)}),y):(y.includes(u)||y.push(u),u.standeeShare&&this.game.figures.filter(x=>x instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&u.standeeShare&&x.name==u.standeeShare&&x.edition==(u.standeeShareEdition||u.edition)).map(x=>x).forEach(x=>{y.includes(x)||(y.push(x),this.monsterStandeeShared(x,y))}),this.game.figures.filter(M=>M instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&M.standeeShare&&u.name==M.standeeShare&&u.edition==(M.standeeShareEdition||M.edition)).map(M=>M).forEach(M=>{y.includes(M)||(y.push(M),this.monsterStandeeShared(M,y))}),y)}monsterStandeeUsed(u,y){return this.monsterStandeeShared(u,[]).map(v=>v.entities).flat().find(v=>(_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.entityManager.isAlive(v)||v.dormant)&&v.number==y)}monsterStandeeCount(u,y=!0){return this.monsterStandeeShared(u,[]).map(v=>v.entities).flat().filter(v=>(_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.entityManager.isAlive(v)||v.dormant)&&(y||v.number>0)).length}monsterStandeeMax(u){if(u.bb&&!_SettingsManager__WEBPACK_IMPORTED_MODULE_13__.f.settings.bbStandeeLimit)return 10;let y=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(u.standeeCount||u.count||0,u.level);if((!y||!u.standeeCount)&&u.standeeShare){const v=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monstersData(u.standeeShareEdition||u.edition).find(M=>M.name==u.standeeShare);v&&(y=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(v.standeeCount||v.count,u.level))}return y}monsterRandomStandee(u){let y=-1;const v=this.monsterStandeeMax(u);if([...Array(v).keys()].every(x=>_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monsterManager.monsterStandeeUsed(u,x+1)))return console.error("This should not happen: monsterRandomStandee called with all standees used already!"),y;const M=u.randomCount?(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(u.randomCount):0;if(M&&M<v&&[...Array(M).keys()].some(x=>!_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monsterManager.monsterStandeeUsed(u,x+1)))for(y=Math.floor(Math.random()*M)+1;_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monsterManager.monsterStandeeUsed(u,y);)y=Math.floor(Math.random()*M)+1;else for(y=Math.floor(Math.random()*v)+1;_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monsterManager.monsterStandeeUsed(u,y);)y=Math.floor(Math.random()*v)+1;return y}addMonsterEntity(u,y,v,M=!1){if(u.bb&&!u.baseStat||!u.bb&&!u.stats.some(O=>O.type==v))return u.errors=u.errors||[],void(!u.errors.find(O=>O.type==src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__.H.unknown)&&!u.errors.find(O=>O.type==src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__.H.monsterType)&&(console.error("Missing type '"+v+"' for "+u.name),u.errors.push(new src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__.h(src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__.H.monsterType,"monster",u.name,u.edition,v))));let x=new _model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__.I(y,v,u);if(u.entities=u.entities.filter(O=>O.number!=y),u.entities.push(x),_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.addEntityCount(u,x),u.tags.includes("addedManually")&&(u.tags=u.tags.filter(O=>"addedManually"!=O)),M&&(x.summon=_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.new),!M||_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.fhRules()){if(this.game.state==_model_Game__WEBPACK_IMPORTED_MODULE_4__.mk.next&&(-1==u.ability?this.applySameDeck(u)?-1==u.ability&&(u.ability=0,u.lastDraw=this.game.round):(u.ability=0,u.lastDraw=this.game.round):1==u.entities.length&&!this.applySameDeck(u)&&u.lastDraw<this.game.round&&(u.ability=u.ability+1+this.game.figures.filter(O=>O instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&(O.name!=u.name||O.edition!=u.edition)&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(O).name==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(u).name&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(O).edition==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(u).edition&&O.drawExtra&&O.ability>-1).length,u.lastDraw=this.game.round,u.ability>=u.abilities.length&&this.shuffleAbilities(u))),this.game.state==_model_Game__WEBPACK_IMPORTED_MODULE_4__.mk.next&&1==this.monsterEntityCount(u)){let O=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.figures.indexOf(u);const V=this.getSameDeckMonster(u);for(V&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.gameplayFigure(V)&&this.applySameDeck(u);_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.figures.some((c,E)=>!c.off&&E<O&&(c.getInitiative()>u.getInitiative()||c.getInitiative()==u.getInitiative()&&c instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&c.name.toLowerCase()>u.name.toLowerCase()));)_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.figures.splice(O,1),O--,_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.figures.splice(O,0,u)}!M&&u.off?u.off=!1:M&&u.entities.every(O=>!_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.entityManager.isAlive(O)||O.summon==_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.new)&&(u.off=!0),this.game.state==_model_Game__WEBPACK_IMPORTED_MODULE_4__.mk.next&&x.summon!=_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.new&&(x.active=u.active||_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.figures.some((O,V,c)=>O.active&&V>c.indexOf(u)))}return x}spawnMonsterEntity(u,y,v=!1,M=!1,x=!1,O=!1){u.isAlly=v,u.isAllied=M,u.drawExtra=x;const V=this.monsterStandeeMax(u);if(_SettingsManager__WEBPACK_IMPORTED_MODULE_13__.f.settings.automaticStandees&&this.monsterStandeeCount(u)<V){let c=-1;for(;this.monsterStandeeUsed(u,c);)c-=1;if(_SettingsManager__WEBPACK_IMPORTED_MODULE_13__.f.settings.randomStandees)c=this.monsterRandomStandee(u);else if(this.monsterStandeeCount(u,!1)==V-1)for(c=1;_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monsterManager.monsterStandeeUsed(u,c);)c++;else 0==this.monsterStandeeCount(u,!1)&&this.monsterStandeeCount(u,!0)==V-1&&u.entities.every(R=>(_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.entityManager.isAlive(R)||R.dormant)&&R.type==y)&&(u.entities.forEach((R,T)=>{R.number=T+1}),c=V);u.boss&&(y=_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_11__.N.boss);const E=this.addMonsterEntity(u,c,y,O);return E&&(E.revealed=!0),E}}removeMonsterEntity(u,y){u.entities.splice(u.entities.indexOf(y),1),(0==u.entities.length||u.entities.every(v=>!_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.entityManager.isAlive(v)&&!v.dormant))&&(!u.off&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.state==_model_Game__WEBPACK_IMPORTED_MODULE_4__.mk.next&&u.active?_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.roundManager.toggleFigure(u):u.off=!0,_SettingsManager__WEBPACK_IMPORTED_MODULE_13__.f.settings.removeUnusedMonster&&0==u.entities.length&&this.removeMonster(u)),_SettingsManager__WEBPACK_IMPORTED_MODULE_13__.f.settings.scenarioStats&&y.dead&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.scenarioStatsManager.killMonsterEntity(y)}setLevel(u,y){u.level=y,this.resetMonsterAbilities(u),u.entities.forEach(v=>{let x,M=this.getStat(u,v.type);v.level=u.level,x="number"==typeof M.health?M.health:(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(M.health),v.health==v.maxHealth&&(v.health=x),v.maxHealth=x,v.health>v.maxHealth&&(v.health=v.maxHealth)})}toggleActive(u,y){this.game.state==_model_Game__WEBPACK_IMPORTED_MODULE_4__.mk.next&&(u.active?(y.active=!y.active,u.entities.every(v=>v.dead||v.health<=0||!v.active)&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.roundManager.toggleFigure(u)):y.active?(y.active=!1,u.entities.every(v=>v.dead||v.health<=0||!v.active||v.summon==_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.new)&&(u.off=!0)):(u.off=!1,y.active=!0),y.active?(y.off=!1,!u.active&&this.game.figures.every(v=>!v.active)&&(u.active=!0)):y.off=!0)}getSameDeckMonster(u){return this.game.figures.find(y=>y instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&(y.name!=u.name||y.edition!=u.edition)&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(y).name==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(u).name&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(y).edition==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(u).edition&&!y.drawExtra)}applySameDeck(u){const y=this.getSameDeckMonster(u);return!!y&&(u.abilities=JSON.parse(JSON.stringify(y.abilities)),u.ability=y.ability,u.lastDraw=this.game.round,u.drawExtra&&this.drawExtra(u),!0)}drawExtra(u){if(u.drawExtra){u.ability=-1;const y=this.getSameDeckMonster(u);if(!y)return console.error("Draw extra for '"+u.name+"' ("+u.deck+" not possible, not same deck monster found!"),void(u.drawExtra=!1);u.ability=y.ability+1+this.game.figures.filter(v=>v instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&(v.name!=u.name||v.edition!=u.edition)&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(v).name==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(u).name&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(v).edition==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(u).edition&&v.drawExtra&&v.ability>y.ability).length,u.ability>=u.abilities.length&&this.shuffleAbilities(u),u.lastDraw=this.game.round}else this.applySameDeck(u)}next(){this.game.figures.forEach(u=>{if(u instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R){let y=this.getAbility(u);if(y){if(this.hasBottomActions(u)){const v=y;if(y=this.getAbility(u,!0),y&&("bottom"==u.firstActiveAction&&y.bottomLost||"top"==u.firstActiveAction&&y.lost)){const M=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.abilities(u).indexOf(y);u.abilities=u.abilities.filter(x=>x!=M),u.ability-=1}if(v&&("bottom"==u.firstActiveAction&&v.lost||"top"==u.firstActiveAction&&v.bottomLost)){const M=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.abilities(u).indexOf(v);u.abilities=u.abilities.filter(x=>x!=M),u.ability-=1}}this.hasBottomActions(u)&&u.firstActiveAction&&u.ability>=u.abilities.length+(u.abilities.length%2==0?-1:-2)?(u.abilities.splice(0,1),this.shuffleAbilities(u)):(y&&y.shuffle||u.ability>=u.abilities.length)&&this.shuffleAbilities(u)}u.entities=u.entities.filter(v=>_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.entityManager.isAlive(v)||v.dormant),u.entities.forEach(v=>{v.tags&&(v.tags=v.tags.filter(M=>!M.startsWith("roundAction-"))),v.summon==_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.new&&(v.summon=_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.true),v.entityConditions.forEach(M=>{M.types.includes(_model_data_Condition__WEBPACK_IMPORTED_MODULE_8__.GV.expire)&&M.state==_model_data_Condition__WEBPACK_IMPORTED_MODULE_8__.mg.normal&&(M.lastState=M.state,M.state=_model_data_Condition__WEBPACK_IMPORTED_MODULE_8__.mg.expire)})}),u.tags=u.tags.filter(v=>!v.startsWith("roundAction-")),u.off=0==u.entities.length}})}draw(){this.game.figures.filter(u=>u instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&!u.drawExtra).forEach(u=>{if(u instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.gameplayFigure(u)&&(u.ability=u.ability+1+this.game.figures.filter(y=>y instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&(y.name!=u.name||y.edition!=u.edition)&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(y).name==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(u).name&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(y).edition==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(u).edition&&y.drawExtra&&y.ability>-1).length,u.lastDraw=this.game.round,this.hasBottomActions(u)&&(u.ability+=1),u.ability>=u.abilities.length&&this.shuffleAbilities(u),u.bb&&u.tags.includes("bb-elite"))){let y=u.ability+1;y>=u.abilities.length&&(y=0);const v=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(u).abilities;if(v[u.abilities[y]].initiative<v[u.abilities[u.ability]].initiative){const M=u.abilities[u.ability];u.abilities[u.ability]=u.abilities[y],u.abilities[y]=M}}}),this.game.figures.filter(u=>u instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&u.drawExtra).forEach(u=>{u instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&(this.drawExtra(u),u.ability>=u.abilities.length&&this.shuffleAbilities(u))})}removeAbility(u,y){const v=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(u);this.game.figures.filter(M=>{if(M instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R){const x=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(M);return v.name==x.name&&v.edition==x.edition}return!1}).map(M=>M).forEach(M=>{M.abilities.splice(y,1)})}restoreAbility(u,y){const v=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(u);this.game.figures.filter(M=>{if(M instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R){const x=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(M);return v.name==x.name&&v.edition==x.edition}return!1}).map(M=>M).forEach(M=>{M.abilities.unshift(v.abilities.indexOf(y))})}restoreDefaultAbilities(u){const y=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(u);this.game.figures.filter(v=>{if(v instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R){const M=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(v);return y.name==M.name&&y.edition==M.edition}return!1}).map(v=>v).forEach(v=>{v.abilities=y.abilities.map((M,x)=>x).filter(M=>!y.abilities[M].level||isNaN(+y.abilities[M].level)||(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(y.abilities[M].level)<=u.level),v.ability=-1})}shuffleAbilities(u,y=!1){if(y||(u.ability=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.state==_model_Game__WEBPACK_IMPORTED_MODULE_4__.mk.draw||0==u.entities.length?-1:0),u.drawExtra){const O=this.getSameDeckMonster(u);return O?void this.shuffleAbilities(O,y):(console.error("Shuffle for '"+u.name+"' ("+u.deck+" not possible, not same deck monster found!"),u.drawExtra=!1,void this.shuffleAbilities(u,y))}const v=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(u),M=this.game.figures.filter(O=>{if(O instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R){const V=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(O);return v.name==V.name&&v.edition==V.edition}return!1}).map(O=>O);let x=y&&u.ability>-1?u.abilities.splice(0,u.ability+1+M.filter(O=>O.drawExtra).length):[];(0,src_app_ui_helper_Static__WEBPACK_IMPORTED_MODULE_2__.Z)(u.abilities),y&&u.abilities.unshift(...x),M.forEach(O=>{O.abilities=JSON.parse(JSON.stringify(u.abilities)),_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.state==_model_Game__WEBPACK_IMPORTED_MODULE_4__.mk.draw?O.ability=-1:(O.ability=u.ability,O.drawExtra&&this.drawExtra(O))})}drawAbility(u){if(u.drawExtra){const y=this.getSameDeckMonster(u);return y?void this.drawAbility(y):(console.error("Draw for '"+u.name+"' ("+u.deck+" not possible, not same deck monster found!"),u.drawExtra=!1,void this.drawAbility(u))}u.ability+=1,this.hasBottomActions(u)&&(u.ability+=1),this.game.figures.forEach(y=>{y instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&this.getSameDeckMonster(y)&&(y.ability=u.ability,y.drawExtra&&this.drawExtra(y))})}drawnAbilities(u){let y=0;u.ability>=0&&(y=u.ability+1);let v=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.figures.find(M=>M instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&(M.name!=u.name||M.edition!=u.edition)&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(M).name==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(u).name&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(M).edition==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(u).edition&&M.ability>=y);for(;v instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R;)y=v.ability+1,v=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.figures.find(M=>M instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&(M.name!=u.name||M.edition!=u.edition)&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(M).name==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(u).name&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(M).edition==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(u).edition&&M.ability>=y);return y}getAbility(u,y=!1){if(u.ability<0||u.ability>=u.abilities.length||!_SettingsManager__WEBPACK_IMPORTED_MODULE_13__.f.settings.abilities)return;const v=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.abilities(u);return v?v[u.abilities[u.ability+(y?u.ability>0?-1:1:0)]]:void 0}hasBottomActions(u){return _GameManager__WEBPACK_IMPORTED_MODULE_12__.E.abilities(u).length>0&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.abilities(u).every(y=>_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.hasBottomAbility(y))}sortEntities(u,y){return u.type==_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_11__.N.elite&&y.type==_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_11__.N.normal?-1:u.type==_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_11__.N.normal&&y.type==_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_11__.N.elite?1:_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monsterManager.sortEntitiesByNumber(u,y)}sortEntitiesByNumber(u,y){return u.summon==_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.new&&y.summon!=_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.new?1:u.summon!=_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.new&&y.summon==_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.new?-1:u.summon==_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.new&&y.summon==_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.new?0:u.number<0&&y.number>=0?1:y.number<0&&u.number>=0||u.number<y.number?-1:1}}},5532(u,y,v){v.d(y,{Hg:()=>M,O7:()=>V,e_:()=>x,em:()=>O});var M=function(c){return c.fire="fire",c.ice="ice",c.air="air",c.earth="earth",c.light="light",c.dark="dark",c.wild="wild",c}(M||{}),x=function(c){return c.strong="strong",c.waning="waning",c.inert="inert",c.new="new",c.consumed="consumed",c.partlyConsumed="partlyConsumed",c.always="always",c}(x||{});class O{type;state=x.inert;constructor(E){this.type=E}}const V=[new O(M.fire),new O(M.ice),new O(M.air),new O(M.earth),new O(M.light),new O(M.dark)]},6066(u,y,v){v.d(y,{I:()=>R});var M=v(8317),x=v(3812),O=v(8164),V=v(2357),c=v(4786),E=v(392);class R{number;marker="";type;stat;dead=!1;summon=O.N5.false;dormant=!1;revealed=!1;active=!1;off=!1;level;health;maxHealth;entityConditions=[];immunities=[];markers=[];tags=[];shield;shieldPersistent;retaliate=[];retaliatePersistent=[];constructor(q,I,s){this.number=q,this.type=I;const D=M.E.monsterManager.getStat(s,I);D?this.stat=D:(this.stat=new E.f(I,s.level),s.errors=s.errors||[],!s.errors.find(p=>p.type==c.H.unknown)&&!s.errors.find(p=>p.type==c.H.stat)&&(console.error("Could not find '"+I+"' stats for monster: "+s.name+" level: "+s.level),s.errors.push(new c.h(c.H.stat,"monster",s.name,s.edition,I,""+s.level)))),this.maxHealth=(0,x.hZ)(this.stat.health,s.level),this.health=this.maxHealth,0==this.health&&(this.health=1),this.level=s.level}toModel(){return new T(this.number,this.marker,this.type,this.dead,this.summon,this.active,this.off,this.revealed,this.dormant,this.health,this.maxHealth,this.entityConditions.map(q=>q.toModel()),this.immunities,this.markers,this.tags||[],this.shield,this.shieldPersistent,this.retaliate,this.retaliatePersistent)}fromModel(q){this.marker=q.marker,this.dead=q.dead,this.summon=q.summon,this.active=q.active,this.off=q.off,this.revealed=q.revealed,this.dormant=q.dormant,this.health=q.health,this.maxHealth=q.maxHealth,this.entityConditions=[],q.entityConditions&&(this.entityConditions=q.entityConditions.map(I=>{let s=new V.BR(I.name,I.value);return s.fromModel(I),s})),this.immunities=q.immunities||[],this.markers=q.markers||[],this.tags=q.tags||[],this.shield=q.shield?JSON.parse(q.shield):void 0,this.shieldPersistent=q.shieldPersistent?JSON.parse(q.shieldPersistent):void 0,this.retaliate=(q.retaliate||[]).map(I=>JSON.parse(I)),this.retaliatePersistent=(q.retaliatePersistent||[]).map(I=>JSON.parse(I))}}class T{number;marker;type;dead;summon;revealed;dormant;active;off;health;maxHealth;entityConditions;immunities;markers;tags;shield;shieldPersistent;retaliate;retaliatePersistent;constructor(q,I,s,D,p,G,H,b,S,A,F,t,N,K,w,Q,$,Kt,st){this.number=q,this.marker=I,this.type=s,this.dead=D,this.summon=p,this.active=G,this.off=H,this.revealed=b,this.dormant=S,this.health=A,this.maxHealth=F,this.entityConditions=JSON.parse(JSON.stringify(t)),this.immunities=JSON.parse(JSON.stringify(N)),this.markers=JSON.parse(JSON.stringify(K)),this.tags=JSON.parse(JSON.stringify(w)),this.shield=Q?JSON.stringify(Q):"",this.shieldPersistent=$?JSON.stringify($):"",this.retaliate=Kt.map(Wt=>JSON.stringify(Wt)),this.retaliatePersistent=st.map(Wt=>JSON.stringify(Wt))}}},6484(u,y,v){v.d(y,{n:()=>V});var M=v(9204),x=v(706);const V=new class O{db;init(){var E=this;return(0,M.A)(function*(){return(yield navigator.storage.persist())||console.warn("Storage may be cleared by the UA under storage pressure."),new Promise((T,B)=>{if(window.indexedDB){const q=window.indexedDB.open("ghs-db",1);q.onupgradeneeded=I=>{console.debug("Upgrade DB",I);const s=I.target.result;I.oldVersion<1&&(s.createObjectStore("game"),s.createObjectStore("settings"),s.createObjectStore("undo",{autoIncrement:!0}),s.createObjectStore("redo",{autoIncrement:!0}),s.createObjectStore("undo-infos",{autoIncrement:!0}),s.createObjectStore("game-backup",{autoIncrement:!0}))},q.onsuccess=I=>{E.db=I.target.result,localStorage.getItem("ghs-game")&&E.migrate(),T(!0)},q.onerror=I=>{E.db=void 0,console.error("db error",q.error,I),console.warn("No IndexedDB, fallback to Local Storage"),B(!1)}}else E.db=void 0,console.warn("No IndexedDB, fallback to Local Storage"),B(!1)})})()}writeGameModel(E){return this.write("game","default",E)}readGameModel(){return this.read("game","default")}addBackup(E){if(this.db)this.write("game-backup",void 0,E);else{let R=1,T=localStorage.getItem("ghs-game-backup-"+R);for(;T;)R++,T=localStorage.getItem("ghs-game-backup-"+R);try{localStorage.setItem("ghs-game-backup-"+R,JSON.stringify(E))}catch(B){console.error(B)}}}read(E,R){return new Promise((T,B)=>{if(this.db){const s=this.db.transaction(E,"readonly").objectStore(E).get(R);s.onsuccess=D=>{T(D.target.result)},s.onerror=D=>{console.error("read "+E+" failed",D),B(D)}}else{const q=localStorage.getItem("ghs-"+E);q?T(JSON.parse(q)):B(null)}})}write(E,R,T){return new Promise((B,q)=>{if(this.db){const D=this.db.transaction(E,"readwrite").objectStore(E).put(T,R);D.onsuccess=p=>{B()},D.onerror=p=>{console.error("update "+E+" failed",p),q()}}else try{localStorage.setItem("ghs-"+E,JSON.stringify(T)),B()}catch(I){console.error(I),q()}})}remove(E,R="default"){this.db?this.db.transaction(E,"readwrite").objectStore(E).delete(R).onerror=I=>{console.error("delete "+R+" from "+E+" failed",I)}:localStorage.removeItem("ghs-"+E)}readAll(E){return new Promise((R,T)=>{if(this.db){const I=this.db.transaction(E,"readonly").objectStore(E).getAll();I.onsuccess=s=>{R(s.target.result)},I.onerror=s=>{console.error("read "+E+" failed",s,s.error),T(s)}}else{const B=localStorage.getItem("ghs-"+E);B?R(JSON.parse(B)):T(null)}})}readList(E,R,T,B=!0){return new Promise((q,I)=>{if(this.db){const p=this.db.transaction(E,"readonly").objectStore(E);let G=[];const H=p.openCursor(null,"prev");var s=!1;H.onsuccess=b=>{var S=b.target.result;if(!s&&T>0)return s=!0,void S.advance(T);S?(G.push(S.value),G.length<R?S.continue():q(B?G.reverse():G)):q(B?G.reverse():G)},H.onerror=b=>{console.error("read "+E+" failed",b),I(b)}}else{const D=localStorage.getItem("ghs-"+E);D?q(JSON.parse(D).slice(T,T+R)):I(null)}})}writeArray(E,R){var T=this;return(0,M.A)(function*(){return new Promise(function(){var B=(0,M.A)(function*(q,I){if(T.db)try{const s=T.db.transaction(E,"readwrite"),D=s.objectStore(E);yield new Promise((p,G)=>{const H=D.clear();H.onsuccess=()=>p(),H.onerror=()=>G(H.error)});for(let p=0;p<R.length;p++)yield new Promise((G,H)=>{const b=D.put(R[p]);b.onsuccess=()=>G(),b.onerror=()=>H(b.error)});yield new Promise((p,G)=>{s.oncomplete=()=>p(),s.onerror=()=>G(s.error),s.onabort=()=>G(new Error("Transaction aborted"))}),q()}catch(s){console.error(`Failed to writeArray to ${E}:`,s),I(s)}else try{localStorage.setItem("ghs-"+E,JSON.stringify(R)),q()}catch(s){console.error(s),I()}});return function(q,I){return B.apply(this,arguments)}}())})()}clear(E=void 0){return new Promise((R,T)=>{if(this.db)if(E){const I=this.db.transaction(E,"readwrite").objectStore(E).clear();I.onsuccess=s=>{R()},I.onerror=s=>{console.error("delete "+E+" failed",s),T(I.error)}}else{const B=window.indexedDB.deleteDatabase("ghs-db");B.onsuccess=q=>{R()},B.onblocked=q=>{setTimeout(()=>{this.db&&this.db.close()},1e3)},B.onerror=q=>{console.error("delete database 'ghs-db' failed",q),T(B.error)}}else if(E)localStorage.removeItem("ghs-"+E),R();else if(localStorage.clear(),window.indexedDB){const B=window.indexedDB.deleteDatabase("ghs-db");B.onsuccess=q=>{R()},B.onblocked=q=>{setTimeout(()=>{this.db&&this.db.close()},1e3)},B.onerror=q=>{console.error("delete database 'ghs-db' failed",q),T(B.error)}}else R()})}datadump(){var E=this;return(0,M.A)(function*(R=!1){let T={};if(E.db&&!R)T.game=yield E.readGameModel(),T.settings=yield E.read("settings","default"),T.undo=yield E.readAll("undo"),T.redo=yield E.readAll("redo"),T["undo-infos"]=yield E.readAll("undo-infos"),T["game-backup"]=yield E.readAll("game-backup");else{R||console.warn("No IndexedDB, fallback to Local Storage");for(let B=0;B<localStorage.length;B++){const q=localStorage.key(B);if(q){const I=localStorage.getItem(q);I&&(T[q]=JSON.parse(I))}}}return Promise.resolve(T)}).apply(this,arguments)}migrate(){var E=this;return(0,M.A)(function*(){console.warn("Migration of old local storage");try{let p=yield V.datadump(!0),G=document.createElement("a");G.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(p))),G.setAttribute("download","ghs-migration-backup.json"),document.body.appendChild(G),G.click(),document.body.removeChild(G)}catch{console.warn("Could not read datadump")}const R=localStorage.getItem("ghs-game");if(R){let p=JSON.parse(R);E.write("game","default",p).then(()=>{localStorage.removeItem("ghs-game")}).catch()}const T=localStorage.getItem("ghs-settings");if(T){let p=JSON.parse(T);E.write("settings","default",Object.assign(new x.w,p)).then(()=>{localStorage.removeItem("ghs-settings")}).catch()}const B=localStorage.getItem("ghs-undo");if(null!=B){let p=JSON.parse(B),G=1,H=localStorage.getItem("ghs-undo-"+G);for(;H;){const b=JSON.parse(H);p.push(...b),G++,H=localStorage.getItem("ghs-undo-"+G)}E.writeArray("undo",p).then(()=>{localStorage.removeItem("ghs-undo");let b=localStorage.getItem("ghs-undo-"+G);for(;b;)localStorage.removeItem("ghs-undo-"+G),G++,b=localStorage.getItem("ghs-undo-"+G)}).catch()}const q=localStorage.getItem("ghs-redo");if(null!=q){let p=JSON.parse(q),G=1,H=localStorage.getItem("ghs-redo-"+G);for(;H;){const b=JSON.parse(H);p.push(...b),G++,H=localStorage.getItem("ghs-redo-"+G)}E.writeArray("redo",p).then(()=>{localStorage.removeItem("ghs-redo");let b=localStorage.getItem("ghs-redo-"+G);for(;b;)localStorage.removeItem("ghs-redo-"+G),G++,b=localStorage.getItem("ghs-redo-"+G)}).catch()}const I=localStorage.getItem("ghs-undo-infos");if(null!=I){let p=JSON.parse(I),G=1,H=localStorage.getItem("ghs-undo-infos-"+G);for(;H;){const b=JSON.parse(H);p.push(...b),G++,H=localStorage.getItem("ghs-undo-infos-"+G)}E.writeArray("undo-infos",p).then(()=>{localStorage.removeItem("ghs-undo-infos");let b=localStorage.getItem("ghs-undo-infos-"+G);for(;b;)localStorage.removeItem("ghs-undo-infos-"+G),G++,b=localStorage.getItem("ghs-undo-infos-"+G)}).catch()}let s=1,D=localStorage.getItem("ghs-game-backup-"+s);for(;D;)E.write("game-backup",void 0,D).then(()=>{localStorage.removeItem("ghs-game-backup-"+s)}).catch(),s++,D=localStorage.getItem("ghs-game-backup-"+s)})()}}},6538(u,y,v){v.d(y,{N:()=>M});var M=function(x){return x.normal="normal",x.elite="elite",x.boss="boss",x}(M||{})},6719(u,y,v){v.d(y,{X:()=>O});var M=v(2357),x=v(3812);class O{uuid;marker="";dead=!1;dormant=!1;revealed=!1;active=!1;off=!1;level=-1;health;maxHealth;entityConditions=[];immunities=[];number;markers=[];tags=[];shield;shieldPersistent;retaliate=[];retaliatePersistent=[];constructor(E,R,T,B){this.uuid=E,this.number=R,this.marker=B||"",this.maxHealth=(0,x.hZ)(T.health),this.health=this.maxHealth}toModel(){return new V(this.uuid,this.number,this.marker,this.dead,this.active,this.dormant,this.health,this.maxHealth,this.entityConditions.map(E=>E.toModel()),this.immunities,this.markers,this.tags||[],this.shield,this.shieldPersistent,this.retaliate,this.retaliatePersistent)}fromModel(E){this.number=E.number,this.marker=E.marker,this.dead=E.dead,this.active=E.active,this.dormant=E.dormant,this.health=E.health,this.maxHealth=E.maxHealth,this.entityConditions=[],E.entityConditions&&(this.entityConditions=E.entityConditions.map(R=>{let T=new M.BR(R.name,R.value);return T.fromModel(R),T})),this.immunities=E.immunities||[],this.markers=E.markers||[],this.tags=E.tags||[],this.shield=E.shield?JSON.parse(E.shield):void 0,this.shieldPersistent=E.shieldPersistent?JSON.parse(E.shieldPersistent):void 0,this.retaliate=(E.retaliate||[]).map(R=>JSON.parse(R)),this.retaliatePersistent=(E.retaliatePersistent||[]).map(R=>JSON.parse(R))}}class V{uuid;number;marker;dead;active;dormant;health;maxHealth;entityConditions;immunities;markers;tags;shield;shieldPersistent;retaliate;retaliatePersistent;constructor(E,R,T,B,q,I,s,D,p,G,H,b,S,A,F,t){this.uuid=E,this.number=R,this.marker=T,this.dead=B,this.active=q,this.dormant=I,this.health=s,this.maxHealth=D,this.entityConditions=JSON.parse(JSON.stringify(p)),this.immunities=JSON.parse(JSON.stringify(G)),this.markers=JSON.parse(JSON.stringify(H)),this.tags=JSON.parse(JSON.stringify(b)),this.shield=S?JSON.stringify(S):"",this.shieldPersistent=A?JSON.stringify(A):"",this.retaliate=F.map(N=>JSON.stringify(N)),this.retaliatePersistent=t.map(N=>JSON.stringify(N))}}},7017(u,y,v){v.d(y,{s:()=>M});class M{level;health;constructor(V,c){this.level=V,this.health=c}}},7114(u,y,v){v.d(y,{Az:()=>R,Qc:()=>x,TH:()=>B,Yj:()=>E,iH:()=>c});class x{cardId;edition;type;selected;subSelections;checks;scenarioApply;attack;constructor(s,D,p,G,H,b,S,A){this.cardId=s,this.edition=D,this.type=p,this.selected=G,this.subSelections=H,this.checks=b,this.scenarioApply=A,this.attack=S}}var c=function(I){return I.and="and",I.building="building",I.campaignSticker="campaignSticker",I.character="character",I.loseCollectiveResource="loseCollectiveResource",I.loseCollectiveResourceType="loseCollectiveResourceType",I.loseResource="loseResource",I.loseResourceType="loseResourceType",I.moraleGT="moraleGT",I.moraleLT="moraleLT",I.otherwise="otherwise",I.payGold="payGold",I.payCollectiveGold="payCollectiveGold",I.payCollectiveGoldConditional="payCollectiveGoldConditional",I.payCollectiveGoldReputationGT="payCollectiveGoldReputationGT",I.payCollectiveGoldReputationLT="payCollectiveGoldReputationLT",I.payCollectiveItem="payCollectiveItem",I.reputationFactionGT="reputationFactionGT",I.reputationGT="reputationGT",I.reputationLT="reputationLT",I.season="season",I.seasonLT="seasonLT",I.traits="traits",I.traitsAll="traitsAll",I}(c||{}),E=function(I){return I.additionally="additionally",I.and="and",I.battleGoal="battleGoal",I.campaignSticker="campaignSticker",I.campaignStickerMap="campaignStickerMap",I.campaignStickerReplace="campaignStickerReplace",I.checkbox="checkbox",I.choose="choose",I.collectiveGold="collectiveGold",I.collectiveGoldAdditional="collectiveGoldAdditional",I.collectiveGoldOther="collectiveGoldOther",I.collectiveItem="collectiveItem",I.collectiveResource="collectiveResource",I.collectiveResourceType="collectiveResourceType",I.consumeItem="consumeItem",I.consumeCollectiveItem="consumeCollectiveItem",I.custom="custom",I.discard="discard",I.discardOne="discardOne",I.drawAnotherEvent="drawAnotherEvent",I.drawEvent="drawEvent",I.event="event",I.eventReturn="eventReturn",I.eventsToTop="eventsToTop",I.experience="experience",I.globalAchievement="globalAchievement",I.gold="gold",I.goldAdditional="goldAdditional",I.gainTrait="gainTrait",I.inspiration="inspiration",I.item="item",I.itemDesign="itemDesign",I.loseBattleGoal="loseBattleGoal",I.loseCollectiveExperience="loseCollectiveExperience",I.loseCollectiveGold="loseCollectiveGold",I.loseCollectiveResource="loseCollectiveResource",I.loseCollectiveResourceAny="loseCollectiveResourceAny",I.loseCollectiveResourceType="loseCollectiveResourceType",I.loseExperience="loseExperience",I.loseGold="loseGold",I.loseGoldOne="loseGoldOne",I.loseItem="loseItem",I.loseMorale="loseMorale",I.loseProsperity="loseProsperity",I.loseReputation="loseReputation",I.loseReputationFaction="loseReputationFaction",I.loseResource="loseResource",I.loseTrait="loseTrait",I.morale="morale",I.noEffect="noEffect",I.outcome="outcome",I.outcomes="outcomes",I.outcomeSelect="outcomeSelect",I.outpostAttack="outpostAttack",I.outpostTarget="outpostTarget",I.randomItem="randomItem",I.randomItemBlueprint="randomItemBlueprint",I.randomItemDesign="randomItemDesign",I.randomScenario="randomScenario",I.removeEvent="removeEvent",I.reputation="reputation",I.reputationFaction="reputationFaction",I.reputationAdditional="reputationAdditional",I.resource="resource",I.resourceType="resourceType",I.partyAchievement="partyAchievement",I.prosperity="prosperity",I.scenarioCondition="scenarioCondition",I.scenarioDamage="scenarioDamage",I.scenarioSingleMinus1="scenarioSingleMinus1",I.sectionWeek="sectionWeek",I.sectionWeeks="sectionWeeks",I.sectionWeekSeasonFinal="sectionWeekSeasonFinal",I.sectionWeeksSeason="sectionWeeksSeason",I.skipThreat="skipThreat",I.soldier="soldier",I.soldiers="soldiers",I.townGuardDeckCard="townGuardDeckCard",I.townGuardDeckCardRemove="townGuardDeckCardRemove",I.townGuardDeckCardRemovePermanently="townGuardDeckCardRemovePermanently",I.townGuardDeckCards="townGuardDeckCards",I.traitExperience="traitExperience",I.traitScenarioCondition="traitScenarioCondition",I.traitScenarioDamage="traitScenarioDamage",I.unlockEnvelope="unlockEnvelope",I.unlockScenario="unlockScenario",I.unlockScenarioGroup="unlockScenarioGroup",I.upgradeBuilding="upgradeBuilding",I.wreckBuilding="wreckBuilding",I}(E||{});class R{condition;type=E.noEffect;values=[];alt=!1;constructor(s,D=[]){this.type=s,this.values=D}}class B{attackValue;targetNumber;targetDescription;narrative;effects;constructor(s,D,p,G,H){this.attackValue=s,this.targetNumber=D,this.targetDescription=p,this.narrative=G,this.effects=H}}},7165(u,y,v){v.d(y,{Ah:()=>O,lb:()=>V});class O{index=0;goal=!1;rewards=[];constructor(R,T=-1){if(this.index=T,"G"==R)this.goal=!0;else{let B=R.split("|");for(let q of B)this.rewards.push(new c(q))}}}var V=function(E){return E.custom="custom",E.gold="gold",E.goldFh="goldFh",E.experience="experience",E.experienceFh="experienceFh",E.battleGoal="battleGoal",E.damage="damage",E.condition="condition",E.heal="heal",E.item="item",E.itemFh="itemFh",E.itemDesign="itemDesign",E.randomItem="randomItem",E.randomItemDesign="randomItemDesign",E.itemBlueprint="itemBlueprint",E.randomItemBlueprint="randomItemBlueprint",E.scenario="scenario",E.randomScenario="randomScenario",E.randomScenarioFh="randomScenarioFh",E.partyAchievement="partyAchievement",E.event="event",E.loot="loot",E.lootCards="lootCards",E.resource="resource",E.campaignSticker="campaignSticker",E.calendarSection="calendarSection",E}(V||{});class c{type;value;constructor(R){let T=R.split(":");try{this.type=T[0],T.length>1&&(this.value=isNaN(+T[1])?T[1]:+T[1])}catch{this.type=V.custom,console.error("Invalid treasure reward string: '"+R+"'")}}}},8102(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:()=>AttackModifierManager});var src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3219),src_app_ui_helper_Static__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(4670),_model_Character__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1824),_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3417),_model_Entity__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(3812),_model_Monster__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2065),_model_ObjectiveContainer__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4933),_GameManager__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(8317),_SettingsManager__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(1619);class AttackModifierManager{game;constructor(u){this.game=u}byFigure(u){if(u instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K)return u.attackModifierDeck;if(u instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R)return(_SettingsManager__WEBPACK_IMPORTED_MODULE_8__.f.settings.alwaysAllyAttackModifierDeck||_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.fhRules(!0))&&(u.isAlly||u.isAllied)?this.game.allyAttackModifierDeck:this.game.monsterAttackModifierDeck;if(u instanceof _model_ObjectiveContainer__WEBPACK_IMPORTED_MODULE_6__.$e&&u.amDeck){if("M"==u.amDeck||!_SettingsManager__WEBPACK_IMPORTED_MODULE_8__.f.settings.alwaysAllyAttackModifierDeck&&!_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.fhRules(!0)&&"A"==u.amDeck)return this.game.monsterAttackModifierDeck;if("A"==u.amDeck)return this.game.allyAttackModifierDeck;{const y=_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.figures.find(v=>v instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K&&v.name==u.amDeck);if(y&&_SettingsManager__WEBPACK_IMPORTED_MODULE_8__.f.settings.characterAttackModifierDeck)return y.attackModifierDeck}}return new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.J}countUpcomingBlesses(){let u=0;return(_SettingsManager__WEBPACK_IMPORTED_MODULE_8__.f.settings.alwaysAllyAttackModifierDeck||_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.fhRules()&&_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.figures.some(y=>y instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&(y.isAlly||y.isAllied)))&&(u+=_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.allyAttackModifierDeck.cards.filter((y,v)=>y.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.bless&&v>_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.allyAttackModifierDeck.current).length),u+=_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.monsterAttackModifierDeck.cards.filter((y,v)=>y.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.bless&&v>_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.monsterAttackModifierDeck.current).length,_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.figures.filter(y=>y instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K).map(y=>y).forEach(y=>{u+=y.attackModifierDeck.cards.filter((v,M)=>v.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.bless&&M>y.attackModifierDeck.current).length}),u}countUpcomingCurses(u){if(u)return _GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.monsterAttackModifierDeck.cards.filter((v,M)=>v.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.curse&&M>_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.monsterAttackModifierDeck.current).length;let y=0;return(_SettingsManager__WEBPACK_IMPORTED_MODULE_8__.f.settings.alwaysAllyAttackModifierDeck||_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.fhRules()&&_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.figures.some(v=>v instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&(v.isAlly||v.isAllied)))&&(y+=_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.allyAttackModifierDeck.cards.filter((v,M)=>v.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.curse&&M>_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.allyAttackModifierDeck.current).length),_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.figures.filter(v=>v instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K).map(v=>v).forEach(v=>{y+=v.attackModifierDeck.cards.filter((M,x)=>M.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.curse&&x>v.attackModifierDeck.current).length}),y}getAdditional(u,y,v=!1){let M=[];return u.additionalModifier.find(x=>x.attackModifier&&x.attackModifier.type==y)&&u.additionalModifier.forEach((x,O)=>{if(x.attackModifier&&x.attackModifier.type==y){let V=Object.assign(new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(x.attackModifier.type),x.attackModifier);V.id="additional-"+u.name+O,V.character=!0;const c=v?0:this.countUpcomingAdditional(u,y);for(let E=0;E<x.count-c;E++)M.push(V)}}),M}getAllAdditional(){let u=[];return _GameManager__WEBPACK_IMPORTED_MODULE_7__.E.charactersData().forEach(y=>{y.additionalModifier.find(v=>v.attackModifier)&&y.additionalModifier.forEach((v,M)=>{if(v.attackModifier){let x=Object.assign(new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(v.attackModifier.type),v.attackModifier);x.id="additional-"+y.name+M,x.character=!0;for(let O=0;O<v.count;O++)u.push(x)}})}),u}countUpcomingAdditional(u,y){let v=0;return(_SettingsManager__WEBPACK_IMPORTED_MODULE_8__.f.settings.alwaysAllyAttackModifierDeck||_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.fhRules()&&_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.figures.some(M=>M instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&(M.isAlly||M.isAllied)))&&(v+=_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.allyAttackModifierDeck.cards.filter((M,x)=>x>_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.allyAttackModifierDeck.current&&M.type==y&&M.id&&M.id.startsWith("additional-"+u.name)).length),v+=_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.monsterAttackModifierDeck.cards.filter((M,x)=>x>_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.monsterAttackModifierDeck.current&&M.type==y&&M.id&&M.id.startsWith("additional-"+u.name)).length,_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.figures.filter(M=>M instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K).map(M=>M).forEach(M=>{v+=M.attackModifierDeck.cards.filter((x,O)=>O>M.attackModifierDeck.current&&x.type==y&&x.id&&x.id.startsWith("additional-"+u.name)).length}),v}countExtraMinus1(){let u=0;return(_SettingsManager__WEBPACK_IMPORTED_MODULE_8__.f.settings.alwaysAllyAttackModifierDeck||_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.fhRules()&&_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.figures.some(y=>y instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&(y.isAlly||y.isAllied)))&&(u+=_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.allyAttackModifierDeck.cards.filter(y=>y.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.minus1extra).length),u+=_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.monsterAttackModifierDeck.cards.filter(y=>y.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.minus1extra).length,_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.game.figures.filter(y=>y instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K).map(y=>y).forEach(y=>{u+=y.attackModifierDeck.cards.filter(v=>v.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.minus1extra).length}),u}addModifier(u,y,v=-1,M=!0){const x=Object.assign(new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(y.type),y);(M&&v<0||v>u.cards.length)&&(v=Math.floor(Math.random()*(u.cards.length-u.current))+u.current+1,this.shuffleModifiers(u,!0)),-1==v&&(v=u.cards.length),u.cards=[...u.cards.slice(0,v),x,...u.cards.slice(v)]}addModifierByType(u,y){this.addModifier(u,new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(y))}removeModifierByType(u,y){const v=u.cards.find(M=>M.type==y);v&&u.cards.splice(u.cards.indexOf(v),1)}drawModifier(u,y){u.bb?this.drawBB(u,y):u.current>=u.cards.length-1?this.shuffleModifiers(u):y?this.drawAdvantage(u,y):this.drawNormal(u)}drawNormal(u){if(u.current=u.current+1,u.state&&(u.lastVisible=u.current),u.state=void 0,_SettingsManager__WEBPACK_IMPORTED_MODULE_8__.f.settings.amAdvantage){let y=u.cards[u.current];if(y&&y.rolling)for(;y.rolling;){if(u.current==u.cards.length-1)return;u.current=u.current+1,y=u.cards[u.current],this.updateLastVisible(u)}}this.updateLastVisible(u)}updateLastVisible(u){let y=0;u.cards.slice(u.lastVisible,u.current+1).reverse().forEach((v,M)=>{v.rolling||y++,3==y&&(u.lastVisible=u.current-M+1,y++)}),_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.uiChange.next(!1)}drawAdvantage(u,y){let v=!1;const M=_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.fhRules()||_SettingsManager__WEBPACK_IMPORTED_MODULE_8__.f.settings.alwaysFhAdvantage;if(u.current=u.current+1,u.lastVisible=u.current,u.state=y,u.current==u.cards.length)return;_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.uiChange.next(!1);let x=u.cards[u.current];if(x&&x.rolling)for(v=M;x.rolling;){if(u.current==u.cards.length-1)return;u.current=u.current+1,x=u.cards[u.current],_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.uiChange.next(!1)}else if(u.current=u.current+1,x=u.cards[u.current],_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.uiChange.next(!1),M&&_SettingsManager__WEBPACK_IMPORTED_MODULE_8__.f.settings.amAdvantageHouseRule&&x&&x.rolling)for(;x.rolling;){if(u.current==u.cards.length-1)return;u.current=u.current+1,x=u.cards[u.current],_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.uiChange.next(!1)}if(v){if(u.current==u.cards.length-1)return;u.current=u.current+1,_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.uiChange.next(!1)}}drawBB(u,y){let v=Math.floor(u.current/3)+1;if(u.state=y,v>=Math.floor(u.cards.length/3))u.current=-1,u.lastVisible=-1;else if(u.current=3*v+Math.floor(3*Math.random()),y){const M=3*v+Math.floor(3*Math.random());u.lastVisible=u.current,u.current=M}else u.lastVisible=u.current}shuffleModifiers(u,y=!1){if(u.bb)return u.current=-1,void(u.lastVisible=-1);const v=u.current,M=u.lastVisible;let x=y&&v>-1?u.cards.splice(0,v+1):[];y||(u.cards=u.cards.filter((O,V)=>V>u.current||O.type!=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.bless&&O.type!=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.curse&&O.type!=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.empower&&O.type!=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.enfeeble)),_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.challengesManager.apply&&_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.challengesManager.isActive(1500,"fh")&&(u.cards=u.cards.filter((O,V)=>V>u.current||O.type!=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.minus1&&O.type!=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.minus2)),u.current=-1,u.lastVisible=0,u.discarded=[],(0,src_app_ui_helper_Static__WEBPACK_IMPORTED_MODULE_1__.Z)(u.cards),y&&(u.current=v,u.lastVisible=M,u.cards.unshift(...x))}removeDrawnDiscards(u){const y=u.cards.length;u.cards=u.cards.filter((v,M)=>M>u.current||v.type!=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.bless&&v.type!=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.curse&&v.type!=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.empower&&v.type!=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.enfeeble),u.current=u.current-(y-u.cards.length)}next(){this.checkShuffle(this.game.monsterAttackModifierDeck),this.checkShuffle(this.game.allyAttackModifierDeck),this.game.figures.forEach(u=>{u instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K&&this.checkShuffle(u.attackModifierDeck)})}firstRound(){this.shuffleModifiers(this.game.monsterAttackModifierDeck),this.shuffleModifiers(this.game.allyAttackModifierDeck),this.game.figures.forEach(u=>{u instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K&&this.shuffleModifiers(u.attackModifierDeck)})}checkShuffle(u){!u.bb&&u.cards.some((y,v)=>v<=u.current&&y.shuffle)&&this.shuffleModifiers(u)}buildMonsterAttackModifierDeck(u=!1){let y=new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.J;return u||(_SettingsManager__WEBPACK_IMPORTED_MODULE_8__.f.settings.gh2eImbuementKeep&&("advanced"==_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.imbuementManager.imbuement?_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.imbuementManager.advanced(y,!1):_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.imbuementManager.imbuement&&_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.imbuementManager.enable(y,!1)),this.game.figures.forEach(v=>{v instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K&&v.perks&&v.perks.find(M=>M.monsterDeck)&&_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.attackModifierManager.applyCharacterPerks(v,y,!0)})),y}buildCharacterAttackModifierDeck(u){if(u.bb&&u.amTables&&u.amTables.length>=u.level&&u.amTables[u.level-1])return new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.J(u.amTables[u.level-1].map((v,M)=>{if("string"==typeof v){let x=new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(v);return x.character=!0,x}{let x=v;return x.character=!0,x.id="bb-"+u.level+"-"+M,x}}),_SettingsManager__WEBPACK_IMPORTED_MODULE_8__.f.settings.bbAm);let y=new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.J;return this.applyCharacterPerks(u,y),y}applyCharacterPerks(u,y,v=!1){let M=0;if(u.perks.forEach(x=>{!!x.monsterDeck==v&&x.cards&&x.cards.forEach((O,V)=>{if(x.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.add||x.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.replace){let c=Object.assign(new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(O.attackModifier.type),O.attackModifier);c.id="perk"+M,c.shuffle=O.attackModifier.shuffle||!1,(!this.findByAttackModifier(src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.zs,c)||x.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.add||V>0)&&(c.character=!0),this.findByAttackModifier(y.attackModifiers,c)||(M++,y.attackModifiers.push(c))}})}),u.progress&&u.progress.perks&&u.progress.perks.forEach((x,O)=>{const V=u.perks[O];if(V&&!!V.monsterDeck==v)if(V.combined)x==V.count&&this.addPerkCard(V,y,src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.zs);else for(let c=0;c<x;c++)this.addPerkCard(V,y,src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.zs)}),!v){if(_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.trialsManager.apply&&_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.trialsManager.trialsEnabled&&u.progress.trial&&"fh"==u.progress.trial.edition&&"348"==u.progress.trial.name&&((y=new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.J).cards=y.cards.filter(x=>[src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.double,src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.plus1,!src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.plus2].includes(x.type))),!_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.characterManager.ignoreNegativeItemEffects(u))for(let x of u.progress.equippedItems){const O=_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.itemManager.getItem(x.name,x.edition,!0);if(O&&O.minusOne)for(let V=0;V<O.minusOne;V++)this.addModifier(y,new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.minus1))}if(u.progress.equippedItems.find(x=>"gh"==x.edition&&"101"==x.name)){let x=y.cards.find(O=>O.id==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.minus1);x&&(y.cards.splice(y.cards.indexOf(x),1),x=y.cards.find(O=>O.id==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.minus1),x&&y.cards.splice(y.cards.indexOf(x),1))}if(u.progress.equippedItems.find(x=>"toa"==x.edition&&"107"==x.name)){const x=y.cards.find(O=>O.id==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.minus2);x&&y.cards.splice(y.cards.indexOf(x),1)}if(u.progress.equippedItems.find(x=>"fh"==x.edition&&"11"==x.name)){const x=y.cards.find(O=>O.id==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.minus1);x&&y.cards.splice(y.cards.indexOf(x),1)}if(u.progress.equippedItems.find(x=>"fh"==x.edition&&"41"==x.name)){const x=y.cards.find(V=>V.id==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.plus0);x&&y.cards.splice(y.cards.indexOf(x),1);const O=y.cards.find(V=>V.id==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.minus1);O&&y.cards.splice(y.cards.indexOf(O),1)}}}buildTownGuardAttackModifierDeck(u,y){const v=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.IK.map(O=>Object.assign(new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(O.type),O)),M=new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.J(v);M.attackModifiers.push(...src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.qq);let x=0;return y.townGuardPerks&&(y.townGuardPerks.forEach(O=>{const V=O.perk;V.cards&&V.cards.forEach((c,E)=>{if(V.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.add||V.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.replace){let R=Object.assign(new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(c.attackModifier.type,c.attackModifier.value,c.attackModifier.valueType),c.attackModifier);R.id="perk"+x,(!this.findByAttackModifier(v,R)||V.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.add||E>0)&&(R.character=!0),this.findByAttackModifier(M.attackModifiers,R)||(x++,M.attackModifiers.push(R))}})}),u.townGuardPerkSections&&y.townGuardPerks.forEach(O=>{const V=O.perk;if(!V)return;const c=O.sections.filter(E=>u.townGuardPerkSections.includes(E)).length;if(V.combined)c==V.count&&this.addPerkCard(V,M,v);else for(let E=0;E<c;E++)this.addPerkCard(V,M,v)}),u.scenarios.forEach(O=>{const V=_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.scenarioManager.scenarioDataForModel(O);V&&V.rewards&&V.rewards.townGuardAm&&V.rewards.townGuardAm.forEach((c,E)=>{let R=M.attackModifiers.find(T=>T.id==c);R?M.cards=[...M.cards,Object.assign(new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(R.type),R)]:console.warn("Unknown Town Guard AM:",c)})}),u.conclusions.forEach(O=>{const V=_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.scenarioManager.sectionDataForModel(O);V&&V.rewards&&V.rewards.townGuardAm&&V.rewards.townGuardAm.forEach((c,E)=>{let R=M.attackModifiers.find(T=>T.id==c);R?M.cards=[...M.cards,Object.assign(new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(R.type),R)]:console.warn("Unknown Town Guard AM:",c)})})),M}addPerkCard(u,y,v){if(u.cards=u.cards||[],u.cards.forEach((M,x)=>{(!this.findByAttackModifier(v,M.attackModifier)||u.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.add||u.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.replace&&x>=this.replaceCount(u))&&(M.attackModifier.character=!0)}),u.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.add)this.addCards(y,u.cards);else if(u.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.remove)this.removeCards(y,u.cards);else if(u.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.replace){const M=this.replaceCount(u);M&&(this.removeCards(y,u.cards.slice(0,M)),this.addCards(y,u.cards.slice(M,u.cards.length)))}}perkCards(u){let y=[];return u.perks.forEach(v=>{for(let M=0;M<(v.combined?1:v.count);M++)v.cards&&v.cards.forEach((x,O)=>{(v.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.add||v.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.replace&&O>=this.replaceCount(v))&&y.push(Object.assign(new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(x.attackModifier.type),x.attackModifier))})}),y}replaceCount(u){if(u.replaceCount)return u.replaceCount;let y=0;return u.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.replace&&(y=1,u.cards.forEach((v,M,x)=>{let O=x.slice(0,M+1).map(V=>V.count).reduce((V,c)=>V+c);M<x.length-1&&O<=x.slice(M+1,x.length).map(V=>V.count).reduce((V,c)=>V+c)&&(O=M+1)})),y}findByAttackModifier(u,y,v=!1){return u.find(M=>{let x=Object.assign(new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(y.type),y);x.id="",x.revealed=!1,x.shuffle=y.shuffle||!1;let O=Object.assign(new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(M.type),M);return O.id="",O.revealed=!1,O.shuffle=M.shuffle||!1,v&&O.character&&(O.character=!1),JSON.stringify(x)==JSON.stringify(O)})}addCards(u,y){y.forEach(v=>{for(let M=0;M<v.count;M++){const x=this.findByAttackModifier(u.attackModifiers,v.attackModifier);if(x){let O=Object.assign(new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(x.type),x);u.cards=[...u.cards,O]}else console.warn("Did not found AM to add: ",v.attackModifier,u)}})}removeCards(u,y){y.forEach(v=>{for(let M=0;M<v.count;M++){let x=!1,O=this.findByAttackModifier(u.cards,v.attackModifier);if(O){const V=u.cards.indexOf(O);u.cards.splice(V,1),x=!0}else if(!v.attackModifier.id&&!v.attackModifier.character&&(O=this.findByAttackModifier(u.cards,v.attackModifier,!0),O)){const V=u.cards.indexOf(O);u.cards.splice(V,1),x=!0}x||console.warn("Did not found AM to remove: ",v.attackModifier,u)}})}cardById(u,y){let v=u.attackModifiers.find(M=>M.id==y);if(v||(v=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.zs.find(M=>M.id==y),v||(v=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.bx.find(M=>M.id==y)),v||(v=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.iy.find(M=>M.id==y)),v||(v=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.u3.find(M=>M.id==y)),v||(v=this.getAllAdditional().find(M=>M.id==y)),v||(v=this.findForChallenge(y)),v||(v=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.IK.find(M=>M.id==y)),v||(v=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.qq.find(M=>M.id==y)),v||(v=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.vY.find(M=>M.id==y)),v))return Object.assign(new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(v.type),v)}findForChallenge(u){if(u.startsWith("challenge-fh-1503-")){const y=u.replace("challenge-fh-1503-","").split("-")[0],v=+u.replace("challenge-fh-1503-","").split("-")[1],M=_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.charactersData("fh").find(x=>"fh"==x.edition&&x.name==y);if(M){let x=this.perkCards(M)[v];if(x)return x.id="challenge-fh-1503-"+M.name+"-"+v,x.character=!0,x}}}mergeAttackModifierDeck(u,y){let v=!1;return u||(u=new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.J,v=!0),(y.discarded.length!=u.discarded.length||!y.discarded.every((M,x)=>u.discarded.indexOf(M)==x))&&(u.discarded=y.discarded,v=!0),u.current!=y.current&&(u.current=y.current,v=!0),u.lastVisible!=y.lastVisible&&(u.lastVisible=y.lastVisible,v=!0),u.state!=y.state&&(u.state=y.state,v=!0),(u.attackModifiers.length!=y.attackModifiers.length||!u.attackModifiers.map(M=>M.id).every((M,x)=>y.attackModifiers[x].id==M))&&(u.attackModifiers=y.attackModifiers,v=!0),(u.cards.length!=y.cards.length||!u.cards.map(M=>M.id).every((M,x)=>y.cards[x].id==M))&&(u.cards=y.cards,v=!0),v}fromModel(u,y){u.current=y.current,u.lastVisible=y.lastVisible,y.cards=y.cards.map(v=>("success"==v?v="tg-success":"wreck"==v?v="tg-wreck":"scenario-reward-55-0"==v?v="fh-tg-add-plus50-algox":"scenario-reward-56-0"==v||"scenario-reward-57-0"==v?v="fh-tg-add-plus50":"scenario-reward-58-0"==v||"scenario-reward-59-0"==v?v="fh-tg-add-plus50-unfettered":"scenario-reward-60-0"==v?v="fh-tg-add-plus50-lurkers":"conclusion-reward-50.2-0"==v&&(v="fh-tg-add-plus20"),v)),u.cards=y.cards.map(v=>this.cardById(u,v)||new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.invalid,0,src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.tW.default,v)),u.discarded=y.discarded||y.disgarded||[],u.active=y.active,u.state=y.state,u.bb=y.bb}calculateAttackResult(attackModifierDeck,base,forceIndex=-1){if(attackModifierDeck.current<0)return void console.warn("No Attack Modifier drawn",attackModifierDeck);let result=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_4__.hZ)(base),stringified="",rollingOffset=1,firstCard=attackModifierDeck.cards[attackModifierDeck.current],secondCard=attackModifierDeck.cards[attackModifierDeck.current-1],baseCard=firstCard,chooseOffset=0,effects=[];const fh=_GameManager__WEBPACK_IMPORTED_MODULE_7__.E.fhRules()||_SettingsManager__WEBPACK_IMPORTED_MODULE_8__.f.settings.alwaysFhAdvantage;if(attackModifierDeck.state){switch(attackModifierDeck.state){case"advantage":fh?(rollingOffset=2,chooseOffset=-1,this.applyAttackModifier(result,secondCard)>this.applyAttackModifier(result,baseCard)&&(baseCard=secondCard,chooseOffset=1),firstCard.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.success||secondCard.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.wreck?(baseCard=firstCard,chooseOffset=-1):(secondCard.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.success||firstCard.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.wreck)&&(baseCard=secondCard,chooseOffset=1)):baseCard.rolling?(baseCard=secondCard,rollingOffset=0):!secondCard.rolling&&this.applyAttackModifier(result,secondCard)>this.applyAttackModifier(result,baseCard)&&(baseCard=secondCard,chooseOffset=1);break;case"disadvantage":fh&&(chooseOffset=-1,firstCard.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.wreck||secondCard.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.success?(baseCard=firstCard,chooseOffset=-1):(secondCard.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.wreck||firstCard.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.success)&&(baseCard=secondCard,chooseOffset=1)),(this.applyAttackModifier(result,secondCard)<this.applyAttackModifier(result,baseCard)||!fh&&baseCard.rolling)&&(baseCard=secondCard,(fh||!baseCard.rolling)&&(chooseOffset=1))}-1!=forceIndex&&(baseCard=attackModifierDeck.cards[forceIndex],chooseOffset=attackModifierDeck.current-forceIndex-(forceIndex==attackModifierDeck.current?1:0))}if("disadvantage"!=attackModifierDeck.state&&attackModifierDeck.current-rollingOffset>-1){let u=attackModifierDeck.cards[attackModifierDeck.current-rollingOffset];for(;u&&u.rolling&&attackModifierDeck.current-rollingOffset>=attackModifierDeck.lastVisible;)result=this.applyAttackModifier(result,u),stringified+=this.stringifyAttackModifierValue(u),effects.push(...u.effects),rollingOffset++,u=attackModifierDeck.current-rollingOffset>-1?attackModifierDeck.cards[attackModifierDeck.current-rollingOffset]:void 0}result=this.applyAttackModifier(result,baseCard),stringified+=this.stringifyAttackModifierValue(baseCard);const matches=stringified.match(/x\d+/g)||[];return stringified=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_4__.hZ)(base)+stringified.replace(/x\d+/g,""),matches.length&&(stringified="("+stringified+")"+matches.join("")),effects.push(...baseCard.effects),new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.oz(attackModifierDeck.cards.indexOf(baseCard),chooseOffset,attackModifierDeck.state,base,stringified,eval(stringified.replaceAll("x","*")),effects)}applyAttackModifier(u,y){switch(y.valueType){case src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.tW.default:return y.value&&console.warn("Possible invalid AM",y),u;case src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.tW.plus:return u+y.value;case src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.tW.minus:return u-y.value;case src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.tW.multiply:return u*y.value}}stringifyAttackModifierValue(u){switch(u.valueType){case src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.tW.default:return u.value&&console.warn("Possible invalid AM",u),"+"+u.value;case src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.tW.plus:return"+"+u.value;case src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.tW.minus:return"-"+u.value;case src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.tW.multiply:return"x"+u.value}}}},8164(u,y,v){v.d(y,{N5:()=>V,rX:()=>c,up:()=>E});var M=v(2357),x=v(3812),O=v(1311),V=function(T){return T.new="new",T.true="true",T.false="false",T}(V||{}),c=function(T){return T.blue="blue",T.green="green",T.yellow="yellow",T.orange="orange",T.white="white",T.purple="purple",T.pink="pink",T.red="red",T.custom="custom",T.fh="fh",T}(c||{});class E{uuid;name;title;cardId;number;color;attack=0;movement=0;range=0;flying=!1;dead=!1;state=V.new;init=!0;action;additionalAction;thumbnail;thumbnailUrl;noThumbnail=!1;dormant=!1;revealed=!1;active=!1;off=!1;level;health=2;maxHealth=2;entityConditions=[];immunities=[];markers=[];tags=[];shield;shieldPersistent;retaliate=[];retaliatePersistent=[];constructor(B,q,I,s,D,p,G=void 0){this.uuid=B||(0,O.A)(),this.name=q,this.title="",this.cardId=I,this.level=s,this.number=D,this.color=p,G&&(this.maxHealth=(0,x.hZ)(G.health,s),this.health=this.maxHealth,this.attack=G.attack||0,this.movement=(0,x.hZ)(G.movement,s),this.range=(0,x.hZ)(G.range,s),this.flying=G.flying,this.action=G.action?JSON.parse(JSON.stringify(G.action)):void 0,this.additionalAction=G.additionalAction?JSON.parse(JSON.stringify(G.additionalAction)):void 0,G.thumbnail&&(this.thumbnail=G.edition+"-"+G.name),this.thumbnailUrl=G.thumbnailUrl,this.noThumbnail=G.noThumbnail),this.health=this.maxHealth}toModel(){return new R(this.uuid||(0,O.A)(),this.name,this.title,this.cardId,this.number,this.color,this.attack&&this.attack+""||"0",this.movement,this.range,this.flying,this.dead,this.state,this.level,this.health,this.maxHealth,this.entityConditions.map(B=>B.toModel()),this.immunities,this.markers,this.tags||[],this.action?JSON.stringify(this.action):void 0,this.additionalAction?JSON.stringify(this.additionalAction):void 0,this.active,this.dormant,this.thumbnail,this.thumbnailUrl,this.noThumbnail,this.shield,this.shieldPersistent,this.retaliate,this.retaliatePersistent)}fromModel(B){this.uuid=B.uuid||(0,O.A)(),this.name=B.name||"",this.title=B.title||"",this.cardId=B.cardId||"",this.number=B.number,this.color=B.color,this.attack=B.attack&&!isNaN(+B.attack)?+B.attack:B.attack||0,this.movement=B.movement,this.range=B.range,this.flying=B.flying,this.dead=B.dead,this.state=B.state,this.level=B.level,this.health=B.health,this.maxHealth=B.maxHealth,this.entityConditions=[],B.entityConditions&&(this.entityConditions=B.entityConditions.map(q=>{let I=new M.BR(q.name,q.value);return I.fromModel(q),I})),this.immunities=B.immunities||[],B.action&&(this.action=JSON.parse(B.action)),B.additionalAction&&(this.additionalAction=JSON.parse(B.additionalAction)),this.active=B.active,this.dormant=B.dormant,this.thumbnail=B.thumbnail,this.thumbnailUrl=B.thumbnailUrl,this.noThumbnail=B.noThumbnail,this.markers=B.markers||this.markers,this.tags=B.tags||this.tags,this.init=!1,this.shield=B.shield?JSON.parse(B.shield):void 0,this.shieldPersistent=B.shieldPersistent?JSON.parse(B.shieldPersistent):void 0,this.retaliate=(B.retaliate||[]).map(q=>JSON.parse(q)),this.retaliatePersistent=(B.retaliatePersistent||[]).map(q=>JSON.parse(q))}}class R{uuid;name;title;cardId;number;color;attack;movement;range;flying;dead;state;level;health;maxHealth;entityConditions;immunities;markers;tags;action;additionalAction;active=!1;dormant;thumbnail;thumbnailUrl;noThumbnail;shield;shieldPersistent;retaliate;retaliatePersistent;constructor(B,q,I,s,D,p,G,H,b,S,A,F,t,N,K,w,Q,$,Kt,st,Wt,nn,Sn,_n,Yt,mn,bn,Zt,kn,Dn){this.uuid=B,this.name=q,this.title=I,this.cardId=s,this.number=D,this.color=p,this.attack=G,this.movement=H,this.range=b,this.flying=S,this.dead=A,this.state=F,this.level=t,this.health=N,this.maxHealth=K,this.entityConditions=JSON.parse(JSON.stringify(w)),this.immunities=JSON.parse(JSON.stringify(Q)),this.markers=JSON.parse(JSON.stringify($)),this.tags=JSON.parse(JSON.stringify(Kt)),this.action=st,this.additionalAction=Wt,this.active=nn,this.dormant=Sn,this.thumbnail=_n,this.thumbnailUrl=Yt,this.noThumbnail=mn,this.shield=bn?JSON.stringify(bn):"",this.shieldPersistent=Zt?JSON.stringify(Zt):"",this.retaliate=kn.map(Rt=>JSON.stringify(Rt)),this.retaliatePersistent=Dn.map(Rt=>JSON.stringify(Rt))}}},8317(u,y,v){v.d(y,{E:()=>C});var M=v(5797),x=v(4786),O=v(57),V=v(4670),c=v(1824),E=v(9765),R=v(2065),T=v(6066),B=v(4933),q=v(6719),I=v(8164),s=v(8374),D=v(840),p=v(8635),G=v(2357),H=v(9039),b=v(8826),S=v(5532),A=v(3018),F=v(2e3),t=v(3812),N=v(3219),K=v(6538),w=v(1619);class Q{getValues(l){return l.value&&"string"==typeof l.value?l.value.split(":"):[]}calcActionHints(l,d){let h=[];if(l instanceof R.R&&d instanceof T.I&&h.push(...this.calcMonsterActionHints(l,d)),d instanceof I.up){if(d.action&&d.action.type==D.X2.shield){const _=h.find(f=>f.type==D.X2.shield);_?_.value+=(0,t.hZ)(d.action.value):h.push(new D.Uc(D.X2.shield,(0,t.hZ)(d.action.value)))}if(d.additionalAction&&d.additionalAction.type==D.X2.shield){const _=h.find(f=>f.type==D.X2.shield);_?_.value+=(0,t.hZ)(d.additionalAction.value):h.push(new D.Uc(D.X2.shield,(0,t.hZ)(d.additionalAction.value)))}if(d.action&&d.action.type==D.X2.retaliate){let _=d.action.subActions&&d.action.subActions.find(P=>P.type==D.X2.range);const f=h.find(P=>_&&(1!=(0,t.hZ)(_.value)||P.range&&1!=P.range)?P.type==D.X2.retaliate&&P.range==(0,t.hZ)(_.value):P.type==D.X2.retaliate);f?f.value+=(0,t.hZ)(d.action.value):h.push(new D.Uc(D.X2.retaliate,(0,t.hZ)(d.action.value),_?(0,t.hZ)(_.value):0))}if(d.additionalAction&&d.additionalAction.type==D.X2.retaliate){let _=d.additionalAction.subActions&&d.additionalAction.subActions.find(P=>P.type==D.X2.range);const f=h.find(P=>_&&(1!=(0,t.hZ)(_.value)||P.range&&1!=P.range)?P.type==D.X2.retaliate&&P.range==(0,t.hZ)(_.value):P.type==D.X2.retaliate);f?f.value+=(0,t.hZ)(d.additionalAction.value):h.push(new D.Uc(D.X2.retaliate,(0,t.hZ)(d.additionalAction.value),_?(0,t.hZ)(_.value):0))}}if(d.shield){const _=h.find(f=>f.type==D.X2.shield);_?_.value+=(0,t.hZ)(d.shield.value):h.push(new D.Uc(D.X2.shield,(0,t.hZ)(d.shield.value)))}if(d.shieldPersistent){const _=h.find(f=>f.type==D.X2.shield);_?_.value+=(0,t.hZ)(d.shieldPersistent.value):h.push(new D.Uc(D.X2.shield,(0,t.hZ)(d.shieldPersistent.value)))}return d.retaliate&&d.retaliate.forEach(_=>{let f=_.subActions.find(j=>j.type==D.X2.range);const P=h.find(j=>f&&(1!=(0,t.hZ)(f.value)||j.range&&1!=j.range)?j.type==D.X2.retaliate&&j.range==(0,t.hZ)(f.value):j.type==D.X2.retaliate);P?P.value+=(0,t.hZ)(_.value):h.push(new D.Uc(D.X2.retaliate,(0,t.hZ)(_.value),f?(0,t.hZ)(f.value):0))}),d.retaliatePersistent&&d.retaliatePersistent.forEach(_=>{let f=_.subActions.find(j=>j.type==D.X2.range);const P=h.find(j=>f&&(1!=(0,t.hZ)(f.value)||j.range&&1!=j.range)?j.type==D.X2.retaliate&&j.range==(0,t.hZ)(f.value):j.type==D.X2.retaliate);P?P.value+=(0,t.hZ)(_.value):h.push(new D.Uc(D.X2.retaliate,(0,t.hZ)(_.value),f?(0,t.hZ)(f.value):0))}),h.sort((_,f)=>_.type==D.X2.shield&&f.type!=D.X2.shield?-1:f.type==D.X2.shield&&_.type!=D.X2.shield?1:_.range-f.range)}calcMonsterActionHints(l,d){let h=[];const _=C.monsterManager.getStat(l,d.type);if(this.calcMonsterActionHint(l,d.type,D.X2.shield,_.actions,h),this.calcMonsterActionHint(l,d.type,D.X2.retaliate,_.actions,h),C.entityManager.isAlive(d,!0)&&(!d.active||l.active)){const f=C.game.figures.find(P=>P.active);if(l.active||C.game.state==E.mk.next&&(!f||C.game.figures.indexOf(f)>C.game.figures.indexOf(l))){let P=C.monsterManager.getAbility(l);if(C.monsterManager.hasBottomActions(l)&&l.firstActiveAction){const j=P;P=C.monsterManager.getAbility(l,!0),P&&(this.calcMonsterActionHint(l,d.type,D.X2.shield,"bottom"==l.firstActiveAction?P.bottomActions:P.actions,h),this.calcMonsterActionHint(l,d.type,D.X2.retaliate,"bottom"==l.firstActiveAction?P.bottomActions:P.actions,h)),j&&(this.calcMonsterActionHint(l,d.type,D.X2.shield,"bottom"==l.firstActiveAction?j.actions:j.bottomActions,h),this.calcMonsterActionHint(l,d.type,D.X2.retaliate,"bottom"==l.firstActiveAction?j.actions:j.bottomActions,h))}else P&&(this.calcMonsterActionHint(l,d.type,D.X2.shield,P.actions,h),this.calcMonsterActionHint(l,d.type,D.X2.retaliate,P.actions,h),P.bottomActions&&(this.calcMonsterActionHint(l,d.type,D.X2.shield,P.bottomActions,h,"bottom"),this.calcMonsterActionHint(l,d.type,D.X2.retaliate,P.bottomActions,h,"bottom")))}}return h}calcMonsterActionHint(l,d,h,_,f,P=""){_.forEach((j,Y)=>{const U=(P?P+"-":"")+Y;if(j.type==h&&"X"!=j.value){let z=new D.Uc(h,(0,t.hZ)(j.value));if(j.subActions&&j.subActions.length>0){let nt=j.subActions.find(gt=>gt.type==D.X2.range);if(nt)if(nt.valueType&&nt.valueType!=D.iQ.fixed){const gt=C.monsterManager.getStat(l,d);gt&&nt.valueType==D.iQ.plus?z.range=(0,t.hZ)(gt.range)+(0,t.hZ)(nt.value):gt&&nt.valueType==D.iQ.minus?z.range=(0,t.hZ)(gt.range)-(0,t.hZ)(nt.value):(nt.valueType==D.iQ.add||nt.valueType==D.iQ.subtract)&&(z.additionalRange=nt.valueType==D.iQ.add?"add":"substract",z.range=(0,t.hZ)(nt.value))}else z.range=(0,t.hZ)(nt.value)}let W=f.find(nt=>nt.type==z.type&&(!z.additionalRange&&nt.range==z.range||nt.range&&z.additionalRange));W?(W.range&&z.additionalRange&&("add"==z.additionalRange?W.range+=z.range:W.range-=z.range),W.value+=z.value):f.push(z)}else if(j.type==D.X2.monsterType&&j.value==d||j.type==D.X2.concatenation||j.type==D.X2.grid)this.calcMonsterActionHint(l,d,h,j.subActions,f,U);else if(j.type==D.X2.element&&j.valueType==D.iQ.minus&&l.entities.find(z=>z.tags.find(W=>W==this.roundTag(j,U))))this.calcMonsterActionHint(l,d,h,j.subActions,f,U);else if(j.type==D.X2.special){const z=l.stats.find(W=>W.level==l.level&&W.type==d);z&&this.calcMonsterActionHint(l,d,h,z.special[(0,t.hZ)(j.value)-1],f,U)}})}roundTag(l,d){return"roundAction-"+(d?d+"-":"")+l.type}isInteractiveAction(l){const d=l.subActions&&l.subActions.find(_=>_.type==D.X2.specialTarget&&(""+_.value).startsWith("self")),h=null!=d;switch(l.type){case D.X2.heal:return h&&l.subActions.every(_=>_==d||_.type==D.X2.condition);case D.X2.condition:return h&&1==l.subActions.length;case D.X2.sufferDamage:return!l.subActions||0==l.subActions.length||h&&1==l.subActions.length;case D.X2.switchType:case D.X2.element:return!0;case D.X2.spawn:case D.X2.summon:return this.getMonsterSpawnData(l).length>0||this.getObjectiveSpawnData(l).length>0}return!1}isInteractiveApplicableAction(l,d,h){if(!this.isInteractiveAction(d)||!C.entityManager.isAlive(l,!0)||-1!=l.tags.indexOf(this.roundTag(d,h)))return!1;switch(d.type){case D.X2.heal:return l.health>0&&l.health<(0,t.hZ)(l.maxHealth)||null!=d.subActions.find(f=>f.type==D.X2.condition&&new G.kW(f.value).types.includes(G.GV.positive));case D.X2.condition:return!C.entityManager.hasCondition(l,new G.kW(""+d.value));case D.X2.switchType:return l instanceof T.I&&(l.type==K.N.elite||l.type==K.N.normal);case D.X2.element:const _=this.getValues(d);return d.valueType&&d.valueType!=D.iQ.plus&&d.valueType!=D.iQ.fixed?d.valueType==D.iQ.minus&&this.getElementsToConsume(d).length==_.length&&(!d.subActions||d.subActions.every(P=>!this.isInteractiveAction(P))||d.subActions.some((P,j)=>this.isInteractiveApplicableAction(l,P,(h?h+"-":"")+j))):C.game.elementBoard.some(f=>(d.value==S.Hg.wild||_.includes(f.type))&&(f.state==S.e_.inert||f.state==S.e_.waning||f.state==S.e_.consumed||f.state==S.e_.partlyConsumed));case D.X2.sufferDamage:case D.X2.spawn:case D.X2.summon:return!0}return!1}getInteractiveActions(l,d,h,_){let f=[];return C.entityManager.isAlive(l,!0)?(h.forEach((P,j)=>{const Y=(_?_+"-":"")+j,U=this.roundTag(P,Y),z=l.tags.includes(U);if(this.isInteractiveApplicableAction(l,P,Y)&&!z&&f.push({action:P,index:Y}),P.subActions&&(P.type!=D.X2.monsterType&&!this.isInteractiveAction(P)||z||this.subactionElement(P,l,Y)||this.subactionsMonsterType(P,l))&&f.push(...this.getInteractiveActions(l,d,P.subActions,Y)),P.type==D.X2.special&&l instanceof T.I&&d instanceof R.R){const W=d.stats.find(nt=>nt.level==d.level&&nt.type==l.type);W&&f.push(...this.getInteractiveActions(l,d,W.special[(0,t.hZ)(P.value)-1],Y))}}),f):[]}getAllInteractiveActions(l,d,h){let _=[];return(l instanceof R.R||l instanceof B.$e)&&l.entities.forEach(f=>{C.actionsManager.getInteractiveActions(f,l,d,h).forEach(P=>{null==_.find(j=>j.index==P.index)&&_.push(P)})}),_}subactionElement(l,d,h){return l.type==D.X2.element&&(l.valueType!=D.iQ.minus||this.isInteractiveApplicableAction(d,l,h))}subactionsMonsterType(l,d){return l.type==D.X2.monsterType&&d instanceof T.I&&d.type==l.value}isMultiTarget(l,d=!0){return l.type==D.X2.target&&(0,t.hZ)(l.value)>1||this.isMultiTargetSpecial(l)||d&&l.type==D.X2.area||l.subActions&&l.subActions.some(_=>this.isMultiTarget(_,d))}isMultiTargetSpecial(l){return l.type==D.X2.specialTarget&&"string"==typeof l.value&&(l.value.toLowerCase().includes("allies")||l.value.toLowerCase().includes("enemies")||l.value.toLowerCase().includes("figures")||l.value.toLowerCase().includes("targets")||"all"==l.value)}applyInteractiveAction(l,d,h,_=[],f=!1){const P=h.action,j=h.index;if(!this.isInteractiveApplicableAction(l,P,j)&&!f)return;const Y=this.roundTag(P,j);if(!l.tags.includes(Y)){switch(P.type){case D.X2.heal:let U=(0,t.hZ)(P.value,d.level);l.health+U>(0,t.hZ)(l.maxHealth)&&(U=(0,t.hZ)(l.maxHealth)-l.health),l.health+=U,C.entityManager.addCondition(l,d,new G.kW(G.r5.heal,U)),P.subActions&&P.subActions.filter(nt=>nt.type==D.X2.condition).forEach(nt=>{C.entityManager.addCondition(l,d,new G.kW(""+nt.value))}),C.entityManager.applyCondition(l,d,G.r5.heal,!0);break;case D.X2.condition:if("bless"==P.value||"curse"==P.value){const nt=d instanceof R.R?w.f.settings.allyAttackModifierDeck&&(C.fhRules()||w.f.settings.alwaysAllyAttackModifierDeck)&&(d.isAlly||d.isAllied)?C.game.allyAttackModifierDeck:C.game.monsterAttackModifierDeck:d instanceof c.K?d.attackModifierDeck:void 0;nt&&C.attackModifierManager.addModifier(nt,new N.uU("bless"==P.value?N.Yn.bless:N.Yn.curse))}else C.entityManager.addCondition(l,d,new G.kW(""+P.value));break;case D.X2.sufferDamage:l.health-=(0,t.hZ)(P.value,d.level),l.health<=0&&(l.health=0),(d instanceof R.R&&l instanceof T.I&&l.health<=0||d instanceof B.$e&&l instanceof q.X&&l.health<=0)&&(l.dead=!0);break;case D.X2.switchType:if(d instanceof R.R&&l instanceof T.I){const nt=d.stats.find(ht=>ht.level==d.level&&ht.type==K.N.normal),gt=d.stats.find(ht=>ht.level==d.level&&ht.type==K.N.elite);nt&&gt&&(l.type=l.type==K.N.elite?K.N.normal:K.N.elite,l.maxHealth=(0,t.hZ)(l.type==K.N.normal?nt.health:gt.health,d.level),(l.health>l.maxHealth||l.health<l.maxHealth&&l.health==(0,t.hZ)(l.type==K.N.normal?gt.health:nt.health,l.level))&&(l.health=l.maxHealth))}break;case D.X2.element:if(d instanceof R.R&&d.entities.forEach(nt=>{nt!=l&&nt.tags.push(Y)}),P.valueType==D.iQ.minus){let nt=this.getValues(P).map(ht=>ht),gt=this.getElementsToConsume(P).map(ht=>ht.type);nt=nt.map(ht=>ht==S.Hg.wild?_.shift()||gt.shift():(gt.shift(),ht)).map(ht=>ht),nt.forEach(ht=>{C.game.elementBoard.forEach(kt=>{if(kt.type==ht&&(kt.state==S.e_.strong||kt.state==S.e_.waning))if(kt.state=S.e_.partlyConsumed,d instanceof R.R&&l instanceof T.I){const It=d.entities.filter(cn=>this.isInteractiveApplicableAction(cn,P,j));It.length&&It.indexOf(l)==It.length-1&&(kt.state=S.e_.consumed)}else if(d instanceof B.$e&&l instanceof q.X){const It=d.entities.filter(cn=>this.isInteractiveApplicableAction(cn,P,j));It.length&&It.indexOf(l)==It.length-1&&(kt.state=S.e_.consumed)}else kt.state=S.e_.consumed})})}else this.getValues(P).forEach((nt,gt)=>{const ht=_[gt]?_[gt]:nt;C.game.elementBoard.forEach(kt=>{kt.type==ht&&kt.state!=S.e_.always&&(kt.state=S.e_.new)})});break;case D.X2.spawn:case D.X2.summon:const z=this.getMonsterSpawnData(P);for(let nt of z)if(nt.monster&&nt.monster.type){const gt=d instanceof R.R?d.edition:C.game.scenario?C.game.scenario.edition:C.currentEdition(),ht=C.monsterManager.addMonsterByName(nt.monster.name,gt);if(ht){const kt="string"==typeof nt.count?(0,t.hZ)(nt.count.replaceAll("HP",""+l.health).replaceAll("H",""+(0,t.hZ)(l.maxHealth)),l.level):nt.count||1,It=Math.min(C.monsterManager.monsterStandeeMax(ht)-C.monsterManager.monsterStandeeCount(ht),kt);for(let cn=0;cn<It;cn++){const un=C.monsterManager.spawnMonsterEntity(ht,nt.monster.type,ht.isAlly,ht.isAllied,ht.drawExtra,P.type==D.X2.summon);if(un){if(nt.monster.marker&&(un.marker=nt.monster.marker),nt.monster.health){let me=nt.monster.health;"string"==typeof me&&(me=me.replaceAll("H",""+l.health)),un.health=(0,t.hZ)(me),un.health>un.maxHealth&&(un.health=un.maxHealth)}(un.marker||un.tags.length>0)&&C.addEntityCount(ht,un)}}}}const W=this.getObjectiveSpawnData(P);for(let nt of W)if(d instanceof R.R){const gt=nt.count?(0,t.hZ)(nt.count):1,ht=C.game.figures.find(kt=>kt instanceof B.$e&&C.additionalIdentifier(d).equals(kt.objectiveId))||C.objectiveManager.addObjective(nt.objective,nt.objective.name,C.additionalIdentifier(d));if(gt>1)for(let kt=0;kt<gt;kt++){const It=C.objectiveManager.addObjectiveEntity(ht);if(It){if(nt.objective.marker&&(It.marker=nt.objective.marker),nt.objective.health){let cn=nt.objective.health;"string"==typeof cn&&(cn=cn.replaceAll("H",""+l.health)),It.health=(0,t.hZ)(cn),It.health>It.maxHealth&&(It.health=It.maxHealth)}(It.marker||It.tags.length>0)&&C.addEntityCount(ht,It)}}}}l.tags.push(Y)}}getMonsterSpawnData(l){let d=[];if(!l||!l.type||l.type!=D.X2.spawn&&l.type!=D.X2.summon)return d;if("monsterStandee"==l.value){d=JSON.parse(JSON.stringify(l.valueObject)).map(_=>_);const h=Math.max(2,C.characterManager.characterCount());d=d.filter(_=>!!(_.monster.type||h<3&&_.monster.player2||3==h&&_.monster.player3||h>3&&_.monster.player4)||!w.f.settings.calculate),d.forEach(_=>{_.monster.type||(h<3&&_.monster.player2?_.monster.type=_.monster.player2:3==h&&_.monster.player3?_.monster.type=_.monster.player3:h>3&&_.monster.player4&&(_.monster.type=_.monster.player4))})}return d}getObjectiveSpawnData(l){let d=[];return!l||!l.type||l.type!=D.X2.spawn&&l.type!=D.X2.summon||"objectiveSpawn"==l.value&&(d=JSON.parse(JSON.stringify(l.valueObject)).map(h=>h),d=d.filter(h=>!h.count||(0,t.hZ)(h.count)>0)),d}getElementsToConsume(l){let d=[];return(!l||!l.type||l.type==D.X2.element&&l.valueType==D.iQ.minus)&&this.getValues(l).forEach((_,f,P)=>{const j=C.game.elementBoard.find(Y=>(Y.type==_||_==S.Hg.wild&&!P.includes(Y.type))&&Y.state!=S.e_.inert&&Y.state!=S.e_.new&&Y.state!=S.e_.consumed&&!d.includes(Y));j&&d.push(j)}),d}}var $=v(8102);class Kt{game;constructor(l){this.game=l}getBattleGoalEditions(){return C.editionData.filter(l=>w.f.settings.editions.includes(l.edition)&&l.battleGoals&&l.battleGoals.length>0).map(l=>l.edition)}getBattleGoals(l=!0,d=!1){const h=C.game.edition;return C.editionData.filter(_=>w.f.settings.editions.includes(_.edition)&&(C.game.edition&&C.editionRules(_.edition)||C.game.battleGoalEditions.includes(_.edition))).flatMap(_=>_.battleGoals.filter(f=>!l||!this.game.filteredBattleGoals||0==this.game.filteredBattleGoals.length||!this.game.filteredBattleGoals.find(P=>f.edition==P.edition&&f.name==P.name))).filter((_,f,P)=>d||!_.alias&&(!h||_.edition==h)||!P.find(j=>_.alias&&j.edition==_.alias.edition&&j.name==_.alias.name&&(!h||_.edition!=h)||j.edition==h&&j.alias&&_.edition==j.alias.edition&&_.name==j.alias.name)).sort((_,f)=>{if(_.edition==f.edition)return _.cardId<f.cardId?-1:1;if(h){if(_.edition==h)return-1;if(f.edition==h)return 1}return _.edition<f.edition?-1:1})}getUnrevealedBattleGoals(l=void 0){return this.getBattleGoals().filter(d=>!this.game.figures.find(h=>h instanceof c.K&&(!l||h!=l)&&h.battleGoals&&h.battleGoals.find(_=>d.edition==_.edition&&d.name==_.name)))}getBattleGoalsForEdition(l){return C.editionData.filter(d=>d.edition==l||C.editionExtensions(l).includes(l)).flatMap(d=>d.battleGoals)}getBattleGoal(l){return this.getBattleGoals(void 0,!0).find(d=>d.edition==l.edition&&d.name==l.name)}drawBattleGoal(l,d=!1){let h=this.getUnrevealedBattleGoals();if(C.trialsManager.apply&&C.trialsManager.activeTrial("fh",360)&&(h=h.filter(_=>2==_.checks)),h.length){let _=h[Math.floor(Math.random()*h.length)];l.battleGoals=l.battleGoals||[],d&&l.battleGoals.length>2?l.battleGoals.splice(l.battleGoals.length-2,0,new O.gw(_.name,_.edition)):l.battleGoals.push(new O.gw(_.name,_.edition))}}}var st=v(1571);class Wt{game;petsAvailable=!1;petsEnabled=!1;gardenAvailable=!1;gardenEnabled=!1;distillAvailable=!1;constructor(l){this.game=l}update(){this.petsAvailable=C.fhRules()&&null!=C.game.party.buildings.find(l=>"stables"==l.name&&l.level),this.petsEnabled=this.petsAvailable&&w.f.settings.fhPets,this.gardenAvailable=C.fhRules()&&null!=C.game.party.buildings.find(l=>"garden"==l.name&&l.level),this.gardenEnabled=this.gardenAvailable&&w.f.settings.fhGarden,this.distillAvailable=(w.f.settings.characterItems||w.f.settings.characterSheet)&&C.fhRules()&&null!=C.game.party.buildings.find(l=>"alchemist"==l.name&&l.level>1&&"wrecked"!=l.state)}applyRewards(l){if(l.defense&&(this.game.party.defense+=l.defense),l.loseMorale&&(this.game.party.morale-=l.loseMorale,this.game.party.morale<0&&(this.game.party.morale=0)),l.prosperity&&(this.game.party.prosperity+=l.prosperity),l.soldiers){this.game.party.soldiers+=l.soldiers;const d=this.game.party.buildings.find(h=>"barracks"==h.name);if(d){let h=0;1==d.level?h=4:2==d.level?h=6:3==d.level?h=8:4==d.level&&(h=10),this.game.party.soldiers>h&&(this.game.party.soldiers=h)}}}rewardSection(l){if(C.game.party.conclusions.find(h=>h.edition==l.edition&&h.index==l.index&&h.group==l.group))return l;const d=C.sectionData(l.edition).filter(h=>h.conclusion&&!h.parent&&h.parentSections&&h.parentSections.find(_=>1==_.length&&_.includes(l.index)));if(0!=d.length){let h;return d.forEach(_=>{h||(h=this.rewardSection(_))}),h}}initialBuilding(l){return 0==l.costs.prosperity&&0==l.costs.lumber&&0==l.costs.metal&&0==l.costs.hide&&0==l.costs.gold}availableBuilding(l){return l.prosperityUnlock&&l.costs.prosperity<=C.prosperityLevel()&&!C.game.party.buildings.find(d=>l.name==d.name&&d.level)&&(!l.requires||null!=C.game.party.buildings.find(d=>d.name==l.requires&&d.level))}nextWeek(){if(this.gardenEnabled){const l=this.game.party.buildings.find(d=>"garden"==d.name&&d.level);this.game.party.garden=this.game.party.garden||new st.j,l&&(this.game.party.garden.flipped=l.level<3&&!this.game.party.garden.flipped,this.game.party.garden.automated&&(l.level>2||this.game.party.garden.flipped)&&this.game.party.garden.plots.forEach(d=>{this.game.party.loot[d]=(this.game.party.loot[d]||0)+1}))}}}var nn=v(3492);class Sn{game;available=!1;enabled=!1;apply=!1;constructor(l){this.game=l}drawCard(l){l.current++,l.current>=l.cards.length&&(l.current=l.cards.length-1)}shuffleDeck(l,d=!1){const h=l.current,_=l.finished;let f=d&&h>-1?l.cards.splice(0,h+1):[];l.current=-1,l.finished=-1,l.keep=[],(0,V.Z)(l.cards),d&&(l.current=h,l.finished=_,l.cards.unshift(...f))}getChallengeCard(l){return C.challengesData(l.edition).find(d=>d.cardId==+l.name)}clearDrawn(l,d=!1){let h=[];if(d&&l.keep.forEach(_=>{h.push(l.cards[_])}),l.current>=0){for(let _=l.current;_>l.finished;_--)if(!d||!l.keep.includes(_)){const f=l.cards.splice(_,1);f.length&&(l.cards=[...l.cards,f[0]])}l.keep=d?h.map(_=>l.cards.indexOf(_)):[],l.current=l.finished+(d?l.keep.length:0)}}toggleKeep(l,d,h){l.keep.includes(d)?l.keep.splice(l.keep.indexOf(d),1):(l.keep.length==h&&l.keep.splice(0,1),l.keep.push(d))}update(){if(this.available=C.fhRules()&&null!=this.game.party.buildings.find(l=>"town-hall"==l.name&&l.level),this.enabled=w.f.settings.fhChallenges&&C.fhRules()&&null!=this.game.party.buildings.find(l=>"town-hall"==l.name&&l.level&&"wrecked"!=l.state),this.apply=w.f.settings.fhChallengesApply&&this.enabled,this.available&&this.game.edition){const l=C.challengesData(this.game.edition);l.length&&(!this.game.challengeDeck||!this.game.challengeDeck.cards.length)&&(this.game.challengeDeck=new nn.lV,this.game.challengeDeck.cards=l.map(d=>{const h=new nn.W2;return h.cardId=d.cardId,h.edition=d.edition,h}),this.game.challengeDeck.current=-1,this.shuffleDeck(this.game.challengeDeck))}this.apply&&this.applyCardsAlways()}activeCards(l=void 0,d=!1){return this.available&&this.game.challengeDeck.cards.length&&this.game.challengeDeck.current>this.game.challengeDeck.finished&&(d||!C.roundManager.firstRound)||this.game.state==E.mk.next?this.game.challengeDeck.cards.slice(this.game.challengeDeck.finished+1,this.game.challengeDeck.current+1).filter(h=>!l||h.edition==l||C.editionExtensions(l).includes(h.edition)):[]}activeCardIds(l=void 0){return this.activeCards(l).map(d=>d.cardId)}isActive(l,d=void 0){return this.activeCardIds(d).includes(l)}applyCardsStart(){this.activeCards(void 0,!0).forEach(l=>{this.applyCardStart(l)})}applyCardStart(l){if("fh"==l.edition)switch(l.cardId){case 1486:for(let h=0;h<3;h++)C.attackModifierManager.addModifier(this.game.monsterAttackModifierDeck,new N.uU(N.Yn.bless));break;case 1496:this.game.monsterAttackModifierDeck.cards=this.game.monsterAttackModifierDeck.cards.filter(h=>h.type!=N.Yn.plus0);break;case 1503:const d=C.charactersData("fh").filter(h=>(!h.spoiler||this.game.unlockedCharacters.includes(h.edition+":"+h.name))&&!this.game.figures.find(_=>_ instanceof c.K&&_.edition==h.edition&&_.name==h.name));if(d.length){const h=d[Math.floor(Math.random()*d.length)];let _=C.attackModifierManager.perkCards(h);_.forEach((f,P)=>{f.id="challenge-fh-1503-"+h.name+"-"+P,f.character=!0});for(let f=0;f<5;f++){let P=_.splice(Math.floor(Math.random()*_.length),1)[0];this.game.monsterAttackModifierDeck.cards=[...this.game.monsterAttackModifierDeck.cards,Object.assign(new N.uU(P.type),P)]}C.attackModifierManager.shuffleModifiers(this.game.monsterAttackModifierDeck)}}}applyCardsAlways(){this.activeCards().forEach(l=>{this.applyCardAlways(l),this.game.figures.forEach(d=>{d instanceof R.R&&this.applyCardStatEffect(d,l)})})}applyCardAlways(l){if("fh"==l.edition)switch(l.cardId){case 1484:this.game.monsterAttackModifierDeck.cards.forEach(d=>{(!d.effects||0==d.effects.length)&&(d.type==N.Yn.minus1||d.type==N.Yn.minus2||d.type==N.Yn.null)&&(d.effects=[],d.effects.push(new N.hM(N.hY.changeType,N.Yn.plus0)))});break;case 1485:this.game.monsterAttackModifierDeck.cards.forEach(d=>{(!d.effects||0==d.effects.length)&&d.type==N.Yn.minus2&&(d.effects=[],d.effects.push(new N.hM(N.hY.changeType,N.Yn.double)))});break;case 1523:if(2==this.game.round&&this.game.state==E.mk.draw){let d=this.game.figures.find(h=>h instanceof R.R&&"fh"==h.edition&&"hound"==h.name);if(!d||!d.tags.includes("challenge-fh-1523")){if(!d){const h=C.monstersData("fh").find(_=>"hound"==_.name);h?d=C.monsterManager.addMonster(h,this.game.level):console.error("Unknown state: Monster Data for hound missing apply FH Challenge 1523!")}if(d){d.tags.push("challenge-fh-1523");for(let h=0;h<C.characterManager.characterCount();h++)C.monsterManager.spawnMonsterEntity(d,K.N.normal)}}}}}applyCardsTrigger(l){this.activeCards().forEach(d=>{d.cardId==l&&this.applyCardTrigger(d)})}applyCardTrigger(l){if("fh"==l.edition&&1526===l.cardId){const d=this.game.figures.filter(h=>h instanceof R.R).map(h=>h.entities.filter(_=>C.entityManager.isAlive(_)).length);d.length&&d.reduce((h,_)=>h+_)<C.characterManager.characterCount()&&this.game.figures.forEach(h=>{h instanceof R.R&&h.entities.forEach(_=>{C.entityManager.isAlive(_)&&C.entityManager.addCondition(_,h,new G.kW(G.r5.ward))})})}}applyCardStatEffect(l,d){"fh"==d.edition&&l.entities.forEach(h=>{if(C.entityManager.isAlive(h))switch(d.cardId){case 1492:if(h.health!=h.maxHealth||h.tags&&h.tags.includes("challenge-fh-1492")){if(h.health<h.maxHealth&&h.tags&&h.tags.includes("challenge-fh-1492")){const P=h.retaliatePersistent.find(j=>!(j.type!=D.X2.retaliate||2!=j.value||j.valueType!=D.iQ.fixed||j.subActions&&j.subActions.length));P&&h.retaliatePersistent.splice(h.retaliatePersistent.indexOf(P),1),h.tags.splice(h.tags.indexOf("challenge-fh-1492"))}}else h.tags=h.tags||[],h.tags.push("challenge-fh-1492"),h.retaliatePersistent.push(new D.rc(D.X2.retaliate,2));break;case 1493:(!h.tags||!h.tags.includes("challenge-fh-1493"))&&(h.tags=h.tags||[],h.tags.push("challenge-fh-1493"),h.maxHealth+=Math.ceil(this.game.level/2),h.health+=Math.ceil(this.game.level/2));break;case 1496:(!h.immunities||!h.immunities.includes(G.r5.curse))&&(!h.tags||!h.tags.includes("challenge-fh-1496"))&&(h.tags=h.tags||[],h.tags.push("challenge-fh-1496"),h.immunities.push(G.r5.curse));break;case 1515:const _=l.entities.find(P=>P.type==K.N.elite&&C.entityManager.isAlive(P));!_||h.type!=K.N.normal||h.tags&&h.tags.includes("challenge-fh-1515")?!_&&h.tags&&h.tags.includes("challenge-fh-1515")&&(h.shieldPersistent&&(1==h.shieldPersistent.value?h.shieldPersistent=void 0:h.shieldPersistent.value=(0,t.hZ)(h.shieldPersistent.value)-1),h.tags.splice(h.tags.indexOf("challenge-fh-1515"))):(h.tags=h.tags||[],h.tags.push("challenge-fh-1515"),h.shieldPersistent?h.shieldPersistent.value=(0,t.hZ)(h.shieldPersistent.value)+1:h.shieldPersistent=new D.rc(D.X2.shield,1));break;case 1524:const f=h.entityConditions.filter(P=>P.types.includes(G.GV.negative)&&P.state!=G.mg.removed&&!P.expired);f.length||h.tags&&h.tags.includes("challenge-fh-1524")?f.length&&h.tags&&h.tags.includes("challenge-fh-1524")&&(h.shieldPersistent&&(1==h.shieldPersistent.value?h.shieldPersistent=void 0:h.shieldPersistent.value=(0,t.hZ)(h.shieldPersistent.value)-1),h.tags.splice(h.tags.indexOf("challenge-fh-1524"))):(h.tags=h.tags||[],h.tags.push("challenge-fh-1524"),h.shieldPersistent?h.shieldPersistent.value=(0,t.hZ)(h.shieldPersistent.value)+1:h.shieldPersistent=new D.rc(D.X2.shield,1))}})}}var _n=v(1311),Yt=v(7017),mn=v(4074);class bn{game;xpMap=[0,45,95,150,210,275,345,420,500];constructor(l){this.game=l}characterIcon(l,d=""){let h;return h=l instanceof p.qS?l:C.getCharacterData(l,d),h.iconUrl?h.iconUrl:h.icon?"./assets/images/character/icons/"+h.icon+".svg":"./assets/images/character/icons/"+h.edition+"-"+h.name+".svg"}characterIdentityIcon(l,d){const h=C.getCharacterData(l);return h.identities&&0!=h.identities.length?"./assets/images/character/icons/"+h.edition+"-"+h.name+"-"+h.identities[d]+".svg":this.characterIcon(l)}characterName(l,d=!1,h=!1,_=!0){let f=w.f.getLabel("data.character."+l.edition+"."+l.name),P=!1;return _&&l.identities.length>0&&w.f.settings.characterIdentities?l.title&&l.title.split("|")[l.identity]&&l.title.split("|")[l.identity]?(f=l.title.split("|")[l.identity],P=!0):w.f.settings.characterIdentityHint&&!d&&(f+=" ("+w.f.getLabel("data.character."+l.edition+"."+l.name+"."+l.identities[l.identity])+")"):l.title&&(f=l.title,P=!0),d&&P&&(f+=" ("+w.f.getLabel("data.character."+l.edition+"."+l.name)+")"),h&&(f="%game.characterIconColored."+l.name+"%"+f),this.game.figures.find(j=>j instanceof c.K&&j.name==l.name&&j.edition!=l.edition)&&(f+=" ["+w.f.getLabel("data.edition."+l.edition)+"]"),f}characterColor(l){let d;return d=l instanceof p.qS?l:C.getCharacterData(l),d.color}characterThumbnail(l){return l.thumbnailUrl?l.thumbnailUrl:l.thumbnail?"./assets/images/character/thumbnail/"+l.thumbnail+".png":"./assets/images/character/thumbnail/"+l.edition+"-"+l.name+".png"}characterCount(l=!1){return!l&&this.game.playerCount>0?this.game.playerCount:this.game.figures.filter(d=>d instanceof c.K&&!d.absent).length}addCharacter(l,d){if(!this.game.figures.some(h=>h instanceof c.K&&h.name==l.name&&h.edition==l.edition)){let h=new c.K(l,d);for(h.availableSummons.filter(_=>_.special).forEach(_=>this.createSpecialSummon(h,_)),h.number=1;C.game.figures.some(_=>_ instanceof c.K&&_.number==h.number);)h.number++;this.game.party.retirements&&this.game.party.retirements.forEach(_=>{_.number==h.number&&h.progress.retirements++}),0==h.progress.gold&&(C.fhRules()?h.progress.gold=10*C.prosperityLevel()+20:C.gh2eRules()?h.progress.gold=10*C.prosperityLevel()+15:C.editionRules("jotl")||(h.progress.gold=15*(h.level+1))),h.tags.push("new-character"),this.game.figures.push(h),C.addEntityCount(h),this.previousEnhancements(h,C.enhancementsManager.temporary),this.game.state==E.mk.next&&C.attackModifierManager.shuffleModifiers(h.attackModifierDeck),C.sortFigures(h)}this.game.levelCalculation&&C.levelManager.calculateScenarioLevel(),C.trialsManager.applyTrialCards()}removeCharacter(l,d=!1){const h=this.game.figures.indexOf(l);if(-1!=h){if(this.game.figures.splice(h,1),d&&w.f.settings.applyRetirement&&(C.game.party.prosperity+=C.fhRules(!0)?2:1,w.f.settings.events&&l.retireEvent&&l.retireEvent.split("|").forEach(_=>{_.split(":").length>1?C.eventCardManager.addEvent(_.split(":")[0],_.split(":")[1],!0):(C.eventCardManager.addEvent("city",_,!0),C.eventCardManager.addEvent("road",_,!0))})),l.marker){const _=l.edition+"-"+l.name;this.game.figures.forEach(f=>{f instanceof c.K?(f.markers.splice(f.markers.indexOf(_),1),f.summons&&f.summons.forEach(P=>{P.markers.splice(P.markers.indexOf(_),1)})):(f instanceof R.R||f instanceof B.$e)&&f.entities.forEach(P=>{P.markers.splice(P.markers.indexOf(_),1)})})}this.game.levelCalculation&&C.levelManager.calculateScenarioLevel()}}addSummon(l,d){l.summons=l.summons.filter(h=>h.name!=d.name||h.number!=d.number||h.color!=d.color),"cs"==l.edition&&"skull"==l.name&&d.cardId&&l.availableSummons.find(h=>h.cardId==d.cardId)&&(d.tags.push("cs-skull-spirit"),d.state=I.N5.true),l.summons.push(d),"boneshaper"==l.name&&(l.tags.includes("solid-bones")||l.tags.includes("unholy-prowess"))&&"shambling-skeleton"===d.name&&(d.maxHealth+=1,d.health==d.maxHealth-1?d.health=d.maxHealth:d.health+=1,C.entityManager.checkHealth(d,l),l.tags.includes("solid-bones")&&(d.movement+=1,d.action=new D.rc(D.X2.pierce,1))),"astral"==l.name&&l.tags.includes("veil-of-protection")&&(d.health+=3,d.maxHealth+=3)}removeSummon(l,d){if(l.summons.splice(l.summons.indexOf(d),1),"astral"==l.name&&l.tags.includes("imbue-with-life")&&"animated-claymore"==d.name){let h=l.entityConditions.find(_=>_.name==G.r5.disarm);l.tags=l.tags.filter(_=>"imbue-with-life"!=_),h&&(h.permanent=!1,h.state=G.mg.expire)}}addXP(l,d,h=!0){l.progress.experience+=d,h&&this.setLevel(l,this.levelForXp(l.progress.experience))}levelForXp(l){let d=0;return this.xpMap.forEach((h,_)=>{l>=h&&(d=_+1)}),d}setLevel(l,d){const h=l.stats.find(f=>f.level==d);h?l.stat=h:(l.errors=l.errors||[],!l.errors.find(f=>f.type==x.H.unknown)&&!l.errors.find(f=>f.type==x.H.stat)&&(console.error("No character stat found for level: "+d),l.errors.push(new x.h(x.H.stat,"character",l.name,l.edition,"",""+d))),l.stat=new Yt.s(d,0)),l.level=d;const _=l.health==l.maxHealth;l.maxHealth=l.stat.health,"shackles"==l.name&&"fh"==l.edition&&2==l.progress.perks[11]&&(l.maxHealth+=5),"astral"==l.name&&l.tags.includes("veil-of-protection")&&(l.maxHealth+=3),l.progress.equippedItems.find(f=>"fh"==f.edition&&"3"==f.name)&&(l.maxHealth+=1,l.health+=1),(l.health>l.maxHealth||_)&&(l.health=l.maxHealth),l.availableSummons.filter(f=>f.special).forEach(f=>this.createSpecialSummon(l,f)),(l.progress.experience<C.characterManager.xpMap[d-1]||l.progress.experience>=C.characterManager.xpMap[d])&&(l.progress.experience=C.characterManager.xpMap[d-1]),this.game.levelCalculation&&C.levelManager.calculateScenarioLevel(),l.bb&&(l.attackModifierDeck=C.attackModifierManager.buildCharacterAttackModifierDeck(l))}createSpecialSummon(l,d){if(l.summons=l.summons.filter(h=>h.name!=d.name||0!=h.number||h.color!=I.rX.custom),!d.level||d.level<=l.level){let h=new I.up((0,_n.A)(),d.name,d.cardId,l.level,0,I.rX.custom,d);h.state=I.N5.true,h.init=!1,this.addSummon(l,h)}}ignoreNegativeItemEffects(l){let d=l.perks.find(h=>h.custom&&(h.custom.includes("%game.custom.perks.ignoreNegativeItem%")||h.custom.includes("%game.custom.perks.ignoreNegativeItemFh%")));if(d){const h=l.perks.indexOf(d);return l.progress.perks[h]&&d.combined?l.progress.perks[h]==d.count:l.progress.perks[h]>0}return!1}ignoreNegativeScenarioffects(l){let d=l.perks.find(h=>h.custom&&(h.custom.includes("%game.custom.perks.ignoreNegativeScenario%")||h.custom.includes("%game.custom.perks.ignoreScenario%")));if(d){const h=l.perks.indexOf(d);return l.progress.perks[h]&&d.combined?l.progress.perks[h]==d.count:l.progress.perks[h]>0}return!1}itemEffect(l){return"gh"==l.edition?"number"==typeof l.id&&[16,38,52,101,103,108].includes(l.id):"cs"==l.edition?"number"==typeof l.id&&[157,71].includes(l.id):"toa"==l.edition?"number"==typeof l.id&&[101,107].includes(l.id):"fh"==l.edition&&"number"==typeof l.id&&[3,11,41,60,132,138,178].includes(l.id)}applyDonations(l){for(let d=0;d<l.donations;d++)if(C.editionRules("cs")){const h=N.bx.filter(f=>!f.rolling&&!this.game.figures.find(P=>P instanceof c.K&&P.attackModifierDeck.cards.find(j=>j.id==f.id))),_=N.bx.filter(f=>f.rolling&&!this.game.figures.find(P=>P instanceof c.K&&P.attackModifierDeck.cards.find(j=>j.id==f.id)));h.length>0&&C.attackModifierManager.addModifier(l.attackModifierDeck,h[Math.floor(Math.random()*h.length)]),_.length>0&&C.attackModifierManager.addModifier(l.attackModifierDeck,_[Math.floor(Math.random()*_.length)])}else C.attackModifierManager.addModifier(l.attackModifierDeck,new N.uU(N.Yn.bless)),C.attackModifierManager.addModifier(l.attackModifierDeck,new N.uU(N.Yn.bless));l.donations=0}next(){this.game.figures.forEach(l=>{l instanceof c.K&&(l.initiative=0,l.initiativeVisible=!1,l.off=!1,w.f.settings.characterAttackModifierDeckPermanent||(l.attackModifierDeckVisible=!1),l.lootCardsVisible=!1,l.longRest=!1,l.summons=l.summons.filter(d=>C.entityManager.isAlive(d)),l.summons.forEach(d=>{d.state==I.N5.new&&(d.state=I.N5.true)}),l instanceof c.K&&!l.absent&&"blinkblade"==l.name&&l.tags.includes("time_tokens")&&0==l.primaryToken&&(l.identity=0),l.progress.equippedItems.find(d=>"cs"==d.edition&&"57"==d.name)&&C.entityManager.hasCondition(l,new G.kW(G.r5.wound))&&!C.entityManager.hasCondition(l,new G.kW(G.r5.regenerate))&&C.entityManager.addCondition(l,l,new G.kW(G.r5.regenerate)),l.tags&&(l.tags=l.tags.filter(d=>!d.startsWith("roundAction-"))),C.trialsManager.apply&&C.trialsManager.trialsEnabled&&w.f.settings.battleGoals&&C.entityManager.isAlive(l)&&l.progress.trial&&"fh"==l.progress.trial.edition&&"356"==l.progress.trial.name&&l.tags.includes("trial-fh-356")&&(l.tags.splice(l.tags.indexOf("trial-fh-356"),1),C.battleGoalManager.drawBattleGoal(l,!0)))})}draw(){this.game.figures.forEach(l=>{l instanceof c.K&&(1==this.game.round&&(this.applyDonations(l),l.initiativeVisible=!0),C.entityManager.isAlive(l)&&!l.absent&&(l.off=!1),!l.absent&&"blinkblade"==l.name&&l.tags.includes("time_tokens")&&0==l.primaryToken&&(0==l.identity&&l.tokenValues[0]<2?l.tokenValues[0]+=1:1==l.identity&&(l.tokenValues[0]>0?l.tokenValues[0]-=1:(l.identity=0,l.tokenValues[0]=1))),C.entityManager.isAlive(l)&&"shackles"==l.name&&l.tags.includes("delayed_malady")&&(l.tags.splice(l.tags.indexOf("delayed_malady"),1),l.entityConditions.forEach(d=>{d.types.indexOf(G.GV.negative)&&!d.expired&&d.state!=G.mg.removed&&(l.immunities.includes(d.name)||l.immunities.push(d.name))}),l.tags.includes("delayed_malady")||(l.immunities=[])),C.trialsManager.apply&&C.trialsManager.trialsEnabled&&w.f.settings.battleGoals&&!l.absent&&l.progress.trial&&"fh"==l.progress.trial.edition&&"356"==l.progress.trial.name&&l.tags.includes("trial-fh-356")&&l.tags.splice(l.tags.indexOf("trial-fh-356"),1))})}personalQuestByCard(l,d){return C.editionData.filter(h=>h.edition==l||C.editionExtensions(l).includes(h.edition)).flatMap(h=>h.personalQuests).find(h=>h.cardId==d||h.altId==d||h.altId=="0"+d)}previousEnhancements(l,d){l.progress.enhancements=l.progress.enhancements?l.progress.enhancements.filter(h=>!h.inherited):[],d||(C.game.party.retirements.filter(_=>_.edition==l.edition&&_.name==l.name).forEach(_=>{_&&_.progress&&_.progress.enhancements&&l.progress.enhancements.push(..._.progress.enhancements.filter(f=>!f.inherited).map(f=>new mn.V(f.cardId,f.actionIndex,f.index,f.action,!0)))}),l.progress.enhancements=l.progress.enhancements.filter((_,f,P)=>{const j=P.find(Y=>Y.cardId==_.cardId&&Y.actionIndex==_.actionIndex&&Y.index==_.index);return!j||f===P.indexOf(j)})),l.progress.enhancements.filter(h=>h.actionIndex.includes("custom")).forEach(h=>{const _=C.deckData(l).abilities.find(f=>f.cardId==h.cardId);if(_){const f=this.enhancementMapping(h.actionIndex.includes("bottom")?_.bottomActions||[]:_.actions,h.actionIndex.includes("bottom")?"bottom":"");f.length&&f[h.index]&&(h.actionIndex=f[h.index],h.index=h.index-f.indexOf(h.actionIndex))}})}enhancementMapping(l,d){let h=[];return l.forEach((_,f)=>{if(_.type!=D.X2.custom||"%character.abilities.wip%"!=_.value){const P=(d?d+"-":"")+f;_.enhancementTypes&&_.enhancementTypes.forEach(j=>{h.push(P)}),_.subActions&&h.push(...this.enhancementMapping(_.subActions,P))}}),h}getActiveCharacters(){return this.game.figures.filter(l=>l instanceof c.K&&C.gameplayFigure(l)&&!l.absent).map(l=>l)}}var Zt=v(2120);class kn{game;fh=!1;temporary=!1;enhancerLevel=0;squareActions=[D.X2.move,D.X2.attack,D.X2.range,D.X2.shield,D.X2.push,D.X2.pull,D.X2.pierce,D.X2.retaliate,D.X2.heal,D.X2.target,D.X2.teleport];circleActions=[D.X2.move,D.X2.attack,D.X2.range,D.X2.shield,D.X2.push,D.X2.pull,D.X2.pierce,D.X2.retaliate,D.X2.heal,D.X2.target,D.X2.teleport];diamondActions=[D.X2.attack,D.X2.condition,D.X2.push,D.X2.pull];diamondPlusActions=[D.X2.heal,D.X2.condition,D.X2.shield,D.X2.retaliate];hexActions=[D.X2.area];summonActions=[D.X2.move,D.X2.attack,D.X2.range,D.X2.heal];diamondConditions=[G.r5.poison,G.r5.wound,G.r5.muddle,G.r5.immobilize,G.r5.disarm,G.r5.curse];diamondPlusConditions=[G.r5.strengthen,G.r5.bless,G.r5.regenerate];constructor(l){this.game=l}update(){this.fh=C.fhRules(!0)||w.f.settings.alwaysFhEnhancements,this.temporary=w.f.settings.temporaryEnhancements,this.enhancerLevel=this.fh&&this.game.party.buildings.find(l=>"enhancer"==l.name&&l.level&&"wrecked"!=l.state)?.level||0,this.fh?(this.diamondConditions=[G.r5.poison,G.r5.wound,G.r5.muddle,G.r5.immobilize,G.r5.curse],this.diamondPlusConditions=[G.r5.strengthen,G.r5.bless,G.r5.regenerate,G.r5.ward]):(this.diamondConditions=[G.r5.poison,G.r5.wound,G.r5.muddle,G.r5.immobilize,G.r5.disarm,G.r5.curse],this.diamondPlusConditions=[G.r5.strengthen,G.r5.bless,G.r5.regenerate])}calculateCosts(l,d=1,h,_,f=!1){let P=0;return P+=this.calculateBaseCosts(l,h),P>0&&(C.actionsManager.isMultiTarget(l)&&(P*=2),this.fh&&"lost"==h&&(P/=2),this.fh&&!C.gh2eRules()&&"persistent"==h&&(P*=3),P+=this.levelCosts(d),P+=this.enhancementCosts(_),this.fh&&this.temporary&&(_&&(P-=20),f||(P=Math.ceil(.8*P))),this.enhancerLevel>1&&!f&&(P-=10)),P}calculateBaseCosts(l,d=void 0){let h=0;if("summon"==d)switch(l.type){case D.X2.move:h+=this.fh?60:this.temporary?40:100;break;case D.X2.attack:h+=!this.fh&&this.temporary?60:100;break;case D.X2.range:h+=!this.fh&&this.temporary?40:50;break;case D.X2.heal:h+=this.fh?40:this.temporary?30:50}else switch(l.type){case D.X2.move:h+=!this.fh&&this.temporary?20:30;break;case D.X2.attack:h+=!this.fh&&this.temporary?35:50;break;case D.X2.range:h+=!this.fh&&this.temporary?20:30;break;case D.X2.target:h+=this.fh?75:this.temporary?40:50;break;case D.X2.shield:h+=this.fh?80:this.temporary?60:100;break;case D.X2.retaliate:h+=this.fh?60:this.temporary?40:100;break;case D.X2.pierce:h+=!this.fh&&this.temporary?15:30;break;case D.X2.heal:case D.X2.push:h+=!this.fh&&this.temporary?20:30;break;case D.X2.pull:h+=this.fh?20:this.temporary?15:30;break;case D.X2.teleport:h+=this.fh?50:40;break;case D.X2.jump:h+=this.fh?60:this.temporary?35:50;break;case D.X2.element:h+=l.value!=S.Hg.wild?!this.fh&&this.temporary?60:100:!this.fh&&this.temporary?90:150;break;case D.X2.condition:switch(l.value){case G.r5.poison:h+=this.fh?50:this.temporary?30:75;break;case G.r5.wound:h+=!this.fh&&this.temporary?45:75;break;case G.r5.muddle:h+=this.fh?40:this.temporary?25:50;break;case G.r5.immobilize:h+=this.fh?150:100;break;case G.r5.disarm:h+=this.fh?0:150;break;case G.r5.curse:h+=this.fh?150:this.temporary?100:75;break;case G.r5.strengthen:h+=this.fh||this.temporary?100:50;break;case G.r5.bless:h+=this.fh?75:50;break;case G.r5.regenerate:h+=this.fh?40:50;break;case G.r5.ward:h+=this.fh?75:0}break;case D.X2.area:{const _=(""+l.value).split("|").map(f=>(0,Zt.dy)(f)).filter(f=>f).map(f=>f);h+=Math.ceil(200/(_.filter(f=>f.type==Zt.Gq.target).length||1));break}}return h}levelCosts(l){return l<1?l=1:l>9&&(l=9),(l-1)*(!this.fh&&this.temporary?10:this.enhancerLevel>2?15:25)}enhancementCosts(l){return l<0&&(l=0),l*(!this.fh&&this.temporary?20:this.enhancerLevel>3?50:75)}}class Dn{game;constructor(l){this.game=l}entities(l,d=!1){let h=[];return l instanceof c.K?this.isAlive(l,d)&&h.push(l):(l instanceof R.R||l instanceof B.$e)&&(h=l.entities.filter(_=>this.isAlive(_,d)||!d&&_.dormant)),h}entitiesAll(l,d=!0,h=!1){let _=[];return l instanceof c.K&&(!d||this.isAlive(l,h))?(_.push(l),_.push(...l.summons.filter(f=>!d||this.isAlive(f,h)))):(l instanceof R.R||l instanceof B.$e)&&_.push(...l.entities.filter(f=>!d||this.isAlive(f,h))),_}getIndexedEntities(l=!1){let d=[];return Object.assign([],this.game.figures).sort((_,f)=>l?C.sortFiguresByTypeAndName(_,f):0).forEach(_=>{_ instanceof c.K?(d.push({entity:_,figure:_}),_.summons.forEach(f=>{d.push({entity:f,figure:_})})):(_ instanceof R.R||_ instanceof B.$e)&&_.entities.forEach(f=>{d.push({entity:f,figure:_})})}),d}getIndexForEntity(l,d=!1){let h=-1;return this.getIndexedEntities(d).forEach((_,f)=>{_.entity!=l||(h=f)}),h}isAlive(l,d=!1){return!(l.health<=0&&(0,t.hZ)(l.maxHealth)>0&&!l.entityConditions.find(h=>h.highlight&&h.types.includes(G.GV.apply))||d&&l.entityConditions.find(h=>h.name==G.r5.stun&&h.state!=G.mg.new&&h.lastState!=G.mg.new&&h.state!=G.mg.removed)||(l instanceof c.K?l.exhausted||l.absent:l instanceof T.I?l.dead||l.dormant||d&&l.summon==I.N5.new:l instanceof I.up?l.dead||l.dormant||d&&l.state==I.N5.new:!(l instanceof q.X)||l.dead||l.dormant))}checkHealth(l,d){let h=(0,t.hZ)(l.maxHealth);l instanceof c.K&&!l.absent&&"lightning"==l.name&&l.tags.find(_=>"unbridled-power"===_)&&(h=Math.max(h,26)),h>0&&l.health>h&&(l.health=h),h>0&&l.health<=0&&!l.entityConditions.find(_=>w.f.settings.applyConditions&&w.f.settings.activeApplyConditions&&_.highlight&&_.types.includes(G.GV.apply)&&!w.f.settings.activeApplyConditionsExcludes.includes(_.name)&&!w.f.settings.activeApplyConditionsAuto.includes(_.name))&&(!(l instanceof c.K)||l.off&&l.exhausted?(l instanceof T.I||l instanceof I.up||l instanceof q.X)&&!l.dead&&(l.dead=!0,setTimeout(()=>{C.uiChange.next(!1)},w.f.settings.animations?1500*w.f.settings.animationSpeed:0)):(l.off=!0,l.exhausted=!0)),l.health>0&&(l instanceof c.K&&l.exhausted?(l.off=!1,l.exhausted=!1):(l instanceof T.I||l instanceof I.up||l instanceof q.X)&&l.dead&&(l.dead=!1))}changeHealth(l,d,h,_=!1){this.changeHealthHighlightConditions(l,d,h,_),l.health+=h,this.checkHealth(l,d),w.f.settings.scenarioStats&&0!=h&&(h>0?C.scenarioStatsManager.applyHeal(l,d,h):C.scenarioStatsManager.applyDamage(l,d,-1*h)),h<1&&l instanceof c.K&&!l.absent&&C.trialsManager.apply&&C.trialsManager.trialsEnabled&&l.progress.trial&&"fh"==l.progress.trial.edition&&"356"==l.progress.trial.name&&!l.tags.includes("trial-fh-356")&&l.tags.push("trial-fh-356")}changeHealthHighlightConditions(l,d,h,_=!1){if(w.f.settings.applyConditions){const f=l.entityConditions.find(P=>!(P.expired||P.state==G.mg.new||P.permanent||P.name!=G.r5.regenerate||this.isImmune(l,d,P.name)||w.f.settings.applyConditionsExcludes.includes(P.name)));if(f&&h<0&&(f.expired=!0),this.sufferDamageHighlightConditions(l,d,h,_),f&&l.entityConditions.find(P=>!P.expired&&P.state!=G.mg.new&&P.name==G.r5.ward&&P.highlight&&!this.isImmune(l,d,P.name))&&(f.expired=!1),l.health+h>l.health){const P=l.entityConditions.find(Y=>Y.types.includes(G.GV.clearHeal)&&!Y.expired&&!this.isImmune(l,d,Y.name));let j=l.entityConditions.find(Y=>Y.name==G.r5.heal);P&&(!j||j.expired||!j.highlight)&&(j||(j=new G.BR(G.r5.heal,h),l.entityConditions.push(j)),j.expired=!1,j.highlight=!0,j.value=h,w.f.settings.applyConditions&&w.f.settings.activeApplyConditions&&w.f.settings.activeApplyConditionsAuto.includes(G.r5.heal)&&this.applyCondition(l,d,G.r5.heal,!0))}}}sufferDamageHighlightConditions(l,d,h,_=!1){if(w.f.settings.applyConditions){if(h<0&&!_){let Y=0;[G.r5.retaliate,G.r5.shield].forEach(U=>{let z=l.entityConditions.find(W=>W.name==U);if(!z||z.expired||!z.highlight)if(z||(z=new G.BR(U,0),l.entityConditions.push(z)),z.value=0,C.actionsManager.calcActionHints(d,l).forEach(nt=>{z&&(U==G.r5.shield&&nt.type==D.X2.shield||U==G.r5.retaliate&&nt.type==D.X2.retaliate)&&(z.value+=nt.value)}),U==G.r5.shield&&z.value&&l.health+h+z.value>0){if(z.expired=!1,z.highlight=!0,Y=z.value,w.f.settings.applyConditions&&w.f.settings.activeApplyConditions&&w.f.settings.activeApplyConditionsAuto.includes(U))return this.applyCondition(l,d,U,!0,!0),void this.sufferDamageHighlightConditions(l,d,h+z.value,!0)}else if(U==G.r5.retaliate&&z.value)return z.expired=!1,z.highlight=!0,this.applyCondition(l,d,U,!0,!0),void this.sufferDamageHighlightConditions(l,d,h+z.value,!0)}),l.entityConditions.filter(U=>U.name==G.r5.poison||U.name==G.r5.poison_x).forEach(U=>{U.highlight=h<0&&!U.expired&&U.state!=G.mg.new&&l.health+h>-Y&&!this.isImmune(l,d,U.name)})}const f=l.entityConditions.find(Y=>!Y.expired&&Y.state!=G.mg.new&&Y.name==G.r5.ward&&!this.isImmune(l,d,Y.name)),P=l.entityConditions.find(Y=>!Y.expired&&Y.state!=G.mg.new&&Y.name==G.r5.brittle&&!this.isImmune(l,d,Y.name));let j=(!l.entityConditions.find(Y=>!Y.expired&&Y.state!=G.mg.new&&Y.name==G.r5.poison&&!this.isImmune(l,d,Y.name))||w.f.settings.applyConditionsExcludes.includes(G.r5.poison))&&(!l.entityConditions.find(Y=>!Y.expired&&Y.state!=G.mg.new&&Y.name==G.r5.poison_x&&!this.isImmune(l,d,Y.name))||w.f.settings.applyConditionsExcludes.includes(G.r5.poison_x));h<0&&f&&!P&&l.health+h-Math.floor(h/2)>0?(f.value=-1*h,f.highlight=!0,w.f.settings.applyConditions&&w.f.settings.activeApplyConditions&&w.f.settings.activeApplyConditionsAuto.includes(G.r5.ward)&&j&&this.applyCondition(l,d,G.r5.ward,!0,!0)):f&&(f.highlight=!1),P&&!f&&h<0&&l.health+h>0?(P.value=-1*h,P.highlight=!0,w.f.settings.applyConditions&&w.f.settings.activeApplyConditions&&w.f.settings.activeApplyConditionsAuto.includes(G.r5.brittle)&&j&&this.applyCondition(l,d,G.r5.brittle,!0,!0)):P&&(P.highlight=!1),P&&f&&(P.highlight=!1,f.highlight=!1,h<0&&(P.expired=!0,f.expired=!0)),(P&&P.highlight||f&&f.highlight)&&C.uiChange.next(!1)}if(h<0&&!_&&w.f.settings.calculateAdvantageStats&&w.f.settings.animations&&this.game.figures.find(f=>f instanceof c.K&&f.active)&&d instanceof R.R&&l instanceof T.I){const f=this.game.figures.find(Y=>Y instanceof c.K&&Y.active),P=f.entityConditions.find(Y=>Y.name==G.r5.muddle&&!Y.expired),j=f.entityConditions.find(Y=>Y.name==G.r5.strengthen&&!Y.expired);if(P||C.monsterManager.getStat(d,l.type).actions&&C.monsterManager.getStat(d,l.type).actions.find(Y=>"%game.custom.disadvantage%"==Y.value)){if(!j){const Y=P||new G.BR(G.r5.muddle);Y.highlight=!0,P||(Y.types.push(G.GV.hidden),f.entityConditions.push(Y)),setTimeout(()=>{Y.highlight=!1,P||f.entityConditions.splice(f.entityConditions.indexOf(Y),1),C.uiChange.next(!1)},1e3*w.f.settings.animationSpeed)}}else j&&!P&&(j.highlight=!0,setTimeout(()=>{j.highlight=!1,C.uiChange.next(!1)},1e3*w.f.settings.animationSpeed))}}hasCondition(l,d,h=!1){return l.entityConditions.some(_=>_.name==d.name&&_.state!=G.mg.removed&&!_.expired&&(!h||_.permanent))}activeConditions(l,d=!1,h=!1){return l.entityConditions.filter(_=>(!_.expired||d&&_.types.includes(G.GV.expiredIndicator))&&(h||!_.types.includes(G.GV.hidden)))}isImmune(l,d,h,_=!1){let f=!1;if(l.immunities&&l.immunities.includes(h)&&!_)return!0;if(d instanceof R.R&&l instanceof T.I){const P=C.monsterManager.getStat(d,l.type);f=null!=P&&null!=P.immunities&&P.immunities.includes(h)}else if(l instanceof c.K){let P=[];l.progress.equippedItems.find(j=>"gh"==j.edition&&"38"==j.name)&&P.push(G.r5.stun,G.r5.muddle),l.progress.equippedItems.find(j=>"gh"==j.edition&&"52"==j.name)&&P.push(G.r5.poison,G.r5.wound),l.progress.equippedItems.find(j=>"gh"==j.edition&&"103"==j.name)&&P.push(G.r5.poison,G.r5.wound),l.progress.equippedItems.find(j=>"cs"==j.edition&&"57"==j.name)&&P.push(G.r5.muddle),l.progress.equippedItems.find(j=>"fh"==j.edition&&"138"==j.name)&&P.push(G.r5.disarm,G.r5.stun,G.r5.muddle),l.perks&&l.perks.forEach(j=>{let Y=l.perks.indexOf(j);j.immunity&&(j.combined&&l.progress.perks[Y]>=j.count||!j.combined&&l.progress.perks[Y]>=1)&&P.push(j.immunity)}),f=P.includes(h)}else if(l instanceof I.up&&d instanceof c.K&&!d.absent&&"prism"==d.name&&l.tags.includes("prism_mode"))return!0;if(!f){if(h==G.r5.wound_x)return this.isImmune(l,d,G.r5.wound,_);if(h==G.r5.poison_x)return this.isImmune(l,d,G.r5.poison,_);if(h==G.r5.rupture)return this.isImmune(l,d,G.r5.wound,_);if(h==G.r5.infect)return this.isImmune(l,d,G.r5.poison,_);if(h==G.r5.chill)return this.isImmune(l,d,G.r5.immobilize,_)||this.isImmune(l,d,G.r5.muddle,_)}return f}addCondition(l,d,h,_=!1){let f=l.entityConditions.find(P=>P.name==h.name);f?(f.expired=!1,f.lastState=f.state,f.state=G.mg.normal):(f=new G.BR(h.name,h.value),l.entityConditions.push(f)),!d.active&&f.types.includes(G.GV.expire)?(!d.off&&!d.active&&(f.lastState=f.state),f.state=G.mg.expire):d.active&&f.types.includes(G.GV.turn)?(f.lastState=f.state,f.state=G.mg.turn):d.active&&f.types.includes(G.GV.afterTurn)?f.state=G.mg.new:!d.active&&f.types.includes(G.GV.afterTurn)&&(f.lastState=G.mg.normal),d.off&&f.types.includes(G.GV.turn)&&(f.lastState=f.state,f.state=G.mg.expire),f.permanent=_,f.highlight=!1,C.challengesManager.apply&&C.challengesManager.isActive(1487,"fh")&&f.types.includes(G.GV.negative)&&f.name!=G.r5.wound&&l instanceof c.K&&!this.isImmune(l,l,G.r5.wound)&&this.addCondition(l,d,new G.kW(G.r5.wound)),w.f.settings.applyConditions&&!w.f.settings.applyConditionsExcludes.includes(G.r5.safeguard)&&this.hasCondition(l,new G.kW(G.r5.safeguard))&&f.types.includes(G.GV.negative)&&(this.removeCondition(l,d,f),this.removeCondition(l,d,new G.kW(G.r5.safeguard)))}removeCondition(l,d,h,_=!1){l.entityConditions=l.entityConditions.filter(f=>f.name!=h.name||f.permanent!=_),C.challengesManager.apply&&C.challengesManager.isActive(1525,"fh")&&h.types.includes(G.GV.negative)&&l instanceof T.I&&this.addCondition(l,d,new G.kW(G.r5.strengthen))}applyCondition(l,d,h,_=!1,f=!1){const P=l.entityConditions.find(j=>j.name==h&&!j.expired&&(j.types.includes(G.GV.apply)||j.types.includes(G.GV.highlightOnly)));if(P&&!this.isImmune(l,d,P.name)){if(P.name==G.r5.poison||P.name==G.r5.poison_x){l.health-=P.value;const j=l.entityConditions.find(U=>!U.expired&&U.state!=G.mg.new&&U.name==G.r5.ward&&!this.isImmune(l,d,U.name)),Y=l.entityConditions.find(U=>!U.expired&&U.state!=G.mg.new&&U.name==G.r5.brittle&&!this.isImmune(l,d,U.name));j&&!Y&&(j.value+=P.value),Y&&!j&&(Y.value+=P.value),this.checkHealth(l,d)}if(P.name==G.r5.ward){const j=Math.floor(P.value/2);if(f)l.health+=P.value-j;else if(l.health+=P.value,!f){this.checkHealth(l,d),l.health-=j;const Y=l.entityConditions.find(U=>!(U.expired||U.state==G.mg.new||U.permanent||U.name!=G.r5.regenerate||this.isImmune(l,d,U.name)||w.f.settings.applyConditionsExcludes.includes(U.name)));Y&&j>0&&(Y.expired=!0),this.checkHealth(l,d)}P.value=1,P.expired=!0}if(P.name==G.r5.brittle&&(f?l.health-=P.value:(l.health+=P.value,this.checkHealth(l,d),l.health-=2*P.value,this.checkHealth(l,d)),P.value=1,P.expired=!0),P.name==G.r5.shield){l.health+=P.value,f||this.checkHealth(l,d),P.expired=!0;const j=l.entityConditions.find(U=>!U.expired&&U.state!=G.mg.new&&U.name==G.r5.ward&&!this.isImmune(l,d,U.name));j&&j.highlight&&(j.value-=P.value);const Y=l.entityConditions.find(U=>!U.expired&&U.state!=G.mg.new&&U.name==G.r5.brittle&&!this.isImmune(l,d,U.name));Y&&Y.highlight&&(Y.value-=P.value)}if(P.name==G.r5.retaliate&&(P.expired=!0),P.name==G.r5.heal){const j=l.entityConditions.find(U=>U.types.includes(G.GV.preventHeal)&&U.state!=G.mg.expire&&!U.expired&&!this.isImmune(l,d,U.name));j&&(l.health-=P.value);let Y=l.entityConditions.find(U=>U.types.includes(G.GV.clearHeal)&&!U.permanent&&!U.expired);for(;Y;)Y.lastState=Y.state,Y.state=G.mg.expire,Y.expired=!0,Y=l.entityConditions.find(U=>U.types.includes(G.GV.clearHeal)&&!U.permanent&&!U.expired);!j&&l.health-P.value>=(0,t.hZ)(l.maxHealth)&&(P.highlight=!1),this.checkHealth(l,d),P.expired=!0}_&&w.f.settings.animations?(P.highlight=!0,setTimeout(()=>{P.highlight=!1,C.uiChange.next(!1)},1e3*w.f.settings.animationSpeed)):P.highlight=!1,P.permanent&&(P.expired=!1)}}declineApplyCondition(l,d,h){const _=l.entityConditions.find(f=>f.name==h&&!f.expired&&f.types.includes(G.GV.apply));_&&(_.highlight=!1,_.permanent||(_.name==G.r5.heal&&(_.expired=!0),_.name==G.r5.shield&&(_.expired=!0)))}restoreConditions(l){l.entityConditions.forEach(d=>{d.name==G.r5.chill&&(d.expired?d.expired=!1:d.value++),d.types.includes(G.GV.expire)&&d.expired&&(d.expired=!1)})}expireConditions(l,d){l.entityConditions.forEach(_=>{_.name==G.r5.chill&&(1!=_.value||_.permanent?_.value--:_.expired=!0)});let h=!1;l.entityConditions.forEach(_=>{_.types.includes(G.GV.expire)&&_.state==G.mg.expire&&!_.permanent&&(_.expired=!0,_.types.includes(G.GV.negative)&&(h=!0))}),C.challengesManager.apply&&h&&d instanceof R.R&&!d.isAlly&&l instanceof T.I&&(C.challengesManager.isActive(1524,"fh")&&this.changeHealth(l,d,-1,!0),C.challengesManager.isActive(1525,"fh")&&this.addCondition(l,d,new G.kW(G.r5.strengthen)))}applyConditionsTurn(l,d){const h=l.entityConditions.find(_=>!_.expired&&_.state==G.mg.normal&&_.name==G.r5.regenerate&&!this.isImmune(l,d,_.name)&&!w.f.settings.applyConditionsExcludes.includes(_.name));if(h){const _=(0,t.hZ)(l.maxHealth),f=l.entityConditions.every(P=>P.expired||!P.types.includes(G.GV.preventHeal)||this.isImmune(l,d,P.name))&&l.health<_;if(l.entityConditions.filter(P=>!P.expired&&P.types.includes(G.GV.clearHeal)&&!P.permanent).forEach(P=>{P.expired=!0,P.lastState=P.state,P.state=G.mg.removed}),f){let P=l.entityConditions.find(j=>j.types.includes(G.GV.clearHeal)&&j.state!=G.mg.expire&&j.state!=G.mg.new&&!j.permanent&&!j.expired);for(;P;)P.lastState=P.state,P.state=G.mg.expire,P.expired=!0,P=l.entityConditions.find(j=>j.types.includes(G.GV.clearHeal)&&j.state!=G.mg.expire&&j.state!=G.mg.new&&!j.permanent&&!j.expired);h.lastState=h.state,h.state=G.mg.expire,l.health+=h.value,this.checkHealth(l,d)}h.highlight=!0,setTimeout(()=>{h.highlight=!1},1e3*w.f.settings.animationSpeed)}l instanceof c.K&&l.progress.equippedItems.find(_=>"fh"==_.edition&&"178"==_.name)&&l.initiative>=60&&!l.longRest&&(l.health=l.health+1,l.entityConditions.push(new G.BR(G.r5.heal,1)),this.applyCondition(l,d,G.r5.heal,!0)),l.entityConditions.filter(_=>!_.expired&&_.state==G.mg.normal&&_.types.includes(G.GV.turn)).forEach(_=>{!this.isImmune(l,d,_.name)&&!w.f.settings.applyConditionsExcludes.includes(_.name)&&(_.lastState=_.state,_.state=G.mg.turn,(_.name==G.r5.wound||_.name==G.r5.wound_x)&&(l.health=l.health-_.value,l instanceof c.K&&l.progress.equippedItems.find(f=>"cs"==f.edition&&"71"==f.name)&&(l.health=l.health+_.value+1,l.entityConditions.push(new G.BR(G.r5.heal,1)),this.applyCondition(l,d,G.r5.heal,!0)),this.checkHealth(l,d),_.highlight=!0,setTimeout(()=>{_.highlight=!1,(!(l instanceof c.K)||!l.progress.equippedItems.find(f=>"cs"==f.edition&&"71"==f.name))&&(this.sufferDamageHighlightConditions(l,d,-_.value,!0),this.checkHealth(l,d))},1e3*w.f.settings.animationSpeed)))}),l.entityConditions.filter(_=>!_.expired&&_.types.includes(G.GV.afterTurn)&&!_.permanent).forEach(_=>{_.state==G.mg.normal?(_.lastState=_.state,_.state=G.mg.turn):_.state==G.mg.new&&_.lastState!=G.mg.new&&(_.lastState=_.state,_.state=G.mg.normal)}),l.entityConditions.filter(_=>!_.expired&&_.types.includes(G.GV.expire)&&!_.permanent).forEach(_=>{_.state==G.mg.expire&&_.lastState==G.mg.new&&(_.lastState=G.mg.normal)})}unapplyConditionsTurn(l,d){l.entityConditions.filter(_=>_.state==G.mg.turn&&_.types.includes(G.GV.turn)&&!w.f.settings.applyConditionsExcludes.includes(_.name)).forEach(_=>{_.expired?_.expired=!1:(_.lastState=_.state,_.state=G.mg.normal,(_.name==G.r5.wound||_.name==G.r5.wound_x)&&(l.health=l.health+_.value,this.checkHealth(l,d)))});const h=l.entityConditions.find(_=>_.name==G.r5.regenerate&&!w.f.settings.applyConditionsExcludes.includes(_.name));if(h){const _=l.entityConditions.every(f=>!f.types.includes(G.GV.preventHeal))&&h.state==G.mg.expire;l.entityConditions.filter(f=>f.expired&&f.types.includes(G.GV.clearHeal)).forEach(f=>f.expired=!1),_&&(h.lastState=h.state,h.state=G.mg.normal,l.health-=h.value,this.checkHealth(l,d))}l instanceof c.K&&l.progress.equippedItems.find(_=>"fh"==_.edition&&"178"==_.name)&&l.initiative>=60&&!l.longRest&&l.entityConditions.find(_=>_.name==G.r5.heal&&1==_.value&&_.expired)&&(l.entityConditions=l.entityConditions.filter(_=>_.name!=G.r5.heal||1!=_.value||!_.expired),l.health=l.health-1)}applyConditionsAfter(l,d){l.entityConditions.filter(h=>!h.expired&&h.types.includes(G.GV.afterTurn)).forEach(h=>{!this.isImmune(l,d,h.name)&&!w.f.settings.applyConditionsExcludes.includes(h.name)&&(h.state==G.mg.turn?h.name==G.r5.bane&&(this.changeHealth(l,d,-10,!0),h.expired=!0,h.highlight=!0,setTimeout(()=>{h.highlight=!1},1e3*w.f.settings.animationSpeed)):h.state==G.mg.normal?(h.lastState=h.state,h.state=G.mg.turn):h.state==G.mg.new&&h.lastState!=G.mg.new?(h.lastState=h.state,h.state=G.mg.normal):h.state==G.mg.new&&h.lastState==G.mg.new&&(h.lastState=G.mg.new,h.state=G.mg.normal))})}unapplyConditionsAfter(l,d){l.entityConditions.filter(h=>h.state!=G.mg.removed&&h.types.includes(G.GV.afterTurn)&&!w.f.settings.applyConditionsExcludes.includes(h.name)).forEach(h=>{h.expired?(h.name==G.r5.bane&&(l.health=l.health+10,this.checkHealth(l,d)),h.highlight=!1,h.expired=!1):h.state==G.mg.normal&&h.lastState==G.mg.new?h.state=G.mg.new:h.state==G.mg.new&&h.lastState!=G.mg.new&&(h.lastState=h.state)})}highlightedConditions(l){return l.entityConditions.filter(d=>d.highlight).sort((d,h)=>h.types.indexOf(G.GV.double)-d.types.indexOf(G.GV.double))}hasMarker(l,d){return l.markers&&l.markers.includes(d)}toggleMarker(l,d){this.hasMarker(l,d)?l.markers.splice(l.markers.indexOf(d),1):l.markers.push(d)}toggleActive(l,d){this.game.state==E.mk.next&&(l.active?(d.active=!d.active,this.entities(l).every(h=>!this.isAlive(h)||!h.active)&&C.roundManager.toggleFigure(l)):d.active?(d.active=!1,this.entities(l).every(h=>!this.isAlive(h,!0)||!h.active)&&(l.off=!0)):(l.off=!1,d.active=!0),d.active?(d.off=!1,!l.active&&this.game.figures.every(h=>!h.active)&&(l.active=!0)):d.off=!0)}undoInfos(l,d,h){let _=[];return l instanceof c.K&&d instanceof c.K?_.push(h+".char",C.characterManager.characterName(l)):l instanceof I.up&&d instanceof c.K?_.push(h+".summon",C.characterManager.characterName(d),"data.summon."+l.name):d instanceof B.$e&&l instanceof q.X?_.push(h+".objectiveContainer",d.title||d.name||d.escort?"escort":"objective",""+l.number):d instanceof R.R&&l instanceof T.I?_.push(h+".monster","data.monster."+d.name,""+l.number):d instanceof R.R&&_.push(h+".monsterEntities","data.monster."+d.name),_}next(){this.game.figures.forEach(l=>{this.entitiesAll(l).forEach(d=>{w.f.settings.expireConditions&&(d.entityConditions=d.entityConditions.filter(h=>!h.expired),d.entityConditions.forEach(h=>{h.types.includes(G.GV.expire)&&!h.permanent&&h.state==G.mg.normal&&(h.lastState=h.state,h.state=G.mg.expire)})),w.f.settings.applyConditions&&d.entityConditions.filter(h=>h.types.includes(G.GV.turn)||h.types.includes(G.GV.afterTurn)&&!this.isImmune(d,l,h.name)).forEach(h=>{h.lastState=h.state,h.state=G.mg.normal}),d.shield=void 0,d.retaliate=[]})})}}var Rt=v(9733),Z=v(7114),vt=v(7165);const rn=[Z.Yj.additionally,Z.Yj.and,Z.Yj.battleGoal,Z.Yj.campaignSticker,Z.Yj.campaignStickerMap,Z.Yj.campaignStickerReplace,Z.Yj.checkbox,Z.Yj.drawAnotherEvent,Z.Yj.drawEvent,Z.Yj.event,Z.Yj.eventReturn,Z.Yj.eventsToTop,Z.Yj.experience,Z.Yj.globalAchievement,Z.Yj.gold,Z.Yj.goldAdditional,Z.Yj.inspiration,Z.Yj.loseBattleGoal,Z.Yj.loseGold,Z.Yj.loseMorale,Z.Yj.loseProsperity,Z.Yj.loseReputation,Z.Yj.loseReputationFaction,Z.Yj.morale,Z.Yj.partyAchievement,Z.Yj.prosperity,Z.Yj.removeEvent,Z.Yj.reputation,Z.Yj.reputationFaction,Z.Yj.reputationAdditional,Z.Yj.resource,Z.Yj.scenarioCondition,Z.Yj.scenarioDamage,Z.Yj.scenarioSingleMinus1,Z.Yj.sectionWeek,Z.Yj.sectionWeeks,Z.Yj.sectionWeekSeasonFinal,Z.Yj.sectionWeeksSeason,Z.Yj.soldier,Z.Yj.soldiers,Z.Yj.townGuardDeckCard,Z.Yj.townGuardDeckCardRemove,Z.Yj.townGuardDeckCardRemovePermanently,Z.Yj.townGuardDeckCards,Z.Yj.traitExperience,Z.Yj.traitScenarioCondition,Z.Yj.traitScenarioDamage,Z.Yj.unlockEnvelope,Z.Yj.unlockScenario,Z.Yj.unlockScenarioGroup,Z.Yj.upgradeBuilding,Z.Yj.wreckBuilding];class Wn{game;constructor(l){this.game=l}getEventTypesForEdition(l,d=!0){return C.editionData.filter(h=>h.edition==l||d&&C.editionExtensions(l).includes(h.edition)).flatMap(h=>h.events).flatMap(h=>h.type).filter((h,_,f)=>_==f.indexOf(h))}getEventCardsForEdition(l,d,h=!0){return C.editionData.filter(_=>_.edition==l||h&&C.editionExtensions(l).includes(_.edition)).flatMap(_=>_.events).filter(_=>_.type==d)}getEventCardForEdition(l,d,h){return C.editionData.filter(_=>_.edition==l||C.editionExtensions(l).includes(_.edition)).flatMap(_=>_.events).find(_=>_.type==d&&_.cardId==h)}buildPartyDeck(l,d){const h=C.campaignData(l);h&&h.events&&h.events[d]&&this.buildEventDeck(d,h.events[d])}buildPartyDeckMigration(l){if(!this.game.party.eventDecks||!Object.keys(this.game.party.eventDecks).length){const d=C.campaignData(l);if(d.events&&(Object.keys(d.events).forEach(h=>{d.events[h]&&d.events[h].length&&(this.buildPartyDeck(l||C.currentEdition(),h),console.debug("Build "+h+" Event Deck"))}),this.game.party.eventDecks&&Object.keys(this.game.party.eventDecks).length)){this.game.party.scenarios.filter(_=>_.edition==l||C.editionExtensions(l).includes(_.edition)).map(_=>C.scenarioManager.getScenario(_.index,_.edition,_.group)).forEach(_=>this.buildPartyDeckMigrationScenarioHelper(_)),this.game.party.conclusions.filter(_=>_.edition==l||C.editionExtensions(l).includes(_.edition)).map(_=>C.scenarioManager.getSection(_.index,_.edition,_.group,!0)).forEach(_=>this.buildPartyDeckMigrationScenarioHelper(_)),this.game.unlockedCharacters.map(_=>C.getCharacterData(_.split(":")[1],_.split(":")[0])).forEach(_=>{_.unlockEvent&&_.unlockEvent.split("|").forEach(f=>{f.split(":").length>1?this.addEvent(f.split(":")[0],f.split(":")[1],!0):(this.addEvent("city",f,!0),this.addEvent("road",f,!0))})}),this.game.party.retirements.map(_=>C.getCharacterData(_.name,_.edition)).forEach(_=>{_.retireEvent&&_.retireEvent.split("|").forEach(f=>{f.split(":").length>1?this.addEvent(f.split(":")[0],f.split(":")[1],!0):(this.addEvent("city",f,!0),this.addEvent("road",f,!0))})});let h=C.editionData.filter(_=>_.treasures&&_.edition==l||C.editionExtensions(l).includes(_.edition)).flatMap(_=>_.treasures.map((f,P)=>new vt.Ah(f,P+1+_.treasureOffset||0)));this.game.party.treasures.forEach(_=>{if(_.edition==l||C.editionExtensions(l).includes(_.edition)){const f=h.find(P=>P.index==+_.name);f&&f.rewards&&f.rewards.forEach(P=>{P.type==vt.lb.event&&"string"==typeof P.value&&P.value.split("-").length>1&&this.addEvent(P.value.split("-")[0],P.value.split("-")[1],!0)})}}),console.debug("Migrated event decks")}}}buildPartyDeckMigrationScenarioHelper(l){l&&l.rewards&&(l.rewards.events&&l.rewards.events.forEach(d=>{d.split(":").length>1&&this.addEvent(d.split(":")[0],d.split(":")[1],!0)}),l.rewards.eventDecks&&l.rewards.eventDecks.forEach(d=>{const h=d.split(":")[0],_=C.eventCardManager.getEventCardsForEdition(l.edition,h),f=_.find(j=>l.rewards&&j.cardId==d.split(":")[1].split("|")[0]),P=_.find(j=>l.rewards&&j.cardId==d.split(":")[1].split("|")[1]);f&&P?C.eventCardManager.buildEventDeck(h,_.slice(_.indexOf(f),_.indexOf(P)+1).map(j=>j.cardId)):console.warn("Could not find start and end for: "+d)}))}buildEventDeck(l,d){d.forEach(h=>this.addEvent(l,h))}shuffleEvents(l){(0,V.Z)(this.game.party.eventDecks[l]||[])}addEvent(l,d,h=!1){const _=this.game.edition||C.currentEdition();null!=this.getEventCardForEdition(_,l,d)?(this.game.party.eventDecks[l]||(this.game.party.eventDecks[l]=[]),!this.game.party.eventDecks[l].includes(d)&&(!h||!this.game.party.eventCards.find(f=>f.type==l&&f.cardId==d&&f.edition==_))&&(this.game.party.eventDecks[l].push(d),this.shuffleEvents(l))):console.warn("Could not find "+l+" Event "+d+"for Edition "+_)}returnEvent(l,d){this.game.party.eventDecks[l]||(this.game.party.eventDecks[l]=[]),this.removeEvent(l,d),this.game.party.eventDecks[l].push(d)}removeEvent(l,d){this.game.party.eventDecks[l]||(this.game.party.eventDecks[l]=[]);const h=this.game.party.eventDecks[l].indexOf(d);-1!=h&&this.game.party.eventDecks[l].splice(h,1)}applyEvent(l,d,h,_,f,P,j){let Y=[];const U=l.options[d];let z=!1,W=["fh","jotl"].includes(l.edition);return U&&(U.removeFromDeck?W=!0:U.returnToDeck?z=!0:U.outcomes&&h&&h.forEach(nt=>{const gt=U.outcomes[nt];gt&&(gt.removeFromDeck?W=!0:gt.returnToDeck&&(z=!0))}),w.f.settings.eventsApply&&j&&(Y.push(...this.applyEventOutcomes(l,d,h,_,!1)),f&&Y.push(...this.applyEventOutcomes(l,d,h,_,!0)),P&&l.options.filter(nt=>!nt.label&&nt.outcomes).forEach(nt=>{nt.outcomes.forEach(gt=>{gt.attack&&(Y.push(gt.attack),gt.attack.effects&&Y.push(...this.applyEffects(l,gt.attack.effects,_,f)))})}))),!z&&["fh"].includes(l.edition)&&(z=l.options.some(nt=>!nt.label&&nt.returnToDeck)),z||W?z?this.returnEvent(l.type,l.cardId):this.removeEvent(l.type,l.cardId):console.warn(j&&!U?"Apply event without valid selection":"No remove or return for event",l,d,h),this.game.party.eventCards.push(new Z.Qc(l.cardId,l.edition,l.type,d,h,_,P,!f)),Y}applyEventOutcomes(l,d,h=[],_,f=!1){let P=[];const j=l.options[d];return j&&j.outcomes&&j.outcomes.forEach((Y,U)=>{if(!Y.condition||h&&h.includes(U)){if(Y.condition){const z=this.applyCondition(Y.condition);z&&P.push(z)}Y.effects&&P.push(...this.applyEffects(l,Y.effects,_,f))}}),P}applicableEffect(l){return rn.includes(l.type)}applyEffects(l,d,h,_){let f=[];return d.forEach((P,j)=>{if("string"==typeof P)f.push(new Z.Az(Z.Yj.custom,[P]));else if(!this.applicableEffect(P)||P.condition&&!this.resolvableCondition(P.condition))P.type!=Z.Yj.noEffect&&(_||f.push(P),P.type!=Z.Yj.outpostAttack&&P.type!=Z.Yj.outpostTarget&&console.warn("Missing implementation for applying effect",P,_));else{let Y=C.characterManager.getActiveCharacters();if(P.condition){const U=this.applyCondition(P.condition);U&&f.push(U),"string"!=typeof P.condition&&P.condition.type==Z.iH.character&&(Y=Y.filter(z=>P.condition.values.includes(z.name)))}if(P.type==Z.Yj.and||P.type==Z.Yj.additionally)f.push(...this.applyEffects(l,P.values.filter(U=>"number"!=typeof U&&"string"!=typeof U),h,_));else if(_)switch(P.type){case Z.Yj.scenarioCondition:case Z.Yj.traitScenarioCondition:if(P.values){let z=P.values;P.type==Z.Yj.traitScenarioCondition&&(z=z.slice(1)),z.filter(W=>"string"==typeof W).forEach(W=>{const nt=W.split(":")[0];if(nt!=G.r5.bless&&nt!=G.r5.curse)Y.filter(gt=>P.type==Z.Yj.scenarioCondition||gt.traits.some(ht=>ht==P.values[0])).forEach(gt=>{C.entityManager.addCondition(gt,gt,new G.kW(nt))});else if(nt==G.r5.curse){const gt=W.split(":")[1]?+W.split(":")[1]:1;for(let ht=0;ht<gt;ht++)Y.filter(kt=>P.type==Z.Yj.scenarioCondition||kt.traits.some(It=>It==P.values[0])).forEach(kt=>{C.attackModifierManager.countUpcomingCurses(!1)<10&&C.attackModifierManager.addModifierByType(kt.attackModifierDeck,N.Yn.curse)})}else if(nt==G.r5.bless){const gt=W.split(":")[1]?+W.split(":")[1]:1;for(let ht=0;ht<gt;ht++)Y.filter(kt=>P.type==Z.Yj.scenarioCondition||kt.traits.some(It=>It==P.values[0])).forEach(kt=>{C.attackModifierManager.countUpcomingBlesses()<10&&C.attackModifierManager.addModifierByType(kt.attackModifierDeck,N.Yn.bless)})}})}break;case Z.Yj.scenarioDamage:{const z=+P.values[0];z&&Y.forEach(W=>{C.entityManager.changeHealth(W,W,-z,!0)});break}case Z.Yj.traitScenarioDamage:{const z=+P.values[1];z&&Y.filter(W=>W.traits.some(nt=>nt==P.values[0])).forEach(W=>{C.entityManager.changeHealth(W,W,-z,!0)});break}case Z.Yj.scenarioSingleMinus1:const U=+P.values[0];if(U)for(let z=0;z<U;z++)Y.forEach(W=>{C.attackModifierManager.countExtraMinus1()<15&&C.attackModifierManager.addModifierByType(W.attackModifierDeck,N.Yn.minus1extra)})}else switch(P.type){case Z.Yj.battleGoal:Y.forEach(U=>{U.progress.battleGoals+=+P.values[0]});break;case Z.Yj.campaignSticker:this.game.party.campaignStickers.push(...P.values.filter(U=>"string"==typeof U));break;case Z.Yj.campaignStickerMap:{const U=C.scenarioManager.getSection(P.values[0],l.edition,void 0,!0);U&&this.game.party.conclusions.push(new Rt.Ag(U.index,U.edition,U.group));break}case Z.Yj.campaignStickerReplace:this.game.party.campaignStickers.splice(this.game.party.campaignStickers.indexOf(P.values[1],1)),this.game.party.campaignStickers.push(P.values[0]);break;case Z.Yj.checkbox:h[j]&&P.values&&P.values.length&&f.push(...this.applyEffects(l,P.values.filter(U=>"number"!=typeof U),h,_));break;case Z.Yj.drawAnotherEvent:case Z.Yj.drawEvent:this.game.eventDraw=P.values[0];break;case Z.Yj.event:case Z.Yj.eventReturn:this.addEvent(P.values[0],P.values[1]);break;case Z.Yj.eventsToTop:{const U=this.game.party.eventDecks[P.values[0]],z=U?U.find(W=>P.values.includes(W)):void 0;if(U&&z){const W=U.indexOf(z);U.splice(W,1),U.unshift(z)}break}case Z.Yj.experience:Y.forEach(U=>{U.progress.experience+=+P.values[0]});break;case Z.Yj.globalAchievement:this.game.party.globalAchievementsList.push(...P.values.filter(U=>"string"==typeof U));break;case Z.Yj.gold:case Z.Yj.goldAdditional:Y.forEach(U=>{U.progress.gold+=+P.values[0]});break;case Z.Yj.inspiration:this.game.party.inspiration+=+P.values[0];break;case Z.Yj.loseBattleGoal:Y.forEach(U=>{U.progress.battleGoals-=+P.values[0],U.progress.battleGoals<0&&(U.progress.battleGoals=0)});break;case Z.Yj.loseExperience:Y.forEach(U=>{U.progress.experience-=+P.values[0],U.progress.experience<0&&(U.progress.experience=0)});break;case Z.Yj.loseGold:Y.forEach(U=>{U.progress.gold-=+P.values[0],U.progress.gold<0&&(U.progress.gold=0)});break;case Z.Yj.loseMorale:this.game.party.morale-=+P.values[0],this.game.party.morale<0&&(this.game.party.morale=0);break;case Z.Yj.loseProsperity:this.game.party.prosperity-=+P.values[0],this.game.party.prosperity<0&&(this.game.party.prosperity=0);break;case Z.Yj.loseReputation:this.game.party.reputation-=P.values[0],this.game.party.reputation<-20&&(this.game.party.reputation=-20);break;case Z.Yj.loseReputationFaction:{const U=P.values[0];this.game.party.factionReputation[U]=(this.game.party.factionReputation[U]||0)-P.values[1],this.game.party.factionReputation[U]<-10&&(this.game.party.factionReputation[U]=-10);break}case Z.Yj.morale:this.game.party.morale+=+P.values[0],this.game.party.morale>20&&(this.game.party.morale=20);break;case Z.Yj.removeEvent:this.removeEvent(P.values[0],P.values[1]);break;case Z.Yj.reputation:case Z.Yj.reputationAdditional:this.game.party.reputation+=P.values[0],this.game.party.reputation>20&&(this.game.party.reputation=20);break;case Z.Yj.reputationFaction:{const U=P.values[0];this.game.party.factionReputation[U]=(this.game.party.factionReputation[U]||0)+P.values[1],this.game.party.factionReputation[U]>20&&(this.game.party.factionReputation[U]=20);break}case Z.Yj.resource:Y.forEach(U=>{U.progress.loot[P.values[1]]=(U.progress.loot[P.values[1]]||0)+ +P.values[0]});break;case Z.Yj.partyAchievement:this.game.party.achievementsList.push(...P.values.filter(U=>"string"==typeof U));break;case Z.Yj.prosperity:this.game.party.prosperity+=+P.values[0];break;case Z.Yj.scenarioCondition:case Z.Yj.scenarioDamage:case Z.Yj.scenarioSingleMinus1:break;case Z.Yj.sectionWeek:case Z.Yj.sectionWeeks:{const U=this.game.party.weeks+(P.values[1]?+P.values[1]:1);this.game.party.weekSections[U]=[...C.game.party.weekSections[U]||[],P.values[0]];break}case Z.Yj.sectionWeekSeasonFinal:{const U=P.values[0],z=P.values[1];let nt=0;nt=Math.max(this.game.party.weeks,0)%20<10?Math.floor(this.game.party.weeks/10)+("summer"==z?3:2):Math.floor(this.game.party.weeks/10)+("winter"==z?3:2),this.game.party.weekSections[10*nt]=[...C.game.party.weekSections[10*nt]||[],U];break}case Z.Yj.sectionWeeksSeason:{const U=P.values[0],z=P.values[2];let W=this.game.party.weeks+(P.values[1]?+P.values[1]:1);const nt=Math.max(W,0)%20<10;(nt&&"summer"==z||!nt&&"winter"==z)&&(W=W-Math.max(W,0)%20+ +P.values[3]+20),this.game.party.weekSections[W]=[...C.game.party.weekSections[W]||[],U];break}case Z.Yj.soldier:case Z.Yj.soldiers:this.game.party.soldiers+=+(P.values[0]||1),this.game.party.soldiers>10&&(this.game.party.soldiers=10);break;case Z.Yj.townGuardDeckCard:case Z.Yj.townGuardDeckCards:if(this.game.party.townGuardDeck){const U=P.values[1]?+P.values[1]:1;for(let z=0;z<U;z++)this.game.party.townGuardDeck.cards=[...this.game.party.townGuardDeck.cards,P.values[0]],this.game.party.townGuardDeck.current=-1,(0,V.Z)(this.game.party.townGuardDeck.cards)}break;case Z.Yj.townGuardDeckCardRemove:case Z.Yj.townGuardDeckCardRemovePermanently:if(this.game.party.townGuardDeck){const U=this.game.party.townGuardDeck.cards.find(z=>z==P.values[0]);U&&this.game.party.townGuardDeck.cards.splice(this.game.party.townGuardDeck.cards.indexOf(U),1)}break;case Z.Yj.traitExperience:Y.filter(U=>U.traits.some(z=>z==P.values[0])).forEach(U=>{U.progress.experience+=+P.values[1]});break;case Z.Yj.traitScenarioCondition:case Z.Yj.traitScenarioDamage:break;case Z.Yj.unlockEnvelope:if("fh"==l.edition){const U=C.campaignData(l.edition).buildings.find(z=>z.id==P.values[0]);U?null==this.game.party.buildings.find(z=>z.name==U.name)&&this.game.party.buildings.push(new st.k(U.name,0)):(console.warn("Building not found to apply event effect",P,_),f.push(P))}else console.warn("Building not found to apply event effect",P,_),f.push(P);break;case Z.Yj.unlockScenario:case Z.Yj.unlockScenarioGroup:this.game.party.manualScenarios.push(new Rt.Ag(P.values[0],l.edition,P.values[1]?P.values[1]:""));break;case Z.Yj.upgradeBuilding:{const U=this.game.party.buildings.find(z=>z.name==P.values[0]);U?U.level>=+P.values[1]?this.game.party.morale+=+P.values[2]:U.level+=1:(console.warn("Building not found to apply event effect",P,_),f.push(P));break}case Z.Yj.wreckBuilding:{const U=P.values[0],z=this.game.party.buildings.find(W=>W.name==U);z&&(z.state="wrecked");break}default:f.push(P)}}}),f}applyCondition(l){if("string"!=typeof l)switch(l.type){case Z.iH.and:return l.values.filter(d=>"number"!=typeof d).forEach(d=>{this.applyCondition(d)}),l;case Z.iH.building:case Z.iH.campaignSticker:case Z.iH.character:case Z.iH.moraleGT:case Z.iH.moraleLT:case Z.iH.otherwise:case Z.iH.reputationGT:case Z.iH.reputationLT:case Z.iH.reputationFactionGT:case Z.iH.season:case Z.iH.seasonLT:case Z.iH.traits:break;default:return console.warn("Missing implementation for applying condition",l),l}}resolvableCondition(l){if("string"==typeof l)return!0;let d=C.characterManager.getActiveCharacters();switch(l.type){case Z.iH.and:return l.values&&l.values.every(h=>"number"!=typeof h&&this.resolvableCondition(h));case Z.iH.building:return l.values&&l.values.every(h=>"string"==typeof h&&this.game.party.buildings&&this.game.party.buildings.find(_=>_.level&&_.name==h));case Z.iH.campaignSticker:return this.game.party.campaignStickers.includes(l.values[0]);case Z.iH.character:return l.values&&d.some(h=>l.values.includes(h.name));case Z.iH.moraleGT:return l.values&&"number"==typeof l.values[0]&&this.game.party.morale>l.values[0];case Z.iH.moraleLT:return l.values&&"number"==typeof l.values[0]&&this.game.party.morale<l.values[0];case Z.iH.otherwise:return!0;case Z.iH.reputationGT:return l.values&&"number"==typeof l.values[0]&&this.game.party.reputation>l.values[0];case Z.iH.reputationLT:return l.values&&"number"==typeof l.values[0]&&this.game.party.reputation<l.values[0];case Z.iH.reputationFactionGT:return l.values&&"string"==typeof l.values[0]&&"number"==typeof l.values[1]&&(this.game.party.factionReputation[l.values[0]]||0)>l.values[1];case Z.iH.season:return Math.max(this.game.party.weeks,0)%20<10?"summer"==l.values[0]:"winter"==l.values[0];case Z.iH.seasonLT:return"summer"==l.values[0]?Math.max(this.game.party.weeks+ +l.values[1],0)%20<10:"winter"==l.values[0]&&Math.max(this.game.party.weeks+ +l.values[1],0)%20>=10;case Z.iH.traits:return l.values&&d.some(h=>h.traits.some(_=>l.values.includes(_))||l.values.includes(h.characterClass));case Z.iH.traitsAll:return l.values&&l.values.every(h=>d.some(_=>!_.traits.includes(h)||_.characterClass==h));case Z.iH.payGold:return l.values&&d.every(h=>"number"==typeof l.values[0]&&h.progress.gold>=l.values[0]);case Z.iH.payCollectiveGold:return l.values&&"number"==typeof l.values[0]&&d.length>0&&d.map(h=>h.progress.gold).reduce((h,_)=>h+_)>=l.values[0];case Z.iH.payCollectiveGoldConditional:return l.values&&l.values.some(h=>"number"!=typeof h&&this.resolvableCondition(h));case Z.iH.payCollectiveGoldReputationGT:return l.values&&"number"==typeof l.values[0]&&"number"==typeof l.values[1]&&d.length>0&&d.map(h=>h.progress.gold).reduce((h,_)=>h+_)>=l.values[0]&&this.game.party.reputation>l.values[1];case Z.iH.payCollectiveGoldReputationLT:return l.values&&"number"==typeof l.values[0]&&"number"==typeof l.values[1]&&d.length>0&&d.map(h=>h.progress.gold).reduce((h,_)=>h+_)>=l.values[0]&&this.game.party.reputation<l.values[1];default:return!1}}}class Zn{game;enabled=!1;available=!1;imbuement=!1;constructor(l){this.game=l}update(){this.available=C.gh2eRules()&&C.game.party.conclusions.some(l=>"gh2e"==l.edition&&"48.2"==l.index)&&(!C.game.party.conclusions.some(l=>"gh2e"==l.edition&&"16.5"==l.index)||"advanced"),(w.f.settings.alwaysGh2eImbuement||!this.available&&!w.f.settings.partySheet)&&(this.available="advanced"),this.enabled=w.f.settings.alwaysGh2eImbuement||this.available&&w.f.settings.gh2eImbuement,(!w.f.settings.gh2eImbuementKeep||!this.imbuement)&&(this.imbuement=null!=C.game.monsterAttackModifierDeck.cards.find(l=>l.type==N.Yn.imbue),this.imbuement&&null!=C.game.monsterAttackModifierDeck.cards.find(l=>l.type==N.Yn.advancedImbue)&&(this.imbuement="advanced"))}disable(l){l.cards=l.cards.filter(d=>d.type!=N.Yn.imbue&&d.type!=N.Yn.advancedImbue),C.attackModifierManager.shuffleModifiers(l),"advanced"==this.imbuement?(C.attackModifierManager.addModifierByType(l,N.Yn.minus2),C.attackModifierManager.addModifierByType(l,N.Yn.minus1),C.attackModifierManager.addModifierByType(l,N.Yn.minus1),C.attackModifierManager.addModifierByType(l,N.Yn.minus1),C.attackModifierManager.addModifierByType(l,N.Yn.plus0),C.attackModifierManager.addModifierByType(l,N.Yn.plus0)):(C.attackModifierManager.addModifierByType(l,N.Yn.minus1),C.attackModifierManager.addModifierByType(l,N.Yn.minus1),C.attackModifierManager.addModifierByType(l,N.Yn.minus1)),this.imbuement=!1}enable(l,d=!0){w.f.settings.gh2eImbuementKeep&&(this.imbuement=!0),C.attackModifierManager.removeModifierByType(l,N.Yn.minus1),C.attackModifierManager.removeModifierByType(l,N.Yn.minus1),C.attackModifierManager.removeModifierByType(l,N.Yn.minus1),N.iy.forEach(h=>{C.attackModifierManager.addModifier(l,h,-1,d)}),this.imbuement=!0}advanced(l,d=!0){w.f.settings.gh2eImbuementKeep&&(this.imbuement="advanced"),C.attackModifierManager.removeModifierByType(l,N.Yn.minus2),C.attackModifierManager.removeModifierByType(l,N.Yn.minus1),C.attackModifierManager.removeModifierByType(l,N.Yn.minus1),C.attackModifierManager.removeModifierByType(l,N.Yn.minus1),C.attackModifierManager.removeModifierByType(l,N.Yn.plus0),C.attackModifierManager.removeModifierByType(l,N.Yn.plus0),N.iy.forEach(h=>{C.attackModifierManager.addModifier(l,h,-1,d)}),N.u3.forEach(h=>{C.attackModifierManager.addModifier(l,h,-1,d)}),this.imbuement="advanced"}}var jt=v(2941),pt=v(1604);class On{game;constructor(l){this.game=l}itemEditions(l=void 0){return C.editionData.filter(d=>w.f.settings.editions.includes(d.edition)&&(!l||l==d.edition||C.editionExtensions(l).includes(d.edition)||"fh"==l&&"gh"==d.edition)&&d.items&&d.items.length>0).flatMap(d=>d.edition)}getItems(l,d=!1){return C.itemData().filter(h=>d&&(!l||h.edition==l)||this.isItemAvailable(h,l))}isItemAvailable(l,d,h=!0){if(!this.game.party.campaignMode)return!d||l.edition==d||C.editionExtensions(d).includes(l.edition);if(d&&(l.edition==d||C.editionExtensions(d).includes(l.edition))&&(h&&this.game.party.unlockedItems.find(_=>_.name==""+l.id&&_.edition==l.edition)||l.unlockProsperity>0&&l.unlockProsperity<=C.prosperityLevel()||l.unlockScenario&&this.game.party.scenarios.find(_=>l.unlockScenario&&_.index==l.unlockScenario.name&&_.edition==l.unlockScenario.edition)||!l.blueprint&&!l.random&&l.requiredBuilding&&"alchemist"!=l.requiredBuilding&&this.game.party.buildings&&this.game.party.buildings.find(_=>_.name==l.requiredBuilding&&_.level>=l.requiredBuildingLevel)))return!0;if(w.f.settings.fhGhItems&&C.fhRules()){if("gh"==l.edition){const _=this.game.party.buildings&&this.game.party.buildings.find(f=>"trading-post"==f.name&&"wrecked"!=f.state);if(_){if("number"==typeof l.id&&_.level>=2&&[21,37,53,93,94,106,115].includes(l.id))return!0;if("number"==typeof l.id&&_.level>=3&&[46,83,84,85,86,87,88,102,110,111,120,121,122,123,126,128].includes(l.id))return!0;if("number"==typeof l.id&&_.level>=4&&[17,35,47,51,62,74,77,78,79,80,81,82,117,118,119,127,129,131].includes(l.id))return!0}return"number"==typeof l.id&&[10,25,72,105,109,116].includes(l.id)}if("fc"==l.edition){let _=[];this.game.party.scenarios.find(f=>"fh"==f.edition&&"82"==f.index&&!f.group)&&_.push(153,159,161),this.game.party.buildings&&this.game.party.buildings.find(f=>"enhancer"==f.name&&4==f.level&&"wrecked"!=f.state)&&_.push(154,155,157,163)}}return!1}getItem(l,d,h){return isNaN(+l)||(l=+l),C.itemData().find(_=>_&&_.id==l&&_.edition==d&&(h||this.isItemAvailable(_,d)))}maxItemIndex(l){return Math.max(...this.getItems(l,!0).filter(d=>"number"==typeof d.id).map(d=>+d.id))}pricerModifier(){return this.game.party.reputation>=0?-1*Math.ceil((C.game.party.reputation-2)/4):-1*Math.floor((C.game.party.reputation+2)/4)}assigned(l){return this.game.figures.filter(d=>d instanceof c.K&&d.progress&&d.progress.items).map(d=>d).map(d=>d.progress&&d.progress.items).reduce((d,h)=>d&&h&&d.concat(h)).filter(d=>l&&d.name==""+l.id&&d.edition==l.edition).length}owned(l,d){return null!=d.progress.items.find(h=>l&&h.name==""+l.id&&h.edition==l.edition)}canAdd(l,d){return l.count&&this.countAvailable(l)>0&&!d.progress.items.find(h=>l&&h.name==""+l.id&&h.edition==l.edition)&&(!l.solo||l.edition==d.edition&&l.solo==d.name)||!1}canBuy(l,d,h=0){return!(!d.tags.includes("new-character")&&this.buyingDisabled())&&(l.cost&&l.cost+this.pricerModifier()+h<=d.progress.gold&&this.canAdd(l,d)||!1)}buyingDisabled(){return C.fhRules()&&C.game.party.campaignMode&&null!=C.game.party.buildings.find(l=>"trading-post"==l.name&&l.level>0&&"wrecked"==l.state)}canCraft(l,d,h={}){if(this.craftingDisabled())return!1;let _=!1,f=!0;return l.resources&&Object.keys(l.resources).forEach(P=>{const j=P,Y=(l.resources[j]||0)+(h[j]||0);Y>0&&(_=!0),f=(0,pt.hV)(j)==pt.hM.herb_resources?f&&((d.progress.loot[j]||0)>=Y||(C.game.party.loot[j]||0)>=Y):f&&(d.progress.loot[j]||0)>=Y}),l.requiredItems&&l.requiredItems.forEach(P=>{if(P!=l.id){const j=this.getItem(P,l.edition,!0);j?(_=!0,this.owned(j,d)||(f=f&&(this.canCraft(j,d,l.resources||{})||this.canBuy(j,d,l.cost)))):console.error("Missing required item '"+P+"' for item '"+l.id+"' ("+l.name+")")}}),f&&_}canDistill(l){if(C.buildingsManager.distillAvailable){if(l.resourcesAny&&l.resourcesAny.length)return l.resourcesAny.every(d=>d.herb_resources);if(l.resources&&l.resources)return Object.keys(l.resources).map(h=>h).every(h=>pt.Pr.includes(h))}return!1}craftingDisabled(){return C.fhRules()&&C.game.party.campaignMode&&null!=C.game.party.buildings.find(l=>"craftsman"==l.name&&l.level>0&&"wrecked"==l.state)}brewingDisabled(){return C.fhRules()&&C.game.party.campaignMode&&null!=C.game.party.buildings.find(l=>"alchemist"==l.name&&l.level>0&&"wrecked"==l.state)}itemUsable(l){return!("alchemist"==l.requiredBuilding&&this.brewingDisabled())}itemSellValue(l){if(l.cost)return Math.floor(l.cost/2);{let d=0;return l.resourcesAny&&(d+=l.resourcesAny.length),l.resources&&Object.keys(l.resources).forEach(h=>{d+=2*(l.resources[h]||0)}),l.requiredItems&&l.requiredItems.forEach(()=>{d+=2}),d}}addItem(l,d){d.progress.items.push(new O.gw(l.id+"",l.edition))}buyItem(l,d){d.progress.gold-=l.cost+this.pricerModifier(),d.progress.items.push(new O.gw(l.id+"",l.edition))}craftItemResources(l,d){l.resources&&Object.keys(l.resources).forEach(h=>{const _=h,f=l.resources[_]||0;(0,pt.hV)(_)==pt.hM.herb_resources?(d.progress.loot[_]||0)>=f?d.progress.loot[_]=(d.progress.loot[_]||0)-f:this.game.party.loot[_]=(this.game.party.loot[_]||0)-f:d.progress.loot[_]=(d.progress.loot[_]||0)-f}),l.requiredItems&&l.requiredItems.forEach(h=>{if(h!=l.id){const _=this.getItem(h,l.edition,!0);if(_){if(_){const f=d.progress.items.find(P=>P.name==""+_.id&&P.edition==_.edition);if(f){const P=d.progress.items.indexOf(f);d.progress.items.splice(P,1),d.progress.equippedItems=d.progress.equippedItems.filter(j=>j.name!=""+_.id||j.edition!=_.edition)}else this.canBuy(_,d)?d.progress.gold-=l.cost+this.pricerModifier():this.craftItemResources(_,d)}}else console.error("Missing required item '"+h+"' for item '"+l.id+"' ("+l.name+")")}})}craftItem(l,d){this.craftItemResources(l,d),d.progress.items.push(new O.gw(l.id+"",l.edition))}removeItem(l,d){const h=d.progress.items.find(_=>_.name==""+l.id&&_.edition==l.edition);if(h){const _=d.progress.items.indexOf(h);d.progress.items.splice(_,1),d.progress.equippedItems=d.progress.equippedItems.filter(f=>f.name!=""+l.id||f.edition!=l.edition)}}sellItem(l,d){const h=d.progress.items.find(_=>_.name==""+l.id&&_.edition==l.edition);if(h&&this.itemSellValue(l)){const _=d.progress.items.indexOf(h);d.progress.gold+=this.itemSellValue(l),d.progress.items.splice(_,1),d.progress.equippedItems=d.progress.equippedItems.filter(f=>f.name!=""+l.id||f.edition!=l.edition)}}addItemCount(l){if(this.game.party.campaignMode){const d=C.itemManager.assigned(l);if(C.itemManager.countAvailable(l)+d<l.count){const _=C.game.party.unlockedItems.find(f=>+f.name==l.id&&f.edition==l.edition);_?(_.count+=1,_.count==l.count&&(_.count=-1)):C.game.party.unlockedItems.push(new O.VP(""+l.id,l.edition,1))}}}countAvailable(l){const d=this.assigned(l);if(!this.isItemAvailable(l,l.edition,!1)){const h=C.game.party.unlockedItems.find(_=>+_.name==l.id&&_.edition==l.edition);if(h&&h.count>0)return h.count-d<0&&console.warn("More items assigend than available:",l),h.count-d;if(!h)return-1}return l.count-d<0&&console.warn("More items assigend than available:",l),l.count-d}isEquipped(l,d){return null!=d.progress.equippedItems.find(h=>h.name==""+l.id&&h.edition==l.edition)}toggleEquippedItem(l,d,h=!1){let _=d.progress.equippedItems.map(P=>this.getItem(P.name,P.edition,!0)).filter(P=>P).map(P=>P);const f=_.indexOf(l);if(h&&-1==f)_.push(l);else if(h)_.splice(f,1);else if(-1!=f){_.splice(f,1);const P=Math.ceil(d.level/2),j=_.filter(Y=>Y.slot==jt.o8.small).length;if(16==l.id&&"gh"==l.edition&&j>=P)for(let Y=0;Y<j-P;Y++){const U=_.find(z=>z.slot==jt.o8.small);U&&_.splice(_.indexOf(U),1)}}else{const P="drifter"==d.name&&"fh"==d.edition&&d.progress.perks[11];if(l.slot==jt.o8.small){let j=Math.ceil(d.level/2);if(_.find(Y=>16==Y.id&&"gh"==Y.edition||60==Y.id&&"fh"==Y.edition)&&(j+=2),_.find(Y=>132==Y.id&&"fh"==Y.edition)&&(j+=1),C.trialsManager.favorsEnabled&&C.trialsManager.apply&&(j+=C.trialsManager.activeFavor("fh","capacity")),_.filter(Y=>Y.slot==l.slot).length>=j){const Y=_.find(U=>U.slot==l.slot);Y&&_.splice(_.indexOf(Y),1)}}else if(l.slot==jt.o8.onehand){const j=_.find(Y=>Y.slot==jt.o8.twohand);if(j&&!P&&(_=_.filter(Y=>Y.slot!=jt.o8.twohand)),_.filter(Y=>Y.slot==l.slot).length>(P?j?0:2:1)){const Y=_.find(U=>U.slot==l.slot);Y&&_.splice(_.indexOf(Y),1)}}else if(l.slot==jt.o8.twohand)if(_=_.filter(j=>j.slot!=l.slot),P)for(;_.filter(j=>j.slot==jt.o8.onehand).length>1;){const j=_.find(Y=>Y.slot==jt.o8.onehand);j&&_.splice(_.indexOf(j),1)}else _=_.filter(j=>j.slot!=jt.o8.onehand);else _.filter(j=>j.slot==l.slot).forEach(j=>this.toggleEquippedItem(j,d)),_=_.filter(j=>j.slot!=l.slot);_.push(l)}d.progress.equippedItems=_.map(P=>new O.h5(P.id+"",P.edition)),l.minusOne&&!C.characterManager.ignoreNegativeItemEffects(d)&&(d.attackModifierDeck=C.attackModifierManager.buildCharacterAttackModifierDeck(d),C.attackModifierManager.shuffleModifiers(d.attackModifierDeck)),3==l.id&&"fh"==l.edition&&(-1==f?d.maxHealth+=1:d.maxHealth-=1,d.health=d.maxHealth)}drawRandomItem(l,d=!1,h=-1,_=-1){let P,f=this.getItems(void 0,!0).filter(j=>(!d&&j.random||d&&j.blueprint&&(!j.requiredBuilding||C.game.party.buildings.find(Y=>Y.name==j.requiredBuilding&&Y.level>=j.requiredBuildingLevel)))&&(-1==h||"number"==typeof j.id&&j.id>=h)&&(-1==_||"number"==typeof j.id&&j.id<=_)&&!C.game.party.unlockedItems.find(Y=>Y.name==""+j.id&&Y.edition==j.edition)&&(j.edition==l||C.editionExtensions(l).includes(j.edition)));return f.length>0&&(P=f[Math.floor(Math.random()*f.length)]),P}applyEquippedItemEffects(l){l.immunities=[],l.progress.equippedItems.forEach(d=>{const h=C.itemManager.getItem(d.name,d.edition,!0);h&&(C.itemManager.applyItemEffects(l,h,"initial"==h.consumed),"initial"==h.consumed&&(d.tags=[...d.tags||[],jt.Tr.consumed]))})}applyItemEffects(l,d,h=!1){if(d.effects&&d.effects.forEach(_=>{(!d.spent&&!d.consumed||h||_.always)&&this.applyItemEffect(l,_)}),h&&d.summon){let _=new I.up((0,_n.A)(),d.summon.name,d.summon.cardId,l.level,1,I.rX.blue,d.summon);_.init=!1,C.characterManager.addSummon(l,_)}w.f.settings.characterItemsApply&&"fh"==d.edition&&258==d.id&&l.health<l.maxHealth/2&&(l.health+=7,C.attackModifierManager.addModifier(l.attackModifierDeck,new N.uU(N.Yn.curse)))}applyItemEffect(l,d){switch(d.type){case jt.TQ.heal:const h=(0,t.hZ)(d.value);l.health+=h,C.entityManager.addCondition(l,l,new G.kW(G.r5.heal,h)),C.entityManager.applyCondition(l,l,G.r5.heal,!0);break;case jt.TQ.damage:const _=(0,t.hZ)(d.value);C.entityManager.changeHealth(l,l,-_,!0);break;case jt.TQ.condition:const f=(""+d.value).split(":")[0];let P=(""+d.value).split(":").length>1?+(""+d.value).split(":")[1]:1;if(f==G.r5.bless)for(let z=0;z<P;z++)C.attackModifierManager.countUpcomingBlesses()<10&&C.attackModifierManager.addModifier(l.attackModifierDeck,new N.uU(N.Yn.bless));else if(f==G.r5.curse)for(let z=0;z<P;z++)C.attackModifierManager.countUpcomingCurses(!1)<10&&C.attackModifierManager.addModifier(l.attackModifierDeck,new N.uU(N.Yn.curse));else C.entityManager.addCondition(l,l,new G.kW(f,P));break;case jt.TQ.immune:const j=""+d.value;l.immunities.includes(j)||l.immunities.push(j);break;case jt.TQ.element:const Y=""+d.value;Y!=S.Hg.wild&&C.game.elementBoard.forEach(z=>{z.type==Y&&(z.state=S.e_.new)});break;case jt.TQ.initiative:l.initiative+=(0,t.hZ)(d.value),l.initiative<1?l.initiative=1:l.initiative>99&&(l.initiative=99);break;case jt.TQ.refreshSpent:l.progress.equippedItems.forEach(z=>{z.tags&&z.tags.includes(jt.Tr.spent)&&(z.tags=z.tags.filter(W=>W!=jt.Tr.spent))});break;case jt.TQ.removeNegativeConditions:const U=C.conditionsForTypes(G.GV.negative,G.GV.character).map(z=>z.name);l.entityConditions=l.entityConditions.filter(z=>!U.includes(z.name))}}sortItems(l,d){return"number"==typeof l.id&&"number"==typeof d.id?l.id-d.id:"number"==typeof l.id?-1:"number"==typeof d.id?1:l.id<d.id?-1:1}}class $n{game;constructor(l){this.game=l}ge5PlayerOffset(){if(!this.game.ge5Player)return 0;const l=C.characterManager.characterCount();return l<=4?0:l-3}adjustedLevel(){const l=this.game.level-this.ge5PlayerOffset()-(!this.game.solo||C.fhRules(!0)||w.f.settings.alwaysFhSolo?0:1)+this.game.bonusAdjustment;return l<0?0:l>7?7:l}trap(l=-1){return(l<0||l>7)&&(l=this.game.level),2+l}experience(l=-1){return(l<0||l>7)&&(l=this.adjustedLevel()),4+2*l}loot(l=-1){(l<0||l>7)&&(l=this.adjustedLevel());let d=2+Math.floor(l/2);return l>=7&&(d=6),d}terrain(l=-1){return w.f.settings.alwaysHazardousTerrain||C.fhRules(!0)?((l<0||l>7)&&(l=this.game.level),1+Math.ceil(l/3)):Math.floor(this.trap(l)/2)}bbMonsterDifficutly(){let l=2+C.game.levelAdjustment;return l<0?l=0:l>4&&(l=4),l}scenarioLevel(){const l=C.characterManager.characterCount();if(0==l)return 1;const d=this.game.figures.some(h=>h instanceof c.K)?this.game.figures.filter(h=>h instanceof c.K&&!h.absent).map(h=>h.level).reduce((h,_)=>h+_):1;return Math.ceil((d/l+(this.game.solo&&(C.fhRules(!0)||w.f.settings.alwaysFhSolo)?1:0))/2)+(!this.game.solo||C.fhRules(!0)||w.f.settings.alwaysFhSolo?0:1)+this.ge5PlayerOffset()}calculateScenarioLevel(){this.game.levelAdjustment>6?this.game.levelAdjustment=6:this.game.levelAdjustment<-6&&(this.game.levelAdjustment=-6);let l=this.scenarioLevel()+this.game.levelAdjustment;l>7?l=7:l<0&&(l=0),this.setLevel(l)}setLevel(l){if(this.game.level!=l){const d=l-this.game.level;this.game.level=l,this.game.figures.forEach(h=>{h instanceof R.R?(h.level+=d,h.level>7?h.level=7:h.level<0&&(h.level=0),C.monsterManager.setLevel(h,h.level)):h instanceof B.$e&&h.entities.forEach(_=>{_.health>(0,t.hZ)(h.health)&&(h.health=(0,t.hZ)(h.health))})})}}}class Gt{game;constructor(l){this.game=l}drawCard(l,d=void 0){let h;l.current++,l.current>=l.cards.length&&(l.current=l.cards.length-1);const _=l.cards[l.current];return _&&(w.f.settings.applyLoot&&d&&(h=this.applyLoot(_,d,l.current)),_.type==pt.r6.random_item&&this.game.scenario&&this.game.party.campaignMode&&this.game.party.randomItemLooted.push(new Rt.Ag(this.game.scenario.index,this.game.scenario.edition,this.game.scenario.group))),h}applyLoot(l,d,h){let _;if(d.lootCards=d.lootCards||[],l.type==pt.r6.money||l.type==pt.r6.special1||l.type==pt.r6.special2?d.loot+=this.getValue(l):l.type==pt.r6.random_item&&this.game.scenario&&this.game.party.campaignMode&&w.f.settings.characterItems&&w.f.settings.applyLootRandomItem&&(_=C.itemManager.drawRandomItem(this.game.scenario.edition),_||(d.loot+=3)),d.lootCards.push(h),C.trialsManager.apply&&C.trialsManager.trialsEnabled){const f=this.game.figures.find(P=>P instanceof c.K&&P!=d&&P.progress.trial&&"fh"==P.progress.trial.edition&&"351"==P.progress.trial.name);f&&C.entityManager.changeHealth(f,f,-Math.ceil(this.game.level/3),!0)}return _}shuffleDeck(l,d=!1){const h=l.current;let _=d&&h>-1?l.cards.splice(0,h+1):[];l.current=-1,(0,V.Z)(l.cards),d&&(l.current=h,l.cards.unshift(..._))}getTotal(l,d){const h=l.cards.filter(_=>_.type==d);return 0==h.length?0:h.map(_=>this.getValue(_)).reduce((_,f)=>_+f)}addCharacterLoot(l,d){const h=this.getValue(d);if(d.type==pt.r6.money||d.type==pt.r6.special1||d.type==pt.r6.special2)l.loot+=h;else if(pt.mn.includes(d.type)){const _=l.progress.loot[d.type]||0;_+h>=0&&(l.progress.loot[d.type]=_+h)}}lootTreasure(l,d,h){let _=[];const f=C.editionData.find(P=>P.edition==h);if(f&&f.treasures)if((d=d<0?d:d-(f.treasureOffset||0))>=0&&d<f.treasures.length){const j=new vt.Ah(f.treasures[d],d);j.rewards&&j.rewards.forEach(Y=>{_.push(this.applyTreasureReward(l,Y,h))})}else if(d<0&&f.treasures.length+d+1>0){const j=new vt.Ah(f.treasures[f.treasures.length+d+1],d);j.rewards&&j.rewards.forEach(Y=>{_.push(this.applyTreasureReward(l,Y,h))})}else console.warn("Invalid treasure index: '"+d+"' for Edition "+h);return _}hasTreasure(l,d,h){return l.treasures.some(_=>_==d||"string"==typeof _&&(_.startsWith(d+":")||"G"==d&&_=="G-"+h))}applyTreasureReward(l,d,h){let _=[];switch(d.type){case vt.lb.gold:case vt.lb.goldFh:"number"==typeof d.value&&(l.progress.gold+=d.value);break;case vt.lb.experience:case vt.lb.experienceFh:"number"==typeof d.value&&(l.progress.experience+=d.value);break;case vt.lb.battleGoal:"number"==typeof d.value&&(l.progress.battleGoals+=d.value);break;case vt.lb.damage:"number"==typeof d.value?l.health-=d.value:"terrain"==d.value&&(l.health-=C.levelManager.terrain()),l.health<=0&&(l.exhausted=!0,l.off=!0,l.active=!1);break;case vt.lb.heal:"number"==typeof d.value&&(l.health+=d.value,l.health>l.maxHealth&&(l.health=l.maxHealth));break;case vt.lb.loot:"number"==typeof d.value&&(l.loot+=d.value);break;case vt.lb.resource:"string"==typeof d.value&&d.value.split("+").forEach(f=>{const P=f.split("-")[0],j=+f.split("-")[1];l.progress.loot[P]=(l.progress.loot[P]||0)+j});break;case vt.lb.condition:"string"==typeof d.value&&d.value.split("+").forEach(f=>{C.entityManager.hasCondition(l,new G.kW(f))||C.entityManager.addCondition(l,l,new G.kW(f))});break;case vt.lb.item:case vt.lb.itemDesign:case vt.lb.itemBlueprint:case vt.lb.itemFh:d.value&&(""+d.value).split("+").forEach(f=>{let P=h,j=-1;isNaN(+f)?(j=+f.split("-")[0],P=f.split("-")[1]):j=+f;const Y=C.itemManager.getItem(j,P,!0);if(Y){const U=new O.VP(""+Y.id,Y.edition);d.type==vt.lb.item||d.type==vt.lb.itemFh?((w.f.settings.characterItems||w.f.settings.characterSheet)&&(l.progress.items.find(z=>z.name==U.name&&z.edition==U.edition)?l.progress.gold+=C.itemManager.itemSellValue(Y):l.progress.items.push(U)),C.itemManager.addItemCount(Y)):C.game.party.unlockedItems.push(U)}});break;case vt.lb.calendarSection:if(d.value&&"string"==typeof d.value&&d.value.split("-").length>1){const f=d.value.split("-")[0],P=C.game.party.weeks+ +d.value.split("-")[1];C.game.party.weekSections[P]=[...C.game.party.weekSections[P]||[],f]}break;case vt.lb.campaignSticker:d.value&&"string"==typeof d.value&&C.game.party.campaignStickers.push(d.value);break;case vt.lb.partyAchievement:d.value&&"string"==typeof d.value&&C.game.party.achievementsList.push(d.value);break;case vt.lb.lootCards:if("number"==typeof d.value){C.game.lootDeck.active=!0;for(let f=0;f<d.value;f++)this.drawCard(C.game.lootDeck);C.uiChange.next(!1)}break;case vt.lb.scenario:if(d.value){const f=new Rt.Ag(""+d.value,h);!C.game.party.manualScenarios.find(P=>P.index==f.index&&P.edition==f.edition&&P.group==f.group&&!P.custom)&&!C.game.party.scenarios.find(P=>P.index==f.index&&P.edition==f.edition&&P.group==f.group&&!P.custom)&&C.game.party.manualScenarios.push(f)}break;case vt.lb.randomScenario:if(w.f.settings.drawRandomScenario){let f=C.scenarioManager.drawRandomScenario(h);f&&(C.game.party.manualScenarios.push(new Rt.Ag(""+f.index,f.edition,f.group)),_.push(f.index,C.scenarioManager.scenarioTitle(f)))}break;case vt.lb.randomScenarioFh:if(w.f.settings.drawRandomScenario){let f=C.scenarioManager.drawRandomScenarioSection(h);f&&(C.game.party.conclusions.push(new Rt.Ag(""+f.index,f.edition,f.group)),_.push(f.index,C.scenarioManager.scenarioTitle(f,!0),f.unlocks?f.unlocks.map(P=>"%data.scenarioNumber:"+P+"%").join(", "):""))}break;case vt.lb.randomItem:case vt.lb.randomItemDesign:case vt.lb.randomItemBlueprint:if(w.f.settings.drawRandomItem){let f=-1,P=-1;"string"==typeof d.value&&d.value.includes("-")&&(f=+d.value.split("-")[0],P=+d.value.split("-")[1]);let j=C.itemManager.drawRandomItem(h,d.type==vt.lb.randomItemBlueprint,f,P);j?(d.type==vt.lb.randomItem?l.progress.items.push(new O.gw(""+j.id,j.edition)):C.game.party.unlockedItems.push(new O.VP(""+j.id,j.edition)),_.push(""+j.id,"data.items."+j.name,j.edition)):C.game.party.inspiration+=1}}return _}getValue(l,d=!0){const h=C.characterManager.characterCount();let _=l.value4P;return h<=2?_=l.value2P:3==h&&(_=l.value3P),d&&(_+=l.enhancements),_}firstRound(){this.shuffleDeck(this.game.lootDeck)}fullLootDeck(){let l=JSON.parse(JSON.stringify(pt.Di));return this.game.lootDeckEnhancements.forEach(d=>{if(d.enhancements>0){const h=l.find(_=>_.type==d.type&&_.value2P==d.value2P&&_.value3P==d.value3P&&_.value4P==d.value4P&&0==_.enhancements);if(!h)return void console.warn("Enhancement of non-available loot card: "+d.type+":"+d.value4P+":"+d.value3P+":"+d.value2P);l.splice(l.indexOf(h),1,JSON.parse(JSON.stringify(d)))}}),l}apply(l,d={}){l.cards=[],Object.values(pt.r6).forEach(h=>{const _=(0,V.Z)(this.fullLootDeck().filter(P=>P.type==h)),f=Math.min(Math.max(d[h]||0),_.length);if(h!=pt.r6.special1&&h!=pt.r6.special2)for(let P=0;P<f;P++){const j=_[P];(h!=pt.r6.random_item||!this.randomItemLooted())&&l.cards.push(j)}else if(f>0){const P=_[0];l.cards.push(P),!this.game.lootDeckFixed.includes(P.type)&&(h!=pt.r6.special2||!this.game.party.conclusions.find(j=>"fh"==j.edition&&"128.5"==j.index))&&(h!=pt.r6.special1||!this.game.party.conclusions.find(j=>"fh"==j.edition&&"133.4"==j.index))&&this.game.lootDeckFixed.push(P.type)}else this.game.lootDeckFixed=this.game.lootDeckFixed.filter(P=>P!=h),l.cards=l.cards.filter(P=>P.type!=h)}),this.shuffleDeck(l)}randomItemLooted(){return null!=C.game.party.randomItemLooted.find(l=>this.game.scenario&&l.index==this.game.scenario.index&&l.edition==this.game.scenario.edition&&l.group==this.game.scenario.group)}valueLabel(l){return l.value4P==l.value3P&&l.value3P==l.value2P?""+(l.value4P>0?l.value4P:""):l.value4P==l.value3P&&l.value3P!=l.value2P?"%game.loot.player.3-4% +"+l.value4P+"/%game.loot.player.2% +"+l.value2P:l.value4P!=l.value3P&&l.value3P==l.value2P?"%game.loot.player.4% +"+l.value4P+"/%game.loot.player.2-3% +"+l.value2P:"%game.loot.player.4% +"+l.value4P+"/%game.loot.player.3% +"+l.value3P+"/%game.loot.player.2% +"+l.value2P}applySelectResources(l){l.characters.forEach((d,h)=>{l.characterSpent[h].gold&&(d.progress.gold-=l.characterSpent[h].gold),l.characterSpent[h].hide&&(d.progress.loot[pt.r6.hide]=(d.progress.loot[pt.r6.hide]||0)-l.characterSpent[h].hide),l.characterSpent[h].lumber&&(d.progress.loot[pt.r6.lumber]=(d.progress.loot[pt.r6.lumber]||0)-l.characterSpent[h].lumber),l.characterSpent[h].metal&&(d.progress.loot[pt.r6.metal]=(d.progress.loot[pt.r6.metal]||0)-l.characterSpent[h].metal)}),l.fhSupportSpent.hide&&(C.game.party.loot[pt.r6.hide]=(C.game.party.loot[pt.r6.hide]||0)-l.fhSupportSpent.hide),l.fhSupportSpent.lumber&&(C.game.party.loot[pt.r6.lumber]=(C.game.party.loot[pt.r6.lumber]||0)-l.fhSupportSpent.lumber),l.fhSupportSpent.metal&&(C.game.party.loot[pt.r6.metal]=(C.game.party.loot[pt.r6.metal]||0)-l.fhSupportSpent.metal)}}var Jn=v(5385);class Qn{game;constructor(l){this.game=l}objectiveName(l){return l.title||l.name||l.escort?"escort":"objective"}addObjective(l=void 0,d=void 0,h=void 0){let _=C.game.figures.find(f=>f instanceof B.$e&&(!h&&l&&!f.objectiveId&&f.name==l.name&&f.health==(0,t.hZ)(""+l.health)&&f.escort==l.escort&&f.initiative==(l.initiative||99)||h&&f.objectiveId&&this.objectiveDataByObjectiveIdentifier(h)==this.objectiveDataByObjectiveIdentifier(f.objectiveId)));return _||(_=new B.$e((0,_n.A)(),h),l&&(_.marker=l.marker,_.name=l.name,d&&(_.name=d),_.health=(0,t.hZ)(""+l.health),_.escort=l.escort,l.initiative&&(_.initiative=l.initiative),_.escort&&(_.amDeck=w.f.settings.allyAttackModifierDeck&&(l.allyDeck||C.fhRules(!0))?"A":"M")),_.edition=_.escort?"escort":"objective",this.game.figures.push(_)),C.addEntityCount(_),this.setInitiativeShare(_),C.sortFigures(_),_}removeObjective(l){const d=this.game.figures.indexOf(l);-1!=d&&this.game.figures.splice(d,1)}addObjectiveEntity(l,d=void 0,h=void 0,_=""){if(!d||l.entities.find(P=>P.number==d)){const P=l.entities.filter(j=>C.entityManager.isAlive(j)).length;if(d=P%12,P<12)for(;l.entities.find(j=>j.number-1==d);)d++}let f=new q.X((0,_n.A)(),d+1,l,_||h&&h.marker||l.marker);return h&&(f.tags=h.tags),l.entities.push(f),l.off&&(l.off=!1),f}removeObjectiveEntity(l,d){l.entities.splice(l.entities.indexOf(d),1),(0==l.entities.length||l.entities.every(h=>!C.entityManager.isAlive(h)))&&(l.off||C.game.state!=E.mk.next?this.removeObjective(l):l.active?C.roundManager.toggleFigure(l):this.removeObjective(l))}objectiveEntityCountIdentifier(l,d){return"all"!=d.type&&(d.name!=l.name||d.edition!=l.edition)||"objective"!=d.type?0:l.entities.filter(h=>C.entityManager.isAlive(h)&&(!d.marker||d.marker==h.marker)&&(!d.tags||0==d.tags.length||d.tags.every(_=>h.tags.includes(_)))).length}skipObjective(l){if(l instanceof B.$e&&!l.escort){if(!l.objectiveId)return!0;{const d=this.objectiveDataByObjectiveIdentifier(l.objectiveId);if(!d||!d.actions||0==d.actions.length)return!0}}return!1}objectiveDataByObjectiveIdentifier(l){if("scenario"in l){const d=l.section?C.sectionData(l.edition).find(h=>h.index==l.scenario&&h.group==l.group):C.scenarioData(l.edition).find(h=>h.index==l.scenario&&h.group==l.group);if(d)if(l.section&&!d.objectives){const h=C.scenarioData(l.edition).find(_=>_.index==d.parent&&_.group==d.group);if(h&&h.objectives&&h.objectives.length>l.index)return h.objectives[l.index]}else if(d.objectives.length>l.index)return d.objectives[l.index]}else{const d=C.figuresByIdentifier(l);if(1==d.length){let h;const _=d[0];return _ instanceof R.R&&_.boss&&C.monsterManager.getStat(_,K.N.boss).special.forEach(P=>{P.forEach(j=>{!h&&(j.type==D.X2.summon||j.type==D.X2.spawn)&&"objectiveSpawn"==j.value&&(h=j.valueObject[0].objective)})}),h}}}next(){this.game.figures.forEach(l=>{l instanceof B.$e&&(l.off=!1,this.setInitiativeShare(l))})}setInitiativeShare(l){if(l.objectiveId){const d=C.objectiveManager.objectiveDataByObjectiveIdentifier(l.objectiveId);if(d&&d.initiativeShare){let h=0;const _=d.initiativeShare.split(":")[0];d.initiativeShare.split(":").length>0&&(h=+d.initiativeShare.split(":")[1]);const f=C.game.figures.find(P=>P instanceof R.R&&P.name==_);f&&(l.initiative=C.game.state==E.mk.next&&f.getInitiative()&&f.getInitiative()<100?h<0?Math.ceil(f.getInitiative()+h):Math.floor(f.getInitiative()+h):0)}}}draw(){this.game.figures.forEach(l=>{l instanceof B.$e&&(l.entities.some(d=>C.entityManager.isAlive(d))&&(l.off=!1),this.setInitiativeShare(l))})}}var yn=v(9819);class Ae{game;working=!1;firstRound=!1;constructor(l){this.game=l}drawAvailable(){return this.game.figures.length>0&&(this.game.state==E.mk.next||this.game.figures.every(l=>l instanceof R.R||l instanceof B.$e&&(l.getInitiative()>0||!w.f.settings.initiativeRequired)||l instanceof c.K&&(l.getInitiative()>0||l.exhausted||l.absent||!w.f.settings.initiativeRequired)))}nextGameState(l=!1){if(this.working=!0,this.game.totalSeconds+=this.game.playSeconds,this.game.playSeconds=0,w.f.settings.scenarioRules&&C.scenarioRulesManager.addScenarioRules(),this.game.state==E.mk.next)this.game.state=E.mk.draw,C.entityManager.next(),C.characterManager.next(),C.monsterManager.next(),C.objectiveManager.next(),C.attackModifierManager.next(),w.f.settings.moveElements&&this.game.elementBoard.forEach(d=>{d.state!=S.e_.always&&(C.bbRules()?d.state=S.e_.inert:d.state==S.e_.strong||d.state==S.e_.new?([S.Hg.fire,S.Hg.ice,S.Hg.air,!S.Hg.earth].includes(d.type)||!this.game.figures.find(h=>h instanceof c.K&&!h.absent&&"triangles"==h.name&&h.tags.includes("element_waning")))&&(d.state=S.e_.waning):d.state==S.e_.waning&&(d.state=S.e_.inert))}),C.sortFigures(),this.game.figures.forEach(d=>{d.active=!1});else if(this.drawAvailable()||l){if(this.firstRound){C.attackModifierManager.firstRound(),C.lootManager.firstRound(),C.challengesManager.enabled&&(C.challengesManager.clearDrawn(this.game.challengeDeck,!0),C.challengesManager.applyCardsStart()),C.trialsManager.favorsEnabled&&C.trialsManager.apply&&C.trialsManager.applyFavorPoints(),this.game.challengeDeck.active=!1;let d=new Rt.Nz(new F.tB,[],[],!0);this.game.scenario?d=this.game.scenario:this.game.scenario=d,this.game.figures.forEach(h=>{h instanceof c.K&&(C.game.scenario&&w.f.settings.characterItemsApply&&C.itemManager.applyEquippedItemEffects(h),w.f.settings.scenarioStats&&(h.scenarioStats=new yn.yn))})}if(this.game.state=E.mk.next,this.game.round++,C.characterManager.draw(),C.monsterManager.draw(),C.objectiveManager.draw(),w.f.settings.moveElements&&this.game.elementBoard.forEach(d=>{d.state==S.e_.new&&(d.state=S.e_.strong)}),C.sortFigures(),C.challengesManager.apply&&C.challengesManager.isActive(1526,"fh")&&C.challengesManager.applyCardsTrigger(1526),this.game.figures.length>0&&(w.f.settings.initiativeRequired||w.f.settings.automaticFirstFigure)){let d=0,h=this.game.figures.find((_,f)=>f==d&&C.gameplayFigure(_));for(;!h&&d<this.game.figures.length-1;)d++,h=this.game.figures.find((_,f)=>f==d&&C.gameplayFigure(_));h&&this.toggleFigure(h,!0)}}w.f.settings.removeUnusedMonster&&this.game.figures.filter(d=>d instanceof R.R&&d.off&&0==d.entities.length&&!d.tags.includes("addedManually")).forEach(d=>{C.monsterManager.removeMonster(d)}),C.uiChange.next(!1),setTimeout(()=>this.working=!1,1)}toggleFigure(l,d=!1){const h=this.game.figures;let _=h.indexOf(l),f=h.find(z=>z.active),P=f?h.indexOf(f):-1;if(!f&&h.every(z=>z.off))for(P=h.length-1,f=h[P];f&&!C.gameplayFigure(f);)P--,f=-1==P?void 0:h[P];const j=l.active||!C.objectiveManager.skipObjective(l)||d;if(-1==_)return void console.error("Invalid figure");let Y=l,U=l.active;if(w.f.settings.activeSummons&&l instanceof c.K&&!l.absent){const z=l.summons.find(nt=>nt.active||nt.tags.includes("cs-skull-spirit-turn")),W=l.summons.filter(nt=>nt.tags.includes("cs-skull-spirit"));z&&(!W.includes(z)||!z.active||W.indexOf(z)<W.length-1)&&(U=!1)}if(U&&(this.afterTurn(l),Y=h.find((z,W)=>C.gameplayFigure(z)&&!z.off&&W!=_),!l.off&&l instanceof R.R&&l.bb&&l.tags.includes("bb-elite")&&((!Y||Y.getInitiative()>l.getInitiative())&&(Y=l),C.sortFigures())),j)for(;Y&&C.objectiveManager.skipObjective(Y);)_=h.indexOf(Y),this.turn(Y),this.afterTurn(Y),Y=h.find((z,W)=>C.gameplayFigure(z)&&!z.off&&W!=_);if(Y){_=h.indexOf(Y);for(let z=0;z<h.length;z++){const W=h[z];C.gameplayFigure(W)&&(z<_&&z>=P&&!W.off?(z>P&&(this.beforeTurn(W),this.turn(W,!0)),this.afterTurn(W)):z==_?(W.active||this.beforeTurn(W),this.turn(W)):!U&&z>_&&z<=P&&this.beforeTurn(W))}}}beforeTurn(l){if(l.off||l.active?(l.off=!1,l instanceof R.R&&l.entities.forEach(d=>{d.active=l.active&&!d.off}),C.entityManager.entitiesAll(l,!1).forEach(d=>{if(w.f.settings.applyConditions){const h=(d instanceof T.I||d instanceof I.up)&&d.dead;if(C.entityManager.unapplyConditionsTurn(d,l),C.entityManager.unapplyConditionsAfter(d,l),h&&!d.dead){const _=C.additionalIdentifier(l,d);let f=C.entityCounter(_);f&&f.killed--}}}),C.entityManager.entitiesAll(l).forEach(d=>{w.f.settings.expireConditions&&C.entityManager.restoreConditions(d)}),l instanceof c.K&&!l.absent&&("music-note"==l.name&&l.tags.includes("song_active")&&(l.experience-=1),!l.active&&"skull"==l.name&&l.tags.includes("spirits")&&l.summons.filter(d=>d.tags.includes("cs-skull-spirit")).forEach(d=>{d.maxHealth&&(d.health+=1,C.entityManager.checkHealth(d,l))}))):l instanceof R.R&&!l.entities.find(d=>d.active)&&l.entities.forEach(d=>{d.active=l.active,d.off=!1}),l instanceof c.K&&w.f.settings.activeSummons&&l.summons.forEach(d=>{d.active&&(d.active=!1)}),l instanceof c.K&&l.longRest&&w.f.settings.applyLongRest){const d=l.entityConditions.find(h=>h.name==G.r5.heal&&h.value&&h.expired);d&&(l.entityConditions=l.entityConditions.filter(h=>h!=d)),w.f.settings.characterItems&&l.progress.equippedItems.forEach(h=>{if(h.tags){const _=C.itemManager.getItem(h.name,h.edition,!0);h.tags=h.tags.filter(f=>f!=jt.Tr.spent),_&&_.spent&&(h.tags=h.tags.filter(f=>f!=jt.Tr.slot&&f!=jt.Tr.slotBack))}})}l.off&&C.entityManager.entities(l).length>0&&(l.off=!1),l.active=!1}turn(l,d=!1){if(l.active=!0,C.scenarioRulesManager.addActiveFigureRule(l),l instanceof R.R&&!l.entities.find(h=>h.active)&&l.entities.forEach(h=>{!l.off&&h.summon!=I.N5.new&&C.entityManager.isAlive(h)&&(h.active=!0)}),w.f.settings.characterAttackModifierDeckActiveBottom&&C.game.figures.forEach(h=>{h instanceof c.K&&(h.attackModifierDeckVisible=!1)}),l instanceof c.K&&C.entityManager.isAlive(l))if(w.f.settings.characterAttackModifierDeckActiveBottom&&w.f.settings.characterAttackModifierDeckPermanentActive&&(l.attackModifierDeckVisible=!0),!d&&w.f.settings.activeSummons){const h=l.summons.find(f=>C.entityManager.isAlive(f,!0)&&f.active),_=l.summons.find((f,P,j)=>(!h||P>j.indexOf(h))&&C.entityManager.isAlive(f,!0)&&!f.tags.includes("prism_mode")&&((!h||!h.tags.includes("cs-skull-spirit"))&&!f.tags.includes("cs-skull-spirit")||f.tags.includes("cs-skull-spirit-turn")));l.summons.slice(h?l.summons.indexOf(h):0,_?l.summons.indexOf(_):l.summons.length).forEach((f,P,j)=>{f.active=!1,f.tags=f.tags.filter(Y=>"cs-skull-spirit-turn"!=Y),w.f.settings.expireConditions&&C.entityManager.expireConditions(f,l),w.f.settings.scenarioRules&&C.scenarioRulesManager.applyScenarioRulesTurn(f,!0),w.f.settings.applyConditions&&(!h||P>0)&&(C.entityManager.applyConditionsTurn(f,l),C.entityManager.applyConditionsAfter(f,l))}),_?(_.active=!0,w.f.settings.applyConditions&&C.entityManager.applyConditionsTurn(_,l),w.f.settings.scenarioRules&&C.scenarioRulesManager.applyScenarioRulesTurn(_),_.dead&&this.turn(l)):(this.game.elementBoard.forEach(f=>{f.state==S.e_.new&&(f.state=S.e_.strong)}),l.summons.forEach(f=>{f.active&&(f.active=!1)}),"lightning"==l.name&&l.tags.includes("blood-pact")&&(("gh2e"!=l.edition||l.health>1)&&(l.health-=1),C.entityManager.checkHealth(l,l)))}else l.summons.forEach(h=>{h.active=!1,w.f.settings.applyConditions&&C.entityManager.applyConditionsTurn(h,l),w.f.settings.scenarioRules&&C.scenarioRulesManager.applyScenarioRulesTurn(h)}),"lightning"==l.name&&l.tags.includes("blood-pact")&&(("gh2e"!=l.edition||l.health>1)&&(l.health-=1),C.entityManager.checkHealth(l,l));if(this.game.elementBoard.forEach(h=>{h.state==S.e_.new&&(h.state=S.e_.strong)}),l instanceof c.K&&!d?!d&&!l.summons.some(h=>h.active)&&(w.f.settings.applyConditions&&C.entityManager.applyConditionsTurn(l,l),w.f.settings.scenarioRules&&C.scenarioRulesManager.applyScenarioRulesTurn(l)):C.entityManager.entitiesAll(l).forEach(h=>{w.f.settings.applyConditions&&C.entityManager.applyConditionsTurn(h,l),w.f.settings.scenarioRules&&C.scenarioRulesManager.applyScenarioRulesTurn(h)}),l instanceof c.K&&!l.absent&&(d||!l.summons.some(h=>h.active))&&("music-note"==l.name&&l.tags.includes("song_active")&&(l.experience+=1),"prism"==l.name&&(l.tags.includes("repair_mode")&&!l.tags.includes("roundAction-repair_mode")&&(l.health+=2,C.entityManager.addCondition(l,l,new G.kW(G.r5.heal,2)),C.entityManager.applyCondition(l,l,G.r5.heal,!0),l.tags.push("roundAction-repair_mode")),l.tags.includes("spider_mode")&&!l.tags.includes("roundAction-spider_mode")&&(C.entityManager.addCondition(l,l,new G.kW(G.r5.ward)),l.tags.push("roundAction-spider_mode")))),l instanceof c.K&&!l.absent&&w.f.settings.applyLongRest&&l.longRest&&(d||!l.summons.some(h=>h.active))){if(l.health<l.maxHealth||l.entityConditions.find(h=>!h.expired&&h.types.includes(G.GV.clearHeal)&&!h.permanent)){let h=2;("lightning"==l.name&&"fh-crossover"==l.edition&&l.tags.includes("rapid_recovery")||"lightning"==l.name&&"gh2e"==l.edition&&l.tags.includes("long_rest_heal"))&&(h+=1),l.health+=h,C.entityManager.addCondition(l,l,new G.kW(G.r5.heal,h)),C.entityManager.applyCondition(l,l,G.r5.heal,!0)}"three-spears"==l.name&&l.tags.includes("supply_tokens_perk")&&0==l.primaryToken&&l.tokenValues[0]<5&&l.progress.perks[10]>=2&&(l.tokenValues[0]+=1)}(l instanceof c.K&&!C.entityManager.isAlive(l)||l instanceof R.R&&l.entities.every(h=>!C.entityManager.isAlive(h))||l instanceof B.$e&&l.entities.every(h=>!C.entityManager.isAlive(h)))&&this.toggleFigure(l)}afterTurn(l){if(!l.off){if(C.scenarioRulesManager.addActiveFigureRule(l,!0),l instanceof R.R&&l.entities.forEach(d=>{d.active=!1,d.off=!0}),w.f.settings.activeSummons&&l instanceof c.K){let d=l.summons.find(h=>C.entityManager.isAlive(h,!0)&&h.active);for(;d;)this.turn(l),d=l.summons.find(h=>C.entityManager.isAlive(h,!0)&&h.active)}if(l instanceof c.K&&(l.summons.forEach(d=>{w.f.settings.activeSummons||(d.active=!1,C.entityManager.isAlive(d)&&(w.f.settings.expireConditions&&C.entityManager.expireConditions(d,l),w.f.settings.applyConditions&&C.entityManager.applyConditionsAfter(d,l),w.f.settings.scenarioRules&&C.scenarioRulesManager.applyScenarioRulesTurn(d,!0)))}),"skull"==l.name&&!l.absent&&l.tags.includes("spirits")&&l.summons.filter(d=>d.tags.includes("cs-skull-spirit")).forEach(d=>{d.maxHealth&&(d.health-=1,C.entityManager.checkHealth(d,l))})),l instanceof c.K&&!l.absent&&"fist"==l.name&&l.tags.includes("gift-of-the-mountain")&&(l.health<(0,t.hZ)(l.maxHealth,l.level)||l.entityConditions.find(d=>d.types.includes(G.GV.clearHeal)&&!d.permanent&&!d.expired))){let d=l.entityConditions.find(h=>h.name==G.r5.heal);d||(d=new G.BR(G.r5.heal,2),l.entityConditions.push(d)),d.value=2,d.expired=!1,d.state=G.mg.normal,l.health+=2,C.entityManager.applyCondition(l,l,G.r5.heal,!0)}l instanceof c.K&&!l.absent&&"shards"==l.name&&l.tags.includes("resonance_tokens")&&l.tokenValues[0]<5&&(l.tokenValues[0]+=1),l instanceof c.K?(w.f.settings.expireConditions&&C.entityManager.expireConditions(l,l),w.f.settings.applyConditions&&C.entityManager.applyConditionsAfter(l,l),w.f.settings.scenarioRules&&C.scenarioRulesManager.applyScenarioRulesTurn(l,!0)):C.entityManager.entitiesAll(l).forEach(d=>{w.f.settings.expireConditions&&C.entityManager.expireConditions(d,l),w.f.settings.applyConditions&&C.entityManager.applyConditionsAfter(d,l),w.f.settings.scenarioRules&&C.scenarioRulesManager.applyScenarioRulesTurn(d,!0)})}this.game.elementBoard.forEach(d=>{d.state==S.e_.new&&(d.state=S.e_.strong),(d.state==S.e_.consumed||d.state==S.e_.partlyConsumed)&&(d.state=S.e_.inert)}),l.off=!0,l.active=!1,l instanceof R.R&&l.bb&&l.tags.includes("bb-elite")&&!l.tags.includes("roundAction-bb-elite")&&(l.tags.push("roundAction-bb-elite"),l.ability+=1,l.ability>=l.abilities.length&&(l.ability=0),l.off=!1)}resetScenario(){if(this.game.playSeconds=0,this.game.sections=[],this.game.scenario&&(this.game.scenario.revealedRooms=[],this.game.scenario.additionalSections=[]),this.game.scenarioRules=[],this.game.appliedScenarioRules=[],this.game.discardedScenarioRules=[],this.game.round=0,this.game.roundResets=[],this.game.roundResetsHidden=[],this.game.eventDraw=void 0,this.game.state=E.mk.draw,this.game.elementBoard.forEach(d=>d.state=S.e_.inert),C.game.monsterAttackModifierDeck=C.attackModifierManager.buildMonsterAttackModifierDeck(),C.game.allyAttackModifierDeck=C.attackModifierManager.buildMonsterAttackModifierDeck(!0),C.bbRules()){const d=C.editionData.find(h=>"bb"==h.edition&&h.monsterAmTables&&h.monsterAmTables.length);if(d){const h=C.levelManager.bbMonsterDifficutly();this.game.monsterAttackModifierDeck=new N.J(d.monsterAmTables[h].map(_=>new N.uU(_)),w.f.settings.bbAm)}}this.game.figures=this.game.figures.filter(d=>d instanceof c.K||this.game.scenario&&this.game.scenario.custom),this.game.entitiesCounter=[],this.game.lootDeck.fromModel(new pt.yX),this.game.challengeDeck.active=!1,this.game.challengeDeck.cards.length&&C.challengesManager.clearDrawn(this.game.challengeDeck),this.game.keepFavors||(this.game.favors=[],this.game.favorPoints=[]),this.game.figures.forEach(d=>{if(d.active=!1,d.off=!1,d instanceof c.K){if("demolitionist"==d.name&&!d.absent&&d.tags.includes("mech")){const h=d.stats.find(_=>_.level==d.level);h&&(d.maxHealth=h.health)}if("astral"==d.name&&!d.absent&&d.tags.includes("veil-of-protection")){const h=d.stats.find(_=>_.level==d.level);h&&(d.maxHealth=h.health)}if(d.health=d.maxHealth,d.loot=0,d.lootCards=[],d.treasures=[],d.experience=0,d.entityConditions=[],d.immunities=[],d.summons=[],d.initiative=0,d.exhausted=!1,d.longRest=!1,d.token=0,d.tokenValues[d.primaryToken]=0,d.battleGoal=!1,d.battleGoals=[],d.shield=void 0,d.shieldPersistent=void 0,d.retaliate=[],d.retaliatePersistent=[],d.scenarioStats=new yn.yn,C.fhRules()&&d.tags.includes("new-character")&&(d.progress.gold=0),d.tags=d.tags.filter(h=>"new-character"!=h&&!d.specialActions.find(_=>_.name==h&&_.expire)),null!=d.defaultIdentity&&(d.identity=d.defaultIdentity),!d.absent&&("blinkblade"==d.name&&d.tags.includes("time_tokens")&&0==d.primaryToken&&(d.tokenValues[0]+=1),"kelp"==d.name&&d.tags.includes("trophy_tokens")&&0==d.primaryToken&&(d.tokenValues[0]+=2),"shards"==d.name&&d.tags.includes("resonance_tokens")&&0==d.primaryToken&&(d.tokenValues[0]+=1),"shards"==d.name&&d.tags.includes("extra_resonance_tokens")&&0==d.primaryToken&&(d.tokenValues[0]+=2,C.entityManager.addCondition(d,d,new G.kW(G.r5.brittle))),"three-spears"==d.name&&d.tags.includes("supply_tokens_scenario")&&0==d.primaryToken&&(d.tokenValues[0]+=1),"eclipse"==d.name&&"gh2e"==d.edition)){let h=new G.BR(G.r5.invisible);h.permanent=!0,d.entityConditions.push(h)}d.availableSummons.filter(h=>h.special).forEach(h=>C.characterManager.createSpecialSummon(d,h)),d.attackModifierDeck=C.attackModifierManager.buildCharacterAttackModifierDeck(d),d.lootCardsVisible=!1,d.progress.equippedItems=d.progress.equippedItems.filter(h=>"loot-random-item"!=h.marker),d.progress.equippedItems.forEach(h=>h.tags=[]),C.characterManager.applyDonations(d)}else d instanceof R.R?(d.entities=[],d.ability=-1,d.abilities=[],C.monsterManager.resetMonsterAbilities(d)):d instanceof B.$e&&(d.entities=[]);C.sortFigures()});const l=C.campaignData();if(this.game.party.townGuardDeck&&l.townGuardPerks){const d=C.attackModifierManager.buildTownGuardAttackModifierDeck(this.game.party,l);C.attackModifierManager.shuffleModifiers(d),d.active=!1,this.game.party.townGuardDeck=d.toModel()}this.game.party.pets&&this.game.party.pets.forEach(d=>{d.lost=!1}),C.trialsManager.applyTrialCards(),C.stateManager.standeeDialogCanceled=!1,C.uiChange.next(!1)}}var Ve=v(8503);class Fe{game;constructor(l){this.game=l}createScenario(){return new Rt.Nz(new F.tB,[],[],!0)}getScenario(l,d,h){return C.scenarioData(d).find(_=>_.index==l&&_.edition==d&&_.group==h)}getSection(l,d,h,_=!1){return C.sectionData(d).find(f=>f.index==l&&f.edition==d&&f.group==h&&(!_||f.conclusion))}setScenario(l,d=!1){if(this.game.scenario=l?new Rt.Nz(l,l.revealedRooms,l.additionalSections,l.custom):void 0,l&&!l.custom){const h=C.scenarioData().find(_=>_.index==l.index&&_.edition==l.edition&&_.group==l.group);if(!h)return void console.error("Could not find scenario data!");C.roundManager.resetScenario(),this.applyScenarioData(h,!1,d),w.f.settings.scenarioRules&&C.scenarioRulesManager.addScenarioRules(!0)}else l||C.roundManager.resetScenario();C.stateManager.standeeDialogCanceled=!1}finishScenario(l,d=!0,h,_=!1,f=!1,P=!0,j=!0,Y=!1){if(C.game.finish=void 0,l){let U=l.rewards?Object.assign(new F.$v,l.rewards):void 0;if(h&&h.rewards&&(U?Object.assign(U,h.rewards):U=Object.assign(new F.$v,h.rewards)),!Y&&P&&w.f.settings.scenarioStats&&this.game.figures.forEach(z=>{z instanceof c.K&&!z.absent&&(z.progress.scenarioStats=z.progress.scenarioStats||[],C.scenarioStatsManager.applyScenarioStats(z,l,d),z.progress.scenarioStats.push(z.scenarioStats))}),!Y&&P&&w.f.settings.characterSheet){const z=!d||U&&U.ignoredBonus&&U.ignoredBonus.includes("experience")?0:C.levelManager.experience(),W=C.levelManager.loot();this.game.figures.forEach(nt=>{nt instanceof c.K&&!nt.absent&&(C.characterManager.addXP(nt,z+nt.experience,!_&&!f),(!U||!U.ignoredBonus||!U.ignoredBonus.includes("gold"))&&(nt.progress.gold+=nt.loot*W,!_&&nt.lootCards&&nt.lootCards.forEach(gt=>{C.lootManager.addCharacterLoot(nt,this.game.lootDeck.cards[gt])})))})}if(d&&(U&&j&&(U.valueMapping&&Object.keys(U.valueMapping).forEach(z=>{if(U&&U.valueMapping&&U.valueMapping[z]){const W=U.valueMapping[z],nt=C.scenarioRulesManager.presentEntitiesByFigureRule(W,void 0).length,gt=W.value;U&&"string"==typeof U[gt]&&(U[gt]=U[gt].replaceAll(z,""+nt))}}),!Y&&w.f.settings.characterSheet&&this.game.figures.forEach(z=>{U&&z instanceof c.K&&!z.absent&&w.f.settings.scenarioRewards&&(U.experience&&C.characterManager.addXP(z,U.experience,!_&&!f),U.gold&&(z.progress.gold+=U.gold),U.perks&&(z.progress.extraPerks+=U.perks,z.progress.extraPerks<0&&(z.progress.extraPerks=0)),U.battleGoals&&(z.progress.battleGoals+=U.battleGoals,z.progress.battleGoals>18?z.progress.battleGoals=18:z.progress.battleGoals<0&&(z.progress.battleGoals=0)),U.resources&&U.resources.forEach(W=>{z.progress.loot[W.type]=(z.progress.loot[W.type]||0)+(0,t.hZ)(W.value),(z.progress.loot[W.type]||0)<0&&(z.progress.loot[W.type]=0)}))}),U.globalAchievements&&this.game.party.globalAchievementsList.push(...U.globalAchievements),U.partyAchievements&&this.game.party.achievementsList.push(...U.partyAchievements),U.lostPartyAchievements&&(this.game.party.achievementsList=this.game.party.achievementsList.filter(z=>U&&!U.lostPartyAchievements.includes(z))),U.campaignSticker&&this.game.party.campaignStickers.push(...U.campaignSticker.map(z=>z.toLowerCase().replaceAll(" ","-"))),U.eventDecks&&U.eventDecks.forEach(z=>{const W=z.split(":")[0],nt=C.eventCardManager.getEventCardsForEdition(l.edition,W),gt=nt.find(kt=>kt.cardId==z.split(":")[1].split("|")[0]),ht=nt.find(kt=>kt.cardId==z.split(":")[1].split("|")[1]);gt&&ht?C.eventCardManager.buildEventDeck(W,nt.slice(nt.indexOf(gt),nt.indexOf(ht)+1).map(kt=>kt.cardId)):console.warn("Could not find start and end for: "+z)}),w.f.settings.partySheet&&(U.reputation&&(this.game.party.reputation+=U.reputation,this.game.party.reputation>20?this.game.party.reputation=20:this.game.party.reputation<-20&&(this.game.party.reputation=-20)),U.reputationFactions&&U.reputationFactions.forEach(z=>{const W=z.split(":")[0],nt=+z.split(":")[1];this.game.party.factionReputation[W]=(this.game.party.factionReputation[W]||0)+nt,this.game.party.factionReputation[W]>20?this.game.party.factionReputation[W]=20:this.game.party.factionReputation[W]<-10&&(this.game.party.factionReputation[W]=-10)}),U.prosperity&&(this.game.party.prosperity+=U.prosperity,this.game.party.prosperity>(C.fhRules()?132:64)?this.game.party.prosperity=C.fhRules()?132:64:this.game.party.prosperity<0&&(this.game.party.prosperity=0)),U.morale&&(this.game.party.morale+=(0,t.hZ)(U.morale),this.game.party.morale>20?this.game.party.morale=20:this.game.party.morale<0&&(this.game.party.morale=0)),U.inspiration&&(this.game.party.inspiration+=(0,t.hZ)(U.inspiration),this.game.party.inspiration<0&&(this.game.party.inspiration=0)),U.itemDesigns&&U.itemDesigns.forEach(z=>{if(z.includes("-")){const W=+z.split("-")[0],nt=+z.split("-")[1];for(let gt=W;gt<=nt;gt++){const ht=C.itemManager.getItem(gt,l.edition,!0);ht&&(!ht.unlockScenario||ht.unlockScenario.edition!=l.edition||ht.unlockScenario.name!=l.index)&&this.game.party.unlockedItems.push(new O.VP(ht.id+"",l.edition))}}else{let W=l.edition;z.includes(":")&&(W=z.split(":")[1]);const nt=C.itemManager.getItem(z.split(":")[0],W,!0);nt&&(!nt.unlockScenario||nt.unlockScenario.edition!=l.edition||nt.unlockScenario.name!=l.index)&&this.game.party.unlockedItems.push(new O.VP(nt.id+"",nt.edition))}}),U.itemBlueprints&&U.itemBlueprints.forEach(z=>{if(z.includes("-")){const W=+z.split("-")[0],nt=+z.split("-")[1];for(let gt=W;gt<=nt;gt++)this.game.party.unlockedItems.push(new O.VP(gt+"",l.edition))}else{let W=l.edition;z.includes(":")&&(W=z.split(":")[1]),this.game.party.unlockedItems.push(new O.VP(z,W))}}),U.calendarSection&&U.calendarSection.forEach(z=>{if(z.split("-").length>1){const W=z.split("-")[0];let nt=-1;if(isNaN(+z.split("-")[1])){if(z.split("-")[1].length>1){const gt=z.split("-")[1].split(":")[0],ht=+z.split("-")[1].split(":")[1];nt=Math.max(C.game.party.weeks,0)-Math.max(C.game.party.weeks,0)%20+("summer"==gt?20:10)+ht}}else nt=C.game.party.weeks+ +z.split("-")[1];-1!=nt&&(C.game.party.weekSections[nt]=[...C.game.party.weekSections[nt]||[],W])}}),U.pet&&null==C.game.party.pets.find(z=>z.edition==l.edition&&z.name==U.pet)&&C.game.party.pets.push(new Ve.j(U.pet,l.edition)),U.events&&w.f.settings.events&&U.events.forEach(z=>{z.split(":").length>1&&C.eventCardManager.addEvent(z.split(":")[0],z.split(":")[1],!0)})),w.f.settings.automaticUnlocking&&U.unlockCharacter&&!this.game.unlockedCharacters.includes(l.edition+":"+U.unlockCharacter)&&this.game.unlockedCharacters.push(l.edition+":"+U.unlockCharacter),U.lootDeckCards&&U.lootDeckCards.forEach(z=>{const W=pt.Di.find(nt=>nt.cardId==z);W&&(W.type!=pt.r6.special1&&W.type!=pt.r6.special2||!C.game.lootDeckFixed.includes(W.type))&&C.game.lootDeckFixed.push(W.type)})),C.characterManager.characterCount()<4&&!Y&&(!l.solo||l.spotlight)&&j&&(!U||!U.ignoredBonus||!U.ignoredBonus.includes("inspiration"))&&(this.game.party.inspiration+=4-C.characterManager.characterCount()),h&&!h.repeatable&&!this.game.party.conclusions.find(z=>z.index==h.index&&z.edition==h.edition&&z.group==h.group)&&this.game.party.conclusions.push(new Rt.Ag(h.index,h.edition,h.group)),C.game.party.campaignMode&&j)){l.conclusion?!l.repeatable&&!this.game.party.conclusions.find(W=>W.index==l.index&&W.edition==l.edition&&W.group==l.group)&&this.game.party.conclusions.push(new Rt.Ag(l.index,l.edition,l.group)):!l.hideIndex&&(!U||!U.repeatScenario)&&this.game.party.scenarios.push(new Rt.Ag(l.index,l.edition,l.group,l.custom,l.custom?l.name:"",l.revealedRooms)),C.imbuementManager.imbuement&&(this.game.party.imbuement+="advanced"==C.imbuementManager.imbuement?2:1);const z=C.campaignData();if(U&&w.f.settings.partySheet&&U.townGuardAm&&U.townGuardAm.length>0&&z.townGuardPerks){const W=C.attackModifierManager.buildTownGuardAttackModifierDeck(this.game.party,z);C.attackModifierManager.shuffleModifiers(W),W.active=!1,this.game.party.townGuardDeck=W.toModel()}}if(_)C.scenarioManager.setScenario(l,!0);else{if(l&&!l.conclusion&&(!U||!U.calendarIgnore)&&C.fhRules()&&!f&&w.f.settings.automaticPassTime&&!l.solo&&w.f.settings.partySheet&&!Y&&j){this.game.party.weeks++,C.buildingsManager.nextWeek();const z=C.editionData.find(nt=>nt.edition==l.edition);let W=[];z&&z.campaign&&W.push(...z.campaign.weeks&&z.campaign.weeks[this.game.party.weeks]||[]),W.push(...this.game.party.weekSections[this.game.party.weeks]||[]),W.forEach(nt=>{const gt=C.sectionData(l.edition).find(ht=>ht.index==nt&&ht.group==l.group&&ht.conclusion);if(gt){const ht=new Rt.Nz(gt);this.finishScenario(ht,!0,ht,!1,void 0,!1,j,!0)}})}d&&!l.hideIndex&&(!C.game.party.campaignMode||!j&&!h)&&this.game.party.casualScenarios.push(new Rt.Ag(l.index,l.edition,l.group,l.custom,l.custom?l.name:"",l.revealedRooms)),Y||(this.game.scenario=void 0,this.game.sections=[],C.roundManager.resetScenario())}}}addSection(l){this.game.sections.some(d=>d.edition==l.edition&&d.index==l.index&&d.group==l.group)||(this.applyScenarioData(l,!0),w.f.settings.scenarioRules&&l.rules&&(l.rules.forEach((d,h)=>{d.always&&C.scenarioRulesManager.addScenarioRule(l,d,h,!0)}),C.scenarioRulesManager.filterDisabledScenarioRules()),this.game.sections.push(new Rt.Nz(l,[])),C.stateManager.standeeDialogCanceled=!1)}applyScenarioData(l,d=!1,h=!1){if(C.stateManager.standeeDialogCanceled=!0,w.f.settings.scenarioRooms&&l.rooms&&0!=l.rooms.length){if(l.rooms.filter(_=>_.initial).forEach(_=>{this.openRoom(_,l,d)}),l.monsters){let _=C.game.figures.filter(f=>f instanceof R.R).map(f=>f);l.monsters.forEach(f=>{const P=f.split(":")[0],j=C.monstersData(l.edition).find(Y=>Y.name==P);j&&!_.find(Y=>Y.name==j.name)&&_.push(new R.R(j))}),l.monsters.forEach(f=>{const P=f.split(":")[0],j=w.f.settings.automaticStandees&&l.rooms&&l.rooms.some(W=>W.monster&&W.monster.some(nt=>nt.name.split(":")[0]==P)),Y=C.monsterManager.getSpawnMonsters(_),U=w.f.settings.interactiveAbilities&&Y.find(W=>W.name==P),z=w.f.settings.scenarioRules&&this.getRuleMonster(new Rt.Nz(l)).find(W=>W.name==P);if(!j&&!U&&!z){let W=C.monsterManager.addMonsterByName(f,l.edition);W&&(W.isAlly=l.allies&&l.allies.includes(P)||d&&C.game.scenario&&C.game.scenario.allies&&C.game.scenario.allies.includes(P)||!1,W.isAllied=l.allied&&l.allied.includes(P)||d&&C.game.scenario&&C.game.scenario.allied&&C.game.scenario.allied.includes(P)||!1,W.drawExtra=l.drawExtra&&l.drawExtra.includes(P)||d&&C.game.scenario&&C.game.scenario.drawExtra&&C.game.scenario.drawExtra.includes(P)||!1)}})}}else l.monsters&&l.monsters.forEach(_=>{const f=_.split(":")[0];let P=C.monsterManager.addMonsterByName(_,l.edition);P&&(P.isAlly=l.allies&&l.allies.includes(f)||d&&C.game.scenario&&C.game.scenario.allies&&C.game.scenario.allies.includes(f)||!1,P.isAllied=l.allied&&l.allied.includes(f)||d&&C.game.scenario&&C.game.scenario.allied&&C.game.scenario.allied.includes(f)||!1,P.drawExtra=l.drawExtra&&l.drawExtra.includes(f)||d&&C.game.scenario&&C.game.scenario.drawExtra&&C.game.scenario.drawExtra.includes(f)||!1)}),l.objectives&&l.objectives.forEach((_,f)=>{const j=C.objectiveManager.addObjective(_,void 0,{edition:l.edition,scenario:l.index,group:l.group,section:d,index:f});C.objectiveManager.addObjectiveEntity(j)});if(w.f.settings.addAllMonsters&&this.getMonsters(new Rt.Nz(l),!0).forEach(_=>{this.game.figures.find(f=>f instanceof A.f&&f.name==_.name&&f.edition==_.edition)||C.monsterManager.addMonster(_,this.game.level)}),l.solo&&(l.spotlight||C.game.figures.forEach(_=>{_ instanceof c.K&&(_.absent=_.name!=l.solo||_.edition!=l.edition)}),!C.game.figures.some(_=>_ instanceof c.K&&_.name==l.solo&&_.edition==l.edition))){const _=C.charactersData().find(f=>f.name==l.solo&&f.edition==l.edition);_?C.characterManager.addCharacter(_,5):console.error("Solo Scenario Character not found: '"+l.solo+"' ("+l.name+")")}if(l.lootDeckConfig){let _=JSON.parse(JSON.stringify(l.lootDeckConfig));this.game.lootDeckFixed.forEach(f=>{_[f]=1}),C.lootManager.apply(this.game.lootDeck,_)}if(l.resetRound){const _=l.resetRound.endsWith("Keep")&&(this.game.state==E.mk.next&&this.game.round%2==0||this.game.state==E.mk.draw&&this.game.round%2==1)?1:0;"visible"==l.resetRound||"visibleKeep"==l.resetRound?this.game.roundResets.push(this.game.round+(this.game.state==E.mk.draw?0:-1)-_):this.game.roundResetsHidden.push(this.game.round+(this.game.state==E.mk.draw?0:-1)-_),this.game.round=(this.game.state==E.mk.draw?0:1)+_}if(C.bbRules()&&l.level&&C.game.figures.forEach(_=>{_ instanceof c.K&&l.level&&C.characterManager.setLevel(_,l.level)}),w.f.settings.partySheet&&w.f.settings.events&&l.eventType&&!h){let _=l.eventType;"fh"==l.edition&&("road"==_||"outpost"==_)&&(_=(Math.max(C.game.party.weeks,0)%20<10?"summer-":"winter-")+_),C.game.eventDraw=_}w.f.settings.partySheet&&w.f.settings.events&&w.f.settings.eventsApply&&C.game.party.eventCards&&C.game.party.eventCards.filter(_=>_.scenarioApply).forEach(_=>{const f=C.eventCardManager.getEventCardForEdition(_.edition,_.type,_.cardId);if(f&&-1!=_.selected){const P=f.options[_.selected];if(P&&P.outcomes&&P.outcomes.forEach((j,Y)=>{j.effects&&(!_.subSelections||0==_.subSelections.length||_.subSelections.includes(Y))&&C.eventCardManager.applyEffects(f,j.effects.filter(U=>"string"!=typeof U),_.checks,!0)}),_.attack){const j=f.options.find(Y=>!!Y.outcomes&&Y.outcomes.some(U=>!!U.attack&&!!U.attack.effects));if(j){const Y=j.outcomes.find(U=>!!U.attack&&!!U.attack.effects);Y&&Y.attack&&C.eventCardManager.applyEffects(f,Y.attack.effects.filter(U=>"string"!=typeof U),_.checks,!0)}}}_.scenarioApply=!1}),w.f.settings.removeUnusedMonster&&this.game.figures.filter(_=>_ instanceof R.R&&_.off&&0==_.entities.length&&!_.tags.includes("addedManually")).forEach(_=>{C.monsterManager.removeMonster(_)})}openRoom(l,d,h){if(this.game.scenario&&(this.game.scenario.revealedRooms=this.game.scenario.revealedRooms||[],this.game.scenario.revealedRooms.push(l.roomNumber)),l.monster){let _=[];l.monster.forEach(f=>{let P=f.type;if(!P){const j=C.characterManager.characterCount();P=j<3?f.player2:3==j?f.player3:f.player4}!P&&!f.player2&&!f.player3&&!f.player4&&(P=K.N.normal),(P==K.N.boss||P==K.N.elite)&&_.push(...this.applyRoomSpawn(d,f,P,h))}),l.monster.forEach(f=>{let P=f.type;if(!P){const j=C.characterManager.characterCount();P=j<3?f.player2:3==j?f.player3:f.player4}!P&&!f.player2&&!f.player3&&!f.player4&&(P=K.N.normal),P==K.N.normal&&_.push(...this.applyRoomSpawn(d,f,P,h))}),this.game.state==E.mk.next&&this.game.figures.forEach(f=>{f instanceof R.R&&(f.edition==d.edition||C.editionExtensions(d.edition).includes(f.edition))&&f.entities.some(P=>_.includes(P))&&(f.active=f.active||!this.game.figures.some(P=>P.active),f.entities.forEach(P=>{_.includes(P)&&(P.active=f.active||C.game.figures.some((j,Y,U)=>j.active&&Y>U.indexOf(f)),P.revealed=!0)}))}),this.game.figures.find(f=>f instanceof c.K&&!f.absent&&"snowflake"==f.name&&f.tags.includes("muddle-monster"))&&this.game.figures.forEach(f=>{f instanceof R.R&&f.entities.forEach(P=>{_.includes(P)&&!C.entityManager.isImmune(P,f,G.r5.muddle)&&C.entityManager.addCondition(P,f,new G.kW(G.r5.muddle))})})}l.objectives&&l.objectives.forEach(_=>{if("number"==typeof _&&_>0){const f={edition:d.edition,scenario:d.index,group:d.group,section:h,index:_-1},P=C.objectiveManager.objectiveDataByObjectiveIdentifier(f);if(P){const j=C.objectiveManager.addObjective(P,void 0,f);C.objectiveManager.addObjectiveEntity(j)}}else if("string"==typeof _&&_.includes(":")){let f=_.split(":");const P=+f.splice(0,1),j=(0,t.hZ)(f.join(":"));if(P>0&&j>0){const Y={edition:d.edition,scenario:d.index,group:d.group,section:h,index:P-1},U=C.objectiveManager.objectiveDataByObjectiveIdentifier(Y);if(U){const z=C.objectiveManager.addObjective(U,void 0,Y);for(let W=0;W<j;W++)C.objectiveManager.addObjectiveEntity(z)}}}else if("string"==typeof _&&_.includes("-")){let f=_.split("-");const P=+f[0],j=f[1];if(P>0&&j){const Y={edition:d.edition,scenario:d.index,group:d.group,section:h,index:P-1},U=C.objectiveManager.objectiveDataByObjectiveIdentifier(Y);if(U){const z=C.objectiveManager.addObjective(U,void 0,Y);C.objectiveManager.addObjectiveEntity(z,void 0,void 0,j)}}}})}applyRoomSpawn(l,d,h,_){let f=[];const P=d.name.split(":")[0],j=l.allies&&l.allies.includes(P)||_&&C.game.scenario&&C.game.scenario.allies&&C.game.scenario.allies.includes(P)||!1,Y=l.allied&&l.allied.includes(P)||_&&C.game.scenario&&C.game.scenario.allied&&C.game.scenario.allied.includes(P)||!1,U=l.drawExtra&&l.drawExtra.includes(P)||_&&C.game.scenario&&C.game.scenario.drawExtra&&C.game.scenario.drawExtra.includes(P)||!1,z=C.monsterManager.addMonsterByName(d.name,l.edition);if(z&&(w.f.settings.standees||!z.entities.find(W=>W.type==h))){const W=C.monsterManager.spawnMonsterEntity(z,h,j,Y,U);W&&(d.marker&&(W.marker=d.marker),d.tags&&(W.tags=d.tags),d.health&&(W.health=(0,t.hZ)(d.health)),d.number&&(W.number=d.number),f.push(W),(W.marker||W.tags.length>0)&&C.addEntityCount(z,W))}return z&&z.bb&&(f.length&&f.every(W=>W.type==K.N.elite)&&!z.tags.includes("bb-elite")?z.tags.push("bb-elite"):z.tags=z.tags.filter(W=>"bb-elite"!=W)),f}scenarioData(l,d=!1){const h=C.editionData.filter(_=>w.f.settings.editions.includes(_.edition)).map(_=>_.scenarios).flat();return l?!d&&this.game.party.campaignMode&&h.some(_=>_.initial)?h.filter(_=>{if(_.edition!=l)return!1;if(this.isSuccess(_)||this.game.party.manualScenarios.find(j=>_.index==j.index&&_.edition==j.edition&&_.group==j.group))return!0;let f=!1,P=!_.requires||0==_.requires.length;return this.game.party.scenarios.forEach(j=>{const Y=h.find(U=>U.index==j.index&&U.edition==j.edition&&U.group==j.group);Y&&Y.edition==_.edition&&Y.group==_.group&&Y.unlocks&&Y.unlocks.includes(_.index)&&(f=!0)}),this.game.party.conclusions.forEach(j=>{const Y=C.sectionData(j.edition).find(U=>U.index==j.index&&U.edition==j.edition&&U.group==j.group);Y&&Y.edition==_.edition&&Y.group==_.group&&Y.unlocks&&Y.unlocks.includes(_.index)&&(f=!0)}),P||(P=_.requires.some(j=>j.every(Y=>{let U=this.game.party.scenarios.filter(z=>z.index==Y&&(z.edition==_.edition||C.editionExtensions(_.edition).includes(z.edition)));return U.length>1&&U.filter(z=>z.group==_.group),U.length>1&&U.filter(z=>z.edition==_.edition),U.length>0}))),(f||_.initial)&&P}):h.filter(_=>_.edition==l):h}isCurrent(l){return null!=C.game.scenario&&C.game.scenario.edition==l.edition&&C.game.scenario.index==l.index&&C.game.scenario.group==l.group&&C.game.scenario.solo==l.solo}isSuccess(l){return C.game.party.scenarios&&null!=C.game.party.scenarios.find(d=>d.edition==l.edition&&d.group==l.group&&d.index==l.index)}isBlocked(l){const d=this.game.party.scenarios.filter(_=>_.edition==l.edition&&_.group==l.group).map(_=>this.getScenario(_.index,_.edition,_.group)),h=this.game.party.conclusions.filter(_=>_.edition==l.edition&&_.group==l.group).map(_=>this.getSection(_.index,_.edition,_.group,!0));return d.some(_=>_&&_.blocks&&_.blocks.includes(l.index)&&this.isSuccess(_))||h.some(_=>_&&_.blocks&&_.blocks.includes(l.index))}isLocked(l){return this.game.party.campaignMode&&l.requirements&&l.requirements.length>0&&l.requirements.every(d=>d.global&&d.global.some(h=>{if(h.startsWith("!"))return this.game.party.globalAchievementsList.find(_=>_.toLowerCase().trim()==h.substring(1,h.length).toLowerCase().trim());if(h.includes(":")&&!isNaN(+h.split(":")[1])){let _=+h.split(":")[1];return this.game.party.globalAchievementsList.forEach(f=>{f.toLowerCase().trim()==h.split(":")[0].toLowerCase().trim()&&_--}),_>0}return!this.game.party.globalAchievementsList.find(_=>_.toLowerCase().trim()==h.toLowerCase().trim())})||d.party&&d.party.some(h=>{if(h.startsWith("!"))return this.game.party.achievementsList.find(_=>_.toLowerCase().trim()==h.substring(1,h.length).toLowerCase().trim());if(h.includes(":")&&!isNaN(+h.split(":")[1])){let _=+h.split(":")[1];return this.game.party.achievementsList.forEach(f=>{f.toLowerCase().trim()==h.split(":")[0].toLowerCase().trim()&&_--}),_>0}return!this.game.party.achievementsList.find(_=>_.toLowerCase().trim()==h.toLowerCase().trim())})||d.campaignSticker&&d.campaignSticker.some(h=>{if(h.startsWith("!"))return this.game.party.campaignStickers.find(_=>_.toLowerCase().replaceAll(" ","-").trim()==h.substring(1,h.length).toLowerCase().trim());if(h.includes(":")&&!isNaN(+h.split(":")[1])){let _=+h.split(":")[1];return this.game.party.campaignStickers.forEach(f=>{f.toLowerCase().replaceAll(" ","-").trim()==h.split(":")[0].toLowerCase().trim()&&_--}),_>0}return!this.game.party.campaignStickers.find(_=>_.toLowerCase().replaceAll(" ","-").trim()==h.toLowerCase().trim())})||d.buildings&&d.buildings.some(h=>{if(h.startsWith("!"))return this.game.party.buildings.find(_=>_.name.toLowerCase().trim()==h.substring(1,h.length).toLowerCase().trim()&&_.level>0);if(h.includes(":")&&!isNaN(+h.split(":")[1])){let _=+h.split(":")[1];return!this.game.party.buildings.find(f=>f.name.toLowerCase().trim()==h.substring(1,h.length).toLowerCase().trim()&&f.level>=_)}return!this.game.party.buildings.find(_=>_.name.toLowerCase().trim()==h.toLowerCase().trim()&&_.level>0)})||d.characters&&d.characters.some(h=>h.startsWith("!")?C.game.figures.find(_=>_ instanceof c.K&&_.name.toLowerCase().trim()==h.substring(1,h.length).toLowerCase().trim()):!C.game.figures.find(_=>_ instanceof c.K&&_.name.toLowerCase().trim()==h.toLowerCase().trim()))||d.scenarios&&d.scenarios.every(h=>h.some(_=>null==this.game.party.scenarios.find(f=>f.index==_&&f.edition==l.edition&&f.group==l.group))))||l.solo&&!this.game.figures.find(d=>d instanceof c.K&&d.name==l.solo&&(C.bbRules()||d.level>=5))||!1}getRequirements(l,d=!1){let h=[];return l.requirements&&l.requirements.forEach(_=>{let f=!1,P=new Rt.Pl;if(_.global&&_.global.forEach(j=>{if(j.startsWith("!"))j=j.substring(1,j.length),(d||C.game.party.globalAchievementsList.find(Y=>Y.toLowerCase().trim()==j.toLowerCase().trim()))&&(P.globalAchievementsMissing.push(j),f=!0);else if(j.includes(":")&&!isNaN(+j.split(":")[1])){let Y=+j.split(":")[1];C.game.party.globalAchievementsList.forEach(U=>{U.toLowerCase().trim()==j.split(":")[0].toLowerCase().trim()&&Y--}),(d||Y>0)&&(P.globalAchievementsCount.push({name:j.split(":")[0],count:Y,required:+j.split(":")[1]}),f=!0)}else(d||!C.game.party.globalAchievementsList.find(Y=>Y.toLowerCase().trim()==j.toLowerCase().trim()))&&(P.globalAchievements.push(j),f=!0)}),_.party&&_.party.forEach(j=>{if(j.startsWith("!"))j=j.substring(1,j.length),(d||C.game.party.achievementsList.find(Y=>Y.toLowerCase().trim()==j.toLowerCase().trim()))&&(P.partyAchievementsMissing.push(j),f=!0);else if(j.includes(":")&&!isNaN(+j.split(":")[1])){let Y=+j.split(":")[1];C.game.party.achievementsList.forEach(U=>{U.toLowerCase().trim()==j.split(":")[0].toLowerCase().trim()&&Y--}),Y>0&&(P.partyAchievementsCount.push({name:j.split(":")[0],count:Y,required:+j.split(":")[1]}),f=!0)}else(d||!C.game.party.achievementsList.find(Y=>Y.toLowerCase().trim()==j.toLowerCase().trim()))&&(P.partyAchievements.push(j),f=!0)}),_.campaignSticker&&_.campaignSticker.forEach(j=>{if(j.startsWith("!"))j=j.substring(1,j.length),(d||C.game.party.campaignStickers.find(Y=>Y.toLowerCase().trim()==j.toLowerCase().trim()))&&(P.campaignStickersMissing.push(j),f=!0);else if(j.includes(":")&&!isNaN(+j.split(":")[1])){let Y=+j.split(":")[1];C.game.party.campaignStickers.forEach(U=>{U.toLowerCase().trim()==j.split(":")[0].toLowerCase().trim()&&Y--}),Y>0&&(P.campaignStickersCount.push({name:j.split(":")[0],count:Y,required:+j.split(":")[1]}),f=!0)}else(d||!C.game.party.campaignStickers.find(Y=>Y.toLowerCase().trim()==j.toLowerCase().trim()))&&(P.campaignStickers.push(j),f=!0)}),_.buildings&&_.buildings.forEach(j=>{if(j.startsWith("!"))if((j=j.substring(1,j.length)).includes(":")){let Y=+j.split(":")[1];(d||C.game.party.buildings.find(U=>U.name.toLowerCase().trim()==j.split(":")[0].toLowerCase().trim()&&U.level>=Y))&&(P.buildingsLevel.push({name:j.split(":")[0],level:Y}),f=!0)}else(d||C.game.party.buildings.find(Y=>Y.name.toLowerCase().trim()==j.toLowerCase().trim()&&Y.level>0))&&(P.buildingsMissing.push(j),f=!0);else if(j.includes(":")){let Y=+j.split(":")[1];(d||!C.game.party.buildings.find(U=>U.name.toLowerCase().trim()==j.split(":")[0].toLowerCase().trim()&&U.level>=Y))&&(P.buildingsLevel.push({name:j.split(":")[0],level:Y}),f=!0)}else(d||!C.game.party.buildings.find(Y=>Y.name.toLowerCase().trim()==j.toLowerCase().trim()&&Y.level>0))&&(P.buildings.push(j),f=!0)}),_.characters&&_.characters.forEach(j=>{j.startsWith("!")?(j=j.substring(1,j.length),(d||C.game.figures.find(Y=>Y instanceof c.K&&Y.name.toLowerCase().trim()==j.toLowerCase().trim()))&&(P.charactersMissing.push(j),f=!0)):(d||!C.game.figures.find(Y=>Y instanceof c.K&&Y.name.toLowerCase().trim()==j.toLowerCase().trim()))&&(P.characters.push(j),f=!0)}),_.scenarios&&_.scenarios.length){let j=[];_.scenarios.forEach((Y,U)=>{Y.forEach(z=>{(null==this.game.party.scenarios.find(W=>W.index==z&&W.edition==l.edition&&W.group==l.group)||d)&&(j[U]=j[U]||[],j[U].push(z))})}),(d||j.length==l.requires.length&&j.every(Y=>Y.length))&&(P.scenarios=j,f=!0)}f&&h.push(P)}),h}getSections(l){return C.sectionData().filter(d=>d.edition==l.edition&&d.parent==l.index&&d.group==l.group)}availableSections(l=!1,d=!1){if(!this.game.scenario)return[];const h=this.getSections(this.game.scenario).filter(f=>(!f.conclusion||l)&&(d||!this.game.sections.find(P=>P.edition==f.edition&&P.index==f.index&&P.parent==f.parent))&&(!f.parentSections||f.parentSections.some(P=>P.every(j=>this.game.sections.find(Y=>Y.index==j))))&&!this.game.sections.find(P=>P.edition==f.edition&&f.blockedSections&&f.blockedSections.includes(P.index))).sort(this.sortScenarios);return[...this.game.scenario.additionalSections.map(f=>this.game.scenario&&C.sectionData(this.game.scenario.edition,!0).find(P=>"randomMonsterCard"==P.group&&P.index==f)).filter(f=>f&&!this.game.sections.find(P=>P.edition==f.edition&&P.index==f.index)).map(f=>f),...h]}getTreasures(l,d,h=!1,_=!1){let f=[];return l.rooms&&(_?l.rooms.forEach(P=>{P.treasures&&f.push(...P.treasures)}):l.revealedRooms&&l.revealedRooms.forEach(P=>{const j=l.rooms.find(Y=>Y.roomNumber==P);j&&j.treasures&&f.push(...j.treasures)})),d.forEach(P=>{P.rooms&&(_?P.rooms.forEach(j=>{j.treasures&&f.push(...j.treasures)}):P.revealedRooms&&P.revealedRooms.forEach(j=>{const Y=P.rooms.find(U=>U.roomNumber==j);Y&&Y.treasures&&f.push(...Y.treasures)}))}),f=f.filter((P,j)=>!h||!C.game.figures.some(Y=>Y instanceof c.K&&C.lootManager.hasTreasure(Y,P,j))),h&&(f=f.filter(P=>!C.game.party.treasures.find(j=>j.name==""+P&&j.edition==l.edition))),f}getAllTreasures(l){let d=[];return l.rooms&&l.rooms.forEach(h=>{h.treasures&&d.push(...h.treasures)}),this.getSections(l).forEach(h=>{h.rooms&&h.rooms.forEach(_=>{_.treasures&&d.push(..._.treasures)})}),d}treasureRewardsFromString(l){return l.split(":").length<2?[]:l.split(":").slice(1).join(":").split("|").map(d=>d.split("+"))}getMonsters(l,d=!1,h=!1){let _=[];return h?_.push(...C.game.figures.filter(f=>f instanceof R.R).map(f=>new A.f(f))):(_.push(...this.getScenarioMonster(l,d)),_.push(...this.getRuleMonster(l,d))),_.push(...C.monsterManager.getSpawnMonsters(_)),_}getScenarioMonster(l,d=!1){let h=[];h.push(l),h.push(...C.sectionData(l.edition).filter(f=>f.group==l.group&&f.parent==l.index&&(d||null!=this.game.sections.find(P=>P.edition==f.edition&&P.group==f.group&&P.index==f.index)))),l.additionalSections&&h.push(...C.sectionData(l.edition,!0).filter(f=>l.additionalSections.includes(f.index)&&(d||null!=this.game.sections.find(P=>P.edition==f.edition&&P.group==f.group&&P.index==f.index))));let _=[];return h.forEach(f=>{f.monsters&&f.monsters.forEach(P=>{const j=C.monstersData().find(Y=>Y.name==P.split(":")[0]&&(Y.edition==f.edition||C.editionExtensions(f.edition).includes(Y.edition)));j&&!_.includes(j)&&_.push(j)})}),_}getRuleMonster(l,d=!1){let h=[];h.push(l),d&&(h.push(...C.sectionData(l.edition).filter(f=>f.group==l.group&&f.parent==l.index)),l.additionalSections&&h.push(...C.sectionData(l.edition,!0).filter(f=>l.additionalSections.includes(f.index))));let _=[];return h.forEach(f=>{f.rules&&f.rules.forEach(P=>{P.spawns&&P.spawns.forEach(j=>{const Y=C.monstersData().find(U=>U.name==j.monster.name.split(":")[0]&&(U.edition==f.edition||C.editionExtensions(f.edition).includes(U.edition)));Y&&!_.includes(Y)&&_.push(Y)})})}),_}sortScenarios(l,d){if(l.conclusion!=d.conclusion)return l.conclusion?1:-1;if(!isNaN(+l.index)&&!isNaN(+d.index))return+l.index-+d.index;const h=l.index.match(/(\d+)/),_=d.index.match(/(\d+)/);return h&&_?+h[0]-+_[0]:l.index.toLowerCase()<d.index.toLowerCase()?-1:1}openRooms(l=!1){return this.game.scenario&&this.game.scenario.rooms?this.game.scenario.rooms.filter(d=>this.game.scenario&&this.game.scenario.revealedRooms.includes(d.roomNumber)&&(l||!d.initial)):[]}closedRooms(){return this.game.scenario&&this.game.scenario.rooms?this.game.scenario.rooms.filter(l=>this.game.scenario&&!this.game.scenario.revealedRooms.includes(l.roomNumber)&&this.openRooms(!0).some(d=>d.rooms&&d.rooms.includes(l.roomNumber))):[]}drawRandomScenario(l){let h,d=C.scenarioData(l).filter(_=>_.random&&!C.game.party.manualScenarios.find(f=>f.index==_.index&&f.edition==_.edition&&f.group==_.group&&!f.custom)&&!this.isSuccess(_));return d.length>0&&(h=d[Math.floor(Math.random()*d.length)]),h}drawRandomScenarioSection(l){let h,d=C.sectionData(l).filter(_=>_.conclusion&&_.random&&!C.game.party.conclusions.find(f=>f.index==_.index&&f.edition==_.edition&&f.group==_.group&&!f.custom)&&!C.game.party.scenarios.find(f=>f.index==_.index&&f.edition==_.edition&&f.group==_.group&&!f.custom));return d.length>0&&(h=d[Math.floor(Math.random()*d.length)]),h}scenarioUndoArgs(l=void 0){return(l=l||C.game.scenario)?[l.index,this.scenarioTitle(l),l.custom?"scenario.custom":"data.edition."+l.edition]:["","",""]}scenarioTitle(l,d=!1){return l?"data."+(d?"section.title.":"scenario.title.")+l.edition+"."+(l.group?l.group+"-":"")+l.index.replaceAll(".","-"):d?"section":"scenario"}scenarioDataForModel(l){if(l.isCustom){const h=new F.tB;return h.name=l.custom,h}const d=C.scenarioData().find(h=>h.index==l.index&&h.edition==l.edition&&h.group==l.group);if(d)return JSON.parse(JSON.stringify(d));console.warn("Invalid scenario data:",l)}sectionDataForModel(l){const d=C.sectionData().find(h=>h.index==l.index&&h.edition==l.edition&&h.group==l.group);if(d)return JSON.parse(JSON.stringify(d));console.warn("Invalid section data:",l)}toModel(l,d,h,_=!1,f=""){return new Rt.Ag(l.index,l.edition,l.group,_,f,JSON.parse(JSON.stringify(d)),JSON.parse(JSON.stringify(h)))}}var Xe=v(740);class le{game;constructor(l){this.game=l}applyDamage(l,d,h){const _=this.game.figures.find(f=>f.active);if(d instanceof c.K)l instanceof c.K?(_&&_ instanceof R.R?l.scenarioStats.monsterDamage+=h:l.scenarioStats.otherDamage+=h,l.exhausted&&(l.scenarioStats.exhausts+=1),l.scenarioStats.maxDamage=Math.max(l.scenarioStats.maxDamage,h)):l instanceof I.up&&(_&&_ instanceof R.R?d.scenarioStats.summons.monsterDamage+=h:d.scenarioStats.summons.otherDamage+=h,l.dead&&(d.scenarioStats.summons.exhausts+=1),d.scenarioStats.summons.maxDamage=Math.max(d.scenarioStats.summons.maxDamage,h));else if(_ instanceof c.K)if(_.summons.find(f=>f.active)){if(_.scenarioStats.summons.dealtDamage+=h,_.scenarioStats.summons.maxDealtDamage=Math.max(_.scenarioStats.summons.maxDealtDamage,h),l instanceof T.I&&l.dead)switch(l.type){case K.N.normal:_.scenarioStats.summons.normalKills+=1;break;case K.N.elite:_.scenarioStats.summons.eliteKills+=1;break;case K.N.boss:_.scenarioStats.summons.bossKills+=1}}else if(_.scenarioStats.dealtDamage+=h,_.scenarioStats.maxDealtDamage=Math.max(_.scenarioStats.maxDealtDamage,h),l instanceof T.I&&l.dead)switch(l.type){case K.N.normal:_.scenarioStats.normalKills+=1;break;case K.N.elite:_.scenarioStats.eliteKills+=1;break;case K.N.boss:_.scenarioStats.bossKills+=1}}applyHeal(l,d,h){const _=this.game.figures.find(f=>f.active);d instanceof c.K&&_ instanceof c.K&&(l instanceof c.K?l.scenarioStats.healedDamage+=h:l instanceof I.up&&(d.scenarioStats.summons.healedDamage+=h),_.summons.find(f=>f.active)?_.scenarioStats.summons.heals+=h:_.scenarioStats.heals+=h)}killMonsterEntity(l){const d=this.game.figures.find(h=>h.active);if(d instanceof c.K)if(d.summons.find(h=>h.active)){if(l instanceof T.I&&l.dead)switch(l.type){case K.N.normal:d.scenarioStats.summons.normalKills+=1;break;case K.N.elite:d.scenarioStats.summons.eliteKills+=1;break;case K.N.boss:d.scenarioStats.summons.bossKills+=1}}else if(l instanceof T.I&&l.dead)switch(l.type){case K.N.normal:d.scenarioStats.normalKills+=1;break;case K.N.elite:d.scenarioStats.eliteKills+=1;break;case K.N.boss:d.scenarioStats.bossKills+=1}}applyScenarioStats(l,d,h){l.scenarioStats.scenario=new Rt.Ag(d.index,d.edition,d.group),l.scenarioStats.success=h,l.scenarioStats.level=l.level,l.scenarioStats.difficulty=this.game.level,l.scenarioStats.gold=l.loot,l.scenarioStats.xp=l.experience,l.scenarioStats.treasures=l.treasures.length,l.lootCards&&l.lootCards.forEach(_=>{const f=this.game.lootDeck.cards[_];if(f){let P=f.type;(P==pt.r6.special1||P==pt.r6.special2)&&(P=pt.r6.money),l.scenarioStats.loot[P]=C.lootManager.getValue(f)}})}}var xn=v(9204);class En{parameters;constructor(...l){this.parameters=l}checkParameters(){for(let l=0;l<this.requiredParameters;l++)if(null==this.parameters[l])throw new he(l);if(!this.validParameters(...this.parameters))throw new _e(this.parameters)}execute(){this.checkParameters(),this.executeWithParameters(...this.parameters)}executionError(l){throw new de(this.id,this.parameters,l)}before(){return["command."+this.id,...this.parameters]}toString(){return JSON.stringify([this.id,...this.parameters])}fromString(l){const d=JSON.parse(l);this.id=d[0],this.parameters=d.slice(1)}}class ge extends Error{id;constructor(l,d,h){super(d,h),this.id=l}}class de extends Error{id;parameters;constructor(l,d,h,_){super(h,_),this.id=l,this.parameters=d}}class he extends Error{parameter;constructor(l,d,h){super(d,h),this.parameter=l}}class _e extends Error{parameters;constructor(l,d,h){super(d,h),this.parameters=l}}class pn extends En{id="attackModifierDeck.draw";requiredParameters=1;validParameters(l,d){return!("m"!=l&&"a"!=l&&null==C.game.figures.find(h=>h instanceof c.K&&h.number==l)||d&&"advantage"!=d&&"disadvantage"!=d)}executeWithParameters(l,d){let h;switch(C.game.state!=E.mk.next&&this.executionError("invalid game state"),l){case"m":h=C.game.monsterAttackModifierDeck;break;case"a":h=C.game.allyAttackModifierDeck;break;default:const _=C.game.figures.find(f=>f instanceof c.K&&f.number==l);_&&(h=_.attackModifierDeck)}h?C.attackModifierManager.drawModifier(h,"advantage"==d||"disadvantage"==d?d:void 0):this.executionError("deck not found")}}class Be extends En{id="character.add";requiredParameters=3;validParameters(l,d,h){return l&&d&&h&&h<10&&null!=C.charactersData(l).find(_=>_.name==d)||!1}executeWithParameters(l,d,h){const _=C.charactersData(l).find(f=>f.name==d);_?C.characterManager.addCharacter(_,h):this.executionError("character not found")}}class si extends En{id="character.initiative";requiredParameters=2;validParameters(l,d,h){return d>=0&&d<=99&&(!h||99==d)&&null!=C.game.figures.find(_=>_ instanceof c.K&&_.number==l)||!1}executeWithParameters(l,d,h){h&&99!=d&&this.executionError("invalid long rest");const _=C.game.figures.find(f=>f instanceof c.K&&f.number==l);_?(_.initiative=d,_.longRest=h):this.executionError("character not found")}before(){const l=C.game.figures.find(d=>d instanceof c.K&&d.number==this.parameters[0]);return l?["command."+this.id,C.characterManager.characterName(l,!0,!0,!1)]:["command.invalid."+this.id,...this.parameters]}}class ri extends En{id="figure.next";requiredParameters=0;validParameters(){return!0}executeWithParameters(l){C.game.state!=E.mk.next&&this.executionError("invalid game state");const d=C.game.figures.filter(_=>C.gameplayFigure(_));let h=d.find(_=>_.active);if(h){if(h&&l&&d.indexOf(h)>0)if(h instanceof c.K){const _=h.summons.filter(P=>C.entityManager.isAlive(P)&&P.state!=I.N5.new);let f=_.find(P=>P.active);(!f||f&&0==_.indexOf(f))&&(h.summons.forEach(P=>P.active=!1),h=d[d.indexOf(h)-1])}else h=d[d.indexOf(h)-1]}else h=l?d[d.length-1]:d.find(_=>!_.off);if(h)if(h instanceof c.K){const _=h.summons.find(P=>P.active),f=h.summons.filter(P=>P.tags.includes("cs-skull-spirit"));w.f.settings.activeSummons&&!_&&h.active&&f.length&&!f.find(P=>P.active)&&f.forEach(P=>P.tags.push("cs-skull-spirit-turn")),C.roundManager.toggleFigure(h)}else if(h instanceof R.R){let _=!0;const f=h.entities.filter(P=>C.entityManager.isAlive(P)&&P.summon!=I.N5.new);if(w.f.settings.activeStandees){let P=f.find(j=>j.active);!P&&f.length>0&&l&&h.active?(P=f[f.length-1],C.monsterManager.toggleActive(h,P),P.active=!0,_=!1):P&&!l&&(C.monsterManager.toggleActive(h,P),f.indexOf(P)<f.length-1&&(f[f.indexOf(P)+1].active=!0),_=!1)}_&&(l&&!h.active&&w.f.settings.activeStandees&&h.entities.forEach(P=>{C.entityManager.isAlive(P)&&(P.active=!0,P.off=!1)}),C.roundManager.toggleFigure(h))}else h instanceof B.$e&&C.roundManager.toggleFigure(h)}}class ci extends En{id="lootDeck.draw";requiredParameters=0;validParameters(){return!0}executeWithParameters(){C.game.state!=E.mk.next&&this.executionError("invalid game state");const l=C.game.figures.find(d=>d instanceof c.K&&d.active);C.lootManager.drawCard(C.game.lootDeck,l)}}class li extends En{id="round.state";requiredParameters=0;validParameters(){return!0}executeWithParameters(){C.roundManager.nextGameState()}before(){return["command."+this.id+(C.game.state==E.mk.next?".next":".draw")]}}const _a=new class gi{commandsMap={"attackModifierDeck.draw":pn,"character.add":Be,"character.initiative":si,"figure.next":ri,"lootDeck.draw":ci,"round.state":li};history=[];execute(l,...d){try{if(!this.commandsMap[l])throw new ge(l);const h=new this.commandsMap[l](...d);C.stateManager.before(...h.before());try{h.execute(),this.history.push(h),C.stateManager.after()}catch(_){if(C.stateManager.revertLastUndo(),_ instanceof de)console.error(_,_.id,_.parameters,_.message);else if(_ instanceof he)console.error("Missing Parameter",l,_.parameter);else{if(!(_ instanceof _e))throw _;console.error("Invalid Parameters",l,_.parameters)}}}catch(h){if(!(h instanceof ge))throw h;console.error("Unkown Command",l,h.message)}}};window.commandManager=_a;var Ye=v(3391),ma=v(706),Nt=v(6484);class di{game;permissions;ws;undos=[];redos=[];undoInfos=[];lastSaveTimestamp;hasUpdate=!1;installPrompt=null;lastAction="update";updateBlocked=!1;serverError="";errorLog=[];backupError;permissionBackup;connectionTries=0;gameOffsetWarning=!0;standeeDialogCanceled=!1;keyboardSelecting=!1;keyboardSelect=-1;undoPermission=!1;redoPermission=!1;characterPermissions={};monsterPermissions={};wakeLock=null;scenarioSummary=!1;serverVersion="";storageBlocked=!1;autoBackupTimeout=null;ready=!1;constructor(l){this.game=l,this.lastSaveTimestamp=(new Date).getTime()}init(){var l=this;return(0,xn.A)(function*(d=!1){try{const _=yield Nt.n.readGameModel();_.server=!1,l.game.fromModel(_)}catch{d||Nt.n.writeGameModel(l.game.toModel())}l.updateBlocked=!1,w.f.settings.serverUrl&&w.f.settings.serverPort&&w.f.settings.serverCode&&(w.f.settings.serverAutoconnect?l.connect():(C.stateManager.updateBlocked=!0,C.stateManager.permissions=new Ye.x,l.updatePermissions())),yield l.loadStorage();const h=l.undos.length+l.redos.length-l.undoInfos.length;for(let _=0;_<h;_++)l.undoInfos.unshift([]);C.uiChange.subscribe({next:()=>{(!w.f.settings.serverUrl||!w.f.settings.serverPort||!w.f.settings.serverCode)&&(l.permissions=void 0,l.updateBlocked=!1),l.updatePermissions()}}),l.ready=!0,C.uiChange.next(!1)}).apply(this,arguments)}install(){var l=this;return(0,xn.A)(function*(){l.installPrompt&&(l.installPrompt.prompt(),yield C.stateManager.installPrompt.userChoice,l.installPrompt=null)})()}loadStorage(){var l=this;return(0,xn.A)(function*(){try{l.undos=yield Nt.n.readAll("undo"),l.redos=yield Nt.n.readAll("redo"),l.undoInfos=yield Nt.n.readAll("undo-infos"),l.updatePermissions()}catch{l.updatePermissions()}})()}saveStorage(){var l=this;return(0,xn.A)(function*(){if(!l.storageBlocked){l.storageBlocked=!0;try{yield Nt.n.writeArray("undo",l.undos),yield Nt.n.writeArray("redo",l.redos),yield Nt.n.writeArray("undo-infos",l.undoInfos)}catch(d){throw console.error("Failed to save undo/redo storage:",d),d}finally{l.storageBlocked=!1}}})()}buildWsUrl(l,d,h){let _=d.split("/");const f=_[0];let P="";return _.length>1&&(P="/"+_.splice(1,_.length+1).join("/")),P=l+f+":"+h+P,P}connect(){if(w.f.settings.serverUrl&&w.f.settings.serverPort&&w.f.settings.serverCode){this.disconnect(),this.connectionTries++;const d=this.buildWsUrl(w.f.settings.serverWss?"wss://":"ws://",w.f.settings.serverUrl,w.f.settings.serverPort);w.f.settings.logServerMessages&&console.debug("WS preparing "+d),this.ws=new WebSocket(d),this.ws.onmessage=this.onMessage,this.ws.onopen=this.onOpen,this.ws.onclose=this.onClose,this.ws.onerror=this.onError}}disconnect(){this.permissions=void 0,this.updatePermissions(),this.ws&&this.ws.readyState!=WebSocket.CLOSED&&(w.f.settings.logServerMessages&&console.debug("WS closing"),this.ws.close())}onMessage(l){try{const d=JSON.parse(l.data);switch(C.stateManager.updateBlocked=!1,d.serverVersion&&(C.stateManager.serverVersion=d.serverVersion),w.f.settings.logServerMessages&&console.debug("WS received "+d.type,l),d.type){case"game":window.document.body.classList.add("working"),window.document.body.classList.add("server-sync");let h=d.payload;C.game.revision>h.revision&&(C.stateManager.before(),Nt.n.addBackup(C.game.toModel()),console.warn("An older revision was loaded from server, created a backup of previous state."),C.stateManager.saveLocal(),C.stateManager.before("serverSyncEmpty"));const _=d.undoinfo;_&&(_.length>0&&"serverSync"==_[0]?C.stateManager.before("serverSync",..._.slice(1)):C.game.revision-(C.game.revisionOffset||0)<h.revision-(h.revisionOffset||0)&&C.stateManager.before("serverSync",..._)),C.game.fromModel(h,!0),C.stateManager.saveLocal(),C.uiChange.next(!0),setTimeout(()=>{window.document.body.classList.remove("working"),window.document.body.classList.remove("server-sync")},1),C.stateManager.serverError="";break;case"game-undo":window.document.body.classList.add("working"),window.document.body.classList.add("server-sync");let f=d.payload;if(null!=d.revision){const Y=d.revision||0;let U=0,z=C.stateManager.undos.splice(C.stateManager.undos.length-1,1)[0];for(z&&z.revision-(z.revisionOffset||0)>Y&&(C.stateManager.redos.push(z),U++);z&&z.revision-(z.revisionOffset||0)>Y;)z=C.stateManager.undos.splice(C.stateManager.undos.length-1,1)[0],z&&z.revision-(z.revisionOffset||0)>Y&&(C.stateManager.redos.push(z),U++);(!z||z.revision-(z.revisionOffset||0)!=Y)&&C.stateManager.undoInfos.splice(C.stateManager.undos.length-C.stateManager.redos.length,0,d.undoinfo?"serverSync"==d.undoinfo[0]?d.undoinfo:["serverSync",...d.undoinfo]:["serverSync"]),C.stateManager.redos.splice(C.stateManager.redos.length-U,0,C.game.toModel())}else{C.stateManager.redos.push(C.game.toModel());const Y=C.stateManager.undos[C.stateManager.undos.length-1];Y&&Y.revision-Y.revisionOffset==C.game.revision-C.game.revisionOffset-1?C.stateManager.undos.splice(C.stateManager.undos.length-1,1):C.stateManager.undoInfos.splice(C.stateManager.undoInfos.length-C.stateManager.redos.length,0,d.undoinfo?["serverSync",...d.undoinfo]:["serverSync"])}C.game.fromModel(f),C.stateManager.saveLocal(),C.stateManager.saveStorage(),C.uiChange.next(!0),setTimeout(()=>{window.document.body.classList.remove("working"),window.document.body.classList.remove("server-sync")},1),C.stateManager.serverError="";break;case"game-redo":window.document.body.classList.add("working"),window.document.body.classList.add("server-sync");let P=d.payload;if(null!=d.revision){const Y=d.revision||0;let U=0,z=C.stateManager.redos.splice(C.stateManager.redos.length-1,1)[0];for(z&&z.revision-(z.revisionOffset||0)<Y?(C.stateManager.undos.push(z),U++):z&&z.revision-(z.revisionOffset||0)>Y&&C.stateManager.redos.push(z);z&&z.revision-(z.revisionOffset||0)<Y;)z=C.stateManager.redos.splice(C.stateManager.redos.length-1,1)[0],z&&z.revision-(z.revisionOffset||0)<Y&&(C.stateManager.undos.push(z),U++);(!z||z.revision-(z.revisionOffset||0)!=Y)&&C.stateManager.undoInfos.splice(C.stateManager.undos.length+U,0,d.undoinfo?"serverSync"==d.undoinfo[0]?d.undoinfo:["serverSync",...d.undoinfo]:["serverSync"]),C.stateManager.undos.splice(C.stateManager.undos.length-U,0,C.game.toModel())}else{C.stateManager.undos.push(C.game.toModel());const Y=C.stateManager.redos.length>0?C.stateManager.redos[C.stateManager.redos.length-1]:void 0;Y&&Y.revision-Y.revisionOffset==C.game.revision-C.game.revisionOffset+1?C.stateManager.redos.splice(C.stateManager.redos.length-1,1):C.stateManager.undoInfos.splice(C.stateManager.undoInfos.length-C.stateManager.redos.length,0,d.undoinfo&&["serverSync",...d.undoinfo]||["serverSync"])}C.game.fromModel(P),C.stateManager.saveLocal(),C.stateManager.saveStorage(),C.uiChange.next(!0),setTimeout(()=>{window.document.body.classList.remove("working"),window.document.body.classList.remove("server-sync")},1),C.stateManager.serverError="";break;case"game-update":window.document.body.classList.add("working"),window.document.body.classList.add("server-sync");let j=d.payload;C.game.revision==j.revision&&(C.game.playSeconds=j.playSeconds,C.game.server=j.server,C.stateManager.saveLocal(),C.uiChange.next(!0),setTimeout(()=>{window.document.body.classList.remove("working"),window.document.body.classList.remove("server-sync")},1),C.stateManager.serverError="");break;case"requestUpdate":C.stateManager.after(1,!1,0,"game-update"),C.stateManager.serverError="";break;case"settings":if(window.document.body.classList.add("server-sync"),w.f.settings.serverSettings)if(d.payload){let Y=d.payload;ma.f.forEach(U=>{Y[U]=w.f.settings[U]}),Y.serverCode=w.f.settings.serverCode||w.f.settings.serverPassword,Y.serverPassword=void 0,w.f.setSettings(Object.assign(new ma.w,Y)),Nt.n.write("settings","default",w.f.settings)}else C.stateManager.saveSettings();setTimeout(()=>{window.document.body.classList.remove("server-sync")},1),C.stateManager.serverError="";break;case"permissions":C.stateManager.permissions=d.payload||void 0,C.stateManager.permissionBackup=C.stateManager.permissions&&JSON.parse(JSON.stringify(C.stateManager.permissions))||void 0,C.stateManager.updatePermissions(),C.stateManager.serverError="";break;case"ping":console.debug("Received ping answer...");break;case"remoteCommand":d.payload&&(C.game.server||d.payload.force)&&(console.debug("remoteCommand:",d.payload),_a.execute(d.payload.id,...d.payload.parameters||[]));break;case"error":if("No enum constant de.champonthis.ghs.server.socket.model.MessageType.PING"==d.message){console.debug("Received ping answer...");break}console.warn("[GHS] Error: ",d),(d.message.startsWith("Permission(s) missing")||d.message.startsWith("invalid revision"))&&("redo"==C.stateManager.lastAction||"update"==C.stateManager.lastAction?C.stateManager.undo(!1):"undo"==C.stateManager.lastAction&&C.stateManager.redo(!1)),d.message&&(d.message.startsWith("Invalid password")||d.message.startsWith("Invalid game code"))&&(console.warn("Disconnect..."),l.target?.close()),C.stateManager.serverError="string"==typeof d?d:JSON.stringify(d),window.document.body.classList.remove("working"),window.document.body.classList.remove("server-sync");break;default:C.uiChange.next(!1)}}catch(d){C.stateManager.errorLog.push(l.data),C.stateManager.serverError=l.data,console.error("[GHS] "+l.data,d),window.document.body.classList.remove("working"),window.document.body.classList.remove("server-sync")}}onOpen(l){w.f.settings.logServerMessages&&console.debug("WS opened",l);const d=l.target;if(d&&d.readyState==WebSocket.OPEN&&w.f.settings.serverCode){C.stateManager.connectionTries=0,C.stateManager.updateBlocked=!1,C.stateManager.permissions=C.stateManager.permissionBackup;let h={code:w.f.settings.serverCode,password:w.f.settings.serverCode,type:"request-game",payload:C.game.toModel()};if(w.f.settings.logServerMessages&&console.debug("WS sending request-game"),d.send(JSON.stringify(h)),w.f.settings.serverSettings){let _={code:w.f.settings.serverCode,password:w.f.settings.serverCode,type:"request-settings","allow-empty":!0};w.f.settings.logServerMessages&&console.debug("WS sending request-settings"),d.send(JSON.stringify(_))}C.stateManager.updatePermissions(),C.uiChange.next(!1)}}onClose(l){w.f.settings.logServerMessages&&console.debug("WS closed",l),C.game.server=!1,C.stateManager.updateBlocked=!0,C.stateManager.serverVersion="",C.stateManager.permissions=new Ye.x,C.stateManager.updatePermissions(),C.uiChange.next(!1)}onError(l){w.f.settings.logServerMessages&&console.debug("WS error",l),C.game.server=!1,C.stateManager.updateBlocked=!0,C.stateManager.serverVersion="",C.stateManager.permissions=new Ye.x,C.stateManager.updatePermissions(),C.uiChange.next(!1)}forceUpdateState(){C.stateManager.updateBlocked=!1,C.stateManager.permissions=C.stateManager.permissionBackup,C.stateManager.updatePermissions(),C.uiChange.next(!1)}requestSettings(){if(this.ws&&this.ws.readyState==WebSocket.OPEN&&w.f.settings.serverCode&&w.f.settings.serverSettings){let l={code:w.f.settings.serverCode,password:w.f.settings.serverCode,type:"request-settings","allow-empty":!0};w.f.settings.logServerMessages&&console.debug("WS sending request-settings"),this.ws.send(JSON.stringify(l))}}sendPing(){if(w.f.settings.serverUrl&&w.f.settings.serverPort&&w.f.settings.serverCode)if(this.ws&&this.ws.readyState==WebSocket.OPEN){let l={code:w.f.settings.serverCode,type:"ping"};w.f.settings.logServerMessages&&console.debug("WS sending ping"),this.ws.send(JSON.stringify(l))}else this.connect()}wsState(){return w.f.settings.serverUrl&&w.f.settings.serverPort&&w.f.settings.serverCode?this.ws&&this.ws.readyState||-1:-99}reset(){Nt.n.addBackup(C.game.toModel());const l=this.game.revision;this.game=new E.Zt,this.game.revision=l,Nt.n.clear("game"),Nt.n.clear("undo"),Nt.n.clear("redo"),Nt.n.clear("undo-infos")}saveLocal(){Nt.n.writeGameModel(this.game.toModel()),this.lastSaveTimestamp=(new Date).getTime()}saveSettings(){if(this.ws&&this.ws.readyState==WebSocket.OPEN&&w.f.settings.serverCode&&w.f.settings.serverSettings){let l={code:w.f.settings.serverCode,password:w.f.settings.serverCode,type:"settings",payload:w.f.settings};w.f.settings.logServerMessages&&console.debug("WS sending settings"),this.ws.send(JSON.stringify(l))}}updatePermissions(){this.undoPermission=this.hasUndo()&&(!this.permissions||!this.updateBlocked),this.redoPermission=this.hasRedo()&&(!this.permissions||!this.updateBlocked),this.characterPermissions={},C.game.figures.forEach(l=>{l instanceof c.K&&(this.characterPermissions[l.name+"|"+l.edition]=!this.permissions||this.permissions&&(this.permissions.characters||this.permissions.character.some(d=>d.name==l.name&&d.edition==l.edition)))}),C.game.party.retirements&&C.game.party.retirements.forEach(l=>{this.characterPermissions[l.name+"|"+l.edition]=!this.permissions||this.permissions&&(this.permissions.characters||this.permissions.character.some(d=>d.name==l.name&&d.edition==l.edition))}),this.monsterPermissions={},C.game.figures.forEach(l=>{l instanceof R.R&&(this.monsterPermissions[l.name+"|"+l.edition]=!this.permissions||this.permissions&&(this.permissions.monsters||this.permissions.monster.some(d=>d.name==l.name&&d.edition==l.edition)))})}before(...l){window.document.body.classList.add("working"),this.addToUndo(l&&l.map(d=>""+d)||[])}after(){var l=this;return(0,xn.A)(function*(d=1,h=!1,_=1,f="game",P=0,j=1){if(l.game.revision+=_,l.saveLocal(),l.ws&&l.ws.readyState==WebSocket.OPEN&&w.f.settings.serverCode){window.document.body.classList.add("server-sync");let Y=l.undoInfos[l.undos.length-1];"game-undo"==f&&(Y=l.undoInfos[l.undos.length+j-1]);let U={code:w.f.settings.serverCode,password:w.f.settings.serverCode,type:f,payload:l.game.toModel(),undoinfo:Y,revision:P,undolength:j};w.f.settings.logServerMessages&&console.debug("WS sending "+f),l.ws.send(JSON.stringify(U))}(h||w.f.settings.autoBackup>0&&(l.game.revision+l.game.revisionOffset)%w.f.settings.autoBackup==0)&&(yield l.autoBackup()),d&&w.f.settings.animations?setTimeout(()=>{l.lastAction="update",C.uiChange.next(!1),window.document.body.classList.remove("working"),window.document.body.classList.remove("server-sync")},d*w.f.settings.animationSpeed):(l.lastAction="update",C.uiChange.next(!1),window.document.body.classList.remove("working"),window.document.body.classList.remove("server-sync"))}).apply(this,arguments)}autoBackup(){var l=this;return(0,xn.A)(function*(d="",h=!1){if(!l.autoBackupTimeout)if(l.storageBlocked)l.autoBackupTimeout=setTimeout(()=>{l.autoBackupTimeout=null,l.autoBackup()},100);else{window.document.body.classList.add("working"),window.document.body.classList.add("server-sync");try{let _=yield Nt.n.datadump();if(d||(d="ghs-autobackup-"+(new Date).toISOString()+".json"),!h&&w.f.settings.autoBackupUrl&&w.f.settings.autoBackupUrl.url)try{l.backupError=void 0;let f=new XMLHttpRequest,P=w.f.settings.autoBackupUrl.url;P=P.replaceAll("{FILENAME}",d);const j=d.replace(/[\\/:*?"<>|]/g,"_");P=P.replaceAll("{WINDOWS_FILENAME}",j),f.open(w.f.settings.autoBackupUrl.method,P,!0,w.f.settings.autoBackupUrl.username,w.f.settings.autoBackupUrl.password);let Y=JSON.stringify(_);w.f.settings.autoBackupUrl.fileUpload?(Y=new FormData,Y.append(d,new File([JSON.stringify(_)],d,{type:"application/json"}))):f.setRequestHeader("Content-Type","application/json"),w.f.settings.autoBackupUrl.authorization&&f.setRequestHeader("Authorization",w.f.settings.autoBackupUrl.authorization),f.send(Y),f.addEventListener("error",U=>{l.backupError=-1,console.warn("Could not post autobackup",w.f.settings.autoBackupUrl,U)}),f.addEventListener("readystatechange",U=>{f.readyState===XMLHttpRequest.DONE&&f.status>=400&&(l.backupError=f.status,console.warn("Could not post autobackup",w.f.settings.autoBackupUrl,f.status,f.responseText))})}catch(f){l.backupError=-1,console.warn("Could not post autobackup",w.f.settings.autoBackupUrl,f)}else{let f=document.createElement("a");f.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(_))),f.setAttribute("download",d),document.body.appendChild(f),f.click(),document.body.removeChild(f)}}catch{console.warn("Could not create autobackup")}window.document.body.classList.remove("working"),window.document.body.classList.remove("server-sync")}}).apply(this,arguments)}addToUndo(l){if(this.game.toModel()!=this.undos[this.undos.length-1]){this.undos.push(this.game.toModel());const d=Nt.n.db?w.f.settings.maxUndo:Math.min(w.f.settings.maxUndo,50);this.undos.length>d&&this.undos.splice(0,this.undos.length-d),this.undoInfos.splice(this.undoInfos.length-this.redos.length,this.redos.length),this.undoInfos.push(l),this.undoInfos.length>this.undos.length&&this.undoInfos.splice(0,this.undoInfos.length-this.undos.length),this.redos.length>5&&Nt.n.addBackup(this.redos[0]),this.redos=[],this.saveStorage()}}revertLastUndo(){this.undos.splice(this.undos.length-1,1),this.undoInfos.splice(this.undoInfos.length-1,1),window.document.body.classList.remove("working"),window.document.body.classList.remove("server-sync"),this.saveStorage(),C.uiChange.next(!1)}hasUndo(){return this.undos.length>0}undo(l=!0){this.fixedUndo(1,l)}fixedUndo(l,d=!0){if(l>0&&l<=this.undos.length){window.document.body.classList.add("working"),this.redos.push(this.game.toModel());const h=C.game.revision,_=C.game.revisionOffset+l-1,f=this.undos.splice(this.undos.length-l,l);for(let j=f.length-1;j>0;j--)this.redos.push(f[j]);this.game.fromModel(f[0]),this.game.revision=h,this.game.revisionOffset=_+2,this.saveStorage(),d?this.after(1,!1,1,"game-undo",f[0].revision-(f[0].revisionOffset||0),l):C.uiChange.next(!1),this.lastAction="undo"}}hasRedo(){return this.redos.length>0}redo(l=!0){this.fixedRedo(1,l)}fixedRedo(l,d=!0){if(l>0&&l<=this.redos.length){window.document.body.classList.add("working"),this.undos.push(this.game.toModel());const h=C.game.revision,_=C.game.revisionOffset-l+1,f=this.redos.splice(this.redos.length-l,l);for(let j=f.length-1;j>0;j--)this.undos.push(f[j]);this.game.fromModel(f[0]),this.game.revision=h,this.game.revisionOffset=_,this.saveStorage(),d?this.after(1,!1,1,"game-redo",f[0].revision-(f[0].revisionOffset||0),l):C.uiChange.next(!1),this.lastAction="undo"}}clearUndos(){this.undoInfos.splice(0,this.undoInfos.length-this.redos.length),this.undos=[],this.saveStorage()}clearRedos(){this.undoInfos.splice(this.undos.length,this.undoInfos.length),this.redos=[],this.saveStorage()}savePermissions(l,d){if(this.ws&&this.ws.readyState==WebSocket.OPEN&&w.f.settings.serverCode){let h={code:w.f.settings.serverCode,password:w.f.settings.serverCode,type:"permissions",payload:{permissions:d,code:l,password:l}};w.f.settings.logServerMessages&&console.debug("WS sending permissions"),this.ws.send(JSON.stringify(h))}}}class hi{game;available=!1;trialsAvailable=!1;favorsAvailable=!1;trialsEnabled=!1;favorsEnabled=!1;apply=!1;constructor(l){this.game=l}update(){const l=C.fhRules()&&this.game.party.buildings.find(d=>"hall-of-revelry"==d.name&&d.level&&"wrecked"!=d.state);this.available=!1,this.trialsEnabled=!1,this.favorsEnabled=!1,C.fhRules()&&l&&(this.available=!0,this.trialsAvailable=1==l.level,this.favorsAvailable=2==l.level,w.f.settings.fhTrials&&(this.trialsEnabled=this.trialsAvailable,this.favorsEnabled=this.favorsAvailable,this.apply=w.f.settings.fhTrialsApply))}applyTrialCards(){if(this.trialsEnabled){const l=C.editionData.find(d=>d.edition==C.currentEdition()&&d.trials&&d.trials.length);this.game.party.trials=this.game.party.trials||-1,l&&this.game.figures.forEach(d=>{if(d instanceof c.K&&!d.progress.trial){let h=this.game.party.retirements.find(_=>_.number==d.number&&_.progress&&_.progress.trial);if(h&&h.progress&&h.progress.trial)d.progress.trial=h.progress.trial,h.progress.trial=void 0;else if(this.game.party.trials<l.trials.length-1){this.game.party.trials++;const _=l.trials[this.game.party.trials];d.progress.trial=new O.gw(""+_.cardId,_.edition)}}})}else C.fhRules()&&this.game.party.buildings.find(d=>"hall-of-revelry"==d.name&&1==d.level)||(this.game.party.trials=-1,this.game.figures.forEach(d=>{d instanceof c.K&&d.progress.trial&&(d.progress.trial=void 0)}))}activeTrial(l,d){return this.trialsEnabled&&null!=this.game.figures.find(h=>h instanceof c.K&&h.progress.trial&&h.progress.trial.edition==l&&h.progress.trial.name==""+d)}applyFavorPoints(){this.game.favorPoints.forEach(l=>{const d=this.game.monsterAttackModifierDeck.cards.find(h=>1==l?h.type==N.Yn.minus1:h.type==N.Yn.minus2);d&&this.game.monsterAttackModifierDeck.cards.splice(this.game.monsterAttackModifierDeck.cards.indexOf(d),1)})}activeFavor(l,d){return this.game.favors.filter(h=>h.edition==l&&h.name==d).length}cardIdSecondPrinting(l){return 708-l}}const C=new class _i{game=new E.Zt;editionData=[];editionMapping={};editionMappingAll={};editionScenarioMapping={};editionScenarioMappingAll={};stateManager;entityManager;characterManager;monsterManager;objectiveManager;attackModifierManager;actionsManager;levelManager;scenarioManager;scenarioRulesManager;roundManager;lootManager;itemManager;battleGoalManager;eventCardManager;buildingsManager;challengesManager;scenarioStatsManager;trialsManager;enhancementsManager;imbuementManager;uiChange=new M.t(!1);constructor(){this.stateManager=new di(this.game),this.entityManager=new Dn(this.game),this.characterManager=new bn(this.game),this.monsterManager=new Jn.a(this.game),this.objectiveManager=new Qn(this.game),this.attackModifierManager=new $.Z(this.game),this.actionsManager=new Q,this.levelManager=new $n(this.game),this.scenarioManager=new Fe(this.game),this.scenarioRulesManager=new Xe.H(this.game),this.roundManager=new Ae(this.game),this.itemManager=new On(this.game),this.lootManager=new Gt(this.game),this.battleGoalManager=new Kt(this.game),this.eventCardManager=new Wn(this.game),this.buildingsManager=new Wt(this.game),this.challengesManager=new Sn(this.game),this.scenarioStatsManager=new le(this.game),this.trialsManager=new hi(this.game),this.enhancementsManager=new kn(this.game),this.imbuementManager=new Zn(this.game)}editions(l=!1,d=!1){return this.editionData.filter(h=>(l||w.f.settings.editions.includes(h.edition))&&(d||!h.additional)).map(h=>h.edition)}editionsData(l=!1,d=!1){const h=this.editions(l,d);return this.editionData.filter(_=>h.includes(_.edition))}editionLogo(l){const d=this.editionData.find(h=>h.edition==l);return d&&d.logoUrl?d.logoUrl:""}currentEditions(l=!1){return this.game.edition?[this.game.edition,...this.editionExtensions(this.game.edition)]:this.editions(!1,l)}currentEdition(l=void 0){if(this.game.edition)return this.game.edition;if(this.game.scenario&&this.game.scenario.edition)return this.game.scenario.edition;const d=C.game.figures.filter(h=>h instanceof c.K).map(h=>h.edition);return d.length>0&&d.every((h,_,f)=>0==_||f[_-1]==h)?d[0]:l??this.editions()[0]}editionExtensions(l,d=!1){if(d&&this.editionMappingAll[l])return this.editionMappingAll[l];if(!d&&this.editionMapping[l])return this.editionMapping[l];const h=this.editionData.find(f=>f.edition==l);let _=[];return h&&h.extensions&&h.extensions.forEach(f=>{!_.includes(f)&&this.editions(d,!0).includes(f)&&_.push(f),this.editionExtensions(f,d).forEach(P=>{!_.includes(P)&&this.editions(d,!0).includes(f)&&_.push(P)})}),this.editionData.filter(f=>f.edition!=l&&f.extends&&f.extends.includes(l)).forEach(f=>{_.includes(f.edition)||_.push(f.edition)}),d?this.editionMappingAll[l]=_:this.editionMapping[l]=_,_}editionScenarioExtensions(l,d=!1){if(d&&this.editionScenarioMappingAll[l])return this.editionScenarioMappingAll[l];if(!d&&this.editionScenarioMapping[l])return this.editionScenarioMapping[l];const h=this.editionData.filter(_=>(d||w.f.settings.editions.includes(_.edition))&&_.additional&&_.scenarios&&_.scenarios.length&&_.scenarios.some(f=>f.edition==_.edition)&&_.extensions.includes(l)).map(_=>_.edition);return d?this.editionScenarioMappingAll[l]=h:this.editionScenarioMapping[l]=h,h}resetEditionMapping(){this.editionMapping={},this.editionMappingAll={},this.editionScenarioMapping={},this.editionScenarioMappingAll={}}newItemStyle(l){const d=this.editionData.find(h=>h.edition==l);return!(!d||!(d.newItemStyle||d.extensions&&d.extensions.some(h=>this.newItemStyle(h))))}newAmStyle(l){const d=this.editionData.find(h=>h.edition==l);return!(!d||!(d.newAmStyle||d.extensions&&d.extensions.some(h=>this.newAmStyle(h))))}charactersData(l=void 0){const d=this.editionData.filter(_=>(!l||w.f.settings.editions.includes(_.edition))&&(!l||_.edition==l||this.editionExtensions(_.edition).includes(l))).flatMap(_=>_.characters),h=d.filter(_=>_.merge);return d.filter(_=>(!l||_.edition==l)&&!_.merge&&(_.replace||!_.replace&&!d.find(f=>f.replace&&f.name===_.name&&f.edition===_.edition))).map(_=>{const f=h.find(P=>P.name===_.name&&P.edition===_.edition);return f?Object.assign(new p.qS(_),f):new p.qS(_)})}monstersData(l=void 0){return this.editionData.filter(d=>(!l||w.f.settings.editions.includes(d.edition))&&(!l||d.edition==l||this.editionExtensions(d.edition).includes(l))).flatMap(d=>d.monsters).filter((d,h,_)=>(!l||d.edition==l)&&(d.replace||!d.replace&&!_.find(f=>f.replace&&f.name==d.name&&f.edition==d.edition)))}decksData(l=void 0){const d=this.editionData.filter(_=>(!l||w.f.settings.editions.includes(_.edition))&&(!l||_.edition==l||this.editionExtensions(_.edition).includes(l))).flatMap(_=>_.decks),h=d.filter(_=>_.abilities.some(f=>f.replace));return d.filter(_=>!h.includes(_)).map(_=>{const f=h.find(j=>j.edition==_.edition&&j.name==_.name);if(!f)return _;let P=new H.m(_.edition,_.name,_.character);return P.abilities=_.abilities.map(j=>Object.assign(new s.T,f.abilities.find(Y=>Y.cardId==j.cardId&&Y.replace)||j)),P})}scenarioData(l=void 0){return this.editionData.filter(d=>(!l||w.f.settings.editions.includes(d.edition))&&(!l||d.edition==l||this.editionExtensions(d.edition).includes(l))).flatMap(d=>d.scenarios).filter(d=>!l||d.edition==l)}sectionData(l=void 0,d=!1){return this.editionData.filter(h=>(!l||w.f.settings.editions.includes(h.edition))&&(!l||h.edition==l||h.additional&&this.editionExtensions(h.edition).includes(l)||d&&this.editionExtensions(l).includes(h.edition))).flatMap(h=>h.sections).filter(h=>!l||h.edition==l||d).map(h=>{if(!w.f.settings.fhSecondEdition||"fh"!=h.edition)return h;if("6.2"==h.index){let _=new F.tB(h);return _.index="60.2",_}if("60.2"==h.index){let _=new F.tB(h);return _.index="6.2",_}return h})}itemData(l=void 0,d=!1){return this.editionData.filter(h=>(d||w.f.settings.editions.includes(h.edition))&&(!l||h.edition==l||this.editionExtensions(h.edition,!0).includes(l))).flatMap(h=>h.items).filter((h,_,f)=>h.replace||!h.replace&&!f.find(P=>P.replace&&P.id==h.id&&P.edition==h.edition))}challengesData(l=void 0,d=!1){return this.editionData.filter(h=>(d||w.f.settings.editions.includes(h.edition))&&(!l||h.edition==l||this.editionExtensions(h.edition,!0).includes(l))).flatMap(h=>h.challenges)}conditions(l=void 0,d=!1){let h=[],_=[];return l?(_=this.editionData.filter(f=>(f.edition==l||this.editionExtensions(l).includes(f.edition))&&f.conditions&&f.conditions.length>0).flatMap(f=>f.conditions),!d&&this.game.conditions&&_.push(...this.game.conditions),h.push(..._.map(f=>f.split(":").length>1?new G.kW(f.split(":")[0],+f.split(":")[1]):new G.kW(f)))):h=G.Xo,h=h.filter(f=>!f.types.includes(G.GV.special)),d||this.game.figures.filter(f=>f instanceof c.K&&f.specialConditions&&f.specialConditions.length&&!f.absent&&C.gameplayFigure(f)).forEach(f=>f.specialConditions.forEach(P=>h.push(new G.kW(P)))),h.filter((f,P,j)=>j.map(Y=>Y.name).indexOf(f.name)==P)}figureConditions(l,d=void 0){let h=[];if(l instanceof c.K)l.summons&&l.summons.forEach(_=>{_.action&&this.actionConditions(_.action).forEach(f=>{h.find(P=>P==f)||h.push(f)}),_.additionalAction&&this.actionConditions(_.additionalAction).forEach(f=>{h.find(P=>P==f)||h.push(f)})});else if(l instanceof R.R&&d instanceof T.I){const _=C.monsterManager.getStat(l,d.type),f=C.monsterManager.getAbility(l);f&&f.actions.forEach(P=>{this.actionConditions(P,_).forEach(j=>{h.find(Y=>Y==j)||h.push(j)})})}return h}actionConditions(l,d=void 0){let h=[];return l.type==D.X2.condition?h.push(l.value):d&&l.type==D.X2.attack&&d.actions&&d.actions.forEach(_=>{_.type==D.X2.condition&&h.push(_.value)}),l.subActions&&l.subActions.forEach(_=>{h.push(...this.actionConditions(_,d))}),h}conditionsForTypes(...l){return this.conditions(this.game.edition).filter(d=>l.every(h=>d.types.includes(h)))}allConditionsForTypes(...l){return this.conditions().filter(d=>l.every(h=>d.types.includes(h)))}markers(){return this.game.figures.filter(l=>l instanceof c.K&&!l.absent&&(l.marker||this.game.state==E.mk.next&&l.active)).map(l=>l).sort((l,d)=>l.marker&&!d.marker?-1:!l.marker&&d.marker?1:0).map(l=>l.edition+"-"+l.name)}sortFigures(l=void 0){this.game.figures.sort((d,h)=>w.f.settings.sortFigures?this.game.state==E.mk.draw?this.sortFiguresByTypeAndName(d,h):l&&l!=d&&l!=h?0:w.f.settings.initiativeRequired||d.getInitiative()>0&&h.getInitiative()>0?d.getInitiative()==h.getInitiative()?this.sortFiguresByTypeAndName(d,h):C.challengesManager.apply&&C.challengesManager.isActive(1491,"fh")?h.getInitiative()-d.getInitiative():d.getInitiative()-h.getInitiative():0:0)}sortFiguresByTypeAndName(l,d){if(l.off&&!d.off)return 1;if(!l.off&&d.off)return-1;let h=l.name.toLowerCase();l instanceof c.K?h=C.characterManager.characterName(l).toLowerCase():l instanceof R.R?h=w.f.getLabel("data.monster."+l.name).toLowerCase():l instanceof B.$e&&(h=l.title?l.title:w.f.getLabel(l.name?"data.objective."+l.name:l.escort?"escort":"objective").toLowerCase());let _=d.name.toLowerCase();if(d instanceof c.K?_=C.characterManager.characterName(d).toLowerCase():d instanceof R.R?_=w.f.getLabel("data.monster."+d.name).toLowerCase():d instanceof B.$e&&(_=d.title?d.title:w.f.getLabel(d.name?"data.objective."+d.name:d.escort?"escort":"objective").toLowerCase()),l instanceof c.K&&d instanceof R.R)return-1;if(l instanceof R.R&&d instanceof c.K)return 1;if(l instanceof c.K&&d instanceof B.$e)return-1;if(l instanceof B.$e&&d instanceof c.K)return 1;if(l instanceof R.R&&d instanceof B.$e)return-1;if(l instanceof B.$e&&d instanceof R.R)return 1;if(l instanceof R.R&&d instanceof R.R)return 0;if(l instanceof B.$e&&d instanceof B.$e&&h==_){if(l.marker&&d.marker)return l.marker<d.marker?-1:1;if(l.marker)return 1;if(d.marker)return-1}return l instanceof c.K&&d instanceof c.K&&w.f.settings.characterSortIndex?l.number-d.number:h<_?-1:1}deckData(l,d=!1){let h;return l instanceof R.R&&l.statEffect&&l.statEffect.deck&&(h=this.decksData().find(_=>l instanceof R.R&&l.statEffect&&l.statEffect.deck&&l.statEffect.deck==_.name&&(_.edition==l.edition||_.edition==C.currentEdition()||-1!=this.editionExtensions(_.edition).indexOf(C.currentEdition(l.edition)))),h&&l.abilities.length!=h.abilities.length&&(l.abilities=h.abilities.filter(_=>isNaN(+_.level)||+_.level<=(l&&l.level||0)).map(_=>h?h.abilities.indexOf(_):-1),(0,V.Z)(l.abilities),this.game.state==E.mk.next&&(l.ability=0))),h||(h=this.decksData(l.edition).find(_=>_.name==l.deck||_.name==l.name)),h||(h=this.decksData().find(_=>(_.name==l.deck||_.name==l.name)&&this.editionExtensions(l.edition).includes(_.edition))),h||(h=this.decksData().find(_=>(_.name==l.deck||_.name==l.name)&&_.edition==l.edition)),h||(l.errors=l.errors||[],!d&&!l.errors.find(_=>_.type==x.H.unknown)&&!l.errors.find(_=>_.type==x.H.deck)&&(console.error("Unknwon deck: "+l.name+(l.deck?"["+l.deck+"]":"")+" for "+l.edition),l.errors.push(new x.h(x.H.deck,l instanceof c.K?"character":"monster",l.name,l.edition,l.deck))),new H.m)}abilities(l){return this.deckData(l).abilities||[]}hasBottomAbility(l){return l&&l.bottomActions&&l.bottomActions.length>0||!1}getCharacterData(l,d=""){let h=this.charactersData().find(_=>_.name==l&&(!d||_.edition==d));if(!h){if(h=this.charactersData().find(_=>_.name==l),!h&&!d)for(d=l.split("-")[0],l=l.split("-").slice(1).join("-"),h=this.charactersData().find(_=>_.name==l&&_.edition==d);l&&!h;)d=d+"-"+l.split("-")[0],l=l.split("-").slice(1).join("-"),h=this.charactersData().find(_=>_.name==l&&_.edition==d);return h||(h=new p.qS,h.name=l,h.edition=d,h.errors=h.errors||[],h.errors.find(_=>_.type==x.H.unknown)||(console.error("unknown character '"+l+"' for edition '"+d+"'"),h.errors.push(new x.h(x.H.unknown,"character",l,d)))),h}return h}isCharacter(l){return l instanceof c.K}isMonster(l){return l instanceof R.R}isMonsterEntity(l){return l instanceof T.I}isSummon(l){return l instanceof I.up}isObjectiveContainer(l){return l instanceof B.$e}isObjectiveEntity(l){return l instanceof q.X}toCharacter(l){return l}toMonster(l){return l}toMonsterEntity(l){return l}toSummon(l){return l}toObjectiveContainer(l){return l}toObjectiveEntity(l){return l}getEdition(l,d=""){const h=this.currentEdition(d);return l.edition==h||this.editionExtensions(h).includes(l.edition)?"":l.edition}gameplayFigure(l){return(l instanceof R.R||l instanceof B.$e)&&this.entityManager.entitiesAll(l,!0).length>0||l instanceof c.K&&C.entityManager.isAlive(l)}figuresByIdentifier(l,d=!1,h=[]){if(0==h.length&&(h=this.game.figures),l&&l.type){const _=l.type;if("all"==_)return d?h.filter(f=>!(f instanceof c.K&&this.characterManager.ignoreNegativeScenarioffects(f))):h;if(l.name){const f=l.edition,P=new RegExp("^"+l.name+"$");switch(_){case"monster":return h.filter(j=>j instanceof R.R&&(!f||j.edition==f)&&j.name.match(P)&&(!l.marker||j.entities.some(Y=>Y.marker==l.marker))&&(!l.tags||0==l.tags.length||j.entities.some(Y=>l.tags&&l.tags.every(U=>Y.tags&&Y.tags.includes(U)))));case"character":case"characterWithSummon":return h.filter(j=>!(!(j instanceof c.K)||j.absent||f&&j.edition!=f||!j.name.match(P)||!(!l.tags||0==l.tags.length||l.tags&&l.tags.every(Y=>j.tags&&j.tags.includes(Y)))||d&&this.characterManager.ignoreNegativeScenarioffects(j)));case"objective":return this.game.figures.filter(j=>j instanceof B.$e&&j.name.match(P)&&("escort"!=f||j.escort)&&(!l.marker||j.entities.some(Y=>Y.marker==l.marker))&&(!l.tags||0==l.tags.length||j.entities.some(Y=>l.tags&&l.tags.every(U=>Y.tags&&Y.tags.includes(U)))))}}}return[]}entitiesByIdentifier(l,d){return this.figuresByIdentifier(l,d).map(_=>_ instanceof R.R||_ instanceof B.$e?_.entities:_ instanceof c.K?l&&"characterWithSummon"==l.type?[_,..._.summons]:_:void 0).flat().filter(_=>null!=_).map(_=>_).filter(_=>!l||(!l.marker||!(_ instanceof T.I)||_.marker==l.marker)&&(!l.tags||0==l.tags.length||l.tags.every(f=>_.tags.includes(f))))}getMonsterData(l,d){let h=this.monstersData().find(_=>_.name==l&&_.edition==d);return h||(h=this.monstersData().find(_=>_.name==l),h||(h=new A.f,h.errors=h.errors||[],h.name=l,h.edition=d,h.errors.find(_=>_.type==x.H.unknown)||(console.error("unknown monster '"+l+"' for edition '"+d+"'"),h.errors.push(new x.h(x.H.unknown,"monster",l,d)))),h)}prosperityLevel(){let l=1,d=b.yF;return this.fhRules()?d=b.b9:this.gh2eRules()&&(d=b.fH),d.forEach(h=>{this.prosperityTicks()>h&&l++}),l}prosperityTicks(){let l=this.game.party.prosperity;return this.game.party.envelopeB&&this.editionRules("gh")?(l+=1,this.game.party.donations>10&&(l+=Math.floor(Math.min(this.game.party.donations-10,30)/5)),this.game.party.donations>40&&(l+=Math.floor((this.game.party.donations-40)/10))):this.gh2eRules()&&(l+=Math.floor(Math.min(this.game.party.donations,100)/5),l+=Math.floor(Math.min(this.game.party.imbuement+5,80)/10)),l}fhRules(l=!1){return this.editionRules("fh")||l&&this.gh2eRules()}gh2eRules(){return this.editionRules("gh2e")}bbRules(){return this.editionRules("bb")}editionRules(l,d=!0){const h=d?this.currentEdition():this.game.edition;return h&&(h==l||this.editionExtensions(h).includes(l))||!1}additionalIdentifier(l,d=void 0){return l instanceof c.K?new O.h5(l.name,l.edition,"character",void 0,l.tags):l instanceof R.R?d instanceof T.I?new O.h5(l.name,l.edition,"monster",d.marker,d.tags):new O.h5(l.name,l.edition,"monster",void 0,l.tags):l instanceof B.$e?d instanceof q.X?new O.h5(l.name,l.escort?"escort":"objective","objective",d.marker,d.tags):new O.h5(l.name,l.escort?"escort":"objective","objective",void 0,[]):new O.h5(l.name,l.edition,void 0,void 0,d&&d.tags||[])}entityCounter(l){return this.entityCounters(l)[0]||void 0}entityCounters(l){const d=new RegExp("^"+l.name+"$");return this.game.entitiesCounter.filter(h=>(!l.type||l.type==h.identifier.type)&&h.identifier.name.match(d)&&(!l.edition||l.edition==h.identifier.edition)&&(!l.marker||l.marker==h.identifier.marker)&&(!l.tags||0==l.tags.length||l.tags.every(_=>h.identifier.tags&&h.identifier.tags.includes(_))))}addEntityCount(l,d=void 0){const h=this.additionalIdentifier(l,d);let _=this.entityCounter(h);_||(_={identifier:h,total:0,killed:0},this.game.entitiesCounter.push(_)),_.total++}checkEntitiesKilled(){this.game.figures.forEach(l=>{l instanceof c.K?this.entityCounter(this.additionalIdentifier(l))||this.addEntityCount(l):(l instanceof R.R||l instanceof B.$e)&&l.entities.forEach(d=>{this.entityManager.isAlive(d)&&!this.entityCounter(this.additionalIdentifier(l,d))&&this.addEntityCount(l,d)})}),this.game.entitiesCounter.forEach(l=>{let d=this.figuresByIdentifier(l.identifier);if(0==d.length&&l.total>l.killed)l.killed=l.total;else if(d.every(h=>h instanceof c.K))d=d.filter(h=>h instanceof c.K&&this.entityManager.isAlive(h)),d.length+l.killed<l.total?l.killed=l.total-d.length:d.length+l.killed>l.total&&(console.warn("More killed then figures counted",l.identifier,"total: "+l.total,"killed: "+l.killed,"current: "+d.length),l.total=d.length+l.killed);else if(d.every(h=>h instanceof R.R)){const h=d.map(_=>this.monsterManager.monsterEntityCountIdentifier(_,l.identifier)).reduce((_,f)=>_+f);h+l.killed<l.total?l.killed=l.total-h:h+l.killed>l.total&&(console.warn("More killed then figures counted",l.identifier,"total: "+l.total,"killed: "+l.killed,"current: "+h),l.total=h+l.killed)}else if(d.every(h=>h instanceof B.$e)){const h=d.map(_=>this.objectiveManager.objectiveEntityCountIdentifier(_,l.identifier)).reduce((_,f)=>_+f);h+l.killed<l.total?l.killed=l.total-h:h+l.killed>l.total&&(console.warn("More killed then figures counted",l.identifier,"total: "+l.total,"killed: "+l.killed,"current: "+h),l.total=h+l.killed)}})}nextElementState(l,d=!1,h=!1){if(C.bbRules())return l.state!=S.e_.strong?S.e_.strong:S.e_.inert;if(C.game.state==E.mk.draw||h){if(l.state==S.e_.new&&!d)return S.e_.strong;if(l.state!=S.e_.new&&l.state!=S.e_.strong)return l.state==S.e_.waning?S.e_.inert:d?S.e_.waning:S.e_.new;if(!d)return S.e_.waning}else{if(l.state==S.e_.new&&!d)return S.e_.strong;if(l.state==S.e_.strong){if(d)return S.e_.waning}else{if(l.state!=S.e_.waning)return d?S.e_.waning:S.e_.new;if(d)return S.e_.new}}return S.e_.inert}campaignData(l=void 0){l=l||this.currentEdition();const d=this.editionData.find(_=>_.edition==l);if(d&&d.campaign)return Object.assign(new b.Np,d.campaign);const h=this.editionExtensions(l).map(_=>this.editionData.find(f=>f.edition==_)).map(_=>_?_.campaign:void 0).find(_=>_);return h?Object.assign(new b.Np,h):new b.Np}changeParty(l){w.f.settings.automaticTheme&&("fh"!=this.game.edition&&"fh"==l.edition||"gh2e"!=this.game.edition&&"gh2e"==l.edition?w.f.set("fhStyle",!0):"fh"==this.game.edition&&"fh"!=l.edition&&w.f.set("fhStyle",!1)),this.game.party.characters=this.game.figures.filter(d=>d instanceof c.K).map(d=>d.toModel()),this.game.party.edition=this.game.edition,this.game.party.conditions=this.game.conditions,this.game.party.battleGoalEditions=this.game.battleGoalEditions,this.game.party.filteredBattleGoals=this.game.filteredBattleGoals,this.game.party.unlockedCharacters=this.game.unlockedCharacters,this.game.party.level=this.game.level,this.game.party.levelCalculation=this.game.levelCalculation,this.game.party.levelAdjustment=this.game.levelAdjustment,this.game.party.bonusAdjustment=this.game.bonusAdjustment,this.game.party.ge5Player=this.game.ge5Player,this.game.party.playerCount=this.game.playerCount,this.game.party.solo=this.game.solo,this.game.party.lootDeckEnhancements=this.game.lootDeckEnhancements,this.game.party.lootDeckFixed=this.game.lootDeckFixed,this.game.party.lootDeckSections=this.game.lootDeckSections,this.game.party=l,this.game.edition=this.game.party.edition,this.game.conditions=this.game.party.conditions||[],this.game.battleGoalEditions=this.game.party.battleGoalEditions||[],this.game.filteredBattleGoals=this.game.party.filteredBattleGoals||[],this.game.unlockedCharacters=this.game.party.unlockedCharacters||[],this.game.level=0==this.game.party.level?0:this.game.party.level||this.game.level,this.game.levelCalculation=0!=this.game.party.levelCalculation&&(this.game.party.levelCalculation||this.game.levelCalculation),this.game.levelAdjustment=0==this.game.party.levelAdjustment?0:this.game.party.levelAdjustment||this.game.levelAdjustment,this.game.bonusAdjustment=0==this.game.party.bonusAdjustment?0:this.game.party.bonusAdjustment||this.game.bonusAdjustment,this.game.ge5Player=0!=this.game.party.ge5Player&&(this.game.party.ge5Player||this.game.ge5Player),this.game.playerCount=this.game.party.playerCount||this.game.playerCount,this.game.solo=0!=this.game.party.solo&&(this.game.party.solo||this.game.solo),this.game.lootDeckEnhancements=this.game.party.lootDeckEnhancements||[],this.game.lootDeckFixed=this.game.party.lootDeckFixed||[],this.game.lootDeckSections=this.game.party.lootDeckSections||[],this.game.figures=this.game.figures.filter(d=>!(d instanceof c.K)),this.scenarioManager.setScenario(void 0),l.characters.forEach(d=>{let h=new c.K(this.getCharacterData(d.name,d.edition),d.level);h.fromModel(d),this.game.figures.push(h)})}resetCampaign(){this.game.figures=[],this.game.party.characters=[],this.game.party.location="",this.game.party.achievements="",this.game.party.achievementsList=[],this.game.party.reputation=0,this.game.party.prosperity=0,this.game.party.scenarios=[],this.game.party.conclusions=[],this.game.party.casualScenarios=[],this.game.party.manualScenarios=[],this.game.party.globalAchievements="",this.game.party.globalAchievementsList=[],this.game.party.treasures=[],this.game.party.donations=0,this.game.party.retirements=[],this.game.party.unlockedItems=[],this.game.party.unlockedCharacters=[],this.game.party.envelopeB=!1,this.game.party.weeks=0,this.game.party.weekSections=[],this.game.party.loot={},this.game.party.randomItemLooted=[],this.game.party.inspiration=0,this.game.party.defense=0,this.game.party.soldiers=0,this.game.party.morale=0,this.game.party.townGuardPerks=0,this.game.party.townGuardPerkSections=[],this.game.party.campaignStickers=[],this.game.party.townGuardDeck=void 0,this.game.party.buildings=[],this.game.party.lootDeckEnhancements=[],this.game.party.lootDeckFixed=[],this.game.party.lootDeckSections=[]}toggleGameClock(){this.game.gameClock=this.game.gameClock||[];let l=this.game.gameClock.length?this.game.gameClock[0]:void 0;l&&(l.clockIn?l.clockOut?l=void 0:l.clockOut=(new Date).getTime():(console.warn("Timestamp with invalid clock:",l),l.clockIn=(new Date).getTime())),l||this.game.gameClock.unshift(new E.bt((new Date).getTime())),this.stateManager.saveLocal()}mergeGameClocks(l,d){let h=[];return l.forEach(_=>{const f=d.find(P=>P.clockIn<=_.clockIn&&(P.clockOut&&_.clockOut&&P.clockOut>=_.clockOut||!P.clockOut));h.push(f||_)}),d.forEach(_=>{h.find(f=>f.clockIn<=_.clockIn&&(f.clockOut&&_.clockOut&&f.clockOut>=_.clockOut||!f.clockOut))||h.push(_)}),h.sort((_,f)=>f.clockIn-_.clockIn)}gh2eFactionUnlocks(){return this.game.party.conclusions.map(l=>C.scenarioManager.sectionDataForModel(l)).filter(l=>!!l&&l.rewards&&l.rewards.factionUnlock).map(l=>l&&l.rewards&&l.rewards.factionUnlock||"")}gh2eFactionUnlock(l){return this.gh2eFactionUnlocks().includes(l)}};window.gameManager=C},8374(u,y,v){v.d(y,{T:()=>M});class M{cardId;name;initiative;level=0;shuffle;actions;lost=!1;round=!1;persistent=!1;loss=!1;xp=0;bottomActions;bottomLost=!1;bottomRound=!1;bottomPersistent=!1;bottomLoss=!1;bottomXp=0;bottomShuffle=!1;revealed=!1;replace=!1;constructor(O=void 0,V=void 0,c=0,E=[],R=!1,T=[],B=0){this.cardId=O,this.name=V,this.initiative=c,this.actions=E,this.shuffle=R,this.bottomActions=T,this.level=B}}},8503(u,y,v){v.d(y,{j:()=>O});var M=v(57);class O extends M.gw{petname;active;lost;constructor(c,E,R="",T=!1,B=!1){super(c,E),this.petname=R,this.active=T,this.lost=B}}},8635(u,y,v){v.d(y,{iq:()=>M,qS:()=>O});var M=function(V){return V.algox="algox",V.aesther="aesther",V.harrower="harrower",V.human="human",V.inox="inox",V.lurker="lurker",V.orchid="orchid",V.quatryl="quatryl",V.savvas="savvas",V.unfettered="unfettered",V.valrath="valrath",V.vermling="vermling",V}(M||{}),x=function(V){return V.male="m",V.female="f",V.unknown="",V}(x||{});class O{name="";stats=[];characterClass;gender=x.unknown;identities=[];defaultIdentity=void 0;tokens=[];primaryToken=-1;handSize=0;unlockEvent="";retireEvent="";traits=[];availableSummons=[];specialActions=[];specialConditions=[];icon="";iconUrl="";thumbnail;thumbnailUrl;color="#aaaaaa";noThumbnail=!1;marker=!1;deck="";perkWarning=!1;perks=[];additionalModifier=[];masteries=[];bb=!1;amTables=[];edition="";spoiler=!1;locked=!1;errors;replace=!1;merge=!1;constructor(c=void 0){c&&(this.errors=c.errors||[],this.name=c.name,this.stats=c.stats||[],this.characterClass=c.characterClass||void 0,this.gender=c.gender||x.unknown,this.identities=c.identities||[],this.defaultIdentity=c.defaultIdentity,this.tokens=c.tokens||[],this.primaryToken=c.primaryToken>=0?c.primaryToken:-1,this.handSize=c.handSize||0,this.unlockEvent=c.unlockEvent||"",this.retireEvent=c.retireEvent||"",this.traits=c.traits||[],this.availableSummons=c.availableSummons||[],this.edition=c.edition||"",this.icon=c.icon||c.edition+"-"+c.name,this.iconUrl=c.iconUrl||"./assets/images/character/icons/"+this.icon+".svg",this.thumbnail=c.thumbnail||void 0,this.thumbnailUrl=c.thumbnailUrl||void 0,this.noThumbnail=c.noThumbnail,this.color=c.color||"#aaaaaa",this.marker=c.marker||!1,this.spoiler=c.spoiler||!1,this.specialActions=c.specialActions||[],this.specialConditions=c.specialConditions||[],this.locked=c.locked||!1,this.deck=c.deck||"",this.perkWarning=c.perkWarning,this.perks=c.perks||[],this.additionalModifier=c.additionalModifier||[],this.masteries=c.masteries||[],this.replace=c.replace||!1,this.merge=c.merge||!1,this.bb=c.bb||!1,this.amTables=c.amTables||[])}}},8826(u,y,v){v.d(y,{Np:()=>c,b9:()=>x,fH:()=>O,le:()=>V,yF:()=>M});const M=[3,8,14,21,29,38,49,63],x=[5,14,26,41,59,80,104,131],O=[4,11,21,32,44,58,73,88];class V{edition;characters;monsters;decks;scenarios;sections;items;conditions=[];battleGoals=[];events=[];personalQuests=[];challenges=[];trials=[];favors=[];pets=[];worldMap;extendWorldMap;label={};labelSpoiler={};url="";logoUrl="";additional=!1;extensions=[];extends=[];newAmStyle=!1;newItemStyle=!1;campaign;treasures=[];treasureOffset=0;monsterAmTables=[];constructor(R,T,B,q,I,s,D,p=void 0,G=[],H=[],b=[],S=!1,A=[]){this.edition=R,this.characters=T,this.monsters=B,this.decks=q,this.scenarios=I,this.sections=s,this.items=D,p&&(this.conditions=p),this.battleGoals=G,this.events=H,this.personalQuests=b,this.additional=S,this.extensions=A}}class c{events={};campaignStickers=[];buildings=[];highMorale=[];lowMorale=[];lootSpecial1Sections=[];lootSpecial2Sections=[];townGuardPerks=[];weeks={};factions=[];imbuementSections={};reputationSections=[];prosperitySections={}}},9039(u,y,v){v.d(y,{m:()=>M});class M{name;character;abilities;edition;constructor(O="",V="",c=!1,E=[]){this.name=V,this.abilities=E,this.edition=O,this.character=c}}},9733(u,y,v){v.d(y,{Ag:()=>c,Nz:()=>x,Pl:()=>V,jW:()=>O});var M=v(2e3);class x extends M.tB{custom;revealedRooms;additionalSections=[];constructor(R,T=[],B=[],q=!1){super(R),this.solo=R.solo,this.spotlight=R.spotlight,this.revealedRooms=JSON.parse(JSON.stringify(T)),this.additionalSections=JSON.parse(JSON.stringify(B)),R.rooms&&R.rooms.forEach(I=>{I.initial&&!this.revealedRooms.includes(I.roomNumber)&&this.revealedRooms.push(I.roomNumber)}),this.custom=q}}class O extends M.tB{isSuccess;isBlocked;isLocked;constructor(R,T,B,q){super(R),this.isSuccess=T,this.isBlocked=B,this.isLocked=q}}class V{globalAchievements=[];globalAchievementsCount=[];globalAchievementsMissing=[];partyAchievements=[];partyAchievementsCount=[];partyAchievementsMissing=[];campaignStickers=[];campaignStickersCount=[];campaignStickersMissing=[];buildings=[];buildingsLevel=[];buildingsLevelMissing=[];buildingsMissing=[];characters=[];charactersMissing=[];scenarios=[];isEmpty(){return 0==this.buildings.length&&0==this.buildingsLevel.length&&0==this.buildingsMissing.length&&0==this.buildingsLevelMissing.length&&0==this.campaignStickers.length&&0==this.campaignStickersCount.length&&0==this.campaignStickersMissing.length&&0==this.globalAchievements.length&&0==this.globalAchievementsCount.length&&0==this.globalAchievementsMissing.length&&0==this.partyAchievements.length&&0==this.partyAchievementsCount.length&&0==this.partyAchievementsMissing.length&&0==this.characters.length&&0==this.charactersMissing.length&&0==this.scenarios.length}}class c{index;edition;group;isCustom;custom;revealedRooms;additionalSections;constructor(R,T,B=void 0,q=!1,I="",s=void 0,D=void 0){this.index=R,this.edition=T,this.group=B,this.isCustom=q,this.custom=I,this.revealedRooms=s,this.additionalSections=D}}},9765(u,y,v){v.d(y,{Zt:()=>s,bt:()=>p,mk:()=>D,u8:()=>G});var M=v(8317),x=v(1619),O=v(1824),V=v(3219),c=v(3492),E=v(5532),R=v(1604),T=v(2065),B=v(4933),q=v(1891),I=v(9733);class s{revision=0;revisionOffset=0;edition=void 0;conditions=[];battleGoalEditions=[];filteredBattleGoals=[];figures=[];entitiesCounter=[];state=D.draw;scenario=void 0;sections=[];scenarioRules=[];appliedScenarioRules=[];discardedScenarioRules=[];level=1;levelCalculation=!0;levelAdjustment=0;bonusAdjustment=0;ge5Player=!0;playerCount=-1;round=0;roundResets=[];roundResetsHidden=[];playSeconds=0;totalSeconds=0;monsterAttackModifierDeck=new V.J;allyAttackModifierDeck=new V.J;elementBoard;solo=!1;party;parties;lootDeck=new R.yX;lootDeckEnhancements=[];lootDeckFixed=[];lootDeckSections=[];unlockedCharacters=[];server=!1;finish;gameClock=[];challengeDeck=new c.lV;favors=[];favorPoints=[];keepFavors=!1;eventDraw;constructor(){this.elementBoard=JSON.parse(JSON.stringify(E.O7)),this.party=new q.r,this.parties=[this.party]}toModel(){return new G(this.revision,this.revisionOffset,this.edition,this.conditions,this.battleGoalEditions,this.filteredBattleGoals,this.figures.map(b=>b.edition+"-"+(b instanceof B.$e?b.uuid:b.name)),this.entitiesCounter,this.figures.filter(b=>b instanceof O.K).map(b=>b.toModel()),this.figures.filter(b=>b instanceof T.R).map(b=>b.toModel()),this.figures.filter(b=>b instanceof B.$e).map(b=>b.toModel()),this.state,this.scenario&&M.E.scenarioManager.toModel(this.scenario,this.scenario.revealedRooms,this.scenario.additionalSections,this.scenario.custom,this.scenario.custom?this.scenario.name:"")||void 0,this.sections.map(b=>M.E.scenarioManager.toModel(b,b.revealedRooms,b.additionalSections)),this.scenarioRules.map(b=>b.identifier),this.appliedScenarioRules,this.discardedScenarioRules,this.level,this.levelCalculation,this.levelAdjustment,this.bonusAdjustment,this.ge5Player,this.playerCount,this.round,this.roundResets,this.roundResetsHidden,this.playSeconds,this.totalSeconds,this.monsterAttackModifierDeck.toModel(),this.allyAttackModifierDeck.toModel(),this.elementBoard,this.solo,this.party,this.parties,this.lootDeck,this.lootDeckEnhancements,this.lootDeckFixed,this.lootDeckSections,this.unlockedCharacters,this.server,this.finish,this.gameClock,this.challengeDeck.toModel(),this.favors,this.favorPoints,this.keepFavors,this.eventDraw)}fromModel(b,S=!1){if(this.revision=b.revision||0,this.revisionOffset=b.revisionOffset||0,this.edition=b.edition,this.conditions=b.conditions||[],this.battleGoalEditions=b.battleGoalEditions||[],this.filteredBattleGoals=b.filteredBattleGoals||[],this.figures=this.figures.filter(A=>b.characters.map(F=>F.name).includes(A.name)||b.monsters.map(F=>F.name).includes(A.name)||b.objectiveContainers&&b.objectiveContainers.map(F=>F.name).includes(A.name)),this.entitiesCounter=b.entitiesCounter||[],b.characters.forEach(A=>{let F=this.figures.find(t=>t instanceof O.K&&t.name==A.name&&t.edition==A.edition);F||(F=new O.K(M.E.getCharacterData(A.name,A.edition),A.level),this.figures.push(F)),F.fromModel(A)}),b.monsters.forEach(A=>{let F=this.figures.find(t=>t instanceof T.R&&t.name==A.name&&t.edition==A.edition);F||(F=new T.R(M.E.getMonsterData(A.name,A.edition)),this.figures.push(F)),F.fromModel(A)}),b.objectiveContainers&&(this.figures=this.figures.filter(A=>!(A instanceof B.$e)||b.objectiveContainers&&b.objectiveContainers.some(F=>F.uuid&&F.uuid==A.uuid)),b.objectiveContainers.forEach(A=>{let F=this.figures.find(t=>t instanceof B.$e&&t.uuid==A.uuid);F||(F=new B.$e(A.uuid,A.additionalObjectiveId||A.objectiveId),this.figures.push(F)),F.fromModel(A)})),this.figures.sort((A,F)=>b.figures.indexOf(A.edition+"-"+(A instanceof B.$e?A.uuid:A.name))-b.figures.indexOf(F.edition+"-"+(F instanceof B.$e?F.uuid:F.name))),this.state=b.state,b.scenario){const A=M.E.scenarioManager.scenarioDataForModel(b.scenario);this.scenario=A?new I.Nz(A,b.scenario.revealedRooms||[],b.scenario.additionalSections||[],b.scenario.isCustom):void 0}else this.scenario=void 0;this.sections=[],b.sections.forEach(A=>{const F=M.E.scenarioManager.sectionDataForModel(A);F&&this.sections.push(new I.Nz(F,A.revealedRooms||[]))}),this.level=b.level,this.scenarioRules=[],b.scenarioRules&&b.scenarioRules.forEach(A=>{const F=M.E.scenarioRulesManager.getScenarioForRule(A).scenario;F&&(F.rules&&F.rules.length>A.index&&A.index>=0?(F.rules[A.index].spawns&&F.rules[A.index].spawns.forEach(t=>{t.manual&&!t.count&&(t.count="1")}),this.scenarioRules.push({identifier:A,rule:F.rules[A.index]})):F.errata&&A.index<0&&F.errata.split("|")[-1*A.index-1]&&this.scenarioRules.push({identifier:A,rule:M.E.scenarioRulesManager.createErrataRule(F.edition,F.errata.split("|")[-1*A.index-1])}))}),this.appliedScenarioRules=b.appliedScenarioRules||[],this.discardedScenarioRules=b.discardedScenarioRules||b.disgardedScenarioRules||[],this.levelCalculation=b.levelCalculation,this.levelAdjustment=b.levelAdjustment,this.bonusAdjustment=b.bonusAdjustment,this.ge5Player=b.ge5Player,this.playerCount=b.playerCount||-1,this.round=b.round,this.roundResets=b.roundResets||[],this.roundResetsHidden=b.roundResetsHidden||[],(S&&!b.server||b.playSeconds>this.playSeconds)&&(this.playSeconds=b.playSeconds),(S&&!b.server||b.totalSeconds>this.totalSeconds)&&(this.totalSeconds=b.totalSeconds),this.monsterAttackModifierDeck=this.monsterAttackModifierDeck||new V.J,this.figures.forEach(A=>{A instanceof O.K&&A.perks&&A.perks.find(F=>F.monsterDeck)&&M.E.attackModifierManager.applyCharacterPerks(A,this.monsterAttackModifierDeck,!0)}),b.monsterAttackModifierDeck&&b.monsterAttackModifierDeck.cards&&b.monsterAttackModifierDeck.cards.length>0&&M.E.attackModifierManager.fromModel(this.monsterAttackModifierDeck,b.monsterAttackModifierDeck),this.allyAttackModifierDeck=this.allyAttackModifierDeck||new V.J,b.allyAttackModifierDeck&&b.allyAttackModifierDeck.cards&&b.allyAttackModifierDeck.cards.length>0&&M.E.attackModifierManager.fromModel(this.allyAttackModifierDeck,b.allyAttackModifierDeck),this.elementBoard=this.elementBoard||E.O7,b.elementBoard&&b.elementBoard.forEach((A,F)=>this.elementBoard[F].state=A.state),this.solo=b.solo,this.party=Object.assign(new q.r,b.party?JSON.parse(JSON.stringify(b.party)):new q.r),this.parties=[this.party],b.parties&&b.parties.forEach(A=>{A.id!=this.party.id&&(A.achievements&&(A.achievementsList.push(...A.achievements.split("\n")),A.achievements=""),A.globalAchievements&&(A.globalAchievementsList.push(...A.globalAchievements.split("\n")),A.globalAchievements=""),this.parties.push(Object.assign(new q.r,A)))}),b.lootDeck?this.lootDeck?this.lootDeck.fromModel(b.lootDeck):this.lootDeck=b.lootDeck:this.lootDeck=new R.yX,this.lootDeckEnhancements=b.lootDeckEnhancements||[],this.lootDeckFixed=b.lootDeckFixed||[],this.lootDeckSections=b.lootDeckSections||[],this.favors=b.favors||[],this.favorPoints=b.favorPoints||[],this.keepFavors=b.keepFavors||!1,this.eventDraw=b.eventDraw||void 0,this.lootDeckEnhancements.forEach(A=>{A.value&&(isNaN(+A.value)?"%game.loot.player.3-4% +1/%game.loot.player.2% +2"==A.value?(A.value4P=1,A.value3P=1,A.value2P=2):"%game.loot.player.4% +1/%game.loot.player.2-3% +2"==A.value?(A.value4P=1,A.value3P=2,A.value2P=2):console.warn("Cannot migrate loot: "+A.value):(A.value4P=+A.value,A.value3P=+A.value,A.value2P=+A.value),A.value=void 0)}),(0,R.G8)(this.lootDeck.cards),(0,R.G8)(this.lootDeckEnhancements),this.unlockedCharacters=b.unlockedCharacters||[],this.unlockedCharacters=this.unlockedCharacters.map(A=>{if(!A.includes(":")){let F=this.edition||M.E.currentEdition(),t=M.E.getCharacterData(A,F);if(t||(t=M.E.getCharacterData(A)),t)return t.edition+":"+t.name;console.warn("Could not find character data for unlock: "+A)}return A}),this.party.migrate(),this.challengeDeck=this.challengeDeck||new c.lV,b.challengeDeck&&this.challengeDeck.fromModel(b.challengeDeck),this.server=b.server,this.finish=b.finish,x.f.settings.gameClockMerge?this.gameClock=M.E.mergeGameClocks(this.gameClock,b.gameClock):S||(this.gameClock=b.gameClock)}}var D=function(H){return H.draw="draw",H.next="next",H}(D||{});class p{clockIn;clockOut;constructor(b,S=void 0){this.clockIn=b,this.clockOut=S}}class G{revision;revisionOffset;edition;conditions;battleGoalEditions;filteredBattleGoals;figures;entitiesCounter;characters;monsters;objectiveContainers;state;scenario;sections;scenarioRules;appliedScenarioRules;discardedScenarioRules;level;levelCalculation;levelAdjustment;bonusAdjustment;ge5Player;playerCount;round;roundResets;roundResetsHidden;playSeconds;totalSeconds;monsterAttackModifierDeck;allyAttackModifierDeck;elementBoard;solo;party;parties;lootDeck;lootDeckEnhancements;lootDeckFixed;lootDeckSections;unlockedCharacters;server;finish;gameClock;challengeDeck;favors;favorPoints;keepFavors;eventDraw;disgardedScenarioRules;constructor(b=0,S=0,A=void 0,F=[],t=[],N=[],K=[],w=[],Q=[],$=[],Kt=void 0,st=D.next,Wt=void 0,nn=[],Sn=[],_n=[],Yt=[],mn=0,bn=!0,Zt=0,kn=0,Dn=!0,Rt=-1,Z=0,vt=[],rn=[],Wn=0,Zn=0,jt=new V.qM(-1,V._v.map(pn=>pn.id),[],!0),pt=new V.qM(-1,V._v.map(pn=>pn.id),[],!0),On=[],$n=!1,Gt=new q.r,Jn=[],Qn=new R.yX,yn=[],Ae=[],Ve=[],Fe=[],Xe=!1,le=void 0,xn=[],En=new c.U2,ge=[],de=[],he=!1,_e=void 0){this.revision=b,this.revisionOffset=S,this.edition=A,this.conditions=F,this.battleGoalEditions=t,this.filteredBattleGoals=N,this.figures=K,this.entitiesCounter=JSON.parse(JSON.stringify(w)),this.characters=Q,this.monsters=$,this.objectiveContainers=Kt,this.state=st,this.scenario=Wt,this.sections=nn,this.scenarioRules=JSON.parse(JSON.stringify(Sn)),this.appliedScenarioRules=JSON.parse(JSON.stringify(_n)),this.discardedScenarioRules=JSON.parse(JSON.stringify(Yt)),this.level=mn,this.levelCalculation=bn,this.levelAdjustment=Zt,this.bonusAdjustment=kn,this.ge5Player=Dn,this.playerCount=Rt,this.round=Z,this.roundResets=JSON.parse(JSON.stringify(vt)),this.roundResetsHidden=JSON.parse(JSON.stringify(rn)),this.playSeconds=Wn,this.totalSeconds=Zn,this.monsterAttackModifierDeck=jt,this.allyAttackModifierDeck=pt,this.elementBoard=JSON.parse(JSON.stringify(On)),this.solo=$n,this.party=JSON.parse(JSON.stringify(Gt)),this.party.players=this.party.players.map(pn=>pn||""),this.parties=JSON.parse(JSON.stringify(Jn)),this.parties.forEach(pn=>{pn.players=pn.players.map(Be=>Be||"")}),this.lootDeck=JSON.parse(JSON.stringify(Qn)),this.lootDeckEnhancements=JSON.parse(JSON.stringify(yn)),this.lootDeckFixed=JSON.parse(JSON.stringify(Ae)),this.lootDeckSections=JSON.parse(JSON.stringify(Ve)),this.unlockedCharacters=JSON.parse(JSON.stringify(Fe)),this.server=Xe,this.finish=le?JSON.parse(JSON.stringify(le)):void 0,this.gameClock=xn,this.challengeDeck=En,this.favors=JSON.parse(JSON.stringify(ge)),this.favorPoints=JSON.parse(JSON.stringify(de)),this.keepFavors=he,this.eventDraw=_e,this.disgardedScenarioRules=JSON.parse(JSON.stringify(Yt))}}},9819(u,y,v){v.d(y,{F3:()=>x,lv:()=>M,yn:()=>O});class M{experience=0;gold=0;loot={};itemNotes="";items=[];equippedItems=[];personalQuest="";personalQuestProgress=[];battleGoals=0;notes="";retired=!1;retirements=0;extraPerks=0;perks=[];masteries=[];donations=0;scenarioStats=[];trial;deck=[];enhancements=[]}class x{dealtDamage=0;monsterDamage=0;otherDamage=0;healedDamage=0;heals=0;normalKills=0;eliteKills=0;bossKills=0;exhausts=0;maxDealtDamage=0;maxDamage=0}class O extends x{scenario;success=!1;level=0;difficulty=0;gold=0;xp=0;treasures=0;loot={};summons=new x}}},u=>{u.O(0,[502],()=>u(u.s=985)),u.O()}]);
//# sourceMappingURL=main.01ac5764044c9a6f.js.map