"use strict";(self.webpackChunkgloomhavensecretariat=self.webpackChunkgloomhavensecretariat||[]).push([[308],{2308:(At,v,l)=>{l.r(v),l.d(v,{diagram:()=>Dt});var m=l(467),_=l(2448),J=l(8802),P=l(5414),i=l(3675),Q=l(9158);l(7374),l(2571),l(1973),l(8416),l(3386);const y="rect",O="rectWithTitle",D="statediagram",st="".concat(D,"-").concat("state"),$="transition",nt="".concat($," ").concat("note-edge"),ct="".concat(D,"-").concat("note"),it="".concat(D,"-").concat("cluster"),rt="".concat(D,"-").concat("cluster-alt"),G="parent",B="note",R="----",at="".concat(R).concat(B),N="".concat(R).concat(G),U="fill:none",w="fill: #333",K="text",H="normal";let p={},E=0;function x(e="",c=0,t="",r=R){const n=null!==t&&t.length>0?"".concat(r).concat(t):"";return"".concat("state","-").concat(e).concat(n,"-").concat(c)}const u=(e,c,t,r,n,a)=>{const s=t.id,f=function Et(e){return null==e?"":e.classes?e.classes.join(" "):""}(r[s]);if("root"!==s){let h=y;!0===t.start&&(h="start"),!1===t.start&&(h="end"),t.type!==_.D&&(h=t.type),p[s]||(p[s]={id:s,shape:h,description:i.e.sanitizeText(s,(0,i.c)()),classes:"".concat(f," ").concat(st)});const o=p[s];t.description&&(Array.isArray(o.description)?(o.shape=O,o.description.push(t.description)):o.description.length>0?(o.shape=O,o.description=o.description===s?[t.description]:[o.description,t.description]):(o.shape=y,o.description=t.description),o.description=i.e.sanitizeTextOrArray(o.description,(0,i.c)())),1===o.description.length&&o.shape===O&&(o.shape=y),!o.type&&t.doc&&(i.l.info("Setting cluster for ",s,L(t)),o.type="group",o.dir=L(t),o.shape=t.type===_.a?"divider":"roundedWithTitle",o.classes=o.classes+" "+it+" "+(a?rt:""));const A={labelStyle:"",shape:o.shape,labelText:o.description,classes:o.classes,style:"",id:s,dir:o.dir,domId:x(s,E),type:o.type,padding:15,centerLabel:!0};if(t.note){const S={labelStyle:"",shape:"note",labelText:t.note.text,classes:ct,style:"",id:s+at+"-"+E,domId:x(s,E,B),type:o.type,padding:15},C={labelStyle:"",shape:"noteGroup",labelText:t.note.text,classes:o.classes,style:"",id:s+N,domId:x(s,E,G),type:"group",padding:0};E++;const d=s+N;e.setNode(d,C),e.setNode(S.id,S),e.setNode(s,A),e.setParent(s,d),e.setParent(S.id,d);let g=s,T=S.id;"left of"===t.note.position&&(g=S.id,T=s),e.setEdge(g,T,{arrowhead:"none",arrowType:"",style:U,labelStyle:"",classes:nt,arrowheadStyle:w,labelpos:"c",labelType:K,thickness:H})}else e.setNode(s,A)}c&&"root"!==c.id&&(i.l.trace("Setting node ",s," to be child of its parent ",c.id),e.setParent(s,c.id)),t.doc&&(i.l.trace("Adding nodes children "),St(e,t,t.doc,r,n,!a))},St=(e,c,t,r,n,a)=>{i.l.trace("items",t),t.forEach(s=>{switch(s.stmt){case _.b:case _.D:u(e,c,s,r,n,a);break;case _.S:{u(e,c,s.state1,r,n,a),u(e,c,s.state2,r,n,a);const f={id:"edge"+E,arrowhead:"normal",arrowTypeEnd:"arrow_barb",style:U,labelStyle:"",label:i.e.sanitizeText(s.description,(0,i.c)()),arrowheadStyle:w,labelpos:"c",labelType:K,thickness:H,classes:$};e.setEdge(s.state1.id,s.state2.id,f,E),E++}}})},L=(e,c=_.c)=>{let t=c;if(e.doc)for(let r=0;r<e.doc.length;r++){const n=e.doc[r];"dir"===n.stmt&&(t=n.value)}return t},Dt={parser:_.p,db:_.d,renderer:{setConf:function(e){const c=Object.keys(e);for(const t of c);},getClasses:function(e,c){return c.db.extract(c.db.getRootDocV2()),c.db.getClasses()},draw:function(){var e=(0,m.A)(function*(c,t,r,n){i.l.info("Drawing state diagram (v2)",t),p={},n.db.getDirection();const{securityLevel:a,state:s}=(0,i.c)(),f=s.nodeSpacing||50,h=s.rankSpacing||50;i.l.info(n.db.getRootDocV2()),n.db.extract(n.db.getRootDocV2()),i.l.info(n.db.getRootDocV2());const o=n.db.getStates(),A=new J.T({multigraph:!0,compound:!0}).setGraph({rankdir:L(n.db.getRootDocV2()),nodesep:f,ranksep:h,marginx:8,marginy:8}).setDefaultEdgeLabel(function(){return{}});let S;u(A,void 0,n.db.getRootDocV2(),o,n.db,!0),"sandbox"===a&&(S=(0,P.Ltv)("#i"+t));const C=(0,P.Ltv)("sandbox"===a?S.nodes()[0].contentDocument.body:"body"),d=C.select('[id="'.concat(t,'"]')),g=C.select("#"+t+" g");yield(0,Q.r)(g,A,["barb"],D,t),i.u.insertTitle(d,"statediagramTitleText",s.titleTopMargin,n.db.getDiagramTitle());const j=d.node().getBBox(),k=j.width+16,V=j.height+16;d.attr("class",D);const z=d.node().getBBox();(0,i.i)(d,V,k,s.useMaxWidth);const Y="".concat(z.x-8," ").concat(z.y-8," ").concat(k," ").concat(V);i.l.debug("viewBox ".concat(Y)),d.attr("viewBox",Y);const ht=document.querySelectorAll('[id="'+t+'"] .edgeLabel .label');for(const M of ht){const I=M.getBBox(),b=document.createElementNS("http://www.w3.org/2000/svg",y);b.setAttribute("rx",0),b.setAttribute("ry",0),b.setAttribute("width",I.width),b.setAttribute("height",I.height),M.insertBefore(b,M.firstChild)}});return function(t,r,n,a){return e.apply(this,arguments)}}()},styles:_.s,init:e=>{e.state||(e.state={}),e.state.arrowMarkerAbsolute=e.arrowMarkerAbsolute,_.d.clear()}}}}]);