"use strict";(self.webpackChunkgloomhavensecretariat=self.webpackChunkgloomhavensecretariat||[]).push([[792],{740:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{H:()=>ScenarioRulesManager});var _angular_cdk_drag_drop__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(50854),src_app_ui_helper_Static__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(14670),_model_Character__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(51824),_model_Entity__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(13812),_model_Game__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(29765),_model_Monster__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(42065),_model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(76066),_model_ObjectiveContainer__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(34933),_model_ObjectiveEntity__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(56719),_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(73219),_model_data_Condition__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(42357),_model_data_FigureError__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(34786),_model_data_MonsterStat__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(40392),_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(16538),_model_data_ScenarioRule__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(83414),_GameManager__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(58317),_SettingsManager__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(31619);class ScenarioRulesManager{game;constructor(p){this.game=p}addScenarioRules(p=!1){this.game.scenarioRules=[];const k=this.game.scenario;k&&k.rules&&k.rules.forEach((M,C)=>{(!M.alwaysApply||!_SettingsManager__WEBPACK_IMPORTED_MODULE_16__.f.settings.scenarioRulesAutoapply)&&this.addScenarioRule(k,M,C,!1,p)}),this.game.sections&&this.game.sections.forEach(M=>{M.rules&&M.rules.forEach((C,t)=>{(!C.alwaysApply||!_SettingsManager__WEBPACK_IMPORTED_MODULE_16__.f.settings.scenarioRulesAutoapply)&&this.addScenarioRule(M,C,t,!0,p)})}),this.addScenarioErrata(),this.filterDisabledScenarioRules()}addScenarioRulesAlways(){const p=this.game.scenario;p&&p.rules&&p.rules.filter(k=>this.game.round>0&&k.always||k.alwaysApply||k.alwaysApplyTurn).forEach(k=>{k.alwaysApply&&_SettingsManager__WEBPACK_IMPORTED_MODULE_16__.f.settings.scenarioRulesAutoapply&&this.scnearioRuleActive(k,p.rules.indexOf(k),!1)?this.applyRule(k,{edition:p.edition,scenario:p.index,group:p.group,index:p.rules.indexOf(k),section:!1}):this.game.discardedScenarioRules.find(M=>M.edition==p.edition&&M.scenario==p.index&&M.group==p.group&&M.index==p.rules.indexOf(k)&&!M.section)||this.addScenarioRule(p,k,p.rules.indexOf(k),!1)}),this.game.sections&&this.game.sections.forEach(k=>{k.rules&&k.rules.filter(M=>this.game.round>0&&M.always||M.alwaysApply||M.alwaysApplyTurn).forEach(M=>{M.alwaysApply&&_SettingsManager__WEBPACK_IMPORTED_MODULE_16__.f.settings.scenarioRulesAutoapply&&this.scnearioRuleActive(M,k.rules.indexOf(M),!0)?(this.applyRule(M,{edition:k.edition,scenario:k.index,group:k.group,index:k.rules.indexOf(M),section:!0}),_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenarioRules.splice(_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenarioRules.length-1,1)):this.game.discardedScenarioRules.find(C=>C.edition==k.edition&&C.scenario==k.index&&C.group==k.group&&C.index==k.rules.indexOf(M)&&C.section)||this.addScenarioRule(k,M,k.rules.indexOf(M),!0)})}),this.addScenarioErrata(),this.filterDisabledScenarioRules()}applyScenarioRulesAlways(){const p=this.game.scenario;let k=[];p&&p.rules&&k.push(...p.rules.map((M,C)=>({identifier:{edition:p.edition,scenario:p.index,group:p.group,index:C,section:!1},rule:M})).filter(M=>M.rule.alwaysApply&&this.game.appliedScenarioRules.find(C=>C.edition==M.identifier.edition&&C.scenario==M.identifier.scenario&&C.group==M.identifier.group&&C.index==M.identifier.index&&C.section==M.identifier.section))),this.game.sections&&this.game.sections.forEach(M=>{M.rules&&k.push(...M.rules.map((C,t)=>({identifier:{edition:M.edition,scenario:M.index,group:M.group,index:t,section:!0},rule:C})).filter(C=>C.rule.alwaysApply&&this.game.appliedScenarioRules.find(t=>t.edition==C.identifier.edition&&t.scenario==C.identifier.scenario&&t.group==C.identifier.group&&t.index==C.identifier.index&&t.section==C.identifier.section)))}),k.forEach(M=>{this.scnearioRuleActive(M.rule,M.identifier.index,M.identifier.section)&&this.applyRule(M.rule,M.identifier)})}applyScenarioRulesTurn(p,k=!1){const M=this.game.scenario;let C=[];M&&M.rules&&C.push(...M.rules.map((t,v)=>({identifier:{edition:M.edition,scenario:M.index,group:M.group,index:v,section:!1},rule:t})).filter(t=>t.rule.alwaysApplyTurn&&(!k&&"turn"==t.rule.alwaysApplyTurn||k&&"after"==t.rule.alwaysApplyTurn)&&this.game.appliedScenarioRules.find(v=>v.edition==t.identifier.edition&&v.scenario==t.identifier.scenario&&v.group==t.identifier.group&&v.index==t.identifier.index&&v.section==t.identifier.section))),this.game.sections&&this.game.sections.forEach(t=>{t.rules&&C.push(...t.rules.map((v,D)=>({identifier:{edition:t.edition,scenario:t.index,group:t.group,index:D,section:!0},rule:v})).filter(v=>v.rule.alwaysApplyTurn&&(!k&&"turn"==v.rule.alwaysApplyTurn||k&&"after"==v.rule.alwaysApplyTurn)&&this.game.appliedScenarioRules.find(D=>D.edition==v.identifier.edition&&D.scenario==v.identifier.scenario&&D.group==v.identifier.group&&D.index==v.identifier.index&&D.section==v.identifier.section)))}),C.forEach(t=>{this.applyRule(t.rule,t.identifier,[p])})}addScenarioErrata(){const p=this.game.scenario;p&&p.errata&&p.errata.split("|").forEach((k,M)=>{this.addScenarioRule(p,this.createErrataRule(p.edition,k),-1-M,!1)}),this.game.sections&&this.game.sections.forEach(k=>{k&&k.errata&&k.errata.split("|").forEach((M,C)=>{this.addScenarioRule(k,this.createErrataRule(k.edition,M),-1-C,!1)})})}createErrataRule(p,k){let M=new _model_data_ScenarioRule__WEBPACK_IMPORTED_MODULE_14__.lS("true");return M.always=!0,M.once=!0,M.note="%errata%:&nbsp;%data.custom."+p+".errata."+k+"%",M}filterDisabledScenarioRules(){this.game.scenarioRules=this.game.scenarioRules.filter((p,k,M)=>!M.find(C=>C.rule.disableRules&&C.rule.disableRules.some(t=>t.edition==p.identifier.edition&&t.group==p.identifier.group&&(t.index==p.identifier.index||-1==t.index)&&t.scenario==p.identifier.scenario&&t.section==p.identifier.section)))}scnearioRuleActive(rule,index,section,initial=!1){let round=rule.round||"false",active=!1;for(;-1!=round.indexOf("R");)round=round.replace("R",""+(rule.start?this.game.round+1:this.game.round));for(;-1!=round.indexOf("C");)round=round.replace("C",""+_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.characterManager.characterCount());try{active=eval(round)&&(rule.always||this.game.state==_model_Game__WEBPACK_IMPORTED_MODULE_4__.mk.next||rule.start&&initial)}catch(p){console.warn("Cannot apply scenario rule: '"+rule.round+"'","index: "+index,p),active=!1}if(active&&(rule.figures&&rule.figures.filter(p=>"present"==p.type||"dead"==p.type).length>0&&rule.figures.filter(p=>"present"==p.type||"dead"==p.type).forEach(p=>{const k=this.presentEntitiesByFigureRule(p,rule),M=p.value?(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(p.value.split(":")[0]):"present"==p.type?1:0;active=active&&M>=0&&("present"==p.type?k.length>=M:k.length<=M),p.identifier&&(p.identifier.marker||p.identifier.tags&&p.identifier.tags.length>0)&&!_SettingsManager__WEBPACK_IMPORTED_MODULE_16__.f.settings.automaticStandees&&(active=!1)}),active&&rule.figures&&rule.figures.filter(p=>"killed"==p.type).length>0&&rule.figures.filter(p=>"killed"==p.type).forEach(p=>{if(p.identifier){const k=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityCounters(p.identifier);if(active=active&&k.length>0,active)if("all"==p.value)k.forEach(M=>{active=active&&M&&M.total>0&&M.killed>=M.total||!1});else{const M=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(p.value||0);let C=0;k.forEach(t=>{C+=t.killed}),active=active&&C>0&&C>=M||!1}}else active=!1}),active&&rule.figures&&rule.figures.filter(p=>"initiative"==p.type).length>0&&rule.figures.filter(p=>"initiative"==p.type).forEach(figureRule=>{if(figureRule.identifier){const figures=this.figuresByFigureRule(figureRule,rule);active=active&&figures.length&&(null!=figures.find(figure=>!!figure.active&&(isNaN(+figureRule.value)?eval(figure.getInitiative()+" "+figureRule.value):figure.getInitiative()==+figureRule.value))||figures.every(figure=>!figure.active&&isNaN(+figureRule.value)&&!eval(figure.getInitiative()+" "+figureRule.value)))||!1}else active=!1}),rule.requiredRooms&&rule.requiredRooms.length&&rule.requiredRooms.forEach(p=>{active=active&&null!=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario&&-1!=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario.revealedRooms.indexOf(p)}),rule.requiredRules&&rule.requiredRules.length&&rule.requiredRules.forEach(p=>{active=active&&this.game.appliedScenarioRules.some(k=>p.edition==k.edition&&p.scenario==k.scenario&&p.group==k.group&&p.index==k.index&&p.section==k.section)}),rule.requiredScenarios&&rule.requiredScenarios.length&&rule.requiredScenarios.forEach(p=>{active=active&&null!=this.game.party.scenarios.find(k=>k.edition==p.edition&&k.index==p.index&&k.group==p.group)}),rule.rooms&&rule.rooms.length&&rule.rooms.every(p=>_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario&&-1!=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario.revealedRooms.indexOf(p))&&(active=!1),rule.treasures)){let p=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.figures.filter(k=>k instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K).map(k=>k.treasures.map(M=>"number"==typeof M?M:"G")).flat();if(("number"==typeof rule.treasures||"string"==typeof rule.treasures)&&p.length<(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(rule.treasures))active=!1;else if("number"!=typeof rule.treasures&&"string"!=typeof rule.treasures){let k=0;rule.treasures.forEach(M=>{const C=p.indexOf(M);-1!=C&&(p.splice(C,1),k++)}),k<rule.treasures.length&&(active=!1)}}return active}addScenarioRule(p,k,M,C,t=!1){const v=this.scnearioRuleActive(k,M,C,t),D={edition:p.edition,scenario:p.index,group:p.group,index:M,section:C},O=this.game.appliedScenarioRules.find(R=>R.edition==D.edition&&R.scenario==D.scenario&&R.group==D.group&&R.index==D.index&&R.section==D.section),A=this.game.discardedScenarioRules.find(R=>R.edition==D.edition&&R.scenario==D.scenario&&R.group==D.group&&R.index==D.index&&R.section==D.section),E=this.game.scenarioRules.find(R=>R.identifier.edition==D.edition&&R.identifier.scenario==D.scenario&&R.identifier.group==D.group&&R.identifier.index==D.index&&R.identifier.section==D.section);!v||O||A||E?!v&&k.always&&(this.game.scenarioRules=this.game.scenarioRules.filter(R=>R.identifier.edition!=D.edition||R.identifier.group!=D.group||R.identifier.index!=D.index||R.identifier.scenario!=D.scenario||R.identifier.section!=D.section)):(k.spawns&&k.spawns.forEach(R=>{R.manual&&!R.count&&0!=R.count&&(R.count=1)}),k.objectiveSpawns&&k.objectiveSpawns.forEach(R=>{R.manual&&!R.count&&0!=R.count&&(R.count=1)}),this.game.scenarioRules.push({identifier:D,rule:k}))}addActiveFigureRule(p,k=!1){const M=this.game.scenario;M&&M.rules&&M.rules.filter(C=>{if(C.figures){const t=C.figures.find(v=>v.type==(k?"afterTurn":"onTurn"));return null!=t&&this.figuresByFigureRule(t,C).some(v=>v.edition==p.edition&&v.name==p.name)}return!1}).forEach(C=>{this.addScenarioRule(M,C,M.rules.indexOf(C),!1)}),this.game.sections&&this.game.sections.forEach(C=>{C.rules&&C.rules.filter(t=>{if(t.figures){const v=t.figures.find(D=>D.type==(k?"afterTurn":"onTurn"));return null!=v&&this.figuresByFigureRule(v,t).some(D=>D.edition==p.edition&&D.name==p.name)}return!1}).forEach(t=>{this.addScenarioRule(C,t,C.rules.indexOf(t),!0)})}),this.filterDisabledScenarioRules()}getScenarioForRule(p){if(p.section){const k=this.game.sections.find(M=>M.edition==p.edition&&M.group==p.group&&M.index==p.scenario&&M.rules&&M.rules.length>p.index);if(k)return{scenario:k,section:!0}}else if(this.game.scenario&&this.game.scenario.edition==p.edition&&this.game.scenario.group==p.group&&this.game.scenario.index==p.scenario&&this.game.scenario.rules&&this.game.scenario.rules.length>p.index)return{scenario:this.game.scenario,section:!1};return{scenario:void 0,section:!1}}figuresByFigureRule(figureRule,rule){const ref=figureRule.identifierRef;return"number"==typeof ref?ref>=0&&ref<rule.figures.length&&ref!=rule.figures.indexOf(figureRule)&&rule.figures.indexOf(figureRule)!=rule.figures[ref].identifierRef?this.figuresByFigureRule(rule.figures[ref],rule):(console.warn("Invalid Figure Fule Identifier Ref!",ref,rule),[]):figureRule.identifier&&(figureRule.identifier.health||figureRule.identifier.hp||figureRule.identifier.conditions&&0!=figureRule.identifier.conditions.length)?_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.figuresByIdentifier(figureRule.identifier,figureRule.scenarioEffect).filter(figure=>{if(figureRule.identifier&&figureRule.identifier.number&&figure instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&figure.entities.every(entity=>figureRule.identifier&&figureRule.identifier.number&&!eval(figureRule.identifier.number.replaceAll("N",""+entity.number))))return!1;if(figureRule.identifier&&figureRule.identifier.health){if(figure instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K){const p=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(figureRule.identifier.health.replaceAll("H",""+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(figure.maxHealth)));return figure.health<=p}if(figure instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R||figure instanceof _model_ObjectiveContainer__WEBPACK_IMPORTED_MODULE_7__.$e)return figure.entities.some(p=>{if(figureRule.identifier&&figureRule.identifier.health&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.isAlive(p)){const k=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(figureRule.identifier.health.replaceAll("H",""+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(p.maxHealth)));return p.health<=k}return!1})}if(figureRule.identifier&&figureRule.identifier.hp){if(figure instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K)return eval(figureRule.identifier.hp.replaceAll("HP",""+figure.health).replaceAll("H",""+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(figure.maxHealth)));if(figure instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R||figure instanceof _model_ObjectiveContainer__WEBPACK_IMPORTED_MODULE_7__.$e)return figure.entities.some(entity=>{if(figureRule.identifier&&figureRule.identifier.hp&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.isAlive(entity)){const expression=figureRule.identifier.hp.replaceAll("HP",""+entity.health).replaceAll("H",""+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(entity.maxHealth));return eval(expression)}return!1})}if(figureRule.identifier&&figureRule.identifier.conditions){if(figure instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K)return figureRule.identifier.conditions.every(p=>p.startsWith("!")&&!_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.hasCondition(figure,new _model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.kW(p.substring(1)))||!p.startsWith("!")&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.hasCondition(figure,new _model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.kW(p)));if(figure instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R||figure instanceof _model_ObjectiveContainer__WEBPACK_IMPORTED_MODULE_7__.$e)return figure.entities.some(p=>!!(figureRule.identifier&&figureRule.identifier.health&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.isAlive(p))&&figureRule.identifier.conditions&&figureRule.identifier.conditions.every(k=>k.startsWith("!")&&!_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.hasCondition(p,new _model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.kW(k.substring(1)))||!k.startsWith("!")&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.hasCondition(p,new _model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.kW(k))))}return!1}):_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.figuresByIdentifier(figureRule.identifier,figureRule.scenarioEffect)}entitiesByFigureRule(figureRule,rule){const ref=figureRule.identifierRef;return"number"==typeof ref?rule&&ref>=0&&ref<rule.figures.length&&ref!=rule.figures.indexOf(figureRule)&&rule.figures.indexOf(figureRule)!=rule.figures[ref].identifierRef?this.entitiesByFigureRule(rule.figures[ref],rule):(console.warn("Invalid Figure Fule Identifier Ref!",ref,rule),[]):figureRule.identifier&&(figureRule.identifier.number||figureRule.identifier.health||figureRule.identifier.hp||figureRule.identifier.conditions&&0!=figureRule.identifier.conditions.length)?_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entitiesByIdentifier(figureRule.identifier,figureRule.scenarioEffect).filter(entity=>{let filter=!0;if(figureRule.identifier&&figureRule.identifier.health&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.isAlive(entity)){const p=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(figureRule.identifier.health.replaceAll("H",""+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(entity.maxHealth)));filter=filter&&entity.health<=p}if(figureRule.identifier&&figureRule.identifier.hp&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.isAlive(entity)){const expression=figureRule.identifier.hp.replaceAll("HP",""+entity.health).replaceAll("H",""+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(entity.maxHealth));filter=filter&&eval(expression)}return figureRule.identifier&&figureRule.identifier.conditions&&(filter=filter&&figureRule.identifier.conditions.every(p=>p.startsWith("!")&&!_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.hasCondition(entity,new _model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.kW(p.substring(1)))||!p.startsWith("!")&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.hasCondition(entity,new _model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.kW(p)))),figureRule.identifier&&figureRule.identifier.number&&(filter=filter&&eval(figureRule.identifier.number.replaceAll("N",""+entity.number))),figureRule.identifier&&figureRule.identifier.marker&&(entity instanceof _model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__.I||entity instanceof _model_ObjectiveEntity__WEBPACK_IMPORTED_MODULE_8__.X)&&(filter=filter&&figureRule.identifier.marker==entity.marker),filter}):_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entitiesByIdentifier(figureRule.identifier,figureRule.scenarioEffect)}presentEntitiesByFigureRule(p,k){return this.entitiesByFigureRule(p,k).filter(M=>(_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.isAlive(M)||M instanceof _model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__.I&&M.dormant)&&(!(M instanceof _model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__.I)||!p.identifier?.marker||p.identifier&&M.marker==p.identifier.marker&&(!p.identifier.tags||0==p.identifier.tags.length||p.identifier.tags.forEach(C=>-1!=M.tags.indexOf(C)))))}applyRule(p,k,M=void 0){const C=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.getScenarioForRule(k).scenario,t=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.getScenarioForRule(k).section;if(C){if(p.figures&&p.figures.filter(v=>"remove"==v.type).forEach(v=>{_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.figuresByFigureRule(v,p).forEach(O=>{O instanceof _model_ObjectiveContainer__WEBPACK_IMPORTED_MODULE_7__.$e?_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.objectiveManager.removeObjective(O):O instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.monsterManager.removeMonster(O)})}),p.spawns){let v=[];p.spawns.forEach(D=>{const O=this.spawnType(D.monster);C&&(O==_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_13__.N.boss||O==_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_13__.N.elite)&&v.push(...this.applySpawnRule(C,p,D,O))}),p.spawns.forEach(D=>{const O=this.spawnType(D.monster);C&&O==_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_13__.N.normal&&v.push(...this.applySpawnRule(C,p,D,O))})}if(p.objectiveSpawns&&p.objectiveSpawns.forEach(v=>{const D={edition:C.edition,scenario:C.index,group:C.group,section:t,index:v.objective.id-1},O=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.objectiveManager.objectiveDataByObjectiveIdentifier(D);if(O&&0!=v.count){const A=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(v.count||1);let E=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.objectiveManager.addObjective(O,O.name,D);E&&v.objective.marker&&(E.marker=v.objective.marker);for(let R=0;R<A;R++){const I=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.objectiveManager.addObjectiveEntity(E);v.objective.tags&&(I.tags=v.objective.tags),(E.marker||I.tags.length>0)&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.addEntityCount(E)}}}),p.elements&&p.elements.forEach(v=>{_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.elementBoard.forEach(D=>{v&&D.type==v.type&&(D.state=v.state)})}),p.figures&&(p.figures.filter(v=>"gainCondition"==v.type||"permanentCondition"==v.type||"loseCondition"==v.type||"damage"==v.type||"heal"==v.type||"setHp"==v.type||"dormant"==v.type||"activate"==v.type||"removeEntity"==v.type).forEach(v=>{let D=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.figuresByFigureRule(v,p),O=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.entitiesByFigureRule(v,p);D.forEach(A=>{_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.entitiesAll(A).filter(R=>-1!=O.indexOf(R)&&(!M||-1!=M.indexOf(R))).forEach(R=>{switch(v.type){case"gainCondition":let I=new _model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.kW(v.value);_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.hasCondition(R,I)||_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.addCondition(R,A,I);break;case"permanentCondition":let U=new _model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.kW(v.value);_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.hasCondition(R,U,!0)||_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.addCondition(R,A,U,!0);break;case"loseCondition":let X=new _model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.kW(v.value);_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.hasCondition(R,X)&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.removeCondition(R,A,X);break;case"damage":let T,s=0;s=isNaN(+v.value)&&-1!=v.value.indexOf("H")?+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(v.value.replaceAll("HP",""+R.health).replaceAll("H",""+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(R.maxHealth))):+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(v.value),A instanceof _model_ObjectiveContainer__WEBPACK_IMPORTED_MODULE_7__.$e&&A.objectiveId&&(T=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.objectiveManager.objectiveDataByObjectiveIdentifier(A.objectiveId)),T&&T.trackDamage?s*=-1:s<0?s=0:s>(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(R.maxHealth)&&(s=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(R.maxHealth)),_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.changeHealth(R,A,-s,!0);break;case"heal":let m=0;m=isNaN(+v.value)&&-1!=v.value.indexOf("H")?+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(v.value.replaceAll("HP",""+R.health).replaceAll("H",""+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(R.maxHealth))):+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(v.value),m<0&&(m=0),R.health+=m,_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.addCondition(R,A,new _model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.kW(_model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.r5.heal,m)),_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.applyCondition(R,A,_model_data_Condition__WEBPACK_IMPORTED_MODULE_10__.r5.heal,!0);break;case"setHp":let w=0;w=isNaN(+v.value)&&-1!=v.value.indexOf("H")?+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(v.value.replaceAll("HP",""+R.health).replaceAll("H",""+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(R.maxHealth))):+(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(v.value),w<0?w=0:w>(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(R.maxHealth)&&(w=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(R.maxHealth)),R.health=w;break;case"dormant":R instanceof _model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__.I&&(R.dormant=!0,R.revealed=!1);break;case"activate":R instanceof _model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__.I&&(R.dormant=!1);break;case"removeEntity":R.tags.push("ignore-kill"),R instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K?_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.characterManager.removeCharacter(R):A instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&R instanceof _model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__.I?_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.monsterManager.removeMonsterEntity(A,R):A instanceof _model_ObjectiveContainer__WEBPACK_IMPORTED_MODULE_7__.$e&&R instanceof _model_ObjectiveEntity__WEBPACK_IMPORTED_MODULE_8__.X&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.objectiveManager.removeObjectiveEntity(A,R),v.identifier&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityCounters(v.identifier).forEach(q=>{q.total-=1})}})})}),p.figures.filter(v=>"toggleOff"==v.type||"toggleOn"==v.type).forEach(v=>{_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.figuresByFigureRule(v,p).forEach(O=>{O.off="toggleOff"==v.type,O instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&O.entities.forEach(A=>{A.dormant="toggleOff"==v.type})})}),p.figures.filter(v=>"transfer"==v.type||"transferEntities"==v.type).forEach(v=>{const D=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.figuresByFigureRule(v,p),O=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.entitiesByFigureRule(v,p);if(1==D.length&&D[0]instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R){const A=D[0],E=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.monsterManager.addMonsterByName(v.value,C.edition);E&&("transfer"==v.type?(-1==v.value.indexOf(":")&&(E.level=A.level),E.active=A.active,E.drawExtra=A.drawExtra,E.lastDraw=A.lastDraw,E.ability=A.ability,E.isAlly=A.isAlly,E.isAllied=A.isAllied,v.identifier&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityCounters(v.identifier).forEach(R=>{R.total-=A.entities.length}),E.entities=[...E.entities,...A.entities],A.entities.forEach(R=>{_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.addEntityCount(E,R)})):(v.identifier&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityCounters(v.identifier).forEach(R=>{R.total-=O.length}),E.entities=[...E.entities,...O.filter(R=>R instanceof _model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__.I).map(R=>R)],O.forEach(R=>{_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.addEntityCount(E,R)})),E.entities.forEach(R=>{const I=A.stats.find(X=>X.level==A.level&&X.type==R.type),U=E.stats.find(X=>X.level==E.level&&X.type==R.type);U?(R.stat=U,I&&R.maxHealth==(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(I.health)&&(R.maxHealth=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(U.health))):(E.errors=E.errors||[],!E.errors.find(X=>X.type==_model_data_FigureError__WEBPACK_IMPORTED_MODULE_11__.H.unknown)&&!E.errors.find(X=>X.type==_model_data_FigureError__WEBPACK_IMPORTED_MODULE_11__.H.stat)&&(console.error("Could not find '"+R.type+"' stats for monster: "+E.name+" level: "+E.level),E.errors.push(new _model_data_FigureError__WEBPACK_IMPORTED_MODULE_11__.h(_model_data_FigureError__WEBPACK_IMPORTED_MODULE_11__.H.stat,"monster",E.name,E.edition,R.type,""+E.level)))),(R.health>R.maxHealth||0==R.maxHealth&&R.health>0)&&(R.health=R.maxHealth)}),E!=A&&("transfer"==v.type?_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.monsterManager.removeMonster(A):A.entities=A.entities.filter(R=>-1==O.indexOf(R))),E.off=0==_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.monsterManager.monsterEntityCount(E),A.off=0==_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.monsterManager.monsterEntityCount(A),_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.sortFigures(E))}else if(1==D.length&&D[0]instanceof _model_ObjectiveContainer__WEBPACK_IMPORTED_MODULE_7__.$e){const A=D[0],R=C.objectives[+v.value-1];let I=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.objectiveManager.addObjective(R,void 0,{edition:C.edition,scenario:C.index,group:C.group,section:t,index:+v.value-1});I.entities=A.entities,I.entities.forEach(U=>{U.maxHealth=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(A.health),U.health>U.maxHealth&&(U.health=U.maxHealth),R&&(R.tags&&(U.tags=R.tags),R.marker&&(U.marker=R.marker))}),_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.objectiveManager.removeObjective(A)}}),p.figures.filter(v=>"amAdd"==v.type||"amRemove"==v.type).forEach(v=>{_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.figuresByFigureRule(v,p).forEach(O=>{const A=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.attackModifierManager.byFigure(O),E=v.value.split(":")[0];let R=+v.value.split(":")[1];if("amAdd"==v.type)for(let I=0;I<R;I++){if(E==_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_9__.Yn.bless&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.attackModifierManager.countUpcomingBlesses()>=10)return;if(E==_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_9__.Yn.curse&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.attackModifierManager.countUpcomingCurses(O instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&!O.isAlly&&!O.isAllied)>=10)return;if(E==_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_9__.Yn.minus1&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.attackModifierManager.countExtraMinus1()>=15)return;_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.attackModifierManager.addModifier(A,new _model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_9__.uU(E))}else{let I=A.cards.find((U,X)=>U.type==E&&X>A.current);for(;I&&R>0;)A.cards.splice(A.cards.indexOf(I),1),I=A.cards.find((U,X)=>U.type==E&&X>A.current),R--;if(R>0){let U=A.cards.find(X=>X.type==E);for(;U&&R<0;)A.cards.splice(A.cards.indexOf(U),1),U=A.cards.find(X=>X.type==E),R--}}})}),p.figures.filter(v=>"setAbility"==v.type||"drawAbility"==v.type||"discardAbilityToBottom"==v.type||"removeAbility"==v.type).forEach(v=>{_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.figuresByFigureRule(v,p).forEach(O=>{if(O instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R)if("setAbility"==v.type||"removeAbility"==v.type){const A=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.abilities(O).find(E=>isNaN(+v.value)?E.name==v.value:E.cardId==+v.value);if(A){const E=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.abilities(O).indexOf(A);-1!=E&&(O.abilities=O.abilities.filter(R=>R!=E),"setAbility"==v.type&&(O.abilities.unshift(E),O.ability=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.state==_model_Game__WEBPACK_IMPORTED_MODULE_4__.mk.draw?-1:0))}}else"drawAbility"==v.type?_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.monsterManager.drawAbility(O):"discardAbilityToBottom"==v.type&&(0,_angular_cdk_drag_drop__WEBPACK_IMPORTED_MODULE_0__.HD)(O.abilities,O.ability,0)})})),p.statEffects&&p.statEffects.forEach(v=>{const D=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.figuresByIdentifier(v.identifier);let O=0;if(v.reference&&("present"==v.reference.type||"killed"==v.reference.type)){const A=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.presentEntitiesByFigureRule(v.reference,p).length,E=v.reference.value?(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(v.reference.value.split(":")[0]):0;O="present"==v.reference.type?A+E:E-A}D.forEach(A=>{if(A instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R){let E=new _model_data_MonsterStat__WEBPACK_IMPORTED_MODULE_12__.M;E.name=v.statEffect.name,v.statEffect.health&&(E.health=(""+v.statEffect.health).replaceAll("X",""+O)),v.statEffect.movement&&(E.movement=(""+v.statEffect.movement).replaceAll("X",""+O)),v.statEffect.attack&&(E.attack=(""+v.statEffect.attack).replaceAll("X",""+O)),v.statEffect.range&&(E.range=(""+v.statEffect.range).replaceAll("X",""+O)),E.initiative=v.statEffect.initiative,E.flying=v.statEffect.flying,E.actions=v.statEffect.actions,E.special=v.statEffect.special,E.immunities=v.statEffect.immunities,E.deck=v.statEffect.deck,E.absolute=v.statEffect.absolute||!1,E.note=v.note,A.statEffect=E.absolute||E.health||E.movement||E.attack||E.range||E.initiative||E.actions&&E.actions.length||E.immunities&&E.immunities.length||E.deck||E.name||null!=E.flying?E:void 0,A.statEffect&&A.statEffect.initiative&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.sortFigures()}})}),p.randomDungeon&&p.randomDungeon.monsterCount&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario){const v=(0,src_app_ui_helper_Static__WEBPACK_IMPORTED_MODULE_1__.Z)(_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.sectionData(_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario.edition,!0).filter(D=>"randomMonsterCard"==D.group&&p.randomDungeon&&(!p.randomDungeon.monsterCards||-1!=p.randomDungeon.monsterCards.indexOf(D.index))&&(!_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario||!_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario.additionalSections||-1==_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario.additionalSections.indexOf(D.index))));v.length>=p.randomDungeon.monsterCount&&(_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario.additionalSections=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario.additionalSections||[],_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.game.scenario.additionalSections.push(...v.slice(0,p.randomDungeon.monsterCount).map(D=>D.index)),p.randomDungeon.initial&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioManager.addSection(v[0]))}}}spawns(p){return p.spawns&&p.spawns.filter(k=>this.spawnType(k.monster))||[]}spawnType(p){let k=p.type;if(!k){const M=Math.max(2,_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.characterManager.characterCount());k=M<3?p.player2:3==M?p.player3:p.player4}return k}spawnCount(p,k){let M=k.count,C=0;if(M&&p.figures){const t=p.figures.find(v=>"present"==v.type||"dead"==v.type);if(t){const v=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.scenarioRulesManager.entitiesByFigureRule(t,p).filter(O=>_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.entityManager.isAlive(O)&&(!(O instanceof _model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__.I)||!t.identifier?.marker||O instanceof _model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__.I&&O.marker==t.identifier?.marker)),D=t.value&&t.value.split(":").length>1?(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(t.value.split(":")[1]):0;C="present"==t.type?v.length:Math.max(0,D-v.length)}}for(;"string"==typeof M&&-1!=M.indexOf("F");)M=M.replace("F",""+C);return(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(M||(k.manual?0:1))}applySpawnRule(p,k,M,C){const t=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.monsterManager.addMonsterByName(M.monster.name,p.edition);let v=[];if(t)for(let D=0;D<this.spawnCount(k,M);D++){let O=_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.monsterManager.spawnMonsterEntity(t,C,p.allies&&-1!=p.allies.indexOf(M.monster.name),p.allied&&-1!=p.allied.indexOf(M.monster.name),p.drawExtra&&-1!=p.drawExtra.indexOf(M.monster.name),M.summon);O&&(M.monster.marker&&(O.marker=M.monster.marker),M.monster.tags&&(O.tags=M.monster.tags),v.push(M.monster.name),(O.marker||O.tags.length>0)&&_GameManager__WEBPACK_IMPORTED_MODULE_15__.E.addEntityCount(t,O))}return v}}},1270:(p,k,M)=>{M.d(k,{CS:()=>v,tY:()=>C});class C{id="";name="";costs={prosperity:0,lumber:0,metal:0,hide:0,gold:0,manual:0};upgrades=[];repair=void 0;rebuild=[];effectNormal=[];effectWrecked=[];interactionsAvailable=[];interactionsUnavailable=[];requires="";rewards=[];prosperityUnlock=!1;envelope=void 0;coordinates=[];edition=""}class v{characters;characterSpent;fhSupportSpent;morale;constructor(O,A,E,R=0){this.characters=O,this.characterSpent=A,this.fhSupportSpent=E,this.morale=R}}},9733:(p,k,M)=>{M.d(k,{Ag:()=>O,Nz:()=>t,Pl:()=>D,jW:()=>v});var C=M(82e3);class t extends C.tB{custom;revealedRooms;additionalSections=[];constructor(E,R=[],I=[],U=!1){super(E),this.solo=E.solo,this.revealedRooms=JSON.parse(JSON.stringify(R)),this.additionalSections=JSON.parse(JSON.stringify(I)),E.rooms&&E.rooms.forEach(X=>{X.initial&&-1==this.revealedRooms.indexOf(X.roomNumber)&&this.revealedRooms.push(X.roomNumber)}),this.custom=U}}class v extends C.tB{isSuccess;isBlocked;isLocked;constructor(E,R,I,U){super(E),this.isSuccess=R,this.isBlocked=I,this.isLocked=U}}class D{globalAchievements=[];globalAchievementsCount=[];globalAchievementsMissing=[];partyAchievements=[];partyAchievementsCount=[];partyAchievementsMissing=[];campaignStickers=[];campaignStickersCount=[];campaignStickersMissing=[];buildings=[];buildingsLevel=[];buildingsLevelMissing=[];buildingsMissing=[];characters=[];charactersMissing=[];scenarios=[];isEmpty(){return 0==this.buildings.length&&0==this.buildingsLevel.length&&0==this.buildingsMissing.length&&0==this.buildingsLevelMissing.length&&0==this.campaignStickers.length&&0==this.campaignStickersCount.length&&0==this.campaignStickersMissing.length&&0==this.globalAchievements.length&&0==this.globalAchievementsCount.length&&0==this.globalAchievementsMissing.length&&0==this.partyAchievements.length&&0==this.partyAchievementsCount.length&&0==this.partyAchievementsMissing.length&&0==this.characters.length&&0==this.charactersMissing.length&&0==this.scenarios.length}}class O{index;edition;group;isCustom;custom;revealedRooms;additionalSections;constructor(E,R,I=void 0,U=!1,X="",s=void 0,T=void 0){this.index=E,this.edition=R,this.group=I,this.isCustom=U,this.custom=X,this.revealedRooms=s,this.additionalSections=T}}},12120:(p,k,M)=>{M.d(k,{Gq:()=>C,dy:()=>v,mC:()=>D,wd:()=>t});var C=function(O){return O.active="active",O.target="target",O.conditional="conditional",O.ally="ally",O.blank="blank",O.enhance="enhance",O.invisible="invisible",O}(C||{});class t{x=0;y=0;type=C.active;value="";constructor(A,E,R,I){this.x=A,this.y=E,this.type=R,this.value=I}}function v(O){let A=new RegExp(/^\((\d+),(\d+),(active|target|conditional|ally|blank|enhance|invisible)(\:(\w*))?\)$/).exec(O);if(null==A)return null;let E="";return A.length>5&&A[5]&&(E=A[5]),new t(+A[1],+A[2],A[3],E)}function D(O){return"("+O.x+","+O.y+","+C[O.type]+(O.value?":"+O.value:"")+")"}},13812:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{LK:()=>EntityValueRegexExtended,OD:()=>EntityValueRegex,hZ:()=>EntityValueFunction,p5:()=>EntityExpressionRegex});var _businesslogic_GameManager__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(58317),_Game__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(29765);const EntityExpressionRegex=/^([xCL0-9\.\+\/\-\*\(\)\=\?\:\|\s\>\<]+)$/,EntityValueRegex=/\[([xCL0-9\.\+\/\-\*\(\)\=\?\:\|\s\>\<]+)(\{(.*)\})?\]/,EntityValueRegexExtended=/\[([a-zA-Z0-9\.\+\/\-\*\(\)\=\?\:\|\s\>\<]+)(\{(.*)\})?\]/;function EntityValueFunction(value,L=void 0){if(!value)return 0;if("number"==typeof value)return value;if("-"==value)return 0;let expression=value,func;const match=value.match(EntityValueRegex);match&&match[0].length==value.length&&(expression=match[1],func=match[3]),null==L&&(L=_businesslogic_GameManager__WEBPACK_IMPORTED_MODULE_0__.E.game.level),expression=expression.replace(/[x]/g,"*"),expression=expression.replace(/[C]/g,""+Math.max(2,_businesslogic_GameManager__WEBPACK_IMPORTED_MODULE_0__.E.characterManager.characterCount())),expression=expression.replace(/[L]/g,""+L),expression=expression.replace(/[P]/g,""+_businesslogic_GameManager__WEBPACK_IMPORTED_MODULE_0__.E.prosperityLevel()),expression=expression.replace(/[R]/g,""+(_businesslogic_GameManager__WEBPACK_IMPORTED_MODULE_0__.E.game.round+(_businesslogic_GameManager__WEBPACK_IMPORTED_MODULE_0__.E.game.state==_Game__WEBPACK_IMPORTED_MODULE_1__.mk.draw?1:0)));let result=0,funcValue;try{result=eval(expression)}catch(p){return console.warn("Could not evaluate expression: "+expression,p),0}if(func&&func.startsWith("$")&&(func=func.replace("$",""),-1!=func.indexOf(":")&&(funcValue=+func.split(":")[1],func=func.split(":")[0])),func)switch(!0){case"math.ceil"==func:result=Math.ceil(result);break;case"math.floor"==func:result=Math.floor(result);break;case"math.max"==func&&null!=funcValue:result=Math.min(result,funcValue);break;case"math.maxCeil"==func&&null!=funcValue:result=Math.ceil(Math.min(result,funcValue));break;case"math.maxFloor"==func&&null!=funcValue:result=Math.floor(Math.min(result,funcValue));break;case"math.min"==func&&null!=funcValue:result=Math.max(result,funcValue);break;case"math.minCeil"==func&&null!=funcValue:result=Math.ceil(Math.max(result,funcValue));break;case"math.minFloor"==func&&null!=funcValue:result=Math.floor(Math.max(result,funcValue));break;default:console.error("Unknown expression: "+func+"("+match+")")}return Math.round(result)}},14670:(p,k,M)=>{M.d(k,{DJ:()=>A,It:()=>X,KZ:()=>O,L$:()=>m,T8:()=>U,Z:()=>D,bb:()=>T,co:()=>w,gP:()=>E,n1:()=>I,oB:()=>R,yE:()=>q});var C=M(81570),t=M(31619);function v(){return+window.getComputedStyle(document.body).getPropertyValue("--ghs-width").replace(/[^\d\+]/g,"")/+window.getComputedStyle(document.body).getPropertyValue("--ghs-factor")}function D(P){let $,S=P.length;for(;0!=S;)$=Math.floor(Math.random()*S),S--,[P[S],P[$]]=[P[$],P[S]];return P}function O(P,S=!1){return S?P.filter($=>$.spoiler&&-1==t.f.settings.spoilers.indexOf($.name)).length>1:P.some($=>$.spoiler&&-1==t.f.settings.spoilers.indexOf($.name))}function A(P){return!P.spoiler||-1!=t.f.settings.spoilers.indexOf("[ALL]")||-1!=t.f.settings.spoilers.indexOf(P.name)}function E(P){return P.filter(S=>!A(S))}function R(P,S,$=!1){return $?P.toLowerCase()==S.toLowerCase():S.split(" ").every(V=>-1!=P.toLowerCase().indexOf(V.toLowerCase()))}function I(P,S=!1){return P>0?"+"+P:S&&0==P?"-":""+P}function U(P,S=!1){let $=Math.floor(P);const V=Math.floor($/86400);$-=86400*V;const N=Math.floor($/3600);$-=3600*N;const K=Math.floor($/60);$-=60*K;let Y=t.f.getLabel("duration."+((V?"days":N&&"hours")||K&&"minutes"||"seconds"),[$,K,N,V].map(j=>""+j),!1);return S&&(Y=t.f.getLabel("duration.totalHours",[Y,(P/3600).toFixed(1)])),Y}function X(){t.f.settings.fullscreen&&document.fullscreenElement&&(document.exitFullscreen&&document.exitFullscreen(),document.body.classList.add("fullscreen")),window.addEventListener("focus",s,!0)}function s(P){setTimeout(()=>{if(t.f.settings.fullscreen&&!document.fullscreenElement){try{document.body.requestFullscreen&&document.body.requestFullscreen()}catch{}document.body.classList.remove("fullscreen")}window.removeEventListener("focus",s,!0)})}function T(P){return!P.metaKey&&(!window.document.activeElement||"INPUT"!=window.document.activeElement.tagName&&"SELECT"!=window.document.activeElement.tagName&&"TEXTAREA"!=window.document.activeElement.tagName)}function m(P,S){return(P%S+S)%S}function w(P,S=void 0){t.f.settings.animations&&P.overlayRef.overlayElement?(P.overlayRef.overlayElement.classList.add("dialog-closing"),P.overlayRef.hostElement&&P.overlayRef.hostElement.getElementsByClassName("dialog-close-button")[0]&&P.overlayRef.hostElement.getElementsByClassName("dialog-close-button")[0].classList.add("closing"),P.overlayRef.backdropElement&&P.overlayRef.backdropElement.classList.add("backdrop-closing"),setTimeout(()=>P.close(S),250)):P.close(S)}function q(P="right"){const V=[new C.uH({originX:"end",originY:"top"},{overlayX:"start",overlayY:"top"},1.5*v(),-3*v()),new C.uH({originX:"end",originY:"center"},{overlayX:"start",overlayY:"center"}),new C.uH({originX:"end",originY:"bottom"},{overlayX:"start",overlayY:"bottom"},1.5*v(),3*v())],N=[new C.uH({originX:"start",originY:"top"},{overlayX:"end",overlayY:"top"},-1.5*v(),-3*v()),new C.uH({originX:"start",originY:"center"},{overlayX:"end",overlayY:"center"}),new C.uH({originX:"start",originY:"bottom"},{overlayX:"end",overlayY:"bottom"},-1.5*v(),3*v())],K=[new C.uH({originX:"center",originY:"bottom"},{overlayX:"center",overlayY:"top"},0,3*v()),new C.uH({originX:"center",originY:"center"},{overlayX:"center",overlayY:"center"}),new C.uH({originX:"center",originY:"top"},{overlayX:"center",overlayY:"bottom"},0,-3*v())];switch(P){case"right":return[...V,...N,...K];case"left":return[...N,...V,...K];case"center":return[...K,...N,...V]}}},16538:(p,k,M)=>{M.d(k,{N:()=>C});var C=function(t){return t.normal="normal",t.elite="elite",t.boss="boss",t}(C||{})},18102:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>AttackModifierManager});var src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(73219),src_app_ui_helper_Static__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(14670),_model_Character__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(51824),_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(93417),_model_Entity__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(13812),_model_Monster__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(42065),_GameManager__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(58317),_SettingsManager__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(31619);class AttackModifierManager{game;constructor(p){this.game=p}byFigure(p){return p instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K?p.attackModifierDeck:p instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R?(_SettingsManager__WEBPACK_IMPORTED_MODULE_7__.f.settings.alwaysAllyAttackModifierDeck||_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.fhRules())&&(p.isAlly||p.isAllied)?this.game.allyAttackModifierDeck:this.game.monsterAttackModifierDeck:new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.J}countUpcomingBlesses(){let p=0;return(_SettingsManager__WEBPACK_IMPORTED_MODULE_7__.f.settings.alwaysAllyAttackModifierDeck||_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.fhRules()&&_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.game.figures.some(k=>k instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&(k.isAlly||k.isAllied)))&&(p+=_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.game.allyAttackModifierDeck.cards.filter((k,M)=>k.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.bless&&M>_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.game.allyAttackModifierDeck.current).length),p+=_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.game.monsterAttackModifierDeck.cards.filter((k,M)=>k.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.bless&&M>_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.game.monsterAttackModifierDeck.current).length,_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.game.figures.filter(k=>k instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K).map(k=>k).forEach(k=>{p+=k.attackModifierDeck.cards.filter((M,C)=>M.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.bless&&C>k.attackModifierDeck.current).length}),p}countUpcomingCurses(p){if(p)return _GameManager__WEBPACK_IMPORTED_MODULE_6__.E.game.monsterAttackModifierDeck.cards.filter((M,C)=>M.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.curse&&C>_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.game.monsterAttackModifierDeck.current).length;let k=0;return(_SettingsManager__WEBPACK_IMPORTED_MODULE_7__.f.settings.alwaysAllyAttackModifierDeck||_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.fhRules()&&_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.game.figures.some(M=>M instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&(M.isAlly||M.isAllied)))&&(k+=_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.game.allyAttackModifierDeck.cards.filter((M,C)=>M.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.curse&&C>_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.game.allyAttackModifierDeck.current).length),_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.game.figures.filter(M=>M instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K).map(M=>M).forEach(M=>{k+=M.attackModifierDeck.cards.filter((C,t)=>C.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.curse&&t>M.attackModifierDeck.current).length}),k}getAdditional(p,k,M=!1){let C=[];return p.additionalModifier.find(t=>t.attackModifier&&t.attackModifier.type==k)&&p.additionalModifier.forEach((t,v)=>{if(t.attackModifier&&t.attackModifier.type==k){let D=Object.assign(new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(t.attackModifier.type,t.attackModifier.value,t.attackModifier.valueType),t.attackModifier);D.id="additional-"+p.name+v,D.character=!0;const O=M?0:this.countUpcomingAdditional(p,k);for(let A=0;A<t.count-O;A++)C.push(JSON.parse(JSON.stringify(D)))}}),C}getAllAdditional(){let p=[];return _GameManager__WEBPACK_IMPORTED_MODULE_6__.E.charactersData().forEach(k=>{k.additionalModifier.find(M=>M.attackModifier)&&k.additionalModifier.forEach((M,C)=>{if(M.attackModifier){let t=Object.assign(new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(M.attackModifier.type,M.attackModifier.value,M.attackModifier.valueType),M.attackModifier);t.id="additional-"+k.name+C,t.character=!0;for(let v=0;v<M.count;v++)p.push(JSON.parse(JSON.stringify(t)))}})}),p}countUpcomingAdditional(p,k){let M=0;return(_SettingsManager__WEBPACK_IMPORTED_MODULE_7__.f.settings.alwaysAllyAttackModifierDeck||_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.fhRules()&&_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.game.figures.some(C=>C instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&(C.isAlly||C.isAllied)))&&(M+=_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.game.allyAttackModifierDeck.cards.filter((C,t)=>t>_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.game.allyAttackModifierDeck.current&&C.type==k&&C.id&&C.id.startsWith("additional-"+p.name)).length),M+=_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.game.monsterAttackModifierDeck.cards.filter((C,t)=>t>_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.game.monsterAttackModifierDeck.current&&C.type==k&&C.id&&C.id.startsWith("additional-"+p.name)).length,_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.game.figures.filter(C=>C instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K).map(C=>C).forEach(C=>{M+=C.attackModifierDeck.cards.filter((t,v)=>v>C.attackModifierDeck.current&&t.type==k&&t.id&&t.id.startsWith("additional-"+p.name)).length}),M}countExtraMinus1(){let p=0;return(_SettingsManager__WEBPACK_IMPORTED_MODULE_7__.f.settings.alwaysAllyAttackModifierDeck||_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.fhRules()&&_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.game.figures.some(k=>k instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&(k.isAlly||k.isAllied)))&&(p+=_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.game.allyAttackModifierDeck.cards.filter(k=>k.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.minus1extra).length),p+=_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.game.monsterAttackModifierDeck.cards.filter(k=>k.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.minus1extra).length,_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.game.figures.filter(k=>k instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K).map(k=>k).forEach(k=>{p+=k.attackModifierDeck.cards.filter(M=>M.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.minus1extra).length}),p}addModifier(p,k,M=-1){(M<0||M>p.cards.length)&&(M=Math.floor(Math.random()*(p.cards.length-p.current))+p.current+1,this.shuffleModifiers(p,!0)),p.cards.splice(M,0,k)}addModifierByType(p,k){this.addModifier(p,new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(k))}removeModifierByType(p,k){const M=p.cards.find(C=>C.type==k);M&&p.cards.splice(p.cards.indexOf(M),1)}drawModifier(p,k){p.bb?this.drawBB(p,k):p.current>=p.cards.length-1?this.shuffleModifiers(p):k?this.drawAdvantage(p,k):this.drawNormal(p)}drawNormal(p){if(p.current=p.current+1,p.state&&(p.lastVisible=p.current),p.state=void 0,_SettingsManager__WEBPACK_IMPORTED_MODULE_7__.f.settings.amAdvantage){let k=p.cards[p.current];if(k&&k.rolling)for(;k.rolling;){if(p.current==p.cards.length-1)return;p.current=p.current+1,k=p.cards[p.current],this.updateLastVisible(p)}}this.updateLastVisible(p)}updateLastVisible(p){let k=0;p.cards.slice(p.lastVisible,p.current+1).reverse().forEach((M,C)=>{M.rolling||k++,3==k&&(p.lastVisible=p.current-C+1,k++)}),_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.uiChange.emit()}drawAdvantage(p,k){let M=!1;const C=_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.fhRules()||_SettingsManager__WEBPACK_IMPORTED_MODULE_7__.f.settings.alwaysFhAdvantage;if(p.current=p.current+1,p.lastVisible=p.current,p.state=k,p.current==p.cards.length)return;_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.uiChange.emit();let t=p.cards[p.current];if(t&&t.rolling)for(M=C;t.rolling;){if(p.current==p.cards.length-1)return;p.current=p.current+1,t=p.cards[p.current],_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.uiChange.emit()}else if(p.current=p.current+1,t=p.cards[p.current],_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.uiChange.emit(),C&&_SettingsManager__WEBPACK_IMPORTED_MODULE_7__.f.settings.amAdvantageHouseRule&&t&&t.rolling)for(;t.rolling;){if(p.current==p.cards.length-1)return;p.current=p.current+1,t=p.cards[p.current],_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.uiChange.emit()}if(M){if(p.current==p.cards.length-1)return;p.current=p.current+1,_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.uiChange.emit()}}drawBB(p,k){let M=Math.floor(p.current/3)+1;if(p.state=k,M>=Math.floor(p.cards.length/3))p.current=-1,p.lastVisible=-1;else if(p.current=3*M+Math.floor(3*Math.random()),k){let C=M+1;C>=Math.floor(p.cards.length/3)&&(C=0);const t=3*C+Math.floor(3*Math.random());p.lastVisible=p.current,p.current=t}else p.lastVisible=p.current}shuffleModifiers(p,k=!1){if(p.bb)return p.current=-1,void(p.lastVisible=-1);const M=p.current,C=p.lastVisible;let t=k&&M>-1?p.cards.splice(0,M+1):[];k||(p.cards=p.cards.filter((v,D)=>D>p.current||v.type!=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.bless&&v.type!=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.curse&&v.type!=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.empower&&v.type!=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.enfeeble)),_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.challengesManager.apply&&_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.challengesManager.isActive(1500,"fh")&&(p.cards=p.cards.filter((v,D)=>D>p.current||v.type!=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.minus1&&v.type!=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.minus2)),p.current=-1,p.lastVisible=0,p.discarded=[],(0,src_app_ui_helper_Static__WEBPACK_IMPORTED_MODULE_1__.Z)(p.cards),k&&(p.current=M,p.lastVisible=C,p.cards.unshift(...t))}removeDrawnDiscards(p){const k=p.cards.length;p.cards=p.cards.filter((M,C)=>C>p.current||M.type!=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.bless&&M.type!=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.curse&&M.type!=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.empower&&M.type!=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.enfeeble),p.current=p.current-(k-p.cards.length)}next(){this.checkShuffle(this.game.monsterAttackModifierDeck),this.checkShuffle(this.game.allyAttackModifierDeck),this.game.figures.forEach(p=>{p instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K&&this.checkShuffle(p.attackModifierDeck)})}firstRound(){this.shuffleModifiers(this.game.monsterAttackModifierDeck),this.shuffleModifiers(this.game.allyAttackModifierDeck),this.game.figures.forEach(p=>{p instanceof _model_Character__WEBPACK_IMPORTED_MODULE_2__.K&&this.shuffleModifiers(p.attackModifierDeck)})}checkShuffle(p){!p.bb&&p.cards.some((k,M)=>M<=p.current&&k.shuffle)&&this.shuffleModifiers(p)}buildCharacterAttackModifierDeck(p){if(p.bb&&p.amTables&&p.amTables.length>=p.level&&p.amTables[p.level-1])return new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.J(p.amTables[p.level-1].map((C,t)=>{if("string"==typeof C){let v=new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(C);return v.character=!0,v}{let v=C;return v.character=!0,v.id="bb-"+p.level+"-"+t,v}}),_SettingsManager__WEBPACK_IMPORTED_MODULE_7__.f.settings.bbAm);let k=new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.J,M=0;if(p.perks.forEach(C=>{C.cards&&C.cards.forEach((t,v)=>{if(C.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.add||C.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.replace){let D=Object.assign(new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(t.attackModifier.type,t.attackModifier.value,t.attackModifier.valueType),t.attackModifier);D.id="perk"+M,D.shuffle=t.attackModifier.shuffle||!1,(!this.findByAttackModifier(src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.zs,D)||C.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.add||v>0)&&(D.character=!0),this.findByAttackModifier(k.attackModifiers,D)||(M++,k.attackModifiers.push(D))}})}),p.progress&&p.progress.perks&&p.progress.perks.forEach((C,t)=>{const v=p.perks[t];if(v)if(v.combined)C==v.count&&this.addPerkCard(v,k,src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.zs);else for(let D=0;D<C;D++)this.addPerkCard(v,k,src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.zs)}),_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.trialsManager.apply&&_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.trialsManager.trialsEnabled&&p.progress.trial&&"fh"==p.progress.trial.edition&&"348"==p.progress.trial.name&&(k=new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.J,k.cards=k.cards.filter(C=>-1==[src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.double,src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.plus1,src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.plus2].indexOf(C.type))),!_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.characterManager.ignoreNegativeItemEffects(p))for(let C of p.progress.equippedItems){const t=_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.itemManager.getItem(C.name,C.edition,!0);if(t&&t.minusOne)for(let v=0;v<t.minusOne;v++)this.addModifier(k,new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.minus1))}if(p.progress.equippedItems.find(C=>"gh"==C.edition&&"101"==C.name)){let C=k.cards.find(t=>t.id==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.minus1);C&&(k.cards.splice(k.cards.indexOf(C),1),C=k.cards.find(t=>t.id==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.minus1),C&&k.cards.splice(k.cards.indexOf(C),1))}if(p.progress.equippedItems.find(C=>"toa"==C.edition&&"107"==C.name)){const C=k.cards.find(t=>t.id==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.minus2);C&&k.cards.splice(k.cards.indexOf(C),1)}if(p.progress.equippedItems.find(C=>"fh"==C.edition&&"11"==C.name)){const C=k.cards.find(t=>t.id==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.minus1);C&&k.cards.splice(k.cards.indexOf(C),1)}if(p.progress.equippedItems.find(C=>"fh"==C.edition&&"41"==C.name)){const C=k.cards.find(v=>v.id==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.plus0);C&&k.cards.splice(k.cards.indexOf(C),1);const t=k.cards.find(v=>v.id==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.minus1);t&&k.cards.splice(k.cards.indexOf(t),1)}return k}buildTownGuardAttackModifierDeck(p,k){const M=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.IK.map(v=>v.clone()),C=new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.J(M);C.attackModifiers.push(...src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.qq);let t=0;return k.townGuardPerks&&(k.townGuardPerks.forEach(v=>{const D=v.perk;D.cards&&D.cards.forEach((O,A)=>{if(D.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.add||D.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.replace){let E=Object.assign(new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(O.attackModifier.type,O.attackModifier.value,O.attackModifier.valueType),O.attackModifier);E.id="perk"+t,(!this.findByAttackModifier(M,E)||D.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.add||A>0)&&(E.character=!0),this.findByAttackModifier(C.attackModifiers,E)||(t++,C.attackModifiers.push(E))}})}),p.townGuardPerkSections&&k.townGuardPerks.forEach(v=>{const D=v.perk;if(!D)return;const O=v.sections.filter(A=>-1!=p.townGuardPerkSections.indexOf(A)).length;if(D.combined)O==D.count&&this.addPerkCard(D,C,M);else for(let A=0;A<O;A++)this.addPerkCard(D,C,M)}),p.scenarios.forEach(v=>{const D=_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.scenarioManager.scenarioDataForModel(v);D&&D.rewards&&D.rewards.townGuardAm&&D.rewards.townGuardAm.forEach((O,A)=>{let E=C.attackModifiers.find(R=>R.id==O);E?C.cards.push(E.clone()):console.warn("Unknown Town Guard AM:",O)})}),p.conclusions.forEach(v=>{const D=_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.scenarioManager.sectionDataForModel(v);D&&D.rewards&&D.rewards.townGuardAm&&D.rewards.townGuardAm.forEach((O,A)=>{let E=C.attackModifiers.find(R=>R.id==O);E?C.cards.push(E.clone()):console.warn("Unknown Town Guard AM:",O)})})),C}addPerkCard(p,k,M){if(p.cards=p.cards||[],p.cards.forEach((C,t)=>{(!this.findByAttackModifier(M,C.attackModifier)||p.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.add||p.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.replace&&t>=this.replaceCount(p))&&(C.attackModifier.character=!0)}),p.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.add)this.addCards(k,p.cards);else if(p.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.remove)this.removeCards(k,p.cards);else if(p.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.replace){const C=this.replaceCount(p);C&&(this.removeCards(k,p.cards.slice(0,C)),this.addCards(k,p.cards.slice(C,p.cards.length)))}}perkCards(p){let k=[];return p.perks.forEach(M=>{for(let C=0;C<(M.combined?1:M.count);C++)M.cards&&M.cards.forEach((t,v)=>{(M.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.add||M.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.replace&&v>=this.replaceCount(M))&&k.push(Object.assign(new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(t.attackModifier.type,t.attackModifier.value,t.attackModifier.valueType),t.attackModifier))})}),k}replaceCount(p){let k=0;return p.type==_model_data_Perks__WEBPACK_IMPORTED_MODULE_3__.RU.replace&&(k=1,p.cards.forEach((M,C,t)=>{let v=t.slice(0,C+1).map(D=>D.count).reduce((D,O)=>D+O);C<t.length-1&&v<=t.slice(C+1,t.length).map(D=>D.count).reduce((D,O)=>D+O)&&(v=C+1)})),k}findByAttackModifier(p,k,M=!1){return p.find(C=>{let t=Object.assign(new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(k.type,k.value,k.valueType),k);t.id="",t.revealed=!1,t.shuffle=k.shuffle||!1;let v=Object.assign(new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(C.type,C.value,C.valueType),C);return v.id="",v.revealed=!1,v.shuffle=C.shuffle||!1,M&&v.character&&(v.character=!1),JSON.stringify(t)==JSON.stringify(v)})}addCards(p,k){k.forEach(M=>{for(let C=0;C<M.count;C++){const t=this.findByAttackModifier(p.attackModifiers,M.attackModifier);if(t){let v=Object.assign(new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(t.type,t.value,t.valueType),t);p.cards.push(v)}else console.warn("Did not found AM to add: ",M.attackModifier,p)}})}removeCards(p,k){k.forEach(M=>{for(let C=0;C<M.count;C++){let t=!1,v=this.findByAttackModifier(p.cards,M.attackModifier);if(v){const D=p.cards.indexOf(v);p.cards.splice(D,1),t=!0}else if(!M.attackModifier.id&&!M.attackModifier.character&&(v=this.findByAttackModifier(p.cards,M.attackModifier,!0),v)){const D=p.cards.indexOf(v);p.cards.splice(D,1),t=!0}t||console.warn("Did not found AM to remove: ",M.attackModifier,p)}})}cardById(p,k){let M=p.attackModifiers.find(C=>C.id==k);if(M||(M=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.zs.find(C=>C.id==k),M||(M=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.bx.find(C=>C.id==k)),M||(M=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.iy.find(C=>C.id==k)),M||(M=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.u3.find(C=>C.id==k)),M||(M=this.getAllAdditional().find(C=>C.id==k)),M||(M=this.findForChallenge(k)),M||(M=src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.IK.find(C=>C.id==k)),M))return JSON.parse(JSON.stringify(M))}findForChallenge(p){if(p.startsWith("challenge-fh-1503-")){const k=p.replace("challenge-fh-1503-","").split("-")[0],M=+p.replace("challenge-fh-1503-","").split("-")[1],C=_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.charactersData("fh").find(t=>"fh"==t.edition&&t.name==k);if(C){let t=this.perkCards(C)[M];if(t)return t.id="challenge-fh-1503-"+C.name+"-"+M,t.character=!0,t}}}fromModel(p,k){p.current=k.current,p.lastVisible=k.lastVisible,k.cards=k.cards.map(M=>("success"==M?M="tg-success":"wreck"==M?M="tg-wreck":"scenario-reward-55-0"==M?M="fh-tg-add-plus50-algox":"scenario-reward-56-0"==M||"scenario-reward-57-0"==M?M="fh-tg-add-plus50":"scenario-reward-58-0"==M||"scenario-reward-59-0"==M?M="fh-tg-add-plus50-unfettered":"scenario-reward-60-0"==M?M="fh-tg-add-plus50-lurkers":"conclusion-reward-50.2-0"==M&&(M="fh-tg-add-plus20"),M)),p.cards=k.cards.map(M=>this.cardById(p,M)||new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.uU(src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.invalid,0,src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.tW.default,M)),p.discarded=k.discarded||k.disgarded||[],p.active=k.active,p.state=k.state,p.bb=k.bb}calculateAttackResult(attackModifierDeck,base,forceIndex=-1){if(attackModifierDeck.current<0)return void console.warn("No Attack Modifier drawn",attackModifierDeck);let result=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_4__.hZ)(base),stringified="",rollingOffset=1,firstCard=attackModifierDeck.cards[attackModifierDeck.current],secondCard=attackModifierDeck.cards[attackModifierDeck.current-1],baseCard=firstCard,chooseOffset=0,effects=[];const fh=_GameManager__WEBPACK_IMPORTED_MODULE_6__.E.fhRules()||_SettingsManager__WEBPACK_IMPORTED_MODULE_7__.f.settings.alwaysFhAdvantage;if(attackModifierDeck.state){switch(attackModifierDeck.state){case"advantage":fh?(rollingOffset=2,chooseOffset=-1,this.applyAttackModifier(result,secondCard)>this.applyAttackModifier(result,baseCard)&&(baseCard=secondCard,chooseOffset=1),firstCard.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.success||secondCard.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.wreck?(baseCard=firstCard,chooseOffset=-1):(secondCard.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.success||firstCard.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.wreck)&&(baseCard=secondCard,chooseOffset=1)):baseCard.rolling?(baseCard=secondCard,rollingOffset=0):!secondCard.rolling&&this.applyAttackModifier(result,secondCard)>this.applyAttackModifier(result,baseCard)&&(baseCard=secondCard,chooseOffset=1);break;case"disadvantage":fh&&(chooseOffset=-1,firstCard.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.wreck||secondCard.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.success?(baseCard=firstCard,chooseOffset=-1):(secondCard.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.wreck||firstCard.type==src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.Yn.success)&&(baseCard=secondCard,chooseOffset=1)),(this.applyAttackModifier(result,secondCard)<this.applyAttackModifier(result,baseCard)||!fh&&baseCard.rolling)&&(baseCard=secondCard,(fh||!baseCard.rolling)&&(chooseOffset=1))}-1!=forceIndex&&(baseCard=attackModifierDeck.cards[forceIndex],chooseOffset=attackModifierDeck.current-forceIndex-(forceIndex==attackModifierDeck.current?1:0))}if("disadvantage"!=attackModifierDeck.state&&attackModifierDeck.current-rollingOffset>-1){let p=attackModifierDeck.cards[attackModifierDeck.current-rollingOffset];for(;p&&p.rolling&&attackModifierDeck.current-rollingOffset>=attackModifierDeck.lastVisible;)result=this.applyAttackModifier(result,p),stringified+=this.stringifyAttackModifierValue(p),effects.push(...p.effects),rollingOffset++,p=attackModifierDeck.current-rollingOffset>-1?attackModifierDeck.cards[attackModifierDeck.current-rollingOffset]:void 0}result=this.applyAttackModifier(result,baseCard),stringified+=this.stringifyAttackModifierValue(baseCard);const matches=stringified.match(/x\d+/g)||[];return stringified=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_4__.hZ)(base)+stringified.replace(/x\d+/g,""),matches.length&&(stringified="("+stringified+")"+matches.join("")),effects.push(...baseCard.effects),new src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.oz(attackModifierDeck.cards.indexOf(baseCard),chooseOffset,attackModifierDeck.state,base,stringified,eval(stringified.replaceAll("x","*")),effects)}applyAttackModifier(p,k){switch(k.valueType){case src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.tW.default:return k.value&&console.warn("Possible invalid AM",k),p;case src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.tW.plus:return p+k.value;case src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.tW.minus:return p-k.value;case src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.tW.multiply:return p*k.value}}stringifyAttackModifierValue(p){switch(p.valueType){case src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.tW.default:return p.value&&console.warn("Possible invalid AM",p),"+"+p.value;case src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.tW.plus:return"+"+p.value;case src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.tW.minus:return"-"+p.value;case src_app_game_model_data_AttackModifier__WEBPACK_IMPORTED_MODULE_0__.tW.multiply:return"x"+p.value}}}},24074:(p,k,M)=>{M.d(k,{J:()=>C,V:()=>t});var C=function(v){return v.square="square",v.circle="circle",v.diamond="diamond",v.diamond_plus="diamond_plus",v.hex="hex",v.any="any",v}(C||{});class t{cardId;actionIndex;index;action;inherited;constructor(D,O,A,E,R=!1){this.cardId=D,this.actionIndex=O,this.index=A,this.action=E,this.inherited=R}}},25532:(p,k,M)=>{M.d(k,{Hg:()=>C,O7:()=>D,e_:()=>t,em:()=>v});var C=function(O){return O.fire="fire",O.ice="ice",O.air="air",O.earth="earth",O.light="light",O.dark="dark",O.wild="wild",O}(C||{}),t=function(O){return O.strong="strong",O.waning="waning",O.inert="inert",O.new="new",O.consumed="consumed",O.partlyConsumed="partlyConsumed",O.always="always",O}(t||{});class v{type;state=t.inert;constructor(A){this.type=A}}const D=[new v(C.fire),new v(C.ice),new v(C.air),new v(C.earth),new v(C.light),new v(C.dark)]},26484:(p,k,M)=>{M.d(k,{n:()=>D});var C=M(89204),t=M(30706);const D=new class v{db;init(){var A=this;return(0,C.A)(function*(){return(yield navigator.storage.persist())||console.warn("Storage may be cleared by the UA under storage pressure."),new Promise((R,I)=>{if(window.indexedDB){const U=window.indexedDB.open("ghs-db",1);U.onupgradeneeded=X=>{console.debug("Upgrade DB",X);const s=X.target.result;X.oldVersion<1&&(s.createObjectStore("game"),s.createObjectStore("settings"),s.createObjectStore("undo",{autoIncrement:!0}),s.createObjectStore("redo",{autoIncrement:!0}),s.createObjectStore("undo-infos",{autoIncrement:!0}),s.createObjectStore("game-backup",{autoIncrement:!0}))},U.onsuccess=X=>{A.db=X.target.result,localStorage.getItem("ghs-game")&&A.migrate(),R(!0)},U.onerror=X=>{A.db=void 0,console.error("db error",U.error,X),console.warn("No IndexedDB, fallback to Local Storage"),I(!1)}}else A.db=void 0,console.warn("No IndexedDB, fallback to Local Storage"),I(!1)})})()}writeGameModel(A){return this.write("game","default",A)}readGameModel(){return this.read("game","default")}addBackup(A){if(this.db)this.write("game-backup",void 0,A);else{let E=1,R=localStorage.getItem("ghs-game-backup-"+E);for(;R;)E++,R=localStorage.getItem("ghs-game-backup-"+E);try{localStorage.setItem("ghs-game-backup-"+E,JSON.stringify(A))}catch(I){console.error(I)}}}read(A,E){return new Promise((R,I)=>{if(this.db){const s=this.db.transaction(A,"readonly").objectStore(A).get(E);s.onsuccess=T=>{R(T.target.result)},s.onerror=T=>{console.error("read "+A+" failed",T),I(T)}}else{const U=localStorage.getItem("ghs-"+A);U?R(JSON.parse(U)):I(null)}})}write(A,E,R){return new Promise((I,U)=>{if(this.db){const T=this.db.transaction(A,"readwrite").objectStore(A).put(R,E);T.onsuccess=m=>{I()},T.onerror=m=>{console.error("update "+A+" failed",m),U()}}else try{localStorage.setItem("ghs-"+A,JSON.stringify(R)),I()}catch(X){console.error(X),U()}})}remove(A,E="default"){this.db?this.db.transaction(A,"readwrite").objectStore(A).delete(E).onerror=X=>{console.error("delete "+E+" from "+A+" failed",X)}:localStorage.removeItem("ghs-"+A)}readAll(A){return new Promise((E,R)=>{if(this.db){const X=this.db.transaction(A,"readonly").objectStore(A).getAll();X.onsuccess=s=>{E(s.target.result)},X.onerror=s=>{console.error("read "+A+" failed",s,s.error),R(s)}}else{const I=localStorage.getItem("ghs-"+A);I?E(JSON.parse(I)):R(null)}})}readList(A,E,R,I=!0){return new Promise((U,X)=>{if(this.db){const m=this.db.transaction(A,"readonly").objectStore(A);let w=[];const q=m.openCursor(null,"prev");var s=!1;q.onsuccess=P=>{var S=P.target.result;if(!s&&R>0)return s=!0,void S.advance(R);S?(w.push(S.value),w.length<E?S.continue():U(I?w.reverse():w)):U(I?w.reverse():w)},q.onerror=P=>{console.error("read "+A+" failed",P),X(P)}}else{const T=localStorage.getItem("ghs-"+A);T?U(JSON.parse(T).slice(R,R+E)):X(null)}})}writeArray(A,E){var R=this;return(0,C.A)(function*(){return new Promise(function(){var I=(0,C.A)(function*(U,X){if(R.db){yield R.clear(A).catch(s=>console.error(s));for(let s=0;s<E.length;s++){const T=E[s];yield R.write(A,void 0,T).catch(()=>X())}U()}else try{localStorage.setItem("ghs-"+A,JSON.stringify(E)),U()}catch(s){console.error(s),X()}});return function(U,X){return I.apply(this,arguments)}}())})()}clear(A=void 0){return new Promise((E,R)=>{if(this.db)if(A){const X=this.db.transaction(A,"readwrite").objectStore(A).clear();X.onsuccess=s=>{E()},X.onerror=s=>{console.error("delete "+A+" failed",s),R(X.error)}}else{const I=window.indexedDB.deleteDatabase("ghs-db");I.onsuccess=U=>{E()},I.onblocked=U=>{setTimeout(()=>{this.db&&this.db.close()},1e3)},I.onerror=U=>{console.error("delete database 'ghs-db' failed",U),R(I.error)}}else if(A)localStorage.removeItem("ghs-"+A),E();else if(localStorage.clear(),window.indexedDB){const I=window.indexedDB.deleteDatabase("ghs-db");I.onsuccess=U=>{E()},I.onblocked=U=>{setTimeout(()=>{this.db&&this.db.close()},1e3)},I.onerror=U=>{console.error("delete database 'ghs-db' failed",U),R(I.error)}}else E()})}datadump(){var A=this;return(0,C.A)(function*(E=!1){let R={};if(A.db&&!E)R.game=yield A.readGameModel(),R.settings=yield A.read("settings","default"),R.undo=yield A.readAll("undo"),R.redo=yield A.readAll("redo"),R["undo-infos"]=yield A.readAll("undo-infos"),R["game-backup"]=yield A.readAll("game-backup");else{E||console.warn("No IndexedDB, fallback to Local Storage");for(let I=0;I<localStorage.length;I++){const U=localStorage.key(I);if(U){const X=localStorage.getItem(U);X&&(R[U]=JSON.parse(X))}}}return Promise.resolve(R)}).apply(this,arguments)}migrate(){var A=this;return(0,C.A)(function*(){console.warn("Migration of old local storage");try{let m=yield D.datadump(!0),w=document.createElement("a");w.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(m))),w.setAttribute("download","ghs-migration-backup.json"),document.body.appendChild(w),w.click(),document.body.removeChild(w)}catch{console.warn("Could not read datadump")}const E=localStorage.getItem("ghs-game");if(E){let m=JSON.parse(E);A.write("game","default",m).then(()=>{localStorage.removeItem("ghs-game")}).catch()}const R=localStorage.getItem("ghs-settings");if(R){let m=JSON.parse(R);A.write("settings","default",Object.assign(new t.w,m)).then(()=>{localStorage.removeItem("ghs-settings")}).catch()}const I=localStorage.getItem("ghs-undo");if(null!=I){let m=JSON.parse(I),w=1,q=localStorage.getItem("ghs-undo-"+w);for(;q;){const P=JSON.parse(q);m.push(...P),w++,q=localStorage.getItem("ghs-undo-"+w)}A.writeArray("undo",m).then(()=>{localStorage.removeItem("ghs-undo");let P=localStorage.getItem("ghs-undo-"+w);for(;P;)localStorage.removeItem("ghs-undo-"+w),w++,P=localStorage.getItem("ghs-undo-"+w)}).catch()}const U=localStorage.getItem("ghs-redo");if(null!=U){let m=JSON.parse(U),w=1,q=localStorage.getItem("ghs-redo-"+w);for(;q;){const P=JSON.parse(q);m.push(...P),w++,q=localStorage.getItem("ghs-redo-"+w)}A.writeArray("redo",m).then(()=>{localStorage.removeItem("ghs-redo");let P=localStorage.getItem("ghs-redo-"+w);for(;P;)localStorage.removeItem("ghs-redo-"+w),w++,P=localStorage.getItem("ghs-redo-"+w)}).catch()}const X=localStorage.getItem("ghs-undo-infos");if(null!=X){let m=JSON.parse(X),w=1,q=localStorage.getItem("ghs-undo-infos-"+w);for(;q;){const P=JSON.parse(q);m.push(...P),w++,q=localStorage.getItem("ghs-undo-infos-"+w)}A.writeArray("undo-infos",m).then(()=>{localStorage.removeItem("ghs-undo-infos");let P=localStorage.getItem("ghs-undo-infos-"+w);for(;P;)localStorage.removeItem("ghs-undo-infos-"+w),w++,P=localStorage.getItem("ghs-undo-infos-"+w)}).catch()}let s=1,T=localStorage.getItem("ghs-game-backup-"+s);for(;T;)A.write("game-backup",void 0,T).then(()=>{localStorage.removeItem("ghs-game-backup-"+s)}).catch(),s++,T=localStorage.getItem("ghs-game-backup-"+s)})()}}},29765:(p,k,M)=>{M.d(k,{Zt:()=>s,bt:()=>m,mk:()=>T,u8:()=>w});var C=M(58317),t=M(31619),v=M(51824),D=M(73219),O=M(83492),A=M(25532),E=M(51604),R=M(42065),I=M(34933),U=M(71891),X=M(9733);class s{revision=0;revisionOffset=0;edition=void 0;conditions=[];battleGoalEditions=[];filteredBattleGoals=[];figures=[];entitiesCounter=[];state=T.draw;scenario=void 0;sections=[];scenarioRules=[];appliedScenarioRules=[];discardedScenarioRules=[];level=1;levelCalculation=!0;levelAdjustment=0;bonusAdjustment=0;ge5Player=!0;playerCount=-1;round=0;roundResets=[];roundResetsHidden=[];playSeconds=0;totalSeconds=0;monsterAttackModifierDeck=new D.J;allyAttackModifierDeck=new D.J;elementBoard;solo=!1;party;parties;lootDeck=new E.yX;lootDeckEnhancements=[];lootDeckFixed=[];lootDeckSections=[];unlockedCharacters=[];server=!1;finish;gameClock=[];challengeDeck=new O.lV;favors=[];favorPoints=[];keepFavors=!1;eventDraw;constructor(){this.elementBoard=JSON.parse(JSON.stringify(A.O7)),this.party=new U.r,this.parties=[this.party]}toModel(){return new w(this.revision,this.revisionOffset,this.edition,this.conditions,this.battleGoalEditions,this.filteredBattleGoals,this.figures.map(P=>P.edition+"-"+(P instanceof I.$e?P.uuid:P.name)),this.entitiesCounter,this.figures.filter(P=>P instanceof v.K).map(P=>P.toModel()),this.figures.filter(P=>P instanceof R.R).map(P=>P.toModel()),this.figures.filter(P=>P instanceof I.$e).map(P=>P.toModel()),this.state,this.scenario&&C.E.scenarioManager.toModel(this.scenario,this.scenario.revealedRooms,this.scenario.additionalSections,this.scenario.custom,this.scenario.custom?this.scenario.name:"")||void 0,this.sections.map(P=>C.E.scenarioManager.toModel(P,P.revealedRooms,P.additionalSections)),this.scenarioRules.map(P=>P.identifier),this.appliedScenarioRules,this.discardedScenarioRules,this.level,this.levelCalculation,this.levelAdjustment,this.bonusAdjustment,this.ge5Player,this.playerCount,this.round,this.roundResets,this.roundResetsHidden,this.playSeconds,this.totalSeconds,this.monsterAttackModifierDeck.toModel(),this.allyAttackModifierDeck.toModel(),this.elementBoard,this.solo,this.party,this.parties,this.lootDeck,this.lootDeckEnhancements,this.lootDeckFixed,this.lootDeckSections,this.unlockedCharacters,this.server,this.finish,this.gameClock,this.challengeDeck.toModel(),this.favors,this.favorPoints,this.keepFavors,this.eventDraw)}fromModel(P,S=!1){if(this.revision=P.revision||0,this.revisionOffset=P.revisionOffset||0,this.edition=P.edition,this.conditions=P.conditions||[],this.battleGoalEditions=P.battleGoalEditions||[],this.filteredBattleGoals=P.filteredBattleGoals||[],this.figures=this.figures.filter($=>-1!=P.characters.map(V=>V.name).indexOf($.name)||-1!=P.monsters.map(V=>V.name).indexOf($.name)||P.objectiveContainers&&-1!=P.objectiveContainers.map(V=>V.name).indexOf($.name)),this.entitiesCounter=P.entitiesCounter||[],P.characters.forEach($=>{let V=this.figures.find(N=>N instanceof v.K&&N.name==$.name&&N.edition==$.edition);V||(V=new v.K(C.E.getCharacterData($.name,$.edition),$.level),this.figures.push(V)),V.fromModel($)}),P.monsters.forEach($=>{let V=this.figures.find(N=>N instanceof R.R&&N.name==$.name&&N.edition==$.edition);V||(V=new R.R(C.E.getMonsterData($.name,$.edition)),this.figures.push(V)),V.fromModel($)}),P.objectiveContainers&&(this.figures=this.figures.filter($=>!($ instanceof I.$e)||P.objectiveContainers&&P.objectiveContainers.some(V=>V.uuid&&V.uuid==$.uuid)),P.objectiveContainers.forEach($=>{let V=this.figures.find(N=>N instanceof I.$e&&N.uuid==$.uuid);V||(V=new I.$e($.uuid,$.additionalObjectiveId||$.objectiveId),this.figures.push(V)),V.fromModel($)})),this.figures.sort(($,V)=>P.figures.indexOf($.edition+"-"+($ instanceof I.$e?$.uuid:$.name))-P.figures.indexOf(V.edition+"-"+(V instanceof I.$e?V.uuid:V.name))),this.state=P.state,P.scenario){const $=C.E.scenarioManager.scenarioDataForModel(P.scenario);this.scenario=$?new X.Nz($,P.scenario.revealedRooms||[],P.scenario.additionalSections||[],P.scenario.isCustom):void 0}else this.scenario=void 0;this.sections=[],P.sections.forEach($=>{const V=C.E.scenarioManager.sectionDataForModel($);V&&this.sections.push(new X.Nz(V,$.revealedRooms||[]))}),this.level=P.level,this.scenarioRules=[],P.scenarioRules&&P.scenarioRules.forEach($=>{const V=C.E.scenarioRulesManager.getScenarioForRule($).scenario;V&&(V.rules&&V.rules.length>$.index&&$.index>=0?(V.rules[$.index].spawns&&V.rules[$.index].spawns.forEach(N=>{N.manual&&!N.count&&(N.count="1")}),this.scenarioRules.push({identifier:$,rule:V.rules[$.index]})):V.errata&&$.index<0&&V.errata.split("|")[-1*$.index-1]&&this.scenarioRules.push({identifier:$,rule:C.E.scenarioRulesManager.createErrataRule(V.edition,V.errata.split("|")[-1*$.index-1])}))}),this.appliedScenarioRules=P.appliedScenarioRules||[],this.discardedScenarioRules=P.discardedScenarioRules||P.disgardedScenarioRules||[],this.levelCalculation=P.levelCalculation,this.levelAdjustment=P.levelAdjustment,this.bonusAdjustment=P.bonusAdjustment,this.ge5Player=P.ge5Player,this.playerCount=P.playerCount||-1,this.round=P.round,this.roundResets=P.roundResets||[],this.roundResetsHidden=P.roundResetsHidden||[],(S&&!P.server||P.playSeconds>this.playSeconds)&&(this.playSeconds=P.playSeconds),(S&&!P.server||P.totalSeconds>this.totalSeconds)&&(this.totalSeconds=P.totalSeconds),this.monsterAttackModifierDeck=this.monsterAttackModifierDeck||new D.J,P.monsterAttackModifierDeck&&P.monsterAttackModifierDeck.cards&&P.monsterAttackModifierDeck.cards.length>0&&C.E.attackModifierManager.fromModel(this.monsterAttackModifierDeck,P.monsterAttackModifierDeck),this.allyAttackModifierDeck=this.allyAttackModifierDeck||new D.J,P.allyAttackModifierDeck&&P.allyAttackModifierDeck.cards&&P.allyAttackModifierDeck.cards.length>0&&C.E.attackModifierManager.fromModel(this.allyAttackModifierDeck,P.allyAttackModifierDeck),this.elementBoard=this.elementBoard||A.O7,P.elementBoard&&P.elementBoard.forEach(($,V)=>this.elementBoard[V].state=$.state),this.solo=P.solo,this.party=Object.assign(new U.r,P.party?JSON.parse(JSON.stringify(P.party)):new U.r),this.parties=[this.party],P.parties&&P.parties.forEach($=>{$.id!=this.party.id&&($.achievements&&($.achievementsList.push(...$.achievements.split("\n")),$.achievements=""),$.globalAchievements&&($.globalAchievementsList.push(...$.globalAchievements.split("\n")),$.globalAchievements=""),this.parties.push(Object.assign(new U.r,$)))}),P.lootDeck?this.lootDeck?this.lootDeck.fromModel(P.lootDeck):this.lootDeck=P.lootDeck:this.lootDeck=new E.yX,this.lootDeckEnhancements=P.lootDeckEnhancements||[],this.lootDeckFixed=P.lootDeckFixed||[],this.lootDeckSections=P.lootDeckSections||[],this.favors=P.favors||[],this.favorPoints=P.favorPoints||[],this.keepFavors=P.keepFavors||!1,this.eventDraw=P.eventDraw||void 0,this.lootDeckEnhancements.forEach($=>{$.value&&(isNaN(+$.value)?"%game.loot.player.3-4% +1/%game.loot.player.2% +2"==$.value?($.value4P=1,$.value3P=1,$.value2P=2):"%game.loot.player.4% +1/%game.loot.player.2-3% +2"==$.value?($.value4P=1,$.value3P=2,$.value2P=2):console.warn("Cannot migrate loot: "+$.value):($.value4P=+$.value,$.value3P=+$.value,$.value2P=+$.value),$.value=void 0)}),(0,E.G8)(this.lootDeck.cards),(0,E.G8)(this.lootDeckEnhancements),this.unlockedCharacters=P.unlockedCharacters||[],this.unlockedCharacters=this.unlockedCharacters.map($=>{if(-1==$.indexOf(":")){let V=this.edition||C.E.currentEdition(),N=C.E.getCharacterData($,V);if(N||(N=C.E.getCharacterData($)),N)return N.edition+":"+N.name;console.warn("Could not find character data for unlock: "+$)}return $}),this.party.migrate(),this.challengeDeck=this.challengeDeck||new O.lV,P.challengeDeck&&this.challengeDeck.fromModel(P.challengeDeck),this.server=P.server,this.finish=P.finish,t.f.settings.gameClockMerge?this.gameClock=C.E.mergeGameClocks(this.gameClock,P.gameClock):S||(this.gameClock=P.gameClock)}}var T=function(q){return q.draw="draw",q.next="next",q}(T||{});class m{clockIn;clockOut;constructor(P,S=void 0){this.clockIn=P,this.clockOut=S}}class w{revision;revisionOffset;edition;conditions;battleGoalEditions;filteredBattleGoals;figures;entitiesCounter;characters;monsters;objectiveContainers;state;scenario;sections;scenarioRules;appliedScenarioRules;discardedScenarioRules;level;levelCalculation;levelAdjustment;bonusAdjustment;ge5Player;playerCount;round;roundResets;roundResetsHidden;playSeconds;totalSeconds;monsterAttackModifierDeck;allyAttackModifierDeck;elementBoard;solo;party;parties;lootDeck;lootDeckEnhancements;lootDeckFixed;lootDeckSections;unlockedCharacters;server;finish;gameClock;challengeDeck;favors;favorPoints;keepFavors;eventDraw;disgardedScenarioRules;constructor(P=0,S=0,$=void 0,V=[],N=[],K=[],Y=[],j=[],G=[],Lt=[],Jt=void 0,Ut=T.next,ee=void 0,pe=[],Vt=[],qt=[],ue=[],ne=0,he=!0,_e=0,ye=0,xe=!0,kt=-1,J=0,ut=[],He=[],Ke=0,We=0,Ot=new D.qM(-1,D._v,[],!0),dt=new D.qM(-1,D._v,[],!0),Gt=[],Ae=!1,Ve=new U.r,Je=[],Ze=new E.yX,Fe=[],Ee=[],Sn=[],$n=[],Dn=!1,cn=void 0,fe=[],Ce=new O.U2,ln=[],gn=[],dn=!1,hn=void 0){this.revision=P,this.revisionOffset=S,this.edition=$,this.conditions=V,this.battleGoalEditions=N,this.filteredBattleGoals=K,this.figures=Y,this.entitiesCounter=JSON.parse(JSON.stringify(j)),this.characters=G,this.monsters=Lt,this.objectiveContainers=Jt,this.state=Ut,this.scenario=ee,this.sections=pe,this.scenarioRules=JSON.parse(JSON.stringify(Vt)),this.appliedScenarioRules=JSON.parse(JSON.stringify(qt)),this.discardedScenarioRules=JSON.parse(JSON.stringify(ue)),this.level=ne,this.levelCalculation=he,this.levelAdjustment=_e,this.bonusAdjustment=ye,this.ge5Player=xe,this.playerCount=kt,this.round=J,this.roundResets=JSON.parse(JSON.stringify(ut)),this.roundResetsHidden=JSON.parse(JSON.stringify(He)),this.playSeconds=Ke,this.totalSeconds=We,this.monsterAttackModifierDeck=Ot,this.allyAttackModifierDeck=dt,this.elementBoard=JSON.parse(JSON.stringify(Gt)),this.solo=Ae,this.party=JSON.parse(JSON.stringify(Ve)),this.party.players=this.party.players.map(Xe=>Xe||""),this.parties=JSON.parse(JSON.stringify(Je)),this.parties.forEach(Xe=>{Xe.players=Xe.players.map(In=>In||"")}),this.lootDeck=JSON.parse(JSON.stringify(Ze)),this.lootDeckEnhancements=JSON.parse(JSON.stringify(Fe)),this.lootDeckFixed=JSON.parse(JSON.stringify(Ee)),this.lootDeckSections=JSON.parse(JSON.stringify(Sn)),this.unlockedCharacters=JSON.parse(JSON.stringify($n)),this.server=Dn,this.finish=cn?JSON.parse(JSON.stringify(cn)):void 0,this.gameClock=fe,this.challengeDeck=Ce,this.favors=JSON.parse(JSON.stringify(ln)),this.favorPoints=JSON.parse(JSON.stringify(gn)),this.keepFavors=dn,this.eventDraw=hn,this.disgardedScenarioRules=JSON.parse(JSON.stringify(ue))}}},30706:(p,k,M)=>{M.d(k,{f:()=>v,w:()=>t});var C=M(42357);class t{abilities=!0;abilityNumbers=!0;abilityReveal=!0;activeApplyConditions=!0;activeApplyConditionsAuto=[];activeApplyConditionsExcludes=[C.r5.shield];activeStandees=!0;activeSummons=!0;addAllMonsters=!1;allyAttackModifierDeck=!0;alwaysAllyAttackModifierDeck=!1;alwaysFhAdvantage=!1;alwaysFhEnhancements=!1;alwaysFhSolo=!1;alwaysHazardousTerrain=!1;alwaysLootApplyDialog=!1;alwaysLootDeck=!1;amAdvantage=!1;amAdvantageHouseRule=!1;animations=!0;animationSpeed=1;applyBuildingRewards=!0;applyConditions=!0;applyConditionsExcludes=[C.r5.shield];applyLongRest=!0;applyLoot=!0;applyLootRandomItem=!0;applyRetirement=!0;artwork=!0;autoBackup=-1;autoBackupFinish=!1;autoBackupUrl;automaticAttackModifierFullscreen=!0;automaticFirstFigure=!0;automaticGameClock=!0;automaticGameClockFocus=!1;automaticPassTime=!0;automaticStandees=!0;automaticStandeesDialog=!1;automaticTheme=!0;automaticUnlocking=!0;autoscroll=!0;barsize=1;backupHint=!0;battleGoals=!1;battleGoalsCharacter=!1;battleGoalsFh=!1;battleGoalsReminder=!0;bbAm=!0;bbChars=!0;bbStandeeLimit=!0;browserNavigation=!1;buildingEffectsVisible=!1;buildingInteractionsVisible=!1;calculate=!0;calculateAdvantageStats=!0;calculateShieldStats=!0;calculateStats=!0;calendarLocked=!1;characterAttackModifierAnimate=!0;characterAttackModifierDeck=!0;characterAttackModifierDeckPermanent=!1;characterAttackModifierDeckPermanentActive=!1;characterCompact=!1;characterFullView=!1;characterHandSize=!1;characterIdentities=!0;characterIdentityHint=!0;characterItems=!1;characterItemsApply=!0;characterItemsPermanent=!1;characterItemsPermanentActive=!1;characterItemsPermanentEquipped=!0;characterItemsPermanentSorted=!0;characterItemsPermanentZoom=1;playerNumber=!1;characterSheet=!0;characterSheetCompact=!1;characterSheetLocked=!1;characterShieldRetaliate=!1;characterSortIndex=!1;characterTraits=!1;columns=!0;columnsForce=!1;combineInteractiveAbilities=!0;combineSummonAction=!0;damageHP=!1;damageHPToggle=!0;debugEditWorldMap=!1;debugEventCards=!1;debugRightClick=!1;disableAnimations=!1;disableArtwork=!1;disableColumns=!1;disableDragFigures=!1;disablePinchZoom=!1;disabledTurnConfirmation=!1;disableSortFigures=!1;disableStandees=!1;disableWakeLock=!1;dragFigures=!0;dragValues=!0;editionDataUrls=[];editions=[];eliteFirst=!0;errata=!1;excludeEditionDataUrls=[];expireConditions=!0;events=!1;eventsApply=!0;eventsDraw=!0;eventsDrawReminder=!1;feedbackErrors=!0;feedbackErrorsIgnore=[];fhChallenges=!1;fhChallengesApply=!0;fhGarden=!0;fhGhItems=!1;fhPets=!0;fhSecondEdition=!1;fhStyle=!1;fhTrials=!1;fhTrialsApply=!0;fontsize=1;gameClock=!1;gameClockMerge=!0;gh2eImbuement=!0;globalFontsize=1;globalMapHighlighting=!0;fullscreen=!1;hideAbsent=!1;hideCharacterHP=!1;hideCharacterLoot=!1;hideCharacterXP=!1;hideStats=!1;hints=!0;initiativeRequired=!0;initiativeRoundConfirm=!1;interactiveAbilities=!0;keyboardShortcuts=!0;locale="en";logServerMessages=!1;lootDeck=!0;maxUndo=100;portraitMode=!0;monsters=!0;monsterAttackModifierDeck=!0;moveElements=!0;partySheet=!0;pinchZoom=!0;pressDoubleClick=!0;randomStandees=!1;removeUnusedMonster=!1;scenarioNumberInput=!1;scenarioRewards=!0;scenarioRewardsItems=!0;scenarioRooms=!0;scenarioRules=!0;scenarioRulesAutoapply=!1;scenarioStats=!1;serverAutoconnect=!0;serverCode;serverPassword;serverPing=0;serverPort;serverSettings=!1;serverUrl;serverWss=!1;showBossMonster=!0;showAllSections=!1;showExpandedAbilityCard=!1;showFullAbilityCard=!1;showHiddenMonster=!1;showOnlyUnfinishedScenarios=!1;sortFigures=!0;spoilers=[];standaloneInitiativeAutomatic=!1;standees=!0;standeeShieldRetaliate=!1;standeeStats=!1;statAnimations=!1;stats=!0;summons=!0;temporaryEnhancements=!1;theme="";tooltips=!0;treasures=!0;treasuresLoot=!0;treasuresLootItem=!0;treasuresLootScenario=!0;turnConfirmation=!0;unlockEnvelopeBuildings=!0;wakeLock=!0;wrapProsperity=!1;zoom=100}const v=["animations","animationSpeed","artwork","automaticAttackModifierFullscreen","autoBackup","autoBackupFinish","autoBackupUrl","automaticGameClock","automaticTheme","autoscroll","barsize","backupHint","browserNavigation","buildingEffectsVisible","buildingInteractionsVisible","calendarLocked","characterAttackModifierAnimate","characterAttackModifierDeckPermanent","characterAttackModifierDeckPermanentActive","characterFullView","characterItemsPermanent","characterItemsPermanentActive","characterItemsPermanentEquipped","characterItemsPermanentSorted","characterItemsPermanentZoom","characterCompact","playerNumber","characterSheetCompact","characterSheetLocked","columns","columnsForce","damageHPToggle","debugEditWorldMap","debugEventCards","debugRightClick","disableAnimations","disableArtwork","disableColumns","disableDragFigures","disablePinchZoom","disableWakeLock","dragFigures","dragValues","errata","eventsDrawReminder","fhStyle","fontsize","gameClock","globalFontsize","globalMapHighlighting","feedbackErrors","feedbackErrorsIgnore","fullscreen","hideCharacterHP","hideCharacterLoot","hideCharacterXP","hints","initiativeRoundConfirm","keyboardShortcuts","logServerMessages","pinchZoom","portraitMode","pressDoubleClick","serverAutoconnect","serverCode","serverPassword","serverPing","serverPort","serverSettings","serverUrl","serverWss","showAllSections","showBossMonster","showHiddenMonster","showOnlyUnfinishedScenarios","standaloneInitiativeAutomatic","statAnimations","theme","tooltips","wakeLock","wrapProsperity","zoom"]},31619:(p,k,M)=>{M.d(k,{f:()=>w});var C=M(89204),t=M(7610),v=M(43025),D=M(25846),O=M(21832),A=M(51824),E=M(30706),R=M(1270),I=M(13812),U=M(58317);const s=new class X{checkDuplicates(){U.E.charactersData().forEach((P,S,$)=>{$.find(V=>!P.replace&&!V.replace&&$.indexOf(V)!=$.indexOf(P)&&P.name==V.name&&P.edition==V.edition)&&console.warn("Duplicate Character: "+P.name+" (Edition: "+P.edition+")")}),U.E.decksData().forEach((P,S,$)=>{$.find(V=>$.indexOf(V)!=$.indexOf(P)&&P.name==V.name&&P.edition==V.edition)&&console.warn("Duplicate Deck: "+P.name+" (Edition: "+P.edition+")")}),U.E.scenarioData().forEach((P,S,$)=>{$.find(V=>$.indexOf(V)!=$.indexOf(P)&&P.index==V.index&&P.edition==V.edition&&P.group==V.group)&&console.warn("Duplicate Scenario: "+P.index+" (Edition: "+P.edition+")")}),U.E.sectionData().forEach((P,S,$)=>{$.find(V=>$.indexOf(V)!=$.indexOf(P)&&P.index==V.index&&P.edition==V.edition&&P.group==V.group)&&console.warn("Duplicate Section: "+P.index+" (Edition: "+P.edition+")")}),U.E.itemData().forEach((P,S,$)=>{$.find(V=>$.indexOf(V)!=$.indexOf(P)&&P.id==V.id&&P.edition==V.edition)&&console.warn("Duplicate Item: "+P.id+" (Edition: "+P.edition+")")}),U.E.monstersData().forEach((P,S,$)=>{$.find(V=>!P.replace&&!V.replace&&$.indexOf(V)!=$.indexOf(P)&&P.name==V.name&&P.edition==V.edition)&&console.warn("Duplicate Monster: "+P.name+" (Edition: "+P.edition+")")}),U.E.battleGoalManager.getBattleGoals(void 0,!0).forEach((P,S,$)=>{if(!P.alias){const V=$.filter((N,K)=>K!=S&&(N.name==P.name||w.getLabel("data.battleGoals."+N.cardId)==w.getLabel("data.battleGoals."+P.cardId)));V.length>0&&V.find(N=>!N.alias)&&console.warn("BattleGoal doubles:",P.edition+" - "+P.name,V.map(N=>N.edition+" - "+N.name))}})}checkScenarioMonster(){U.E.scenarioData().forEach(P=>{P.monsters&&P.monsters.forEach(S=>{U.E.monstersData().find($=>($.edition==P.edition||-1!=U.E.editionExtensions(P.edition).indexOf($.edition))&&$.name==S.split(":")[0])||console.warn("Invalid monster: "+S+" | scenario",P.edition,P.group||"",P.index)}),P.rooms&&P.rooms.forEach(S=>{S.monster&&S.monster.forEach($=>{U.E.monstersData().find(V=>(V.edition==P.edition||-1!=U.E.editionExtensions(P.edition).indexOf(V.edition))&&V.name==$.name.split(":")[0])||console.warn("Invalid monster: "+$.name+" | scenario",P.edition,P.group||"",P.index)})})})}checkSectionMonster(){U.E.sectionData().forEach(P=>{P.monsters&&P.monsters.forEach(S=>{U.E.monstersData().find($=>($.edition==P.edition||-1!=U.E.editionExtensions(P.edition).indexOf($.edition))&&$.name==S.split(":")[0])||console.warn("Invalid monster: "+S+" | section",P.edition,P.group||"",P.index)}),P.rooms&&P.rooms.forEach(S=>{S.monster&&S.monster.forEach($=>{U.E.monstersData().find(V=>(V.edition==P.edition||-1!=U.E.editionExtensions(P.edition).indexOf(V.edition))&&V.name==$.name.split(":")[0])||console.warn("Invalid monster: "+$.name+" | section",P.edition,P.group||"",P.index)})})})}checkMissingScenarioMonster(){U.E.scenarioData().forEach(P=>{P.rooms&&P.rooms.forEach(S=>{S.monster&&S.monster.forEach($=>{(!P.monsters||!P.monsters.find(V=>V==$.name||V.split(":")[0]==$.name))&&console.debug("Missing monster '"+$.name+"' from room '"+S.roomNumber+"' in monsters",P.edition,P.group||"",P.index)})})})}checkMissingSectionMonster(){U.E.sectionData().forEach(P=>{P.rooms&&P.rooms.forEach(S=>{S.monster&&S.monster.forEach($=>{(!P.monsters||!P.monsters.find(V=>V==$.name||V.split(":")[0]==$.name))&&console.debug("Missing monster '"+$.name+"' from room '"+S.roomNumber+"' in monsters | section",P.edition,P.group||"",P.index)})})})}checkMonsterUsage(){U.E.monstersData().forEach(P=>{let S=!1;U.E.scenarioData().forEach($=>{$.monsters&&$.monsters.some(V=>V.split(":")[0]==P.name)&&(S=!0),!S&&$.rooms&&$.rooms.forEach(V=>{V.monster&&V.monster.some(N=>N.name.split(":")[0]==P.name)&&(S=!0)})}),S||U.E.sectionData().forEach($=>{$.monsters&&$.monsters.find(V=>V.split(":")[0]==P.name)&&(S=!0),!S&&$.rooms&&$.rooms.forEach(V=>{V.monster&&V.monster.some(N=>N.name.split(":")[0]==P.name)&&(S=!0)})}),S||console.warn("Could not find usage of '"+P.name+"'",P.edition)})}checkMonsterBossCount(){U.E.monstersData().forEach(P=>{P.boss&&(0,I.hZ)(P.count)>1&&console.warn("Boss count check: "+P.name+" (Edition: "+P.edition+")")})}checkCharacterCardIds(){U.E.decksData().filter(P=>{if(P.character)for(let S=0;S<P.abilities.length-1;S++){const $=P.abilities[S],V=P.abilities[S+1];if(null==$.cardId)console.warn(P.edition,P.name,S,$.name);else if(null!=$.cardId&&null!=V.cardId&&$.cardId+1!=V.cardId){console.warn(P.edition,P.name,S,$.cardId,$.name,S+1,V.cardId,V.name);break}}})}};var T=M(26484);const w=new class m{defaultLocale="en";defaultEditions=["gh","fh","jotl","fc","cs","toa","bb","gh2e","solo"];defaultEditionDataUrls=["./assets/data/gh.json","./assets/data/fh.json","./assets/data/jotl.json","./assets/data/fc.json","./assets/data/cs.json","./assets/data/toa.json","./assets/data/bb.json","./assets/data/solo.json","./assets/data/fh-crossover.json","./assets/data/gh-envx.json","./assets/data/toa-envv.json","./assets/data/sc.json","./assets/data/gh-solo-items.json","./assets/data/sox.json","./assets/data/bas.json","./assets/data/cc.json","./assets/data/gh2e.json","./assets/data/ir.json","./assets/data/r100kc.json","./assets/data/sits.json"];settings=new E.w;label={};locales=["en","de","fr","ko","es","it","zh_Hans","zh_Hant","ru","pt"];developent=!1;debugManager=s;init(P){var S=this;return(0,C.A)(function*(){yield S.loadSettings(),S.developent=P;for(let $ of S.defaultEditionDataUrls)-1==w.settings.editionDataUrls.indexOf($)&&-1==w.settings.excludeEditionDataUrls.indexOf($)&&w.settings.editionDataUrls.push($);for(let $ of w.settings.editionDataUrls)yield w.loadEditionData($)})()}loadSettings(){var P=this;return(0,C.A)(function*(){let S=!1;try{let $=yield T.n.read("settings","default");$?P.setSettings(Object.assign(new E.w,$)):S=!0}catch{S=!0}if(S)try{yield fetch("./ghs-settings-default.json").then($=>{if(!$.ok)throw Error();return $.json()}).then($=>{P.setSettings(Object.assign(new E.w,$))})}catch{P.setSettings(new E.w)}P.updateLocale(P.settings.locale)})()}setSettings(P){if(P.locale!=this.settings.locale&&this.updateLocale(P.locale),this.settings=P,(!this.settings.editions||0==this.settings.editions.length)&&this.settings.editions.push(...this.defaultEditions),!this.settings.editionDataUrls||0==this.settings.editionDataUrls.length)for(let S of this.defaultEditionDataUrls)-1==this.settings.editionDataUrls.indexOf(S)&&-1==this.settings.excludeEditionDataUrls.indexOf(S)&&this.settings.editionDataUrls.push(S);P.theme||(P.theme=P.fhStyle?"fh":"default"),P.disableAnimations&&(P.animations=!1,P.disableAnimations=!1),P.disableArtwork&&(P.artwork=!1,P.disableArtwork=!1),P.disableColumns&&(P.columns=!1,P.disableColumns=!1),P.disableDragFigures&&(P.dragFigures=!1,P.disableDragFigures=!1),P.disablePinchZoom&&(P.pinchZoom=!1,P.disablePinchZoom=!1),P.disabledTurnConfirmation&&(P.turnConfirmation=!1,P.disabledTurnConfirmation=!1),P.disableSortFigures&&(P.sortFigures=!1,P.disableSortFigures=!1),P.disableStandees&&(P.standees=!1,P.disableStandees=!1),P.disableWakeLock&&(P.wakeLock=!1,P.disableWakeLock=!1),P.serverPassword&&(P.serverCode=P.serverPassword,P.serverPassword=void 0),P.combineSummonAction||(P.combineInteractiveAbilities=!1,P.combineSummonAction=!0),this.sortSpoilers()}storeSettings(){T.n.write("settings","default",this.settings),this.settings.serverSettings&&U.E.stateManager.saveSettings(),U.E.uiChange.emit()}reset(){T.n.remove("settings"),this.loadSettings()}set(P,S){var $=this;return(0,C.A)(function*(V,N,K=!0){$.settings[V]=N,K&&(yield $.apply(V,N)),$.storeSettings()}).apply(this,arguments)}toggle(P){var S=this;return(0,C.A)(function*(){yield S.set(P,!S.settings[P])})()}apply(P,S){var $=this;return(0,C.A)(function*(){"fullscreen"===P?S?document.body.requestFullscreen&&document.body.requestFullscreen():document.exitFullscreen&&document.exitFullscreen():"locale"===P?yield $.updateLocale(S):"animationSpeed"===P?document.body.style.setProperty("--ghs-animation-speed",S+""):"fontsize"===P?document.body.style.setProperty("--ghs-fontsize",S+""):"barsize"===P?document.body.style.setProperty("--ghs-barsize",S+""):"globalFontsize"===P?document.body.style.setProperty("--ghs-global-fontsize",S+""):"portraitMode"===P?S?document.body.classList.add("portrait-mode"):document.body.classList.remove("portrait-mode"):"theme"===P&&$.settings.automaticTheme?$.settings.fhStyle="fh"==S||"bb"==S:"bbAm"===P?(U.E.game.monsterAttackModifierDeck.bb=S||!1,U.E.game.figures.forEach(V=>{V instanceof A.K&&(V.attackModifierDeck.bb=S||!1)})):"temporaryEnhancements"===P&&U.E.game.figures.forEach(V=>{V instanceof A.K&&U.E.characterManager.previousEnhancements(V,S)})})()}get(P){return this.settings[P]}setAutoBackupFinish(P){this.settings.autoBackupFinish=P,this.settings.autoBackupFinish&&this.settings.autoBackup<0?this.settings.autoBackup=0:!this.settings.autoBackupFinish&&0==this.settings.autoBackup&&(this.settings.autoBackup=-1),this.storeSettings()}setAutoBackupUrl(P){this.settings.autoBackupUrl=P,this.settings.autoBackupUrl&&!this.settings.autoBackupUrl.method&&(this.settings.autoBackupUrl.method="POST"),this.storeSettings()}setDisableWakeLock(P){var S=this;return(0,C.A)(function*(){S.settings.disableWakeLock=P,P&&U.E.stateManager.wakeLock?U.E.stateManager.wakeLock.release().then(()=>{U.E.stateManager.wakeLock=null}):!P&&!U.E.stateManager.wakeLock&&"wakeLock"in navigator&&(U.E.stateManager.wakeLock=yield navigator.wakeLock.request("screen")),S.storeSettings()})()}setWakeLock(P){var S=this;return(0,C.A)(function*(){S.settings.wakeLock=P,!P&&U.E.stateManager.wakeLock?U.E.stateManager.wakeLock.release().then(()=>{U.E.stateManager.wakeLock=null}):P&&!U.E.stateManager.wakeLock&&"wakeLock"in navigator&&(U.E.stateManager.wakeLock=yield navigator.wakeLock.request("screen")),S.storeSettings()})()}setServer(P,S,$){this.settings.serverUrl=P,this.settings.serverPort=S,this.settings.serverCode=$,this.storeSettings()}setServerSettings(P){this.settings.serverSettings=P,P?U.E.stateManager.requestSettings():this.storeSettings()}setZoom(P){this.settings.zoom=P,this.storeSettings()}addSpoiler(P){-1==this.settings.spoilers.indexOf(P)&&(this.settings.spoilers.push(P),this.sortSpoilers(),this.storeSettings())}addSpoilers(P){for(let S of P)-1==this.settings.spoilers.indexOf(S.name)&&this.settings.spoilers.push(S.name);this.storeSettings()}removeSpoiler(P){-1!=this.settings.spoilers.indexOf(P)&&(this.settings.spoilers.splice(this.settings.spoilers.indexOf(P),1),this.storeSettings())}removeAllSpoilers(){this.settings.spoilers=[],this.storeSettings()}addEdition(P){-1==this.settings.editions.indexOf(P)&&(this.settings.editions.push(P),U.E.resetEditionMapping(),this.storeSettings())}removeEdition(P){this.settings.editions.splice(this.settings.editions.indexOf(P),1),U.E.resetEditionMapping(),this.storeSettings()}sortSpoilers(){this.settings.spoilers.sort((P,S)=>P.toLowerCase()>S.toLowerCase()?1:P.toLowerCase()<S.toLowerCase()?-1:0)}cleanEditionData(){U.E.editionData=[]}loadEditionData(P){var S=this;return(0,C.A)(function*($,V=!1){try{return yield fetch($).then(K=>{if(K.ok)return K.json();console.warn("Invalid data url: "+$+" ["+K.statusText+"]")}).then(K=>{if(-1==U.E.editions(!0).indexOf(K.edition)||V)return V&&(U.E.editionData=U.E.editionData.filter(Y=>Y.url!=$)),K.characters=K.characters||[],K.monsters=K.monsters||[],K.decks=K.decks||[],K.scenarios=K.scenarios||[],K.sections=K.sections||[],K.items=K.items||[],K.conditions=K.conditions||[],K.battleGoals=K.battleGoals||[],K.events=K.events||[],K.challenges=K.challenges||[],K.trials=K.trials||[],K.favors=K.favors||[],K.pets=K.pets||[],K.personalQuests=K.personalQuests||[],K.label=K.label||{},K.labelSpoiler=K.labelSpoiler||{},K.url=$,K.logoUrl=K.logoUrl||"",K.additional=K.additional||!1,K.extensions=K.extensions||[],K.newAmStyle=K.newAmStyle||!1,K.treasures=K.treasures||[],K.treasureOffset=K.treasureOffset||0,K.campaign&&K.campaign.buildings&&(K.campaign.buildings=K.campaign.buildings.map(Y=>Object.assign(new R.tY,Y))),K.battleGoals.map((Y,j)=>(Y.edition||(Y.edition=K.edition),Y.cardId||(Y.cardId=Y.edition+"-"+(j+1)),Y)),K.events.map((Y,j)=>(Y.edition||(Y.edition=K.edition),Y.cardId||(Y.cardId=""+(j+1)),Y)),K.personalQuests.map((Y,j)=>(Y.edition||(Y.edition=K.edition),Y.cardId||(Y.cardId=K.edition+"-"+(j+1)),Y.requirements||(Y.requirements=[]),Y)),K.campaign&&K.campaign.buildings&&K.campaign.buildings.forEach(Y=>{Y.edition||(Y.edition=K.edition)}),K.challenges.map((Y,j)=>(Y.edition||(Y.edition=K.edition),Y.cardId||(Y.cardId=j+1),Y)),K.trials.map((Y,j)=>(Y.edition||(Y.edition=K.edition),Y.cardId||(Y.cardId=j+1),Y)),K.favors.map((Y,j)=>(Y.edition||(Y.edition=K.edition),Y.name||(Y.name="favor-"+(j+1)),Y)),K.pets.map((Y,j)=>(Y.edition||(Y.edition=K.edition),Y.id||(Y.id=(j<9?"0":"")+(j+1)),Y)),U.E.editionData.push(K),U.E.editionData.sort((Y,j)=>S.settings.editionDataUrls.indexOf(Y.url)-S.settings.editionDataUrls.indexOf(j.url)),-1!=w.settings.editions.indexOf(K.edition)?S.loadDataLabel(K):S.loadEditionLabel(K),K;console.warn("Edition already exists: "+K.edition)})}catch(N){return void console.warn("Invalid data url: "+$+" ["+N+"]")}}).apply(this,arguments)}validateEditionData(){s.checkDuplicates(),s.checkScenarioMonster(),s.checkSectionMonster(),s.checkMissingScenarioMonster(),s.checkMissingSectionMonster(),s.checkMonsterUsage(),s.checkMonsterBossCount()}loadDataLabel(P){this.label.data||(this.label.data={}),P.label&&P.label[this.settings.locale]&&(this.label.data=this.merge(this.label.data,!0,P.label[this.settings.locale])),P.labelSpoiler&&P.labelSpoiler[this.settings.locale]&&(this.label.data=this.merge(this.label.data,!0,P.labelSpoiler[this.settings.locale])),this.settings.locale!=this.defaultLocale&&P.label&&P.label[this.defaultLocale]&&(this.label.data=this.merge(this.label.data,!1,P.label[this.defaultLocale]),P.labelSpoiler&&P.labelSpoiler[this.defaultLocale]&&(this.label.data=this.merge(this.label.data,!1,P.labelSpoiler[this.defaultLocale]))),this.label.data.edition||(this.label.data.edition={}),this.label.data.character||(this.label.data.character={}),this.label.data.monster||(this.label.data.monster={}),this.label.data.deck||(this.label.data.deck={}),this.label.data.ability||(this.label.data.ability={}),this.label.data.scenario||(this.label.data.scenario={}),this.label.data.partyAchievements||(this.label.data.partyAchievements={}),this.label.data.globalAchievements||(this.label.data.globalAchievements={}),this.label.data.campaignSticker||(this.label.data.campaignSticker={}),this.label.data.scenario.group||(this.label.data.scenario.group={}),this.label.data.section||(this.label.data.section={}),this.label.data.objective||(this.label.data.objective={}),this.label.data.summon||(this.label.data.summon={}),this.label.data.battleGoals||(this.label.data.battleGoals={}),this.label.data.personalQuest||(this.label.data.personalQuest={}),this.label.data.items||(this.label.data.items={})}loadEditionLabel(P){this.label.data||(this.label.data={}),this.label.data.edition||(this.label.data.edition={}),this.settings.locale!=this.defaultLocale&&P.label&&P.label[this.defaultLocale]&&P.label[this.defaultLocale].edition&&(this.label.data.edition=this.merge(this.label.data.edition,!1,P.label[this.defaultLocale].edition)),P.label&&P.label[this.settings.locale]&&P.label[this.settings.locale].edition&&(this.label.data.edition=this.merge(this.label.data.edition,!0,P.label[this.settings.locale].edition))}isObject(P){return P&&"object"==typeof P&&!Array.isArray(P)}merge(P,S,...$){if(!$.length)return P;const V=P;if(this.isObject(V))for(let N=0;N<$.length;N+=1){const K=$[N];if(this.isObject(K))for(const Y in K)K.hasOwnProperty(Y)&&(this.isObject(K[Y])?(V[Y]?this.isObject(V[Y])||(V[Y]={"":V[Y]}):V[Y]={},this.merge(V[Y],S,K[Y])):Array.isArray(V[Y])&&Array.isArray(K[Y])?V[Y]=Array.from(new Set(V[Y].concat(K[Y]))):(S||!V[Y])&&(V[Y]=K[Y]))}return V}getEditionByUrl(P){const S=U.E.editionData.find($=>$.url==P);return S?S.url:(console.error("No edition data found for url '"+P+"'"),"")}addEditionDataUrl(P){var S=this;return(0,C.A)(function*(){if(-1==S.settings.editionDataUrls.indexOf(P)){const $=yield S.loadEditionData(P);if($)return S.settings.editionDataUrls.push(P),U.E.editionData.sort((V,N)=>S.settings.editionDataUrls.indexOf(V.url)-S.settings.editionDataUrls.indexOf(N.url)),-1!=S.settings.excludeEditionDataUrls.indexOf(P)&&S.settings.excludeEditionDataUrls.splice(S.settings.excludeEditionDataUrls.indexOf(P),1),S.storeSettings(),$}})()}removeEditionDataUrl(P){var S=this;return(0,C.A)(function*(){-1!=S.settings.editionDataUrls.indexOf(P)&&(U.E.editionData=U.E.editionData.filter($=>$.url!=P),S.settings.editionDataUrls.splice(S.settings.editionDataUrls.indexOf(P),1),-1!=S.defaultEditionDataUrls.indexOf(P)&&S.settings.excludeEditionDataUrls.push(P),S.storeSettings())})()}restoreDefaultEditionDataUrls(){var P=this;return(0,C.A)(function*(){for(let S of P.defaultEditionDataUrls)-1==P.settings.editionDataUrls.indexOf(S)&&(P.settings.editionDataUrls.push(S),yield P.loadEditionData(S));P.settings.editionDataUrls.sort((S,$)=>-1!=P.defaultEditionDataUrls.indexOf(S)&&-1!=P.defaultEditionDataUrls.indexOf($)?P.defaultEditionDataUrls.indexOf(S)-P.defaultEditionDataUrls.indexOf($):-1!=P.defaultEditionDataUrls.indexOf(S)&&-1==P.defaultEditionDataUrls.indexOf($)?-1:-1==P.defaultEditionDataUrls.indexOf(S)&&-1!=P.defaultEditionDataUrls.indexOf($)?1:P.settings.editionDataUrls.indexOf(S)-P.settings.editionDataUrls.indexOf($)),U.E.editionData.sort((S,$)=>P.settings.editionDataUrls.indexOf(S.url)-P.settings.editionDataUrls.indexOf($.url)),P.storeSettings()})()}updateLocale(P){var S=this;return(0,C.A)(function*(){S.label={},yield fetch("./assets/locales/"+P+".json").then($=>$.json()).then($=>{S.label=S.merge(S.label,!0,$)}).catch($=>{console.error("Invalid locale: "+P,$)}),P!=S.defaultLocale&&(yield fetch("./assets/locales/"+S.defaultLocale+".json").then($=>$.json()).then($=>{S.label=S.merge(S.label,!1,$)}).catch($=>{console.error("Invalid locale: "+P,$)})),S.label.data={};for(let $ of U.E.editionData)S.loadDataLabel($);switch(P){case"de":(0,t.EO)(v.A);break;case"fr":(0,t.EO)(D.A);break;case"ko":(0,t.EO)(O.A)}U.E.uiChange.emit()})()}getLabel(P,S=[],$=!0,V=!1,N="",K=this.label){if(P+="",!K)return V?this.emptyLabel(P,S,N):N&&P?this.getLabel(P):P||"";if(K[P])return"object"==typeof K[P]?K[P][""]?this.insertLabelArguments(K[P][""],S,$):V?this.emptyLabel(P,S,N):N&&P?this.getLabel(P):P||"":this.insertLabelArguments(K[P],S,$);{if("data.monster."==N){const j=P.match(/(.+)\-(scenario|section)\-(.+)/);if(j)return this.insertLabelArguments(K[P=j[1]],S,$)+" #"+j[3]}let Y=P.split(".");if(K[Y[0]])return P=Y.slice(1,Y.length).join("."),this.getLabel(P,S,$,V,N+Y[0]+".",K[Y[0]])}return V?this.emptyLabel(P,S,N):N&&P?this.getLabel(P):P||""}emptyLabel(P,S,$){return P+(S&&S.length>0?" ["+S+"]":"")}insertLabelArguments(P,S,$){if(S)for(let V in S)for(;-1!=P.indexOf(`{${V}}`);)if(P=P.replace(`{${V}}`,$?this.getLabel(S[V]):S[V]),-1!=S[V].indexOf(`{${V}}`)){console.warn("Loop for '"+P+"'",S[V]);break}return P}};window.settingsManager=w},31932:(p,k,M)=>{var C=M(37529),t=M(1115),v=M(12424),D=M(50854),O=M(34456),A=M(49122),E=M(46140),R=M(43205);var U=M(36039),X=M(89204),s=M(58317),T=M(29765),m=M(31619),w=M(26484),q=M(51824),P=M(42065),S=M(16538),$=M(13812),V=M(14670),N=M(7610),K=M(12120),Y=M(73219),j=M(42357),G=M(40840),Lt=M(40392);function Jt(i,r=void 0,e=!1){if("number"==typeof i)return e&&0==i?"-":i;if("string"==typeof i&&"0"==i)return"-";if(!i)return e?"-":"";let a=s.E.game.level;if(r&&r>0&&(a=r),m.f.settings.calculate&&(i.match($.p5)||i.match($.OD)))try{return(0,$.hZ)(i,a)}catch{return console.error("Could not calculate value for: ",i),i}const n=i.match($.OD);if(n){let o=n[3],g=[];const _=o&&o.startsWith("$");return _&&(o=o.replace("$",""),-1!=o.indexOf(":")&&(g=[o.split(":")[1]],o=o.split(":")[0])),_?n[1]+" "+m.f.getLabel("game.custom."+o,g):n[1]}for(;i.match(ci);)i=i.replace(ci,(o,...g)=>m.f.getLabel(g[0]));return i||(e?"-":"")}let Ut=(()=>{class i{el;value;level;empty=!1;C;L;calc;constructor(e){this.el=e,this.C=Math.max(2,s.E.characterManager.characterCount()),this.L=s.E.game.level,this.calc=m.f.settings.calculate}ngOnChanges(e){this.el.nativeElement.innerHTML=Jt(this.value,this.level,this.empty)}ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{(this.calc!=m.f.settings.calculate||this.C!=Math.max(2,s.E.characterManager.characterCount())||this.L!=s.E.game.level)&&(this.C=Math.max(2,s.E.characterManager.characterCount()),this.L=s.E.game.level,this.calc=m.f.settings.calculate,this.el.nativeElement.innerHTML=Jt(this.value,this.level,this.empty))}}),this.el.nativeElement.innerHTML=Jt(this.value,this.level,this.empty)}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}static \u0275fac=function(a){return new(a||i)(t.rXU(t.aKT))};static \u0275dir=t.FsC({type:i,selectors:[["","value-calc",""]],inputs:{value:[0,"value-calc","value"],level:"level",empty:"empty"},standalone:!1,features:[t.OA$]})}return i})();const ee=["enhancementContainer"],pe=(i,r,e,a,n,o)=>({highlight:i,inline:r,right:e,"text-black":a,fh:n,aoe:o}),Vt=i=>({small:i}),qt=(i,r)=>({"action-interactive":i,"action-interactive-highlight":r}),ue=i=>[i],ne=()=>[],he=(i,r)=>({small:i,"action-element-consume":r}),_e=(i,r)=>({consume:i,wild:r}),ye=(i,r,e)=>({consume:i,"action-interactive":r,"action-interactive-highlight":e}),xe=(i,r)=>({"text-white":i,small:r}),kt=()=>["alliesRange:","alliesRangeAffect:","allyAffectRange:","enemiesRange:","enemiesRangeAffect:","enemyRange:"],J=(i,r)=>({small:i,"text-white":r}),ut=(i,r)=>[i,r],He=(i,r)=>({small:i,"card-concat":r}),Ke=(i,r,e)=>({small:i,empty:r,first:e}),We=(i,r,e)=>({small:i,"action-interactive":r,"action-interactive-highlight":e}),Ot=i=>({"ghs-svg":i}),dt=i=>({elite:i}),Gt=(i,r)=>r.type+i;function Ae(i,r){if(1&i&&(t.j41(0,"span",2),t.nrm(1,"ghs-action-hex",21),t.k0s()),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(7,Vt,e.action.small)),t.R7$(),t.Y8G("action",e.action)("value",""+e.action.value)("size",e.hexSize)("index",e.actionIndex)("cardId",e.cardId)("character",e.character)}}function Ve(i,r){if(1&i&&t.nrm(0,"img",26),2&i){const e=t.XpG(3);t.Y8G("src","./assets/images"+(e.fhStyle?"/fh":"")+"/condition/"+e.getConditionName(e.values[0])+".svg",t.B4B)}}function Je(i,r){1&i&&t.nrm(0,"img",27)}function Ze(i,r){if(1&i&&(t.j41(0,"span",28),t.EFF(1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.JRh(e.values[1])}}function Fe(i,r){if(1&i&&t.nrm(0,"ghs-action-enhancements",29),2&i){const e=t.XpG(3);t.Y8G("action",e.origAction)("index",e.actionIndex)("character",e.character)("cardId",e.cardId)}}function Ee(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function Sn(i,r){if(1&i){const e=t.RV6();t.nVh(0,Ee,2,0,"span"),t.j41(1,"ghs-action",31),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(4);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(4);t.vxM(n.fhStyle&&a>0?0:-1),t.R7$(),t.Aen(n.style),t.Y8G("ngClass","subaction-"+e.type)("action",e)("monster",n.monster)("objective",n.objective)("inline",n.inline)("right",n.right)("textBlack",n.textBlack)("hexSize",n.hexSize)("statsCalculation",n.statsCalculation)("interactiveAbilities",n.interactiveAbilities)("interactiveActions",n.interactiveActions)("index",(n.actionIndex?n.actionIndex+"-":"")+n.getOrigIndex(e))("monsterType",n.monsterType)("character",n.character)("cardId",n.cardId)}}function $n(i,r){if(1&i&&(t.j41(0,"div",30),t.Z7z(1,Sn,2,18,null,null,Gt),t.nI1(3,"slice"),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(t.i5U(3,0,e.subActions,e.hasAOE?1:0))}}function Dn(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",3)(1,"span",22),t.bIt("singleClick",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.toggleHighlight(n))}),t.j41(2,"span",23),t.nrm(3,"span",24),t.k0s(),t.j41(4,"span",25),t.nVh(5,Ve,1,1,"img",26),t.nVh(6,Je,1,0,"img",27),t.nVh(7,Ze,2,1,"span",28),t.k0s(),t.nVh(8,Fe,1,4,"ghs-action-enhancements",29),t.k0s(),t.nVh(9,$n,4,3,"div",30),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(15,Vt,e.action.small)),t.R7$(),t.Y8G("clickBehind",!e.isInteractiveApplicableAction)("ghs-tooltip","monster.toggleAction")("delay",1)("disabled",!e.isInteractiveApplicableAction)("ngClass",t.l_i(17,qt,e.isInteractiveApplicableAction,e.highlightAction())),t.R7$(2),t.Aen(e.style),t.Y8G("ghs-label","game.condition."+e.getConditionName(e.values[0]))("ghs-label-args",e.values.length>1?t.eq3(20,ue,e.values[1]):t.lJ4(22,ne)),t.R7$(2),t.vxM("invalid"!=e.getConditionName(e.values[0])?5:-1),t.R7$(),t.vxM("invalid"==e.getConditionName(e.values[0])?6:-1),t.R7$(),t.vxM(e.values.length>1?7:-1),t.R7$(),t.vxM(e.origAction.enhancementTypes&&e.origAction.enhancementTypes.length&&e.character&&e.cardId?8:-1),t.R7$(),t.vxM(e.subActions.length>0?9:-1)}}function cn(i,r){if(1&i&&(t.j41(0,"span",33),t.nrm(1,"img",36),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(3);t.Y8G("ngClass",t.l_i(2,_e,a.action.valueType==a.ActionValueType.minus,"wild"==e)),t.R7$(),t.Y8G("src","./assets/images"+(a.fhStyle?"/fh":"")+"/element/"+e+".svg",t.B4B)}}function fe(i,r){1&i&&(t.j41(0,"span",34),t.EFF(1,":"),t.k0s())}function Ce(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function ln(i,r){if(1&i){const e=t.RV6();t.nVh(0,Ce,2,0,"span"),t.j41(1,"ghs-action",37),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(4);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(4);t.vxM(n.fhStyle&&a>0?0:-1),t.R7$(),t.Aen(n.style),t.Y8G("ngClass","subaction-"+e.type)("action",e)("monster",n.monster)("objective",n.objective)("relative",n.relative||n.forceRelative)("inline",n.inline)("right",n.right)("textBlack",n.textBlack)("hexSize",n.hexSize)("interactiveAbilities",n.interactiveAbilities)("interactiveActions",n.interactiveActions)("statsCalculation",n.statsCalculation)("index",(n.actionIndex?n.actionIndex+"-":"")+n.getOrigIndex(e))("monsterType",n.monsterType)("character",n.character)("cardId",n.cardId)}}function gn(i,r){if(1&i&&(t.j41(0,"div",35),t.Z7z(1,ln,2,19,null,null,Gt),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.subActions)}}function dn(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",4)(1,"span",32),t.bIt("singleClick",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.toggleHighlight(n))}),t.Z7z(2,cn,2,5,"span",33,t.fX1),t.nVh(4,fe,2,0,"span",34),t.k0s(),t.nVh(5,gn,3,0,"div",35),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.l_i(8,he,e.action.small,e.action.valueType==e.ActionValueType.minus)),t.R7$(),t.Y8G("clickBehind",!e.isInteractiveApplicableAction)("ghs-tooltip","monster.toggleAction")("delay",1)("disabled",!e.isInteractiveApplicableAction)("ngClass",t.l_i(11,qt,e.isInteractiveApplicableAction,e.highlightAction())),t.R7$(),t.Dyx(e.values),t.R7$(2),t.vxM(e.action.valueType==e.ActionValueType.minus&&e.subActions.length>0?4:-1),t.R7$(),t.vxM(e.subActions.length>0?5:-1)}}function hn(i,r){1&i&&(t.j41(0,"span",34),t.EFF(1,":"),t.k0s())}function Xe(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",38)(1,"span",39),t.bIt("singleClick",function(n){t.eBV(e);const o=t.XpG(3);return t.Njj(o.toggleHighlight(n))}),t.j41(2,"span",40),t.nrm(3,"img",36),t.k0s(),t.j41(4,"span",40),t.nrm(5,"img",36),t.k0s()(),t.nVh(6,hn,2,0,"span",34),t.k0s()}if(2&i){const e=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.sMw(8,ye,e.action.valueType==e.ActionValueType.minus,e.isInteractiveApplicableAction,e.highlightAction()))("clickBehind",!e.isInteractiveApplicableAction)("ghs-tooltip","monster.toggleAction")("delay",1)("disabled",!e.isInteractiveApplicableAction),t.R7$(2),t.Y8G("src","./assets/images"+(e.fhStyle?"/fh":"")+"/element/"+e.values[0]+".svg",t.B4B),t.R7$(2),t.Y8G("src","./assets/images"+(e.fhStyle?"/fh":"")+"/element/"+e.values[1]+".svg",t.B4B),t.R7$(),t.vxM(e.action.valueType==e.ActionValueType.minus?6:-1)}}function In(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function Li(i,r){if(1&i){const e=t.RV6();t.nVh(0,In,2,0,"span"),t.j41(1,"ghs-action",37),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(4);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(4);t.vxM(n.fhStyle&&a>0?0:-1),t.R7$(),t.Aen(n.style),t.Y8G("ngClass","subaction-"+e.type)("action",e)("monster",n.monster)("objective",n.objective)("relative",n.relative||n.forceRelative)("inline",n.inline)("right",n.right)("textBlack",n.textBlack)("hexSize",n.hexSize)("interactiveAbilities",n.interactiveAbilities)("interactiveActions",n.interactiveActions)("statsCalculation",n.statsCalculation)("index",(n.actionIndex?n.actionIndex+"-":"")+n.getOrigIndex(e))("monsterType",n.monsterType)("character",n.character)("cardId",n.cardId)}}function Ui(i,r){if(1&i&&(t.j41(0,"div",35),t.Z7z(1,Li,2,19,null,null,Gt),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.subActions)}}function qi(i,r){if(1&i&&(t.j41(0,"span",4),t.nVh(1,Xe,7,12,"span",38),t.nVh(2,Ui,3,0,"div",35),t.k0s()),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.l_i(3,he,e.action.small,e.action.valueType==e.ActionValueType.minus)),t.R7$(),t.vxM(2==e.values.length?1:-1),t.R7$(),t.vxM(e.subActions.length>0?2:-1)}}function Hi(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function Ki(i,r){if(1&i){const e=t.RV6();t.nVh(0,Hi,2,0,"span"),t.j41(1,"ghs-action",45),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(5);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(5);t.vxM(n.fhStyle&&a>0?0:-1),t.R7$(),t.Aen(n.style),t.Y8G("ngClass","subaction-"+e.type)("action",e)("monster",n.monster)("objective",n.objective)("relative",n.relative)("inline",n.inline)("right",n.right)("textBlack",n.textBlack)("hexSize",n.hexSize)("interactiveAbilities",n.interactiveAbilities)("interactiveActions",n.interactiveActions)("statsCalculation",n.statsCalculation)("index",(n.actionIndex?n.actionIndex+"-":"")+n.getOrigIndex(e))("monsterType",n.getMonsterType(""+n.action.value))}}function si(i,r){if(1&i&&(t.j41(0,"div",44),t.Z7z(1,Ki,2,17,null,null,Gt),t.k0s()),2&i){const e=t.XpG(4);t.R7$(),t.Dyx(e.subActions)}}function An(i,r){if(1&i&&(t.j41(0,"span",41)(1,"span",42),t.nrm(2,"span",43),t.EFF(3,":"),t.k0s(),t.nVh(4,si,3,0,"div",44),t.k0s()),2&i){const e=t.XpG(3);t.Y8G("ngClass",t.eq3(6,Vt,e.action.small)),t.R7$(),t.Y8G("ngClass","monster-type-"+e.action.value),t.R7$(),t.Aen(e.style),t.Y8G("ghs-label","monster."+e.action.value),t.R7$(2),t.vxM(e.subActions.length>0?4:-1)}}function ri(i,r){if(1&i&&t.nVh(0,An,5,8,"span",41),2&i){const e=t.XpG(2);t.vxM(e.relative||e.hasEntities(""+e.action.value)?0:-1)}}function Bt(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-action",49),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(5);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(5);t.Aen(a.style),t.Y8G("ngClass","subaction-"+e.type)("action",e)("monster",a.monster)("objective",a.objective)("inline",a.inline)("right",a.right)("textBlack",a.textBlack)("hexSize",a.hexSize)("interactiveAbilities",a.interactiveAbilities)("interactiveActions",a.interactiveActions)("relative",a.relative||a.forceRelative)("statsCalculation",a.statsCalculation)("index",(a.actionIndex?a.actionIndex+"-":"")+a.getOrigIndex(e))("monsterType",a.monsterType)("character",a.character)("cardId",a.cardId)}}function Wi(i,r){if(1&i&&(t.j41(0,"div",47),t.Z7z(1,Bt,1,18,"ghs-action",48,Gt),t.k0s()),2&i){const e=t.XpG(4);t.R7$(),t.Dyx(e.subActions)}}function Ji(i,r){if(1&i&&(t.j41(0,"span",46),t.nVh(1,Wi,3,0,"div",47),t.k0s()),2&i){const e=t.XpG(3);t.Y8G("ngClass",t.eq3(2,Vt,e.action.small)),t.R7$(),t.vxM(e.subActions.length>0?1:-1)}}function Zi(i,r){if(1&i&&t.nVh(0,Ji,2,4,"span",46),2&i){const e=t.XpG(2);t.vxM(e.action.value==e.round?0:-1)}}function f(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"/"),t.k0s())}function Pt(i,r){if(1&i&&(t.j41(0,"span",55),t.EFF(1),t.k0s()),2&i){const e=t.XpG(4);t.R7$(),t.JRh(e.getEliteRange())}}function c(i,r){if(1&i&&(t.j41(0,"span",52)(1,"span"),t.EFF(2),t.k0s(),t.nVh(3,f,2,0,"span"),t.nVh(4,Pt,2,1,"span",55),t.k0s()),2&i){const e=t.XpG(3);t.Y8G("ngClass",t.eq3(4,Vt,e.action.small)),t.R7$(2),t.JRh(e.getRange()),t.R7$(),t.vxM(e.getEliteRange()&&e.getRange()!=e.getEliteRange()?3:-1),t.R7$(),t.vxM(e.getEliteRange()&&e.getRange()!=e.getEliteRange()?4:-1)}}function l(i,r){if(1&i&&t.nrm(0,"ghs-action-enhancements",53),2&i){const e=r.$implicit,a=t.XpG(3);t.Y8G("action",a.origAction)("index",a.actionIndex)("character",a.character)("cardId",a.cardId)("slot",e)}}function d(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function h(i,r){if(1&i){const e=t.RV6();t.nVh(0,d,2,0,"span"),t.j41(1,"ghs-action",49),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(4);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(4);t.vxM(n.fhStyle&&a>0?0:-1),t.R7$(),t.Aen(n.style),t.Y8G("ngClass","subaction-"+e.type)("action",e)("monster",n.monster)("objective",n.objective)("inline",n.inline)("right",n.right)("textBlack",n.textBlack)("hexSize",n.hexSize)("interactiveAbilities",n.interactiveAbilities)("interactiveActions",n.interactiveActions)("relative",n.relative||n.forceRelative)("statsCalculation",n.statsCalculation)("index",(n.actionIndex?n.actionIndex+"-":"")+n.getOrigIndex(e))("monsterType",n.monsterType)("character",n.character)("cardId",n.cardId)}}function u(i,r){if(1&i&&(t.j41(0,"div",54),t.Z7z(1,h,2,19,null,null,Gt),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.subActions)}}function b(i,r){if(1&i&&(t.j41(0,"span",5)(1,"div",50,0),t.nrm(3,"span",51),t.nVh(4,c,5,6,"span",52),t.Z7z(5,l,1,5,"ghs-action-enhancements",53,t.fX1),t.nI1(7,"ghsRange"),t.k0s(),t.nVh(8,u,3,0,"div",54),t.k0s()),2&i){const e=t.XpG(2);t.R7$(3),t.Aen(e.style),t.Y8G("ghs-label","game.specialTarget."+e.values[0])("ghs-label-args",e.values.slice(1))("relative",e.relative||e.forceRelative)("ngClass",t.l_i(11,xe,!e.textBlack&&!e.right,e.action.small)),t.R7$(),t.vxM(-1!=t.lJ4(14,kt).indexOf(e.action.value+"")?4:-1),t.R7$(),t.Dyx(t.i5U(7,8,t.lJ4(15,ne),e.character&&e.cardId&&e.origAction&&e.origAction.enhancementTypes&&e.origAction.enhancementTypes.length||0)),t.R7$(3),t.vxM(e.subActions.length>0?8:-1)}}function x(i,r){if(1&i&&t.nrm(0,"ghs-action-enhancements",53),2&i){const e=r.$implicit,a=t.XpG(4);t.Y8G("action",a.origAction)("index",a.actionIndex)("character",a.character)("cardId",a.cardId)("slot",e)}}function F(i,r){if(1&i&&(t.j41(0,"div",50,0),t.nrm(2,"span",57),t.Z7z(3,x,1,5,"ghs-action-enhancements",53,t.fX1),t.nI1(5,"ghsRange"),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.Aen(e.style),t.Y8G("ghs-label",e.action.value+"")("relative",e.relative||e.forceRelative)("ngClass",t.l_i(8,J,e.action.small,!e.textBlack&&!e.right)),t.R7$(),t.Dyx(t.i5U(5,5,t.lJ4(11,ne),e.character&&e.cardId&&e.origAction&&e.origAction.enhancementTypes&&e.origAction.enhancementTypes.length||0))}}function z(i,r){if(1&i&&t.nrm(0,"ghs-action-enhancements",29),2&i){const e=t.XpG(4);t.Y8G("action",e.origAction)("index",e.actionIndex)("character",e.character)("cardId",e.cardId)}}function H(i,r){if(1&i&&(t.nrm(0,"span",57),t.nVh(1,z,1,4,"ghs-action-enhancements",29)),2&i){const e=t.XpG(3);t.Aen(e.style),t.Y8G("ghs-label",e.action.value+"")("relative",e.relative||e.forceRelative)("ngClass",t.l_i(6,J,e.action.small,!e.textBlack&&!e.right)),t.R7$(),t.vxM(e.origAction.enhancementTypes&&e.origAction.enhancementTypes.length&&e.character&&e.cardId?1:-1)}}function Q(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-action",49),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(4);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(4);t.Aen(a.style),t.Y8G("ngClass","subaction-"+e.type)("action",e)("monster",a.monster)("objective",a.objective)("inline",a.inline)("right",a.right)("textBlack",a.textBlack)("hexSize",a.hexSize)("interactiveAbilities",a.interactiveAbilities)("interactiveActions",a.interactiveActions)("relative",a.relative||a.forceRelative)("statsCalculation",a.statsCalculation)("index",(a.actionIndex?a.actionIndex+"-":"")+a.getOrigIndex(e))("monsterType",a.monsterType)("character",a.character)("cardId",a.cardId)}}function at(i,r){if(1&i&&(t.j41(0,"div",56),t.Z7z(1,Q,1,18,"ghs-action",48,Gt),t.nI1(3,"slice"),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(t.i5U(3,0,e.subActions,e.hasAOE?1:0))}}function ct(i,r){if(1&i&&(t.j41(0,"span",6),t.nVh(1,F,6,12,"div",50),t.nVh(2,H,2,9),t.nVh(3,at,4,3,"div",56),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.vxM(e.action.enhancementTypes&&"any"==e.action.enhancementTypes[0]?-1:1),t.R7$(),t.vxM(e.action.enhancementTypes&&"any"==e.action.enhancementTypes[0]?2:-1),t.R7$(),t.vxM(e.subActions.length>0?3:-1)}}function gt(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-action",49),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(4);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(4);t.Aen(a.style),t.Y8G("ngClass","subaction-"+e.type)("action",e)("monster",a.monster)("objective",a.objective)("inline",a.inline)("right",a.right)("textBlack",a.textBlack)("hexSize",a.hexSize)("interactiveAbilities",a.interactiveAbilities)("interactiveActions",a.interactiveActions)("relative",!0)("statsCalculation",a.statsCalculation)("index",(a.actionIndex?a.actionIndex+"-":"")+a.getOrigIndex(e))("monsterType",a.monsterType)("character",a.character)("cardId",a.cardId)}}function wt(i,r){if(1&i&&(t.j41(0,"div",56),t.Z7z(1,gt,1,18,"ghs-action",48,Gt),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.subActions)}}function Ft(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",58),t.bIt("singleClick",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.toggleHighlight(n))}),t.nrm(1,"span",57),t.nVh(2,wt,3,0,"div",56),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("clickBehind",!e.isInteractiveApplicableAction)("ghs-tooltip","monster.toggleAction")("delay",1)("disabled",!e.isInteractiveApplicableAction)("ngClass",t.l_i(11,qt,e.isInteractiveApplicableAction,e.highlightAction())),t.R7$(),t.Aen(e.style),t.Y8G("ghs-label",e.action.value+"")("relative",e.relative||e.forceRelative)("ngClass",t.l_i(14,J,e.action.small,!e.textBlack&&!e.right)),t.R7$(),t.vxM(e.subActions.length>0?2:-1)}}function ie(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-action",49),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(4);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(4);t.Aen(a.style),t.Y8G("ngClass","subaction-"+e.type)("action",e)("monster",a.monster)("objective",a.objective)("inline",a.inline)("right",a.right)("textBlack",a.textBlack)("hexSize",a.hexSize)("interactiveAbilities",a.interactiveAbilities)("interactiveActions",a.interactiveActions)("relative",a.relative||a.forceRelative)("statsCalculation",a.statsCalculation)("index",(a.actionIndex?a.actionIndex+"-":"")+a.getOrigIndex(e))("monsterType",a.monsterType)("character",a.character)("cardId",a.cardId)}}function le(i,r){if(1&i&&(t.j41(0,"div",56),t.Z7z(1,ie,1,18,"ghs-action",48,Gt),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.subActions)}}function _n(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",58),t.bIt("singleClick",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.toggleHighlight(n))}),t.nrm(1,"span",59),t.nVh(2,le,3,0,"div",56),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("clickBehind",!e.isInteractiveApplicableAction)("ghs-tooltip","monster.toggleAction")("delay",1)("disabled",!e.isInteractiveApplicableAction)("ngClass",t.l_i(12,qt,e.isInteractiveApplicableAction,e.highlightAction())),t.R7$(),t.Aen(e.style),t.Y8G("ghs-label","game.sufferDamage")("relative",e.relative||e.forceRelative)("ngClass",t.l_i(15,J,e.action.small,!e.textBlack&&!e.right))("ghs-label-args",t.l_i(18,ut,e.monster?"%data.monster."+e.monster.name+"%":"",e.action.value)),t.R7$(),t.vxM(e.subActions.length>0?2:-1)}}function wc(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-action",49),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(4);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(4);t.Aen(a.style),t.Y8G("ngClass","subaction-"+e.type)("action",e)("monster",a.monster)("objective",a.objective)("inline",a.inline)("right",a.right)("textBlack",a.textBlack)("hexSize",a.hexSize)("interactiveAbilities",a.interactiveAbilities)("interactiveActions",a.interactiveActions)("relative",a.relative||a.forceRelative)("statsCalculation",a.statsCalculation)("index",(a.actionIndex?a.actionIndex+"-":"")+a.getOrigIndex(e))("monsterType",a.monsterType)("character",a.character)("cardId",a.cardId)}}function Rc(i,r){if(1&i&&(t.j41(0,"div",56),t.Z7z(1,wc,1,18,"ghs-action",48,Gt),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.subActions)}}function jc(i,r){if(1&i&&(t.j41(0,"span",6),t.nrm(1,"span",57),t.nVh(2,Rc,3,0,"div",56),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Aen(e.style),t.Y8G("ghs-label",e.action.value+"")("relative",e.relative||e.forceRelative)("ngClass",t.l_i(6,J,e.action.small,!e.textBlack&&!e.right)),t.R7$(),t.vxM(e.subActions.length>0?2:-1)}}function Gc(i,r){if(1&i&&t.nrm(0,"span",8),2&i){const e=t.XpG(2);t.Y8G("ghs-label",e.action.value+"")}}function Tc(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-action",49),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(4);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(4);t.Aen(n.style),t.Y8G("ngClass","subaction-"+e.type)("action",e)("monster",n.monster)("objective",n.objective)("inline",n.inline)("right",n.right)("textBlack",n.textBlack)("hexSize",n.hexSize)("interactiveAbilities",n.interactiveAbilities)("interactiveActions",n.interactiveActions)("relative",!0)("statsCalculation",!1)("index",(n.actionIndex?n.actionIndex+"-":"")+a)("monsterType",n.monsterType)("character",n.character)("cardId",n.cardId)}}function Sc(i,r){if(1&i&&(t.j41(0,"div",61),t.Z7z(1,Tc,1,18,"ghs-action",48,Gt),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.subActions)}}function $c(i,r){if(1&i&&(t.j41(0,"span",9),t.nrm(1,"span",60),t.nVh(2,Sc,3,0,"div",61),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Aen(e.style),t.Y8G("ghs-label",e.action.value+"")("relative",e.relative||e.forceRelative)("ngClass",t.l_i(6,J,e.action.small,!e.textBlack&&!e.right)),t.R7$(),t.vxM(e.subActions.length>0?2:-1)}}function Dc(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-action",49),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(4);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(4);t.Aen(a.style),t.Y8G("ngClass","subaction-"+a.subActions[e+(a.hasAOE?1:0)].type)("action",a.subActions[e+(a.hasAOE?1:0)])("monster",a.monster)("objective",a.objective)("inline",a.inline)("right",a.right)("textBlack",a.textBlack)("hexSize",a.hexSize)("interactiveAbilities",a.interactiveAbilities)("interactiveActions",a.interactiveActions)("relative",a.relative||a.forceRelative)("statsCalculation",a.statsCalculation)("index",(a.actionIndex?a.actionIndex+"-":"")+a.getOrigIndex(a.subActions[e+(a.hasAOE?1:0)]))("monsterType",a.monsterType)("character",a.character)("cardId",a.cardId)}}function Ic(i,r){if(1&i&&(t.Z7z(0,Dc,1,18,"ghs-action",48,t.fX1),t.nI1(2,"ghsRange")),2&i){const e=t.XpG(3);t.Dyx(t.i5U(2,0,t.lJ4(3,ne),e.subActions.length))}}function Ac(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",10)(1,"ghs-action-summon",62),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s(),t.nVh(2,Ic,3,4),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(17,Vt,e.action.small)),t.R7$(),t.Aen(e.style),t.Y8G("action",e.action)("right",e.right)("textBlack",e.textBlack)("monster",e.monster)("objective",e.objective)("interactiveAbilities",e.interactiveAbilities)("interactiveActions",e.interactiveActions)("index",e.actionIndex)("character",e.character)("cardId",e.cardId)("monsterType",e.monsterType)("character",e.character)("cardId",e.cardId),t.R7$(),t.vxM(e.subActions.length>0?2:-1)}}function Vc(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-action",49),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(4);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(4);t.Aen(a.style),t.Y8G("ngClass","subaction-"+e.type)("action",e)("monster",a.monster)("objective",a.objective)("inline",a.inline)("right",a.right)("textBlack",a.textBlack)("hexSize",a.hexSize)("interactiveAbilities",a.interactiveAbilities)("interactiveActions",a.interactiveActions)("relative",a.relative||a.forceRelative)("statsCalculation",a.statsCalculation)("index",(a.actionIndex?a.actionIndex+"-":"")+a.getOrigIndex(e))("monsterType",a.monsterType)("character",a.character)("cardId",a.cardId)}}function Fc(i,r){if(1&i&&t.Z7z(0,Vc,1,18,"ghs-action",48,Gt),2&i){const e=t.XpG(3);t.Dyx(e.subActions)}}function Xc(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",10)(1,"ghs-action-summon",63),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s(),t.nVh(2,Fc,2,0),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(18,Vt,e.action.small)),t.R7$(),t.Aen(e.style),t.Y8G("action",e.action)("right",e.right)("textBlack",e.textBlack)("monster",e.monster)("objective",e.objective)("spawn",!0)("interactiveAbilities",e.interactiveAbilities)("interactiveActions",e.interactiveActions)("index",e.actionIndex)("character",e.character)("cardId",e.cardId)("monsterType",e.monsterType)("character",e.character)("cardId",e.cardId),t.R7$(),t.vxM(e.subActions.length>0?2:-1)}}function Bc(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-action",49),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(4);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(4);t.Aen(a.style),t.Y8G("ngClass","subaction-"+e.type)("action",e)("monster",a.monster)("objective",a.objective)("inline",a.inline)("right",a.right)("textBlack",a.textBlack)("hexSize",a.hexSize)("interactiveAbilities",a.interactiveAbilities)("interactiveActions",a.interactiveActions)("relative",a.relative||a.forceRelative)("statsCalculation",a.statsCalculation)("index",(a.actionIndex?a.actionIndex+"-":"")+a.getOrigIndex(e))("monsterType",a.monsterType)("character",a.character)("cardId",a.cardId)}}function Yc(i,r){if(1&i&&t.Z7z(0,Bc,1,18,"ghs-action",48,Gt),2&i){const e=t.XpG(3);t.Dyx(e.subActions)}}function Nc(i,r){if(1&i&&(t.j41(0,"span",11),t.nrm(1,"span",57),t.nVh(2,Yc,2,0),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Aen(e.style),t.Y8G("ghs-label",e.action.value+"")("relative",e.relative||e.forceRelative)("ngClass",t.l_i(6,J,e.action.small,!e.textBlack&&!e.right)),t.R7$(),t.vxM(e.subActions.length>0?2:-1)}}function zc(i,r){if(1&i&&t.nrm(0,"span",67),2&i){const e=t.XpG(6);t.Aen(e.style),t.Y8G("ghs-label",e.values[0])("relative",e.relative||e.forceRelative)}}function Lc(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function Uc(i,r){if(1&i&&(t.j41(0,"span"),t.nVh(1,zc,1,4,"span",66),t.nVh(2,Lc,2,0,"span"),t.k0s()),2&i){const e=t.XpG(5);t.R7$(),t.vxM(e.fhStyle?-1:1),t.R7$(),t.vxM(e.fhStyle?2:-1)}}function qc(i,r){if(1&i&&(t.j41(0,"span",65),t.nVh(1,Uc,3,2,"span"),t.k0s()),2&i){const e=t.XpG(4);t.R7$(),t.vxM(e.values.length>0?1:-1)}}function Hc(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-action",49),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(3);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s(),t.nVh(1,qc,2,1,"span",65)}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.Aen(n.style),t.Y8G("ngClass","subaction-"+e.type)("action",e)("monster",n.monster)("objective",n.objective)("inline",n.inline)("right",n.right)("textBlack",n.textBlack)("hexSize",n.hexSize)("interactiveAbilities",n.interactiveAbilities)("interactiveActions",n.interactiveActions)("relative",n.relative||n.forceRelative)("statsCalculation",n.statsCalculation)("index",(n.actionIndex?n.actionIndex+"-":"")+n.getOrigIndex(e))("monsterType",n.monsterType)("character",n.character)("cardId",n.cardId),t.R7$(),t.vxM(!n.inline&&(n.values.length>1&&+n.values[1]>0&&a<+n.values[1]-1||n.values.length<2&&a<n.subActions.length-1)&&e.type!=n.ActionType.concatenationSpacer?1:-1)}}function Kc(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function Wc(i,r){if(1&i){const e=t.RV6();t.nVh(0,Kc,2,0,"span"),t.j41(1,"ghs-action",49),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(4);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(4);t.vxM(n.fhStyle&&a>0?0:-1),t.R7$(),t.Aen(n.style),t.Y8G("ngClass","subaction-"+e.type)("action",e)("monster",n.monster)("objective",n.objective)("inline",n.inline)("right",n.right)("textBlack",n.textBlack)("hexSize",n.hexSize)("interactiveAbilities",n.interactiveAbilities)("interactiveActions",n.interactiveActions)("relative",n.relative||n.forceRelative)("statsCalculation",n.statsCalculation)("index",(n.actionIndex?n.actionIndex+"-":"")+n.getOrigIndex(e))("monsterType",n.monsterType)("character",n.character)("cardId",n.cardId)}}function Jc(i,r){if(1&i&&(t.j41(0,"div",30),t.Z7z(1,Wc,2,19,null,null,Gt),t.nI1(3,"slice"),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(t.brH(3,0,e.subActions,+e.values[1]+(e.hasAOE?1:0),e.subActions.length))}}function Zc(i,r){if(1&i&&(t.j41(0,"span",12)(1,"span",64),t.Z7z(2,Hc,2,19,null,null,Gt),t.nI1(4,"slice"),t.k0s(),t.nVh(5,Jc,4,4,"div",30),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.l_i(6,He,e.action.small,e.cardConcat)),t.R7$(),t.Dyx(t.brH(4,2,e.subActions,0,e.values.length>1?+e.values[1]:e.subActions.length)),t.R7$(3),t.vxM(e.values.length>1&&e.subActions.length>+e.values[1]?5:-1)}}function Qc(i,r){if(1&i&&(t.j41(0,"span",69),t.EFF(1," \xa0 "),t.k0s()),2&i){const e=t.XpG(3);t.Y8G("ngClass",t.eq3(1,Vt,e.action.small))}}function tl(i,r){if(1&i&&(t.j41(0,"span",12)(1,"span",68),t.Z7z(2,Qc,2,3,"span",69,t.fX1),t.nI1(4,"ghsRange"),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(2),t.Dyx(t.i5U(4,0,t.lJ4(3,ne),e.EntityValueFunction(e.action.value)||1))}}function el(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-action",49),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(4);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(4);t.Aen(a.style),t.Y8G("ngClass","subaction-"+e.type)("action",e)("monster",a.monster)("objective",a.objective)("inline",a.inline)("right",a.right)("textBlack",a.textBlack)("hexSize",a.hexSize)("interactiveAbilities",a.interactiveAbilities)("interactiveActions",a.interactiveActions)("relative",a.relative||a.forceRelative)("statsCalculation",a.statsCalculation)("index",(a.actionIndex?a.actionIndex+"-":"")+a.getOrigIndex(e))("monsterType",a.monsterType)("character",a.character)("cardId",a.cardId)}}function nl(i,r){if(1&i&&(t.j41(0,"span",71),t.Z7z(1,el,1,18,"ghs-action",48,Gt),t.k0s()),2&i){const e=t.XpG(3);t.xc7("--ghs-grid-columns",e.action.value||2),t.Y8G("ngClass",t.eq3(3,Vt,e.action.small)),t.R7$(),t.Dyx(e.subActions)}}function il(i,r){if(1&i&&(t.j41(0,"span",12),t.nVh(1,nl,3,5,"span",70),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.vxM(e.subActions.length>0?1:-1)}}function al(i,r){if(1&i&&t.nrm(0,"span",74),2&i){const e=t.XpG(3);t.Aen(e.style),t.Y8G("ghs-label",""+e.action.value)("relative",e.relative||e.forceRelative)}}function ol(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-action",49),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(3);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(3);t.Aen(a.style),t.Y8G("ngClass","subaction-"+e.type)("action",e)("monster",a.monster)("objective",a.objective)("inline",a.inline)("right",a.right)("textBlack",a.textBlack)("hexSize",a.hexSize)("interactiveAbilities",a.interactiveAbilities)("interactiveActions",a.interactiveActions)("relative",a.relative||a.forceRelative)("statsCalculation",a.statsCalculation)("index",(a.actionIndex?a.actionIndex+"-":"")+a.getOrigIndex(e))("monsterType",a.monsterType)("character",a.character)("cardId",a.cardId)}}function sl(i,r){if(1&i&&(t.j41(0,"span",13),t.nVh(1,al,1,4,"span",72),t.j41(2,"span",73),t.Z7z(3,ol,1,18,"ghs-action",48,Gt),t.k0s()()),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.sMw(2,Ke,e.action.small,0==e.subActions.length,"0"==e.actionIndex)),t.R7$(),t.vxM(e.action.value?1:-1),t.R7$(2),t.Dyx(e.subActions)}}function rl(i,r){if(1&i&&t.nrm(0,"span",74),2&i){const e=t.XpG(3);t.Aen(e.style),t.Y8G("ghs-label",""+e.action.value)("relative",e.relative||e.forceRelative)}}function cl(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-action",49),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(3);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(3);t.Aen(a.style),t.Y8G("ngClass","subaction-"+e.type)("action",e)("monster",a.monster)("objective",a.objective)("inline",a.inline)("right",a.right)("textBlack",a.textBlack)("hexSize",a.hexSize)("interactiveAbilities",a.interactiveAbilities)("interactiveActions",a.interactiveActions)("relative",a.relative||a.forceRelative)("statsCalculation",a.statsCalculation)("index",(a.actionIndex?a.actionIndex+"-":"")+a.getOrigIndex(e))("monsterType",a.monsterType)("character",a.character)("cardId",a.cardId)}}function ll(i,r){if(1&i&&(t.j41(0,"span",14),t.nVh(1,rl,1,4,"span",72),t.j41(2,"span",73),t.Z7z(3,cl,1,18,"ghs-action",48,Gt),t.k0s()()),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Vt,e.action.small)),t.R7$(),t.vxM(e.action.value?1:-1),t.R7$(2),t.Dyx(e.subActions)}}function gl(i,r){if(1&i&&t.nrm(0,"span",74),2&i){const e=t.XpG(3);t.Aen(e.style),t.Y8G("ghs-label",""+e.action.value)("relative",e.relative||e.forceRelative)}}function dl(i,r){1&i&&(t.j41(0,"span",75)(1,"span",28),t.EFF(2,"!"),t.k0s()())}function hl(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-action",49),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(3);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(3);t.Aen(a.style),t.Y8G("ngClass","subaction-"+e.type)("action",e)("monster",a.monster)("objective",a.objective)("inline",a.inline)("right",a.right)("textBlack",a.textBlack)("hexSize",a.hexSize)("interactiveAbilities",a.interactiveAbilities)("interactiveActions",a.interactiveActions)("relative",a.relative||a.forceRelative)("statsCalculation",a.statsCalculation)("index",(a.actionIndex?a.actionIndex+"-":"")+a.getOrigIndex(e))("monsterType",a.monsterType)("character",a.character)("cardId",a.cardId)}}function _l(i,r){if(1&i&&(t.j41(0,"span",15),t.nVh(1,gl,1,4,"span",72),t.nVh(2,dl,3,0,"span",75),t.j41(3,"span",73),t.Z7z(4,hl,1,18,"ghs-action",48,Gt),t.k0s()()),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(3,Vt,e.action.small)),t.R7$(),t.vxM(e.action.value?1:-1),t.R7$(),t.vxM(e.action.value?-1:2),t.R7$(2),t.Dyx(e.subActions)}}function ml(i,r){if(1&i&&t.nrm(0,"img",78),2&i){const e=t.XpG(3);t.Y8G("src","./assets/images/action/card/overlay/"+e.values[0]+".svg",t.B4B)}}function pl(i,r){if(1&i&&t.nrm(0,"span",80),2&i){const e=t.XpG(3);t.xc7("mask-image","url('/assets/images/action/card/overlay/"+e.values[0]+".svg')")("-webkit-mask-image","url('/assets/images/action/card/overlay/"+e.values[0]+".svg')")}}function ul(i,r){if(1&i&&(t.j41(0,"span",28),t.EFF(1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.JRh(e.values[1])}}function fl(i,r){if(1&i&&(t.j41(0,"span",16)(1,"div",76),t.nrm(2,"img",77),t.nVh(3,ml,1,1,"img",78),t.nVh(4,pl,1,4,"span",79),t.nVh(5,ul,2,1,"span",28),t.k0s()()),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(6,Vt,e.action.small)),t.R7$(),t.Y8G("ngClass",e.values[0]),t.R7$(),t.Y8G("src","./assets/images/action/card/"+e.values[0]+".svg",t.B4B),t.R7$(),t.vxM("slot"!=e.values[0]&&"slotStart"!=e.values[0]&&"slotXp"!=e.values[0]?3:-1),t.R7$(),t.vxM("slot"==e.values[0]||"slotStart"==e.values[0]||"slotXp"==e.values[0]?4:-1),t.R7$(),t.vxM(e.values.length>1?5:-1)}}function Cl(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",17)(1,"span",81),t.nrm(2,"span",43),t.EFF(3),t.k0s(),t.j41(4,"ghs-actions",82),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(21,Vt,e.action.small)),t.R7$(2),t.Aen(e.style),t.Y8G("ghs-label","game.action."+e.action.type),t.R7$(),t.SpI(" ",e.action.value,":"),t.R7$(),t.Aen(e.style),t.Y8G("actions",e.specialActions)("monster",e.monster)("objective",e.objective)("inline",e.inline)("right",e.right)("textBlack",e.textBlack)("hexSize",e.hexSize)("interactiveAbilities",e.interactiveAbilities)("interactiveActions",e.interactiveActions)("relative",e.relative||e.forceRelative)("statsCalculation",e.statsCalculation)("index",e.actionIndex)("character",e.character)("cardId",e.cardId)}}function Ml(i,r){if(1&i&&t.nrm(0,"img",86),2&i){const e=t.XpG(4);t.Y8G("src","./assets/images"+(e.fhStyle?"/fh":"")+"/action/"+e.action.type+".svg",t.B4B)("ngClass",t.eq3(2,Ot,e.isGhsSvg(e.action.type)))}}function vl(i,r){if(1&i&&t.nrm(0,"img",86),2&i){const e=t.XpG(4);t.Y8G("src","./assets/images"+(e.fhStyle?"/fh":"")+"/action/fly.svg",t.B4B)("ngClass",t.eq3(2,Ot,e.isGhsSvg(e.action.type)))}}function Ol(i,r){if(1&i&&t.nrm(0,"span",87),2&i){const e=t.XpG(5);t.Y8G("value-calc",e.normalValue)("level",e.level)}}function Pl(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"/"),t.k0s())}function bl(i,r){if(1&i&&t.nrm(0,"span",88),2&i){const e=t.XpG(5);t.Y8G("ngClass",t.eq3(3,dt,e.hasEntities(e.MonsterType.normal)))("value-calc",e.eliteValue)("level",e.level)}}function kl(i,r){if(1&i&&(t.j41(0,"span"),t.nVh(1,Ol,1,2,"span",87),t.nVh(2,Pl,2,0,"span"),t.nVh(3,bl,1,5,"span",88),t.k0s()),2&i){const e=t.XpG(4);t.R7$(),t.vxM(e.hasEntities(e.MonsterType.normal)||!e.monster?1:-1),t.R7$(),t.vxM(e.hasEntities(e.MonsterType.normal)&&e.hasEntities(e.MonsterType.elite)&&e.normalValue!=e.eliteValue?2:-1),t.R7$(),t.vxM(!e.hasEntities(e.MonsterType.elite)||e.normalValue==e.eliteValue&&e.hasEntities(e.MonsterType.normal)?-1:3)}}function yl(i,r){if(1&i&&t.nrm(0,"span",67),2&i){const e=t.XpG(5);t.Aen(e.style),t.Y8G("ghs-label",e.normalValue+"")("relative",e.relative||e.forceRelative)}}function xl(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"/"),t.k0s())}function El(i,r){if(1&i&&t.nrm(0,"span",90),2&i){const e=t.XpG(5);t.Aen(e.style),t.Y8G("ngClass",t.eq3(5,dt,e.hasEntities(e.MonsterType.normal)))("ghs-label",e.eliteValue+"")("relative",e.relative||e.forceRelative)}}function wl(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"\xa0"),t.k0s())}function Rl(i,r){if(1&i&&(t.j41(0,"span"),t.nVh(1,yl,1,4,"span",66),t.nVh(2,xl,2,0,"span"),t.nVh(3,El,1,7,"span",89),t.nVh(4,wl,2,0,"span"),t.k0s()),2&i){const e=t.XpG(4);t.R7$(),t.vxM(e.hasEntities(e.MonsterType.normal)||!e.monster||e.forceRelative?1:-1),t.R7$(),t.vxM(e.hasEntities(e.MonsterType.normal)&&e.hasEntities(e.MonsterType.elite)&&e.normalValue!=e.eliteValue?2:-1),t.R7$(),t.vxM(!e.hasEntities(e.MonsterType.elite)||e.normalValue==e.eliteValue&&e.hasEntities(e.MonsterType.normal)?-1:3),t.R7$(),t.vxM(e.fhStyle?-1:4)}}function jl(i,r){if(1&i&&(t.j41(0,"span",84),t.nrm(1,"span",43),t.k0s(),t.j41(2,"span",85),t.nVh(3,Ml,1,4,"img",86),t.nVh(4,vl,1,4,"img",86),t.k0s(),t.j41(5,"span",28),t.nVh(6,kl,4,3,"span"),t.nVh(7,Rl,5,4,"span"),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Aen(e.style),t.Y8G("ghs-label","game.action."+e.action.type),t.R7$(2),t.vxM(e.action.type==e.ActionType.move&&e.flying?-1:3),t.R7$(),t.vxM(e.action.type==e.ActionType.move&&e.flying?4:-1),t.R7$(2),t.vxM(e.relative||e.forceRelative?-1:6),t.R7$(),t.vxM(e.relative||e.forceRelative?7:-1)}}function Gl(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"/"),t.k0s())}function Tl(i,r){if(1&i&&t.nrm(0,"span",91),2&i){const e=t.XpG(5);t.Y8G("value-calc",e.eliteValue)("level",e.level)}}function Sl(i,r){if(1&i&&(t.j41(0,"span"),t.nrm(1,"span",87),t.nVh(2,Gl,2,0,"span"),t.nVh(3,Tl,1,2,"span",91),t.k0s()),2&i){const e=t.XpG(4);t.R7$(),t.Y8G("value-calc",e.normalValue)("level",e.level),t.R7$(),t.vxM(e.eliteValue&&e.normalValue!=e.eliteValue?2:-1),t.R7$(),t.vxM(e.eliteValue&&e.normalValue!=e.eliteValue?3:-1)}}function $l(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1,"/"),t.nrm(2,"span",92),t.k0s()),2&i){const e=t.XpG(5);t.R7$(2),t.Aen(e.style),t.Y8G("ghs-label",e.eliteValue+"")("relative",e.relative||e.forceRelative)}}function Dl(i,r){if(1&i&&(t.j41(0,"span",67),t.nVh(1,$l,3,4,"span"),t.k0s()),2&i){const e=t.XpG(4);t.Aen(e.style),t.Y8G("ghs-label",e.normalValue+"")("relative",e.relative||e.forceRelative),t.R7$(),t.vxM(e.normalValue!=e.eliteValue?1:-1)}}function Il(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"\xa0"),t.k0s())}function Al(i,r){if(1&i&&(t.j41(0,"span",84),t.nrm(1,"span",43),t.k0s()),2&i){const e=t.XpG(4);t.R7$(),t.Aen(e.style),t.Y8G("ghs-label","game.action.targets")}}function Vl(i,r){if(1&i&&(t.j41(0,"span",84),t.nrm(1,"span",43),t.k0s()),2&i){const e=t.XpG(4);t.R7$(),t.Aen(e.style),t.Y8G("ghs-label","game.action."+e.action.type)}}function Fl(i,r){if(1&i&&t.nrm(0,"img",86),2&i){const e=t.XpG(4);t.Y8G("src","./assets/images"+(e.fhStyle?"/fh":"")+"/action/"+e.action.type+".svg",t.B4B)("ngClass",t.eq3(2,Ot,e.isGhsSvg(e.action.type)))}}function Xl(i,r){if(1&i&&t.nrm(0,"img",86),2&i){const e=t.XpG(4);t.Y8G("src","./assets/images"+(e.fhStyle?"/fh":"")+"/action/fly.svg",t.B4B)("ngClass",t.eq3(2,Ot,e.isGhsSvg(e.action.type)))}}function Bl(i,r){if(1&i&&(t.j41(0,"span",28),t.EFF(1),t.nVh(2,Sl,4,4,"span"),t.nVh(3,Dl,2,5,"span",66),t.nVh(4,Il,2,0,"span"),t.k0s(),t.nVh(5,Al,2,3,"span",84),t.nVh(6,Vl,2,3,"span",84),t.nVh(7,Fl,1,4,"img",86),t.nVh(8,Xl,1,4,"img",86)),2&i){const e=t.XpG(3);t.R7$(),t.SpI(" ",e.action.valueType==e.ActionValueType.add?"+":"-"," "),t.R7$(),t.vxM(e.relative||e.forceRelative?-1:2),t.R7$(),t.vxM(e.relative||e.forceRelative?3:-1),t.R7$(),t.vxM(e.fhStyle?-1:4),t.R7$(),t.vxM(e.action.type==e.ActionType.target&&e.EntityValueFunction(e.action.value)>1?5:-1),t.R7$(),t.vxM(e.action.type!=e.ActionType.target||e.EntityValueFunction(e.action.value)<2?6:-1),t.R7$(),t.vxM(e.action.type==e.ActionType.move&&e.flying?-1:7),t.R7$(),t.vxM(e.action.type==e.ActionType.move&&e.flying?8:-1)}}function Yl(i,r){if(1&i&&t.nrm(0,"ghs-action-enhancements",29),2&i){const e=t.XpG(3);t.Y8G("action",e.origAction)("index",e.actionIndex)("character",e.character)("cardId",e.cardId)}}function Nl(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function zl(i,r){if(1&i){const e=t.RV6();t.nVh(0,Nl,2,0,"span"),t.j41(1,"ghs-action",49),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(4);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(4);t.vxM(n.fhStyle&&a>0?0:-1),t.R7$(),t.Aen(n.style),t.Y8G("ngClass","subaction-"+e.type)("action",e)("monster",n.monster)("objective",n.objective)("inline",n.inline)("right",n.right)("textBlack",n.textBlack)("hexSize",n.hexSize)("interactiveAbilities",n.interactiveAbilities)("interactiveActions",n.interactiveActions)("relative",n.relative||n.forceRelative)("statsCalculation",n.statsCalculation)("index",(n.actionIndex?n.actionIndex+"-":"")+n.getOrigIndex(e))("monsterType",n.monsterType)("character",n.character)("cardId",n.cardId)}}function Ll(i,r){if(1&i&&(t.j41(0,"div",30),t.Z7z(1,zl,2,19,null,null,Gt),t.nI1(3,"slice"),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(t.i5U(3,0,e.statsCalculation&&e.additionalSubActions.length>0?e.additionalSubActions:e.subActions,e.hasAOE?1:0))}}function Ul(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",18)(1,"span",83),t.bIt("singleClick",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.toggleHighlight(n))}),t.nVh(2,jl,8,7),t.nVh(3,Bl,9,8),t.nVh(4,Yl,1,4,"ghs-action-enhancements",29),t.k0s(),t.nVh(5,Ll,4,3,"div",30),t.nI1(6,"slice"),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass","action-"+e.action.type),t.R7$(),t.Y8G("ngClass",t.sMw(13,We,e.action.small,e.isInteractiveApplicableAction,e.highlightAction()))("clickBehind",!e.isInteractiveApplicableAction)("ghs-tooltip","monster.toggleAction")("delay",1)("disabled",!e.isInteractiveApplicableAction),t.R7$(),t.vxM(e.action.valueType!=e.ActionValueType.add&&e.action.valueType!=e.ActionValueType.subtract?2:-1),t.R7$(),t.vxM(e.action.valueType==e.ActionValueType.add||e.action.valueType==e.ActionValueType.subtract?3:-1),t.R7$(),t.vxM(e.origAction.enhancementTypes&&e.origAction.enhancementTypes.length&&e.character&&e.cardId?4:-1),t.R7$(),t.vxM(t.i5U(6,10,e.statsCalculation&&e.additionalSubActions.length>0?e.additionalSubActions:e.subActions,e.hasAOE?1:0).length>0?5:-1)}}function ql(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",19)(1,"ghs-action",49),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(19,Vt,e.action.small)),t.R7$(),t.Aen(e.style),t.Y8G("ngClass","subaction-area")("action",(e.statsCalculation&&e.additionalSubActions.length>0?e.additionalSubActions:e.subActions)[0])("monster",e.monster)("objective",e.objective)("inline",e.inline)("right",e.right)("textBlack",e.textBlack)("hexSize",e.hexSize)("interactiveAbilities",e.interactiveAbilities)("interactiveActions",e.interactiveActions)("relative",e.relative||e.forceRelative)("statsCalculation",e.statsCalculation)("index",(e.actionIndex?e.actionIndex+"-":"")+e.getOrigIndex((e.statsCalculation&&e.additionalSubActions.length>0?e.additionalSubActions:e.subActions)[0]))("monsterType",e.monsterType)("character",e.character)("cardId",e.cardId)}}function Hl(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-action",49),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(3);return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(3);t.Aen(a.style),t.Y8G("ngClass","subaction-"+e.type)("action",e)("monster",a.monster)("objective",a.objective)("inline",a.inline)("right",a.right)("textBlack",a.textBlack)("hexSize",a.hexSize)("interactiveAbilities",a.interactiveAbilities)("interactiveActions",a.interactiveActions)("relative",a.relative||a.forceRelative)("statsCalculation",a.statsCalculation)("index",(a.actionIndex?a.actionIndex+"-":"")+a.getOrigIndex(e))("monsterType",a.monsterType)("character",a.character)("cardId",a.cardId)}}function Kl(i,r){if(1&i&&(t.j41(0,"div",20),t.Z7z(1,Hl,1,18,"ghs-action",48,t.fX1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Dyx(e.elementActions)}}function Wl(i,r){if(1&i&&(t.j41(0,"span",1),t.nVh(1,Ae,2,9,"span",2)(2,Dn,10,23,"span",3)(3,dn,6,14,"span",4)(4,qi,3,6,"span",4)(5,ri,1,1)(6,Zi,1,1)(7,b,9,16,"span",5)(8,ct,4,3,"span",6)(9,Ft,3,17,"span",7)(10,_n,3,21,"span",7)(11,jc,3,9,"span",6)(12,Gc,1,1,"span",8)(13,$c,3,9,"span",9)(14,Ac,3,19,"span",10)(15,Xc,3,20,"span",10)(16,Nc,3,9,"span",11)(17,Zc,6,9,"span",12)(18,tl,5,4,"span",12)(19,il,2,1,"span",12)(20,sl,5,6,"span",13)(21,ll,5,4,"span",14)(22,_l,6,5,"span",15)(23,fl,6,8,"span",16)(24,Cl,5,23,"span",17)(25,Ul,7,17,"span",18),t.nVh(26,ql,2,21,"div",19),t.nVh(27,Kl,3,0,"div",20),t.k0s()),2&i){let e;const a=t.XpG();t.Y8G("ngClass",t.l4e(4,pe,a.highlight,a.inline,a.right,a.textBlack||a.right,a.fhStyle,a.hasAOE)),t.R7$(),t.vxM((e=a.action.type)===a.ActionType.area?1:e===a.ActionType.condition?2:e===a.ActionType.element?3:e===a.ActionType.elementHalf?4:e===a.ActionType.monsterType?5:e===a.ActionType.round?6:e===a.ActionType.specialTarget?7:e===a.ActionType.custom?8:e===a.ActionType.nonCalc?9:e===a.ActionType.sufferDamage?10:e===a.ActionType.switchType?11:e===a.ActionType.hint?12:e===a.ActionType.grant?13:e===a.ActionType.summon?14:e===a.ActionType.spawn?15:e===a.ActionType.trigger?16:e===a.ActionType.concatenation?17:e===a.ActionType.concatenationSpacer?18:e===a.ActionType.grid?19:e===a.ActionType.box?20:e===a.ActionType.boxFhSubActions?21:e===a.ActionType.forceBox?22:e===a.ActionType.card?23:e===a.ActionType.special?24:25),t.R7$(25),t.vxM(a.hasAOE?26:-1),t.R7$(),t.vxM(a.elementActions.length>0&&a.fhStyle?27:-1)}}const Qi=[G.X2.attack,G.X2.damage,G.X2.fly,G.X2.heal,G.X2.jump,G.X2.loot,G.X2.move,G.X2.range,G.X2.retaliate,G.X2.shield,G.X2.target,G.X2.teleport],fo=[G.X2.concatenation,G.X2.concatenationSpacer,G.X2.box,G.X2.boxFhSubActions,G.X2.card,G.X2.forceBox,G.X2.grid,G.X2.nonCalc];let ae=(()=>{class i{monster;monsterType;objective;origAction;relative=!1;inline=!1;textBlack=!1;right=!1;highlight=!1;interactiveAbilities=!1;interactiveActions=[];interactiveActionsChange=new t.bkB;statsCalculation=!1;hexSize;actionIndex="";style=!1;character;cardId;enhancementContainer;action;normalValue="";eliteValue="";values=[];specialActions=[];subActions=[];fhStyle=!1;flying=!1;isInteractiveApplicableAction=!1;settingsManager=m.f;EntityValueFunction=$.hZ;additionalSubActions=[];elementActions=[];ActionType=G.X2;ActionValueType=G.iQ;MonsterType=S.N;hasAOE=!1;cardConcat=!1;forceRelative=!1;level=0;round="";ngOnInit(){this.update(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}ngAfterViewInit(){this.enhancmenetElementReplace()}update(){if(this.fhStyle=m.f.settings.fhStyle&&!this.style||"fh"==this.style,this.action=this.origAction?JSON.parse(JSON.stringify(this.origAction)):void 0,this.action&&!this.action.subActions&&(this.action.subActions=[]),!m.f.settings.calculate&&this.action&&this.action.subActions){const e=this.action.subActions.find(a=>a.type==G.X2.nonCalc);e&&(this.action=e)}this.action&&void 0===this.action.value&&(this.action.value=""),this.action&&this.action.type==G.X2.monsterType&&(this.monsterType=this.action.value),this.updateSubActions(),this.applyChallenges(),this.forceRelative=!this.monster||!this.hasEntities(),this.monster&&!this.relative&&!this.forceRelative&&m.f.settings.calculate&&this.action&&(this.action.type==G.X2.shield||this.action.type==G.X2.retaliate)&&this.action.valueType!=G.iQ.minus&&this.action.subActions&&this.action.subActions.find(e=>e.type==G.X2.specialTarget&&!(e.value+"").startsWith("self"))&&(this.forceRelative=!0,this.action.valueType=G.iQ.plus),this.level=this.monster?this.monster.level:s.E.game.level,this.flying=!1,this.monster&&(this.flying=this.monster.flying&&(!this.monster.statEffect||"disabled"!=this.monster.statEffect.flying)||null!=this.monster.statEffect&&1==this.monster.statEffect.flying),this.action&&(this.normalValue=this.getNormalValue(),this.eliteValue=this.getEliteValue(),this.values=this.getValues(this.action,!0),this.specialActions=this.getSpecial(this.action)),this.isInteractiveApplicableAction=this.interactiveAbilities&&this.monster&&this.monster.entities.some(e=>this.origAction&&s.E.actionsManager.isInteractiveApplicableAction(e,this.origAction,this.actionIndex))||this.objective&&this.objective.entities.some(e=>this.origAction&&s.E.actionsManager.isInteractiveApplicableAction(e,this.origAction,this.actionIndex))||!1,this.enhancementContainer&&this.enhancmenetElementReplace(),this.round=s.E.game.round%2==0?"even":"odd"}hasEntities(e=void 0){return e==S.N.normal&&this.monster&&this.monster.boss?this.hasEntities(S.N.boss):this.monster&&(!this.monsterType||!e||this.monsterType==e)&&this.monster.entities.some(a=>(!e||a.type==e)&&s.E.entityManager.isAlive(a))||!1}getNormalValue(){return this.getValue(this.monster&&this.monster.boss?S.N.boss:S.N.normal)}getEliteValue(){return this.hasEntities(S.N.elite)?this.getValue(S.N.elite):this.getNormalValue()}getMonsterType(e){return e}getStat(e){return this.monster?s.E.monsterManager.getStat(this.monster,e):new Lt.f(e,s.E.game.level)}getRange(e=S.N.normal){return this.monster&&this.monster.boss&&(e=S.N.boss),Jt(this.getStat(e).range,this.monster?this.monster.level:void 0)}getEliteRange(){return this.monster&&!this.monster.entities.some(e=>e.type==S.N.elite&&s.E.entityManager.isAlive(e))?this.getRange():this.getRange(S.N.elite)}getValues(e,a=!1){return a?s.E.actionsManager.getValues(e):[...this.values]}getSpecial(e){if(this.monster&&this.monster.boss)return this.getStat(S.N.boss).special[e.value-1];{const a=this.getStat(S.N.normal).special[e.value-1],n=this.getStat(S.N.elite).special[e.value-1];return a!=n&&JSON.stringify(a)!=JSON.stringify(n)?[new G.rc(G.X2.monsterType,S.N.normal,G.iQ.fixed,a),new G.rc(G.X2.monsterType,S.N.elite,G.iQ.fixed,n)]:a}}getValue(e){if(!this.action)return"";if(-1!=fo.indexOf(this.action.type))return this.action.value;if(m.f.settings.calculate&&!this.relative&&!this.forceRelative){const a=this.getStat(e);let n=0,o=!0;switch(this.action.type){case G.X2.attack:if("number"==typeof a.attack)n=a.attack;else if(-1!=a.attack.indexOf("X")){if(this.action.valueType==G.iQ.plus)return a.attack+" +"+(m.f.settings.fhStyle?"":" ")+this.action.value;if(this.action.valueType==G.iQ.minus)return a.attack+" -"+(m.f.settings.fhStyle?"":" ")+this.action.value;o=!1}else try{n=(0,$.hZ)(a.attack,this.level)}catch{o=!1}a.actions&&a.actions.forEach(g=>{g.type==G.X2.attack&&(g.valueType==G.iQ.add?n+=(0,$.hZ)(g.value,this.level):g.valueType==G.iQ.subtract&&(n-=(0,$.hZ)(g.value,this.level),n<0&&(n=0)))});break;case G.X2.move:n=(0,$.hZ)(a.movement,this.level);break;case G.X2.range:n=(0,$.hZ)(a.range,this.level)}if(o&&(this.action.value||0==this.action.value)&&("number"==typeof this.action.value||this.action.value.match($.p5)||this.action.value.match($.OD))){if(this.action.valueType==G.iQ.plus)return n+(0,$.hZ)(this.action.value);if(this.action.valueType==G.iQ.minus)return n?n-(0,$.hZ)(this.action.value):"-"}}if(m.f.settings.calculateStats&&m.f.settings.calculateShieldStats&&!this.relative&&!this.forceRelative){const a=this.getStat(e);let n=0;if(this.action.type==G.X2.shield||this.action.type==G.X2.retaliate){if(!this.action.subActions||!this.action.subActions.find(o=>o.type==G.X2.specialTarget&&!(o.value+"").startsWith("self"))){const o=this.action.subActions&&this.action.subActions.find(_=>_.type==G.X2.range);(a.actions&&a.actions.filter(_=>this.action&&_.type==this.action.type)||[]).forEach(_=>{if(this.action&&_!=this.action){const y=_.subActions&&_.subActions.find(B=>B.type==G.X2.range);(!o&&!y||o&&y&&(0,$.hZ)(o.value,this.level)==(0,$.hZ)(y.value,this.level))&&(n=(0,$.hZ)(_.value,this.level))}})}if(n>0)return n+(0,$.hZ)(this.action.value,this.level)}}return this.action.valueType==G.iQ.plus?"+"+(m.f.settings.fhStyle?"":" ")+this.action.value:this.action.valueType==G.iQ.minus?"-"+(m.f.settings.fhStyle?"":" ")+this.action.value:m.f.settings.calculate&&((""+this.action.value).match($.p5)||(""+this.action.value).match($.OD))?(0,$.hZ)(this.action.value,this.level):this.action.value}getConditionName(e){return new j.kW(e).name}updateSubActions(){if(this.action){if(this.elementActions=[],m.f.settings.fhStyle&&-1==[G.X2.element,G.X2.elementHalf,...fo].indexOf(this.action.type)&&(this.action.subActions.forEach(e=>{(e.type==G.X2.element||e.type==G.X2.elementHalf)&&this.elementActions.push(e)}),this.action.subActions=this.action.subActions.filter(e=>e.type!=G.X2.element&&e.type!=G.X2.elementHalf)),this.action.subActions=this.action.subActions.filter(e=>e.type!=G.X2.nonCalc),this.additionalSubActions=JSON.parse(JSON.stringify(this.action.subActions)),this.hasAOE=this.additionalSubActions.some((e,a)=>0==a&&e.type==G.X2.area)&&(this.action.type!=G.X2.element||this.action.valueType!=G.iQ.minus),this.monster&&m.f.settings.calculateStats&&!this.relative){let e=[];const a=s.E.monsterManager.getStat(this.monster,this.monster.boss?S.N.boss:S.N.normal);let n=this.monster.boss?void 0:s.E.monsterManager.getStat(this.monster,S.N.elite);if(this.action.type==G.X2.attack&&this.action.valueType!=G.iQ.add&&this.action.valueType!=G.iQ.subtract){let _=this.additionalSubActions.find(B=>B.type==G.X2.monsterType&&B.value==S.N.normal),y=this.additionalSubActions.find(B=>B.type==G.X2.monsterType&&B.value==S.N.elite);if((a.range||n&&n.range)&&!this.action.subActions.some(B=>B.type==G.X2.range||B.type==G.X2.area&&-1!=(""+B.value).indexOf("active")||B.type==G.X2.specialTarget)){const B=new G.rc(G.X2.range,0,G.iQ.plus);B.small=!0,a.range&&(n&&n.range||!n)?this.additionalSubActions.splice(this.hasAOE?1:0,0,B):a.range?_?_.subActions.push(B):(_=new G.rc(G.X2.monsterType,S.N.normal,G.iQ.fixed,[B]),e.push(_)):n&&n.range&&(y?y.subActions.push(B):(y=new G.rc(G.X2.monsterType,S.N.normal,G.iQ.fixed,[B]),e.push(y)))}a.actions&&this.monster.entities.some(B=>s.E.entityManager.isAlive(B)&&(B.type==S.N.normal||B.type==S.N.boss))&&a.actions.filter(B=>this.additionAttackSubAction(B)).forEach(B=>{const nt=new G.rc(B.type,B.value,B.valueType,B.subActions);this.action&&!this.subActionExists(this.action.subActions,nt)&&!this.subActionExists(e,nt)&&(B.type!=G.X2.area||this.action.subActions.every(Z=>Z.type!=G.X2.area))&&(!n||n.actions&&this.subActionExists(n.actions,nt,!1)||this.monster&&!this.monster.entities.some(Z=>s.E.entityManager.isAlive(Z)&&Z.type==S.N.elite)?(nt.small=!0,e.push(nt)):n&&(!n.actions||!this.subActionExists(n.actions,nt))&&!this.subActionExists(this.action.subActions,nt)&&!this.subActionExists(e,nt)&&(_?this.subActionExists(_.subActions,nt)||_.subActions.push(nt):(_=new G.rc(G.X2.monsterType,S.N.normal,G.iQ.fixed,[nt]),e.push(_))))}),n&&n.actions&&this.monster.entities.some(B=>s.E.entityManager.isAlive(B)&&B.type==S.N.elite)&&n.actions.filter(B=>this.additionAttackSubAction(B)).forEach(B=>{const nt=new G.rc(B.type,B.value,B.valueType,B.subActions);this.action&&(!a.actions||!this.subActionExists(a.actions,nt,!1)||!this.hasEntities(S.N.normal))&&(this.monster&&!this.monster.entities.some(Z=>s.E.entityManager.isAlive(Z)&&Z.type==S.N.normal)?(nt.small=!0,e.push(nt)):!this.subActionExists(this.action.subActions,nt)&&!this.subActionExists(e,nt)&&(y?this.subActionExists(y.subActions,nt)||y.subActions.push(nt):(y=new G.rc(G.X2.monsterType,S.N.elite,G.iQ.fixed,[nt]),e.push(y))))})}e.forEach(_=>{if(this.action)if(_.type==G.X2.target)if(this.additionalSubActions.some(y=>y.type==G.X2.target||y.type==G.X2.specialTarget&&y.value!=G.lB.enemyOneAll)){if((_.valueType==G.iQ.add||_.valueType==G.iQ.fixed)&&this.additionalSubActions.some(y=>y.type==G.X2.target)&&!this.additionalSubActions.some(y=>y.type==G.X2.specialTarget)){const y=this.additionalSubActions.find(B=>B.type==G.X2.target&&B!=_);y&&(_.valueType=G.iQ.fixed,_.value=(0,$.hZ)(_.value,this.level)+(y.valueType!=G.iQ.subtract&&y.valueType!=G.iQ.minus?(0,$.hZ)(y.value,this.level):-(0,$.hZ)(y.value,this.level)),this.additionalSubActions.splice(this.additionalSubActions.indexOf(y),1,_))}}else _.valueType==G.iQ.add&&(_.valueType=G.iQ.fixed,_.value=(0,$.hZ)(_.value,this.level)+1),this.additionalSubActions.length>0&&(this.additionalSubActions[this.additionalSubActions.length-1].type==G.X2.element||this.additionalSubActions[this.additionalSubActions.length-1].type==G.X2.specialTarget&&this.additionalSubActions[this.additionalSubActions.length-1].value==G.lB.enemyOneAll)?this.additionalSubActions.splice(this.additionalSubActions.length-1,0,_):this.additionalSubActions.push(_);else if(_.type!=G.X2.range||this.additionalSubActions.some(y=>y.type==G.X2.range)){if(_.type!=G.X2.range&&!this.subActionExists(this.additionalSubActions,_))if(_.type==G.X2.area)this.additionalSubActions.splice(0,0,_),this.hasAOE=!0;else if(this.action&&_.type==G.X2.card&&this.action.subActions.find(y=>y.type==G.X2.pierce)){const y=this.action.subActions.find(B=>B.type==G.X2.pierce);y&&(y.value=(0,$.hZ)(y.value,this.level)+(0,$.hZ)(_.value,this.level))}else _.small=!0,_.type==G.X2.monsterType&&(_.small=!1,_.subActions.forEach(y=>y.small=!0)),this.additionalSubActions.length>0&&this.additionalSubActions[this.additionalSubActions.length-1].type==G.X2.element?this.additionalSubActions.splice(this.additionalSubActions.length-1,0,_):this.additionalSubActions.push(_)}else this.additionalSubActions.length>0&&this.action.subActions[this.additionalSubActions.length-1].type==G.X2.element?this.additionalSubActions.splice(this.action.subActions.length-1,0,_):this.additionalSubActions.push(_)});const o=this.additionalSubActions.find(_=>_.type==G.X2.target&&(_.valueType==G.iQ.add||_.valueType==G.iQ.subtract));if(o){let _=!1;e.forEach(y=>{if(this.action&&y.type==G.X2.monsterType&&y.subActions.find(B=>B.type==G.X2.target)){const B=y.subActions.find(nt=>nt.type==G.X2.target);B&&(_=!0,B.value=(0,$.hZ)(B.value,this.level)+(o.valueType==G.iQ.add?(0,$.hZ)(o.value,this.level):-(0,$.hZ)(o.value,this.level)))}}),_&&this.additionalSubActions.splice(this.additionalSubActions.indexOf(o),1)}if(this.action.type==G.X2.move&&!this.action.subActions.find(_=>_.type==G.X2.jump)){let _=new G.rc(G.X2.jump,"");_.small=!0,a.actions.find(y=>y.type==G.X2.jump)?n&&!n.actions.find(y=>y.type==G.X2.jump)&&this.hasEntities(S.N.elite)?this.additionalSubActions.push(new G.rc(G.X2.monsterType,S.N.normal,G.iQ.fixed,[_])):this.additionalSubActions.push(_):n&&n.actions.find(y=>y.type==G.X2.jump)&&(this.hasEntities(S.N.normal)?this.additionalSubActions.push(new G.rc(G.X2.monsterType,S.N.elite,G.iQ.fixed,[_])):this.additionalSubActions.push(_))}let g=this.additionalSubActions.find(_=>(_.type==G.X2.element||_.type==G.X2.elementHalf)&&_.valueType==G.iQ.minus&&_.subActions.every(y=>this.subActionExists(e,y)));for(m.f.settings.fhStyle&&(g=this.elementActions.find(_=>(_.type==G.X2.element||_.type==G.X2.elementHalf)&&_.valueType==G.iQ.minus&&_.subActions.every(y=>this.subActionExists(e,y))));g;)m.f.settings.fhStyle?(this.elementActions.splice(this.elementActions.indexOf(g),1),g=this.elementActions.find(_=>(_.type==G.X2.element||_.type==G.X2.elementHalf)&&_.valueType==G.iQ.minus&&_.subActions.every(y=>this.subActionExists(e,y)))):(this.additionalSubActions.splice(this.additionalSubActions.indexOf(g),1),g=this.additionalSubActions.find(_=>(_.type==G.X2.element||_.type==G.X2.elementHalf)&&_.valueType==G.iQ.minus&&_.subActions.every(y=>this.subActionExists(e,y))));if(this.additionalSubActions.some((_,y,B)=>_.type==G.X2.monsterType&&y<B.length-1&&B[y+1].type==G.X2.monsterType)){const _=this.additionalSubActions.findIndex(y=>y.type==G.X2.monsterType);this.additionalSubActions.splice(_,2,new G.rc(G.X2.grid,"",G.iQ.fixed,[this.additionalSubActions[_],this.additionalSubActions[_+1]]))}}this.subActions=this.action.subActions.filter(e=>!e.hidden),this.additionalSubActions=this.additionalSubActions.filter(e=>!e.hidden),this.cardConcat=this.action.type==G.X2.concatenation&&this.subActions.every(e=>e.type==G.X2.card||e.type==G.X2.concatenationSpacer)}}additionAttackSubAction(e){return!!(-1!=[G.X2.condition,G.X2.target,G.X2.pierce,G.X2.pull,G.X2.push,G.X2.swing,G.X2.area].indexOf(e.type)||m.f.settings.calculateAdvantageStats&&e.type==G.X2.custom&&"%game.custom.advantage%"==e.value)}subActionExists(e,a,n=!0){return(!n||a.type!=G.X2.condition||-1==new j.kW(a.value+"").types.indexOf(j.GV.stackable))&&e.some(o=>o.type==a.type&&o.value==a.value&&(o.valueType||G.iQ.fixed)==(a.valueType||G.iQ.fixed))}applyChallenges(){this.action&&this.monster&&(s.E.challengesManager.apply&&s.E.challengesManager.isActive(1488,"fh")&&(this.action.type==G.X2.attack&&this.additionalSubActions.forEach(e=>{this.monster&&e.type==G.X2.range&&(e.value=(0,$.hZ)(e.value,this.monster.level)+(e.valueType==G.iQ.minus||e.valueType==G.iQ.subtract?-1:1))}),this.action.type==G.X2.move&&(this.action.value=(0,$.hZ)(this.action.value,this.monster.level)+(this.action.valueType==G.iQ.minus||this.action.valueType==G.iQ.subtract?-1:1))),s.E.challengesManager.apply&&s.E.challengesManager.isActive(1498,"fh")&&this.action.type==G.X2.attack&&this.additionalSubActions.find(e=>e.type==G.X2.range)&&this.additionalSubActions.push(new G.rc(G.X2.push,1,G.iQ.fixed,[],!0)),s.E.challengesManager.apply&&s.E.challengesManager.isActive(1521,"fh")&&this.action.type==G.X2.move&&!this.additionalSubActions.find(e=>e.type==G.X2.jump)&&this.additionalSubActions.push(new G.rc(G.X2.jump,"",G.iQ.fixed,[],!0)),s.E.challengesManager.apply&&s.E.challengesManager.isActive(1522,"fh")&&this.action.type==G.X2.attack&&!this.additionalSubActions.find(e=>e.type==G.X2.target)&&!this.additionalSubActions.find(e=>e.type==G.X2.area)&&(this.action.value=(0,$.hZ)(this.action.value,this.monster.level)-(this.action.valueType==G.iQ.minus||this.action.valueType==G.iQ.subtract?-1:1),this.additionalSubActions.push(new G.rc(G.X2.target,2,G.iQ.fixed,[],!0))))}isGhsSvg(e){return-1!=Qi.indexOf(e)}highlightAction(){return null!=this.interactiveActions.find(e=>e.index==this.actionIndex)||!1}toggleHighlight(e){if(this.isInteractiveApplicableAction){if(this.highlightAction())this.interactiveActions=this.interactiveActions.filter(a=>!a.index.startsWith(this.actionIndex));else if(this.origAction&&(this.interactiveActions.push({action:this.origAction,index:this.actionIndex}),this.origAction.subActions)){let a=[];this.monster?a=s.E.actionsManager.getAllInteractiveActions(this.monster,this.origAction.subActions,this.actionIndex):this.objective&&(a=s.E.actionsManager.getAllInteractiveActions(this.objective,this.origAction.subActions,this.actionIndex)),a.forEach(n=>{this.interactiveActions.some(o=>o.index==n.index)||this.interactiveActions.push(n)})}this.interactiveActionsChange.emit(this.interactiveActions),e.preventDefault(),e.stopPropagation()}}getOrigIndex(e){if(this.origAction&&this.origAction.subActions){const a=this.origAction.subActions.find(n=>JSON.stringify(e)==JSON.stringify(n));if(a)return this.origAction.subActions.indexOf(a)}return-1}onInteractiveActionsChange(e){this.interactiveActionsChange.emit(e)}enhancmenetElementReplace(){if(this.origAction&&this.origAction.enhancementTypes&&this.origAction.enhancementTypes.length&&this.enhancementContainer){const e=this.enhancementContainer.nativeElement.getElementsByClassName("placeholder-enhancement"),a=this.enhancementContainer.nativeElement.getElementsByTagName("ghs-action-enhancements");for(let n=0;n<a.length;n++)e[0]&&e[0].parentElement!=a[n].parentElement&&e[0].parentElement.replaceChild(a[n],e[0])}}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-action"]],viewQuery:function(a,n){if(1&a&&t.GBs(ee,5),2&a){let o;t.mGM(o=t.lsd())&&(n.enhancementContainer=o.first)}},inputs:{monster:"monster",monsterType:"monsterType",objective:"objective",origAction:[0,"action","origAction"],relative:"relative",inline:"inline",textBlack:"textBlack",right:"right",highlight:"highlight",interactiveAbilities:"interactiveAbilities",interactiveActions:"interactiveActions",statsCalculation:"statsCalculation",hexSize:"hexSize",actionIndex:[0,"index","actionIndex"],style:"style",character:"character",cardId:"cardId"},outputs:{interactiveActionsChange:"interactiveActionsChange"},standalone:!1,decls:1,vars:1,consts:[["enhancementContainer",""],[1,"action",3,"ngClass"],[1,"action-area",3,"ngClass"],[1,"action-condition",3,"ngClass"],[1,"action-element",3,"ngClass"],[1,"action-specialTarget"],[1,"action-custom"],["ghs-pointer-input","",1,"action-custom",3,"clickBehind","ghs-tooltip","delay","disabled","ngClass"],[1,"action-hint",3,"ghs-label"],[1,"action-grant"],[1,"action-summon",3,"ngClass"],[1,"action-trigger"],[1,"action-default"],[1,"action-box-container",3,"ngClass"],[1,"action-box-fh-subactions-container",3,"ngClass"],[1,"action-box-container-forced",3,"ngClass"],[1,"action-card",3,"ngClass"],[1,"action-default","action-special",3,"ngClass"],[1,"action-default",3,"ngClass"],[1,"aoe-value",3,"ngClass"],[1,"element-actions"],[3,"action","value","size","index","cardId","character"],["ghs-pointer-input","",1,"condition",3,"singleClick","clickBehind","ghs-tooltip","delay","disabled","ngClass"],[1,"condition-value"],[3,"ghs-label","ghs-label-args"],[1,"condition-image"],[1,"icon",3,"src"],["src","./assets/images/warning.svg",1,"icon","warning"],[1,"value"],[3,"action","index","character","cardId"],[1,"subactions"],[3,"interactiveActionsChange","ngClass","action","monster","objective","inline","right","textBlack","hexSize","statsCalculation","interactiveAbilities","interactiveActions","index","monsterType","character","cardId"],["ghs-pointer-input","",1,"elements",3,"singleClick","clickBehind","ghs-tooltip","delay","disabled","ngClass"],[1,"element",3,"ngClass"],[1,"minus"],[1,"element-subactions"],[3,"src"],[1,"element-subaction",3,"interactiveActionsChange","ngClass","action","monster","objective","relative","inline","right","textBlack","hexSize","interactiveAbilities","interactiveActions","statsCalculation","index","monsterType","character","cardId"],[1,"elements","elements-half"],["ghs-pointer-input","",1,"element-half-container",3,"singleClick","ngClass","clickBehind","ghs-tooltip","delay","disabled"],[1,"element-half"],[1,"action-monster-type",3,"ngClass"],[1,"monster-type","small",3,"ngClass"],[3,"ghs-label"],[1,"monster-type-subactions"],[3,"interactiveActionsChange","ngClass","action","monster","objective","relative","inline","right","textBlack","hexSize","interactiveAbilities","interactiveActions","statsCalculation","index","monsterType"],[1,"action-round",3,"ngClass"],[1,"round-subactions"],[3,"ngClass","action","monster","objective","inline","right","textBlack","hexSize","interactiveAbilities","interactiveActions","relative","statsCalculation","index","monsterType","character","cardId","style"],[3,"interactiveActionsChange","ngClass","action","monster","objective","inline","right","textBlack","hexSize","interactiveAbilities","interactiveActions","relative","statsCalculation","index","monsterType","character","cardId"],[1,"enhancements-container"],[1,"special-target-value",3,"ghs-label","ghs-label-args","relative","ngClass"],[3,"ngClass"],[3,"action","index","character","cardId","slot"],[1,"special-target-subactions"],[1,"elite"],[1,"custom-subactions"],[1,"custom-value",3,"ghs-label","relative","ngClass"],["ghs-pointer-input","",1,"action-custom",3,"singleClick","clickBehind","ghs-tooltip","delay","disabled","ngClass"],[1,"custom-value",3,"ghs-label","relative","ngClass","ghs-label-args"],[1,"grant-value",3,"ghs-label","relative","ngClass"],[1,"grant-subactions"],[3,"interactiveActionsChange","action","right","textBlack","monster","objective","interactiveAbilities","interactiveActions","index","character","cardId","monsterType"],[3,"interactiveActionsChange","action","right","textBlack","monster","objective","spawn","interactiveAbilities","interactiveActions","index","character","cardId","monsterType"],[1,"action-concatenation",3,"ngClass"],[1,"action-concatenation-item"],[3,"ghs-label","relative","style"],[3,"ghs-label","relative"],[1,"action-concatenation-spacer"],[1,"action-concatenation-spacer-item",3,"ngClass"],[1,"action-grid",3,"--ghs-grid-columns","ngClass"],[1,"action-grid",3,"ngClass"],[1,"action-box-label",3,"ghs-label","relative","style"],[1,"action-box"],[1,"action-box-label",3,"ghs-label","relative"],[1,"action-box-label"],[1,"card-value",3,"ngClass"],[1,"ghs-svg",3,"src"],[1,"overlay",3,"src"],[1,"overlay",3,"mask-image","-webkit-mask-image"],[1,"overlay"],[1,"special-type"],[1,"special-subactions",3,"interactiveActionsChange","actions","monster","objective","inline","right","textBlack","hexSize","interactiveAbilities","interactiveActions","relative","statsCalculation","index","character","cardId"],["ghs-pointer-input","",1,"main-action",3,"singleClick","ngClass","clickBehind","ghs-tooltip","delay","disabled"],[1,"type"],[1,"action-icon"],[1,"icon",3,"src","ngClass"],[3,"value-calc","level"],[3,"ngClass","value-calc","level"],[3,"ngClass","ghs-label","relative","style"],[3,"ngClass","ghs-label","relative"],[1,"elite",3,"value-calc","level"],[1,"elite",3,"ghs-label","relative"]],template:function(a,n){1&a&&t.nVh(0,Wl,28,11,"span",1),2&a&&t.vxM(n.action&&n.origAction?0:-1)},styles:['.action[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap;position:relative;width:100%;color:var(--ghs-color-white);line-height:.8em}.action.aoe[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:.2em;align-items:center}@keyframes _ngcontent-%COMP%_highlight-animation{0%{background-position:0% center;-webkit-mask-position:0% center;mask-position:0% center}65%{background-position:0% center;-webkit-mask-position:0% center;mask-position:0% center}to{background-position:200% center;-webkit-mask-position:200% center;mask-position:200% center}}@keyframes _ngcontent-%COMP%_highlight-image{0%{opacity:1}50%{opacity:1}to{opacity:.5}}.action.highlight[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background-image:linear-gradient(-225deg,var(--ghs-color-white) 0%,var(--ghs-color-white) 50%,var(--ghs-color-darkgray) 75%,var(--ghs-color-white) 100%);background-position:0% center;background-clip:border-box;background-size:200% auto;background-clip:text;-webkit-background-clip:text;-webkit-text-fill-color:transparent;animation:_ngcontent-%COMP%_highlight-animation calc(var(--ghs-animation-speed) * 3s) linear infinite;animation-delay:-1.5s}.action.highlight[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_highlight-image calc(var(--ghs-animation-speed) * .3s) ease-in-out infinite;animation-delay:-1.5s}.action.highlight.right[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background-image:linear-gradient(-225deg,var(--ghs-color-black) 0%,var(--ghs-color-black) 50%,var(--ghs-color-white) 75%,var(--ghs-color-black) 100%)}.action[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .placeholder-action[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.action[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin:0 .1em .1em;height:1em;width:auto}.action[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]:not(.ghs-svg){filter:var(--ghs-filter-shadow)}.action[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .condition-value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .special-target-value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .monster-type[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .summon-value[_ngcontent-%COMP%]{filter:var(--ghs-filter-shadow)}.action[_ngcontent-%COMP%]   .type.small[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .value.small[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .condition-value.small[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .custom-value.small[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .grant-value.small[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .special-target-value.small[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .monster-type.small[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .summon-value.small[_ngcontent-%COMP%]{filter:var(--ghs-filter-shadow-thin)}.action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]{font-size:76%;line-height:76%}.action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   .condition-value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   .special-target-value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   .monster-type[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   .summon-value[_ngcontent-%COMP%]{filter:var(--ghs-filter-shadow-thin)}.action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   .placeholder-action[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow-thin)}.action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]:not(.ghs-svg){filter:var(--ghs-filter-shadow-thin)}.action[_ngcontent-%COMP%]   .action-default[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-custom[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-grant[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-summon[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-specialTarget[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-condition[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.action[_ngcontent-%COMP%]   .action-custom[_ngcontent-%COMP%]   ghs-action-enhancements[_ngcontent-%COMP%]{margin-top:.4em}.action[_ngcontent-%COMP%]   .action-default[_ngcontent-%COMP%]   .main-action[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-grant[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-condition[_ngcontent-%COMP%]{filter:drop-shadow(.01em .01em .01em var(--ghs-color-black))}.action[_ngcontent-%COMP%]   .action-monster-type[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.action[_ngcontent-%COMP%]   .action-default[_ngcontent-%COMP%]   .main-action[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-default[_ngcontent-%COMP%]   .main-action[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.action[_ngcontent-%COMP%]   .action-default[_ngcontent-%COMP%]   .main-action[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{white-space:nowrap}.action[_ngcontent-%COMP%]   .action-summon[_ngcontent-%COMP%]{width:100%}.action[_ngcontent-%COMP%]   .action-summon[_ngcontent-%COMP%]   ghs-action-summon[_ngcontent-%COMP%]{width:100%}.action[_ngcontent-%COMP%]   .action-area[_ngcontent-%COMP%]{margin-top:.3em}.action[_ngcontent-%COMP%]   .enhancements-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;filter:drop-shadow(.01em .01em .01em var(--ghs-color-black))}.action[_ngcontent-%COMP%]   ghs-action-enhancements-custom-label[_ngcontent-%COMP%]{font-size:1em;line-height:1em}.action[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%]{padding:0 .2em}.action[_ngcontent-%COMP%]   ghs-action-summon[_ngcontent-%COMP%]{padding:0 .1em}.action[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%]{position:relative;font-size:82%;line-height:82%;padding:0 .5em}.action[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%]:before, .action[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%]:after, .action[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%]:before, .action[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%]:after{content:" ";position:absolute;width:2em;height:.09em;left:-1.6em;top:50%;transform:translateY(-50%);background:linear-gradient(90deg,transparent 0%,var(--ghs-color-white) 100%)}.action[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%]:after, .action[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%]:after{left:auto;right:-1.6em;background:linear-gradient(90deg,var(--ghs-color-white) 0%,transparent 100%)}.action[_ngcontent-%COMP%]   .action-special[_ngcontent-%COMP%] > .type[_ngcontent-%COMP%]{margin-bottom:.1em}.action[_ngcontent-%COMP%]   .special-type[_ngcontent-%COMP%]{color:var(--ghs-color-red);filter:var(--ghs-filter-shadow)}.action[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.action[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .condition-image[_ngcontent-%COMP%]{position:relative;width:1em;height:1em;margin:0 .1em .1em}.action[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .condition-image[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:100%;height:auto;margin:0;filter:var(--ghs-filter-shadow-thin)}.action[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .condition-image[_ngcontent-%COMP%]   img.icon.warning[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow) var(--ghs-filter-shadow-thin)}.action[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .condition-image[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:.45em;line-height:1em;color:var(--ghs-color-white);position:absolute;top:0;left:0;display:flex;justify-content:center;align-items:flex-end;width:100%;height:100%}.action[_ngcontent-%COMP%]   .action-specialTarget[_ngcontent-%COMP%]{display:block}.action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap;margin:.15em 0}.action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value[_ngcontent-%COMP%]{position:relative;height:1.2em}.action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:relative;height:100%;width:auto;z-index:1}.action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;z-index:2}.action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-family:var(--ghs-font-title);font-size:.8em;filter:invert(1);z-index:3}.action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slot[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStart[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEnd[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXp[_ngcontent-%COMP%]{height:2em}.action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slot[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStart[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEnd[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXp[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{background-color:var(--ghs-ability-color);-webkit-mask-position:top left;mask-position:top left;-webkit-mask-size:100% 100%;mask-size:100% 100%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat}.action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slot[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStart[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEnd[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXp[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{left:42%}.action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slot[_ngcontent-%COMP%] + .slot[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slot[_ngcontent-%COMP%] + .slotXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStart[_ngcontent-%COMP%] + .slot[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotStart[_ngcontent-%COMP%] + .slotXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEnd[_ngcontent-%COMP%] + .slot[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotEnd[_ngcontent-%COMP%] + .slotXp[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXp[_ngcontent-%COMP%] + .slot[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .card-value.slotXp[_ngcontent-%COMP%] + .slotXp[_ngcontent-%COMP%]{margin-left:-.1em}.action[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]{margin-left:.1em}.action[_ngcontent-%COMP%]   .condition-value[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-bless[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-curse[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-pierce[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-pull[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-push[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-swing[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{text-transform:uppercase}.action[_ngcontent-%COMP%]   .elite[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.action[_ngcontent-%COMP%]   .action-hint[_ngcontent-%COMP%]{position:relative;min-width:60%;background:#7cd2e0;background:linear-gradient(90deg,#7cd2e0,#c1ecf5);color:var(--ghs-color-black);font-size:.7em;line-height:.9em;text-align:center;font-weight:700;margin:-.7em .5em .5em;padding:.3em;border:.1em solid rgb(39,103,124)}.action[_ngcontent-%COMP%]   .action-hint[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:.1em;border:.1em solid var(--ghs-color-white);opacity:.7}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;align-items:flex-start;margin-top:.5%}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]{display:flex;flex-wrap:unset;justify-content:center;align-items:center}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%]{position:relative;width:1.2em;height:1.2em}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]   .minus[_ngcontent-%COMP%]{font-size:1.5em}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]:not(.elements-half)   .element-half[_ngcontent-%COMP%]{position:relative;width:.6em;overflow:hidden}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]:not(.elements-half)   .element-half[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:200%}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]:not(.elements-half)   .element-half[_ngcontent-%COMP%]:nth-child(1){left:0;margin-right:-.01em}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]:not(.elements-half)   .element-half[_ngcontent-%COMP%]:nth-child(1).highlight{animation:_ngcontent-%COMP%_element-half-pulse calc(var(--ghs-animation-speed) * 1.2s) ease-in-out infinite;transform-origin:center right}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]:not(.elements-half)   .element-half[_ngcontent-%COMP%]:nth-child(1).highlight:hover{transform:scale(1)!important}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]:not(.elements-half)   .element-half[_ngcontent-%COMP%]:nth-child(2){right:0;margin-left:-.01em}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]:not(.elements-half)   .element-half[_ngcontent-%COMP%]:nth-child(2)   img[_ngcontent-%COMP%]{transform:translate(-50%)}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]:not(.elements-half)   .element-half[_ngcontent-%COMP%]:nth-child(2):before{background-position:right}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]:not(.elements-half)   .element-half[_ngcontent-%COMP%]:nth-child(2).highlight{animation:_ngcontent-%COMP%_element-half-pulse-right calc(var(--ghs-animation-speed) * 1.2s) ease-in-out infinite;transform-origin:center left}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]:not(.elements-half)   .element-half[_ngcontent-%COMP%]:nth-child(2).highlight:hover{transform:scale(1)!important}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]   .element-half-container[_ngcontent-%COMP%]{overflow:visible;width:1.2em;height:1.2em}.action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]   .element-half-container[_ngcontent-%COMP%]:after{filter:var(--ghs-filter-white)}@keyframes _ngcontent-%COMP%_highlight-text-pulse{0%{transform:scale(.9)}50%{transform:scale(1)}to{transform:scale(.9)}}@keyframes _ngcontent-%COMP%_element-pulse{0%{transform:scale(.8)}50%{transform:scale(1)}to{transform:scale(.8)}}@keyframes _ngcontent-%COMP%_element-half-pulse{0%{transform:scale(.8)}50%{transform:scale(1)}to{transform:scale(.8)}}@keyframes _ngcontent-%COMP%_element-half-pulse-right{0%{transform:scale(.8)}50%{transform:scale(1)}to{transform:scale(.8)}}.action[_ngcontent-%COMP%]   .action-interactive.condition[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-interactive.action-custom[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-interactive.main-action[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-interactive.elements[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-interactive.element-half-container[_ngcontent-%COMP%]   .element-half[_ngcontent-%COMP%]{cursor:zoom-in}.action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.condition[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.action-custom[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.main-action[_ngcontent-%COMP%]{cursor:zoom-out;animation:_ngcontent-%COMP%_highlight-text-pulse calc(var(--ghs-animation-speed) * 1.2s) ease-in-out infinite}.action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.condition[_ngcontent-%COMP%]:hover, .action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.action-custom[_ngcontent-%COMP%]:hover, .action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.main-action[_ngcontent-%COMP%]:hover{transform:scale(1);opacity:.8;animation:none}.action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.elements[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%]{cursor:zoom-out;animation:_ngcontent-%COMP%_element-pulse calc(var(--ghs-animation-speed) * 1.2s) ease-in-out infinite}.action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.elements[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%]:hover{animation:none;transform:scale(1)!important;z-index:5}.action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.element-half-container[_ngcontent-%COMP%]   .element-half[_ngcontent-%COMP%]{cursor:zoom-out}.action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.element-half-container[_ngcontent-%COMP%]   .element-half[_ngcontent-%COMP%]:nth-child(1){animation:_ngcontent-%COMP%_element-half-pulse calc(var(--ghs-animation-speed) * 1.2s) ease-in-out infinite;transform-origin:center right}.action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.element-half-container[_ngcontent-%COMP%]   .element-half[_ngcontent-%COMP%]:nth-child(1):hover{transform:scale(1)!important}.action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.element-half-container[_ngcontent-%COMP%]   .element-half[_ngcontent-%COMP%]:nth-child(2){animation:_ngcontent-%COMP%_element-half-pulse-right calc(var(--ghs-animation-speed) * 1.2s) ease-in-out infinite;transform-origin:center left}.action[_ngcontent-%COMP%]   .action-interactive.action-interactive-highlight.element-half-container[_ngcontent-%COMP%]   .element-half[_ngcontent-%COMP%]:nth-child(2):hover{transform:scale(1)!important}.action[_ngcontent-%COMP%]   ghs-action.subaction-area[_ngcontent-%COMP%]:not(:nth-of-type(1)){margin-top:.1%}.action[_ngcontent-%COMP%]   ghs-action.subaction-area[_ngcontent-%COMP%]:nth-of-type(1){flex-basis:0}.action[_ngcontent-%COMP%]   ghs-action.subaction-area[_ngcontent-%COMP%]:nth-of-type(1)   .action-area[_ngcontent-%COMP%]   ghs-action-hex[_ngcontent-%COMP%]{position:relative}.action[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]{margin-top:0}.action[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100%;justify-content:center;flex:1 0 auto}.action[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%]{margin-top:0;margin-left:5%}.action[_ngcontent-%COMP%]   .custom-subactions[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .grant-subactions[_ngcontent-%COMP%]{width:100%}.action[_ngcontent-%COMP%]   .monster-type[_ngcontent-%COMP%]{text-transform:uppercase}.action[_ngcontent-%COMP%]   .monster-type.monster-type-elite[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.action[_ngcontent-%COMP%]   .monster-type.monster-type-boss[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.action[_ngcontent-%COMP%]   .action-concatenation[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center}.action[_ngcontent-%COMP%]   .action-concatenation[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]{flex-basis:auto;flex-shrink:0;max-width:100%}.action[_ngcontent-%COMP%]   .action-concatenation.card-concat[_ngcontent-%COMP%]{margin-bottom:.4em}.action[_ngcontent-%COMP%]   .action-concatenation.card-concat[_ngcontent-%COMP%]   .subaction-card[_ngcontent-%COMP%]{margin-bottom:-.4em}.action[_ngcontent-%COMP%]   .action-concatenation[_ngcontent-%COMP%]   .action-concatenation-item[_ngcontent-%COMP%]{margin:0 .15em;filter:drop-shadow(.01em .01em .01em var(--ghs-color-black))}.action[_ngcontent-%COMP%]   .action-concatenation-spacer[_ngcontent-%COMP%]{display:flex}.action[_ngcontent-%COMP%]   .action-concatenation-spacer[_ngcontent-%COMP%]   .action-concatenation-spacer-item[_ngcontent-%COMP%]{display:block;width:1em}.action[_ngcontent-%COMP%]   .action-concatenation-spacer[_ngcontent-%COMP%]   .action-concatenation-spacer-item.small[_ngcontent-%COMP%]{width:.4em}.action[_ngcontent-%COMP%]   .action-grid[_ngcontent-%COMP%]{--ghs-grid-columns: 2;display:grid;grid-template-columns:repeat(var(--ghs-grid-columns),auto);column-gap:.5em;margin:0 .5em;align-items:center}.action[_ngcontent-%COMP%]   .action-box-container[_ngcontent-%COMP%]{width:100%;position:relative;display:flex;flex-direction:column;margin-bottom:.5em}.action[_ngcontent-%COMP%]   .action-box-container[_ngcontent-%COMP%]   .action-box-label[_ngcontent-%COMP%]{color:var(--ghs-ability-color);text-align:left;padding:.3em 1em}.action[_ngcontent-%COMP%]   .action-box-container[_ngcontent-%COMP%]   .action-box[_ngcontent-%COMP%]{position:relative;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:.2em .3em}.action[_ngcontent-%COMP%]   .action-box-container[_ngcontent-%COMP%]   .action-box[_ngcontent-%COMP%]:before{content:" ";display:block;position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--ghs-color-black);opacity:.5;z-index:0}.action[_ngcontent-%COMP%]   .action-box-container.empty[_ngcontent-%COMP%]{margin-bottom:0}.action[_ngcontent-%COMP%]   .action-box-container.empty[_ngcontent-%COMP%]   .action-box[_ngcontent-%COMP%]{display:none}.action[_ngcontent-%COMP%]   .action-box-container.first[_ngcontent-%COMP%]{margin-top:-.8em}.action[_ngcontent-%COMP%]   .action-box-fh-subactions-container[_ngcontent-%COMP%]{width:100%;position:relative;display:flex;flex-direction:column;margin-bottom:.5em}.action[_ngcontent-%COMP%]   .action-box-fh-subactions-container[_ngcontent-%COMP%]   .action-box-label[_ngcontent-%COMP%]{color:var(--ghs-ability-color);text-align:left;padding:.3em 1em}.action[_ngcontent-%COMP%]   .action-box-fh-subactions-container[_ngcontent-%COMP%]   .action-box[_ngcontent-%COMP%]{position:relative;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:.2em .3em;border:.04em dashed var(--ghs-color-white);border-radius:2em/100%}.action[_ngcontent-%COMP%]   .action-box-fh-subactions-container[_ngcontent-%COMP%]   .action-box[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:-.04em;left:-.02em;height:100%;width:100%;background-color:var(--ghs-color-white);opacity:.2;border:.04em solid var(--ghs-color-white);border-radius:2em/100%;z-index:-1}.action[_ngcontent-%COMP%]   .action-box-container-forced[_ngcontent-%COMP%]{position:relative;display:flex;margin-bottom:.5em}.action[_ngcontent-%COMP%]   .action-box-container-forced[_ngcontent-%COMP%]   .action-box-label[_ngcontent-%COMP%]{position:relative;top:.1em;display:flex;flex-grow:1;justify-content:center;align-items:center;padding:.3em;border-right:.1em solid var(--ghs-ability-color)}.action[_ngcontent-%COMP%]   .action-box-container-forced[_ngcontent-%COMP%]   .action-box-label[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:1.5em}.action[_ngcontent-%COMP%]   .action-box-container-forced[_ngcontent-%COMP%]   .action-box[_ngcontent-%COMP%]{position:relative;display:flex;flex-grow:1;justify-content:flex-start;align-items:center;padding:.2em}.action[_ngcontent-%COMP%]   .action-box-container-forced[_ngcontent-%COMP%]:before{content:" ";display:block;position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--ghs-color-black);opacity:.5;z-index:0;border:.1em solid var(--ghs-ability-color);border-radius:.5em}.action[_ngcontent-%COMP%]   .special-target-value[_ngcontent-%COMP%]{display:block}.action[_ngcontent-%COMP%]   ghs-action.subaction-monsterType[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.action.inline[_ngcontent-%COMP%]{justify-content:flex-start;margin-top:0;margin-bottom:0}.action.inline[_ngcontent-%COMP%]:not(:nth-child(1)){margin-top:.1em}.action.inline[_ngcontent-%COMP%]   .action-default[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .action-custom[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .action-grant[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .action-summon[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .action-specialTarget[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .action-condition[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.action.inline[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{align-self:flex-start}.action.inline[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .condition-value[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .special-target-value[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .monster-type[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .summon-value[_ngcontent-%COMP%]{filter:none!important}.action.inline[_ngcontent-%COMP%]   .special-target-value[_ngcontent-%COMP%]{display:block}.action.inline[_ngcontent-%COMP%]   .main-action[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .condition-subactions[_ngcontent-%COMP%]{align-self:flex-start;justify-content:flex-start}.action.inline[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   ghs-action-summon[_ngcontent-%COMP%]{text-align:left;padding:0!important}.action.inline[_ngcontent-%COMP%]   .action-concatenation[_ngcontent-%COMP%]{justify-content:flex-start}.action.inline[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]{flex-basis:unset}.action.inline[_ngcontent-%COMP%]   .element-subactions.subaction-area[_ngcontent-%COMP%] ~ ghs-action[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   ghs-action.subaction-area[_ngcontent-%COMP%] ~ ghs-action[_ngcontent-%COMP%]{flex-basis:100%;flex-shrink:1;margin-left:.1%}.action.inline[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]{flex-wrap:unset}.action.inline[_ngcontent-%COMP%]   .action-custom[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .action-grant[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .action-summon[_ngcontent-%COMP%]{align-items:flex-start;flex-wrap:wrap}.action.inline[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:.7em;width:auto}.action.inline[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%], .action.inline[_ngcontent-%COMP%]   .action-specialTarget[_ngcontent-%COMP%]{align-items:flex-start}.action.right[_ngcontent-%COMP%], .action.right[_ngcontent-%COMP%]   .action-default[_ngcontent-%COMP%], .action.right[_ngcontent-%COMP%]   .action-custom[_ngcontent-%COMP%], .action.right[_ngcontent-%COMP%]   .action-grant[_ngcontent-%COMP%], .action.right[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%], .action.right[_ngcontent-%COMP%]   .action-specialTarget[_ngcontent-%COMP%], .action.right[_ngcontent-%COMP%]   .action-condition[_ngcontent-%COMP%], .action.right[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]{justify-content:flex-end;text-align:right}.action.right[_ngcontent-%COMP%]   .action-default[_ngcontent-%COMP%]   .main-action[_ngcontent-%COMP%]{justify-content:flex-end;text-align:right;width:100%}.action.right.inline[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%], .action.right.inline[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%], .action.right.inline[_ngcontent-%COMP%]   ghs-action-summon[_ngcontent-%COMP%]{text-align:right;width:100%}.action.right.inline[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%]{align-items:flex-end;align-self:flex-end}.action.text-black[_ngcontent-%COMP%]{color:var(--ghs-color-black);filter:none!important}.action.text-black[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .placeholder-action[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .action-default[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .action-custom[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .action-grant[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .action-specialTarget[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .action-condition[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .condition-value[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .special-target-value[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .monster-type[_ngcontent-%COMP%], .action.text-black[_ngcontent-%COMP%]   .summon-value[_ngcontent-%COMP%]{filter:none!important}.action[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .monster-type-subactions[_ngcontent-%COMP%]{flex-shrink:0;display:flex;flex-direction:column;justify-content:center;align-items:center}.action[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%]   .subaction-area[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]   .monster-type-subactions[_ngcontent-%COMP%]   .subaction-area[_ngcontent-%COMP%]{margin-top:.3em}.action.fh[_ngcontent-%COMP%]{max-width:100%}.action.fh[_ngcontent-%COMP%]   .action-default[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-custom[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-grant[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-summon[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-trigger[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-specialTarget[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-condition[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]{flex-direction:row;flex-wrap:wrap}.action.fh[_ngcontent-%COMP%]   .action-custom[_ngcontent-%COMP%]   ghs-action-enhancements[_ngcontent-%COMP%]{width:100%}.action.fh[_ngcontent-%COMP%]   .action-custom[_ngcontent-%COMP%]   .enhancements-container[_ngcontent-%COMP%]   ghs-action-enhancements[_ngcontent-%COMP%]{width:auto}.action.fh[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .special-target-value[_ngcontent-%COMP%]{font-family:var(--ghs-font-text)}.action.fh[_ngcontent-%COMP%]   .main-action[_ngcontent-%COMP%]{font-size:125%;line-height:125%}.action.fh[_ngcontent-%COMP%]   .main-action.small[_ngcontent-%COMP%]{font-size:82%;line-height:82%}.action.fh[_ngcontent-%COMP%]   .main-action.small[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:.8em}.action.fh[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .condition-value[_ngcontent-%COMP%]{display:none}.action.fh[_ngcontent-%COMP%]   .action-monster-type[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]{flex-direction:row;align-items:center}.action.fh[_ngcontent-%COMP%]   .action-monster-type.action-monster-type[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .element-subactions.action-monster-type[_ngcontent-%COMP%]{flex-wrap:wrap}.action.fh[_ngcontent-%COMP%]   .action-grid[_ngcontent-%COMP%]{column-gap:.1em;margin:0}.action.fh[_ngcontent-%COMP%]   .monster-type[_ngcontent-%COMP%]{text-transform:initial}.action.fh[_ngcontent-%COMP%]:not(.inline)   .condition[_ngcontent-%COMP%]   .condition-image[_ngcontent-%COMP%]{width:1.4em;height:1.4em;display:flex;justify-content:center;align-items:center}.action.fh[_ngcontent-%COMP%]:not(.inline)   .subactions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .condition-image[_ngcontent-%COMP%]{width:1.2em;height:1em;display:flex;justify-content:center;align-items:center}.action.fh[_ngcontent-%COMP%]:not(.inline)   .subactions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .condition-image[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:1.5em;height:1.5em;margin:0}.action.fh[_ngcontent-%COMP%]:not(.inline)   .subactions[_ngcontent-%COMP%]   .action-push[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]:not(.inline)   .subactions[_ngcontent-%COMP%]   .action-pull[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]:not(.inline)   .subactions[_ngcontent-%COMP%]   .action-pierce[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{width:1.7em;height:1em;justify-content:flex-start}.action.fh[_ngcontent-%COMP%]:not(.inline)   .subactions[_ngcontent-%COMP%]   .action-push[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]:not(.inline)   .subactions[_ngcontent-%COMP%]   .action-pull[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]:not(.inline)   .subactions[_ngcontent-%COMP%]   .action-pierce[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:1.5em;height:1.5em;margin:0}.action.fh[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .condition-subactions[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .monster-type-subactions[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .subaction-custom[_ngcontent-%COMP%]   .custom-subactions[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .subaction-grant[_ngcontent-%COMP%]   .grant-subactions[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .subaction-specialTarget[_ngcontent-%COMP%]   .special-target-subactions[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:row;flex-wrap:wrap;max-width:95%;padding:.1em;margin-left:.2em;width:auto}.action.fh[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .condition-subactions[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .monster-type-subactions[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .subaction-custom[_ngcontent-%COMP%]   .custom-subactions[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .subaction-grant[_ngcontent-%COMP%]   .grant-subactions[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .subaction-specialTarget[_ngcontent-%COMP%]   .special-target-subactions[_ngcontent-%COMP%]:before{content:" ";position:absolute;z-index:0;top:50%;width:100%;height:100%;transform:translateY(-50%);background-color:var(--ghs-color-white);opacity:.2;border-radius:1em/100%}.action.fh[_ngcontent-%COMP%]   .subactions.monster-type-subactions[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .condition-subactions.monster-type-subactions[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .monster-type-subactions.monster-type-subactions[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .subaction-custom[_ngcontent-%COMP%]   .custom-subactions.monster-type-subactions[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .subaction-grant[_ngcontent-%COMP%]   .grant-subactions.monster-type-subactions[_ngcontent-%COMP%]:before, .action.fh[_ngcontent-%COMP%]   .subaction-specialTarget[_ngcontent-%COMP%]   .special-target-subactions.monster-type-subactions[_ngcontent-%COMP%]:before{display:none}.action.fh[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .condition-subactions[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .monster-type-subactions[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .subaction-custom[_ngcontent-%COMP%]   .custom-subactions[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .subaction-grant[_ngcontent-%COMP%]   .grant-subactions[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .subaction-specialTarget[_ngcontent-%COMP%]   .special-target-subactions[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]{margin:0 .1em}.action.fh.text-black[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%]:before, .action.fh.text-black[_ngcontent-%COMP%]   .condition-subactions[_ngcontent-%COMP%]:before, .action.fh.text-black[_ngcontent-%COMP%]   .monster-type-subactions[_ngcontent-%COMP%]:before, .action.fh.text-black[_ngcontent-%COMP%]   .subaction-custom[_ngcontent-%COMP%]   .custom-subactions[_ngcontent-%COMP%]:before, .action.fh.text-black[_ngcontent-%COMP%]   .subaction-grant[_ngcontent-%COMP%]   .grant-subactions[_ngcontent-%COMP%]:before, .action.fh.text-black[_ngcontent-%COMP%]   .subaction-specialTarget[_ngcontent-%COMP%]   .special-target-subactions[_ngcontent-%COMP%]:before{opacity:.5}.action.fh[_ngcontent-%COMP%]   .action-concatenation[_ngcontent-%COMP%]   .action-concatenation-item[_ngcontent-%COMP%]{margin:0}.action.fh[_ngcontent-%COMP%]   .special-type[_ngcontent-%COMP%]{flex-basis:100%;flex-shrink:0}.action.fh[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]   .minus[_ngcontent-%COMP%]{margin-left:.15em}.action.fh[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%]:not(:first-child){margin-left:.3em}.action.fh[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]{max-width:80%}.action.fh[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]   .subaction-element[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]{padding:0}.action.fh[_ngcontent-%COMP%]   .element-actions[_ngcontent-%COMP%]{flex-basis:100%}.action.fh[_ngcontent-%COMP%]   .element-actions[_ngcontent-%COMP%] > .subaction-element[_ngcontent-%COMP%] > .action[_ngcontent-%COMP%] > .action-element[_ngcontent-%COMP%]{margin-top:.5em}.action.fh[_ngcontent-%COMP%]   .element-actions[_ngcontent-%COMP%] > .subaction-element[_ngcontent-%COMP%] > .action[_ngcontent-%COMP%] > .action-element[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:-.4em;left:50%;transform:translate(-50%);width:2em;height:.4em;color:radial-gradient(var(--ghs-color-white) 0%,transparent 100%);background:radial-gradient(var(--ghs-color-white) 0%,transparent 100%);background-clip:padding-box;clip-path:polygon(48% 100%,52% 100%,52% 15%,100% 15%,100% 0%,0% 0%,0% 15%,48.5% 15%);z-index:-1}.action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;padding:.2em}.action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements.elements-half[_ngcontent-%COMP%]{width:2.5em;height:1.25em;margin-left:.3em}.action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]   .element-half-container[_ngcontent-%COMP%]{width:100%}.action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]   .element-half-container[_ngcontent-%COMP%]   .element-half[_ngcontent-%COMP%]{top:initial;height:100%}.action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]{margin-left:-.2em}.action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]   .grant-value[_ngcontent-%COMP%]{padding:0}.action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]   .condition-subactions[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]   .monster-type-subactions[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]   .custom-subactions[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]   .grant-subactions[_ngcontent-%COMP%], .action.fh[_ngcontent-%COMP%]   .action-element[_ngcontent-%COMP%]   .element-subactions[_ngcontent-%COMP%]   .special-target-subactions[_ngcontent-%COMP%]{margin-left:.1em}.action.fh[_ngcontent-%COMP%]   .action-element-consume[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;z-index:1;border:.04em dashed var(--ghs-color-white);border-radius:2em/100%}.action.fh[_ngcontent-%COMP%]   .action-element-consume[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:-.04em;left:-.02em;height:100%;width:100%;background-color:var(--ghs-color-white);opacity:.2;border:.04em solid var(--ghs-color-white);border-radius:2em/100%;z-index:-1}.action.fh.inline[_ngcontent-%COMP%]{width:100%}.action.fh.inline[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%]:before{background-color:var(--ghs-color-darkgray);opacity:.3}.action.fh.inline[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%]{justify-content:center;align-self:center}']})}return i})();const ci=/\%((\w+|\s|\.|\-|\:|\,|\+|\(|\)|\||\_|\[|\]|\||\{|\}|\$|\\|\/|\%U+200B)+)\%/,Qe=function(i,r=[],e=!1,a=!1){const n=!a&&m.f.settings.fhStyle||"fh"==a;for(;i.match(ci);)i=i.replace(ci,(o,...g)=>{let _=g[0],y="";-1!=_.indexOf(":")&&(y=_.split(":")[1],_=_.split(":")[0]);let B=_.split(".");!y&&-1!=g[0].indexOf(":")&&(y=B[B.length-1]),y||(y="");const nt=B[0],Z=B[1];let W=o,et="";if("condition"==Z||"immunity"==Z){let it=new j.kW(B[2]);et='<span class="condition-icon'+("immunity"==Z?" immunity":"")+'">',et+='<img  src="./assets/images/'+(n?"fh/":"")+"condition/"+it.name+'.svg" class="icon">',!y&&-1!=it.types.indexOf(j.GV.upgrade)&&(y="X"),y&&(et+='<span class="value">'+y+"</span>"),et+="</span>",W='<span class="placeholder-condition'+(n?" fh":"")+'">'+(n?"&#8203;":m.f.getLabel("game.condition."+it.name,[y||""]))+et+"</span>"}else if("conditionIcon"==Z||"immunityIcon"==Z){let it=new j.kW(B[2]);et='<span class="condition-icon'+("immunityIcon"==Z?" immunity":"")+'">',et+='<img  src="./assets/images/'+(n?"fh/":"")+"condition/"+it.name+'.svg" class="icon">',!y&&-1!=it.types.indexOf(j.GV.upgrade)&&(y="X"),y&&(et+='<span class="value">'+y+"</span>"),et+="</span>",W='<span class="placeholder-condition">&#8203;'+et+"</span>"}else if("action"!=Z||3!=B.length||B[2].startsWith("specialTarget")||B[2].startsWith("summon")||B[2].startsWith("area"))if("actionIcon"!=Z||3!=B.length||B[2].startsWith("specialTarget")||B[2].startsWith("summon")||B[2].startsWith("area"))if("element"==Z){let it=B[2];"consume"==it?(et='<span class="element inline consume">',it=B[3]):et='<span class="element inline">',et+='<img src="./assets/images/'+(n?"fh/":"")+"element/"+it+'.svg"></span>',W=et}else if("elementHalf"==Z){let it=!1;B[2]&&B[2].startsWith("consume")&&(it=!0);const st=y.split("|");W='<span class="attack-modifier-effect placeholder-element-half element-half-placeholder'+(n?" fh":"")+'"><span class="element-half-container'+(it?" consume":"")+'"><span class="element-half"><img src="./assets/images/'+(n?"fh/":"")+"element/"+st[0]+'.svg"></span><span class="element-half"><img src="./assets/images/'+(n?"fh/":"")+"element/"+st[1]+'.svg"></span></span></span>'}else if("action"==Z&&B[2].startsWith("area"))W='<span class="placeholder-area">',"areaRotated"==B[2]&&(W='<span class="placeholder-area" style="transform:rotate(-90deg);">'),y.split("|").forEach(it=>{const st=(0,K.dy)(it);null!=st&&(W+='<span class="hex" style="grid-column-start : '+(2*st.x+1+st.y%2)+";grid-column-end:"+(2*st.x+3+st.y%2)+";grid-row-start:"+(st.y+1)+";grid-row-end:"+(st.y+1)+'"><img src="./assets/images/action/hex/'+st.type+'.svg"></span>')}),W+="</span>";else if("initiative"==Z&&3==B.length)et='<img class="ghs-svg" src="./assets/images/initiative.svg"></span>',W='<span class="placeholder-initiative">'+B[2]+et+"</span>";else if("action"==Z&&4==B.length)et='<img  src="./assets/images/action/'+B[2]+"/"+B[3]+'.svg" class="icon ghs-svg">',W='<span class="placeholder-perk">'+et+y+"</span>";else if("game"==nt&&"items"==Z&&4==B.length)et='<img  src="./assets/images/items/'+B[2]+"/"+B[3]+'.svg" class="icon ghs-svg">',W='<span class="placeholder-item-slot">'+et+y+"</span>";else if("game"==nt&&"itemFh"==Z&&3==B.length)if("random"==B[2])W='<span class="placeholder-item-fh"><span class="value"><img src="./assets/images/fh/loot/random_item.svg"></span></span>';else{const it=+B[2];W='<span class="placeholder-item-fh"><span class="value">'+(it<100?"0":"")+(it<10?"0":"")+it+"</span></span>"}else if("card"==Z&&3==B.length){let it=B[2],st="";y&&(st='<span class="card-value">'+y+"</span>"),et='<img class="icon ghs-svg" src="./assets/images/action/card/'+it+'.svg">',W='<span class="placeholder-effect placeholder-card">'+et+'<img class="card-overlay" src="./assets/images/action/card/overlay/'+it+'.svg">'+st+"</span>"}else if("attackmodifier"==Z&&3==B.length)et='<img  src="./assets/images'+(n?"/fh":"")+"/attackmodifier/icons/"+B[2]+'.png" class="icon">',W='<span class="placeholder-attackmodifier">'+et+"</span>";else if("townGuardAM"==Z&&y){W='<span class="placeholder-townguard-attackmodifier">'+y+"</span>";const it=[...Y.IK,...Y.qq].find(st=>st.id==y);if(it){const st=it.effects.find(ke=>"custom"==ke.type&&ke.icon);let pt='<span class="townguard-attackmodifier"><img src="./assets/images/fh/attackmodifier/icons/'+it.valueType+'.png" class="icon"><span class="value">'+(it.value>=0?"+":"")+it.value+"</span></span>";(it.type==Y.Yn.wreck||it.type==Y.Yn.success)&&(pt='<span class="townguard-attackmodifier"><img src="./assets/images/fh/attackmodifier/icons/'+it.type+'.png" class="icon"></span>'),W='<span class="placeholder-townguard-attackmodifier">'+(null!=st?'<img  src="./assets/images/action/custom/'+st.value+'.svg" class="icon">':"")+pt+(it.rolling?'<img  src="./assets/images/attackmodifier/rolling.svg" class="icon">':"")+"</span>"}}else if("customAction"==Z&&y)W='<span class="placeholder-custom-action"><img  src="./assets/images/action/custom/'+y+'.svg" class="icon ghs-svg"></span>';else if("experience"==Z)et='<img  src="./assets/images/experience.svg" class="icon ghs-svg">',W='<span class="placeholder-experience">'+et+(y?'<span class="value">'+y+"</span>":"")+"</span>";else if("characterIcon"==Z&&3==B.length)et='<img class="icon" src="'+s.E.characterManager.characterIcon(B[2])+'">',W='<span class="placeholder-character-icon">'+et+"</span>";else if("characterIconColored"==Z&&3==B.length)et='<img class="icon" src="'+s.E.characterManager.characterIcon(B[2])+'">',W='<span class="placeholder-character-icon-colored">'+et+"</span>";else if("characterIconColoredBg"==Z&&3==B.length){const it=B[2];et='<img class="icon" src="'+s.E.characterManager.characterIcon(it)+'">',W='<span class="placeholder-character-icon-colored-bg" style="background-color:'+s.E.characterManager.characterColor(it)+'">'+et+"</span>"}else if("characterIconIdentity"==Z&&4==B.length)et='<img class="icon" src="'+s.E.characterManager.characterIdentityIcon(B[2],+B[3])+'">',W='<span class="placeholder-character-icon">'+et+"</span>";else if("characterIconIdentityColored"==Z&&4==B.length)et='<img class="icon" src="'+s.E.characterManager.characterIdentityIcon(B[2],+B[3])+'">',W='<span class="placeholder-character-icon-colored">'+et+"</span>";else if("characterIconIdentityColoredBg"==Z&&4==B.length){const it=B[2];et='<img class="icon" src="'+s.E.characterManager.characterIdentityIcon(it,+B[3])+'">',W='<span class="placeholder-character-icon-colored-bg" style="background-color:'+s.E.characterManager.characterColor(it)+'">'+et+"</span>"}else if("characterToken"==Z&&B.length>=3){const it=B[2];let st=s.E.characterManager.characterIcon(it),Et=!1;B.length>3&&(st="./assets/images/character/token/"+it+"-"+B[3]+".svg",Et=!0),et='<img src="'+st+'">',W='<span class="placeholder-character-token'+(Et?" additional":"")+'" style="--ghs-character-color:'+s.E.characterManager.characterColor(it)+'">'+et+"</span>"}else if("coloredToken"==Z&&B.length>3)et='<img src="./assets/images/character/custom/'+B[3]+'.svg">',W='<span class="placeholder-character-token" style="--ghs-character-color:#'+B[2]+'">'+et+"</span>";else if("characterColored"==Z)W='<span style="color: '+s.E.characterManager.characterColor(B[2])+';">'+y+"</span>";else if("monsterType"==Z&&3==B.length){const it=B[2];W='<span class="placeholder-monster-type '+it+'">'+m.f.getLabel("game.monster."+it)+"</span>"}else if("monsterType"==Z&&4==B.length)W='<span class="placeholder-monster-type '+B[2]+'">'+B[3]+"</span>";else if("mapMarker"==Z&&3==B.length)"element"==B[2]?(et='<img src="./assets/images/element/'+y+'.svg">',W='<span class="placeholder-element">'+et+"</span>"):W='<span class="map-marker">'+B[2]+"</span>";else if("objectiveMarker"==Z&&3==B.length)W='<span class="objective-marker">'+B[2]+"</span>";else if("scenarioNumber"==Z)W='<span class="scenario-number">'+y+"</span>";else if(n&&"target"==Z&&2==B.length)et='<img  src="./assets/images/fh/action/target.svg" class="icon ghs-svg">',W='<span class="placeholder-action">'+et+"</span>";else if(n||"damage"!=Z)if(n&&"damage"==Z)et='<img  src="./assets/images/fh/action/damage.svg" class="icon ghs-svg">',W='<span class="damage">&#8203;'+et+y+"</span>";else if("loot"==Z&&4==B.length)et='<img  src="./assets/images/'+B[3]+'-player.svg" class="icon">',W='<span class="placeholder-player">'+et+"</span>";else if("resource"==Z&&3==B.length)et='<img  src="./assets/images/fh/loot/'+B[2]+'.svg" class="icon ghs-svg">',W='<span class="placeholder-resource">'+et+"</span>";else if("section"==Z&&y)et='<img src="./assets/images/fh/party/section.svg" class="icon ghs-svg">',W='<span class="placeholder-section">'+et+y+"</span>";else if("gh2eFaction"==Z&&y)et='<img src="./assets/images/gh2e/faction/'+y+'.svg" class="icon ghs-svg">',W='<span class="placeholder-faction">'+et+"</span>";else if("checkmark"==Z)W='<span class="placeholder-checkmark"><img src="./assets/images/check.svg" class="icon ghs-svg"></span>';else if("itemSlot"==Z&&y)W='<span class="placeholder-items-slot"><img src="./assets/images/items/slots/'+y+'.svg" class="icon ghs-svg"></span>';else if("bbAm"==Z&&3==B.length)W='<span class="placeholder-bb-am"><img src="./assets/images/bb/attackmodifier/'+B[2]+'.svg" class="icon ghs-svg"></span>';else if("townGuardAm"==Z&&3==B.length&&y){const it=B[2];let st="";it==Y.tW.plus?st="+":it==Y.tW.minus?st="-":it==Y.tW.multiply&&(st="x"),W='<span class="placeholder-town-guard-am '+B[2]+'">'+st+y+"</span>"}else if("fhIcon"==Z&&y)et='<img src="./assets/images/fh/icons/'+y+'.svg" class="icon ghs-svg">',W='<span class="placeholder-fh-icon">'+et+"</span>";else if("gameIcon"==Z&&y)et='<img src="./assets/images/'+y+'.svg" class="icon ghs-svg">',W='<span class="placeholder-game-icon">'+et+"</span>";else if("trait"==Z)et='<img src="./assets/images/fh/character/traits/trait.svg" class="icon ghs-svg">',W='<span class="placeholder-trait">'+et+(y?m.f.getLabel("data.character.traits."+y):"")+"</span>";else if("checkbox"==Z)W='<span class="placeholder-checkbox"></span>';else if("eventCard"==Z&&y)W='<span class="placeholder-action"><img src="./assets/images/eventcards/'+y+'.svg" class="icon ghs-svg"></span>';else if("eventCheckbox"==Z&&y)W='<span class="event-checkbox">'+y+"</span>";else if("valueSign"==Z&&y)W='<span class="value-sign">'+(+y>-1?"+":"")+y+"</span>";else if("enhancement"==Z&&3==B.length)et=n&&"any"!==B[2]?'<img class="enhancement-icon" src="./assets/images/fh/character/abilities/enhancements/'+B[2]+'.svg">':'<img class="enhancement-icon" src="./assets/images/character/abilities/enhancements/circle.svg">',W='<span class="placeholder-enhancement">'+et+"</span>";else{let it=_.split(":").splice(1).map(st=>Qe(m.f.getLabel(st),r,e));y&&(it=[y,...it]),it.push(...r),W=m.f.getLabel(_.split(":")[0],it)+et}else W='<span class="damage">'+m.f.getLabel("game.damage",[y])+"</span>";else{B.splice(0,1);const it=-1!=Qi.indexOf(B[B.length-1]);et='<img  src="./assets/images/'+(n?"fh/action/":"action/")+B[B.length-1]+'.svg" class="icon'+(it?" ghs-svg":"")+'">',W='&#8203;<span class="placeholder-action">&#8203;'+et+y+"</span>"}else{B.splice(0,1);const it=-1!=Qi.indexOf(B[B.length-1]);et='<img  src="./assets/images/'+(n?"fh/":"")+B.join("/")+'.svg" class="icon'+(it?" ghs-svg":"")+'">',W='&#8203;<span class="placeholder-action">'+(n?"&#8203;":m.f.getLabel(_))+et+y+"</span>"}return W});return Jl(i,e)},Jl=function(i,r){for(;i.match($.OD);)i=i.replace($.OD,(e,...a)=>{if(m.f.settings.calculate&&!r)return""+(0,$.hZ)(e);{let n=a[2],o=[];const g=n&&n.startsWith("$");return g&&(n=n.replace("$",""),-1!=n.indexOf(":")&&(o=[n.split(":")[1]],n=n.split(":")[0])),g?a[0]+" "+m.f.getLabel("game.custom."+n,o):a[0]}});for(;i.match($.LK);)i=i.replace($.LK,(e,...a)=>{let n=a[2],o=[];const g=n&&n.startsWith("$");return g&&(n=n.replace("$",""),-1!=n.indexOf(":")&&(o=[n.split(":")[1]],n=n.split(":")[0])),g?a[0]+" "+m.f.getLabel("game.custom."+n,o):a[0]});return i};let tt=(()=>{class i{el;value;args=[];argLabel=!0;empty=!0;attribute="";slice=[];relative=!1;style=!1;C;L;locale;calc=!1;fhStyle=!1;valueChange="";constructor(e){this.el=e,e.nativeElement.classList.add("placeholder"),this.C=Math.max(2,s.E.characterManager.characterCount()),this.L=s.E.game.level,this.locale=m.f.settings.locale,this.calc=m.f.settings.calculate,this.fhStyle=m.f.settings.fhStyle}ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{const e=Math.max(2,s.E.characterManager.characterCount());(this.locale!=m.f.settings.locale||this.C!=e||this.L!=s.E.game.level||this.fhStyle!=m.f.settings.fhStyle||this.calc!=m.f.settings.calculate||this.valueChange!=this.value)&&(this.C=e,this.L=s.E.game.level,this.locale=m.f.settings.locale,this.calc=m.f.settings.calculate,this.fhStyle=m.f.settings.fhStyle,this.valueChange=this.value,this.apply())}}),this.apply()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}ngOnChanges(e){(e.args&&JSON.stringify(e.args.previousValue)!=JSON.stringify(e.args.currentValue)||e.value&&e.value.previousValue!=e.value.currentValue||e.style&&e.style.previousValue!=e.style.currentValue)&&this.apply()}apply(){let e=this.args.map(n=>""+n)||[];this.argLabel&&(e=e.map(n=>Qe(m.f.getLabel(n,[],!1,this.empty),[],this.relative,this.style)));let a="number"==typeof this.value?this.value:this.value&&Qe(m.f.getLabel(this.value,e,!1,this.empty),e,this.relative,this.style)||"";"string"==typeof a&&1==this.slice.length?a=a.slice(this.slice[0]):"string"==typeof a&&2==this.slice.length&&(a=a.slice(this.slice[0],this.slice[1])),this.attribute?this.el.nativeElement.setAttribute(this.attribute,a):this.el.nativeElement.innerHTML=a}static \u0275fac=function(a){return new(a||i)(t.rXU(t.aKT))};static \u0275dir=t.FsC({type:i,selectors:[["","ghs-label",""]],inputs:{value:[0,"ghs-label","value"],args:[0,"ghs-label-args","args"],argLabel:[0,"ghs-label-args-replace","argLabel"],empty:[0,"ghs-label-empty","empty"],attribute:[0,"ghs-label-attribute","attribute"],slice:"slice",relative:"relative",style:"style"},standalone:!1,features:[t.OA$]})}return i})(),Zl=(()=>{class i{el;value="";constructor(e){this.el=e,e.nativeElement.classList.add("placeholder")}ngOnInit(){this.value=this.el.nativeElement.textContent,this.apply()}ngOnChanges(e){this.apply()}apply(){const e=this.value&&Qe("%"+this.value+"%")||"";e&&(this.el.nativeElement.innerHTML=e)}static \u0275fac=function(a){return new(a||i)(t.rXU(t.aKT))};static \u0275dir=t.FsC({type:i,selectors:[["","ghs-placeholder",""]],inputs:{value:[0,"ghs-placeholder","value"]},standalone:!1,features:[t.OA$]})}return i})(),At=(()=>{class i{onKeyDown(e){if(m.f.settings.keyboardShortcuts&&("Enter"===e.key||" "===e.key)&&!e.shiftKey&&!e.altKey&&e.target instanceof HTMLElement){const a=e.target.getAttribute("disabled")||e.target.classList.contains("disabled")||e.target.parentElement&&(e.target.parentElement.getAttribute("disabled")||e.target.parentElement.classList.contains("disabled"));e.preventDefault(),e.stopPropagation(),a||(e.target.dispatchEvent(new Event("click",{bubbles:!0,cancelable:!0})),e.target.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0})),e.target.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0})))}}static \u0275fac=function(a){return new(a||i)};static \u0275dir=t.FsC({type:i,selectors:[["","tabclick",""]],hostAttrs:["tabindex","0","role","button"],hostBindings:function(a,n){1&a&&t.bIt("keydown",function(g){return n.onKeyDown(g)})},standalone:!1})}return i})();const Ql=(i,r)=>({elite:i,boss:r}),tg=(i,r)=>({extended:i,small:r}),ta=(i,r)=>[i,r],eg=(i,r,e,a)=>({disabled:i,existing:r,elite:e,boss:a}),ng=i=>({active:i});function ig(i,r){if(1&i&&(t.j41(0,"div",2)(1,"div",11),t.nrm(2,"div",12),t.k0s()()),2&i){const e=t.XpG();t.R7$(2),t.xc7("background-image",e.monster.noThumbnail||!e.settingsManager.settings.artwork?"":"url("+e.gameManager.monsterManager.monsterThumbnail(e.monster)+")")}}function ag(i,r){if(1&i&&t.nrm(0,"span",3),2&i){const e=t.XpG();t.Y8G("ghs-label",(e.monster.isAlly?"game.ally.addEntity.":"monster.addEntity.")+e.type)}}function og(i,r){if(1&i&&t.nrm(0,"span",5),2&i){const e=t.XpG();t.Y8G("ghs-label","monster.changeStandee")("ghs-label-args",t.l_i(2,ta,e.entity.type,e.entity.number))}}function sg(i,r){if(1&i&&t.nrm(0,"span",5),2&i){const e=t.XpG();t.Y8G("ghs-label","monster.setStandees")("ghs-label-args",t.l_i(2,ta,e.type,e.entitiesLeft()))}}function rg(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",13),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.pickNumber(n))}),t.j41(1,"span",14),t.EFF(2),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.ziG(3,eg,a.hasNumber(e)&&(!a.change||!a.entity),a.hasNumber(e),a.type==a.MonsterType.elite,a.type==a.MonsterType.boss)),t.R7$(),t.Y8G("ngClass",a.monster.bb?"bb-"+e:""),t.R7$(),t.JRh(e)}}function cg(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",15),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.summon=!n.summon)}),t.nrm(1,"img",16),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(3,ng,e.summon)),t.R7$(),t.Y8G("src",t.VkB("./assets/images/summons/",e.monster.summonColor,".png"),t.B4B)}}function lg(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",9)(1,"a",17),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleMonsterType())}),t.nrm(2,"span",5),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","monster.changeType")("ghs-label-args",t.l_i(2,ta,e.entity.type==e.MonsterType.normal?e.entity.type:e.MonsterType.elite,e.entity.type==e.MonsterType.normal?e.MonsterType.elite:e.MonsterType.normal))}}function gg(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",10)(1,"a",17),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.close())}),t.nrm(2,"span",3),t.k0s()()}2&i&&(t.R7$(2),t.Y8G("ghs-label","monster.cancelNumberpicker"))}let li=(()=>{class i{dialogRef;monster;type;max;range;summon=!1;MonsterType=S.N;entity;entities;automatic=!1;change=!1;settingsManager=m.f;timeout;gameManager=s.E;constructor(e,a){this.dialogRef=a,this.monster=e.monster,this.type=e.type,this.max=s.E.monsterManager.monsterStandeeMax(this.monster),this.range=e.range,this.entity=e.entity,this.entities=e.entities,this.automatic=e.automatic||!1,this.change=e.change||!1,this.entity||(this.entity=this.entities&&this.entities.find(n=>n.number<0)||void 0),this.entity&&(this.type=this.entity.type)}onKeyPress(e){if(m.f.settings.keyboardShortcuts)if(e.key in["0","1","2","3","4","5","6","7","8","9"]){if(this.timeout){clearTimeout(this.timeout),this.timeout=void 0;const a=+e.key+10,n=+e.key;a<=this.max?this.pickNumber(a):(this.pickNumber(1),this.pickNumber(n))}else"1"===e.key&&this.range.filter(a=>a>10).some(a=>!this.hasNumber(a))?this.timeout=setTimeout(()=>{this.pickNumber(+e.key),this.timeout=void 0},1e3):this.pickNumber("0"===e.key&&this.max>9?10:+e.key);e.preventDefault(),e.stopPropagation()}else"s"!==e.key||this.entity?"t"===e.key&&(this.entity&&this.toggleMonsterType(),this.type==S.N.normal?this.type=S.N.elite:this.type==S.N.elite&&(this.type=S.N.normal)):this.summon=!this.summon}ngOnInit(){this.range=Array.from(Array(this.max).keys()).map(e=>e+1)}hasEntity(){return this.monster.entities.filter(e=>s.E.entityManager.isAlive(e)&&(!m.f.settings.hideStats||e.type==this.type)).length>0}hasNumber(e){return null!=s.E.monsterManager.monsterStandeeUsed(this.monster,e)}entitiesLeft(){return this.entities&&this.entities.filter(e=>e.type==this.type&&e.number<1).length||0}randomStandee(){const e=s.E.monsterManager.monsterStandeeMax(this.monster);let a=Math.floor(Math.random()*e)+1;for(;this.monster.entities.some(n=>n.number==a);)a=Math.floor(Math.random()*e)+1;this.pickNumber(a,!0,!1)}nextStandee(){let e=1;for(;this.monster.entities.some(a=>a.number==e);)e+=1;this.pickNumber(e,!0,!0)}pickNumber(e,a=!1,n=!1){if(!(e<1||e>this.max)){if(this.hasNumber(e)||!this.type||this.change){if(this.change&&this.entity&&this.entity.number!=e){s.E.stateManager.before("updateStandee","data.monster."+this.monster.name,"monster."+this.entity.type,""+this.entity.number,""+e);let o=s.E.monsterManager.monsterStandeeUsed(this.monster,e);if(o){let g=-1;for(;s.E.monsterManager.monsterStandeeUsed(this.monster,g);)g-=1;o.number=g}this.entity.number=e,s.E.stateManager.after()}}else{let o="addStandee";a&&!n?o="addRandomStandee":a&&(o="addNextStandee"),s.E.stateManager.before(o,"data.monster."+this.monster.name,"monster."+this.type,""+e);const g=this.monster.entities.find(_=>_.number==e);if(g&&s.E.monsterManager.removeMonsterEntity(this.monster,g),this.entity)this.entity.number=e,this.entity.revealed&&(this.entity.revealed=!1),this.entity=this.entities&&(this.entities.find(_=>_.number<0&&_.type==this.type)||this.entities.find(_=>_.number<0))||void 0,this.entity&&(this.type=this.entity.type);else{const _=s.E.monsterManager.addMonsterEntity(this.monster,e,this.type,this.summon);s.E.game.state==T.mk.next&&_&&(this.monster.active=!s.E.game.figures.some(y=>y.active),this.monster.active&&(s.E.sortFigures(this.monster),_.active=!0))}s.E.stateManager.after(),(this.entities?this.monster.entities.filter(_=>_.number>0).length:s.E.entityManager.entities(this.monster).length)==s.E.monsterManager.monsterStandeeMax(this.monster)||!this.entity&&this.entities?(0,V.co)(this.dialogRef):this.entity&&this.entities&&this.monster.entities.filter(_=>_.number>0).length==s.E.monsterManager.monsterStandeeMax(this.monster)-1&&this.nextStandee()}this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0)}}toggleMonsterType(){if(this.entity&&(this.entity.type==S.N.normal||this.entity.type==S.N.elite)){const e=s.E.monsterManager.getStat(this.monster,S.N.normal),a=s.E.monsterManager.getStat(this.monster,S.N.elite);e&&a?(s.E.stateManager.before("changeMonsterType","data.monster."+this.monster.name,"monster."+this.entity.type,""+this.entity.number,this.entity.type==S.N.normal?S.N.elite:S.N.normal),this.entity.type=this.entity.type==S.N.normal?S.N.elite:S.N.normal,this.entity.maxHealth=(0,$.hZ)(this.entity.type==S.N.normal?e.health:a.health,this.monster.level),(this.entity.health>this.entity.maxHealth||this.entity.health<this.entity.maxHealth&&this.entity.health==(0,$.hZ)(this.entity.type==S.N.normal?a.health:e.health,this.monster.level))&&(this.entity.health=this.entity.maxHealth),this.monster.bb&&(this.monster.entities.every(n=>n.type==S.N.elite)?-1==this.monster.tags.indexOf("bb-elite")&&this.monster.tags.push("bb-elite"):-1!=this.monster.tags.indexOf("bb-elite")&&(this.monster.tags=this.monster.tags.filter(n=>"bb-elite"!=n))),s.E.stateManager.after()):console.warn("Missing stats!",this.monster)}}close(){(0,V.co)(this.dialogRef,!0)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-monster-numberpicker-dialog"]],hostBindings:function(a,n){1&a&&t.bIt("keydown",function(g){return n.onKeyPress(g)},t.EBC)},standalone:!1,decls:14,vars:16,consts:[[1,"title"],[1,"monster"],[1,"standee"],[3,"ghs-label"],[3,"ngClass"],[3,"ghs-label","ghs-label-args"],[1,"number-container",3,"ngClass"],["tabclick","",1,"number-button",3,"ngClass"],["tabclick","",1,"summon-button",3,"ngClass"],[1,"change-type"],[1,"cancel"],[1,"background-image-container"],[1,"background-image"],["tabclick","",1,"number-button",3,"click","ngClass"],[1,"number",3,"ngClass"],["tabclick","",1,"summon-button",3,"click","ngClass"],[1,"summon",3,"src"],["tabclick","",3,"click"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"span",1),t.nVh(2,ig,3,2,"div",2),t.nrm(3,"span",3),t.k0s(),t.j41(4,"span",4),t.nVh(5,ag,1,1,"span",3),t.nVh(6,og,1,5,"span",5),t.nVh(7,sg,1,5,"span",5),t.k0s()(),t.j41(8,"div",6),t.Z7z(9,rg,3,8,"div",7,t.fX1),t.nVh(11,cg,2,5,"div",8),t.k0s(),t.nVh(12,lg,3,5,"div",9),t.nVh(13,gg,3,1,"div",10)),2&a&&(t.R7$(2),t.vxM(n.automatic?2:-1),t.R7$(),t.Y8G("ghs-label","data.monster."+n.monster.name),t.R7$(),t.Y8G("ngClass",t.l_i(10,Ql,n.type==n.MonsterType.elite,n.type==n.MonsterType.boss)),t.R7$(),t.vxM(n.change&&n.entity||n.entities&&0!=n.entities.length?-1:5),t.R7$(),t.vxM(n.change&&n.entity?6:-1),t.R7$(),t.vxM(n.entities&&n.entities.length>0?7:-1),t.R7$(),t.Y8G("ngClass",t.l_i(13,tg,4==n.max,(n.automatic||n.change||n.entities&&n.entities.length>0)&&n.max>4&&n.max<10)),t.R7$(),t.Dyx(n.range),t.R7$(2),t.vxM(n.change||n.automatic||n.entities&&0!=n.entities.length||n.monster.bb?-1:11),t.R7$(),t.vxM(n.change&&n.entity&&n.entity.type!=n.MonsterType.boss?12:-1),t.R7$(),t.vxM(n.automatic?13:-1))},dependencies:[N.YU,tt,At],styles:[".title[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.title[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.title[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]{position:relative;display:flex;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 7.8 * var(--ghs-text-factor))}.title[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .background-image-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:25% 25% 5% 5%;border:solid calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) var(--ghs-color-gray);overflow:hidden;z-index:0}.title[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .background-image-container[_ngcontent-%COMP%]   .background-image[_ngcontent-%COMP%]{position:absolute;top:-8%;left:0;width:100%;height:150%;background-color:var(--ghs-color-darkgray);background-size:calc(var(--ghs-unit) * 9.5 * var(--ghs-text-factor)) AUTO;background-repeat:no-repeat;background-position:top center;filter:brightness(70%)}.title[_ngcontent-%COMP%]   .elite[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.title[_ngcontent-%COMP%]   .boss[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.number-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,auto);justify-items:center;align-items:center;gap:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.number-container.extended[_ngcontent-%COMP%]{grid-template-columns:repeat(5,auto)}.number-container.small[_ngcontent-%COMP%]{grid-template-columns:repeat(3,auto)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.number-container[_ngcontent-%COMP%]   .number-button.elite[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.number-container[_ngcontent-%COMP%]   .number-button.boss[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.number-container[_ngcontent-%COMP%]   .number-button.existing[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray)}.number-container[_ngcontent-%COMP%]   .number-button.disabled[_ngcontent-%COMP%]{pointer-events:none}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:not(.existing)   .number.bb-1[_ngcontent-%COMP%]{color:var(--ghs-color-bb-1)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:not(.existing)   .number.bb-2[_ngcontent-%COMP%]{color:var(--ghs-color-bb-2)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:not(.existing)   .number.bb-3[_ngcontent-%COMP%]{color:var(--ghs-color-bb-3)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:not(.existing)   .number.bb-4[_ngcontent-%COMP%]{color:var(--ghs-color-bb-4)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:not(.existing)   .number.bb-5[_ngcontent-%COMP%]{color:var(--ghs-color-bb-5)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:not(.existing)   .number.bb-6[_ngcontent-%COMP%]{color:var(--ghs-color-bb-6)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:not(.existing)   .number.bb-7[_ngcontent-%COMP%]{color:var(--ghs-color-bb-7)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:not(.existing)   .number.bb-8[_ngcontent-%COMP%]{color:var(--ghs-color-bb-8)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:not(.existing)   .number.bb-9[_ngcontent-%COMP%]{color:var(--ghs-color-bb-9)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:not(.existing)   .number.bb-10[_ngcontent-%COMP%]{color:var(--ghs-color-bb-10)}.number-container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.number-container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]   img.summon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.number-container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.number-container[_ngcontent-%COMP%]   .summon-button.active[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) / 5) var(--ghs-color-white) solid;border-radius:100%}.change-type[_ngcontent-%COMP%]{display:flex;justify-content:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.change-type[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}.change-type[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.cancel[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.cancel[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}.cancel[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}"]})}return i})();var mt=M(34933),mn=M(73018);class Co{id;marker;name;health;escort;initiative;actions=[];allyDeck=!1;tags=[];initiativeShare;trackDamage=!1;constructor(r,e,a=!1,n=-1,o="",g=[],_=void 0){this.name=r,this.health=e,this.escort=a,this.id=n,this.marker=o,this.tags=g,this.initiative=_}}var Vn=M(82e3);let Oo=(()=>{class i{directives=[];active;behindActive;currentZoom=0;currentPinchZoom=!1;zoomDiff=-1;activePointers=new Map;constructor(){this.currentZoom=m.f.settings.zoom,window.addEventListener("pointerdown",e=>{if(this.activePointers.set(e.pointerId,e),m.f.settings.pinchZoom&&2===this.countActiveTouches()&&(this.zoomDiff=this.getTouchDistance(),this.currentPinchZoom=!0),e.isPrimary&&(this.active=this.find(e.target),this.active)){if(this.active.clickBehind&&(this.behindActive=this.find(this.active.elementRef.nativeElement.parentElement),!this.behindActive)){const a=document.elementsFromPoint(e.clientX,e.clientY);for(let n=0;n<a.length;n++){const o=a[n];if(o!=e.target&&(this.behindActive=this.directives.find(g=>o&&g.elementRef.nativeElement==o),this.behindActive))break}}this.behindActive&&this.active.clickBehind&&this.behindActive.pointerdown(e),this.active.pointerdown(e),this.active.isDragElement||(e.preventDefault(),e.stopPropagation())}}),window.addEventListener("pointermove",e=>{if(m.f.settings.pinchZoom&&this.activePointers.size>=2)return this.activePointers.set(e.pointerId,e),this.handlePinchZoom(),void(this.currentPinchZoom=!0);this.active&&e.isPrimary&&(this.active.pointermove(e),window.document.body.classList.add("dragging"),window.document.body.classList.add("no-pointer"),this.behindActive&&(this.behindActive.cancel(),this.behindActive=void 0))},{passive:!0}),window.addEventListener("pointerup",e=>{this.activePointers.delete(e.pointerId),this.active&&e.isPrimary&&(this.active.pointerup(e),this.active.isDragElement||(e.preventDefault(),e.stopPropagation()),this.active=void 0),this.behindActive&&e.isPrimary&&(this.behindActive.pointerup(e),this.behindActive=void 0),m.f.settings.pinchZoom&&this.activePointers.size<2&&this.zoomDiff>-1&&m.f.settings.zoom!=this.currentZoom&&(this.zoomDiff=-1,m.f.setZoom(this.currentZoom)),0===this.activePointers.size&&(this.currentPinchZoom=!1),window.document.body.classList.remove("dragging"),window.document.body.classList.remove("no-pointer")}),window.addEventListener("pointercancel",e=>{this.activePointers.delete(e.pointerId),this.active&&e.isPrimary&&(this.active.pointerup(e),this.behindActive&&(this.behindActive.pointerup(e),this.behindActive=void 0),!this.active.clickBehind&&!this.active.isDragElement&&(e.preventDefault(),e.stopPropagation()),this.active=void 0),window.document.body.classList.remove("dragging"),window.document.body.classList.remove("no-pointer")}),window.addEventListener("keydown",e=>{m.f.settings.keyboardShortcuts&&this.active&&"Shift"===e.key&&(this.active.fast=!0)}),window.addEventListener("keyup",e=>{m.f.settings.keyboardShortcuts&&this.active&&"Shift"===e.key&&(this.active.fast=!1)})}zoom(e){this.currentZoom+=e,document.body.style.setProperty("--ghs-factor",this.currentZoom+"");const a=+window.getComputedStyle(document.body).getPropertyValue("min-width").replace("px","");e<0&&a>=window.innerWidth&&(this.currentZoom-=e,document.body.style.setProperty("--ghs-factor",this.currentZoom+""))}countActiveTouches(){let e=0;return this.activePointers.forEach(a=>{"touch"===a.pointerType&&e++}),e}getTouchDistance(){const e=Array.from(this.activePointers.values()).filter(o=>"touch"===o.pointerType);if(e.length<2)return 0;const[a,n]=e;return Math.abs(a.clientX-n.clientX)}handlePinchZoom(){if(!m.f.settings.pinchZoom)return;const e=Array.from(this.activePointers.values()).filter(a=>"touch"===a.pointerType);if(2===e.length){const a=Math.abs(e[0].clientX-e[1].clientX);this.zoomDiff>0&&this.zoom(Math.ceil(.25*(this.zoomDiff-a))),this.zoomDiff=a}}cancel(){this.active&&(this.active.cancel(),this.active=void 0),this.behindActive&&(this.behindActive.cancel(),this.behindActive=void 0),window.document.body.classList.remove("dragging"),window.document.body.classList.remove("no-pointer")}register(e){this.directives.push(e)}unregister(e){this.directives.splice(this.directives.indexOf(e),1)}find(e){let a=e,n=this.directives.find(g=>a&&g.elementRef.nativeElement==a),o=0;for(;!n&&o<50&&a!==document.body&&a.parentElement;)a=a.parentElement,n=this.directives.find(g=>a&&g.elementRef.nativeElement==a),o++;return n}static \u0275fac=function(a){return new(a||i)};static \u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),rt=(()=>{class i{elementRef;service;clickBehind=!1;relative=!1;screenWidth=!1;repeat=!1;disabled=!1;forcePress=!1;forceDoubleClick=!1;onRelease=!1;fastShift=!1;dragMove=new t.bkB;dragEnd=new t.bkB;dragCancel=new t.bkB;singleClick=new t.bkB;doubleClick=new t.bkB;timeout=null;relativeValue=-1;value=-1;repeats=-1;down=!1;clicks=0;startX=0;startY=0;move=!1;fast=!1;fastOffset=0;lastX=0;isDragElement=!1;constructor(e,a){this.elementRef=e,this.service=a,this.value=-1,this.elementRef.nativeElement.style["touch-action"]="pan-y",this.isDragElement=e.nativeElement.hasAttribute("cdkdrag")||e.nativeElement.hasAttribute("cdkdraghandle")||e.nativeElement.classList.contains("cdk-drag")||e.nativeElement.classList.contains("cdk-drag-handle")||e.nativeElement.classList.contains("cdk-drag-preview")||e.nativeElement.classList.contains("cdk-drag-placeholder")}ngOnInit(){this.service.register(this)}ngOnDestroy(){this.service.unregister(this)}pointerdown(e){"mouse"===e.pointerType&&0!==e.button||(this.down=!0,this.startX=e.clientX,this.startY=e.clientY,this.move||!this.repeat||this.doubleClick.observed?(this.forcePress||m.f.settings.pressDoubleClick&&!this.forceDoubleClick&&this.doubleClick.observed&&!this.move&&"touch"===e.pointerType)&&(this.timeout=setTimeout(()=>{("mouse"===e.pointerType||!this.onRelease)&&this.doubleClick.emit(e),this.timeout=null,this.clicks=2},550)):(this.repeats=-1,this.repeatTimeout(e)))}pointermove(e){if(this.down){const n=e.clientY;!this.move&&Math.max(Math.abs(this.startX-e.clientX),Math.abs(this.startY-n))>7?this.panstart(e):this.move&&this.panmove(e)}}pointerup(e){this.down&&(this.down=!1,this.startX=0,this.startY=0,this.service.currentPinchZoom?(this.clicks=0,this.timeout&&(clearTimeout(this.timeout),this.timeout=null)):this.move?this.clicks=0:this.forcePress||"mouse"!==e.pointerType&&m.f.settings.pressDoubleClick&&!this.forceDoubleClick?"touch"===e.pointerType&&this.onRelease&&2==this.clicks?(this.doubleClick.emit(e),this.clicks=0):(this.clicks<2&&(!this.repeat||this.doubleClick.observed)&&this.singleClick.emit(e),this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.clicks=0):(this.clicks++,this.timeout&&(clearTimeout(this.timeout),this.timeout=null),2==this.clicks&&this.doubleClick.observed?(this.doubleClick.emit(e),this.clicks=0):this.timeout=setTimeout(()=>{this.clicks>0&&(!this.repeat||this.doubleClick.observed)&&this.singleClick.emit(e),this.clicks=0,this.timeout=null},this.doubleClick.observed?250:0)),this.panend(e))}panstart(e){!this.disabled&&m.f.settings.dragValues&&(this.dragMove.observed||this.dragEnd.observed)&&this.elementRef.nativeElement.classList.add("dragging"),this.move=!0,this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}panmove(e){if(!this.disabled&&m.f.settings.dragValues&&(this.dragMove.observed||this.dragEnd.observed)){const a=this.elementRef.nativeElement.getBoundingClientRect(),n=e.clientX;this.screenWidth?document.body.clientWidth>1200?this.value=Math.min(99,Math.max(0,n*(1200/document.body.clientWidth)/document.body.clientWidth*100)):(this.value=Math.min(99,Math.max(0,n/document.body.clientWidth*100)),this.relative&&(this.value=.4*this.value)):this.value=Math.min(99,Math.max(0,(n-a.left)/a.width*100)),this.relative&&-1==this.relativeValue&&(this.relativeValue=this.value),this.fast&&(this.fastOffset+=n-this.lastX<0?-1:1),this.value=Math.floor(this.relative?this.value-this.relativeValue:this.value)+this.fastOffset,this.lastX=n,this.dragMove.emit(this.value)}}panend(e){!this.disabled&&m.f.settings.dragValues&&(this.dragMove.observed||this.dragEnd.observed)&&(this.value>=0||this.relative)&&this.dragEnd.emit(this.value),this.reset()}cancel(){this.down=!1,this.clicks=0,this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.dragCancel.emit(this.value),this.reset()}reset(){this.repeats=-1,this.startX=-1,this.startY=-1,this.move=!1,this.value=-1,this.relativeValue=-1,this.fast=!1,this.fastOffset=0,this.elementRef.nativeElement.classList.remove("dragging")}repeatTimeout(e){this.down&&!this.move&&(this.singleClick.emit(e),-1==this.repeats?this.repeats=500:(this.repeats-=25,this.repeats<25&&(this.repeats=25)),this.timeout=setTimeout(()=>{this.repeatTimeout(e)},this.repeats))}static \u0275fac=function(a){return new(a||i)(t.rXU(t.aKT),t.rXU(Oo))};static \u0275dir=t.FsC({type:i,selectors:[["ghs-pointer-input"],["","ghs-pointer-input",""]],inputs:{clickBehind:"clickBehind",relative:"relative",screenWidth:"screenWidth",repeat:"repeat",disabled:"disabled",forcePress:"forcePress",forceDoubleClick:"forceDoubleClick",onRelease:"onRelease",fastShift:"fastShift"},outputs:{dragMove:"dragMove",dragEnd:"dragEnd",dragCancel:"dragCancel",singleClick:"singleClick",doubleClick:"doubleClick"},standalone:!1})}return i})();const fg=["ghs-setting-menu",""],gi=i=>({disabled:i}),pn=i=>({checked:i});function Cg(i,r){1&i&&t.nrm(0,"img",6)}function Mg(i,r){if(1&i&&t.nrm(0,"div",5),2&i){const e=t.XpG(2);t.Y8G("ghs-label",e.additionalHint)}}function vg(i,r){if(1&i&&(t.j41(0,"span",11),t.nrm(1,"input",12)(2,"span",5),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.Y8G("checked",!e.startsWith("!"))("ngClass",t.eq3(3,pn,!e.startsWith("!"))),t.R7$(),t.Y8G("ghs-label","settings."+e.replace("!",""))}}function Og(i,r){if(1&i&&(t.j41(0,"div",9),t.nrm(1,"span",10),t.Z7z(2,vg,3,5,"span",11,t.fX1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","settings.requires"),t.R7$(),t.Dyx(e.requires)}}function Pg(i,r){if(1&i&&(t.j41(0,"span",11),t.nrm(1,"input",12)(2,"span",5),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.Y8G("checked",!e.startsWith("!"))("ngClass",t.eq3(3,pn,!e.startsWith("!"))),t.R7$(),t.Y8G("ghs-label","settings."+e.replace("!",""))}}function bg(i,r){if(1&i&&(t.j41(0,"div",9),t.nrm(1,"span",10),t.Z7z(2,Pg,3,5,"span",11,t.fX1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","settings.requiresOne"),t.R7$(),t.Dyx(e.requiresOne)}}function kg(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",2)(1,"label",3)(2,"input",4),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.settingsManager.toggle(n.setting))}),t.k0s(),t.nrm(3,"span",5),t.k0s(),t.nVh(4,Cg,1,0,"img",6),t.j41(5,"span",7)(6,"div",8),t.nrm(7,"span",5)(8,"br"),t.nVh(9,Mg,1,1,"div",5),t.nVh(10,Og,4,1,"div",9),t.nVh(11,bg,4,1,"div",9),t.k0s()()()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(8,gi,e.disabled||e.isDisabled)),t.R7$(),t.Y8G("checked",!e.disabled&&!e.isDisabled&&e.settingsManager.settings[e.setting]||e.checked),t.R7$(),t.Y8G("ghs-label","settings."+e.setting+(e.suffix?"."+e.suffix:"")),t.R7$(),t.vxM(e.hint?4:-1),t.R7$(3),t.Y8G("ghs-label","settings."+e.setting+(e.suffix?"."+e.suffix:"")+".hint"),t.R7$(2),t.vxM(e.additionalHint?9:-1),t.R7$(),t.vxM(e.requires.length?10:-1),t.R7$(),t.vxM(e.requiresOne.length?11:-1)}}function yg(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",13)(1,"label",3)(2,"input",4),t.bIt("change",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.settingsManager.set(o.setting,n))}),t.k0s(),t.nrm(3,"span",5),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(3,gi,a.settingsManager.settings[a.setting]==e||a.disabled||a.isDisabled)),t.R7$(),t.Y8G("checked",a.settingsManager.settings[a.setting]==e),t.R7$(),t.Y8G("ghs-label","settings."+a.setting+(a.suffix?"."+a.suffix:"")+"."+e)}}function xg(i,r){if(1&i&&t.Z7z(0,yg,4,5,"div",13,t.fX1),2&i){const e=t.XpG();t.Dyx(e.values)}}function Eg(i,r){1&i&&t.nrm(0,"img",16)}function wg(i,r){if(1&i&&t.nrm(0,"div",5),2&i){const e=t.XpG(2);t.Y8G("ghs-label",e.additionalHint)}}function Rg(i,r){if(1&i&&(t.j41(0,"span",11),t.nrm(1,"span",5)(2,"span",17),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.Y8G("ghs-label","settings."+e.replace("!","")),t.R7$(),t.Y8G("ngClass",t.eq3(2,pn,!e.startsWith("!")))}}function jg(i,r){if(1&i&&(t.j41(0,"div",9),t.nrm(1,"span",10),t.Z7z(2,Rg,3,4,"span",11,t.fX1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","settings.requires"),t.R7$(),t.Dyx(e.requires)}}function Gg(i,r){if(1&i&&(t.j41(0,"span",11),t.nrm(1,"span",5)(2,"span",17),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.Y8G("ghs-label","settings."+e.replace("!","")),t.R7$(),t.Y8G("ngClass",t.eq3(2,pn,!e.startsWith("!")))}}function Tg(i,r){if(1&i&&(t.j41(0,"div",9),t.nrm(1,"span",10),t.Z7z(2,Gg,3,4,"span",11,t.fX1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","settings.requiresOne"),t.R7$(),t.Dyx(e.requiresOne)}}function Sg(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",2)(1,"label",14),t.nrm(2,"span",5),t.j41(3,"input",15,0),t.bIt("keyup",function(){return t.eBV(e),t.Njj(0)})("change",function(){t.eBV(e);const n=t.sdS(4),o=t.XpG();return t.Njj(o.settingsManager.set(o.setting,+n.value))}),t.k0s()(),t.nVh(5,Eg,1,0,"img",16),t.j41(6,"div",7)(7,"div",8),t.nrm(8,"span",5)(9,"br"),t.nVh(10,wg,1,1,"div",5),t.nVh(11,jg,4,1,"div",9),t.nVh(12,Tg,4,1,"div",9),t.k0s()()()}if(2&i){const e=t.sdS(4),a=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(13,gi,a.disabled||a.isDisabled)),t.R7$(),t.Y8G("ghs-label","settings."+a.setting+(a.suffix?"."+a.suffix:"")),t.R7$(),t.Y8G("value",a.settingsManager.get(a.setting))("min",a.min)("max",a.max)("size",e.value.length)("ghs-label","settings."+a.setting+(a.suffix?"."+a.suffix:""))("ghs-label-attribute","placeholder"),t.R7$(2),t.vxM(a.hint?5:-1),t.R7$(3),t.Y8G("ghs-label","settings."+a.setting+(a.suffix?"."+a.suffix:"")+".hint"),t.R7$(2),t.vxM(a.additionalHint?10:-1),t.R7$(),t.vxM(a.requires.length?11:-1),t.R7$(),t.vxM(a.requiresOne.length?12:-1)}}function $g(i,r){if(1&i&&t.nrm(0,"div",5),2&i){const e=t.XpG(2);t.Y8G("ghs-label",e.additionalHint)}}function Dg(i,r){if(1&i&&(t.j41(0,"span",11),t.nrm(1,"span",5)(2,"span",17),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.Y8G("ghs-label","settings."+e.replace("!","")),t.R7$(),t.Y8G("ngClass",t.eq3(2,pn,!e.startsWith("!")))}}function Ig(i,r){if(1&i&&(t.j41(0,"div",9),t.nrm(1,"span",10),t.Z7z(2,Dg,3,4,"span",11,t.fX1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","settings.requires"),t.R7$(),t.Dyx(e.requires)}}function Ag(i,r){if(1&i&&(t.j41(0,"span",11),t.nrm(1,"span",5)(2,"span",17),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.Y8G("ghs-label","settings."+e.replace("!","")),t.R7$(),t.Y8G("ngClass",t.eq3(2,pn,!e.startsWith("!")))}}function Vg(i,r){if(1&i&&(t.j41(0,"div",9),t.nrm(1,"span",10),t.Z7z(2,Ag,3,4,"span",11,t.fX1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","settings.requiresOne"),t.R7$(),t.Dyx(e.requiresOne)}}function Fg(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",2)(1,"label",3)(2,"span",18),t.bIt("doubleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.settingsManager.set(n.setting,n.default))}),t.k0s(),t.j41(3,"input",19,1),t.bIt("change",function(){t.eBV(e);const n=t.sdS(4),o=t.XpG();return t.Njj(o.settingsManager.set(o.setting,+n.value))})("input",function(){t.eBV(e);const n=t.sdS(4),o=t.XpG();return t.Njj(o.settingsManager.apply(o.setting,+n.value))}),t.k0s()(),t.nrm(5,"img",6),t.j41(6,"span",7)(7,"div",8),t.nrm(8,"span",5)(9,"br"),t.nVh(10,$g,1,1,"div",5),t.nVh(11,Ig,4,1,"div",9),t.nVh(12,Vg,4,1,"div",9),t.k0s()()()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(10,gi,e.disabled||e.isDisabled)),t.R7$(),t.Y8G("ghs-label","settings."+e.setting+(e.suffix?"."+e.suffix:"")),t.R7$(),t.Y8G("min",e.min)("step",e.step)("max",e.max)("value",e.settingsManager.get(e.setting)),t.R7$(5),t.Y8G("ghs-label","settings."+e.setting+(e.suffix?"."+e.suffix:"")+".hint"),t.R7$(2),t.vxM(e.additionalHint?10:-1),t.R7$(),t.vxM(e.requires.length?11:-1),t.R7$(),t.vxM(e.requiresOne.length?12:-1)}}const Xg=["ghs-setting-title-menu",""];function Bg(i,r){1&i&&t.nrm(0,"img",2)}function Yg(i,r){if(1&i&&(t.j41(0,"div",1),t.nVh(1,Bg,1,0,"img",2),t.j41(2,"span",3),t.nrm(3,"span",4),t.k0s()()),2&i){const e=t.XpG();t.R7$(),t.vxM(e.settingsManager.settings.serverSettings?1:-1),t.R7$(2),t.Y8G("ghs-label","settings.synced")}}const Po=':host{position:relative;z-index:9999}.hint-container .hint .text{white-space:break-spaces}.back{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back .ghs-svg{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back:hover .ghs-svg{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled{pointer-events:none}.back.disabled .ghs-svg{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container{z-index:1}.menu-container{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container .separator{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column .separator,.menu-container.two-column .span{grid-column:2 span}.menu-container .columns{display:flex}.menu-container .columns .column{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container .columns .column.no-grow{flex-grow:0}.menu-container .line{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container .line.hidden{display:none}.menu-container .line p{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container .line p a{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container .line .ghs-svg{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container .line button{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container .line .hint-container{width:100%}.menu-container .line .hint-container.inline{width:initial;margin-right:1em}.menu-container .line .input-container{flex-wrap:nowrap}.menu-container .line .input-container input,.menu-container .line .input-container select{flex-basis:0;flex-grow:1}.menu-container .line a,.menu-container .line label,.menu-container .line button{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container .line a:hover,.menu-container .line label:hover,.menu-container .line button:hover{color:var(--ghs-color-white)}.menu-container .line a img.icon,.menu-container .line label img.icon,.menu-container .line button img.icon{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container .line a img.icon.spoiler,.menu-container .line label img.icon.spoiler,.menu-container .line button img.icon.spoiler{filter:brightness(0) var(--ghs-filter-gray)}.menu-container .line a.disabled,.menu-container .line label.disabled,.menu-container .line button.disabled{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container .line a.disabled input,.menu-container .line label.disabled input,.menu-container .line button.disabled input{filter:grayscale(1)}.menu-container .line a.confirm,.menu-container .line label.confirm,.menu-container .line button.confirm{color:var(--ghs-color-yellow)}.menu-container .line a.confirm-delete,.menu-container .line label.confirm-delete,.menu-container .line button.confirm-delete{color:var(--ghs-color-red)}.menu-container .line a~input,.menu-container .line a~select,.menu-container .line label~input,.menu-container .line label~select,.menu-container .line button~input,.menu-container .line button~select{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container .line>a{text-decoration:none}.menu-container .line.state-container{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container .line.state-container .state{display:flex;flex-direction:column}.menu-container .line.state-container .state.undo{align-items:flex-start}.menu-container .line.state-container .state.undo .undo-text{display:flex;align-items:center}.menu-container .line.state-container .state.redo{align-items:flex-end}.menu-container .line.state-container .state .info{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container .line.state-container .state.disabled .info{color:var(--ghs-color-disabled)}.menu-container .line.state-container .warning{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container .line.state-container .warning img{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container .line.state-container .warning:hover{opacity:.7}.menu-container .line.state-container .undo-dialog{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container .line.state-container .undo-dialog img.ghs-svg{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container .line.state-container .undo-dialog:hover{cursor:pointer}.menu-container .line.state-container .undo-dialog:hover img.ghs-svg{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container .line.state-container .undo-dialog.disabled img.ghs-svg{filter:var(--ghs-filter-darkgray)!important}.menu-container .line.title{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container .line.title a,.menu-container .line.title label{cursor:initial;color:var(--ghs-color-disabled)}.menu-container .line.title.hide-title{border-bottom:none;margin-bottom:0}.menu-container .line.title.hide-title label{display:none}.menu-container .line.sticky{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container .line.sticky.fh{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container .line.sticky.modern{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container .disabled{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container .disabled a,.menu-container .disabled label,.menu-container .disabled input[type=checkbox],.menu-container .disabled input[type=radio]{color:var(--ghs-color-disabled)}.menu-container .disabled input[type=checkbox]:before,.menu-container .disabled input[type=radio]:before{background-color:var(--ghs-color-disabled)!important}.menu-container .denied a,.menu-container .denied label{color:var(--ghs-color-disabled)}.menu-container .objective-marker{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container .spoilers>.spoiler{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container .spoilers>.spoiler .add{display:none}.menu-container .spoilers>.spoiler:hover .name{display:none}.menu-container .spoilers>.spoiler:hover .add{display:inherit}.menu-container .spoilers>.spoiler~.spoiler{margin-top:0;border-top:none}.menu-container .input-button{display:flex;cursor:pointer}.menu-container .input-button .add-button:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container .input-button .add-button:hover:after{background-color:var(--ghs-color-white)}.menu-container .input-button .add-button.disabled{pointer-events:none;cursor:not-allowed}.menu-container .input-button .add-button.disabled:after{background-color:var(--ghs-color-disabled)}.menu-container select{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container select option{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column .span-xs{grid-column:2 span}.menu-container .columns.columns-break{flex-wrap:wrap}}\n',bo="@media (max-width: 600px),(orientation: portrait){.menu-container.two-column{display:grid;grid-template-columns:auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column .separator,.menu-container.two-column .span{grid-column:1 span}}.line .condition-list{display:flex;align-items:center}.line .condition-list .hint-container{margin:calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.line .condition-list .hint-container .condition{cursor:pointer;width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));position:relative;display:flex}.line .condition-list .hint-container .condition.immunity{opacity:.7;filter:grayscale(.3)}.line .condition-list .hint-container .condition:hover{opacity:.6;filter:none}.line .condition-list .hint-container .condition img{width:100%;height:auto}.line .condition-list .hint-container .condition .value{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);position:absolute;bottom:0;left:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor));transform:translate(-50%)}.line .condition-list .hint-container .condition.disabled{filter:grayscale(.6);pointer-events:none}.line .condition-list .hint-container .hint-trigger{margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.line .condition-list .hint-container .hint.right{transform:translate(-50%)}.line.hidden{display:none}.menu-container .line .ghs-svg.sync-settings{height:2em;width:auto;filter:var(--ghs-filter-disabled) var(--ghs-filter-outline-thin-black)}.menu-container.connected .line .ghs-svg.sync-settings{filter:var(--ghs-filter-green) var(--ghs-filter-outline-thin-black)}\n";let un=(()=>{class i{elementRef;setting;checked=!1;disabled=!1;requires=[];requiresOne=[];type="checkbox";values=[];min="";max="";step=.1;default=1;hint=!0;additionalHint="";suffix="";isDisabled=!1;settingsManager=m.f;constructor(e){this.elementRef=e}ngOnInit(){"checkbox"===this.type&&this.values.length>0&&(this.type="radio"),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.isDisabled=this.requires.length>0&&this.requires.some(e=>e.startsWith("!")?m.f.get(e.replace("!","")):!m.f.get(e))||this.requiresOne.length>0&&this.requiresOne.every(e=>e.startsWith("!")?m.f.get(e.replace("!","")):!m.f.get(e))}static \u0275fac=function(a){return new(a||i)(t.rXU(t.aKT))};static \u0275cmp=t.VBU({type:i,selectors:[["","ghs-setting-menu",""]],inputs:{setting:[0,"ghs-setting-menu","setting"],checked:"checked",disabled:"disabled",requires:"requires",requiresOne:"requiresOne",type:"type",values:"values",min:"min",max:"max",step:"step",default:"default",hint:"hint",additionalHint:"additionalHint",suffix:[0,"labelSuffix","suffix"]},standalone:!1,attrs:fg,decls:4,vars:4,consts:[["numberInput",""],["rangeInput",""],[1,"hint-container"],[3,"ngClass"],["tabclick","","type","checkbox",3,"change","checked"],[3,"ghs-label"],["src","./assets/images/hint.svg",1,"hint-trigger","ghs-svg"],[1,"hint"],[1,"text"],[1,"requires"],[1,"title",3,"ghs-label"],[1,"require"],["type","checkbox",3,"checked","ngClass"],[1,"line"],[1,"label",3,"ngClass"],["tabclick","","type","number",3,"keyup","change","value","min","max","size","ghs-label","ghs-label-attribute"],["src","./assets/images/warning.svg",1,"hint-trigger","ghs-svg"],[1,"checkbox",3,"ngClass"],["ghs-pointer-input","",3,"doubleClick","ghs-label"],["tabclick","","type","range",3,"change","input","min","step","max","value"]],template:function(a,n){1&a&&(t.nVh(0,kg,12,10,"div",2),t.nVh(1,xg,2,0),t.nVh(2,Sg,13,15,"div",2),t.nVh(3,Fg,13,12,"div",2)),2&a&&(t.vxM("checkbox"==n.type?0:-1),t.R7$(),t.vxM("radio"==n.type?1:-1),t.R7$(),t.vxM("number"==n.type?2:-1),t.R7$(),t.vxM("range"==n.type?3:-1))},dependencies:[N.YU,tt,rt,At],styles:[Po,bo,".hint-container label{cursor:pointer;display:flex;align-items:center}.hint-container .requires{font-family:var(--ghs-normal);font-size:.9em;display:flex;flex-direction:column;margin-top:1em}.hint-container .requires .title{margin-bottom:.3em}.hint-container .requires .require{display:flex;align-items:center}.hint-container .requires .require input[type=checkbox]{width:1.5em;height:1.5em;border-width:.1em;border-style:solid;display:grid;place-content:center;margin-right:.5em}\n"],encapsulation:2})}return i})(),Ng=(()=>{class i{settingsManager=m.f;setting;sync=!1;static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["","ghs-setting-title-menu",""]],inputs:{setting:[0,"ghs-setting-title-menu","setting"],sync:"sync"},standalone:!1,attrs:Xg,decls:3,vars:2,consts:[[3,"ghs-label"],[1,"hint-container"],["src","./assets/images/sync-settings.svg",1,"hint-trigger","ghs-svg","sync-settings"],[1,"hint"],[1,"text",3,"ghs-label"]],template:function(a,n){1&a&&(t.j41(0,"label"),t.nrm(1,"span",0),t.k0s(),t.nVh(2,Yg,4,2,"div",1)),2&a&&(t.R7$(),t.Y8G("ghs-label","settings."+n.setting),t.R7$(),t.vxM(n.sync?2:-1))},dependencies:[tt],styles:[Po,bo],encapsulation:2})}return i})();const zg=i=>({active:i}),Lg=i=>({disabled:i});function Ug(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",3),t.nrm(1,"p",2),t.j41(2,"div",6)(3,"a",7),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.ignoreError())}),t.nrm(4,"span",2),t.k0s(),t.nrm(5,"div",8),t.k0s()()}2&i&&(t.R7$(),t.Y8G("ghs-label","tools.feedback.reportIssue.errorHint"),t.R7$(3),t.Y8G("ghs-label","tools.feedback.reportIssue.errorIgnore"))}function qg(i,r){if(1&i&&(t.j41(0,"option",10),t.nrm(1,"span",2),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ghs-label","tools.feedback.reportIssue.type."+e)}}function Hg(i,r){if(1&i){const e=t.RV6();t.j41(0,"textarea",17),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2);return t.DH7(o.automaticText,n)||(o.automaticText=n),t.Njj(n)}),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("disabled",!0),t.R50("ngModel",e.automaticText)}}function Kg(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",4)(1,"label"),t.nrm(2,"span",2),t.k0s(),t.j41(3,"select",9),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.issueType,n)||(o.issueType=n),t.Njj(n)}),t.Z7z(4,qg,2,2,"option",10,t.fX1),t.k0s(),t.nrm(6,"p",11)(7,"p",11)(8,"label",2),t.j41(9,"textarea",9),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.issuerText,n)||(o.issuerText=n),t.Njj(n)}),t.k0s(),t.j41(10,"p",3),t.EFF(11,"Please write in English or German / Bitte in Englisch oder Deutsch verfassen!"),t.k0s(),t.nrm(12,"label",2),t.nVh(13,Hg,1,2,"textarea",12),t.j41(14,"div",13)(15,"a",14),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.downloadDataDump())}),t.nrm(16,"span",2),t.k0s(),t.j41(17,"a",15),t.nrm(18,"span",2),t.k0s()(),t.nrm(19,"p",16),t.k0s()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","tools.feedback.reportIssue.type"),t.R7$(),t.R50("ngModel",e.issueType),t.R7$(),t.Dyx(e.issueTypes),t.R7$(2),t.Y8G("ghs-label","tools.feedback.reportIssue.type."+e.issueType+".hint"),t.R7$(),t.Y8G("ghs-label","tools.feedback.reportIssue.specify"),t.R7$(),t.Y8G("ghs-label","tools.feedback.reportIssue.text"),t.R7$(),t.R50("ngModel",e.issuerText),t.R7$(3),t.Y8G("ghs-label","tools.feedback.reportIssue.automaticText"),t.R7$(),t.vxM(e.automaticText?13:-1),t.R7$(3),t.Y8G("ghs-label","tools.feedback.reportIssue.download"),t.R7$(),t.Y8G("ngClass",t.eq3(13,Lg,!e.issuerText&&!e.automaticText))("href",e.issueMail(e.issueType,e.issuerText),t.B4B),t.R7$(),t.Y8G("ghs-label","tools.feedback.reportIssue.send"),t.R7$(),t.Y8G("ghs-label","tools.feedback.reportIssue.mail")}}let ko=(()=>{class i{error;dialogRef;gameManager=s.E;issueTypes=["abilityCard","monsterStat","characterStat","artwork","software","feedback"];form="issue";issueType="abilityCard";issuerText="";automaticText="";constructor(e,a){this.error=e,this.dialogRef=a,e&&(this.automaticText=m.f.getLabel("tools.feedback.reportIssue.errorText",[e.message,e.stack||""]),this.issueTypes.push("automatic"),this.issueType="automatic")}scenarioMail(e,a,n){let o="mailto:scenario@gloomhaven-secretariat.de",g=new Vn.tB;return g.name=e,g.index=a,g.monsters=s.E.game.figures.filter(_=>_ instanceof P.R).map(_=>_.name),g.allies=s.E.game.figures.filter(_=>_ instanceof P.R&&_.isAlly).map(_=>_.name),g.allied=s.E.game.figures.filter(_=>_ instanceof P.R&&_.isAllied).map(_=>_.name),g.drawExtra=s.E.game.figures.filter(_=>_ instanceof P.R&&_.drawExtra).map(_=>_.name),g.objectives=s.E.game.figures.filter(_=>_ instanceof mt.$e).map(_=>{if(_.objectiveId){const B=s.E.objectiveManager.objectiveDataByObjectiveIdentifier(_.objectiveId);if(B)return B}return new Co(_.name,_.health,_.escort,-1,_.marker,[],_.initiative)}),g.rooms=s.E.game.scenario?.rooms||[],g.marker=s.E.game.scenario?.marker||"",g.rules=s.E.game.scenario?.rules||[],g.edition=s.E.game.scenario?.edition||s.E.currentEdition(),o+="?subject=Submit Scenario #"+g.index+" "+g.name+" ("+m.f.getLabel("data.edition."+g.edition)+")",o+="&body="+n+"%0D%0A%0D%0AJSON:%0D%0A"+JSON.stringify(g,void 0,2),o}issueMail(e,a){let n="mailto:issue@gloomhaven-secretariat.de";return"feedback"==e&&(n="mailto:feedback@gloomhaven-secretariat.de"),n+="?subject=[GHS v0.133.0] "+m.f.getLabel("tools.feedback.reportIssue.type."+e+".subject"),this.automaticText&&(a+=(a?"\n\n":"")+this.automaticText),n+="&body="+m.f.getLabel("tools.feedback.reportIssue.type."+e+".hint")+"%0D%0A%0D%0A"+a.replaceAll("\n","%0D%0A"),n}downloadDataDump(){return(0,X.A)(function*(){try{let e=yield w.n.datadump(),a=document.createElement("a");a.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e))),a.setAttribute("download","ghs-data-dump.json"),document.body.appendChild(a),a.click(),document.body.removeChild(a)}catch{console.warn("Could not read datadump")}})()}ignoreError(){if(this.error){const e=this.error.message+(this.error.stack?this.error.stack.split("\n")[0]:"");m.f.settings.feedbackErrorsIgnore=m.f.settings.feedbackErrorsIgnore||[],-1==m.f.settings.feedbackErrorsIgnore.indexOf(e)&&(m.f.settings.feedbackErrorsIgnore.push(e),m.f.storeSettings(),(0,V.co)(this.dialogRef))}}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-feedback-dialog"]],standalone:!1,decls:7,vars:7,consts:[[1,"feedback-dialog","scroll-container"],[3,"click","ngClass"],[3,"ghs-label"],[1,"hint"],[1,"form","issue-form"],["href","https://github.com/Lurkars/gloomhavensecretariat/issues/new/choose","target","_blank"],[1,"settings"],[3,"click"],["ghs-setting-menu","feedbackErrors"],[3,"ngModelChange","ngModel"],[3,"value"],[1,"hint",3,"ghs-label"],[3,"disabled","ngModel"],[1,"buttons"],[1,"button",3,"click"],[1,"button",3,"ngClass","href"],[1,"warning",3,"ghs-label"],[3,"ngModelChange","disabled","ngModel"]],template:function(a,n){1&a&&(t.j41(0,"span",0)(1,"a",1),t.bIt("click",function(){return n.form="issue"}),t.nrm(2,"span",2),t.k0s(),t.nVh(3,Ug,6,2,"div",3),t.nVh(4,Kg,20,15,"div",4),t.j41(5,"a",5),t.nrm(6,"span",2),t.k0s()()),2&a&&(t.R7$(),t.Y8G("ngClass",t.eq3(5,zg,"issue"==n.form)),t.R7$(),t.Y8G("ghs-label","tools.feedback.reportIssue"),t.R7$(),t.vxM(n.automaticText?3:-1),t.R7$(),t.vxM("issue"==n.form?4:-1),t.R7$(2),t.Y8G("ghs-label","tools.feedback.githubIssue"))},dependencies:[N.YU,O.xH,O.y7,O.me,O.wz,O.BC,O.vS,tt,un],styles:[".feedback-dialog[_ngcontent-%COMP%]{font-size:150%;display:flex;flex-direction:column;padding:.5em}.feedback-dialog[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;text-decoration:underline}.feedback-dialog[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{color:var(--ghs-color-white);font-weight:700;pointer-events:none;text-decoration:none}.feedback-dialog[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:.9em;color:var(--ghs-color-yellow)}.feedback-dialog[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;font-size:.9em;color:var(--ghs-color-gray)}.feedback-dialog[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;align-items:center;justify-items:start;column-gap:.5em;row-gap:.5em}.feedback-dialog[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-gray);display:flex}.feedback-dialog[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{grid-column:2;padding:0;margin:0;font-family:var(--ghs-font-text);font-size:.7em;color:var(--ghs-color-gray);opacity:.9}.feedback-dialog[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{grid-column:2;padding:0;margin:0;font-family:var(--ghs-font-text);font-size:.9em;color:var(--ghs-color-yellow);width:calc(var(--ghs-unit) * 65 * var(--ghs-dialog-factor))}.feedback-dialog[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 65 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 20 * var(--ghs-dialog-factor));max-width:60vw}.feedback-dialog[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{cursor:pointer;grid-column:span 2;place-self:end;padding:.3em .7em;border-radius:.5em;background-color:var(--ghs-color-darkgray);color:var(--ghs-color-white);text-decoration:none;font-family:var(--ghs-font-title)}.feedback-dialog[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{opacity:.8}.feedback-dialog[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray);opacity:.8}.feedback-dialog[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;grid-column:span 2;place-self:end}.feedback-dialog[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{margin:0 .5em}"]})}return i})(),yo=(()=>{class i{settinsManager=m.f;static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-keyboard-shortcuts-dialog"]],standalone:!1,decls:345,vars:0,consts:[[1,"scroll-container"],["ghs-label","tools.keyboard"],["ghs-label","tools.keyboard.global"],["ghs-setting-menu","keyboardShortcuts",1,"line"],["ghs-label","tools.keyboard.ctrl"],["ghs-label","tools.keyboard.undo"],["ghs-label","tools.keyboard.shift"],["ghs-label","tools.keyboard.redo"],["ghs-label","tools.keyboard.esc"],["ghs-label","tools.keyboard.mainMenu"],["ghs-label","tools.keyboard.zoomIn"],["ghs-label","tools.keyboard.zoomOut"],["ghs-label","tools.keyboard.zoomReset"],["ghs-label","tools.keyboard.toggleFullscreen"],["ghs-label","tools.keyboard.tab"],["ghs-label","tools.keyboard.toggelTab"],["ghs-label","tools.keyboard.round"],["ghs-label","tools.keyboard.am"],["ghs-label","tools.keyboard.amAdvantage"],["ghs-label","tools.keyboard.amDisadvantage"],["ghs-label","tools.keyboard.loot"],["ghs-label","tools.keyboard.activeCharacter.lootInc"],["ghs-label","tools.keyboard.activeCharacter.lootDec"],["ghs-label","tools.keyboard.toggleElements"],["ghs-label","tools.keyboard.toggleAbsent"],["ghs-label","tools.keyboard.select"],["ghs-label","tools.keyboard.selectNatural"],["ghs-label","tools.keyboard.difficulty"],["ghs-label","tools.keyboard.alt"],["ghs-label","tools.keyboard.activeCharacter.xpInc"],["ghs-label","tools.keyboard.activeCharacter.xpDec"],["ghs-label","tools.keyboard.events"],["ghs-label","tools.keyboard.finish"],["ghs-label","tools.keyboard.party"],["ghs-label","tools.keyboard.globalMap"],["ghs-label","tools.keyboard.scenarioChart"],["ghs-label","tools.keyboard.toggleHandSize"],["ghs-label","tools.keyboard.toggleTraits"],["ghs-label","tools.keyboard.toggleDamageHP"],["ghs-label","tools.keyboard.togglePlayerNumber"],["ghs-label","tools.keyboard.keyboard"],["ghs-label","tools.keyboard.entityMenu"],["ghs-label","tools.keyboard.entityMenu.hpInc"],["ghs-label","tools.keyboard.entityMenu.hpDec"],["ghs-label","tools.keyboard.entityMenu.toggleCondition"],["ghs-label","tools.keyboard.entityMenu.xpInc"],["ghs-label","tools.keyboard.entityMenu.xpDec"],["ghs-label","tools.keyboard.entityMenu.lootInc"],["ghs-label","tools.keyboard.entityMenu.lootDec"],["ghs-label","tools.keyboard.entityMenu.blessInc"],["ghs-label","tools.keyboard.entityMenu.blessDec"],["ghs-label","tools.keyboard.entityMenu.curseInc"],["ghs-label","tools.keyboard.entityMenu.curseDec"],["ghs-label","tools.keyboard.entityMenu.kill"],["ghs-label","tools.keyboard.entityMenu.maxHpInc"],["ghs-label","tools.keyboard.entityMenu.maxHpDec"],["ghs-label","tools.keyboard.entityMenu.characterSheet"],["ghs-label","tools.keyboard.entityMenu.toggleAbsent"],["ghs-label","tools.keyboard.mainMenu.open"],["ghs-label","tools.keyboard.enter"],["ghs-label","tools.keyboard.space"],["ghs-label","tools.keyboard.mainMenu.confirm"],["ghs-label","tools.keyboard.mainMenu.decline"],["ghs-label","tools.keyboard.mainMenu.select"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nrm(1,"h1",1)(2,"p",2)(3,"div",3),t.j41(4,"ul")(5,"li")(6,"kbd"),t.nrm(7,"span",4),t.k0s(),t.EFF(8," + "),t.j41(9,"kbd")(10,"span"),t.EFF(11,"z"),t.k0s()(),t.nrm(12,"span",5),t.k0s(),t.j41(13,"li")(14,"kbd"),t.nrm(15,"span",4),t.k0s(),t.EFF(16," + "),t.j41(17,"kbd")(18,"span"),t.EFF(19,"y"),t.k0s()(),t.EFF(20,"\xa0|\xa0"),t.j41(21,"kbd"),t.nrm(22,"span",4),t.k0s(),t.EFF(23," + "),t.j41(24,"kbd"),t.nrm(25,"span",6),t.k0s(),t.EFF(26," + "),t.j41(27,"kbd")(28,"span"),t.EFF(29,"Z"),t.k0s()(),t.nrm(30,"span",7),t.k0s(),t.j41(31,"li")(32,"kbd"),t.nrm(33,"span",8),t.k0s(),t.nrm(34,"span",9),t.k0s(),t.j41(35,"li")(36,"kbd")(37,"span"),t.EFF(38,"\u2191"),t.k0s()(),t.EFF(39,"\xa0|\xa0"),t.j41(40,"kbd")(41,"span"),t.EFF(42,"+"),t.k0s()(),t.nrm(43,"span",10),t.k0s(),t.j41(44,"li")(45,"kbd")(46,"span"),t.EFF(47,"\u2193"),t.k0s()(),t.EFF(48,"\xa0|\xa0"),t.j41(49,"kbd")(50,"span"),t.EFF(51,"-"),t.k0s()(),t.nrm(52,"span",11),t.k0s(),t.j41(53,"li")(54,"kbd"),t.nrm(55,"span",4),t.k0s(),t.EFF(56," + "),t.j41(57,"kbd")(58,"span"),t.EFF(59,"r"),t.k0s()(),t.nrm(60,"span",12),t.k0s(),t.j41(61,"li")(62,"kbd")(63,"span"),t.EFF(64,"f"),t.k0s()(),t.nrm(65,"span",13),t.k0s(),t.j41(66,"li")(67,"kbd"),t.nrm(68,"span",14),t.k0s(),t.nrm(69,"span",15),t.k0s(),t.j41(70,"li")(71,"kbd")(72,"span"),t.EFF(73,"n"),t.k0s()(),t.nrm(74,"span",16),t.k0s(),t.j41(75,"li")(76,"kbd")(77,"span"),t.EFF(78,"m"),t.k0s()(),t.nrm(79,"span",17),t.k0s(),t.j41(80,"li")(81,"kbd")(82,"span"),t.EFF(83,"a"),t.k0s()(),t.nrm(84,"span",18),t.k0s(),t.j41(85,"li")(86,"kbd")(87,"span"),t.EFF(88,"d"),t.k0s()(),t.nrm(89,"span",19),t.k0s(),t.j41(90,"li")(91,"kbd")(92,"span"),t.EFF(93,"l"),t.k0s()(),t.nrm(94,"span",20),t.EFF(95,"\xa0|\xa0"),t.nrm(96,"span",21),t.k0s(),t.j41(97,"li")(98,"kbd"),t.nrm(99,"span",6),t.k0s(),t.EFF(100,"\xa0+\xa0"),t.j41(101,"kbd")(102,"span"),t.EFF(103,"X"),t.k0s()(),t.nrm(104,"span",22),t.k0s(),t.j41(105,"li")(106,"kbd")(107,"span"),t.EFF(108,"1"),t.k0s()(),t.EFF(109,"-"),t.j41(110,"kbd")(111,"span"),t.EFF(112,"6"),t.k0s()(),t.nrm(113,"span",23),t.k0s(),t.j41(114,"li")(115,"kbd")(116,"span"),t.EFF(117,"h"),t.k0s()(),t.nrm(118,"span",24),t.k0s(),t.j41(119,"li")(120,"kbd")(121,"span"),t.EFF(122,"s"),t.k0s()(),t.nrm(123,"span",25),t.EFF(124,"\xa0("),t.j41(125,"kbd")(126,"span"),t.EFF(127,"0"),t.k0s()(),t.EFF(128,"-"),t.j41(129,"kbd")(130,"span"),t.EFF(131,"9"),t.k0s()(),t.EFF(132,") "),t.k0s(),t.j41(133,"li")(134,"kbd")(135,"span"),t.EFF(136,"w"),t.k0s()(),t.nrm(137,"span",26),t.EFF(138,"\xa0("),t.j41(139,"kbd")(140,"span"),t.EFF(141,"0"),t.k0s()(),t.EFF(142,"-"),t.j41(143,"kbd")(144,"span"),t.EFF(145,"9"),t.k0s()(),t.EFF(146,") "),t.k0s(),t.j41(147,"li")(148,"kbd")(149,"span"),t.EFF(150,"x"),t.k0s()(),t.nrm(151,"span",27),t.k0s(),t.j41(152,"li")(153,"kbd"),t.nrm(154,"span",28),t.k0s(),t.EFF(155,"\xa0+\xa0"),t.j41(156,"kbd")(157,"span"),t.EFF(158,"x"),t.k0s()(),t.nrm(159,"span",29),t.k0s(),t.j41(160,"li")(161,"kbd"),t.nrm(162,"span",6),t.k0s(),t.EFF(163,"\xa0+\xa0"),t.j41(164,"kbd")(165,"span"),t.EFF(166,"X"),t.k0s()(),t.nrm(167,"span",30),t.k0s(),t.j41(168,"li")(169,"kbd")(170,"span"),t.EFF(171,"e"),t.k0s()(),t.nrm(172,"span",31),t.k0s(),t.j41(173,"li")(174,"kbd"),t.nrm(175,"span",6),t.k0s(),t.EFF(176," + "),t.j41(177,"kbd")(178,"span"),t.EFF(179,"f"),t.k0s()(),t.nrm(180,"span",32),t.k0s(),t.j41(181,"li")(182,"kbd")(183,"span"),t.EFF(184,"p"),t.k0s()(),t.nrm(185,"span",33),t.k0s(),t.j41(186,"li")(187,"kbd")(188,"span"),t.EFF(189,"g"),t.k0s()(),t.nrm(190,"span",34),t.k0s(),t.j41(191,"li")(192,"kbd")(193,"span"),t.EFF(194,"c"),t.k0s()(),t.nrm(195,"span",35),t.k0s(),t.j41(196,"li")(197,"kbd"),t.nrm(198,"span",6),t.k0s(),t.EFF(199,"\xa0+\xa0"),t.j41(200,"kbd")(201,"span"),t.EFF(202,"H"),t.k0s()(),t.nrm(203,"span",36),t.k0s(),t.j41(204,"li")(205,"kbd")(206,"span"),t.EFF(207,"t"),t.k0s()(),t.nrm(208,"span",37),t.k0s(),t.j41(209,"li")(210,"kbd")(211,"span"),t.EFF(212,"i"),t.k0s()(),t.nrm(213,"span",38),t.k0s(),t.j41(214,"li")(215,"kbd")(216,"span"),t.EFF(217,"#"),t.k0s()(),t.nrm(218,"span",39),t.k0s(),t.j41(219,"li")(220,"kbd")(221,"span"),t.EFF(222,"?"),t.k0s()(),t.nrm(223,"span",40),t.k0s()(),t.nrm(224,"p",41),t.j41(225,"ul")(226,"li")(227,"kbd")(228,"span"),t.EFF(229,"\u2192"),t.k0s()(),t.nrm(230,"span",42),t.k0s(),t.j41(231,"li")(232,"kbd")(233,"span"),t.EFF(234,"\u2190"),t.k0s()(),t.nrm(235,"span",43),t.k0s(),t.j41(236,"li")(237,"kbd")(238,"span"),t.EFF(239,"0"),t.k0s()(),t.EFF(240,"-"),t.j41(241,"kbd")(242,"span"),t.EFF(243,"9"),t.k0s()(),t.EFF(244,"\xa0"),t.nrm(245,"span",44),t.k0s(),t.j41(246,"li")(247,"kbd")(248,"span"),t.EFF(249,"x"),t.k0s()(),t.nrm(250,"span",45),t.k0s(),t.j41(251,"li")(252,"kbd"),t.nrm(253,"span",6),t.k0s(),t.EFF(254,"\xa0+\xa0"),t.j41(255,"kbd")(256,"span"),t.EFF(257,"X"),t.k0s()(),t.nrm(258,"span",46),t.k0s(),t.j41(259,"li")(260,"kbd")(261,"span"),t.EFF(262,"l"),t.k0s()(),t.nrm(263,"span",47),t.k0s(),t.j41(264,"li")(265,"kbd"),t.nrm(266,"span",6),t.k0s(),t.EFF(267,"\xa0+\xa0"),t.j41(268,"kbd")(269,"span"),t.EFF(270,"L"),t.k0s()(),t.nrm(271,"span",48),t.k0s(),t.j41(272,"li")(273,"kbd")(274,"span"),t.EFF(275,"b"),t.k0s()(),t.nrm(276,"span",49),t.k0s(),t.j41(277,"li")(278,"kbd"),t.nrm(279,"span",6),t.k0s(),t.EFF(280,"\xa0+\xa0"),t.j41(281,"kbd")(282,"span"),t.EFF(283,"B"),t.k0s()(),t.nrm(284,"span",50),t.k0s(),t.j41(285,"li")(286,"kbd")(287,"span"),t.EFF(288,"c"),t.k0s()(),t.nrm(289,"span",51),t.k0s(),t.j41(290,"li")(291,"kbd"),t.nrm(292,"span",6),t.k0s(),t.EFF(293,"\xa0+\xa0"),t.j41(294,"kbd")(295,"span"),t.EFF(296,"C"),t.k0s()(),t.nrm(297,"span",52),t.k0s(),t.j41(298,"li")(299,"kbd")(300,"span"),t.EFF(301,"k"),t.k0s()(),t.EFF(302,"\xa0|\xa0"),t.j41(303,"kbd")(304,"span"),t.EFF(305,"d"),t.k0s()(),t.nrm(306,"span",53),t.k0s(),t.j41(307,"li")(308,"kbd")(309,"span"),t.EFF(310,"\u2191"),t.k0s()(),t.nrm(311,"span",54),t.k0s(),t.j41(312,"li")(313,"kbd")(314,"span"),t.EFF(315,"\u2193"),t.k0s()(),t.nrm(316,"span",55),t.k0s(),t.j41(317,"li")(318,"kbd")(319,"span"),t.EFF(320,"s"),t.k0s()(),t.nrm(321,"span",56),t.k0s(),t.j41(322,"li")(323,"kbd")(324,"span"),t.EFF(325,"a"),t.k0s()(),t.nrm(326,"span",57),t.k0s()(),t.nrm(327,"p",58),t.j41(328,"ul")(329,"li")(330,"kbd"),t.nrm(331,"span",59),t.k0s(),t.EFF(332,"\xa0|\xa0"),t.j41(333,"kbd"),t.nrm(334,"span",60),t.k0s(),t.nrm(335,"span",61),t.k0s(),t.j41(336,"li")(337,"kbd"),t.nrm(338,"span",8),t.k0s(),t.nrm(339,"span",62),t.k0s(),t.j41(340,"li")(341,"kbd")(342,"span",14),t.EFF(343,"\u21b9"),t.k0s()(),t.nrm(344,"span",63),t.k0s()()())},dependencies:[tt,un],styles:[".scroll-container[_ngcontent-%COMP%]{color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}li[_ngcontent-%COMP%]{display:flex;align-items:center}li[_ngcontent-%COMP%]   kbd[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}"]})}return i})(),xo=(()=>{class i{el;active=!1;constructor(e){this.el=e}ngOnChanges(e){e.active&&e.active.currentValue&&e.active.currentValue!=e.active.previousValue&&setTimeout(()=>{this.el.nativeElement.scrollIntoView({behavior:m.f.settings.animations?"smooth":"auto",block:"center",inline:"center"})},5)}static \u0275fac=function(a){return new(a||i)(t.rXU(t.aKT))};static \u0275dir=t.FsC({type:i,selectors:[["","autoscroll",""]],inputs:{active:[0,"autoscroll","active"]},standalone:!1,features:[t.OA$]})}return i})(),Wg=(()=>{class i{el;figure;block="center";inline="center";active=!1;constructor(e){this.el=e}ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{setTimeout(()=>{m.f.settings.autoscroll&&!this.active&&this.figure.active&&this.el.nativeElement.scrollIntoView({behavior:m.f.settings.animations?"smooth":"auto",block:this.block,inline:this.inline}),this.active=this.figure.active},m.f.settings.animations?300*m.f.settings.animationSpeed:5)}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}static \u0275fac=function(a){return new(a||i)(t.rXU(t.aKT))};static \u0275dir=t.FsC({type:i,selectors:[["","figure-autoscroll",""]],inputs:{figure:[0,"figure-autoscroll","figure"],block:"block",inline:"inline"},standalone:!1})}return i})();const Eo=i=>({disabled:i}),Jg=(i,r)=>({"has-undos":i,"has-redos":r}),wo=(i,r)=>({confirm:i,disabled:r}),di=i=>[i],Ro=(i,r)=>({disabled:i,confirm:r});function Zg(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",20),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.moreRedos())}),t.nrm(1,"span",3),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","state.loadMore"))}function Qg(i,r){if(1&i&&(t.nrm(0,"span",22),t.nI1(1,"slice")),2&i){const e=t.XpG().$implicit,a=t.XpG();t.Y8G("ghs-label","state.info."+a.getRedoInfo(e)[0])("ghs-label-args",t.brH(1,3,a.getRedoInfo(e),1,a.getRedoInfo(e).length))("ghs-label-empty",!0)}}function td(i,r){if(1&i&&(t.j41(0,"span",14),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(),t.E5c("",a.gameManager.stateManager.redos[a.gameManager.stateManager.redos.length-e-1].revision," - ",a.gameManager.stateManager.redos[a.gameManager.stateManager.redos.length-e-1].revisionOffset," - ",a.gameManager.stateManager.redos[a.gameManager.stateManager.redos.length-e-1].revision-a.gameManager.stateManager.redos[a.gameManager.stateManager.redos.length-e-1].revisionOffset)}}function ed(i,r){if(1&i&&(t.j41(0,"span",23),t.nrm(1,"img",24)(2,"span",25),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(2),t.Y8G("ghs-label","state.missing")("ghs-label-args",t.eq3(2,di,a.getRedoRevision(e)-a.getRedoRevision(e-1)-1))}}function nd(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",21),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.redo(n))})("mouseleave",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.cancelConfirm())}),t.j41(1,"span",11),t.EFF(2),t.k0s(),t.nVh(3,Qg,2,7,"span",22),t.nrm(4,"span",13),t.nVh(5,td,2,3,"span",14),t.k0s(),t.nVh(6,ed,3,4,"span",23)}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.l_i(5,wo,a.undoConfirm=="redo-"+e,!a.gameManager.stateManager.redoPermission)),t.R7$(2),t.SpI("",a.getRedoRevision(e)+1,"."),t.R7$(),t.vxM(a.getRedoInfo(e).length>0?3:-1),t.R7$(2),t.vxM(a.gameManager.stateManager.redos[a.gameManager.stateManager.redos.length-e-1]?5:-1),t.R7$(),t.vxM(e>0&&a.getRedoRevision(e)-a.getRedoRevision(e-1)!=1?6:-1)}}function id(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",26),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.gameManager.stateManager.gameOffsetWarning=!1)}),t.nrm(1,"img",24)(2,"span",25),t.k0s()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","state.missing")("ghs-label-args",t.eq3(2,di,e.undoOffset))}}function ad(i,r){if(1&i&&(t.j41(0,"span",23),t.nrm(1,"img",24)(2,"span",25),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(2),t.Y8G("ghs-label","state.missing")("ghs-label-args",t.eq3(2,di,a.gameManager.game.revision-a.gameManager.game.revisionOffset-a.getUndoRevision(e)-1))}}function od(i,r){if(1&i&&(t.j41(0,"span",23),t.nrm(1,"img",24)(2,"span",25),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(2),t.Y8G("ghs-label","state.missing")("ghs-label-args",t.eq3(2,di,a.getUndoRevision(e+1)-a.getUndoRevision(e)-1))}}function sd(i,r){if(1&i&&(t.nrm(0,"span",22),t.nI1(1,"slice")),2&i){const e=t.XpG().$implicit,a=t.XpG();t.Y8G("ghs-label","state.info."+a.getUndoInfo(e)[0])("ghs-label-args",t.brH(1,3,a.getUndoInfo(e),1,a.getUndoInfo(e).length))("ghs-label-empty",!0)}}function rd(i,r){if(1&i&&(t.j41(0,"span",14),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(),t.E5c("",a.gameManager.stateManager.undos[e].revision," - ",a.gameManager.stateManager.undos[e].revisionOffset," - ",a.gameManager.stateManager.undos[e].revision-a.gameManager.stateManager.undos[e].revisionOffset)}}function cd(i,r){if(1&i){const e=t.RV6();t.nVh(0,ad,3,4,"span",23),t.nVh(1,od,3,4,"span",23),t.j41(2,"span",21),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.undo(n))})("mouseleave",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.cancelConfirm())}),t.j41(3,"span",11),t.EFF(4),t.k0s(),t.nVh(5,sd,2,7,"span",22),t.nrm(6,"span",13),t.nVh(7,rd,2,3,"span",14),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.vxM(!a.undoOffset&&e==a.undoArray.length-1&&a.gameManager.game.revision-a.gameManager.game.revisionOffset-a.getUndoRevision(e)-1?0:-1),t.R7$(),t.vxM(e<a.undoArray.length-1&&a.getUndoRevision(e+1)-a.getUndoRevision(e)!=1?1:-1),t.R7$(),t.Y8G("ngClass",t.l_i(6,wo,a.undoConfirm=="undo-"+e,!a.gameManager.stateManager.undoPermission||a.undoOffset&&a.gameManager.stateManager.gameOffsetWarning)),t.R7$(2),t.SpI("",a.getUndoRevision(e)+1,"."),t.R7$(),t.vxM(a.getUndoInfo(e).length>0?5:-1),t.R7$(2),t.vxM(a.gameManager.stateManager.undos[e]?7:-1)}}function ld(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",27),t.bIt("inViewportAction",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.moreUndos())})("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.moreUndos())}),t.nrm(1,"span",3),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","state.loadMore"))}function gd(i,r){1&i&&t.nrm(0,"span")}function dd(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",28),t.bIt("mouseleave",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.confirm="")})("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.clearUndos())}),t.nrm(1,"span",3),t.EFF(2),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.l_i(3,Ro,!e.gameManager.stateManager.undoPermission,"clearUndos"==e.confirm)),t.R7$(),t.Y8G("ghs-label","state.clear.undos"),t.R7$(),t.JRh("clearUndos"==e.confirm?"!":"?")}}function hd(i,r){1&i&&(t.j41(0,"span",4),t.EFF(1,"|"),t.k0s())}function _d(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",28),t.bIt("mouseleave",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.confirm="")})("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.clearRedos())}),t.nrm(1,"span",3),t.EFF(2),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.l_i(3,Ro,!e.gameManager.stateManager.redoPermission,"clearRedos"==e.confirm)),t.R7$(),t.Y8G("ghs-label","state.clear.redos"),t.R7$(),t.JRh("clearRedos"==e.confirm?"!":"?")}}let md=(()=>{class i{dialogRef;gameManager=s.E;undoOffset=0;confirm="";undoArray=[];redoArray=[];undoConfirm="";constructor(e){this.dialogRef=e,this.dialogRef.overlayRef.hostElement.style.zIndex="3000",this.dialogRef.overlayRef.backdropElement&&(this.dialogRef.overlayRef.backdropElement.style.zIndex="3000")}ngOnInit(){this.undoOffset=s.E.stateManager.undos.length>0?s.E.game.revision-(s.E.game.revisionOffset||0)-this.getUndoRevision(s.E.stateManager.undos.length-1)-1:0,this.undoArray=Array.from({length:Math.min(10,s.E.stateManager.undos.length)}).map((e,a)=>s.E.stateManager.undos.length-a-1),this.redoArray=Array.from({length:Math.min(10,s.E.stateManager.redos.length)}).map((e,a)=>Math.min(10,s.E.stateManager.redos.length)-a-1),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.undoOffset=s.E.stateManager.undos.length>0?s.E.game.revision-(s.E.game.revisionOffset||0)-this.getUndoRevision(s.E.stateManager.undos.length-1)-1:0,this.undoArray=Array.from({length:Math.min(10,s.E.stateManager.undos.length)}).map((e,a)=>s.E.stateManager.undos.length-a-1),this.redoArray=Array.from({length:Math.min(10,s.E.stateManager.redos.length)}).map((e,a)=>Math.min(10,s.E.stateManager.redos.length)-a-1)}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}moreUndos(){this.undoArray.length<s.E.stateManager.undos.length&&(this.undoArray=Array.from({length:Math.min(s.E.stateManager.undos.length,this.undoArray.length+10)}).map((e,a)=>s.E.stateManager.undos.length-a-1))}moreRedos(){if(this.redoArray.length<s.E.stateManager.redos.length){const e=Math.min(s.E.stateManager.redos.length,this.redoArray.length+10);this.redoArray=Array.from({length:e}).map((a,n)=>e-n-1)}}getUndoInfo(e){let a=[];return s.E.stateManager.undos.length>0&&s.E.stateManager.undoInfos.length>=s.E.stateManager.undos.length&&e>=0&&e<s.E.stateManager.undos.length&&(a=s.E.stateManager.undoInfos[e],a&&a.length>1&&"serverSync"==a[0]?a="setInitiative"==a[1]&&a.length>3?["serverSync",m.f.getLabel("state.info."+a[1],[a[2],""])]:["serverSync",m.f.getLabel("state.info."+a[1],a.slice(2))]:a&&1==a.length&&"serverSync"==a[0]?a=["serverSync",""]:a||(a=["unknown"])),a}getRedoInfo(e){let a=[];return s.E.stateManager.redos.length>0&&s.E.stateManager.undoInfos.length>=s.E.stateManager.undos.length+s.E.stateManager.redos.length&&e>=0&&e<s.E.stateManager.redos.length&&(a=s.E.stateManager.undoInfos[s.E.stateManager.undos.length+e],a&&a.length>1&&"serverSync"==a[0]?a="setInitiative"==a[1]&&a.length>3?["serverSync",m.f.getLabel("state.info."+a[1],[a[2],""])]:["serverSync",m.f.getLabel("state.info."+a[1],a.slice(2))]:a&&1==a.length&&"serverSync"==a[0]?a=["serverSync",""]:a||(a=["unknown"])),a}getUndoRevision(e){const a=s.E.stateManager.undos;return a[e]&&a[e].revision-(a[e].revisionOffset||0)||0}getRedoRevision(e){const a=s.E.stateManager.redos,n=a.length-e-1;return a[n]&&a[n].revision-(a[n].revisionOffset||0)||0}undo(e,a=!1){a||this.undoConfirm=="undo-"+e?s.E.stateManager.fixedUndo(s.E.stateManager.undos.length-e):this.undoConfirm="undo-"+e}redo(e,a=!1){a||this.undoConfirm=="redo-"+e?s.E.stateManager.fixedRedo(e+1):this.undoConfirm="redo-"+e}cancelConfirm(){this.undoConfirm=""}clearUndos(){"clearUndos"!=this.confirm?this.confirm="clearUndos":(this.undoArray=[],this.undoOffset=0,s.E.stateManager.clearUndos())}clearRedos(){"clearRedos"!=this.confirm?this.confirm="clearRedos":(this.redoArray=[],s.E.stateManager.clearRedos())}static \u0275fac=function(a){return new(a||i)(t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-undo-dialog"]],standalone:!1,decls:32,vars:25,consts:[[1,"undo-dialog"],[1,"menu"],["tabclick","",1,"state","undo",3,"click","ngClass"],[3,"ghs-label"],[1,"separator"],["tabclick","",1,"state","redo",3,"click","ngClass"],[1,"container"],[1,"list","redos"],["tabclick","",1,"more"],[1,"list","current",3,"autoscroll","ngClass"],[1,"entry"],[1,"revision"],[1,"info",3,"ghs-label"],[1,"spacer"],[1,"debug"],[1,"warning","undo-offset"],[1,"list","undos"],["tabclick","","inViewport","",1,"more"],[1,"menu","clear-menu"],["tabclick","",1,"state",3,"ngClass"],["tabclick","",1,"more",3,"click"],["tabclick","",1,"entry",3,"click","mouseleave","ngClass"],[1,"info","text-white",3,"ghs-label","ghs-label-args","ghs-label-empty"],[1,"warning"],["src","./assets/images/warning.svg"],[3,"ghs-label","ghs-label-args"],[1,"warning","undo-offset",3,"click"],["tabclick","","inViewport","",1,"more",3,"inViewportAction","click"],["tabclick","",1,"state",3,"mouseleave","click","ngClass"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"a",2),t.bIt("click",function(){return n.gameManager.stateManager.undo()}),t.nrm(3,"span",3),t.k0s(),t.j41(4,"span",4),t.EFF(5,"|"),t.k0s(),t.j41(6,"a",5),t.bIt("click",function(){return n.gameManager.stateManager.redo()}),t.nrm(7,"span",3),t.k0s()(),t.j41(8,"div",6)(9,"div",7),t.nVh(10,Zg,2,1,"span",8),t.Z7z(11,nd,7,8,null,null,t.fX1),t.k0s(),t.j41(13,"div",9)(14,"span",10)(15,"span",11),t.EFF(16),t.k0s(),t.nrm(17,"span",12)(18,"span",13),t.j41(19,"span",14),t.EFF(20),t.k0s()(),t.nVh(21,id,3,4,"span",15),t.k0s(),t.j41(22,"div",16),t.Z7z(23,cd,8,9,null,null,t.fX1),t.nVh(25,ld,2,1,"span",17),t.k0s()(),t.nrm(26,"div",13),t.j41(27,"div",18),t.nVh(28,gd,1,0,"span"),t.nVh(29,dd,3,6,"a",19),t.nVh(30,hd,2,0,"span",4),t.nVh(31,_d,3,6,"a",19),t.k0s()()),2&a&&(t.R7$(2),t.Y8G("ngClass",t.eq3(18,Eo,!n.gameManager.stateManager.undoPermission||n.undoOffset&&n.gameManager.stateManager.gameOffsetWarning||0==n.undoArray.length)),t.R7$(),t.Y8G("ghs-label","state.undo"),t.R7$(3),t.Y8G("ngClass",t.eq3(20,Eo,!n.gameManager.stateManager.redoPermission||0==n.redoArray.length)),t.R7$(),t.Y8G("ghs-label","state.redo"),t.R7$(3),t.vxM(n.redoArray.length<n.gameManager.stateManager.redos.length?10:-1),t.R7$(),t.Dyx(n.redoArray),t.R7$(2),t.Y8G("autoscroll",!0)("ngClass",t.l_i(22,Jg,n.undoArray.length>0,n.redoArray.length>0)),t.R7$(3),t.SpI("",n.gameManager.game.revision-(n.gameManager.game.revisionOffset||0)+1,"."),t.R7$(),t.Y8G("ghs-label","state.currentGame"),t.R7$(3),t.E5c("",n.gameManager.game.revision," - ",n.gameManager.game.revisionOffset," - ",n.gameManager.game.revision-n.gameManager.game.revisionOffset),t.R7$(),t.vxM(n.undoOffset&&n.gameManager.stateManager.gameOffsetWarning?21:-1),t.R7$(2),t.Dyx(n.undoArray),t.R7$(2),t.vxM(n.undoArray.length<n.gameManager.stateManager.undos.length?25:-1),t.R7$(3),t.vxM(0==n.undoArray.length?28:-1),t.R7$(),t.vxM(n.undoArray.length>0?29:-1),t.R7$(),t.vxM(n.undoArray.length>0&&n.redoArray.length>0?30:-1),t.R7$(),t.vxM(n.redoArray.length>0?31:-1))},dependencies:[N.YU,R.dQ,xo,tt,At,N.P9],styles:[".undo-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:relative;padding:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 70);height:calc(var(--ghs-unit) * 68 * var(--ghs-dialog-factor));max-height:calc(var(--ghs-unit) * 68 * var(--ghs-dialog-factor))}.undo-dialog[_ngcontent-%COMP%]   .working[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray);animation:ghs-spinning 1.5s linear infinite;margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.undo-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:center}.undo-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{color:var(--ghs-color-disabled);margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.undo-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{cursor:pointer;font-family:var(--ghs-font-title);margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.undo-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.undo-dialog[_ngcontent-%COMP%]   .menu.clear-menu[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.undo-dialog[_ngcontent-%COMP%]   .menu.clear-menu[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));font-family:var(--ghs-font-text)}.undo-dialog[_ngcontent-%COMP%]   .menu.clear-menu[_ngcontent-%COMP%]   .state.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.undo-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{padding:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));max-height:100%;overflow:auto}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{display:flex;flex-direction:column}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;align-items:flex-end;color:var(--ghs-color-white)}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   .revision[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;text-align:right;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]:hover{filter:brightness(.5)}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .entry.confirm[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .entry.disabled[_ngcontent-%COMP%]{pointer-events:none}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   .debug[_ngcontent-%COMP%]{display:none}.undo-dialog[_ngcontent-%COMP%]   .list.current[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) 0;border-top:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid transparent;border-bottom:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid transparent}.undo-dialog[_ngcontent-%COMP%]   .list.current[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-style:italic}.undo-dialog[_ngcontent-%COMP%]   .list.current.has-undos[_ngcontent-%COMP%]{border-bottom-color:var(--ghs-color-gray)}.undo-dialog[_ngcontent-%COMP%]   .list.current.has-redos[_ngcontent-%COMP%]{border-top-color:var(--ghs-color-gray)}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--ghs-color-red)}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .warning.undo-offset[_ngcontent-%COMP%]{cursor:zoom-out}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .warning.undo-offset[_ngcontent-%COMP%]:hover{opacity:.7}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.undo-dialog[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .more[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer;color:var(--ghs-color-gray)}"]})}return i})();const jo=i=>({disabled:i}),pd=i=>[i],Go=i=>({denied:i}),fn=(i,r)=>({disabled:i,denied:r}),To=(i,r)=>r.edition+"-"+r.name,ud=(i,r)=>r.uuid;function fd(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",25),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.gameManager.stateManager.gameOffsetWarning=!1)}),t.nrm(1,"img",26)(2,"span",27),t.k0s()}if(2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","state.missing")("ghs-label-args",t.eq3(2,pd,e.undoOffset))}}function Cd(i,r){if(1&i&&(t.nrm(0,"span",13),t.nI1(1,"slice")),2&i){const e=t.XpG(2);t.Y8G("ghs-label","state.info."+e.undoInfo[0])("ghs-label-args",t.brH(1,3,e.undoInfo,1,e.undoInfo.length))("ghs-label-empty",!0)}}function Md(i,r){if(1&i&&(t.nrm(0,"span",13),t.nI1(1,"slice")),2&i){const e=t.XpG(2);t.Y8G("ghs-label","state.info."+e.redoInfo[0])("ghs-label-args",t.brH(1,3,e.redoInfo,1,e.redoInfo.length))("ghs-label-empty",!0)}}function vd(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",28)(1,"a",19),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.setActive(n.SubMenu.scenario))}),t.nrm(2,"span",12),t.k0s()(),t.j41(3,"div",28)(4,"a",19),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.setActive(n.SubMenu.section))}),t.nrm(5,"span",12),t.k0s()(),t.j41(6,"div",28)(7,"a",19),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.setActive(n.SubMenu.monster_add))}),t.nrm(8,"span",12),t.k0s()(),t.j41(9,"div",28)(10,"a",19),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.setActive(n.SubMenu.monster_remove))}),t.nrm(11,"span",12),t.k0s()(),t.nrm(12,"div",17),t.j41(13,"div",28)(14,"a",19),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.setActive(n.SubMenu.character_add))}),t.nrm(15,"span",12),t.k0s()(),t.j41(16,"div",28)(17,"a",19),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.setActive(n.SubMenu.character_remove))}),t.nrm(18,"span",12),t.k0s()(),t.j41(19,"div",28)(20,"a",19),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.setActive(n.SubMenu.objective_add))}),t.nrm(21,"span",12),t.k0s()(),t.j41(22,"div",28)(23,"a",19),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.setActive(n.SubMenu.objective_remove))}),t.nrm(24,"span",12),t.k0s()(),t.nrm(25,"div",17),t.j41(26,"div",29)(27,"a",19),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.setActive(n.SubMenu.campaign))}),t.nrm(28,"span",12),t.k0s()(),t.nrm(29,"div",17)}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(17,Go,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.scenario)),t.R7$(2),t.Y8G("ghs-label","scenario.set"),t.R7$(),t.Y8G("ngClass",t.l_i(19,fn,!e.hasSections(),e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.scenario)),t.R7$(2),t.Y8G("ghs-label","section"),t.R7$(),t.Y8G("ngClass",t.l_i(22,fn,e.hasAllMonster(),e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.monsters)),t.R7$(2),t.Y8G("ghs-label","monster.add"),t.R7$(),t.Y8G("ngClass",t.l_i(25,fn,0==e.monsters().length,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.monsters)),t.R7$(2),t.Y8G("ghs-label","monster.remove"),t.R7$(2),t.Y8G("ngClass",t.l_i(28,fn,e.characters().length>0&&e.gameManager.bbRules()&&e.settingsManager.settings.bbChars,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.characters)),t.R7$(2),t.Y8G("ghs-label","character.add"),t.R7$(),t.Y8G("ngClass",t.l_i(31,fn,0==e.characters().length,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.characters)),t.R7$(2),t.Y8G("ghs-label","character.remove"),t.R7$(),t.Y8G("ngClass",t.eq3(34,Go,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.characters)),t.R7$(2),t.Y8G("ghs-label","objective.add"),t.R7$(),t.Y8G("ngClass",t.l_i(36,fn,0==e.objectives().length,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.characters)),t.R7$(2),t.Y8G("ghs-label","objective.remove"),t.R7$(4),t.Y8G("ghs-label","campaign")}}function Od(i,r){1&i&&(t.j41(0,"span"),t.nrm(1,"span",12),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","server.menu.connected"))}function Pd(i,r){1&i&&(t.j41(0,"span"),t.nrm(1,"span",12),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","server.connecting"))}function bd(i,r){1&i&&(t.j41(0,"span"),t.nrm(1,"span",12),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","server.menu.connect"))}function kd(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",18)(1,"a",30),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.gameManager.stateManager.install())}),t.nrm(2,"img",31)(3,"span",12),t.k0s()()}2&i&&(t.R7$(3),t.Y8G("ghs-label","app.install"))}function yd(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",18)(1,"a",32),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.close())}),t.nrm(2,"img",33),t.EFF(3,"\xa0 "),t.nrm(4,"span",12),t.k0s()()}2&i&&(t.R7$(),t.Y8G("routerLink","/"),t.R7$(3),t.Y8G("ghs-label","tools.backToGhs"))}function xd(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",24)(1,"a",19),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.update())}),t.EFF(2,"<"),t.nrm(3,"span",12),t.EFF(4,"(!)>"),t.k0s()()}2&i&&(t.R7$(3),t.Y8G("ghs-label","update"))}function Ed(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",1)(1,"div",8),t.nVh(2,fd,3,4,"span",9),t.j41(3,"a",10),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.gameManager.stateManager.undo())}),t.j41(4,"span",11),t.nrm(5,"span",12),t.k0s(),t.nVh(6,Cd,2,7,"span",13),t.k0s(),t.j41(7,"span",14),t.bIt("click",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.openUndoDialog(n))}),t.nrm(8,"img",15),t.k0s(),t.j41(9,"a",16),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.gameManager.stateManager.redo())}),t.nrm(10,"span",12),t.nVh(11,Md,2,7,"span",13),t.k0s()(),t.nrm(12,"div",17),t.nVh(13,vd,30,39),t.j41(14,"div",18)(15,"a",19),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.setActive(n.SubMenu.settings))}),t.nrm(16,"span",12),t.k0s()(),t.j41(17,"div",18)(18,"a",19),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.setActive(n.SubMenu.datamanagement))}),t.nrm(19,"span",12),t.k0s()(),t.nrm(20,"div",17),t.j41(21,"div",18)(22,"a",19),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.setActive(n.SubMenu.server))}),t.nVh(23,Od,2,1,"span")(24,Pd,2,1,"span")(25,bd,2,1,"span"),t.k0s()(),t.nrm(26,"div",17),t.j41(27,"div",18)(28,"a",19),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.setActive(n.SubMenu.about))}),t.nrm(29,"span",12),t.k0s()(),t.j41(30,"div",18)(31,"a",20),t.nrm(32,"span",12),t.k0s()(),t.nrm(33,"div",17),t.nVh(34,kd,4,1,"div",18),t.j41(35,"div",18)(36,"a",19),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.feedbackDialog())}),t.nrm(37,"img",21),t.EFF(38,"\xa0 "),t.nrm(39,"span",12),t.k0s()(),t.j41(40,"div",18)(41,"a",22),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.keyboardShourtcutsDialog())}),t.nrm(42,"img",23),t.k0s()(),t.nVh(43,yd,5,2,"div",18),t.nVh(44,xd,5,1,"div",24),t.k0s()}if(2&i){let e;const a=t.XpG();t.R7$(2),t.vxM(a.undoOffset&&a.gameManager.stateManager.gameOffsetWarning?2:-1),t.R7$(),t.Y8G("ngClass",t.eq3(18,jo,!a.gameManager.stateManager.undoPermission||a.undoOffset&&a.gameManager.stateManager.gameOffsetWarning||0==a.gameManager.stateManager.undos.length)),t.R7$(2),t.Y8G("ghs-label","state.undo"),t.R7$(),t.vxM(a.undoInfo.length>0?6:-1),t.R7$(3),t.Y8G("ngClass",t.eq3(20,jo,!a.gameManager.stateManager.redoPermission||0==a.gameManager.stateManager.redos.length)),t.R7$(),t.Y8G("ghs-label","state.redo"),t.R7$(),t.vxM(a.redoInfo.length>0?11:-1),t.R7$(2),t.vxM(a.standalone?-1:13),t.R7$(3),t.Y8G("ghs-label","settings"),t.R7$(3),t.Y8G("ghs-label","datamanagement"),t.R7$(4),t.vxM((e=a.gameManager.stateManager.wsState())===a.WebSocket.OPEN?23:e===a.WebSocket.CONNECTING?24:25),t.R7$(6),t.Y8G("ghs-label","about"),t.R7$(3),t.Y8G("ghs-label","help"),t.R7$(2),t.vxM(a.gameManager.stateManager.installPrompt?34:-1),t.R7$(5),t.Y8G("ghs-label","tools.feedback"),t.R7$(2),t.Y8G("ghs-tooltip","tools.keyboard"),t.R7$(2),t.vxM(a.standalone?43:-1),t.R7$(),t.vxM(a.isUpdateAvailable()?44:-1)}}function wd(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-scenario-menu",34),t.bIt("close",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.close())}),t.k0s()}}function Rd(i,r){1&i&&t.nrm(0,"ghs-section-menu")}function jd(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-character-menu",34),t.bIt("close",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.close())}),t.k0s()}}function Gd(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-campaign-menu",34),t.bIt("close",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.close())}),t.k0s()}}function Td(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",18)(1,"a",35),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.removeCharacter(n))}),t.nrm(2,"img",36),t.j41(3,"span"),t.EFF(4),t.k0s()()()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(2),t.Y8G("src",e.iconUrl,t.B4B),t.R7$(2),t.JRh(a.gameManager.characterManager.characterName(e,!0))}}function Sd(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",2)(1,"div",18)(2,"a",35),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.removeAllCharacters())}),t.EFF(3," <"),t.nrm(4,"span",12),t.EFF(5,"> "),t.k0s()(),t.Z7z(6,Td,5,2,"div",18,To),t.k0s()}if(2&i){const e=t.XpG();t.R7$(4),t.Y8G("ghs-label","character.removeAll"),t.R7$(2),t.Dyx(e.characters())}}function $d(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",3)(1,"div",18)(2,"a",35),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.addObjectiveContainer())}),t.nrm(3,"img",37)(4,"span",12),t.k0s()(),t.j41(5,"div",18)(6,"a",35),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.addObjectiveContainer(!0))}),t.nrm(7,"img",38)(8,"span",12),t.k0s()()()}2&i&&(t.R7$(4),t.Y8G("ghs-label","objective.add"),t.R7$(4),t.Y8G("ghs-label","escort.add"))}function Dd(i,r){1&i&&t.nrm(0,"img",37)}function Id(i,r){1&i&&t.nrm(0,"img",38)}function Ad(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.title)}}function Vd(i,r){if(1&i&&t.nrm(0,"span",12),2&i){const e=t.XpG().$implicit;t.Y8G("ghs-label","data.objective."+e.name)}}function Fd(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"("),t.k0s())}function Xd(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,")"),t.k0s())}function Bd(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",18)(1,"a",35),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.removeObjective(n))}),t.nVh(2,Dd,1,0,"img",37),t.nVh(3,Id,1,0,"img",38),t.nVh(4,Ad,2,1,"span"),t.nVh(5,Vd,1,1,"span",12),t.nVh(6,Fd,2,0,"span"),t.nrm(7,"span",12),t.nVh(8,Xd,2,0,"span"),t.k0s()()}if(2&i){const e=r.$implicit;t.R7$(2),t.vxM(e.escort?-1:2),t.R7$(),t.vxM(e.escort?3:-1),t.R7$(),t.vxM(e.title?4:-1),t.R7$(),t.vxM(!e.title&&e.name?5:-1),t.R7$(),t.vxM(e.title||e.name?6:-1),t.R7$(),t.Y8G("ghs-label",e.escort?"escort":"objective"),t.R7$(),t.vxM(e.name?8:-1)}}function Yd(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",4)(1,"div",18)(2,"a",35),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.removeAllObjectives())}),t.EFF(3," <"),t.nrm(4,"span",12),t.EFF(5,"> "),t.k0s()(),t.Z7z(6,Bd,9,7,"div",18,ud),t.k0s()}if(2&i){const e=t.XpG();t.R7$(4),t.Y8G("ghs-label","objective.removeAll"),t.R7$(2),t.Dyx(e.objectives())}}function Nd(i,r){1&i&&t.nrm(0,"ghs-monster-menu")}function zd(i,r){if(1&i&&(t.j41(0,"span",39),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.R7$(),t.SpI("\xa0(",a.gameManager.entityManager.entities(e).length,")")}}function Ld(i,r){if(1&i&&(t.j41(0,"span",40),t.EFF(1,"\xa0["),t.nrm(2,"span",12),t.EFF(3,"]"),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","data.edition."+a.gameManager.getEdition(e))}}function Ud(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",18)(1,"a",35),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.removeMonster(n))}),t.nrm(2,"span",12),t.nVh(3,zd,2,1,"span",39),t.nVh(4,Ld,4,1,"span",40),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","data.monster."+e.name),t.R7$(),t.vxM(a.gameManager.entityManager.entities(e).length>0?3:-1),t.R7$(),t.vxM(a.gameManager.getEdition(e)?4:-1)}}function qd(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",18)(1,"a",35),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.removeAllMonsters(!0))}),t.EFF(2," <"),t.nrm(3,"span",12),t.EFF(4,"> "),t.k0s()()}2&i&&(t.R7$(3),t.Y8G("ghs-label","monster.removeUnused"))}function Hd(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",5)(1,"div",18)(2,"a",35),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.removeAllMonsters())}),t.EFF(3," <"),t.nrm(4,"span",12),t.EFF(5,"> "),t.k0s()(),t.Z7z(6,Ud,5,3,"div",18,To),t.nVh(8,qd,5,1,"div",18),t.k0s()}if(2&i){const e=t.XpG();t.R7$(4),t.Y8G("ghs-label","monster.removeAll"),t.R7$(2),t.Dyx(e.monsters()),t.R7$(2),t.vxM(e.hasUnusedMonster()?8:-1)}}function Kd(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-settings-menu",41),t.bIt("setMenu",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setActive(n))}),t.k0s()}}function Wd(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-debug-menu",34),t.bIt("close",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.close())}),t.k0s()}}function Jd(i,r){1&i&&t.nrm(0,"ghs-server-menu")}function Zd(i,r){1&i&&t.nrm(0,"ghs-datamanagement-menu")}function Qd(i,r){1&i&&t.nrm(0,"ghs-datamanagement-menu",6),2&i&&t.Y8G("editionsOnly",!0)}function th(i,r){1&i&&t.nrm(0,"ghs-about-menu")}function eh(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",42),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.setActive(n.SubMenu.main))}),t.nrm(1,"img",33),t.k0s()}2&i&&t.Y8G("ghs-label","menu.backToMain")("ghs-label-attribute","title")}var we=function(i){return i.main="main",i.scenario="scenario",i.section="section",i.monster_add="monster_add",i.monster_remove="monster_remove",i.character_add="character_add",i.character_remove="character_remove",i.objective_add="objective_add",i.objective_remove="objective_remove",i.settings="settings",i.debug="debug",i.server="server",i.datamanagement="datamanagement",i.editions="editions",i.about="about",i.campaign="campaign",i}(we||{});let So=(()=>{class i{dialogRef;dialog;swUpdate;gameManager=s.E;settingsManager=m.f;GameState=T.mk;SubMenu=we;active=we.main;standalone=!1;hasSpoilers=V.KZ;isSpoiled=V.DJ;notSpoiled=V.gP;WebSocket=WebSocket;undoInfo=[];undoOffset=0;redoInfo=[];constructor(e,a,n,o){this.dialogRef=a,this.dialog=n,this.swUpdate=o,this.active=e.subMenu,this.standalone=e.standalone,this.dialogRef.overlayRef.hostElement.style.zIndex="3000",this.dialogRef.overlayRef.backdropElement&&(this.dialogRef.overlayRef.backdropElement.style.zIndex="3000")}ngOnInit(){this.updateUndoRedo(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.updateUndoRedo()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}close(){(0,V.co)(this.dialogRef)}updateUndoRedo(){const e=s.E.stateManager.undos,a=s.E.stateManager.redos,n=s.E.stateManager.undoInfos;e.length>0&&n.length>=e.length?(this.undoInfo=n[e.length-1],this.undoOffset=s.E.game.revision-(s.E.game.revisionOffset||0)-(e[e.length-1].revision-(e[e.length-1].revisionOffset||0))-1,this.undoInfo&&this.undoInfo.length>1&&"serverSync"==this.undoInfo[0]?this.undoInfo=s.E.game.state==T.mk.draw&&"setInitiative"==this.undoInfo[1]&&this.undoInfo.length>3?["serverSync",m.f.getLabel("state.info."+this.undoInfo[1],[this.undoInfo[2],""])]:["serverSync",m.f.getLabel("state.info."+this.undoInfo[1],this.undoInfo.slice(2))]:this.undoInfo&&1==this.undoInfo.length&&"serverSync"==this.undoInfo[0]?this.undoInfo=["serverSync",""]:this.undoInfo||(this.undoInfo=["unknown"])):(this.undoInfo=[],this.undoOffset=0),a.length>0&&n.length>e.length?(this.redoInfo=n[e.length],this.redoInfo&&this.redoInfo.length>1&&"serverSync"==this.redoInfo[0]?this.redoInfo="setInitiative"==this.redoInfo[1]&&this.redoInfo.length>3?["serverSync",m.f.getLabel("state.info."+this.redoInfo[1],[this.redoInfo[2],""])]:["serverSync",m.f.getLabel("state.info."+this.redoInfo[1],this.redoInfo.slice(2))]:this.redoInfo&&1==this.redoInfo.length&&"serverSync"==this.redoInfo[0]?this.redoInfo=["serverSync",""]:this.redoInfo||(this.redoInfo=["unknown"])):this.redoInfo=[]}openUndoDialog(e){this.dialog.open(md,{panelClass:["dialog"]}),this.close(),e.preventDefault(),e.stopPropagation()}setActive(e){this.active=e}hasSections(){return s.E.editionData.some(e=>e.edition==s.E.currentEdition()&&e.sections&&e.sections.length>0)}characters(){return s.E.game.figures.filter(e=>e instanceof q.K).map(e=>e).sort((e,a)=>{const n=s.E.characterManager.characterName(e).toLowerCase(),o=s.E.characterManager.characterName(a).toLowerCase();return n>o?1:n<o?-1:0})}objectives(){return s.E.game.figures.filter(e=>e instanceof mt.$e).map(e=>e).sort((e,a)=>{const n=(e.title?e.title:m.f.getLabel(e.name?"data.objective."+e.name:e.escort?"escort":"objective")).toLowerCase(),o=(a.title?a.title:m.f.getLabel(a.name?"data.objective."+a.name:a.escort?"escort":"objective")).toLowerCase();return n>o?1:n<o?-1:0})}monsters(){return s.E.game.figures.filter(e=>e instanceof P.R).map(e=>e).sort((e,a)=>{const n=m.f.getLabel("data.monster."+e.name).toLowerCase(),o=m.f.getLabel("data.monster."+a.name).toLowerCase();return n>o?1:n<o?-1:0})}removeCharacter(e){s.E.stateManager.before("removeChar",s.E.characterManager.characterName(e)),s.E.characterManager.removeCharacter(e),0==this.characters().length&&this.close(),s.E.stateManager.after()}removeAllCharacters(){s.E.stateManager.before("removeAllChars"),s.E.game.figures=s.E.game.figures.filter(e=>!(e instanceof q.K)),this.close(),s.E.stateManager.after()}addObjectiveContainer(e=!1){s.E.stateManager.before("addObjective"+(e?".escort":""));const a=s.E.objectiveManager.addObjective(new Co("",e?3:7,e),e?"%escort%":"%objective%");s.E.objectiveManager.addObjectiveEntity(a),this.close(),s.E.stateManager.after()}removeObjective(e){s.E.stateManager.before("removeObjective",e.title||e.name),s.E.objectiveManager.removeObjective(e),0==this.objectives().length&&this.close(),s.E.stateManager.after()}removeAllObjectives(){s.E.stateManager.before("removeAllObjectives"),s.E.game.figures=s.E.game.figures.filter(e=>!(e instanceof mt.$e)),this.close(),s.E.stateManager.after()}removeMonster(e){s.E.stateManager.before("removeMonster","data.monster."+e.name),s.E.monsterManager.removeMonster(e),0==this.monsters().length&&this.close(),s.E.stateManager.after()}removeAllMonsters(e=!1){s.E.stateManager.before("removeAllMonster"),s.E.game.figures=s.E.game.figures.filter(a=>!(a instanceof P.R)||e&&a.entities.some(n=>s.E.entityManager.isAlive(n))),this.close(),s.E.stateManager.after()}hasAllMonster(){return s.E.monstersData().every(e=>s.E.game.figures.some(a=>a instanceof mn.f&&a.name==e.name&&a.edition==e.edition))}hasUnusedMonster(){return null!=s.E.game.figures.find(e=>e instanceof P.R&&e.entities.every(a=>!s.E.entityManager.isAlive(a)))&&null!=s.E.game.figures.find(e=>e instanceof P.R&&e.entities.some(a=>s.E.entityManager.isAlive(a)))}isUpdateAvailable(){return window.electron?window.electron.updateAvailable:s.E.stateManager.hasUpdate}update(e=!1){(this.isUpdateAvailable()||e)&&(window.electron?window.electron.quitAndInstall():this.swUpdate.isEnabled?this.swUpdate.activateUpdate().then(()=>{this.clearAndRefresh()}):this.clearAndRefresh())}clearAndRefresh(){return(0,X.A)(function*(){if("caches"in window){const e=yield caches.keys();yield Promise.all(e.map(function(){var a=(0,X.A)(function*(n){return yield caches.delete(n)});return function(n){return a.apply(this,arguments)}}()))}window.location.reload()})()}feedbackDialog(){this.dialog.open(ko,{panelClass:["dialog"]}),this.close()}keyboardShourtcutsDialog(){this.dialog.open(yo,{panelClass:["dialog"]}),this.close()}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG),t.rXU(E.EI))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-main-menu"]],standalone:!1,decls:18,vars:2,consts:[[1,"scroll-container"],[1,"menu-container","main","two-column"],[1,"menu-container","character-remove"],[1,"menu-container","objective-add"],[1,"menu-container","objective-remove"],[1,"menu-container","monster-remove"],[3,"editionsOnly"],["tabclick","",1,"back",3,"ghs-label","ghs-label-attribute"],[1,"line","state-container","span"],[1,"warning"],["tabclick","",1,"state","undo",3,"click","ngClass"],[1,"undo-text"],[3,"ghs-label"],[1,"info","text-white",3,"ghs-label","ghs-label-args","ghs-label-empty"],["tabclick","",1,"undo-dialog",3,"click"],["src","./assets/images/long-rest.svg",1,"ghs-svg"],["tabclick","",1,"state","redo",3,"click","ngClass"],[1,"separator"],[1,"line"],["tabclick","",3,"click"],["href","https://help.gloomhaven-secretariat.de","target","_blank"],["src","./assets/images/hint.svg",1,"ghs-svg"],["tabclick","",3,"click","ghs-tooltip"],["src","./assets/images/keyboard.svg",1,"ghs-svg"],[1,"line","separator"],[1,"warning",3,"click"],["src","./assets/images/warning.svg"],[3,"ghs-label","ghs-label-args"],[1,"line",3,"ngClass"],[1,"line","span"],[1,"install",3,"click"],["src","./assets/images/install.svg",1,"ghs-svg"],["tabclick","",3,"click","routerLink"],["src","./assets/images/left.svg",1,"ghs-svg"],[3,"close"],[3,"click"],[1,"icon",3,"src"],["src","./assets/images/objective/objective.svg",1,"icon"],["src","./assets/images/objective/escort.svg",1,"icon"],[1,"count"],[1,"edition"],[3,"setMenu"],["tabclick","",1,"back",3,"click","ghs-label","ghs-label-attribute"]],template:function(a,n){if(1&a&&(t.j41(0,"div",0),t.nVh(1,Ed,45,22,"div",1)(2,wd,1,0,"ghs-scenario-menu")(3,Rd,1,0,"ghs-section-menu")(4,jd,1,0,"ghs-character-menu")(5,Gd,1,0,"ghs-campaign-menu")(6,Sd,8,1,"div",2)(7,$d,9,2,"div",3)(8,Yd,8,1,"div",4)(9,Nd,1,0,"ghs-monster-menu")(10,Hd,9,2,"div",5)(11,Kd,1,0,"ghs-settings-menu")(12,Wd,1,0,"ghs-debug-menu")(13,Jd,1,0,"ghs-server-menu")(14,Zd,1,0,"ghs-datamanagement-menu")(15,Qd,1,1,"ghs-datamanagement-menu",6)(16,th,1,0,"ghs-about-menu"),t.k0s(),t.nVh(17,eh,2,2,"div",7)),2&a){let o;t.R7$(),t.vxM((o=n.active)===n.SubMenu.main?1:o===n.SubMenu.scenario?2:o===n.SubMenu.section?3:o===n.SubMenu.character_add?4:o===n.SubMenu.campaign?5:o===n.SubMenu.character_remove?6:o===n.SubMenu.objective_add?7:o===n.SubMenu.objective_remove?8:o===n.SubMenu.monster_add?9:o===n.SubMenu.monster_remove?10:o===n.SubMenu.settings?11:o===n.SubMenu.debug?12:o===n.SubMenu.server?13:o===n.SubMenu.datamanagement?14:o===n.SubMenu.editions?15:o===n.SubMenu.about?16:-1),t.R7$(16),t.vxM(n.active!=n.SubMenu.main?17:-1)}},styles:['[_nghost-%COMP%]{position:relative;z-index:9999}.hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:break-spaces}.back[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled[_ngcontent-%COMP%]{pointer-events:none}.back.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container[_ngcontent-%COMP%]{z-index:1}.menu-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.no-grow[_ngcontent-%COMP%]{flex-grow:0}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container.inline[_ngcontent-%COMP%]{width:initial;margin-right:1em}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex-wrap:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-gray)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{filter:grayscale(1)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm-delete[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]{align-items:flex-start}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]   .undo-text[_ngcontent-%COMP%]{display:flex;align-items:center}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.redo[_ngcontent-%COMP%]{align-items:flex-end}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]:hover{opacity:.7}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover{cursor:pointer}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog.disabled[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)!important}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]{border-bottom:none;margin-bottom:0}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container[_ngcontent-%COMP%]   .line.sticky.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container[_ngcontent-%COMP%]   .line.sticky.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .add[_ngcontent-%COMP%]{display:inherit}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%] ~ .spoiler[_ngcontent-%COMP%]{margin-top:0;border-top:none}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]{display:flex;cursor:pointer}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]   .span-xs[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns.columns-break[_ngcontent-%COMP%]{flex-wrap:wrap}}']})}return i})(),ea=(()=>{class i{dialogRef;label;args;constructor(e,a){this.dialogRef=a,e.label||this.dialogRef.close(),this.label=e.label,this.args=e.args||[]}cancel(){(0,V.co)(this.dialogRef,!1)}confirm(){(0,V.co)(this.dialogRef,!0)}keydown(e){m.f.settings.keyboardShortcuts&&"Enter"===e.key&&(this.confirm(),e.preventDefault(),e.stopPropagation())}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-confirm-dialog"]],hostBindings:function(a,n){1&a&&t.bIt("keydown",function(g){return n.keydown(g)},t.EBC)},standalone:!1,decls:6,vars:4,consts:[[1,"confirm-dialog"],[1,"title",3,"ghs-label","ghs-label-args"],[1,"menu"],[1,"cancel",3,"click"],[3,"ghs-label"],[1,"confirm",3,"click","ghs-label"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nrm(1,"div",1),t.j41(2,"div",2)(3,"a",3),t.bIt("click",function(){return n.cancel()}),t.nrm(4,"span",4),t.k0s(),t.j41(5,"a",5),t.bIt("click",function(){return n.confirm()}),t.k0s()()()),2&a&&(t.R7$(),t.Y8G("ghs-label",n.label)("ghs-label-args",n.args),t.R7$(3),t.Y8G("ghs-label","cancel"),t.R7$(),t.Y8G("ghs-label","confirm"))},dependencies:[tt],styles:[".confirm-dialog[_ngcontent-%COMP%]{position:relative;color:var(--ghs-color-white)}.confirm-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.confirm-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center}.confirm-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:2em;padding:.3em}.confirm-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.confirm-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-green)}"]})}return i})();var lt=M(78164);const nh=i=>({vertical:i});function ih(i,r){if(1&i&&(t.nrm(0,"img",7),t.EFF(1)),2&i){const e=t.XpG();t.Y8G("src",e.character.iconUrl,t.B4B),t.R7$(),t.SpI(" ",e.gameManager.characterManager.characterName(e.character,!0)," \xa0 ")}}function ah(i,r){1&i&&t.nrm(0,"img",8)}function oh(i,r){1&i&&(t.j41(0,"span"),t.nrm(1,"span",3),t.EFF(2,"\xa0"),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","monster"))}function sh(i,r){1&i&&(t.j41(0,"span"),t.nrm(1,"span",3),t.EFF(2,"\xa0"),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","game.ally"))}function rh(i,r){if(1&i&&(t.nVh(0,ah,1,0,"img",8),t.nVh(1,oh,3,1,"span"),t.nVh(2,sh,3,1,"span")),2&i){const e=t.XpG();t.vxM("m"==e.numeration?0:-1),t.R7$(),t.vxM("m"==e.numeration?1:-1),t.R7$(),t.vxM("A"==e.numeration?2:-1)}}function ch(i,r){1&i&&t.nrm(0,"span",3),2&i&&t.Y8G("ghs-label","game.attackModifiers")}function lh(i,r){1&i&&t.nrm(0,"span",3),2&i&&t.Y8G("ghs-label","party.campaign.townGuardDeck")}function gh(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.SpI("\xa0",e.numeration)}}let na=(()=>{class i{dialogRef;deck;character;ally;numeration="";newStyle=!1;townGuard=!1;before;after;gameManager=s.E;constructor(e,a){this.dialogRef=a,this.deck=e.deck,this.character=e.character,this.ally=e.ally,this.numeration=e.numeration,this.newStyle=e.newStyle,this.townGuard=e.townGuard,this.before=e.before,this.after=e.after}beforeAttackModifierDeck(e){this.before.emit(e)}afterAttackModifierDeck(e){this.after.emit(e)}vertical(){return window.innerWidth<800}close(){(0,V.co)(this.dialogRef)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-attackmodifier-deck-fullscreen"]],standalone:!1,decls:12,vars:16,consts:[[1,"attack-modifiers-fullscreen"],[1,"header"],[1,"title"],[3,"ghs-label"],[1,"attack-modifierdeck-container",3,"ngClass"],[3,"before","after","deck","character","ally","numeration","fullscreen","vertical","townGuard","initTimeout"],[1,"close-container",3,"click"],[1,"icon",3,"src"],["src","./assets/images/monster/enemy.png",1,"icon"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.nVh(3,ih,2,2),t.nVh(4,rh,3,3),t.nVh(5,ch,1,1,"span",3),t.nVh(6,lh,1,1,"span",3),t.nVh(7,gh,2,1,"span"),t.k0s()(),t.j41(8,"div",4)(9,"ghs-attackmodifier-deck",5),t.bIt("before",function(g){return n.beforeAttackModifierDeck(g)})("after",function(g){return n.afterAttackModifierDeck(g)}),t.k0s(),t.j41(10,"div",6),t.bIt("click",function(){return n.close()}),t.k0s()(),t.j41(11,"div",6),t.bIt("click",function(){return n.close()}),t.k0s()()),2&a&&(t.R7$(3),t.vxM(n.character?3:-1),t.R7$(),t.vxM(n.character||n.townGuard?-1:4),t.R7$(),t.vxM(n.townGuard?-1:5),t.R7$(),t.vxM(n.townGuard?6:-1),t.R7$(),t.vxM(n.character||"m"==n.numeration||"A"==n.numeration?-1:7),t.R7$(),t.Y8G("ngClass",t.eq3(14,nh,n.vertical())),t.R7$(),t.Y8G("deck",n.deck)("character",n.character)("ally",n.ally)("numeration",n.numeration)("fullscreen",!1)("vertical",n.vertical())("townGuard",n.townGuard)("initTimeout",1))},styles:[".attack-modifiers-fullscreen[_ngcontent-%COMP%]{width:100vw;height:100vh}.attack-modifiers-fullscreen[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:flex-start;align-items:center;z-index:1}.attack-modifiers-fullscreen[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));cursor:initial}.attack-modifiers-fullscreen[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 10 * var(--ghs-text-factor));width:auto;margin-right:.2em}.attack-modifiers-fullscreen[_ngcontent-%COMP%]   .attack-modifierdeck-container[_ngcontent-%COMP%]{position:relative;width:100%;height:30vw;max-height:350px;overflow-x:auto;display:flex;flex-direction:column;justify-content:flex-start;align-items:center;z-index:3}.attack-modifiers-fullscreen[_ngcontent-%COMP%]   .attack-modifierdeck-container[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{display:flex;width:99vw;max-width:800px;height:25.5vw;max-height:213px;z-index:3;margin-top:2em;margin-left:1%}.attack-modifiers-fullscreen[_ngcontent-%COMP%]   .attack-modifierdeck-container.vertical[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden;width:99vw;max-width:800px;height:100%;max-height:initial}.attack-modifiers-fullscreen[_ngcontent-%COMP%]   .attack-modifierdeck-container.vertical[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{width:98vw;margin-right:1%;height:calc(100% - var(--ghs-unit) * 10 * var(--ghs-text-factor));max-height:initial;transform:none}.attack-modifiers-fullscreen[_ngcontent-%COMP%]   .close-container[_ngcontent-%COMP%]{cursor:zoom-out;position:absolute;display:flex;width:100%;height:100%;z-index:2;top:0;left:0}"]})}return i})();var vt=M(60057);let Be=(()=>{class i{el;disabled=!1;clicked=!1;change=new t.bkB;constructor(e){this.el=e,this.el.nativeElement.classList.add("reveal")}onClick(){this.disabled?this.clicked&&(this.clicked=!1,this.el.nativeElement.classList.remove("confirm")):this.el.nativeElement.classList.contains("flipped")?(this.el.nativeElement.classList.remove("flipped"),setTimeout(()=>{this.change.emit(!1)},m.f.settings.animations?1e3*m.f.settings.animationSpeed:0)):this.clicked?(this.el.nativeElement.classList.add("flipped"),setTimeout(()=>{this.change.emit(!0)},m.f.settings.animations?1e3*m.f.settings.animationSpeed:0),this.clicked=!1,this.el.nativeElement.classList.remove("confirm")):(this.clicked=!0,this.el.nativeElement.classList.add("confirm"))}onMouseLeave(){(!this.disabled||this.clicked)&&(this.clicked=!1,this.el.nativeElement.classList.remove("confirm"))}static \u0275fac=function(a){return new(a||i)(t.rXU(t.aKT))};static \u0275dir=t.FsC({type:i,selectors:[["","card-reveal",""]],hostBindings:function(a,n){1&a&&t.bIt("pointerdown",function(){return n.onClick()})("mouseleave",function(){return n.onMouseLeave()})},inputs:{disabled:"disabled"},outputs:{change:"change"},standalone:!1})}return i})(),Cn=(()=>{class i{transform(e,...a){return(0,V.n1)(e,-1!=a.indexOf("empty"))}static \u0275fac=function(a){return new(a||i)};static \u0275pipe=t.EJ8({name:"ghsValueSign",type:i,pure:!0,standalone:!1})}return i})(),Tt=(()=>{class i{transform(e,a,n=!1){e.length=0;for(let o=0;o<a;o++)e.push(n?a-o-1:o);return e}static \u0275fac=function(a){return new(a||i)};static \u0275pipe=t.EJ8({name:"ghsRange",type:i,pure:!0,standalone:!1})}return i})(),$o=(()=>{class i{transform(e){return Math.floor(e)}static \u0275fac=function(a){return new(a||i)};static \u0275pipe=t.EJ8({name:"ghsFloor",type:i,pure:!0,standalone:!1})}return i})(),dh=(()=>{class i{transform(e){return Math.ceil(e)}static \u0275fac=function(a){return new(a||i)};static \u0275pipe=t.EJ8({name:"ghsCeil",type:i,pure:!0,standalone:!1})}return i})(),hi=(()=>{class i{transform(e){return e<0?0:e}static \u0275fac=function(a){return new(a||i)};static \u0275pipe=t.EJ8({name:"ghsMinZero",type:i,pure:!0,standalone:!1})}return i})(),ia=(()=>{class i{transform(e,a=!1){return(0,V.T8)(e,a)}static \u0275fac=function(a){return new(a||i)};static \u0275pipe=t.EJ8({name:"ghsDurationLabel",type:i,pure:!0,standalone:!1})}return i})(),hh=(()=>{class i{transform(e,a){return e.filter(n=>{if(!a||""==a)return!0;a=a.toLowerCase();let o=n.index.toLowerCase(),g=0;for(;a.startsWith("0");)g++,a=a.replace("0","");for(let _=0;_<g;_++)o.length<(a="0"+a).length&&(o="0"+o);return!!o.includes(a)||m.f.getLabel(n.name).toLowerCase().includes(a)})}static \u0275fac=function(a){return new(a||i)};static \u0275pipe=t.EJ8({name:"ghsScenarioSearch",type:i,pure:!0,standalone:!1})}return i})();const _h=(i,r,e,a,n)=>({flipped:i,selected:r,disabled:e,filtered:a,fh:n}),mh=()=>[];function ph(i,r){1&i&&t.nrm(0,"img",11)}function uh(i,r){1&i&&t.nrm(0,"img",13)}function Ch(i,r){if(1&i&&(t.nrm(0,"div",7),t.j41(1,"div",8),t.nrm(2,"span",9),t.k0s(),t.j41(3,"div",10),t.Z7z(4,ph,1,0,"img",11,t.fX1),t.nI1(6,"ghsRange"),t.k0s(),t.j41(7,"div",12),t.EFF(8),t.nVh(9,uh,1,0,"img",13),t.k0s()),2&i){const e=t.XpG();t.Y8G("ghs-label","data.battleGoals."+e.battleGoal.cardId),t.R7$(2),t.Y8G("ghs-label","data.battleGoals."+e.battleGoal.cardId+".text"),t.R7$(2),t.Dyx(t.i5U(6,4,t.lJ4(7,mh),e.battleGoal.checks)),t.R7$(4),t.SpI(" ",e.battleGoal.cardId," "),t.R7$(),t.vxM(e.settingsManager.settings.fhStyle?9:-1)}}let aa=(()=>{class i{gameManager=s.E;settingsManager=m.f;battleGoal;identifier;flipped=!1;selected=!1;disabled=!1;filtered=!1;reveal=!1;ngOnChanges(e){e.identifier&&e.identifier.previousValue!=e.identifier.currentValue&&!this.battleGoal&&this.identifier&&(this.battleGoal=s.E.battleGoalManager.getBattleGoal(this.identifier))}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-battlegoal"]],inputs:{battleGoal:"battleGoal",identifier:"identifier",flipped:"flipped",selected:"selected",disabled:"disabled",filtered:"filtered",reveal:"reveal"},standalone:!1,features:[t.OA$],decls:8,vars:12,consts:[["container",""],[1,"battlegoal-container"],["card-reveal","",1,"card","vertical","reverse","battlegoal",3,"ngClass","disabled"],[1,"card-front"],[1,"card-back"],[1,"revealed"],[1,"text",3,"ghs-label"],[1,"name",3,"ghs-label"],[1,"text"],[1,"placeholder",3,"ghs-label"],[1,"checks"],["src","./assets/images/check.svg"],[1,"card-id"],["src","./assets/images/fh/battlegoals/winter.svg"]],template:function(a,n){if(1&a&&(t.j41(0,"div",1,0)(2,"div",2)(3,"div",3),t.nVh(4,Ch,10,8),t.k0s(),t.j41(5,"div",4)(6,"span",5),t.nrm(7,"span",6),t.k0s()()()()),2&a){const o=t.sdS(1);t.R7$(2),t.xc7("font-size",.072*o.offsetWidth+"px"),t.Y8G("ngClass",t.s1E(6,_h,n.flipped,n.selected,n.disabled,n.filtered,!!n.battleGoal&&"fh"==n.battleGoal.edition))("disabled",!n.reveal),t.R7$(2),t.vxM(n.battleGoal?4:-1),t.R7$(3),t.Y8G("ghs-label","game.cards.confirmReveal")}},dependencies:[N.YU,Be,tt,Tt],styles:[".battlegoal-container[_ngcontent-%COMP%]{position:relative;width:100%;padding-bottom:147%}.battlegoal[_ngcontent-%COMP%]{cursor:pointer;position:absolute;width:100%;height:100%;border:.2em solid transparent;border-radius:.5em}.battlegoal[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]{background-image:url(battle-goal-front.e7531094c588ed2e.png);background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:.5em}.battlegoal[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;top:22.5%;left:50%;width:60%;height:10%;display:flex;justify-content:center;align-items:center;transform:translate(-50%);font-family:var(--ghs-font-title);color:var(--ghs-color-black);font-size:1.5em}.battlegoal[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{position:absolute;top:30%;left:50%;width:55%;height:40%;display:flex;justify-content:center;align-items:center;text-align:center;transform:translate(-50%);font-family:var(--ghs-font-text);color:var(--ghs-color-black);font-size:1em;line-height:1em}.battlegoal[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]{position:absolute;top:70%;left:50%;width:60%;height:10%;display:flex;justify-content:center;align-items:center;transform:translate(-50%)}.battlegoal[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1.5em;width:auto;margin:0 .2em}.battlegoal[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{position:absolute;top:80%;left:50%;width:60%;height:10%;display:flex;justify-content:center;align-items:center;text-align:center;text-transform:uppercase;transform:translate(-50%);font-family:var(--ghs-font-normal);font-size:.75em;color:var(--ghs-color-white);filter:var(--ghs-filter-outline-thin)}.battlegoal[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]{background-image:url(battle-goal-back.d069b60d499428ec.png);background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:.5em}.battlegoal.confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center;text-align:center;color:var(--ghs-color-white);font-size:1.5em;filter:drop-shadow(calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) var(--ghs-color-black))}.battlegoal.confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{text-align:center}.battlegoal.disabled[_ngcontent-%COMP%]{cursor:initial}.battlegoal.selected[_ngcontent-%COMP%]{border-color:var(--ghs-color-green)}.battlegoal.filtered[_ngcontent-%COMP%]{border-color:var(--ghs-color-red)}.battlegoal.fh[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]{background-image:url(battle-goal-front-fh.9cbd213e8708b674.png)}.battlegoal.fh[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal)}.battlegoal.fh[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{color:var(--ghs-color-brown);filter:none;font-weight:700}.battlegoal.fh[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto;margin-left:.1em;filter:var(--ghs-filter-brown)}.battlegoal.fh[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]{background-image:url(battle-goal-back-fh.60856d4f807bfc05.png)}"]})}return i})();const Do=i=>({selected:i}),Mh=i=>[i],vh=i=>({disabled:i}),Oh=(i,r)=>r.cardId;function Ph(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",4)(1,"span",10),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.selectEdition(n))}),t.k0s(),t.j41(2,"span",6),t.EFF(3),t.k0s(),t.j41(4,"input",11),t.bIt("change",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.toggleEdition(n))}),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG();t.R7$(),t.Y8G("ghs-label","game.battleGoals.edition")("ghs-label-args",t.eq3(6,Mh,e))("ngClass",t.eq3(8,Do,e==a.currentEdition)),t.R7$(2),t.SpI("(",a.gameManager.battleGoalManager.getBattleGoalsForEdition(e).length,")"),t.R7$(),t.Y8G("checked",-1!=a.gameManager.game.battleGoalEditions.indexOf(e)||a.gameManager.editionRules(e,!1))("disabled",a.gameManager.editionRules(e,!1))}}function bh(i,r){1&i&&t.nrm(0,"span",8),2&i&&t.Y8G("ghs-label","game.battleGoals.setup.empty")}function kh(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-battlegoal",12),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.toggleFilter(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("battleGoal",e)("flipped",!0)("disabled",!a.selected(e)&&!a.filtered(e)||a.selectedAlias(e))("reveal",!1)("selected",!a.selectedAlias(e)&&a.selected(e))("filtered",a.filtered(e))("ngClass",t.eq3(7,vh,e.alias&&a.selectedAlias(e)))}}let _i=(()=>{class i{gameManager=s.E;currentEdition="";editions=[];battleGoals=[];constructor(){this.editions=s.E.battleGoalManager.getBattleGoalEditions(),s.E.game.edition&&-1!=s.E.battleGoalManager.getBattleGoalEditions().indexOf(s.E.game.edition)&&(!s.E.game.battleGoalEditions||0==s.E.game.battleGoalEditions.length||1==s.E.game.battleGoalEditions.length&&-1!=s.E.game.battleGoalEditions.indexOf(s.E.game.edition))&&this.selectEdition(s.E.game.edition),this.update()}selectedAlias(e){return e.alias&&null!=s.E.battleGoalManager.getBattleGoals().find(a=>e.alias&&a.edition==e.alias.edition&&a.name==e.alias.name)||!1}selectEdition(e=""){this.currentEdition=e,this.update()}update(){this.battleGoals=this.currentEdition?s.E.battleGoalManager.getBattleGoalsForEdition(this.currentEdition):s.E.battleGoalManager.getBattleGoals(!1,!0)}toggleEdition(e){s.E.editionRules(e,!1)||(s.E.game.battleGoalEditions=s.E.game.battleGoalEditions||[],s.E.game.filteredBattleGoals=s.E.game.filteredBattleGoals||[],s.E.stateManager.before("battleGoals.setup."+(-1==s.E.game.battleGoalEditions.indexOf(e)?"addEdition":"removeEdition"),e),-1==s.E.game.battleGoalEditions.indexOf(e)?s.E.game.battleGoalEditions.push(e):(s.E.game.battleGoalEditions=s.E.game.battleGoalEditions.filter(a=>a!=e),s.E.game.filteredBattleGoals=s.E.game.filteredBattleGoals.filter(a=>a.edition!=e)),s.E.stateManager.after(),this.update())}selected(e){return!this.filtered(e)&&(e.edition==s.E.game.edition||-1!=s.E.game.battleGoalEditions.indexOf(e.edition))}filtered(e){return null!=s.E.game.filteredBattleGoals.find(a=>a.edition==e.edition&&a.name==e.name)}toggleFilter(e){s.E.game.filteredBattleGoals=s.E.game.filteredBattleGoals||[],s.E.stateManager.before("battleGoals.setup.filter."+(this.filtered(e)?"addCard":"removeCard"),e.edition,e.name),this.filtered(e)?s.E.game.filteredBattleGoals=s.E.game.filteredBattleGoals.filter(a=>a.edition!=e.edition||a.name!=e.name):this.selected(e)&&!this.selectedAlias(e)&&s.E.game.filteredBattleGoals.push(new vt.gw(e.name,e.edition)),s.E.stateManager.after(),this.update()}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-battlegoal-setup"]],standalone:!1,decls:14,vars:7,consts:[[1,"battle-goals-setup-dialog"],[1,"scroll-container"],[1,"header",3,"ghs-label"],[1,"editions"],[1,"edition"],[1,"name",3,"click","ghs-label","ngClass"],[1,"size"],[1,"battle-goals"],[1,"warning",3,"ghs-label"],[1,"battlegoal",3,"battleGoal","flipped","disabled","reveal","selected","filtered","ngClass"],[1,"name",3,"click","ghs-label","ghs-label-args","ngClass"],["type","checkbox",3,"change","checked","disabled"],[1,"battlegoal",3,"click","battleGoal","flipped","disabled","reveal","selected","filtered","ngClass"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"div",2),t.j41(3,"div",3)(4,"div",4)(5,"span",5),t.bIt("click",function(){return n.selectEdition()}),t.k0s(),t.j41(6,"span",6),t.EFF(7),t.k0s()(),t.Z7z(8,Ph,5,10,"div",4,t.fX1),t.k0s(),t.j41(10,"div",7),t.nVh(11,bh,1,1,"span",8),t.Z7z(12,kh,1,9,"ghs-battlegoal",9,Oh),t.k0s()()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","game.battleGoals.setup"),t.R7$(3),t.Y8G("ghs-label","game.battleGoals.all")("ngClass",t.eq3(5,Do,""==n.currentEdition)),t.R7$(2),t.SpI("(",n.gameManager.battleGoalManager.getBattleGoals().length,")"),t.R7$(),t.Dyx(n.editions),t.R7$(3),t.vxM(0==n.battleGoals.length?11:-1),t.R7$(),t.Dyx(n.battleGoals))},dependencies:[N.YU,aa,tt],styles:[".battle-goals-setup-dialog[_ngcontent-%COMP%]{position:relative;width:100%}.battle-goals-setup-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.battle-goals-setup-dialog[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;flex-wrap:wrap}.battle-goals-setup-dialog[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.battle-goals-setup-dialog[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{cursor:pointer}.battle-goals-setup-dialog[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]   .name.selected[_ngcontent-%COMP%]{color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));font-weight:700}.battle-goals-setup-dialog[_ngcontent-%COMP%]   .battle-goals[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;margin:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.battle-goals-setup-dialog[_ngcontent-%COMP%]   .battle-goals[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-yellow)}.battle-goals-setup-dialog[_ngcontent-%COMP%]   .battle-goals[_ngcontent-%COMP%]   ghs-battlegoal[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 25 * var(--ghs-dialog-factor))}.battle-goals-setup-dialog[_ngcontent-%COMP%]   .battle-goals[_ngcontent-%COMP%]   ghs-battlegoal.disabled[_ngcontent-%COMP%]{opacity:.5}@media (max-width: 600px),(orientation: portrait){.battle-goals-setup-dialog[_ngcontent-%COMP%]   .battle-goals[_ngcontent-%COMP%]{flex-direction:column;align-items:center}}"]})}return i})();const yh=(i,r)=>[i,r],xh=i=>({disabled:i}),Eh=(i,r)=>r.cardId;function wh(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-battlegoal",7),t.bIt("singleClick",function(){const n=t.eBV(e).$index,o=t.XpG();return t.Njj(o.select(n))})("doubleClick",function(){const n=t.eBV(e).$index,o=t.XpG();return t.Njj(o.select(n,!0))}),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG();t.Y8G("battleGoal",e)("flipped",n.gameManager.roundManager.firstRound||n.selected==a||!n.character.battleGoal||-1!=n.revealed.indexOf(a)||n.trial349||n.trial356&&n.battleGoals.length>3&&a<n.battleGoals.length-2||n.cardOnly)("selected",n.selected==a||n.trial349||n.trial356&&n.battleGoals.length>3&&a<n.battleGoals.length-2)("reveal",!n.cardOnly&&n.gameManager.game.round>0&&n.selected!=a&&n.character.battleGoal&&-1==n.revealed.indexOf(a))("disabled",n.character.battleGoal&&!!n.gameManager.game.scenario&&n.gameManager.game.round>0||!1)}}function Rh(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",5)(1,"a",8),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.cancel())}),t.k0s(),t.j41(2,"a",9),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.accept())}),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","game.battleGoals.cancel"),t.R7$(),t.Y8G("ngClass",t.eq3(3,xh,-1==e.selected&&!e.trial349))("ghs-label","game.battleGoals.chooseCard")}}function jh(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",12),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.drawCards())}),t.k0s()}2&i&&t.Y8G("ghs-label","game.battleGoals.drawCards")}function Gh(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",12),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.drawCard())}),t.k0s()}2&i&&t.Y8G("ghs-label","game.battleGoals.drawCard")}function Th(i,r){1&i&&t.nrm(0,"p",11),2&i&&t.Y8G("ghs-label","game.battleGoals.drawUnavailable")}function Sh(i,r){if(1&i&&(t.j41(0,"div",6),t.nVh(1,jh,1,1,"a",10),t.nVh(2,Gh,1,1,"a",10),t.nVh(3,Th,1,1,"p",11),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.vxM(e.redrawAvailable?1:-1),t.R7$(),t.vxM(e.available?2:-1),t.R7$(),t.vxM(e.available&&e.redrawAvailable?-1:3)}}function $h(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",6)(1,"a",12),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.setup())}),t.k0s()()}2&i&&(t.R7$(),t.Y8G("ghs-label","game.battleGoals.setup"))}let oa=(()=>{class i{dialogRef;dialog;gameManager=s.E;battleGoals=[];revealed=[];character;selected;available=0;redrawAvailable=0;cardOnly=!1;trial349=!1;trial356=!1;constructor(e,a,n){this.dialogRef=a,this.dialog=n,this.character=e.character,this.selected=this.character.battleGoal?0:-1,this.cardOnly=e.cardOnly,0==s.E.battleGoalManager.getBattleGoals().length?this.dialog.open(_i,{panelClass:["dialog"]}).closed.subscribe({next:()=>{this.available=s.E.battleGoalManager.getUnrevealedBattleGoals().length,this.redrawAvailable=s.E.battleGoalManager.getUnrevealedBattleGoals(this.character).length,this.redrawAvailable>(s.E.fhRules()||m.f.settings.battleGoalsFh?2:1)&&e.draw?this.drawCards():this.close()}}):e.draw?(this.available=s.E.battleGoalManager.getUnrevealedBattleGoals().length,this.redrawAvailable=s.E.battleGoalManager.getUnrevealedBattleGoals(this.character).length,this.drawCards()):this.update(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.character=s.E.game.figures.find(o=>o instanceof q.K&&o.edition==this.character.edition&&o.name==this.character.name)||this.character,this.selected=this.character.battleGoal?0:-1,this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}drawCards(){this.redrawAvailable&&(s.E.stateManager.before("battleGoals.drawCards",s.E.characterManager.characterName(this.character)),this.character.battleGoals=[],this.character.battleGoal=!1,s.E.battleGoalManager.drawBattleGoal(this.character),(!s.E.trialsManager.apply||!s.E.trialsManager.activeTrial("fh",360))&&(s.E.battleGoalManager.drawBattleGoal(this.character),(s.E.fhRules()||m.f.settings.battleGoalsFh)&&s.E.battleGoalManager.drawBattleGoal(this.character)),s.E.stateManager.after()),this.update()}update(){this.available=s.E.battleGoalManager.getUnrevealedBattleGoals().length,this.redrawAvailable=s.E.battleGoalManager.getUnrevealedBattleGoals(this.character).length,this.battleGoals=this.character.battleGoals.map(e=>s.E.battleGoalManager.getBattleGoal(e)).filter(e=>e).map(e=>e),this.character.battleGoal&&-1==this.revealed.indexOf(0)&&this.revealed.push(0),this.trial349=s.E.trialsManager.apply&&s.E.trialsManager.trialsEnabled&&this.character.progress.trial&&"fh"==this.character.progress.trial.edition&&"349"==this.character.progress.trial.name||!1,this.trial356=s.E.trialsManager.apply&&s.E.trialsManager.trialsEnabled&&this.character.progress.trial&&"fh"==this.character.progress.trial.edition&&"356"==this.character.progress.trial.name||!1}drawCard(){this.available&&(s.E.stateManager.before("battleGoals.drawCard",s.E.characterManager.characterName(this.character)),s.E.battleGoalManager.drawBattleGoal(this.character,this.trial356),s.E.stateManager.after()),this.update()}select(e,a=!1){!this.cardOnly&&(a||!this.character.battleGoal||s.E.roundManager.firstRound)&&!this.trial349&&(-1==this.revealed.indexOf(e)&&this.revealed.push(e),-1!=this.selected&&-1==this.revealed.indexOf(this.selected)&&this.revealed.push(this.selected),this.selected=this.selected==e?-1:e)}setup(){this.dialog.open(_i,{panelClass:["dialog"]}).closed.subscribe({next:()=>{s.E.battleGoalManager.getBattleGoals().length<(s.E.fhRules()||m.f.settings.battleGoalsFh?3:2)?this.close():this.update()}})}accept(){((-1!=this.selected||this.trial349)&&!this.character.battleGoal||0!=this.selected&&this.character.battleGoal)&&(s.E.stateManager.before("battleGoals."+(-1!=this.selected||this.trial349?"select":"deselect"),s.E.characterManager.characterName(this.character)),this.trial349?this.character.battleGoal=!0:-1!=this.selected?(this.character.battleGoal=!0,(0,D.HD)(this.character.battleGoals,this.selected,0)):this.character.battleGoal=!1,s.E.stateManager.after()),this.close()}cancel(){this.selected=this.character.battleGoal?0:-1,this.close()}close(){(0,V.co)(this.dialogRef)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-character-battlegoals"]],standalone:!1,decls:9,vars:8,consts:[[1,"battle-goals-dialog"],[1,"scroll-container"],[1,"header",3,"ghs-label","ghs-label-args"],[1,"battle-goals"],["ghs-pointer-input","",3,"battleGoal","flipped","selected","reveal","disabled"],[1,"menu"],[1,"menu","small"],["ghs-pointer-input","",3,"singleClick","doubleClick","battleGoal","flipped","selected","reveal","disabled"],[1,"cancel",3,"click","ghs-label"],[1,"accept",3,"click","ngClass","ghs-label"],[3,"ghs-label"],[1,"empty-hint",3,"ghs-label"],[3,"click","ghs-label"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"div",2),t.j41(3,"div",3),t.Z7z(4,wh,1,5,"ghs-battlegoal",4,Eh),t.k0s(),t.nVh(6,Rh,3,5,"div",5),t.nVh(7,Sh,4,3,"div",6),t.nVh(8,$h,2,1,"div",6),t.k0s()()),2&a&&(t.R7$(2),t.Y8G("ghs-label",n.character.battleGoal?"game.battleGoals.chosen":"game.battleGoals.choose")("ghs-label-args",t.l_i(5,yh,n.character.name,n.gameManager.characterManager.characterName(n.character))),t.R7$(2),t.Dyx(n.battleGoals),t.R7$(2),t.vxM(n.character.battleGoal&&0==n.selected?-1:6),t.R7$(),t.vxM(n.cardOnly?-1:7),t.R7$(),t.vxM(n.cardOnly?-1:8))},dependencies:[N.YU,aa,tt,rt],styles:[".battle-goals-dialog[_ngcontent-%COMP%]{position:relative}.battle-goals-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{text-align:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.battle-goals-dialog[_ngcontent-%COMP%]   .battle-goals[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;margin:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.battle-goals-dialog[_ngcontent-%COMP%]   .battle-goals[_ngcontent-%COMP%]   ghs-battlegoal[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 27 * var(--ghs-dialog-factor))}@media (max-width: 600px),(orientation: portrait){.battle-goals-dialog[_ngcontent-%COMP%]   .battle-goals[_ngcontent-%COMP%]{flex-direction:column;align-items:center}}.battle-goals-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor)) 0;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly;align-items:center}.battle-goals-dialog[_ngcontent-%COMP%]   .menu.small[_ngcontent-%COMP%]{justify-content:center;margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor)) 0;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.7 * var(--ghs-dialog-factor))}.battle-goals-dialog[_ngcontent-%COMP%]   .menu.small[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{min-width:auto}.battle-goals-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;min-width:33%;display:flex;justify-content:center;margin:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.battle-goals-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.battle-goals-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.accept[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.battle-goals-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.battle-goals-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-darkgray)}.battle-goals-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .empty-hint[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}"]})}return i})();var Rt=M(76066),oe=M(56719),Ye=M(47172),Dh=M(9168),zt=M(81570);const Ih=i=>({hint:i});let Ah=(()=>{class i{value="";args=[];argLabel=!0;style=!1;relative=!1;size;hint=!1;static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-tooltip"]],inputs:{value:"value",args:[0,"ghs-label-args","args"],argLabel:[0,"ghs-label-args-replace","argLabel"],style:"style",relative:"relative",size:"size",hint:"hint"},standalone:!1,decls:2,vars:11,consts:[[3,"ngClass"],[1,"placeholder","text-white",3,"ghs-label","ghs-label-args","ghs-label-args-replace","relative"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nrm(1,"span",1),t.k0s()),2&a&&(t.HbH(n.size),t.Y8G("ngClass",t.eq3(9,Ih,n.hint)),t.R7$(),t.Aen(n.style),t.Y8G("ghs-label",n.value)("ghs-label-args",n.args)("ghs-label-args-replace",n.argLabel)("relative",n.relative))},dependencies:[N.YU,tt],styles:['[_nghost-%COMP%]{display:block;z-index:3000}div[_ngcontent-%COMP%]{position:relative;font-size:calc(var(--ghs-unit) * 2.2 * var(--ghs-text-factor));font-weight:200;margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor)) calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));padding:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor)) calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));max-width:calc(var(--ghs-unit) * 50 * var(--ghs-text-factor))}div[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:0;background-color:var(--ghs-color-darkgray);border-radius:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));opacity:.9;z-index:0}div[_ngcontent-%COMP%]   .placeholder[_ngcontent-%COMP%]{z-index:1}div.hint[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray);border-radius:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));background-color:var(--ghs-color-black)}div.small[_ngcontent-%COMP%]{font-weight:100;font-size:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor)) calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));padding:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor)) calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}div.large[_ngcontent-%COMP%]{font-weight:400;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor)) calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));padding:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor)) calc(var(--ghs-unit) * 4 * var(--ghs-text-factor))}'],data:{animation:[(0,Ye.hZ)("tooltip",[(0,Ye.kY)(":enter",[(0,Ye.iF)({opacity:0}),(0,Ye.i0)(300,(0,Ye.iF)({opacity:1}))]),(0,Ye.kY)(":leave",[(0,Ye.i0)(300,(0,Ye.iF)({opacity:0}))])])]},changeDetection:0})}return i})(),ft=(()=>{class i{overlay;overlayPositionBuilder;elementRef;value="";args=[];argLabel=!0;style=!1;relative=!1;size;hint=!1;toggable=!0;originX;originY;overlayX;overlayY;offsetX=0;offsetY=0;delay=0;disabled=!1;overlayRef;timeout;constructor(e,a,n){this.overlay=e,this.overlayPositionBuilder=a,this.elementRef=n}ngOnInit(){const e=this.overlayPositionBuilder.flexibleConnectedTo(this.elementRef).withPositions([{originX:this.originX||"start",originY:this.originY||"bottom",overlayX:this.overlayX||(this.hint?"center":"start"),overlayY:this.overlayY||"top",offsetX:this.offsetX,offsetY:this.offsetY}]);this.overlayRef=this.overlay.create({positionStrategy:e}),this.overlayRef.hostElement.style.zIndex="3000",this.timeout=null}show(){!this.disabled&&(m.f.settings.tooltips||!this.toggable)&&this.value&&!this.overlayRef.hasAttached()&&!this.timeout&&(this.timeout=setTimeout(()=>{const e=this.overlayRef.attach(new Dh.A8(Ah));e.instance.value=this.value,e.instance.args=this.args.map(a=>""+a),e.instance.argLabel=this.argLabel,e.instance.style=this.style,e.instance.relative=this.relative,e.instance.size=this.size,e.instance.hint=this.hint},this.delay||!this.hint&&500||1))}hide(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.overlayRef.hasAttached()&&this.overlayRef.detach()}ngOnDestroy(){this.hide(),this.overlayRef.dispose()}static \u0275fac=function(a){return new(a||i)(t.rXU(zt.hJ),t.rXU(zt.lF),t.rXU(t.aKT))};static \u0275dir=t.FsC({type:i,selectors:[["","ghs-tooltip",""]],hostBindings:function(a,n){1&a&&t.bIt("mouseover",function(){return n.show()})("mouseleave",function(){return n.hide()})},inputs:{value:[0,"ghs-tooltip","value"],args:[0,"ghs-label-args","args"],argLabel:[0,"ghs-label-args-replace","argLabel"],style:"style",relative:"relative",size:"size",hint:"hint",toggable:"toggable",originX:"originX",originY:"originY",overlayX:"overlayX",overlayY:"overlayY",offsetX:"offsetX",offsetY:"offsetY",delay:"delay",disabled:"disabled"},standalone:!1})}return i})();const Vh=i=>({fh:i}),Io=i=>({disabled:i}),Fh=(i,r)=>({active:i,immunity:r}),Xh=i=>({stack:i}),Ao=i=>({active:i}),Bh=(i,r)=>r.name;function Yh(i,r){if(1&i){const e=t.RV6();t.j41(0,"img",10),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.dec(n))}),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(1,Io,a.getValue(e)<=1))}}function Nh(i,r){if(1&i&&(t.j41(0,"span",6),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(2,Xh,-1!=e.types.indexOf(a.ConditionType.stack))),t.R7$(),t.JRh(a.getValue(e))}}function zh(i,r){1&i&&t.nrm(0,"span",7)}function Lh(i,r){if(1&i){const e=t.RV6();t.j41(0,"img",11),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.inc(n))}),t.k0s()}}function Uh(i,r){1&i&&t.nrm(0,"div",9)}function qh(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",2),t.nVh(1,Yh,1,3,"img",3),t.j41(2,"span",4),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.toggleCondition(n))}),t.nrm(3,"img",5),t.nVh(4,Nh,2,4,"span",6),t.k0s(),t.nVh(5,zh,1,0,"span",7),t.nVh(6,Lh,1,0,"img",8),t.k0s(),t.nVh(7,Uh,1,0,"div",9)}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG();t.Y8G("ngClass",t.eq3(13,Io,!n.hasCondition(e)&&(!n.immunityEnabled&&n.isImmune(e.name)&&!n.permanentEnabled&&!n.isPermanent(e.name)||n.isImmune(e.name,!0)))),t.R7$(),t.vxM(-1!=e.types.indexOf(n.ConditionType.stack)||-1!=e.types.indexOf(n.ConditionType.upgrade)?1:-1),t.R7$(),t.Y8G("ghs-tooltip","game.condition."+e.name+".hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom")("ngClass",t.l_i(15,Fh,!n.immunityEnabled&&n.hasCondition(e)||n.immunityEnabled&&-1!=n.immunities.indexOf(e.name),n.isImmune(e.name))),t.R7$(),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+e.name+".svg",t.B4B),t.R7$(),t.vxM(-1!=e.types.indexOf(n.ConditionType.stack)||-1!=e.types.indexOf(n.ConditionType.upgrade)?4:-1),t.R7$(),t.vxM(n.isPermanent(e.name)?5:-1),t.R7$(),t.vxM(-1!=e.types.indexOf(n.ConditionType.stack)||-1!=e.types.indexOf(n.ConditionType.upgrade)?6:-1),t.R7$(),t.vxM(-1!=n.conditionSeparator.indexOf(a)?7:-1)}}function Hh(i,r){if(1&i){const e=t.RV6();t.nrm(0,"div",9),t.j41(1,"a",12)(2,"span",13),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.togglePermanentEnabled())}),t.nrm(3,"img",14),t.k0s()(),t.j41(4,"a",12)(5,"span",13),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleImmunityEnabled())}),t.nrm(6,"img",5),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("ngClass",t.eq3(13,Ao,e.permanentEnabled))("ghs-tooltip","game.condition.permanent.hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("ngClass",t.eq3(15,Ao,e.immunityEnabled))("ghs-tooltip","game.condition.immune.hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom"),t.R7$(),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh/condition/immune.svg":"/condition/immunity.svg"),t.B4B)}}let mi=(()=>{class i{entityConditions;immunities;entity;entities;figure;type;columns=3;empower=!1;enfeeble=!1;onChange=new t.bkB;gameManager=s.E;settingsManager=m.f;ConditionType=j.GV;conditions=[];conditionSeparator=[];monsterType=!1;permanentEnabled=!1;immunityEnabled=!1;timeout;numberStore=0;ngOnInit(){if(this.initializeConditions(),this.entities){const e=this.entities.map(a=>a instanceof Rt.I&&a.type).filter((a,n,o)=>a&&o.indexOf(a)==n);1==e.length&&(this.monsterType=e[0])}this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.initializeConditions()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}onKeyPress(e){if(m.f.settings.keyboardShortcuts&&e.key in["0","1","2","3","4","5","6","7","8","9"]){const a=+e.key;this.timeout?(clearTimeout(this.timeout),this.numberStore=10*this.numberStore+a,this.selectCondition()):a>0&&10*a<=this.conditions.length+3?(this.numberStore=a,this.timeout=setTimeout(()=>{this.selectCondition()},1e3)):(this.numberStore=0==a?10:a,this.selectCondition()),e.preventDefault(),e.stopPropagation()}}selectCondition(){const e=this.numberStore;if(!(this.figure instanceof mt.$e)||this.figure.escort){let a;e<=this.conditions.length?a=this.conditions[e-1]:e==this.conditions.length+1?(this.permanentEnabled=!this.permanentEnabled,this.immunityEnabled=!1):e==this.conditions.length+2&&(this.immunityEnabled=!this.immunityEnabled,this.permanentEnabled=!1),a&&(!this.isImmune(a.name)||this.immunityEnabled&&!s.E.entityManager.isImmune(this.entity,this.figure,a.name,!0))&&this.toggleCondition(a)}this.timeout=void 0,this.numberStore=-1}initializeConditions(){this.conditions=[],this.conditionSeparator=[];let e=[];e.push(...s.E.conditionsForTypes("standard","negative",this.type)),e.push(...s.E.conditionsForTypes("upgrade","negative",this.type)),e.push(...s.E.conditionsForTypes("stack","negative",this.type)),e=e.filter((o,g,_)=>_.map(y=>y.name).indexOf(o.name)==g),e.length&&this.conditions.push(...e);let a=[];a.push(...s.E.conditionsForTypes("standard","positive",this.type)),a.push(...s.E.conditionsForTypes("upgrade","positive",this.type)),a.push(...s.E.conditionsForTypes("stack","positive",this.type)),a=a.filter((o,g,_)=>_.map(y=>y.name).indexOf(o.name)==g),a.length&&(this.conditionSeparator.push(this.conditions.length-1),this.conditions.push(...a));let n=[];n.push(...s.E.conditionsForTypes("standard","neutral",this.type)),n.push(...s.E.conditionsForTypes("upgrade","neutral",this.type)),n.push(...s.E.conditionsForTypes("stack","neutral",this.type)),n=n.filter((o,g,_)=>_.map(y=>y.name).indexOf(o.name)==g),n.length&&(this.conditionSeparator.push(this.conditions.length-1),this.conditions.push(...n)),this.immunityEnabled&&(this.conditionSeparator.push(this.conditions.length-1),this.conditions.push(new j.kW(j.r5.curse)),this.enfeeble&&this.conditions.push(new j.kW(j.r5.enfeeble)),this.conditions.push(new j.kW(j.r5.bless)),this.empower&&this.conditions.push(new j.kW(j.r5.empower)))}hasCondition(e,a=!1,n=!1){return this.entityConditions?this.entityConditions.some(o=>o.name==e.name&&o.state!=j.mg.removed&&!o.expired&&(!this.permanentEnabled||(a||this.permanentEnabled)&&o.permanent)):this.entity?s.E.entityManager.hasCondition(this.entity,e,a||this.permanentEnabled):this.entities.every(o=>s.E.entityManager.hasCondition(o,e,a||this.permanentEnabled))}isImmune(e,a=!1){let n=!1;return this.immunities&&!a&&(n=-1!=this.immunities.indexOf(e)),n||(this.entity?n=s.E.entityManager.isImmune(this.entity,this.figure,e,!0):this.entities&&(n=this.entities.every(o=>s.E.entityManager.isImmune(o,this.figure,e,!0)))),n}isPermanent(e){return!!this.entityConditions&&this.entityConditions.some(a=>a.name==e&&a.permanent&&!a.expired)}inc(e){e.name==j.r5.plague&&3==e.value||(e.value=this.getValue(e)+1,this.checkUpdate(e),this.onChange.emit(this.entityConditions))}dec(e){e.value=this.getValue(e)-1,e.value<1&&(e.value=1),this.checkUpdate(e),this.onChange.emit(this.entityConditions)}getValue(e){const a=this.entityConditions.find(n=>n.name==e.name&&!n.expired);return a?a.value:e.value}checkUpdate(e){const a=this.entityConditions.find(n=>n.name==e.name&&!n.expired);a&&(a.value=e.value)}toggleCondition(e,a=!1){if(this.immunityEnabled&&!a)-1==this.immunities.indexOf(e.name)?this.immunities.push(e.name):this.immunities.splice(this.immunities.indexOf(e.name),1);else{if(this.hasCondition(e,a||this.permanentEnabled)){let n=this.entityConditions.find(o=>o.name==e.name&&(!a||o.permanent));n&&(n.expired=!0,n.lastState=n.state,n.state=j.mg.removed)}else{let n=this.entityConditions.find(o=>o.name==e.name&&(!a||o.permanent));n?(n.expired=!1,n.lastState=n.state,n.state=j.mg.new):(n=new j.BR(e.name,e.value),n.lastState=n.state,n.state=j.mg.new,this.entityConditions.push(n)),n.permanent=a||this.permanentEnabled}this.onChange.emit(this.entityConditions)}}togglePermanentEnabled(){this.permanentEnabled=!this.permanentEnabled,this.immunityEnabled=!1,this.initializeConditions()}toggleImmunityEnabled(){this.immunityEnabled=!this.immunityEnabled,this.permanentEnabled=!1,this.initializeConditions()}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-conditions"]],hostBindings:function(a,n){1&a&&t.bIt("keydown",function(g){return n.onKeyPress(g)},t.EBC)},inputs:{entityConditions:"entityConditions",immunities:"immunities",entity:"entity",entities:"entities",figure:"figure",type:"type",columns:"columns",empower:"empower",enfeeble:"enfeeble"},outputs:{onChange:"conditionChange"},standalone:!1,decls:5,vars:6,consts:[[3,"ngClass"],[1,"condition-container"],[1,"item",3,"ngClass"],["tabclick","","src","./assets/images/left.svg",1,"ghs-svg","dec",3,"ngClass"],["tabclick","",1,"condition",3,"click","ghs-tooltip","originX","overlayX","originY","overlayY","ngClass"],[3,"src"],[1,"value",3,"ngClass"],[1,"condition","permanent","permanent-overlay"],["tabclick","","src","./assets/images/right.svg",1,"ghs-svg","inc"],[1,"separator"],["tabclick","","src","./assets/images/left.svg",1,"ghs-svg","dec",3,"click","ngClass"],["tabclick","","src","./assets/images/right.svg",1,"ghs-svg","inc",3,"click"],[1,"item"],["tabclick","",1,"condition","toggle",3,"click","ngClass","ghs-tooltip","originX","overlayX","originY","overlayY"],["src","./assets/images/condition/permanent.svg"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.Z7z(2,qh,8,18,null,null,Bh),t.nVh(4,Hh,7,17),t.k0s()()),2&a&&(t.xc7("--condition-columns",n.columns),t.Y8G("ngClass",t.eq3(4,Vh,n.settingsManager.settings.fhStyle)),t.R7$(2),t.Dyx(n.conditions),t.R7$(2),t.vxM(n.conditions.length?4:-1))},dependencies:[N.YU,ft,At],styles:['.condition-container[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));display:grid;grid-template-columns:repeat(var(--condition-columns),calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor)));column-gap:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));row-gap:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));align-items:center;justify-items:center;margin-bottom:auto;margin-bottom:calc(var(--ghs-unit) / 4 * var(--ghs-dialog-factor));max-height:calc(var(--ghs-unit) * 65 * var(--ghs-dialog-factor))}.condition-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{grid-column:span var(--condition-columns);width:100%;border-top:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) solid var(--ghs-color-darkgray)}.item[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor))}.item.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray);filter:brightness(.5) grayscale(.2)}.item.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}.item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{cursor:pointer;display:flex;position:relative;width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));z-index:1}.item[_ngcontent-%COMP%]   .condition.permanent-overlay[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));pointer-events:none;z-index:2}.item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:after{pointer-events:none;content:" ";height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}.item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:auto}.item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);position:absolute;bottom:0;left:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));transform:translate(-50%)}.item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value.stack[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));bottom:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor))}.item[_ngcontent-%COMP%]   .condition.active[_ngcontent-%COMP%]:after{border:calc(var(--ghs-unit) / 4) var(--ghs-color-white) solid;border-radius:100%}.item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:hover:after{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.item[_ngcontent-%COMP%]   .condition.active[_ngcontent-%COMP%]:hover:after{border:calc(var(--ghs-unit) / 5) var(--ghs-color-red) solid}.item[_ngcontent-%COMP%]   .condition.toggle[_ngcontent-%COMP%]{justify-content:center;align-items:center}.item[_ngcontent-%COMP%]   .condition.toggle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:70%;width:auto}.item[_ngcontent-%COMP%]   .dec[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .inc[_ngcontent-%COMP%]{cursor:pointer;position:absolute;width:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow);top:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));transform:translateY(-50%)}.item[_ngcontent-%COMP%]   .dec.dec[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .inc.dec[_ngcontent-%COMP%]{left:0}.item[_ngcontent-%COMP%]   .dec.inc[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .inc.inc[_ngcontent-%COMP%]{right:0}.item[_ngcontent-%COMP%]   .dec.disabled[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .inc.disabled[_ngcontent-%COMP%]{pointer-events:none;filter:var(--ghs-filter-darkgray)}']})}return i})();const Vo=(i,r)=>({"negative-value":i,"positive-value":r}),sa=i=>({inactive:i}),Kh=(i,r,e)=>({active:i,new:r,center:e}),Wh=(i,r)=>r.number;function Jh(i,r){if(1&i&&t.nrm(0,"img",17),2&i){const e=t.XpG(2);t.Y8G("src",e.gameManager.monsterManager.monsterThumbnail(e.monster),t.B4B)}}function Zh(i,r){1&i&&(t.j41(0,"span",19),t.nrm(1,"span",18),t.EFF(2,"\xa0"),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","game.ally"))}function Qh(i,r){1&i&&(t.j41(0,"span",20),t.nrm(1,"span",18),t.EFF(2,"\xa0"),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","game.allied"))}function t_(i,r){if(1&i&&t.nrm(0,"span",21),2&i){const e=t.XpG(2);t.Y8G("ghs-label","(%game.monsterType."+e.data.type+"%)")}}function e_(i,r){if(1&i&&(t.j41(0,"div",1),t.nVh(1,Jh,1,1,"img",17),t.nrm(2,"span",18),t.EFF(3,"\xa0 "),t.nVh(4,Zh,3,1,"span",19),t.nVh(5,Qh,3,1,"span",20),t.nVh(6,t_,1,1,"span",21),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.vxM(!e.monster.noThumbnail&&e.settingsManager.settings.artwork?1:-1),t.R7$(),t.Y8G("ghs-label","data.monster."+e.monster.name),t.R7$(2),t.vxM(e.monster.isAlly?4:-1),t.R7$(),t.vxM(e.monster.isAllied?5:-1),t.R7$(),t.vxM(e.data.type?6:-1)}}function n_(i,r){if(1&i&&(t.j41(0,"span",1),t.nrm(1,"img",22),t.j41(2,"span"),t.EFF(3),t.k0s()()),2&i){const e=t.XpG();t.R7$(),t.Y8G("src",e.character.iconUrl,t.B4B),t.R7$(2),t.JRh(e.gameManager.characterManager.characterName(e.character,!0))}}function i_(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",25),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.toggleEntity(n))}),t.EFF(1),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG();t.HbH(t.VkB("entity ",a.gameManager.toMonsterEntity(e).type)),t.Y8G("ngClass",t.eq3(5,sa,-1==a.entities.indexOf(e))),t.R7$(),t.JRh(e.number)}}function a_(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function o_(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2).$implicit,a=t.XpG();t.R7$(),t.JRh(a.gameManager.toSummon(e).number)}}function s_(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",26),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.toggleEntity(n))}),t.j41(1,"span",27),t.nrm(2,"img",28),t.j41(3,"span",29),t.nVh(4,a_,2,0,"span"),t.nVh(5,o_,2,1,"span"),t.k0s()()()}if(2&i){const e=t.XpG().$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(6,sa,-1==a.entities.indexOf(e))),t.R7$(),t.Y8G("ngClass",t.sMw(8,Kh,a.gameManager.toSummon(e).state==a.SummonState.true,a.gameManager.toSummon(e).state==a.SummonState.new,a.gameManager.toSummon(e).entityConditions.length%2==0)),t.R7$(),t.Y8G("src",t.VkB("./assets/images/summons/",a.gameManager.toSummon(e).color,".png"),t.B4B),t.R7$(2),t.vxM(0==a.gameManager.toSummon(e).number?4:-1),t.R7$(),t.vxM(a.gameManager.toSummon(e).number>0?5:-1)}}function r_(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",26),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.toggleEntity(n))}),t.j41(1,"span",30),t.EFF(2),t.k0s()()}if(2&i){const e=t.XpG().$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(2,sa,-1==a.entities.indexOf(e))),t.R7$(2),t.SpI(" ",a.gameManager.toObjectiveEntity(e).number," ")}}function c_(i,r){if(1&i&&(t.nVh(0,i_,2,7,"div",23),t.nVh(1,s_,6,12,"div",24),t.nVh(2,r_,3,4,"div",24)),2&i){const e=t.XpG();t.vxM(e.monster?0:-1),t.R7$(),t.vxM(e.character?1:-1),t.R7$(),t.vxM(e.objective?2:-1)}}function l_(i,r){if(1&i&&t.nrm(0,"ghs-conditions",11),2&i){const e=t.XpG();t.Y8G("entityConditions",e.entityConditions)("immunities",e.entityImmunities)("entities",e.entities)("figure",e.monster)("type","monster")("columns",4)}}function g_(i,r){if(1&i&&t.nrm(0,"ghs-conditions",11),2&i){const e=t.XpG();t.Y8G("entityConditions",e.entityConditions)("immunities",e.entityImmunities)("entities",e.entities)("figure",e.character)("type","monster")("columns",4)}}function d_(i,r){if(1&i&&t.nrm(0,"ghs-conditions",11),2&i){const e=t.XpG();t.Y8G("entityConditions",e.entityConditions)("immunities",e.entityImmunities)("entities",e.entities)("figure",e.objective)("type",e.objective.escort?"character":"objective")("columns",4)}}function h_(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",31),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleType())}),t.nrm(1,"span",18)(2,"img",32)(3,"span",18),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","%game.monsterType.normal%"),t.R7$(2),t.Y8G("ghs-label","%game.monsterType.elite%"))}let ra=(()=>{class i{data;dialogRef;gameManager=s.E;settingsManager=m.f;health=0;maxHealth=0;ConditionName=j.r5;ConditionType=j.GV;MonsterType=S.N;entities;allEntities=[];entityConditions=[];initialImmunities=[];entityImmunities=[];monster;character;objective;SummonState=lt.N5;EntityValueFunction=$.hZ;constructor(e,a){this.data=e,this.dialogRef=a,this.data.monster?(this.monster=this.data.monster,this.allEntities=this.monster.entities.filter(n=>!e.type||n.type==e.type)):this.data.character?(this.character=this.data.character,this.allEntities=this.character.summons):this.data.objective&&(this.objective=this.data.objective,this.allEntities=this.objective.entities),this.dialogRef.closed.subscribe({next:n=>{n||this.close()}}),this.entities=[],this.allEntities.forEach(n=>this.entities.push(n)),this.update()}keyboardShortcuts(e){m.f.settings.keyboardShortcuts&&!e.altKey&&!e.metaKey&&(!window.document.activeElement||"INPUT"!=window.document.activeElement.tagName&&"SELECT"!=window.document.activeElement.tagName&&"TEXTAREA"!=window.document.activeElement.tagName)&&(e.ctrlKey||e.shiftKey||"ArrowRight"!==e.key?e.ctrlKey||e.shiftKey||"ArrowLeft"!==e.key?e.ctrlKey||e.shiftKey||"ArrowUp"!==e.key?e.ctrlKey||e.shiftKey||"ArrowDown"!==e.key?!e.ctrlKey&&!e.shiftKey&&("k"===e.key.toLowerCase()||"d"===e.key.toLowerCase())&&(this.toggleDead(),e.preventDefault(),e.stopPropagation()):(this.changeMaxHealth(-1),e.preventDefault(),e.stopPropagation()):(this.changeMaxHealth(1),e.preventDefault(),e.stopPropagation()):(this.changeHealth(-1),e.preventDefault(),e.stopPropagation()):(this.changeHealth(1),e.preventDefault(),e.stopPropagation()))}update(){this.entityConditions=[],this.entities.forEach((e,a,n)=>{e.entityConditions.forEach(o=>{!this.entityConditions.find(g=>g.name==o.name)&&n.every(g=>g.entityConditions.find(_=>_.name==o.name&&_.state==o.state))&&this.entityConditions.push(JSON.parse(JSON.stringify(o)))}),e.immunities.forEach(o=>{!this.entityImmunities.find(g=>g==o)&&n.every(g=>g.immunities.find(_=>_==o))&&(this.entityImmunities.push(o),this.initialImmunities.push(o))})})}toggleEntity(e){-1==this.entities.indexOf(e)?this.entities.push(e):this.entities.splice(this.entities.indexOf(e),1),this.update()}changeHealth(e){this.health+=e}changeMaxHealth(e){this.maxHealth+=e}toggleType(){if(this.monster){const e=this.monster.stats.find(n=>this.monster&&n.level==this.monster.level&&n.type==S.N.normal),a=this.monster.stats.find(n=>this.monster&&n.level==this.monster.level&&n.type==S.N.elite);e&&a?(s.E.stateManager.before("toggleTypeAll","monster."+this.monster.name),this.entities.forEach(n=>{this.monster&&s.E.entityManager.isAlive(n)&&n instanceof Rt.I&&(n.type=n.type==S.N.elite?S.N.normal:S.N.elite,n.maxHealth=(0,$.hZ)(n.type==S.N.normal?e.health:a.health,this.monster.level),(n.health>n.maxHealth||n.health<n.maxHealth&&n.health==(0,$.hZ)(n.type==S.N.normal?a.health:e.health,this.monster.level))&&(n.health=n.maxHealth))}),s.E.stateManager.after()):console.warn("Missing stats!",this.monster)}}toggleDead(){this.monster?s.E.stateManager.before("monsterDead","monster."+this.monster.name,this.data.type?"monster."+this.data.type+" ":""):this.character?s.E.stateManager.before("summonsDead",s.E.characterManager.characterName(this.character)):this.objective&&s.E.stateManager.before("objectivesDead",s.E.objectiveManager.objectiveName(this.objective)),this.entities.forEach(e=>{e.dead=!0}),setTimeout(()=>{this.entities.forEach(e=>{(s.E.game.state==T.mk.draw||0==e.entityConditions.length||e.entityConditions.every(a=>-1==a.types.indexOf(j.GV.turn)&&-1==a.types.indexOf(j.GV.apply)))&&(this.monster&&e instanceof Rt.I?s.E.monsterManager.removeMonsterEntity(this.monster,e):this.character&&e instanceof lt.up?s.E.characterManager.removeSummon(this.character,e):this.objective&&e instanceof oe.X&&s.E.objectiveManager.removeObjectiveEntity(this.objective,e))}),this.entities.every(e=>!s.E.entityManager.isAlive(e))&&this.monster&&this.monster.active&&s.E.roundManager.toggleFigure(this.monster),s.E.stateManager.after(),s.E.uiChange.emit()},m.f.settings.animations?1500*m.f.settings.animationSpeed:0),(0,V.co)(this.dialogRef,!0)}close(){if(this.entityConditions.filter(e=>e.state==j.mg.new||e.state==j.mg.removed).forEach(e=>{this.monster?s.E.stateManager.before(...s.E.entityManager.undoInfos(void 0,this.monster,e.state==j.mg.removed?"removeCondition":"addCondition"),e.name,this.data.type?"monster."+this.data.type+" ":""):this.character?s.E.stateManager.before(e.state==j.mg.removed?"removeCondition.summons":"addCondition.summons",s.E.characterManager.characterName(this.character),e.name):this.objective&&s.E.stateManager.before(e.state==j.mg.removed?"removeCondition.objectives":"addCondition.objectives",s.E.objectiveManager.objectiveName(this.objective),e.name),this.entities.forEach(a=>{e.expired=e.state==j.mg.new,e.state==j.mg.removed?s.E.entityManager.removeCondition(a,this.monster||this.character||this.objective||new P.R(new mn.f),e,e.permanent):(this.monster&&!s.E.entityManager.isImmune(a,this.monster,e.name)||this.character||this.objective)&&s.E.entityManager.addCondition(a,this.monster||this.character||this.objective||new P.R(new mn.f),e,e.permanent)}),s.E.stateManager.after()}),this.entityConditions.forEach(e=>{this.entities.find(a=>a.entityConditions.find(n=>n.name==e.name&&!n.expired&&n.value!=e.value))&&(this.monster?s.E.stateManager.before(...s.E.entityManager.undoInfos(void 0,this.monster,"setConditionValue"),e.name,""+e.value,this.data.type?"monster."+this.data.type+" ":""):this.character?s.E.stateManager.before("setConditionValue.summons",s.E.characterManager.characterName(this.character),e.name,""+e.value):this.objective&&s.E.stateManager.before("setConditionValue.objectives",s.E.objectiveManager.objectiveName(this.objective),e.name,""+e.value),this.entities.forEach(a=>{const n=a.entityConditions.find(o=>o.name==e.name&&!o.expired);n&&n.value!=e.value&&(n.value=e.value)}),s.E.stateManager.after())}),this.initialImmunities.forEach(e=>{-1==this.entityImmunities.indexOf(e)&&(this.monster?s.E.stateManager.before(...s.E.entityManager.undoInfos(void 0,this.monster,"removeImmunity"),e,this.data.type?"monster."+this.data.type+" ":""):this.character?s.E.stateManager.before("removeImmunity.summons",s.E.characterManager.characterName(this.character),e):this.objective&&s.E.stateManager.before("removeImmunity.objectives",s.E.objectiveManager.objectiveName(this.objective),e),this.entities.forEach(a=>{a.immunities=a.immunities.filter(n=>n!=e)}),s.E.stateManager.after())}),this.entityImmunities.forEach(e=>{-1==this.initialImmunities.indexOf(e)&&(this.monster?s.E.stateManager.before(...s.E.entityManager.undoInfos(void 0,this.monster,"addImmunity"),e,this.data.type?"monster."+this.data.type+" ":""):this.character?s.E.stateManager.before("addImmunity.summons",s.E.characterManager.characterName(this.character),e):this.objective&&s.E.stateManager.before("addImmunity.objectives",s.E.objectiveManager.objectiveName(this.objective),e),this.entities.forEach(a=>{a.immunities.push(e)}),s.E.stateManager.after())}),0!=this.health){this.monster?s.E.stateManager.before("changeMonsterHP","monster."+this.monster.name,(0,V.n1)(this.health),this.data.type?"monster."+this.data.type+" ":""):this.character?s.E.stateManager.before("changeSummonsHP",s.E.characterManager.characterName(this.character),(0,V.n1)(this.health)):this.objective&&s.E.stateManager.before("changeObjectivesHP",s.E.objectiveManager.objectiveName(this.objective),(0,V.n1)(this.health));let e=[];this.entities.forEach(a=>{0!=this.health&&(this.monster?s.E.entityManager.changeHealth(a,this.monster,this.health):this.character?s.E.entityManager.changeHealth(a,this.character,this.health):this.objective&&s.E.entityManager.changeHealth(a,this.objective,this.health)),(a.maxHealth>0&&a.health<=0||a.dead)&&(a.dead=0==a.entityConditions.length||a.entityConditions.every(n=>!n.highlight||-1==n.types.indexOf(j.GV.turn)&&-1==n.types.indexOf(j.GV.apply)),e.push(a))}),this.health=0,e.length>0?setTimeout(()=>{e.forEach(a=>{a.dead&&(this.monster&&a instanceof Rt.I?s.E.monsterManager.removeMonsterEntity(this.monster,a):this.character&&a instanceof lt.up?s.E.characterManager.removeSummon(this.character,a):this.objective&&a instanceof oe.X&&s.E.objectiveManager.removeObjectiveEntity(this.objective,a))}),this.entities.every(a=>!s.E.entityManager.isAlive(a))&&(this.monster&&this.monster.active&&s.E.roundManager.toggleFigure(this.monster),this.objective&&s.E.objectiveManager.removeObjective(this.objective)),this.objective&&0==this.objective.entities.length&&s.E.objectiveManager.removeObjective(this.objective),s.E.stateManager.after()},m.f.settings.animations?1500*m.f.settings.animationSpeed:0):s.E.stateManager.after()}0!=this.maxHealth&&(this.monster?s.E.stateManager.before("changeMonsterMaxHP","monster."+this.monster.name,(0,V.n1)(this.health),this.data.type?"monster."+this.data.type+" ":""):this.character?s.E.stateManager.before("changeSummonsMaxHP",s.E.characterManager.characterName(this.character),(0,V.n1)(this.health)):this.objective&&(s.E.stateManager.before("changeObjectivesMaxHP",s.E.objectiveManager.objectiveName(this.objective),(0,V.n1)(this.health)),this.objective.health=(0,V.n1)(this.health)),this.entities.forEach(e=>{e.health==e.maxHealth&&(e.health+=this.maxHealth),e.maxHealth+=this.maxHealth,e.health>e.maxHealth&&(e.health=e.maxHealth)}),s.E.stateManager.after())}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-entities-menu-dialog"]],hostBindings:function(a,n){1&a&&t.bIt("keydown",function(g){return n.keyboardShortcuts(g)},t.EBC)},standalone:!1,decls:35,vars:30,consts:[[1,"entity-menu-dialog","scroll-container"],[1,"name"],[1,"entities"],[1,"entity-container"],[1,"item"],["tabclick","",1,"button",3,"singleClick","repeat"],["src","./assets/images/minus.svg",1,"ghs-svg"],[1,"item",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/status/health.svg"],[1,"badge","health-count",3,"ngClass"],["src","./assets/images/plus.svg",1,"ghs-svg"],[3,"entityConditions","immunities","entities","figure","type","columns"],["tabclick","",1,"button",3,"click"],["src","./assets/images/status/dead.svg"],[1,"item","max-health-container"],["src","./assets/images/status/health.svg",3,"ghs-label","ghs-label-attribute"],["tabclick","",1,"toggle-type"],[1,"standee",3,"src"],[3,"ghs-label"],[1,"ally"],[1,"allied"],[1,"monster-type",3,"ghs-label"],[1,"icon","character-icon",3,"src"],["tabclick","",3,"class","ngClass"],["tabclick","",1,"entity",3,"ngClass"],["tabclick","",3,"click","ngClass"],["tabclick","",1,"entity",3,"click","ngClass"],[1,"summon-image",3,"ngClass"],[3,"src"],[1,"summon-number"],[1,"objective-marker"],["tabclick","",1,"toggle-type",3,"click"],["src","./assets/images/switch.svg",1,"ghs-svg"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nVh(1,e_,7,5,"div",1),t.nVh(2,n_,4,2,"span",1),t.j41(3,"div",2),t.Z7z(4,c_,3,3,null,null,Wh),t.k0s(),t.j41(6,"div",3)(7,"span",4)(8,"ghs-pointer-input",5),t.bIt("singleClick",function(){return n.changeHealth(-1)}),t.nrm(9,"img",6),t.k0s()(),t.j41(10,"span",7),t.nrm(11,"img",8),t.j41(12,"span",9),t.EFF(13),t.nI1(14,"ghsValueSign"),t.k0s()(),t.j41(15,"span",4)(16,"ghs-pointer-input",5),t.bIt("singleClick",function(){return n.changeHealth(1)}),t.nrm(17,"img",10),t.k0s()()(),t.nVh(18,l_,1,6,"ghs-conditions",11),t.nVh(19,g_,1,6,"ghs-conditions",11),t.nVh(20,d_,1,6,"ghs-conditions",11),t.j41(21,"div",3)(22,"span",7)(23,"a",12),t.bIt("click",function(){return n.toggleDead()}),t.nrm(24,"img",13),t.k0s()(),t.j41(25,"span",14)(26,"ghs-pointer-input",5),t.bIt("singleClick",function(){return n.changeMaxHealth(-1)}),t.nrm(27,"img",6),t.k0s(),t.nrm(28,"img",15),t.j41(29,"span",9),t.EFF(30),t.nI1(31,"ghsValueSign"),t.k0s(),t.j41(32,"ghs-pointer-input",5),t.bIt("singleClick",function(){return n.changeMaxHealth(1)}),t.nrm(33,"img",10),t.k0s()()(),t.nVh(34,h_,4,2,"span",16),t.k0s()),2&a&&(t.R7$(),t.vxM(n.monster?1:-1),t.R7$(),t.vxM(n.character?2:-1),t.R7$(2),t.Dyx(n.allEntities),t.R7$(4),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-label","game.health")("ghs-label-attribute","title"),t.R7$(2),t.Y8G("ngClass",t.l_i(24,Vo,n.health<0,n.health>0)),t.R7$(),t.JRh(t.bMT(14,20,n.health)),t.R7$(3),t.Y8G("repeat",!0),t.R7$(2),t.vxM(n.monster?18:-1),t.R7$(),t.vxM(n.character?19:-1),t.R7$(),t.vxM(n.objective?20:-1),t.R7$(2),t.Y8G("ghs-label","game.dead")("ghs-label-attribute","title"),t.R7$(4),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-label","game.maxHealth")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ngClass",t.l_i(27,Vo,n.maxHealth<0,n.maxHealth>0)),t.R7$(),t.JRh(t.bMT(31,22,n.maxHealth)),t.R7$(2),t.Y8G("repeat",!0),t.R7$(2),t.vxM(n.monster?34:-1))},dependencies:[N.YU,mi,tt,rt,At,Cn],styles:['.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));width:auto;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   img.standee[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top-left-radius:30%;border-top-right-radius:30%;height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));width:auto}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap;margin:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor)) auto;max-width:calc(var(--ghs-unit) * 28 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]{position:relative;cursor:pointer;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-white);border-radius:100%;font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   .entity.normal[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   .entity.elite[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   .entity.boss[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   .entity.inactive[_ngcontent-%COMP%]{filter:none;opacity:.7;border-color:transparent}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]:hover{filter:none;opacity:.7;border-color:var(--ghs-color-gray)}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-image[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 4);height:calc(var(--ghs-unit) * 4);transition:top calc(var(--ghs-animation-speed) * .5s) ease-out,left calc(var(--ghs-animation-speed) * .5s) ease-out}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-image.new[_ngcontent-%COMP%]:before{content:" ";display:block;position:absolute;width:calc(var(--ghs-unit) * 4);height:calc(var(--ghs-unit) * 4);background-image:url(minus.97c98a810771fceb.svg);background-size:cover;z-index:2}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-image[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%]{position:absolute;display:flex;justify-content:center;align-items:center;top:0;left:calc(var(--ghs-unit) * -.1);height:calc(var(--ghs-unit) * 4);width:calc(var(--ghs-unit) * 2);font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5);color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray);border-top-left-radius:calc(var(--ghs-unit) * 4);border-bottom-left-radius:calc(var(--ghs-unit) * 4);z-index:3;opacity:.9}.entity-menu-dialog[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor)));align-content:space-between}.entity-menu-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   .max-health-container[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:space-evenly;grid-column:2 span;width:calc(var(--ghs-unit) * 14 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   .max-health-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:auto}.entity-menu-dialog[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.entity-menu-dialog[_ngcontent-%COMP%]   span.item[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.entity-menu-dialog[_ngcontent-%COMP%]   a.button[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.entity-menu-dialog[_ngcontent-%COMP%]   a.button[_ngcontent-%COMP%]:hover, .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.button[_ngcontent-%COMP%]:hover{opacity:.4}.entity-menu-dialog[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.entity-menu-dialog[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}.entity-menu-dialog[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:auto}.entity-menu-dialog[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0;color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));text-shadow:var(--ghs-outline);text-align:center}.toggle-type[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer;color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}']})}return i})();var bt=M(72941),Fo=M(58503);const __=["characterSheet"],m_=i=>({denied:i});let Re=(()=>{class i{data;dialogRef;characterSheet;settingsManager=m.f;constructor(e,a){this.data=e,this.dialogRef=a,this.dialogRef.closed.subscribe({next:()=>{this.characterSheet.applyValues()}})}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-character-sheet-dialog"]],viewQuery:function(a,n){if(1&a&&t.GBs(__,5),2&a){let o;t.mGM(o=t.lsd())&&(n.characterSheet=o.first)}},standalone:!1,decls:7,vars:9,consts:[["characterSheet",""],[1,"light","character-sheet-dialog"],[1,"scroll-container"],[1,"lock-toggle",3,"ghs-tooltip","ngClass"],["ghs-pointer-input","",3,"singleClick"],[3,"src"],[3,"character","editable","forceEdit","dialogRef"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"a",4),t.bIt("singleClick",function(){return t.eBV(o),t.Njj(n.settingsManager.toggle("characterSheetLocked"))}),t.nrm(4,"img",5),t.k0s()(),t.nrm(5,"ghs-character-sheet",6,0),t.k0s()()}2&a&&(t.R7$(2),t.Y8G("ghs-tooltip","character.progress.lock")("ngClass",t.eq3(7,m_,n.data.viewOnly&&!n.data.forceEdit)),t.R7$(2),t.Y8G("src","./assets/images/lock"+(n.settingsManager.settings.characterSheetLocked||n.data.viewOnly&&!n.data.forceEdit?"":"-open")+".svg",t.B4B),t.R7$(),t.Y8G("character",n.data.character)("editable",!n.data.viewOnly)("forceEdit",n.data.forceEdit)("dialogRef",n.dialogRef))},styles:[".character-sheet-dialog[_ngcontent-%COMP%]{position:relative;background-color:var(--ghs-color-white)}.character-sheet-dialog[_ngcontent-%COMP%]   ghs-character-sheet[_ngcontent-%COMP%]{display:block}.character-sheet-dialog[_ngcontent-%COMP%]   .lock-toggle[_ngcontent-%COMP%]{position:sticky;top:0;left:0;width:100%;height:0;overflow:visible;display:flex;justify-content:flex-end;z-index:2}.character-sheet-dialog[_ngcontent-%COMP%]   .lock-toggle[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 3.2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3.2 * var(--ghs-dialog-factor))}.character-sheet-dialog[_ngcontent-%COMP%]   .lock-toggle[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.character-sheet-dialog[_ngcontent-%COMP%]   .lock-toggle.permissive[_ngcontent-%COMP%]{opacity:.6}"]})}return i})();const Xo=i=>[i],p_=i=>({disabled:i}),u_=()=>[],f_=i=>({selected:i}),C_=(i,r)=>r.edition+"-"+r.name;function M_(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",7),t.bIt("click",function(){const n=t.eBV(e).$index,o=t.XpG();return t.Njj(o.toggleSelect(n))}),t.nrm(1,"img",8),t.j41(2,"span",9),t.EFF(3),t.k0s()()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG();t.Y8G("ngClass",t.eq3(3,f_,n.selected==a)),t.R7$(),t.Y8G("src",e.iconUrl,t.B4B),t.R7$(2),t.SpI(" ",n.gameManager.characterManager.characterName(e,!0)," ")}}let Bo=(()=>{class i{data;dialogRef;gameManager=s.E;selected=0;characters;type;constructor(e,a){this.data=e,this.dialogRef=a,this.characters=e.characters,this.type=e.type}toggleSelect(e){this.selected=this.selected==e?-1:e}close(e=void 0){(0,V.co)(this.dialogRef,e)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-additional-am-select-dialog"]],standalone:!1,decls:10,vars:13,consts:[[3,"ghs-label","ghs-label-args"],[1,"characters"],[1,"character",3,"ngClass"],[1,"menu"],[1,"cancel",3,"click"],[3,"ghs-label"],[1,"select",3,"click","ngClass"],[1,"character",3,"click","ngClass"],[1,"icon",3,"src"],[1,"name"]],template:function(a,n){1&a&&(t.j41(0,"p"),t.nrm(1,"span",0),t.k0s(),t.j41(2,"div",1),t.Z7z(3,M_,4,5,"div",2,C_),t.k0s(),t.j41(5,"div",3)(6,"a",4),t.bIt("click",function(){return n.close()}),t.nrm(7,"span",5),t.k0s(),t.j41(8,"a",6),t.bIt("click",function(){return n.close(n.selected)}),t.nrm(9,"span",0),t.k0s()()),2&a&&(t.R7$(),t.Y8G("ghs-label","game.attackModifiers.additional.dialog")("ghs-label-args",t.eq3(6,Xo,n.type)),t.R7$(2),t.Dyx(n.characters),t.R7$(4),t.Y8G("ghs-label","cancel"),t.R7$(),t.Y8G("ngClass",t.eq3(8,p_,-1==n.selected)),t.R7$(),t.Y8G("ghs-label",-1==n.selected?"game.attackModifiers.additional.select":"game.attackModifiers.additional.apply")("ghs-label-args",-1!=n.selected?t.eq3(10,Xo,n.characters[n.selected].title||"%data.character."+n.characters[n.selected].edition+"."+n.characters[n.selected].name+"%"):t.lJ4(12,u_)))},dependencies:[N.YU,tt],styles:["p[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.8 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-align:center}.characters[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);margin:.25em;padding:.25em;border:1px solid transparent}.characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:1.5em;height:auto;margin-right:.2em;filter:grayscale(.7)}.characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]:hover{color:var(--ghs-color-darkgray);border-color:var(--ghs-color-darkgray)}.characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]:hover   .icon[_ngcontent-%COMP%]{filter:grayscale(.3)}.characters[_ngcontent-%COMP%]   .character.selected[_ngcontent-%COMP%]{color:var(--ghs-color-white);border-color:var(--ghs-color-gray)}.characters[_ngcontent-%COMP%]   .character.selected[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{filter:none}.menu[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;color:var(--ghs-color-green);margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-gray)}.menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.5;color:var(--ghs-color-gray)}"]})}return i})();const Yo=i=>({highlight:i});function v_(i,r){if(1&i&&(t.j41(0,"kbd",1),t.nI1(1,"ghsFloor"),t.j41(2,"span"),t.EFF(3),t.nI1(4,"ghsFloor"),t.k0s()()),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(6,Yo,t.bMT(1,2,e.entityIndex/10)==e.gameManager.stateManager.keyboardSelect)),t.R7$(3),t.JRh(t.bMT(4,4,e.entityIndex/10))}}function O_(i,r){if(1&i&&(t.j41(0,"span",0),t.nVh(1,v_,5,8,"kbd",1),t.j41(2,"kbd",1)(3,"span"),t.EFF(4),t.k0s()()()),2&i){const e=t.XpG();t.R7$(),t.vxM(e.entityIndex>=10?1:-1),t.R7$(),t.Y8G("ngClass",t.eq3(3,Yo,e.entityIndex<10&&e.entityIndex==e.gameManager.stateManager.keyboardSelect)),t.R7$(2),t.JRh(e.entityIndex%10)}}let pi=(()=>{class i{gameManager=s.E;entity;show=!1;entityIndex=-1;ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.entityIndex=s.E.entityManager.getIndexForEntity(this.entity,"w"===s.E.stateManager.keyboardSelecting),-1!=this.entityIndex&&this.entityIndex++}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-entity-index-key"]],inputs:{entity:"entity",show:"show"},standalone:!1,decls:1,vars:1,consts:[[1,"key-container"],[3,"ngClass"]],template:function(a,n){1&a&&t.nVh(0,O_,5,5,"span",0),2&a&&t.vxM(n.gameManager.stateManager.keyboardSelecting||n.show?0:-1)},dependencies:[N.YU,$o],styles:[".key-container[_ngcontent-%COMP%]{position:absolute;display:flex;min-width:calc(var(--ghs-unit) * 10);max-width:calc(var(--ghs-unit) * 10);font-size:calc(var(--ghs-unit) * 2.5);z-index:999}"]})}return i})(),Fn=(()=>{class i{el;value=0;colored=!0;empty=!0;hideEmpty=!1;reverse=!1;invert=!1;container=!1;constructor(e){this.el=e,this.update()}ngOnChanges(e){this.update()}update(){this.el.nativeElement.innerHTML=(0,V.n1)(this.reverse?-this.value:this.value,this.empty),this.container&&(this.el.nativeElement.innerHTML='<span class="value">'+(0,V.n1)(this.reverse?-this.value:this.value,this.empty)+"</span>"),this.el.nativeElement.classList.remove("hide-zero-value","positive-value","negative-value"),0==this.value&&this.hideEmpty?this.el.nativeElement.classList.add("hide-zero-value"):this.colored&&(!this.invert&&this.value>0||this.invert&&this.value<0?this.el.nativeElement.classList.add("positive-value"):(!this.invert&&this.value<0||this.invert&&this.value>0)&&this.el.nativeElement.classList.add("negative-value"))}static \u0275fac=function(a){return new(a||i)(t.rXU(t.aKT))};static \u0275dir=t.FsC({type:i,selectors:[["","value-sign",""]],inputs:{value:[0,"value-sign","value"],colored:"colored",empty:"empty",hideEmpty:"hideEmpty",reverse:"reverse",invert:"invert",container:"container"},standalone:!1,features:[t.OA$]})}return i})();const P_=["charactertitle"],b_=["objectiveTitle"],k_=["summonTitle"],y_=i=>({absent:i}),x_=i=>({"change-entity":i}),E_=i=>({fh:i}),Dt=i=>({disabled:i}),ui=i=>({"immunity disabled":i}),No=i=>({empty:i}),Mn=i=>({active:i}),w_=(i,r,e)=>({active:i,new:r,fh:e}),R_=i=>({"disabled soft":i}),j_=(i,r)=>({active:i,new:r}),ca=()=>[],G_=i=>({deactivated:i}),T_=i=>({"active-tag":i}),S_=i=>({bb:i}),zo=(i,r)=>r.type+i,$_=(i,r)=>r.name;function D_(i,r){if(1&i&&t.nrm(0,"ghs-entity-index-key",4),2&i){const e=t.XpG();t.Y8G("entity",e.data.entity)("show",!0)}}function I_(i,r){if(1&i){const e=t.RV6();t.nrm(0,"span",12),t.j41(1,"img",13),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleCharacterMarker())}),t.k0s(),t.j41(2,"span",14),t.EFF(3),t.k0s(),t.nrm(4,"span",12),t.j41(5,"img",15),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleCharacterAbsent())}),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("src",e.gameManager.toCharacter(e.data.figure).iconUrl,t.B4B),t.R7$(),t.Y8G("ngClass",t.eq3(6,y_,e.gameManager.toCharacter(e.data.figure).absent)),t.R7$(),t.JRh(e.gameManager.characterManager.characterName(e.gameManager.toCharacter(e.data.figure),!0)),t.R7$(2),t.Y8G("src","./assets/images/status/"+(e.gameManager.toCharacter(e.data.figure).absent?"absent":"present")+".svg",t.B4B)("ghs-label",e.gameManager.toCharacter(e.data.figure).absent?"character.present":"character.absent")("ghs-label-attribute","title")}}function A_(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.JRh(e.gameManager.toObjectiveContainer(e.data.figure).title)}}function V_(i,r){if(1&i&&t.nrm(0,"span",17),2&i){const e=t.XpG(2);t.Y8G("ghs-label","data.objective."+e.gameManager.toObjectiveContainer(e.data.figure).name)}}function F_(i,r){if(1&i&&t.nrm(0,"span",17),2&i){const e=t.XpG(2);t.Y8G("ghs-label",e.gameManager.toObjectiveContainer(e.data.figure).escort?"escort":"objective")}}function X_(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1," \xa0( "),t.nrm(2,"span",17),t.EFF(3," ) "),t.k0s()),2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label",e.gameManager.toObjectiveContainer(e.data.figure).escort?"escort":"objective")}}function B_(i,r){if(1&i&&(t.nrm(0,"img",16),t.nVh(1,A_,2,1,"span"),t.nVh(2,V_,1,1,"span",17),t.nVh(3,F_,1,1,"span",17),t.nVh(4,X_,4,1,"span")),2&i){const e=t.XpG();t.Y8G("src","./assets/images/objective/"+(e.gameManager.toObjectiveContainer(e.data.figure).escort?"escort":"objective")+".svg",t.B4B),t.R7$(),t.vxM(e.gameManager.toObjectiveContainer(e.data.figure).title?1:-1),t.R7$(),t.vxM(!e.gameManager.toObjectiveContainer(e.data.figure).title&&e.gameManager.toObjectiveContainer(e.data.figure).name?2:-1),t.R7$(),t.vxM(e.gameManager.toObjectiveContainer(e.data.figure).title||e.gameManager.toObjectiveContainer(e.data.figure).name?-1:3),t.R7$(),t.vxM(e.gameManager.toObjectiveContainer(e.data.figure).title?4:-1)}}function Y_(i,r){if(1&i&&t.nrm(0,"img",19),2&i){const e=t.XpG(2);t.Y8G("src",e.gameManager.monsterManager.monsterThumbnail(e.gameManager.toMonster(e.data.figure)),t.B4B)}}function N_(i,r){1&i&&(t.j41(0,"span",20),t.nrm(1,"span",17),t.EFF(2,"\xa0"),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","game.ally"))}function z_(i,r){1&i&&(t.j41(0,"span",21),t.nrm(1,"span",17),t.EFF(2,"\xa0"),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","game.allied"))}function L_(i,r){if(1&i&&(t.j41(0,"span",22),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2);t.Y8G("ngClass",e.gameManager.toMonsterEntity(e.data.entity).type+(e.bb?" bb-"+e.gameManager.toMonsterEntity(e.data.entity).number:"")),t.R7$(),t.SpI("#",e.gameManager.toMonsterEntity(e.data.entity).number)}}function U_(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",18),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeMonsterEntity())}),t.nVh(1,Y_,1,1,"img",19),t.nrm(2,"span",17),t.EFF(3,"\xa0 "),t.nVh(4,N_,3,1,"span",20),t.nVh(5,z_,3,1,"span",21),t.nVh(6,L_,2,2,"span",22),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(6,x_,e.gameManager.monsterManager.monsterStandeeMax(e.gameManager.toMonster(e.data.figure))>1||e.data.entity&&e.gameManager.isMonsterEntity(e.data.entity)&&e.gameManager.toMonsterEntity(e.data.entity).type!=e.MonsterType.boss)),t.R7$(),t.vxM(!e.gameManager.toMonster(e.data.figure).noThumbnail&&e.settingsManager.settings.artwork?1:-1),t.R7$(),t.Y8G("ghs-label","data.monster."+e.data.figure.name),t.R7$(2),t.vxM(e.gameManager.toMonster(e.data.figure).isAlly?4:-1),t.R7$(),t.vxM(e.gameManager.toMonster(e.data.figure).isAllied?5:-1),t.R7$(),t.vxM(e.data.entity&&e.gameManager.isMonsterEntity(e.data.entity)?6:-1)}}function q_(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.JRh(e.gameManager.toCharacter(e.data.figure).title)}}function H_(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1,"\xa0("),t.nrm(2,"span",17),t.EFF(3,")"),t.k0s()),2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","data.character."+e.data.figure.edition+"."+e.data.figure.name)}}function K_(i,r){if(1&i&&t.nrm(0,"span",17),2&i){const e=t.XpG(2);t.Y8G("ghs-label","data.character."+e.data.figure.edition+"."+e.data.figure.name)}}function W_(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.SpI("",e.gameManager.toSummon(e.data.entity).title,"\xa0")}}function J_(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"("),t.k0s())}function Z_(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,")"),t.k0s())}function Q_(i,r){if(1&i&&(t.j41(0,"span"),t.nVh(1,J_,2,0,"span"),t.nrm(2,"span",17),t.nVh(3,Z_,2,0,"span"),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.vxM(e.gameManager.toSummon(e.data.entity).title?1:-1),t.R7$(),t.Y8G("ghs-label","data.summon."+e.gameManager.toSummon(e.data.entity).name),t.R7$(),t.vxM(e.gameManager.toSummon(e.data.entity).title?3:-1)}}function tm(i,r){1&i&&(t.j41(0,"span"),t.nrm(1,"span",17),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","game.summon"))}function em(i,r){if(1&i&&t.nrm(0,"img",24),2&i){const e=t.XpG(2);t.Y8G("src",t.VkB("./assets/images/summons/",e.gameManager.toSummon(e.data.entity).color,".png"),t.B4B)}}function nm(i,r){if(1&i&&(t.j41(0,"small"),t.nrm(1,"img",16),t.nVh(2,q_,2,1,"span"),t.nVh(3,H_,4,1,"span"),t.nVh(4,K_,1,1,"span",17),t.k0s(),t.nVh(5,W_,2,1,"span"),t.nVh(6,Q_,4,3,"span"),t.nVh(7,tm,2,1,"span"),t.j41(8,"span",23),t.nVh(9,em,1,2,"img",24),t.j41(10,"span",25),t.EFF(11),t.k0s()()),2&i){const e=t.XpG();t.R7$(),t.Y8G("src",e.gameManager.toCharacter(e.data.figure).iconUrl,t.B4B),t.R7$(),t.vxM(e.gameManager.toCharacter(e.data.figure).title?2:-1),t.R7$(),t.vxM(e.gameManager.toCharacter(e.data.figure).title?3:-1),t.R7$(),t.vxM(e.gameManager.toCharacter(e.data.figure).title?-1:4),t.R7$(),t.vxM(e.gameManager.toSummon(e.data.entity).title?5:-1),t.R7$(),t.vxM(e.gameManager.toSummon(e.data.entity).name?6:-1),t.R7$(),t.vxM(e.gameManager.toSummon(e.data.entity).name?-1:7),t.R7$(),t.Y8G("ngClass",t.eq3(10,E_,e.gameManager.toSummon(e.data.entity).color==e.SummonColor.fh)),t.R7$(),t.vxM(e.gameManager.toSummon(e.data.entity).color!=e.SummonColor.fh?9:-1),t.R7$(2),t.JRh(e.gameManager.toSummon(e.data.entity).number)}}function im(i,r){if(1&i&&(t.j41(0,"div",27),t.nrm(1,"ghs-action",33),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(),t.Y8G("action",e)("highlight",a.settingsManager.settings.statAnimations)}}function am(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",34)(1,"ghs-pointer-input",40),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(4);return t.Njj(n.changeLoot(-1))}),t.nrm(2,"img",36),t.k0s()(),t.j41(3,"span",30)(4,"span",37),t.EFF(5),t.k0s(),t.nrm(6,"img",45)(7,"span",43),t.k0s(),t.j41(8,"span",34)(9,"ghs-pointer-input",35),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(4);return t.Njj(n.changeLoot(1))}),t.nrm(10,"img",41),t.k0s()()}if(2&i){const e=t.XpG(4);t.R7$(),t.Y8G("ngClass",t.eq3(8,Dt,e.gameManager.toCharacter(e.data.entity).loot+e.loot==0))("repeat",!0),t.R7$(2),t.Y8G("ghs-label","game.loot")("ghs-label-attribute","title"),t.R7$(2),t.JRh(e.gameManager.toCharacter(e.data.entity).loot+e.loot),t.R7$(2),t.Y8G("value-sign",e.loot)("hideEmpty",!0),t.R7$(2),t.Y8G("repeat",!0)}}function om(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",34)(1,"ghs-pointer-input",40),t.bIt("singleClick",function(){const n=t.eBV(e).$index,o=t.XpG(4);return t.Njj(o.changeCharacterToken(-1,n))}),t.nrm(2,"img",36),t.k0s()(),t.j41(3,"span",44)(4,"span",37),t.EFF(5),t.k0s(),t.nrm(6,"span",17)(7,"span",43),t.k0s(),t.j41(8,"span",34)(9,"ghs-pointer-input",35),t.bIt("singleClick",function(){const n=t.eBV(e).$index,o=t.XpG(4);return t.Njj(o.changeCharacterToken(1,n))}),t.nrm(10,"img",41),t.k0s()()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(4);t.R7$(),t.Y8G("ngClass",t.eq3(9,Dt,n.gameManager.toCharacter(n.data.entity).tokenValues[a]+n.characterTokenValues[a]==0))("repeat",!0),t.R7$(2),t.Y8G("ghs-label","data.character."+n.gameManager.toCharacter(n.data.entity).edition+"."+n.gameManager.toCharacter(n.data.entity).name+".tokens."+e)("ghs-label-attribute","title"),t.R7$(2),t.JRh(n.gameManager.toCharacter(n.data.entity).tokenValues[a]+n.characterTokenValues[a]),t.R7$(),t.Y8G("ghs-label","%data.characterToken."+n.gameManager.toCharacter(n.data.entity).name+"."+e+"%"),t.R7$(),t.Y8G("value-sign",n.characterTokenValues[a])("hideEmpty",!0),t.R7$(2),t.Y8G("repeat",!0)}}function sm(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",34)(1,"ghs-pointer-input",40),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.changeExperience(-1))}),t.nrm(2,"img",36),t.k0s()(),t.j41(3,"span",30)(4,"span",37),t.EFF(5),t.k0s(),t.nrm(6,"img",42)(7,"span",43),t.k0s(),t.j41(8,"span",34)(9,"ghs-pointer-input",35),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.changeExperience(1))}),t.nrm(10,"img",41),t.k0s()(),t.nVh(11,am,11,10),t.j41(12,"span",34)(13,"ghs-pointer-input",40),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.changeCharacterToken(-1))}),t.nrm(14,"img",36),t.k0s()(),t.j41(15,"span",44)(16,"span",37),t.EFF(17),t.k0s(),t.nrm(18,"span",17)(19,"span",43),t.k0s(),t.j41(20,"span",34)(21,"ghs-pointer-input",35),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.changeCharacterToken(1))}),t.nrm(22,"img",41),t.k0s()(),t.Z7z(23,om,11,11,null,null,t.fX1)}if(2&i){const e=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(18,Dt,e.gameManager.toCharacter(e.data.entity).experience+e.experience==0))("repeat",!0),t.R7$(2),t.Y8G("ghs-label","game.experience")("ghs-label-attribute","title"),t.R7$(2),t.JRh(e.gameManager.toCharacter(e.data.entity).experience+e.experience),t.R7$(2),t.Y8G("value-sign",e.experience)("hideEmpty",!0),t.R7$(2),t.Y8G("repeat",!0),t.R7$(2),t.vxM(e.settingsManager.settings.lootDeck&&(e.settingsManager.settings.alwaysLootDeck||e.gameManager.fhRules())||e.settingsManager.settings.hideCharacterLoot?-1:11),t.R7$(2),t.Y8G("ngClass",t.eq3(20,Dt,e.gameManager.toCharacter(e.data.entity).token+e.characterToken==0))("repeat",!0),t.R7$(2),t.Y8G("ghs-label","character.token")("ghs-label-attribute","title"),t.R7$(2),t.JRh(e.gameManager.toCharacter(e.data.entity).token+e.characterToken),t.R7$(),t.Y8G("ghs-label","%data.characterToken."+e.gameManager.toCharacter(e.data.entity).name+"%"),t.R7$(),t.Y8G("value-sign",e.characterToken)("hideEmpty",!0),t.R7$(2),t.Y8G("repeat",!0),t.R7$(2),t.Dyx(e.gameManager.toCharacter(e.data.entity).tokens)}}function rm(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",34)(1,"ghs-pointer-input",35),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeHealth(-1))}),t.nrm(2,"img",36),t.k0s()(),t.j41(3,"span",30)(4,"span",37),t.EFF(5),t.nI1(6,"ghsMinZero"),t.k0s(),t.nrm(7,"img",38)(8,"span",39),t.k0s(),t.j41(9,"span",34)(10,"ghs-pointer-input",40),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeHealth(1))}),t.nrm(11,"img",41),t.k0s()(),t.nVh(12,sm,25,22)}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-label","game.health")("ghs-label-attribute","title"),t.R7$(2),t.JRh(t.bMT(6,9,e.data.entity.health+e.health)),t.R7$(3),t.Y8G("value-sign",e.health)("hideEmpty",!0),t.R7$(2),t.Y8G("ngClass",t.eq3(11,Dt,e.data.entity.health+e.health==e.Math.max(e.EntityValueFunction(e.data.entity.maxHealth),-1!=e.specialTags.indexOf("unbridled-power")?26:0)+e.maxHp))("repeat",!0),t.R7$(2),t.vxM(e.gameManager.isCharacter(e.data.entity)&&!e.bb?12:-1)}}function cm(i,r){1&i&&(t.j41(0,"span",49),t.nrm(1,"img",52),t.k0s())}function lm(i,r){1&i&&(t.j41(0,"span",49),t.nrm(1,"img",52),t.k0s())}function gm(i,r){1&i&&(t.j41(0,"span",49),t.nrm(1,"img",52),t.k0s())}function dm(i,r){if(1&i&&(t.j41(0,"span",55),t.nrm(1,"img",24),t.k0s()),2&i){const e=t.XpG(4);t.R7$(),t.Y8G("src",e.empowerChar.iconUrl,t.B4B)}}function hm(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",34)(1,"ghs-pointer-input",40),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.changeEmpower(-1))}),t.nrm(2,"img",36),t.k0s()(),t.j41(3,"span",34)(4,"span",53),t.EFF(5),t.k0s(),t.j41(6,"span",47),t.nrm(7,"img",54),t.k0s(),t.nrm(8,"span",43),t.nVh(9,gm,2,0,"span",49),t.nVh(10,dm,2,1,"span",55),t.k0s(),t.j41(11,"span",34)(12,"ghs-pointer-input",40),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.changeEmpower(1))}),t.nrm(13,"img",41),t.k0s()()}if(2&i){const e=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(15,Dt,e.countUpcomingAttackModifier(e.AttackModifierType.empower)+e.empower==0||e.isImmune(e.ConditionName.empower)||-1!=e.entityImmunities.indexOf(e.ConditionName.empower)))("repeat",!0),t.R7$(4),t.JRh(e.countUpcomingAttackModifier(e.AttackModifierType.empower)+e.empower),t.R7$(),t.Y8G("ghs-tooltip","game.condition.empower.hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom")("ngClass",t.eq3(17,ui,e.isImmune(e.ConditionName.empower)||-1!=e.entityImmunities.indexOf(e.ConditionName.empower))),t.R7$(2),t.Y8G("value-sign",e.empower)("hideEmpty",!0),t.R7$(),t.vxM(e.countEmpower()<0?9:-1),t.R7$(),t.vxM(e.empowerChar?10:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(19,Dt,e.empowerChar&&e.empower>=e.countEmpower()||e.isImmune(e.ConditionName.empower)||-1!=e.entityImmunities.indexOf(e.ConditionName.empower)))("repeat",!0)}}function _m(i,r){1&i&&(t.j41(0,"span",49),t.nrm(1,"img",52),t.k0s())}function mm(i,r){if(1&i&&(t.j41(0,"span",55),t.nrm(1,"img",24),t.k0s()),2&i){const e=t.XpG(4);t.R7$(),t.Y8G("src",e.enfeebleChar.iconUrl,t.B4B)}}function pm(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",34)(1,"ghs-pointer-input",40),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.changeEnfeeble(-1))}),t.nrm(2,"img",36),t.k0s()(),t.j41(3,"span",34)(4,"span",56),t.EFF(5),t.k0s(),t.j41(6,"span",47),t.nrm(7,"img",57),t.k0s(),t.nrm(8,"span",43),t.nVh(9,_m,2,0,"span",49),t.nVh(10,mm,2,1,"span",55),t.k0s(),t.j41(11,"span",34)(12,"ghs-pointer-input",40),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.changeEnfeeble(1))}),t.nrm(13,"img",41),t.k0s()()}if(2&i){const e=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(15,Dt,e.countUpcomingAttackModifier(e.AttackModifierType.enfeeble)+e.enfeeble==0||e.isImmune(e.ConditionName.enfeeble)||-1!=e.entityImmunities.indexOf(e.ConditionName.enfeeble)))("repeat",!0),t.R7$(4),t.JRh(e.countUpcomingAttackModifier(e.AttackModifierType.enfeeble)+e.enfeeble),t.R7$(),t.Y8G("ghs-tooltip","game.condition.enfeeble.hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom")("ngClass",t.eq3(17,ui,e.isImmune(e.ConditionName.enfeeble)||-1!=e.entityImmunities.indexOf(e.ConditionName.enfeeble))),t.R7$(2),t.Y8G("value-sign",e.enfeeble)("hideEmpty",!0),t.R7$(),t.vxM(e.countEnfeeble()<0?9:-1),t.R7$(),t.vxM(e.enfeebleChar?10:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(19,Dt,e.enfeebleChar&&e.enfeeble>=e.countEnfeeble()||e.isImmune(e.ConditionName.enfeeble)||-1!=e.entityImmunities.indexOf(e.ConditionName.enfeeble)))("repeat",!0)}}function um(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",34)(1,"ghs-pointer-input",40),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeBless(-1))}),t.nrm(2,"img",36),t.k0s()(),t.j41(3,"span",34)(4,"span",46),t.EFF(5),t.k0s(),t.j41(6,"span",47),t.nrm(7,"img",48),t.k0s(),t.nrm(8,"span",43),t.nVh(9,cm,2,0,"span",49),t.k0s(),t.j41(10,"span",34)(11,"ghs-pointer-input",40),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeBless(1))}),t.nrm(12,"img",41),t.k0s()(),t.j41(13,"span",34)(14,"ghs-pointer-input",40),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeCurse(-1))}),t.nrm(15,"img",36),t.k0s()(),t.j41(16,"span",34)(17,"span",50),t.EFF(18),t.k0s(),t.j41(19,"span",47),t.nrm(20,"img",51),t.k0s(),t.nrm(21,"span",43),t.nVh(22,lm,2,0,"span",49),t.k0s(),t.j41(23,"span",34)(24,"ghs-pointer-input",40),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeCurse(1))}),t.nrm(25,"img",41),t.k0s()(),t.nVh(26,hm,14,21),t.nVh(27,pm,14,21)}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(30,Dt,e.countUpcomingAttackModifier(e.AttackModifierType.bless)+e.bless==0||e.isImmune(e.ConditionName.bless)||-1!=e.entityImmunities.indexOf(e.ConditionName.bless)))("repeat",!0),t.R7$(4),t.JRh(e.countUpcomingAttackModifier(e.AttackModifierType.bless)+e.bless),t.R7$(),t.Y8G("ghs-tooltip","game.condition.bless.hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom")("ngClass",t.eq3(32,ui,e.isImmune(e.ConditionName.bless)||-1!=e.entityImmunities.indexOf(e.ConditionName.bless))),t.R7$(2),t.Y8G("value-sign",e.bless)("hideEmpty",!0),t.R7$(),t.vxM(e.gameManager.attackModifierManager.countUpcomingBlesses()+e.bless>10?9:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(34,Dt,e.gameManager.attackModifierManager.countUpcomingBlesses()+e.bless>=10||e.isImmune(e.ConditionName.bless)||-1!=e.entityImmunities.indexOf(e.ConditionName.bless)))("repeat",!0),t.R7$(3),t.Y8G("ngClass",t.eq3(36,Dt,e.countUpcomingAttackModifier(e.AttackModifierType.curse)+e.curse==0||e.isImmune(e.ConditionName.curse)||-1!=e.entityImmunities.indexOf(e.ConditionName.curse)))("repeat",!0),t.R7$(4),t.JRh(e.countUpcomingAttackModifier(e.AttackModifierType.curse)+e.curse),t.R7$(),t.Y8G("ghs-tooltip","game.condition.curse.hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom")("ngClass",t.eq3(38,ui,e.isImmune(e.ConditionName.curse)||-1!=e.entityImmunities.indexOf(e.ConditionName.curse))),t.R7$(2),t.Y8G("value-sign",e.curse)("hideEmpty",!0),t.R7$(),t.vxM(e.gameManager.attackModifierManager.countUpcomingCurses(e.gameManager.isMonster(e.data.figure)&&!e.gameManager.toMonster(e.data.figure).isAlly&&!e.gameManager.toMonster(e.data.figure).isAllied)+e.curse>10?22:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(40,Dt,e.gameManager.attackModifierManager.countUpcomingCurses(e.gameManager.isMonster(e.data.figure)&&!e.gameManager.toMonster(e.data.figure).isAlly&&!e.gameManager.toMonster(e.data.figure).isAllied)+e.curse>=10||e.isImmune(e.ConditionName.curse)||-1!=e.entityImmunities.indexOf(e.ConditionName.curse)))("repeat",!0),t.R7$(2),t.vxM(e.hasCondition(e.ConditionName.empower)?26:-1),t.R7$(),t.vxM(e.hasCondition(e.ConditionName.enfeeble)?27:-1)}}function fm(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",34)(1,"ghs-pointer-input",35),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeHealth(-1))}),t.nrm(2,"img",36),t.k0s()(),t.j41(3,"span",30)(4,"span",37),t.EFF(5),t.nI1(6,"ghsMinZero"),t.k0s(),t.nrm(7,"img",58)(8,"span",59),t.k0s(),t.j41(9,"span",34)(10,"ghs-pointer-input",35),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeHealth(1))}),t.nrm(11,"img",41),t.k0s()()}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-label","game.health")("ghs-label-attribute","title"),t.R7$(2),t.JRh(t.bMT(6,8,e.data.entity.health+e.health)),t.R7$(3),t.Y8G("value-sign",e.health)("hideEmpty",!0)("invert",!0),t.R7$(2),t.Y8G("repeat",!0)}}function Cm(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",34)(1,"ghs-pointer-input",35),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeId(-1))}),t.nrm(2,"img",60),t.k0s()(),t.j41(3,"span",34)(4,"span",61),t.EFF(5),t.k0s()(),t.j41(6,"span",34)(7,"ghs-pointer-input",35),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeId(1))}),t.nrm(8,"img",62),t.k0s()()}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("repeat",!0),t.R7$(4),t.JRh(e.gameManager.toObjectiveEntity(e.data.entity).number+e.id),t.R7$(2),t.Y8G("repeat",!0)}}function Mm(i,r){if(1&i&&(t.j41(0,"span",34)(1,"span",63),t.EFF(2),t.k0s()()),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(2,No,!e.OBJECTIV_MARKERS[(e.marker+e.OBJECTIV_MARKERS.indexOf(e.gameManager.toObjectiveContainer(e.data.figure).marker))%e.OBJECTIV_MARKERS.length])),t.R7$(),t.JRh(e.OBJECTIV_MARKERS[(e.marker+e.OBJECTIV_MARKERS.indexOf(e.gameManager.toObjectiveContainer(e.data.figure).marker))%e.OBJECTIV_MARKERS.length])}}function vm(i,r){if(1&i&&(t.j41(0,"span",34)(1,"span",63),t.EFF(2),t.k0s()()),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(2,No,!e.OBJECTIV_MARKERS[(e.marker+e.OBJECTIV_MARKERS.indexOf(e.gameManager.toObjectiveEntity(e.data.entity).marker))%e.OBJECTIV_MARKERS.length])),t.R7$(),t.JRh(e.OBJECTIV_MARKERS[(e.marker+e.OBJECTIV_MARKERS.indexOf(e.gameManager.toObjectiveEntity(e.data.entity).marker))%e.OBJECTIV_MARKERS.length])}}function Om(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",34)(1,"ghs-pointer-input",35),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeMarker(-1))}),t.nrm(2,"img",60),t.k0s()(),t.nVh(3,Mm,3,4,"span",34),t.nVh(4,vm,3,4,"span",34),t.j41(5,"span",34)(6,"ghs-pointer-input",35),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeMarker(1))}),t.nrm(7,"img",62),t.k0s()()}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("repeat",!0),t.R7$(2),t.vxM(e.data.entity&&e.gameManager.isObjectiveEntity(e.data.entity)?-1:3),t.R7$(),t.vxM(e.data.entity&&e.gameManager.isObjectiveEntity(e.data.entity)?4:-1),t.R7$(2),t.Y8G("repeat",!0)}}function Pm(i,r){if(1&i&&t.nrm(0,"span",17),2&i){const e=t.XpG(3);t.Y8G("ghs-label",""+e.gameManager.toSummon(e.data.entity).attack)}}function bm(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function km(i,r){if(1&i&&(t.j41(0,"span",69),t.nrm(1,"ghs-action",70),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("action",e.gameManager.toSummon(e.data.entity).action)}}function ym(i,r){if(1&i&&(t.j41(0,"span",69),t.nrm(1,"ghs-action",70),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("action",e.gameManager.toSummon(e.data.entity).additionalAction)}}function xm(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",28)(1,"span",64),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openLevelDialog())}),t.nrm(2,"img",65),t.j41(3,"span",66),t.EFF(4,">"),t.k0s()(),t.j41(5,"span",64),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openLevelDialog())}),t.nrm(6,"img",67),t.nVh(7,Pm,1,1,"span",17),t.nVh(8,bm,2,0,"span"),t.k0s(),t.j41(9,"span",64),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openLevelDialog())}),t.nrm(10,"img",68),t.j41(11,"span",66),t.EFF(12,">"),t.k0s()(),t.nVh(13,km,2,1,"span",69),t.nVh(14,ym,2,1,"span",69),t.k0s()}if(2&i){const e=t.XpG(2);t.R7$(3),t.Y8G("value-calc",e.gameManager.toSummon(e.data.entity).movement)("empty",!0),t.R7$(4),t.vxM(0!=e.gameManager.toSummon(e.data.entity).attack?7:-1),t.R7$(),t.vxM(0==e.gameManager.toSummon(e.data.entity).attack?8:-1),t.R7$(3),t.Y8G("value-calc",e.gameManager.toSummon(e.data.entity).range)("empty",!0),t.R7$(2),t.vxM(e.gameManager.toSummon(e.data.entity).action?13:-1),t.R7$(),t.vxM(e.gameManager.toSummon(e.data.entity).additionalAction?14:-1)}}function Em(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",29)(1,"a",71),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.toggleExhausted())}),t.nrm(2,"img",72),t.k0s()()}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","game.exhausted")("ghs-label-attribute","title")("ngClass",t.eq3(3,Mn,e.gameManager.toCharacter(e.data.entity).exhausted))}}function wm(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",30)(1,"a",73),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.toggleDead())}),t.nrm(2,"img",74),t.k0s()()}2&i&&t.Y8G("ghs-label","game.dead")("ghs-label-attribute","title")}function Rm(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",30)(1,"a",75),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openLevelDialog())}),t.EFF(2),t.nrm(3,"img",76),t.k0s()()}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","game.level")("ghs-label-attribute","title"),t.R7$(2),t.SpI(" ",e.data.figure.level," ")}}function jm(i,r){if(1&i&&t.nrm(0,"img",24),2&i){const e=t.XpG(3);t.Y8G("src",t.VkB("./assets/images/summons/",e.gameManager.toSummon(e.data.entity).color,".png"),t.B4B)}}function Gm(i,r){if(1&i&&(t.j41(0,"span",25),t.EFF(1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.SpI(" ",e.gameManager.toSummon(e.data.entity).number," ")}}function Tm(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",30)(1,"a",73),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.toggleDead())}),t.nrm(2,"img",74),t.k0s()(),t.j41(3,"span",30)(4,"a",75),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openLevelDialog())}),t.EFF(5),t.nrm(6,"img",76),t.k0s()(),t.j41(7,"span",34)(8,"a",77),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.toggleSummonStatus())}),t.nVh(9,jm,1,2,"img",24),t.nVh(10,Gm,2,1,"span",25),t.k0s()()}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","game.dead")("ghs-label-attribute","title"),t.R7$(3),t.Y8G("ghs-label","game.level")("ghs-label-attribute","title"),t.R7$(2),t.SpI(" ",e.data.figure.level," "),t.R7$(3),t.Y8G("ngClass",t.sMw(8,w_,e.gameManager.toSummon(e.data.entity).state==e.SummonState.true,e.gameManager.toSummon(e.data.entity).state==e.SummonState.new,e.gameManager.toSummon(e.data.entity).color==e.SummonColor.fh)),t.R7$(),t.vxM(e.gameManager.toSummon(e.data.entity).color!=e.SummonColor.fh?9:-1),t.R7$(),t.vxM(e.gameManager.toSummon(e.data.entity).color==e.SummonColor.fh?10:-1)}}function Sm(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",78)(1,"ghs-pointer-input",35),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.changeMaxHealth(-1))}),t.nrm(2,"img",36),t.k0s(),t.nrm(3,"img",79),t.j41(4,"span",80),t.EFF(5),t.k0s(),t.j41(6,"ghs-pointer-input",35),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.changeMaxHealth(1))}),t.nrm(7,"img",41),t.k0s()()}if(2&i){const e=t.XpG(3);t.R7$(),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-label","game.maxHealth")("ghs-label-attribute","title"),t.R7$(2),t.Lme("",e.EntityValueFunction(e.data.entity.maxHealth)+e.maxHp<e.EntityValueFunction(e.data.entity.maxHealth)||e.data.entity.health==+e.data.entity.maxHealth?e.EntityValueFunction(e.data.entity.maxHealth)+e.maxHp:e.data.entity.health,"/",e.EntityValueFunction(e.data.entity.maxHealth)+e.maxHp),t.R7$(),t.Y8G("repeat",!0)}}function $m(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",30)(1,"a",73),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.toggleDead())}),t.nrm(2,"img",74),t.k0s()(),t.nVh(3,Sm,8,6,"span",78)}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","game.dead")("ghs-label-attribute","title"),t.R7$(3),t.vxM(e.EntityValueFunction(e.data.entity.maxHealth)>0?3:-1)}}function Dm(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",30)(1,"ghs-pointer-input",81),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.dead(!0))})("doubleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.dead(!0,!0))}),t.nrm(2,"img",82),t.k0s()()}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","data.buildings.stables.pets.catch")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ngClass",t.eq3(3,R_,e.catchingDisabled))}}function Im(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",77),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.toggleSummon())}),t.nrm(1,"img",24),t.k0s()}if(2&i){const e=t.XpG(3);t.Y8G("ngClass",t.l_i(3,j_,e.gameManager.toMonsterEntity(e.data.entity).summon==e.SummonState.true,e.gameManager.toMonsterEntity(e.data.entity).summon==e.SummonState.new)),t.R7$(),t.Y8G("src",t.VkB("./assets/images/summons/",e.gameManager.toMonster(e.data.figure).summonColor,".png"),t.B4B)}}function Am(i,r){if(1&i){const e=t.RV6();t.j41(0,"span")(1,"a",84),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.toggleMarker(n))}),t.j41(2,"span",85),t.nrm(3,"img",24),t.k0s()()()}if(2&i){const e=r.$implicit,a=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(2,Mn,a.hasMarker(e))),t.R7$(2),t.Y8G("src",a.gameManager.characterManager.characterIcon(e),t.B4B)}}function Vm(i,r){if(1&i&&(t.j41(0,"div",31),t.nVh(1,Im,2,6,"a",83),t.Z7z(2,Am,4,4,"span",null,t.fX1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.vxM(e.data.entity&&e.EntityValueFunction(e.data.entity.maxHealth)>0&&(!e.gameManager.isMonster(e.data.figure)||!e.gameManager.toMonster(e.data.figure).immortal)&&e.gameManager.isMonsterEntity(e.data.entity)?1:-1),t.R7$(),t.Dyx(e.markers())}}function Fm(i,r){if(1&i&&t.nrm(0,"ghs-conditions",32),2&i){const e=t.XpG(2);t.Y8G("entityConditions",e.entityConditions)("immunities",e.entityImmunities)("entity",e.data.entity)("figure",e.data.figure)("type",e.conditionType)("empower",e.hasCondition(e.ConditionName.empower))("enfeeble",e.hasCondition(e.ConditionName.enfeeble))}}function Xm(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-pointer-input",95),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(4);return t.Njj(n.changeRetaliate(n.entityRetaliate.length,1,0))}),t.nrm(1,"img",96),t.k0s()}}function Bm(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",91)(1,"ghs-pointer-input",88),t.bIt("singleClick",function(){const n=t.eBV(e).$index,o=t.XpG(3);return t.Njj(o.changeRetaliate(n,-1,0))}),t.nrm(2,"img",36),t.k0s(),t.j41(3,"ghs-pointer-input",92),t.bIt("singleClick",function(){const n=t.eBV(e).$index,o=t.XpG(3);return t.Njj(o.changeRetaliate(n,0,-1))}),t.nrm(4,"img",36),t.k0s()(),t.j41(5,"span",91),t.nrm(6,"ghs-action",70)(7,"ghs-action",70),t.nVh(8,Xm,2,0,"ghs-pointer-input",93),t.k0s(),t.j41(9,"span",91)(10,"ghs-pointer-input",89),t.bIt("singleClick",function(){const n=t.eBV(e).$index,o=t.XpG(3);return t.Njj(o.changeRetaliate(n,1,0))}),t.nrm(11,"img",41),t.k0s(),t.j41(12,"ghs-pointer-input",94),t.bIt("singleClick",function(){const n=t.eBV(e).$index,o=t.XpG(3);return t.Njj(o.changeRetaliate(n,0,1))}),t.nrm(13,"img",41),t.k0s()()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(9,Dt,!e.value)),t.R7$(2),t.Y8G("ngClass",t.eq3(11,Dt,n.EntityValueFunction(n.entityRetaliateRange[a].value)<=1)),t.R7$(3),t.Aen("fh"),t.Y8G("action",e),t.R7$(),t.Aen("fh"),t.Y8G("action",n.entityRetaliateRange[a]),t.R7$(),t.vxM(a==n.entityRetaliate.length-1&&e.value?8:-1)}}function Ym(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-pointer-input",95),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(4);return t.Njj(n.changeRetaliatePersistent(n.entityRetaliatePersistent.length,1,0))}),t.nrm(1,"img",96),t.k0s()}}function Nm(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",91)(1,"ghs-pointer-input",88),t.bIt("singleClick",function(){const n=t.eBV(e).$index,o=t.XpG(3);return t.Njj(o.changeRetaliatePersistent(n,-1,0))}),t.nrm(2,"img",36),t.k0s(),t.j41(3,"ghs-pointer-input",92),t.bIt("singleClick",function(){const n=t.eBV(e).$index,o=t.XpG(3);return t.Njj(o.changeRetaliatePersistent(n,0,-1))}),t.nrm(4,"img",36),t.k0s()(),t.j41(5,"span",91),t.nrm(6,"ghs-action",70)(7,"ghs-action",70),t.nVh(8,Ym,2,0,"ghs-pointer-input",93),t.k0s(),t.j41(9,"span",91)(10,"ghs-pointer-input",89),t.bIt("singleClick",function(){const n=t.eBV(e).$index,o=t.XpG(3);return t.Njj(o.changeRetaliatePersistent(n,1,0))}),t.nrm(11,"img",41),t.k0s(),t.j41(12,"ghs-pointer-input",94),t.bIt("singleClick",function(){const n=t.eBV(e).$index,o=t.XpG(3);return t.Njj(o.changeRetaliatePersistent(n,0,1))}),t.nrm(13,"img",41),t.k0s()()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(9,Dt,!e.value)),t.R7$(2),t.Y8G("ngClass",t.eq3(11,Dt,n.EntityValueFunction(n.entityRetaliateRangePersistent[a].value)<=1)),t.R7$(3),t.Aen("fh"),t.Y8G("action",e),t.R7$(),t.Aen("fh"),t.Y8G("action",n.entityRetaliateRangePersistent[a]),t.R7$(),t.vxM(a==n.entityRetaliatePersistent.length-1&&e.value?8:-1)}}function zm(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",26)(1,"span",86),t.nrm(2,"span",87),t.k0s(),t.j41(3,"span",34)(4,"ghs-pointer-input",88),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeShield(-1))}),t.nrm(5,"img",36),t.k0s()(),t.j41(6,"span",34),t.nrm(7,"ghs-action",70),t.k0s(),t.j41(8,"span",34)(9,"ghs-pointer-input",89),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeShield(1))}),t.nrm(10,"img",41),t.k0s()(),t.Z7z(11,Bm,14,13,null,null,zo),t.nrm(13,"div",90),t.j41(14,"span",86),t.nrm(15,"span",87),t.k0s(),t.j41(16,"span",34)(17,"ghs-pointer-input",88),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeShieldPersistent(-1))}),t.nrm(18,"img",36),t.k0s()(),t.j41(19,"span",34),t.nrm(20,"ghs-action",70),t.k0s(),t.j41(21,"span",34)(22,"ghs-pointer-input",89),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeShieldPersistent(1))}),t.nrm(23,"img",41),t.k0s()(),t.Z7z(24,Nm,14,13,null,null,t.fX1),t.k0s()}if(2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","%game.card.round%"),t.R7$(2),t.Y8G("ngClass",t.eq3(10,Dt,!e.entityShield.value)),t.R7$(3),t.Aen("fh"),t.Y8G("action",e.entityShield),t.R7$(4),t.Dyx(e.entityRetaliate),t.R7$(4),t.Y8G("ghs-label","%game.card.persistent%"),t.R7$(2),t.Y8G("ngClass",t.eq3(12,Dt,!e.entityShieldPersistent.value)),t.R7$(3),t.Aen("fh"),t.Y8G("action",e.entityShieldPersistent),t.R7$(4),t.Dyx(e.entityRetaliatePersistent)}}function Lm(i,r){if(1&i&&(t.j41(0,"div",7)(1,"div",26),t.Z7z(2,im,2,2,"div",27,zo),t.nVh(4,rm,13,13),t.nVh(5,um,28,42),t.nVh(6,fm,12,10),t.nVh(7,Cm,9,3),t.nVh(8,Om,8,4),t.nVh(9,xm,15,8,"div",28),t.nVh(10,Em,3,5,"span",29),t.nVh(11,wm,3,2,"span",30),t.nVh(12,Rm,4,3,"span",30),t.nVh(13,Tm,11,12),t.nVh(14,$m,4,3),t.nVh(15,Dm,3,5,"span",30),t.nVh(16,Vm,4,1,"div",31),t.k0s(),t.nVh(17,Fm,1,7,"ghs-conditions",32),t.nVh(18,zm,26,14,"div",26),t.k0s()),2&i){const e=t.XpG();t.R7$(2),t.Dyx(e.actionHints),t.R7$(2),t.vxM(!(e.data.entity&&e.EntityValueFunction(e.data.entity.maxHealth)>0)||e.gameManager.isMonster(e.data.figure)&&e.gameManager.toMonster(e.data.figure).immortal?-1:4),t.R7$(),t.vxM(!(e.gameManager.isCharacter(e.data.figure)&&e.settingsManager.settings.characterSheet&&e.settingsManager.settings.characterAttackModifierDeck||e.gameManager.isMonster(e.data.figure))||e.data.entity&&(!(e.EntityValueFunction(e.data.entity.maxHealth)>0)||e.gameManager.isMonster(e.data.figure)&&e.gameManager.toMonster(e.data.figure).immortal||e.bb)?-1:5),t.R7$(),t.vxM(e.data.entity&&0==e.EntityValueFunction(e.data.entity.maxHealth)&&e.objectiveData&&e.objectiveData.trackDamage?6:-1),t.R7$(),t.vxM(e.data.entity&&e.gameManager.isObjectiveEntity(e.data.entity)?7:-1),t.R7$(),t.vxM(e.data.figure&&e.gameManager.isObjectiveContainer(e.data.figure)?8:-1),t.R7$(),t.vxM(e.data.entity&&e.gameManager.isSummon(e.data.entity)?9:-1),t.R7$(),t.vxM(e.data.entity&&e.gameManager.isCharacter(e.data.entity)?10:-1),t.R7$(),t.vxM(e.data.entity&&e.gameManager.isObjectiveEntity(e.data.entity)?11:-1),t.R7$(),t.vxM(e.data.entity&&e.gameManager.isCharacter(e.data.entity)?12:-1),t.R7$(),t.vxM(e.data.entity&&e.gameManager.isSummon(e.data.entity)?13:-1),t.R7$(),t.vxM(e.data.entity&&e.gameManager.isMonsterEntity(e.data.entity)?14:-1),t.R7$(),t.vxM(e.catching?15:-1),t.R7$(),t.vxM(e.bb?-1:16),t.R7$(),t.vxM(!(e.data.entity&&e.EntityValueFunction(e.data.entity.maxHealth)>0)||e.gameManager.isMonster(e.data.figure)&&e.gameManager.toMonster(e.data.figure).immortal?-1:17),t.R7$(),t.vxM(e.data.entity&&(e.settingsManager.settings.characterShieldRetaliate&&(e.gameManager.isCharacter(e.data.entity)||e.gameManager.isObjectiveContainer(e.data.figure)&&e.gameManager.toObjectiveContainer(e.data.figure).escort&&e.gameManager.isObjectiveEntity(e.data.entity))||e.settingsManager.settings.standeeShieldRetaliate&&(e.gameManager.isMonsterEntity(e.data.entity)||e.gameManager.isSummon(e.data.entity)))?18:-1)}}function Um(i,r){1&i&&t.nrm(0,"hr",8)}function qm(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",98),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.setIdentity(n))}),t.nrm(1,"img",24),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ghs-tooltip","data.character."+a.gameManager.toCharacter(a.data.entity).edition+"."+a.gameManager.toCharacter(a.data.entity).name+"."+a.gameManager.toCharacter(a.data.entity).identities[e])("ngClass",t.eq3(3,G_,a.gameManager.toCharacter(a.data.entity).identity==e)),t.R7$(),t.Y8G("src",a.gameManager.characterManager.characterIdentityIcon(a.gameManager.toCharacter(a.data.entity).name,e),t.B4B)}}function Hm(i,r){if(1&i&&(t.j41(0,"div",9),t.Z7z(1,qm,2,5,"a",97,t.fX1),t.nI1(3,"ghsRange"),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(t.i5U(3,0,t.lJ4(3,ca),e.gameManager.toCharacter(e.data.entity).identities.length))}}function Km(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",99),t.nrm(1,"img",100),t.j41(2,"span",101),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(2);return t.Njj(o.applySpecialAction(n))}),t.nrm(3,"span",17),t.k0s(),t.j41(4,"span",102)(5,"div",103),t.nrm(6,"span",17),t.k0s()()()}if(2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.R7$(2),t.Y8G("ngClass",t.eq3(3,T_,-1!=a.specialTags.indexOf(e.name))),t.R7$(),t.Y8G("ghs-label","data.character."+a.data.figure.edition+"."+a.data.figure.name+"."+e.name),t.R7$(3),t.Y8G("ghs-label","data.character."+a.data.figure.edition+"."+a.data.figure.name+"."+e.name+".hint")}}function Wm(i,r){if(1&i&&t.nVh(0,Km,7,5,"div",99),2&i){const e=r.$implicit,a=t.XpG(2);t.vxM((!e.level||e.level<=a.data.figure.level)&&(!e.perk||a.gameManager.isCharacter(a.data.entity)&&a.gameManager.toCharacter(a.data.figure).progress.perks[e.perk-1]==a.gameManager.toCharacter(a.data.figure).perks[e.perk-1].count)&&(a.gameManager.isCharacter(a.data.entity)&&!e.summon||a.gameManager.isSummon(a.data.entity)&&e.summon)?0:-1)}}function Jm(i,r){if(1&i&&(t.j41(0,"div",10),t.Z7z(1,Wm,1,1,null,null,$_),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.gameManager.toCharacter(e.data.figure).specialActions)}}function Zm(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",73),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeMaxHealth(-1))}),t.nrm(1,"img",36),t.k0s(),t.j41(2,"span",34),t.nrm(3,"img",38),t.j41(4,"span",80),t.EFF(5),t.k0s()(),t.j41(6,"a",73),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeMaxHealth(1))}),t.nrm(7,"img",41),t.k0s()}if(2&i){const e=t.XpG(2);t.R7$(5),t.Lme("",e.EntityValueFunction(e.gameManager.toObjectiveContainer(e.data.figure).health)+e.maxHp<e.EntityValueFunction(e.gameManager.toObjectiveContainer(e.data.figure).health)||e.data.entity.health==e.EntityValueFunction(e.gameManager.toObjectiveContainer(e.data.figure).health)?e.EntityValueFunction(e.gameManager.toObjectiveContainer(e.data.figure).health)+e.maxHp:e.data.entity.health,"/",e.EntityValueFunction(e.gameManager.toObjectiveContainer(e.data.figure).health)+e.maxHp)}}function Qm(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",109),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(2);return t.Njj(o.toggleAMDeck(n))}),t.EFF(1,"m"),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.Y8G("ngClass",t.eq3(1,Mn,!a.gameManager.toObjectiveContainer(a.data.figure).amDeck||a.gameManager.toObjectiveContainer(a.data.figure).amDeck==e))}}function tp(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",109),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(2);return t.Njj(o.toggleAMDeck(n))}),t.EFF(1,"A"),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.Y8G("ngClass",t.eq3(1,Mn,a.gameManager.toObjectiveContainer(a.data.figure).amDeck==e))}}function ep(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",109),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(2);return t.Njj(o.toggleAMDeck(n))}),t.nrm(1,"img",24),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Mn,a.gameManager.toObjectiveContainer(a.data.figure).amDeck==e)),t.R7$(),t.Y8G("src",a.gameManager.characterManager.characterIcon(e),t.B4B)}}function np(i,r){if(1&i&&(t.nVh(0,Qm,2,3,"span",108),t.nVh(1,tp,2,3,"span",108),t.nVh(2,ep,2,4,"span",108)),2&i){const e=r.$implicit,a=t.XpG(2);t.vxM("M"==e?0:-1),t.R7$(),t.vxM(a.settingsManager.settings.allyAttackModifierDeck&&(a.gameManager.fhRules()||a.settingsManager.settings.alwaysAllyAttackModifierDeck)&&"A"==e?1:-1),t.R7$(),t.vxM("M"!=e&&"A"!=e?2:-1)}}function ip(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",110),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.toggleAMDeck(n.gameManager.toObjectiveContainer(n.data.figure).amDeck||""))}),t.nrm(1,"img",24),t.k0s()}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("src",e.gameManager.characterManager.characterIcon(e.gameManager.toObjectiveContainer(e.data.figure).amDeck||""),t.B4B)}}function ap(i,r){if(1&i&&(t.j41(0,"div",104),t.nrm(1,"input",105,0),t.nVh(3,Zm,8,2),t.k0s(),t.j41(4,"div",106),t.Z7z(5,np,3,3,null,null,t.fX1),t.nVh(7,ip,2,1,"span",107),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("value",e.gameManager.toObjectiveContainer(e.data.figure).title||""),t.R7$(2),t.vxM(e.showMaxHealth()&&e.data.entity&&e.gameManager.isObjectiveEntity(e.data.entity)?3:-1),t.R7$(2),t.Dyx(e.amDecks),t.R7$(2),t.vxM(e.gameManager.toObjectiveContainer(e.data.figure).amDeck&&-1==e.amDecks.indexOf(e.gameManager.toObjectiveContainer(e.data.figure).amDeck||"")?7:-1)}}function op(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",34)(1,"a",114),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.setLevel(n+1))}),t.EFF(2),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(2,Mn,e+1==a.data.entity.level)),t.R7$(),t.JRh(e+1)}}function sp(i,r){if(1&i&&t.nrm(0,"img",24)(1,"input",115,1),2&i){const e=t.XpG(3);t.Y8G("src",e.gameManager.characterManager.characterIcon(e.gameManager.toCharacter(e.data.entity).name),t.B4B),t.R7$(),t.Y8G("value",e.gameManager.toCharacter(e.data.entity).title)}}function rp(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",116),t.nrm(1,"img",24),t.j41(2,"input",117),t.bIt("change",function(n){const o=t.eBV(e).$implicit,g=t.XpG(4);return t.Njj(g.setTitle(n,o))}),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG(4);t.R7$(),t.Y8G("src",a.gameManager.characterManager.characterIdentityIcon(a.gameManager.toCharacter(a.data.entity).name,a.gameManager.toCharacter(a.data.entity).identity),t.B4B),t.R7$(),t.Y8G("value",a.titles[e])}}function cp(i,r){if(1&i&&(t.j41(0,"div",113),t.Z7z(1,rp,3,2,"div",116,t.fX1),t.nI1(3,"ghsRange"),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(t.i5U(3,0,t.lJ4(3,ca),e.gameManager.toCharacter(e.data.entity).identities.length))}}function lp(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",111)(1,"span",34),t.nrm(2,"img",76),t.k0s(),t.Z7z(3,op,3,4,"span",34,t.fX1),t.nI1(5,"ghsRange"),t.k0s(),t.j41(6,"div",112),t.nVh(7,sp,3,2),t.nVh(8,cp,4,4,"div",113),t.j41(9,"a",73),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeMaxHealth(-1))}),t.nrm(10,"img",36),t.k0s(),t.j41(11,"span",30),t.nrm(12,"img",38),t.j41(13,"span",80),t.EFF(14),t.k0s()(),t.j41(15,"a",73),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeMaxHealth(1))}),t.nrm(16,"img",41),t.k0s()()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(10,S_,e.bb)),t.R7$(3),t.Dyx(t.i5U(5,7,t.lJ4(12,ca),e.bb?5:9)),t.R7$(4),t.vxM(0!=e.titles.length&&e.settingsManager.settings.characterIdentities?-1:7),t.R7$(),t.vxM(e.titles.length>0&&e.settingsManager.settings.characterIdentities?8:-1),t.R7$(3),t.Y8G("ghs-label","game.maxHealth")("ghs-label-attribute","title"),t.R7$(3),t.Lme("",e.EntityValueFunction(e.data.entity.maxHealth)+e.maxHp<e.EntityValueFunction(e.data.entity.maxHealth)||e.data.entity.health==e.EntityValueFunction(e.data.entity.maxHealth)?e.EntityValueFunction(e.data.entity.maxHealth)+e.maxHp:e.data.entity.health,"/",e.EntityValueFunction(e.data.entity.maxHealth)+e.maxHp)}}function gp(i,r){if(1&i&&t.nrm(0,"span",121),2&i){const e=t.XpG(3);t.Y8G("value-calc",+e.gameManager.toSummon(e.data.entity).attack+e.attack)("empty",!0)}}function dp(i,r){1&i&&(t.j41(0,"span",122),t.EFF(1,"X"),t.k0s())}function hp(i,r){if(1&i){const e=t.RV6();t.nrm(0,"input",118,2),t.j41(2,"div",119)(3,"a",120),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeMaxHealth(-1))}),t.nrm(4,"img",36),t.k0s(),t.j41(5,"span",34),t.nrm(6,"img",38),t.j41(7,"span",80),t.EFF(8),t.k0s()(),t.j41(9,"a",73),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeMaxHealth(1))}),t.nrm(10,"img",41),t.k0s(),t.j41(11,"a",120),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeMovement(-1))}),t.nrm(12,"img",36),t.k0s(),t.j41(13,"span",34),t.nrm(14,"img",65),t.j41(15,"span",121),t.EFF(16,">"),t.k0s()(),t.j41(17,"a",73),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeMovement(1))}),t.nrm(18,"img",41),t.k0s(),t.j41(19,"a",120),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeAttack(-1))}),t.nrm(20,"img",36),t.k0s(),t.j41(21,"span",34),t.nrm(22,"img",67),t.nVh(23,gp,1,2,"span",121),t.nVh(24,dp,2,0,"span",122),t.k0s(),t.j41(25,"a",120),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeAttack(1))}),t.nrm(26,"img",41),t.k0s(),t.j41(27,"a",120),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeRange(-1))}),t.nrm(28,"img",36),t.k0s(),t.j41(29,"span",34),t.nrm(30,"img",68),t.j41(31,"span",121),t.EFF(32,">"),t.k0s()(),t.j41(33,"a",73),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeRange(1))}),t.nrm(34,"img",41),t.k0s()()}if(2&i){const e=t.XpG(2);t.R7$(3),t.Y8G("ngClass",t.eq3(13,Dt,e.EntityValueFunction(e.data.entity.maxHealth)+e.maxHp==0)),t.R7$(5),t.Lme("",e.EntityValueFunction(e.data.entity.maxHealth)+e.maxHp<e.EntityValueFunction(e.data.entity.maxHealth)||e.data.entity.health==e.EntityValueFunction(e.data.entity.maxHealth)?e.EntityValueFunction(e.data.entity.maxHealth)+e.maxHp:e.data.entity.health,"/",e.EntityValueFunction(e.data.entity.maxHealth)+e.maxHp),t.R7$(3),t.Y8G("ngClass",t.eq3(15,Dt,e.gameManager.toSummon(e.data.entity).movement+e.movement==0)),t.R7$(4),t.Y8G("value-calc",e.gameManager.toSummon(e.data.entity).movement+e.movement)("empty",!0),t.R7$(4),t.Y8G("ngClass",t.eq3(17,Dt,"X"==e.gameManager.toSummon(e.data.entity).attack||+e.gameManager.toSummon(e.data.entity).attack+e.attack==0)),t.R7$(4),t.vxM("X"!=e.gameManager.toSummon(e.data.entity).attack?23:-1),t.R7$(),t.vxM("X"==e.gameManager.toSummon(e.data.entity).attack?24:-1),t.R7$(),t.Y8G("ngClass",t.eq3(19,Dt,"X"==e.gameManager.toSummon(e.data.entity).attack)),t.R7$(2),t.Y8G("ngClass",t.eq3(21,Dt,e.gameManager.toSummon(e.data.entity).range+e.range==0)),t.R7$(4),t.Y8G("value-calc",e.gameManager.toSummon(e.data.entity).range+e.range)("empty",!0)}}function _p(i,r){if(1&i&&(t.j41(0,"div",11),t.nVh(1,lp,17,13),t.nVh(2,hp,35,23),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.vxM(e.data.entity&&e.gameManager.isCharacter(e.data.entity)?1:-1),t.R7$(),t.vxM(e.data.entity&&e.gameManager.isSummon(e.data.entity)?2:-1)}}let Xn=(()=>{class i{data;changeDetectorRef;dialogRef;dialog;overlay;gameManager=s.E;settingsManager=m.f;characterTitleInput;objectiveTitleInput;summonTitleInput;conditionType="";levelDialog=!1;health=0;experience=0;loot=0;maxHp=0;attack=0;movement=0;range=0;bless=0;curse=0;empower=0;enfeeble=0;marker=0;id=0;characterToken=0;characterTokenValues=[];objectiveDead=!1;entityConditions=[];entityImmunities=[];actionHints=[];specialTags=[];entityShield=new G.rc(G.X2.shield,0);entityShieldPersistent=new G.rc(G.X2.shield,0);entityRetaliate=[new G.rc(G.X2.retaliate,0)];entityRetaliatePersistent=[new G.rc(G.X2.retaliate,0)];entityRetaliateRange=[new G.rc(G.X2.range,1,G.iQ.fixed,[],!0)];entityRetaliateRangePersistent=[new G.rc(G.X2.range,1,G.iQ.fixed,[],!0)];titles=[];empowerChar;empowerChars=[];enfeebleChar;enfeebleChars=[];bb=!1;amDecks=[];AttackModifierType=Y.Yn;SummonState=lt.N5;SummonColor=lt.rX;ConditionName=j.r5;ConditionType=j.GV;MonsterType=S.N;OBJECTIV_MARKERS=mt.ZM;EntityValueFunction=$.hZ;ghsModulo=V.L$;Math=Math;catching=!1;catchingDisabled=!0;objectiveData;constructor(e,a,n,o,g){if(this.data=e,this.changeDetectorRef=a,this.dialogRef=n,this.dialog=o,this.overlay=g,e.entity instanceof q.K){this.conditionType="character";for(let _=0;_<e.entity.tokens.length;_++)this.characterTokenValues[_]=0;if(e.entity.identities&&e.entity.identities.length>1&&m.f.settings.characterIdentities){if(this.titles=e.entity.title.split("|"),this.titles.length<e.entity.identities.length)for(let _=this.titles.length;_<e.entity.identities.length;_++)this.titles.push("");for(let _=0;_<this.titles.length;_++)this.titles[_]||(this.titles[_]=m.f.getLabel("data.character."+e.entity.edition+"."+e.entity.name.toLowerCase()))}}else e.figure instanceof mt.$e?this.conditionType=e.figure.escort?"character":"objective":e.entity instanceof Rt.I?this.conditionType="monster":e.entity instanceof lt.up&&(this.conditionType="monster",e.entity.init&&(this.levelDialog=!0));this.data.entity&&(this.entityConditions=JSON.parse(JSON.stringify(this.data.entity.entityConditions)),this.entityImmunities=JSON.parse(JSON.stringify(this.data.entity.immunities))),this.data.figure instanceof P.R&&this.data.entity instanceof Rt.I&&(this.actionHints=s.E.actionsManager.calcActionHints(this.data.figure,this.data.entity).map(_=>new G.rc(_.type,_.value,G.iQ.fixed,_.range?[new G.rc(G.X2.range,_.range,G.iQ.fixed,[],!0)]:[]))),this.data.figure instanceof q.K&&this.data.figure.specialActions&&this.data.figure.specialActions.forEach(_=>{(this.data.entity instanceof q.K&&!_.summon&&-1!=this.data.entity.tags.indexOf(_.name)||this.data.entity instanceof lt.up&&_.summon&&-1!=this.data.entity.tags.indexOf(_.name))&&this.specialTags.push(_.name)}),e.figure instanceof mt.$e&&e.figure.objectiveId&&(this.objectiveData=s.E.objectiveManager.objectiveDataByObjectiveIdentifier(e.figure.objectiveId)),this.data.entity&&(this.data.entity.shield&&(this.entityShield.value=this.data.entity.shield.value),this.data.entity.shieldPersistent&&(this.entityShieldPersistent.value=this.data.entity.shieldPersistent.value),this.data.entity.retaliate.forEach((_,y)=>{this.entityRetaliate[y]?this.entityRetaliate[y].value=_.value:this.entityRetaliate[y]=new G.rc(G.X2.retaliate,_.value),this.entityRetaliateRange[y]||(this.entityRetaliateRange[y]=new G.rc(G.X2.range,1),this.entityRetaliateRange[y].small=!0);const B=_.subActions.find(nt=>nt.type==G.X2.range);B&&(this.entityRetaliateRange[y].value=B.value)}),this.data.entity.retaliatePersistent.forEach((_,y)=>{this.entityRetaliatePersistent[y]?this.entityRetaliatePersistent[y].value=_.value:this.entityRetaliatePersistent[y]=new G.rc(G.X2.retaliate,_.value),this.entityRetaliateRangePersistent[y]||(this.entityRetaliateRangePersistent[y]=new G.rc(G.X2.range,1),this.entityRetaliateRangePersistent[y].small=!0);const B=_.subActions.find(nt=>nt.type==G.X2.range);B&&(this.entityRetaliateRangePersistent[y].value=B.value)}),s.E.buildingsManager.petsEnabled&&this.data.figure instanceof P.R&&this.data.figure.pet&&(this.catching=!0,this.catchingDisabled=null==s.E.game.figures.find(_=>_ instanceof q.K&&_.progress.equippedItems.find(y=>"fh"==y.edition&&"247"==y.name&&(!y.tags||-1==y.tags.indexOf(bt.Tr.consumed)))))),this.dialogRef.closed.subscribe({next:_=>{_||this.close()}}),this.empowerChars=s.E.game.figures.filter(_=>_ instanceof q.K&&s.E.entityManager.isAlive(_)&&_.additionalModifier&&_.additionalModifier.find(y=>y.attackModifier&&y.attackModifier.type==Y.Yn.empower)).map(_=>_),this.empowerChars.forEach(_=>{_.active&&(this.empowerChar=_)}),!this.empowerChar&&1==this.empowerChars.length&&(this.empowerChar=this.empowerChars[0]),this.enfeebleChars=s.E.game.figures.filter(_=>_ instanceof q.K&&s.E.entityManager.isAlive(_)&&!_.absent&&_.additionalModifier&&_.additionalModifier.find(y=>y.attackModifier&&y.attackModifier.type==Y.Yn.enfeeble)).map(_=>_),this.enfeebleChars.forEach(_=>{_.active&&(this.enfeebleChar=_)}),!this.enfeebleChar&&1==this.enfeebleChars.length&&(this.enfeebleChar=this.enfeebleChars[0]),this.bb=this.data.entity instanceof q.K&&this.data.entity.bb||this.data.figure instanceof P.R&&this.data.figure.bb,this.amDecks=["M","A",...s.E.game.figures.filter(_=>_ instanceof q.K&&!_.absent).map(_=>_.name)]}keyboardShortcuts(e){m.f.settings.keyboardShortcuts&&!this.levelDialog&&!e.altKey&&!e.metaKey&&(!window.document.activeElement||"INPUT"!=window.document.activeElement.tagName&&"SELECT"!=window.document.activeElement.tagName&&"TEXTAREA"!=window.document.activeElement.tagName)&&((!(this.data.entity instanceof q.K)||!this.data.entity.absent)&&(e.ctrlKey||e.shiftKey||"ArrowRight"!==e.key?e.ctrlKey||e.shiftKey||"ArrowLeft"!==e.key?e.ctrlKey||e.shiftKey||"ArrowUp"!==e.key?e.ctrlKey||e.shiftKey||"ArrowDown"!==e.key?e.ctrlKey||"x"!==e.key.toLowerCase()?e.ctrlKey||"l"!==e.key.toLowerCase()?e.ctrlKey||"b"!==e.key.toLowerCase()?e.ctrlKey||"c"!==e.key.toLowerCase()?e.ctrlKey||e.shiftKey||"k"!==e.key.toLowerCase()&&"d"!==e.key.toLowerCase()?!e.ctrlKey&&!e.shiftKey&&"s"===e.key.toLowerCase()&&this.data.entity instanceof q.K&&((0,V.co)(this.dialogRef),this.dialog.open(Re,{panelClass:["dialog-invert"],data:{character:this.data.entity}}),e.preventDefault(),e.stopPropagation()):(this.data.entity instanceof q.K?this.toggleExhausted():this.toggleDead(),e.preventDefault(),e.stopPropagation()):(this.changeCurse(e.shiftKey?-1:1),e.preventDefault(),e.stopPropagation()):(this.changeBless(e.shiftKey?-1:1),e.preventDefault(),e.stopPropagation()):(this.changeLoot(e.shiftKey?-1:1),e.preventDefault(),e.stopPropagation()):(this.changeExperience(e.shiftKey?-1:1),e.preventDefault(),e.stopPropagation()):(this.changeMaxHealth(-1),e.preventDefault(),e.stopPropagation()):(this.changeMaxHealth(1),e.preventDefault(),e.stopPropagation()):(this.changeHealth(-1),e.preventDefault(),e.stopPropagation()):(this.changeHealth(1),e.preventDefault(),e.stopPropagation())),m.f.settings.keyboardShortcuts&&!e.ctrlKey&&!e.shiftKey&&"a"===e.key.toLowerCase()&&this.data.entity instanceof q.K&&(this.toggleCharacterAbsent(),e.preventDefault(),e.stopPropagation()))}changeHealth(e){if(this.health+=e,this.data.entity){let a=(0,$.hZ)(this.data.entity.maxHealth);this.data.entity instanceof q.K&&"lightning"==this.data.entity.name&&-1!=this.specialTags.indexOf("unbridled-power")&&(a=Math.max(a,26)),this.maxHp&&this.data.entity.health+this.health>a+this.maxHp&&(this.health=a+this.maxHp-this.data.entity.health)}}changeExperience(e){this.data.entity instanceof q.K&&(this.experience+=e,this.data.entity.experience+this.experience<=0&&(this.experience=-this.data.entity.experience))}changeCharacterToken(e,a=-1){this.data.entity instanceof q.K&&(a<0?(this.characterToken+=e,this.data.entity.token+this.characterToken<=0&&(this.characterToken=-this.data.entity.token)):(this.characterTokenValues[a]+=e,this.data.entity.tokenValues[a]+this.characterTokenValues[a]<=0&&(this.characterTokenValues[a]=-this.data.entity.tokenValues[a])))}changeLoot(e){this.data.entity instanceof q.K&&(this.loot+=e,this.data.entity.loot+this.loot<=0&&(this.loot=-this.data.entity.loot))}attackModifierDeck(){return s.E.attackModifierManager.byFigure(this.data.figure)}beforeAttackModifierDeck(e){s.E.stateManager.before("updateAttackModifierDeck."+e.type,this.data.figure instanceof q.K?s.E.characterManager.characterName(this.data.figure):this.data.figure instanceof P.R&&(this.data.figure.isAlly||this.data.figure.isAllied)?"ally":"monster",...e.values)}afterAttackModifierDeck(e){this.attackModifierDeck().merge(e.deck),s.E.stateManager.after()}countAttackModifier(e){return this.attackModifierDeck().cards.filter(a=>a.type==e).length}countUpcomingAttackModifier(e,a=void 0){return this.attackModifierDeck().cards.filter((n,o)=>n.type==e&&o>this.attackModifierDeck().current&&(!a||n.id&&n.id.startsWith(a))).length}countDrawnAttackModifier(e){return this.attackModifierDeck().cards.filter((a,n)=>a.type==e&&n<=this.attackModifierDeck().current).length}changeAttackModifier(e,a){if(a>0){if(e==Y.Yn.bless&&s.E.attackModifierManager.countUpcomingBlesses()>=10)return;if(e==Y.Yn.curse&&s.E.attackModifierManager.countUpcomingCurses(this.data.figure instanceof P.R&&!this.data.figure.isAlly&&!this.data.figure.isAllied)>=10)return;for(let n=0;n<a;n++)s.E.attackModifierManager.addModifier(this.attackModifierDeck(),new Y.uU(e))}else if(a<0){let n=this.attackModifierDeck().cards.find((o,g)=>o.type==e&&g>this.attackModifierDeck().current);for(;n&&a<0;)this.attackModifierDeck().cards.splice(this.attackModifierDeck().cards.indexOf(n),1),n=this.attackModifierDeck().cards.find((o,g)=>o.type==e&&g>this.attackModifierDeck().current),a++}}changeBless(e){if(this.data.figure instanceof q.K||this.data.figure instanceof P.R){this.bless+=e;const a=s.E.attackModifierManager.countUpcomingBlesses();this.bless+a>=10?this.bless=10-a:this.bless+a<0&&(this.bless=-a)}}changeCurse(e){if(this.data.figure instanceof q.K||this.data.figure instanceof P.R){this.curse+=e;const a=s.E.attackModifierManager.countUpcomingCurses(this.data.figure instanceof P.R&&!this.data.figure.isAlly&&!this.data.figure.isAllied);this.curse+a>=10?this.curse=10-a:this.curse+a<0&&(this.curse=-a)}}countEmpower(e=!1){return this.empowerChar?this.empowerChar.additionalModifier.filter(a=>a.attackModifier&&a.attackModifier.type==Y.Yn.empower).map(a=>a.count).reduce((a,n)=>a+n)-(e?0:s.E.attackModifierManager.countUpcomingAdditional(this.empowerChar,Y.Yn.empower)):-1}countEnfeeble(e=!1){return this.enfeebleChar?this.enfeebleChar.additionalModifier.filter(a=>a.attackModifier&&a.attackModifier.type==Y.Yn.enfeeble).map(a=>a.count).reduce((a,n)=>a+n)-(e?0:s.E.attackModifierManager.countUpcomingAdditional(this.enfeebleChar,Y.Yn.enfeeble)):-1}changeEmpower(e){if(this.empowerChar||e<0){this.empower+=e;const a=this.countUpcomingAttackModifier(Y.Yn.empower),n=this.countEmpower();this.empower>=n?this.empower=n:this.empower+a<0&&(this.empower=-a)}else this.dialog.open(Bo,{panelClass:["dialog"],data:{characters:this.empowerChars,type:Y.Yn.empower}}).closed.subscribe({next:n=>{"number"==typeof n&&-1!=n&&(this.empowerChar=this.empowerChars[n])}})}changeEnfeeble(e){if(this.enfeebleChar||e<0){this.enfeeble+=e;const a=this.countUpcomingAttackModifier(Y.Yn.enfeeble),n=this.countEnfeeble();this.enfeeble>=n?this.enfeeble=n:this.enfeeble+a<0&&(this.enfeeble=-a)}else this.dialog.open(Bo,{panelClass:["dialog"],data:{characters:this.enfeebleChars,type:Y.Yn.enfeeble}}).closed.subscribe({next:n=>{"number"==typeof n&&-1!=n&&(this.enfeebleChar=this.enfeebleChars[n])}})}hasCondition(e){return e==j.r5.empower?this.empowerChars.length>0:e==j.r5.enfeeble?this.enfeebleChars.length>0:null!=s.E.conditions(s.E.game.edition).find(a=>a.name==e)}toggleExhausted(){this.data.entity instanceof q.K&&(s.E.stateManager.before(this.data.entity.exhausted?"unsetExhausted":"setExhausted",s.E.characterManager.characterName(this.data.entity)),this.exhausted(),s.E.stateManager.after())}exhausted(){this.data.entity instanceof q.K&&(this.data.entity.exhausted=!this.data.entity.exhausted,this.data.entity.exhausted?(this.data.entity.off=!0,this.data.entity.active=!1):this.data.entity.off=!1)}changeMaxHealth(e){this.maxHp+=e,!(this.data.entity instanceof q.K)&&!(this.data.figure instanceof mt.$e)&&(this.health+=e),this.data.figure instanceof mt.$e?(0,$.hZ)(this.data.figure.health)+this.maxHp<=1&&(this.maxHp=1-(0,$.hZ)(this.data.figure.health)):this.data.entity&&(0,$.hZ)(this.data.entity.maxHealth)+this.maxHp<=1&&(this.maxHp=1-(0,$.hZ)(this.data.entity.maxHealth))}setLevel(e){this.data.entity instanceof q.K&&(s.E.stateManager.before("setLevel",s.E.characterManager.characterName(this.data.entity),""+e),s.E.characterManager.setLevel(this.data.entity,e),s.E.stateManager.after())}isImmune(e){return!!this.data.entity&&s.E.entityManager.isImmune(this.data.entity,this.data.figure,e)}markers(){return this.data.entity?[...s.E.markers(),...this.data.entity.markers].filter((e,a,n)=>a==n.indexOf(e)):[]}hasMarker(e){return!!this.data.entity&&s.E.entityManager.hasMarker(this.data.entity,e)}toggleCharacterAbsent(){this.data.entity instanceof q.K&&(this.data.entity.absent||s.E.characterManager.characterCount()>1)&&(s.E.stateManager.before(this.data.entity.absent?"unsetAbsent":"setAbsent",s.E.characterManager.characterName(this.data.entity)),this.data.entity.absent=!this.data.entity.absent,this.data.entity.absent&&this.data.entity.active&&s.E.roundManager.toggleFigure(this.data.entity),s.E.stateManager.after())}toggleCharacterMarker(){this.data.entity instanceof q.K&&(s.E.stateManager.before(this.data.entity.marker?"disableMarker":"enableMarker",s.E.characterManager.characterName(this.data.entity)),this.data.entity.marker=!this.data.entity.marker,s.E.stateManager.after())}toggleMarker(e){if(this.data.entity){const a=new q.K(s.E.getCharacterData(e),1),n=s.E.characterManager.characterName(a),o=a.name;s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,this.hasMarker(e)?"removeMarker":"addMarker"),n,o),s.E.entityManager.toggleMarker(this.data.entity,e),s.E.stateManager.after()}}toggleSummon(){if(this.data.entity instanceof Rt.I){let e=lt.N5.false;this.data.entity.summon==lt.N5.false?e=lt.N5.new:this.data.entity.summon==lt.N5.new&&(e=lt.N5.true),s.E.stateManager.before("setEntitySummonState","data.monster."+this.data.figure.name,"monster."+this.data.entity.type,""+this.data.entity.number,"summon.state."+e),this.data.entity.summon=e,s.E.stateManager.after()}}changeMonsterEntity(){this.data.figure instanceof P.R&&this.data.entity instanceof Rt.I&&(s.E.monsterManager.monsterStandeeMax(this.data.figure)>1||this.data.entity.type!=S.N.boss)&&(this.close(),this.dialog.open(li,{panelClass:["dialog"],data:{monster:this.data.figure,entity:this.data.entity,change:!0},positionStrategy:this.overlay.position().flexibleConnectedTo(this.data.positionElement).withPositions((0,V.yE)())}),(0,V.co)(this.dialogRef))}toggleDead(){(this.data.entity instanceof Rt.I||this.data.entity instanceof lt.up||this.data.entity instanceof oe.X)&&this.dead()}dead(e=!1,a=!1){if(this.data.figure instanceof P.R&&this.data.entity instanceof Rt.I&&(!e||this.catching&&(!this.catchingDisabled||a))){if(s.E.stateManager.before(e?"buildings.stables.pets.catch":"entityDead","data.monster."+this.data.figure.name,"monster."+this.data.entity.type,""+this.data.entity.number),this.data.entity.dead=!0,this.data.figure.entities.every(n=>n.dead)&&this.data.figure.active&&s.E.roundManager.toggleFigure(this.data.figure),e&&null==s.E.game.party.pets.find(n=>this.data.figure instanceof P.R&&n.edition==this.data.figure.edition&&n.name==this.data.figure.pet)){s.E.game.party.pets.push(new Fo.j(this.data.figure.pet,this.data.figure.edition));const n=s.E.game.figures.find(o=>o instanceof q.K&&o.progress.equippedItems.find(g=>"fh"==g.edition&&"247"==g.name&&(!g.tags||-1==g.tags.indexOf(bt.Tr.consumed))));if(n){const o=n.progress.equippedItems.find(g=>"fh"==g.edition&&"247"==g.name&&(!g.tags||-1==g.tags.indexOf(bt.Tr.consumed)));o&&(o.tags=o.tags||[],o.tags.push(bt.Tr.consumed))}}setTimeout(()=>{this.data.figure instanceof P.R&&this.data.entity instanceof Rt.I&&(s.E.monsterManager.removeMonsterEntity(this.data.figure,this.data.entity),s.E.stateManager.after())},m.f.settings.animations?1500*m.f.settings.animationSpeed:0),(0,V.co)(this.dialogRef,!0)}else if(this.data.figure instanceof q.K&&this.data.entity instanceof lt.up)s.E.stateManager.before("summonDead",s.E.characterManager.characterName(this.data.figure),"data.summon."+this.data.entity.name),this.data.entity.dead=!0,setTimeout(()=>{this.data.figure instanceof q.K&&this.data.entity instanceof lt.up&&(s.E.characterManager.removeSummon(this.data.figure,this.data.entity),s.E.stateManager.after())},m.f.settings.animations?1500*m.f.settings.animationSpeed:0),(0,V.co)(this.dialogRef,!0);else if(this.data.figure instanceof mt.$e&&this.data.entity instanceof oe.X){let n=this.data.figure.name;n||(n=this.data.figure.title,n||(n=this.data.figure.escort?"%escort%":"%objective%")),s.E.stateManager.before("objectiveEntityDead",n,""+this.data.entity.number),this.data.entity.dead=!0,this.data.figure.entities.every(o=>o.dead)&&this.data.figure.active&&s.E.roundManager.toggleFigure(this.data.figure),setTimeout(()=>{this.data.figure instanceof mt.$e&&this.data.entity instanceof oe.X&&(s.E.objectiveManager.removeObjectiveEntity(this.data.figure,this.data.entity),s.E.stateManager.after())},m.f.settings.animations&&this.data.figure.entities.some(o=>s.E.entityManager.isAlive(o))?1500*m.f.settings.animationSpeed:0),(0,V.co)(this.dialogRef,!0)}}changeAttack(e){this.data.entity instanceof lt.up&&(this.attack+=e,"number"==typeof this.data.entity.attack&&this.data.entity.attack+this.attack<0&&(this.attack=-this.data.entity.attack))}changeMovement(e){this.data.entity instanceof lt.up&&(this.movement+=e,this.data.entity.movement+this.movement<=0&&(this.movement=-this.data.entity.movement))}changeRange(e){this.data.entity instanceof lt.up&&(this.range+=e,this.data.entity.range+this.range<=0&&(this.range=-this.data.entity.range))}toggleSummonStatus(){if(this.data.entity instanceof lt.up){let e=lt.N5.new;this.data.entity.state==lt.N5.new&&(e=lt.N5.true),s.E.stateManager.before("setSummonState",s.E.characterManager.characterName(this.data.figure),"data.summon."+this.data.entity.name,"summon.state."+e),this.data.entity.state=e,s.E.stateManager.after()}}changeId(e){if(this.data.figure instanceof mt.$e&&this.data.entity instanceof oe.X){this.id+=e;let a=this.data.entity.number+this.id;if(a<1?this.id=12-this.data.entity.number:a>12&&(this.id=1-this.data.entity.number),a=this.data.entity.number+this.id,this.data.figure.entities.length<12)for(;this.data.figure.entities.some(n=>n.number==a&&n!=this.data.entity);)this.id+=e,a=this.data.entity.number+this.id,a<1?this.id=12-this.data.entity.number:a>12&&(this.id=1-this.data.entity.number),a=this.data.entity.number+this.id}}changeMarker(e){this.data.figure instanceof mt.$e&&(this.marker=(0,V.L$)(this.marker+e,mt.ZM.length))}openLevelDialog(){if(this.levelDialog=!0,this.changeDetectorRef.detectChanges(),this.data.entity instanceof q.K&&(this.characterTitleInput&&(this.characterTitleInput.nativeElement.value=this.data.entity.title||m.f.getLabel("data.character."+this.data.entity.edition+"."+this.data.entity.name.toLowerCase())),this.titles=[],this.data.entity.identities&&this.data.entity.identities.length>1&&m.f.settings.characterIdentities)){if(this.titles=this.data.entity.title.split("|"),this.titles.length<this.data.entity.identities.length)for(let e=this.titles.length;e<this.data.entity.identities.length;e++)this.titles.push("");for(let e=0;e<this.titles.length;e++)this.titles[e]||(this.titles[e]=m.f.getLabel("data.character."+this.data.entity.edition+"."+this.data.entity.name.toLowerCase()))}this.data.entity instanceof lt.up&&(this.summonTitleInput.nativeElement.value=this.data.entity.title||m.f.getLabel("data.summon."+this.data.entity.name.toLowerCase()))}applySpecialAction(e){e.noTag||(-1==this.specialTags.indexOf(e.name)?this.specialTags.push(e.name):this.specialTags.splice(this.specialTags.indexOf(e.name),1))}changeShield(e){this.entityShield.value=(0,$.hZ)(this.entityShield.value)+e,this.entityShield.value<0&&(this.entityShield.value=0),s.E.uiChange.emit()}changeShieldPersistent(e){this.entityShieldPersistent.value=(0,$.hZ)(this.entityShieldPersistent.value)+e,this.entityShieldPersistent.value<0&&(this.entityShieldPersistent.value=0),s.E.uiChange.emit()}changeRetaliate(e,a,n){this.entityRetaliate[e]||(this.entityRetaliate[e]=new G.rc(G.X2.retaliate,0)),this.entityRetaliateRange[e]||(this.entityRetaliateRange[e]=new G.rc(G.X2.range,1),this.entityRetaliateRange[e].small=!0),this.entityRetaliate[e].value=(0,$.hZ)(this.entityRetaliate[e].value)+a,this.entityRetaliateRange[e].value=(0,$.hZ)(this.entityRetaliateRange[e].value)+n,(0,$.hZ)(this.entityRetaliate[e].value)<=0&&this.entityRetaliate.length>1&&(this.entityRetaliate.splice(e,1),this.entityRetaliateRange.splice(e,1)),s.E.uiChange.emit()}changeRetaliatePersistent(e,a,n){this.entityRetaliatePersistent[e]||(this.entityRetaliatePersistent[e]=new G.rc(G.X2.retaliate,0)),this.entityRetaliateRangePersistent[e]||(this.entityRetaliateRangePersistent[e]=new G.rc(G.X2.range,1),this.entityRetaliateRangePersistent[e].small=!0),this.entityRetaliatePersistent[e].value=(0,$.hZ)(this.entityRetaliatePersistent[e].value)+a,this.entityRetaliateRangePersistent[e].value=(0,$.hZ)(this.entityRetaliateRangePersistent[e].value)+n,(0,$.hZ)(this.entityRetaliatePersistent[e].value)<=0&&this.entityRetaliatePersistent.length>1&&(this.entityRetaliatePersistent.splice(e,1),this.entityRetaliateRangePersistent.splice(e,1)),s.E.uiChange.emit()}setTitle(e,a){this.titles[a]=e.target.value}setIdentity(e){if(this.data.entity instanceof q.K&&e!=this.data.entity.identity){let a="blinkblade"==this.data.entity.name&&this.data.entity.tags.find(n=>"time_tokens"===n)&&0==this.data.entity.primaryToken;if((s.E.game.state==T.mk.next||s.E.game.state==T.mk.draw&&0==this.data.entity.identity&&0==this.data.entity.tokenValues[0])&&a)return;s.E.stateManager.before("setIdentity",s.E.characterManager.characterName(this.data.entity,!1,!1,!1),this.data.entity.name,this.data.entity.identities[e],this.data.entity.edition),this.data.entity.identity=e,s.E.stateManager.after()}}toggleAMDeck(e){this.data.figure instanceof mt.$e&&(this.data.figure.amDeck==e||this.data.figure.amDeck&&"M"==e?(s.E.stateManager.before("unsetObjectiveAmDeck",this.data.figure.title||this.data.figure.name||this.data.figure.escort?"escort":"objective",e),this.data.figure.amDeck=void 0,s.E.stateManager.after()):"M"!=e&&-1!=this.amDecks.indexOf(e)&&(s.E.stateManager.before("setObjectiveAmDeck",this.data.figure.title||this.data.figure.name||this.data.figure.escort?"escort":"objective",e),this.data.figure.amDeck=e,s.E.stateManager.after()))}close(){this.data.entity instanceof q.K?this.closeCharacter():this.data.figure instanceof P.R?this.closeMonster():this.data.entity instanceof lt.up?this.closeSummon():this.data.entity instanceof oe.X?this.closeObjectiveEntity():this.data.figure instanceof mt.$e&&this.closeObjectiveContainer(),this.closeShieldRetaliate(),this.closeAMs(),this.closeConditions()}closeCharacter(){if(this.data.entity instanceof q.K){if(this.maxHp&&(s.E.stateManager.before("changeMaxHP",s.E.characterManager.characterName(this.data.entity),(0,V.n1)(this.maxHp)),(this.data.entity.maxHealth+this.maxHp<this.data.entity.maxHealth||this.data.entity.health==this.data.entity.maxHealth)&&(this.data.entity.health=this.data.entity.maxHealth+this.maxHp),this.data.entity.maxHealth+=this.maxHp,s.E.stateManager.after(),this.maxHp=0),0!=this.health&&(s.E.stateManager.before("changeHP",s.E.characterManager.characterName(this.data.entity),(0,V.n1)(this.health)),s.E.entityManager.changeHealth(this.data.entity,this.data.figure,this.health),this.health=0,s.E.stateManager.after()),0!=this.experience&&(s.E.stateManager.before("changeXP",s.E.characterManager.characterName(this.data.entity),(0,V.n1)(this.experience)),this.data.entity.experience+=this.experience,this.data.entity.experience<0&&(this.data.entity.experience=0),this.experience=0,s.E.stateManager.after()),0!=this.characterToken){let o=this.data.entity.token+this.characterToken;o<0&&(o=0),s.E.stateManager.before("setCharacterToken",s.E.characterManager.characterName(this.data.entity),o),this.data.entity.token=o,this.characterToken=0,s.E.stateManager.after()}for(let o=0;o<this.data.entity.tokens.length;o++)if(0!=this.characterTokenValues[o]){let g=this.data.entity.tokenValues[o]+this.characterTokenValues[o];g<0&&(g=0),s.E.stateManager.before("setCharacterTokenValue",s.E.characterManager.characterName(this.data.entity),"%data.characterToken."+this.data.figure.name+"."+this.data.entity.tokens[o]+"%",g),this.data.entity.tokenValues[o]=g,this.characterTokenValues[o]=0,s.E.stateManager.after()}0!=this.loot&&(s.E.stateManager.before("changeLoot",s.E.characterManager.characterName(this.data.entity),(0,V.n1)(this.loot)),this.data.entity.loot+=this.loot,this.data.entity.loot<0&&(this.data.entity.loot=0),this.loot=0,s.E.stateManager.after());const e=this.data.entity.tags.filter(o=>this.data.figure instanceof q.K&&this.data.figure.specialActions&&null!=this.data.figure.specialActions.find(g=>g.name==o)&&-1==this.specialTags.indexOf(o));e.length&&(s.E.stateManager.before("removeSpecialTags",s.E.characterManager.characterName(this.data.entity),e.map(o=>"%data.character."+this.data.figure.edition+"."+this.data.figure.name+"."+o+"%").join(",")),this.data.entity.tags=this.data.entity.tags.filter(o=>-1==e.indexOf(o)),"lightning"==this.data.entity.name&&-1!=e.indexOf("careless-charge")&&(this.data.entity.immunities=[],this.entityImmunities=this.data.entity.immunities),"fist"==this.data.entity.name&&-1!=e.indexOf("one-with-the-mountain")&&(this.data.entity.entityConditions=this.data.entity.entityConditions.filter(o=>o.name!=j.r5.regenerate||!o.permanent)),"demolitionist"==this.data.entity.name&&-1!=e.indexOf("mech")&&(this.data.entity.maxHealth-=5,s.E.entityManager.checkHealth(this.data.entity,this.data.entity)),"boneshaper"==this.data.entity.name&&(-1!=e.indexOf("solid-bones")||-1!=e.indexOf("unholy-prowess"))&&this.data.entity.summons.forEach(o=>{"shambling-skeleton"===o.name&&(o.maxHealth-=1,o.health>o.maxHealth&&(o.health=o.maxHealth),-1!=e.indexOf("solid-bones")&&(o.movement-=1,o.action=void 0))}),"astral"==this.data.entity.name&&(-1!=e.indexOf("veil-of-protection")&&(this.data.entity.health-=3,this.data.entity.maxHealth-=3,this.data.entity.summons.forEach(o=>{o.health-=3,o.maxHealth-=3})),-1!=e.indexOf("imbue-with-life")&&(this.data.entity.entityConditions=this.data.entity.entityConditions.filter(o=>o.name!=j.r5.disarm||!o.permanent))),s.E.stateManager.after());const a=this.specialTags.filter(o=>this.data.entity&&-1==this.data.entity.tags.indexOf(o));if(a.length){if(s.E.stateManager.before("addSpecialTags",s.E.characterManager.characterName(this.data.entity),a.map(o=>"%data.character."+this.data.figure.edition+"."+this.data.figure.name+"."+o+"%").join(",")),this.data.entity.tags.push(...a),"lightning"==this.data.entity.name&&-1!=a.indexOf("careless-charge")&&(this.data.entity.immunities=s.E.conditionsForTypes("character","negative").map(o=>o.name),this.data.entity.immunities.push(j.r5.curse),this.hasCondition(j.r5.enfeeble)&&this.data.entity.immunities.push(j.r5.enfeeble),this.entityImmunities=this.data.entity.immunities),"fist"==this.data.entity.name&&-1!=a.indexOf("one-with-the-mountain")){let o=this.data.entity.entityConditions.find(g=>g.name==j.r5.regenerate);o?o.permanent=!0:(o=new j.BR(j.r5.regenerate),o.permanent=!0,this.data.entity.entityConditions.push(o))}if("demolitionist"==this.data.entity.name&&-1!=a.indexOf("mech")&&(this.data.entity.maxHealth+=5,this.data.entity.health+=10,s.E.entityManager.addCondition(this.data.entity,this.data.figure,new j.kW(j.r5.heal,10)),s.E.entityManager.applyCondition(this.data.entity,this.data.figure,j.r5.heal,!0)),"boneshaper"==this.data.entity.name&&(-1!=a.indexOf("solid-bones")||-1!=a.indexOf("unholy-prowess"))&&this.data.entity.summons.forEach(o=>{"shambling-skeleton"===o.name&&(o.maxHealth+=1,o.health==o.maxHealth-1&&(o.health=o.maxHealth),-1!=a.indexOf("solid-bones")&&(o.movement+=1,o.action=new G.rc(G.X2.pierce,1)))}),"astral"==this.data.entity.name&&(-1!=a.indexOf("veil-of-protection")&&(this.data.entity.health+=3,this.data.entity.maxHealth+=3,this.data.entity.summons.forEach(o=>{o.health+=3,o.maxHealth+=3})),-1!=a.indexOf("imbue-with-life"))){let o=this.data.entity.entityConditions.find(g=>g.name==j.r5.disarm);o?(o.expired=!1,o.permanent=!0):(o=new j.BR(j.r5.disarm),o.permanent=!0,this.data.entity.entityConditions.push(o))}s.E.stateManager.after()}let n=this.data.entity.title;if(this.characterTitleInput&&(n=this.characterTitleInput.nativeElement.value),this.titles.length>0){for(let o=0;o<this.titles.length;o++)this.titles[o]==m.f.getLabel("data.character."+this.data.entity.edition+"."+this.data.entity.name.toLowerCase())&&(this.titles[o]="");for(n=this.titles.join("|");n.endsWith("|");)n=n.substring(0,n.length-1)}n!=m.f.getLabel("data.character."+this.data.entity.edition+"."+this.data.entity.name.toLowerCase())?this.data.entity.title!=n&&(s.E.stateManager.before("setTitle",s.E.characterManager.characterName(this.data.entity),n),this.data.entity.title=n,s.E.stateManager.after()):""!=this.data.entity.title&&(s.E.stateManager.before("unsetTitle",s.E.characterManager.characterName(this.data.entity),this.data.entity.title),this.data.entity.title="",s.E.stateManager.after())}}closeMonster(){this.data.figure instanceof P.R&&this.data.entity instanceof Rt.I&&(this.maxHp&&(s.E.stateManager.before("changeEntityMaxHp","data.monster."+this.data.figure.name,"monster."+this.data.entity.type,""+this.data.entity.number,(0,V.n1)(this.maxHp)),this.data.entity.maxHealth+=this.maxHp,s.E.stateManager.after(),this.maxHp=0),0!=this.health&&(s.E.stateManager.before("changeEntityHp","data.monster."+this.data.figure.name,"monster."+this.data.entity.type,""+this.data.entity.number,(0,V.n1)(this.health)),s.E.entityManager.changeHealth(this.data.entity,this.data.figure,this.health),s.E.stateManager.after(),this.health=0),(this.data.entity.maxHealth>0&&this.data.entity.health<=0||this.data.entity.dead)&&(0==this.data.entity.entityConditions.length||this.data.entity.entityConditions.every(e=>!e.highlight&&-1==e.types.indexOf(j.GV.turn)&&-1==e.types.indexOf(j.GV.apply)))&&this.dead())}closeSummon(){if(this.data.figure instanceof q.K&&this.data.entity instanceof lt.up){if(this.data.entity.init)s.E.characterManager.removeSummon(this.data.figure,this.data.entity),s.E.stateManager.before("addSummon",s.E.characterManager.characterName(this.data.figure),this.data.entity.name),this.data.entity.init=!1,0!=this.health&&s.E.entityManager.changeHealth(this.data.entity,this.data.figure,this.health),0!=this.attack&&"number"==typeof this.data.entity.attack&&(this.data.entity.attack+=this.attack),0!=this.movement&&(this.data.entity.movement+=this.movement),0!=this.range&&(this.data.entity.range+=this.range),this.maxHp&&((this.data.entity.maxHealth+this.maxHp<this.data.entity.maxHealth||this.data.entity.health==this.data.entity.maxHealth)&&(this.data.entity.health=this.data.entity.maxHealth+this.maxHp),this.data.entity.maxHealth+=this.maxHp),s.E.characterManager.addSummon(this.data.figure,this.data.entity),s.E.stateManager.after();else{this.summonTitleInput&&(this.summonTitleInput.nativeElement.value&&this.summonTitleInput.nativeElement.value!=this.data.entity.name?this.data.entity.title!=this.summonTitleInput.nativeElement.value&&(s.E.stateManager.before("setTitle",this.data.entity.name,this.summonTitleInput.nativeElement.value),this.data.entity.title=this.summonTitleInput.nativeElement.value,s.E.stateManager.after()):""!=this.data.entity.title&&(s.E.stateManager.before("unsetTitle","data.summon."+this.data.entity.name,this.data.entity.title),this.data.entity.title="",s.E.stateManager.after())),this.maxHp&&(s.E.stateManager.before("changeSummonMaxHp",s.E.characterManager.characterName(this.data.figure),this.data.entity.title?this.data.entity.title:"data.summon."+this.data.entity.name,(0,V.n1)(this.maxHp)),this.data.entity.maxHealth+=this.maxHp,s.E.stateManager.after()),0!=this.health&&(s.E.stateManager.before("changeSummonHp",s.E.characterManager.characterName(this.data.figure),this.data.entity.title?this.data.entity.title:"data.summon."+this.data.entity.name,(0,V.n1)(this.health)),s.E.entityManager.changeHealth(this.data.entity,this.data.figure,this.health),s.E.stateManager.after()),0!=this.attack&&"number"==typeof this.data.entity.attack&&(s.E.stateManager.before("changeSummonAttack",s.E.characterManager.characterName(this.data.figure),this.data.entity.title?this.data.entity.title:"data.summon."+this.data.entity.name,(0,V.n1)(this.attack)),this.data.entity.attack+=this.attack,s.E.stateManager.after()),0!=this.movement&&(s.E.stateManager.before("changeSummonMove",s.E.characterManager.characterName(this.data.figure),this.data.entity.title?this.data.entity.title:"data.summon."+this.data.entity.name,(0,V.n1)(this.movement)),this.data.entity.movement+=this.movement,s.E.stateManager.after()),0!=this.range&&(s.E.stateManager.before("changeSummonRange",s.E.characterManager.characterName(this.data.figure),this.data.entity.title?this.data.entity.title:"data.summon."+this.data.entity.name,(0,V.n1)(this.range)),this.data.entity.range+=this.range,s.E.stateManager.after());const e=this.data.entity.tags.filter(n=>this.data.figure instanceof q.K&&this.data.figure.specialActions&&null!=this.data.figure.specialActions.find(o=>o.name==n)&&-1==this.specialTags.indexOf(n));e.length&&(s.E.stateManager.before("removeSpecialTagsSummon",s.E.characterManager.characterName(this.data.figure),e.map(n=>"%data.character."+this.data.figure.edition+"."+this.data.figure.name+"."+n+"%").join(","),this.data.entity.title?this.data.entity.title:"data.summon."+this.data.entity.name),this.data.entity.tags=this.data.entity.tags.filter(n=>-1==e.indexOf(n)),s.E.stateManager.after());const a=this.specialTags.filter(n=>this.data.entity&&-1==this.data.entity.tags.indexOf(n));a.length&&(s.E.stateManager.before("addSpecialTagsSummon",s.E.characterManager.characterName(this.data.figure),a.map(n=>"%data.character."+this.data.figure.edition+"."+this.data.figure.name+"."+n+"%").join(","),this.data.entity.title?this.data.entity.title:"data.summon."+this.data.entity.name),this.data.entity.tags.push(...a),s.E.stateManager.after())}(this.data.entity.health<=0||this.data.entity.dead)&&(0==this.data.entity.entityConditions.length||this.data.entity.entityConditions.every(e=>!e.highlight&&-1==e.types.indexOf(j.GV.turn)&&-1==e.types.indexOf(j.GV.apply)))&&this.dead()}}showMaxHealth(){return this.data.figure instanceof mt.$e&&!isNaN(+this.data.figure.health)&&(0,$.hZ)(this.data.figure.health)>0}closeObjectiveEntity(){if(this.data.figure instanceof mt.$e&&this.data.entity instanceof oe.X){if(this.maxHp){s.E.stateManager.before("changeObjectiveMaxHp",this.data.figure.title||this.data.figure.name||this.data.figure.escort?"escort":"objective",(0,V.n1)(this.maxHp));const n=(0,$.hZ)(this.data.figure.health)+this.maxHp;this.data.figure.health=n,this.data.figure.entities.forEach(o=>{(o.health==o.maxHealth||o.health>n)&&(o.health=n),o.maxHealth=n}),s.E.stateManager.after()}0!=this.health&&(s.E.stateManager.before("changeObjectiveEntityHP",this.data.figure.title||this.data.figure.name||this.data.figure.escort?"escort":"objective",this.data.entity.number,(0,V.n1)(this.health)),s.E.entityManager.changeHealth(this.data.entity,this.data.figure,this.health),(!this.objectiveData||!this.objectiveData.trackDamage)&&this.data.entity.health<=0&&s.E.objectiveManager.removeObjectiveEntity(this.data.figure,this.data.entity),s.E.stateManager.after(),this.health=0);const e=this.data.entity.number+this.id;e!=this.data.entity.number&&(s.E.stateManager.before("changeObjectiveEntityNumber",this.data.figure.title||this.data.figure.name||this.data.figure.escort?"escort":"objective",this.data.entity.number,""+e),this.data.entity.number=e,s.E.stateManager.after()),this.id=0,this.data.entity.marker||(this.data.entity.marker="");const a=mt.ZM[(0,V.L$)(this.marker+mt.ZM.indexOf(this.data.entity.marker),mt.ZM.length)];a!=this.data.entity.marker&&(a?s.E.stateManager.before("setObjectiveEntityMarker",this.data.figure.title||this.data.figure.name||this.data.figure.escort?"escort":"objective",this.data.entity.number,a):s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"removeEntityMarker"),this.data.entity.marker),this.data.entity.marker=a,s.E.stateManager.after()),this.marker=0,this.objectiveTitleInput&&(this.objectiveTitleInput.nativeElement.value&&this.objectiveTitleInput.nativeElement.value!=this.data.figure.name?this.data.figure.title!=this.objectiveTitleInput.nativeElement.value&&(s.E.stateManager.before("setTitle",this.data.figure.name,this.objectiveTitleInput.nativeElement.value),this.data.figure.title=this.objectiveTitleInput.nativeElement.value,s.E.stateManager.after()):""!=this.data.figure.title&&(s.E.stateManager.before("unsetTitle",this.data.figure.name||this.data.figure.escort?"escort":"objective",this.data.figure.title),this.data.figure.title="",s.E.stateManager.after()))}}closeObjectiveContainer(){if(this.data.figure instanceof mt.$e){this.data.figure.marker=this.data.figure.marker||"";const e=mt.ZM[(0,V.L$)(this.marker+mt.ZM.indexOf(this.data.figure.marker),mt.ZM.length)];e!=this.data.figure.marker&&(s.E.stateManager.before("changeObjectiveMarker",this.data.figure.title||this.data.figure.name||this.data.figure.escort?"escort":"objective",e),this.data.figure.marker=e,this.data.figure.entities.forEach(a=>a.marker=e),s.E.stateManager.after()),this.marker=0,this.objectiveTitleInput&&(this.objectiveTitleInput.nativeElement.value&&this.objectiveTitleInput.nativeElement.value!=this.data.figure.name?this.data.figure.title!=this.objectiveTitleInput.nativeElement.value&&(s.E.stateManager.before("setTitle",this.data.figure.name,this.objectiveTitleInput.nativeElement.value),this.data.figure.title=this.objectiveTitleInput.nativeElement.value,s.E.stateManager.after()):""!=this.data.figure.title&&(s.E.stateManager.before("unsetTitle",this.data.figure.name||this.data.figure.escort?"escort":"objective",this.data.figure.title),this.data.figure.title="",s.E.stateManager.after()))}}closeShieldRetaliate(){if(m.f.settings.characterShieldRetaliate&&(this.data.entity instanceof q.K||this.data.entity instanceof oe.X)||m.f.settings.standeeShieldRetaliate&&(this.data.entity instanceof lt.up||this.data.entity instanceof Rt.I)){this.entityShield.value?(!this.data.entity.shield||this.entityShield.value!=this.data.entity.shield.value)&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"setEntityShield"),this.entityShield.value),this.data.entity.shield=this.entityShield,s.E.stateManager.after()):this.data.entity.shield&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"removeEntityShield")),this.data.entity.shield=void 0,s.E.stateManager.after()),this.entityShieldPersistent.value?(!this.data.entity.shieldPersistent||this.entityShieldPersistent.value!=this.data.entity.shieldPersistent.value)&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"setEntityShieldPersistent"),this.entityShield.value),this.data.entity.shieldPersistent=this.entityShieldPersistent,s.E.stateManager.after()):this.data.entity.shieldPersistent&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"removeEntityShieldPersistent")),this.data.entity.shieldPersistent=void 0,s.E.stateManager.after());const e=this.entityRetaliate.filter(n=>n.value).map((n,o)=>{let g=new G.rc(G.X2.retaliate,n.value);return g.subActions=n.subActions||[],this.entityRetaliateRange[o]&&1!=this.entityRetaliateRange[o].value&&g.subActions.unshift(this.entityRetaliateRange[o]),g});JSON.stringify(e)!=JSON.stringify(this.data.entity.retaliate)&&(e.length>0?s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"setEntityRetaliate"),e.map(n=>"%game.action.retaliate% "+(0,$.hZ)(n.value)+(n.subActions&&n.subActions[0]&&n.subActions[0].type==G.X2.range&&(0,$.hZ)(n.subActions[0].value)>1?" %game.action.range% "+(0,$.hZ)(n.subActions[0].value):"")).join(", ")):s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"removeEntityRetaliate")),this.data.entity.retaliate=e,s.E.stateManager.after());const a=this.entityRetaliatePersistent.filter(n=>n.value).map((n,o)=>{let g=new G.rc(G.X2.retaliate,n.value);return g.subActions=[],this.entityRetaliateRangePersistent[o]&&1!=this.entityRetaliateRangePersistent[o].value&&g.subActions.push(this.entityRetaliateRangePersistent[o]),g});JSON.stringify(a)!=JSON.stringify(this.data.entity.retaliatePersistent)&&(a.length>0?s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"setEntityRetaliatePersistent"),a.map(n=>"%game.action.retaliate% "+(0,$.hZ)(n.value)+(n.subActions&&n.subActions[0]&&n.subActions[0].type==G.X2.range&&(0,$.hZ)(n.subActions[0].value)>1?" %game.action.range% "+(0,$.hZ)(n.subActions[0].value):"")).join(", ")):s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"removeEntityRetaliatePersistent")),this.data.entity.retaliatePersistent=a,s.E.stateManager.after())}}closeAMs(){if(0!=this.bless&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,this.bless<0?"removeCondition"+(this.bless<-1?"s":""):"addCondition"+(this.bless>1?"s":"")),Y.Yn.bless,this.bless>0?this.bless:-1*this.bless),this.changeAttackModifier(Y.Yn.bless,this.bless),s.E.stateManager.after(),this.bless=0),0!=this.curse&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,this.curse<0?"removeCondition"+(this.curse<-1?"s":""):"addCondition"+(this.curse>1?"s":"")),Y.Yn.curse,this.curse>0?this.curse:-1*this.curse),this.changeAttackModifier(Y.Yn.curse,this.curse),s.E.stateManager.after(),this.curse=0),0!=this.empower&&(this.empowerChar||this.empower<0)){if(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,this.empower<0?"removeCondition"+(this.empower<-1?"s":""):"addCondition"+(this.empower>1?"s":"")),Y.Yn.empower,this.empower>0?this.empower:-1*this.empower),this.empowerChar&&this.empower>0){const e=s.E.attackModifierManager.getAdditional(this.empowerChar,Y.Yn.empower);for(let a=0;a<Math.min(this.empower,e.length);a++)s.E.attackModifierManager.addModifier(this.attackModifierDeck(),e[a])}else for(let e=0;e<-1*this.empower;e++){const a=this.attackModifierDeck().cards.find((n,o)=>o>this.attackModifierDeck().current&&n.type==Y.Yn.empower);a&&this.attackModifierDeck().cards.splice(this.attackModifierDeck().cards.indexOf(a),1)}s.E.stateManager.after(),this.empower=0}if(0!=this.enfeeble&&(this.enfeebleChar||this.enfeeble<0)){if(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,this.enfeeble<0?"removeCondition"+(this.enfeeble<-1?"s":""):"addCondition"+(this.enfeeble>1?"s":"")),Y.Yn.enfeeble,this.enfeeble>0?this.enfeeble:-1*this.enfeeble),this.enfeebleChar&&this.enfeeble>0){const e=s.E.attackModifierManager.getAdditional(this.enfeebleChar,Y.Yn.enfeeble);for(let a=0;a<Math.min(this.enfeeble,e.length);a++)s.E.attackModifierManager.addModifier(this.attackModifierDeck(),e[a])}else for(let e=0;e<-1*this.enfeeble;e++){const a=this.attackModifierDeck().cards.find((n,o)=>o>this.attackModifierDeck().current&&n.type==Y.Yn.enfeeble);a&&this.attackModifierDeck().cards.splice(this.attackModifierDeck().cards.indexOf(a),1)}s.E.stateManager.after(),this.enfeeble=0}}closeConditions(){this.data.entity&&(this.entityConditions.filter(e=>e.state==j.mg.new||e.state==j.mg.removed).forEach(e=>{this.data.entity&&(e.state==j.mg.new||s.E.entityManager.hasCondition(this.data.entity,e,e.permanent))&&(this.data.entity instanceof q.K&&e.name==j.r5.muddle&&e.state==j.mg.new&&this.data.entity.progress.equippedItems.find(a=>"gh"==a.edition&&"108"==a.name)&&(e.name=j.r5.strengthen),e.expired=e.state==j.mg.new,s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,e.state==j.mg.removed?"removeCondition":"addCondition"),e.name,this.data.entity instanceof Rt.I?"monster."+this.data.entity.type+" ":""),e.state==j.mg.removed?s.E.entityManager.removeCondition(this.data.entity,this.data.figure,e,e.permanent):s.E.entityManager.addCondition(this.data.entity,this.data.figure,e,e.permanent),s.E.stateManager.after())}),this.entityConditions.forEach(e=>{if(this.data.entity){const a=this.data.entity.entityConditions.find(n=>n.name==e.name&&!n.expired);(-1!=e.types.indexOf(j.GV.stack)||-1!=e.types.indexOf(j.GV.upgrade))&&a&&a.value!=e.value&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"setConditionValue"),e.name,""+e.value,this.data.entity instanceof Rt.I?"monster."+this.data.entity.type+" ":""),a.value=e.value,s.E.stateManager.after())}}),this.data.entity.immunities.forEach(e=>{this.data.entity&&-1==this.entityImmunities.indexOf(e)&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"removeImmunity"),e),this.data.entity.immunities=this.data.entity.immunities.filter(a=>a!=e),s.E.stateManager.after())}),this.entityImmunities.forEach(e=>{this.data.entity&&-1==this.data.entity.immunities.indexOf(e)&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.data.entity,this.data.figure,"addImmunity"),e),this.data.entity.immunities.push(e),s.E.stateManager.after())}))}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(t.gRc),t.rXU(v.ce),t.rXU(v.lG),t.rXU(zt.hJ))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-entity-menu-dialog"]],viewQuery:function(a,n){if(1&a&&(t.GBs(P_,5),t.GBs(b_,5),t.GBs(k_,5)),2&a){let o;t.mGM(o=t.lsd())&&(n.characterTitleInput=o.first),t.mGM(o=t.lsd())&&(n.objectiveTitleInput=o.first),t.mGM(o=t.lsd())&&(n.summonTitleInput=o.first)}},hostBindings:function(a,n){1&a&&t.bIt("keydown",function(g){return n.keyboardShortcuts(g)},t.EBC)},standalone:!1,decls:13,vars:11,consts:[["objectiveTitle",""],["charactertitle",""],["summonTitle",""],[1,"entity-menu-dialog","scroll-container"],[3,"entity","show"],[1,"name"],["tabclick","",1,"name",3,"ngClass"],[1,"status-container"],[1,"character-special"],[1,"identities-container"],[1,"special-actions"],[1,"level-dialog"],[1,"spacer"],["tabclick","",1,"icon","character-icon",3,"click","src"],[1,"character-title",3,"ngClass"],["tabclick","",1,"absent",3,"click","src","ghs-label","ghs-label-attribute"],[1,"icon",3,"src"],[3,"ghs-label"],["tabclick","",1,"name",3,"click","ngClass"],[1,"standee",3,"src"],[1,"ally"],[1,"allied"],[1,"standee-number",3,"ngClass"],[1,"summon-icon",3,"ngClass"],[3,"src"],[1,"summon-number"],[1,"entity-container"],[1,"action-hint"],[1,"summon-stats-container"],[1,"item",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"item",3,"ghs-label","ghs-label-attribute"],[1,"marker-container"],[3,"entityConditions","immunities","entity","figure","type","empower","enfeeble"],[3,"action","highlight"],[1,"item"],["tabclick","",1,"button",3,"singleClick","repeat"],["src","./assets/images/minus.svg",1,"ghs-svg"],[1,"badge","badge-left"],["src","./assets/images/status/health.svg"],[1,"badge","badge-right","health-count",3,"value-sign","hideEmpty"],["tabclick","",1,"button",3,"singleClick","ngClass","repeat"],["src","./assets/images/plus.svg",1,"ghs-svg"],["src","./assets/images/status/experience.svg"],[1,"badge","badge-right",3,"value-sign","hideEmpty"],[1,"item","character-token",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/status/loot.svg"],[1,"badge","badge-left","bless-count"],[1,"condition",3,"ghs-tooltip","originX","overlayX","originY","overlayY","ngClass"],["src","./assets/images/status/bless.svg"],[1,"badge","badge-center","badge-warning"],[1,"badge","badge-left","curse-count"],["src","./assets/images/status/curse.svg"],["src","./assets/images/warning.svg"],[1,"badge","badge-left","empower-count"],["src","./assets/images/status/empower.svg"],[1,"badge","badge-character-icon"],[1,"badge","badge-left","enfeeble-count"],["src","./assets/images/status/enfeeble.svg"],["src","./assets/images/action/damage.svg",1,"damage"],[1,"badge","badge-right","health-count",3,"value-sign","hideEmpty","invert"],["src","./assets/images/left.svg",1,"ghs-svg"],[1,"objective-marker"],["src","./assets/images/right.svg",1,"ghs-svg"],[1,"map-marker",3,"ngClass"],["tabclick","",1,"stat",3,"click"],["src","./assets/images/action/move.svg",1,"ghs-svg"],[3,"value-calc","empty"],["src","./assets/images/action/attack.svg",1,"ghs-svg"],["src","./assets/images/action/range.svg",1,"ghs-svg"],[1,"action"],[3,"action"],["tabclick","",1,"exhausted",3,"click"],["src","./assets/images/status/exhausted.svg",1,"ghs-svg"],["tabclick","",1,"button",3,"click"],["src","./assets/images/status/dead.svg"],["tabclick","",1,"button","level-button",3,"click"],["src","./assets/images/status/level.svg"],["tabclick","",1,"summon",3,"click","ngClass"],[1,"item","max-health-container"],["src","./assets/images/status/health.svg",3,"ghs-label","ghs-label-attribute"],[1,"badge","badge-right","max-health"],["tabclick","",1,"button",3,"singleClick","doubleClick","ngClass"],["src","./assets/images/fh/catching.svg",1,"ghs-svg"],["tabclick","",1,"summon",3,"ngClass"],[1,"item",3,"click","ngClass"],[1,"condition","marker"],[1,"shield-overlay"],[1,"text-white",3,"ghs-label"],["tabclick","",1,"button",3,"singleClick","ngClass"],["tabclick","",1,"button",3,"singleClick"],[1,"separator"],[1,"item","column"],["tabclick","",1,"button","small",3,"singleClick","ngClass"],["tabclick","",1,"button","add-retaliate"],["tabclick","",1,"button","small",3,"singleClick"],["tabclick","",1,"button","add-retaliate",3,"singleClick"],["src","./assets/images/select-arrow.svg",1,"ghs-svg"],[1,"item",3,"ghs-tooltip","ngClass"],[1,"item",3,"click","ghs-tooltip","ngClass"],[1,"hint-container"],["src","./assets/images/hint.svg",1,"hint-trigger","ghs-svg"],["tabclick","",1,"hint-trigger","special-action","text-white",3,"click","ngClass"],[1,"hint","above","center"],[1,"text"],[1,"objective-container"],[1,"title",3,"value"],[1,"decks"],[1,"deck","active","warning"],[1,"deck",3,"ngClass"],[1,"deck",3,"click","ngClass"],[1,"deck","active","warning",3,"click"],[1,"level-container",3,"ngClass"],[1,"char-container"],[1,"titles-container"],["tabclick","",1,"level",3,"click","ngClass"],["type","text",1,"title",3,"value"],[1,"title-container"],["type","text",1,"title",3,"change","value"],[1,"title"],[1,"summon-container"],["tabclick","",1,"button",3,"click","ngClass"],[1,"badge","badge-right",3,"value-calc","empty"],[1,"badge","badge-right"]],template:function(a,n){1&a&&(t.j41(0,"div",3),t.nVh(1,D_,1,2,"ghs-entity-index-key",4),t.j41(2,"div",5),t.nVh(3,I_,6,8),t.nVh(4,B_,5,5),t.nVh(5,U_,7,8,"div",6),t.nVh(6,nm,12,12),t.k0s(),t.nVh(7,Lm,19,15,"div",7),t.nVh(8,Um,1,0,"hr",8),t.nVh(9,Hm,4,4,"div",9),t.nVh(10,Jm,3,0,"div",10),t.nVh(11,ap,8,3),t.nVh(12,_p,3,2,"div",11),t.k0s()),2&a&&(t.R7$(),t.vxM(n.data.entityIndexKey&&n.data.entity?1:-1),t.R7$(2),t.vxM(n.data.entity&&n.gameManager.isCharacter(n.data.figure)&&n.gameManager.isCharacter(n.data.entity)?3:-1),t.R7$(),t.vxM(n.gameManager.isObjectiveContainer(n.data.figure)?4:-1),t.R7$(),t.vxM(n.gameManager.isMonster(n.data.figure)?5:-1),t.R7$(),t.vxM(n.data.entity&&n.gameManager.isCharacter(n.data.figure)&&n.gameManager.isSummon(n.data.entity)?6:-1),t.R7$(),t.vxM(n.levelDialog||n.gameManager.isCharacter(n.data.figure)&&n.gameManager.toCharacter(n.data.figure).absent?-1:7),t.R7$(),t.vxM(n.data.entity&&n.gameManager.isCharacter(n.data.entity)&&(n.settingsManager.settings.characterIdentities&&n.gameManager.toCharacter(n.data.entity).identities&&n.gameManager.toCharacter(n.data.entity).identities.length>1||n.gameManager.toCharacter(n.data.figure).specialActions&&n.gameManager.toCharacter(n.data.figure).specialActions.length>0)?8:-1),t.R7$(),t.vxM(n.data.entity&&n.gameManager.isCharacter(n.data.entity)&&n.settingsManager.settings.characterIdentities&&n.gameManager.toCharacter(n.data.entity).identities&&n.gameManager.toCharacter(n.data.entity).identities.length>1?9:-1),t.R7$(),t.vxM(n.data.entity&&!n.levelDialog&&n.gameManager.isCharacter(n.data.figure)&&n.gameManager.toCharacter(n.data.figure).specialActions&&n.gameManager.toCharacter(n.data.figure).specialActions.length>0?10:-1),t.R7$(),t.vxM(n.gameManager.isObjectiveContainer(n.data.figure)?11:-1),t.R7$(),t.vxM(n.levelDialog?12:-1))},dependencies:[N.YU,ae,mi,pi,tt,ft,rt,At,Ut,Fn,hi,Tt],styles:['.entity-menu-dialog[_ngcontent-%COMP%]{position:relative}.entity-menu-dialog[_ngcontent-%COMP%]   ghs-entity-index-key[_ngcontent-%COMP%]{position:absolute;top:0;left:0}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);min-width:calc(var(--ghs-unit) * 44 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));width:auto;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   img.standee[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top-left-radius:30%;border-top-right-radius:30%;height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));width:auto}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%]{cursor:pointer}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%]:hover{opacity:.4}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .character-title[_ngcontent-%COMP%]{display:flex;align-items:center}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .character-title.absent[_ngcontent-%COMP%]{text-decoration:line-through}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   img.absent[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));cursor:pointer;filter:var(--ghs-filter-white)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .change-entity[_ngcontent-%COMP%]{cursor:w-resize}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.normal[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.elite[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.boss[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.bb-1[_ngcontent-%COMP%]{color:var(--ghs-color-bb-1)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.bb-2[_ngcontent-%COMP%]{color:var(--ghs-color-bb-2)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.bb-3[_ngcontent-%COMP%]{color:var(--ghs-color-bb-3)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.bb-4[_ngcontent-%COMP%]{color:var(--ghs-color-bb-4)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.bb-5[_ngcontent-%COMP%]{color:var(--ghs-color-bb-5)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.bb-6[_ngcontent-%COMP%]{color:var(--ghs-color-bb-6)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.bb-7[_ngcontent-%COMP%]{color:var(--ghs-color-bb-7)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.bb-8[_ngcontent-%COMP%]{color:var(--ghs-color-bb-8)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.bb-9[_ngcontent-%COMP%]{color:var(--ghs-color-bb-9)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .standee-number.bb-10[_ngcontent-%COMP%]{color:var(--ghs-color-bb-10)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .summon-icon[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .summon-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .summon-icon[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * -.1 * var(--ghs-dialog-factor));display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 2.25 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray);border-top-left-radius:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));border-bottom-left-radius:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));z-index:1;opacity:.9}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .summon-icon.fh[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-gh-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);border:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor)) solid var(--ghs-color-white);border-radius:100%}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{flex-basis:100%;flex-shrink:0;display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.entity-menu-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .status-container[_ngcontent-%COMP%]{display:flex;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .status-container[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor)));row-gap:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor));align-items:center;justify-items:center;margin-bottom:auto}.entity-menu-dialog[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.entity-menu-dialog[_ngcontent-%COMP%]   span.item[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   span.item.column[_ngcontent-%COMP%]{flex-direction:column;justify-content:space-around}.entity-menu-dialog[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.entity-menu-dialog[_ngcontent-%COMP%]   a.button[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.entity-menu-dialog[_ngcontent-%COMP%]   a.button[_ngcontent-%COMP%]:hover, .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.button[_ngcontent-%COMP%]:hover{opacity:.4}.entity-menu-dialog[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]:hover, .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.disabled[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.disabled[_ngcontent-%COMP%]:hover{pointer-events:none;color:var(--ghs-color-gray)!important;opacity:initial}.entity-menu-dialog[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.disabled[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}.entity-menu-dialog[_ngcontent-%COMP%]   a.disabled.soft[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]:hover.soft, .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.disabled.soft[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.disabled[_ngcontent-%COMP%]:hover.soft{cursor:initial;pointer-events:initial}.entity-menu-dialog[_ngcontent-%COMP%]   a.small[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.small[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   a.small[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   ghs-pointer-input.small[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));width:auto}.entity-menu-dialog[_ngcontent-%COMP%]   .add-retaliate[_ngcontent-%COMP%]{position:absolute;left:50%;bottom:0;transform:translate(-50%,60%)}.entity-menu-dialog[_ngcontent-%COMP%]   .character-token[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3.25 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:auto}.entity-menu-dialog[_ngcontent-%COMP%]   img.damage[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) brightness(.7) var(--ghs-filter-outline-thin-black)}.entity-menu-dialog[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .condition.disabled[_ngcontent-%COMP%]{color:var(--ghs-color-gray);filter:brightness(.5) grayscale(.2)}.entity-menu-dialog[_ngcontent-%COMP%]   .max-health-container[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:space-evenly;grid-column:2 span;width:calc(var(--ghs-unit) * 14 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .max-health-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:auto}.entity-menu-dialog[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{position:absolute;bottom:0;color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));text-shadow:var(--ghs-outline);text-align:center}.entity-menu-dialog[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:auto}.entity-menu-dialog[_ngcontent-%COMP%]   .badge.badge-left[_ngcontent-%COMP%]{left:0}.entity-menu-dialog[_ngcontent-%COMP%]   .badge.badge-right[_ngcontent-%COMP%]{right:0}.entity-menu-dialog[_ngcontent-%COMP%]   .badge.badge-center[_ngcontent-%COMP%]{bottom:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));left:50%;transform:translate(-50%)}.entity-menu-dialog[_ngcontent-%COMP%]   .badge.badge-warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red)}.entity-menu-dialog[_ngcontent-%COMP%]   .badge.badge-character-icon[_ngcontent-%COMP%]{bottom:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));right:40%}.entity-menu-dialog[_ngcontent-%COMP%]   .badge.badge-character-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   input.badge[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * -1.5 * var(--ghs-dialog-factor));min-width:0;border:none;width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));background:transparent}.entity-menu-dialog[_ngcontent-%COMP%]   .marker-container.marker-container[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .identities-container.marker-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor)));row-gap:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));align-items:center;justify-items:center;margin-bottom:auto;grid-column:1/span 3}.entity-menu-dialog[_ngcontent-%COMP%]   .marker-container.identities-container[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .identities-container.identities-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap}.entity-menu-dialog[_ngcontent-%COMP%]   .marker-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .identities-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .marker-container[_ngcontent-%COMP%]   .item.deactivated[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .identities-container[_ngcontent-%COMP%]   .item.deactivated[_ngcontent-%COMP%]{cursor:initial}.entity-menu-dialog[_ngcontent-%COMP%]   .marker-container[_ngcontent-%COMP%]   .item.active[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .marker-container[_ngcontent-%COMP%]   .item.new[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .identities-container[_ngcontent-%COMP%]   .item.active[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .identities-container[_ngcontent-%COMP%]   .item.new[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) / 4) var(--ghs-color-white) solid;border-radius:100%}.entity-menu-dialog[_ngcontent-%COMP%]   .marker-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover, .entity-menu-dialog[_ngcontent-%COMP%]   .identities-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.entity-menu-dialog[_ngcontent-%COMP%]   .marker-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover.deactivated, .entity-menu-dialog[_ngcontent-%COMP%]   .identities-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover.deactivated{border:none}.entity-menu-dialog[_ngcontent-%COMP%]   .marker-container[_ngcontent-%COMP%]   .item.disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .marker-container[_ngcontent-%COMP%]   .item.deactivated[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .identities-container[_ngcontent-%COMP%]   .item.disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .identities-container[_ngcontent-%COMP%]   .item.deactivated[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:grayscale(.7);opacity:.7}.entity-menu-dialog[_ngcontent-%COMP%]   .item.active[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) / 4) var(--ghs-color-white) solid;border-radius:100%}.entity-menu-dialog[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{grid-column:span 3;width:100%;border-top:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) solid var(--ghs-color-darkgray);margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .action-hint[_ngcontent-%COMP%]{grid-column:span 3;font-size:1.5em}.entity-menu-dialog[_ngcontent-%COMP%]   .shield-overlay[_ngcontent-%COMP%]{grid-column:span 3;font-size:1.7em;height:.5em}.entity-menu-dialog[_ngcontent-%COMP%]   .exhausted[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .condition.marker[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.entity-menu-dialog[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));filter:grayscale(70%)}.entity-menu-dialog[_ngcontent-%COMP%]   .summon.new[_ngcontent-%COMP%]:after, .entity-menu-dialog[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]:hover:after{content:" ";display:block;position:absolute;width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));background-image:url(minus.97c98a810771fceb.svg);background-size:cover}.entity-menu-dialog[_ngcontent-%COMP%]   .summon.active[_ngcontent-%COMP%], .entity-menu-dialog[_ngcontent-%COMP%]   .summon.new[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) / 4) var(--ghs-color-white) solid;border-radius:100%;filter:none}.entity-menu-dialog[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%;filter:none}.entity-menu-dialog[_ngcontent-%COMP%]   .summon.new[_ngcontent-%COMP%]:hover:after, .entity-menu-dialog[_ngcontent-%COMP%]   .summon.active[_ngcontent-%COMP%]:hover:after{content:"";display:none}.entity-menu-dialog[_ngcontent-%COMP%]   .summon.active[_ngcontent-%COMP%]:hover{filter:grayscale(70%)}.entity-menu-dialog[_ngcontent-%COMP%]   .summon.fh.new[_ngcontent-%COMP%]:after, .entity-menu-dialog[_ngcontent-%COMP%]   .summon.fh[_ngcontent-%COMP%]:hover:after{right:calc(var(--ghs-unit) * -.3 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));background-image:url(minus.4a3eac90cfce6ac6.svg);z-index:2}.entity-menu-dialog[_ngcontent-%COMP%]   .summon.fh[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));background-color:var(--ghs-color-darkgray);z-index:1;opacity:.9;font-family:var(--ghs-font-gh-title);color:var(--ghs-color-white);border:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor)) solid var(--ghs-color-white);border-radius:100%}.entity-menu-dialog[_ngcontent-%COMP%]   .max-health-container[_ngcontent-%COMP%]{justify-content:space-evenly!important;width:calc(var(--ghs-unit) * 12 * var(--ghs-dialog-factor))!important}.entity-menu-dialog[_ngcontent-%COMP%]   .max-health-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));width:auto}.entity-menu-dialog[_ngcontent-%COMP%]   .max-health-container[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3.2 * var(--ghs-dialog-factor));filter:var(--ghs-filter-red)}.entity-menu-dialog[_ngcontent-%COMP%]   .summon-stats-container[_ngcontent-%COMP%]{grid-column:span 3;grid-row:span 2;display:flex;flex-direction:column;justify-content:center;align-items:center;margin-bottom:auto}.entity-menu-dialog[_ngcontent-%COMP%]   .summon-stats-container[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .summon-stats-container[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .map-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 4.7 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .map-marker.empty[_ngcontent-%COMP%]{filter:grayscale(.7)}.entity-menu-dialog[_ngcontent-%COMP%]   input.title[_ngcontent-%COMP%]{max-width:calc(var(--ghs-unit) * 20 * var(--ghs-dialog-factor));margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);border-radius:calc(var(--ghs-unit) * 1);user-select:auto;-webkit-user-select:auto;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center}.entity-menu-dialog[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   img.hint-trigger[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:auto;margin-top:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   .special-action[_ngcontent-%COMP%]{height:auto;margin-left:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]   .special-action[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));opacity:.8;filter:grayscale(.5)}.entity-menu-dialog[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]   .special-action[_ngcontent-%COMP%]:after{position:relative;content:" ";width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));transform:scale(0);transform-origin:bottom left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;clip-path:polygon(14% 44%,0 65%,50% 100%,100% 16%,80% 0%,43% 62%);color:var(--ghs-color-white);background-color:var(--ghs-color-white);margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]   .special-action.active-tag[_ngcontent-%COMP%]{opacity:1;filter:none}.entity-menu-dialog[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]   .special-action.active-tag[_ngcontent-%COMP%]:after{transform:scale(1)}.entity-menu-dialog[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:calc(var(--ghs-unit) * 1) 0}.entity-menu-dialog[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);display:flex;justify-content:center;z-index:2;width:calc(var(--ghs-unit) * 5);height:calc(var(--ghs-unit) * 5);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 3.5);line-height:calc(var(--ghs-unit) * 4.5);background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-character-icon.83c1ab396221d56b.png);margin:calc(var(--ghs-unit) * 1);cursor:pointer}.entity-menu-dialog[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * .8);filter:grayscale(100%) brightness(100) contrast(100%);height:70%;width:auto}.entity-menu-dialog[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]:hover{filter:brightness(.7)}.entity-menu-dialog[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .deck.active[_ngcontent-%COMP%]{cursor:initial;filter:grayscale(.5) brightness(.5)}.entity-menu-dialog[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .deck.warning[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) * .4) solid var(--ghs-color-red);border-radius:100%;filter:brightness(.7)}.entity-menu-dialog[_ngcontent-%COMP%]   .objective-container[_ngcontent-%COMP%]{display:flex;align-items:center;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .objective-container[_ngcontent-%COMP%]   .max-health[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .level-button[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));display:flex;align-items:center}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor)));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .level-container.bb[_ngcontent-%COMP%]{grid-template-columns:repeat(3,calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor)))}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .level.active[_ngcontent-%COMP%]{pointer-events:none;border:calc(var(--ghs-unit) / 4) var(--ghs-color-white) solid;border-radius:100%}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .char-container[_ngcontent-%COMP%]{display:flex;align-items:center;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .char-container[_ngcontent-%COMP%]   .titles-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .char-container[_ngcontent-%COMP%]   .titles-container[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]{display:flex;align-items:center}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .char-container[_ngcontent-%COMP%]   .max-health[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor)))}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.entity-menu-dialog[_ngcontent-%COMP%]   .level-dialog[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{left:50%;transform:translate(-50%,calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor)))}']})}return i})();var ot=M(51604);const mp=(i,r,e)=>({inline:i,right:r,fh:e}),pp=i=>({spacing:i}),up=(i,r)=>r.type+i;function fp(i,r){1&i&&t.nrm(0,"div",1)}function Cp(i,r){if(1&i){const e=t.RV6();t.nVh(0,fp,1,0,"div",1),t.j41(1,"ghs-action",2),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG();t.vxM(n.divider[a]?0:-1),t.R7$(),t.Aen(n.style),t.Y8G("action",e)("monster",n.monster)("monsterType",n.monsterType)("objective",n.objective)("inline",n.inline)("right",n.right)("textBlack",n.textBlack)("hexSize",n.hexSize)("relative",n.relative)("statsCalculation",n.statsCalculation)("highlight",-1!=n.highlightActions.indexOf(e.type))("interactiveAbilities",n.interactiveAbilities)("interactiveActions",n.interactiveActions)("index",(n.actionIndex?n.actionIndex+"-":"")+a)("character",n.character)("cardId",n.cardId)("ngClass",t.eq3(20,pp,!n.noDivider&&!n.inline&&a>0&&!n.divider[a]&&n.spacing[a]))}}let vn=(()=>{class i{monster;monsterType;objective;actions;relative=!1;inline=!1;textBlack=!1;right=!1;statsCalculation=!1;interactiveAbilities=!1;interactiveActions=[];interactiveActionsChange=new t.bkB;highlightActions=[];hexSize;actionIndex="";style=!1;noDivider=!1;character;cardId;divider=[];spacing=[];settingsManager=m.f;ActionType=G.X2;ActionValueType=G.iQ;additionalActions=[];additionActionTypes=[G.X2.shield,G.X2.retaliate,G.X2.heal,G.X2.element,G.X2.elementHalf];ngOnInit(){this.update(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){if(this.additionalActions=[],this.monster&&m.f.settings.calculateStats){const e=s.E.monsterManager.getStat(this.monster,this.monster.boss?S.N.boss:S.N.normal);let a=this.monster.boss||this.monster.bb?void 0:s.E.monsterManager.getStat(this.monster,S.N.elite);e.actions&&e.actions.filter(n=>-1!=this.additionActionTypes.indexOf(n.type)).forEach(n=>{!a||a.actions&&a.actions.some(o=>JSON.stringify(n)==JSON.stringify(o))?this.additionalActions.push(JSON.parse(JSON.stringify(n))):a&&(!a.actions||!a.actions.some(o=>JSON.stringify(n)==JSON.stringify(o)))&&this.additionalActions.push(new G.rc(G.X2.monsterType,S.N.normal,G.iQ.fixed,[JSON.parse(JSON.stringify(n))]))}),a&&a.actions.filter(n=>-1!=this.additionActionTypes.indexOf(n.type)).forEach(n=>{(!e.actions||!e.actions.some(o=>JSON.stringify(n)==JSON.stringify(o)))&&this.additionalActions.push(new G.rc(G.X2.monsterType,S.N.elite,G.iQ.fixed,[JSON.parse(JSON.stringify(n))]))})}!this.noDivider&&this.actions&&this.actions.forEach((e,a)=>{this.divider[a]=this.calcDivider(e,a),this.spacing[a]=this.calcSpacing(e,a)})}calcDivider(e,a){return!(a<1||this.inline||(e.type==G.X2.element||e.type==G.X2.elementHalf)&&e.valueType!=G.iQ.minus||e.type==G.X2.card||e.type==G.X2.hint||e.type==G.X2.round||this.actions[a-1].type==G.X2.box||m.f.settings.calculate&&this.actions[a-1].type==G.X2.monsterType&&this.monster&&!this.monster.entities.find(n=>s.E.entityManager.isAlive(n)&&n.type==this.actions[a-1].value)||e.type==G.X2.concatenation&&e.subActions.every(n=>n.type==G.X2.card||n.type==G.X2.element||n.type==G.X2.elementHalf||n.type==G.X2.concatenationSpacer))}calcSpacing(e,a){return!(a<1||this.inline||this.actions[a-1].type==G.X2.box||this.actions[a-1].type==G.X2.round)}onInteractiveActionsChange(e){this.interactiveActionsChange.emit(e)}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-actions"]],inputs:{monster:"monster",monsterType:"monsterType",objective:"objective",actions:"actions",relative:"relative",inline:"inline",textBlack:"textBlack",right:"right",statsCalculation:"statsCalculation",interactiveAbilities:"interactiveAbilities",interactiveActions:"interactiveActions",highlightActions:"highlightActions",hexSize:"hexSize",actionIndex:[0,"index","actionIndex"],style:"style",noDivider:"noDivider",character:"character",cardId:"cardId"},outputs:{interactiveActionsChange:"interactiveActionsChange"},standalone:!1,decls:3,vars:5,consts:[[1,"actions",3,"ngClass"],[1,"divider"],[3,"interactiveActionsChange","action","monster","monsterType","objective","inline","right","textBlack","hexSize","relative","statsCalculation","highlight","interactiveAbilities","interactiveActions","index","character","cardId","ngClass"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.Z7z(1,Cp,2,22,null,null,up),t.k0s()),2&a&&(t.Y8G("ngClass",t.sMw(1,mp,n.inline,n.right,n.settingsManager.settings.fhStyle)),t.R7$(),t.Dyx(n.actions))},dependencies:[N.YU,ae],styles:[".actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;height:100%;position:relative}.actions.inline[_ngcontent-%COMP%]{align-items:flex-start}.actions.right[_ngcontent-%COMP%]{align-items:flex-end;text-align:right}.actions.right[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]{margin-left:auto}.actions[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]{position:relative;width:100%}.actions[_ngcontent-%COMP%]   ghs-action.spacing[_ngcontent-%COMP%]{margin-top:.7em}.actions[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{width:2em;border-top:.11em var(--ghs-color-white) dotted;margin:.1em}.actions[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:first-child{margin-top:auto}.actions[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:last-child{margin-bottom:auto}.actions.fh[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{width:3em;height:.06em;min-height:.06em;border-top:none;background:linear-gradient(90deg,transparent 0%,var(--ghs-color-white) 50%,transparent 100%);margin:.2em}"]})}return i})();const Mp=["container"],vp=(i,r,e,a,n)=>({flipped:i,random:r,fh:e,craft:a,bb:n}),On=(i,r)=>({interactive:i,usable:r}),fi=i=>({fh:i}),Op=()=>[],Pp=i=>[i];function bp(i,r){if(1&i&&(t.j41(0,"span",24),t.EFF(1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.SpI("",e.edition,"\xa0")}}function kp(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function yp(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function xp(i,r){if(1&i&&(t.j41(0,"div",4)(1,"span",26),t.nrm(2,"span",27),t.k0s(),t.j41(3,"div",23),t.nVh(4,bp,2,1,"span",24),t.nVh(5,kp,2,0,"span"),t.nVh(6,yp,2,0,"span"),t.j41(7,"span"),t.EFF(8),t.k0s()()()),2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","game.cards.confirmReveal"),t.R7$(2),t.vxM(e.edition?4:-1),t.R7$(),t.vxM(e.idNumber&&+e.item.id<100?5:-1),t.R7$(),t.vxM(e.idNumber&&+e.item.id<10?6:-1),t.R7$(2),t.JRh(e.item.id)}}function Ep(i,r){if(1&i&&t.nrm(0,"img",7),2&i){const e=t.XpG(3);t.Y8G("src","./assets/artwork/items/"+e.item.edition+"-"+(e.idNumber&&+e.item.id<100?"0":"")+(e.idNumber&&+e.item.id<10?"0":"")+e.item.id+(e.item.backArtwork?"-back":"")+".png",t.B4B)}}function wp(i,r){if(1&i&&t.nrm(0,"span",33),2&i){const e=t.XpG().$index,a=t.XpG(4);t.Y8G("ngClass",t.eq3(2,fi,a.settingsManager.settings.fhStyle))("ghs-label","%game.characterToken."+a.slotsBackMarked[e]+"%")}}function Rp(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",31),t.bIt("singleClick",function(){const n=t.eBV(e).$index,o=t.XpG(4);return t.Njj(o.clickedSlotBack.emit(n))}),t.nrm(1,"ghs-action",32),t.nVh(2,wp,1,4,"span",33),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(4);t.Y8G("ngClass",t.l_i(5,On,n.clickedSlotBack.observed,n.usable)),t.R7$(),t.Aen(n.fhStyle||n.bb?"fh":"gh"),t.Y8G("action",e),t.R7$(),t.vxM(n.slotsBackMarked.length>=a-1&&n.slotsBackMarked[a]?2:-1)}}function jp(i,r){if(1&i&&(t.j41(0,"div",11),t.Z7z(1,Rp,3,8,"span",30,t.fX1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.slotsBack)}}function Gp(i,r){if(1&i&&(t.j41(0,"div",12),t.EFF(1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Lme("",e.count,"/",e.item.count)}}function Tp(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",34),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.flipped=!n.flipped)}),t.nrm(1,"span",35),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","%game.card.flip%"))}function Sp(i,r){if(1&i&&(t.j41(0,"span",24),t.EFF(1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.SpI("",e.edition,"\xa0")}}function $p(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function Dp(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function Ip(i,r){if(1&i&&(t.j41(0,"div",25),t.nrm(1,"span",36),t.k0s()),2&i){const e=t.XpG(3);t.Y8G("ngClass",t.eq3(2,fi,e.settingsManager.settings.fhStyle)),t.R7$(),t.Y8G("ghs-label","%game.characterToken."+e.item.solo+"%")}}function Ap(i,r){if(1&i&&(t.j41(0,"div",5),t.nVh(1,Ep,1,1,"img",7),t.nrm(2,"div",8),t.j41(3,"div",9)(4,"div",10),t.nrm(5,"ghs-actions",28),t.k0s(),t.nVh(6,jp,3,0,"div",11),t.k0s(),t.nVh(7,Gp,2,2,"div",12),t.nVh(8,Tp,2,1,"div",29),t.j41(9,"div",23),t.nVh(10,Sp,2,1,"span",24),t.nVh(11,$p,2,0,"span"),t.nVh(12,Dp,2,0,"span"),t.j41(13,"span"),t.EFF(14),t.k0s()(),t.nVh(15,Ip,2,4,"div",25),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.vxM(e.item.noArtwork?-1:1),t.R7$(),t.Y8G("ghs-label","data.items."+e.item.edition+"-"+e.item.id),t.R7$(3),t.Aen(e.fhStyle||e.bb?"fh":"gh"),t.Y8G("actions",e.item.actionsBack)("noDivider",!0),t.R7$(),t.vxM(e.slotsBack.length>0?6:-1),t.R7$(),t.vxM(e.item.count?7:-1),t.R7$(),t.vxM(e.item.actionsBack&&e.item.actionsBack.length>0?8:-1),t.R7$(2),t.vxM(e.edition?10:-1),t.R7$(),t.vxM(e.idNumber&&+e.item.id<100?11:-1),t.R7$(),t.vxM(e.idNumber&&+e.item.id<10?12:-1),t.R7$(2),t.JRh(e.item.id),t.R7$(),t.vxM(e.item.solo?15:-1)}}function Vp(i,r){if(1&i&&t.nrm(0,"img",7),2&i){const e=t.XpG(2);t.Y8G("src","./assets/artwork/items/"+e.item.edition+"-"+(e.idNumber&&+e.item.id<100?"0":"")+(e.idNumber&&+e.item.id<10?"0":"")+e.item.id+".png",t.B4B)}}function Fp(i,r){if(1&i&&(t.j41(0,"div",10),t.nrm(1,"ghs-actions",28),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Aen(e.fhStyle||e.bb?"fh":"gh"),t.Y8G("actions",e.item.actions)("noDivider",!0)}}function Xp(i,r){if(1&i&&t.nrm(0,"span",33),2&i){const e=t.XpG().$index,a=t.XpG(3);t.Y8G("ngClass",t.eq3(2,fi,a.settingsManager.settings.fhStyle))("ghs-label","%game.characterToken."+a.slotsMarked[e]+"%")}}function Bp(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",31),t.bIt("singleClick",function(){const n=t.eBV(e).$index,o=t.XpG(3);return t.Njj(o.clickedSlot.emit(n))}),t.nrm(1,"ghs-action",32),t.nVh(2,Xp,1,4,"span",33),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.Y8G("ngClass",t.l_i(5,On,n.clickedSlot.observed,n.usable)),t.R7$(),t.Aen(n.fhStyle||n.bb?"fh":"gh"),t.Y8G("action",e),t.R7$(),t.vxM(n.slotsMarked.length>=a-1&&n.slotsMarked[a]?2:-1)}}function Yp(i,r){if(1&i&&(t.j41(0,"div",11),t.Z7z(1,Bp,3,8,"span",30,t.fX1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Dyx(e.slots)}}function Np(i,r){if(1&i&&(t.j41(0,"div",12),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Lme("",e.count,"/",e.item.count)}}function zp(i,r){1&i&&t.nrm(0,"span",37),2&i&&t.Y8G("ghs-label","%game.itemFh."+r.$implicit+"%")}function Lp(i,r){if(1&i&&t.Z7z(0,zp,1,1,"span",37,t.fX1),2&i){const e=t.XpG(3);t.Dyx(e.item.requiredItems)}}function Up(i,r){if(1&i&&(t.j41(0,"span",40),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.SpI("x",e.value)}}function qp(i,r){if(1&i&&(t.j41(0,"span",38),t.nrm(1,"img",39),t.nVh(2,Up,2,1,"span",40),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+e.key+".svg",t.B4B),t.R7$(),t.vxM(e.value&&e.value>1?2:-1)}}function Hp(i,r){if(1&i&&(t.Z7z(0,qp,3,2,"span",38,t.fX1),t.nI1(2,"keyvalue")),2&i){const e=t.XpG(3);t.Dyx(t.bMT(2,0,e.item.resources))}}function Kp(i,r){if(1&i&&(t.j41(0,"span",40),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.SpI("x",e.value)}}function Wp(i,r){if(1&i&&(t.j41(0,"span",38),t.nrm(1,"span",41),t.nVh(2,Kp,2,1,"span",40),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.Y8G("ghs-label","game.items.anyResource")("ghs-label-args",t.eq3(3,Pp,e.key)),t.R7$(),t.vxM(e.value&&e.value>1?2:-1)}}function Jp(i,r){1&i&&(t.Z7z(0,Wp,3,5,"span",38,t.fX1),t.nI1(2,"keyvalue")),2&i&&t.Dyx(t.bMT(2,0,r.$implicit))}function Zp(i,r){if(1&i&&(t.j41(0,"div",13),t.nVh(1,Lp,2,0),t.nVh(2,Hp,3,2),t.Z7z(3,Jp,3,2,null,null,t.fX1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.vxM(e.item.requiredItems?1:-1),t.R7$(),t.vxM(e.item.resources?2:-1),t.R7$(),t.Dyx(e.item.resourcesAny||t.lJ4(2,Op))}}function Qp(i,r){if(1&i&&(t.j41(0,"div",14)(1,"span",40),t.EFF(2),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(2),t.JRh(e.item.cost)}}function tu(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",42),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.clickedConsumed.emit())})("doubleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.clickedConsumed.emit(!0))}),t.nrm(1,"span",35),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.l_i(2,On,e.clickedConsumed.observed,e.usable)),t.R7$(),t.Y8G("ghs-label","%game.card.lost%")}}function eu(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",43),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.clickedSpent.emit())})("doubleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.clickedSpent.emit(!0))}),t.nrm(1,"span",35),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.l_i(2,On,e.clickedSpent.observed,e.usable)),t.R7$(),t.Y8G("ghs-label","%game.card.spent%")}}function nu(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",44),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return n.flipped=!n.flipped,t.Njj(n.clickedFlip.emit())})("doubleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.clickedFlip.emit(!0))}),t.nrm(1,"span",35),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.l_i(2,On,e.clickedFlip.observed,e.usable)),t.R7$(),t.Y8G("ghs-label","%game.card.flip%")}}function iu(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",45),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.clickedPersistent.emit())})("doubleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.clickedPersistent.emit(!0))}),t.nrm(1,"span",35),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.l_i(2,On,e.clickedPersistent.observed,e.usable)),t.R7$(),t.Y8G("ghs-label","%game.card.persistent%")}}function au(i,r){1&i&&(t.j41(0,"div",19),t.nrm(1,"span",35),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","%game.card.loss%"))}function ou(i,r){1&i&&(t.j41(0,"div",20),t.nrm(1,"span",35),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","%game.card.round%"))}function su(i,r){if(1&i&&(t.j41(0,"div",21)(1,"span",46),t.nrm(2,"img",47),t.k0s(),t.j41(3,"span",40),t.EFF(4),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("src","./assets/images"+(e.fhStyle||e.bb?"/fh/attackmodifier/icons/minus1.png":"/items/minus1.svg"),t.B4B),t.R7$(2),t.SpI("x",e.item.minusOne)}}function ru(i,r){if(1&i&&(t.j41(0,"div",22),t.nrm(1,"img",48),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("src","./assets/images/items/slots/"+e.item.slot+".svg",t.B4B)}}function cu(i,r){if(1&i&&(t.j41(0,"span",24),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.SpI("",e.edition,"\xa0")}}function lu(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function gu(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function du(i,r){if(1&i&&(t.j41(0,"div",25),t.nrm(1,"span",36),t.k0s()),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(2,fi,e.settingsManager.settings.fhStyle)),t.R7$(),t.Y8G("ghs-label","%game.characterToken."+e.item.solo+"%")}}function hu(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",3),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.emitRevealed(n))}),t.nVh(1,xp,9,5,"div",4),t.nVh(2,Ap,16,14,"div",5),t.j41(3,"div",6),t.nVh(4,Vp,1,1,"img",7),t.nrm(5,"div",8),t.j41(6,"div",9),t.nVh(7,Fp,2,4,"div",10),t.nVh(8,Yp,3,0,"div",11),t.k0s(),t.nVh(9,Np,2,2,"div",12),t.nVh(10,Zp,5,3,"div",13),t.nVh(11,Qp,3,1,"div",14),t.nVh(12,tu,2,5,"div",15),t.nVh(13,eu,2,5,"div",16),t.nVh(14,nu,2,5,"div",17),t.nVh(15,iu,2,5,"div",18),t.nVh(16,au,2,1,"div",19),t.nVh(17,ou,2,1,"div",20),t.nVh(18,su,5,2,"div",21),t.nVh(19,ru,2,1,"div",22),t.j41(20,"div",23),t.nVh(21,cu,2,1,"span",24),t.nVh(22,lu,2,0,"span"),t.nVh(23,gu,2,0,"span"),t.j41(24,"span"),t.EFF(25),t.k0s()(),t.nVh(26,du,2,4,"div",25),t.k0s()()}if(2&i){const e=t.XpG();t.xc7("font-size",e.fontsize),t.Y8G("ngClass",t.s1E(26,vp,e.flipped,e.item.random,e.fhStyle,e.craft,e.bb))("disabled",!e.reveal||e.item.actionsBack&&e.item.actionsBack.length>0||!1),t.R7$(),t.vxM(e.item.actionsBack&&0!=e.item.actionsBack.length?-1:1),t.R7$(),t.vxM(e.item.actionsBack&&e.item.actionsBack.length>0?2:-1),t.R7$(2),t.vxM(e.bb||e.item.noArtwork?-1:4),t.R7$(),t.Y8G("ghs-label","data.items."+e.item.edition+"-"+e.item.id),t.R7$(2),t.vxM(e.item.actions&&e.item.actions.length>0?7:-1),t.R7$(),t.vxM(e.slots.length>0?8:-1),t.R7$(),t.vxM(e.item.count&&(!e.bb||e.item.count>1)?9:-1),t.R7$(),t.vxM(e.craft?10:-1),t.R7$(),t.vxM(e.item.cost&&!e.item.solo?11:-1),t.R7$(),t.vxM(e.item.consumed?12:-1),t.R7$(),t.vxM(e.item.spent?13:-1),t.R7$(),t.vxM(e.item.actionsBack&&e.item.actionsBack.length>0?14:-1),t.R7$(),t.vxM(e.item.persistent?15:-1),t.R7$(),t.vxM(e.item.loss?16:-1),t.R7$(),t.vxM(e.item.round?17:-1),t.R7$(),t.vxM(e.item.minusOne?18:-1),t.R7$(),t.vxM(e.item.slot?19:-1),t.R7$(2),t.vxM(e.edition?21:-1),t.R7$(),t.vxM(e.idNumber&&+e.item.id<100?22:-1),t.R7$(),t.vxM(e.idNumber&&+e.item.id<10?23:-1),t.R7$(2),t.JRh(e.item.id),t.R7$(),t.vxM(e.item.solo?26:-1)}}let je=(()=>{class i{containerElement;item;identifier;flipped=!1;reveal=!1;count=1;slotsMarked=[];slotsBackMarked=[];editionLabel="";revealed=new t.bkB;clickedConsumed=new t.bkB;clickedSpent=new t.bkB;clickedFlip=new t.bkB;clickedSlot=new t.bkB;clickedSlotBack=new t.bkB;clickedPersistent=new t.bkB;fhStyle=!1;bb=!1;craft=!1;edition="";slots=[];slotsBack=[];idNumber=!1;usable=!0;settingsManager=m.f;gameManager=s.E;fontsize="1em";ngOnInit(){if(!this.item&&this.identifier&&(this.item=s.E.itemManager.getItem(this.identifier.name,this.identifier.edition,!0)),this.item){if(this.item.edition!=this.editionLabel&&(this.edition=this.item.edition),"fh"==this.item.edition&&(this.fhStyle=!0),"bb"==this.item.edition&&(this.bb=!0),(this.item.resources&&Object.values(this.item.resources).some(e=>e)||this.item.requiredItems&&this.item.requiredItems.length>0||this.item.resourcesAny&&this.item.resourcesAny.length>0)&&(this.fhStyle=!0,this.craft=!0),this.item.actions=this.item.actions||[],this.applySlots(this.item.slots,this.slots),this.item.slotsBack&&(this.item.actionsBack=this.item.actionsBack||[],this.applySlots(this.item.slotsBack,this.slots)),this.item.summon&&!this.item.actions.find(e=>e.type==G.X2.summon&&"summonDataItem"==e.value)){const e=new G.rc(G.X2.summon,"summonDataItem");e.valueObject=this.item.summon,e.small=!0,this.item.actions.push(e)}this.idNumber="number"==typeof this.item.id,this.usable=s.E.itemManager.itemUsable(this.item)}this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.fontsize=.072*this.containerElement.nativeElement.offsetWidth+"px",this.item&&(this.usable=s.E.itemManager.itemUsable(this.item))}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}ngAfterViewInit(){setTimeout(()=>{this.fontsize=.072*this.containerElement.nativeElement.offsetWidth+"px"},1)}applySlots(e,a){if(e&&!a.find(n=>n.type==G.X2.card&&n.subActions.length>0&&(""+n.value).startsWith("slot")))for(let n=0;n<e;n++){let o=new G.rc(G.X2.card,"slot");this.fhStyle&&0==n?o=new G.rc(G.X2.card,"slotStart"):this.fhStyle&&n==e-1&&(o=new G.rc(G.X2.card,"slotEnd")),e>3&&(o.small=!0),a.push(o)}}applySlotsGrid(e,a){if(e&&!a.find(n=>n.type==G.X2.grid&&n.subActions.length>0&&n.subActions[0].type==G.X2.card&&(""+n.subActions[0].value).startsWith("slot")))if(e<5){const n=new G.rc(G.X2.grid,e);for(let o=0;o<e;o++)n.subActions.push(new G.rc(G.X2.card,this.fhStyle&&0==o?"slotStart":this.fhStyle&&o==e-1?"slotEnd":"slot"));e>3&&(n.small=!0),a.push(n)}else{const n=Math.ceil(e/3);for(let o=0;o<n;o++){const g=o<n-1?3:e%3,_=new G.rc(G.X2.grid,g);n>1&&(_.small=!0);for(let y=0;y<g;y++)_.subActions.push(new G.rc(G.X2.card,this.fhStyle&&0==y&&0==o?"slotStart":this.fhStyle&&y==g-1&&o==n-1?"slotEnd":"slot"));a.push(_)}}}emitRevealed(e){this.revealed.emit(e)}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-item"]],viewQuery:function(a,n){if(1&a&&t.GBs(Mp,5),2&a){let o;t.mGM(o=t.lsd())&&(n.containerElement=o.first)}},inputs:{item:"item",identifier:"identifier",flipped:"flipped",reveal:"reveal",count:"count",slotsMarked:"slotsMarked",slotsBackMarked:"slotsBackMarked",editionLabel:"editionLabel"},outputs:{revealed:"revealed",clickedConsumed:"clickedConsumed",clickedSpent:"clickedSpent",clickedFlip:"clickedFlip",clickedSlot:"clickedSlot",clickedSlotBack:"clickedSlotBack",clickedPersistent:"clickedPersistent"},standalone:!1,decls:3,vars:1,consts:[["container",""],[1,"item-container"],["card-reveal","",1,"card","vertical","reverse","item",3,"ngClass","fontSize","disabled"],["card-reveal","",1,"card","vertical","reverse","item",3,"change","ngClass","disabled"],[1,"card-back","back"],[1,"card-back","front"],[1,"card-front","front"],[1,"artwork",3,"src"],[1,"name",3,"ghs-label"],[1,"content"],[1,"actions"],[1,"actions","slot-actions"],[1,"count"],[1,"craft"],[1,"costs"],["ghs-pointer-input","",1,"consumed",3,"ngClass"],["ghs-pointer-input","",1,"spent",3,"ngClass"],["ghs-pointer-input","",1,"flip",3,"ngClass"],["ghs-pointer-input","",1,"persistent",3,"ngClass"],[1,"loss"],[1,"round"],[1,"minus-one"],[1,"slot"],[1,"id"],[1,"edition"],[1,"solo",3,"ngClass"],[1,"revealed"],[1,"text",3,"ghs-label"],[3,"actions","noDivider"],["ghs-pointer-input","",1,"flip"],["ghs-pointer-input","",1,"slot-action",3,"ngClass"],["ghs-pointer-input","",1,"slot-action",3,"singleClick","ngClass"],[3,"action"],[1,"marker",3,"ngClass","ghs-label"],["ghs-pointer-input","",1,"flip",3,"singleClick"],[1,"placeholder","text-white",3,"ghs-label"],[3,"ghs-label"],[1,"required-item",3,"ghs-label"],[1,"resource"],[3,"src"],[1,"value"],[1,"any",3,"ghs-label","ghs-label-args"],["ghs-pointer-input","",1,"consumed",3,"singleClick","doubleClick","ngClass"],["ghs-pointer-input","",1,"spent",3,"singleClick","doubleClick","ngClass"],["ghs-pointer-input","",1,"flip",3,"singleClick","doubleClick","ngClass"],["ghs-pointer-input","",1,"persistent",3,"singleClick","doubleClick","ngClass"],[1,"card-icon","small"],[1,"icon",3,"src"],[1,"ghs-svg",3,"src"]],template:function(a,n){1&a&&(t.j41(0,"div",1,0),t.nVh(2,hu,27,32,"div",2),t.k0s()),2&a&&(t.R7$(2),t.vxM(n.item?2:-1))},dependencies:[N.YU,ae,vn,Be,tt,rt,N.lG],styles:[".item-container[_ngcontent-%COMP%]{position:relative;width:100%;padding-bottom:147%}.item[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;color:var(--ghs-color-white)}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]{background-image:url(item-front.8bf9b41fdff9cdd6.png);background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:.5em;background-clip:padding-box}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .artwork[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;-webkit-mask-image:url(item-front-mask.3394fd70bd536cc8.png);mask-image:url(item-front-mask.3394fd70bd536cc8.png);-webkit-mask-size:100% 100%;mask-size:100% 100%;-webkit-mask-position:center center;mask-position:center center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;top:4%;left:50%;width:90%;height:10%;display:flex;justify-content:center;align-items:center;text-align:center;transform:translate(-56%);font-family:var(--ghs-font-gh-title);font-size:1.2em;filter:var(--ghs-filter-outline)}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]{position:relative;height:3.5em;width:3.5em;margin:.2em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:auto}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .card-icon.small[_ngcontent-%COMP%]{height:2.2em;width:2.2em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{position:absolute;top:60%;left:50%;width:100%;height:27%;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;transform:translate(-50%);font-family:var(--ghs-font-gh-normal);font-size:1.25em;line-height:.8em;--ghs-filter-shadow: brightness(1) !important;--ghs-filter-shadow-thin: brightness(1) !important}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{width:85%;font-size:1.2em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{width:95%;font-size:calc(1em * var(--ghs-fontsize))}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{filter:none}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]   .text-white[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .actions.slot-actions[_ngcontent-%COMP%]{width:85%;display:flex;flex-wrap:wrap;justify-content:center;align-items:center}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .actions.slot-actions[_ngcontent-%COMP%]   .slot-action[_ngcontent-%COMP%]{position:relative;margin:-.2em .2em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .actions.slot-actions[_ngcontent-%COMP%]   .slot-action[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]{position:absolute;top:calc(.2em * var(--ghs-fontsize));left:calc(.2em * var(--ghs-fontsize));font-size:calc(1.2em * var(--ghs-fontsize))}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .actions.slot-actions[_ngcontent-%COMP%]   .slot-action[_ngcontent-%COMP%]   .marker.fh[_ngcontent-%COMP%]{font-size:calc(1em * var(--ghs-fontsize))}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{position:absolute;top:51.5%;left:11%;width:10%;height:5%;display:flex;justify-content:center;align-items:center;text-align:center;font-family:var(--ghs-font-gh-normal);font-size:.8em;text-shadow:var(--ghs-filter-outline-thin)}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]{position:absolute;top:45%;left:71%;width:20%;height:13%;display:flex;justify-content:center;align-items:center;text-align:center}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);font-size:2em;filter:var(--ghs-filter-outline-thin)}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .craft[_ngcontent-%COMP%]{position:absolute;top:13%;left:80.4%;width:15%;height:35%;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;font-family:var(--ghs-font-gh-title);font-size:1em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .craft[_ngcontent-%COMP%]   .required-item[_ngcontent-%COMP%]{font-size:1.2em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .craft[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:1em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .craft[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1.7em;width:auto}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .craft[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]   .any[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-text);color:var(--ghs-color-black);font-size:1.2em;line-height:.9em;font-weight:700}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .craft[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-text);color:var(--ghs-color-black);margin:-.4em 0;font-size:1.2em;font-weight:700}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .craft[_ngcontent-%COMP%]   .required-item[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .craft[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]{width:100%;margin:.1em 0;border-top:.12em solid transparent}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .craft[_ngcontent-%COMP%]   .required-item[_ngcontent-%COMP%]:not(:first-child), .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .craft[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]:not(:first-child){border-color:var(--ghs-color-black)}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .flip[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .persistent[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .loss[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round[_ngcontent-%COMP%]{position:absolute;top:81%;left:69%;width:20%;height:13%;display:flex;justify-content:center;align-items:center;text-align:center;font-size:1.8em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed.consumed[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent.consumed[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .flip.consumed[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .persistent.consumed[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .loss.consumed[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round.consumed[_ngcontent-%COMP%]{left:71%}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed.persistent[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed.round[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent.persistent[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent.round[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .flip.persistent[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .flip.round[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .persistent.persistent[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .persistent.round[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .loss.persistent[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .loss.round[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round.persistent[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round.round[_ngcontent-%COMP%]{left:12.5%}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed.flip[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent.flip[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .flip.flip[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .persistent.flip[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .loss.flip[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round.flip[_ngcontent-%COMP%]{cursor:ew-resize}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed.loss[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent.loss[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .flip.loss[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .persistent.loss[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .loss.loss[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round.loss[_ngcontent-%COMP%]{left:57%;font-size:1.2em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .interactive[_ngcontent-%COMP%]{cursor:not-allowed}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .interactive.usable[_ngcontent-%COMP%]{cursor:pointer}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .interactive.usable[_ngcontent-%COMP%]:hover{opacity:.6}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .minus-one[_ngcontent-%COMP%]{position:absolute;top:84%;left:12.5%;width:25%;height:13%;display:flex;justify-content:center;align-items:center;text-align:center;font-family:var(--ghs-font-gh-title);font-size:.8em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .minus-one[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:1.4em;filter:var(--ghs-filter-outline-thin);margin-top:-.5em;margin-left:.1em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]{position:absolute;top:88%;left:45%;width:10%;height:7%;display:flex;justify-content:center;align-items:center}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:100%;width:auto;opacity:.8}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{position:absolute;top:1%;left:80%;width:15%;height:7%;display:flex;justify-content:flex-end;align-items:center;font-family:var(--ghs-font-gh-normal);font-size:.8em;filter:var(--ghs-filter-thin)}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]{text-transform:uppercase}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .solo[_ngcontent-%COMP%]{position:absolute;top:43.5%;left:70%;width:23%;height:15%;display:flex;justify-content:center;align-items:center;z-index:1;font-size:2.4em}.item[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .solo.fh[_ngcontent-%COMP%]{font-size:2.1em;top:41%}.item[_ngcontent-%COMP%]   .front.card-back[_ngcontent-%COMP%]{background-image:url(item-front-flipped.127cb9a750311d37.png)!important}.item[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%]{background-image:url(item-back.64e65973760cc390.png);background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:.5em;background-clip:padding-box}.item[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{position:absolute;top:46.5%;left:0%;width:22%;height:7%;display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-gh-normal);font-size:1.2em;filter:var(--ghs-filter-outline)}.item.disabled[_ngcontent-%COMP%]{cursor:initial}.item.confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]{position:relative;top:30%;width:100%;height:70%;display:flex;justify-content:center;align-items:center;text-align:center;color:var(--ghs-color-white);font-size:1.5em;filter:drop-shadow(calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) var(--ghs-color-black))}.item.confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{text-align:center}.item.random[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]{background-image:url(item-random-front.88f16c05c7ae8ab1.png)}.item.random[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%]{background-image:url(item-random-back.4e43c9e17cefa170.png)}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]{background-image:url(item-front-fh.4fc516965fc2ca34.png)}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .artwork[_ngcontent-%COMP%]{-webkit-mask-image:url(item-front-mask-fh.cd7e1477ce66b2d1.png);mask-image:url(item-front-mask-fh.cd7e1477ce66b2d1.png)}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{top:1%;font-family:var(--ghs-font-fh-title);letter-spacing:.02em;transform:translate(-58%)}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-text)!important;font-size:1.4em;line-height:1em}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{top:48.5%;left:5%;letter-spacing:.1em}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]{top:35%;left:69.5%;background-image:url(costs.fa9800cb8300123b.png);background-size:contain;background-repeat:no-repeat;width:28%;height:19%}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{position:relative;font-size:2.3em;top:-.5%;left:-.5%}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .flip[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .persistent[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .loss[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round[_ngcontent-%COMP%]{top:84%;left:73%}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed.consumed[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent.consumed[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .flip.consumed[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .persistent.consumed[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .loss.consumed[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round.consumed[_ngcontent-%COMP%]{left:74%}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed.persistent[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed.round[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent.persistent[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent.round[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .flip.persistent[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .flip.round[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .persistent.persistent[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .persistent.round[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .loss.persistent[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .loss.round[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round.persistent[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round.round[_ngcontent-%COMP%]{left:4%}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed.loss[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent.loss[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .flip.loss[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .persistent.loss[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .loss.loss[_ngcontent-%COMP%], .item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round.loss[_ngcontent-%COMP%]{left:58.5%;font-size:1.7em}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .minus-one[_ngcontent-%COMP%]{top:86%;left:4%;font-family:var(--ghs-font-fh-text);font-size:.9em}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .minus-one[_ngcontent-%COMP%]   .card-icon.small[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:80%;left:20%}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .minus-one[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{margin-top:-.3em}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]{top:90.5%}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{opacity:.5}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{top:0%;left:83%;align-items:flex-start}.item.fh[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .solo[_ngcontent-%COMP%]{top:36%;font-size:2em}.item.fh[_ngcontent-%COMP%]   .front.card-back[_ngcontent-%COMP%]{background-image:url(item-front-fh.4fc516965fc2ca34.png)!important}.item.fh[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%]{background-image:url(item-back-fh.e293bb7bd25a2ea5.png)}.item.fh[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{transform:rotate(-90deg);top:24%;left:-6%;color:var(--ghs-color-black);filter:none;font-family:var(--ghs-font-fh-title);font-size:1em}.item.fh.random[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]{background-image:url(item-random-front-fh.2b2d210fbf1d2b55.png)}.item.fh.random[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%]{background-image:url(item-random-back-fh.45214b480302b366.png)}.item.fh.craft[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]{background-image:url(item-craft-front-fh.d073f3df88fe481d.png)}.item.fh.craft[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .artwork[_ngcontent-%COMP%]{-webkit-mask-image:url(item-craft-front-mask-fh.0f1291f6ecc709fa.png);mask-image:url(item-craft-front-mask-fh.0f1291f6ecc709fa.png)}.item.fh.craft[_ngcontent-%COMP%]   .front.card-back[_ngcontent-%COMP%]   .artwork[_ngcontent-%COMP%]{left:15%}.item.fh.craft.random[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]{background-image:url(item-craft-random-front-fh.9511a49714d79585.png)}.item.bb[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]{background-image:url(item-front-bb.ffe0ae0c84f98c49.png)}.item.bb[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-title)!important;top:30%;transform:translate(-50%);text-transform:uppercase;font-size:1.1em;filter:none;text-align:center}.item.bb[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-text)!important;top:45%;font-size:1.7em;line-height:1.2em}.item.bb[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .spent[_ngcontent-%COMP%], .item.bb[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .consumed[_ngcontent-%COMP%]{top:75%;left:50%;transform:translate(-50%)}.item.bb[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]{top:20%}.item.bb[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.item.bb[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{top:initial;bottom:0%;left:0%;align-items:flex-start}"]})}return i})();const _u=(i,r)=>({equipped:i,disabled:r}),mu=(i,r)=>({selected:i,unavailable:r}),pu=(i,r,e)=>({filtered:i,unavailable:r,owned:e});function uu(i,r){if(1&i&&t.nrm(0,"ghs-item",2),2&i){const e=t.XpG();t.Y8G("item",e.item)("flipped",e.flipped)("count",e.gameManager.itemManager.assigned(e.item))("editionLabel",e.gameManager.currentEdition())("ngClass",t.l_i(5,mu,!(e.dialog||!e.equipped()),!e.dialog&&e.bbBlocked()))}}function fu(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-item",7),t.bIt("clickedConsumed",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.toggleFlag(n,o.ItemFlags.consumed))})("clickedFlip",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.toggleFlag(n,o.ItemFlags.flipped))})("clickedSpent",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.toggleFlag(n,o.ItemFlags.spent))})("clickedPersistent",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.toggleFlag(n,o.ItemFlags.persistent))})("clickedSlot",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.toggleFlagCount(n,o.ItemFlags.slot))})("clickedSlotBack",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.toggleFlagCount(n,o.ItemFlags.slotBack))}),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("item",e.item)("count",e.gameManager.itemManager.assigned(e.item))("flipped",e.flipped&&!e.countFlag(e.ItemFlags.flipped))("slotsMarked",e.slotsMarked(e.ItemFlags.slot))("slotsBackMarked",e.slotsMarked(e.ItemFlags.slotBack))("editionLabel",e.gameManager.currentEdition())("ngClass",t.sMw(7,pu,!e.equipped(),e.countFlag(e.ItemFlags.consumed)>0||e.bbBlocked(),e.countFlag(e.ItemFlags.persistent)>0))}}function Cu(i,r){1&i&&(t.j41(0,"span",4),t.nrm(1,"img",8),t.k0s())}let la=(()=>{class i{character;item;flipped=!0;setup=!1;dialog=!1;gameManager=s.E;settingsManager=m.f;ItemFlags=bt.Tr;GameState=T.mk;equipped(){return this.character.progress.equippedItems.find(e=>e.name==""+this.item.id&&e.edition==this.item.edition)}bbBlocked(){return s.E.bbRules()&&!this.equipped()&&null!=this.character.progress.equippedItems.find(e=>"number"==typeof this.item.id&&+e.name==(this.item.id%2==0?this.item.id-1:this.item.id+1)&&e.edition==this.item.edition)}isLootRandomItem(){return this.character.progress.equippedItems.find(e=>e.name==""+this.item.id&&e.edition==this.item.edition&&"loot-random-item"==e.marker)}toggleEquippedItem(e=!1){const a=null!=this.character.progress.items.find(n=>n.name==""+this.item.id&&n.edition==this.item.edition);(this.setup||e)&&(a||!this.bbBlocked()||e)&&(s.E.stateManager.before(this.equipped()?"unequipItem":"equipItem",s.E.characterManager.characterName(this.character),this.item.id,this.item.edition),s.E.itemManager.toggleEquippedItem(this.item,this.character,e),s.E.bbRules()&&(!this.equipped()&&a?s.E.itemManager.removeItem(this.item,this.character):this.equipped()&&!a&&s.E.itemManager.addItem(this.item,this.character)),s.E.stateManager.after(),m.f.settings.animations&&setTimeout(()=>{s.E.uiChange.emit()},500*m.f.settings.animationSpeed))}countFlag(e){const a=this.equipped();return a&&a.tags&&a.tags.filter(n=>n==e).length||0}toggleFlag(e,a){if((e||!s.E.challengesManager.apply||!s.E.challengesManager.isActive(1502,"fh")||this.item.slot!=bt.o8.small)&&(!this.setup&&s.E.game.state==T.mk.next||e)){const n=this.equipped();n&&(s.E.itemManager.itemUsable(this.item)||e)&&(n.tags=n.tags||[],s.E.stateManager.before((-1==n.tags.indexOf(a)?"characterItemApply.":"characterItemUnapply.")+a,s.E.characterManager.characterName(this.character),this.item.id,this.item.edition,this.item.name),-1==n.tags.indexOf(a)?!e&&s.E.challengesManager.apply&&s.E.challengesManager.isActive(1507,"fh")&&a==bt.Tr.spent?n.tags.push(bt.Tr.consumed):n.tags.push(a):(n.tags=n.tags.filter(o=>o!=a),a==bt.Tr.spent&&(n.tags=n.tags.filter(o=>o!=bt.Tr.slot&&o!=bt.Tr.slotBack))),(a==bt.Tr.consumed||a==bt.Tr.spent)&&-1!=n.tags.indexOf(a)&&m.f.settings.characterItemsApply&&s.E.itemManager.applyItemEffects(this.character,this.item,!0),s.E.stateManager.after(),m.f.settings.animations&&setTimeout(()=>{s.E.uiChange.emit()},500*m.f.settings.animationSpeed))}}toggleFlagCount(e,a){if(!this.setup&&s.E.game.state==T.mk.next){const n=this.equipped();if(n){n.tags=n.tags||[];const o=this.countFlag(a);if(s.E.stateManager.before((o<=e?"characterItemApply.":"characterItemUnapply.")+a,s.E.characterManager.characterName(this.character),this.item.id,this.item.edition,this.item.name),o<=e){for(let g=o;g<=e;g++)n.tags.push(a);a==bt.Tr.slot&&this.countFlag(a)==this.item.slots&&(this.item.spent&&!this.countFlag(bt.Tr.spent)?n.tags.push(bt.Tr.spent):this.item.consumed&&!this.countFlag(bt.Tr.consumed)&&n.tags.push(bt.Tr.consumed))}else for(let g=e;g<o;g++)n.tags.splice(n.tags.indexOf(a),1);s.E.stateManager.after(),m.f.settings.animations&&setTimeout(()=>{s.E.uiChange.emit()},500*m.f.settings.animationSpeed)}}}slotsMarked(e){let a=[];for(let n=0;n<this.countFlag(e);n++)a.push(this.character.name);return a}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-character-item"]],inputs:{character:"character",item:"item",flipped:"flipped",setup:"setup",dialog:"dialog"},standalone:!1,decls:7,vars:9,consts:[["container",""],[1,"item"],["ghs-pointer-input","",3,"item","flipped","count","editionLabel","ngClass"],[3,"item","count","flipped","slotsMarked","slotsBackMarked","editionLabel","ngClass"],[1,"loot-random-item"],["ghs-pointer-input","",1,"button-equip",3,"singleClick","doubleClick","ngClass"],["src","./assets/images/check.svg",1,"ghs-svg"],[3,"clickedConsumed","clickedFlip","clickedSpent","clickedPersistent","clickedSlot","clickedSlotBack","item","count","flipped","slotsMarked","slotsBackMarked","editionLabel","ngClass"],["src","./assets/images/fh/loot-token.png"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",1,0),t.nVh(2,uu,1,8,"ghs-item",2),t.nVh(3,fu,1,11,"ghs-item",3),t.nVh(4,Cu,2,0,"span",4),t.j41(5,"a",5),t.bIt("singleClick",function(){return t.eBV(o),t.Njj(n.toggleEquippedItem())})("doubleClick",function(){return t.eBV(o),t.Njj(n.toggleEquippedItem(!0))}),t.nrm(6,"img",6),t.k0s()()}if(2&a){const o=t.sdS(1);t.xc7("font-size",.1*o.offsetWidth+"px"),t.R7$(2),t.vxM(n.setup?2:-1),t.R7$(),t.vxM(n.setup?-1:3),t.R7$(),t.vxM(n.isLootRandomItem()?4:-1),t.R7$(),t.Y8G("ngClass",t.l_i(6,_u,n.equipped(),!n.setup||n.bbBlocked()))}},dependencies:[N.YU,je,rt],styles:[".item[_ngcontent-%COMP%]{position:relative;width:100%;padding-bottom:150%}.item[_ngcontent-%COMP%]   ghs-item[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;border:.1em solid transparent;border-radius:.5em;overflow:hidden;cursor:initial}.item[_ngcontent-%COMP%]   ghs-item.disabled[_ngcontent-%COMP%]{opacity:.5}.item[_ngcontent-%COMP%]   ghs-item.unavailable[_ngcontent-%COMP%]{cursor:not-allowed;border-color:var(--ghs-color-darkgray);filter:grayscale(.7)}.item[_ngcontent-%COMP%]   ghs-item.filtered[_ngcontent-%COMP%]{border-color:var(--ghs-color-red)}.item[_ngcontent-%COMP%]   ghs-item.selected[_ngcontent-%COMP%]{cursor:pointer;border-color:var(--ghs-color-green)}.item[_ngcontent-%COMP%]   .loot-random-item[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;position:absolute;top:-1em;left:-1em;width:1.8em;height:1.8em}.item[_ngcontent-%COMP%]   .loot-random-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:auto}.item[_ngcontent-%COMP%]   .button-equip[_ngcontent-%COMP%]{z-index:1;position:absolute;display:flex;cursor:pointer;bottom:.5em;left:4.2em;justify-content:center;align-items:center;width:1.6em;height:1.6em;opacity:.6}.item[_ngcontent-%COMP%]   .button-equip.disabled[_ngcontent-%COMP%]{cursor:initial}.item[_ngcontent-%COMP%]   .button-equip[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:100%;height:auto;filter:var(--ghs-filter-white)}.item[_ngcontent-%COMP%]   .button-equip.equipped[_ngcontent-%COMP%]{opacity:1}.item[_ngcontent-%COMP%]   .button-equip.equipped[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.item[_ngcontent-%COMP%]   .button-equip[_ngcontent-%COMP%]:hover:not(.disabled){opacity:.6}.item[_ngcontent-%COMP%]   .button-equip[_ngcontent-%COMP%]:hover:not(.disabled)   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.item[_ngcontent-%COMP%]   .button-equip[_ngcontent-%COMP%]:hover:not(.disabled).equipped   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-red)}"]})}return i})();const Mu=(i,r)=>({closed:i,opened:r});function vu(i,r){if(1&i&&t.nrm(0,"ghs-item",1),2&i){const e=t.XpG();t.Y8G("item",e.item)("flipped",e.opened)("editionLabel",e.gameManager.currentEdition())}}function Ou(i,r){if(1&i&&t.nrm(0,"ghs-character-item",2),2&i){const e=t.XpG();t.Y8G("character",e.character)("item",e.item)("setup",e.setup)("flipped",e.opened)("dialog",!0)}}function Pu(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",5),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.close())}),t.k0s()}}let Me=(()=>{class i{data;dialogRef;opened=!1;gameManager=s.E;item;character;setup=!1;constructor(e,a){this.data=e,this.dialogRef=a,this.item=e.item,this.character=e.character,this.setup=e.setup||!1}ngOnInit(){this.opened=!0}close(){this.opened=!1,setTimeout(()=>{this.dialogRef.close()},m.f.settings.animations?1e3*m.f.settings.animationSpeed:0)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-item-dialog"]],standalone:!1,decls:5,vars:7,consts:[[1,"item-dialog",3,"click","ngClass"],[3,"item","flipped","editionLabel"],[3,"character","item","setup","flipped","dialog"],[1,"close-dialog"],[1,"close-container",3,"click"],[1,"close-dialog",3,"click"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.bIt("click",function(){return!n.character&&n.close()}),t.nVh(1,vu,1,3,"ghs-item",1),t.nVh(2,Ou,1,5,"ghs-character-item",2),t.nVh(3,Pu,1,0,"a",3),t.k0s(),t.j41(4,"div",4),t.bIt("click",function(){return n.close()}),t.k0s()),2&a&&(t.Y8G("ngClass",t.l_i(4,Mu,!n.opened,n.opened)),t.R7$(),t.vxM(n.character?-1:1),t.R7$(),t.vxM(n.character?2:-1),t.R7$(),t.vxM(n.character?3:-1))},dependencies:[N.YU,la,je],styles:["[_nghost-%COMP%]{background-color:transparent;padding:0;margin:0;border:0}.item-dialog[_ngcontent-%COMP%]{position:relative;width:66.66vh;max-width:400px;height:100vh;max-height:600px;border-image:none;background:none;transition:transform calc(var(--ghs-animation-speed) * .15s) ease-in-out;transform:scale(0);z-index:2}.item-dialog[_ngcontent-%COMP%]   ghs-item[_ngcontent-%COMP%], .item-dialog[_ngcontent-%COMP%]   ghs-character-item[_ngcontent-%COMP%]{width:100%;height:auto}.item-dialog[_ngcontent-%COMP%]   .close-dialog[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:0;left:0;width:100%;height:45%}.item-dialog.opened[_ngcontent-%COMP%]{transform:scale(1)}.item-dialog.closed[_ngcontent-%COMP%]{transform:scale(0);transition-delay:.8s}@media (max-width: 600px),(orientation: portrait){.item-dialog[_ngcontent-%COMP%]{width:80vw;max-width:400px;height:120vw;max-height:600px}}.close-container[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1}"]})}return i})();const bu=(i,r)=>({fh:i,modern:r}),ku=()=>[],yu=i=>({absent:i}),xu=(i,r)=>({disabled:i,unavailable:r}),Eu=i=>[i],ga=(i,r,e)=>({active:i,disabled:r,spent:e}),Lo=(i,r)=>[i,r],wu=(i,r,e,a)=>[i,r,e,a],Ru=i=>({selected:i}),ju=(i,r)=>r.edition+"-"+r.name;function Gu(i,r){1&i&&(t.j41(0,"span",4),t.nrm(1,"img",18)(2,"span",3),t.k0s()),2&i&&(t.R7$(2),t.Y8G("ghs-label","game.items.brewing.disabled"))}function Tu(i,r){if(1&i&&(t.j41(0,"span",6),t.EFF(1),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.SpI("",e+1,".")}}function Su(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",19),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.toggleHerb(n,2))}),t.nrm(1,"img",20),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG();t.Y8G("ngClass",t.sMw(2,ga,a.receipe.length>2&&a.receipe[2]==e,a.receipe[2]!=e&&0==(a.character.progress.loot[e]||0)&&0==(a.gameManager.game.party.loot[e]||0),a.receipe[2]!=e&&((a.characterSpent[e]||0)>0||(a.fhSupportSpent[e]||0)>0)&&(a.character.progress.loot[e]||0)<=(a.characterSpent[e]||0)&&(a.gameManager.game.party.loot[e]||0)<=(a.fhSupportSpent[e]||0))),t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+e+".svg",t.B4B)}}function $u(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",25),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2).$implicit,o=t.XpG();return t.Njj(o.moveHerb(n,o.characterSpent,o.fhSupportSpent))}),t.nrm(1,"img",26),t.k0s()}}function Du(i,r){if(1&i&&(t.j41(0,"span",23),t.EFF(1),t.k0s(),t.nVh(2,$u,2,0,"a",24)),2&i){const e=t.XpG().$implicit,a=t.XpG();t.Y8G("ghs-label","game.loot.")("ghs-label-attribute","title"),t.R7$(),t.Lme(" ",a.characterSpent[e]||"-"," / ",a.character.progress.loot[e]||0," "),t.R7$(),t.vxM(a.characterSpent[e]&&(a.gameManager.game.party.loot[e]||0)>(a.fhSupportSpent[e]||0)?2:-1)}}function Iu(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function Au(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",25),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2).$implicit,o=t.XpG();return t.Njj(o.moveHerb(n,o.fhSupportSpent,o.characterSpent))}),t.nrm(1,"img",27),t.k0s()}}function Vu(i,r){if(1&i&&(t.nVh(0,Au,2,0,"a",24),t.j41(1,"span",23),t.EFF(2),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG();t.vxM(a.fhSupportSpent[e]&&(a.character.progress.loot[e]||0)>(a.characterSpent[e]||0)?0:-1),t.R7$(),t.Y8G("ghs-label","game.loot.")("ghs-label-attribute","title"),t.R7$(),t.Lme(" ",a.fhSupportSpent[e]||"-"," / ",a.gameManager.game.party.loot[e]||0," ")}}function Fu(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function Xu(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",19),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.toggleHerb(n,0))}),t.nrm(1,"img",20),t.k0s(),t.j41(2,"span",19),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.toggleHerb(n,1))}),t.nrm(3,"img",20),t.k0s(),t.nVh(4,Su,2,6,"span",21),t.j41(5,"span",22),t.nVh(6,Du,3,5),t.nVh(7,Iu,2,0,"span"),t.k0s(),t.j41(8,"span",22),t.nVh(9,Vu,3,5),t.nVh(10,Fu,2,0,"span"),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.sMw(9,ga,a.receipe.length>0&&a.receipe[0]==e,a.receipe[0]!=e&&0==(a.character.progress.loot[e]||0)&&0==(a.gameManager.game.party.loot[e]||0),a.receipe[0]!=e&&((a.characterSpent[e]||0)>0||(a.fhSupportSpent[e]||0)>0)&&(a.character.progress.loot[e]||0)<=(a.characterSpent[e]||0)&&(a.gameManager.game.party.loot[e]||0)<=(a.fhSupportSpent[e]||0))),t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+e+".svg",t.B4B),t.R7$(),t.Y8G("ngClass",t.sMw(13,ga,a.receipe.length>1&&a.receipe[1]==e,a.receipe[1]!=e&&0==(a.character.progress.loot[e]||0)&&0==(a.gameManager.game.party.loot[e]||0),a.receipe[1]!=e&&((a.characterSpent[e]||0)>0||(a.fhSupportSpent[e]||0)>0)&&(a.character.progress.loot[e]||0)<=(a.characterSpent[e]||0)&&(a.gameManager.game.party.loot[e]||0)<=(a.fhSupportSpent[e]||0))),t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+e+".svg",t.B4B),t.R7$(),t.vxM(3==a.brewing?4:-1),t.R7$(2),t.vxM(a.character.progress.loot[e]?6:-1),t.R7$(),t.vxM(a.character.progress.loot[e]?-1:7),t.R7$(2),t.vxM(a.gameManager.game.party.loot[e]?9:-1),t.R7$(),t.vxM(a.gameManager.game.party.loot[e]?-1:10)}}function Bu(i,r){if(1&i&&t.nrm(0,"img",20),2&i){const e=t.XpG().$implicit;t.Y8G("src","./assets/images/fh/loot/"+e+".svg",t.B4B)}}function Yu(i,r){1&i&&t.nrm(0,"img",29)}function Nu(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"+"),t.k0s())}function zu(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",28),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.removeHerb(n,!1))}),t.nVh(1,Bu,1,1,"img",20),t.nVh(2,Yu,1,0,"img",29),t.nVh(3,Nu,2,0,"span"),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG();t.R7$(),t.vxM(e?1:-1),t.R7$(),t.vxM(e?-1:2),t.R7$(),t.vxM(a<n.receipe.length-1?3:-1)}}function Lu(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"="),t.k0s())}function Uu(i,r){if(1&i&&t.nrm(0,"span",12),2&i){const e=t.XpG();t.Y8G("ghs-label","game.items.brewing.item")("ghs-label-args",t.l_i(2,Lo,e.item.id,e.item.name))}}function qu(i,r){if(1&i&&t.nrm(0,"span",12),2&i){const e=t.XpG();t.Y8G("ghs-label","game.items.brewing.item")("ghs-label-args",t.l_i(2,Lo,e.brewed.id,e.brewed.name))}}function Hu(i,r){1&i&&(t.j41(0,"span",11),t.nrm(1,"img",29),t.k0s())}function Ku(i,r){if(1&i&&(t.j41(0,"div",10),t.nrm(1,"span",12),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","game.items.brewing.brewed"+(e.otherCharacter?"Other":""))("ghs-label-args",t.ziG(2,wu,e.brewed.id,e.brewed.name,e.gameManager.characterManager.characterName(e.character,!0),e.otherCharacter?e.gameManager.characterManager.characterName(e.otherCharacter,!0):""))}}function Wu(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",33),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.otherCharacter=n)}),t.nrm(1,"img",34),t.j41(2,"span",35),t.EFF(3),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ngClass",t.eq3(3,Ru,a.otherCharacter==e)),t.R7$(),t.Y8G("src",e.iconUrl,t.B4B),t.R7$(2),t.SpI(" ",a.gameManager.characterManager.characterName(e,!0)," ")}}function Ju(i,r){if(1&i&&(t.j41(0,"div",10),t.nrm(1,"span",30),t.k0s(),t.j41(2,"div",31),t.Z7z(3,Wu,4,5,"div",32,ju),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","game.items.brewing.selectCharacter"),t.R7$(2),t.Dyx(e.otherCharacters)}}function Zu(i,r){1&i&&(t.j41(0,"div",10),t.nrm(1,"span",36),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","game.items.brewing.noChar"))}function Qu(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",13)(1,"ghs-item",37),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openItemDialog())}),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("item",e.brewed||e.item)("flipped",!0)}}let Uo=(()=>{class i{character;dialogRef;dialog;gameManager=s.E;settingsManager=m.f;herbs=[ot.r6.arrowvine,ot.r6.axenut,ot.r6.corpsecap,ot.r6.flamefruit,ot.r6.rockroot,ot.r6.snowthistle];brewing;characterSpent={};fhSupportSpent={};receipe=[void 0,void 0];item;brewed;otherCharacters=[];otherCharacter;noChar=!1;constructor(e,a,n){if(this.character=e,this.dialogRef=a,this.dialog=n,this.brewing=0,s.E.fhRules()&&s.E.game.party.campaignMode&&s.E.game.party.buildings){const o=s.E.game.party.buildings.find(g=>"alchemist"==g.name);o&&o.level&&(this.brewing=o.level<3?2:3)}}ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.updateItem()}),this.updateItem()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}updateItem(){const e=this.getItem();this.item=e&&s.E.game.party.unlockedItems.find(a=>a.name==""+e.id&&a.edition==e.edition)&&e,this.brewed=void 0,this.otherCharacters=[],this.otherCharacter=void 0,this.noChar=!1}addHerb(e,a,n=-1){e&&(a||(this.character.progress.loot[e]&&(this.character.progress.loot[e]||0)>(this.characterSpent[e]||0)?a=this.characterSpent:s.E.game.party.loot[e]&&(s.E.game.party.loot[e]||0)>(this.fhSupportSpent[e]||0)&&(a=this.fhSupportSpent)),a&&(a[e]=(a[e]||0)+1,this.receipe[n>-1?n:this.receipe.length]=e)),this.updateItem()}removeHerb(e,a,n=-1){this.receipe[n>-1?n:this.receipe.indexOf(e)]=void 0,2==n&&this.receipe.splice(2,1),e&&(a||(a=this.fhSupportSpent[e]?this.fhSupportSpent:this.characterSpent),a[e]=(a[e]||1)-1),this.updateItem()}toggleHerb(e,a){const n=this.receipe[a]!=e;this.receipe[a]&&this.removeHerb(this.receipe[a],!1,a),n&&((this.character.progress.loot[e]||0)<=(this.characterSpent[e]||0)&&(s.E.game.party.loot[e]||0)<=(this.fhSupportSpent[e]||0)&&this.removeHerb(e,!1),this.addHerb(e,!1,a))}moveHerb(e,a,n){a[e]=(a[e]||1)-1,n[e]=(n[e]||0)+1}brew(e=!1){(!s.E.itemManager.brewingDisabled()||e)&&(this.brewed=this.getItem(),this.brewed&&(this.otherCharacter?this.brewInternal(this.otherCharacter,this.brewed):this.character.progress.items.find(a=>this.brewed&&a.name==""+this.brewed.id&&a.edition==this.brewed.edition)?(this.otherCharacters=s.E.game.figures.filter(a=>a instanceof q.K&&a!=this.character&&!a.progress.items.find(n=>this.brewed&&n.name==""+this.brewed.id&&n.edition==this.brewed.edition)).map(a=>a),this.noChar=0==this.otherCharacters.length,1==this.otherCharacters.length&&(this.otherCharacter=this.otherCharacters[0])):(this.brewInternal(this.character,this.brewed),this.otherCharacters=[],this.otherCharacter=void 0,this.noChar=!1)))}brewInternal(e,a){this.otherCharacter=e!=this.character?e:void 0,s.E.stateManager.before(this.otherCharacter?"brewPotionOther":"brewPotion",s.E.characterManager.characterName(this.character),a.id,a.edition,this.otherCharacter?s.E.characterManager.characterName(this.otherCharacter):""),this.herbs.forEach(n=>{this.fhSupportSpent[n]&&(s.E.game.party.loot[n]=(s.E.game.party.loot[n]||0)-(this.fhSupportSpent[n]||0)),this.characterSpent[n]&&(this.character.progress.loot[n]=(this.character.progress.loot[n]||0)-(this.characterSpent[n]||0))}),s.E.game.party.unlockedItems.find(n=>n.name==""+a.id&&n.edition==a.edition)||s.E.game.party.unlockedItems.push(new vt.VP(""+a.id,a.edition)),e.progress.items.push(new vt.gw(""+a.id,a.edition)),s.E.stateManager.after(),this.brewed=a,this.otherCharacter=e!=this.character?e:void 0}getItem(){if(this.receipe[0]&&this.receipe[1])return this.receipe.filter((e,a,n)=>e&&n.indexOf(e)==a).length!=this.receipe.filter(e=>e).length?s.E.itemManager.getItems(s.E.currentEdition(),!0).find(e=>!(e.requiredItems&&e.requiredItems.length||"alchemist"!=e.requiredBuilding||!(this.receipe[2]?e.requiredBuildingLevel>=3:e.requiredBuildingLevel<3)||e.resources)):s.E.itemManager.getItems(s.E.currentEdition(),!0).find(e=>(!e.requiredItems||!e.requiredItems.length)&&"alchemist"==e.requiredBuilding&&(this.receipe[2]?e.requiredBuildingLevel>=3:e.requiredBuildingLevel<3)&&e.resources&&this.herbs.every(a=>e.resources&&this.receipe.filter(n=>n==a).length==(e.resources[a]||0)))}openItemDialog(){this.dialog.open(Me,{panelClass:["fullscreen-panel"],disableClose:!0,data:{item:this.brewed||this.item}})}close(){(0,V.co)(this.dialogRef)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-items-brew"]],standalone:!1,decls:33,vars:35,consts:[[1,"items-brew-dialog",3,"ngClass"],[1,"scroll-container"],[1,"title"],[3,"ghs-label"],[1,"brewing-disabled"],[1,"table"],[1,"head-col","first"],[1,"first"],[1,"icon","character-icon",3,"src"],[1,"name",3,"ngClass"],[1,"receipe"],[1,"herb"],[1,"placeholder","text-white","item",3,"ghs-label","ghs-label-args"],[1,"brewed"],[1,"menu"],[1,"cancel",3,"click"],["ghs-pointer-input","",1,"apply",3,"singleClick","doubleClick","ngClass"],[3,"ghs-label","ghs-label-args"],["src","./assets/images/close.svg"],[1,"head-col","calc-col","toggle",3,"click","ngClass"],[1,"ghs-svg",3,"src"],[1,"head-col","calc-col","toggle",3,"ngClass"],[1,"calc-col"],[1,"value",3,"ghs-label","ghs-label-attribute"],[1,"button"],[1,"button",3,"click"],["src","./assets/images/right.svg",1,"ghs-svg"],["src","./assets/images/left.svg",1,"ghs-svg"],[1,"herb",3,"click"],["src","./assets/images/fh/loot/unknown.svg",1,"ghs-svg"],[1,"placeholder","text-white","item",3,"ghs-label"],[1,"characters"],[1,"character",3,"ngClass"],[1,"character",3,"click","ngClass"],[1,"icon",3,"src"],[1,"name"],[1,"placeholder","item","already",3,"ghs-label"],[3,"click","item","flipped"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"label",2),t.nrm(3,"span",3),t.nVh(4,Gu,3,1,"span",4),t.k0s(),t.j41(5,"div",5),t.Z7z(6,Tu,2,1,"span",6,t.fX1),t.nI1(8,"ghsRange"),t.j41(9,"span",7),t.nrm(10,"img",8),t.j41(11,"span",9),t.EFF(12),t.k0s()(),t.j41(13,"span",7),t.nrm(14,"span",3),t.k0s(),t.Z7z(15,Xu,11,17,null,null,t.fX1),t.k0s(),t.j41(17,"div",10),t.Z7z(18,zu,4,3,"span",11,t.fX1),t.nVh(20,Lu,2,0,"span"),t.nVh(21,Uu,1,5,"span",12),t.nVh(22,qu,1,5,"span",12),t.nVh(23,Hu,2,0,"span",11),t.k0s(),t.nVh(24,Ku,2,7,"div",10),t.nVh(25,Ju,5,1),t.nVh(26,Zu,2,1,"div",10),t.nVh(27,Qu,2,2,"div",13),t.j41(28,"div",14)(29,"a",15),t.bIt("click",function(){return n.close()}),t.nrm(30,"span",3),t.k0s(),t.j41(31,"a",16),t.bIt("singleClick",function(){return n.brew()})("doubleClick",function(){return n.brew(!0)}),t.nrm(32,"span",17),t.k0s()()()()),2&a&&(t.Y8G("ngClass",t.l_i(24,bu,"fh"==n.settingsManager.settings.theme,"modern"==n.settingsManager.settings.theme)),t.R7$(3),t.Y8G("ghs-label","game.items.brewing"),t.R7$(),t.vxM(n.gameManager.itemManager.brewingDisabled()?4:-1),t.R7$(),t.xc7("--ghs-summary-columns",2+n.brewing),t.R7$(),t.Dyx(t.i5U(8,21,t.lJ4(27,ku),n.brewing)),t.R7$(4),t.Y8G("src",n.character.iconUrl,t.B4B),t.R7$(),t.Y8G("ngClass",t.eq3(28,yu,n.character.absent)),t.R7$(),t.SpI(" ",n.gameManager.characterManager.characterName(n.character)," "),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.supply"),t.R7$(),t.Dyx(n.herbs),t.R7$(3),t.Dyx(n.receipe),t.R7$(2),t.vxM(!n.brewed||n.otherCharacters.length>0||n.noChar?20:-1),t.R7$(),t.vxM(!n.item||n.brewed&&!n.noChar?-1:21),t.R7$(),t.vxM(n.brewed&&n.otherCharacters.length>0?22:-1),t.R7$(),t.vxM(n.item||n.brewed?-1:23),t.R7$(),t.vxM(n.brewed&&0==n.otherCharacters.length&&!n.noChar?24:-1),t.R7$(),t.vxM(n.brewed&&n.otherCharacters.length>0?25:-1),t.R7$(),t.vxM(n.noChar?26:-1),t.R7$(),t.vxM(n.brewed||n.item?27:-1),t.R7$(3),t.Y8G("ghs-label","cancel"),t.R7$(),t.Y8G("ngClass",t.l_i(30,xu,n.noChar||n.brewed&&(0==n.otherCharacters.length||!n.otherCharacter)||n.receipe.length<2||!n.receipe[0]||!n.receipe[1],n.gameManager.itemManager.brewingDisabled())),t.R7$(),t.Y8G("ghs-label","game.items.brewing.brew"+(n.otherCharacter?"For":""))("ghs-label-args",t.eq3(33,Eu,n.otherCharacter?n.gameManager.characterManager.characterName(n.otherCharacter,!0):"")))},dependencies:[N.YU,tt,je,rt,Tt],styles:[".items-brew-dialog[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto;margin:0 .3em}.items-brew-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.items-brew-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline);margin-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.items-brew-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .brewing-disabled[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white);margin:.5em}.items-brew-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .brewing-disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:0 .2em;height:1em;width:auto;filter:var(--ghs-filter-red)}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]{--ghs-summary-columns: 5;font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));display:grid;grid-template-columns:repeat(var(--ghs-summary-columns),auto);padding-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));color:var(--ghs-color-white);overflow:auto}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-white)}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;text-align:center;padding:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));border-bottom:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-white);border-right:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-darkgray)}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-weight:700;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));flex-direction:row;justify-content:flex-end;background-image:url(dialog_background.fa4ff388462f6a00.png);position:sticky;left:0;z-index:1}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col.calc-col[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:.6}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]{cursor:pointer}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray);opacity:.6}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .toggle.active[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .toggle.spent[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow);opacity:.6}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .toggle.disabled[_ngcontent-%COMP%]{pointer-events:none}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .toggle.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);opacity:.4}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .calc-col[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:.6}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .first[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);border-top:none}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--ghs-color-white);display:flex;justify-content:center;align-items:center;padding:0 .15em;white-space:nowrap}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;padding:0 .15em}.items-brew-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1em;width:auto}.items-brew-dialog.fh[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.items-brew-dialog.modern[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.items-brew-dialog[_ngcontent-%COMP%]   .receipe[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));color:var(--ghs-color-white)}.items-brew-dialog[_ngcontent-%COMP%]   .receipe[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]{display:flex;align-items:center}.items-brew-dialog[_ngcontent-%COMP%]   .receipe[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));filter:var(--ghs-filter-white)}.items-brew-dialog[_ngcontent-%COMP%]   .receipe[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{margin-left:.5em}.items-brew-dialog[_ngcontent-%COMP%]   .receipe[_ngcontent-%COMP%]   .already[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.items-brew-dialog[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%}.items-brew-dialog[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;margin:.25em;padding:.25em;border:1px solid transparent}.items-brew-dialog[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline)}.items-brew-dialog[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:1.5em;height:auto;margin-right:.2em;filter:grayscale(.7)}.items-brew-dialog[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]:hover{color:var(--ghs-color-darkgray);border-color:var(--ghs-color-darkgray)}.items-brew-dialog[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]:hover   .icon[_ngcontent-%COMP%]{filter:grayscale(.3)}.items-brew-dialog[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character.selected[_ngcontent-%COMP%]{color:var(--ghs-color-white);border-color:var(--ghs-color-gray)}.items-brew-dialog[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character.selected[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{filter:none}.items-brew-dialog[_ngcontent-%COMP%]   .brewed[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:100%}.items-brew-dialog[_ngcontent-%COMP%]   .brewed[_ngcontent-%COMP%]   ghs-item[_ngcontent-%COMP%]{position:relative;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 27 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 40.5 * var(--ghs-dialog-factor))}.items-brew-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center}.items-brew-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:2em;padding:.3em}.items-brew-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.items-brew-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.items-brew-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.items-brew-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}.items-brew-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.unavailable[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-gray)}.items-brew-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.unavailable[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}"]})}return i})();const qo=i=>[i],tf=i=>({disabled:i}),ef=i=>({selected:i});function nf(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",12),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.toggleSelected(n))}),t.nrm(1,"img",13),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(2,ef,e==a.selectedResource)),t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+e+".svg",t.B4B)}}let Ho=(()=>{class i{data;dialogRef;availableResources=[];selectedResource;character;item;constructor(e,a){this.data=e,this.dialogRef=a,this.character=e.character,this.item=e.item,s.E.itemManager.canDistill(this.item)?this.availableResources=this.item.resourcesAny&&this.item.resourcesAny.length?ot.Pr:Object.keys(this.item.resources).map(n=>n):this.dialogRef.close()}toggleSelected(e){this.selectedResource=this.selectedResource==e?void 0:e}close(){(0,V.co)(this.dialogRef)}distill(){this.selectedResource&&(s.E.stateManager.before("distillItem",s.E.characterManager.characterName(this.character),this.item.id,this.item.edition),s.E.itemManager.removeItem(this.item,this.character),this.character.progress.loot[this.selectedResource]=(this.character.progress.loot[this.selectedResource]||0)+1,s.E.stateManager.after(),(0,V.co)(this.dialogRef))}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-item-distill-dialog"]],standalone:!1,decls:13,vars:15,consts:[[1,"item-distill-dialog"],[1,"header"],[1,"title",3,"ghs-label","ghs-label-args"],[1,"item"],[3,"item","reveal","flipped"],[1,"resources"],[1,"resource",3,"ngClass"],[1,"menu"],[1,"cancel",3,"click"],[3,"ghs-label"],["ghs-pointer-input","",1,"apply",3,"singleClick","ngClass"],[3,"ghs-label","ghs-label-args"],[1,"resource",3,"click","ngClass"],[1,"ghs-svg",3,"src"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"span",2),t.k0s(),t.j41(3,"div",3),t.nrm(4,"ghs-item",4),t.k0s(),t.j41(5,"div",5),t.Z7z(6,nf,2,4,"div",6,t.fX1),t.k0s(),t.j41(8,"div",7)(9,"a",8),t.bIt("click",function(){return n.close()}),t.nrm(10,"span",9),t.k0s(),t.j41(11,"a",10),t.bIt("singleClick",function(){return n.distill()}),t.nrm(12,"span",11),t.k0s()()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","game.items.distilling")("ghs-label-args",t.eq3(9,qo,"data.items."+n.item.edition+"-"+n.item.id)),t.R7$(2),t.Y8G("item",n.item)("reveal",!0)("flipped",!0),t.R7$(2),t.Dyx(n.availableResources),t.R7$(4),t.Y8G("ghs-label","cancel"),t.R7$(),t.Y8G("ngClass",t.eq3(11,tf,!n.selectedResource)),t.R7$(),t.Y8G("ghs-label",n.selectedResource?"game.items.distilling.distill":"game.items.distilling.select")("ghs-label-args",t.eq3(13,qo,""+n.selectedResource)))},dependencies:[N.YU,tt,je,rt],styles:[".item-distill-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.item-distill-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.item-distill-dialog[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{display:flex;justify-content:center}.item-distill-dialog[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ghs-item[_ngcontent-%COMP%]{display:block;position:relative;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 27 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 40.5 * var(--ghs-dialog-factor));transition:all calc(var(--ghs-animation-speed) * .5s) ease-in-out}.item-distill-dialog[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.item-distill-dialog[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]{cursor:pointer}.item-distill-dialog[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray);width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:auto}.item-distill-dialog[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource.selected[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.item-distill-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center}.item-distill-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:1.5em;padding:.3em}.item-distill-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.item-distill-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.item-distill-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.item-distill-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}"]})}return i})();const af=(i,r)=>({fh:i,modern:r}),da=(i,r)=>[i,r],of=i=>({management:i}),ha=i=>({disabled:i}),Ko=i=>({selected:i}),_a=i=>[i],Wo=()=>[],sf=(i,r,e,a,n)=>({selected:i,disabled:r,filtered:e,unavailable:a,owned:n}),rf=i=>({equipped:i}),Jo=(i,r)=>r.edition+"-"+r.id;function cf(i,r){1&i&&t.nrm(0,"span",3),2&i&&t.Y8G("ghs-label","game.items.shop")}function lf(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",17),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openItems())}),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ghs-label","game.items.shop.character")("ghs-label-args",t.l_i(3,da,e.character.name,e.gameManager.characterManager.characterName(e.character)))("ngClass",t.eq3(6,of,e.character.progress.items&&e.character.progress.items.length))}}function gf(i,r){if(1&i&&(t.j41(0,"span",22),t.nrm(1,"img",31),t.EFF(2),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.SpI(" ",e.character.progress.loot.lumber," ")}}function df(i,r){if(1&i&&(t.j41(0,"span",23),t.nrm(1,"img",32),t.EFF(2),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.SpI(" ",e.character.progress.loot.metal," ")}}function hf(i,r){if(1&i&&(t.j41(0,"span",24),t.nrm(1,"img",33),t.EFF(2),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.SpI(" ",e.character.progress.loot.hide," ")}}function _f(i,r){if(1&i&&(t.j41(0,"span",25),t.nrm(1,"img",34),t.EFF(2),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.SpI(" ",e.character.progress.loot.arrowvine," ")}}function mf(i,r){if(1&i&&(t.j41(0,"span",26),t.nrm(1,"img",35),t.EFF(2),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.SpI(" ",e.character.progress.loot.axenut," ")}}function pf(i,r){if(1&i&&(t.j41(0,"span",27),t.nrm(1,"img",36),t.EFF(2),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.SpI(" ",e.character.progress.loot.corpsecap," ")}}function uf(i,r){if(1&i&&(t.j41(0,"span",28),t.nrm(1,"img",37),t.EFF(2),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.SpI(" ",e.character.progress.loot.flamefruit," ")}}function ff(i,r){if(1&i&&(t.j41(0,"span",29),t.nrm(1,"img",38),t.EFF(2),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.SpI(" ",e.character.progress.loot.rockroot," ")}}function Cf(i,r){if(1&i&&(t.j41(0,"span",30),t.nrm(1,"img",39),t.EFF(2),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.SpI(" ",e.character.progress.loot.snowthistle," ")}}function Mf(i,r){if(1&i&&(t.j41(0,"div",20),t.nVh(1,gf,3,1,"span",22),t.nVh(2,df,3,1,"span",23),t.nVh(3,hf,3,1,"span",24),t.nVh(4,_f,3,1,"span",25),t.nVh(5,mf,3,1,"span",26),t.nVh(6,pf,3,1,"span",27),t.nVh(7,uf,3,1,"span",28),t.nVh(8,ff,3,1,"span",29),t.nVh(9,Cf,3,1,"span",30),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.vxM(e.character.progress.loot.lumber?1:-1),t.R7$(),t.vxM(e.character.progress.loot.metal?2:-1),t.R7$(),t.vxM(e.character.progress.loot.hide?3:-1),t.R7$(),t.vxM(e.character.progress.loot.arrowvine?4:-1),t.R7$(),t.vxM(e.character.progress.loot.axenut?5:-1),t.R7$(),t.vxM(e.character.progress.loot.corpsecap?6:-1),t.R7$(),t.vxM(e.character.progress.loot.flamefruit?7:-1),t.R7$(),t.vxM(e.character.progress.loot.rockroot?8:-1),t.R7$(),t.vxM(e.character.progress.loot.snowthistle?9:-1)}}function vf(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",40),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.brewDialog())})("doubleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.brewDialog(!0))}),t.nrm(1,"img",41)(2,"span",12),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(2,ha,e.gameManager.itemManager.brewingDisabled())),t.R7$(2),t.Y8G("ghs-label","game.items.brewing")}}function Of(i,r){if(1&i&&(t.j41(0,"div",5)(1,"span",18),t.nrm(2,"img",19),t.EFF(3),t.k0s(),t.nVh(4,Mf,10,9,"div",20),t.nVh(5,vf,3,4,"a",21),t.k0s()),2&i){const e=t.XpG();t.R7$(2),t.Y8G("src","./assets/images/"+(e.settingsManager.settings.fhStyle?"fh/":"")+"loot.svg",t.B4B),t.R7$(),t.JRh(e.character.progress.gold),t.R7$(),t.vxM(e.gameManager.fhRules()?4:-1),t.R7$(),t.vxM(e.brewing?5:-1)}}function Pf(i,r){1&i&&t.nrm(0,"img",42)(1,"span",12),2&i&&(t.R7$(),t.Y8G("ghs-label","game.items.shop.buyingDisabled"))}function bf(i,r){1&i&&t.nrm(0,"img",42)(1,"span",12),2&i&&(t.R7$(),t.Y8G("ghs-label","game.items.shop.craftingDisabled"))}function kf(i,r){if(1&i&&(t.j41(0,"div",6),t.nVh(1,Pf,2,1),t.nVh(2,bf,2,1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.vxM(e.gameManager.itemManager.buyingDisabled()&&e.character&&-1==e.character.tags.indexOf("new-character")?1:-1),t.R7$(),t.vxM(e.gameManager.itemManager.craftingDisabled()?2:-1)}}function yf(i,r){if(1&i){const e=t.RV6();t.j41(0,"label",43),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.toggleItemSlotFilter(n))})("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.toggleItemSlotFilter(n,!0))}),t.nrm(1,"img",44),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(2,Ko,-1!=a.itemSlots.indexOf(e))),t.R7$(),t.Y8G("src","./assets/images/items/slots/"+e+".svg",t.B4B)}}function xf(i,r){if(1&i){const e=t.RV6();t.j41(0,"label",43),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleItemSlotFilter("undefined"))})("doubleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleItemSlotFilter("undefined",!0))}),t.nrm(1,"img",45),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(1,Ko,-1!=e.itemSlots.indexOf("undefined")))}}function Ef(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",11),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.affordable,n)||(o.affordable=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.update(!0))}),t.k0s(),t.nrm(2,"span",12),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.R50("ngModel",e.affordable),t.R7$(),t.Y8G("ghs-label","game.items.filter.affordable")}}function wf(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",11),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.sorted,n)||(o.sorted=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.update(!0))}),t.k0s(),t.nrm(2,"span",12),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.R50("ngModel",e.sorted),t.R7$(),t.Y8G("ghs-label","game.items.filter.sorted")}}function Rf(i,r){if(1&i){const e=t.RV6();t.j41(0,"label",46)(1,"input",47),t.bIt("change",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.setEdition(n))}),t.k0s(),t.nrm(2,"span",12),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ngClass",t.eq3(3,ha,a.currentEdition==e)),t.R7$(),t.Y8G("checked",a.currentEdition==e),t.R7$(),t.Y8G("ghs-label","data.edition."+e)}}function jf(i,r){if(1&i&&(t.j41(0,"div",13),t.Z7z(1,Rf,3,5,"label",46,t.fX1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.editions)}}function Gf(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",53),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.addItem(n.selected,!0))}),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","game.items.add")("ghs-label-args",e.selected?t.eq3(2,_a,"data.items."+e.selected.edition+"-"+e.selected.id):t.lJ4(4,Wo))}}function Tf(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",54),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(!!n.selected&&(n.selected.cost?n.buyItem(n.selected):n.craftItem(n.selected)))}),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(3,ha,!e.selected||!e.gameManager.itemManager.canBuy(e.selected,e.character)&&!e.gameManager.itemManager.canCraft(e.selected,e.character)))("ghs-label","game.items."+(e.selected?e.selected.cost?"buy":"craft":"choose"))("ghs-label-args",e.selected?t.l_i(5,da,"data.items."+e.selected.edition+"-"+e.selected.id,e.selected.cost+e.gameManager.itemManager.pricerModifier()):t.lJ4(8,Wo))}}function Sf(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",53),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.removeItem(n.selected))}),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","game.items.remove")("ghs-label-args",t.eq3(2,_a,"data.items."+e.selected.edition+"-"+e.selected.id))}}function $f(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",55),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.sellItem(n.selected))}),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","game.items.sell")("ghs-label-args",t.l_i(2,da,"data.items."+e.selected.edition+"-"+e.selected.id,e.gameManager.itemManager.itemSellValue(e.selected)))}}function Df(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",56),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.distillItem(n.selected))}),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","game.items.distilling")("ghs-label-args",t.eq3(2,_a,"data.items."+e.selected.edition+"-"+e.selected.id))}}function If(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",14)(1,"a",48),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.close())}),t.k0s(),t.nVh(2,Gf,1,5,"a",49),t.nVh(3,Tf,1,9,"a",50),t.nVh(4,Sf,1,4,"a",49),t.nVh(5,$f,1,5,"a",51),t.nVh(6,Df,1,4,"a",52),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","cancel"),t.R7$(),t.vxM(e.selected&&!e.gameManager.itemManager.owned(e.selected,e.character)?2:-1),t.R7$(),t.vxM(!e.selected||(e.selected.cost||e.selected.resources)&&!e.gameManager.itemManager.owned(e.selected,e.character)?3:-1),t.R7$(),t.vxM(e.selected&&e.gameManager.itemManager.owned(e.selected,e.character)?4:-1),t.R7$(),t.vxM(e.selected&&e.gameManager.itemManager.owned(e.selected,e.character)?5:-1),t.R7$(),t.vxM(e.selected&&e.gameManager.itemManager.owned(e.selected,e.character)&&e.gameManager.itemManager.canDistill(e.selected)?6:-1)}}function Af(i,r){1&i&&(t.j41(0,"div",15)(1,"div",57),t.nrm(2,"span",12),t.k0s()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","game.items.empty"))}function Vf(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-item",62),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.select(n))})("doubleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.select(n,!0))}),t.k0s()}if(2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG();t.Y8G("item",a)("flipped",!0)("count",o.character?o.itemsMeta[n].countAvailable<1?"-":o.itemsMeta[n].assigned+1:1)("editionLabel",o.currentEdition)("ngClass",t.s1E(5,sf,a==o.selected,!o.character,!o.itemsMeta[n].canAdd,(a.cost||a.resources)&&!o.itemsMeta[n].canBuy&&!o.itemsMeta[n].canCraft,o.itemsMeta[n].owned))}}function Ff(i,r){if(1&i&&t.nrm(0,"ghs-item",59),2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG();t.Y8G("item",a)("flipped",!0)("count",o.character?o.itemsMeta[n].countAvailable<1?"-":o.itemsMeta[n].assigned+1:1)("editionLabel",o.currentEdition)}}function Xf(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",63),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.removeUnlocked(n))}),t.nrm(1,"img",64),t.k0s()}}function Bf(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",65),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.toggleEquippedItem(n))})("doubleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.toggleEquippedItem(n,!0))}),t.nrm(1,"img",66),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(1,rf,a.gameManager.itemManager.isEquipped(e,a.character)))}}function Yf(i,r){if(1&i&&(t.j41(0,"div",16),t.nVh(1,Vf,1,11,"ghs-item",58),t.nVh(2,Ff,1,4,"ghs-item",59),t.nVh(3,Xf,2,0,"a",60),t.nVh(4,Bf,2,3,"a",61),t.k0s()),2&i){const e=r.$implicit,a=t.XpG();t.R7$(),t.vxM(a.character?1:-1),t.R7$(),t.vxM(a.character&&a.select?-1:2),t.R7$(),t.vxM(!a.all&&a.unlocked(e)?3:-1),t.R7$(),t.vxM(a.character&&a.gameManager.itemManager.owned(e,a.character)?4:-1)}}function Nf(i,r){1&i&&t.nrm(0,"span",68),2&i&&t.Y8G("ghs-label","game.items.unlock")}function zf(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",63),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.removeUnlocked(n))}),t.nrm(1,"img",64),t.k0s()}}function Lf(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",16)(1,"ghs-item",67),t.bIt("revealed",function(n){const o=t.eBV(e).$implicit,g=t.XpG();return t.Njj(g.unlockItemReveal(o,n))}),t.k0s(),t.nVh(2,Nf,1,1,"span",68),t.nVh(3,zf,2,0,"a",60),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.R7$(),t.Y8G("item",e)("reveal",!0)("flipped",a.unlocked(e))("editionLabel",a.currentEdition),t.R7$(),t.vxM(a.unlocked(e)?-1:2),t.R7$(),t.vxM(!a.all&&a.unlocked(e)?3:-1)}}let Bn=(()=>{class i{data;dialogRef;dialog;gameManager=s.E;settingsManager=m.f;edition;currentEdition;editions;editionItems=[];items=[];itemsMeta=[];selected;character;filter="";all=!1;affordable=!1;sorted=!1;itemSlots=[];itemSlotUndefined=!1;unlocks=[];campaignMode=!1;brewing=0;ItemSlot=Object.values(bt.o8);constructor(e,a,n){this.data=e,this.dialogRef=a,this.dialog=n,this.selected=void 0,this.character=e.select,this.sorted=null!=this.character&&this.character.progress.items.length>0,this.edition=e.edition,this.affordable=e.affordable||!1,this.campaignMode=this.edition&&s.E.game.party.campaignMode||!1,this.editions=this.edition?s.E.itemManager.itemEditions(this.edition):s.E.itemManager.itemEditions(),this.all=null==this.edition,this.currentEdition=this.edition||this.editions[0]}ngOnInit(){this.updateEditionItems(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}setEdition(e){this.currentEdition=e,this.updateEditionItems()}updateEditionItems(){this.editions=this.all?s.E.itemManager.itemEditions():this.edition&&!this.campaignMode?s.E.itemManager.itemEditions(this.edition):[],-1==this.editions.indexOf(this.currentEdition)&&(this.currentEdition=this.edition||this.editions[0]),this.editionItems=this.edition&&this.campaignMode&&!this.all?s.E.itemManager.getItems(this.edition):s.E.itemManager.getItems(this.currentEdition,this.all).filter(e=>e.edition==this.currentEdition),this.all&&(this.sorted=!1),this.update()}brewDialog(e=!1){(!s.E.itemManager.brewingDisabled()||e)&&this.dialog.open(Uo,{panelClass:["dialog"],data:this.character})}update(e=!1){if(this.unlocks=[],this.selected=void 0,this.items=this.editionItems.filter(a=>!this.affordable||s.E.itemManager.assigned(a)<a.count).filter(a=>!this.affordable||this.character&&s.E.itemManager.canAdd(a,this.character)&&(s.E.itemManager.canBuy(a,this.character)||s.E.itemManager.canCraft(a,this.character))),this.character&&this.edition&&this.campaignMode&&!this.all&&!this.affordable&&this.character.progress.items.forEach(a=>{if(a.edition==this.edition&&!this.items.find(n=>n.id==+a.name&&n.edition==a.edition)){const n=s.E.itemManager.getItem(a.name,a.edition,!0);n&&this.items.push(n)}}),this.items=this.items.filter(a=>!this.filter||(0,V.oB)(a.name,this.filter)||(0,V.oB)(m.f.getLabel("data.items."+a.edition+"-"+a.id),this.filter)||(0,V.oB)(("number"==typeof a.id&&a.id<100?"0":"")+("number"==typeof a.id&&a.id<10?"0":"")+a.id,this.filter)),this.itemSlotUndefined=null!=this.items.find(a=>!a.slot),this.itemSlotUndefined||(this.itemSlots=this.itemSlots.filter(a=>"undefined"!=a)),this.itemSlots.length>0&&(this.items=this.items.filter(a=>a.slot&&-1!=this.itemSlots.indexOf(a.slot)||!a.slot&&-1!=this.itemSlots.indexOf("undefined"))),this.campaignMode&&this.edition&&!this.all&&!this.affordable&&(this.unlocks=s.E.itemManager.getItems(this.edition,!0).filter(a=>(""+a.id==this.filter||"0"+a.id==this.filter||"00"+a.id==this.filter)&&!this.items.find(n=>n.id==a.id&&n.edition==a.edition))),!e&&this.affordable&&0==this.items.length)this.affordable=!1,this.sorted=null!=this.character&&this.character.progress.items.length>0,this.update();else{if(this.itemsMeta=[],this.character&&(this.items.forEach(a=>{this.character&&this.itemsMeta.push({edition:a.edition,id:a.id,canAdd:s.E.itemManager.canAdd(a,this.character),canBuy:s.E.itemManager.canBuy(a,this.character),canCraft:s.E.itemManager.canCraft(a,this.character),owned:s.E.itemManager.owned(a,this.character),assigned:s.E.itemManager.assigned(a),countAvailable:s.E.itemManager.countAvailable(a)})}),s.E.fhRules()&&s.E.game.party.campaignMode&&s.E.game.party.buildings)){const a=s.E.game.party.buildings.find(n=>"alchemist"==n.name);a&&a.level&&(this.brewing=a.level<3?2:3)}this.items.sort((a,n)=>{if(this.sorted){if(this.character){const o=this.itemsMeta.find(_=>_.edition==a.edition&&_.id==a.id),g=this.itemsMeta.find(_=>_.edition==n.edition&&_.id==n.id);if(!o||!g)return 0;if(o.owned&&!g.owned)return-1;if(!o.owned&&g.owned)return 1;if((o.canBuy||o.canCraft)&&!g.canBuy&&!g.canCraft)return-1;if((g.canBuy||g.canCraft)&&!o.canBuy&&!o.canCraft)return 1;if(o.canAdd&&!g.canAdd)return-1;if(!o.canAdd&&g.canAdd)return 1;if(a.slot&&!n.slot)return-1;if(n.slot&&!a.slot)return 1}return a.slot&&n.slot?Object.values(bt.o8).indexOf(a.slot)-Object.values(bt.o8).indexOf(n.slot):0}return a.edition!=n.edition?a.edition==this.currentEdition?-1:1:s.E.itemManager.sortItems(a,n)}),this.itemsMeta.sort((a,n)=>{const o=this.items.find(_=>_.edition==a.edition&&_.id==a.id),g=this.items.find(_=>_.edition==n.edition&&_.id==n.id);return o&&g?this.items.indexOf(o)-this.items.indexOf(g):0})}this.brewing=0}toggleItemSlotFilter(e,a=!1){-1==this.itemSlots.indexOf(e)?a?this.itemSlots.push(e):this.itemSlots=[e]:this.itemSlots=this.itemSlots.filter(n=>n!=e),this.update(!0)}select(e,a=!1){this.data.select&&(this.selected=this.selected!=e&&(a||this.character&&(s.E.itemManager.owned(e,this.character)||s.E.itemManager.canAdd(e,this.character)))?e:void 0)}unlocked(e){return s.E.game.party.unlockedItems&&null!=s.E.game.party.unlockedItems.find(a=>a.name==""+e.id&&a.edition==e.edition)}unlockItemReveal(e,a){-1!=this.unlocks.indexOf(e)&&a&&(s.E.game.party.unlockedItems=s.E.game.party.unlockedItems||[],this.unlocked(e)||(s.E.stateManager.before("addUnlockedItem",e.edition,e.id,e.name),s.E.game.party.unlockedItems.push(new vt.VP(""+e.id,e.edition)),s.E.stateManager.after(),this.updateEditionItems()))}removeUnlocked(e){this.unlocked(e)&&(s.E.stateManager.before("removeUnlockedItem",e.edition,e.id,e.name),s.E.game.party.unlockedItems=s.E.game.party.unlockedItems||[],s.E.game.party.unlockedItems=s.E.game.party.unlockedItems.filter(a=>a.name!=""+e.id||a.edition!=e.edition),s.E.stateManager.after(),this.updateEditionItems())}addItem(e,a=!1){this.character&&(s.E.itemManager.canAdd(e,this.character)||a)&&(s.E.stateManager.before("addItem",s.E.characterManager.characterName(this.character),e.id+"",e.edition),s.E.itemManager.addItem(e,this.character),s.E.stateManager.after(),this.update())}buyItem(e){this.character&&s.E.itemManager.canBuy(e,this.character)&&(s.E.stateManager.before("buyItem",s.E.characterManager.characterName(this.character),e.id+"",e.edition),s.E.itemManager.buyItem(e,this.character),s.E.stateManager.after(),this.update())}craftItem(e){this.character&&s.E.itemManager.canCraft(e,this.character)&&(s.E.stateManager.before("craftItem",s.E.characterManager.characterName(this.character),e.id+"",e.edition),s.E.itemManager.craftItem(e,this.character),s.E.stateManager.after(),this.update())}removeItem(e){const a=this.character&&this.character.progress.items.find(n=>n.name==""+e.id&&n.edition==e.edition);if(a&&this.character){const n=this.character.progress.items.indexOf(a);s.E.stateManager.before("removeItem",s.E.characterManager.characterName(this.character),this.character.progress.items[n].name,this.character.progress.items[n].edition),s.E.itemManager.removeItem(e,this.character),s.E.stateManager.after(),this.update()}}sellItem(e){const a=this.character&&this.character.progress.items.find(n=>n.name==""+e.id&&n.edition==e.edition);if(this.character&&a&&s.E.itemManager.itemSellValue(e)){const n=this.character.progress.items.indexOf(a);s.E.stateManager.before("sellItem",s.E.characterManager.characterName(this.character),this.character.progress.items[n].name,this.character.progress.items[n].edition),s.E.itemManager.sellItem(e,this.character),s.E.stateManager.after(),this.update()}}distillItem(e){this.character&&this.dialog.open(Ho,{panelClass:["dialog"],data:{character:this.character,item:e}})}toggleEquippedItem(e,a=!1){if(this.character&&(!(s.E.game.state!=T.mk.draw||s.E.game.round>0)||a)){const g=this.character.progress.equippedItems.map(_=>this.items.find(y=>_.name==""+y.id&&y.edition==_.edition)).filter(_=>_).map(_=>_).indexOf(e);s.E.stateManager.before(-1!=g?"unequipItem":"equipItem",s.E.characterManager.characterName(this.character),e.name,e.edition),s.E.itemManager.toggleEquippedItem(e,this.character,a),s.E.stateManager.after()}}openItems(){this.character&&this.character.progress.items&&this.character.progress.items.length&&(this.dialogRef.close(),this.dialog.open(Zo,{panelClass:["dialog"],data:this.character}))}close(){(0,V.co)(this.dialogRef)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-items-dialog"]],standalone:!1,decls:28,vars:19,consts:[[1,"items-dialog",3,"ngClass"],[1,"scroll-container"],[1,"header"],[1,"title",3,"ghs-label"],[1,"title",3,"ghs-label","ghs-label-args","ngClass"],[1,"resources"],[1,"shop-disabled"],[1,"filter"],[1,"slots"],["ghs-pointer-input","",3,"ngClass"],["type","text",3,"ngModelChange","keyup","ngModel","ghs-label","ghs-label-attribute"],["type","checkbox",3,"ngModelChange","change","ngModel"],[3,"ghs-label"],[1,"editions"],[1,"menu"],[1,"item-list"],[1,"item"],[1,"title",3,"click","ghs-label","ghs-label-args","ngClass"],[1,"resource","gold"],[3,"src"],[1,"resource-grid"],["ghs-pointer-input","",1,"brewing",3,"ngClass"],[1,"resource","lumber"],[1,"resource","metal"],[1,"resource","hide"],[1,"resource","arrowvine"],[1,"resource","axenut"],[1,"resource","corpsecap"],[1,"resource","flamefruit"],[1,"resource","rockroot"],[1,"resource","snowthistle"],["src","./assets/images/fh/loot/lumber.svg"],["src","./assets/images/fh/loot/metal.svg"],["src","./assets/images/fh/loot/hide.svg"],["src","./assets/images/fh/loot/arrowvine.svg"],["src","./assets/images/fh/loot/axenut.svg"],["src","./assets/images/fh/loot/corpsecap.svg"],["src","./assets/images/fh/loot/flamefruit.svg"],["src","./assets/images/fh/loot/rockroot.svg"],["src","./assets/images/fh/loot/snowthistle.svg"],["ghs-pointer-input","",1,"brewing",3,"singleClick","doubleClick","ngClass"],["src","./assets/images/fh/brewing.svg"],["src","./assets/images/close.svg"],["ghs-pointer-input","",3,"singleClick","doubleClick","ngClass"],[1,"ghs-svg",3,"src"],["src","./assets/images/unknown.svg",1,"ghs-svg"],[1,"edition",3,"ngClass"],["type","checkbox",3,"change","checked"],[1,"cancel",3,"click","ghs-label"],[1,"secondary",3,"ghs-label","ghs-label-args"],[1,"primary",3,"ngClass","ghs-label","ghs-label-args"],[1,"primary",3,"ghs-label","ghs-label-args"],[1,"tertiary",3,"ghs-label","ghs-label-args"],[1,"secondary",3,"click","ghs-label","ghs-label-args"],[1,"primary",3,"click","ngClass","ghs-label","ghs-label-args"],[1,"primary",3,"click","ghs-label","ghs-label-args"],[1,"tertiary",3,"click","ghs-label","ghs-label-args"],[1,"empty"],["ghs-pointer-input","",3,"item","flipped","count","editionLabel","ngClass"],[3,"item","flipped","count","editionLabel"],[1,"button-remove"],["ghs-pointer-input","",1,"button-equip",3,"ngClass"],["ghs-pointer-input","",3,"singleClick","doubleClick","item","flipped","count","editionLabel","ngClass"],[1,"button-remove",3,"click"],["src","./assets/images/minus.svg",1,"ghs-svg"],["ghs-pointer-input","",1,"button-equip",3,"singleClick","doubleClick","ngClass"],["src","./assets/images/check.svg",1,"ghs-svg"],[3,"revealed","item","reveal","flipped","editionLabel"],[1,"overlay-text",3,"ghs-label"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.nVh(3,cf,1,1,"span",3),t.nVh(4,lf,1,8,"span",4),t.nVh(5,Of,6,4,"div",5),t.nVh(6,kf,3,2,"div",6),t.j41(7,"div",7)(8,"div",8),t.Z7z(9,yf,2,4,"label",9,t.fX1),t.nVh(11,xf,2,3,"label",9),t.k0s(),t.j41(12,"input",10),t.mxI("ngModelChange",function(g){return t.DH7(n.filter,g)||(n.filter=g),g}),t.bIt("keyup",function(){return n.update()}),t.k0s(),t.nVh(13,Ef,3,2,"label"),t.nVh(14,wf,3,2,"label"),t.j41(15,"label")(16,"input",11),t.mxI("ngModelChange",function(g){return t.DH7(n.all,g)||(n.all=g),g}),t.bIt("change",function(){return n.updateEditionItems()}),t.k0s(),t.EFF(17," <"),t.nrm(18,"span",12),t.EFF(19,"(!)> "),t.k0s()(),t.nVh(20,jf,3,0,"div",13),t.k0s(),t.nVh(21,If,7,6,"div",14),t.nVh(22,Af,3,1,"div",15),t.j41(23,"div",15),t.Z7z(24,Yf,5,4,"div",16,Jo),t.Z7z(26,Lf,4,6,"div",16,Jo),t.k0s()()()),2&a&&(t.Y8G("ngClass",t.l_i(16,af,"fh"==n.settingsManager.settings.theme,"modern"==n.settingsManager.settings.theme)),t.R7$(3),t.vxM(n.character?-1:3),t.R7$(),t.vxM(n.character?4:-1),t.R7$(),t.vxM(n.character?5:-1),t.R7$(),t.vxM(n.gameManager.itemManager.buyingDisabled()&&n.character&&-1==n.character.tags.indexOf("new-character")||n.gameManager.itemManager.craftingDisabled()?6:-1),t.R7$(3),t.Dyx(n.ItemSlot),t.R7$(2),t.vxM(n.itemSlotUndefined?11:-1),t.R7$(),t.R50("ngModel",n.filter),t.Y8G("ghs-label","game.items.filter")("ghs-label-attribute","placeholder"),t.R7$(),t.vxM(n.character?13:-1),t.R7$(),t.vxM(n.character?14:-1),t.R7$(2),t.R50("ngModel",n.all),t.R7$(2),t.Y8G("ghs-label","game.items.filter.all"),t.R7$(2),t.vxM(n.editions&&n.editions.length>1?20:-1),t.R7$(),t.vxM(n.character?21:-1),t.R7$(),t.vxM(0==n.items.length&&0==n.unlocks.length?22:-1),t.R7$(2),t.Dyx(n.items),t.R7$(2),t.Dyx(n.unlocks))},dependencies:[N.YU,O.me,O.Zm,O.BC,O.vS,tt,je,rt],styles:[".items-dialog[_ngcontent-%COMP%]{position:relative}.items-dialog[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%]{overflow-x:hidden;max-height:calc(90vh - var(--ghs-unit) * 6)}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title.management[_ngcontent-%COMP%]{cursor:pointer}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));color:var(--ghs-color-white);margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));display:flex;justify-content:center;align-items:center}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-right:.25em;height:1.2em;width:auto;filter:var(--ghs-filter-white)}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource.gold[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .brewing[_ngcontent-%COMP%]{cursor:pointer;color:var(--ghs-color-gray);display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .brewing[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray);height:1em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .brewing[_ngcontent-%COMP%]:hover{opacity:.7}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .brewing.disabled[_ngcontent-%COMP%]{cursor:initial;opacity:.8}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .brewing.disabled[_ngcontent-%COMP%]:hover{opacity:.6}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .shop-disabled[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white);margin:.5em}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .shop-disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:0 .2em;height:1em;width:auto;filter:var(--ghs-filter-red)}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly;align-items:center;z-index:1}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1.2em;width:auto;filter:var(--ghs-filter-darkgray)}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   label.selected[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{max-width:100%;min-width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer;color:var(--ghs-color-white);margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap;margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer;color:var(--ghs-color-gray);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{position:sticky;top:-1px;left:0;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));max-width:100%;display:flex;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly;align-items:center;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:10}.items-dialog[_ngcontent-%COMP%]   .menu.small[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor)) 0;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.7 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;margin:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.primary[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.secondary[_ngcontent-%COMP%]{color:var(--ghs-color-gray)}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.tertiary[_ngcontent-%COMP%]{color:var(--ghs-color-blue)}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{flex-direction:column-reverse;height:calc(var(--ghs-unit) * 14 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{min-width:initial}}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]{position:relative;display:flex;flex-wrap:wrap;justify-content:center;margin:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));min-height:calc(var(--ghs-unit) * 40.5 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-yellow)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{position:relative;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 27 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 40.5 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ghs-item[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;border:calc(var(--ghs-unit) * .35 * var(--ghs-dialog-factor)) solid transparent;border-radius:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));overflow:hidden;cursor:pointer}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ghs-item.disabled[_ngcontent-%COMP%]{cursor:initial;opacity:.5}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ghs-item.unavailable[_ngcontent-%COMP%]{cursor:not-allowed;border-color:var(--ghs-color-red)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ghs-item.filtered[_ngcontent-%COMP%]{cursor:initial;border-color:var(--ghs-color-darkgray);filter:grayscale(.3)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ghs-item.owned[_ngcontent-%COMP%]{border-color:var(--ghs-color-blue)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ghs-item.selected[_ngcontent-%COMP%]{border-color:var(--ghs-color-green)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .overlay-text[_ngcontent-%COMP%]{cursor:pointer;z-index:1;position:absolute;display:flex;justify-content:center;align-items:center;text-align:center;top:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-darkgray)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]{z-index:1;position:absolute;display:flex;cursor:pointer;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-filter-white) var(--ghs-filter-shadow)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-shadow)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .button-equip[_ngcontent-%COMP%]{z-index:1;position:absolute;display:flex;cursor:pointer;bottom:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 11.8 * var(--ghs-dialog-factor));justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));opacity:.6}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .button-equip[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:100%;height:auto;filter:var(--ghs-filter-white)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .button-equip.equipped[_ngcontent-%COMP%]{opacity:1}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .button-equip.equipped[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .button-equip[_ngcontent-%COMP%]:hover{opacity:.6}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .button-equip[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .button-equip[_ngcontent-%COMP%]:hover.equipped   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-red)}@media (max-width: 600px),(orientation: portrait){.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]{flex-direction:column;align-items:center}}.items-dialog.fh[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.items-dialog.modern[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}"]})}return i})();const Uf=(i,r)=>({fh:i,modern:r}),qf=(i,r)=>[i,r],Hf=i=>({spent:i}),Kf=(i,r)=>r.edition+"-"+r.id;function Wf(i,r){1&i&&(t.j41(0,"div",8)(1,"div",9),t.nrm(2,"span",7),t.k0s()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","game.items.empty"))}function Jf(i,r){if(1&i&&t.nrm(0,"ghs-character-item",10),2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("character",a.character)("item",e)("setup",a.setup)("ngClass",t.eq3(4,Hf,!a.setup&&a.countFlag(e,a.ItemFlags.spent)))}}function Zf(i,r){if(1&i&&(t.j41(0,"div",8),t.Z7z(1,Jf,1,6,"ghs-character-item",10,Kf),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.items)}}let Zo=(()=>{class i{character;dialogRef;dialog;gameManager=s.E;settingsManager=m.f;setup=!1;onlyEquipped=!1;items=[];ItemFlags=bt.Tr;GameState=T.mk;constructor(e,a,n){this.character=e,this.dialogRef=a,this.dialog=n,this.setup=s.E.game.state==T.mk.draw&&s.E.roundManager.firstRound,this.onlyEquipped=!this.setup,this.update()}sortItemData(e,a){if(!this.setup){if(this.equipped(e)&&!this.equipped(a))return-1;if(this.equipped(a)&&!this.equipped(e))return 1}return e.slot&&!a.slot?-1:a.slot&&!e.slot?1:e.slot&&a.slot?Object.values(bt.o8).indexOf(e.slot)-Object.values(bt.o8).indexOf(a.slot):0}update(){this.items=s.E.bbRules()?s.E.itemManager.getItems("bb"):this.character.progress.items.map(e=>s.E.itemManager.getItem(e.name,e.edition,!0)).filter(e=>e).map(e=>e).sort((e,a)=>this.sortItemData(e,a)),this.onlyEquipped&&(this.items=this.items.filter(e=>this.equipped(e)))}equipped(e){return this.character.progress.equippedItems.find(a=>a.name==""+e.id&&a.edition==e.edition)}countFlag(e,a){const n=this.equipped(e);return n&&n.tags&&n.tags.filter(o=>o==a).length||0}openShop(){this.dialogRef.close(),this.dialog.open(Bn,{panelClass:["dialog"],data:{edition:s.E.game.edition,select:this.character,affordable:!0}})}close(){(0,V.co)(this.dialogRef)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-items-character-dialog"]],standalone:!1,decls:11,vars:15,consts:[[1,"items-dialog",3,"ngClass"],[1,"scroll-container"],[1,"header"],[1,"title",3,"click","ghs-label","ghs-label-args","ghs-tooltip"],[1,"menu"],[1,"shop",3,"click","ghs-label"],["type","checkbox",3,"ngModelChange","change","ngModel"],[3,"ghs-label"],[1,"item-list"],[1,"empty"],[3,"character","item","setup","ngClass"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),t.bIt("click",function(){return n.openShop()}),t.k0s()(),t.j41(4,"div",4)(5,"a",5),t.bIt("click",function(){return n.openShop()}),t.k0s(),t.j41(6,"label")(7,"input",6),t.mxI("ngModelChange",function(g){return t.DH7(n.onlyEquipped,g)||(n.onlyEquipped=g),g}),t.bIt("change",function(){return n.update()}),t.k0s(),t.nrm(8,"span",7),t.k0s()(),t.nVh(9,Wf,3,1,"div",8),t.nVh(10,Zf,3,0,"div",8),t.k0s()()),2&a&&(t.Y8G("ngClass",t.l_i(9,Uf,"fh"==n.settingsManager.settings.theme,"modern"==n.settingsManager.settings.theme)),t.R7$(3),t.Y8G("ghs-label","game.items.character")("ghs-label-args",t.l_i(12,qf,n.character.name,n.gameManager.characterManager.characterName(n.character)))("ghs-tooltip","game.items.character.shop"),t.R7$(2),t.Y8G("ghs-label","game.items.character.shop"),t.R7$(2),t.R50("ngModel",n.onlyEquipped),t.R7$(),t.Y8G("ghs-label","game.items.character.toggleEquipped"),t.R7$(),t.vxM(0==n.items.length?9:-1),t.R7$(),t.vxM(n.items.length>0?10:-1))},dependencies:[N.YU,O.Zm,O.BC,O.vS,la,tt,ft],styles:[".items-dialog[_ngcontent-%COMP%]{position:relative}.items-dialog[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%]{overflow-x:hidden;max-height:calc(90vh - var(--ghs-unit) * 6)}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.items-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white);cursor:pointer}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:center;align-items:center;z-index:1}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer;color:var(--ghs-color-white);margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .shop[_ngcontent-%COMP%]{cursor:pointer;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.items-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .shop[_ngcontent-%COMP%]:hover{opacity:.7}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;margin:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));min-height:calc(var(--ghs-unit) * 40.5 * var(--ghs-dialog-factor))}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-yellow)}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   ghs-character-item[_ngcontent-%COMP%]{position:relative;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 27 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 40.5 * var(--ghs-dialog-factor));transition:all calc(var(--ghs-animation-speed) * .5s) ease-in-out}.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   ghs-character-item.spent[_ngcontent-%COMP%]{transform:rotate(90deg);margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * 7.25 * var(--ghs-dialog-factor))}@media (max-width: 600px),(orientation: portrait){.items-dialog[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]{flex-direction:column;align-items:center}}.items-dialog.fh[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.items-dialog.modern[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}"]})}return i})();const Qf=()=>[1,2,3,4,5,6,7,8,9],tC=i=>({active:i});function eC(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1,"\xa0("),t.nrm(2,"span",3),t.EFF(3,")"),t.k0s()),2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","data.character."+e.character.edition+"."+e.character.name)}}function nC(i,r){if(1&i&&(t.j41(0,"span",2),t.nrm(1,"img",10),t.EFF(2),t.nVh(3,eC,4,1,"span"),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("src",e.character.iconUrl,t.B4B),t.R7$(),t.SpI(" ",e.gameManager.characterManager.characterName(e.character)," "),t.R7$(),t.vxM(e.character.title?3:-1)}}function iC(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.SpI(" ",e.objective.title)}}function aC(i,r){if(1&i&&t.nrm(0,"span",3),2&i){const e=t.XpG(2);t.Y8G("ghs-label",e.objective.name?"data.objective."+e.objective.name:e.objective.escort?"escort":"objective")}}function oC(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1,"\xa0"),t.nrm(2,"span",3),t.k0s()),2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label",e.objective.escort?"escort":"objective")}}function sC(i,r){if(1&i&&(t.j41(0,"span",2),t.nrm(1,"img",10),t.nVh(2,iC,2,1,"span"),t.nVh(3,aC,1,1,"span",3),t.nVh(4,oC,3,1,"span"),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("src","./assets/images/objective/"+(e.objective.escort?"escort":"objective")+".svg",t.B4B),t.R7$(),t.vxM(e.objective.title?2:-1),t.R7$(),t.vxM(e.objective.title?-1:3),t.R7$(),t.vxM(e.objective.title?4:-1)}}function rC(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",7),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.pickNumber(n))}),t.j41(1,"span",8),t.EFF(2),t.k0s()()}if(2&i){const e=r.$implicit;t.R7$(2),t.JRh(e)}}function cC(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",11),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.longRest())}),t.nrm(1,"img",12)(2,"span",3),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(2,tC,e.character.longRest)),t.R7$(2),t.Y8G("ghs-label","game.figure.longRest"+(e.character.longRest?"Off":""))}}let ma=(()=>{class i{figure;dialogRef;value="__";characterManager=s.E.characterManager;gameManager=s.E;settingsManager=m.f;GameState=T.mk;character;objective;constructor(e,a){this.figure=e,this.dialogRef=a,this.figure instanceof q.K?this.character=this.figure:this.figure instanceof mt.$e&&(this.objective=this.figure),a.closed.subscribe({next:()=>{-1!=this.value.indexOf("_")&&!isNaN(+this.value.replace("_",""))&&this.updateInitiative(+this.value.replace("_",""))}})}onKeyPress(e){m.f.settings.keyboardShortcuts&&(e.key in["0","1","2","3","4","5","6","7","8","9"]?(this.pickNumber(+e.key),e.preventDefault(),e.stopPropagation()):"Enter"===e.key&&(0,V.co)(this.dialogRef))}pickNumber(e){this.value=(this.value+""+e).substring(1,3),-1==this.value.indexOf("_")&&(this.updateInitiative(+this.value),(0,V.co)(this.dialogRef))}updateInitiative(e){this.figure.initiative!=e&&(s.E.stateManager.before("setInitiative",this.character?s.E.characterManager.characterName(this.character):"data.objective."+this.figure.name,""+(e>0&&e<100?e:0)),e>0&&e<100?(this.setInitiative(e),this.character&&99!=e&&("prism"!=this.character.name||-1==this.character.tags.indexOf("long_rest"))&&(this.character.longRest=!1)):s.E.game.state==T.mk.draw&&(this.figure.initiative=0),s.E.game.state==T.mk.next&&s.E.sortFigures(this.character),s.E.stateManager.after())}setInitiative(e){((s.E.game.state==T.mk.draw||!m.f.settings.initiativeRequired)&&e>=0||e>0)&&e<100&&e!=this.figure.initiative&&(this.figure.initiative=e,this.character&&(this.character.initiativeVisible=!0))}longRest(){this.character&&(this.character.longRest?(s.E.stateManager.before("setInitiative",s.E.characterManager.characterName(this.character),this.character.initiative),this.character.longRest=!1,s.E.stateManager.after()):(s.E.stateManager.before("characterLongRest",s.E.characterManager.characterName(this.character)),99==this.character.initiative||"prism"==this.character.name&&-1!=this.character.tags.indexOf("long_rest")?this.character.longRest=!0:(this.setInitiative(99),this.character.longRest=!0,s.E.game.state==T.mk.next&&s.E.sortFigures(this.character)),s.E.stateManager.after()),(0,V.co)(this.dialogRef))}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-character-initiative-dialog"]],hostBindings:function(a,n){1&a&&t.bIt("keydown",function(g){return n.onKeyPress(g)},t.EBC)},standalone:!1,decls:18,vars:6,consts:[[1,"initiative-dialog"],[1,"title"],[1,"character"],[3,"ghs-label"],[1,"number-container"],[1,"value"],[1,"number-button"],[1,"number-button",3,"click"],[1,"number"],[1,"long-rest-button",3,"ngClass"],[1,"icon",3,"src"],[1,"long-rest-button",3,"click","ngClass"],["src","./assets/images/long-rest.svg",1,"ghs-svg"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.nVh(2,nC,4,3,"span",2),t.nVh(3,sC,5,4,"span",2),t.nrm(4,"span",3),t.k0s(),t.j41(5,"div",4),t.nrm(6,"span"),t.j41(7,"span",5),t.EFF(8),t.k0s(),t.nrm(9,"span"),t.Z7z(10,rC,3,1,"span",6,t.fX1),t.nrm(12,"span"),t.j41(13,"span",7),t.bIt("click",function(){return n.pickNumber(0)}),t.j41(14,"span",8),t.EFF(15,"0"),t.k0s()(),t.nrm(16,"span"),t.k0s(),t.nVh(17,cC,3,4,"span",9),t.k0s()),2&a&&(t.R7$(2),t.vxM(n.character?2:-1),t.R7$(),t.vxM(n.objective?3:-1),t.R7$(),t.Y8G("ghs-label","game.figure.setInitiative"),t.R7$(4),t.JRh(n.value),t.R7$(2),t.Dyx(t.lJ4(5,Qf)),t.R7$(7),t.vxM(n.character?17:-1))},dependencies:[N.YU,tt],styles:[".initiative-dialog[_ngcontent-%COMP%]{position:relative}.initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));width:auto;margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.initiative-dialog[_ngcontent-%COMP%]   .number-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor) * var(--ghs-text-factor)))}.initiative-dialog[_ngcontent-%COMP%]   .number-container[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor) * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.initiative-dialog[_ngcontent-%COMP%]   .number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor) * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor) * var(--ghs-text-factor));cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor) * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline)}.initiative-dialog[_ngcontent-%COMP%]   .number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray);margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button.active[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button.active[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button.active[_ngcontent-%COMP%]:hover{color:var(--ghs-color-darkgray)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button.active[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)}"]})}return i})();const Qo=(i,r)=>[i,r],lC=i=>({selected:i}),gC=(i,r)=>({disabled:i,remove:r}),dC=(i,r)=>r.edition+"-"+r.name;function hC(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",6),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.toggleSelect(n.name))}),t.nrm(1,"img",7),t.j41(2,"span"),t.EFF(3),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(3,lC,e.name==a.selected)),t.R7$(),t.Y8G("src",e.iconUrl,t.B4B),t.R7$(2),t.JRh(a.gameManager.characterManager.characterName(e,!0))}}function _C(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",8),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.close())}),t.nrm(1,"span",0),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.l_i(3,gC,!(e.selected||e.edit&&e.data.selected),e.edit&&!e.selected&&e.data.selected)),t.R7$(),t.Y8G("ghs-label",e.edit&&!e.selected&&e.data.selected?"game.loot.remove":e.edit&&e.data.selected&&e.selected==e.data.selected?"game.loot.keep":"game.loot.apply")("ghs-label-args",t.l_i(6,Qo,e.edition,e.selected||e.data.selected||""))}}function mC(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",9),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.close())}),t.nrm(1,"span",10),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","cancel"))}let ts=(()=>{class i{data;dialogRef;gameManager=s.E;characters=[];selected;edition;loot;edit=!1;constructor(e,a){this.data=e,this.dialogRef=a,this.loot=e.loot,this.selected=e.selected||"",this.edit=e.edit||!1,this.characters=s.E.game.figures.filter(n=>n instanceof q.K&&!n.absent&&s.E.entityManager.isAlive(n)).map(n=>n),this.edition=this.characters.find(n=>n.name==this.selected)?.edition||""}toggleSelect(e){this.selected==e?(this.selected="",this.data.selected&&(this.edition=this.characters.find(a=>a.name==this.data.selected)?.edition||"")):(this.selected=e,this.edition=this.characters.find(a=>a.name==this.selected)?.edition||"")}close(){(0,V.co)(this.dialogRef,this.selected)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-loot-apply-dialog"]],standalone:!1,decls:8,vars:7,consts:[[3,"ghs-label","ghs-label-args"],[1,"characters"],[1,"character",3,"ngClass"],[1,"menu"],[3,"ngClass"],[1,"cancel"],[1,"character",3,"click","ngClass"],[1,"icon",3,"src"],[3,"click","ngClass"],[1,"cancel",3,"click"],[3,"ghs-label"]],template:function(a,n){1&a&&(t.j41(0,"p"),t.nrm(1,"span",0),t.k0s(),t.j41(2,"div",1),t.Z7z(3,hC,4,5,"div",2,dC),t.k0s(),t.j41(5,"div",3),t.nVh(6,_C,2,9,"a",4),t.nVh(7,mC,2,1,"a",5),t.k0s()),2&a&&(t.R7$(),t.Y8G("ghs-label","game.loot.chooseCharacter")("ghs-label-args",t.l_i(4,Qo,""+n.gameManager.lootManager.getValue(n.loot),"game.loot."+n.loot.type)),t.R7$(2),t.Dyx(n.characters),t.R7$(3),t.vxM(n.selected||n.data.selected?6:-1),t.R7$(),t.vxM(n.selected||n.data.selected?-1:7))},dependencies:[N.YU,tt],styles:["p[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.8 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-align:center}.characters[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);margin:.25em;padding:.25em;border:1px solid transparent}.characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:1.5em;height:auto;margin-right:.2em;filter:grayscale(.7)}.characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]:hover{color:var(--ghs-color-darkgray);border-color:var(--ghs-color-darkgray)}.characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]:hover   .icon[_ngcontent-%COMP%]{filter:grayscale(.3)}.characters[_ngcontent-%COMP%]   .character.selected[_ngcontent-%COMP%]{color:var(--ghs-color-white);border-color:var(--ghs-color-gray)}.characters[_ngcontent-%COMP%]   .character.selected[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{filter:none}.menu[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;color:var(--ghs-color-green)}.menu[_ngcontent-%COMP%]   a.remove[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray)}.menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.5;color:var(--ghs-color-gray)}"]})}return i})();const pC=(i,r)=>({fh:i,modern:r}),uC=(i,r)=>[i,r],fC=i=>({autosell:i});let pa=(()=>{class i{data;dialogRef;dialog;settingsManager=m.f;gameManager=s.E;item;character;autoSell=!1;constructor(e,a,n){this.data=e,this.dialogRef=a,this.dialog=n,this.item=e.item,this.character=e.character,this.autoSell=null!=this.character&&null!=this.character.progress.items.find(o=>o.name==""+this.item.id&&o.edition==this.item.edition)}close(){(0,V.co)(this.dialogRef)}openDialog(){this.dialog.open(Me,{panelClass:["fullscreen-panel"],disableClose:!0,data:{item:this.item}})}apply(){(0,V.co)(this.dialogRef,this.item)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-random-item-dialog"]],standalone:!1,decls:10,vars:17,consts:[[1,"random-item-dialog",3,"ngClass"],[1,"scroll-container"],[1,"title",3,"ghs-label","ghs-label-args"],[1,"item",3,"ngClass"],[3,"click","item","flipped","editionLabel"],[1,"menu"],[1,"cancel",3,"click"],[3,"ghs-label"],[1,"apply",3,"click"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"span",2),t.j41(3,"div",3)(4,"ghs-item",4),t.bIt("click",function(){return n.openDialog()}),t.k0s()(),t.j41(5,"div",5)(6,"a",6),t.bIt("click",function(){return n.close()}),t.nrm(7,"span",7),t.k0s(),t.j41(8,"a",8),t.bIt("click",function(){return n.apply()}),t.nrm(9,"span",7),t.k0s()()()()),2&a&&(t.Y8G("ngClass",t.l_i(9,pC,"fh"==n.settingsManager.settings.theme,"modern"==n.settingsManager.settings.theme)),t.R7$(2),t.Y8G("ghs-label","game.loot.random_item.draw")("ghs-label-args",t.l_i(12,uC,n.character.name,n.gameManager.characterManager.characterName(n.character))),t.R7$(),t.Y8G("ngClass",t.eq3(15,fC,n.autoSell)),t.R7$(),t.Y8G("item",n.item)("flipped",!0)("editionLabel",n.gameManager.currentEdition()),t.R7$(3),t.Y8G("ghs-label","cancel"),t.R7$(2),t.Y8G("ghs-label","game.loot.random_item.apply"))},dependencies:[N.YU,tt,je],styles:[".random-item-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:block;font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline);margin-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.random-item-dialog.fh[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.random-item-dialog.modern[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.random-item-dialog[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:100%}.random-item-dialog[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ghs-item[_ngcontent-%COMP%]{display:block;width:calc(var(--ghs-unit) * 27 * var(--ghs-dialog-factor));height:auto}.random-item-dialog[_ngcontent-%COMP%]   .item.autosell[_ngcontent-%COMP%]{cursor:not-allowed;border-color:var(--ghs-color-darkgray);filter:grayscale(.7)}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:2em;padding:.3em}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}"]})}return i})();var ht=M(9733);const CC=(i,r)=>({flipped:i,"no-animations":r});function MC(i,r){1&i&&t.nrm(0,"img",9),2&i&&t.Y8G("ghs-tooltip","challenges.automation.hint")}function vC(i,r){if(1&i&&t.nrm(0,"img",12),2&i){const e=t.XpG(2);t.Y8G("ghs-tooltip","data.challenges."+e.challenge.edition+"."+e.challenge.cardId+".hint")}}function OC(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function PC(i,r){if(1&i&&(t.j41(0,"div",7)(1,"div",8),t.nVh(2,MC,1,1,"img",9),t.k0s(),t.nrm(3,"p",10),t.j41(4,"div",11),t.nVh(5,vC,1,1,"img",12),t.k0s()(),t.j41(6,"div",13),t.nrm(7,"p",10),t.k0s(),t.j41(8,"div",14),t.nVh(9,OC,2,0,"span"),t.EFF(10),t.k0s()),2&i){const e=t.XpG();t.R7$(2),t.vxM(e.challenge.automation&&e.settingsManager.settings.fhChallengesApply?2:-1),t.R7$(),t.Y8G("ghs-label","data.challenges."+e.challenge.edition+"."+e.challenge.cardId),t.R7$(2),t.vxM("partial"==e.challenge.automation&&e.settingsManager.settings.fhChallengesApply?5:-1),t.R7$(2),t.Y8G("ghs-label","data.challenges."+e.challenge.edition+"."+e.challenge.cardId+".text"),t.R7$(2),t.vxM(e.challenge.cardId<10?9:-1),t.R7$(),t.SpI("",e.challenge.cardId," ")}}let Ci=(()=>{class i{challenge;keep=!1;flipped=!1;reveal=!1;disableFlip=!1;revealed=!1;animate=!1;settingsManager=m.f;onChange(e){this.revealed=e}ngOnChanges(e){const a=e.flipped;a&&!this.disableFlip&&a.currentValue&&a.currentValue!=a.previousValue&&(this.animate=!0)}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-challenge-card"]],inputs:{challenge:"challenge",keep:"keep",flipped:"flipped",reveal:"reveal",disableFlip:"disableFlip"},standalone:!1,features:[t.OA$],decls:8,vars:9,consts:[["container",""],[1,"challenge"],["card-reveal","",1,"card",3,"change","ngClass","disabled"],[1,"card-back"],[1,"revealed"],[1,"text",3,"ghs-label"],[1,"card-front"],[1,"title"],[1,"automation"],["src","./assets/images/automation.svg",1,"ghs-svg",3,"ghs-tooltip"],[1,"placeholder",3,"ghs-label"],[1,"hint"],["src","./assets/images/warning.svg",1,"ghs-svg",3,"ghs-tooltip"],[1,"text"],[1,"card-id"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",1,0)(2,"div",2),t.bIt("change",function(_){return t.eBV(o),t.Njj(n.onChange(_))}),t.j41(3,"div",3)(4,"span",4),t.nrm(5,"span",5),t.k0s()(),t.j41(6,"div",6),t.nVh(7,PC,11,6),t.k0s()()()}if(2&a){const o=t.sdS(1);t.R7$(2),t.xc7("font-size",.1*o.offsetWidth+"px"),t.Y8G("ngClass",t.l_i(6,CC,n.flipped||n.revealed,!n.animate))("disabled",!n.reveal),t.R7$(3),t.Y8G("ghs-label","game.cards.confirmReveal"),t.R7$(2),t.vxM(n.challenge?7:-1)}},dependencies:[N.YU,Be,tt,ft],styles:[".challenge[_ngcontent-%COMP%]{position:relative;width:100%;padding-bottom:147%}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;border:5% solid transparent;border-radius:5%;transition:transform calc(var(--ghs-animation-speed) * .5s) cubic-bezier(.75,0,.85,1)}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]{background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:5%;background-image:url(challenge-front.9a22e80ccfbf0b6d.png)}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{position:absolute;top:6%;left:0;width:100%;height:20%;display:flex;justify-content:center;align-items:center;text-align:center;margin:0;font-family:var(--ghs-font-title);font-size:.85em;transform:rotate(-3deg)}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{max-width:60%;margin:0}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .automation[_ngcontent-%COMP%], .challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{display:flex;align-items:center;width:20%}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .automation[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{cursor:help}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .automation.automation[_ngcontent-%COMP%], .challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .hint.automation[_ngcontent-%COMP%]{justify-content:flex-end}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .automation.automation[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .hint.automation[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{margin-right:.2em;width:1.5em;height:auto;filter:var(--ghs-filter-darkgray)}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .automation.hint[_ngcontent-%COMP%], .challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .hint.hint[_ngcontent-%COMP%]{justify-content:flex-start}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .automation.hint[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .hint.hint[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{margin-left:.2em;width:1.3em;height:auto;filter:var(--ghs-filter-yellow)}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{position:absolute;top:30%;left:17.5%;width:65%;height:60%;margin:0;font-family:var(--ghs-font-normal);font-size:.75em;line-height:.9em;text-align:center;transform:rotate(-3deg)}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{position:absolute;bottom:1%;right:8%;text-align:right;font-family:var(--ghs-font-normal);font-size:.5em;color:var(--ghs-color-white);filter:var(--ghs-filter-outline)}.challenge[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]{background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:5%;background-image:url(challenge-back.73584a0c39f15db5.png)}.challenge[_ngcontent-%COMP%]   .confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center;color:var(--ghs-color-black);font-size:1.3em;filter:drop-shadow(calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) var(--ghs-color-white))}.challenge[_ngcontent-%COMP%]   .confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{text-align:center}"]})}return i})();M(83492);const bC=(i,r)=>({closed:i,opened:r});let kC=(()=>{class i{card;dialogRef;opened=!1;constructor(e,a){this.card=e,this.dialogRef=a}ngOnInit(){this.opened=!0}close(){this.opened=!1,setTimeout(()=>{this.dialogRef.close()},m.f.settings.animations?1e3*m.f.settings.animationSpeed:0)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-challenge-dialog"]],standalone:!1,decls:3,vars:6,consts:[[1,"challenge-dialog",3,"click","ngClass"],[3,"challenge","flipped"],[1,"close-container",3,"click"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.bIt("click",function(){return n.close()}),t.nrm(1,"ghs-challenge-card",1),t.k0s(),t.j41(2,"div",2),t.bIt("click",function(){return n.close()}),t.k0s()),2&a&&(t.Y8G("ngClass",t.l_i(3,bC,!n.opened,n.opened)),t.R7$(),t.Y8G("challenge",n.card)("flipped",n.opened))},dependencies:[N.YU,Ci],styles:["[_nghost-%COMP%]{background-color:transparent;padding:0;margin:0;border:0}.challenge-dialog[_ngcontent-%COMP%]{position:relative;width:66.66vh;max-width:400px;height:100vh;max-height:600px;border-image:none;background:none;transition:transform calc(var(--ghs-animation-speed) * .15s) ease-in-out;transform:scale(0);z-index:2}.challenge-dialog[_ngcontent-%COMP%]   ghs-challenge-card[_ngcontent-%COMP%]{width:100%;height:auto}.challenge-dialog[_ngcontent-%COMP%]   .close-dialog[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:0;left:0;width:100%;height:45%}.challenge-dialog.opened[_ngcontent-%COMP%]{transform:scale(1)}.challenge-dialog.closed[_ngcontent-%COMP%]{transform:scale(0);transition-delay:.8s}@media (max-width: 600px),(orientation: portrait){.challenge-dialog[_ngcontent-%COMP%]{width:80vw;max-width:400px;height:120vw;max-height:600px}}.close-container[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1}"]})}return i})();const Yn=(i,r)=>[i,r],Ne=i=>[i],ua=(i,r,e)=>[i,r,e];function yC(i,r){if(1&i&&(t.j41(0,"div",1),t.nrm(1,"span",3),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","scenario.requirements.solo")("ghs-label-args",t.l_i(2,Yn,e.scenarioData.edition,e.solo))}}function xC(i,r){if(1&i&&t.nrm(0,"div",6),2&i){const e=r.$implicit;t.Y8G("ghs-label","scenario.requirements.party")("ghs-label-args",t.eq3(2,Ne,e))}}function EC(i,r){if(1&i&&t.nrm(0,"div",6),2&i){const e=r.$implicit;t.Y8G("ghs-label","scenario.requirements.partyCount")("ghs-label-args",t.sMw(2,ua,e.name,e.required-e.count,e.required))}}function wC(i,r){if(1&i&&t.nrm(0,"div",6),2&i){const e=r.$implicit;t.Y8G("ghs-label","scenario.requirements.partyMissing")("ghs-label-args",t.eq3(2,Ne,e))}}function RC(i,r){if(1&i&&t.nrm(0,"div",6),2&i){const e=r.$implicit;t.Y8G("ghs-label","scenario.requirements.global")("ghs-label-args",t.eq3(2,Ne,e))}}function jC(i,r){if(1&i&&t.nrm(0,"div",6),2&i){const e=r.$implicit;t.Y8G("ghs-label","scenario.requirements.globalCount")("ghs-label-args",t.sMw(2,ua,e.name,e.required-e.count,e.required))}}function GC(i,r){if(1&i&&t.nrm(0,"div",6),2&i){const e=r.$implicit;t.Y8G("ghs-label","scenario.requirements.globalMissing")("ghs-label-args",t.eq3(2,Ne,e))}}function TC(i,r){if(1&i&&t.nrm(0,"div",6),2&i){const e=r.$implicit;t.Y8G("ghs-label","scenario.requirements.campaignStickers")("ghs-label-args",t.eq3(2,Ne,e))}}function SC(i,r){if(1&i&&t.nrm(0,"div",6),2&i){const e=r.$implicit;t.Y8G("ghs-label","scenario.requirements.campaignStickersCount")("ghs-label-args",t.sMw(2,ua,e.name,e.required-e.count,e.required))}}function $C(i,r){if(1&i&&t.nrm(0,"div",6),2&i){const e=r.$implicit;t.Y8G("ghs-label","scenario.requirements.campaignStickersMissing")("ghs-label-args",t.eq3(2,Ne,e))}}function DC(i,r){if(1&i&&t.nrm(0,"div",6),2&i){const e=r.$implicit;t.Y8G("ghs-label","scenario.requirements.buildings")("ghs-label-args",t.eq3(2,Ne,e))}}function IC(i,r){if(1&i&&t.nrm(0,"div",6),2&i){const e=r.$implicit;t.Y8G("ghs-label","scenario.requirements.buildingsLevel")("ghs-label-args",t.l_i(2,Yn,e.name,e.level))}}function AC(i,r){if(1&i&&t.nrm(0,"div",6),2&i){const e=r.$implicit;t.Y8G("ghs-label","scenario.requirements.buildingsMissing")("ghs-label-args",t.eq3(2,Ne,e))}}function VC(i,r){if(1&i&&t.nrm(0,"div",11),2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ghs-label","scenario.requirements.characters")("ghs-label-args",t.l_i(2,Yn,a.scenarioData.edition,e))}}function FC(i,r){if(1&i&&t.nrm(0,"div",11),2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ghs-label","scenario.requirements.charactersMissing")("ghs-label-args",t.l_i(2,Yn,a.scenarioData.edition,e))}}function XC(i,r){1&i&&t.nrm(0,"div",15),2&i&&t.Y8G("ghs-label","scenario.requirements.scenarios.and")}function BC(i,r){if(1&i&&(t.nrm(0,"div",16),t.nVh(1,XC,1,1,"div",15)),2&i){const e=r.$implicit,a=r.$index,n=t.XpG().$implicit,o=t.XpG(3);t.Y8G("ghs-label","scenario.requirements.scenarios.scenario")("ghs-label-args",t.l_i(3,Yn,e,o.scenarioData.edition)),t.R7$(),t.vxM(n.length>1&&a<n.length-1?1:-1)}}function YC(i,r){1&i&&t.nrm(0,"div",15),2&i&&t.Y8G("ghs-label","scenario.requirements.scenarios.or")}function NC(i,r){if(1&i&&(t.j41(0,"div",12),t.Z7z(1,BC,2,6,null,null,t.fX1),t.k0s(),t.nVh(3,YC,1,1,"div",15)),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2).$implicit;t.R7$(),t.Dyx(e),t.R7$(2),t.vxM(n.scenarios.length>1&&a<n.scenarios.length-1?3:-1)}}function zC(i,r){if(1&i&&(t.j41(0,"div",12),t.nrm(1,"div",14),t.Z7z(2,NC,4,1,null,null,t.fX1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.Y8G("ghs-label","scenario.requirements.scenarios"),t.R7$(),t.Dyx(e.scenarios)}}function LC(i,r){1&i&&(t.j41(0,"span",13),t.nrm(1,"span",17),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","or"))}function UC(i,r){if(1&i&&(t.j41(0,"div",4)(1,"div",5),t.Z7z(2,xC,1,4,"div",6,t.fX1),t.k0s(),t.j41(4,"div",5),t.Z7z(5,EC,1,6,"div",6,t.fX1),t.k0s(),t.j41(7,"div",5),t.Z7z(8,wC,1,4,"div",6,t.fX1),t.k0s(),t.j41(10,"div",7),t.Z7z(11,RC,1,4,"div",6,t.fX1),t.k0s(),t.j41(13,"div",7),t.Z7z(14,jC,1,6,"div",6,t.fX1),t.k0s(),t.j41(16,"div",7),t.Z7z(17,GC,1,4,"div",6,t.fX1),t.k0s(),t.j41(19,"div",8),t.Z7z(20,TC,1,4,"div",6,t.fX1),t.k0s(),t.j41(22,"div",8),t.Z7z(23,SC,1,6,"div",6,t.fX1),t.k0s(),t.j41(25,"div",8),t.Z7z(26,$C,1,4,"div",6,t.fX1),t.k0s(),t.j41(28,"div",9),t.Z7z(29,DC,1,4,"div",6,t.fX1),t.k0s(),t.j41(31,"div",9),t.Z7z(32,IC,1,5,"div",6,t.fX1),t.k0s(),t.j41(34,"div",9),t.Z7z(35,AC,1,4,"div",6,t.fX1),t.k0s(),t.j41(37,"div",10),t.Z7z(38,VC,1,5,"div",11,t.fX1),t.k0s(),t.j41(40,"div",10),t.Z7z(41,FC,1,5,"div",11,t.fX1),t.k0s(),t.nVh(43,zC,4,1,"div",12),t.k0s(),t.nVh(44,LC,2,1,"span",13)),2&i){const e=r.$implicit,a=r.$index,n=t.XpG();t.R7$(2),t.Dyx(e.partyAchievements),t.R7$(3),t.Dyx(e.partyAchievementsCount),t.R7$(3),t.Dyx(e.partyAchievementsMissing),t.R7$(3),t.Dyx(e.globalAchievements),t.R7$(3),t.Dyx(e.globalAchievementsCount),t.R7$(3),t.Dyx(e.globalAchievementsMissing),t.R7$(3),t.Dyx(e.campaignStickers),t.R7$(3),t.Dyx(e.campaignStickersCount),t.R7$(3),t.Dyx(e.campaignStickersMissing),t.R7$(3),t.Dyx(e.buildings),t.R7$(3),t.Dyx(e.buildingsLevel),t.R7$(3),t.Dyx(e.buildingsMissing),t.R7$(3),t.Dyx(e.characters),t.R7$(3),t.Dyx(e.charactersMissing),t.R7$(2),t.vxM(e.scenarios.length?43:-1),t.R7$(),t.vxM(a<n.requirements.length-1?44:-1)}}function qC(i,r){if(1&i){const e=t.RV6();t.j41(0,"label",2)(1,"input",18),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.all,n)||(o.all=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.update())}),t.k0s(),t.nrm(2,"span",17),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.R50("ngModel",e.all),t.R7$(),t.Y8G("ghs-label","scenario.requirements.all")}}function HC(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",6)(1,"a",7),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.close())}),t.nrm(2,"span",3),t.k0s(),t.j41(3,"a",8),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.startScenario())}),t.nrm(4,"span",3),t.k0s()()}2&i&&(t.R7$(2),t.Y8G("ghs-label","scenario.requirements.cancel"),t.R7$(2),t.Y8G("ghs-label","scenario.requirements.start"))}let es=(()=>{class i{scenarioData;highlight=!1;all=!1;allToggle=!0;gameManager=s.E;solo="";requirements=[];missingRequirements=[];hideAll=!1;ngOnInit(){this.update()}ngOnChanges(e){e.all&&this.update()}update(){this.requirements=s.E.scenarioManager.getRequirements(this.scenarioData,this.all),this.missingRequirements=s.E.scenarioManager.getRequirements(this.scenarioData),this.solo="",this.hideAll=!this.all&&JSON.stringify(s.E.scenarioManager.getRequirements(this.scenarioData,!0))==JSON.stringify(this.requirements),this.scenarioData.solo&&(this.all||!s.E.game.figures.find(e=>e instanceof q.K&&e.name==this.scenarioData.solo&&e.level>=5))&&(this.solo=this.scenarioData.solo)}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-requirements"]],inputs:{scenarioData:"scenarioData",highlight:"highlight",all:"all",allToggle:"allToggle"},standalone:!1,features:[t.OA$],decls:5,vars:2,consts:[[1,"requirements"],[1,"solo"],[1,"checkbox"],[3,"ghs-label","ghs-label-args"],[1,"requirement"],[1,"party"],[1,"achievement",3,"ghs-label","ghs-label-args"],[1,"global"],[1,"campaign-stickers"],[1,"buildings"],[1,"characters"],[1,"characters",3,"ghs-label","ghs-label-args"],[1,"scenarios"],[1,"separator"],[1,"requires",3,"ghs-label"],[1,"separator",3,"ghs-label"],[1,"scenario",3,"ghs-label","ghs-label-args"],[3,"ghs-label"],["type","checkbox",3,"ngModelChange","change","ngModel"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nVh(1,yC,2,5,"div",1),t.Z7z(2,UC,45,2,null,null,t.fX1),t.nVh(4,qC,3,2,"label",2),t.k0s()),2&a&&(t.R7$(),t.vxM(n.solo?1:-1),t.R7$(),t.Dyx(n.requirements),t.R7$(2),t.vxM(n.allToggle&&!n.hideAll?4:-1))},dependencies:[O.Zm,O.BC,O.vS,tt],styles:[".requirements[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.requirements[_ngcontent-%COMP%]   .achievement[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.requirements[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{cursor:pointer;margin-top:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));display:flex;align-items:center;font-family:var(--ghs-font-text);color:var(--ghs-color-gray);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor))}.requirements[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));display:flex;justify-content:center;align-items:center;flex-wrap:wrap}.requirements[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .requires[_ngcontent-%COMP%]{text-align:center;width:100%;flex-grow:1}.requirements[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}"]})}return i})(),Mi=(()=>{class i{data;dialogRef;gameManager=s.E;constructor(e,a){this.data=e,this.dialogRef=a}startScenario(){s.E.stateManager.before("setScenario",...s.E.scenarioManager.scenarioUndoArgs(new ht.Nz(this.data.scenarioData))),s.E.scenarioManager.setScenario(new ht.Nz(this.data.scenarioData),this.data.linked||!1),s.E.stateManager.after(),(0,V.co)(this.dialogRef,!0)}close(){(0,V.co)(this.dialogRef)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-requirements-dialog"]],standalone:!1,decls:9,vars:5,consts:[[1,"requirements-dialog"],[1,"header"],[1,"title"],[3,"ghs-label"],[1,"name"],[3,"scenarioData"],[1,"buttons"],[1,"cancel",3,"click"],[1,"start",3,"click"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"span",2),t.nrm(3,"span",3),t.j41(4,"span",4),t.EFF(5),t.nrm(6,"span",3),t.k0s()()(),t.nrm(7,"ghs-requirements",5),t.nVh(8,HC,5,2,"div",6),t.k0s()),2&a&&(t.R7$(3),t.Y8G("ghs-label","scenario.requirements"),t.R7$(2),t.SpI("#",n.data.scenarioData.index," "),t.R7$(),t.Y8G("ghs-label",n.gameManager.scenarioManager.scenarioTitle(n.data.scenarioData)),t.R7$(),t.Y8G("scenarioData",n.data.scenarioData),t.R7$(),t.vxM(n.data.hideMenu?-1:8))},dependencies:[tt,es],styles:[".requirements-dialog[_ngcontent-%COMP%]{position:relative;color:var(--ghs-color-white)}.requirements-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-family:var(--ghs-font-title);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor))}.requirements-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;flex-direction:column}.requirements-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{text-align:center;color:var(--ghs-color-gray);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.requirements-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly;align-items:center}.requirements-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;min-width:33%;display:flex;justify-content:center;margin:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));white-space:nowrap}.requirements-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.requirements-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.requirements-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .start[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}"]})}return i})();const KC=(i,r)=>({flipped:i,"no-animations":r});function WC(i,r){1&i&&t.nrm(0,"img",9),2&i&&t.Y8G("ghs-tooltip","campaign.trials.automation")}function JC(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function ZC(i,r){if(1&i&&(t.nrm(0,"div",7),t.j41(1,"div",8),t.nVh(2,WC,1,1,"img",9),t.k0s(),t.j41(3,"div",10),t.nrm(4,"p",11),t.k0s(),t.j41(5,"div",12),t.nVh(6,JC,2,0,"span"),t.EFF(7),t.k0s()),2&i){const e=t.XpG();t.Y8G("ghs-label","data.trials."+e.trialCard.edition+"."+e.trialCard.cardId),t.R7$(2),t.vxM(e.trialCard.automation&&e.settingsManager.settings.fhChallengesApply?2:-1),t.R7$(2),t.Y8G("ghs-label","data.trials."+e.trialCard.edition+"."+e.trialCard.cardId+".text"),t.R7$(2),t.vxM(e.trialCard.cardId<1e3?6:-1),t.R7$(),t.SpI("",e.settingsManager.settings.fhSecondEdition?e.gameManager.trialsManager.cardIdSecondPrinting(e.trialCard.cardId):e.trialCard.cardId," ")}}let QC=(()=>{class i{trial;edition;keep=!1;flipped=!1;reveal=!1;disableFlip=!1;trialCard;revealed=!1;animate=!1;gameManager=s.E;settingsManager=m.f;ngOnInit(){const e=s.E.editionData.find(a=>a.edition==this.edition&&a.trials);e&&(this.trialCard=e.trials.find(a=>a.edition==this.edition&&a.cardId==this.trial))}onChange(e){this.revealed=e}ngOnChanges(e){const a=e.flipped;a&&!this.disableFlip&&a.currentValue&&a.currentValue!=a.previousValue&&(this.animate=!0)}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-trial-card"]],inputs:{trial:"trial",edition:"edition",keep:"keep",flipped:"flipped",reveal:"reveal",disableFlip:"disableFlip"},standalone:!1,features:[t.OA$],decls:8,vars:9,consts:[["container",""],[1,"trial"],["card-reveal","",1,"card",3,"change","ngClass","disabled"],[1,"card-back"],[1,"revealed"],[1,"text",3,"ghs-label"],[1,"card-front"],[1,"title",3,"ghs-label"],[1,"automation"],["src","./assets/images/automation.svg",1,"ghs-svg",3,"ghs-tooltip"],[1,"text"],[1,"placeholder","margin-breaks",3,"ghs-label"],[1,"card-id"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",1,0)(2,"div",2),t.bIt("change",function(_){return t.eBV(o),t.Njj(n.onChange(_))}),t.j41(3,"div",3)(4,"span",4),t.nrm(5,"span",5),t.k0s()(),t.j41(6,"div",6),t.nVh(7,ZC,8,5),t.k0s()()()}if(2&a){const o=t.sdS(1);t.R7$(2),t.xc7("font-size",.1*o.offsetWidth+"px"),t.Y8G("ngClass",t.l_i(6,KC,n.flipped||n.revealed,!n.animate))("disabled",!n.reveal),t.R7$(3),t.Y8G("ghs-label","game.cards.confirmReveal"),t.R7$(2),t.vxM(n.trialCard?7:-1)}},dependencies:[N.YU,Be,tt,ft],styles:[".trial[_ngcontent-%COMP%]{position:relative;width:100%;padding-bottom:147%}.trial[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;border:5% solid transparent;border-radius:5%}.trial[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]{background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:5%;background-image:url(trial-front.88b3e4fb0b27e613.png)}.trial[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{position:absolute;top:7%;left:25%;width:100%;margin:0;font-family:var(--ghs-font-title);font-size:1.1em;color:var(--ghs-color-white);filter:var(--ghs-filter-outline);text-transform:uppercase}.trial[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .automation[_ngcontent-%COMP%]{position:absolute;top:4%;right:8%;display:flex;justify-content:center;align-items:center}.trial[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .automation[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{cursor:help;width:1.2em;height:auto;filter:var(--ghs-filter-white)}.trial[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{position:absolute;top:20%;left:11%;width:78%;height:70%;margin:0;font-family:var(--ghs-font-normal);font-size:.8em;line-height:.9em;display:flex;justify-content:center;align-items:center}.trial[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;text-align:center}.trial[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{position:absolute;bottom:1.2%;right:88%;text-align:right;font-family:var(--ghs-font-normal);font-size:.45em;color:var(--ghs-color-white);filter:var(--ghs-filter-outline)}.trial[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]{background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:5%;background-image:url(trial-back.5d90a94e1c9992f4.png)}.trial[_ngcontent-%COMP%]   .confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center;color:var(--ghs-color-black);font-size:1.3em;filter:drop-shadow(calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) var(--ghs-color-white))}.trial[_ngcontent-%COMP%]   .confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{text-align:center}"]})}return i})();const tM=(i,r)=>({closed:i,opened:r});let ns=(()=>{class i{data;dialogRef;opened=!1;constructor(e,a){this.data=e,this.dialogRef=a}ngOnInit(){this.opened=!0}close(){this.opened=!1,setTimeout(()=>{this.dialogRef.close()},m.f.settings.animations?1e3*m.f.settings.animationSpeed:0)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-trial-dialog"]],standalone:!1,decls:3,vars:7,consts:[[1,"trial-dialog",3,"click","ngClass"],[3,"edition","trial","flipped"],[1,"close-container",3,"click"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.bIt("click",function(){return n.close()}),t.nrm(1,"ghs-trial-card",1),t.k0s(),t.j41(2,"div",2),t.bIt("click",function(){return n.close()}),t.k0s()),2&a&&(t.Y8G("ngClass",t.l_i(4,tM,!n.opened,n.opened)),t.R7$(),t.Y8G("edition",n.data.edition)("trial",n.data.trial)("flipped",n.opened))},dependencies:[N.YU,QC],styles:["[_nghost-%COMP%]{background-color:transparent;padding:0;margin:0;border:0}.trial-dialog[_ngcontent-%COMP%]{position:relative;width:66.66vh;max-width:400px;height:100vh;max-height:600px;border-image:none;background:none;transition:transform calc(var(--ghs-animation-speed) * .15s) ease-in-out;transform:scale(0);z-index:2}.trial-dialog[_ngcontent-%COMP%]   ghs-trial[_ngcontent-%COMP%]{width:100%;height:auto}.trial-dialog[_ngcontent-%COMP%]   .close-dialog[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:0;left:0;width:100%;height:45%}.trial-dialog.opened[_ngcontent-%COMP%]{transform:scale(1)}.trial-dialog.closed[_ngcontent-%COMP%]{transform:scale(0);transition-delay:.8s}@media (max-width: 600px),(orientation: portrait){.trial-dialog[_ngcontent-%COMP%]{width:80vw;max-width:400px;height:120vw;max-height:600px}}.close-container[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1}"]})}return i})();var Ct=M(67165);const eM=(i,r)=>r.edition+"-"+r.id;function nM(i,r){if(1&i&&t.nrm(0,"span",3),2&i){const e=t.XpG().$index,a=t.XpG(2);t.Y8G("ghs-label",a.rewardLabel[e][0]+".result")("ghs-label-args",a.rewardResults[e])}}function iM(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,",\xa0"),t.k0s())}function aM(i,r){if(1&i&&(t.nrm(0,"span",2),t.nVh(1,nM,1,2,"span",3),t.nVh(2,iM,2,0,"span")),2&i){const e=r.$index,a=t.XpG(2);t.Y8G("ghs-label",a.rewardLabel[e][0])("ghs-label-args",a.rewardLabel[e].slice(1)),t.R7$(),t.vxM(a.rewardResults&&a.rewardResults[e]&&a.rewardResults[e].length>0?1:-1),t.R7$(),t.vxM(a.treasure.rewards.length>1&&e<a.treasure.rewards.length-1?2:-1)}}function oM(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-item",5),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.openItemDialog(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(3);t.Y8G("item",e)("flipped",!0)("editionLabel",a.gameManager.game.edition||"")}}function sM(i,r){if(1&i&&(t.j41(0,"div",1),t.Z7z(1,oM,1,3,"ghs-item",4,eM),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Dyx(e.items)}}function rM(i,r){if(1&i&&(t.j41(0,"span",0),t.Z7z(1,aM,3,4,null,null,t.fX1),t.nVh(3,sM,3,0,"div",1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.treasure.rewards),t.R7$(2),t.vxM(e.itemCards&&e.items.length>0?3:-1)}}let Pn=(()=>{class i{dialog;gameManager=s.E;treasure;index;edition;rewardResults;itemCards=!1;items=[];rewardLabel=[];labelPrefix="game.loot.treasures.rewards.";constructor(e){this.dialog=e}ngOnInit(){if(this.treasure)this.index=this.treasure.index;else{const e=s.E.editionData.find(a=>a.edition==this.edition);if(e&&e.treasures){const a=this.index<0?this.index:this.index-(e.treasureOffset||0);a>=0&&a<e.treasures.length?this.treasure=new Ct.Ah(e.treasures[a],this.index):a<0&&e.treasures.length+a+1>0?this.treasure=new Ct.Ah(e.treasures[a+1+e.treasures.length],this.index):console.warn("Invalid treasure index: '"+this.index+"' for Edition "+this.edition,e.treasures.length)}}this.treasure&&(this.treasure.rewards.forEach((e,a)=>{this.rewardLabel[a]=this.calcRewardLabel(e)}),this.itemCards&&this.treasure.rewards.forEach((e,a)=>{if(-1!=[Ct.lb.item,Ct.lb.itemBlueprint,Ct.lb.itemDesign,Ct.lb.itemFh].indexOf(e.type)){const n=""+e.value;let o=this.edition,g=-1;isNaN(+n)?(g=+n.split("-")[0],o=n.split("-")[1]):g=+n;const _=s.E.itemManager.getItem(g,o,!0);_&&this.items.push(_)}else if(-1!=[Ct.lb.randomItem,Ct.lb.randomItemBlueprint,Ct.lb.randomItemDesign].indexOf(e.type)&&this.rewardResults&&this.rewardResults[a]&&this.rewardResults[a][0]&&!isNaN(+this.rewardResults[a][0])){const n=s.E.itemManager.getItem(this.rewardResults[a][0],this.rewardResults[a][2],!0);n&&this.items.push(n)}}))}calcRewardLabel(e){if("custom"==e.type)return[""+e.value];const a=""+(e.value||"");switch(e.type){case Ct.lb.gold:case Ct.lb.goldFh:case Ct.lb.experience:case Ct.lb.experienceFh:case Ct.lb.battleGoal:case Ct.lb.randomScenario:case Ct.lb.randomScenarioFh:case Ct.lb.randomItem:case Ct.lb.randomItemDesign:case Ct.lb.randomItemBlueprint:case Ct.lb.partyAchievement:case Ct.lb.campaignSticker:case Ct.lb.heal:case Ct.lb.loot:case Ct.lb.lootCards:return[this.labelPrefix+e.type,a];case Ct.lb.damage:return"terrain"==a?[this.labelPrefix+e.type,"%game.level.hazardousTerrain%"]:[this.labelPrefix+e.type,"%game.damage:"+a+"%"];case Ct.lb.condition:const n=a.split("+").map(st=>"%game.condition."+st+"%");let o=n[0];return n.length>1&&(o=n.slice(0,-1).join(","),o+=" %and% "+n[n.length-1]),[this.labelPrefix+e.type,o];case Ct.lb.item:case Ct.lb.itemDesign:case Ct.lb.itemFh:case Ct.lb.itemBlueprint:const g=[],_=[];a.split("+").forEach(st=>{let Et=this.edition,pt=-1;isNaN(+st)?(pt=+st.split("-")[0],Et=st.split("-")[1]):pt=+st;const te=s.E.itemManager.getItem(pt,Et,!0);te?(g.push(e.type==Ct.lb.itemFh||e.type==Ct.lb.itemBlueprint?te.id+"":"%game.item% "+(Et==this.edition?te.id:te.id+" [%data.edition."+te.edition+"%]")),_.push('"'+m.f.getLabel("data.items."+te.edition+"-"+te.id)+'"')):(console.warn("Invalid Item '"+pt+"' (Edition "+Et+") on treasure '"+this.index+"' for Edition "+this.edition),_.push('<img class="icon ghs-svg" src="./assets/images/warning.svg"> %item% '+pt))});let y=g[0];g.length>1&&(y=g.slice(0,-1).join(","),y+=" %and% "+g[g.length-1]);let B=_[0];return _.length>1&&(B=_.slice(0,-1).join(","),B+=" %and% "+_[_.length-1]),[this.labelPrefix+e.type,y,B];case Ct.lb.scenario:const nt=s.E.scenarioManager.getScenario(a,this.edition,void 0);return nt?[this.labelPrefix+e.type,nt.index,s.E.scenarioManager.scenarioTitle(nt)]:(console.warn("Invalid Scenario '"+a+"' on treasure '"+this.index+"' for Edition "+this.edition),[this.labelPrefix+e.type,a,'<img class="icon ghs-svg" src="./assets/images/warning.svg"> %scenario%']);case Ct.lb.event:const Z=a.split("-")[0],W=a.split("-")[1];return[this.labelPrefix+e.type+"."+Z,""+W];case Ct.lb.resource:const et=a.split("+").map(st=>st.split("-")[1]+'<img class="icon ghs-svg" src="./assets/images/fh/loot/'+st.split("-")[0]+'.svg">');let it=et[0];return et.length>1&&(it=et.slice(0,-1).join(","),it+=" %and% "+et[et.length-1]),[this.labelPrefix+e.type,it];case Ct.lb.calendarSection:if(a.split("-").length>1)return[this.labelPrefix+e.type,a.split("-")[0],a.split("-")[1]]}return[]}openItemDialog(e){this.dialog.open(Me,{panelClass:["fullscreen-panel"],disableClose:!0,data:{item:e}})}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-treasure-label"]],inputs:{treasure:"treasure",index:"index",edition:"edition",rewardResults:"rewardResults",itemCards:"itemCards"},standalone:!1,decls:1,vars:1,consts:[[1,"treasure-label"],[1,"items"],[1,"label",3,"ghs-label","ghs-label-args"],[1,"result",3,"ghs-label","ghs-label-args"],[3,"item","flipped","editionLabel"],[3,"click","item","flipped","editionLabel"]],template:function(a,n){1&a&&t.nVh(0,rM,4,1,"span",0),2&a&&t.vxM(n.treasure?0:-1)},dependencies:[tt,je],styles:[".treasure-label{display:inline-block;line-height:1em}.treasure-label:first-letter{text-transform:uppercase}.treasure-label .items{display:flex;flex-wrap:wrap;justify-content:center;align-items:center}.treasure-label .items ghs-item{position:relative;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 20 * var(--ghs-dialog-factor))}\n"],encapsulation:2})}return i})();const cM=(i,r)=>({fh:i,modern:r}),lM=i=>({absent:i}),is=i=>({denied:i}),Mt=i=>[i],Ht=()=>[],se=(i,r)=>[i,r],Nn=(i,r,e)=>[i,r,e],gM=()=>["+1"],dM=(i,r)=>({unlocked:i,disabled:r}),$t=(i,r)=>r.edition+"-"+r.name,hM=(i,r)=>r.edition+"-"+r.id,_M=(i,r)=>r&&r.edition+"-"+r.id,as=(i,r)=>r.type,mM=(i,r)=>r.id;function pM(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.SpI("#",e.scenario.index,"\xa0")}}function uM(i,r){1&i&&(t.j41(0,"span",6),t.nrm(1,"span",3),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","scenario.finish.success"))}function fM(i,r){if(1&i&&(t.j41(0,"span",7),t.nrm(1,"span",3),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label",e.conclusion.name?e.gameManager.scenarioManager.scenarioTitle(e.conclusion,!0):"%scenario.section% #"+e.conclusion.index)}}function CM(i,r){1&i&&(t.j41(0,"span",8),t.nrm(1,"span",3),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","scenario.summary.casualWarning"))}function MM(i,r){1&i&&(t.j41(0,"span",9),t.nrm(1,"span",3),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","scenario.finish.failure"))}function vM(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",18)(1,"img",22),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.openCharacterSheet(n))}),t.k0s(),t.j41(2,"span",23),t.EFF(3),t.k0s(),t.j41(4,"span",24)(5,"img",25),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.toggleAbsent(n))}),t.k0s()()()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(),t.Y8G("src",e.iconUrl,t.B4B),t.R7$(),t.Y8G("ngClass",t.eq3(7,lM,e.absent)),t.R7$(),t.SpI(" ",a.gameManager.characterManager.characterName(e,!0)," "),t.R7$(),t.Y8G("ngClass",t.eq3(9,is,!a.gameManager.stateManager.characterPermissions[e.name+"|"+e.edition])),t.R7$(),t.Y8G("src","./assets/images/status/"+(e.absent?"absent":"present")+".svg",t.B4B)("ghs-label",e.absent?"character.present":"character.absent")("ghs-label-attribute","title")}}function OM(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.JRh(t.bMT(2,1,e.loot))}}function PM(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.R7$(),t.Lme("",e.lootCards.length,"/",a.gameManager.game.lootDeck.cards.length)}}function bM(i,r){if(1&i&&(t.j41(0,"span",20),t.nVh(1,OM,3,3,"span"),t.nVh(2,PM,2,2,"span"),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.vxM(e.gameManager.game.lootDeck.cards.length?-1:1),t.R7$(),t.vxM(e.gameManager.game.lootDeck.cards.length?2:-1)}}function kM(i,r){if(1&i&&(t.j41(0,"span",20),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.SpI(" ",t.bMT(2,1,e.rewards.gold)," ")}}function yM(i,r){if(1&i&&(t.j41(0,"span",19),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,kM,3,3,"span",20,$t)),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.summary.rewards.gold"),t.R7$(),t.Dyx(e.characters)}}function xM(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",20)(1,"input",26),t.bIt("change",function(n){const o=t.eBV(e).$index,g=t.XpG(3);return t.Njj(g.changeCollectiveGold(n,o))}),t.k0s()()}if(2&i){const e=r.$index,a=t.XpG(3);t.R7$(),t.Y8G("max",a.collectiveGold[e]+a.availableCollectiveGold())("value",a.collectiveGold[e])}}function EM(i,r){if(1&i&&(t.j41(0,"span",21),t.nrm(1,"span",5),t.k0s(),t.Z7z(2,xM,2,2,"span",20,$t)),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.summary.rewards.collectiveGold"),t.R7$(),t.Dyx(e.characters)}}function wM(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",20)(1,"input",26),t.bIt("change",function(n){const o=t.eBV(e).$index,g=t.XpG().$implicit,_=t.XpG(3);return t.Njj(_.changeCollectiveResource(n,o,g.type))}),t.k0s()()}if(2&i){const e=r.$index,a=t.XpG().$implicit,n=t.XpG(3);t.R7$(),t.Y8G("max",(n.collectiveResources[e]&&n.collectiveResources[e][a.type]||0)+n.availableCollectiveResource(a.type))("value",n.collectiveResources[e]&&n.collectiveResources[e][a.type]||0)}}function RM(i,r){if(1&i&&(t.j41(0,"span",21),t.nrm(1,"span",27),t.k0s(),t.Z7z(2,wM,2,2,"span",20,$t)),2&i){const e=r.$implicit,a=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.summary.rewards.collectiveResource")("ghs-label-args",t.eq3(2,Mt,e.type)),t.R7$(),t.Dyx(a.characters)}}function jM(i,r){if(1&i&&t.Z7z(0,RM,4,4,null,null,t.fX1),2&i){const e=t.XpG(2);t.Dyx(e.rewards.collectiveResources)}}function GM(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.SpI("\xa0(",e.gameManager.trialsManager.activeFavor("fh","wealth"),"x)")}}function TM(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&i){const e=t.XpG(3).$implicit;t.R7$(),t.JRh(t.bMT(2,1,e.loot))}}function SM(i,r){if(1&i&&(t.EFF(0," \xa0 "),t.j41(1,"span"),t.EFF(2,"("),t.k0s(),t.Z7z(3,TM,3,3,"span",null,t.fX1),t.nI1(5,"ghsRange"),t.j41(6,"span"),t.EFF(7,")"),t.k0s()),2&i){const e=t.XpG(5);t.R7$(3),t.Dyx(t.i5U(5,0,t.lJ4(3,Ht),e.gameManager.trialsManager.activeFavor("fh","wealth")))}}function $M(i,r){if(1&i&&(t.j41(0,"span",29),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s(),t.nVh(3,SM,8,4)),2&i){const e=t.XpG().$implicit,a=t.XpG(3);t.R7$(),t.JRh(t.bMT(2,2,e.loot*a.gameManager.trialsManager.activeFavor("fh","wealth"))),t.R7$(2),t.vxM(a.gameManager.trialsManager.activeFavor("fh","wealth")>1?3:-1)}}function DM(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function IM(i,r){if(1&i&&(t.j41(0,"span",20),t.nVh(1,$M,4,4),t.nVh(2,DM,2,0,"span"),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.vxM(e.loot?1:-1),t.R7$(),t.vxM(e.loot?-1:2)}}function AM(i,r){if(1&i&&(t.j41(0,"span",19),t.nrm(1,"span",28),t.nVh(2,GM,2,1,"span"),t.k0s(),t.Z7z(3,IM,3,2,"span",20,$t)),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","data.favors.fh.wealth.reward")("ghs-tooltip","data.favors.fh.wealth.text"),t.R7$(),t.vxM(e.gameManager.trialsManager.activeFavor("fh","wealth")>1?2:-1),t.R7$(),t.Dyx(e.characters)}}function VM(i,r){1&i&&t.nrm(0,"span",3),2&i&&t.Y8G("ghs-label","scenario.summary.gold")}function FM(i,r){if(1&i&&(t.nrm(0,"img",30),t.EFF(1)),2&i){const e=t.XpG(2);t.R7$(),t.Lme(" ",e.lootedGold,"/",e.totalGold," ")}}function XM(i,r){if(1&i&&(t.j41(0,"span")(1,"span",29),t.EFF(2),t.nI1(3,"ghsValueSign"),t.k0s(),t.EFF(4),t.k0s()),2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG(2);t.R7$(2),t.JRh(t.bMT(3,2,(o.success&&o.rewards&&o.rewards.gold?o.rewards.gold:0)+(o.collectiveGold[n]?o.collectiveGold[n]:0)+a.loot*o.gameManager.levelManager.loot()+(o.gameManager.trialsManager.favorsEnabled&&o.gameManager.trialsManager.apply?a.loot*o.gameManager.trialsManager.activeFavor("fh","wealth"):0))),t.R7$(2),t.SpI(" (",a.progress.gold+(o.success&&o.rewards&&o.rewards.gold?o.rewards.gold:0)+(o.collectiveGold[n]?o.collectiveGold[n]:0)+a.loot*o.gameManager.levelManager.loot()+(o.gameManager.trialsManager.favorsEnabled&&o.gameManager.trialsManager.apply?a.loot*o.gameManager.trialsManager.activeFavor("fh","wealth"):0),") ")}}function BM(i,r){if(1&i&&(t.j41(0,"span")(1,"span"),t.EFF(2,"/"),t.k0s(),t.EFF(3),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(3),t.SpI(" (",e.progress.gold,") ")}}function YM(i,r){if(1&i&&(t.nVh(0,XM,5,4,"span"),t.nVh(1,BM,4,1,"span")),2&i){const e=r.$implicit;t.vxM(e.absent?-1:0),t.R7$(),t.vxM(e.absent?1:-1)}}function NM(i,r){if(1&i&&(t.j41(0,"span")(1,"span",32),t.EFF(2),t.nI1(3,"ghsValueSign"),t.k0s(),t.EFF(4),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG().$implicit,n=t.XpG(2);t.R7$(2),t.JRh(t.bMT(3,2,n.lootValue(e,a))),t.R7$(2),t.SpI(" (",(e.progress.loot[a]||0)+n.lootValue(e,a),") ")}}function zM(i,r){if(1&i&&(t.j41(0,"span")(1,"span",32),t.EFF(2,"/"),t.k0s(),t.EFF(3),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG().$implicit;t.R7$(3),t.SpI(" (",e.progress.loot[a]||0,") ")}}function LM(i,r){if(1&i&&(t.nVh(0,NM,5,4,"span"),t.nVh(1,zM,4,1,"span")),2&i){const e=r.$implicit;t.vxM(e.absent?-1:0),t.R7$(),t.vxM(e.absent?1:-1)}}function UM(i,r){if(1&i&&(t.j41(0,"span",21),t.nrm(1,"img",31),t.EFF(2),t.k0s(),t.Z7z(3,LM,2,2,null,null,$t)),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+e+".svg",t.B4B),t.R7$(),t.Lme(" ",n.lootColumnsLooted[a],"/",n.lootColumnsTotal[a]," "),t.R7$(),t.Dyx(n.characters)}}function qM(i,r){if(1&i&&(t.j41(0,"span",20),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.SpI(" ",t.bMT(2,1,e.experience)," ")}}function HM(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&i){const e=t.XpG(4);t.R7$(),t.JRh(t.bMT(2,1,e.gameManager.levelManager.experience()))}}function KM(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"/"),t.k0s())}function WM(i,r){if(1&i&&(t.j41(0,"span",20),t.nVh(1,HM,3,3,"span"),t.nVh(2,KM,2,0,"span"),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.vxM(e.absent?-1:1),t.R7$(),t.vxM(e.absent?2:-1)}}function JM(i,r){if(1&i&&(t.j41(0,"span",20),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&i){const e=t.XpG(4);t.R7$(),t.SpI(" ",t.bMT(2,1,e.rewards.experience)," ")}}function ZM(i,r){if(1&i&&(t.j41(0,"span",19),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,JM,3,3,"span",20,$t)),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.summary.rewards.experience"),t.R7$(),t.Dyx(e.characters)}}function QM(i,r){if(1&i&&(t.j41(0,"span",19),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,WM,3,2,"span",20,$t),t.nVh(4,ZM,4,1)),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.summary.xpBonus"),t.R7$(),t.Dyx(e.characters),t.R7$(2),t.vxM(e.success&&e.rewards&&e.rewards.experience?4:-1)}}function t1(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&i){const e=t.XpG(4);t.R7$(),t.JRh(t.bMT(2,1,2*e.challenges))}}function e1(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"/"),t.k0s())}function n1(i,r){if(1&i&&(t.j41(0,"span",20),t.nVh(1,t1,3,3,"span"),t.nVh(2,e1,2,0,"span"),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.vxM(e.absent?-1:1),t.R7$(),t.vxM(e.absent?2:-1)}}function i1(i,r){if(1&i&&(t.j41(0,"span",19),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,n1,3,2,"span",20,$t)),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.summary.xpChallenges"),t.R7$(),t.Dyx(e.characters)}}function a1(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.SpI("\xa0(",e.gameManager.trialsManager.activeFavor("fh","knowledge"),"x)")}}function o1(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"+3"),t.k0s())}function s1(i,r){if(1&i&&(t.EFF(0," \xa0 "),t.j41(1,"span"),t.EFF(2,"("),t.k0s(),t.Z7z(3,o1,2,0,"span",null,t.fX1),t.nI1(5,"ghsRange"),t.j41(6,"span"),t.EFF(7,")"),t.k0s()),2&i){const e=t.XpG(5);t.R7$(3),t.Dyx(t.i5U(5,0,t.lJ4(3,Ht),e.gameManager.trialsManager.activeFavor("fh","knowledge")))}}function r1(i,r){if(1&i&&(t.j41(0,"span",33),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s(),t.nVh(3,s1,8,4)),2&i){const e=t.XpG(4);t.R7$(),t.JRh(t.bMT(2,2,3*e.gameManager.trialsManager.activeFavor("fh","knowledge"))),t.R7$(2),t.vxM(e.gameManager.trialsManager.activeFavor("fh","knowledge")>1?3:-1)}}function c1(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function l1(i,r){if(1&i&&(t.j41(0,"span",20),t.nVh(1,r1,4,4),t.nVh(2,c1,2,0,"span"),t.k0s()),2&i){const e=r.$index,a=t.XpG(3);t.R7$(),t.vxM(a.battleGoals[e]?1:-1),t.R7$(),t.vxM(a.battleGoals[e]?-1:2)}}function g1(i,r){if(1&i&&(t.j41(0,"span",19),t.nrm(1,"span",28),t.nVh(2,a1,2,1,"span"),t.k0s(),t.Z7z(3,l1,3,2,"span",20,$t)),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","data.favors.fh.knowledge.reward")("ghs-tooltip","data.favors.fh.knowledge.text"),t.R7$(),t.vxM(e.gameManager.trialsManager.activeFavor("fh","knowledge")>1?2:-1),t.R7$(),t.Dyx(e.characters)}}function d1(i,r){if(1&i&&(t.j41(0,"span",33),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&i){const e=t.XpG(2).$implicit,a=t.XpG(2);t.R7$(),t.JRh(t.bMT(2,1,(a.rewards&&a.rewards.experience?a.rewards.experience:0)+2*a.challenges+e.experience+(a.rewards&&a.rewards.ignoredBonus&&-1!=a.rewards.ignoredBonus.indexOf("experience")?0:a.gameManager.levelManager.experience())))}}function h1(i,r){if(1&i&&(t.j41(0,"span",33),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&i){const e=t.XpG(2).$implicit;t.R7$(),t.JRh(t.bMT(2,1,e.experience))}}function _1(i,r){if(1&i&&(t.j41(0,"span",34),t.nrm(1,"img",35),t.k0s()),2&i){const e=t.XpG(2).$implicit;t.Y8G("ghs-tooltip","scenario.summary.levelUp")("ghs-label-args",t.l_i(2,se,e.level,e.level+1))}}function m1(i,r){if(1&i&&(t.j41(0,"span"),t.nVh(1,d1,3,3,"span",33),t.nVh(2,h1,3,3,"span",33),t.EFF(3),t.nVh(4,_1,2,5,"span",34),t.k0s()),2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG(2);t.R7$(),t.vxM(o.success?1:-1),t.R7$(),t.vxM(o.success?-1:2),t.R7$(),t.SpI(" (",a.progress.experience+2*o.challenges+a.experience+(o.success&&o.rewards&&o.rewards.experience?o.rewards.experience:0)+(!o.success||o.rewards&&o.rewards.ignoredBonus&&-1!=o.rewards.ignoredBonus.indexOf("experience")?0:o.gameManager.levelManager.experience())+(o.gameManager.trialsManager.favorsEnabled&&o.gameManager.trialsManager.apply&&o.battleGoals[n]?3*o.gameManager.trialsManager.activeFavor("fh","knowledge"):0),") "),t.R7$(),t.vxM(o.levelUp[n]?4:-1)}}function p1(i,r){if(1&i&&(t.j41(0,"span")(1,"span",33),t.EFF(2,"/"),t.k0s(),t.EFF(3),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(3),t.SpI(" (",e.progress.experience,") ")}}function u1(i,r){if(1&i&&(t.nVh(0,m1,5,4,"span"),t.nVh(1,p1,4,1,"span")),2&i){const e=r.$implicit;t.vxM(e.absent?-1:0),t.R7$(),t.vxM(e.absent?1:-1)}}function f1(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function C1(i,r){if(1&i&&(t.j41(0,"span"),t.nVh(1,f1,2,0,"span"),t.EFF(2),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.vxM(!(""+e).startsWith("G")&&+(""+e).split(":")[0]<10?1:-1),t.R7$(),t.SpI(" ",(""+e).startsWith("G-")?"G":(""+e).split(":")[0])}}function M1(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"??? "),t.k0s())}function v1(i,r){if(1&i&&t.nrm(0,"ghs-treasure-label",40),2&i){const e=t.XpG().$implicit,a=t.XpG(4);t.Y8G("edition",a.scenario.edition)("index",+(""+e).split(":")[0]-1)("rewardResults",a.gameManager.scenarioManager.treasureRewardsFromString(""+e))}}function O1(i,r){if(1&i&&(t.j41(0,"div",37)(1,"span",38),t.nVh(2,C1,3,2,"span"),t.nVh(3,M1,2,0,"span"),t.k0s(),t.j41(4,"span",39),t.nVh(5,v1,1,3,"ghs-treasure-label",40),t.k0s()()),2&i){const e=r.$implicit;t.R7$(2),t.vxM((""+e).startsWith("G")||+(""+e).split(":")[0]>=0?2:-1),t.R7$(),t.vxM(!(""+e).startsWith("G")&&+(""+e).split(":")[0]<0?3:-1),t.R7$(2),t.vxM((""+e).startsWith("G-")?-1:5)}}function P1(i,r){if(1&i&&(t.j41(0,"span",36),t.Z7z(1,O1,6,3,"div",37,t.fX1),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.Dyx(e.treasures||t.lJ4(0,Ht))}}function b1(i,r){if(1&i&&(t.j41(0,"span",21),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,P1,3,1,"span",36,$t)),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.summary.treasures"),t.R7$(),t.Dyx(e.characters)}}function k1(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-item",45),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2).$implicit,o=t.XpG(2);return t.Njj(o.openItemDialog(n))}),t.k0s()}if(2&i){const e=t.XpG(2).$implicit;t.Y8G("item",e)("flipped",!0)}}function y1(i,r){if(1&i){const e=t.RV6();t.j41(0,"span"),t.nVh(1,k1,1,2,"ghs-item",43),t.j41(2,"input",44),t.bIt("change",function(n){const o=t.eBV(e).$index,g=t.XpG().$index,_=t.XpG(2);return t.Njj(_.toggleItem(n,o,g))}),t.k0s()()}if(2&i){const e=r.$index,a=t.XpG().$index,n=t.XpG(2);t.R7$(),t.vxM(n.items[e]&&-1!=n.items[e].indexOf(a)?1:-1),t.R7$(),t.Y8G("disabled",n.itemDistributed(e,a))("checked",n.items[e]&&-1!=n.items[e].indexOf(a))}}function x1(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",41),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.openItemDialog(n))}),t.nrm(1,"span",42),t.k0s(),t.Z7z(2,y1,3,3,"span",null,$t)}if(2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.summary.item")("ghs-label-args",t.eq3(2,Mt,e.name)),t.R7$(),t.Dyx(a.characters)}}function E1(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-item",45),t.bIt("click",function(){t.eBV(e);const n=t.XpG(4);return t.Njj(n.openItemDialog(n.randomItem))}),t.k0s()}if(2&i){const e=t.XpG(4);t.Y8G("item",e.randomItem)("flipped",!0)}}function w1(i,r){if(1&i){const e=t.RV6();t.j41(0,"span"),t.nVh(1,E1,1,2,"ghs-item",43),t.j41(2,"input",44),t.bIt("change",function(n){const o=t.eBV(e).$index,g=t.XpG(3);return t.Njj(g.toggleRandomItem(n,o))}),t.k0s()()}if(2&i){const e=r.$index,a=t.XpG(3);t.R7$(),t.vxM(a.randomItemIndex==e?1:-1),t.R7$(),t.Y8G("disabled",a.randomItemIndex>-1&&a.randomItemIndex!=e)("checked",a.randomItemIndex==e)}}function R1(i,r){if(1&i&&(t.j41(0,"span",21),t.nrm(1,"span",42),t.k0s(),t.Z7z(2,w1,3,3,"span",null,$t)),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.summary.randomItem")("ghs-label-args",t.eq3(2,Mt,e.randomItem.name)),t.R7$(),t.Dyx(e.characters)}}function j1(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-item",45),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(3);return t.Njj(o.openItemDialog(n))}),t.k0s()}if(2&i){const e=t.XpG().$implicit;t.Y8G("item",e)("flipped",!0)}}function G1(i,r){if(1&i&&(t.j41(0,"span"),t.nVh(1,j1,1,2,"ghs-item",43),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.vxM(e?1:-1)}}function T1(i,r){if(1&i&&(t.j41(0,"span",21),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,G1,2,1,"span",null,_M)),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.summary.randomItems"),t.R7$(),t.Dyx(e.randomItems)}}function S1(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",52),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(3);return t.Njj(o.openBattleGoals(n))}),t.nrm(1,"ghs-battlegoal",53),t.k0s()}if(2&i){const e=t.XpG().$implicit;t.R7$(),t.Y8G("identifier",e.battleGoal&&e.battleGoals[0])("flipped",e.battleGoal)}}function $1(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",52),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2).$implicit,o=t.XpG(3);return t.Njj(o.openBattleGoals(n))}),t.nrm(1,"ghs-battlegoal",53),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2).$implicit;t.R7$(),t.Y8G("identifier",e)("flipped",a.battleGoal)}}function D1(i,r){if(1&i&&(t.j41(0,"div",48),t.Z7z(1,$1,2,2,"span",47,$t),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.Dyx(e.battleGoals)}}function I1(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",52),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2).$implicit,o=t.XpG(3);return t.Njj(o.openBattleGoals(n))}),t.nrm(1,"ghs-battlegoal",53),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2).$implicit;t.R7$(),t.Y8G("identifier",e)("flipped",a.battleGoal)}}function A1(i,r){if(1&i&&(t.j41(0,"div",48),t.Z7z(1,I1,2,2,"span",47,$t),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.Dyx(e.battleGoals.slice(0,e.battleGoals.length-2))}}function V1(i,r){1&i&&t.nrm(0,"input",54),2&i&&t.Y8G("disabled",!0)("checked",!0)}function F1(i,r){if(1&i&&(t.Z7z(0,V1,1,2,"input",54,t.fX1),t.nI1(2,"ghsRange")),2&i){const e=t.XpG(4);t.Dyx(t.i5U(2,0,t.lJ4(3,Ht),e.rewards.battleGoals))}}function X1(i,r){if(1&i){const e=t.RV6();t.j41(0,"input",55),t.bIt("change",function(n){t.eBV(e);const o=t.XpG().$index,g=t.XpG(3);return t.Njj(g.toggleBattleGoal(n,o,2))}),t.k0s()}if(2&i){const e=t.XpG().$index,a=t.XpG(3);t.Y8G("checked",a.battleGoals[e]>1)}}function B1(i,r){if(1&i){const e=t.RV6();t.j41(0,"input",55),t.bIt("change",function(n){const o=t.eBV(e).$implicit,g=t.XpG(2).$index,_=t.XpG(3);return t.Njj(_.toggleBattleGoal(n,g,3+o))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2).$index,n=t.XpG(3);t.Y8G("checked",n.battleGoals[a]>2+e)}}function Y1(i,r){if(1&i&&(t.Z7z(0,B1,1,1,"input",50,t.fX1),t.nI1(2,"ghsRange")),2&i){const e=t.XpG().$index,a=t.XpG(3);t.Dyx(t.i5U(2,0,t.lJ4(3,Ht),a.battleGoals[e]-1))}}function N1(i,r){1&i&&(t.j41(0,"span",51),t.nrm(1,"img",35),t.k0s()),2&i&&t.Y8G("ghs-tooltip","scenario.summary.perksUp")}function z1(i,r){if(1&i){const e=t.RV6();t.j41(0,"span")(1,"span",46),t.nVh(2,S1,2,2,"span",47),t.nVh(3,D1,3,0,"div",48),t.nVh(4,A1,3,0,"div",48),t.j41(5,"span",49),t.nVh(6,F1,3,4),t.j41(7,"input",44),t.bIt("change",function(n){const o=t.eBV(e).$index,g=t.XpG(3);return t.Njj(g.toggleBattleGoal(n,o,1))}),t.k0s(),t.nVh(8,X1,1,1,"input",50),t.nVh(9,Y1,3,4),t.k0s(),t.nVh(10,N1,2,1,"span",51),t.k0s()()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.R7$(2),t.vxM(n.settingsManager.settings.battleGoals&&e.battleGoal&&e.battleGoals.length>0&&e!=n.trial349&&e!=n.trial356?2:-1),t.R7$(),t.vxM(n.settingsManager.settings.battleGoals&&e.battleGoal&&e.battleGoals.length>0&&e==n.trial349?3:-1),t.R7$(),t.vxM(n.settingsManager.settings.battleGoals&&e.battleGoal&&e.battleGoals.length>2&&e==n.trial356?4:-1),t.R7$(2),t.vxM(n.rewards&&n.rewards.battleGoals?6:-1),t.R7$(),t.Y8G("disabled",e.absent)("checked",!e.absent&&n.battleGoals[a]>0),t.R7$(),t.vxM(!e.absent&&n.battleGoals[a]>0?8:-1),t.R7$(),t.vxM(!e.absent&&e==n.trial349&&n.battleGoals[a]>1?9:-1),t.R7$(),t.vxM(n.perksUp[a]?10:-1)}}function L1(i,r){if(1&i&&(t.j41(0,"span",21),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,z1,11,9,"span",null,$t)),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","game.battleGoals"),t.R7$(),t.Dyx(e.characters)}}function U1(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",59),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(3);return t.Njj(o.openTrial(n))}),t.nrm(1,"img",60),t.k0s()}}function q1(i,r){if(1&i){const e=t.RV6();t.j41(0,"span")(1,"span",56),t.nVh(2,U1,2,0,"span",57),t.j41(3,"span",58)(4,"input",44),t.bIt("change",function(n){const o=t.eBV(e).$index,g=t.XpG(3);return t.Njj(g.toggleTrial(n,o))}),t.k0s()(),t.nrm(5,"span",57),t.k0s()()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.R7$(2),t.vxM(e.progress.trial?2:-1),t.R7$(2),t.Y8G("disabled",e.absent)("checked",!e.absent&&n.trials[a])}}function H1(i,r){if(1&i&&(t.j41(0,"span",21),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,q1,6,3,"span",null,$t)),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","character.progress.trial"),t.R7$(),t.Dyx(e.characters)}}function K1(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",61),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.stats=!n.stats)}),t.k0s(),t.nrm(1,"span",62)}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","scenario.stats.toggle."+(e.stats?"hide":"show")),t.R7$(),t.xc7("grid-column","span "+(e.characters.length-1))}}function W1(i,r){if(1&i&&(t.j41(0,"span",63),t.nrm(1,"span",64)(2,"span",64)(3,"span",64),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.dealtDamage")("ghs-label-args",t.eq3(15,Mt,e.scenarioStats.dealtDamage))("ghs-tooltip","scenario.stats.dealtDamage.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.monsterDamage")("ghs-label-args",t.eq3(17,Mt,e.scenarioStats.monsterDamage))("ghs-tooltip","scenario.stats.monsterDamage.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.otherDamage")("ghs-label-args",t.eq3(19,Mt,e.scenarioStats.otherDamage))("ghs-tooltip","scenario.stats.otherDamage.hint")}}function J1(i,r){if(1&i&&(t.j41(0,"span",63),t.nrm(1,"span",64)(2,"span",64),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.heals")("ghs-label-args",t.eq3(10,Mt,e.scenarioStats.heals))("ghs-tooltip","scenario.stats.heals.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.healedDamage")("ghs-label-args",t.eq3(12,Mt,e.scenarioStats.healedDamage))("ghs-tooltip","scenario.stats.healedDamage.hint")}}function Z1(i,r){if(1&i&&t.nrm(0,"span",64),2&i){const e=t.XpG().$implicit;t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.normalKills")("ghs-label-args",t.eq3(5,Mt,e.scenarioStats.normalKills))("ghs-tooltip","scenario.stats.normalKills.hint")}}function Q1(i,r){if(1&i&&t.nrm(0,"span",64),2&i){const e=t.XpG().$implicit;t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.eliteKills")("ghs-label-args",t.eq3(5,Mt,e.scenarioStats.eliteKills))("ghs-tooltip","scenario.stats.eliteKills.hint")}}function tv(i,r){if(1&i&&t.nrm(0,"span",64),2&i){const e=t.XpG().$implicit;t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.bossKills")("ghs-label-args",t.eq3(5,Mt,e.scenarioStats.bossKills))("ghs-tooltip","scenario.stats.bossKills.hint")}}function ev(i,r){if(1&i&&(t.j41(0,"span",63),t.nVh(1,Z1,1,7,"span",65),t.nVh(2,Q1,1,7,"span",65),t.nVh(3,tv,1,7,"span",65),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.vxM(e.scenarioStats.normalKills?1:-1),t.R7$(),t.vxM(e.scenarioStats.eliteKills?2:-1),t.R7$(),t.vxM(e.scenarioStats.bossKills?3:-1)}}function nv(i,r){if(1&i&&(t.j41(0,"span",63),t.nrm(1,"span",64)(2,"span",64),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.maxDealtDamage")("ghs-label-args",t.eq3(10,Mt,e.scenarioStats.maxDealtDamage))("ghs-tooltip","scenario.stats.maxDealtDamage.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.maxDamage")("ghs-label-args",t.eq3(12,Mt,e.scenarioStats.maxDamage))("ghs-tooltip","scenario.stats.maxDamage.hint")}}function iv(i,r){if(1&i&&(t.j41(0,"span",21),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,W1,4,21,"span",63,$t),t.j41(4,"span",21),t.nrm(5,"span",3),t.k0s(),t.Z7z(6,J1,3,14,"span",63,$t),t.j41(8,"span",21),t.nrm(9,"span",3),t.k0s(),t.Z7z(10,ev,4,3,"span",63,$t),t.j41(12,"span",21),t.nrm(13,"span",3),t.k0s(),t.Z7z(14,nv,3,14,"span",63,$t)),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.stats.damage"),t.R7$(),t.Dyx(e.characters),t.R7$(3),t.Y8G("ghs-label","scenario.stats.heal"),t.R7$(),t.Dyx(e.characters),t.R7$(3),t.Y8G("ghs-label","scenario.stats.kills"),t.R7$(),t.Dyx(e.characters),t.R7$(3),t.Y8G("ghs-label","scenario.stats.max"),t.R7$(),t.Dyx(e.characters)}}function av(i,r){if(1&i&&(t.j41(0,"div",16)(1,"span",17),t.nrm(2,"span",3),t.k0s(),t.Z7z(3,vM,6,11,"span",18,$t),t.j41(5,"span",19),t.nrm(6,"span",3),t.k0s(),t.Z7z(7,bM,3,2,"span",20,$t),t.nVh(9,yM,4,1),t.nVh(10,EM,4,1),t.nVh(11,jM,2,0),t.nVh(12,AM,5,3),t.j41(13,"span",21),t.nVh(14,VM,1,1,"span",3),t.nVh(15,FM,2,2),t.k0s(),t.Z7z(16,YM,2,2,null,null,$t),t.Z7z(18,UM,5,3,null,null,t.fX1),t.j41(20,"span",19),t.nrm(21,"span",3),t.k0s(),t.Z7z(22,qM,3,3,"span",20,$t),t.nVh(24,QM,5,2),t.nVh(25,i1,4,1),t.nVh(26,g1,5,3),t.j41(27,"span",21),t.nrm(28,"span",3),t.k0s(),t.Z7z(29,u1,2,2,null,null,$t),t.nVh(31,b1,4,1),t.Z7z(32,x1,4,4,null,null,hM),t.nVh(34,R1,4,4),t.nVh(35,T1,4,1),t.nVh(36,L1,4,1),t.nVh(37,H1,4,1),t.nVh(38,K1,2,3),t.nVh(39,iv,16,4),t.k0s()),2&i){const e=t.XpG();t.xc7("--ghs-summary-columns",1+e.characters.length),t.R7$(2),t.Y8G("ghs-label","scenario.summary.name"),t.R7$(),t.Dyx(e.characters),t.R7$(3),t.Y8G("ghs-label","scenario.summary.loot"),t.R7$(),t.Dyx(e.characters),t.R7$(2),t.vxM(e.success&&e.rewards&&e.rewards.gold?9:-1),t.R7$(),t.vxM(e.success&&e.rewards&&e.rewards.collectiveGold?10:-1),t.R7$(),t.vxM(e.success&&e.rewards&&e.rewards.collectiveResources?11:-1),t.R7$(),t.vxM(e.success&&e.gameManager.trialsManager.favorsEnabled&&e.gameManager.trialsManager.apply&&e.gameManager.trialsManager.activeFavor("fh","wealth")?12:-1),t.R7$(2),t.vxM(e.totalGold?-1:14),t.R7$(),t.vxM(e.totalGold?15:-1),t.R7$(),t.Dyx(e.characters),t.R7$(2),t.Dyx(e.lootColumns),t.R7$(3),t.Y8G("ghs-label","scenario.summary.xpGained"),t.R7$(),t.Dyx(e.characters),t.R7$(2),t.vxM(!e.success||e.rewards&&e.rewards.ignoredBonus&&-1!=e.rewards.ignoredBonus.indexOf("experience")?-1:24),t.R7$(),t.vxM(e.success&&e.challenges>0?25:-1),t.R7$(),t.vxM(e.success&&e.gameManager.trialsManager.favorsEnabled&&e.gameManager.trialsManager.apply&&e.gameManager.trialsManager.activeFavor("fh","knowledge")?26:-1),t.R7$(2),t.Y8G("ghs-label","scenario.summary.xp"),t.R7$(),t.Dyx(e.characters),t.R7$(2),t.vxM(e.gameManager.scenarioManager.getTreasures(e.scenario,e.gameManager.game.sections).length>0?31:-1),t.R7$(),t.Dyx(e.rewardItems),t.R7$(2),t.vxM(e.randomItem?34:-1),t.R7$(),t.vxM(e.randomItems&&e.randomItems.length>0?35:-1),t.R7$(),t.vxM(e.success?36:-1),t.R7$(),t.vxM(e.success&&e.gameManager.trialsManager.trialsEnabled?37:-1),t.R7$(),t.vxM(e.settingsManager.settings.scenarioStats?38:-1),t.R7$(),t.vxM(e.stats?39:-1)}}function ov(i,r){1&i&&(t.j41(0,"div",67)(1,"span"),t.nrm(2,"span",3),t.k0s()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","scenario.summary.alreadyWarning.hint"))}function sv(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",13)(1,"label"),t.nrm(2,"span",3),t.k0s(),t.j41(3,"div",66),t.nVh(4,ov,3,1,"div",67),t.j41(5,"div",67)(6,"a",68),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.updateState(!n.forceCampaign))}),t.nrm(7,"span",3),t.k0s()()()()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","scenario.summary.alreadyWarning"),t.R7$(2),t.vxM(e.forceCampaign?-1:4),t.R7$(3),t.Y8G("ghs-label","scenario.summary.alreadyWarning."+(e.forceCampaign?"reapply":"ignore"))}}function rv(i,r){1&i&&(t.j41(0,"div",67)(1,"span"),t.nrm(2,"span",3),t.k0s()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","scenario.summary.casualWarning.hintFh"))}function cv(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",67)(1,"a",68),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return n.characterProgress=!n.gameManager.fhRules()||!n.characterProgress,t.Njj(n.updateState())}),t.nrm(2,"span",3),t.k0s()()}if(2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","scenario.summary.casualWarning."+(e.characterProgress||e.forceCampaign?"reapply":"ignore"))}}function lv(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",67)(1,"a",68),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.updateState(!0))}),t.nrm(2,"span",3),t.k0s()()}2&i&&(t.R7$(2),t.Y8G("ghs-label","scenario.summary.casualWarning.campaignRewards"))}function gv(i,r){if(1&i&&(t.j41(0,"div",13)(1,"label"),t.nrm(2,"span",3),t.k0s(),t.j41(3,"div",66),t.nVh(4,rv,3,1,"div",67),t.nVh(5,cv,3,1,"div",67),t.nVh(6,lv,3,1,"div",67),t.k0s()()),2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","scenario.summary.casualWarning"+(e.gameManager.fhRules()?".fh":"")),t.R7$(2),t.vxM(!e.characterProgress&&e.gameManager.fhRules()?4:-1),t.R7$(),t.vxM(e.forceCampaign||e.gameManager.fhRules()?5:-1),t.R7$(),t.vxM(e.forceCampaign?-1:6)}}function dv(i,r){1&i&&(t.j41(0,"div",13)(1,"label"),t.nrm(2,"span",3),t.k0s(),t.j41(3,"div",66)(4,"div",67),t.nrm(5,"span",71),t.k0s()()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","scenario.summary.conclusionWarning"),t.R7$(3),t.Y8G("ghs-label","scenario.summary.conclusionWarning.hint"))}function hv(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function _v(i,r){if(1&i&&(t.j41(0,"div",72),t.nrm(1,"span",3)(2,"span",3),t.nVh(3,hv,2,0,"span"),t.k0s()),2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG(4);t.R7$(),t.Y8G("ghs-label",o.gameManager.scenarioManager.scenarioTitle(o.gameManager.scenarioManager.getScenario(a,o.scenario.edition,o.scenario.group))),t.R7$(),t.Y8G("ghs-label","%data.scenarioNumber:"+a+"%"),t.R7$(),t.vxM(o.scenario.unlocks.length>1&&n<o.scenario.unlocks.length-1?3:-1)}}function mv(i,r){if(1&i&&t.nVh(0,_v,4,3,"div",72),2&i){const e=r.$implicit,a=t.XpG(4);t.vxM(a.gameManager.scenarioManager.getScenario(e,a.scenario.edition,a.scenario.group)?0:-1)}}function pv(i,r){if(1&i&&(t.j41(0,"div",66),t.Z7z(1,mv,1,1,null,null,t.fX1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.scenario.unlocks)}}function uv(i,r){if(1&i){const e=t.RV6();t.j41(0,"label",73)(1,"input",74),t.bIt("change",function(){const n=t.eBV(e).$implicit,o=t.XpG(4);return t.Njj(o.selectLocation(n))}),t.k0s(),t.nrm(2,"span",3)(3,"span",3),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(4);t.R7$(),t.Y8G("value",e)("checked",a.chooseLocation==e),t.R7$(),t.Y8G("ghs-label",a.gameManager.scenarioManager.scenarioTitle(a.gameManager.scenarioManager.getScenario(e,a.scenario.edition,a.scenario.group))),t.R7$(),t.Y8G("ghs-label","%data.scenarioNumber:"+e+"%")}}function fv(i,r){if(1&i&&(t.j41(0,"div",66)(1,"div",67),t.nrm(2,"span",3),t.EFF(3,":"),t.k0s(),t.Z7z(4,uv,4,4,"label",73,t.fX1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.chooseLocation"),t.R7$(2),t.Dyx(e.rewards.chooseLocation)}}function Cv(i,r){if(1&i&&(t.j41(0,"div",69)(1,"label"),t.nrm(2,"span",3),t.k0s(),t.nVh(3,pv,3,0,"div",66),t.nVh(4,fv,6,1,"div",66),t.k0s()),2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label",e.scenario.unlocks&&e.scenario.unlocks.length>1||e.rewards&&e.rewards.chooseLocation&&e.rewards.chooseLocation.length>1?"scenario.rewards.locations":"scenario.rewards.location"),t.R7$(),t.vxM(e.scenario.unlocks?3:-1),t.R7$(),t.vxM(e.rewards&&e.rewards.chooseLocation&&e.rewards.chooseLocation.length?4:-1)}}function Mv(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function vv(i,r){if(1&i&&(t.j41(0,"div",72),t.nrm(1,"span",3)(2,"span",3),t.nVh(3,Mv,2,0,"span"),t.k0s()),2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG(3);t.R7$(),t.Y8G("ghs-label",o.gameManager.scenarioManager.scenarioTitle(o.gameManager.scenarioManager.getScenario(a,o.scenario.edition,o.scenario.group))),t.R7$(),t.Y8G("ghs-label","%data.scenarioNumber:"+a+"%"),t.R7$(),t.vxM(o.conclusion.unlocks.length>1&&n<o.conclusion.unlocks.length-1?3:-1)}}function Ov(i,r){if(1&i&&t.nVh(0,vv,4,3,"div",72),2&i){const e=r.$implicit,a=t.XpG(3);t.vxM(a.gameManager.scenarioManager.getScenario(e,a.conclusion.edition,a.conclusion.group)?0:-1)}}function Pv(i,r){if(1&i&&(t.j41(0,"div",69)(1,"label"),t.nrm(2,"span",3),t.k0s(),t.j41(3,"div",66),t.Z7z(4,Ov,1,1,null,null,t.fX1),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label",e.conclusion.unlocks.length>1?"scenario.rewards.locations":"scenario.rewards.location"),t.R7$(2),t.Dyx(e.conclusion.unlocks)}}function bv(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG().$index,a=t.XpG(3);t.Y8G("ghs-label",a.rewards.hints.globalAchievements[e])}}function kv(i,r){if(1&i&&(t.j41(0,"div",75)(1,"span"),t.nrm(2,"span",3),t.k0s(),t.nVh(3,bv,1,1,"span",76),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","data.globalAchievements."+e),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.globalAchievements&&n.rewards.hints.globalAchievements[a]?3:-1)}}function yv(i,r){if(1&i&&(t.j41(0,"div",70)(1,"label"),t.nrm(2,"span",3),t.EFF(3,":"),t.k0s(),t.j41(4,"div",66),t.Z7z(5,kv,4,2,"div",75,t.fX1),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.globalAchievements"),t.R7$(3),t.Dyx(e.rewards.globalAchievements)}}function xv(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG().$index,a=t.XpG(3);t.Y8G("ghs-label",a.rewards.hints.lostPartyAchievements[e])}}function Ev(i,r){if(1&i&&(t.j41(0,"div",75)(1,"span"),t.nrm(2,"span",3),t.k0s(),t.nVh(3,xv,1,1,"span",76),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","data.partyAchievements."+e),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.lostPartyAchievements&&n.rewards.hints.lostPartyAchievements[a]?3:-1)}}function wv(i,r){if(1&i&&(t.j41(0,"div",70)(1,"label"),t.nrm(2,"span",3),t.EFF(3,":"),t.k0s(),t.j41(4,"div",66),t.Z7z(5,Ev,4,2,"div",75,t.fX1),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.lostPartyAchievements"),t.R7$(3),t.Dyx(e.rewards.lostPartyAchievements)}}function Rv(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG().$index,a=t.XpG(3);t.Y8G("ghs-label",a.rewards.hints.partyAchievements[e])}}function jv(i,r){if(1&i&&(t.j41(0,"div",75)(1,"span"),t.nrm(2,"span",3),t.k0s(),t.nVh(3,Rv,1,1,"span",76),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","data.partyAchievements."+e),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.partyAchievements&&n.rewards.hints.partyAchievements[a]?3:-1)}}function Gv(i,r){if(1&i&&(t.j41(0,"div",70)(1,"label"),t.nrm(2,"span",3),t.EFF(3,":"),t.k0s(),t.j41(4,"div",66),t.Z7z(5,jv,4,2,"div",75,t.fX1),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.partyAchievements"),t.R7$(3),t.Dyx(e.rewards.partyAchievements)}}function Tv(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG().$index,a=t.XpG(3);t.Y8G("ghs-label",a.rewards.hints.campaignSticker[e])}}function Sv(i,r){if(1&i&&(t.j41(0,"div",75)(1,"span"),t.nrm(2,"span",3),t.k0s(),t.nVh(3,Tv,1,1,"span",76),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","data.campaignSticker."+e),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.campaignSticker&&n.rewards.hints.campaignSticker[a]?3:-1)}}function $v(i,r){if(1&i&&(t.j41(0,"div",70)(1,"label"),t.nrm(2,"span",3),t.EFF(3,":"),t.k0s(),t.j41(4,"div",66),t.Z7z(5,Sv,4,2,"div",75,t.fX1),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.campaignSticker"),t.R7$(3),t.Dyx(e.rewards.campaignSticker)}}function Dv(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG().$index,a=t.XpG(3);t.Y8G("ghs-label",a.rewards.hints.calendarSection[e])}}function Iv(i,r){if(1&i&&(t.j41(0,"div",75),t.nrm(1,"span",77),t.nVh(2,Dv,1,1,"span",76),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.rewards.calendarSection.add"+(e.split("-")[1].split(":").length>1?".next":""))("ghs-label-args",t.sMw(3,Nn,e.split("-")[0],e.split("-")[1].split(":").length>1?e.split("-")[1].split(":")[1]:e.split("-")[1],e.split("-")[1].split(":").length>1?e.split("-")[1].split(":")[0]:"")),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.calendarSection&&n.rewards.hints.calendarSection[a]?2:-1)}}function Av(i,r){if(1&i&&(t.j41(0,"div",70)(1,"label"),t.nrm(2,"span",3),t.EFF(3,":"),t.k0s(),t.j41(4,"div",66),t.Z7z(5,Iv,3,7,"div",75,t.fX1),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.calendarSection"),t.R7$(3),t.Dyx(e.rewards.calendarSection)}}function Vv(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",75),t.nrm(1,"span",71),t.j41(2,"input",78),t.bIt("change",function(n){const o=t.eBV(e).$index,g=t.XpG(3);return t.Njj(g.changeCalendarSectionManual(n,o))}),t.k0s()()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.R7$(),t.Y8G("ghs-label",e.hint),t.R7$(),t.Y8G("value",n.calendarSectionManual[a]||-1)}}function Fv(i,r){if(1&i&&(t.j41(0,"div",70)(1,"label"),t.nrm(2,"span",3),t.EFF(3,":"),t.k0s(),t.j41(4,"div",66),t.Z7z(5,Vv,3,2,"div",75,t.fX1),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.calendarSection"),t.R7$(3),t.Dyx(e.rewards.calendarSectionManual)}}function Xv(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG().$index,a=t.XpG(3);t.Y8G("ghs-label",a.rewards.hints.envelopes[e])}}function Bv(i,r){if(1&i&&(t.j41(0,"div",79),t.nrm(1,"span",77),t.nVh(2,Xv,1,1,"span",76),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.rewards.envelope")("ghs-label-args",t.eq3(3,Mt,e)),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.envelopes&&n.rewards.hints.envelopes[a]?2:-1)}}function Yv(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG(4);t.Y8G("ghs-label",e.rewards.hints.gold)}}function Nv(i,r){if(1&i&&(t.j41(0,"div",80)(1,"span"),t.nrm(2,"span",42),t.k0s(),t.nVh(3,Yv,1,1,"span",76),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.gold")("ghs-label-args",t.eq3(3,Mt,""+e.rewards.gold)),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.gold?3:-1)}}function zv(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG(4);t.Y8G("ghs-label",e.rewards.hints.experience)}}function Lv(i,r){if(1&i&&(t.j41(0,"div",81)(1,"span"),t.nrm(2,"span",42),t.k0s(),t.nVh(3,zv,1,1,"span",76),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.experience")("ghs-label-args",t.eq3(3,Mt,""+e.rewards.experience)),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.experience?3:-1)}}function Uv(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG(4);t.Y8G("ghs-label",e.rewards.hints.collectiveGold)}}function qv(i,r){if(1&i&&(t.j41(0,"div",82)(1,"span"),t.nrm(2,"span",42),t.k0s(),t.nVh(3,Uv,1,1,"span",76),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.collectiveGold")("ghs-label-args",t.eq3(3,Mt,""+e.rewards.collectiveGold)),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.collectiveGold?3:-1)}}function Hv(i,r){if(1&i&&t.nrm(0,"span",77),2&i){const e=t.XpG().$implicit,a=t.XpG(4);t.Y8G("ghs-label","scenario.rewards.resources"+(a.EntityValueFunction(e.value)<0?"Lose":""))("ghs-label-args",t.l_i(2,se,e.type,""+a.EntityValueFunction(e.value)))}}function Kv(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG().$index,a=t.XpG(4);t.Y8G("ghs-label",a.rewards.hints.resources[e])}}function Wv(i,r){if(1&i&&(t.nVh(0,Hv,1,5,"span",77),t.nVh(1,Kv,1,1,"span",76)),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(4);t.vxM(e.value?0:-1),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.resources&&n.rewards.hints.resources[a]?1:-1)}}function Jv(i,r){if(1&i&&(t.j41(0,"div",83),t.Z7z(1,Wv,2,2,null,null,as),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.rewards.resources)}}function Zv(i,r){if(1&i&&t.nrm(0,"span",77),2&i){const e=t.XpG().$implicit,a=t.XpG(4);t.Y8G("ghs-label","scenario.rewards.collectiveResources"+(a.EntityValueFunction(e.value)<0?"Lose":""))("ghs-label-args",t.l_i(2,se,e.type,a.EntityValueFunction(e.value)))}}function Qv(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG().$index,a=t.XpG(4);t.Y8G("ghs-label",a.rewards.hints.resources[e])}}function tO(i,r){if(1&i&&(t.nVh(0,Zv,1,5,"span",77),t.nVh(1,Qv,1,1,"span",76)),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(4);t.vxM(e.value?0:-1),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.resources&&n.rewards.hints.resources[a]?1:-1)}}function eO(i,r){if(1&i&&(t.j41(0,"div",84),t.Z7z(1,tO,2,2,null,null,as),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.rewards.collectiveResources)}}function nO(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG(4);t.Y8G("ghs-label",e.rewards.hints.reputation)}}function iO(i,r){if(1&i&&(t.j41(0,"div",85)(1,"span"),t.nrm(2,"span",27),t.nI1(3,"ghsValueSign"),t.k0s(),t.nVh(4,nO,1,1,"span",76),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.reputation")("ghs-label-args",t.eq3(5,Mt,t.bMT(3,3,e.rewards.reputation))),t.R7$(2),t.vxM(e.rewards.hints&&e.rewards.hints.reputation?4:-1)}}function aO(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG().$index,a=t.XpG(4);t.Y8G("ghs-label",a.rewards.hints.reputationFactions[e])}}function oO(i,r){if(1&i&&(t.j41(0,"span"),t.nrm(1,"span",27),t.k0s(),t.nVh(2,aO,1,1,"span",76)),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(4);t.R7$(),t.Y8G("ghs-label","scenario.rewards.reputationFactions")("ghs-label-args",t.l_i(3,se,e.split(":")[0],e.split(":")[1])),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.reputationFactions[a]?2:-1)}}function sO(i,r){if(1&i&&(t.j41(0,"div",86),t.Z7z(1,oO,3,6,null,null,t.fX1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.rewards.reputationFactions)}}function rO(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG(4);t.Y8G("ghs-label",e.rewards.hints.prosperity)}}function cO(i,r){if(1&i&&(t.j41(0,"div",87)(1,"span"),t.nrm(2,"span",42),t.nI1(3,"ghsValueSign"),t.k0s(),t.nVh(4,rO,1,1,"span",76),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.prosperity")("ghs-label-args",t.eq3(5,Mt,""+t.bMT(3,3,e.rewards.prosperity))),t.R7$(2),t.vxM(e.rewards.hints&&e.rewards.hints.prosperity?4:-1)}}function lO(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG(4);t.Y8G("ghs-label",e.rewards.hints.inspiration)}}function gO(i,r){if(1&i&&(t.j41(0,"div",88)(1,"span"),t.nrm(2,"span",42),t.nI1(3,"ghsValueSign"),t.k0s(),t.nVh(4,lO,1,1,"span",76),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.inspiration")("ghs-label-args",t.eq3(5,Mt,t.bMT(3,3,e.EntityValueFunction(e.rewards.inspiration)))),t.R7$(2),t.vxM(e.rewards.hints&&e.rewards.hints.inspiration?4:-1)}}function dO(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG(4);t.Y8G("ghs-label",e.rewards.hints.morale)}}function hO(i,r){if(1&i&&(t.j41(0,"div",89)(1,"span"),t.nrm(2,"span",42),t.nI1(3,"ghsValueSign"),t.k0s(),t.nVh(4,dO,1,1,"span",76),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.morale")("ghs-label-args",t.eq3(5,Mt,t.bMT(3,3,e.EntityValueFunction(e.rewards.morale)))),t.R7$(2),t.vxM(e.rewards.hints&&e.rewards.hints.morale?4:-1)}}function _O(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG(4);t.Y8G("ghs-label",e.rewards.hints.perks)}}function mO(i,r){if(1&i&&(t.j41(0,"div",90)(1,"span"),t.nrm(2,"span",42),t.k0s(),t.nVh(3,_O,1,1,"span",76),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.perks")("ghs-label-args",t.eq3(3,Mt,""+e.rewards.perks)),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.perks?3:-1)}}function pO(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG(4);t.Y8G("ghs-label",e.rewards.hints.battleGoals)}}function uO(i,r){if(1&i&&(t.j41(0,"div",91),t.nrm(1,"span",77),t.nVh(2,pO,1,1,"span",76),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.rewards.battleGoals")("ghs-label-args",t.eq3(3,Mt,""+e.rewards.battleGoals)),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.battleGoals?2:-1)}}function fO(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",104),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(3);return t.Njj(o.openItemDialog(o.gameManager.itemManager.getItem(n.split(":")[0].split("-")[0],n.split(":")[0].split("-").slice(1).join("-")||o.scenario.edition||"",!0)))}),t.k0s()}if(2&i){let e;const a=t.XpG().$implicit,n=t.XpG(3);t.Y8G("ghs-label","scenario.rewards.items")("ghs-label-args",t.sMw(2,Nn,a.split(":")[0].split("-")[0],(null==(e=n.gameManager.itemManager.getItem(a.split(":")[0].split("-")[0],a.split(":")[0].split("-").slice(1).join("-")||n.scenario.edition||"",!0))?null:e.name)||"",a.split(":")[1]))}}function CO(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",104),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(3);return t.Njj(o.openItemDialog(o.gameManager.itemManager.getItem(n.split("-")[0],n.split("-").slice(1).join("-")||o.scenario.edition||"",!0)))}),t.k0s()}if(2&i){let e;const a=t.XpG().$implicit,n=t.XpG(3);t.Y8G("ghs-label","scenario.rewards.item")("ghs-label-args",t.l_i(2,se,a.split("-")[0],(null==(e=n.gameManager.itemManager.getItem(a.split("-")[0],a.split("-").slice(1).join("-")||n.scenario.edition||"",!0))?null:e.name)||""))}}function MO(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG().$index,a=t.XpG(3);t.Y8G("ghs-label",a.rewards.hints.items[e])}}function vO(i,r){if(1&i&&(t.j41(0,"div",92),t.nVh(1,fO,1,6,"span",77),t.nVh(2,CO,1,5,"span",77),t.nVh(3,MO,1,1,"span",76),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.R7$(),t.vxM(-1!=e.indexOf(":")?1:-1),t.R7$(),t.vxM(-1==e.indexOf(":")?2:-1),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.items&&n.rewards.hints.items[a]?3:-1)}}function OO(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",104),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(5);return t.Njj(o.openItemDialog(o.gameManager.itemManager.getItem(n.split(":")[0].split("-")[0],n.split(":")[0].split("-").slice(1).join("-")||o.scenario.edition||"",!0)))}),t.k0s()}if(2&i){let e;const a=t.XpG().$implicit,n=t.XpG(5);t.Y8G("ghs-label","scenario.rewards.items")("ghs-label-args",t.sMw(2,Nn,a.split(":")[0].split("-")[0],(null==(e=n.gameManager.itemManager.getItem(a.split(":")[0].split("-")[0],a.split(":")[0].split("-").slice(1).join("-")||n.scenario.edition||"",!0))?null:e.name)||"",a.split(":")[1]))}}function PO(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",104),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(5);return t.Njj(o.openItemDialog(o.gameManager.itemManager.getItem(n.split("-")[0],n.split("-").slice(1).join("-")||o.scenario.edition||"",!0)))}),t.k0s()}if(2&i){let e;const a=t.XpG().$implicit,n=t.XpG(5);t.Y8G("ghs-label","scenario.rewards.item")("ghs-label-args",t.l_i(2,se,a.split("-")[0],(null==(e=n.gameManager.itemManager.getItem(a.split("-")[0],a.split("-").slice(1).join("-")||n.scenario.edition||"",!0))?null:e.name)||""))}}function bO(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG(2).$index,a=t.XpG(4);t.Y8G("ghs-label",a.rewards.hints.chooseItem[e])}}function kO(i,r){if(1&i&&(t.nVh(0,OO,1,6,"span",77),t.nVh(1,PO,1,5,"span",77),t.nVh(2,bO,1,1,"span",76)),2&i){const e=r.$implicit,a=t.XpG().$index,n=t.XpG(4);t.vxM(-1!=e.indexOf(":")?0:-1),t.R7$(),t.vxM(-1==e.indexOf(":")?1:-1),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.chooseItem&&n.rewards.hints.chooseItem[a]?2:-1)}}function yO(i,r){1&i&&t.nrm(0,"span",71),2&i&&t.Y8G("ghs-label","or")}function xO(i,r){if(1&i&&(t.Z7z(0,kO,3,3,null,null,t.fX1),t.nVh(2,yO,1,1,"span",71)),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(4);t.Dyx(e||t.lJ4(1,Ht)),t.R7$(2),t.vxM(a<n.rewards.chooseItem.length-1?2:-1)}}function EO(i,r){if(1&i&&(t.j41(0,"div",93)(1,"span"),t.nrm(2,"span",3),t.k0s(),t.Z7z(3,xO,3,2,null,null,t.fX1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.chooseItem"),t.R7$(),t.Dyx(e.rewards.chooseItem||t.lJ4(1,Ht))}}function wO(i,r){if(1&i&&t.nrm(0,"span",77),2&i){const e=t.XpG().$implicit;t.Y8G("ghs-label","scenario.rewards.itemDesignRange")("ghs-label-args",t.eq3(2,Mt,e))}}function RO(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",104),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(3);return t.Njj(o.openItemDialog(o.gameManager.itemManager.getItem(n.split(":")[0],-1!=n.indexOf(":")?n.split(":")[1]:o.scenario.edition||"",!0)))}),t.k0s()}if(2&i){let e;const a=t.XpG().$implicit,n=t.XpG(3);t.Y8G("ghs-label","scenario.rewards.itemDesign")("ghs-label-args",t.l_i(2,se,a,(null==(e=n.gameManager.itemManager.getItem(a.split(":")[0],-1!=a.indexOf(":")?a.split(":")[1]:n.scenario.edition||"",!0))?null:e.name)||""))}}function jO(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",104),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(3);return t.Njj(o.openItemDialog(o.gameManager.itemManager.getItem(n.split(":")[0],n.split(":")[1],!0)))}),t.k0s()}if(2&i){let e;const a=t.XpG().$implicit,n=t.XpG(3);t.Y8G("ghs-label","scenario.rewards.itemDesignEdition")("ghs-label-args",t.sMw(2,Nn,a.split(":")[0],(null==(e=n.gameManager.itemManager.getItem(a.split(":")[0],a.split(":")[1],!0))?null:e.name)||"",a.split(":")[1]))}}function GO(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG().$index,a=t.XpG(3);t.Y8G("ghs-label",a.rewards.hints.itemDesigns[e])}}function TO(i,r){if(1&i&&(t.j41(0,"div",94),t.nVh(1,wO,1,4,"span",77),t.nVh(2,RO,1,5,"span",77),t.nVh(3,jO,1,6,"span",77),t.nVh(4,GO,1,1,"span",76),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.R7$(),t.vxM(-1!=e.indexOf("-")?1:-1),t.R7$(),t.vxM(-1==e.indexOf("-")&&-1==e.indexOf(":")?2:-1),t.R7$(),t.vxM(-1==e.indexOf("-")&&-1!=e.indexOf(":")?3:-1),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.itemDesigns&&n.rewards.hints.itemDesigns[a]?4:-1)}}function SO(i,r){if(1&i&&t.nrm(0,"span",77),2&i){const e=t.XpG().$implicit;t.Y8G("ghs-label","scenario.rewards.itemBlueprintRange")("ghs-label-args",e.split("-"))}}function $O(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",104),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(3);return t.Njj(o.openItemDialog(o.gameManager.itemManager.getItem(n,o.scenario.edition||"",!0)))}),t.k0s()}if(2&i){let e;const a=t.XpG().$implicit,n=t.XpG(3);t.Y8G("ghs-label","scenario.rewards.itemBlueprint")("ghs-label-args",t.l_i(2,se,a,(null==(e=n.gameManager.itemManager.getItem(a,n.scenario.edition||"",!0))?null:e.name)||""))}}function DO(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG().$index,a=t.XpG(3);t.Y8G("ghs-label",a.rewards.hints.itemBlueprints[e])}}function IO(i,r){if(1&i&&(t.j41(0,"div",95),t.nVh(1,SO,1,2,"span",77),t.nVh(2,$O,1,5,"span",77),t.nVh(3,DO,1,1,"span",76),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.R7$(),t.vxM(-1!=e.indexOf("-")?1:-1),t.R7$(),t.vxM(-1==e.indexOf("-")?2:-1),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.itemBlueprints&&n.rewards.hints.itemBlueprints[a]?3:-1)}}function AO(i,r){if(1&i&&t.nrm(0,"span",77),2&i){const e=t.XpG(4);t.Y8G("ghs-label","scenario.rewards.randomItemBlueprints")("ghs-label-args",e.rewards.randomItemBlueprints.split("-"))}}function VO(i,r){if(1&i&&(t.j41(0,"div",95),t.nVh(1,AO,1,2,"span",77),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.vxM(-1!=e.rewards.randomItemBlueprints.indexOf("-")?1:-1)}}function FO(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",104),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(4);return t.Njj(o.openItemDialog(o.gameManager.itemManager.getItem(n,o.scenario.edition||"",!0)))}),t.k0s()}if(2&i){let e;const a=t.XpG().$implicit,n=t.XpG(4);t.Y8G("ghs-label","scenario.rewards.itemBlueprint")("ghs-label-args",t.l_i(2,se,a,(null==(e=n.gameManager.itemManager.getItem(a,n.scenario.edition||"",!0))?null:e.name)||""))}}function XO(i,r){1&i&&(t.j41(0,"span"),t.nrm(1,"span",42),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","scenario.rewards.inspiration")("ghs-label-args",t.lJ4(2,gM)))}function BO(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG(5);t.Y8G("ghs-label",e.rewards.hints.randomItemBlueprint)}}function YO(i,r){if(1&i&&(t.nVh(0,FO,1,5,"span",77),t.nVh(1,XO,2,3,"span"),t.nVh(2,BO,1,1,"span",76)),2&i){const e=r.$implicit,a=t.XpG(4);t.vxM(e>0?0:-1),t.R7$(),t.vxM(-1==e?1:-1),t.R7$(),t.vxM(a.rewards.hints&&a.rewards.hints.randomItemBlueprint?2:-1)}}function NO(i,r){if(1&i&&(t.j41(0,"div",95),t.nrm(1,"span",71),t.Z7z(2,YO,3,3,null,null,t.fX1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.rewards.randomItemBlueprint"),t.R7$(),t.Dyx(e.randomItemBlueprints)}}function zO(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG().$index,a=t.XpG(3);t.Y8G("ghs-label",a.rewards.hints.events[e])}}function LO(i,r){if(1&i&&(t.j41(0,"div",96),t.nrm(1,"span",77),t.nVh(2,zO,1,1,"span",76),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.rewards.event."+e.split(":")[0])("ghs-label-args",t.eq3(3,Mt,e.split(":")[1])),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.events&&n.rewards.hints.events[a]?2:-1)}}function UO(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG().$index,a=t.XpG(3);t.Y8G("ghs-label",a.rewards.hints.removeEvents[e])}}function qO(i,r){if(1&i&&(t.j41(0,"div",96),t.nrm(1,"span",77),t.nVh(2,UO,1,1,"span",76),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.rewards.removeEvent."+e.split(":")[0])("ghs-label-args",t.eq3(3,Mt,e.split(":")[1])),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.removeEvents&&n.rewards.hints.removeEvents[a]?2:-1)}}function HO(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG(4);t.Y8G("ghs-label",e.rewards.hints.overlayCampaignSticker)}}function KO(i,r){if(1&i&&t.nrm(0,"span",77),2&i){const e=t.XpG(4);t.Y8G("ghs-label","scenario.rewards.overlayCampaignSticker")("ghs-label-args",t.l_i(2,se,e.rewards.overlayCampaignSticker.name,e.rewards.overlayCampaignSticker.location))}}function WO(i,r){if(1&i&&(t.j41(0,"div",97),t.nVh(1,HO,1,1,"span",76),t.nVh(2,KO,1,5,"span",77),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.overlayCampaignSticker?1:-1),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.overlayCampaignSticker?-1:2)}}function JO(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG(4);t.Y8G("ghs-label",e.rewards.hints.overlaySticker)}}function ZO(i,r){if(1&i&&t.nrm(0,"span",77),2&i){const e=t.XpG(4);t.Y8G("ghs-label","scenario.rewards.overlaySticker")("ghs-label-args",t.l_i(2,se,e.rewards.overlaySticker.name,e.rewards.overlaySticker.location))}}function QO(i,r){if(1&i&&(t.j41(0,"div",97),t.nVh(1,JO,1,1,"span",76),t.nVh(2,ZO,1,5,"span",77),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.overlaySticker?1:-1),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.overlaySticker?-1:2)}}function tP(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG(4);t.Y8G("ghs-label",e.rewards.hints.pet)}}function eP(i,r){if(1&i&&t.nrm(0,"span",77),2&i){const e=t.XpG(4);t.Y8G("ghs-label","scenario.rewards.pet")("ghs-label-args",t.l_i(2,se,e.rewards.pet,e.scenario.edition))}}function nP(i,r){if(1&i&&(t.j41(0,"div",97),t.nVh(1,tP,1,1,"span",76),t.nVh(2,eP,1,5,"span",77),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.pet?1:-1),t.R7$(),t.vxM(e.rewards.hints&&e.rewards.hints.pet?-1:2)}}function iP(i,r){if(1&i){const e=t.RV6();t.j41(0,"input",107),t.bIt("change",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(4);return t.Njj(o.selectCharacter(n))}),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG(4);t.Y8G("value",e)("checked",a.chooseUnlockCharacter==e)}}function aP(i,r){1&i&&(t.j41(0,"span"),t.nrm(1,"span",3),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","or"))}function oP(i,r){if(1&i&&(t.j41(0,"label",105),t.nVh(1,iP,1,2,"input",106),t.nrm(2,"span",77),t.nVh(3,aP,2,1,"span"),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(4);t.Y8G("ngClass",t.l_i(5,dM,n.unlocked(e),!n.settingsManager.settings.automaticUnlocking)),t.R7$(),t.vxM(n.settingsManager.settings.automaticUnlocking?1:-1),t.R7$(),t.Y8G("ghs-label","scenario.rewards.unlockCharacter.box")("ghs-label-args",t.eq3(8,Mt,e)),t.R7$(),t.vxM(a<n.rewards.chooseUnlockCharacter.length-1?3:-1)}}function sP(i,r){if(1&i&&(t.j41(0,"div",98)(1,"span"),t.nrm(2,"span",3),t.k0s(),t.Z7z(3,oP,4,10,"label",105,t.fX1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.unlockCharacter"),t.R7$(),t.Dyx(e.rewards.chooseUnlockCharacter)}}function rP(i,r){if(1&i&&(t.j41(0,"div",99)(1,"span"),t.nrm(2,"span",3),t.k0s(),t.nrm(3,"span",77),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.unlockCharacter"),t.R7$(),t.Y8G("ghs-label","scenario.rewards.unlockCharacter.box")("ghs-label-args",t.eq3(3,Mt,e.rewards.unlockCharacter))}}function cP(i,r){if(1&i&&(t.j41(0,"div",100),t.nrm(1,"span",71),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("ghs-label",e.rewards.custom)}}function lP(i,r){1&i&&(t.j41(0,"div",100),t.nrm(1,"span",71),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","scenario.rewards.repeatScenario"))}function gP(i,r){if(1&i&&t.nrm(0,"span",77),2&i){const e=t.XpG().$implicit;t.Y8G("ghs-label","scenario.rewards.eventDeck")("ghs-label-args",t.sMw(2,Nn,e.split(":")[0],e.split(":")[1].split("|")[0],e.split(":")[1].split("|")[1]))}}function dP(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG().$index,a=t.XpG(4);t.Y8G("ghs-label",a.rewards.hints.eventDecks[e])}}function hP(i,r){if(1&i&&(t.nVh(0,gP,1,6,"span",77),t.nVh(1,dP,1,1,"span",76)),2&i){const e=r.$index,a=t.XpG(4);t.vxM(a.rewards.hints&&a.rewards.hints.eventDecks&&a.rewards.hints.eventDecks[e]?-1:0),t.R7$(),t.vxM(a.rewards.hints&&a.rewards.hints.eventDecks&&a.rewards.hints.eventDecks[e]?1:-1)}}function _P(i,r){if(1&i&&(t.j41(0,"div",101),t.Z7z(1,hP,2,2,null,null,t.fX1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.rewards.eventDecks)}}function mP(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG().$index,a=t.XpG(3);t.Y8G("ghs-label",a.rewards.hints.lootDeckCards[e])}}function pP(i,r){if(1&i&&(t.j41(0,"div",102),t.nrm(1,"span",77),t.nVh(2,mP,1,1,"span",76),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.rewards.lootDeckCard")("ghs-label-args",t.eq3(3,Mt,e)),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.lootDeckCards&&n.rewards.hints.lootDeckCards[a]?2:-1)}}function uP(i,r){if(1&i&&t.nrm(0,"span",76),2&i){const e=t.XpG().$index,a=t.XpG(3);t.Y8G("ghs-label",a.rewards.hints.removeLootDeckCards[e])}}function fP(i,r){if(1&i&&(t.j41(0,"div",102),t.nrm(1,"span",77),t.nVh(2,uP,1,1,"span",76),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.rewards.removeLootDeckCard")("ghs-label-args",t.eq3(3,Mt,e)),t.R7$(),t.vxM(n.rewards.hints&&n.rewards.hints.removeLootDeckCards&&n.rewards.hints.removeLootDeckCards[a]?2:-1)}}function CP(i,r){if(1&i&&t.nrm(0,"span",77),2&i){const e=r.$implicit;t.Y8G("ghs-label","scenario.rewards.townGuardAm")("ghs-label-args",t.l_i(2,se,e.value,e.valueType))}}function MP(i,r){if(1&i&&(t.j41(0,"div",103),t.Z7z(1,CP,1,5,"span",77,mM),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.townGuardAMs)}}function vP(i,r){if(1&i&&(t.j41(0,"div",14)(1,"label"),t.nrm(2,"span",3),t.EFF(3,":"),t.k0s(),t.j41(4,"div",66),t.Z7z(5,Bv,3,5,"div",79,t.fX1),t.nVh(7,Nv,4,5,"div",80),t.nVh(8,Lv,4,5,"div",81),t.nVh(9,qv,4,5,"div",82),t.nVh(10,Jv,3,0,"div",83),t.nVh(11,eO,3,0,"div",84),t.nVh(12,iO,5,7,"div",85),t.nVh(13,sO,3,0,"div",86),t.nVh(14,cO,5,7,"div",87),t.nVh(15,gO,5,7,"div",88),t.nVh(16,hO,5,7,"div",89),t.nVh(17,mO,4,5,"div",90),t.nVh(18,uO,3,5,"div",91),t.Z7z(19,vO,4,3,"div",92,t.fX1),t.nVh(21,EO,5,2,"div",93),t.Z7z(22,TO,5,4,"div",94,t.fX1),t.Z7z(24,IO,4,3,"div",95,t.fX1),t.nVh(26,VO,2,1,"div",95),t.nVh(27,NO,4,1,"div",95),t.Z7z(28,LO,3,5,"div",96,t.fX1),t.Z7z(30,qO,3,5,"div",96,t.fX1),t.nVh(32,WO,3,2,"div",97),t.nVh(33,QO,3,2,"div",97),t.nVh(34,nP,3,2,"div",97),t.nVh(35,sP,5,1,"div",98),t.nVh(36,rP,4,5,"div",99),t.nVh(37,cP,2,1,"div",100),t.nVh(38,lP,2,1,"div",100),t.nVh(39,_P,3,0,"div",101),t.Z7z(40,pP,3,5,"div",102,t.fX1),t.Z7z(42,fP,3,5,"div",102,t.fX1),t.nVh(44,MP,3,0,"div",103),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","scenario.rewards"),t.R7$(3),t.Dyx(e.rewards.envelopes||t.lJ4(25,Ht)),t.R7$(2),t.vxM(e.rewards.gold?7:-1),t.R7$(),t.vxM(e.rewards.experience?8:-1),t.R7$(),t.vxM(e.rewards.collectiveGold?9:-1),t.R7$(),t.vxM(e.rewards.resources&&e.rewards.resources.length?10:-1),t.R7$(),t.vxM(e.rewards.collectiveResources&&e.rewards.collectiveResources.length?11:-1),t.R7$(),t.vxM(e.rewards.reputation?12:-1),t.R7$(),t.vxM(e.rewards.reputationFactions&&e.rewards.reputationFactions.length?13:-1),t.R7$(),t.vxM(e.rewards.prosperity?14:-1),t.R7$(),t.vxM(e.rewards.inspiration?15:-1),t.R7$(),t.vxM(e.rewards.morale?16:-1),t.R7$(),t.vxM(e.rewards.perks?17:-1),t.R7$(),t.vxM(e.rewards.battleGoals?18:-1),t.R7$(),t.Dyx(e.rewards.items||t.lJ4(26,Ht)),t.R7$(2),t.vxM(e.rewards.chooseItem&&e.rewards.chooseItem.length>0?21:-1),t.R7$(),t.Dyx(e.rewards.itemDesigns||t.lJ4(27,Ht)),t.R7$(2),t.Dyx(e.rewards.itemBlueprints||t.lJ4(28,Ht)),t.R7$(2),t.vxM(e.rewards.randomItemBlueprints?26:-1),t.R7$(),t.vxM(e.rewards.randomItemBlueprint?27:-1),t.R7$(),t.Dyx(e.rewards.events||t.lJ4(29,Ht)),t.R7$(2),t.Dyx(e.rewards.removeEvents||t.lJ4(30,Ht)),t.R7$(2),t.vxM(e.rewards.overlayCampaignSticker?32:-1),t.R7$(),t.vxM(e.rewards.overlaySticker?33:-1),t.R7$(),t.vxM(e.rewards.pet?34:-1),t.R7$(),t.vxM(e.rewards&&e.rewards.chooseUnlockCharacter&&e.rewards.chooseUnlockCharacter.length>0?35:-1),t.R7$(),t.vxM(e.rewards&&e.rewards.unlockCharacter?36:-1),t.R7$(),t.vxM(e.rewards.custom?37:-1),t.R7$(),t.vxM(e.rewards.repeatScenario?38:-1),t.R7$(),t.vxM(e.rewards.eventDecks&&e.rewards.eventDecks.length?39:-1),t.R7$(),t.Dyx(e.rewards.lootDeckCards||t.lJ4(31,Ht)),t.R7$(2),t.Dyx(e.rewards.removeLootDeckCards||t.lJ4(32,Ht)),t.R7$(2),t.vxM(e.townGuardAMs&&e.townGuardAMs.length>0?44:-1)}}function OP(i,r){if(1&i&&(t.nVh(0,dv,6,2,"div",13),t.nVh(1,Cv,5,3,"div",69),t.nVh(2,Pv,6,1,"div",69),t.nVh(3,yv,7,1,"div",70),t.nVh(4,wv,7,1,"div",70),t.nVh(5,Gv,7,1,"div",70),t.nVh(6,$v,7,1,"div",70),t.nVh(7,Av,7,1,"div",70),t.nVh(8,Fv,7,1,"div",70),t.nVh(9,vP,45,33,"div",14)),2&i){const e=t.XpG();t.vxM(e.conclusionWarning?0:-1),t.R7$(),t.vxM(e.success&&(e.scenario.unlocks&&e.scenario.unlocks.length>0||e.rewards&&e.rewards.chooseLocation&&e.rewards.chooseLocation.length>0)?1:-1),t.R7$(),t.vxM(e.success&&(!e.scenario.unlocks||0==e.scenario.unlocks.length)&&e.conclusion&&e.conclusion.unlocks&&e.conclusion.unlocks.length>0?2:-1),t.R7$(),t.vxM(e.rewards&&e.rewards.globalAchievements&&e.rewards.globalAchievements.length>0?3:-1),t.R7$(),t.vxM(e.rewards&&e.rewards.lostPartyAchievements&&e.rewards.lostPartyAchievements.length>0?4:-1),t.R7$(),t.vxM(e.rewards&&e.rewards.partyAchievements&&e.rewards.partyAchievements.length>0?5:-1),t.R7$(),t.vxM(e.rewards&&e.rewards.campaignSticker&&e.rewards.campaignSticker.length>0?6:-1),t.R7$(),t.vxM(e.rewards&&e.rewards.calendarSection&&e.rewards.calendarSection.length>0?7:-1),t.R7$(),t.vxM(e.rewards&&e.rewards.calendarSectionManual&&e.rewards.calendarSectionManual.length>0?8:-1),t.R7$(),t.vxM(e.rewards&&e.hasRewards()?9:-1)}}function PP(i,r){if(1&i&&(t.j41(0,"div",88)(1,"span"),t.nrm(2,"span",42),t.nI1(3,"ghsValueSign"),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","scenario.rewards.inspiration")("ghs-label-args",t.eq3(4,Mt,t.bMT(3,2,e.EntityValueFunction("4-C"))))}}function bP(i,r){if(1&i){const e=t.RV6();t.j41(0,"input",55),t.bIt("change",function(n){t.eBV(e);const o=t.XpG(3);return t.Njj(o.toggleChallenges(n))}),t.k0s()}if(2&i){const e=t.XpG(3);t.Y8G("checked",e.challenges>0)}}function kP(i,r){if(1&i){const e=t.RV6();t.j41(0,"input",55),t.bIt("change",function(n){t.eBV(e);const o=t.XpG(3);return t.Njj(o.toggleChallenges(n,!0))}),t.k0s()}if(2&i){const e=t.XpG(3);t.Y8G("checked",e.challenges>1)}}function yP(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",111)(1,"ghs-challenge-card",112),t.bIt("click",function(){t.eBV(e);const n=t.XpG(4);return t.Njj(n.openChallenge(n.gameManager.game.challengeDeck.keep[1]))}),t.k0s(),t.j41(2,"input",55),t.bIt("change",function(n){t.eBV(e);const o=t.XpG(4);return t.Njj(o.toggleChallenges(n,!0))}),t.k0s()()}if(2&i){const e=t.XpG(4);t.R7$(),t.Y8G("challenge",e.gameManager.game.challengeDeck.cards[e.gameManager.game.challengeDeck.keep[1]])("flipped",!0),t.R7$(),t.Y8G("checked",e.challenges>1)}}function xP(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",110)(1,"div",111)(2,"ghs-challenge-card",112),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openChallenge(n.gameManager.game.challengeDeck.keep[0]))}),t.k0s(),t.j41(3,"input",55),t.bIt("change",function(n){t.eBV(e);const o=t.XpG(3);return t.Njj(o.toggleChallenges(n))}),t.k0s()(),t.nVh(4,yP,3,3,"div",111),t.k0s()}if(2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("challenge",e.gameManager.game.challengeDeck.cards[e.gameManager.game.challengeDeck.keep[0]])("flipped",!0),t.R7$(),t.Y8G("checked",e.challenges>0),t.R7$(),t.vxM(e.numberChallenges>1?4:-1)}}function EP(i,r){if(1&i&&(t.j41(0,"div",108)(1,"div",109),t.nrm(2,"span",3),t.nVh(3,bP,1,1,"input",50),t.nVh(4,kP,1,1,"input",50),t.k0s(),t.nVh(5,xP,5,4,"div",110),t.k0s()),2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","scenario.summary.challenges."+(e.numberChallenges>1?"completed":"complete")),t.R7$(),t.vxM(e.gameManager.challengesManager.enabled?-1:3),t.R7$(),t.vxM(!e.gameManager.challengesManager.enabled&&e.numberChallenges>1?4:-1),t.R7$(),t.vxM(e.gameManager.challengesManager.enabled?5:-1)}}function wP(i,r){if(1&i&&(t.j41(0,"div",14)(1,"label"),t.nrm(2,"span",3),t.EFF(3,":"),t.k0s(),t.j41(4,"div",66),t.nVh(5,PP,4,6,"div",88),t.nVh(6,EP,6,4,"div",108),t.k0s()()),2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","scenario.rewards.bonus"),t.R7$(3),t.vxM(!e.gameManager.fhRules()||!e.EntityValueFunction("4-C")||e.rewards&&e.rewards.ignoredBonus&&-1!=e.rewards.ignoredBonus.indexOf("inspiration")?-1:5),t.R7$(),t.vxM(e.numberChallenges>0?6:-1)}}function RP(i,r){1&i&&(t.j41(0,"div",114)(1,"span"),t.nrm(2,"span",5),t.k0s()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","scenario.rewards.addWeek.summer"))}function jP(i,r){1&i&&(t.j41(0,"div",115)(1,"span"),t.nrm(2,"span",5),t.k0s()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","scenario.rewards.addWeek.winter"))}function GP(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",118),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.showWeekConclusion(n))}),t.k0s()}if(2&i){const e=r.$implicit;t.Y8G("ghs-label","scenario.rewards.addWeek.section")("ghs-label-args",t.eq3(2,Mt,e.index))}}function TP(i,r){if(1&i&&(t.j41(0,"div",116),t.Z7z(1,GP,1,4,"span",117,t.fX1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Dyx(e.weekSections())}}function SP(i,r){if(1&i&&(t.j41(0,"div",14)(1,"label"),t.nrm(2,"span",3),t.EFF(3,":"),t.k0s(),t.j41(4,"div",66)(5,"div",113)(6,"span"),t.nrm(7,"span",27),t.k0s()(),t.nVh(8,RP,3,1,"div",114),t.nVh(9,jP,3,1,"div",115),t.nVh(10,TP,3,0,"div",116),t.k0s()()),2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","scenario.rewards.addWeek"),t.R7$(5),t.Y8G("ghs-label","scenario.rewards.addWeek.next")("ghs-label-args",t.eq3(6,Mt,e.gameManager.game.party.weeks+1)),t.R7$(),t.vxM(e.gameManager.game.party.weeks%20<10&&(e.gameManager.game.party.weeks-1)%20>=10?8:-1),t.R7$(),t.vxM(e.gameManager.game.party.weeks%20>=10&&(e.gameManager.game.party.weeks-1)%20<10?9:-1),t.R7$(),t.vxM(e.weekSections().length?10:-1)}}function $P(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",125),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(4);return t.Njj(o.finish(n,!0))}),t.nrm(1,"span",42),t.k0s()}if(2&i){const e=r.$implicit;t.R7$(),t.Y8G("ghs-label","scenario.summary.link")("ghs-label-args",t.eq3(2,Mt,e))}}function DP(i,r){if(1&i&&(t.j41(0,"span",123),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,$P,2,4,"a",124,t.fX1)),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.summary.forcedLinks"),t.R7$(),t.Dyx(e.scenario.forcedLinks)}}function IP(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",125),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(4);return t.Njj(o.finish(n,!0))}),t.nrm(1,"span",42),t.k0s()}if(2&i){const e=r.$implicit;t.R7$(),t.Y8G("ghs-label","scenario.summary.link")("ghs-label-args",t.eq3(2,Mt,e))}}function AP(i,r){if(1&i&&(t.j41(0,"span",123),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,IP,2,4,"a",124,t.fX1)),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.summary.forcedLinks"),t.R7$(),t.Dyx(e.conclusion.forcedLinks)}}function VP(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",127),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(4);return t.Njj(o.finish(n))}),t.nrm(1,"span",42),t.k0s()}if(2&i){const e=r.$implicit;t.R7$(),t.Y8G("ghs-label","scenario.summary.link")("ghs-label-args",t.eq3(2,Mt,e))}}function FP(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",127),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(5);return t.Njj(o.finish(n))}),t.nrm(1,"span",42),t.k0s()}if(2&i){const e=r.$implicit;t.R7$(),t.Y8G("ghs-label","scenario.summary.link")("ghs-label-args",t.eq3(2,Mt,e))}}function XP(i,r){if(1&i&&t.Z7z(0,FP,2,4,"a",126,t.fX1),2&i){const e=t.XpG(4);t.Dyx(e.conclusion.links)}}function BP(i,r){if(1&i&&(t.j41(0,"span",123),t.nrm(1,"span",3),t.k0s(),t.Z7z(2,VP,2,4,"a",126,t.fX1),t.nVh(4,XP,2,0)),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.summary.links"),t.R7$(),t.Dyx(e.scenario.links),t.R7$(2),t.vxM(e.conclusion&&e.conclusion.links?4:-1)}}function YP(i,r){if(1&i&&(t.j41(0,"span",120),t.nVh(1,DP,4,1),t.nVh(2,AP,4,1),t.nVh(3,BP,5,2),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.vxM(e.scenario.forcedLinks&&e.scenario.forcedLinks.length>0?1:-1),t.R7$(),t.vxM(e.conclusion&&e.conclusion.forcedLinks&&e.conclusion.forcedLinks.length>0?2:-1),t.R7$(),t.vxM(e.scenario.forcedLinks&&0!=e.scenario.forcedLinks.length||e.conclusion&&e.conclusion.forcedLinks&&0!=e.conclusion.forcedLinks.length?-1:3)}}function NP(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",128),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.finish())}),t.nrm(1,"span",3),t.k0s()}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label",e.conclusionOnly?"scenario.summary.solve":"scenario.summary.apply")}}function zP(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",129),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.restart())}),t.nrm(1,"span",3),t.k0s()}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label",e.lootColumns.length>0?"scenario.summary.restartLoseLoot":"scenario.summary.restart")}}function LP(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",15)(1,"a",119),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.close())}),t.nrm(2,"span",3),t.k0s(),t.nVh(3,YP,4,3,"span",120),t.nVh(4,NP,2,1,"a",121),t.nVh(5,zP,2,1,"a",122),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(5,is,e.gameManager.stateManager.permissions&&(!e.gameManager.stateManager.permissions.round||!e.gameManager.stateManager.permissions.scenario||!e.gameManager.stateManager.permissions.characters))),t.R7$(2),t.Y8G("ghs-label","scenario.summary.cancel"),t.R7$(),t.vxM(e.success&&(e.gameManager.game.party.campaignMode||e.forceCampaign)&&(e.scenario.links&&e.scenario.links.length>0||e.scenario.forcedLinks&&e.scenario.forcedLinks.length>0||e.conclusion&&e.conclusion.forcedLinks&&e.conclusion.forcedLinks.length>0)?3:-1),t.R7$(),t.vxM(e.success&&e.gameManager.game.party.campaignMode&&!e.alreadyWarning&&!e.forceCampaign&&(e.scenario.forcedLinks&&0!=e.scenario.forcedLinks.length||e.conclusion&&e.conclusion.forcedLinks&&0!=e.conclusion.forcedLinks.length)?-1:4),t.R7$(),t.vxM(e.success?-1:5)}}let Yt=(()=>{class i{dialogRef;dialog;gameManager=s.E;settingsManager=m.f;LootType=ot.r6;scenario;conclusion;success;conclusionWarning;alreadyWarning=!1;characterProgress=!0;gainRewards=!0;forceCampaign=!1;conclusionOnly;rewardsOnly;characters;battleGoals=[];collectiveGold=[];collectiveResources=[];lootColumns=[];lootColumnsLooted=[];lootColumnsTotal=[];lootedGold=0;totalGold=0;rewardItems=[];rewardItemCount=[];items=[];chooseLocation;chooseUnlockCharacter;rewards=void 0;challenges=0;numberChallenges=0;calendarSectionManual=[];randomItem;randomItemIndex=-1;randomItems=[];randomItemBlueprints=[];trials=[];trial349;trial356;townGuardAMs=[];levelUp=[];perksUp=[];stats=!1;EntityValueFunction=$.hZ;waitForClose=!1;constructor(e,a,n){this.dialogRef=a,this.dialog=n,this.scenario=e.scenario,this.success=e.success,this.conclusion=e.conclusion,this.conclusionOnly=e.conclusionOnly,this.rewardsOnly=e.rewardsOnly,this.conclusionOnly&&(this.conclusion=this.scenario,this.success=!0,s.E.game.finish=void 0,(this.conclusion.repeatable||s.E.game.party.conclusions.find(o=>o.index==this.scenario.index&&o.edition==this.scenario.edition&&o.group==this.scenario.group))&&(this.rewardsOnly=!0)),this.conclusionWarning=this.success&&!this.conclusion&&null!=s.E.sectionData(this.scenario.edition).find(o=>o.parent==this.scenario.index&&o.group==this.scenario.group&&o.edition==this.scenario.edition&&o.conclusion),this.characters=s.E.game.figures.filter(o=>o instanceof q.K).map((o,g)=>(this.battleGoals[g]=0,o)).sort((o,g)=>{if(!o.absent&&g.absent)return-1;if(o.absent&&!g.absent)return 1;const _=s.E.characterManager.characterName(o).toLowerCase(),y=s.E.characterManager.characterName(g).toLowerCase();return _>y?1:_<y?-1:0}),this.trial349=this.characters.find(o=>o.progress.trial&&"fh"==o.progress.trial.edition&&"349"==o.progress.trial.name),this.trial356=this.characters.find(o=>o.progress.trial&&"fh"==o.progress.trial.edition&&"356"==o.progress.trial.name);for(let o in ot.r6){const g=o;g!=ot.r6.money&&g!=ot.r6.special1&&g!=ot.r6.special2&&-1==this.lootColumns.indexOf(g)&&this.characters.some(_=>_.lootCards&&_.lootCards.some(y=>s.E.game.lootDeck.cards[y].type==g))&&(this.lootColumns.push(g),this.lootColumnsLooted.push(this.characters.map(_=>this.lootValue(_,g)).reduce((_,y)=>_+y)),this.lootColumnsTotal.push(s.E.lootManager.getTotal(s.E.game.lootDeck,g)))}s.E.game.lootDeck&&s.E.game.lootDeck.cards.length>0&&(this.characters.length>0&&(this.lootedGold=this.characters.map(o=>this.lootValue(o,ot.r6.money)+this.lootValue(o,ot.r6.special1)+this.lootValue(o,ot.r6.special2)).reduce((o,g)=>o+g)),this.totalGold=s.E.lootManager.getTotal(s.E.game.lootDeck,ot.r6.money),this.totalGold+=s.E.lootManager.getTotal(s.E.game.lootDeck,ot.r6.special1),this.totalGold+=s.E.lootManager.getTotal(s.E.game.lootDeck,ot.r6.special2)),this.alreadyWarning=!this.rewardsOnly&&s.E.game.party.campaignMode&&this.success&&(s.E.scenarioManager.isSuccess(this.scenario)||this.conclusion&&null!=s.E.game.party.conclusions.find(o=>this.conclusion&&o.index==this.conclusion.index&&o.edition==this.conclusion.edition&&o.group==this.conclusion.group))||!1,this.characterProgress=!this.rewardsOnly&&!this.conclusionOnly&&(s.E.game.party.campaignMode||!s.E.fhRules()),this.gainRewards=s.E.game.party.campaignMode,this.updateState(),s.E.stateManager.scenarioSummary=!0,s.E.game.finish||this.conclusionOnly||this.rewardsOnly?this.rewardsOnly||this.loadFinish():(s.E.stateManager.before("finishScenario.dialog",...s.E.scenarioManager.scenarioUndoArgs()),this.updateFinish(),s.E.stateManager.after()),this.dialogRef.closed.subscribe({next:()=>{s.E.stateManager.scenarioSummary&&!this.conclusionOnly&&!this.rewardsOnly&&!this.waitForClose&&(s.E.stateManager.before("finishScenario.close",...s.E.scenarioManager.scenarioUndoArgs()),s.E.stateManager.scenarioSummary=!1,s.E.game.finish=void 0,s.E.stateManager.after())}}),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.conclusionOnly||(s.E.game.finish?this.loadFinish():(s.E.stateManager.scenarioSummary=!1,this.close()))}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}updateFinish(){const e=new Vn.Af;e.conclusion=this.conclusion?new ht.Ag(this.conclusion.index,this.conclusion.edition,this.conclusion.group):void 0,e.success=this.success,e.battleGoals=this.battleGoals,e.challenges=this.challenges,e.chooseLocation=this.chooseLocation,e.chooseUnlockCharacter=this.chooseUnlockCharacter,e.collectiveGold=this.collectiveGold,e.collectiveResources=this.collectiveResources||[],e.items=this.items,e.calendarSectionManual=this.calendarSectionManual,e.randomItem=this.randomItem?new vt.gw(""+this.randomItem.id,this.randomItem.edition):void 0,e.randomItemIndex=this.randomItemIndex,e.randomItems=this.randomItems?this.randomItems.map(a=>a?new vt.gw(""+a.id,a.edition):void 0):[],e.randomItemBlueprints=this.randomItemBlueprints,e.trials=this.trials,s.E.game.finish=e,this.updateState()}loadFinish(){if(s.E.game.finish){const e=s.E.game.finish;this.conclusion=e.conclusion?s.E.sectionData(e.conclusion.edition).find(a=>e.conclusion&&a.index==e.conclusion.index&&a.group==e.conclusion.group&&a.conclusion):void 0,this.success=e.success,this.battleGoals=e.battleGoals||[],this.challenges=e.challenges,this.chooseLocation=e.chooseLocation,this.chooseUnlockCharacter=e.chooseUnlockCharacter,this.collectiveGold=e.collectiveGold||[],this.collectiveResources=e.collectiveResources||[],this.items=e.items,this.calendarSectionManual=e.calendarSectionManual||e.calenderSectionManual,this.randomItem=e.randomItem?s.E.itemManager.getItem(e.randomItem.name,e.randomItem.edition,!0):void 0,this.randomItemIndex=e.randomItemIndex,this.randomItems=e.randomItems?e.randomItems.map(a=>a?s.E.itemManager.getItem(a.name,a.edition,!0):void 0):[],this.randomItemBlueprints=e.randomItemBlueprints||[],this.trials=e.trials||[],this.updateState()}}updateState(e=!1){if(this.forceCampaign=e,this.numberChallenges=0,this.rewards=void 0,this.townGuardAMs=[],(s.E.game.party.campaignMode||e)&&this.success){if(this.scenario.rewards&&(this.rewards=Object.assign(new Vn.$v,this.scenario.rewards)),this.conclusion&&this.conclusion.rewards&&(this.rewards?Object.assign(this.rewards,this.conclusion.rewards):this.rewards=Object.assign(new Vn.$v,this.conclusion.rewards)),m.f.settings.scenarioRewards&&this.rewards){if(this.rewards.collectiveGold&&this.characters.forEach((a,n)=>{this.collectiveGold[n]||(this.collectiveGold[n]=0)}),this.rewards.collectiveResources&&(this.collectiveResources=this.collectiveResources||[],this.characters.forEach((a,n)=>{this.collectiveResources[n]||(this.collectiveResources[n]={})})),this.rewards.items&&this.rewards.items.forEach((a,n)=>{const o=s.E.itemManager.getItem(a.split(":")[0].split("-")[0],a.split(":")[0].split("-").slice(1).join("-")||this.scenario.edition,!0);if(o){if(this.rewardItems[n]=o,this.rewardItemCount[n]=-1==a.indexOf(":")?1:+a.split(":")[1],1==this.characters.filter(g=>!g.absent).length){const g=this.characters.find(_=>!_.absent);g&&(void 0===this.items[this.characters.indexOf(g)]&&(this.items[this.characters.indexOf(g)]=[]),-1==this.items[this.characters.indexOf(g)].indexOf(n)&&this.items[this.characters.indexOf(g)].push(n))}}else console.error("Unknown Item '"+a+"' for scenario '"+this.scenario.index+" ("+this.scenario.edition+")")}),this.rewards.chooseItem){let a=0;this.rewards.chooseItem.forEach(n=>{n.forEach(o=>{const g=s.E.itemManager.getItem(o.split(":")[0].split("-")[0],o.split(":")[0].split("-").slice(1).join("-")||this.scenario.edition,!0);g?(this.rewardItems[a]=g,this.rewardItemCount[a]=-1==o.indexOf(":")?1:+o.split(":")[1],a++):console.error("Unknown Item '"+o+"' for scenario '"+this.scenario.index+" ("+this.scenario.edition+")")})})}if(this.rewards.chooseLocation&&this.rewards.chooseLocation.length>0&&!this.chooseLocation&&(this.chooseLocation=this.rewards.chooseLocation[0]),this.rewards.chooseUnlockCharacter&&this.rewards.chooseUnlockCharacter.length>0&&!this.chooseUnlockCharacter){let a=0;for(;a<this.rewards.chooseUnlockCharacter.length&&-1!=s.E.game.unlockedCharacters.indexOf(this.scenario.edition+":"+this.rewards.chooseUnlockCharacter[a]);)a++;a<this.rewards.chooseUnlockCharacter.length&&(this.chooseUnlockCharacter=this.rewards.chooseUnlockCharacter[a])}if(this.rewards.calendarSectionManual&&this.rewards.calendarSectionManual.forEach((a,n)=>{this.calendarSectionManual[n]||(this.calendarSectionManual[n]=0)}),m.f.settings.scenarioRewardsItems&&this.rewards.randomItemBlueprint&&this.randomItemBlueprints.length<this.rewards.randomItemBlueprint)for(let a=this.randomItemBlueprints.length;a<this.rewards.randomItemBlueprint;a++){let n=s.E.itemManager.drawRandomItem(this.scenario.edition,!0),o=n?new vt.gw(""+n.id,n.edition):void 0;this.randomItemBlueprints[a]=o?+o.name:-1}if(m.f.settings.scenarioRewardsItems&&this.rewards.randomItem&&!this.randomItem){const a=+this.rewards.randomItem.split("-")[0],n=+this.rewards.randomItem.split("-")[1],o=this.rewards.randomItem.split("-").length>2?this.rewards.randomItem.split("-")[2]:this.scenario.edition;let g=s.E.itemManager.drawRandomItem(o,!1,a,n);g&&(this.randomItem=g)}if(m.f.settings.scenarioRewardsItems&&this.rewards.randomItems&&this.randomItems.length<this.characters.length&&this.rewards.randomItems.split("-").length>1){const a=+this.rewards.randomItems.split("-")[0],n=+this.rewards.randomItems.split("-")[1],o=this.rewards.randomItems.split("-").length>2?this.rewards.randomItems.split("-")[2]:this.scenario.edition;for(let g=this.randomItems.length;g<this.characters.length;g++){const _=this.characters[g];if(_.absent)this.randomItems[g]=void 0;else{let y=s.E.itemManager.drawRandomItem(o,!1,a,n);_.progress.items.find(B=>y&&B.name==y.id+""&&B.edition==y.edition)&&(y=void 0),this.randomItems[g]=y||void 0}}}this.rewards.townGuardAm&&(this.townGuardAMs=this.rewards.townGuardAm.map(a=>Y.qq.find(n=>n.id==a))),this.rewards.valueMapping&&Object.keys(this.rewards.valueMapping).forEach(a=>{if(this.rewards&&this.rewards.valueMapping&&this.rewards.valueMapping[a]){const n=this.rewards.valueMapping[a],o=s.E.scenarioRulesManager.presentEntitiesByFigureRule(n,void 0).length,g=n.value;this.rewards&&"string"==typeof this.rewards[g]&&(this.rewards[g]=this.rewards[g].replaceAll(a,""+o))}})}if(s.E.challengesManager.enabled)this.numberChallenges=s.E.game.challengeDeck.keep.length;else if(s.E.fhRules()){const a=s.E.game.party.buildings.find(n=>"town-hall"==n.name&&n.level&&"wrecked"!=n.state);a&&(1==a.level||2==a.level?this.numberChallenges=1:3==a.level&&(this.numberChallenges=2))}}this.characters.forEach((a,n)=>{const o=a.progress.experience+2*this.challenges+a.experience+(this.success&&this.rewards&&this.rewards.experience?this.rewards.experience:0)+(!this.success||this.rewards&&this.rewards.ignoredBonus&&-1!=this.rewards.ignoredBonus.indexOf("experience")?0:s.E.levelManager.experience());this.levelUp[n]=s.E.characterManager.levelForXp(o)>s.E.characterManager.levelForXp(a.progress.experience);const g=Math.floor(a.progress.battleGoals/3),_=Math.floor((a.progress.battleGoals+this.battleGoals[n])/3);this.perksUp[n]=_>g,m.f.settings.scenarioStats&&!a.absent&&s.E.scenarioStatsManager.applyScenarioStats(a,this.scenario,this.success)})}hasRewards(){const e=this.rewards;return!(!e||!(e.envelopes||e.gold||e.experience||e.collectiveGold||e.resources||e.collectiveResources||e.reputation||e.prosperity||e.inspiration||e.morale||e.perks||e.battleGoals||e.items||e.chooseItem||e.itemDesigns||e.itemBlueprints||e.randomItemBlueprint||e.randomItemBlueprints||e.events||e.chooseUnlockCharacter||e.unlockCharacter||e.custom||e.lootDeckCards||e.removeLootDeckCards||e.townGuardAm||e.overlayCampaignSticker||e.overlaySticker||e.pet||e.eventDecks||e.reputationFactions))}hasBonus(){return(s.E.game.party.campaignMode||this.forceCampaign)&&this.success&&!this.conclusionOnly&&!this.scenario.solo&&(s.E.fhRules()&&s.E.characterManager.characterCount()<4&&(!this.rewards||!this.rewards.ignoredBonus||-1==this.rewards.ignoredBonus.indexOf("inspiration"))||this.numberChallenges>0)}addWeek(){return s.E.fhRules()&&(s.E.game.party.campaignMode||this.forceCampaign)&&this.success&&!this.conclusionOnly&&!this.scenario.solo&&!this.scenario.conclusion&&(!this.rewards||!this.rewards.calendarIgnore)&&(!this.scenario.forcedLinks||!this.scenario.forcedLinks.length)&&(!this.conclusion||!this.conclusion.forcedLinks||!this.conclusion.forcedLinks.length)&&m.f.settings.automaticPassTime&&m.f.settings.partySheet}weekSections(){let e=[];const a=s.E.editionData.find(o=>o.edition==this.scenario.edition);let n=[];return a&&a.campaign&&n.push(...a.campaign.weeks&&a.campaign.weeks[s.E.game.party.weeks+1]||[]),n.push(...s.E.game.party.weekSections[s.E.game.party.weeks+1]||[]),n.forEach(o=>{const g=s.E.sectionData(this.scenario.edition).find(_=>_.index==o&&_.group==this.scenario.group&&_.conclusion);g&&e.push(g)}),e}showWeekConclusion(e){const a=new ht.Nz(e);this.dialog.open(i,{panelClass:["dialog"],data:{scenario:a,conclusionOnly:!0,rewardsOnly:!0}})}availableCollectiveGold(){return this.rewards&&this.rewards.collectiveGold&&this.collectiveGold.length>0&&this.rewards.collectiveGold-this.collectiveGold.reduce((e,a)=>e+a)||0}availableCollectiveResource(e){const a=this.rewards&&this.rewards.collectiveResources&&this.rewards.collectiveResources.find(o=>o.type==e)||{type:e,value:0},n=(0,$.hZ)(a.value);return n>0&&n-(this.collectiveResources&&this.collectiveResources.length>0?this.collectiveResources.map(o=>o[e]||0).reduce((o,g)=>o+g):0)||0}lootValue(e,a){let n=0;return e.lootCards&&e.lootCards.forEach(o=>{const g=s.E.game.lootDeck.cards[o];g&&g.type==a&&(n+=s.E.lootManager.getValue(g))}),n}toggleBattleGoal(e,a,n){const o=this.characters[a];let g;s.E.stateManager.before("finishScenario.battleGoal",o.edition,o.name,n),m.f.settings.battleGoals&&o.battleGoal&&o.battleGoals.length>0&&(g=s.E.battleGoalManager.getBattleGoal(o.battleGoals[0])),e.target.checked&&this.battleGoals[a]<n?(this.battleGoals[a]=n,g&&g.checks>n&&(this.battleGoals[a]=g.checks)):this.battleGoals[a]>=n&&(this.battleGoals[a]=n-1,g&&g.checks>n-1&&(this.battleGoals[a]=0)),this.updateFinish(),s.E.stateManager.after()}openBattleGoals(e){this.dialog.open(oa,{panelClass:["dialog"],data:{character:e,cardOnly:e.battleGoal}})}openTrial(e){e.progress.trial&&this.dialog.open(ns,{panelClass:["fullscreen-panel"],data:{edition:e.progress.trial.edition,trial:+e.progress.trial.name}})}openChallenge(e){s.E.game.challengeDeck.cards[e]&&this.dialog.open(kC,{panelClass:["fullscreen-panel"],data:s.E.game.challengeDeck.cards[e]})}toggleTrial(e,a){s.E.stateManager.before("finishScenario.trial",this.characters[a].name,this.trials[a]),this.trials[a]=e.target.checked,this.updateFinish(),s.E.stateManager.after()}toggleChallenges(e,a=!1){if(s.E.stateManager.before("finishScenario.dialog.challenge"+(a?"s":"")),this.challenges<1&&a&&s.E.challengesManager.enabled){const n=s.E.game.challengeDeck.cards.splice(s.E.game.challengeDeck.keep[0],1)[0];s.E.game.challengeDeck.cards.splice(s.E.game.challengeDeck.keep[1],0,n),this.challenges=1,e.target.checked=!1}else this.challenges=this.challenges>(a?1:0)?a?1:0:a?2:1;this.updateFinish(),s.E.stateManager.after()}itemDistributed(e,a,n=!0){if(this.items[e]||(this.items[e]=[]),n&&this.rewards&&this.rewards.chooseItem){let y=0,B=0,nt=0,Z=!1;if(this.rewards.chooseItem.forEach(W=>{!Z&&a<W.length+nt&&(B=W.length+nt-1,Z=!0),nt+=W.length,Z||(y=nt)}),this.rewardItems.some((W,et)=>et!=a&&(et<y||et>B)&&this.characters.some((it,st)=>this.itemDistributed(st,et,!1))))return!0}const o=this.rewardItems[a];if(this.characters[e].progress.items.find(y=>y.name==""+o.id&&y.edition==o.edition))return!0;const g=this.rewardItems[a],_=n?g.count-this.characters.filter(y=>y.progress.items.find(B=>B.name==""+g.id&&B.edition==g.edition)).length:1;return-1==this.items[e].indexOf(a)&&this.items.filter(y=>-1!=y.indexOf(a)).length>=Math.min(this.rewardItemCount[a],_)}toggleItem(e,a,n){s.E.stateManager.before("finishScenario.dialog.item",a,this.rewardItems[n].id),-1==this.items[a].indexOf(n)?this.items[a].push(n):this.items[a].splice(this.items[a].indexOf(n),1),this.updateFinish(),s.E.stateManager.after()}toggleRandomItem(e,a){s.E.stateManager.before("finishScenario.dialog.item",a),this.randomItemIndex=this.randomItemIndex==a?-1:a,this.updateFinish(),s.E.stateManager.after()}openItemDialog(e){e&&this.dialog.open(Me,{panelClass:["fullscreen-panel"],disableClose:!0,data:{item:e}})}changeCollectiveGold(e,a){let n=+e.target.value;const o=this.collectiveGold[a]||0;this.collectiveGold[a]=0,n<0?n=0:n>this.availableCollectiveGold()&&(n=this.availableCollectiveGold()),this.collectiveGold[a]=o,n!=(this.collectiveGold[a]||0)&&(s.E.stateManager.before("finishScenario.dialog.collectiveGold",a,e.target.value),this.collectiveGold[a]=+e.target.value,this.updateFinish(),s.E.stateManager.after()),e.target.value=n}changeCollectiveResource(e,a,n){let o=+e.target.value;this.collectiveResources[a]||(this.collectiveResources[a]={});const g=this.collectiveResources[a][n]||0;this.collectiveResources[a][n]=0,o<0?o=0:o>this.availableCollectiveResource(n)&&(o=this.availableCollectiveResource(n)),this.collectiveResources[a][n]=g,o!=(this.collectiveResources[a][n]||0)&&(s.E.stateManager.before("finishScenario.dialog.collectiveResource",n,a,e.target.value),this.collectiveResources[a]=this.collectiveResources[a]||{},this.collectiveResources[a][n]=o,this.updateFinish(),s.E.stateManager.after()),e.target.value=o}changeCalendarSectionManual(e,a){s.E.stateManager.before("finishScenario.dialog.calendarSectionManual",a,e.target.value),this.calendarSectionManual[a]=+e.target.value,this.updateFinish(),s.E.stateManager.after()}selectLocation(e){s.E.stateManager.before("finishScenario.dialog.chooseLocation",e),this.chooseLocation=e,this.updateFinish(),s.E.stateManager.after()}selectCharacter(e){s.E.stateManager.before("finishScenario.dialog.chooseUnlockCharacter",e),this.chooseUnlockCharacter=e,this.updateFinish(),s.E.stateManager.after()}openCharacterSheet(e){this.dialog.open(Re,{panelClass:["dialog-invert"],data:{character:e}})}toggleAbsent(e){s.E.stateManager.before(e.absent?"unsetAbsent":"setAbsent",s.E.characterManager.characterName(e)),e.absent=!e.absent,s.E.stateManager.after()}finish(){var e=this;return(0,X.A)(function*(a=void 0,n=!1){e.waitForClose=!0;const o=s.E.scenarioData(e.scenario.edition).find(g=>g.group==e.scenario.group&&g.index==a);if(e.conclusionOnly?s.E.stateManager.before("finishConclusion",...s.E.scenarioManager.scenarioUndoArgs(e.scenario)):s.E.stateManager.before(e.success&&o?"finishScenario.linked":"finishScenario."+(e.success?"success":"failure"),...s.E.scenarioManager.scenarioUndoArgs(),a||""),m.f.settings.scenarioRewards&&e.success&&!s.E.bbRules()){if(e.characters.forEach((g,_)=>{if(!g.absent){if(e.battleGoals[_]>0&&(g.progress.battleGoals+=e.battleGoals[_]),e.trials[_]&&(g.progress.trial=void 0),e.collectiveGold[_]>0&&(g.progress.gold+=e.collectiveGold[_]),e.collectiveResources[_]&&Object.keys(e.collectiveResources[_]).forEach(y=>{g.progress.loot[y]=(g.progress.loot[y]||0)+(e.collectiveResources[_][y]||0)}),e.rewardItems.forEach((y,B)=>{e.items.every(nt=>-1==nt.indexOf(B))&&(e.items[_]=e.items[_]||[],e.items[_].push(B))}),e.items[_]&&e.items[_].length>0&&e.items[_].forEach(y=>{const B=e.rewardItems[y];m.f.settings.characterItems&&g.progress.items.push(new vt.gw(""+B.id,B.edition)),s.E.itemManager.addItemCount(B)}),e.challenges)for(let y=0;y<e.challenges;y++)g.progress.experience+=2;s.E.trialsManager.favorsEnabled&&s.E.trialsManager.apply&&(g.progress.gold+=g.loot*s.E.trialsManager.activeFavor("fh","wealth"),e.battleGoals[_]&&(g.progress.experience+=3*s.E.trialsManager.activeFavor("fh","knowledge")))}}),e.rewards&&e.rewards.collectiveResources&&e.rewards.collectiveResources.forEach(g=>{const _=e.availableCollectiveResource(g.type);_&&(s.E.game.party.loot[g.type]=(s.E.game.party.loot[g.type]||0)+_)}),e.chooseLocation&&s.E.game.party.manualScenarios.push(new ht.Ag(e.chooseLocation,e.scenario.edition,e.scenario.group)),m.f.settings.automaticUnlocking&&e.chooseUnlockCharacter&&-1==s.E.game.unlockedCharacters.indexOf(e.scenario.edition+":"+e.chooseUnlockCharacter)&&s.E.game.unlockedCharacters.push(e.scenario.edition+":"+e.chooseUnlockCharacter),e.challenges)for(let g=0;g<e.challenges;g++)s.E.game.party.townGuardPerks+=1;(e.gainRewards||e.forceCampaign)&&e.randomItemBlueprints.length>0&&e.randomItemBlueprints.forEach(g=>{-1==g?s.E.game.party.inspiration+=1:s.E.game.party.unlockedItems.push(new vt.VP(""+g,e.scenario.edition))}),(e.gainRewards||e.forceCampaign)&&e.rewards&&e.rewards.calendarSectionManual&&e.rewards.calendarSectionManual.forEach((g,_)=>{if(e.calendarSectionManual[_]>=0){const y=s.E.game.party.weeks+e.calendarSectionManual[_];s.E.game.party.weekSections[y]=[...s.E.game.party.weekSections[y]||[],g.section]}}),s.E.challengesManager.enabled&&e.challenges&&(s.E.game.challengeDeck.finished+=e.challenges),s.E.trialsManager.applyTrialCards()}e.conclusionOnly?s.E.scenarioManager.finishScenario(e.scenario,!0,e.conclusion,!1,!1,m.f.settings.scenarioRewards&&(e.characterProgress||e.forceCampaign),e.gainRewards||e.forceCampaign,!0):s.E.scenarioManager.finishScenario(s.E.game.scenario,e.success,e.conclusion,!1,null!=o,m.f.settings.scenarioRewards&&!s.E.bbRules()&&(e.characterProgress||e.forceCampaign),e.gainRewards||e.forceCampaign),o?n||!s.E.scenarioManager.isBlocked(o)&&!s.E.scenarioManager.isLocked(o)?s.E.scenarioManager.setScenario(new ht.Nz(o),!0):e.dialog.open(Mi,{panelClass:["dialog"],data:{scenarioData:o,linked:!0}}):s.E.game.figures.forEach(g=>{g instanceof q.K&&(g.absent=!1)}),yield s.E.stateManager.after(0,m.f.settings.autoBackup>-1&&m.f.settings.autoBackupFinish&&(0==m.f.settings.autoBackup||(s.E.game.revision+s.E.game.revisionOffset)%m.f.settings.autoBackup!=0)),e.close()}).apply(this,arguments)}restart(){this.waitForClose=!0,s.E.stateManager.before("finishScenario.restart",...s.E.scenarioManager.scenarioUndoArgs()),s.E.scenarioManager.finishScenario(this.gameManager.game.scenario,this.success,this.conclusion,!0,!1,m.f.settings.scenarioRewards&&(this.characterProgress||this.forceCampaign),this.gainRewards||this.forceCampaign,!1),s.E.stateManager.after(1e3),this.close()}close(){(0,V.co)(this.dialogRef)}unlocked(e){return-1!=s.E.game.unlockedCharacters.indexOf(this.scenario.edition+":"+e)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-scenario-summary"]],standalone:!1,decls:20,vars:18,consts:[[1,"scroll-container"],[1,"header"],[1,"title"],[3,"ghs-label"],[1,"name"],[1,"text-white",3,"ghs-label"],[1,"success"],[1,"conclusion"],[1,"casual"],[1,"failure"],[1,"main",3,"ngClass"],[1,"table",3,"--ghs-summary-columns"],[1,"rewards"],[1,"reward","warning"],[1,"reward"],[1,"buttons",3,"ngClass"],[1,"table"],[1,"head-col","first"],[1,"first"],[1,"head-col","calc-col"],[1,"calc-col"],[1,"head-col"],[1,"icon","character-icon",3,"click","src"],[1,"name",3,"ngClass"],[1,"absent-icon-container",3,"ngClass"],[1,"ghs-svg","absent-icon",3,"click","src","ghs-label","ghs-label-attribute"],["type","number","min","0",3,"change","max","value"],[1,"text-white",3,"ghs-label","ghs-label-args"],[3,"ghs-label","ghs-tooltip"],[1,"gold"],["src","./assets/images/fh/loot/money.svg",1,"ghs-svg"],[1,"ghs-svg",3,"src"],[1,"loot"],[1,"xp"],[1,"level-up",3,"ghs-tooltip","ghs-label-args"],["src","./assets/images/arrow-up.svg",1,"ghs-svg"],[1,"treasures"],[1,"hint-container"],[1,"treasure","hint-trigger"],[1,"hint","above","center"],[1,"text","placeholder","text-white",3,"edition","index","rewardResults"],[1,"head-col",3,"click"],[3,"ghs-label","ghs-label-args"],[3,"item","flipped"],["type","checkbox",3,"change","disabled","checked"],[3,"click","item","flipped"],[1,"battlegoals"],[1,"battlegoal"],[1,"battlegoal-list"],[1,"checkmarks"],["type","checkbox",3,"checked"],[1,"level-up",3,"ghs-tooltip"],[1,"battlegoal",3,"click"],[3,"identifier","flipped"],["type","checkbox",3,"disabled","checked"],["type","checkbox",3,"change","checked"],[1,"trials"],[1,"trial"],[1,"checkmark"],[1,"trial",3,"click"],["src","./assets/images/fh/trials/trial.png"],[1,"head-col","stats-toggle",3,"click","ghs-label"],[1,"stats-header"],[1,"scenario-stats"],[1,"text-white",3,"ghs-label","ghs-label-args","ghs-tooltip"],[1,"text-white",3,"ghs-label","ghs-label-args","style","ghs-tooltip"],[1,"list"],[1,"item"],[3,"click"],[1,"reward","locations"],[1,"reward","achievements"],[1,"placeholder","text-white",3,"ghs-label"],[1,"item","location"],[1,"item","location","choose"],["type","radio","name","chooseLocation",3,"change","value","checked"],[1,"item","achievement"],[1,"placeholder","text-white","hint",3,"ghs-label"],[1,"placeholder","text-white",3,"ghs-label","ghs-label-args"],["type","number","min","-1",3,"change","value"],[1,"item","envelope"],[1,"item","gold"],[1,"item","experience"],[1,"item","collectiveGold"],[1,"item","resources"],[1,"item","collective-resources"],[1,"item","reputation"],[1,"item","reputation","faction"],[1,"item","prosperity"],[1,"item","inspiration"],[1,"item","morale"],[1,"item","perks"],[1,"item","battleGoals"],[1,"item","items"],[1,"item","chooseItem"],[1,"item","item-designs"],[1,"item","item-blueprints"],[1,"item","events"],[1,"item","overlay-sticker"],[1,"list-inline","unlock-character"],[1,"item","character"],[1,"item","custom"],[1,"item","event-deck"],[1,"item","loot-deck-cards"],[1,"item","town-guard-am"],[1,"placeholder","text-white",3,"click","ghs-label","ghs-label-args"],[1,"item","character","choose",3,"ngClass"],["type","radio","name","chooseUnlockCharacter",3,"value","checked"],["type","radio","name","chooseUnlockCharacter",3,"change","value","checked"],[1,"item","challenges"],[1,"menu"],[1,"cards"],[1,"card"],[3,"click","challenge","flipped"],[1,"item","week"],[1,"item","summer"],[1,"item","winter"],[1,"item","week-sections"],[1,"week-section","text-white",3,"ghs-label","ghs-label-args"],[1,"week-section","text-white",3,"click","ghs-label","ghs-label-args"],[1,"cancel",3,"click"],[1,"links"],[1,"apply"],[1,"restart"],[1,"text"],[1,"apply","forced-link"],[1,"apply","forced-link",3,"click"],[1,"link"],[1,"link",3,"click"],[1,"apply",3,"click"],[1,"restart",3,"click"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"span",2),t.nrm(3,"span",3),t.j41(4,"span",4),t.nVh(5,pM,2,1,"span"),t.nrm(6,"span",5),t.k0s()(),t.nVh(7,uM,2,1,"span",6),t.nVh(8,fM,2,1,"span",7),t.nVh(9,CM,2,1,"span",8),t.nVh(10,MM,2,1,"span",9),t.k0s(),t.j41(11,"div",10),t.nVh(12,av,40,22,"div",11),t.j41(13,"div",12),t.nVh(14,sv,8,3,"div",13),t.nVh(15,gv,7,4,"div",13),t.nVh(16,OP,10,10),t.nVh(17,wP,7,3,"div",14),t.nVh(18,SP,11,8,"div",14),t.k0s()(),t.nVh(19,LP,6,7,"div",15),t.k0s()),2&a&&(t.R7$(3),t.Y8G("ghs-label",n.conclusionOnly?"scenario.conclusion":n.rewardsOnly?"scenario.summary.rewards":"scenario.summary"),t.R7$(2),t.vxM(n.scenario.index&&!n.scenario.hideIndex?5:-1),t.R7$(),t.Y8G("ghs-label",n.gameManager.scenarioManager.scenarioTitle(n.scenario,n.conclusionOnly)),t.R7$(),t.vxM(!n.success||n.conclusionOnly||n.rewardsOnly?-1:7),t.R7$(),t.vxM(n.conclusion&&n.conclusion!=n.scenario?8:-1),t.R7$(),t.vxM(!n.success||n.gameManager.game.party.campaignMode||n.rewardsOnly?-1:9),t.R7$(),t.vxM(n.success?-1:10),t.R7$(),t.Y8G("ngClass",t.l_i(15,cM,"fh"==n.settingsManager.settings.theme,"modern"==n.settingsManager.settings.theme)),t.R7$(),t.vxM(n.characters.length>0&&(n.characterProgress||n.forceCampaign)&&n.settingsManager.settings.characterSheet&&!n.conclusionOnly&&!n.rewardsOnly&&!n.gameManager.bbRules()?12:-1),t.R7$(2),t.vxM(!n.conclusionOnly&&n.alreadyWarning&&n.gameManager.game.party.campaignMode?14:-1),t.R7$(),t.vxM(n.conclusionOnly||n.gameManager.game.party.campaignMode?-1:15),t.R7$(),t.vxM(!n.alreadyWarning&&n.gameManager.game.party.campaignMode||n.forceCampaign?16:-1),t.R7$(),t.vxM(n.hasBonus()?17:-1),t.R7$(),t.vxM(n.addWeek()?18:-1),t.R7$(),t.vxM(n.conclusionOnly&&n.alreadyWarning||n.rewardsOnly?-1:19))},dependencies:[N.YU,aa,Ci,tt,ft,je,Pn,Tt,Cn],styles:['.header[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-family:var(--ghs-font-title);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));margin-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;flex-direction:column}.header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{text-align:center;color:var(--ghs-color-white);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.header[_ngcontent-%COMP%]   .failure[_ngcontent-%COMP%]{color:var(--ghs-color-red);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor))}.header[_ngcontent-%COMP%]   .success[_ngcontent-%COMP%]{color:var(--ghs-color-green);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor))}.header[_ngcontent-%COMP%]   .casual[_ngcontent-%COMP%]{color:var(--ghs-color-red);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor))}.header[_ngcontent-%COMP%]   .conclusion[_ngcontent-%COMP%]{text-align:center;color:var(--ghs-color-gray);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.main[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap-reverse;height:100%}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]{--ghs-summary-columns: 5;font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));display:grid;grid-template-columns:repeat(var(--ghs-summary-columns),auto);padding-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));color:var(--ghs-color-white);overflow:auto}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-white)}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%], .main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .absent-icon[_ngcontent-%COMP%]{cursor:pointer}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%]:hover, .main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .absent-icon[_ngcontent-%COMP%]:hover{opacity:.7}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .character-icon.absent-icon[_ngcontent-%COMP%], .main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .absent-icon.absent-icon[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .absent[_ngcontent-%COMP%]{text-decoration:line-through}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .gold[_ngcontent-%COMP%], .main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .xp[_ngcontent-%COMP%], .main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .gold.gold[_ngcontent-%COMP%], .main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .xp.gold[_ngcontent-%COMP%], .main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .loot.gold[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .gold.xp[_ngcontent-%COMP%], .main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .xp.xp[_ngcontent-%COMP%], .main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .loot.xp[_ngcontent-%COMP%]{color:var(--ghs-color-blue)}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .level-up[_ngcontent-%COMP%]{position:absolute;right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:100%;margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-normal);font-size:.7em}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .level-up[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1em;width:auto;margin-left:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;text-align:center;padding:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));border-bottom:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-white);border-right:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-darkgray)}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%] > span.stats-header[_ngcontent-%COMP%]{border:none}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-weight:700;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));flex-direction:row;justify-content:flex-end;background-image:url(dialog_background.fa4ff388462f6a00.png);position:sticky;left:0;z-index:1}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col.calc-col[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:.6}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col.stats-toggle[_ngcontent-%COMP%]{cursor:pointer;border:none;grid-column:span 2;justify-content:flex-start}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .calc-col[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:.6}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .first[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);border-top:none}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{flex-grow:1;width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));text-align:center}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .battlegoals[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .battlegoals[_ngcontent-%COMP%]   .battlegoal[_ngcontent-%COMP%]{display:flex;justify-content:center}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .battlegoals[_ngcontent-%COMP%]   .battlegoal[_ngcontent-%COMP%]   ghs-battlegoal[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 12 * var(--ghs-dialog-factor))}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .battlegoals[_ngcontent-%COMP%]   .battlegoal-list[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap;max-width:calc(var(--ghs-unit) * 38 * var(--ghs-dialog-factor));max-height:calc(var(--ghs-unit) * 34 * var(--ghs-dialog-factor));padding:0 calc(var(--ghs-unit) * 1);overflow:auto}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .battlegoals[_ngcontent-%COMP%]   .checkmarks[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;text-align:center}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .trials[_ngcontent-%COMP%]{display:flex;align-items:center}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .trials[_ngcontent-%COMP%]   .trial[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .trials[_ngcontent-%COMP%]   .trial[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .trials[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;text-align:center}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);justify-content:center;align-items:center}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;background-image:url(treasure.0792d529e76ec279.png);background-size:contain;background-repeat:no-repeat;background-position:center;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));color:var(--ghs-color-black);width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   ghs-item[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 12 * var(--ghs-dialog-factor))}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .scenario-stats[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .scenario-stats[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.main[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .scenario-stats[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:auto}.main.fh[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.main.modern[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.rewards[_ngcontent-%COMP%]{color:var(--ghs-color-white);display:flex;flex-direction:column;min-width:0;max-width:calc(var(--ghs-unit) * 35 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-brown);font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;width:100%;height:100%;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-text);padding-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:0;background:linear-gradient(180deg,var(--ghs-color-brown) 0%,var(--ghs-color-brown) calc(100% - var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor)),transparent 100%);opacity:.2;filter:brightness(20);border-top-left-radius:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor));border-top-right-radius:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor));z-index:0}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;z-index:1;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.location[_ngcontent-%COMP%], .rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.character[_ngcontent-%COMP%]{flex-direction:row;align-items:flex-end;margin:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.character[_ngcontent-%COMP%]   .placeholder[_ngcontent-%COMP%]{white-space:nowrap}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.choose[_ngcontent-%COMP%]{cursor:pointer;color:var(--ghs-color-white);justify-content:flex-start;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-text)}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.choose[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-family:var(--ghs-font-normal);color:var(--ghs-color-gray);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.disabled[_ngcontent-%COMP%], .rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.character.unlocked[_ngcontent-%COMP%]{pointer-events:none}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.character.unlocked[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:50%;left:0;right:0;height:.1em;background-color:var(--ghs-color-white);transform:translateY(-50%);z-index:2}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.challenges[_ngcontent-%COMP%]{flex-direction:column;justify-content:center;align-items:center;margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.challenges[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%], .rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.challenges[_ngcontent-%COMP%]   .cards[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.challenges[_ngcontent-%COMP%]   .cards[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.challenges[_ngcontent-%COMP%]   .cards[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   ghs-challenge-card[_ngcontent-%COMP%]{cursor:pointer;display:block;width:calc(var(--ghs-unit) * 12 * var(--ghs-dialog-factor));color:initial}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.week-sections[_ngcontent-%COMP%]   .week-section[_ngcontent-%COMP%]{cursor:pointer}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .location[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{display:flex;justify-content:center;width:1.5em;height:1.5em;font-size:1em;color:var(--ghs-color-black);background-color:var(--ghs-color-white);border-radius:100%;border:2px solid var(--ghs-color-black);margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list-inline[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-end;flex-wrap:wrap}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list-inline[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{margin:0 .1em}.rewards[_ngcontent-%COMP%]   .reward[_ngcontent-%COMP%]   .list-inline[_ngcontent-%COMP%]   .choose[_ngcontent-%COMP%]{align-items:flex-end}.rewards[_ngcontent-%COMP%]   .reward.warning[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.rewards[_ngcontent-%COMP%]   .reward.warning[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.buttons[_ngcontent-%COMP%]{display:flex;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly;align-items:center}.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));display:flex;justify-content:center}.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.buttons[_ngcontent-%COMP%]   .apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.buttons[_ngcontent-%COMP%]   .links[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.buttons[_ngcontent-%COMP%]   .links[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white);white-space:nowrap}.buttons.denied[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{pointer-events:initial}']})}return i})();const UP=(i,r)=>({flipped:i,"no-animations":r}),qP=()=>[],tn=(i,r)=>({value:i,"value-highlight":r}),HP=(i,r)=>({"with-header":i,edit:r}),KP=i=>({checked:i});function WP(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.JRh(e.loot.value4P>0?""+e.loot.value4P:"")}}function JP(i,r){if(1&i&&(t.nrm(0,"span",15),t.EFF(1,"/ "),t.nrm(2,"span",15)),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.l_i(4,tn,e.highlight,e.highlight&&e.gameManager.characterManager.characterCount()>2))("ghs-label","%game.loot.player.3-4% +"+e.loot.value4P),t.R7$(2),t.Y8G("ngClass",t.l_i(7,tn,e.highlight,e.highlight&&e.gameManager.characterManager.characterCount()<=2))("ghs-label","%game.loot.player.2% +"+e.loot.value2P)}}function ZP(i,r){if(1&i&&(t.nrm(0,"span",15),t.EFF(1,"/ "),t.nrm(2,"span",15)),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.l_i(4,tn,e.highlight,e.highlight&&e.gameManager.characterManager.characterCount()>=4))("ghs-label","%game.loot.player.4% +"+e.loot.value4P),t.R7$(2),t.Y8G("ngClass",t.l_i(7,tn,e.highlight,e.highlight&&e.gameManager.characterManager.characterCount()<=3))("ghs-label","%game.loot.player.2-3% +"+e.loot.value2P)}}function QP(i,r){if(1&i&&(t.nrm(0,"span",15),t.EFF(1,"/ "),t.nrm(2,"span",15),t.EFF(3,"/ "),t.nrm(4,"span",15)),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.l_i(6,tn,e.highlight,e.highlight&&e.gameManager.characterManager.characterCount()>3))("ghs-label","%game.loot.player.4% +"+e.loot.value4P),t.R7$(2),t.Y8G("ngClass",t.l_i(9,tn,e.highlight,e.highlight&&3==e.gameManager.characterManager.characterCount()))("ghs-label","%game.loot.player.3% +"+e.loot.value3P),t.R7$(2),t.Y8G("ngClass",t.l_i(12,tn,e.highlight,e.highlight&&e.gameManager.characterManager.characterCount()<3))("ghs-label","%game.loot.player.2% +"+e.loot.value2P)}}function tb(i,r){if(1&i&&(t.j41(0,"span",6),t.nVh(1,WP,2,1,"span"),t.nVh(2,JP,3,10),t.nVh(3,ZP,3,10),t.nVh(4,QP,5,15),t.nrm(5,"span",14),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.vxM(e.loot.value2P==e.loot.value3P&&e.loot.value3P==e.loot.value4P?1:-1),t.R7$(),t.vxM(e.loot.value4P==e.loot.value3P&&e.loot.value3P!=e.loot.value2P?2:-1),t.R7$(),t.vxM(e.loot.value4P!=e.loot.value3P&&e.loot.value3P==e.loot.value2P?3:-1),t.R7$(),t.vxM(e.loot.value4P!=e.loot.value3P&&e.loot.value3P!=e.loot.value2P?4:-1),t.R7$(),t.Y8G("ghs-label","game.loot."+e.loot.type)}}function eb(i,r){if(1&i&&t.nrm(0,"img",17),2&i){const e=t.XpG(2);t.Y8G("src",e.gameManager.characterManager.characterIcon(e.character),t.B4B)}}function nb(i,r){1&i&&t.nrm(0,"img",18)}function ib(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",16),t.bIt("click",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.changeCharacter(n))}),t.nVh(1,eb,1,1,"img",17),t.nVh(2,nb,1,0,"img",18),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.l_i(3,HP,e.loot.type!=e.LootType.money&&e.loot.type!=e.LootType.special1&&e.loot.type!=e.LootType.special2,e.edit&&e.settingsManager.settings.applyLoot)),t.R7$(),t.vxM(e.character?1:-1),t.R7$(),t.vxM(!e.character&&e.settingsManager.settings.applyLoot&&e.apply?2:-1)}}function ab(i,r){1&i&&t.nrm(0,"img",9)}function ob(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",20),t.bIt("singleClick",function(n){const o=t.eBV(e).$implicit,g=t.XpG(2);return t.Njj(g.toggleSection(n,o))})("doubleClick",function(n){const o=t.eBV(e).$implicit,g=t.XpG(2);return t.Njj(g.toggleSection(n,o,!0))}),t.nrm(1,"span",21),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(1,KP,a.hasSection(e)))}}function sb(i,r){if(1&i&&(t.j41(0,"span",10),t.Z7z(1,ob,2,3,"span",19,t.fX1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.sections)}}let vi=(()=>{class i{dialog;loot;index=-1;disableFlip=!1;flipped=!1;reveal=!1;edit=!1;looted=!1;highlight=!0;apply=!0;character="";gameManager=s.E;settingsManager=m.f;LootType=ot.r6;revealed=!1;animate=!1;sections=[];constructor(e){this.dialog=e}ngOnInit(){this.animate=!this.disableFlip,(this.loot.type==ot.r6.special1||this.loot.type==ot.r6.special2)&&this.loot.value&&(this.sections=this.loot.value.split("|"))}onChange(e){this.revealed=e}ngOnChanges(e){const a=e.flipped;a&&!this.disableFlip&&a.currentValue&&a.currentValue!=a.previousValue&&(this.animate=!0),(this.loot.type==ot.r6.special1||this.loot.type==ot.r6.special2)&&this.loot.value&&(this.sections=this.loot.value.split("|"))}hasSection(e){return null!=s.E.game.party.conclusions.find(a=>a.edition==s.E.currentEdition()&&a.index==e)}toggleSection(e,a,n=!1){if(this.hasSection(a))n&&(s.E.stateManager.before("unsetLootCardSection",a),s.E.game.party.conclusions=s.E.game.party.conclusions.filter(o=>o.edition!=s.E.currentEdition()||o.index!=a),s.E.stateManager.after());else{const o=s.E.sectionData(s.E.currentEdition()).find(g=>g.index==a&&g.conclusion);o&&!n?this.dialog.open(Yt,{panelClass:["dialog"],data:{scenario:o,conclusionOnly:!0}}).closed.subscribe({next:()=>{if(this.hasSection(a)){if(s.E.stateManager.before("setLootCardSection",a),s.E.game.lootDeckSections.push(a),this.character&&o.rewards){const g=s.E.game.figures.find(_=>_ instanceof q.K&&_.name==this.character);g instanceof q.K&&(o.rewards.lootingGold&&(g.progress.gold+=(0,$.hZ)(o.rewards.lootingGold)),o.rewards.items&&o.rewards.items.forEach(_=>{g.progress.items.find(y=>y.edition==s.E.currentEdition()&&y.name==_)||g.progress.items.push(new vt.gw(_,s.E.currentEdition()))}))}o.rewards&&o.rewards.removeLootDeckCards&&o.rewards.removeLootDeckCards.forEach(g=>{const _=ot.Di.find(y=>y.cardId==g);_&&-1!=s.E.game.lootDeckFixed.indexOf(_.type)&&s.E.game.lootDeckFixed.splice(s.E.game.lootDeckFixed.indexOf(_.type),1)}),s.E.stateManager.after()}}}):(s.E.stateManager.before("setLootCardSection",a),s.E.game.lootDeckSections.push(a),s.E.game.party.conclusions.push(new ht.Ag(a,s.E.currentEdition())),s.E.stateManager.after())}e.stopPropagation(),e.preventDefault()}changeCharacter(e){m.f.settings.applyLoot&&(this.edit||!this.character)&&(e.preventDefault(),e.stopPropagation(),this.dialog.open(ts,{panelClass:["dialog"],data:{loot:this.loot,selected:this.character,edit:this.edit}}).closed.subscribe({next:n=>{if("string"==typeof n){const o=s.E.game.figures.find(_=>_ instanceof q.K&&_.name==this.character);let g;if(o instanceof q.K&&o.name!=n&&(this.loot.type==ot.r6.random_item&&n?g=o.progress.equippedItems.find(_=>"loot-random-item"==_.marker):(s.E.stateManager.before("removeLootCard",s.E.characterManager.characterName(o),"game.loot."+this.loot.type,s.E.lootManager.getValue(this.loot)),o.lootCards=o.lootCards.filter(_=>_!=this.index),(this.loot.type==ot.r6.money||this.loot.type==ot.r6.special1||this.loot.type==ot.r6.special2)&&(o.loot-=s.E.lootManager.getValue(this.loot)),this.loot.type==ot.r6.random_item&&(g=o.progress.equippedItems.find(_=>"loot-random-item"==_.marker),g&&(o.progress.items=o.progress.items.filter(_=>g&&(_.edition!=g.edition||_.name!=g.name)),o.progress.equippedItems=o.progress.equippedItems.filter(_=>g&&(_.edition!=g.edition||_.name!=g.name)))),s.E.stateManager.after())),n&&(!o||o.name!=n)){const _=s.E.game.figures.find(y=>y instanceof q.K&&y.name==n);if(_ instanceof q.K)if(this.loot.type!=ot.r6.random_item)s.E.stateManager.before("addLootCard",s.E.characterManager.characterName(_),"game.loot."+this.loot.type,s.E.lootManager.getValue(this.loot)),s.E.lootManager.applyLoot(this.loot,_,this.index),s.E.stateManager.after();else{let y=g?s.E.itemManager.getItem(g.name,g.edition,!0):void 0;y||(y=s.E.lootManager.applyLoot(this.loot,_,this.index)),y&&this.dialog.open(pa,{panelClass:["dialog"],data:{item:y,character:_}}).closed.subscribe({next:B=>{if(B){const nt=B;s.E.stateManager.before("lootRandomItem",nt.id,nt.edition,nt.name,s.E.characterManager.characterName(_));let Z=new vt.gw(""+nt.id,nt.edition);s.E.itemManager.addItemCount(nt),-1==_.lootCards.indexOf(this.index)&&(_.lootCards.push(this.index),_.lootCards.sort((W,et)=>W-et)),null!=_.progress.items.find(W=>W.name==""+nt.id&&W.edition==nt.edition)?_.progress.gold+=s.E.itemManager.itemSellValue(nt):(_.progress.items.push(Z),_.progress.equippedItems.push(new vt.h5(Z.name,Z.edition,void 0,"loot-random-item"))),g&&o instanceof q.K&&(o.lootCards=o.lootCards.filter(W=>W!=this.index),o.progress.items=o.progress.items.filter(W=>g&&(W.edition!=g.edition||W.name!=g.name)),o.progress.equippedItems=o.progress.equippedItems.filter(W=>"loot-random-item"!=W.marker)),s.E.stateManager.after()}else _.lootCards=_.lootCards.filter(nt=>nt!=this.index)}})}}}}}))}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-loot"]],inputs:{loot:"loot",index:"index",disableFlip:"disableFlip",flipped:"flipped",reveal:"reveal",edit:"edit",looted:"looted",highlight:"highlight",apply:"apply",character:"character"},standalone:!1,features:[t.OA$],decls:18,vars:24,consts:[["card",""],["card-reveal","",1,"card",3,"change","ngClass","disabled"],[1,"card-back","back"],[1,"revealed"],[1,"text",3,"ghs-label"],[1,"card-front","front",3,"ngClass"],[1,"header"],[1,"character",3,"ngClass"],[1,"enhancements"],["src","./assets/images/fh/loot/plus1.svg",1,"icon"],[1,"sections"],[1,"card-id"],[1,"footer"],[1,"icon"],[3,"ghs-label"],[3,"ngClass","ghs-label"],[1,"character",3,"click","ngClass"],[3,"src"],["src","./assets/images/warning.svg",1,"warning"],["ghs-pointer-input","",1,"section"],["ghs-pointer-input","",1,"section",3,"singleClick","doubleClick"],[1,"checkbox",3,"ngClass"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div")(1,"div",1,0),t.bIt("change",function(_){return t.eBV(o),t.Njj(n.onChange(_))}),t.j41(3,"div",2)(4,"span",3),t.nrm(5,"span",4),t.k0s()(),t.j41(6,"div",5),t.nVh(7,tb,6,5,"span",6),t.nVh(8,ib,3,6,"span",7),t.j41(9,"span",8),t.Z7z(10,ab,1,0,"img",9,t.fX1),t.nI1(12,"ghsRange"),t.k0s(),t.nVh(13,sb,3,0,"span",10),t.j41(14,"span",11),t.EFF(15),t.k0s(),t.j41(16,"span",12),t.nrm(17,"span",13),t.k0s()()()()}if(2&a){const o=t.sdS(2);t.HbH(t.VkB("loot ",n.loot.type)),t.R7$(),t.xc7("font-size",.08*o.offsetWidth+"px"),t.Y8G("ngClass",t.l_i(20,UP,n.flipped||n.revealed,!n.animate))("disabled",!n.reveal),t.R7$(4),t.Y8G("ghs-label","game.cards.confirmReveal"),t.R7$(),t.xc7("background-image","url(./assets/images/fh/loot/loot-"+n.loot.type+(n.loot.type==n.LootType.money?n.gameManager.lootManager.getValue(n.loot,!1):"")+".png)"),t.Y8G("ngClass",n.loot.type),t.R7$(),t.vxM(n.loot.type!=n.LootType.money&&n.loot.type!=n.LootType.special1&&n.loot.type!=n.LootType.special2?7:-1),t.R7$(),t.vxM(n.looted||n.character?8:-1),t.R7$(2),t.Dyx(t.i5U(12,17,t.lJ4(23,qP),n.loot.enhancements)),t.R7$(3),t.vxM(n.sections.length>0?13:-1),t.R7$(2),t.SpI(" ",n.loot.cardId," * "),t.R7$(2),t.xc7("background-image","url(./assets/images/fh/loot/"+(n.loot.type==n.LootType.special1||n.loot.type==n.LootType.special2?n.LootType.money:n.loot.type)+".svg)")}},dependencies:[N.YU,Be,tt,rt,Tt],styles:['.loot[_ngcontent-%COMP%]{position:absolute;inset:0;display:block}.loot[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{transition:transform calc(var(--ghs-animation-speed) * .5s) cubic-bezier(.75,0,.85,1)}.loot[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%]{background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(loot-back.b3962872f80142fe.png);border-radius:5%}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]{display:flex;position:relative;top:0;left:0;width:100%;height:100%;border-radius:5%;background-position:center;background-size:100% auto;background-repeat:no-repeat}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;position:absolute;top:0;left:0;width:100%;height:10%;font-size:1.3em;text-align:center;white-space:nowrap}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:.7em;opacity:.7}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .value.value-highlight[_ngcontent-%COMP%]{opacity:1;font-size:1.1em}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:20%;display:flex;justify-content:center;align-items:center;z-index:2}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .character.with-header[_ngcontent-%COMP%]{top:10%}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .character.edit[_ngcontent-%COMP%]{cursor:pointer}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:auto;filter:var(--ghs-filter-outline)}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   img.warning[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-outline);height:60%;margin-left:5%}.loot[_ngcontent-%COMP%]   .front.special1[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%], .loot[_ngcontent-%COMP%]   .front.special2[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{left:initial;right:0;width:60%;justify-content:flex-start}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]{position:absolute;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;top:50%;left:50%;height:50%;width:100%;transform:translate(-50%,-50%);z-index:1}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:20%;height:auto;margin:5%}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]{display:flex;flex-direction:column;font-size:1em;position:absolute;top:1em;left:.4em;z-index:2}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{cursor:pointer;position:relative;width:4em;height:.9em;margin-bottom:.8em}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{display:inline-block;position:relative;width:.9em;height:.9em;color:var(--ghs-color-black);border:.2em solid var(--ghs-color-black);background-color:var(--ghs-color-white);margin:0!important}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:before{position:absolute;left:5%;top:-35%;content:" ";width:130%;height:130%;transform:scale(0);transform-origin:bottom left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;clip-path:polygon(14% 44%,0 65%,50% 100%,100% 16%,80% 0%,43% 62%);color:var(--ghs-color-gray);background-color:var(--ghs-color-gray)}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .checkbox.checked[_ngcontent-%COMP%]:before{transform:scale(1);color:var(--ghs-color-black);background-color:var(--ghs-color-black)}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:hover   .checkbox[_ngcontent-%COMP%]:before{transform:scale(1);color:var(--ghs-color-gray);background-color:var(--ghs-color-gray)}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;font-size:.8em;width:20%;height:5%;display:flex;justify-content:center;align-content:center}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{position:absolute;display:flex;justify-content:center;align-items:center;bottom:0%;left:50%;height:12%;width:20%;transform:translate(-50%);border-top-left-radius:25%;border-top-right-radius:25%}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:80%;height:80%;background-size:contain;background-position:center center;background-repeat:no-repeat}.loot[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .bg-click[_ngcontent-%COMP%]{position:absolute;inset:0}.loot[_ngcontent-%COMP%]   .confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center;color:var(--ghs-color-white);font-size:1.3em;filter:drop-shadow(calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) var(--ghs-color-black))}.loot[_ngcontent-%COMP%]   .confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{text-align:center}']})}return i})();const rb=i=>({"random-item":i}),cb=(i,r)=>r.cardId;function lb(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",7),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.randomItem(n)&&o.randomItemDialog(n))}),t.nrm(1,"ghs-loot",8),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ngClass",t.eq3(4,rb,a.randomItem(e))),t.R7$(),t.Y8G("loot",e)("flipped",!0)("disableFlip",!0)}}function gb(i,r){if(1&i&&(t.j41(0,"div",5),t.Z7z(1,lb,2,6,"div",6,cb),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.lootCards)}}let db=(()=>{class i{character;dialogRef;dialog;gameManager=s.E;lootCards=[];sorted=!1;constructor(e,a,n){this.character=e,this.dialogRef=a,this.dialog=n,this.character.lootCards&&this.character.lootCards.forEach(o=>this.lootCards.push(s.E.game.lootDeck.cards[o]))}sort(){this.sorted?(this.sorted=!1,this.lootCards=[],this.character.lootCards&&this.character.lootCards.forEach(e=>this.lootCards.push(s.E.game.lootDeck.cards[e]))):(this.sorted=!0,this.lootCards.sort((e,a)=>e.cardId-a.cardId))}randomItem(e){if(e.type==ot.r6.random_item){const a=this.character.progress.equippedItems.find(n=>"loot-random-item"==n.marker);if(a)return s.E.itemManager.getItem(a.name,a.edition,!0)}}randomItemDialog(e){const a=this.randomItem(e);a&&this.dialog.open(Me,{panelClass:["fullscreen-panel"],disableClose:!0,data:{item:a}})}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-character-loot-cards"]],standalone:!1,decls:6,vars:2,consts:[[1,"loot-cards-dialog"],[1,"scroll-container"],[1,"menu"],[3,"click"],[3,"ghs-label"],[1,"loot-cards"],[1,"loot-container",3,"ngClass"],[1,"loot-container",3,"click","ngClass"],[3,"loot","flipped","disableFlip"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),t.bIt("click",function(){return n.sort()}),t.nrm(4,"span",4),t.k0s()(),t.nVh(5,gb,3,0,"div",5),t.k0s()()),2&a&&(t.R7$(4),t.Y8G("ghs-label",n.sorted?"character.lootCards.drawn":"character.lootCards.sort"),t.R7$(),t.vxM(n.character.lootCards?5:-1))},dependencies:[N.YU,tt,vi],styles:[".loot-cards-dialog[_ngcontent-%COMP%]{position:relative}.loot-cards-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;flex-wrap:wrap;max-width:calc(var(--ghs-unit) * 60 * var(--ghs-dialog-factor))}.loot-cards-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.loot-cards-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.loot-cards-dialog[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-evenly;align-items:center;overflow-y:auto;overflow-x:hidden;width:calc(var(--ghs-unit) * 57 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.loot-cards-dialog[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]{position:relative;display:flex;transition:none;width:calc(var(--ghs-unit) * 25.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 38.25 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) 0;flex-shrink:0;flex-grow:0}.loot-cards-dialog[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-container.random-item[_ngcontent-%COMP%]{cursor:pointer}.loot-cards-dialog[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]   ghs-loot[_ngcontent-%COMP%]{position:absolute;display:flex;top:0;left:0;width:100%;height:100%;z-index:1}"]})}return i})();var fa=M(58167);const hb=()=>[],_b=i=>({active:i}),zn=i=>({disabled:i}),os=i=>({fh:i}),mb=i=>[i],pb=(i,r)=>r.edition+"-"+r.name;function ub(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",10),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.selectColor(n))}),t.j41(1,"span",11),t.nrm(2,"img",12),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ngClass",t.eq3(3,_b,e==a.summonColor)),t.R7$(2),t.Y8G("src",t.VkB("./assets/images/summons/",e,".png"),t.B4B)}}function fb(i,r){if(1&i&&t.Z7z(0,ub,3,5,"span",9,t.fX1),2&i){const e=t.XpG();t.Dyx(e.summonColors)}}function Cb(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",13),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.pickNumber(n+1))}),t.j41(1,"span",14),t.EFF(2),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(2,zn,a.summonNumber==e+1)),t.R7$(2),t.JRh(e+1)}}function Mb(i,r){1&i&&t.nrm(0,"img",18)}function vb(i,r){if(1&i&&t.nrm(0,"img",12),2&i){const e=t.XpG(3);t.Y8G("src",t.VkB("./assets/images/summons/",e.summonColor,".png"),t.B4B)}}function Ob(i,r){if(1&i&&t.nrm(0,"span",20),2&i){const e=t.XpG(2).$implicit;t.Y8G("ghs-label","character.summon.level")("ghs-label-args",t.eq3(2,mb,e.level||1))}}function Pb(i,r){if(1&i&&(t.nrm(0,"span",21),t.j41(1,"span",22),t.nrm(2,"img",12),t.k0s()),2&i){const e=t.XpG(2).$implicit;t.R7$(2),t.Y8G("src",e.thumbnailUrl?e.thumbnailUrl:"./assets/images/summons/thumbnail/"+e.edition+"-"+e.name+".png",t.B4B)}}function bb(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",15),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.addSummon(n))}),t.j41(1,"span",16)(2,"span",17),t.nVh(3,Mb,1,0,"img",18),t.nVh(4,vb,1,2,"img",12),t.j41(5,"span",19),t.EFF(6),t.k0s()()(),t.j41(7,"label"),t.nrm(8,"span",3),t.nVh(9,Ob,1,4,"span",20),t.k0s(),t.nVh(10,Pb,3,1),t.k0s()}if(2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG();t.Y8G("ngClass",t.eq3(8,zn,-1==o.summonNumbers[n]||!o.available(a,o.summonNumber||o.summonNumbers[n]))),t.R7$(2),t.Y8G("ngClass",t.eq3(10,os,o.fhSummon)),t.R7$(),t.vxM(!o.fhSummon&&a.special?3:-1),t.R7$(),t.vxM(o.fhSummon||a.special?-1:4),t.R7$(2),t.JRh(o.summonNumber?o.summonNumber:-1!=o.summonNumbers[n]?o.summonNumbers[n]:"-"),t.R7$(2),t.Y8G("ghs-label","data.summon."+a.name),t.R7$(),t.vxM(o.showLevel(a)?9:-1),t.R7$(),t.vxM(a.thumbnail&&!a.noThumbnail||a.thumbnailUrl?10:-1)}}function kb(i,r){if(1&i&&t.nVh(0,bb,11,12,"span",8),2&i){const e=r.$index,a=t.XpG();t.vxM(a.showAll||-1!=a.summonNumbers[e]?0:-1)}}function yb(i,r){if(1&i&&t.nrm(0,"img",12),2&i){const e=t.XpG(2);t.Y8G("src",t.VkB("./assets/images/summons/",e.summonColor,".png"),t.B4B)}}function xb(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",8)(1,"span",10),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.addCustomSummon())}),t.j41(2,"span",17),t.nVh(3,yb,1,2,"img",12),t.j41(4,"span",19),t.EFF(5),t.k0s()()(),t.j41(6,"input",23),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setSummonName(n))})("keyup",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setSummonName(n))}),t.k0s(),t.j41(7,"span",24),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.addCustomSummon())}),t.nrm(8,"img",25),t.k0s()()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(9,zn,!e.summonNumber)),t.R7$(),t.Y8G("ngClass",t.eq3(11,zn,e.customDisabled())),t.R7$(),t.Y8G("ngClass",t.eq3(13,os,e.fhSummon)),t.R7$(),t.vxM(e.fhSummon?-1:3),t.R7$(2),t.JRh(e.summonNumber?e.summonNumber:"-"),t.R7$(),t.Y8G("value",e.summonName)("ghs-label","summon.name")("ghs-label-attribute","placeholder"),t.R7$(),t.Y8G("ngClass",t.eq3(15,zn,e.customDisabled()))}}let Eb=(()=>{class i{character;dialogRef;gameManager=s.E;summonColors=Object.values(lt.rX).filter(e=>e!=lt.rX.custom&&e!=lt.rX.fh);summonColor=lt.rX.blue;summonNumber;summonName="";summonFilter;fhSummon=!1;summonData=[];summonNumbers=[];showAll=!1;constructor(e,a){if(this.character=e,this.dialogRef=a,this.summonFilter="",this.fhSummon="fh"===this.character.edition||-1!=s.E.editionExtensions(this.character.edition).indexOf("fh"),this.fhSummon&&(this.summonColor=lt.rX.fh),this.updateSummonData(),!this.fhSummon){this.summonNumber=1;for(let n=2;n<9;n++)this.summonData.filter(o=>this.available(o,n))>this.summonData.filter(o=>this.available(o,n-1))&&(this.summonNumber=n)}}pickNumber(e){this.summonNumber=this.summonNumber==e?void 0:e}selectColor(e){this.summonColor=e}available(e,a){return this.summonColor!=lt.rX.custom&&0!=a&&this.character.summons.every(n=>n.dead||n.name!=e.name||(e.special?0!=n.number:n.number!=a)||(e.special?n.color!=lt.rX.custom:n.color!=this.summonColor))&&(e.count||1)>this.character.summons.filter(n=>n.name==e.name&&n.cardId==e.cardId&&s.E.entityManager.isAlive(n)).length}customDisabled(){return this.character.summons.some(e=>s.E.entityManager.isAlive(e)&&e.name==this.summonName&&e.number==this.summonNumber&&e.color==this.summonColor)}showLevel(e){return this.summonData.some(a=>a.name==e.name&&a.cardId!=e.cardId&&e.level!=a.level)}updateSummonData(){let e=[];if(e.push(...this.character.availableSummons.filter(a=>!a.level||a.level<=this.character.level)),m.f.settings.characterItems){if(this.character.progress&&this.character.progress.items)for(let a of this.character.progress.items){const n=s.E.itemManager.getItem(a.name,a.edition,!0);n&&n.summon&&(n.summon.name||(n.summon.name=n.name),n.summon.count||(n.summon.count=1),e.push(n.summon))}}else{const a=s.E.game.edition?[s.E.game.edition,...s.E.editionExtensions(s.E.game.edition)]:s.E.editions(!1,!0);for(let n of a)s.E.itemManager.getItems(n,!0).filter(o=>o.summon).forEach(o=>{o.summon&&e.push(o.summon)})}this.summonData=e.filter(a=>!this.summonFilter||a.cardId==this.summonFilter),this.summonData.forEach((a,n)=>{this.summonNumbers[n]=-1;for(let o=1;o<9;o++)this.available(a,o)&&-1==this.summonNumbers[n]&&(this.summonNumbers[n]=o)})}setSummonName(e){this.summonName=e.target.value}addCustomSummon(){if(this.summonNumber){s.E.stateManager.before("addCustomSummon",s.E.characterManager.characterName(this.character),this.summonNumber,this.summonColor);let e=new lt.up((0,fa.v4)(),this.summonName,"",this.character.level,this.summonNumber,this.summonColor);e.state=lt.N5.new,s.E.characterManager.addSummon(this.character,e),(0,V.co)(this.dialogRef),s.E.stateManager.after(),this.updateSummonData()}}addSummon(e){const a=this.summonData.indexOf(e);if(-1!=a){s.E.stateManager.before("addSummon",s.E.characterManager.characterName(this.character),"data.summon."+e.name);let n=new lt.up((0,fa.v4)(),e.name,e.cardId,this.character.level,e.special?0:this.summonNumber||this.summonNumbers[a],e.special?lt.rX.custom:this.summonColor,e);n.state=e.special?lt.N5.true:lt.N5.new,n.init=!1,s.E.characterManager.addSummon(this.character,n),e.count&&this.character.summons.filter(o=>o.name==e.name&&o.cardId==e.cardId).length!=e.count?(this.summonFilter=e.cardId,this.summonNumber&&(this.fhSummon?this.summonNumber=void 0:(this.summonNumber++,this.summonNumber>(this.fhSummon?8:4)&&(this.summonNumber=1)))):(0,V.co)(this.dialogRef),s.E.stateManager.after(),this.updateSummonData()}}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-character-summondialog"]],standalone:!1,decls:16,vars:9,consts:[[1,"summon-dialog"],[1,"title"],[1,"icon",3,"src"],[3,"ghs-label"],[1,"container"],[1,"color-container"],[1,"number-button",3,"ngClass"],[1,"scroll-container","summons"],[1,"summon",3,"ngClass"],[1,"summon-button",3,"ngClass"],[1,"summon-button",3,"click","ngClass"],[1,"image"],[3,"src"],[1,"number-button",3,"click","ngClass"],[1,"number"],[1,"summon",3,"click","ngClass"],[1,"summon-button"],[1,"image",3,"ngClass"],["src","./assets/images/summons/custom.png"],[1,"summon-number"],[1,"level-hint",3,"ghs-label","ghs-label-args"],[1,"spacer"],[1,"thumbnail"],["type","text",3,"change","keyup","value","ghs-label","ghs-label-attribute"],[1,"add-summon-button",3,"click","ngClass"],["src","./assets/images/plus.svg",1,"ghs-svg"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"small"),t.nrm(3,"img",2),t.EFF(4),t.k0s(),t.nrm(5,"span",3),t.k0s(),t.j41(6,"div",4)(7,"div",5),t.nVh(8,fb,2,0),t.Z7z(9,Cb,3,4,"span",6,t.fX1),t.nI1(11,"ghsRange"),t.k0s(),t.j41(12,"div",7),t.Z7z(13,kb,1,1,null,null,pb),t.nVh(15,xb,9,17,"span",8),t.k0s()()()),2&a&&(t.R7$(3),t.Y8G("src",n.character.iconUrl,t.B4B),t.R7$(),t.SpI(" ",n.gameManager.characterManager.characterName(n.character)," "),t.R7$(),t.Y8G("ghs-label","summon"),t.R7$(3),t.vxM(n.fhSummon?-1:8),t.R7$(),t.Dyx(t.i5U(11,5,t.lJ4(8,hb),8)),t.R7$(4),t.Dyx(n.summonData),t.R7$(2),t.vxM(n.summonFilter?-1:15))},dependencies:[N.YU,tt,Tt],styles:[".title[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.title[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{flex-basis:100%;flex-shrink:0;display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.title[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));width:auto;margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .add-summon-button[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 6.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 6.5 * var(--ghs-dialog-factor))}.container[_ngcontent-%COMP%]   .summon-button.add-summon-button[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .add-summon-button.add-summon-button[_ngcontent-%COMP%]{position:relative;border:none!important}.container[_ngcontent-%COMP%]   .summon-button.add-summon-button[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .add-summon-button.add-summon-button[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.container[_ngcontent-%COMP%]   .summon-button.add-summon-button[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .add-summon-button.add-summon-button[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .add-summon-button[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor))}.container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .add-summon-button[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}.container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .add-summon-button[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%]{position:absolute;display:flex;justify-content:center;align-items:center;top:0;left:calc(var(--ghs-unit) * -.1 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray);border-top-left-radius:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));border-bottom-left-radius:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));z-index:1;opacity:.9}.container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]   .image.fh[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .add-summon-button[_ngcontent-%COMP%]   .image.fh[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));font-family:var(--ghs-font-gh-title);color:var(--ghs-color-white);border:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor)) solid var(--ghs-color-white);border-radius:100%}.container[_ngcontent-%COMP%]   .summon-button.active[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .add-summon-button.active[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) / 4) var(--ghs-color-white) solid;border-radius:100%}.container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]:hover, .container[_ngcontent-%COMP%]   .add-summon-button[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.container[_ngcontent-%COMP%]   .summon-button.disabled[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .add-summon-button.disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.5}.container[_ngcontent-%COMP%]   .summon-button.disabled[_ngcontent-%COMP%]:hover, .container[_ngcontent-%COMP%]   .add-summon-button.disabled[_ngcontent-%COMP%]:hover{border:none}.container[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.container[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));height:auto}.container[_ngcontent-%COMP%]   .color-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,calc(var(--ghs-unit) * 7.5 * var(--ghs-dialog-factor)));row-gap:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.container[_ngcontent-%COMP%]   .color-container[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 6.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 6.5 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.container[_ngcontent-%COMP%]   .color-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 6.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 6.5 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline)}.container[_ngcontent-%COMP%]   .color-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white);border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.container[_ngcontent-%COMP%]   .color-container[_ngcontent-%COMP%]   .number-button.disabled[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-darkgray)}.container[_ngcontent-%COMP%]   .color-container[_ngcontent-%COMP%]   .number-button.disabled[_ngcontent-%COMP%]:hover{border:none}.container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:calc(var(--ghs-unit) * 50 * var(--ghs-dialog-factor))}.container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center}.container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .level-hint[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]:hover   .summon-button[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]:hover   .summon-button.disabled[_ngcontent-%COMP%]{pointer-events:none!important;border:none}.container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]:hover   label[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{margin:0;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);background-color:transparent;border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);border-radius:calc(var(--ghs-unit) * 1);user-select:auto;-webkit-user-select:auto;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   .summon.disabled[_ngcontent-%COMP%]{pointer-events:none!important}.container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   .summon.disabled[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]{opacity:.5}.container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   .summon.disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray)}"]})}return i})();var yt=M(25532);const wb=i=>({fh:i}),ss=i=>({consume:i}),Rb=(i,r)=>r.number;function jb(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function Gb(i,r){if(1&i&&(t.j41(0,"span",4),t.nVh(1,jb,2,0,"span"),t.j41(2,"span",6),t.EFF(3),t.k0s()()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.R7$(),t.vxM(a>0?1:-1),t.R7$(),t.HbH(n.gameManager.isMonsterEntity(e)&&n.gameManager.toMonsterEntity(e).type||""),t.R7$(),t.JRh(e.number)}}function Tb(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",10),t.bIt("singleClick",function(n){const o=t.eBV(e).$implicit,g=t.XpG(3);return t.Njj(g.selectWildElement(n,o))}),t.nrm(1,"img",8),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(3);t.Y8G("ngClass",t.eq3(2,ss,a.chooseElementAction.action.valueType==a.ActionValueType.minus)),t.R7$(),t.Y8G("src","./assets/images"+(a.settingsManager.settings.fhStyle?"/fh":"")+"/element/"+e+".svg",t.B4B)}}function Sb(i,r){if(1&i&&(t.j41(0,"span",5)(1,"span",7),t.nrm(2,"img",8),t.k0s(),t.Z7z(3,Tb,2,4,"span",9,t.fX1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(2,ss,e.chooseElementAction.action.valueType==e.ActionValueType.minus)),t.R7$(),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/element/wild.svg",t.B4B),t.R7$(),t.Dyx(e.chooseElementAction.action.valueType==e.ActionValueType.minus?e.wildToConsume():e.wildToCreate())}}function $b(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",1),t.bIt("singleClick",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.applyInteractiveActions(n))}),t.nrm(1,"span",2),t.j41(2,"span",3),t.Z7z(3,Gb,4,4,"span",4,Rb),t.k0s(),t.nVh(5,Sb,5,4,"span",5),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(3,wb,"fh"==e.settingsManager.settings.theme)),t.R7$(),t.Y8G("ghs-label",e.interactiveActions.length?"monster.applyInteractiveActions":"monster.skipInteractiveActions"),t.R7$(2),t.Dyx(e.interactiveActionEntities),t.R7$(2),t.vxM(e.chooseElementAction?5:-1)}}let rs=(()=>{class i{actions;figure;preIndex="";interactiveActions=[];interactiveActionsChange=new t.bkB;gameManager=s.E;settingsManager=m.f;ActionValueType=G.iQ;interactiveActionEntities=[];chooseElementAction;chooseElementValues=[];ngOnInit(){this.update(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){let e=this.interactiveActions.length>0;this.interactiveActions=[],this.interactiveActionEntities=[],m.f.settings.interactiveAbilities&&this.figure.active&&(this.interactiveActions=s.E.actionsManager.getAllInteractiveActions(this.figure,this.actions,this.preIndex),this.chooseElementAction=void 0,this.chooseElementValues=[],this.interactiveActionEntities=this.figure.entities.filter(a=>s.E.actionsManager.getInteractiveActions(a,this.figure,this.actions,this.preIndex).length),this.figure instanceof P.R&&(this.interactiveActionEntities=this.interactiveActionEntities.map(a=>a).sort(s.E.monsterManager.sortEntities)),this.interactiveActionEntities=this.interactiveActionEntities.filter((a,n)=>m.f.settings.combineInteractiveAbilities||0==n),e=!0),e&&setTimeout(()=>{this.interactiveActionsChange.emit(this.interactiveActions)},1)}applyInteractiveActions(e,a=!1){if(!a&&this.chooseElementAction&&s.E.actionsManager.getValues(this.chooseElementAction.action).filter(n=>n==yt.Hg.wild).length!=this.chooseElementValues.length)return this.chooseElementAction=void 0,void(this.chooseElementValues=[]);if(this.chooseElementAction=this.interactiveActions.find(n=>n.action.type==G.X2.element&&-1!=s.E.actionsManager.getValues(n.action).indexOf(yt.Hg.wild)),this.chooseElementAction){const n=s.E.actionsManager.getValues(this.chooseElementAction.action).filter(o=>o==yt.Hg.wild).length;if(n!=this.chooseElementValues.length)if(this.chooseElementAction.action.valueType==G.iQ.minus&&this.wildToConsume().length==n-this.chooseElementValues.length)this.wildToConsume().forEach(o=>this.chooseElementValues.push(o));else{if(this.chooseElementAction.action.valueType==G.iQ.minus||this.wildToCreate().length!=n-this.chooseElementValues.length)return;this.wildToConsume().forEach(o=>this.chooseElementValues.push(o))}}if(this.interactiveActionEntities.length||this.interactiveActionEntities.length){let n=!0;const o=(m.f.settings.combineInteractiveAbilities?this.interactiveActions:s.E.actionsManager.getInteractiveActions(this.interactiveActionEntities[0],this.figure,this.actions,this.preIndex)).filter(_=>this.interactiveActions.find(y=>y.index==_.index)).map(_=>{let y=_.action.type,B=s.E.actionsManager.getValues(_.action);if(y==G.X2.element)if(_.action.valueType==G.iQ.minus){y="elementConsume",B=B.map(W=>"%game.element.consume."+W+"%");let nt=s.E.actionsManager.getElementsToConsume(_.action).map(W=>"%game.element.consume."+W.type+"%"),Z=this.chooseElementValues.map(W=>"%game.element.consume."+W+"%");B=B.map(W=>W==yt.Hg.wild?Z.pop()||nt.pop():(nt.pop(),W)).map(W=>W)}else y="elementInfuse",B=B.map((nt,Z)=>this.chooseElementValues[Z]?"%game.element."+this.chooseElementValues[Z]+"%":"%game.element."+nt+"%");return m.f.getLabel("state.info.applyHighlightAction."+y,[B.join(", ")])}).join(", "),g=this.interactiveActionEntities.map(_=>_ instanceof Rt.I?"%game.monsterType."+_.type+"."+_.number+"%":_.number).join(", ");s.E.stateManager.before(this.interactiveActions.length?"applyInteractiveActions":"skipInteractiveActions",o,g,this.figure instanceof P.R?"data.monster."+this.figure.name:s.E.objectiveManager.objectiveName(this.figure)),this.interactiveActionEntities.forEach(_=>{let y=s.E.actionsManager.getInteractiveActions(_,this.figure,this.actions,this.preIndex).filter(Z=>this.interactiveActions.find(W=>W.index==Z.index)),B=y[0]||void 0;for(;B;){if(s.E.actionsManager.applyInteractiveAction(_,this.figure,B,this.chooseElementValues),B.action.type==G.X2.element&&(this.chooseElementValues=[]),y=s.E.actionsManager.getInteractiveActions(_,this.figure,this.actions,this.preIndex).filter(Z=>this.interactiveActions.find(W=>W.index==Z.index)),y.some(Z=>Z.index==B.index)){console.warn("Interactive Action already processed, should not happen",B);break}B=y[0]||void 0}s.E.actionsManager.getInteractiveActions(_,this.figure,this.actions,this.preIndex).filter(Z=>!this.interactiveActions.find(W=>W.index==Z.index)).forEach(Z=>{const W=s.E.actionsManager.roundTag(Z.action,Z.index);-1==_.tags.indexOf(W)&&_.tags.push(W)})}),this.interactiveActionEntities.some(_=>_.dead)&&(n=!1,s.E.uiChange.emit(),setTimeout(()=>{this.interactiveActionEntities.forEach(_=>{_.dead&&(this.figure instanceof P.R&&_ instanceof Rt.I?s.E.monsterManager.removeMonsterEntity(this.figure,_):this.figure instanceof mt.$e&&_ instanceof oe.X&&s.E.objectiveManager.removeObjectiveEntity(this.figure,_),this.figure.entities.every(y=>y.dead||y.health<=0||!y.active)&&(this.figure.off=!0,this.figure.active&&s.E.roundManager.toggleFigure(this.figure)))}),this.update(),s.E.stateManager.after()},m.f.settings.animations?1500*m.f.settings.animationSpeed:0)),n&&(this.update(),s.E.stateManager.after()),e.preventDefault(),e.stopPropagation()}}wildToConsume(){return s.E.game.elementBoard.filter(e=>!(e.state==yt.e_.inert||e.state==yt.e_.new||e.state==yt.e_.consumed||-1!=this.chooseElementValues.indexOf(e.type)||this.chooseElementAction&&-1!=s.E.actionsManager.getValues(this.chooseElementAction.action).indexOf(e.type)||this.interactiveActions.find(a=>a.action.type==G.X2.element&&a.action.valueType==G.iQ.minus&&a.action.value==e.type))).map(e=>e.type)}wildToCreate(){return s.E.game.elementBoard.filter(e=>e.state!=yt.e_.new&&e.state!=yt.e_.strong&&e.state!=yt.e_.always&&-1==this.chooseElementValues.indexOf(e.type)&&(!this.chooseElementAction||-1==s.E.actionsManager.getValues(this.chooseElementAction.action).indexOf(e.type))).map(e=>e.type)}selectWildElement(e,a){this.chooseElementValues.push(a),this.applyInteractiveActions(e,!0),e.preventDefault(),e.stopPropagation()}onInteractiveActionsChange(e){this.interactiveActionsChange.emit(e)}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-interactive-actions"]],inputs:{actions:"actions",figure:"figure",preIndex:"preIndex",interactiveActions:"interactiveActions"},outputs:{interactiveActionsChange:"interactiveActionsChange"},standalone:!1,decls:1,vars:1,consts:[["ghs-pointer-input","",1,"interactive-entities",3,"ngClass"],["ghs-pointer-input","",1,"interactive-entities",3,"singleClick","ngClass"],[3,"ghs-label"],[1,"entity-numbers"],[1,"entity"],[1,"choose-element-container"],[1,"number"],[1,"element",3,"ngClass"],[3,"src"],["ghs-pointer-input","",1,"element","choose-element",3,"ngClass"],["ghs-pointer-input","",1,"element","choose-element",3,"singleClick","ngClass"]],template:function(a,n){1&a&&t.nVh(0,$b,6,5,"div",0),2&a&&t.vxM(n.interactiveActions.length||n.interactiveActionEntities.length?0:-1)},dependencies:[N.YU,tt,rt],styles:['.interactive-entities[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;cursor:pointer;font-size:1.3em;line-height:.8em;color:var(--ghs-color-gray);height:1.8em}.interactive-entities.fh[_ngcontent-%COMP%]{height:2.2em;padding-bottom:.4em}.interactive-entities[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{z-index:1}.interactive-entities[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:0;background-color:var(--ghs-color-darkgray);opacity:.5}.interactive-entities[_ngcontent-%COMP%]   .entity-numbers[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap;font-size:1.2em}.interactive-entities[_ngcontent-%COMP%]   .entity-numbers[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{margin-left:.2em}.interactive-entities[_ngcontent-%COMP%]   .entity-numbers[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .number.normal[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.interactive-entities[_ngcontent-%COMP%]   .entity-numbers[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .number.elite[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.interactive-entities[_ngcontent-%COMP%]   .entity-numbers[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .number.boss[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]{position:absolute;width:5.5em;height:5.5em;bottom:.2em;left:50%;transform:translate(-50%);cursor:initial}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%]{position:absolute;width:25%;height:25%;top:50%;left:50%;transform:translate(-50%,-50%)}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:0;background-color:var(--ghs-color-darkgray);opacity:.5;z-index:0;border-radius:100%}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]   .choose-element[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:50%;left:50%;width:25%;height:25%;margin:-12.5%;z-index:1}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]   .choose-element[_ngcontent-%COMP%]:before{display:none}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]   .choose-element[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:brightness(.8) grayscale(.4)}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]   .choose-element[_ngcontent-%COMP%]:hover:before{display:block}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]   .choose-element[_ngcontent-%COMP%]:nth-child(2){transform:rotate(-30deg) translate(125%) rotate(30deg)}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]   .choose-element[_ngcontent-%COMP%]:nth-child(3){transform:rotate(-210deg) translate(125%) rotate(210deg)}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]   .choose-element[_ngcontent-%COMP%]:nth-child(4){transform:rotate(-330deg) translate(125%) rotate(330deg)}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]   .choose-element[_ngcontent-%COMP%]:nth-child(5){transform:rotate(-150deg) translate(125%) rotate(150deg)}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]   .choose-element[_ngcontent-%COMP%]:nth-child(6){transform:rotate(-90deg) translate(125%) rotate(90deg)}.interactive-entities[_ngcontent-%COMP%]   .choose-element-container[_ngcontent-%COMP%]   .choose-element[_ngcontent-%COMP%]:nth-child(7){transform:rotate(-270deg) translate(125%) rotate(270deg)}.interactive-entities[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white);font-size:1.6em;line-height:1em;height:2.5em}.interactive-entities[_ngcontent-%COMP%]:hover:before{opacity:.7}']})}return i})();const Db=(i,r,e)=>({fh:i,bb:r,expand:e}),Ib=i=>({flipped:i}),cs=(i,r)=>({"bottom-actions":i,"character-actions":r}),ls=i=>({disabled:i}),Ab=i=>({"interactive-actions-top":i});function Vb(i,r){if(1&i&&t.nrm(0,"span",7),2&i){const e=t.XpG();t.Y8G("ghs-label",e.deckLabel)}}function Fb(i,r){if(1&i&&(t.j41(0,"span",8),t.nrm(1,"span",11),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","data.character."+e.character.edition+"."+e.character.name)}}function Xb(i,r){if(1&i&&(t.j41(0,"span",9),t.nrm(1,"img",12),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("src",e.character.iconUrl,t.B4B)}}function Bb(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function Yb(i,r){1&i&&t.nrm(0,"div",17)}function Nb(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-interactive-actions",24),t.mxI("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(2);return t.DH7(o.interactiveActions,n)||(o.interactiveActions=n),t.Njj(n)}),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(4,Ab,e.ability.bottomActions&&e.ability.bottomActions.length>0||e.character))("figure",e.monster)("actions",e.ability.actions),t.R50("interactiveActions",e.interactiveActions)}}function zb(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-interactive-actions",29),t.mxI("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(3);return t.DH7(o.interactiveBottomActions,n)||(o.interactiveBottomActions=n),t.Njj(n)}),t.k0s()}if(2&i){const e=t.XpG(3);t.Y8G("figure",e.monster)("actions",e.ability.bottomActions),t.R50("interactiveActions",e.interactiveBottomActions),t.Y8G("preIndex","bottom")}}function Lb(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",25),t.nrm(1,"span",6),t.k0s(),t.j41(2,"div",14)(3,"div",26)(4,"ghs-actions",27),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.onInteractiveBottomActionsChange(n))}),t.k0s()()(),t.nVh(5,zb,1,4,"ghs-interactive-actions",28)}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label",e.ability.level||0),t.R7$(),t.Y8G("ngClass",t.eq3(12,ls,e.activeActions&&"top"==e.activeActions)),t.R7$(2),t.Y8G("actions",e.ability.bottomActions)("monster",e.monster)("character",e.character)("statsCalculation",e.statsCalculation)("relative",e.relative)("interactiveAbilities",e.interactiveAbilities)("interactiveActions",e.interactiveBottomActions)("index","bottom")("cardId",e.ability.cardId),t.R7$(),t.vxM(e.interactiveAbilities&&e.monster&&(!e.activeActions||e.activeActions&&"bottom"==e.activeActions)?5:-1)}}function Ub(i,r){1&i&&(t.j41(0,"div",19),t.nrm(1,"img",30),t.k0s())}function qb(i,r){1&i&&(t.j41(0,"div",20),t.nrm(1,"img",30),t.k0s())}function Hb(i,r){if(1&i&&(t.j41(0,"span",21),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.SpI("[",e.abilityIndex+1,"]")}}function Kb(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function Wb(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function Jb(i,r){if(1&i&&(t.j41(0,"span",21),t.nVh(1,Kb,2,0,"span"),t.nVh(2,Wb,2,0,"span"),t.j41(3,"span"),t.EFF(4),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(),t.vxM(e.character&&e.ability.cardId<100?1:-1),t.R7$(),t.vxM(e.character&&e.ability.cardId<10?2:-1),t.R7$(2),t.JRh(e.ability.cardId)}}function Zb(i,r){if(1&i&&(t.j41(0,"span",9),t.nrm(1,"img",12),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("src",e.character.iconUrl,t.B4B)}}function Qb(i,r){if(1&i&&(t.j41(0,"span",33),t.nrm(1,"img",38),t.j41(2,"span",39),t.EFF(3),t.k0s()()),2&i){const e=t.XpG(3);t.R7$(3),t.JRh(e.ability.xp)}}function t0(i,r){1&i&&(t.j41(0,"span",34),t.nrm(1,"img",40)(2,"img",41),t.k0s())}function e0(i,r){1&i&&(t.j41(0,"span",35),t.nrm(1,"img",42)(2,"img",43),t.k0s())}function n0(i,r){1&i&&(t.j41(0,"span",36),t.nrm(1,"img",44)(2,"img",45),t.k0s())}function a0(i,r){1&i&&(t.j41(0,"span",37),t.nrm(1,"img",46)(2,"img",47),t.k0s())}function o0(i,r){if(1&i&&(t.j41(0,"div",22)(1,"span",31),t.EFF(2,"!"),t.k0s(),t.j41(3,"div",32),t.nVh(4,Qb,4,1,"span",33),t.nVh(5,t0,3,0,"span",34),t.nVh(6,e0,3,0,"span",35),t.nVh(7,n0,3,0,"span",36),t.nVh(8,a0,3,0,"span",37),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(4),t.vxM(e.ability.xp?4:-1),t.R7$(),t.vxM(e.ability.persistent?5:-1),t.R7$(),t.vxM(e.ability.loss?6:-1),t.R7$(),t.vxM(e.ability.round?7:-1),t.R7$(),t.vxM(e.ability.lost?8:-1)}}function s0(i,r){if(1&i&&(t.j41(0,"span",33),t.nrm(1,"img",38),t.j41(2,"span",39),t.EFF(3),t.k0s()()),2&i){const e=t.XpG(3);t.R7$(3),t.JRh(e.ability.bottomXp)}}function r0(i,r){1&i&&(t.j41(0,"span",34),t.nrm(1,"img",40)(2,"img",41),t.k0s())}function c0(i,r){1&i&&(t.j41(0,"span",35),t.nrm(1,"img",42)(2,"img",43),t.k0s())}function l0(i,r){1&i&&(t.j41(0,"span",36),t.nrm(1,"img",44)(2,"img",45),t.k0s())}function g0(i,r){1&i&&(t.j41(0,"span",37),t.nrm(1,"img",46)(2,"img",47),t.k0s())}function d0(i,r){if(1&i&&(t.j41(0,"div",23)(1,"span",31),t.EFF(2,"!"),t.k0s(),t.j41(3,"div",32),t.nVh(4,s0,4,1,"span",33),t.nVh(5,r0,3,0,"span",34),t.nVh(6,c0,3,0,"span",35),t.nVh(7,l0,3,0,"span",36),t.nVh(8,g0,3,0,"span",37),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(4),t.vxM(e.ability.bottomXp?4:-1),t.R7$(),t.vxM(e.ability.bottomPersistent?5:-1),t.R7$(),t.vxM(e.ability.bottomLoss?6:-1),t.R7$(),t.vxM(e.ability.bottomRound?7:-1),t.R7$(),t.vxM(e.ability.bottomLost?8:-1)}}function h0(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",13),t.nVh(1,Bb,2,0,"span"),t.EFF(2),t.k0s(),t.j41(3,"span",8),t.EFF(4),t.k0s(),t.j41(5,"div",14)(6,"div",15)(7,"ghs-actions",16),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()(),t.nVh(8,Yb,1,0,"div",17),t.k0s(),t.nVh(9,Nb,1,6,"ghs-interactive-actions",18),t.nVh(10,Lb,6,14),t.nVh(11,Ub,2,0,"div",19),t.nVh(12,qb,2,0,"div",20),t.nVh(13,Hb,2,1,"span",21),t.nVh(14,Jb,5,3,"span",21),t.nVh(15,Zb,2,1,"span",9),t.nVh(16,o0,9,5,"div",22),t.nVh(17,d0,9,5,"div",23)}if(2&i){const e=t.XpG();t.R7$(),t.vxM(e.ability.initiative<10?1:-1),t.R7$(),t.JRh(e.ability.initiative),t.R7$(2),t.JRh(e.abilityLabel),t.R7$(),t.Y8G("ngClass",t.eq3(22,ls,e.activeActions&&"bottom"==e.activeActions)),t.R7$(2),t.Y8G("actions",e.ability.actions)("monster",e.monster)("character",e.character)("statsCalculation",e.statsCalculation)("relative",e.relative)("interactiveAbilities",e.interactiveAbilities)("interactiveActions",e.interactiveActions)("cardId",e.ability.cardId),t.R7$(),t.vxM(e.interactiveActions.length||e.settingsManager.settings.interactiveAbilities&&e.settingsManager.settings.showExpandedAbilityCard?8:-1),t.R7$(),t.vxM(e.interactiveAbilities&&e.monster&&(!e.activeActions||e.activeActions&&"top"==e.activeActions)?9:-1),t.R7$(),t.vxM(e.ability.bottomActions&&e.ability.bottomActions.length>0||e.character?10:-1),t.R7$(),t.vxM(e.ability.shuffle?11:-1),t.R7$(),t.vxM(e.ability.bottomShuffle?12:-1),t.R7$(),t.vxM(!e.ability.cardId&&e.settingsManager.settings.abilityNumbers?13:-1),t.R7$(),t.vxM(e.ability.cardId&&e.settingsManager.settings.abilityNumbers?14:-1),t.R7$(),t.vxM(e.character?15:-1),t.R7$(),t.vxM(e.ability.lost||e.ability.persistent||e.ability.loss||e.ability.round||e.ability.xp?16:-1),t.R7$(),t.vxM(e.ability.bottomLost||e.ability.bottomPersistent||e.ability.bottomLoss||e.ability.bottomRound||e.ability.bottomXp?17:-1)}}let en=(()=>{class i{elementRef;ability;abilities;monster;character;flipped=!1;reveal=!1;relative=!1;interactiveAbilities=!1;statsCalculation=!0;activeActions=!1;gameManager=s.E;settingsManager=m.f;ActionValueType=G.iQ;deckLabel="";abilityIndex=-1;abilityLabel="";fh=!1;interactiveActions=[];interactiveActionsChange=new t.bkB;interactiveBottomActions=[];interactiveBottomActionsChange=new t.bkB;fontsize="";constructor(e){this.elementRef=e}ngOnInit(){this.update(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}ngOnChanges(e){this.update()}update(){if(this.fontsize=.04*this.elementRef.nativeElement.offsetWidth+"px",this.monster){const e=this.monster.statEffect&&this.monster.statEffect.deck&&!this.monster.statEffect.deck.startsWith(this.monster.name)?this.monster.statEffect.deck:this.monster.deck?this.monster.deck:this.monster.name;this.deckLabel="data.deck."+e,e==m.f.getLabel(this.deckLabel)&&(this.deckLabel="data.monster."+e)}else if(this.character){const e=this.character.deck?this.character.deck:this.character.name;this.deckLabel="data.deck."+e,e==m.f.getLabel(this.deckLabel)&&(this.deckLabel="data.character."+this.character.edition+"."+e)}this.abilityIndex=-1,this.abilityLabel="",this.ability&&(this.abilityIndex=this.getAbilityIndex(this.ability),this.abilityLabel=this.getAbilityLabel(this.ability)),this.fh=this.character&&("fh"==this.character.edition||-1!=s.E.editionExtensions(this.character.edition).indexOf("fh"))||!1}getAbilityIndex(e){return this.abilities&&this.abilities.length>0?this.abilities.indexOf(e):this.monster?s.E.abilities(this.monster).indexOf(e):-1}getAbilityLabel(e){let a=e.name||"";return a=a?"data.ability."+a:this.deckLabel,Qe(m.f.getLabel(a))}onChange(e){this.ability&&(this.ability.revealed=e)}onInteractiveActionsChange(e){this.interactiveAbilities&&(this.interactiveActionsChange.emit(e),this.interactiveActions=e)}onInteractiveBottomActionsChange(e){this.interactiveAbilities&&(this.interactiveBottomActionsChange.emit(e),this.interactiveBottomActions=e)}static \u0275fac=function(a){return new(a||i)(t.rXU(t.aKT))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-ability"]],inputs:{ability:"ability",abilities:"abilities",monster:"monster",character:"character",flipped:"flipped",reveal:"reveal",relative:"relative",interactiveAbilities:"interactiveAbilities",statsCalculation:"statsCalculation",activeActions:"activeActions"},standalone:!1,features:[t.OA$],decls:12,vars:26,consts:[["card",""],[1,"card-container","ability",3,"ngClass"],["card-reveal","",1,"card",3,"change","ngClass","disabled"],[1,"card-back","ability-back",3,"ngClass"],[1,"touch"],[1,"revealed"],[1,"text",3,"ghs-label"],[1,"name",3,"ghs-label"],[1,"name"],[1,"logo"],[1,"card-front","ability-front",3,"ngClass"],[3,"ghs-label"],[3,"src"],[1,"initiative"],[1,"ability-actions-container",3,"ngClass"],[1,"ability-actions"],[3,"interactiveActionsChange","actions","monster","character","statsCalculation","relative","interactiveAbilities","interactiveActions","cardId"],[1,"bottom-spacer"],[3,"ngClass","figure","actions","interactiveActions"],[1,"shuffle"],[1,"bottom-shuffle"],[1,"index"],[1,"required-container"],[1,"required-container","bottom"],[3,"interactiveActionsChange","ngClass","figure","actions","interactiveActions"],[1,"level"],[1,"ability-actions","ability-bottom-actions"],[3,"interactiveActionsChange","actions","monster","character","statsCalculation","relative","interactiveAbilities","interactiveActions","index","cardId"],[1,"interactive-actions-bottom",3,"figure","actions","interactiveActions","preIndex"],[1,"interactive-actions-bottom",3,"interactiveActionsChange","figure","actions","interactiveActions","preIndex"],["src","./assets/images/shuffle.svg"],[1,"label"],[1,"box"],[1,"xp"],[1,"persistent"],[1,"loss"],[1,"round"],[1,"lost"],["src","./assets/images/action/card/experience.svg"],[1,"value"],["src","./assets/images/action/card/persistent.svg"],["src","./assets/images/action/card/overlay/persistent.svg",1,"overlay"],["src","./assets/images/action/card/loss.svg"],["src","./assets/images/action/card/overlay/loss.svg",1,"overlay"],["src","./assets/images/action/card/round.svg"],["src","./assets/images/action/card/overlay/round.svg",1,"overlay"],["src","./assets/images/action/card/lost.svg"],["src","./assets/images/action/card/overlay/lost.svg",1,"overlay"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",1)(1,"div",2,0),t.bIt("change",function(_){return t.eBV(o),t.Njj(n.onChange(_))}),t.j41(3,"div",3),t.nrm(4,"div",4),t.j41(5,"span",5),t.nrm(6,"span",6),t.k0s(),t.nVh(7,Vb,1,1,"span",7),t.nVh(8,Fb,2,1,"span",8),t.nVh(9,Xb,2,1,"span",9),t.k0s(),t.j41(10,"div",10),t.nVh(11,h0,18,24),t.k0s()()()}2&a&&(t.xc7("--ghs-ability-color",n.character&&n.character.color),t.Y8G("ngClass",t.sMw(14,Db,"fh"==n.settingsManager.settings.theme,"bb"==n.settingsManager.settings.theme,n.flipped||n.ability&&n.ability.revealed)),t.R7$(),t.xc7("font-size",n.fontsize),t.Y8G("ngClass",t.eq3(18,Ib,n.flipped||n.ability&&n.ability.revealed))("disabled",!n.reveal||!n.ability),t.R7$(2),t.Y8G("ngClass",t.l_i(20,cs,n.ability&&n.ability.bottomActions&&n.ability.bottomActions.length>0&&!n.character,n.character)),t.R7$(3),t.Y8G("ghs-label","game.cards.confirmReveal"),t.R7$(),t.vxM(n.monster?7:-1),t.R7$(),t.vxM(n.character?8:-1),t.R7$(),t.vxM(n.character?9:-1),t.R7$(),t.Y8G("ngClass",t.l_i(23,cs,n.ability&&n.ability.bottomActions&&n.ability.bottomActions.length>0&&!n.character,n.character)),t.R7$(),t.vxM(n.ability?11:-1))},dependencies:[N.YU,vn,Be,tt,rs],styles:['.ability[_ngcontent-%COMP%]{width:100%;height:100%;color:var(--ghs-color-white);--ghs-ability-color: var(--ghs-color-red)}.ability[_ngcontent-%COMP%]   .ability-back[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]{min-height:16em;display:flex;flex-direction:column;justify-content:center;text-align:center;border-radius:3.5%}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]{position:relative;z-index:1}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]:before{content:" ";position:absolute;width:100%;height:100%;background-image:url(monster-ability-front.6630d6e4791f6c50.png);background-position:0em -.9em;background-size:100% auto;background-repeat:no-repeat;z-index:0}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]:after{content:" ";position:absolute;width:100%;height:100%;background-image:url(monster-ability-front-repeat.90ec2bf17a27d884.png);background-position:0em -2.9em;background-size:100% auto;background-repeat:repeat-y;z-index:-1}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .ability-actions-container[_ngcontent-%COMP%]{position:relative;overflow:auto;z-index:2}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .ability-actions-container.disabled[_ngcontent-%COMP%]{opacity:.3}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .ability-actions-container.disabled[_ngcontent-%COMP%]:hover{opacity:.8}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .ability-actions-container[_ngcontent-%COMP%]   .ability-actions[_ngcontent-%COMP%]{position:relative;margin-top:2em;padding-bottom:.4em;width:100%;min-height:5.4em;font-size:1.7em;z-index:1;display:flex;align-items:center}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .ability-actions-container[_ngcontent-%COMP%]   .ability-actions[_ngcontent-%COMP%]   ghs-actions[_ngcontent-%COMP%]{font-size:calc(1em * var(--ghs-fontsize));position:relative;width:100%;height:100%}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .ability-actions-container[_ngcontent-%COMP%]   .bottom-spacer[_ngcontent-%COMP%]{display:block;position:relative;margin-top:2em}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{display:block;position:absolute;top:.2em;left:0;width:100%;font-family:var(--ghs-font-title);font-size:1.7em;filter:var(--ghs-filter-shadow);text-align:center}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]{position:absolute;font-family:var(--ghs-font-title);font-size:2.4em;filter:var(--ghs-filter-shadow);top:1em;left:.5em;text-align:center;width:1em}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .shuffle[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .bottom-shuffle[_ngcontent-%COMP%]{position:absolute;bottom:1em;right:.5em;z-index:0;filter:var(--ghs-filter-white) var(--ghs-filter-shadow);width:2em}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .shuffle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .bottom-shuffle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{position:absolute;font-size:1em;filter:var(--ghs-filter-shadow-thin);bottom:.5em;left:.5em}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]{background-position:top;background-attachment:local;height:100%;overflow-x:unset;overflow-y:auto}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions.bottom-actions[_ngcontent-%COMP%]:before, .ability[_ngcontent-%COMP%]   .ability-front.character-actions.bottom-actions[_ngcontent-%COMP%]:before{background-position:top;background-image:url(monster-ability-front-bottom.43963667f697d866.png)}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions.character-actions[_ngcontent-%COMP%]:before, .ability[_ngcontent-%COMP%]   .ability-front.character-actions.character-actions[_ngcontent-%COMP%]:before{background-position:top;background-color:var(--ghs-ability-color);background-image:url(character-ability-front.49c9deaf55e5e694.png),url(character-ability-front-blend.fe1021dc39bab753.png);background-blend-mode:screen,luminosity}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions.character-actions[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions.character-actions[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{position:absolute;bottom:1.2em;left:50%;width:1.8em;height:auto;transform:translate(-50%);z-index:1}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions.character-actions[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions.character-actions[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto;filter:drop-shadow(.5em .5em .5em var(--ghs-color-black))}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{top:.8em}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]{top:7em;left:5.2em;transform:translate(-50%)}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{position:absolute;top:3.1em;left:9.4em;width:2.1em;height:1.6em;font-size:1.2em;font-family:var(--ghs-font-title);display:flex;justify-content:center;align-items:center;background-color:var(--ghs-ability-color);mask-image:url(level.38e1f58a07dc5898.svg);-webkit-mask-image:url(level.38e1f58a07dc5898.svg);mask-size:115% 170%;-webkit-mask-size:115% 170%;mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:60% 66%;-webkit-mask-position:60% 66%}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{background:inherit;-webkit-background-clip:text;background-clip:text;color:transparent;filter:invert(1) grayscale(1) contrast(100)}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%]   .shuffle[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .shuffle[_ngcontent-%COMP%]{top:15.5em;right:3.5em;bottom:initial}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%]   .bottom-shuffle[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .bottom-shuffle[_ngcontent-%COMP%]{bottom:2.3em;right:4.8em}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{left:14.7em;bottom:2.2em}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%]   .ability-actions-container[_ngcontent-%COMP%]   .ability-actions[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .ability-actions-container[_ngcontent-%COMP%]   .ability-actions[_ngcontent-%COMP%]{left:1.6em;width:11.5em;min-height:6.4em;max-height:6.4em;margin-top:1.8em}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%]   .ability-actions-container[_ngcontent-%COMP%]   .ability-actions.ability-bottom-actions[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .ability-actions-container[_ngcontent-%COMP%]   .ability-actions.ability-bottom-actions[_ngcontent-%COMP%]{top:1.5em;margin-top:0;margin-bottom:2.2em;padding-top:.2em;padding-bottom:0}.ability[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%]   .ability-actions-container[_ngcontent-%COMP%]   .bottom-spacer[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .ability-actions-container[_ngcontent-%COMP%]   .bottom-spacer[_ngcontent-%COMP%]{display:none}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   ghs-interactive-actions[_ngcontent-%COMP%]{position:absolute;left:0;width:100%;bottom:0;z-index:999}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   ghs-interactive-actions.interactive-actions-top[_ngcontent-%COMP%]{position:absolute;bottom:16em}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   ghs-interactive-actions.interactive-actions-bottom[_ngcontent-%COMP%]{position:absolute;bottom:2.5em}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]{position:absolute;bottom:16.5em;right:3.3em;display:flex}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:none}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]{position:relative;display:flex;flex-grow:1;justify-content:flex-start;align-items:center;padding:.2em}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:relative;display:block;height:2em;margin:0 .1em}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]   span.loss[_ngcontent-%COMP%]{height:1.4em;margin:0 .2em}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:relative;top:0;left:0;height:100%;width:auto}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:nth-child(1){filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:nth-child(2){position:absolute}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;font-size:1.6em;font-family:var(--ghs-font-gh-title);text-align:center;color:var(--ghs-color-black);margin:0}.ability[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container.bottom[_ngcontent-%COMP%]{right:4.6em;bottom:3em}.ability[_ngcontent-%COMP%]   .ability-back[_ngcontent-%COMP%]{background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(monster-ability-back.1b996f6c655437aa.png);z-index:1}.ability[_ngcontent-%COMP%]   .ability-back[_ngcontent-%COMP%]   .touch[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1;overflow:auto}.ability[_ngcontent-%COMP%]   .ability-back[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;top:50%;left:0;width:100%;font-family:var(--ghs-font-title);font-size:1.4em;filter:drop-shadow(calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) var(--ghs-color-black));text-align:center;transform:translateY(2.9em)}.ability[_ngcontent-%COMP%]   .ability-back.bottom-actions[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-back.character-actions[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:50%;height:auto;transform:translate(-50%,-50%);z-index:1}.ability[_ngcontent-%COMP%]   .ability-back.bottom-actions[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-back.character-actions[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto;filter:drop-shadow(.5em .5em .5em var(--ghs-color-black))}.ability[_ngcontent-%COMP%]   .ability-back.bottom-actions.bottom-actions[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-back.character-actions.bottom-actions[_ngcontent-%COMP%]{background-image:url(monster-ability-back-botton.5146fd83ee4567f9.png)}.ability[_ngcontent-%COMP%]   .ability-back.bottom-actions.bottom-actions[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-back.character-actions.bottom-actions[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{top:57.5%}.ability[_ngcontent-%COMP%]   .ability-back.bottom-actions.character-actions[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-back.character-actions.character-actions[_ngcontent-%COMP%]{background-color:var(--ghs-ability-color);background-image:url(character-ability-back.e184c6b79281a977.png),url(character-ability-back-blend.f5f2fb421bd7a6d9.png);background-blend-mode:screen,luminosity}.ability[_ngcontent-%COMP%]   .ability-back.bottom-actions.character-actions[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%], .ability[_ngcontent-%COMP%]   .ability-back.character-actions.character-actions[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{top:.5em;bottom:initial;font-size:2em;transform:none}.ability[_ngcontent-%COMP%]   .confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center;color:var(--ghs-color-white);font-size:2.3em;filter:drop-shadow(calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) var(--ghs-color-black));z-index:2}.ability[_ngcontent-%COMP%]   .confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{text-align:center}.ability.fh[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]:before{background-image:url(monster-ability-front.bae377edfe8630cc.png);background-position:0em -.6em}.ability.fh[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]:after{background-image:url(monster-ability-front-repeat.21d351b34ecd76d1.png)}.ability.fh[_ngcontent-%COMP%]   .ability-front.bottom-actions[_ngcontent-%COMP%]:before{background-image:url(monster-ability-front-bottom.43963667f697d866.png)}.ability.fh[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{bottom:.5em;left:.5em}.ability.fh[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]{font-size:2.6em;top:.8em}.ability.fh[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]:before{background-color:var(--ghs-ability-color);background-image:url(character-ability-front.df38cb6102117d07.png),url(character-ability-front-blend.727e78f926c84cf4.png);background-blend-mode:luminosity,luminosity}.ability.fh[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{color:var(--ghs-color-black);top:1.25em;font-size:1.6em;filter:none}.ability.fh[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{top:1.1em;left:.8em;font-size:1.6em;font-family:var(--ghs-font-gh-title);color:var(--ghs-color-black);-webkit-mask:none;mask:none;background-color:transparent}.ability.fh[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{background:none;color:var(--ghs-color-black);filter:none}.ability.fh[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);font-size:2.6em;top:6.35em;left:4.8em}.ability.fh[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{top:2.4em;right:1.4em;bottom:initial;left:initial;filter:brightness(0);width:1.5em}.ability.fh[_ngcontent-%COMP%]   .ability-front.character-actions[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{bottom:1.6em;left:2.8em}.ability.fh[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]{bottom:15.7em;right:2.6em;overflow:hidden}.ability.fh[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]:before{content:" ";display:block;position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--ghs-color-black);opacity:.5;z-index:0;border:.1em solid var(--ghs-color-white);border-top-left-radius:.5em}.ability.fh[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:block;position:relative;top:.1em;display:flex;flex-grow:1;justify-content:center;align-items:center;padding:.3em;border-right:.1em solid var(--ghs-color-white);font-size:1.5em}.ability.fh[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]   .required-container.bottom[_ngcontent-%COMP%]{bottom:2em;right:2.3em}.ability.fh[_ngcontent-%COMP%]   .ability-back[_ngcontent-%COMP%]{background-image:url(monster-ability-back.7df0db1b0ed7e94a.png)}.ability.fh[_ngcontent-%COMP%]   .ability-back.bottom-actions[_ngcontent-%COMP%]{background-image:url(monster-ability-back-botton.5146fd83ee4567f9.png)}.ability.fh[_ngcontent-%COMP%]   .ability-back.character-actions[_ngcontent-%COMP%]{background-color:var(--ghs-ability-color);background-image:url(character-ability-back.898512c963e50735.png),url(character-ability-back-blend.0a471a56ae7d8140.png);background-blend-mode:luminosity,luminosity}.ability.fh[_ngcontent-%COMP%]   .ability-back.character-actions[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{color:var(--ghs-color-black);top:.4em;font-size:2.6em;filter:none}.ability.bb[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]:before{background-image:url(monster-ability-front.fcbe1060c337aabd.png);background-position:0em -.6em}.ability.bb[_ngcontent-%COMP%]   .ability-front[_ngcontent-%COMP%]:after{background-image:url(monster-ability-front-repeat.50495f927bbccdc9.png)}.ability.bb[_ngcontent-%COMP%]   .ability-back[_ngcontent-%COMP%]{background-image:url(monster-ability-back.3ae9372eae8029aa.png)}']})}return i})();const _0=(i,r)=>({closed:i,opened:r}),gs=(i,r)=>({"bottom-actions":i,"second-ability":r});function m0(i,r){if(1&i&&(t.j41(0,"div",1),t.nrm(1,"ghs-ability",3),t.k0s()),2&i){const e=t.XpG();t.Y8G("ngClass",t.l_i(8,gs,e.ability&&e.ability.bottomActions&&e.ability.bottomActions.length>0||!1,!!e.secondAbility)),t.R7$(),t.Y8G("ability",e.ability)("monster",e.monster)("character",e.character)("flipped",e.opened)("relative",e.relative)("interactiveAbilities",e.interactiveAbilities)("activeActions",!(!e.monster||!e.monster.firstActiveAction)&&("bottom"==e.monster.firstActiveAction?"bottom":"top"))}}function p0(i,r){if(1&i&&(t.j41(0,"div",1),t.nrm(1,"ghs-ability",3),t.k0s()),2&i){const e=t.XpG();t.Y8G("ngClass",t.l_i(8,gs,e.secondAbility&&e.secondAbility.bottomActions&&e.secondAbility.bottomActions.length>0||!1,!!e.secondAbility)),t.R7$(),t.Y8G("ability",e.secondAbility)("monster",e.monster)("character",e.character)("flipped",e.opened)("relative",e.relative)("interactiveAbilities",e.interactiveAbilities)("activeActions",!(!e.monster||!e.monster.firstActiveAction)&&("bottom"==e.monster.firstActiveAction?"top":"bottom"))}}let Ca=(()=>{class i{dialogRef;ability;secondAbility;monster;character;relative;interactiveAbilities;opened=!1;gameManager=s.E;constructor(e,a){this.dialogRef=a,this.ability=e.ability,this.monster=e.monster||void 0,this.character=e.character||void 0,this.relative=e.relative,this.interactiveAbilities=e.interactive,this.monster&&!this.ability&&(this.ability=s.E.monsterManager.getAbility(this.monster),s.E.monsterManager.hasBottomActions(this.monster)&&(this.secondAbility=this.ability,this.ability=s.E.monsterManager.getAbility(this.monster,!0))),this.ability||this.dialogRef.close()}ngOnInit(){this.opened=!0}close(){this.opened=!1,setTimeout(()=>{this.dialogRef.close()},m.f.settings.animations?1e3*m.f.settings.animationSpeed:0)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-ability-dialog"]],standalone:!1,decls:4,vars:6,consts:[["ghs-pointer-input","",1,"ability-dialog",3,"singleClick","ngClass"],[1,"ability-container",3,"ngClass"],[1,"close-container",3,"click"],[3,"ability","monster","character","flipped","relative","interactiveAbilities","activeActions"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.bIt("singleClick",function(){return n.close()}),t.nVh(1,m0,2,11,"div",1),t.nVh(2,p0,2,11,"div",1),t.k0s(),t.j41(3,"div",2),t.bIt("click",function(){return n.close()}),t.k0s()),2&a&&(t.Y8G("ngClass",t.l_i(3,_0,!n.opened,n.opened)),t.R7$(),t.vxM(n.ability?1:-1),t.R7$(),t.vxM(n.secondAbility?2:-1))},dependencies:[N.YU,en,rt],styles:["[_nghost-%COMP%]{background-color:transparent;padding:0;margin:0;border:0}.ability-dialog[_ngcontent-%COMP%]{position:relative;width:100vw;height:100vh;border-image:none;background:none;transition:transform calc(var(--ghs-animation-speed) * .15s) ease-in-out;transform:scale(0);z-index:2;overflow:auto;display:flex;justify-content:center;align-items:center;-ms-overflow-style:none;scrollbar-width:none}.ability-dialog[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.ability-dialog.opened[_ngcontent-%COMP%]{transform:scale(1)}.ability-dialog.closed[_ngcontent-%COMP%]{transform:scale(0);transition-delay:.8s}.ability-dialog[_ngcontent-%COMP%]   .ability-container[_ngcontent-%COMP%]{overflow:visible;width:100vw;max-width:600px;max-height:100vh}.ability-dialog[_ngcontent-%COMP%]   .ability-container[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{display:block;margin:1vh 0}.ability-dialog[_ngcontent-%COMP%]   .ability-container.bottom-actions[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{height:135vw;max-height:810px}@media (max-height: 600px),(orientation: portrait){.ability-dialog[_ngcontent-%COMP%]   .ability-container.bottom-actions.second-ability[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{height:67.5vw;max-height:405px}}.close-container[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1}"]})}return i})();var jt=M(24074);class ds{name="";cardId="";edition="";health=0;attack=0;movement=0;range=0;flying=!1;action;additionalAction;level;special=!1;count=1;enhancements=[];thumbnail=!1;thumbnailUrl;noThumbnail=!1}const u0=(i,r)=>({small:i,edit:r}),f0=i=>({enhanced:i}),C0=(i,r)=>r.type+i;function M0(i,r){if(1&i&&t.nrm(0,"img",3),2&i){const e=t.XpG().$implicit;t.Y8G("src","./assets/images/action/hex/"+e.type+".svg",t.B4B)}}function v0(i,r){if(1&i&&t.nrm(0,"ghs-action-enhancements",4),2&i){const e=t.XpG().$implicit,a=t.XpG();t.Y8G("action",a.action)("index",a.actionIndex)("character",a.character)("cardId",a.cardId)("slot",a.enhanceHexes.indexOf(e))}}function O0(i,r){if(1&i&&(t.j41(0,"span",5),t.nrm(1,"img",6),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.Y8G("src","./assets/images/condition/"+e.value+".svg",t.B4B)}}function P0(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",2),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.click(n))}),t.nVh(1,M0,1,1,"img",3),t.nVh(2,v0,1,5,"ghs-action-enhancements",4),t.nVh(3,O0,2,1,"span",5),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.xc7("grid-column-start",2*e.x+1+e.y%2)("grid-column-end",2*e.x+3+e.y%2)("grid-row-start",e.y+1)("grid-row-end",e.y+1),t.Y8G("ngClass",t.eq3(12,f0,-1!=a.enhancedHexes.indexOf(e))),t.R7$(),t.vxM("enhance"!=e.type||a.editMode?1:-1),t.R7$(),t.vxM(a.editMode||"enhance"!=e.type?-1:2),t.R7$(),t.vxM(a.hasCondition(e)?3:-1)}}let Oi=(()=>{class i{action;value;size;actionIndex="";cardId;character;clickCallback=new t.bkB;doubleclickCallback=new t.bkB;hexes=[];enhanceHexes=[];enhancedHexes=[];edit=!1;editMode=!1;ActionHex=K.wd;ActionHexToString=K.mC;doubleClick=null;ngOnChanges(e){this.hexes=[],this.enhanceHexes=[],this.enhancedHexes=[],this.value||(this.value=""+this.action.value),this.value.split("|").forEach(a=>{const n=(0,K.dy)(a);null!=n&&(this.hexes.push(n),n.type==K.Gq.enhance&&(this.enhanceHexes.push(n),this.character&&this.cardId&&this.actionIndex&&this.character.progress.enhancements&&this.character.progress.enhancements.find(o=>o.cardId==this.cardId&&o.actionIndex==this.actionIndex&&o.index==this.enhanceHexes.length-1&&"hex"==o.action)&&this.enhancedHexes.push(n)),n.type==K.Gq.invisible&&(this.editMode=!0))}),this.edit=this.character&&-1!=this.character.tags.indexOf("edit-abilities")||!1}click(e){this.doubleClick?(clearTimeout(this.doubleClick),this.doubleClick=null,this.doubleclickCallback.emit(e)):this.doubleClick=setTimeout(()=>{this.doubleClick&&(this.clickCallback.emit(e),this.doubleClick=null)},200)}hasCondition(e){return e.value&&Object.keys(j.r5).includes(e.value)||!1}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-action-hex"]],inputs:{action:"action",value:"value",size:"size",actionIndex:[0,"index","actionIndex"],cardId:"cardId",character:"character"},outputs:{clickCallback:"clickCallback",doubleclickCallback:"doubleclickCallback"},standalone:!1,features:[t.OA$],decls:3,vars:6,consts:[[1,"hex-grid",3,"ngClass"],[1,"hex",3,"grid-column-start","grid-column-end","grid-row-start","grid-row-end","ngClass"],[1,"hex",3,"click","ngClass"],[1,"icon",3,"src"],[1,"enhance",3,"action","index","character","cardId","slot"],[1,"condition"],[3,"src"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.Z7z(1,P0,4,14,"div",1,C0),t.k0s()),2&a&&(t.xc7("--ghs-hex-size",n.size),t.Y8G("ngClass",t.l_i(3,u0,n.action.small,n.edit)),t.R7$(),t.Dyx(n.hexes))},styles:[".hex-grid[_ngcontent-%COMP%]{--ghs-hex-size: 1;display:grid;justify-items:center;align-items:center;grid-template-columns:calc(.6em * var(--ghs-hex-size));filter:var(--ghs-filter-shadow)}.hex-grid.small[_ngcontent-%COMP%]{filter:var(--ghs-filter-shadow-thin)}.hex-grid[_ngcontent-%COMP%]   .hex[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:calc(.6em * var(--ghs-hex-size) * 2);height:calc(.6em * var(--ghs-hex-size) * 1.7);z-index:1}.hex-grid[_ngcontent-%COMP%]   .hex[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:100%;height:auto}.hex-grid[_ngcontent-%COMP%]   .hex[_ngcontent-%COMP%]   ghs-action-enhancements[_ngcontent-%COMP%]{font-size:calc(.6em * var(--ghs-hex-size) * 2);position:absolute;top:calc(.6em * var(--ghs-hex-size) * .3);left:calc(.6em * var(--ghs-hex-size) * -.1)}.hex-grid[_ngcontent-%COMP%]   .hex.enhanced[_ngcontent-%COMP%]{filter:brightness(1.3);z-index:2}.hex-grid[_ngcontent-%COMP%]   .hex.enhanced[_ngcontent-%COMP%]   ghs-action-enhancements[_ngcontent-%COMP%]{left:calc(.6em * var(--ghs-hex-size) * -.5)}.hex-grid[_ngcontent-%COMP%]   .hex[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{position:absolute;top:calc(.6em * var(--ghs-hex-size) * -.2);left:calc(.6em * var(--ghs-hex-size) * -.1);width:calc(.6em * var(--ghs-hex-size) * 1.3)}.hex-grid[_ngcontent-%COMP%]   .hex[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}"]})}return i})();var Pi=M(83414);const b0=(i,r,e,a)=>({action:i,additional:r,item:e,fh:a}),hs=i=>({xs:i}),_s=i=>({"text-white":i}),k0=(i,r,e)=>[i,r,e];function y0(i,r){if(1&i&&t.nrm(0,"img",16),2&i){const e=t.XpG(3);t.Y8G("src",e.summonData.thumbnailUrl||"./assets/images/summons/thumbnail//"+e.summonData.edition+"-"+e.summonData.name+".png",t.B4B)}}function x0(i,r){if(1&i&&(t.j41(0,"span",17),t.nrm(1,"img",16),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("src",e.summonData.thumbnailUrl||"./assets/images/summons/thumbnail//"+e.summonData.edition+"-"+e.summonData.name+".png",t.B4B)}}function E0(i,r){if(1&i&&(t.j41(0,"span",1),t.nVh(1,y0,1,1,"img",16),t.nVh(2,x0,2,1,"span",17),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.vxM(e.fhStyle?-1:1),t.R7$(),t.vxM(e.fhStyle?2:-1)}}function w0(i,r){if(1&i&&(t.j41(0,"span",18),t.nrm(1,"span",22),t.EFF(2,"\xa0"),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Aen(e.style),t.Y8G("ghs-label","game.action.summon")}}function R0(i,r){if(1&i&&(t.j41(0,"span",19),t.EFF(1),t.k0s()),2&i){const e=t.XpG(3);t.Y8G("ngClass",t.eq3(2,_s,!e.right)),t.R7$(),t.JRh(e.summon.title)}}function j0(i,r){if(1&i&&t.nrm(0,"span",23),2&i){const e=t.XpG(3);t.Aen(e.style),t.Y8G("ghs-label","data.summon."+e.summon.name)("ngClass",t.eq3(4,_s,!e.right))}}function G0(i,r){if(1&i&&(t.j41(0,"span",21),t.nrm(1,"img",16),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("src","./assets/images"+(e.fhStyle?"/fh":"")+"/action/fly.svg",t.B4B)}}function T0(i,r){if(1&i&&(t.nVh(0,w0,3,3,"span",18),t.nVh(1,R0,2,4,"span",19),t.nVh(2,j0,1,6,"span",20),t.nVh(3,G0,2,1,"span",21)),2&i){const e=t.XpG(2);t.vxM(e.action?0:-1),t.R7$(),t.vxM(e.summon.title?1:-1),t.R7$(),t.vxM(e.summon.title?-1:2),t.R7$(),t.vxM(e.summon.flying?3:-1)}}function S0(i,r){if(1&i&&t.nrm(0,"span",3),2&i){const e=t.XpG(2);t.Y8G("ghs-label","character.summon.action"+(e.summonData.count&&e.summonData.count>1?".count":"")+(e.summonData.flying?".fly":""))("ghs-label-args",t.sMw(2,k0,e.summonData.name,e.summonData.count,e.summonData.flying))}}function $0(i,r){if(1&i&&t.nrm(0,"ghs-action-enhancements",8),2&i){const e=t.XpG(2);t.Y8G("action",e.enhancementActions[0])("index",e.actionIndex)("character",e.character)("cardId",e.cardId)("slot",0)("summon",e.summonData)}}function D0(i,r){if(1&i&&t.nrm(0,"ghs-action-enhancements",8),2&i){const e=t.XpG(2);t.Y8G("action",e.enhancementActions[2])("index",e.actionIndex)("character",e.character)("cardId",e.cardId)("slot",2)("summon",e.summonData)}}function I0(i,r){if(1&i&&t.nrm(0,"ghs-action",11),2&i){const e=t.XpG(2);t.Y8G("action",e.summon.action)}}function A0(i,r){if(1&i&&t.nrm(0,"span",22),2&i){const e=t.XpG(2);t.Aen(e.style),t.Y8G("ghs-label",""+e.summon.attack)}}function V0(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function F0(i,r){if(1&i&&t.nrm(0,"ghs-action-enhancements",8),2&i){const e=t.XpG(2);t.Y8G("action",e.enhancementActions[1])("index",e.actionIndex)("character",e.character)("cardId",e.cardId)("slot",1)("summon",e.summonData)}}function X0(i,r){if(1&i&&t.nrm(0,"ghs-action-enhancements",8),2&i){const e=t.XpG(2);t.Y8G("action",e.enhancementActions[3])("index",e.actionIndex)("character",e.character)("cardId",e.cardId)("slot",3)("summon",e.summonData)}}function B0(i,r){if(1&i&&(t.j41(0,"span",15),t.nrm(1,"ghs-action",11),t.k0s()),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(2,hs,e.summon.additionalAction&&"custom"==e.summon.additionalAction.type)),t.R7$(),t.Y8G("action",e.summon.additionalAction)}}function Y0(i,r){if(1&i&&(t.j41(0,"div",0),t.nVh(1,E0,3,2,"span",1),t.j41(2,"span",2),t.nVh(3,T0,4,4),t.nVh(4,S0,1,6,"span",3),t.k0s(),t.j41(5,"div",4)(6,"span",5),t.nrm(7,"img",6),t.j41(8,"span"),t.EFF(9,":"),t.k0s(),t.nrm(10,"span",7),t.nVh(11,$0,1,6,"ghs-action-enhancements",8),t.k0s(),t.j41(12,"span",9),t.nrm(13,"img",6),t.j41(14,"span"),t.EFF(15,":"),t.k0s(),t.nrm(16,"span",7),t.nVh(17,D0,1,6,"ghs-action-enhancements",8),t.k0s(),t.j41(18,"span",10),t.nVh(19,I0,1,1,"ghs-action",11),t.k0s(),t.j41(20,"span",12),t.nrm(21,"img",6),t.j41(22,"span"),t.EFF(23,":"),t.k0s(),t.nVh(24,A0,1,3,"span",13),t.nVh(25,V0,2,0,"span"),t.nVh(26,F0,1,6,"ghs-action-enhancements",8),t.k0s(),t.j41(27,"span",14),t.nrm(28,"img",6),t.j41(29,"span"),t.EFF(30,":"),t.k0s(),t.nrm(31,"span",7),t.nVh(32,X0,1,6,"ghs-action-enhancements",8),t.k0s(),t.nVh(33,B0,2,4,"span",15),t.k0s()()),2&i){const e=t.XpG();t.Y8G("ngClass",t.ziG(23,b0,e.summon.action,e.summon.additionalAction||e.additional,e.item,e.fhStyle)),t.R7$(),t.vxM(e.summonData&&e.summonData.thumbnail?1:-1),t.R7$(2),t.vxM(e.summonData?-1:3),t.R7$(),t.vxM(e.summonData?4:-1),t.R7$(3),t.Y8G("src","./assets/images/"+(e.fhStyle?"fh/":"")+"action/heal.svg",t.B4B),t.R7$(3),t.Y8G("value-calc",e.summon.maxHealth)("empty",!0),t.R7$(),t.vxM(e.summonData&&e.summonData.enhancements&&-1!=e.summonData.enhancements.indexOf("heal")?11:-1),t.R7$(2),t.Y8G("src","./assets/images/"+(e.fhStyle?"fh/":"")+"action/move.svg",t.B4B),t.R7$(3),t.Y8G("value-calc",e.summon.movement)("empty",!0),t.R7$(),t.vxM(e.summonData&&e.summonData.enhancements&&-1!=e.summonData.enhancements.indexOf("move")?17:-1),t.R7$(),t.Y8G("ngClass",t.eq3(28,hs,e.summon.action&&"custom"==e.summon.action.type)),t.R7$(),t.vxM(e.summon.action?19:-1),t.R7$(2),t.Y8G("src","./assets/images/"+(e.fhStyle?"fh/":"")+"action/attack.svg",t.B4B),t.R7$(3),t.vxM(0!=e.summon.attack?24:-1),t.R7$(),t.vxM(0==e.summon.attack?25:-1),t.R7$(),t.vxM(e.summonData&&e.summonData.enhancements&&-1!=e.summonData.enhancements.indexOf("attack")?26:-1),t.R7$(2),t.Y8G("src","./assets/images/"+(e.fhStyle?"fh/":"")+"action/range.svg",t.B4B),t.R7$(3),t.Y8G("value-calc",e.summon.range)("empty",!0),t.R7$(),t.vxM(e.summonData&&e.summonData.enhancements&&-1!=e.summonData.enhancements.indexOf("range")?32:-1),t.R7$(),t.vxM(e.summon.additionalAction?33:-1)}}let Ma=(()=>{class i{summon;summonData;action=!1;additional=!1;item=!1;right=!1;style=!1;actionIndex="";cardId;character;fhStyle=!1;settingsManager=m.f;enhancementActions=[];hasSummon=!1;ngOnInit(){this.update(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.hasSummon=null!=this.summon,this.fhStyle=m.f.settings.fhStyle&&!this.style||"fh"==this.style,this.enhancementActions=[],this.summonData&&(this.enhancementActions.push(new G.rc(G.X2.heal,this.summonData.health)),this.enhancementActions.push(new G.rc(G.X2.attack,this.summonData.attack)),this.enhancementActions.push(new G.rc(G.X2.move,this.summonData.movement)),this.enhancementActions.push(new G.rc(G.X2.range,this.summonData.range)),this.enhancementActions.forEach(e=>{e.enhancementTypes=[jt.J.square,jt.J.square,jt.J.square,jt.J.square]}))}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-summon-sheet"]],inputs:{summon:"summon",summonData:"summonData",action:"action",additional:"additional",item:"item",right:"right",style:"style",actionIndex:[0,"index","actionIndex"],cardId:"cardId",character:"character"},standalone:!1,decls:1,vars:1,consts:[[1,"summon-container",3,"ngClass"],[1,"thumbnail"],[1,"name"],[1,"summon-label","text-white",3,"ghs-label","ghs-label-args"],[1,"grid"],[1,"item","health"],[1,"ghs-svg",3,"src"],[3,"value-calc","empty"],[1,"enhance",3,"action","index","character","cardId","slot","summon"],[1,"item","move"],[1,"action",3,"ngClass"],[3,"action"],[1,"item","attack"],[3,"ghs-label","style"],[1,"item","range"],[1,"additionalAction",3,"ngClass"],[3,"src"],[1,"thumbnail-border"],[1,"summon-label"],[3,"ngClass"],[3,"ghs-label","style","ngClass"],[1,"flying"],[3,"ghs-label"],[3,"ghs-label","ngClass"]],template:function(a,n){1&a&&t.nVh(0,Y0,34,30,"div",0),2&a&&t.vxM(n.hasSummon?0:-1)},styles:[".summon-container[_ngcontent-%COMP%]{position:relative;width:100%;padding-top:38%;background-image:url(character-ability-summon1.6652de7b772cb310.png);background-size:contain;background-repeat:no-repeat;text-shadow:none}.summon-container[_ngcontent-%COMP%]   .summon-label[_ngcontent-%COMP%]{font-family:var(--ghs-font-text)}.summon-container[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{position:absolute;width:15%;height:53%;top:11%;left:0;overflow:hidden}.summon-container[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;width:127%;height:auto;top:2%;right:7%;border-radius:100%}.summon-container[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:1.1em;letter-spacing:-.04em;position:absolute;top:6%;left:14%;width:86%;height:34%;display:flex;justify-content:center;align-items:center}.summon-container[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .summon-label[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal)}.summon-container[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .flying[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:auto;margin-left:calc(var(--ghs-unit) * .5)}.summon-container[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .flying[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:45% 25% 30%;grid-template-rows:50% 50%;position:absolute;top:34%;left:0;width:100%;height:60%}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr .5fr 1.5fr 1.5fr;justify-content:flex-start;align-items:center}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(1){justify-self:end}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(2){justify-self:center}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(3){justify-self:start}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(4){justify-self:start}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .placeholder[_ngcontent-%COMP%]{display:flex;align-items:baseline;height:100%}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ghs-action-enhancements[_ngcontent-%COMP%]{margin-left:-25%}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%], .summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .attack[_ngcontent-%COMP%]{padding-left:3em}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%], .summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .additionalAction[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:.85em}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .action.xs[_ngcontent-%COMP%], .summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .additionalAction.xs[_ngcontent-%COMP%]{font-size:.75em}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{grid-row:2 span}.summon-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:.9em;width:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.summon-container.additional[_ngcontent-%COMP%]{background-image:url(character-ability-summon2.01e34f17184b79db.png)}.summon-container.additional[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{grid-row:1 span}.summon-container.item[_ngcontent-%COMP%]{background-image:url(summon-item.1142452805cc7730.png)}.summon-container.item[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:1em}.summon-container.item[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{grid-template-columns:65% 25% 0%}.summon-container.item[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{grid-row:1 span}.summon-container.fh[_ngcontent-%COMP%]{background-image:url(character-ability-summon1.087db978155a9f1c.png)}.summon-container.fh[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{top:24%;width:3.7em;height:4em;clip-path:polygon(0em 0em,3em 0em,3.7em 2em,3em 4em,0em 4em);background-color:var(--ghs-ability-color)}.summon-container.fh[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]   .thumbnail-border[_ngcontent-%COMP%]{position:absolute;top:.1em;left:.1em;width:3.7em;height:4em;clip-path:polygon(0em 0em,2.8em 0em,3.5em 1.8em,2.8em 3.8em,0em 3.8em)}.summon-container.fh[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]   .thumbnail-border[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{left:-1.4em;top:-.3em;width:155%}.summon-container.fh[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{top:38%;grid-template-columns:60% 40% 0%}.summon-container.fh[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%], .summon-container.fh[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .attack[_ngcontent-%COMP%]{padding-left:5em}.summon-container.fh.action[_ngcontent-%COMP%]{background-image:url(character-ability-summon2.52aae50ce5366dbc.png)}.summon-container.fh.action[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{grid-template-columns:55% 20% 25%}.summon-container.fh.additional[_ngcontent-%COMP%]{background-image:url(character-ability-summon3.137fcec726831188.png)}.summon-container.fh.additional[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{grid-template-columns:45% 20% 35%}.summon-container.fh.additional[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%], .summon-container.fh.additional[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .attack[_ngcontent-%COMP%]{padding-left:4.5em}"]})}return i})();const N0=(i,r)=>({"text-white":i,small:r}),ms=(i,r)=>({"action-interactive":i,"action-interactive-highlight":r}),z0=(i,r,e,a)=>[i,r,e,a],ps=(i,r,e)=>[i,r,e],L0=(i,r)=>r.monster.name+i,U0=(i,r)=>r.objective.name+i;function q0(i,r){if(1&i&&t.nrm(0,"span",7),2&i){const e=t.XpG(2).$implicit,a=t.XpG(2);t.Aen(a.style),t.Y8G("ghs-label",e.marker?"game.summon.spawnTypeMarker":"game.summon.spawnType")("ghs-label-args",t.ziG(4,z0,e.monster.name,e.monster.type,e.count?e.count:"",e.marker))}}function H0(i,r){if(1&i&&t.nrm(0,"span",7),2&i){const e=t.XpG(2).$implicit,a=t.XpG(2);t.Aen(a.style),t.Y8G("ghs-label",e.marker?"game.summon.spawnMarker":"game.summon.spawn")("ghs-label-args",t.sMw(4,ps,e.monster.name,e.count?e.count:"",e.marker))}}function K0(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1," ("),t.nrm(2,"span",8),t.EFF(3,"\xa0"),t.nrm(4,"span",3),t.EFF(5,")\xa0 "),t.k0s()),2&i){const e=t.XpG(2).$implicit,a=t.XpG(2);t.R7$(2),t.Y8G("value-calc",e.monster.health),t.R7$(2),t.Aen(a.style),t.Y8G("ghs-label","game.hp")}}function W0(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1,"\xa0"),t.nrm(2,"span",3),t.EFF(3,"\xa0"),t.k0s()),2&i){const e=t.XpG(4);t.R7$(2),t.Aen(e.style),t.Y8G("ghs-label","and")}}function J0(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",5),t.bIt("singleClick",function(n){t.eBV(e);const o=t.XpG(3);return t.Njj(o.toggleHighlight(n))}),t.nVh(1,q0,1,9,"span",6),t.nVh(2,H0,1,8,"span",6),t.nVh(3,K0,6,4,"span"),t.nVh(4,W0,4,3,"span"),t.k0s()}if(2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG(2);t.Y8G("clickBehind",!o.isInteractiveApplicableAction())("ghs-tooltip","monster.toggleAction")("delay",1)("disabled",!o.isInteractiveApplicableAction())("ngClass",t.l_i(9,ms,o.isInteractiveApplicableAction(),o.highlightAction())),t.R7$(),t.vxM(a.monster.type!=o.MonsterType.boss?1:-1),t.R7$(),t.vxM(a.monster.type==o.MonsterType.boss?2:-1),t.R7$(),t.vxM(a.monster.health?3:-1),t.R7$(),t.vxM(n<o.monsters.length-1&&o.monsters.length>1?4:-1)}}function Z0(i,r){1&i&&t.nVh(0,J0,5,12,"span",4),2&i&&t.vxM(r.$implicit.monster.type?0:-1)}function Q0(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1,"\xa0"),t.nrm(2,"span",3),t.EFF(3,"\xa0"),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.Aen(e.style),t.Y8G("ghs-label","and")}}function tk(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",5),t.bIt("singleClick",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.toggleHighlight(n))}),t.nrm(1,"span",7),t.nVh(2,Q0,4,3,"span"),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.Y8G("clickBehind",!n.isInteractiveApplicableAction())("ghs-tooltip","monster.toggleAction")("delay",1)("disabled",!n.isInteractiveApplicableAction())("ngClass",t.l_i(10,ms,n.isInteractiveApplicableAction(),n.highlightAction())),t.R7$(),t.Aen(n.style),t.Y8G("ghs-label",e.marker?"game.summon.spawnObjectiveMarker":"game.summon.spawnObjective")("ghs-label-args",t.sMw(13,ps,e.objective.name,e.count?e.count:"",e.marker)),t.R7$(),t.vxM(a<n.objectives.length-1&&n.objectives.length>1?2:-1)}}function ek(i,r){if(1&i&&(t.j41(0,"span",0)(1,"span",2),t.nrm(2,"span",3),t.EFF(3,"\xa0"),t.k0s(),t.Z7z(4,Z0,1,1,null,null,L0),t.Z7z(6,tk,3,17,"span",4,U0),t.k0s()),2&i){const e=t.XpG();t.Y8G("ngClass",t.l_i(4,N0,!e.right,e.action.small)),t.R7$(2),t.Aen(e.style),t.Y8G("ghs-label",e.isSpawn?"game.action.spawn":"game.action.summon"),t.R7$(2),t.Dyx(e.monsters),t.R7$(2),t.Dyx(e.objectives)}}function nk(i,r){if(1&i&&t.nrm(0,"ghs-summon-sheet",9),2&i){const e=t.XpG();t.Aen(e.style),t.Y8G("summon",e.getSummon())("summonData",e.summonData)("action",!0)("additional",e.additional)("right",e.right)("item","summonDataItem"==e.action.value)("character",e.character)("cardId",e.cardId)("index",e.actionIndex)}}let us=(()=>{class i{monster;monsterType;objective;action;textBlack=!1;right=!1;isSpawn=!1;additional=!1;interactiveAbilities=!1;interactiveActions=[];interactiveActionsChange=new t.bkB;actionIndex="";style=!1;character;cardId;spawners=[];monsters=[];objectives=[];type;summonData;count;tags=[];settingsManager=m.f;MonsterType=S.N;constructor(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}ngOnChanges(e){this.update()}update(){this.summonData=void 0,this.spawners=[],this.monster?this.spawners=s.E.entityManager.entities(this.monster,!0).map(e=>e).filter(e=>!this.monsterType||e.type==this.monsterType):this.objective instanceof mt.$e&&(this.spawners=s.E.entityManager.entities(this.objective,!0).map(e=>e)),this.monsters=s.E.actionsManager.getMonsterSpawnData(this.action).map(e=>{const a=new Pi._K(e);if(m.f.settings.calculate&&!m.f.settings.combineInteractiveAbilities&&this.isInteractiveApplicableAction()&&"string"==typeof a.count&&this.spawners.length){const n=this.spawners.find(o=>s.E.actionsManager.isInteractiveApplicableAction(o,this.action,this.actionIndex));n&&(a.count=(0,$.hZ)(a.count.replaceAll("HP",""+n.health).replaceAll("H",""+(0,$.hZ)(n.maxHealth)),n.level))}return a}),this.objectives=s.E.actionsManager.getObjectiveSpawnData(this.action),this.count=void 0,this.type=void 0,("summonData"==this.action.value||"summonDataItem"==this.action.value)&&(this.summonData=this.action.valueObject,this.summonData.edition||(this.character&&this.cardId?this.summonData.edition=this.character.edition:this.monster&&(this.summonData.edition=this.monster.edition)),this.action.small=!0)}getSummonLabel(e){const a="string"==typeof e.monster.health&&-1!=e.monster.health.indexOf("H")?e.monster.health:e.monster.health?(0,$.hZ)(e.monster.health):"";return e.monster.player2==e.monster.player3&&e.monster.player3==e.monster.player4?m.f.getLabel("game.summon.playerAll",[""+e.monster.type])+(a?"("+a+" "+m.f.getLabel("game.hp")+")":""):e.monster.player2==e.monster.player3?m.f.getLabel("game.summon.player2-3",[""+e.monster.player2,""+e.monster.player4])+(a?"("+a+" "+m.f.getLabel("game.hp")+")":""):e.monster.player3==e.monster.player4?m.f.getLabel("game.summon.player3-4",[""+e.monster.player2,""+e.monster.player4])+(a?"("+a+" "+m.f.getLabel("game.hp")+")":""):(console.warn("Incorrect summon data",e),"")}getSummon(){return this.summonData?new lt.up("",this.summonData.name,this.summonData.cardId,this.summonData.level||0,this.summonData.count,lt.rX.custom,this.summonData):new lt.up("","","",0,0,lt.rX.custom)}highlightAction(){return null!=this.interactiveActions.find(e=>e.index==this.actionIndex)||!1}isInteractiveApplicableAction(){return this.interactiveAbilities&&this.monster&&this.monster.entities.some(e=>this.action&&s.E.actionsManager.isInteractiveApplicableAction(e,this.action,this.actionIndex))||this.objective&&this.objective.entities.some(e=>this.action&&s.E.actionsManager.isInteractiveApplicableAction(e,this.action,this.actionIndex))||!1}toggleHighlight(e){this.isInteractiveApplicableAction()&&(this.highlightAction()?this.interactiveActions=this.interactiveActions.filter(a=>a.index!=this.actionIndex):this.action&&this.interactiveActions.push({action:this.action,index:this.actionIndex}),this.interactiveActionsChange.emit(this.interactiveActions),e.preventDefault(),e.stopPropagation())}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-action-summon"]],inputs:{monster:"monster",monsterType:"monsterType",objective:"objective",action:"action",textBlack:"textBlack",right:"right",isSpawn:[0,"spawn","isSpawn"],additional:"additional",interactiveAbilities:"interactiveAbilities",interactiveActions:"interactiveActions",actionIndex:[0,"index","actionIndex"],style:"style",character:"character",cardId:"cardId"},outputs:{interactiveActionsChange:"interactiveActionsChange"},standalone:!1,features:[t.OA$],decls:2,vars:2,consts:[[1,"summon-value",3,"ngClass"],[3,"summon","summonData","action","additional","right","item","style","character","cardId","index"],[1,"summon-label"],[3,"ghs-label"],["ghs-pointer-input","",1,"spawn",3,"clickBehind","ghs-tooltip","delay","disabled","ngClass"],["ghs-pointer-input","",1,"spawn",3,"singleClick","clickBehind","ghs-tooltip","delay","disabled","ngClass"],[3,"ghs-label","ghs-label-args","style"],[3,"ghs-label","ghs-label-args"],[3,"value-calc"],[3,"summon","summonData","action","additional","right","item","character","cardId","index"]],template:function(a,n){1&a&&(t.nVh(0,ek,8,7,"span",0),t.nVh(1,nk,1,11,"ghs-summon-sheet",1)),2&a&&(t.vxM(n.summonData?-1:0),t.R7$(),t.vxM(n.summonData?1:-1))},dependencies:[N.YU,tt,ft,rt,Ma,Ut],styles:[".summon-value[_ngcontent-%COMP%]{font-family:var(--ghs-font-text)}.summon-value[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{filter:var(--ghs-filter-shadow)}.summon-value.small[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{filter:var(--ghs-filter-shadow-thin)}@keyframes _ngcontent-%COMP%_spawn-pulse{0%{transform:scale(.9)}50%{transform:scale(1)}to{transform:scale(.9)}}.summon-value[_ngcontent-%COMP%]   .spawn-highlight[_ngcontent-%COMP%]{display:inline-block;animation:_ngcontent-%COMP%_spawn-pulse calc(var(--ghs-animation-speed) * 1.2s) ease-in-out infinite}.summon-value[_ngcontent-%COMP%]   .spawn-highlight[_ngcontent-%COMP%]:hover{transform:scale(1);opacity:.8;animation:none}.summon-value[_ngcontent-%COMP%]   .spawn.action-interactive[_ngcontent-%COMP%]{display:inline-block;cursor:zoom-in}.summon-value[_ngcontent-%COMP%]   .spawn.action-interactive.action-interactive-highlight[_ngcontent-%COMP%]{cursor:zoom-out;animation:_ngcontent-%COMP%_spawn-pulse calc(var(--ghs-animation-speed) * 1.2s) ease-in-out infinite}.summon-value[_ngcontent-%COMP%]   .spawn.action-interactive.action-interactive-highlight[_ngcontent-%COMP%]:hover{transform:scale(1);opacity:.8;animation:none}.summon-value[_ngcontent-%COMP%]   .spawn-objective-highlight[_ngcontent-%COMP%]{display:inline-block;transform:scale(.9);font-style:italic}.summon-value[_ngcontent-%COMP%]   .spawn-objective-highlight[_ngcontent-%COMP%]:hover{transform:scale(1);opacity:.8}.summon-value[_ngcontent-%COMP%]   .placeholder[_ngcontent-%COMP%]{vertical-align:initial}"]})}return i})();const ik=i=>[i],ak=(i,r,e,a,n,o,g,_,y,B)=>[i,r,e,a,n,o,g,_,y,B],ok=(i,r,e,a,n,o,g,_,y,B,nt,Z)=>[i,r,e,a,n,o,g,_,y,B,nt,Z],va=()=>["X"],sk=()=>[],rk=(i,r)=>r.type+i;function ck(i,r){if(1&i){const e=t.RV6();t.j41(0,"input",20),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.action.small,n)||(o.action.small=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.change())}),t.k0s()}if(2&i){const e=t.XpG();t.R50("ngModel",e.action.small)}}function lk(i,r){1&i&&t.nrm(0,"span",5),2&i&&t.Y8G("ghs-label","editor.action.small")}function gk(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",21),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.subActionRemoved.emit(n.subactionIndex))}),t.nrm(1,"img",22)(2,"span",5),t.k0s()}2&i&&(t.R7$(2),t.Y8G("ghs-label","editor.action.removeSubAction"))}function dk(i,r){if(1&i&&(t.j41(0,"option",9),t.nrm(1,"span",5),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ghs-label","game.action."+e)}}function hk(i,r){1&i&&(t.j41(0,"label"),t.nrm(1,"span",5),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","editor.action.value"))}function _k(i,r){if(1&i&&(t.j41(0,"option",9),t.nrm(1,"span",25),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.Aen("gh"),t.Y8G("ghs-label","game.specialTarget."+e)("ghs-label-args",t.lJ4(5,va))}}function mk(i,r){if(1&i){const e=t.RV6();t.j41(0,"label",24),t.EFF(1," X: "),t.j41(2,"input",26),t.bIt("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.changeSpecialTarget(o.value,n))}),t.k0s()()}if(2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ngModel",e.subValue)}}function pk(i,r){if(1&i){const e=t.RV6();t.j41(0,"select",23),t.bIt("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.changeSpecialTarget(n,o.subValue))}),t.Z7z(1,_k,2,6,"option",9,t.fX1),t.k0s(),t.nVh(3,mk,3,1,"label",24)}if(2&i){const e=t.XpG();t.Y8G("ngModel",e.value),t.R7$(),t.Dyx(e.ActionSpecialTarget),t.R7$(2),t.vxM(e.subValue?3:-1)}}function uk(i,r){if(1&i){const e=t.RV6();t.j41(0,"input",27),t.bIt("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.action.value=o.valueChange(n))})("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.change())}),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngModel",e.action.value)}}function fk(i,r){if(1&i){const e=t.RV6();t.j41(0,"textarea",28),t.bIt("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.action.value=o.valueChange(n))})("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.change())}),t.EFF(1,"  "),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngModel",e.action.value)}}function Ck(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",12)(1,"div",29)(2,"ghs-action-hex",30),t.bIt("clickCallback",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.toggleHex(n))})("doubleclickCallback",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.removeHex(n))}),t.k0s()(),t.j41(3,"textarea",23),t.bIt("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.changeHex(n))}),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("action",e.hexAction)("value",""+e.hexAction.value)("character",e.character)("cardId",e.cardId),t.R7$(),t.Y8G("ngModel",e.hexAction.value)}}function Mk(i,r){if(1&i&&(t.j41(0,"option",9),t.nrm(1,"span",5),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ghs-label","data.monster."+e)}}function vk(i,r){if(1&i&&(t.j41(0,"option",9),t.nrm(1,"span",5),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ghs-label","monster."+e)}}function Ok(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",34)(1,"select",28),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2);return t.DH7(o.monster,n)||(o.monster=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeSummonMonster())}),t.Z7z(2,Mk,2,2,"option",9,t.fX1),t.k0s(),t.j41(4,"select",28),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2);return t.DH7(o.monsterType,n)||(o.monsterType=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeSummonMonster())}),t.nrm(5,"option"),t.Z7z(6,vk,2,2,"option",9,t.fX1),t.k0s()()}if(2&i){const e=t.XpG(2);t.R7$(),t.R50("ngModel",e.monster),t.R7$(),t.Dyx(e.monsters),t.R7$(2),t.R50("ngModel",e.monsterType),t.R7$(2),t.Dyx(e.MonsterTypes)}}function Pk(i,r){1&i&&(t.j41(0,"span"),t.nrm(1,"span",5),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","editor.action.add"))}function bk(i,r){1&i&&t.nrm(0,"span",5),2&i&&t.Y8G("ghs-label","editor.action.add")}function kk(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",35),t.nrm(1,"ghs-action-summon",36),t.j41(2,"input",37),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2);return t.DH7(o.summon.name,n)||(o.summon.name=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeSummon())}),t.k0s(),t.j41(3,"div",38)(4,"span",39)(5,"input",40),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2);return t.DH7(o.summon.health,n)||(o.summon.health=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeSummon())}),t.k0s()(),t.j41(6,"span",39)(7,"input",41),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2);return t.DH7(o.summon.movement,n)||(o.summon.movement=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeSummon())}),t.k0s()(),t.j41(8,"a",42),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.editSummonAction())}),t.nVh(9,Pk,2,1,"span"),t.k0s(),t.j41(10,"span",39)(11,"input",43),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2);return t.DH7(o.summon.attack,n)||(o.summon.attack=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeSummon())}),t.k0s()(),t.j41(12,"span",39)(13,"input",44),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2);return t.DH7(o.summon.range,n)||(o.summon.range=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeSummon())}),t.k0s()(),t.j41(14,"a",42),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.editSummonAdditionalAction())}),t.nVh(15,bk,1,1,"span",5),t.k0s()()()}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("action",e.action)("additional",!0)("character",e.character)("cardId",e.cardId),t.R7$(),t.R50("ngModel",e.summon.name),t.R7$(3),t.R50("ngModel",e.summon.health),t.R7$(2),t.R50("ngModel",e.summon.movement),t.R7$(2),t.vxM(e.summon.action?-1:9),t.R7$(2),t.R50("ngModel",e.summon.attack),t.R7$(2),t.R50("ngModel",e.summon.range),t.R7$(2),t.vxM(e.summon.additionalAction?-1:15)}}function yk(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",13)(1,"div",31)(2,"label")(3,"input",32),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.changeSummonType(n))}),t.k0s(),t.nrm(4,"span",5),t.k0s(),t.j41(5,"label")(6,"input",33),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.changeSummonType(n))}),t.k0s(),t.nrm(7,"span",5),t.k0s()(),t.nVh(8,Ok,8,2,"div",34),t.nVh(9,kk,16,11,"div",35),t.k0s()}if(2&i){const e=t.XpG();t.R7$(3),t.Y8G("checked",!e.summon),t.R7$(),t.Y8G("ghs-label","editor.action.summon.type.monster"),t.R7$(2),t.Y8G("checked",e.summon),t.R7$(),t.Y8G("ghs-label","editor.action.summon.type.summon"),t.R7$(),t.vxM(e.summon?-1:8),t.R7$(),t.vxM(e.summon?9:-1)}}function xk(i,r){if(1&i&&(t.j41(0,"option",9),t.nrm(1,"span",25),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ghs-label","game.condition."+e)("ghs-label-args",t.lJ4(3,va))}}function Ek(i,r){if(1&i){const e=t.RV6();t.j41(0,"label",24),t.EFF(1," X: "),t.j41(2,"input",45),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2);return t.DH7(o.subValue,n)||(o.subValue=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeCondition())}),t.k0s()()}if(2&i){const e=t.XpG(2);t.R7$(2),t.R50("ngModel",e.subValue)}}function wk(i,r){if(1&i){const e=t.RV6();t.j41(0,"select",28),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.value,n)||(o.value=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeCondition())}),t.Z7z(1,xk,2,4,"option",9,t.fX1),t.k0s(),t.nVh(3,Ek,3,1,"label",24)}if(2&i){const e=t.XpG();t.R50("ngModel",e.value),t.R7$(),t.Dyx(e.conditionNames),t.R7$(2),t.vxM(e.subValue?3:-1)}}function Rk(i,r){if(1&i&&(t.j41(0,"option",9),t.nrm(1,"span",25),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ghs-label","game.card."+e)("ghs-label-args",t.lJ4(3,va))}}function jk(i,r){if(1&i){const e=t.RV6();t.j41(0,"label",24),t.EFF(1," X: "),t.j41(2,"input",45),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2);return t.DH7(o.subValue,n)||(o.subValue=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeCard())}),t.k0s()()}if(2&i){const e=t.XpG(2);t.R7$(2),t.R50("ngModel",e.subValue)}}function Gk(i,r){if(1&i){const e=t.RV6();t.j41(0,"select",28),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.value,n)||(o.value=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeCard())}),t.Z7z(1,Rk,2,4,"option",9,t.fX1),t.k0s(),t.nVh(3,jk,3,1,"label",24)}if(2&i){const e=t.XpG();t.R50("ngModel",e.value),t.R7$(),t.Dyx(e.ActionCardTypes),t.R7$(2),t.vxM(e.subValue?3:-1)}}function Tk(i,r){if(1&i&&(t.j41(0,"option",9),t.nrm(1,"span",5),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ghs-label","game.element."+e)}}function Sk(i,r){if(1&i){const e=t.RV6();t.j41(0,"select",28),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.action.value,n)||(o.action.value=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.change())}),t.Z7z(1,Tk,2,2,"option",9,t.fX1),t.k0s()}if(2&i){const e=t.XpG();t.R50("ngModel",e.action.value),t.R7$(),t.Dyx(e.Elements)}}function $k(i,r){if(1&i&&(t.j41(0,"option",9),t.nrm(1,"span",5),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ghs-label","game.element."+e)}}function Dk(i,r){if(1&i){const e=t.RV6();t.j41(0,"select",28),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.value,n)||(o.value=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeElementHalf())}),t.Z7z(1,$k,2,2,"option",9,t.fX1),t.k0s()}if(2&i){const e=t.XpG();t.R50("ngModel",e.value),t.R7$(),t.Dyx(e.HalfElementsLeft)}}function Ik(i,r){if(1&i&&(t.j41(0,"option",9),t.nrm(1,"span",5),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ghs-label","game.element."+e)}}function Ak(i,r){if(1&i){const e=t.RV6();t.j41(0,"select",28),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.subValue,n)||(o.subValue=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeElementHalf())}),t.Z7z(1,Ik,2,2,"option",9,t.fX1),t.k0s()}if(2&i){const e=t.XpG();t.R50("ngModel",e.subValue),t.R7$(),t.Dyx(e.HalfElementsRight)}}function Vk(i,r){if(1&i&&(t.j41(0,"option",9),t.nrm(1,"span",5),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ghs-label","game.monster."+e)}}function Fk(i,r){if(1&i){const e=t.RV6();t.j41(0,"select",28),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.action.value,n)||(o.action.value=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.change())}),t.Z7z(1,Vk,2,2,"option",9,t.fX1),t.k0s()}if(2&i){const e=t.XpG();t.R50("ngModel",e.action.value),t.R7$(),t.Dyx(e.MonsterTypes)}}function Xk(i,r){if(1&i&&(t.j41(0,"option",47),t.nrm(1,"span",5),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("value",e)("selected",a.action.valueType==e||!a.action.valueType&&e==a.ActionValueType.fixed),t.R7$(),t.Y8G("ghs-label","editor.action.valueType."+e)}}function Bk(i,r){if(1&i){const e=t.RV6();t.j41(0,"label"),t.nrm(1,"span",5),t.k0s(),t.j41(2,"select",46),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.action.valueType,n)||(o.action.valueType=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.change())}),t.Z7z(3,Xk,2,3,"option",47,t.fX1),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","editor.action.valueType"),t.R7$(),t.R50("ngModel",e.action.valueType),t.R7$(),t.Dyx(e.ActionValueTypes)}}function Yk(i,r){if(1&i&&(t.j41(0,"option",9),t.nrm(1,"span",5),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ghs-label","character.abilities.enhancements.types."+e)}}function Nk(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",48)(1,"select",28),t.mxI("ngModelChange",function(n){const o=t.eBV(e).$implicit,g=t.XpG(3);return t.DH7(g.action.enhancementTypes[o],n)||(g.action.enhancementTypes[o]=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.change())}),t.Z7z(2,Yk,2,2,"option",9,t.fX1),t.k0s(),t.j41(4,"a",42),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.removeEnhancement(n))}),t.nrm(5,"img",22)(6,"span",5),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG(3);t.R7$(),t.R50("ngModel",a.action.enhancementTypes[e]),t.R7$(),t.Dyx(a.EnhancementTypes),t.R7$(4),t.Y8G("ghs-label","editor.action.removeEnhancement")}}function zk(i,r){if(1&i&&(t.Z7z(0,Nk,7,2,"div",48,t.fX1),t.nI1(2,"ghsRange")),2&i){const e=t.XpG(2);t.Dyx(t.i5U(2,0,t.lJ4(3,sk),e.action.enhancementTypes.length))}}function Lk(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",15)(1,"div",1),t.nrm(2,"label",5),t.j41(3,"a",17),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.addEnhancement())}),t.nrm(4,"img",18)(5,"span",5),t.k0s()(),t.nVh(6,zk,3,4),t.k0s()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","editor.action.enhancements"),t.R7$(3),t.Y8G("ghs-label","editor.action.addEnhancement"),t.R7$(),t.vxM(e.action.enhancementTypes?6:-1)}}function Uk(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",19)(1,"span",49),t.nrm(2,"img",50),t.k0s(),t.j41(3,"ghs-editor-action",51),t.bIt("subActionRemoved",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.removeSubAction(n))})("actionChange",function(n){const o=t.eBV(e).$index,g=t.XpG();return t.Njj(g.changeSubAction(o,n))}),t.k0s()()}if(2&i){const e=r.$index,a=t.XpG();t.R7$(3),t.Y8G("action",a.action.subActions[e])("subactionIndex",e)}}function qk(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-action",6),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.relative=!n.relative)}),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("action",e.data.action)("relative",e.relative)("character",e.data.character)("cardId",e.data.cardId)}}let fs=(()=>{class i{dialog;action;actionTypes=Object.values(G.X2);hideValues=!1;subactionIndex;character;cardId;actionChange=new t.bkB;subActionRemoved=new t.bkB;conditionNames=Object.values(j.r5);ActionType=G.X2;ActionSpecialTarget=Object.values(G.lB);Elements=Object.values(yt.Hg);HalfElementsLeft=Object.values(yt.Hg);HalfElementsRight=Object.values(yt.Hg);ActionValueType=G.iQ;ActionValueTypes=Object.values(G.iQ);ActionCardTypes=Object.values(G.di);MonsterTypes=Object.values(S.N);EnhancementTypes=Object.values(jt.J);hexAction=new G.rc(G.X2.area,"(0,0,invisible)");value="";subValue="";summon;monster="";monsterType;monsters=[];constructor(e){this.dialog=e}ngOnInit(){if(this.monsters=s.E.monstersData().map(e=>e.name),this.action&&this.action.type==G.X2.area){this.hexAction.value=this.action.value?""+this.action.value:"(0,0,invisible)";let e=[];this.hexAction.value.split("|").forEach(a=>{const n=(0,K.dy)(a);null!=n&&e.push(n)}),e.forEach(a=>this.fillHexes(a,e)),this.hexAction.value=e.map(a=>(0,K.mC)(a)).join("|"),s.E.uiChange.emit()}else if(this.action.type==G.X2.condition||this.action.type==G.X2.specialTarget||this.action.type==G.X2.card||this.action.type==G.X2.elementHalf)-1!=(""+this.action.value).indexOf(":")?(this.value=(""+this.action.value).split(":")[0],this.subValue=(""+this.action.value).split(":")[1]):this.value=""+this.action.value,this.action.type==G.X2.elementHalf&&(this.HalfElementsLeft=this.Elements.filter(e=>e!=yt.Hg.wild&&(!this.subValue||e!=this.subValue)),this.HalfElementsRight=this.Elements.filter(e=>e!=yt.Hg.wild&&(!this.value||e!=this.value)));else if(this.action.type==G.X2.summon&&this.action.valueObject)try{this.summon=Object.assign(new ds,this.action.valueObject)}catch{this.summon=void 0;const a=(this.action.value+"").split(":");this.monster=a[0],a.length>1&&(this.monsterType=a[1])}}valueChange(e){return isNaN(+e)?e||"":+e}addSubAction(){this.action.subActions||(this.action.subActions=[]),this.action.subActions.push(new G.rc(G.X2.attack)),this.change()}changeSubAction(e,a){this.action.subActions[e]=a,setTimeout(()=>{this.change()})}removeSubAction(e){this.action.subActions.splice(e,1),this.change()}changeType(e){const a=this.action.type;if(e!=a){if(this.action.type=e,this.action.valueType=G.iQ.fixed,this.action.type==G.X2.area){this.hexAction.value="(0,0,invisible)";let n=[];this.hexAction.value.split("|").forEach(o=>{const g=(0,K.dy)(o);null!=g&&n.push(g)}),n.forEach(o=>this.fillHexes(o,n)),this.hexAction.value=n.map(o=>(0,K.mC)(o)).join("|"),this.action.value=n.filter(o=>o.type!=K.Gq.invisible).map(o=>(0,K.mC)(o)).join("|")}else this.action.type==G.X2.condition?(this.value=this.conditionNames[0],this.changeCondition()):this.action.type==G.X2.element?this.action.value=this.Elements[0]:this.action.type==G.X2.card?(this.value=this.ActionCardTypes[0],this.changeCard()):-1!=[G.X2.area,G.X2.condition,G.X2.element,G.X2.card].indexOf(a)&&(this.action.value="1");this.change()}}change(){this.actionChange.emit(this.action),s.E.uiChange.emit()}toggleHex(e){switch(e.type){case K.Gq.target:e.type=K.Gq.active;break;case K.Gq.active:e.type=K.Gq.blank;break;case K.Gq.blank:e.type=K.Gq.ally;break;case K.Gq.ally:e.type=K.Gq.conditional;break;case K.Gq.conditional:e.type=K.Gq.enhance;break;case K.Gq.enhance:e.type=K.Gq.invisible;break;case K.Gq.invisible:e.type=K.Gq.target}let a=[];(""+this.hexAction.value).split("|").forEach(o=>{const g=(0,K.dy)(o);null!=g&&a.push(g)});const n=a.find(o=>e.x==o.x&&e.y==o.y);n?a.splice(a.indexOf(n),1,e):a.push(e),this.fillHexes(e,a),this.hexAction.value=a.map(o=>(0,K.mC)(o)).join("|"),this.action.value=a.filter(o=>o.type!=K.Gq.invisible).map(o=>(0,K.mC)(o)).join("|"),this.change()}changeHex(e){if(e!=this.hexAction.value){this.hexAction.value=e;let a=[];(""+this.hexAction.value).split("|").forEach(n=>{const o=(0,K.dy)(n);null!=o&&a.push(o)}),this.hexAction.value=a.map(n=>(0,K.mC)(n)).join("|"),this.action.value=a.filter(n=>n.type!=K.Gq.invisible).map(n=>(0,K.mC)(n)).join("|"),this.change()}}removeHex(e){let a=[];(""+this.hexAction.value).split("|").forEach(o=>{const g=(0,K.dy)(o);null!=g&&a.push(g)});const n=a.find(o=>e.x==o.x&&e.y==o.y);if(n){0==n.x&&0==n.y?n.type=K.Gq.invisible:a.splice(a.indexOf(n),1);for(let o=-1;o<2;o++)for(let g=-1;g<2;g++)if((e.x+o!=e.x||e.y+g!=e.y)&&e.x+o>=0&&e.y+g>=0){let _=a.find(y=>e.x+o==y.x&&e.y+g==y.y&&y.type==K.Gq.invisible);_&&(0!=_.x||0!=_.y)&&a.splice(a.indexOf(_),1)}}a.filter(o=>o.type!=K.Gq.invisible).forEach(o=>this.fillHexes(o,a)),this.hexAction.value=a.map(o=>(0,K.mC)(o)).join("|"),this.action.value=a.filter(o=>o.type!=K.Gq.invisible).map(o=>(0,K.mC)(o)).join("|"),this.change()}fillHexes(e,a){for(let n=-1;n<2;n++)for(let o=-1;o<2;o++)(e.x+n!=e.x||e.y+o!=e.y)&&e.x+n>=0&&e.y+o>=0&&(a.find(g=>e.x+n==g.x&&e.y+o==g.y)||a.push(new K.wd(e.x+n,e.y+o,K.Gq.invisible,"")))}changeSpecialTarget(e,a){-1==m.f.getLabel("game.specialTarget."+e).indexOf("{0}")?a="":a||(a="1"),this.value=e,this.subValue=a,this.action.value=this.value+(this.subValue?":"+this.subValue:""),this.change()}changeCondition(){-1!=new j.kW(this.value).types.indexOf(j.GV.value)?(this.subValue||(this.subValue="1"),this.action.value=this.value+":"+this.subValue):(this.action.value=this.value,this.subValue=""),this.change()}changeCard(){this.value==G.di.experience||this.value==G.di.slotXp?(this.subValue||(this.subValue="1"),this.action.value=this.value+":"+this.subValue):(this.action.value=this.value,this.subValue=""),this.change()}changeElementHalf(){this.HalfElementsLeft=this.Elements.filter(e=>e!=yt.Hg.wild&&(!this.subValue||e!=this.subValue)),this.HalfElementsRight=this.Elements.filter(e=>e!=yt.Hg.wild&&(!this.value||e!=this.value)),this.value=this.value||this.HalfElementsLeft[0],this.subValue=this.subValue||this.HalfElementsRight[0],-1!=this.Elements.indexOf(this.value)&&-1!=this.Elements.indexOf(this.subValue)&&(this.action.value=this.value+":"+this.subValue),this.change()}dropSubAction(e){(0,D.HD)(this.action.subActions,e.previousIndex,e.currentIndex),s.E.uiChange.emit()}changeSummonType(e){this.monster="",this.monsterType=void 0,"monster"==e.target.value?(this.summon=void 0,this.changeSummonMonster()):"summon"==e.target.value&&(this.summon=new ds,this.action.value="summonData",this.action.valueObject=this.summon)}changeSummonMonster(){this.action.value=this.monster+(this.monsterType?":"+this.monsterType:""),s.E.uiChange.emit()}changeSummon(){this.summon&&(this.action.valueObject=this.summon),s.E.uiChange.emit()}editSummonAction(){this.summon&&(this.summon.action||(this.summon.action=new G.rc(G.X2.attack)),this.dialog.open(ve,{panelClass:["dialog"],data:{action:this.summon.action}}).closed.subscribe({next:a=>{0==a&&this.summon&&(this.summon.action=void 0),this.changeSummon()}}))}editSummonAdditionalAction(){this.summon&&(this.summon.additionalAction||(this.summon.additionalAction=new G.rc(G.X2.attack)),this.dialog.open(ve,{panelClass:["dialog"],data:{action:this.summon.additionalAction}}).closed.subscribe({next:a=>{0==a&&this.summon&&(this.summon.additionalAction=void 0),this.changeSummon()}}))}removeEnhancement(e){this.action.enhancementTypes&&this.action.enhancementTypes[e]&&(this.action.enhancementTypes.splice(e,1),this.change())}addEnhancement(){this.action.enhancementTypes=this.action.enhancementTypes||[],this.action.enhancementTypes.push(this.EnhancementTypes[0]),this.change()}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-editor-action"]],inputs:{action:"action",actionTypes:"actionTypes",hideValues:"hideValues",subactionIndex:"subactionIndex",character:"character",cardId:"cardId"},outputs:{actionChange:"actionChange",subActionRemoved:"subActionRemoved"},standalone:!1,decls:34,vars:47,consts:[[1,"action"],[1,"header"],[1,"type",3,"ghs-label"],[1,"small"],["type","checkbox",3,"ngModel"],[3,"ghs-label"],[1,"spacer"],[1,"remove"],["placeholder","type",3,"ngModelChange","ngModel"],[3,"value"],["type","text",3,"ngModel"],[3,"ngModel"],[1,"area-container"],[1,"summon"],[1,"action-element-half-container"],[1,"enhancements"],["cdkDropList","",1,"subactions",3,"cdkDropListDropped"],[1,"add",3,"click"],["src","./assets/images/plus.svg",1,"ghs-icon"],["cdkDrag","",1,"subaction"],["type","checkbox",3,"ngModelChange","change","ngModel"],[1,"remove",3,"click"],["src","./assets/images/minus.svg",1,"ghs-icon"],[3,"ngModelChange","ngModel"],[1,"inline"],[3,"ghs-label","ghs-label-args"],["type","text",3,"ngModelChange","ngModel"],["type","text",3,"ngModelChange","change","ngModel"],[3,"ngModelChange","change","ngModel"],[1,"hexes"],[3,"clickCallback","doubleclickCallback","action","value","character","cardId"],[1,"summon-type"],["type","radio","name","summonType","value","monster",3,"change","checked"],["type","radio","name","summonType","value","summon",3,"change","checked"],[1,"summon-monster"],[1,"summon-form"],[3,"action","additional","character","cardId"],[1,"summon-name",3,"ngModelChange","change","ngModel"],[1,"grid"],[1,"item"],[1,"summon-health",3,"ngModelChange","change","ngModel"],[1,"summon-movement",3,"ngModelChange","change","ngModel"],[3,"click"],[1,"summon-attack",3,"ngModelChange","change","ngModel"],[1,"summon-range",3,"ngModelChange","change","ngModel"],["min","1","type","number",3,"ngModelChange","change","ngModel"],["placeholder","valueType",3,"ngModelChange","change","ngModel"],[3,"value","selected"],[1,"enhancement"],["cdkDragHandle","",1,"handle"],["src","./assets/images/menu.svg",1,"ghs-icon"],[3,"subActionRemoved","actionChange","action","subactionIndex"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"span",2),t.j41(3,"label",3),t.nVh(4,ck,1,1,"input",4),t.nVh(5,lk,1,1,"span",5),t.k0s(),t.nrm(6,"span",6),t.nVh(7,gk,3,1,"a",7),t.k0s(),t.j41(8,"select",8),t.bIt("ngModelChange",function(g){return n.changeType(g)}),t.Z7z(9,dk,2,2,"option",9,t.fX1),t.k0s(),t.nVh(11,hk,2,1,"label"),t.nVh(12,pk,4,2),t.nVh(13,uk,1,1,"input",10),t.nVh(14,fk,2,1,"textarea",11),t.nVh(15,Ck,4,5,"div",12),t.nVh(16,yk,10,6,"div",13),t.nVh(17,wk,4,2),t.nVh(18,Gk,4,2),t.nVh(19,Sk,3,1,"select",11),t.j41(20,"div",14),t.nVh(21,Dk,3,1,"select",11),t.nVh(22,Ak,3,1,"select",11),t.k0s(),t.nVh(23,Fk,3,1,"select",11),t.nVh(24,Bk,5,2),t.nVh(25,Lk,7,3,"div",15),t.j41(26,"div",16),t.bIt("cdkDropListDropped",function(g){return n.dropSubAction(g)}),t.j41(27,"div",1),t.nrm(28,"label",5),t.j41(29,"a",17),t.bIt("click",function(){return n.addSubAction()}),t.nrm(30,"img",18)(31,"span",5),t.k0s()(),t.Z7z(32,Uk,4,2,"div",19,rk),t.k0s()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","editor.action.type"),t.R7$(2),t.vxM(n.hideValues?-1:4),t.R7$(),t.vxM(n.hideValues?-1:5),t.R7$(2),t.vxM(n.subactionIndex||0==n.subactionIndex?7:-1),t.R7$(),t.Y8G("ngModel",n.action.type),t.R7$(),t.Dyx(n.actionTypes),t.R7$(2),t.vxM(n.hideValues||-1!=t.eq3(21,ik,n.ActionType.jump).indexOf(n.action.type)?-1:11),t.R7$(),t.vxM(n.action.type==n.ActionType.specialTarget?12:-1),t.R7$(),t.vxM(n.hideValues||-1!=t.zJS(23,ak,[n.ActionType.area,n.ActionType.card,n.ActionType.condition,n.ActionType.element,n.ActionType.elementHalf,n.ActionType.jump,n.ActionType.monsterType,n.ActionType.specialTarget,n.ActionType.summon,n.ActionType.custom]).indexOf(n.action.type)?-1:13),t.R7$(),t.vxM(n.hideValues||n.action.type!=n.ActionType.custom?-1:14),t.R7$(),t.vxM(n.action.type==n.ActionType.area?15:-1),t.R7$(),t.vxM(n.action.type==n.ActionType.summon?16:-1),t.R7$(),t.vxM(n.action.type==n.ActionType.condition?17:-1),t.R7$(),t.vxM(n.action.type==n.ActionType.card?18:-1),t.R7$(),t.vxM(n.action.type==n.ActionType.element?19:-1),t.R7$(2),t.vxM(n.action.type==n.ActionType.elementHalf?21:-1),t.R7$(),t.vxM(n.action.type==n.ActionType.elementHalf?22:-1),t.R7$(),t.vxM(n.action.type==n.ActionType.monsterType?23:-1),t.R7$(),t.vxM(n.hideValues||-1!=t.zJS(34,ok,[n.ActionType.area,n.ActionType.card,n.ActionType.condition,n.ActionType.concatenation,n.ActionType.custom,n.ActionType.grant,n.ActionType.grid,n.ActionType.jump,n.ActionType.monsterType,n.ActionType.specialTarget,n.ActionType.summon,n.ActionType.trigger]).indexOf(n.action.type)?-1:24),t.R7$(),t.vxM(n.hideValues?-1:25),t.R7$(3),t.Y8G("ghs-label","editor.action.subActions"),t.R7$(3),t.Y8G("ghs-label","editor.action.addSubAction"),t.R7$(),t.Dyx(n.action.subActions))},dependencies:[O.xH,O.y7,O.me,O.Q0,O.Zm,O.wz,O.BC,O.VZ,O.vS,D.O7,D.T1,D.Fb,Oi,us,i,tt,Tt],styles:[".action[_ngcontent-%COMP%]{display:flex;flex-direction:column;color:var(--ghs-color-white)}.action[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center;flex-wrap:wrap}.action[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1);display:flex;align-items:center}.action[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 3)}.action[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1)}.action[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{display:flex;align-items:center}.action[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]{display:flex;flex-direction:column}.action[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]{display:flex;align-items:center}.action[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{white-space:nowrap;margin-left:calc(var(--ghs-unit) * .5)}.action[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%]{display:flex;flex-direction:column}.action[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%]   .subaction[_ngcontent-%COMP%]{position:relative;margin-left:calc(var(--ghs-unit) * 2)}.action[_ngcontent-%COMP%]   .subactions[_ngcontent-%COMP%]   .subaction[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.action[_ngcontent-%COMP%]   .area-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:calc(var(--ghs-unit) * .5)}.action[_ngcontent-%COMP%]   .area-container[_ngcontent-%COMP%]   .hexes[_ngcontent-%COMP%]{width:0}.action[_ngcontent-%COMP%]   .area-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:50%}.action[_ngcontent-%COMP%]   .action-element-half-container[_ngcontent-%COMP%]{display:flex}label.inline[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * .5);display:flex}input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{width:100%;min-width:initial;color:var(--ghs-color-white);background-color:transparent;border:1px solid var(--ghs-color-gray);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.7 * var(--ghs-fontsize))}input[type=text][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:hover, select[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:hover{border:1px solid var(--ghs-color-gray)}input[type=text][_ngcontent-%COMP%]   option[_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]   option[_ngcontent-%COMP%], select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:var(--ghs-color-black)}.ghs-icon[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}a[_ngcontent-%COMP%]{display:flex;align-items:center}a[_ngcontent-%COMP%]   .ghs-icon[_ngcontent-%COMP%]:nth-child(1){margin-right:.2em}a[_ngcontent-%COMP%], ghs-action-hex[_ngcontent-%COMP%]{cursor:pointer}.summon[_ngcontent-%COMP%]   .summon-type[_ngcontent-%COMP%], .summon[_ngcontent-%COMP%]   .summon-type[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .summon[_ngcontent-%COMP%]   .summon-monster[_ngcontent-%COMP%]{display:flex}.summon[_ngcontent-%COMP%]   .summon-form[_ngcontent-%COMP%]{position:relative;padding-top:38%;background-color:var(--ghs-color-darkgray)}.summon[_ngcontent-%COMP%]   .summon-form[_ngcontent-%COMP%]   ghs-action-summon[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%}.summon[_ngcontent-%COMP%]   .summon-form[_ngcontent-%COMP%]   .summon-name[_ngcontent-%COMP%]{position:absolute;top:5%;left:50%;width:65%;height:20%;transform:translate(-50%)}.summon[_ngcontent-%COMP%]   .summon-form[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:32% 32% 36%;grid-template-rows:1fr 1fr;position:absolute;justify-items:stretch;top:36%;left:13%;width:87%;height:56%}.summon[_ngcontent-%COMP%]   .summon-form[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{display:flex;justify-content:center}.summon[_ngcontent-%COMP%]   .summon-form[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:100%;width:30%;margin-left:40%}.summon[_ngcontent-%COMP%]   .summon-form[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:var(--ghs-color-black);opacity:.7}"]})}return i})(),ve=(()=>{class i{data;dialogRef;relative=!0;noPreview=[];constructor(e,a){this.data=e,this.dialogRef=a}deleteAction(){this.dialogRef.close(!1)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-editor-action-dialog"]],standalone:!1,decls:6,vars:5,consts:[[1,"scroll-container"],[3,"action","relative","character","cardId"],[3,"actionChange","action","character","cardId"],[3,"click"],["src","./assets/images/minus.svg",1,"ghs-icon"],[3,"ghs-label"],[3,"click","action","relative","character","cardId"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nVh(1,qk,1,4,"ghs-action",1),t.j41(2,"ghs-editor-action",2),t.mxI("actionChange",function(g){return t.DH7(n.data.action,g)||(n.data.action=g),g}),t.k0s(),t.j41(3,"a",3),t.bIt("click",function(){return n.deleteAction()}),t.nrm(4,"img",4)(5,"span",5),t.k0s()()),2&a&&(t.R7$(),t.vxM(-1==n.noPreview.indexOf(n.data.action.type)?1:-1),t.R7$(),t.R50("action",n.data.action),t.Y8G("character",n.data.character)("cardId",n.data.cardId),t.R7$(3),t.Y8G("ghs-label","editor.action.remove"))},dependencies:[ae,fs,tt],styles:["[_nghost-%COMP%]{display:block;font-size:calc(var(--ghs-unit) * 2.7 * var(--ghs-fontsize));width:500px}ghs-action[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.7 * var(--ghs-fontsize))}.ghs-icon[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}a[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center}a[_ngcontent-%COMP%]   .ghs-icon[_ngcontent-%COMP%]:nth-child(1){margin-right:.2em}"]})}return i})();const Hk=(i,r,e,a,n)=>[i,r,e,a,n],Kk=(i,r,e,a)=>[i,r,e,a],bi=(i,r)=>[i,r],Wk=i=>[i],Cs=()=>[],ze=i=>({active:i}),Oa=i=>({enabled:i}),Jk=i=>({disabled:i});function Zk(i,r){1&i&&t.nrm(0,"div",2)}function Qk(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-editor-action",23),t.bIt("actionChange",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.updateAction(n.action))}),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("action",e.action)("actionTypes",e.actionTypes)("hideValues",!0)}}function ty(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",25),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.level=n+1)}),t.EFF(1),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ngClass",t.eq3(2,ze,a.level==e+1)),t.R7$(),t.JRh(e+1)}}function ey(i,r){1&i&&(t.Z7z(0,ty,2,4,"a",24,t.fX1),t.nI1(2,"ghsRange")),2&i&&t.Dyx(t.i5U(2,0,t.lJ4(3,Cs),9))}function ny(i,r){if(1&i&&(t.j41(0,"a",9),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.JRh(e.level)}}function iy(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",28),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.enhancements=n)}),t.EFF(1),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ngClass",t.eq3(2,ze,a.enhancements==e)),t.R7$(),t.JRh(e)}}function ay(i,r){if(1&i){const e=t.RV6();t.Z7z(0,iy,2,4,"a",26,t.fX1),t.nI1(2,"ghsRange"),t.j41(3,"a",27),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.enhancements=n.enhancements+1)}),t.EFF(4,"+"),t.k0s()}if(2&i){const e=t.XpG();t.Dyx(t.i5U(2,0,t.lJ4(3,Cs),e.enhancements+1))}}function oy(i,r){if(1&i&&(t.j41(0,"a",11),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.JRh(e.enhancements)}}function sy(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",33),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.toggleSpecial("lost"))}),t.nrm(1,"img",34)(2,"img",35),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(1,Oa,"lost"==e.special))}}function ry(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",36),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.toggleSpecial("persistent"))}),t.nrm(1,"img",37)(2,"img",38),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(1,Oa,"persistent"==e.special))}}function cy(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",12)(1,"a",29),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleSpecial("summon"))}),t.nrm(2,"img",30),t.k0s(),t.nVh(3,sy,3,3,"a",31),t.nVh(4,ry,3,3,"a",32),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(3,Oa,"summon"==e.special)),t.R7$(2),t.vxM(e.gameManager.enhancementsManager.fh?3:-1),t.R7$(),t.vxM(e.gameManager.enhancementsManager.fh&&!e.gameManager.gh2eRules()?4:-1)}}function ly(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",39),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.setEnhancementAction("plus1"))}),t.EFF(1,"+1 "),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(1,ze,"plus1"==e.enhancementAction))}}function gy(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",41),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.setEnhancementAction(n))}),t.nrm(1,"span",8),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ngClass",t.eq3(2,ze,a.enhancementAction==e)),t.R7$(),t.Y8G("ghs-label","%game.element."+e+"%")}}function dy(i,r){if(1&i&&(t.j41(0,"div",15),t.Z7z(1,gy,2,4,"div",40,t.fX1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.Elements)}}function hy(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",43),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.setEnhancementAction(n))}),t.nrm(1,"span",8),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ngClass",t.eq3(2,ze,a.enhancementAction==e)),t.R7$(),t.Y8G("ghs-label","%game.conditionIcon."+e+"%")}}function _y(i,r){if(1&i&&(t.j41(0,"div",16),t.Z7z(1,hy,2,4,"div",42,t.fX1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.gameManager.enhancementsManager.diamondConditions)}}function my(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",43),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.setEnhancementAction(n))}),t.nrm(1,"span",8),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ngClass",t.eq3(2,ze,a.enhancementAction==e)),t.R7$(),t.Y8G("ghs-label","%game.conditionIcon."+e+"%")}}function py(i,r){if(1&i&&(t.j41(0,"div",16),t.Z7z(1,my,2,4,"div",42,t.fX1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.gameManager.enhancementsManager.diamondPlusConditions)}}function uy(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",44),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.setEnhancementAction(n.ActionType.jump))}),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(2,ze,e.enhancementAction==e.ActionType.jump))("ghs-label","%game.actionIcon.jump%")}}function fy(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",45),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.setEnhancementAction("hex"))}),t.nrm(1,"img",46),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(1,ze,"hex"==e.enhancementAction))}}function Cy(i,r){if(1&i&&(t.j41(0,"tr"),t.nrm(1,"th",8),t.j41(2,"td",47),t.EFF(3),t.k0s()()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","character.abilities.enhancements.multiTarget"),t.R7$(2),t.SpI("+",e.gameManager.enhancementsManager.calculateBaseCosts(e.enhanceAction,e.special))}}function My(i,r){if(1&i&&(t.j41(0,"tr"),t.nrm(1,"th",8),t.j41(2,"td",48),t.EFF(3),t.nI1(4,"ghsCeil"),t.k0s()()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","character.abilities.enhancements.lost"),t.R7$(2),t.SpI("-",t.bMT(4,2,e.gameManager.enhancementsManager.calculateBaseCosts(e.enhanceAction,e.special)/(e.gameManager.actionsManager.isMultiTarget(e.enhanceAction)?1:2))," ")}}function vy(i,r){if(1&i&&(t.j41(0,"tr"),t.nrm(1,"th",8),t.j41(2,"td",47),t.EFF(3),t.k0s()()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","character.abilities.enhancements.persistent"),t.R7$(2),t.SpI("+",e.gameManager.enhancementsManager.calculateBaseCosts(e.enhanceAction,e.special)*(e.gameManager.actionsManager.isMultiTarget(e.enhanceAction)?5:2))}}function Oy(i,r){if(1&i&&(t.j41(0,"tr"),t.nrm(1,"th",8),t.j41(2,"td",47),t.EFF(3),t.k0s()()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","character.abilities.enhancements.level"),t.R7$(2),t.SpI("+",e.gameManager.enhancementsManager.levelCosts(e.level))}}function Py(i,r){if(1&i&&(t.j41(0,"tr"),t.nrm(1,"th",8),t.j41(2,"td",47),t.EFF(3),t.k0s()()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","character.abilities.enhancements.enhancements"),t.R7$(2),t.SpI("+",e.gameManager.enhancementsManager.enhancementCosts(e.enhancements))}}function by(i,r){if(1&i&&(t.j41(0,"tr"),t.nrm(1,"th",8),t.j41(2,"td",48),t.EFF(3),t.nI1(4,"ghsCeil"),t.k0s()()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","character.abilities.enhancements.temporary"),t.R7$(2),t.SpI(" -",t.bMT(4,2,.2*e.gameManager.enhancementsManager.calculateCosts(e.enhanceAction,e.level,e.special,e.enhancements,!0)))}}function ky(i,r){1&i&&(t.j41(0,"tr"),t.nrm(1,"th",8),t.j41(2,"td",48),t.EFF(3,"-10"),t.k0s()()),2&i&&(t.R7$(),t.Y8G("ghs-label","character.abilities.enhancements.enhancerLevel"))}function yy(i,r){if(1&i&&t.nrm(0,"p",21),2&i){const e=t.XpG();t.Y8G("ghs-label","character.abilities.enhancements.disabled.enhancements")("ghs-label-args",t.l_i(2,bi,e.enhancedCards,e.gameManager.prosperityLevel()))}}function xy(i,r){if(1&i&&t.nrm(0,"p",21),2&i){const e=t.XpG();t.Y8G("ghs-label","character.abilities.enhancements.disabled.gold")("ghs-label-args",t.l_i(2,bi,e.data.character.progress.gold,e.gameManager.enhancementsManager.calculateCosts(e.enhanceAction,e.level,e.special,e.enhancements)))}}function Ey(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",22)(1,"a",49),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.close())}),t.nrm(2,"span",8),t.k0s(),t.j41(3,"a",50),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.apply())})("doubleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.apply(!0))}),t.nrm(4,"span",8),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","cancel"),t.R7$(),t.Y8G("ngClass",t.eq3(3,Jk,e.data.character&&e.data.character.progress.gold<e.gameManager.enhancementsManager.calculateCosts(e.enhanceAction,e.level,e.special,e.enhancements)||!e.gameManager.enhancementsManager.fh&&e.enhancedCards>=e.gameManager.prosperityLevel())),t.R7$(),t.Y8G("ghs-label","character.abilities.enhancements.apply")}}let Pa=(()=>{class i{data;dialogRef;gameManager=s.E;ActionType=G.X2;EnhancementType=jt.J;Elements=Object.values(yt.Hg);action;enhanceAction;level=1;enhancements=0;special;character;customAction;wipSpecial=!1;customSpecial=!1;actionTypes=[];enhancementAction="plus1";enhancementType;enhancedCards=0;constructor(e,a){this.data=e,this.dialogRef=a,this.data=e||{},this.action=this.data.action?JSON.parse(JSON.stringify(this.data.action)):new G.rc(G.X2.attack,1),this.action.small=!1,this.character=this.data.character?JSON.parse(JSON.stringify(this.data.character)):void 0,this.customAction=!1,this.enhanceAction=new G.rc(this.action.type,this.action.value,this.action.valueType,this.action.subActions),this.data.summon&&(this.action=new G.rc(G.X2.summon,"summonData"),this.action.valueObject=this.data.summon,this.action.enhancementTypes=[jt.J.square,jt.J.square,jt.J.square,jt.J.square]),this.wipSpecial=null!=this.action&&this.action.type==G.X2.custom&&"%character.abilities.wip%"==this.action.value}ngOnInit(){if(this.data.action&&this.data.actionIndex&&this.data.cardId&&null!=this.data.enhancementIndex&&this.data.character){const e=s.E.deckData(this.data.character).abilities.find(a=>a.cardId==this.data.cardId);if(e&&(this.level="number"==typeof e.level?e.level:1,-1!=this.data.actionIndex.indexOf("bottom")?((e.bottomLost||e.bottomActions.find(a=>a.type==G.X2.card&&-1!=a.value.toString().indexOf("lost")))&&(this.special="lost"),(e.bottomPersistent||e.bottomActions.find(a=>a.type==G.X2.card&&-1!=a.value.toString().indexOf("persistent")))&&(this.special="persistent")):((e.lost||e.actions.find(a=>a.type==G.X2.card&&-1!=a.value.toString().indexOf("lost")))&&(this.special="lost"),(e.persistent||e.actions.find(a=>a.type==G.X2.card&&-1!=a.value.toString().indexOf("persistent")))&&(this.special="persistent")),this.data.summon&&(this.special="summon")),this.enhancements=this.data.character.progress.enhancements&&this.data.character.progress.enhancements.filter(a=>a.cardId==this.data.cardId&&this.data.actionIndex&&a.actionIndex.indexOf("bottom")==this.data.actionIndex.indexOf("bottom")).length||0,this.enhancedCards=this.data.character.progress.enhancements&&this.data.character.progress.enhancements.filter(a=>!a.inherited).map(a=>a.cardId).filter((a,n,o)=>(!this.data.cardId||this.data.cardId!=a)&&n==o.indexOf(a)).length,-1!=[G.X2.custom,G.X2.specialTarget].indexOf(this.data.action.type)&&this.data.action.enhancementTypes&&!this.wipSpecial){switch(this.customSpecial=!0,this.data.action.enhancementTypes[this.data.enhancementIndex]){case jt.J.square:this.actionTypes=s.E.enhancementsManager.squareActions;break;case jt.J.circle:this.actionTypes=s.E.enhancementsManager.circleActions;break;case jt.J.diamond:this.actionTypes=s.E.enhancementsManager.diamondActions;break;case jt.J.diamond_plus:this.actionTypes=s.E.enhancementsManager.diamondPlusActions}this.action=new G.rc(this.actionTypes[0],1)}}else this.customAction=!0;this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.data.character&&this.data.cardId&&(this.enhancements=this.data.character.progress.enhancements&&this.data.character.progress.enhancements.filter(e=>e.cardId==this.data.cardId&&this.data.actionIndex&&e.actionIndex.indexOf("bottom")==this.data.actionIndex.indexOf("bottom")).length||0,this.enhancedCards=this.data.character.progress.enhancements&&this.data.character.progress.enhancements.filter(e=>!e.inherited).map(e=>e.cardId).filter((e,a,n)=>(!this.data.cardId||this.data.cardId!=e)&&a==n.indexOf(e)).length)}}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}updateAction(e=void 0){e&&(this.action=e,this.enhanceAction=new G.rc(this.action.type,this.action.value,this.action.valueType,this.action.subActions)),this.update()}update(){this.customSpecial||(this.actionTypes=[...s.E.enhancementsManager.squareActions,...s.E.enhancementsManager.circleActions,...s.E.enhancementsManager.diamondActions,...s.E.enhancementsManager.diamondPlusActions,...s.E.enhancementsManager.hexActions].filter((a,n,o)=>n===o.indexOf(a))),"summon"===this.special?this.actionTypes=[...s.E.enhancementsManager.summonActions]:-1==this.actionTypes.indexOf(this.action.type)&&(this.action=new G.rc(G.X2.attack,1));const e=this.enhancementType;this.action.enhancementTypes&&this.action.enhancementTypes.length&&!this.wipSpecial?null!=this.data.enhancementIndex&&(this.enhancementType=this.action.enhancementTypes[this.data.enhancementIndex]):(-1!=s.E.enhancementsManager.squareActions.indexOf(this.action.type)&&(this.enhancementType=jt.J.square),-1!=s.E.enhancementsManager.circleActions.indexOf(this.action.type)&&(this.enhancementType=jt.J.circle),-1!=s.E.enhancementsManager.diamondActions.indexOf(this.action.type)&&(this.action.type!=G.X2.condition||-1!=new j.kW(""+this.action.value).types.indexOf(j.GV.negative))&&(this.enhancementType=jt.J.diamond),-1!=s.E.enhancementsManager.diamondPlusActions.indexOf(this.action.type)&&(this.action.type!=G.X2.condition||-1!=new j.kW(""+this.action.value).types.indexOf(j.GV.positive))&&(this.enhancementType=jt.J.diamond_plus),-1!=s.E.enhancementsManager.hexActions.indexOf(this.action.type)&&(this.enhancementType=jt.J.hex)),"summon"===this.special&&(this.enhancementType=jt.J.square,this.enhancementAction="plus1"),!this.data.action||"plus1"!=this.enhancementAction&&"hex"!=this.enhancementAction?Object.values(j.r5).includes(this.enhancementAction)?this.enhanceAction=new G.rc(G.X2.condition,this.enhancementAction):Object.values(yt.Hg).includes(this.enhancementAction)?this.enhanceAction=new G.rc(G.X2.element,this.enhancementAction):this.enhancementAction==G.X2.jump?this.enhanceAction=new G.rc(G.X2.jump):"plus1"==this.enhancementAction&&(this.enhanceAction=new G.rc(this.action.type,this.action.value,this.action.valueType,this.action.subActions)):this.wipSpecial||this.customSpecial?(this.enhanceAction=this.action,this.enhanceAction.enhancementTypes=this.data.action.enhancementTypes):this.enhanceAction=new G.rc(this.data.action.type,this.data.action.value,this.data.action.valueType),this.action.subActions&&(this.enhanceAction.subActions=JSON.parse(JSON.stringify(this.action.subActions))),this.enhancementType==jt.J.hex?this.enhancementAction="hex":e!=this.enhancementType&&(this.enhancementAction="plus1"),this.data.actionIndex&&this.data.cardId&&null!=this.data.enhancementIndex&&this.character&&(this.character.tags=[],this.character.progress.enhancements=this.data.character&&this.data.character.progress.enhancements&&JSON.parse(JSON.stringify(this.data.character.progress.enhancements))||[],this.character.progress.enhancements.push(new jt.V(this.data.cardId,this.data.actionIndex,this.data.enhancementIndex,this.enhancementAction))),s.E.uiChange.emit()}setEnhancementAction(e){this.enhancementAction=e,this.update()}toggleSpecial(e){this.special=this.special==e?void 0:e,this.update()}close(){(0,V.co)(this.dialogRef)}apply(e=!1){const a=s.E.enhancementsManager.calculateCosts(this.enhanceAction,this.level,this.special,this.enhancements);this.data.actionIndex&&this.data.cardId&&null!=this.data.enhancementIndex&&this.data.character&&(this.data.character.progress.gold>=a&&(s.E.enhancementsManager.fh||this.enhancedCards<s.E.prosperityLevel())||e)&&(s.E.stateManager.before("enhanceCard",s.E.characterManager.characterName(this.data.character),this.data.cardId),this.data.character.progress.enhancements||(this.data.character.progress.enhancements=[]),this.data.character.progress.enhancements.push(new jt.V(this.data.cardId,this.data.actionIndex,this.data.enhancementIndex,this.enhancementAction)),e||(this.data.character.progress.gold-=a),s.E.stateManager.after(),(0,V.co)(this.dialogRef))}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-enhancement-dialog"]],standalone:!1,decls:45,vars:53,consts:[[1,"enhancement-dialog","scroll-container"],[1,"header"],["ghs-setting-menu","alwaysFhEnhancements"],["ghs-setting-menu","temporaryEnhancements"],[1,"action"],[3,"action","relative","character","index","cardId"],[3,"action","actionTypes","hideValues"],[1,"levels"],[3,"ghs-label"],[1,"level","active","disabled"],[1,"previous-enhancements"],[1,"previous-enhancement","active","disabled"],[1,"card-properties"],[1,"enhancement-types"],[1,"plus1",3,"ngClass"],[1,"elements"],[1,"conditions"],[1,"jump","text-white",3,"ngClass","ghs-label"],[1,"hex",3,"ngClass"],[1,"costs"],[1,"hints"],[3,"ghs-label","ghs-label-args"],[1,"menu"],[3,"actionChange","action","actionTypes","hideValues"],[1,"level",3,"ngClass"],[1,"level",3,"click","ngClass"],[1,"previous-enhancement",3,"ngClass"],[1,"previous-enhancement","plus",3,"click"],[1,"previous-enhancement",3,"click","ngClass"],[1,"summon",3,"click","ngClass"],["src","./assets/images/summons/red.png"],[1,"lost",3,"ngClass"],[1,"persistent",3,"ngClass"],[1,"lost",3,"click","ngClass"],["src","./assets/images/action/card/lost.svg"],["src","./assets/images/action/card/overlay/lost.svg",1,"overlay"],[1,"persistent",3,"click","ngClass"],["src","./assets/images/action/card/persistent.svg"],["src","./assets/images/action/card/overlay/persistent.svg",1,"overlay"],[1,"plus1",3,"click","ngClass"],[1,"element",3,"ngClass"],[1,"element",3,"click","ngClass"],[1,"condition",3,"ngClass"],[1,"condition",3,"click","ngClass"],[1,"jump","text-white",3,"click","ngClass","ghs-label"],[1,"hex",3,"click","ngClass"],["src","./assets/images/action/hex/target.svg"],[1,"plus"],[1,"minus"],[1,"cancel",3,"click"],["ghs-pointer-input","",1,"apply",3,"singleClick","doubleClick","ngClass"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.nVh(2,Zk,1,0,"div",2),t.nrm(3,"div",3),t.j41(4,"div",4),t.nrm(5,"ghs-action",5),t.nVh(6,Qk,1,3,"ghs-editor-action",6),t.k0s(),t.j41(7,"div",7),t.nrm(8,"label",8),t.nVh(9,ey,3,4),t.nVh(10,ny,2,1,"a",9),t.k0s(),t.j41(11,"div",10),t.nrm(12,"label",8),t.nVh(13,ay,5,4),t.nVh(14,oy,2,1,"a",11),t.k0s(),t.nVh(15,cy,5,5,"div",12),t.j41(16,"div",13),t.nVh(17,ly,2,3,"div",14),t.nVh(18,dy,3,0,"div",15),t.nVh(19,_y,3,0,"div",16),t.nVh(20,py,3,0,"div",16),t.nVh(21,uy,1,4,"div",17),t.nVh(22,fy,2,3,"div",18),t.k0s()(),t.j41(23,"div",19)(24,"table")(25,"tr"),t.nrm(26,"th",8),t.j41(27,"td"),t.EFF(28),t.k0s()(),t.nVh(29,Cy,4,2,"tr"),t.nVh(30,My,5,4,"tr"),t.nVh(31,vy,4,2,"tr"),t.nVh(32,Oy,4,2,"tr"),t.nVh(33,Py,4,2,"tr"),t.nVh(34,by,5,4,"tr"),t.nVh(35,ky,4,1,"tr"),t.j41(36,"tfoot")(37,"tr"),t.nrm(38,"th",8),t.j41(39,"td"),t.EFF(40),t.k0s()()()()(),t.j41(41,"div",20),t.nVh(42,yy,1,5,"p",21),t.nVh(43,xy,1,5,"p",21),t.k0s(),t.nVh(44,Ey,5,5,"div",22),t.k0s()),2&a&&(t.R7$(2),t.vxM(n.gameManager.fhRules(!0)?-1:2),t.R7$(3),t.Y8G("action",n.action)("relative",!1)("character",n.character)("index",n.data.actionIndex||"")("cardId",n.data.cardId),t.R7$(),t.vxM(n.customAction||n.wipSpecial||n.customSpecial?6:-1),t.R7$(2),t.Y8G("ghs-label","character.abilities.enhancements.level"),t.R7$(),t.vxM(n.customAction?9:-1),t.R7$(),t.vxM(n.customAction?-1:10),t.R7$(2),t.Y8G("ghs-label","character.abilities.enhancements.enhancements"),t.R7$(),t.vxM(n.customAction?13:-1),t.R7$(),t.vxM(n.customAction?-1:14),t.R7$(),t.vxM(n.customAction?15:-1),t.R7$(2),t.vxM(n.enhancementType&&-1!=t.s1E(34,Hk,n.EnhancementType.square,n.EnhancementType.circle,n.EnhancementType.diamond,n.EnhancementType.diamond_plus,n.EnhancementType.any).indexOf(n.enhancementType)?17:-1),t.R7$(),t.vxM(n.enhancementType&&-1!=t.ziG(40,Kk,n.EnhancementType.circle,n.EnhancementType.diamond,n.EnhancementType.diamond_plus,n.EnhancementType.any).indexOf(n.enhancementType)?18:-1),t.R7$(),t.vxM(n.enhancementType&&-1!=t.l_i(45,bi,n.EnhancementType.diamond,n.EnhancementType.any).indexOf(n.enhancementType)?19:-1),t.R7$(),t.vxM(n.enhancementType&&-1!=t.l_i(48,bi,n.EnhancementType.diamond_plus,n.EnhancementType.any).indexOf(n.enhancementType)?20:-1),t.R7$(),t.vxM(n.enhancementType&&n.action.type==n.ActionType.move&&"summon"!=n.special?21:-1),t.R7$(),t.vxM(n.enhancementType&&-1!=t.eq3(51,Wk,n.EnhancementType.any).indexOf(n.enhancementType)?22:-1),t.R7$(4),t.Y8G("ghs-label","character.abilities.enhancements.baseCosts"),t.R7$(2),t.JRh(n.gameManager.enhancementsManager.calculateBaseCosts(n.enhanceAction,n.special)),t.R7$(),t.vxM(n.gameManager.actionsManager.isMultiTarget(n.enhanceAction)?29:-1),t.R7$(),t.vxM(n.gameManager.enhancementsManager.fh&&"lost"==n.special?30:-1),t.R7$(),t.vxM(n.gameManager.enhancementsManager.fh&&"persistent"==n.special?31:-1),t.R7$(),t.vxM(n.level>1?32:-1),t.R7$(),t.vxM(n.enhancements?33:-1),t.R7$(),t.vxM(n.gameManager.enhancementsManager.fh&&n.gameManager.enhancementsManager.temporary?34:-1),t.R7$(),t.vxM(n.gameManager.enhancementsManager.enhancerLevel>1?35:-1),t.R7$(3),t.Y8G("ghs-label","character.abilities.enhancements.costs"),t.R7$(2),t.SpI("",n.gameManager.enhancementsManager.calculateCosts(n.enhanceAction,n.level,n.special,n.enhancements)," "),t.R7$(2),t.vxM(!n.gameManager.enhancementsManager.fh&&n.enhancedCards>=n.gameManager.prosperityLevel()?42:-1),t.R7$(),t.vxM(n.data.character&&n.data.character.progress.gold<n.gameManager.enhancementsManager.calculateCosts(n.enhanceAction,n.level,n.special,n.enhancements)?43:-1),t.R7$(),t.vxM(n.character?44:-1))},dependencies:[N.YU,ae,fs,tt,rt,un,dh,Tt],styles:[".enhancement-dialog[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));color:var(--ghs-color-white)}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]{display:block}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]{display:flex;align-items:center;flex-wrap:wrap}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));color:var(--ghs-color-gray)}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .previous-enhancement[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .previous-enhancement[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));color:var(--ghs-color-darkgray);text-shadow:var(--ghs-outline);height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor))}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level.level[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .previous-enhancement.level[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .level.level[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .previous-enhancement.level[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor))}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level.placeholder[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .previous-enhancement.placeholder[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .level.placeholder[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .previous-enhancement.placeholder[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level.active[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .previous-enhancement.active[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .level.active[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .previous-enhancement.active[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level.active.placeholder[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .previous-enhancement.active.placeholder[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .level.active.placeholder[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .previous-enhancement.active.placeholder[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level.disabled[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .previous-enhancement.disabled[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .level.disabled[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .previous-enhancement.disabled[_ngcontent-%COMP%]{cursor:initial;pointer-events:none}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover, .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .previous-enhancement[_ngcontent-%COMP%]:hover, .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover, .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .previous-enhancement[_ngcontent-%COMP%]:hover{color:var(--ghs-color-gray)}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover.placeholder, .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .previous-enhancement[_ngcontent-%COMP%]:hover.placeholder, .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover.placeholder, .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .previous-enhancements[_ngcontent-%COMP%]   .previous-enhancement[_ngcontent-%COMP%]:hover.placeholder{filter:var(--ghs-filter-gray)}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .card-properties[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .card-properties[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;height:2.5em;width:2.5em;margin:.25em;filter:grayscale(.7);opacity:.5;cursor:pointer;padding:.3em;border-radius:100%}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .card-properties[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{filter:grayscale(.5);opacity:1}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .card-properties[_ngcontent-%COMP%]   a.enabled[_ngcontent-%COMP%]{filter:grayscale(0);opacity:1;border:calc(var(--ghs-unit) * .1 * var(--ghs-text-factor)) solid var(--ghs-color-white)}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .card-properties[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:relative;width:1.5em;height:auto}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .card-properties[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:nth-child(1){filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .card-properties[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:nth-child(2){position:absolute}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .card-properties[_ngcontent-%COMP%]   a.summon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:1.6em}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .card-properties[_ngcontent-%COMP%]   a.summon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:nth-child(1){filter:none}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .plus1[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .jump[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor));opacity:.7;filter:grayscale(.6);border-radius:100%}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .plus1.condition[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .element.condition[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .condition.condition[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .jump.condition[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.1 * var(--ghs-text-factor))}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .plus1[_ngcontent-%COMP%]:hover, .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%]:hover, .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:hover, .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .jump[_ngcontent-%COMP%]:hover{font-size:1.4em;opacity:1}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .plus1.active[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .element.active[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .condition.active[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .jump.active[_ngcontent-%COMP%]{font-size:1.6em;opacity:1;filter:none;border:calc(var(--ghs-unit) * .1 * var(--ghs-text-factor)) solid var(--ghs-color-white);pointer-events:none}.enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .plus1.active.condition[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .element.active.condition[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .condition.active.condition[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .enhancement-types[_ngcontent-%COMP%]   .jump.active.condition[_ngcontent-%COMP%]{font-size:1.3em}.enhancement-dialog[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]{display:flex;justify-content:center}.enhancement-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor))}.enhancement-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:left;padding-right:calc(var(--ghs-unit) * 6 * var(--ghs-text-factor))}.enhancement-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:right;padding-left:0}.enhancement-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .enhancement-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .3 * var(--ghs-text-factor)) solid var(--ghs-color-gray)}.enhancement-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .plus[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.enhancement-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .minus[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.enhancement-dialog[_ngcontent-%COMP%]   .hints[_ngcontent-%COMP%]{display:flex;flex-direction:column}.enhancement-dialog[_ngcontent-%COMP%]   .hints[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.3em;text-align:center;color:var(--ghs-color-yellow);margin:.2em 0}.enhancement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.enhancement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:2em;padding:.3em}.enhancement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.enhancement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.enhancement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]:hover{opacity:.7}.enhancement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply.disabled[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray)}.enhancement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply.disabled[_ngcontent-%COMP%]:hover{opacity:1}"]})}return i})();const Ms=i=>[i],wy=()=>[],vs=(i,r)=>({active:i,exclusive:r}),Ry=i=>({active:i}),jy=(i,r,e,a)=>({pick:i,"in-deck":r,always:e,disabled:a}),Os=(i,r)=>r.cardId;function Gy(i,r){if(1&i&&t.nrm(0,"p",2),2&i){const e=t.XpG();t.Y8G("ghs-label","character.abilities.pickCard")("ghs-label-args",t.eq3(2,Ms,e.levelToPick))}}function Ty(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",14),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.undoLastCard())})("doubleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.resetDeck())}),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ghs-label","character.abilities.undoLastPick")("ghs-label-args",t.eq3(3,Ms,e.levelToPick?e.levelToPick-1:e.character.level))("ghs-tooltip","character.abilities.undoLastPick.hint")}}function Sy(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",18),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.setLevel(n))})("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.setLevel(n,!0))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ngClass",t.l_i(2,vs,a.level==e,a.exclusiveLevel==e))("ghs-label",e)}}function $y(i,r){1&i&&(t.j41(0,"span",16),t.EFF(1,"|"),t.k0s())}function Dy(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",19),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.setLevel(n+1))})("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.setLevel(n+1,!0))}),t.EFF(1),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ngClass",t.l_i(2,vs,a.level==e+1,a.exclusiveLevel==e+1)),t.R7$(),t.JRh(e+1)}}function Iy(i,r){if(1&i&&(t.j41(0,"div",4),t.Z7z(1,Sy,1,5,"a",15,t.fX1),t.nVh(3,$y,2,0,"span",16),t.Z7z(4,Dy,2,5,"a",17,t.fX1),t.nI1(6,"ghsRange"),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.additionalLevels),t.R7$(2),t.vxM(e.additionalLevels.length?3:-1),t.R7$(),t.Dyx(t.i5U(6,1,t.lJ4(4,wy),e.deck?e.maxLevel:9))}}function Ay(i,r){if(1&i&&t.nrm(0,"option",21),2&i){const e=r.$implicit;t.Y8G("value",e)("ghs-label","character.abilities.sort."+e)}}function Vy(i,r){if(1&i){const e=t.RV6();t.j41(0,"select",20),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.sort,n)||(o.sort=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.update())}),t.Z7z(1,Ay,1,2,"option",21,t.fX1),t.k0s()}if(2&i){const e=t.XpG();t.R50("ngModel",e.sort),t.R7$(),t.Dyx(e.sorts)}}function Fy(i,r){if(1&i){const e=t.RV6();t.j41(0,"img",22),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleEnhanced())})("doubleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openEnhancementDialog())}),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(1,Ry,e.enhanced))}}function Xy(i,r){1&i&&t.nrm(0,"p",8),2&i&&t.Y8G("ghs-label","character.abilities.deckWarning")}function By(i,r){1&i&&t.nrm(0,"p",8),2&i&&t.Y8G("ghs-label","character.abilities.levelWarning")}function Yy(i,r){if(1&i&&(t.j41(0,"div",11),t.nrm(1,"ghs-ability",23),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("character",e.character)}}function Ny(i,r){if(1&i){const e=t.RV6();t.j41(0,"img",26),t.bIt("doubleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.toggleDeck(n,!0))}),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG();t.Y8G("ghs-tooltip",-1!=a.character.progress.deck.indexOf(a.abilities.indexOf(e))?"character.abilities.removeFromDeck":"character.abilities.forceDeck")}}function zy(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",12)(1,"ghs-ability",24),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.clickAbility(n))})("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.openDialog(n))}),t.k0s(),t.nVh(2,Ny,1,1,"img",25),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.ziG(5,jy,a.levelToPick,1==e.level||"X"==e.level||-1!=a.character.progress.deck.indexOf(a.abilities.indexOf(e)),1==e.level||"X"==e.level,-1==a.character.progress.deck.indexOf(a.abilities.indexOf(e))&&(a.levelToPick<+e.level||a.cardsToPick<1))),t.R7$(),t.Y8G("ability",e)("character",a.character)("flipped",!0),t.R7$(),t.vxM(a.deck?-1:2)}}function Ly(i,r){1&i&&t.nrm(0,"p",13),2&i&&t.Y8G("ghs-label","character.abilities.currentDeck")}function Uy(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",28),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.openDialog(n))}),t.nrm(1,"ghs-ability",29),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(),t.Y8G("ability",e)("character",a.character)("flipped",!0)}}function qy(i,r){if(1&i&&(t.j41(0,"div",10),t.Z7z(1,Uy,2,3,"div",27,Os),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.smallAbilities)}}let Ps=(()=>{class i{data;dialogRef;dialog;character;level;exclusiveLevel;additionalLevels=[];abilities=[];visibleAbilities=[];smallAbilities=[];cardsToPick=1;levelToPick=1;sort="level-deck";sorts=["level-deck","cardId","level-name","name"];deck=!0;maxLevel=1;enhanced=!1;constructor(e,a,n){this.data=e,this.dialogRef=a,this.dialog=n,this.character=e.character,this.level=this.character.level,this.abilities=s.E.deckData(this.character).abilities,this.abilities.filter(o=>"string"==typeof o.level&&"X"!=o.level||"number"==typeof o.level&&o.level>9).forEach(o=>{-1==this.additionalLevels.indexOf(o.level)&&this.additionalLevels.push(o.level)}),this.dialogRef.closed.subscribe({next:()=>{this.character.tags=this.character.tags.filter(o=>"edit-abilities"!=o)}})}ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.cardsToPick=this.character.level-this.character.progress.deck.length-1,this.character.tags=this.character.tags.filter(e=>"edit-abilities"!=e),this.cardsToPick<0&&(this.cardsToPick=0),this.character.progress.deck=this.character.progress.deck||[],this.levelToPick=this.deck&&this.cardsToPick?this.character.level-this.cardsToPick+1:0,this.maxLevel=Math.max(...this.abilities.filter((e,a)=>"number"==typeof e.level&&-1!=this.character.progress.deck.indexOf(a)).map(e=>+e.level),this.character.level),this.levelToPick?(this.visibleAbilities=this.abilities.filter((e,a)=>"number"==typeof e.level&&e.level>1&&e.level<=this.levelToPick&&-1==this.character.progress.deck.indexOf(a)).sort((e,a)=>"number"==typeof e.level&&"number"==typeof a.level&&e.level!=a.level?a.level-e.level:e.cardId&&a.cardId?e.cardId-a.cardId:0),this.smallAbilities=this.abilities.filter((e,a)=>"X"==e.level||1==e.level||-1!=this.character.progress.deck.indexOf(a))):(this.visibleAbilities=this.abilities.filter(e=>!this.exclusiveLevel&&"number"==typeof this.level&&("string"==typeof e.level||+e.level<=this.level)&&-1==this.additionalLevels.indexOf(e.level)||this.exclusiveLevel&&e.level==this.exclusiveLevel||1==this.exclusiveLevel&&"X"==e.level),this.smallAbilities=[],this.deck&&(this.visibleAbilities=this.visibleAbilities.filter(e=>"X"==e.level||1==e.level||"string"==typeof e.level&&e.level==this.level||-1!=this.character.progress.deck.indexOf(this.abilities.indexOf(e))),this.character.tags.push("edit-abilities")),"cardId"==this.sort?this.visibleAbilities.sort((e,a)=>e.cardId&&a.cardId?e.cardId-a.cardId:0):"level-name"==this.sort?this.visibleAbilities.sort((e,a)=>e.level==a.level?e.name&&a.name?e.name<a.name?-1:1:e.cardId&&a.cardId?e.cardId-a.cardId:0:1==e.level&&"X"==a.level?-1:"X"==e.level&&1==a.level?1:"X"==e.level?-1:"X"==a.level?1:"number"==typeof e.level&&"number"==typeof a.level?e.level-a.level:0):"level-deck"==this.sort?this.visibleAbilities.sort((e,a)=>1!=e.level&&"X"!=e.level||1!=a.level&&"X"!=a.level?1==e.level||"X"==e.level?-1:1==a.level||"X"==a.level?1:-1!=this.character.progress.deck.indexOf(this.abilities.indexOf(e))&&-1==this.character.progress.deck.indexOf(this.abilities.indexOf(a))?-1:-1==this.character.progress.deck.indexOf(this.abilities.indexOf(e))&&-1!=this.character.progress.deck.indexOf(this.abilities.indexOf(a))?1:0:0):"name"==this.sort&&this.visibleAbilities.sort((e,a)=>e.name&&a.name?e.name<a.name?-1:1:e.cardId&&a.cardId?e.cardId-a.cardId:0)),!this.levelToPick&&this.enhanced&&this.character.progress.enhancements&&this.character.progress.enhancements.length&&(this.visibleAbilities=this.visibleAbilities.filter(e=>this.character.progress.enhancements&&this.character.progress.enhancements.find(a=>a.cardId==e.cardId)))}togglePick(){this.deck=!this.deck,s.E.uiChange.emit()}setLevel(e,a=!1){this.level=e,this.exclusiveLevel=a?e:void 0,-1!=this.additionalLevels.indexOf(e)&&(this.exclusiveLevel=e),this.update()}undoLastCard(){s.E.stateManager.before("character.undoLastCard",s.E.characterManager.characterName(this.character)),this.character.progress.deck.splice(-1,1),s.E.stateManager.after(),this.update()}resetDeck(){s.E.stateManager.before("character.resetDeck",s.E.characterManager.characterName(this.character)),this.character.progress.deck=[],s.E.stateManager.after(),this.update()}clickAbility(e){"string"!=typeof e.level&&1!=e.level&&this.levelToPick&&this.deck?this.toggleDeck(e):this.openDialog(e)}toggleDeck(e,a=!1){const n=-1!=this.character.progress.deck.indexOf(this.abilities.indexOf(e));(n||a||this.levelToPick>=+e.level&&this.cardsToPick>0)&&(n?(s.E.stateManager.before("character.cardFromDeck",s.E.characterManager.characterName(this.character),e.name||e.cardId||""),this.character.progress.deck=this.character.progress.deck.filter(o=>o!=this.abilities.indexOf(e))):(s.E.stateManager.before("character.cardToDeck",s.E.characterManager.characterName(this.character),e.name||e.cardId||""),this.character.progress.deck.push(this.abilities.indexOf(e))),s.E.stateManager.after(),this.update())}openDialog(e){this.dialog.open(Ca,{panelClass:["fullscreen-panel"],disableClose:!0,data:{ability:e,character:this.character}})}toggleEnhanced(){this.character.progress.enhancements&&this.character.progress.enhancements.length?(this.enhanced=!this.enhanced,s.E.uiChange.emit()):(this.enhanced=!1,this.openEnhancementDialog())}openEnhancementDialog(){this.dialog.open(Pa,{panelClass:["dialog"]})}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-ability-cards-dialog"]],standalone:!1,decls:17,vars:11,consts:[[1,"ability-cards-dialog"],[1,"menu"],[1,"title",3,"ghs-label","ghs-label-args"],["ghs-pointer-input","",3,"ghs-label","ghs-label-args","ghs-tooltip"],[1,"levels"],[3,"ngModel"],[3,"click","ghs-label"],["src","./assets/images/character/enhancements.svg","ghs-pointer-input","",1,"enhancement",3,"ngClass"],[1,"warning",3,"ghs-label"],[1,"scroll-container"],[1,"abilities"],[1,"container"],[1,"container","ability",3,"ngClass"],[1,"title",3,"ghs-label"],["ghs-pointer-input","",3,"singleClick","doubleClick","ghs-label","ghs-label-args","ghs-tooltip"],["ghs-pointer-input","",1,"level",3,"ngClass","ghs-label"],[1,"separator"],["ghs-pointer-input","",1,"level",3,"ngClass"],["ghs-pointer-input","",1,"level",3,"singleClick","doubleClick","ngClass","ghs-label"],["ghs-pointer-input","",1,"level",3,"singleClick","doubleClick","ngClass"],[3,"ngModelChange","change","ngModel"],[3,"value","ghs-label"],["src","./assets/images/character/enhancements.svg","ghs-pointer-input","",1,"enhancement",3,"singleClick","doubleClick","ngClass"],[3,"character"],["ghs-pointer-input","",3,"singleClick","doubleClick","ability","character","flipped"],["src","./assets/images/character/deck.svg","ghs-pointer-input","",1,"deck",3,"ghs-tooltip"],["src","./assets/images/character/deck.svg","ghs-pointer-input","",1,"deck",3,"doubleClick","ghs-tooltip"],[1,"container","small","ability"],[1,"container","small","ability",3,"click"],[3,"ability","character","flipped"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.nVh(2,Gy,1,4,"p",2),t.nVh(3,Ty,1,5,"a",3),t.nVh(4,Iy,7,5,"div",4),t.nVh(5,Vy,3,1,"select",5),t.j41(6,"a",6),t.bIt("click",function(){return n.togglePick()}),t.k0s(),t.nVh(7,Fy,1,3,"img",7),t.nVh(8,Xy,1,1,"p",8),t.nVh(9,By,1,1,"p",8),t.k0s(),t.j41(10,"div",9)(11,"div",10),t.nVh(12,Yy,2,1,"div",11),t.Z7z(13,zy,3,10,"div",12,Os),t.k0s(),t.nVh(15,Ly,1,1,"p",13),t.nVh(16,qy,3,0,"div",10),t.k0s()()),2&a&&(t.R7$(2),t.vxM(n.levelToPick?2:-1),t.R7$(),t.vxM(n.character.progress.deck.length&&n.deck?3:-1),t.R7$(),t.vxM(n.levelToPick?-1:4),t.R7$(),t.vxM(n.levelToPick?-1:5),t.R7$(),t.Y8G("ghs-label",n.deck?"character.abilities.show":"character.abilities.showDeck"),t.R7$(),t.vxM(n.levelToPick?-1:7),t.R7$(),t.vxM(n.character.progress.deck.length>n.character.level-1?8:-1),t.R7$(),t.vxM(n.maxLevel>n.character.level?9:-1),t.R7$(3),t.vxM(n.exclusiveLevel||n.levelToPick||n.enhanced?-1:12),t.R7$(),t.Dyx(n.visibleAbilities),t.R7$(2),t.vxM(n.smallAbilities.length?15:-1),t.R7$(),t.vxM(n.smallAbilities.length?16:-1))},dependencies:[N.YU,O.xH,O.y7,O.wz,O.BC,O.vS,en,tt,ft,rt,Tt],styles:[".title[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);display:flex;justify-content:center;align-items:center;width:100%;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));color:var(--ghs-color-gray)}.warning[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);display:flex;justify-content:center;align-items:center;width:100%;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));color:var(--ghs-color-yellow)}.menu[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));color:var(--ghs-color-gray)}.menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.menu[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));height:auto;filter:var(--ghs-filter-gray);opacity:1;z-index:2;cursor:pointer}.menu[_ngcontent-%COMP%]   .enhancement.active[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.menu[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]:hover{filter:var(--ghs-filter-white)}.menu[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap}.menu[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));color:var(--ghs-color-darkgray);text-shadow:var(--ghs-outline);height:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor))}.menu[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level.placeholder[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)}.menu[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level.active[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.menu[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level.active.placeholder[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.menu[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level.exclusive[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) / 4) var(--ghs-color-white) solid;border-radius:100%}.menu[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover{color:var(--ghs-color-gray)}.menu[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover.placeholder{filter:var(--ghs-filter-gray)}.menu[_ngcontent-%COMP%]   .levels[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray);font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.scroll-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;max-height:calc(var(--ghs-unit) * 78 * var(--ghs-text-factor))}.scroll-container[_ngcontent-%COMP%]   .abilities[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap}.scroll-container[_ngcontent-%COMP%]   .abilities[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 32 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 43.2 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));flex-shrink:0;flex-grow:0}.scroll-container[_ngcontent-%COMP%]   .abilities[_ngcontent-%COMP%]   .container.small[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 20 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 27 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.scroll-container[_ngcontent-%COMP%]   .abilities[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{display:block;position:relative;width:100%;height:100%;z-index:1;cursor:zoom-in}.scroll-container[_ngcontent-%COMP%]   .abilities[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]{position:absolute;top:5%;right:5%;width:9%;height:auto;filter:var(--ghs-filter-white);opacity:1;z-index:2;cursor:pointer}.scroll-container[_ngcontent-%COMP%]   .abilities[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]:hover{opacity:.7}.scroll-container[_ngcontent-%COMP%]   .abilities[_ngcontent-%COMP%]   .ability.pick[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{cursor:pointer}.scroll-container[_ngcontent-%COMP%]   .abilities[_ngcontent-%COMP%]   .ability.in-deck[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]{filter:var(--ghs-filter-green);opacity:1}.scroll-container[_ngcontent-%COMP%]   .abilities[_ngcontent-%COMP%]   .ability.disabled[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkred);cursor:initial}.scroll-container[_ngcontent-%COMP%]   .abilities[_ngcontent-%COMP%]   .ability.disabled[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]:hover{opacity:1}.scroll-container[_ngcontent-%COMP%]   .abilities[_ngcontent-%COMP%]   .ability.always[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]{filter:var(--ghs-filter-white);cursor:initial;pointer-events:none}"]})}return i})();const Hy=(i,r,e)=>({fh:i,"new-style":r,"town-guard":e}),ba=i=>({target:i}),Ky=i=>({"sub-effects":i}),Wy=(i,r)=>({target:i,"sub-effects":r}),ki=i=>({"ghs-svg":i}),Jy=i=>({"text-white":i}),Zy=i=>({"new-style":i}),Zt=(i,r)=>r.type+i;function Qy(i,r){if(1&i&&(t.j41(0,"span",10),t.EFF(1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.JRh(e.effect.value.split(":")[1])}}function t2(i,r){if(1&i&&(t.j41(0,"span"),t.nrm(1,"span",13),t.k0s()),2&i){const e=t.XpG(3);t.HbH(t.VkB("target-value-container ","target-"+e.getTarget().replace("game.specialTarget.",""))),t.R7$(),t.Aen(!!e.newStyle&&"fh"),t.Y8G("ghs-label",e.getTarget().split(":")[0])("ghs-label-args",e.getTarget().split(":").slice(1))}}function e2(i,r){if(1&i&&(t.j41(0,"span",12),t.nrm(1,"span",14),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Aen(!!e.newStyle&&"fh"),t.Y8G("ghs-label",e.getRange())}}function n2(i,r){if(1&i&&(t.nrm(0,"img",9),t.nVh(1,Qy,2,1,"span",10),t.nVh(2,t2,2,7,"span",11),t.nVh(3,e2,2,3,"span",12)),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(5,ba,e.getTarget()||e.getRange()))("src","./assets/images/"+(e.settingsManager.settings.fhStyle?"fh/":"")+"condition/"+e.effect.value.split(":")[0]+".svg",t.B4B),t.R7$(),t.vxM(e.effect.value.split(":").length>1?1:-1),t.R7$(),t.vxM(e.getTarget()?2:-1),t.R7$(),t.vxM(e.getRange()?3:-1)}}function i2(i,r){if(1&i&&(t.j41(0,"div",15),t.nrm(1,"ghs-attackmodifier-effect",16),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(3);t.R7$(),t.Y8G("attackModifier",a.attackModifier)("effect",e)("offsetWidth",a.offsetWidth)("newStyle",a.newStyle)}}function a2(i,r){if(1&i&&(t.nrm(0,"img",9),t.Z7z(1,i2,2,4,"div",15,Zt)),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Ky,e.effect.effects&&e.effect.effects.length))("src","./assets/images/"+(e.settingsManager.settings.fhStyle?"fh/":"")+"element/"+e.effect.value+".svg",t.B4B),t.R7$(),t.Dyx(e.effect.effects)}}function o2(i,r){if(1&i&&(t.j41(0,"span",3)(1,"span",17),t.nrm(2,"img",18),t.k0s(),t.j41(3,"span",17),t.nrm(4,"img",18),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("src","./assets/images/"+(e.settingsManager.settings.fhStyle?"fh/":"")+"element/"+e.effect.value.split("|")[0]+".svg",t.B4B),t.R7$(2),t.Y8G("src","./assets/images/"+(e.settingsManager.settings.fhStyle?"fh/":"")+"element/"+e.effect.value.split("|")[1]+".svg",t.B4B)}}function s2(i,r){if(1&i&&(t.j41(0,"div",15),t.nrm(1,"ghs-attackmodifier-effect",16),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(3);t.R7$(),t.Y8G("attackModifier",a.attackModifier)("effect",e)("offsetWidth",a.offsetWidth)("newStyle",a.newStyle)}}function r2(i,r){if(1&i&&(t.j41(0,"span",19),t.nrm(1,"img",18),t.k0s(),t.j41(2,"span",20),t.EFF(3,":"),t.k0s(),t.Z7z(4,s2,2,4,"div",15,Zt)),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("src","./assets/images/"+(e.settingsManager.settings.fhStyle?"fh/":"")+"element/"+e.effect.value+".svg",t.B4B),t.R7$(3),t.Dyx(e.effect.effects)}}function c2(i,r){if(1&i&&(t.j41(0,"span",10),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.JRh(t.bMT(2,1,+e.effect.value))}}function l2(i,r){if(1&i&&(t.j41(0,"span"),t.nrm(1,"span",13),t.k0s()),2&i){const e=t.XpG(3);t.HbH(t.VkB("target-value-container ","target-"+e.getTarget().replace("game.specialTarget.",""))),t.R7$(),t.Aen(!!e.newStyle&&"fh"),t.Y8G("ghs-label",e.getTarget().split(":")[0])("ghs-label-args",e.getTarget().split(":").slice(1))}}function g2(i,r){if(1&i&&(t.j41(0,"span",12),t.nrm(1,"span",14),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Aen(!!e.newStyle&&"fh"),t.Y8G("ghs-label",e.getRange())}}function d2(i,r){if(1&i&&t.nrm(0,"ghs-attackmodifier-effect",16),2&i){const e=r.$implicit,a=t.XpG(3);t.Y8G("attackModifier",a.attackModifier)("effect",e)("offsetWidth",a.offsetWidth)("newStyle",a.newStyle)}}function h2(i,r){if(1&i&&(t.j41(0,"div",21),t.nrm(1,"img",22),t.nVh(2,c2,3,3,"span",10),t.nVh(3,l2,2,7,"span",11),t.nVh(4,g2,2,3,"span",12),t.j41(5,"div",15)(6,"span",20),t.EFF(7,","),t.k0s(),t.Z7z(8,d2,1,4,"ghs-attackmodifier-effect",16,Zt),t.k0s()()),2&i){const e=t.XpG(2);t.xc7("border-width",.02*e.offsetWidth+"px"),t.Y8G("ngClass",t.l_i(8,Wy,e.getTarget()||e.getRange(),e.subEffects().length>0)),t.R7$(),t.Y8G("ngClass",t.eq3(11,ki,e.isGhsSvg(e.effect.type)))("src","./assets/images/action/"+e.effect.type+".svg",t.B4B),t.R7$(),t.vxM(e.effect.value?2:-1),t.R7$(),t.vxM(e.getTarget()?3:-1),t.R7$(),t.vxM(e.getRange()?4:-1),t.R7$(4),t.Dyx(e.subEffects())}}function _2(i,r){if(1&i&&(t.j41(0,"span",10),t.EFF(1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.JRh(+e.effect.value)}}function m2(i,r){if(1&i&&(t.j41(0,"span"),t.nrm(1,"span",13),t.k0s()),2&i){const e=t.XpG(3);t.HbH(t.VkB("target-value-container ","target-"+e.getTarget().replace("game.specialTarget.",""))),t.R7$(),t.Aen(!!e.newStyle&&"fh"),t.Y8G("ghs-label",e.getTarget().split(":")[0])("ghs-label-args",e.getTarget().split(":").slice(1))}}function p2(i,r){if(1&i&&(t.j41(0,"span",12),t.nrm(1,"span",14),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Aen(!!e.newStyle&&"fh"),t.Y8G("ghs-label",e.getRange())}}function u2(i,r){if(1&i&&t.nrm(0,"ghs-attackmodifier-effect",16),2&i){const e=r.$implicit,a=t.XpG(3);t.Y8G("attackModifier",a.attackModifier)("effect",e)("offsetWidth",a.offsetWidth)("newStyle",a.newStyle)}}function f2(i,r){if(1&i&&(t.j41(0,"div",23),t.nrm(1,"img",22),t.nVh(2,_2,2,1,"span",10),t.nVh(3,m2,2,7,"span",11),t.nVh(4,p2,2,3,"span",12),t.j41(5,"div",15),t.Z7z(6,u2,1,4,"ghs-attackmodifier-effect",16,Zt),t.k0s()()),2&i){const e=t.XpG(2);t.xc7("border-width",.02*e.offsetWidth+"px"),t.Y8G("ngClass",t.eq3(8,ba,e.getTarget()||e.getRange())),t.R7$(),t.Y8G("ngClass",t.eq3(10,ki,e.isGhsSvg(e.effect.type)))("src","./assets/images/"+(e.settingsManager.settings.fhStyle?"fh/":"")+"action/"+e.effect.type+".svg",t.B4B),t.R7$(),t.vxM(e.effect.value?2:-1),t.R7$(),t.vxM(e.getTarget()?3:-1),t.R7$(),t.vxM(e.getRange()?4:-1),t.R7$(2),t.Dyx(e.subEffects())}}function C2(i,r){if(1&i&&(t.j41(0,"span",10),t.EFF(1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.JRh(+e.effect.value)}}function M2(i,r){if(1&i&&(t.j41(0,"span"),t.nrm(1,"span",13),t.k0s()),2&i){const e=t.XpG(3);t.HbH(t.VkB("target-value-container ","target-"+e.getTarget().replace("game.specialTarget.",""))),t.R7$(),t.Aen(!!e.newStyle&&"fh"),t.Y8G("ghs-label",e.getTarget().split(":")[0])("ghs-label-args",e.getTarget().split(":").slice(1))}}function v2(i,r){if(1&i&&(t.j41(0,"span",12),t.nrm(1,"span",14),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Aen(!!e.newStyle&&"fh"),t.Y8G("ghs-label",e.getRange())}}function O2(i,r){if(1&i&&t.nrm(0,"ghs-attackmodifier-effect",16),2&i){const e=r.$implicit,a=t.XpG(3);t.Y8G("attackModifier",a.attackModifier)("effect",e)("offsetWidth",a.offsetWidth)("newStyle",a.newStyle)}}function P2(i,r){if(1&i&&(t.j41(0,"div",24),t.nrm(1,"img",22),t.nVh(2,C2,2,1,"span",10),t.nVh(3,M2,2,7,"span",11),t.nVh(4,v2,2,3,"span",12),t.j41(5,"div",15),t.Z7z(6,O2,1,4,"ghs-attackmodifier-effect",16,Zt),t.k0s()()),2&i){const e=t.XpG(2);t.xc7("border-width",.02*e.offsetWidth+"px"),t.Y8G("ngClass",t.eq3(8,ba,e.getTarget()||e.getRange())),t.R7$(),t.Y8G("ngClass",t.eq3(10,ki,e.isGhsSvg(e.effect.type)))("src","./assets/images/"+(e.settingsManager.settings.fhStyle?"fh/":"")+"action/"+e.effect.type+".svg",t.B4B),t.R7$(),t.vxM(e.effect.value?2:-1),t.R7$(),t.vxM(e.getTarget()?3:-1),t.R7$(),t.vxM(e.getRange()?4:-1),t.R7$(2),t.Dyx(e.subEffects())}}function b2(i,r){if(1&i&&t.nrm(0,"ghs-attackmodifier-effect",16),2&i){const e=r.$implicit,a=t.XpG(4);t.Y8G("attackModifier",a.attackModifier)("effect",e)("offsetWidth",a.offsetWidth)("newStyle",a.newStyle)}}function k2(i,r){if(1&i&&(t.j41(0,"div",15),t.Z7z(1,b2,1,4,"ghs-attackmodifier-effect",16,Zt),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.effect.effects)}}function y2(i,r){if(1&i&&(t.nrm(0,"img",25),t.nVh(1,k2,3,0,"div",15)),2&i){const e=t.XpG(2);t.Y8G("src","./assets/images/attackmodifier/target.svg",t.B4B),t.R7$(),t.vxM(e.effect.effects?1:-1)}}function x2(i,r){if(1&i&&t.nrm(0,"ghs-attackmodifier-effect",16),2&i){const e=r.$implicit,a=t.XpG(4);t.Y8G("attackModifier",a.attackModifier)("effect",e)("offsetWidth",a.offsetWidth)("newStyle",a.newStyle)}}function E2(i,r){if(1&i&&(t.j41(0,"div",15),t.Z7z(1,x2,1,4,"ghs-attackmodifier-effect",16,Zt),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.effect.effects)}}function w2(i,r){if(1&i&&(t.nrm(0,"ghs-action-hex",26),t.nVh(1,E2,3,0,"div",15)),2&i){const e=t.XpG(2);t.Y8G("value",e.effect.value),t.R7$(),t.vxM(e.effect.effects?1:-1)}}function R2(i,r){if(1&i&&t.nrm(0,"ghs-attackmodifier-effect",16),2&i){const e=r.$implicit,a=t.XpG(4);t.Y8G("attackModifier",a.attackModifier)("effect",e)("offsetWidth",a.offsetWidth)("newStyle",a.newStyle)}}function j2(i,r){if(1&i&&(t.j41(0,"div",15),t.Z7z(1,R2,1,4,"ghs-attackmodifier-effect",16,Zt),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.effect.effects)}}function G2(i,r){if(1&i&&(t.j41(0,"span",27),t.nrm(1,"img",28)(2,"img",29),t.k0s(),t.nVh(3,j2,3,0,"div",15)),2&i){const e=t.XpG(2);t.R7$(3),t.vxM(e.effect.effects?3:-1)}}function T2(i,r){if(1&i&&t.nrm(0,"ghs-attackmodifier-effect",16),2&i){const e=r.$implicit,a=t.XpG(4);t.Y8G("attackModifier",a.attackModifier)("effect",e)("offsetWidth",a.offsetWidth)("newStyle",a.newStyle)}}function S2(i,r){if(1&i&&(t.j41(0,"div",15),t.Z7z(1,T2,1,4,"ghs-attackmodifier-effect",16,Zt),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.effect.effects)}}function $2(i,r){if(1&i&&(t.j41(0,"div",7)(1,"span",27),t.nrm(2,"img",28)(3,"img",29),t.k0s(),t.j41(4,"span",30),t.nrm(5,"span",31),t.k0s(),t.nVh(6,S2,3,0,"div",15),t.k0s()),2&i){const e=t.XpG(2);t.R7$(5),t.Y8G("ghs-label","game.attackModifiers.effects.refreshSpentItem"),t.R7$(),t.vxM(e.effect.effects?6:-1)}}function D2(i,r){if(1&i&&t.nrm(0,"ghs-attackmodifier-effect",16),2&i){const e=r.$implicit,a=t.XpG(4);t.Y8G("attackModifier",a.attackModifier)("effect",e)("offsetWidth",a.offsetWidth)("newStyle",a.newStyle)}}function I2(i,r){if(1&i&&(t.j41(0,"div",15),t.Z7z(1,D2,1,4,"ghs-attackmodifier-effect",16,Zt),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.effect.effects)}}function A2(i,r){if(1&i&&(t.j41(0,"span",27),t.nrm(1,"img",32)(2,"img",33),t.k0s(),t.nVh(3,I2,3,0,"div",15)),2&i){const e=t.XpG(2);t.R7$(3),t.vxM(e.effect.effects?3:-1)}}function V2(i,r){if(1&i&&(t.j41(0,"span",34),t.nrm(1,"span",36),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(2,Jy,!e.settingsManager.settings.fhStyle||e.townGuard))("ghs-label",e.effect.value+"")}}function F2(i,r){if(1&i&&(t.j41(0,"span",35),t.nrm(1,"img",18),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("src","./assets/images/action/custom/"+e.effect.value+".svg",t.B4B)}}function X2(i,r){if(1&i&&t.nrm(0,"ghs-attackmodifier-effect",16),2&i){const e=r.$implicit,a=t.XpG(4);t.Y8G("attackModifier",a.attackModifier)("effect",e)("offsetWidth",a.offsetWidth)("newStyle",a.newStyle)}}function B2(i,r){if(1&i&&(t.j41(0,"div",15),t.Z7z(1,X2,1,4,"ghs-attackmodifier-effect",16,Zt),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.effect.effects)}}function Y2(i,r){if(1&i&&(t.nVh(0,V2,2,4,"span",34),t.nVh(1,F2,2,1,"span",35),t.nVh(2,B2,3,0,"div",15)),2&i){const e=t.XpG(2);t.vxM(e.effect.icon?-1:0),t.R7$(),t.vxM(e.effect.icon?1:-1),t.R7$(),t.vxM(e.effect.effects?2:-1)}}function N2(i,r){if(1&i&&t.nrm(0,"ghs-attackmodifier-effect",16),2&i){const e=r.$implicit,a=t.XpG(3);t.Y8G("attackModifier",a.attackModifier)("effect",e)("offsetWidth",a.offsetWidth)("newStyle",a.newStyle)}}function z2(i,r){if(1&i&&(t.j41(0,"span",37),t.nrm(1,"span",31),t.k0s(),t.Z7z(2,N2,1,4,"ghs-attackmodifier-effect",16,Zt)),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Zy,e.newStyle)),t.R7$(),t.Y8G("ghs-label","or"),t.R7$(),t.Dyx(e.effect.effects)}}function L2(i,r){if(1&i&&t.nrm(0,"ghs-attackmodifier-effect",16),2&i){const e=r.$implicit,a=t.XpG(4);t.Y8G("attackModifier",a.attackModifier)("effect",e)("offsetWidth",a.offsetWidth)("newStyle",a.newStyle)}}function U2(i,r){if(1&i&&(t.j41(0,"div",15),t.Z7z(1,L2,1,4,"ghs-attackmodifier-effect",16,Zt),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.effect.effects)}}function q2(i,r){if(1&i&&(t.nrm(0,"img",38),t.nVh(1,U2,3,0,"div",15)),2&i){const e=t.XpG(2);t.Y8G("src","./assets/images/attackmodifier/overlays/replace/"+e.effect.value+".png",t.B4B),t.R7$(),t.vxM(e.effect.effects?1:-1)}}function H2(i,r){if(1&i&&t.nrm(0,"span",39),2&i){const e=t.XpG(3);t.Y8G("ghs-label",""+e.effect.value)}}function K2(i,r){1&i&&(t.j41(0,"span",30),t.EFF(1,"!"),t.k0s())}function W2(i,r){if(1&i&&t.nrm(0,"ghs-attackmodifier-effect",16),2&i){const e=r.$implicit,a=t.XpG(3);t.Y8G("attackModifier",a.attackModifier)("effect",e)("offsetWidth",a.offsetWidth)("newStyle",a.newStyle)}}function J2(i,r){if(1&i&&(t.j41(0,"span",8),t.nVh(1,H2,1,1,"span",39),t.nVh(2,K2,2,0,"span",30),t.j41(3,"div",15),t.Z7z(4,W2,1,4,"ghs-attackmodifier-effect",16,Zt),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(),t.vxM(e.effect.value?1:-1),t.R7$(),t.vxM(e.effect.value?-1:2),t.R7$(2),t.Dyx(e.effect.effects)}}function Z2(i,r){if(1&i&&(t.j41(0,"span",10),t.EFF(1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.JRh(+e.effect.value)}}function Q2(i,r){if(1&i&&(t.nrm(0,"img",9),t.nVh(1,Z2,2,1,"span",10)),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(3,ki,e.isGhsSvg(e.effect.type)))("src","./assets/images/"+(e.settingsManager.settings.fhStyle?"fh/":"")+"action/"+e.effect.type+".svg",t.B4B),t.R7$(),t.vxM(e.effect.value?1:-1)}}function tx(i,r){if(1&i&&(t.j41(0,"span",1)(1,"span",2),t.nVh(2,n2,4,7)(3,a2,3,4)(4,o2,5,2,"span",3)(5,r2,6,1)(6,h2,10,13,"div",4)(7,f2,8,12,"div",5)(8,P2,8,12,"div",6)(9,y2,2,2)(10,w2,2,2)(11,G2,4,1)(12,$2,7,2,"div",7)(13,A2,4,1)(14,Y2,3,3)(15,z2,4,4)(16,q2,2,2)(17,J2,6,2,"span",8)(18,Q2,2,5),t.k0s()()),2&i){let e;const a=t.XpG();t.HbH(t.VkB("effect-wrapper ",a.effect.type)),t.Y8G("ngClass",t.sMw(5,Hy,a.settingsManager.settings.fhStyle,a.newStyle,a.townGuard)),t.R7$(2),t.vxM((e=a.effect.type)===a.AttackModifierEffectType.condition?2:e===a.AttackModifierEffectType.element?3:e===a.AttackModifierEffectType.elementHalf?4:e===a.AttackModifierEffectType.elementConsume?5:e===a.AttackModifierEffectType.heal?6:e===a.AttackModifierEffectType.shield?7:e===a.AttackModifierEffectType.retaliate?8:e===a.AttackModifierEffectType.target?9:e===a.AttackModifierEffectType.area?10:e===a.AttackModifierEffectType.refreshItem?11:e===a.AttackModifierEffectType.refreshSpentItem?12:e===a.AttackModifierEffectType.recoverRandomDiscard?13:e===a.AttackModifierEffectType.custom?14:e===a.AttackModifierEffectType.or?15:e===a.AttackModifierEffectType.changeType?16:e===a.AttackModifierEffectType.required?17:18)}}let ex=(()=>{class i{elementRef;offsetWidth;attackModifier;effect;newStyle=!1;townGuard=!1;length=1;settingsManager=m.f;AttackModifierType=Y.Yn;AttackModifierEffectType=Y.hY;invertIcons=[Y.hY.attack,Y.hY.heal,Y.hY.range,Y.hY.retaliate,Y.hY.shield,Y.hY.target];constructor(e){this.elementRef=e}ngAfterViewInit(){this.adjustFontSize(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.adjustFontSize()})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}adjustFontSize(){this.elementRef.nativeElement.style.fontSize=.2*this.elementRef.nativeElement.offsetWidth+"px"}getTarget(){if(this.effect.effects){const e=this.effect.effects.find(n=>n.type==Y.hY.specialTarget);if(e)return"game.specialTarget."+e.value;const a=this.effect.effects.find(n=>n.type==Y.hY.custom);if(a)return a.value}return""}getRange(){if(this.effect.effects){const e=this.effect.effects.find(a=>a.type==Y.hY.range);if(e)return"%game.action.range:"+e.value+"%"}return""}subEffects(){return this.effect.effects&&this.effect.effects.filter(e=>e.type!=Y.hY.specialTarget&&e.type!=Y.hY.target&&e.type!=Y.hY.range&&e.type!=Y.hY.custom)||[]}isGhsSvg(e){return-1!=this.invertIcons.indexOf(e)}static \u0275fac=function(a){return new(a||i)(t.rXU(t.aKT))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-attackmodifier-effect"]],inputs:{offsetWidth:"offsetWidth",attackModifier:"attackModifier",effect:"effect",newStyle:"newStyle",townGuard:"townGuard",length:"length"},standalone:!1,decls:1,vars:1,consts:[[3,"class","ngClass"],[3,"ngClass"],[1,"effect"],[1,"element-half-container"],[1,"effect-container","heal-container",3,"border-width","ngClass"],[1,"effect-container","shield-container",3,"border-width","ngClass"],[1,"effect-container","retaliate-container",3,"border-width","ngClass"],[1,"card-action-container"],[1,"required-container"],[1,"full",3,"ngClass","src"],[1,"value"],[3,"class"],[1,"target-value-container","range"],[1,"target-value","text-white",3,"ghs-label","ghs-label-args"],[1,"target-value","text-white",3,"ghs-label"],[1,"sub-effects"],[3,"attackModifier","effect","offsetWidth","newStyle"],[1,"element-half"],[3,"src"],[1,"element","consume"],[1,"divider"],[1,"effect-container","heal-container",3,"ngClass"],[3,"ngClass","src"],[1,"effect-container","shield-container",3,"ngClass"],[1,"effect-container","retaliate-container",3,"ngClass"],[1,"full",3,"src"],[3,"value"],[1,"card-action"],["src","./assets/images/action/card/refresh.svg",1,"ghs-svg"],["src","./assets/images/action/card/overlay/refresh.svg",1,"overlay"],[1,"label"],[3,"ghs-label"],["src","./assets/images/action/card/recover.svg",1,"ghs-svg"],["src","./assets/images/action/card/overlay/recover.svg",1,"overlay"],[1,"custom-value-container"],[1,"effect-icon"],[1,"custom-value",3,"ngClass","ghs-label"],[1,"or-label",3,"ngClass"],[1,"overlay",3,"src"],[1,"label",3,"ghs-label"]],template:function(a,n){1&a&&t.nVh(0,tx,19,9,"span",0),2&a&&t.vxM(n.effect?0:-1)},dependencies:[N.YU,Oi,i,tt,Cn],styles:['.effect-wrapper[_ngcontent-%COMP%]{position:relative;display:block;width:100%;padding-bottom:100%}.effect-wrapper[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center}.effect-wrapper[_ngcontent-%COMP%]:nth-child(2){top:5%}.effect-wrapper[_ngcontent-%COMP%]   img.full[_ngcontent-%COMP%]{position:relative;width:100%;height:auto}.effect-wrapper[_ngcontent-%COMP%]   img.full.target[_ngcontent-%COMP%]{top:-20%;width:65%}.effect-wrapper[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.effect-wrapper[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{position:absolute;top:35%;left:50%;transform:translate(-50%);font-family:var(--ghs-font-title);font-size:1em;color:var(--ghs-color-white)}.effect-wrapper.condition[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%], .effect-wrapper.pierce[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%], .effect-wrapper.push[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%], .effect-wrapper.pull[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]{top:4%;left:4%;width:92%;height:92%}.effect-wrapper.condition[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{top:55%}.effect-wrapper[_ngcontent-%COMP%]   .target-value-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;position:absolute;width:100%;height:40%;bottom:0;font-family:var(--ghs-font-title);font-size:.6em;line-height:.8em;color:var(--ghs-color-white);left:50%;transform:translate(-50%)}.effect-wrapper[_ngcontent-%COMP%]   .target-value-container[_ngcontent-%COMP%]   .target-value[_ngcontent-%COMP%]{display:inline;text-align:center}.effect-wrapper.fh[_ngcontent-%COMP%]   .target-value-container[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:.7em}.effect-wrapper.fh[_ngcontent-%COMP%]   .target-value-container.target-self[_ngcontent-%COMP%], .effect-wrapper.fh[_ngcontent-%COMP%]   .target-value-container.target-allyShort[_ngcontent-%COMP%]{font-size:1.3em}.effect-wrapper[_ngcontent-%COMP%]   .effect-container[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;border:1px solid var(--ghs-color-white);border-radius:100%}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.target[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{top:8%;width:40%}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.target[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{top:22%;font-size:1.4em}.effect-wrapper[_ngcontent-%COMP%]   .effect-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:10%;left:50%;transform:translate(-50%);width:50%;height:auto}.effect-wrapper[_ngcontent-%COMP%]   .effect-container[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{position:absolute;top:35%;left:50%;transform:translate(-50%);font-family:var(--ghs-font-gh-title);font-size:.6em;color:var(--ghs-color-black)}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.heal-container[_ngcontent-%COMP%]{background-color:#a11f1a}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.heal-container[_ngcontent-%COMP%]   .sub-effects[_ngcontent-%COMP%]{display:none}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.heal-container.sub-effects[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .effect-wrapper[_ngcontent-%COMP%]   .effect-container.heal-container.sub-effects[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{left:35%}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.heal-container.sub-effects[_ngcontent-%COMP%]   .sub-effects[_ngcontent-%COMP%]{display:block;position:absolute;top:15%;left:40%;width:100%;height:100%}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.heal-container.sub-effects[_ngcontent-%COMP%]   .sub-effects[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{position:absolute;top:10%;left:10%;color:var(--ghs-color-white);margin-left:5%;margin-right:3%;font-size:1.5em}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.heal-container.sub-effects[_ngcontent-%COMP%]   .sub-effects[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]{top:0;left:0;width:100%;height:100%;transform:none}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.shield-container[_ngcontent-%COMP%]{background-color:#6e4e34}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.shield-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{top:10%;width:80%}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.shield-container[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:1.5em;top:35%}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.shield-container.target[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{top:15%;width:48%}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.shield-container.target[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{top:17%;font-size:1.3em}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.retaliate-container[_ngcontent-%COMP%]{background-color:#384c5a;position:relative}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.retaliate-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50%;left:42%;top:20%}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.retaliate-container[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--ghs-color-white);font-size:1.5em;top:25%;left:80%}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.retaliate-container.target[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{top:15%;width:48%}.effect-wrapper[_ngcontent-%COMP%]   .effect-container.retaliate-container.target[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{top:17%;font-size:1.3em}.effect-wrapper[_ngcontent-%COMP%]   .card-action-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.effect-wrapper[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%]{position:relative;width:80%}.effect-wrapper[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:relative;top:0;left:0;width:100%;height:auto}.effect-wrapper[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%]   img.overlay[_ngcontent-%COMP%]{position:absolute;width:100%;height:auto}.effect-wrapper[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:var(--ghs-color-white);text-transform:uppercase}.effect-wrapper[_ngcontent-%COMP%]   .custom-value-container[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-normal);width:98%}.effect-wrapper[_ngcontent-%COMP%]   .custom-value-container[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%]{display:block;text-align:center;font-size:.8em;line-height:.8em;white-space:break-spaces}.effect-wrapper.elementConsume[_ngcontent-%COMP%]   .element.consume[_ngcontent-%COMP%]{width:50%;height:auto;display:flex}.effect-wrapper.elementConsume[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{margin-left:5%;margin-right:3%}.effect-wrapper.elementConsume[_ngcontent-%COMP%]   .sub-effects[_ngcontent-%COMP%]{width:50%}.effect-wrapper.elementConsume[_ngcontent-%COMP%]   .sub-effects[_ngcontent-%COMP%]   ghs-attackmodifier-effect[_ngcontent-%COMP%]{position:relative;display:block;width:100%}.effect-wrapper.elementConsume[_ngcontent-%COMP%]   .sub-effects[_ngcontent-%COMP%]   ghs-attackmodifier-effect[_ngcontent-%COMP%]   .effect.center.element[_ngcontent-%COMP%]{width:100%;height:auto;display:flex}.effect-wrapper[_ngcontent-%COMP%]   .effect-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.effect-wrapper.pull[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .effect-wrapper.push[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{top:60%}.effect-wrapper.pierce[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{left:30%;background-color:#c6833f}.effect-wrapper.pierce.fh[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{background-color:#c88c4e;font-size:1.2em;left:25%;font-family:var(--ghs-font-gh-title);top:32%}.effect-wrapper.push.fh[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);top:12%;color:#4f504f}.effect-wrapper.pull.fh[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);top:40%;color:#4f504f}.effect-wrapper.loot[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60%;height:auto;filter:var(--ghs-filter-white)}.effect-wrapper.loot[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--ghs-color-black)}.effect-wrapper.attack[_ngcontent-%COMP%]   .full[_ngcontent-%COMP%], .effect-wrapper.range[_ngcontent-%COMP%]   .full[_ngcontent-%COMP%]{width:80%}.effect-wrapper.attack[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .effect-wrapper.range[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{top:0;left:105%;font-size:4.2em}.effect-wrapper[_ngcontent-%COMP%]   .element-background[_ngcontent-%COMP%]{position:absolute;inset:0;background-image:url(am-front.48806d22feb6f4bf.png);background-size:100%}.effect-wrapper.or[_ngcontent-%COMP%]{width:100%;height:100%}.effect-wrapper.or[_ngcontent-%COMP%]   .or-label[_ngcontent-%COMP%]{font-size:.8em;color:var(--ghs-color-white);position:relative}.effect-wrapper.or[_ngcontent-%COMP%]   .or-label.new-style[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:-1em -1.25em 1em .75em;color:var(--ghs-color-white);background-color:var(--ghs-color-white);clip-path:polygon(100% 0%,95% 0%,0% 95%,0% 100%,5% 100%,100% 5%)}.effect-wrapper.or[_ngcontent-%COMP%]   .or-label.new-style[_ngcontent-%COMP%]:after{content:" ";position:absolute;inset:1em .75em -1em -1.25em;color:var(--ghs-color-white);background-color:var(--ghs-color-white);clip-path:polygon(100% 0%,95% 0%,0% 95%,0% 100%,5% 100%,100% 5%)}.effect-wrapper.or[_ngcontent-%COMP%]   ghs-attackmodifier-effect[_ngcontent-%COMP%]{position:absolute;inset:0}.effect-wrapper.or[_ngcontent-%COMP%]   ghs-attackmodifier-effect[_ngcontent-%COMP%]:nth-child(2){transform:translate(-18%,-18%) scale(.5)}.effect-wrapper.or[_ngcontent-%COMP%]   ghs-attackmodifier-effect[_ngcontent-%COMP%]:nth-child(3){transform:translate(18%,18%) scale(.5)}.effect-wrapper.required[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]{width:100%;height:50%;position:relative;display:flex;margin-bottom:.5em}.effect-wrapper.required[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{position:relative;top:.1em;display:flex;justify-content:center;align-items:center;padding:.3em;border-right:.1em solid var(--ghs-color-white)}.effect-wrapper.required[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .sub-effects[_ngcontent-%COMP%]{position:relative;display:flex;flex-grow:1;justify-content:flex-start;align-items:center;padding:.2em}.effect-wrapper.required[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .sub-effects[_ngcontent-%COMP%]   ghs-attackmodifier-effect[_ngcontent-%COMP%]{display:block;width:45%;margin-right:5%}.effect-wrapper.required[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]:before{content:" ";display:block;position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--ghs-color-black);opacity:.5;z-index:0;border:.1em solid var(--ghs-color-white);border-radius:.5em}.effect-wrapper.custom[_ngcontent-%COMP%]   .sub-effects[_ngcontent-%COMP%]{position:absolute;top:75%;width:20%}.effect-wrapper.changeType[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{width:273%;height:183%;z-index:1}.effect-wrapper.changeType[_ngcontent-%COMP%]   .sub-effects[_ngcontent-%COMP%]{position:absolute;top:25%;width:100%;z-index:2}.effect-wrapper.town-guard.custom[_ngcontent-%COMP%]   .custom-value-container[_ngcontent-%COMP%]   .custom-value[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);font-size:2.3em;text-shadow:var(--ghs-outline-thin)}']})}return i})();const nx=i=>({"town-guard":i}),ix=(i,r)=>({flipped:i,"no-animations":r}),bn=(i,r)=>({"new-style":i,fh:r}),bs=(i,r,e,a,n)=>({"new-style":i,fh:r,"multiple-2":e,"multiple-3":a,"multiple-4":n}),ka=i=>({side:i}),ks=(i,r,e,a,n)=>({center:i,multiple:r,"multiple-2":e,"multiple-3":a,"multiple-4":n}),ax=i=>({character:i}),ys=i=>({effects:i}),kn=(i,r)=>("object"==typeof r?r.type:r)+i;function ox(i,r){if(1&i&&(t.j41(0,"div",2),t.nrm(1,"img",26),t.k0s()),2&i){const e=t.XpG(3);t.HbH(t.VkB("type ",e.effectClasses)),t.Y8G("ngClass",t.l_i(5,bn,e.newStyle,e.settingsManager.settings.fhStyle)),t.R7$(),t.Y8G("src","./assets/images/attackmodifier/"+(!e.defaultType||e.townGuard||e.csOak||e.imbue||e.newStyle&&e.attackModifier.valueType==e.AttackModifierValueType.plus&&e.attackModifier.effects&&0!=e.attackModifier.effects.length?"am-front":e.attackModifier.type)+".png",t.B4B)}}function sx(i,r){if(1&i&&t.nrm(0,"div",2),2&i){const e=r.$implicit,a=t.XpG(4);t.HbH(t.ai1("type multiple ",e.type," ",e.value)),t.Y8G("ngClass",t.s1E(5,bs,a.newStyle,a.settingsManager.settings.fhStyle,2==a.attackModifier.effects.length,3==a.attackModifier.effects.length,4==a.attackModifier.effects.length))}}function rx(i,r){if(1&i&&t.Z7z(0,sx,1,11,"div",1,kn),2&i){const e=t.XpG(3);t.Dyx(e.attackModifier.effects)}}function cx(i,r){if(1&i&&t.nrm(0,"div",2),2&i){const e=t.XpG().$implicit,a=t.XpG(4);t.HbH(t.ai1("type multiple multiple-mixed-element ",e.type," ",e.value)),t.Y8G("ngClass",t.l_i(5,bn,a.newStyle,a.settingsManager.settings.fhStyle))}}function lx(i,r){if(1&i&&t.nVh(0,cx,1,8,"div",1),2&i){const e=r.$implicit,a=t.XpG(4);t.vxM(a.filter(e)?0:-1)}}function gx(i,r){if(1&i&&t.nrm(0,"div",2),2&i){const e=r.$implicit,a=t.XpG(5);t.HbH(t.ai1("type multiple  multiple-mixed-element multiple-mixed-element-or ",e.type," ",e.value)),t.Y8G("ngClass",t.l_i(5,bn,a.newStyle,a.settingsManager.settings.fhStyle))}}function dx(i,r){if(1&i&&t.Z7z(0,gx,1,8,"div",1,kn),2&i){const e=t.XpG(4);t.Dyx(e.orTypeEffect.effects)}}function hx(i,r){if(1&i&&(t.nrm(0,"div",2),t.Z7z(1,lx,1,1,null,null,kn),t.nVh(3,dx,2,0)),2&i){const e=t.XpG(3);t.HbH(t.VkB("type multiple multiple-mixed-element ",e.mixedElement.value)),t.Y8G("ngClass",t.l_i(5,bn,e.newStyle,e.settingsManager.settings.fhStyle)),t.R7$(),t.Dyx(e.effects),t.R7$(2),t.vxM(e.orTypeEffect&&e.orTypeEffect.effects.length>1?3:-1)}}function _x(i,r){if(1&i&&t.nrm(0,"div",2),2&i){const e=r.$implicit,a=t.XpG(4);t.HbH(t.ai1("type multiple ",e.type," ",e.value)),t.Y8G("ngClass",t.s1E(5,bs,a.newStyle,a.settingsManager.settings.fhStyle,2==a.orTypeEffect.effects.length,3==a.orTypeEffect.effects.length,4==a.orTypeEffect.effects.length))}}function mx(i,r){if(1&i&&t.Z7z(0,_x,1,11,"div",1,kn),2&i){const e=t.XpG(3);t.Dyx(e.orTypeEffect.effects)}}function px(i,r){if(1&i&&t.nrm(0,"div",2),2&i){const e=r.$implicit,a=t.XpG(4);t.HbH(t.VkB("type multiple multiple-1 ",e)),t.Y8G("ngClass",t.l_i(4,bn,a.newStyle,a.settingsManager.settings.fhStyle))}}function ux(i,r){if(1&i&&t.Z7z(0,px,1,7,"div",1,t.fX1),2&i){const e=t.XpG(3);t.Dyx(e.attackModifier.effects[0].value.split("|"))}}function fx(i,r){1&i&&t.nrm(0,"div",27)(1,"div",28)(2,"div",29)(3,"div",30)(4,"div",31)(5,"div",32)}function Cx(i,r){1&i&&(t.j41(0,"div",8),t.nrm(1,"img",33),t.k0s())}function Mx(i,r){if(1&i&&(t.j41(0,"div",9),t.nrm(1,"img",26),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("src","./assets/images/attackmodifier/"+e.attackModifier.valueType+e.attackModifier.value+".png",t.B4B)}}function vx(i,r){1&i&&(t.j41(0,"div",10),t.nrm(1,"img",34),t.k0s())}function Ox(i,r){1&i&&(t.j41(0,"div",11),t.nrm(1,"img",35),t.k0s())}function Px(i,r){if(1&i&&t.nrm(0,"img",14),2&i){const e=t.XpG(3);t.Y8G("ngClass",t.eq3(2,ka,e.newStyle))("src","./assets/images/attackmodifier/"+(e.newStyle?"icons/":"overlays/")+e.attackModifier.type+".png",t.B4B)}}function bx(i,r){if(1&i&&t.nrm(0,"img",15),2&i){const e=t.XpG(3);t.Y8G("src","./assets/images/attackmodifier/"+(e.newStyle?"icons/":"overlays/")+e.attackModifier.valueType+e.attackModifier.value+".png",t.B4B)}}function kx(i,r){1&i&&t.nrm(0,"img",16)}function yx(i,r){if(1&i&&(t.j41(0,"span",17),t.EFF(1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.JRh(e.numeration)}}function xx(i,r){1&i&&(t.j41(0,"span",18),t.EFF(1," * "),t.k0s())}function Ex(i,r){if(1&i&&(t.j41(0,"span",19),t.EFF(1),t.k0s()),2&i){const e=t.XpG(3);t.Y8G("ngClass",t.eq3(2,ka,e.newStyle&&e.attackModifier.effects&&e.attackModifier.effects.length>0)),t.R7$(),t.SpI("+",e.attackModifier.value)}}function wx(i,r){if(1&i&&(t.j41(0,"span",19),t.EFF(1),t.k0s()),2&i){const e=t.XpG(3);t.Y8G("ngClass",t.eq3(2,ka,e.newStyle&&e.attackModifier.effects&&e.attackModifier.effects.length>0)),t.R7$(),t.SpI("-",e.attackModifier.value)}}function Rx(i,r){if(1&i&&(t.j41(0,"span",20),t.nrm(1,"img",26),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("src",e.characterIcon,t.B4B)}}function jx(i,r){if(1&i&&(t.j41(0,"span",21),t.nrm(1,"img",26),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("src","./assets/images/attackmodifier/imbuement/"+e.attackModifier.type+".svg",t.B4B)}}function Gx(i,r){if(1&i&&t.nrm(0,"ghs-attackmodifier-effect",36),2&i){const e=r.$implicit;t.XpG(3);const a=t.sdS(2),n=t.XpG();t.Y8G("attackModifier",n.attackModifier)("effect",e)("offsetWidth",a.offsetWidth)("newStyle",n.newStyle)("length",n.effects.length)}}function Tx(i,r){if(1&i&&(t.j41(0,"div",22),t.Z7z(1,Gx,1,5,"ghs-attackmodifier-effect",36,kn),t.k0s()),2&i){const e=t.XpG(3);t.Y8G("ngClass",t.s1E(1,ks,e.attackModifier.type==e.AttackModifierType.plus0||e.newStyle,e.effects.length>1,2==e.effects.length,3==e.effects.length,4==e.effects.length)),t.R7$(),t.Dyx(e.effects)}}function Sx(i,r){if(1&i&&(t.j41(0,"div",23),t.nrm(1,"ghs-attackmodifier-effect",37),t.k0s()),2&i){t.XpG(2);const e=t.sdS(2),a=t.XpG();t.R7$(),t.Y8G("attackModifier",a.attackModifier)("effect",a.mixedElement)("offsetWidth",e.offsetWidth)("newStyle",a.newStyle)}}function $x(i,r){if(1&i&&(t.j41(0,"div",24),t.nrm(1,"img",26),t.k0s()),2&i){const e=t.XpG(3);t.Y8G("ngClass",t.eq3(2,ax,e.characterIcon)),t.R7$(),t.Y8G("src","./assets/images/bb/attackmodifier/"+e.bbIndex+".svg",t.B4B)}}function Dx(i,r){1&i&&(t.j41(0,"span",25),t.nrm(1,"img",38),t.k0s())}function Ix(i,r){if(1&i&&(t.nVh(0,ox,2,8,"div",1),t.nVh(1,rx,2,0),t.nVh(2,hx,4,8),t.nVh(3,mx,2,0),t.nVh(4,ux,2,0),t.nVh(5,fx,6,0),t.nVh(6,Cx,2,0,"div",8),t.nVh(7,Mx,2,1,"div",9),t.nVh(8,vx,2,0,"div",10),t.nVh(9,Ox,2,0,"div",11),t.nrm(10,"img",12)(11,"img",13),t.nVh(12,Px,1,4,"img",14),t.nVh(13,bx,1,1,"img",15),t.nVh(14,kx,1,0,"img",16),t.nVh(15,yx,2,1,"span",17),t.nVh(16,xx,2,0,"span",18),t.nVh(17,Ex,2,4,"span",19),t.nVh(18,wx,2,4,"span",19),t.nVh(19,Rx,2,1,"span",20),t.nVh(20,jx,2,1,"span",21),t.nVh(21,Tx,3,7,"div",22),t.nVh(22,Sx,2,4,"div",23),t.nVh(23,$x,2,4,"div",24),t.nVh(24,Dx,2,0,"span",25)),2&i){const e=t.XpG(2);t.vxM(!e.mixedElement&&!e.multipe||e.wildElement?0:-1),t.R7$(),t.vxM(e.multipe&&e.attackModifier.effects.length>1?1:-1),t.R7$(),t.vxM(e.mixedElement&&e.effects.length>0?2:-1),t.R7$(),t.vxM(!e.mixedElement&&e.orTypeEffect&&e.orTypeEffect.effects.length>1?3:-1),t.R7$(),t.vxM(e.multipe&&1==e.attackModifier.effects.length?4:-1),t.R7$(),t.vxM(e.wildElement?5:-1),t.R7$(),t.vxM(e.csOak?6:-1),t.R7$(),t.vxM(!e.imbue||e.attackModifier.effects&&0!=e.attackModifier.effects.length?-1:7),t.R7$(),t.vxM(e.attackModifier.type==e.AttackModifierType.empower?8:-1),t.R7$(),t.vxM(e.attackModifier.type==e.AttackModifierType.enfeeble?9:-1),t.R7$(3),t.vxM(e.attackModifier.effects&&e.attackModifier.effects.length>0&&(e.attackModifier.type!=e.AttackModifierType.plus0&&e.attackModifier.type!=e.AttackModifierType.plus&&e.attackModifier.type!=e.AttackModifierType.minus||e.newStyle)&&e.attackModifier.type!=e.AttackModifierType.empower&&e.attackModifier.type!=e.AttackModifierType.enfeeble&&e.attackModifier.type!=e.AttackModifierType.imbue&&e.attackModifier.type!=e.AttackModifierType.advancedImbue?12:-1),t.R7$(),t.vxM(e.attackModifier.type==e.AttackModifierType.empower||e.attackModifier.type==e.AttackModifierType.enfeeble||(e.attackModifier.type==e.AttackModifierType.imbue||e.attackModifier.type==e.AttackModifierType.advancedImbue)&&e.attackModifier.effects&&e.attackModifier.effects.length?13:-1),t.R7$(),t.vxM(e.attackModifier.rolling?14:-1),t.R7$(),t.vxM((e.characterIcon||e.ally)&&(e.attackModifier.character||e.attackModifier.type==e.AttackModifierType.curse)||e.attackModifier.type==e.AttackModifierType.bless||e.csOak||e.imbue||e.attackModifier.type==e.AttackModifierType.minus1extra?-1:15),t.R7$(),t.vxM((e.characterIcon||e.ally)&&e.attackModifier.type==e.AttackModifierType.curse||e.attackModifier.type==e.AttackModifierType.minus1extra?16:-1),t.R7$(),t.vxM(e.attackModifier.type==e.AttackModifierType.plus?17:-1),t.R7$(),t.vxM(e.attackModifier.type==e.AttackModifierType.minus?18:-1),t.R7$(),t.vxM(e.characterIcon&&e.attackModifier.character?19:-1),t.R7$(),t.vxM(e.imbue?20:-1),t.R7$(),t.vxM(e.attackModifier.effects?21:-1),t.R7$(),t.vxM(e.mixedElement?22:-1),t.R7$(),t.vxM(e.bbIndex>-1&&e.bbIndex<3?23:-1),t.R7$(),t.vxM(e.attackModifier.shuffle?24:-1)}}function Ax(i,r){if(1&i&&(t.j41(0,"span",19),t.EFF(1),t.k0s()),2&i){const e=t.XpG(4);t.Y8G("ngClass",t.eq3(2,ys,!e.townGuardEffectIcon&&e.attackModifier.effects.length>0||e.townGuardEffectIcon&&e.attackModifier.effects.length>1)),t.R7$(),t.SpI("+",e.attackModifier.value)}}function Vx(i,r){if(1&i&&(t.j41(0,"span",19),t.EFF(1),t.k0s()),2&i){const e=t.XpG(4);t.Y8G("ngClass",t.eq3(2,ys,e.attackModifier.effects.length>0)),t.R7$(),t.SpI("-",e.attackModifier.value)}}function Fx(i,r){if(1&i&&(t.nVh(0,Ax,2,4,"span",19),t.nVh(1,Vx,2,4,"span",19)),2&i){const e=t.XpG(3);t.vxM(!(e.attackModifier.value>0||0==e.attackModifier.effects.length)||e.attackModifier.valueType!=e.AttackModifierValueType.plus&&e.attackModifier.valueType!=e.AttackModifierValueType.default?-1:0),t.R7$(),t.vxM(e.attackModifier.valueType==e.AttackModifierValueType.minus?1:-1)}}function Xx(i,r){if(1&i&&(t.j41(0,"span",40),t.nrm(1,"img",26),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("src","./assets/images/action/custom/"+e.townGuardEffectIcon.value+".svg",t.B4B)}}function Bx(i,r){if(1&i&&t.nrm(0,"ghs-attackmodifier-effect",42),2&i){const e=r.$implicit;t.XpG(3);const a=t.sdS(2),n=t.XpG();t.Y8G("attackModifier",n.attackModifier)("effect",e)("offsetWidth",a.offsetWidth)("townGuard",!0)("length",n.effects.length)}}function Yx(i,r){if(1&i&&(t.j41(0,"div",41),t.Z7z(1,Bx,1,5,"ghs-attackmodifier-effect",42,kn),t.k0s()),2&i){const e=t.XpG(3);t.Y8G("ngClass",t.s1E(1,ks,0==e.attackModifier.value,e.effects.length>1,2==e.effects.length,3==e.effects.length,4==e.effects.length)),t.R7$(),t.Dyx(e.effects)}}function Nx(i,r){1&i&&t.nrm(0,"img",16)}function zx(i,r){if(1&i&&(t.j41(0,"div",39),t.nrm(1,"img",26),t.k0s(),t.nVh(2,Fx,2,2),t.nVh(3,Xx,2,1,"span",40),t.nVh(4,Yx,3,7,"div",41),t.nVh(5,Nx,1,0,"img",16)),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.l_i(6,bn,e.newStyle,e.settingsManager.settings.fhStyle)),t.R7$(),t.Y8G("src","./assets/images/attackmodifier/town-guard/"+(e.attackModifier.type==e.AttackModifierType.townguard?e.attackModifier.valueType:e.attackModifier.type)+".png",t.B4B),t.R7$(),t.vxM(e.attackModifier.type==e.AttackModifierType.townguard?2:-1),t.R7$(),t.vxM(e.townGuardEffectIcon?3:-1),t.R7$(),t.vxM(e.attackModifier.effects?4:-1),t.R7$(),t.vxM(e.attackModifier.rolling?5:-1)}}function Lx(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",2)(1,"div",3,0),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.onChange(n))}),t.j41(3,"div",4)(4,"span",5),t.nrm(5,"span",6),t.k0s()(),t.j41(6,"div",7),t.nVh(7,Ix,25,23),t.nVh(8,zx,6,9),t.k0s()()()}if(2&i){const e=t.XpG();t.HbH(t.VkB("attack-modifier ",e.attackModifier.type)),t.Y8G("ngClass",t.eq3(9,nx,e.townGuard)),t.R7$(),t.Y8G("ngClass",t.l_i(11,ix,e.flipped||e.attackModifier.revealed,!e.animate))("disabled",!e.reveal),t.R7$(4),t.Y8G("ghs-label","game.cards.confirmReveal"),t.R7$(2),t.vxM(e.townGuard?-1:7),t.R7$(),t.vxM(e.townGuard?8:-1)}}let Ln=(()=>{class i{elementRef;attackModifier;characterIcon;ally=!1;numeration="";number=0;reveal=!1;disableFlip=!1;flipped=!1;newStyle=!1;townGuard=!1;bbIndex=-1;effectClasses="";AttackModifierType=Y.Yn;AttackModifierValueType=Y.tW;AttackModifierEffectType=Y.hY;effects=[];defaultType=!0;animate=!0;multipe=!1;wildElement=!1;csOak=!1;imbue=!1;mixedElement;orTypeEffect;townGuardEffectIcon;settingsManager=m.f;constructor(e){this.elementRef=e}ngOnInit(){this.animate=!this.disableFlip,this.init()}ngAfterViewInit(){this.adjustFontSize(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.adjustFontSize()})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}adjustFontSize(){this.elementRef.nativeElement.style.fontSize=.08*this.elementRef.nativeElement.offsetWidth+"px"}init(){this.attackModifier&&(this.csOak=this.attackModifier.id&&this.attackModifier.id.startsWith("cs-oak")||!1,this.imbue=this.attackModifier.type==Y.Yn.imbue||this.attackModifier.type==Y.Yn.advancedImbue,this.newStyle=this.newStyle||this.attackModifier.type==Y.Yn.empower||this.attackModifier.type==Y.Yn.enfeeble||this.imbue,this.multipe=!1,this.wildElement=!1,this.mixedElement=void 0,this.orTypeEffect=void 0,!this.characterIcon&&this.attackModifier.character&&this.attackModifier.id.startsWith("challenge-fh-1503-")&&(this.characterIcon=s.E.characterManager.characterIcon(this.attackModifier.id.replace("challenge-fh-1503-","").split("-")[0])),this.attackModifier.effects&&(this.attackModifier.effects.find(e=>e.type==Y.hY.element)&&this.attackModifier.effects.some(e=>e.type!=Y.hY.element)&&(this.mixedElement=this.attackModifier.effects.find(e=>e.type==Y.hY.element)),this.townGuard&&(this.townGuardEffectIcon=this.attackModifier.effects.find(e=>e.type==Y.hY.custom&&e.icon)),this.effects=(this.mixedElement?this.attackModifier.effects.filter(e=>e!=this.mixedElement):this.attackModifier.effects).filter(e=>!this.townGuard||e.type!=Y.hY.custom||!e.icon),this.multipe=this.effects.length>1&&this.effects.every(e=>e.type==Y.hY.element)||this.effects.length>1&&this.effects.every(e=>e.type==Y.hY.condition||e.type==Y.hY.pierce||e.type==Y.hY.pull||e.type==Y.hY.push)||1==this.effects.length&&this.effects.every(e=>e.type==Y.hY.elementHalf)||!1,this.wildElement=1==this.effects.length&&this.effects.every(e=>(e.type==Y.hY.element||e.type==Y.hY.elementConsume)&&"wild"==e.value),this.orTypeEffect=this.effects.find(e=>e.type==Y.hY.or),this.effects.forEach(e=>{e.type!=Y.hY.heal&&e.type!=Y.hY.shield&&(this.defaultType=!1),this.effectClasses+=e.type==Y.hY.condition||e.type==Y.hY.element||e.type==Y.hY.elementHalf?" "+e.value.replaceAll("|","-").replaceAll(":","-"):" "+e.type})))}onChange(e){this.attackModifier.revealed=e}ngOnChanges(e){const a=e.flipped;a&&!this.disableFlip&&a.currentValue&&a.currentValue!=a.previousValue&&(this.animate=!0);const n=e.attackModifier;n&&n.currentValue&&n.currentValue!=n.previousValue&&this.init()}getTarget(e){if(e.effects){const a=e.effects.find(n=>n.type==Y.hY.specialTarget);if(a)return""+a.value}return""}filter(e){return-1!=[Y.hY.element,Y.hY.elementConsume,Y.hY.elementHalf,Y.hY.condition,Y.hY.custom,Y.hY.pull,,Y.hY.push,Y.hY.pierce].indexOf(e.type)}static \u0275fac=function(a){return new(a||i)(t.rXU(t.aKT))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-attackmodifier"]],inputs:{attackModifier:"attackModifier",characterIcon:"characterIcon",ally:"ally",numeration:"numeration",number:"number",reveal:"reveal",disableFlip:"disableFlip",flipped:"flipped",newStyle:"newStyle",townGuard:"townGuard",bbIndex:"bbIndex"},standalone:!1,features:[t.OA$],decls:1,vars:1,consts:[["card",""],[3,"class","ngClass"],[3,"ngClass"],["card-reveal","",1,"card",3,"change","ngClass","disabled"],[1,"card-back","back"],[1,"revealed"],[1,"text",3,"ghs-label"],[1,"card-front","front"],[1,"type","cs-oak"],[1,"type","imbue"],[1,"type","empower"],[1,"type","enfeeble"],["src","./assets/images/attackmodifier/overlays/custom.png",1,"overlay","custom"],["src","./assets/images/attackmodifier/overlays/custom-fh.png",1,"overlay","custom-fh"],[1,"overlay",3,"ngClass","src"],[1,"overlay","side",3,"src"],["src","./assets/images/attackmodifier/rolling.svg",1,"rolling"],[1,"numeration"],[1,"numeration","character-curse-icon"],[1,"am-value",3,"ngClass"],[1,"character-icon"],[1,"character-icon","imbue-icon"],[1,"effects",3,"ngClass"],[1,"mixed-element"],[1,"bb-index",3,"ngClass"],[1,"shuffle-icon"],[3,"src"],[1,"type","multiple","wild","air"],[1,"type","multiple","wild","ice"],[1,"type","multiple","wild","fire"],[1,"type","multiple","wild","earth"],[1,"type","multiple","wild","light"],[1,"type","multiple","wild","dark"],["src","./assets/images/attackmodifier/cs-oak.png"],["src","./assets/images/attackmodifier/empower.png"],["src","./assets/images/attackmodifier/enfeeble.png"],[3,"attackModifier","effect","offsetWidth","newStyle","length"],[3,"attackModifier","effect","offsetWidth","newStyle"],["src","./assets/images/shuffle.svg",1,"svg-icon"],[1,"type",3,"ngClass"],[1,"town-guard-icon"],[1,"effects","town-guard",3,"ngClass"],[3,"attackModifier","effect","offsetWidth","townGuard","length"]],template:function(a,n){1&a&&t.nVh(0,Lx,9,14,"div",1),2&a&&t.vxM(n.attackModifier?0:-1)},dependencies:[N.YU,ex,Be,tt],styles:[".attack-modifier{position:relative;width:100%;height:100%;transition:filter calc(var(--ghs-animation-speed) * 2s) linear,transform calc(var(--ghs-animation-speed) * .8s) cubic-bezier(.75,0,.85,1),top calc(var(--ghs-animation-speed) * .5s) linear,left calc(var(--ghs-animation-speed) * .5s) linear}.attack-modifier .card{transition:transform calc(var(--ghs-animation-speed) * .5s) cubic-bezier(.75,0,.85,1)}.attack-modifier .back{background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-back.e947b7717f678f92.png);border-radius:5%}.attack-modifier .front{display:flex;position:relative;top:0;left:0;width:100%;height:100%;border-radius:5%}.attack-modifier .front .type{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1}.attack-modifier .front .type img{position:absolute;top:0;left:0;width:100%;height:100%}.attack-modifier .front .type.custom.new-style{filter:none}.attack-modifier .front .type.custom.new-style~.overlay.custom{display:inline-block}.attack-modifier .front .type.custom.fh~.overlay.custom{display:none}.attack-modifier .front .type.custom.fh~.overlay.custom-fh{display:inline-block}.attack-modifier .front .type.multiple{background-image:url(am-front.48806d22feb6f4bf.png);background-size:100%}.attack-modifier .front .type.multiple.multiple-mixed-element:not(:nth-child(1)){-webkit-mask-image:conic-gradient(from 90deg at 50% 50%,rgb(0,0,0) 25%,rgba(0,0,0,0) 30%,rgba(0,0,0,0) 70%,rgb(0,0,0) 75%);mask-image:conic-gradient(from 90deg at 50% 50%,#000 25%,#0000 30% 70%,#000 75%)}.attack-modifier .front .type.multiple.multiple-mixed-element.multiple-mixed-element-or{-webkit-mask-image:linear-gradient(to right,rgba(0,0,0,0) 20%,rgb(0,0,0) 100%);mask-image:linear-gradient(to right,#0000 20%,#000)}.attack-modifier .front .type.multiple.multiple-1:nth-child(2){-webkit-mask-image:linear-gradient(to right,rgba(0,0,0,0) 45%,rgb(0,0,0) 55%,rgb(0,0,0) 100%);mask-image:linear-gradient(to right,#0000 45%,#000 55% 100%)}.attack-modifier .front .type.multiple.multiple-1.fh:nth-child(2){-webkit-mask-image:conic-gradient(from 110deg at 50% 50%,rgb(0,0,0) 20%,rgba(0,0,0,0) 25%,rgba(0,0,0,0) 70%,rgb(0,0,0) 75%);mask-image:conic-gradient(from 110deg at 50% 50%,#000 20%,#0000 25% 70%,#000 75%)}.attack-modifier .front .type.multiple.multiple-2:nth-child(2){-webkit-mask-image:conic-gradient(from 90deg at 50% 50%,rgb(0,0,0) 35%,rgba(0,0,0,0) 40%,rgba(0,0,0,0) 85%,rgb(0,0,0) 95%);mask-image:conic-gradient(from 90deg at 50% 50%,#000 35%,#0000 40% 85%,#000 95%)}.attack-modifier .front .type.multiple.multiple-3:nth-child(2){-webkit-mask-image:conic-gradient(from 90deg at 50% 50%,rgba(0,0,0,0) 5%,rgb(0,0,0) 10%,rgb(0,0,0) 40%,rgba(0,0,0,0) 45%);mask-image:conic-gradient(from 90deg at 50% 50%,#0000 5%,#000 10% 40%,#0000 45%)}.attack-modifier .front .type.multiple.multiple-3:nth-child(3){-webkit-mask-image:conic-gradient(from 90deg at 50% 50%,rgb(0,0,0) 5%,rgba(0,0,0,0) 10%,rgba(0,0,0,0) 60%,rgb(0,0,0) 75%);mask-image:conic-gradient(from 90deg at 50% 50%,#000 5%,#0000 10% 60%,#000 75%)}.attack-modifier .front .type.multiple.wild.air{-webkit-mask-image:conic-gradient(from 90deg at 50% 20%,rgba(0,0,0,0) 45%,rgb(0,0,0) 50%,rgb(0,0,0) 75%,rgba(0,0,0,0) 80%);mask-image:conic-gradient(from 90deg at 50% 20%,#0000 45%,#000 50% 75%,#0000 80%)}.attack-modifier .front .type.multiple.wild.ice{-webkit-mask-image:conic-gradient(from 180deg at 50% 20%,rgba(0,0,0,0) 45%,rgb(0,0,0) 50%,rgb(0,0,0) 75%,rgba(0,0,0,0) 80%);mask-image:conic-gradient(from 180deg at 50% 20%,#0000 45%,#000 50% 75%,#0000 80%)}.attack-modifier .front .type.multiple.wild.fire{-webkit-mask-image:conic-gradient(from 270deg at 66% 30%,rgba(0,0,0,0) 35%,rgb(0,0,0) 50%,rgb(0,0,0) 65%,rgba(0,0,0,0) 70%,rgba(0,0,0,0) 70%);mask-image:conic-gradient(from 270deg at 66% 30%,#0000 35%,#000 50% 65%,#0000 70% 70%)}.attack-modifier .front .type.multiple.wild.earth{-webkit-mask-image:conic-gradient(from 290deg at 50% 80%,rgba(0,0,0,0) 35%,rgb(0,0,0) 50%,rgb(0,0,0) 65%,rgba(0,0,0,0) 70%,rgba(0,0,0,0) 70%);mask-image:conic-gradient(from 290deg at 50% 80%,#0000 35%,#000 50% 65%,#0000 70% 70%)}.attack-modifier .front .type.multiple.wild.light{-webkit-mask-image:conic-gradient(from 30deg at 50% 80%,rgba(0,0,0,0) 35%,rgb(0,0,0) 50%,rgb(0,0,0) 65%,rgba(0,0,0,0) 70%,rgba(0,0,0,0) 70%);mask-image:conic-gradient(from 30deg at 50% 80%,#0000 35%,#000 50% 65%,#0000 70% 70%)}.attack-modifier .front .type.multiple.wild.dark{-webkit-mask-image:conic-gradient(from 40deg at 33% 30%,rgba(0,0,0,0) 35%,rgb(0,0,0) 50%,rgb(0,0,0) 65%,rgba(0,0,0,0) 70%,rgba(0,0,0,0) 70%);mask-image:conic-gradient(from 40deg at 33% 30%,#0000 35%,#000 50% 65%,#0000 70% 70%)}.attack-modifier .front .type.air{filter:hue-rotate(160deg) saturate(80%)}.attack-modifier .front .type.dark{filter:hue-rotate(180deg) saturate(20%) brightness(85%)}.attack-modifier .front .type.earth{filter:hue-rotate(60deg) saturate(160%)}.attack-modifier .front .type.fire{filter:hue-rotate(355deg) saturate(250%)}.attack-modifier .front .type.ice{filter:hue-rotate(165deg) saturate(250%) brightness(120%)}.attack-modifier .front .type.light{filter:hue-rotate(20deg) saturate(200%) brightness(110%)}.attack-modifier .front .type.bless{filter:hue-rotate(20deg) saturate(250%) brightness(100%)}.attack-modifier .front .type.brittle{filter:hue-rotate(175deg) saturate(90%)}.attack-modifier .front .type.curse{filter:hue-rotate(254deg) saturate(110%) brightness(90%)}.attack-modifier .front .type.disarm{filter:hue-rotate(200deg) saturate(50%) sepia(10%)}.attack-modifier .front .type.immobilize{filter:hue-rotate(330deg) saturate(200%) brightness(80%)}.attack-modifier .front .type.invisible{filter:hue-rotate(200deg) saturate(20%) brightness(70%) contrast(110%)}.attack-modifier .front .type.muddle{filter:hue-rotate(335deg) saturate(170%) sepia(40%) brightness(80%)}.attack-modifier .front .type.poison{filter:hue-rotate(80deg) saturate(90%)}.attack-modifier .front .type.regenerate{filter:hue-rotate(290deg) saturate(200%)}.attack-modifier .front .type.ward{filter:hue-rotate(290deg) saturate(200%) brightness(60%)}.attack-modifier .front .type.strengthen{filter:hue-rotate(165deg) saturate(100%)}.attack-modifier .front .type.stun{filter:hue-rotate(168deg) saturate(150%)}.attack-modifier .front .type.wound:not(.heal){filter:hue-rotate(355deg) saturate(250%)}.attack-modifier .front .type.chill{filter:hue-rotate(165deg) saturate(90%) brightness(120%)}.attack-modifier .front .type.push,.attack-modifier .front .type.pull{filter:grayscale(80%)}.attack-modifier .front .type.pierce{filter:hue-rotate(10deg) saturate(180%)}.attack-modifier .front .type.retaliate{filter:hue-rotate(160deg) grayscale(30%)}.attack-modifier .front .type.target{filter:hue-rotate(330deg) saturate(350%) brightness(80%)}.attack-modifier .front .type.refreshItem{filter:hue-rotate(330deg) saturate(130%)}.attack-modifier .front .type.custom{filter:hue-rotate(330deg) saturate(250%)}.attack-modifier .front img.overlay{position:absolute;width:100%;height:100%;z-index:2}.attack-modifier .front img.overlay.custom,.attack-modifier .front img.overlay.custom-fh{display:none}.attack-modifier .front img.overlay.side{top:50%;width:18%;height:auto;left:5%;transform:translateY(-50%)}.attack-modifier .front img.rolling{position:absolute;z-index:3;width:auto;height:28%;top:36%;right:5%}.attack-modifier .front .bb-index{position:absolute;z-index:4;width:30%;height:15%;top:15%;left:0;display:flex;justify-content:center;align-items:center}.attack-modifier .front .bb-index.character{right:0;left:initial}.attack-modifier .front .bb-index img{width:100%;height:auto;filter:var(--ghs-filter-white) var(--ghs-filter-outline)}.attack-modifier .front .numeration{position:absolute;left:9.6%;top:74%;font-family:var(--ghs-font-gh-title);font-size:.8em;line-height:.8em;color:var(--ghs-color-white);z-index:2;width:8%;height:12%;display:flex;justify-content:center;align-items:center}.attack-modifier .front .numeration.character-curse-icon{font-size:1.8em;top:80%}.attack-modifier .front .numeration img{filter:grayscale(100%) brightness(100) contrast(100%);width:90%;height:auto}.attack-modifier .front .character-icon{position:absolute;left:7.5%;top:67%;z-index:2;width:14%;height:20%;display:flex;justify-content:center;align-items:center;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-character-icon.83c1ab396221d56b.png)}.attack-modifier .front .character-icon img{filter:grayscale(100%) brightness(100) contrast(100%);height:70%;width:auto}.attack-modifier .front .character-icon.imbue-icon img{filter:var(--ghs-filter-white)}.attack-modifier .front .shuffle-icon{position:absolute;right:8.5%;top:67.5%;z-index:2;width:14%;height:20%;display:flex;justify-content:center;align-items:center;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-shuffle-icon.83c1ab396221d56b.png)}.attack-modifier .front .shuffle-icon img{filter:var(--ghs-filter-white);height:70%;width:auto}.attack-modifier .front .town-guard-icon{position:absolute;left:7.5%;top:67%;z-index:2;width:16%;height:24%;display:flex;justify-content:center;align-items:center;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-town-guard-icon.c02be0601faddc20.png)}.attack-modifier .front .town-guard-icon img{filter:var(--ghs-filter-white) var(--ghs-filter-shadow);height:70%;width:auto}.attack-modifier .front .effects{position:absolute;width:18%;top:35%;left:6%;z-index:3}.attack-modifier .front .effects>ghs-attackmodifier-effect{display:block;position:absolute;top:0;left:0;width:100%}.attack-modifier .front .effects.multiple.multiple-2>ghs-attackmodifier-effect:nth-child(1){transform:translateY(-110%)}.attack-modifier .front .effects.town-guard{top:56%;left:43%;width:15%}.attack-modifier .front .effects.center{top:22%;left:31%;width:37%}.attack-modifier .front .effects.center.multiple>ghs-attackmodifier-effect:nth-child(1){transform:translate(-70%,-70%) scale(.5)}.attack-modifier .front .effects.center.multiple>ghs-attackmodifier-effect:nth-child(2){transform:translate(-30%,-30%) scale(.5)}.attack-modifier .front .effects.center.multiple>ghs-attackmodifier-effect:nth-child(3){transform:translate(-30%,-70%) scale(.5)}.attack-modifier .front .effects.center.multiple>ghs-attackmodifier-effect:nth-child(4){transform:translate(-70%,-30%) scale(.5)}.attack-modifier .front .effects.center.multiple.multiple-2>ghs-attackmodifier-effect:nth-child(1){transform:translate(-18%,-18%) scale(.5)}.attack-modifier .front .effects.center.multiple.multiple-2>ghs-attackmodifier-effect:nth-child(2){transform:translate(18%,18%) scale(.5)}.attack-modifier .front .effects.center.multiple.multiple-3>ghs-attackmodifier-effect:nth-child(1){transform:translate(-25%,-15%) scale(.4)}.attack-modifier .front .effects.center.multiple.multiple-3>ghs-attackmodifier-effect:nth-child(2){transform:translateY(25%) scale(.4)}.attack-modifier .front .effects.center.multiple.multiple-3>ghs-attackmodifier-effect:nth-child(3){transform:translate(25%,-15%) scale(.4)}.attack-modifier .front .am-value{position:absolute;display:flex;justify-content:center;align-items:center;top:50%;left:49.5%;width:34%;height:52%;transform:translate(-50%,-50%);font-family:var(--ghs-font-gh-title);color:var(--ghs-color-white);font-size:3.5em;z-index:1;text-shadow:1px 0px var(--ghs-color-darkgray),0px 1px var(--ghs-color-darkgray),1px 0px var(--ghs-color-darkgray),0px 1px var(--ghs-color-darkgray);filter:drop-shadow(1px 1px 1px var(--ghs-color-darkgray))}.attack-modifier .front .am-value.side{left:13%;width:15%;height:25%;font-size:1.6em;z-index:4}.attack-modifier .front .mixed-element{position:absolute;top:8%;left:5%;width:16%;height:25%;z-index:3}.attack-modifier.bless .front:before{display:none}.attack-modifier.draw{z-index:0}.attack-modifier .confirm .revealed{width:100%;height:100%;display:flex;justify-content:center;align-items:center;color:var(--ghs-color-white);font-size:1.3em;filter:drop-shadow(calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) var(--ghs-color-black))}.attack-modifier .confirm .revealed .text{text-align:center}.attack-modifier.town-guard .back{background-image:url(back.86db9c801336d036.png)}.attack-modifier.town-guard .front .am-value.effects{top:43%}\n"],encapsulation:2})}return i})();const Ux=["menu"],qx=(i,r)=>({denied:i,"has-deleted":r}),Oe=i=>({disabled:i}),Hx=i=>({"has-deleted":i}),Kx=i=>({denied:i}),yi=(i,r)=>r.id+i;function Wx(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",6),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.removeDrawnDiscards())}),t.nrm(1,"span",7),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","game.cards.removeDrawnDiscards"))}function Jx(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",14),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleEdit())}),t.k0s(),t.nrm(2,"span",7),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("checked",e.edit),t.R7$(),t.Y8G("ghs-label","game.cards.edit")}}function Zx(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",14),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleBB())}),t.k0s(),t.nrm(2,"span",7),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("checked",e.bbTable),t.R7$(),t.Y8G("ghs-label","game.cards.edit.toggleBB")}}function Qx(i,r){1&i&&(t.j41(0,"span",21),t.nrm(1,"img",27),t.k0s())}function t3(i,r){1&i&&(t.j41(0,"span",21),t.nrm(1,"img",27),t.k0s())}function e3(i,r){1&i&&(t.j41(0,"span",21),t.nrm(1,"img",27),t.k0s())}function n3(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",9)(1,"span",15)(2,"a",16),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeBless(-1))}),t.nrm(3,"img",17),t.k0s()(),t.j41(4,"span",18),t.nrm(5,"img",19),t.j41(6,"span",20),t.EFF(7),t.k0s(),t.nVh(8,Qx,2,0,"span",21),t.k0s(),t.j41(9,"span",15)(10,"a",16),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeBless(1))}),t.nrm(11,"img",22),t.k0s()(),t.j41(12,"span",15)(13,"a",16),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeCurse(-1))}),t.nrm(14,"img",17),t.k0s()(),t.j41(15,"span",18),t.nrm(16,"img",23),t.j41(17,"span",24),t.EFF(18),t.k0s(),t.nVh(19,t3,2,0,"span",21),t.k0s(),t.j41(20,"span",15)(21,"a",16),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeCurse(1))}),t.nrm(22,"img",22),t.k0s()(),t.j41(23,"span",15)(24,"a",16),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeMinus1Extra(-1))}),t.nrm(25,"img",17),t.k0s()(),t.j41(26,"span",18),t.nrm(27,"img",25),t.j41(28,"span",26),t.EFF(29),t.k0s(),t.nVh(30,e3,2,0,"span",21),t.k0s(),t.j41(31,"span",15)(32,"a",16),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeMinus1Extra(1))}),t.nrm(33,"img",22),t.k0s()()()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("ngClass",t.eq3(18,Oe,0==e.countUpcomingAttackModifier(e.AttackModifierType.bless))),t.R7$(2),t.Y8G("ghs-label","game.condition.bless")("ghs-label-attribute","title"),t.R7$(3),t.JRh(e.countUpcomingAttackModifier(e.AttackModifierType.bless)),t.R7$(),t.vxM(e.gameManager.attackModifierManager.countUpcomingBlesses()>10?8:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(20,Oe,e.gameManager.attackModifierManager.countUpcomingBlesses()>=10)),t.R7$(3),t.Y8G("ngClass",t.eq3(22,Oe,0==e.countUpcomingAttackModifier(e.AttackModifierType.curse))),t.R7$(2),t.Y8G("ghs-label","game.condition.curse")("ghs-label-attribute","title"),t.R7$(3),t.JRh(e.countUpcomingAttackModifier(e.AttackModifierType.curse)),t.R7$(),t.vxM(e.gameManager.attackModifierManager.countUpcomingCurses(!e.character&&!e.ally)>10?19:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(24,Oe,e.gameManager.attackModifierManager.countUpcomingCurses(!e.character&&!e.ally)>=10)),t.R7$(3),t.Y8G("ngClass",t.eq3(26,Oe,0==e.countAttackModifier(e.AttackModifierType.minus1extra))),t.R7$(2),t.Y8G("ghs-label","game.attackmodifiers.types.minus1")("ghs-label-attribute","title"),t.R7$(3),t.JRh(e.countAttackModifier(e.AttackModifierType.minus1extra)),t.R7$(),t.vxM(e.gameManager.attackModifierManager.countExtraMinus1()>15?30:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(28,Oe,e.gameManager.attackModifierManager.countExtraMinus1()>=15))}}function i3(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",15)(1,"a",16),t.bIt("click",function(){const n=t.eBV(e).$index,o=t.XpG(2);return t.Njj(o.changeEmpower(n,-1))}),t.nrm(2,"img",17),t.k0s()(),t.j41(3,"span",18),t.nrm(4,"img",28),t.j41(5,"span",29),t.EFF(6),t.k0s(),t.j41(7,"span",30),t.nrm(8,"img",31),t.k0s()(),t.j41(9,"span",15)(10,"a",16),t.bIt("click",function(){const n=t.eBV(e).$index,o=t.XpG(2);return t.Njj(o.changeEmpower(n,1))}),t.nrm(11,"img",22),t.k0s()()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(6,Oe,0==n.countUpcomingAttackModifier(n.AttackModifierType.empower,"additional-"+e.name))),t.R7$(2),t.Y8G("ghs-label","game.attackmodifiers.types.empower")("ghs-label-attribute","title"),t.R7$(3),t.JRh(n.countUpcomingAttackModifier(n.AttackModifierType.empower,"additional-"+e.name)),t.R7$(2),t.Y8G("src",e.iconUrl,t.B4B),t.R7$(2),t.Y8G("ngClass",t.eq3(8,Oe,0==n.countEmpower(a)))}}function a3(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",15)(1,"a",16),t.bIt("click",function(){const n=t.eBV(e).$index,o=t.XpG(2);return t.Njj(o.changeEnfeeble(n,-1))}),t.nrm(2,"img",17),t.k0s()(),t.j41(3,"span",18),t.nrm(4,"img",32),t.j41(5,"span",29),t.EFF(6),t.k0s(),t.j41(7,"span",30),t.nrm(8,"img",31),t.k0s()(),t.j41(9,"span",15)(10,"a",16),t.bIt("click",function(){const n=t.eBV(e).$index,o=t.XpG(2);return t.Njj(o.changeEnfeeble(n,1))}),t.nrm(11,"img",22),t.k0s()()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(6,Oe,0==n.countUpcomingAttackModifier(n.AttackModifierType.enfeeble,"additional-"+e.name))),t.R7$(2),t.Y8G("ghs-label","game.attackmodifiers.types.enfeeble")("ghs-label-attribute","title"),t.R7$(3),t.JRh(n.countUpcomingAttackModifier(n.AttackModifierType.enfeeble,"additional-"+e.name)),t.R7$(2),t.Y8G("src",e.iconUrl,t.B4B),t.R7$(2),t.Y8G("ngClass",t.eq3(8,Oe,0==n.countEnfeeble(a)))}}function o3(i,r){if(1&i&&(t.j41(0,"div",10),t.Z7z(1,i3,12,10,null,null,t.fX1),t.Z7z(3,a3,12,10,null,null,t.fX1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.empowerChars),t.R7$(2),t.Dyx(e.enfeebleChars)}}function s3(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",6),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.restoreDefault())}),t.nrm(1,"span",7),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","game.cards.restore"))}function r3(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",11)(1,"a",33),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.newFirst(n.type))}),t.nrm(2,"img",22),t.k0s(),t.j41(3,"a",33),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeType(!0))}),t.nrm(4,"img",34),t.k0s(),t.j41(5,"span",35),t.nrm(6,"img",31),t.k0s(),t.j41(7,"a",33),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeType())}),t.nrm(8,"img",36),t.k0s(),t.j41(9,"a",33),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.newShuffle(n.type))}),t.nrm(10,"img",37),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(6),t.Y8G("src",t.VkB("./assets/images/attackmodifier/",e.type,".png"),t.B4B)}}function c3(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",11)(1,"a",33),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.addModifier())}),t.nrm(2,"img",22),t.k0s(),t.j41(3,"a",33),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeType(!0))}),t.nrm(4,"img",34),t.k0s(),t.j41(5,"span",35),t.nrm(6,"ghs-attackmodifier",38),t.k0s(),t.j41(7,"a",33),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeType())}),t.nrm(8,"img",36),t.k0s(),t.j41(9,"a",33),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.addModifierShuffle())}),t.nrm(10,"img",37),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(6),t.Y8G("attackModifier",e.tgAM)("flipped",!0)("newStyle",!0)("characterIcon",e.characterIcon)("ally",e.ally)("townGuard",e.townGuard)}}function l3(i,r){1&i&&t.nrm(0,"div",41)}function g3(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",48),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$index,o=t.XpG(2);return t.Njj(o.remove(n+o.deck.current+1))}),t.nrm(1,"img",17),t.k0s()}}function d3(i,r){1&i&&t.nrm(0,"div",47)}function h3(i,r){if(1&i&&(t.j41(0,"div",42),t.nrm(1,"ghs-attackmodifier",45),t.nVh(2,g3,2,0,"a",46),t.nVh(3,d3,1,0,"div",47),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.R7$(),t.Y8G("attackModifier",e)("numeration",n.numeration)("reveal",!0)("flipped",2==n.reveal||e.revealed)("newStyle",n.newStyle)("characterIcon",n.characterIcon)("ally",n.ally)("townGuard",n.townGuard)("bbIndex",n.deck.bb?(a+n.deck.current+1)%3:-1),t.R7$(),t.vxM(n.edit?2:-1),t.R7$(),t.vxM(n.edit?3:-1)}}function _3(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",48),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$index,o=t.XpG(2);return t.Njj(o.remove(o.deck.current-n))}),t.nrm(1,"img",17),t.k0s()}}function m3(i,r){1&i&&t.nrm(0,"div",47)}function p3(i,r){if(1&i&&(t.j41(0,"div",42),t.nrm(1,"ghs-attackmodifier",49),t.nVh(2,_3,2,0,"a",46),t.nVh(3,m3,1,0,"div",47),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.R7$(),t.Y8G("attackModifier",e)("numeration",n.numeration)("flipped",!0)("newStyle",n.newStyle)("characterIcon",n.characterIcon)("ally",n.ally)("townGuard",n.townGuard)("bbIndex",n.deck.bb?(n.deck.current-a)%3:-1),t.R7$(),t.vxM(n.edit?2:-1),t.R7$(),t.vxM(n.edit?3:-1)}}function u3(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",52),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$index,o=t.XpG(3);return t.Njj(o.restore(n))}),t.nrm(1,"img",22),t.k0s()}}function f3(i,r){1&i&&t.nrm(0,"div",47)}function C3(i,r){if(1&i&&(t.j41(0,"div",42),t.nrm(1,"ghs-attackmodifier",50),t.nVh(2,u3,2,0,"a",51),t.nVh(3,f3,1,0,"div",47),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(3);t.R7$(),t.Y8G("attackModifier",e)("numeration",a.numeration)("flipped",!0)("newStyle",a.newStyle)("characterIcon",a.characterIcon)("ally",a.ally)("townGuard",a.townGuard),t.R7$(),t.vxM(a.edit?2:-1),t.R7$(),t.vxM(a.edit?3:-1)}}function M3(i,r){if(1&i&&(t.j41(0,"div",44),t.Z7z(1,C3,4,9,"div",42,yi),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Dyx(e.deletedCards)}}function v3(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",39)(1,"div",40,1),t.bIt("cdkDropListDropped",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.dropUpcoming(n))}),t.nVh(3,l3,1,0,"div",41),t.Z7z(4,h3,4,11,"div",42,yi),t.k0s(),t.j41(6,"div",43,2),t.bIt("cdkDropListDropped",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.dropDiscarded(n))}),t.nrm(8,"div",41),t.Z7z(9,p3,4,10,"div",42,yi),t.k0s(),t.nVh(11,M3,3,0,"div",44),t.k0s()}if(2&i){const e=t.sdS(2),a=t.sdS(7),n=t.XpG();t.xc7("max-height",n.maxHeight),t.Y8G("ngClass",t.eq3(12,Hx,n.edit&&n.deletedCards.length)),t.R7$(),t.Y8G("cdkDropListDisabled",!n.edit)("cdkDropListConnectedTo",a)("cdkDropListAutoScrollStep",20)("ngClass",t.eq3(14,Kx,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.attackModifiers&&(!n.character||!n.gameManager.stateManager.characterPermissions[n.character.name+"|"+n.character.edition]))),t.R7$(2),t.vxM(0==n.upcomingCards.length?3:-1),t.R7$(),t.Dyx(n.upcomingCards),t.R7$(2),t.Y8G("cdkDropListDisabled",!n.edit)("cdkDropListConnectedTo",e)("cdkDropListAutoScrollStep",20),t.R7$(3),t.Dyx(n.discardedCards),t.R7$(2),t.vxM(n.edit&&n.deletedCards.length?11:-1)}}function O3(i,r){if(1&i&&(t.j41(0,"div",57),t.nrm(1,"ghs-attackmodifier",50),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(),t.Y8G("attackModifier",e)("numeration",a.numeration)("flipped",!0)("newStyle",a.newStyle)("characterIcon",a.characterIcon)("ally",a.ally)("townGuard",a.townGuard)}}function P3(i,r){if(1&i&&(t.j41(0,"div",13)(1,"div",53),t.nrm(2,"img",54),t.k0s(),t.j41(3,"div",53),t.nrm(4,"img",55),t.k0s(),t.j41(5,"div",53),t.nrm(6,"img",56),t.k0s(),t.Z7z(7,O3,2,7,"div",57,yi),t.k0s()),2&i){const e=t.XpG();t.R7$(7),t.Dyx(e.deck.cards)}}let xs=(()=>{class i{dialogRef;deck;character;numeration="";before;after;menuElement;gameManager=s.E;settingsManager=m.f;GameState=T.mk;reveal=0;edit=!1;maxHeight="";characterIcon="";ally=!1;newStyle=!1;townGuard=!1;bbTable=!1;AttackModifierType=Y.Yn;type=Y.Yn.minus1;tgAM=Y.qq[0];currentAttackModifier=-1;drawing=!1;upcomingCards=[];discardedCards=[];deletedCards=[];empowerChars=[];enfeebleChars=[];constructor(e,a){this.dialogRef=a,this.deck=e.deck,this.character=e.character,this.ally=e.ally,this.numeration=e.numeration,this.newStyle=e.newStyle,this.townGuard=e.townGuard,this.before=e.before,this.after=e.after,this.dialogRef.closed.subscribe(()=>{this.upcomingCards.forEach(n=>n.revealed=!1)})}ngOnInit(){this.character&&(this.deck=this.character.attackModifierDeck,this.numeration=""+this.character.number,this.characterIcon=this.character.iconUrl),setTimeout(()=>{this.maxHeight="calc(80vh - "+this.menuElement.nativeElement.offsetHeight+"px)"},m.f.settings.animations?250*m.f.settings.animationSpeed:0),this.update(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.update()})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}toggleEdit(){this.edit=!this.edit,this.bbTable=!1,setTimeout(()=>{this.maxHeight="calc(80vh - "+this.menuElement.nativeElement.offsetHeight+"px)"},0)}toggleBB(){this.bbTable=!this.bbTable,this.edit=!1,setTimeout(()=>{this.maxHeight="calc(80vh - "+this.menuElement.nativeElement.offsetHeight+"px)"},0)}update(){let e;this.upcomingCards=this.deck.cards.filter((a,n)=>n>this.deck.current),this.discardedCards=this.deck.cards.filter((a,n)=>n<=this.deck.current).reverse(),this.character?e=s.E.attackModifierManager.buildCharacterAttackModifierDeck(this.character):this.townGuard?(e=s.E.attackModifierManager.buildTownGuardAttackModifierDeck(s.E.game.party,s.E.campaignData()),s.E.game.party.townGuardDeck=this.deck.toModel()):e=new Y.J,this.deck.cards.forEach(a=>{if(e){const n=e.cards.find(o=>o.id==a.id);n&&e.cards.splice(e.cards.indexOf(n),1)}}),this.deletedCards=e.cards,(!this.character||!s.E.entityManager.isImmune(this.character,this.character,j.r5.empower))&&(this.empowerChars=s.E.game.figures.filter(a=>a instanceof q.K&&s.E.entityManager.isAlive(a)&&a.additionalModifier&&a.additionalModifier.find(n=>n.attackModifier&&n.attackModifier.type==Y.Yn.empower)).map(a=>a)),(!this.character||!s.E.entityManager.isImmune(this.character,this.character,j.r5.enfeeble))&&(this.enfeebleChars=s.E.game.figures.filter(a=>a instanceof q.K&&s.E.entityManager.isAlive(a)&&!a.absent&&a.additionalModifier&&a.additionalModifier.find(n=>n.attackModifier&&n.attackModifier.type==Y.Yn.enfeeble)).map(a=>a))}shuffle(e=!1){this.before.emit(new _t(this.deck,"shuffle"+(e?"Upcoming":""))),s.E.attackModifierManager.shuffleModifiers(this.deck,e),this.after.emit(new _t(this.deck,"shuffle"+(e?"Upcoming":""))),this.update()}removeDrawnDiscards(){this.before.emit(new _t(this.deck,"removeDrawnDiscards")),s.E.attackModifierManager.removeDrawnDiscards(this.deck),this.after.emit(new _t(this.deck,"removeDrawnDiscards")),this.update()}restoreDefault(){if(this.before.emit(new _t(this.deck,"restoreDefault")),this.character)this.character.mergeAttackModifierDeck(s.E.attackModifierManager.buildCharacterAttackModifierDeck(this.character)),s.E.attackModifierManager.fromModel(this.deck,this.character.attackModifierDeck.toModel());else if(this.townGuard)this.deck=s.E.attackModifierManager.buildTownGuardAttackModifierDeck(s.E.game.party,s.E.campaignData()),s.E.game.party.townGuardDeck=this.deck.toModel();else if(s.E.bbRules()){const e=s.E.editionData.find(a=>"bb"==a.edition&&a.monsterAmTables&&a.monsterAmTables.length);if(e){const a=s.E.levelManager.bbMonsterDifficutly();this.deck=new Y.J(e.monsterAmTables[a].map(n=>new Y.uU(n)),m.f.settings.bbAm)}else this.deck=new Y.J}else this.deck=new Y.J,1==s.E.imbuementManager.imbuement?s.E.imbuementManager.enable(this.deck):"advanced"==s.E.imbuementManager.imbuement&&s.E.imbuementManager.advanced(this.deck);this.after.emit(new _t(this.deck,"restoreDefault")),this.update()}hasDrawnDiscards(){return this.deck.cards.some((e,a)=>a<=this.deck.current&&(e.type==Y.Yn.bless||e.type==Y.Yn.curse||e.type==Y.Yn.empower||e.type==Y.Yn.enfeeble))}dropUpcoming(e){if(this.before.emit(new _t(this.deck,"reorder")),e.container==e.previousContainer){const a=this.deck.current+1;(0,D.HD)(this.deck.cards,e.previousIndex+a,e.currentIndex+a)}else{const a=this.deck.current;(0,D.HD)(this.deck.cards,a-e.previousIndex,e.currentIndex+a),this.deck.current=this.deck.current-1}this.after.emit(new _t(this.deck,"reorder")),this.update()}dropDiscarded(e){if(this.before.emit(new _t(this.deck,"reorder")),e.container==e.previousContainer)(0,D.HD)(this.deck.cards,this.deck.current-e.previousIndex,this.deck.current-e.currentIndex);else{this.deck.current=this.deck.current+1;const a=this.deck.current;(0,D.HD)(this.deck.cards,e.previousIndex+a,a-e.currentIndex),this.deck.cards[a-e.currentIndex].revealed=!0}this.after.emit(new _t(this.deck,"reorder")),this.update()}remove(e){this.before.emit(new _t(this.deck,"removeCard",e)),e<=this.deck.current&&(this.deck.current--,this.currentAttackModifier=this.deck.current),this.deck.cards.splice(e,1),this.after.emit(new _t(this.deck,"removeCard",e)),this.update()}restore(e){this.before.emit(new _t(this.deck,"restoreCard",e)),this.deck.cards.splice(this.deck.current+1,0,this.deletedCards[e]),this.after.emit(new _t(this.deck,"restoreCard",e)),this.update()}newFirst(e){this.before.emit(new _t(this.deck,"addCard","game.attackModifiers.types."+e));let a=new Y.uU(e);a.revealed=!0,this.deck.cards.splice(this.deck.current+1,0,a),this.after.emit(new _t(this.deck,"addCard","game.attackModifiers.types."+e)),this.update()}newShuffle(e){this.before.emit(new _t(this.deck,"addCardShuffled","game.attackModifiers.types."+e)),this.deck.cards.splice(this.deck.current+1+Math.random()*(this.deck.cards.length-this.deck.current),0,new Y.uU(e)),this.after.emit(new _t(this.deck,"addCardShuffled","game.attackModifiers.types."+e)),this.update()}addModifier(){this.before.emit(new _t(this.deck,"addCard","game.attackModifiers.types."+this.tgAM.type));let e=this.tgAM.clone();e.revealed=!0,this.deck.attackModifiers.find(a=>a.id==e.id)||this.deck.attackModifiers.push(e),this.deck.cards.splice(this.deck.current+1,0,e),this.after.emit(new _t(this.deck,"addCard","game.attackModifiers.types."+this.tgAM.type)),this.update()}addModifierShuffle(){this.before.emit(new _t(this.deck,"addCard","game.attackModifiers.types."+this.tgAM.type));let e=this.tgAM.clone();this.deck.cards.splice(this.deck.current+1+Math.random()*(this.deck.cards.length-this.deck.current),0,e),this.deck.attackModifiers.find(a=>a.id==e.id)||this.deck.attackModifiers.push(e),this.after.emit(new _t(this.deck,"addCard","game.attackModifiers.types."+this.tgAM.type)),this.update()}countAttackModifier(e){return this.deck.cards.filter(a=>a.type==e&&!a.character).length}countDrawnAttackModifier(e){return this.deck.cards.filter((a,n)=>a.type==e&&n<=this.deck.current).length}countUpcomingAttackModifier(e,a=void 0){return this.deck.cards.filter((n,o)=>n.type==e&&o>this.deck.current&&(!a||n.id&&n.id.startsWith(a))).length}changeAttackModifier(e,a){if(a>0){if(e==Y.Yn.bless&&s.E.attackModifierManager.countUpcomingBlesses()>=10)return;if(e==Y.Yn.curse&&s.E.attackModifierManager.countUpcomingCurses(!this.character&&!this.ally)>=10)return;if(e==Y.Yn.minus1&&s.E.attackModifierManager.countExtraMinus1()>=15)return;s.E.attackModifierManager.addModifier(this.deck,new Y.uU(e))}else if(a<0){const n=this.deck.cards.find((o,g)=>o.type==e&&g>this.deck.current);n&&this.deck.cards.splice(this.deck.cards.indexOf(n),1)}this.update()}changeBless(e){this.before.emit(new _t(this.deck,e<0?"removeBless":"addBless")),this.changeAttackModifier(Y.Yn.bless,e),this.after.emit(new _t(this.deck,e<0?"removeBless":"addBless")),this.update()}changeCurse(e){this.before.emit(new _t(this.deck,e<0?"removeCurse":"addCurse")),this.changeAttackModifier(Y.Yn.curse,e),this.after.emit(new _t(this.deck,e<0?"removeCurse":"addCurse")),this.update()}changeMinus1Extra(e){this.before.emit(new _t(this.deck,e<0?"removeMinus1":"addMinus1")),this.changeAttackModifier(Y.Yn.minus1extra,e),this.after.emit(new _t(this.deck,e<0?"removeMinus1":"addMinus1")),this.update()}onChange(e,a){e.revealed=a}changeType(e=!1){if(this.townGuard){let a=Y.qq.indexOf(this.tgAM)+(e?-1:1);a<0?a=Y.qq.length-1:a>=Y.qq.length&&(a=0),this.tgAM=Y.qq[a]}else{let a=Object.values(Y.Yn).indexOf(this.type)+(e?-1:1);a<0?a=Object.values(Y.Yn).length-1:a>=Object.values(Y.Yn).length&&(a=0),this.type=Object.values(Y.Yn)[a],-1!=[Y.Yn.plus,Y.Yn.plus3,Y.Yn.plus4,Y.Yn.plusX,Y.Yn.invalid,Y.Yn.minus,Y.Yn.minus1extra,Y.Yn.empower,Y.Yn.enfeeble,Y.Yn.townguard,Y.Yn.success,Y.Yn.wreck].indexOf(this.type)&&this.changeType(e)}this.update()}countEmpower(e,a=!1){return this.empowerChars[e]?this.empowerChars[e].additionalModifier.filter(n=>n.attackModifier&&n.attackModifier.type==Y.Yn.empower).map(n=>n.count).reduce((n,o)=>n+o)-(a?0:s.E.attackModifierManager.countUpcomingAdditional(this.empowerChars[e],Y.Yn.empower)):-1}countEnfeeble(e,a=!1){return this.enfeebleChars[e]?this.enfeebleChars[e].additionalModifier.filter(n=>n.attackModifier&&n.attackModifier.type==Y.Yn.enfeeble).map(n=>n.count).reduce((n,o)=>n+o)-(a?0:s.E.attackModifierManager.countUpcomingAdditional(this.enfeebleChars[e],Y.Yn.enfeeble)):-1}changeEmpower(e,a){if(this.empowerChars[e]){this.before.emit(new _t(this.deck,a<0?"removeEmpower":"addEmpower"));const n=s.E.attackModifierManager.getAdditional(this.empowerChars[e],Y.Yn.empower);if(a>0)for(let o=0;o<Math.min(a,n.length);o++)s.E.attackModifierManager.addModifier(this.deck,n[o]);else for(let o=0;o<-1*a;o++){const g=this.deck.cards.find((_,y)=>this.empowerChars[y]&&y>this.deck.current&&_.type==Y.Yn.empower&&_.id&&_.id.startsWith("additional-"+this.empowerChars[y].name));g&&this.deck.cards.splice(this.deck.cards.indexOf(g),1)}this.after.emit(new _t(this.deck,a<0?"removeEmpower":"addEmpower")),this.update()}}changeEnfeeble(e,a){if(this.enfeebleChars[e]){this.before.emit(new _t(this.deck,a<0?"removeEnfeeble":"addEnfeeble"));const n=s.E.attackModifierManager.getAdditional(this.enfeebleChars[e],Y.Yn.enfeeble);if(a>0)for(let o=0;o<Math.min(a,n.length);o++)s.E.attackModifierManager.addModifier(this.deck,n[o]);else for(let o=0;o<-1*a;o++){const g=this.deck.cards.find((_,y)=>this.empowerChars[y]&&y>this.deck.current&&_.type==Y.Yn.enfeeble&&_.id&&_.id.startsWith("additional-"+this.empowerChars[y].name));g&&this.deck.cards.splice(this.deck.cards.indexOf(g),1)}this.after.emit(new _t(this.deck,a<0?"removeEnfeeble":"addEnfeeble")),this.update()}}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-attackmodifier-deck-dialog"]],viewQuery:function(a,n){if(1&a&&t.GBs(Ux,5),2&a){let o;t.mGM(o=t.lsd())&&(n.menuElement=o.first)}},standalone:!1,decls:18,vars:18,consts:[["menu",""],["upcomingList","cdkDropList"],["discardedList","cdkDropList"],[1,"attack-modifiers-dialog"],[1,"scroll-container"],[1,"menu",3,"ngClass"],[3,"click"],[3,"ghs-label"],["ghs-pointer-input","",3,"singleClick","doubleClick","ghs-tooltip","overlayX"],[1,"curse-bless"],[1,"additional-modifier"],[1,"insert-menu"],[1,"attack-modifiers-container",3,"maxHeight","ngClass"],[1,"bb-table"],["type","checkbox",3,"click","checked"],[1,"item"],[1,"button",3,"click","ngClass"],["src","./assets/images/minus.svg",1,"ghs-svg"],[1,"item",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/status/bless.svg"],[1,"badge","bless-count"],[1,"warning"],["src","./assets/images/plus.svg",1,"ghs-svg"],["src","./assets/images/status/curse.svg"],[1,"badge","curse-count"],["src","./assets/images/attackmodifier/icons/minus1.png"],[1,"badge","minus1-count"],["src","./assets/images/warning.svg"],["src","./assets/images/attackmodifier/icons/empower.png"],[1,"badge"],[1,"badge","badge-character-icon"],[3,"src"],["src","./assets/images/attackmodifier/icons/enfeeble.png"],[1,"icon-button",3,"click"],["src","./assets/images/left.svg",1,"ghs-svg"],[1,"attack-modifier"],["src","./assets/images/right.svg",1,"ghs-svg"],["src","./assets/images/shuffle.svg",1,"ghs-svg"],[1,"drag-hidden",3,"attackModifier","flipped","newStyle","characterIcon","ally","townGuard"],[1,"attack-modifiers-container",3,"ngClass"],["cdkDropList","",1,"upcoming","drop-list",3,"cdkDropListDropped","cdkDropListDisabled","cdkDropListConnectedTo","cdkDropListAutoScrollStep","ngClass"],[1,"empty"],["cdkDrag","",1,"attack-modifier-container"],["cdkDropList","",1,"discarded","drop-list",3,"cdkDropListDropped","cdkDropListDisabled","cdkDropListConnectedTo","cdkDropListAutoScrollStep"],[1,"deleted"],[1,"drag-hidden",3,"attackModifier","numeration","reveal","flipped","newStyle","characterIcon","ally","townGuard","bbIndex"],[1,"button-remove"],["cdkDragHandle","",1,"drag-handle"],[1,"button-remove",3,"click"],[1,"drag-hidden",3,"attackModifier","numeration","flipped","newStyle","characterIcon","ally","townGuard","bbIndex"],[1,"drag-hidden",3,"attackModifier","numeration","flipped","newStyle","characterIcon","ally","townGuard"],[1,"button-restore"],[1,"button-restore",3,"click"],[1,"header"],["src","./assets/images/bb/attackmodifier/0.svg",1,"ghs-svg"],["src","./assets/images/bb/attackmodifier/1.svg",1,"ghs-svg"],["src","./assets/images/bb/attackmodifier/2.svg",1,"ghs-svg"],[1,"attack-modifier-container"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",3)(1,"div",4)(2,"div",5,0)(4,"a",6),t.bIt("click",function(){return t.eBV(o),t.Njj(n.reveal=(n.reveal+1)%3)}),t.nrm(5,"span",7),t.k0s(),t.j41(6,"a",8),t.bIt("singleClick",function(){return t.eBV(o),t.Njj(n.shuffle())})("doubleClick",function(){return t.eBV(o),t.Njj(n.shuffle(!0))}),t.nrm(7,"span",7),t.k0s(),t.nVh(8,Wx,2,1,"a"),t.nVh(9,Jx,3,2,"label"),t.nVh(10,Zx,3,2,"label"),t.nVh(11,n3,34,30,"div",9),t.nVh(12,o3,5,0,"div",10),t.nVh(13,s3,2,1,"a"),t.nVh(14,r3,11,2,"div",11),t.nVh(15,c3,11,6,"div",11),t.k0s(),t.nVh(16,v3,12,16,"div",12),t.nVh(17,P3,9,0,"div",13),t.k0s()()}2&a&&(t.R7$(2),t.Y8G("ngClass",t.l_i(15,qx,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.attackModifiers&&(!n.character||!n.gameManager.stateManager.characterPermissions[n.character.name+"|"+n.character.edition]),n.edit&&n.deletedCards.length)),t.R7$(3),t.Y8G("ghs-label",2==n.reveal?"game.cards.coverAll":0==n.reveal?"game.cards.revealAll":"game.cards.revealAllConfirm"),t.R7$(),t.Y8G("ghs-tooltip","game.cards.shuffle.upcomingHint")("overlayX","center"),t.R7$(),t.Y8G("ghs-label","game.cards.shuffle"),t.R7$(),t.vxM(n.hasDrawnDiscards()?8:-1),t.R7$(),t.vxM(n.gameManager.bbRules()&&n.settingsManager.settings.bbAm?-1:9),t.R7$(),t.vxM(n.gameManager.bbRules()&&n.settingsManager.settings.bbAm?10:-1),t.R7$(),t.vxM(n.gameManager.bbRules()||n.edit||n.townGuard?-1:11),t.R7$(),t.vxM(n.edit||n.townGuard||!n.empowerChars.length&&!n.enfeebleChars.length?-1:12),t.R7$(),t.vxM(n.edit?13:-1),t.R7$(),t.vxM(n.edit&&!n.townGuard?14:-1),t.R7$(),t.vxM(n.edit&&n.townGuard?15:-1),t.R7$(),t.vxM(n.bbTable?-1:16),t.R7$(),t.vxM(n.bbTable?17:-1))},dependencies:[N.YU,D.O7,D.T1,D.Fb,Ln,tt,ft,rt],styles:['.attack-modifiers-dialog[_ngcontent-%COMP%]{position:relative}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;flex-wrap:wrap;max-width:calc(var(--ghs-unit) * 60 * var(--ghs-dialog-factor))}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]{display:flex;max-width:calc(100% - var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor) * 2)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   span.item[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   span.item[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-darkgray)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:auto}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0;color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));text-shadow:var(--ghs-outline)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   .badge.badge-character-icon[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   .badge.badge-character-icon[_ngcontent-%COMP%]{bottom:calc(var(--ghs-unit) * -.8 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor))}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   .badge.badge-character-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   .badge.badge-character-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{position:absolute;left:0;bottom:0}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:auto}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .curse-bless.additional-modifier[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .additional-modifier.additional-modifier[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(6,1fr)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{cursor:pointer;appearance:none;background-color:var(--form-background);width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));border-width:calc(var(--ghs-unit) * .3);border-style:solid;display:grid;place-content:center;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before{left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));position:relative;content:" ";width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));transform:scale(0);transform-origin:bottom left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;clip-path:polygon(14% 44%,0 65%,50% 100%,100% 16%,80% 0%,43% 62%);color:var(--ghs-color-gray);background-color:var(--ghs-color-gray)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked:before{transform:scale(1)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover:before{background-color:var(--ghs-color-white)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .insert-menu[_ngcontent-%COMP%]{display:flex;align-items:center;flex-basis:100%;flex-shrink:0;max-width:calc(100% - var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor) * 2)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .insert-menu[_ngcontent-%COMP%]   .attack-modifier[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));flex-grow:1}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .insert-menu[_ngcontent-%COMP%]   .attack-modifier[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;max-height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:auto;border-radius:5%}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .insert-menu[_ngcontent-%COMP%]   .attack-modifier[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 19.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 13 * var(--ghs-dialog-factor))}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .insert-menu[_ngcontent-%COMP%]   .icon-button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .insert-menu[_ngcontent-%COMP%]   .icon-button[_ngcontent-%COMP%]:hover{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .menu.has-deleted[_ngcontent-%COMP%]{max-width:calc(var(--ghs-unit) * 90 * var(--ghs-dialog-factor))}.attack-modifiers-dialog[_ngcontent-%COMP%]   .drop-list[_ngcontent-%COMP%]{position:relative}.attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]{display:flex;width:calc(var(--ghs-unit) * 60 * var(--ghs-dialog-factor));overflow:auto}.attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;overflow-y:auto;overflow-x:hidden;width:calc(var(--ghs-unit) * 30 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .attack-modifier-container[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .attack-modifier-container[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .attack-modifier-container[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{position:relative;display:flex;transition:none;width:calc(var(--ghs-unit) * 25.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 17 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) 0;flex-shrink:0;flex-grow:0}.attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .attack-modifier-container[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .attack-modifier-container[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .attack-modifier-container[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%]{position:absolute;display:flex;top:0;left:0;width:100%;height:100%}.attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .7 * var(--ghs-dialog-factor));display:block;border-style:dashed;border-width:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor));border-color:var(--ghs-color-white);width:calc(var(--ghs-unit) * 25.1 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 16.6 * var(--ghs-dialog-factor));border-radius:5%}.attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]{z-index:1;position:absolute;display:flex;cursor:pointer;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-filter-white) var(--ghs-filter-shadow)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-shadow)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-remove.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-restore.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-remove.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-restore.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .button-remove.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .button-restore.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-green) var(--ghs-filter-shadow)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%], .attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{position:absolute;cursor:grab;left:50%;top:50%;width:50%;height:70%;transform:translate(-50%,-50%)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .attack-modifiers-container.has-deleted[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 90 * var(--ghs-dialog-factor))}.attack-modifiers-dialog[_ngcontent-%COMP%]   .bb-table[_ngcontent-%COMP%]{display:grid;justify-items:center;grid-template-columns:auto auto auto}.attack-modifiers-dialog[_ngcontent-%COMP%]   .bb-table[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;transition:none;width:calc(var(--ghs-unit) * 18 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.attack-modifiers-dialog[_ngcontent-%COMP%]   .bb-table[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));width:auto;filter:var(--ghs-filter-white)}.attack-modifiers-dialog[_ngcontent-%COMP%]   .bb-table[_ngcontent-%COMP%]   .attack-modifier-container[_ngcontent-%COMP%]{position:relative;display:flex;transition:none;width:calc(var(--ghs-unit) * 18 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 12 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));flex-shrink:0;flex-grow:0}.attack-modifiers-dialog[_ngcontent-%COMP%]   .bb-table[_ngcontent-%COMP%]   .attack-modifier-container[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%]{position:absolute;display:flex;top:0;left:0;width:100%;height:100%}.cdk-drag-preview[_ngcontent-%COMP%]{opacity:0;cursor:grabbing;z-index:999}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.5;cursor:grabbing}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}']})}return i})();const b3=["menu"],k3=["drawCard"],y3=(i,r,e)=>({disabled:i,vertical:r,character:e}),x3=i=>({denied:i}),E3=(i,r)=>({"town-guard":i,disabled:r}),w3=i=>({"has-shuffle":i}),R3=(i,r)=>({vertical:i,minimize:r}),j3=(i,r,e)=>({vertical:i,"without-fullscreen":r,minimize:e}),Es=(i,r,e,a)=>({vertical:i,"without-fullscreen":r,minimize:e,"has-shuffle":a}),G3=(i,r,e,a,n,o,g,_,y,B,nt)=>({discarded:i,current:r,last:e,bottom:a,rolling:n,active:o,"discard-active":g,animate:_,"animate-reverse":!1,disabled:y,highlight:B,ignored:nt}),ws=(i,r)=>({bottom:i,disabled:r}),ya=(i,r)=>r.id+i;function T3(i,r){1&i&&t.nrm(0,"img",15)}function S3(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",13),t.bIt("click",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.openBattleGoals(n))}),t.nrm(1,"img",14),t.nVh(2,T3,1,0,"img",15),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ghs-label","game.battleGoals")("ghs-label-attribute","title"),t.R7$(),t.Y8G("src",e.settingsManager.settings.fhStyle?"./assets/images/fh/battlegoals/battle-goal-back-fh.png":"./assets/images/battlegoals/battle-goal-back.png",t.B4B),t.R7$(),t.vxM(e.character.battleGoal&&e.character.battleGoals.length>0?2:-1)}}function $3(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.JRh(e.deck.current<e.deck.cards.length-1?e.deck.cards.length-e.deck.current-1+"/"+e.deck.cards.length:"")}}function D3(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.JRh(e.bbCurrent+"/"+e.bbRows)}}function I3(i,r){1&i&&t.nrm(0,"img",6),2&i&&t.Y8G("ghs-label","game.cards.shuffle")("ghs-label-attribute","title")}function A3(i,r){if(1&i&&(t.j41(0,"span",7),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.JRh(e.numeration)}}function V3(i,r){if(1&i&&(t.j41(0,"span",8),t.nrm(1,"img",14),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("src",e.characterIcon,t.B4B)}}function F3(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",16),t.bIt("click",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.openFullscreen(n))}),t.nrm(1,"img",17),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ghs-label","game.cards.fullscreen")("ghs-label-attribute","title")("ngClass",t.l_i(3,R3,e.vertical,!e.deck.active))}}function X3(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",18),t.bIt("click",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.open(n))}),t.nrm(1,"img",19),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ghs-label","game.cards.openDialog")("ghs-label-attribute","title")("ngClass",t.sMw(3,j3,e.vertical,!e.fullscreen,!e.deck.active))}}function B3(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",20),t.bIt("click",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.draw(n,"advantage"))}),t.nrm(1,"img",14),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ghs-label","game.cards.drawAdvantage")("ghs-label-attribute","title")("ngClass",t.ziG(4,Es,e.vertical,!e.fullscreen,!e.deck.active,e.deck.current>=e.deck.cards.length-1)),t.R7$(),t.Y8G("src","./assets/images/"+(e.settingsManager.settings.fhStyle?"fh/":"")+"condition/strengthen.svg",t.B4B)}}function Y3(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",21),t.bIt("click",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.draw(n,"disadvantage"))}),t.nrm(1,"img",14),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ghs-label","game.cards.drawDisadvantage")("ghs-label-attribute","title")("ngClass",t.ziG(4,Es,e.vertical,!e.fullscreen,!e.deck.active,e.deck.current>=e.deck.cards.length-1)),t.R7$(),t.Y8G("src","./assets/images/"+(e.settingsManager.settings.fhStyle?"fh/":"")+"condition/muddle.svg",t.B4B)}}function N3(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",23),t.bIt("click",function(n){t.eBV(e);const o=t.XpG().$index,g=t.XpG(2);return t.Njj(g.clickCard(o,n))}),t.nrm(1,"ghs-attackmodifier",24),t.k0s()}if(2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG(2),g=t.sdS(3);t.xc7("z-index",n>o.current?o.deck.cards.length-n:o.deck.cards.length+n+1)("left",!o.vertical&&n<o.current&&(n>=o.lastVisible||a.active&&-1==o.deck.discarded.indexOf(n))?"calc(75% + "+(o.current-n-1+(a.active&&n<o.lastVisible?n-o.lastVisible+o.activeAMs.indexOf(a)+1:0))+" * 25%)":"")("top",o.vertical&&n<o.current&&(n>=o.lastVisible||a.active&&-1==o.deck.discarded.indexOf(n))?"calc("+(o.current-n-1+(a.active&&n<o.lastVisible?n-o.lastVisible+o.activeAMs.indexOf(a)+1:0))*(g.offsetHeight/1.3)+"px)":""),t.Y8G("ngClass",t.zJS(18,G3,[n<o.current-1,n==o.current,n==o.current-1,o.bottom,a.rolling&&n<=o.current,a.active&&n<=o.current&&-1==o.deck.discarded.indexOf(n),-1!=o.deck.discarded.indexOf(n),n<o.current-1&&n>=o.lastVisible,o.disabled,!o.drawing&&o.deck.state&&n==o.current,!o.drawing&&"disadvantage"==o.deck.state&&(n<o.current||!o.gameManager.fhRules()&&!o.settingsManager.settings.alwaysFhAdvantage)&&a.rolling]))("ghs-label","game.cards.openDialog")("ghs-label-attribute","title"),t.R7$(),t.Y8G("attackModifier",a)("numeration",o.numeration)("characterIcon",o.characterIcon)("ally",o.ally)("flipped",n<=o.current)("disableFlip",!o.drawing||n!=o.current)("newStyle",o.newStyle)("townGuard",o.townGuard)("bbIndex",o.deck.bb?n%3:-1)}}function z3(i,r){if(1&i&&t.nVh(0,N3,2,30,"div",22),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.vxM(a<=n.current+1&&(a>=n.lastVisible||e.active&&-1==n.deck.discarded.indexOf(a))?0:-1)}}function L3(i,r){if(1&i&&t.Z7z(0,z3,1,1,null,null,ya),2&i){const e=t.XpG();t.Dyx(e.deck.cards)}}function U3(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",26),t.bIt("click",function(n){t.eBV(e);const o=t.XpG().$index,g=t.XpG(2);return t.Njj(g.clickCard(o,n))}),t.nrm(1,"ghs-attackmodifier",24),t.k0s()}if(2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG(2);t.xc7("z-index",o.deck.cards.length+2),t.Y8G("ngClass",t.l_i(14,ws,o.bottom,o.disabled))("ghs-label","game.cards.openDialog")("ghs-label-attribute","title"),t.R7$(),t.Y8G("attackModifier",a)("numeration",o.numeration)("characterIcon",o.characterIcon)("ally",o.ally)("flipped",!0)("disableFlip",!o.drawing)("newStyle",o.newStyle)("townGuard",o.townGuard)("bbIndex",o.deck.bb?n%3:-1)}}function q3(i,r){if(1&i&&t.nVh(0,U3,2,17,"div",25),2&i){const e=r.$index,a=t.XpG(2);t.vxM(e==a.current?0:-1)}}function H3(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",28),t.bIt("click",function(n){t.eBV(e);const o=t.XpG().$index,g=t.XpG(2);return t.Njj(g.clickCard(o,n))}),t.nrm(1,"ghs-attackmodifier",24),t.k0s()}if(2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG(2);t.xc7("z-index",o.deck.cards.length+1),t.Y8G("ngClass",t.l_i(14,ws,o.bottom,o.disabled))("ghs-label","game.cards.openDialog")("ghs-label-attribute","title"),t.R7$(),t.Y8G("attackModifier",a)("numeration",o.numeration)("characterIcon",o.characterIcon)("ally",o.ally)("flipped",!0)("disableFlip",!o.drawing)("newStyle",o.newStyle)("townGuard",o.townGuard)("bbIndex",o.deck.bb?n%3:-1)}}function K3(i,r){if(1&i&&t.nVh(0,H3,2,17,"div",27),2&i){const e=r.$index,a=t.XpG(2);t.vxM(a.deck.state&&a.current>=0&&a.lastVisible>=0&&e==a.lastVisible?0:-1)}}function W3(i,r){if(1&i&&(t.Z7z(0,q3,1,1,null,null,ya),t.Z7z(2,K3,1,1,null,null,ya)),2&i){const e=t.XpG();t.Dyx(e.deck.cards),t.R7$(2),t.Dyx(e.deck.cards)}}class _t{deck;type;values;constructor(r,e,...a){this.deck=r,this.type=e,this.values=a}}let yn=(()=>{class i{element;dialog;deck;character;ally=!1;numeration="";bottom=!1;before=new t.bkB;after=new t.bkB;menuElement;fullscreen=!0;vertical=!1;townGuard=!1;battleGoals=!0;standalone=!1;edition;initTimeout=1500;gameManager=s.E;settingsManager=m.f;GameState=T.mk;reveal=0;edit=!1;maxHeight="";characterIcon="";AttackModifierType=Y.Yn;type=Y.Yn.minus1;current=-1;lastVisible=0;drawing=!1;drawTimeout=null;queue=0;queueTimeout=null;newStyle=!1;init=!1;disabled=!1;compact=!1;initServer=!1;bbCurrent=0;bbRows=0;activeAMs=[];drawCard;constructor(e,a){this.element=e,this.dialog=a,this.element.nativeElement.addEventListener("pointerdown",n=>{let o=document.elementsFromPoint(n.clientX,n.clientY);o[0].classList.contains("attack-modifiers")&&o.length>2&&o[2].click()})}ngOnInit(){this.character?(this.deck=this.character.attackModifierDeck,this.edition=this.character.edition,this.numeration=""+this.character.number,this.characterIcon=this.character.iconUrl):(this.battleGoals=!1,this.characterIcon=""),this.current=this.deck.current,this.lastVisible=this.deck.lastVisible,this.compact=!this.drawing&&this.fullscreen&&m.f.settings.automaticAttackModifierFullscreen&&m.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400),this.deck.bb&&(this.bbCurrent=Math.ceil((this.deck.current+1)/3),this.bbRows=Math.ceil(this.deck.cards.length/3)),this.init||(this.drawTimeout=setTimeout(()=>{this.current=this.deck.current,this.lastVisible=this.deck.lastVisible,this.drawTimeout=null,this.init=!0},m.f.settings.animations?this.initTimeout*m.f.settings.animationSpeed:0)),this.uiChangeSubscription=s.E.uiChange.subscribe({next:e=>{this.update(e)}}),this.edition&&!this.newStyle&&(this.newStyle=s.E.newAmStyle(this.edition)),m.f.settings.fhStyle&&(this.newStyle=!0),this.disabled=!this.standalone&&(!this.townGuard&&s.E.game.state==T.mk.draw||this.townGuard&&null!=s.E.game.scenario),window.addEventListener("resize",e=>{this.compact=m.f.settings.automaticAttackModifierFullscreen&&m.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)}),window.addEventListener("fullscreenchange",e=>{this.compact=m.f.settings.automaticAttackModifierFullscreen&&m.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}ngOnChanges(e){e.deck&&this.update()}update(e=!1){this.character?(this.deck=this.character.attackModifierDeck,this.edition=this.character.edition,this.numeration=""+this.character.number,this.characterIcon=this.character.iconUrl):(this.battleGoals=!1,this.characterIcon=""),this.disabled=!this.standalone&&(!this.townGuard&&s.E.game.state==T.mk.draw||this.townGuard&&null!=s.E.game.scenario),this.character&&this.deck!=this.character.attackModifierDeck&&(this.deck=this.character.attackModifierDeck),this.initServer&&s.E.stateManager.wsState()!=WebSocket.OPEN&&(this.initServer=!1),this.deck.active?!this.init||e&&!this.initServer?(this.current=this.deck.current,this.lastVisible=this.deck.lastVisible,e&&!this.initServer&&(this.initServer=!0)):this.current<this.deck.current?(this.queue=Math.max(0,this.deck.current-this.current),this.queueTimeout||(this.deck.bb?(this.queue=0,this.current=this.deck.current,this.lastVisible=this.deck.lastVisible,this.drawQueue()):(this.queue--,this.current++,this.lastVisible=this.deck.lastVisible,this.drawQueue()))):(!this.queueTimeout||this.deck.current<this.current+this.queue)&&(this.queueTimeout&&(clearTimeout(this.queueTimeout),this.queueTimeout=null),this.queue=0,this.drawing=!1,this.current=this.deck.current,this.lastVisible=this.deck.lastVisible):(this.queueTimeout&&(clearTimeout(this.queueTimeout),this.queueTimeout=null),this.queue=0,this.drawing=!1,this.current=this.deck.current,this.lastVisible=this.deck.lastVisible,this.initServer=s.E.stateManager.wsState()==WebSocket.OPEN),m.f.settings.fhStyle&&(this.newStyle=!0),this.deck.bb&&(this.bbCurrent=Math.ceil((this.current+1)/3),this.bbRows=Math.ceil(this.deck.cards.length/3)),this.compact=m.f.settings.automaticAttackModifierFullscreen&&m.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400),this.activeAMs=this.deck.cards.filter((a,n)=>a.active&&n<this.deck.lastVisible&&-1==this.deck.discarded.indexOf(n))}drawQueue(){this.drawing=!0,this.element.nativeElement.getElementsByClassName("attack-modifiers")[0].classList.add("drawing"),this.queueTimeout=setTimeout(()=>{this.drawing=!1,this.queueTimeout=null,this.queue>0?(this.queue--,this.current++,this.drawQueue()):(this.element.nativeElement.getElementsByClassName("attack-modifiers")[0].classList.remove("drawing"),this.queue<0&&(this.queue=0))},m.f.settings.animations?1050*m.f.settings.animationSpeed:0)}draw(e,a=void 0){this.compact&&this.fullscreen?this.openFullscreen(e):this.disabled?this.dialog.open(xs,{panelClass:["dialog"],data:{deck:this.deck,character:this.character,ally:this.ally,numeration:this.numeration,newStyle:this.newStyle,townGuard:this.townGuard,before:this.before,after:this.after}}):!this.drawTimeout&&this.deck.current<this.deck.cards.length-(0==this.queue?0:1)?this.drawTimeout=setTimeout(()=>{this.before.emit(new _t(this.deck,"draw"+(a||""))),s.E.attackModifierManager.drawModifier(this.deck,a),this.after.emit(new _t(this.deck,"draw"+(a||""))),this.drawTimeout=null},m.f.settings.animations?150*m.f.settings.animationSpeed:0):!this.drawTimeout&&this.deck.current>=this.deck.cards.length&&(this.before.emit(new _t(this.deck,"shuffle")),s.E.attackModifierManager.shuffleModifiers(this.deck),this.after.emit(new _t(this.deck,"shuffle")))}openFullscreen(e){this.dialog.open(na,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:{deck:this.deck,character:this.character,ally:this.ally,numeration:this.numeration,newStyle:this.newStyle,townGuard:this.townGuard,before:this.before,after:this.after}}),e.preventDefault(),e.stopPropagation()}openBattleGoals(e){this.character&&(this.dialog.open(oa,{panelClass:["dialog"],data:{character:this.character,draw:!this.character.battleGoals||0==this.character.battleGoals.length}}),e.preventDefault(),e.stopPropagation())}clickCard(e,a){(!this.drawing||e>this.current)&&(this.deck.cards[e].active&&-1==this.deck.discarded.indexOf(e)?(this.before.emit(new _t(this.deck,"discard",e)),this.deck.discarded.push(e),this.after.emit(new _t(this.deck,"discard",e))):this.open(a))}open(e){s.E.game.state==T.mk.next&&this.fullscreen&&m.f.settings.automaticAttackModifierFullscreen&&m.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)?this.openFullscreen(e):(this.dialog.open(xs,{panelClass:["dialog"],data:{deck:this.deck,character:this.character,ally:this.ally,numeration:this.numeration,newStyle:this.newStyle,townGuard:this.townGuard,before:this.before,after:this.after}}),e.preventDefault(),e.stopPropagation())}static \u0275fac=function(a){return new(a||i)(t.rXU(t.aKT),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-attackmodifier-deck"]],viewQuery:function(a,n){if(1&a&&(t.GBs(b3,5),t.GBs(k3,5)),2&a){let o;t.mGM(o=t.lsd())&&(n.menuElement=o.first),t.mGM(o=t.lsd())&&(n.drawCard=o.first)}},inputs:{deck:"deck",character:"character",ally:"ally",numeration:"numeration",bottom:"bottom",fullscreen:"fullscreen",vertical:"vertical",townGuard:"townGuard",battleGoals:"battleGoals",standalone:"standalone",edition:"edition",initTimeout:"initTimeout"},outputs:{before:"before",after:"after"},standalone:!1,features:[t.OA$],decls:17,vars:33,consts:[["drawCard",""],[1,"attack-modifiers",3,"ngClass"],[1,"battlegoals-button",3,"ghs-label","ghs-label-attribute"],[1,"am-container","draw",3,"ngClass"],[1,"am",3,"click","ghs-label","ghs-label-attribute","ngClass"],[1,"number",3,"ngClass"],["src","./assets/images/shuffle.svg",1,"shuffle",3,"ghs-label","ghs-label-attribute"],[1,"numeration"],[1,"character-icon"],[1,"fullscreen",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"settings",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"advantage",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"disadvantage",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"battlegoals-button",3,"click","ghs-label","ghs-label-attribute"],[3,"src"],["src","./assets/images/check.svg",1,"check"],[1,"fullscreen",3,"click","ghs-label","ghs-label-attribute","ngClass"],["src","./assets/images/fullscreen.svg",1,"ghs-svg"],[1,"settings",3,"click","ghs-label","ghs-label-attribute","ngClass"],["src","./assets/images/settings.svg",1,"ghs-svg"],[1,"advantage",3,"click","ghs-label","ghs-label-attribute","ngClass"],[1,"disadvantage",3,"click","ghs-label","ghs-label-attribute","ngClass"],[1,"am-container",3,"z-index","ngClass","left","top","ghs-label","ghs-label-attribute"],[1,"am-container",3,"click","ngClass","ghs-label","ghs-label-attribute"],[1,"am",3,"attackModifier","numeration","characterIcon","ally","flipped","disableFlip","newStyle","townGuard","bbIndex"],[1,"am-container","current","animate",3,"z-index","ngClass","ghs-label","ghs-label-attribute"],[1,"am-container","current","animate",3,"click","ngClass","ghs-label","ghs-label-attribute"],[1,"am-container","discarded","animate",3,"z-index","ngClass","ghs-label","ghs-label-attribute"],[1,"am-container","discarded","animate",3,"click","ngClass","ghs-label","ghs-label-attribute"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",1),t.nVh(1,S3,3,4,"div",2),t.j41(2,"div",3,0)(4,"div",4),t.bIt("click",function(_){return t.eBV(o),t.Njj(n.draw(_))}),t.j41(5,"span",5),t.nVh(6,$3,2,1,"span"),t.nVh(7,D3,2,1,"span"),t.k0s(),t.nVh(8,I3,1,2,"img",6),t.nVh(9,A3,2,1,"span",7),t.nVh(10,V3,2,1,"span",8),t.k0s(),t.nVh(11,F3,2,6,"span",9),t.nVh(12,X3,2,7,"span",10),t.nVh(13,B3,2,9,"span",11),t.nVh(14,Y3,2,9,"span",12),t.k0s(),t.nVh(15,L3,2,0),t.nVh(16,W3,4,0),t.k0s()}if(2&a){const o=t.sdS(3);t.Y8G("ngClass",t.sMw(22,y3,!n.standalone&&(!n.townGuard&&n.gameManager.game.state==n.GameState.draw||n.townGuard&&n.gameManager.game.scenario),n.vertical,n.character)),t.R7$(),t.vxM(!n.gameManager.bbRules()&&n.character&&n.battleGoals&&n.gameManager.game.scenario&&n.settingsManager.settings.battleGoals&&n.gameManager.game.round>0&&!n.settingsManager.settings.battleGoalsCharacter?1:-1),t.R7$(),t.xc7("z-index",n.deck.cards.length+1)("font-size",.08*o.offsetWidth+"px"),t.Y8G("ngClass",t.eq3(26,x3,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.attackModifiers&&(!n.character||!n.gameManager.stateManager.characterPermissions[n.character.name+"|"+n.character.edition]))),t.R7$(2),t.Y8G("ghs-label",n.compact&&n.fullscreen?"game.cards.fullscreen":n.deck.current>=n.deck.cards.length-1?"game.cards.shuffle":"game.cards.draw")("ghs-label-attribute","title")("ngClass",t.l_i(28,E3,n.townGuard,n.disabled)),t.R7$(),t.Y8G("ngClass",t.eq3(31,w3,n.deck.current>=n.deck.cards.length+(n.deck.bb?-3:-1))),t.R7$(),t.vxM(n.deck.bb?-1:6),t.R7$(),t.vxM(n.deck.bb?7:-1),t.R7$(),t.vxM(n.deck.current>=n.deck.cards.length+(n.deck.bb?-3:-1)?8:-1),t.R7$(),t.vxM(n.characterIcon||n.townGuard||n.bottom?-1:9),t.R7$(),t.vxM(n.characterIcon&&!n.bottom?10:-1),t.R7$(),t.vxM(n.fullscreen&&!n.compact?11:-1),t.R7$(),t.vxM(!n.compact||n.vertical?12:-1),t.R7$(),t.vxM(!n.deck.bb&&!n.settingsManager.settings.amAdvantage||n.compact&&!n.vertical?-1:13),t.R7$(),t.vxM(!n.deck.bb&&!n.settingsManager.settings.amAdvantage||n.compact&&!n.vertical?-1:14),t.R7$(),t.vxM(n.deck.bb?-1:15),t.R7$(),t.vxM(n.deck.bb?16:-1)}},dependencies:[N.YU,Ln,tt],styles:[".attack-modifiers[_ngcontent-%COMP%]{position:relative;width:100%;height:100%}.attack-modifiers[_ngcontent-%COMP%]   .am-container[_ngcontent-%COMP%]{position:absolute;width:40%;padding-top:26.66%;top:0;left:0;transition:filter calc(var(--ghs-animation-speed) * 1s) ease-in-out}.attack-modifiers[_ngcontent-%COMP%]   .am-container.disabled[_ngcontent-%COMP%]{filter:grayscale(.8)}.attack-modifiers[_ngcontent-%COMP%]   .am-container[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]{position:absolute;inset:0;cursor:pointer;display:block}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]{cursor:pointer;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-back.e947b7717f678f92.png);border-radius:5%;transition:filter calc(var(--ghs-animation-speed) * 2s) ease-in-out}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am.town-guard[_ngcontent-%COMP%]{background-image:url(back.86db9c801336d036.png)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am.disabled[_ngcontent-%COMP%]{cursor:initial;filter:grayscale(.8)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{display:flex;align-items:center;font-family:var(--ghs-font-text);color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);position:absolute;font-size:2em;line-height:1em;left:50%;bottom:0%;z-index:500;transform:translate(-50%)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .number.has-shuffle[_ngcontent-%COMP%]{top:0;bottom:initial}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .shuffle[_ngcontent-%COMP%]{height:22%;width:auto;position:absolute;right:5%;bottom:5%;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .numeration[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);display:flex;justify-content:center;position:absolute;left:7.5%;top:67%;z-index:2;width:20%;height:30%;color:var(--ghs-color-white);font-size:1.6em;line-height:1.5em;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-character-icon.83c1ab396221d56b.png)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .numeration.character-icon[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .character-icon.character-icon[_ngcontent-%COMP%]{align-items:center}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .numeration.character-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .character-icon.character-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:grayscale(100%) brightness(100) contrast(100%);height:70%;width:auto}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .am.open-dialog[_ngcontent-%COMP%]{cursor:help}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage[_ngcontent-%COMP%]{cursor:pointer;left:-14%;font-family:var(--ghs-font-gh-title);display:flex;justify-content:center;position:absolute;color:var(--ghs-color-white);width:20%;height:30%;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-character-icon.83c1ab396221d56b.png);transition:transform calc(var(--ghs-animation-speed) * .5s) ease-in-out;transform:scale(1.2)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.minimize[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.minimize[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.minimize[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.minimize[_ngcontent-%COMP%]{transform:scale(0)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.vertical[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.vertical[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.vertical[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.vertical[_ngcontent-%COMP%]{left:initial;right:-14%}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.fullscreen[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.fullscreen[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.fullscreen[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.fullscreen[_ngcontent-%COMP%]{cursor:zoom-in;top:-9%}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.settings[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.settings[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.settings[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.settings[_ngcontent-%COMP%]{cursor:help;bottom:-9%}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.settings.without-fullscreen[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.settings.without-fullscreen[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.settings.without-fullscreen[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.settings.without-fullscreen[_ngcontent-%COMP%]{top:50%;bottom:initial;transform:translateY(-50%)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.advantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.disadvantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.advantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.disadvantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.advantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.disadvantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.advantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.disadvantage[_ngcontent-%COMP%]{left:initial;right:0;transition:transform calc(var(--ghs-animation-speed) * .1s) ease-in-out;z-index:499}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.advantage.without-fullscreen[_ngcontent-%COMP%]:not(.vertical), .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.disadvantage.without-fullscreen[_ngcontent-%COMP%]:not(.vertical), .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.advantage.without-fullscreen[_ngcontent-%COMP%]:not(.vertical), .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.disadvantage.without-fullscreen[_ngcontent-%COMP%]:not(.vertical), .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.advantage.without-fullscreen[_ngcontent-%COMP%]:not(.vertical), .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.disadvantage.without-fullscreen[_ngcontent-%COMP%]:not(.vertical), .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.advantage.without-fullscreen[_ngcontent-%COMP%]:not(.vertical), .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.disadvantage.without-fullscreen[_ngcontent-%COMP%]:not(.vertical){left:-14%;right:initial}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.advantage[_ngcontent-%COMP%]:hover, .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.disadvantage[_ngcontent-%COMP%]:hover, .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.advantage[_ngcontent-%COMP%]:hover, .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.disadvantage[_ngcontent-%COMP%]:hover, .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.advantage[_ngcontent-%COMP%]:hover, .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.disadvantage[_ngcontent-%COMP%]:hover, .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.advantage[_ngcontent-%COMP%]:hover, .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.disadvantage[_ngcontent-%COMP%]:hover{transform:scale(1.4)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.advantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.advantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.advantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.advantage[_ngcontent-%COMP%]{top:-9%}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.advantage.has-shuffle[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.advantage.has-shuffle[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.advantage.has-shuffle[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.advantage.has-shuffle[_ngcontent-%COMP%]{transform:scale(.7) translate(50%,-25%);filter:grayscale(.8)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.disadvantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.disadvantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.disadvantage[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.disadvantage[_ngcontent-%COMP%]{bottom:-9%}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.disadvantage.has-shuffle[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.disadvantage.has-shuffle[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage.disadvantage.has-shuffle[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage.disadvantage.has-shuffle[_ngcontent-%COMP%]{transform:scale(.7) translate(50%,25%);filter:grayscale(.8)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:60%;width:auto;align-self:center}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .advantage[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .disadvantage[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.attack-modifiers[_ngcontent-%COMP%]   .draw.denied[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw.denied[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]   *[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw.denied[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw.denied[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]   *[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .draw.denied[_ngcontent-%COMP%]   .am.open-dialig[_ngcontent-%COMP%]{pointer-events:initial}.attack-modifiers[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%]{cursor:pointer;position:absolute;display:flex;align-items:center;z-index:3;width:20%;left:-20%;top:50%;transform:translateY(-50%)}.attack-modifiers[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%]:hover{opacity:.7}.attack-modifiers[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80%;border-radius:5%}.attack-modifiers[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-70%,-50%);width:40%;filter:var(--ghs-filter-green) var(--ghs-filter-outline)}@keyframes _ngcontent-%COMP%_attackmodifier-draw{0%{transform:scale(1) translate(-102%,16.5%)}35%,70%{transform:scale(1.1) translate(-51%,25%)}to{transform:scale(1) translate(0)}}@keyframes _ngcontent-%COMP%_attackmodifier-draw-bottom{0%{transform:scale(1) translate(-102%,-16.5%)}35%,70%{transform:scale(2) translate(-80%,-166.5%)}to{transform:scale(1) translate(0)}}@keyframes _ngcontent-%COMP%_attackmodifier-last{0%{top:0;left:42%;transform:rotate(0)}70%{top:0;left:42%;transform:rotate(0)}to{top:16.5%;left:75%;transform:rotate(25deg)}}@keyframes _ngcontent-%COMP%_attackmodifier-rolling{0%{transform:translate(-61.85%) rotate(25deg)}70%{transform:translate(-61.85%) rotate(25deg)}to{transform:rotate(25deg)}}@keyframes _ngcontent-%COMP%_attackmodifier-active{0%{transform:translate(-61.85%) rotate(-25deg)}70%{transform:translate(-61.85%) rotate(-25deg)}to{transform:rotate(-25deg)}}@keyframes _ngcontent-%COMP%_attackmodifier-active-reverse{0%{transform:translate(61.85%) rotate(-25deg)}70%{transform:translate(61.85%) rotate(-25deg)}to{transform:rotate(-25deg)}}.attack-modifiers[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{position:absolute;top:0;left:42%;z-index:1}.attack-modifiers[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%], .attack-modifiers[_ngcontent-%COMP%]   .last[_ngcontent-%COMP%]{position:absolute;top:16.5%;left:75%;transform:rotate(25deg);z-index:0}.attack-modifiers[_ngcontent-%COMP%]   .discarded.discarded[_ngcontent-%COMP%]:hover, .attack-modifiers[_ngcontent-%COMP%]   .last.discarded[_ngcontent-%COMP%]:hover{z-index:100!important}.attack-modifiers[_ngcontent-%COMP%]   .discarded.active[_ngcontent-%COMP%]:not(.last), .attack-modifiers[_ngcontent-%COMP%]   .last.active[_ngcontent-%COMP%]:not(.last){transform:rotate(-25deg)}.attack-modifiers[_ngcontent-%COMP%]   .discard-active[_ngcontent-%COMP%]{filter:grayscale(.3)}.attack-modifiers[_ngcontent-%COMP%]   .highlight[_ngcontent-%COMP%]{filter:brightness(1)}.attack-modifiers[_ngcontent-%COMP%]   .ignored[_ngcontent-%COMP%]{filter:grayscale(.8) opacity(.8)}.attack-modifiers[_ngcontent-%COMP%]   .ignored[_ngcontent-%COMP%]:hover{filter:none}.attack-modifiers.open-dialog[_ngcontent-%COMP%]{cursor:help}.attack-modifiers[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{filter:grayscale(.8)}.attack-modifiers[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]:hover{transition:filter calc(var(--ghs-animation-speed) * .25s) linear,transform calc(var(--ghs-animation-speed) * .8s) cubic-bezier(.75,0,.85,1),top calc(var(--ghs-animation-speed) * .5s) linear,left calc(var(--ghs-animation-speed) * .5s) linear;filter:grayscale(15%)}.attack-modifiers.drawing[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%], .attack-modifiers.drawing[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%]{cursor:wait!important}.attack-modifiers.drawing[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{cursor:wait!important;animation:_ngcontent-%COMP%_attackmodifier-draw calc(var(--ghs-animation-speed) * 1s) ease-in-out;animation-iteration-count:1}.attack-modifiers.drawing[_ngcontent-%COMP%]   .current.bottom[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_attackmodifier-draw-bottom calc(var(--ghs-animation-speed) * 1s) ease-in-out}.attack-modifiers.drawing[_ngcontent-%COMP%]   .last[_ngcontent-%COMP%]{cursor:wait!important;animation:_ngcontent-%COMP%_attackmodifier-last calc(var(--ghs-animation-speed) * 1s) ease-in-out;animation-iteration-count:1}.attack-modifiers.drawing[_ngcontent-%COMP%]   .animate.rolling[_ngcontent-%COMP%]{cursor:wait!important;animation:_ngcontent-%COMP%_attackmodifier-rolling calc(var(--ghs-animation-speed) * 1s) ease-in-out;animation-iteration-count:1}.attack-modifiers.drawing[_ngcontent-%COMP%]   .animate.active[_ngcontent-%COMP%]{cursor:wait!important;animation:_ngcontent-%COMP%_attackmodifier-active calc(var(--ghs-animation-speed) * 1s) ease-in-out;animation-iteration-count:1}.attack-modifiers.drawing[_ngcontent-%COMP%]   .animate-reverse.active[_ngcontent-%COMP%]{cursor:wait!important;animation:_ngcontent-%COMP%_attackmodifier-active-reverse calc(var(--ghs-animation-speed) * 1s) ease-in-out;animation-iteration-count:1}.vertical[_ngcontent-%COMP%]   .am-container[_ngcontent-%COMP%]{top:0;left:0;width:60%;padding-top:40%}.vertical[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{top:0;position:absolute;transform:translateY(120%);z-index:1}.vertical[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%], .vertical[_ngcontent-%COMP%]   .last[_ngcontent-%COMP%]{position:absolute;top:0;left:45%;transform:translateY(140%) rotate(25deg);z-index:0}.vertical[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%]{width:27%;left:72%;top:12%}@keyframes _ngcontent-%COMP%_attackmodifier-draw-vertical{0%{transform:scale(1)}35%,70%{transform:scale(1.1) translate(15%,125%)}to{transform:scale(1) translateY(120%)}}@keyframes _ngcontent-%COMP%_attackmodifier-last-vertical{0%{left:0;transform:translateY(120%) rotate(0)}70%{left:0;transform:translateY(120%) rotate(0)}to{left:45%;transform:translateY(140%) rotate(25deg)}}.vertical.drawing[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_attackmodifier-draw-vertical calc(var(--ghs-animation-speed) * 1s) ease-in-out}.vertical.drawing[_ngcontent-%COMP%]   .last[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_attackmodifier-last-vertical calc(var(--ghs-animation-speed) * 1s) ease-in-out}"]})}return i})();const J3=["drawCard"],Z3=i=>({character:i}),Q3=(i,r)=>r.id+i;function t4(i,r){if(1&i&&(t.j41(0,"div",1),t.nrm(1,"ghs-attackmodifier",2),t.k0s()),2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG();t.R7$(),t.Y8G("attackModifier",a)("numeration",o.numeration)("characterIcon",o.characterIcon)("flipped",n==o.current)("newStyle",o.newStyle)}}function e4(i,r){if(1&i&&t.nVh(0,t4,2,5,"div",1),2&i){const e=r.$index,a=t.XpG();t.vxM(e==a.current?0:-1)}}let n4=(()=>{class i{element;character;drawingEmitter=new t.bkB;initTimeout=1500;gameManager=s.E;settingsManager=m.f;deck;numeration="";characterIcon="";AttackModifierType=Y.Yn;current=-1;drawing=!1;drawTimeout=null;queue=0;queueTimeout=null;newStyle=!1;drawCard;constructor(e){this.element=e,this.element.nativeElement.addEventListener("pointerdown",a=>{let n=document.elementsFromPoint(a.clientX,a.clientY);n[0].classList.contains("attack-modifiers")&&n.length>2&&n[2].click()})}ngOnInit(){this.character&&(this.deck=this.character.attackModifierDeck,this.characterIcon=this.character.iconUrl,this.numeration=""+this.character.number,this.newStyle=s.E.newAmStyle(this.character.edition)),m.f.settings.fhStyle&&(this.newStyle=!0),this.current=this.deck.current,this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}ngOnChanges(e){e.deck&&this.update()}update(){this.character&&this.deck!=this.character.attackModifierDeck&&(this.deck=this.character.attackModifierDeck),this.current<this.deck.current?(this.queue=Math.max(0,this.deck.current-this.current),this.queueTimeout||(this.queue--,this.current++,this.drawQueue())):(!this.queueTimeout||this.deck.current<this.current+this.queue)&&(this.queueTimeout&&(clearTimeout(this.queueTimeout),this.queueTimeout=null),this.queue=0,this.drawing=!1,this.drawingEmitter.emit(!1),this.current=this.deck.current)}drawQueue(){this.drawing=!0,this.drawingEmitter.emit(!0),this.element.nativeElement.getElementsByClassName("attack-modifier-draw")[0].classList.add("drawing"),this.queueTimeout=setTimeout(()=>{this.drawing=!1,this.drawingEmitter.emit(!1),this.queueTimeout=null,this.queue>0?(this.queue--,this.current++,this.drawQueue()):(this.element.nativeElement.getElementsByClassName("attack-modifier-draw")[0].classList.remove("drawing"),this.queue<0&&(this.queue=0))},m.f.settings.animations?2500*m.f.settings.animationSpeed:0)}static \u0275fac=function(a){return new(a||i)(t.rXU(t.aKT))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-attackmodifier-draw"]],viewQuery:function(a,n){if(1&a&&t.GBs(J3,5),2&a){let o;t.mGM(o=t.lsd())&&(n.drawCard=o.first)}},inputs:{character:"character",initTimeout:"initTimeout"},outputs:{drawingEmitter:"drawing"},standalone:!1,features:[t.OA$],decls:3,vars:3,consts:[[1,"attack-modifier-draw",3,"ngClass"],[1,"am-container"],[1,"am",3,"attackModifier","numeration","characterIcon","flipped","newStyle"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.Z7z(1,e4,1,1,null,null,Q3),t.k0s()),2&a&&(t.Y8G("ngClass",t.eq3(1,Z3,n.character)),t.R7$(),t.Dyx(n.deck.cards))},dependencies:[N.YU,Ln],styles:[".attack-modifier-draw[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;overflow:visible}.attack-modifier-draw[_ngcontent-%COMP%]   .am-container[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;transition:filter calc(var(--ghs-animation-speed) * 1s) ease-in-out;transform:scale(0)}.attack-modifier-draw[_ngcontent-%COMP%]   .am-container[_ngcontent-%COMP%]   .am[_ngcontent-%COMP%]{display:block;position:absolute;inset:0}@keyframes _ngcontent-%COMP%_attackmodifier-draw{0%{transform:scale(0) translate(-152%,-16.5%)}35%,70%{transform:scale(1) translate(-50%,-50%)}to{transform:scale(0) translate(0)}}.attack-modifier-draw.drawing[_ngcontent-%COMP%]   .am-container[_ngcontent-%COMP%]{cursor:wait!important;animation:_ngcontent-%COMP%_attackmodifier-draw calc(var(--ghs-animation-speed) * 2.5s) ease-in-out;animation-iteration-count:1;transform-origin:top left}"]})}return i})();const i4=i=>({critical:i});let Rs=(()=>{class i{entity;diff=0;maxHealth(){return(0,$.hZ)(this.entity.maxHealth)}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-healthbar"]],inputs:{entity:"entity",diff:"diff"},standalone:!1,decls:2,vars:5,consts:[[1,"health-bar",3,"ngClass"],[1,"health-bar-value"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nrm(1,"div",1),t.k0s()),2&a&&(t.Y8G("ngClass",t.eq3(3,i4,(n.entity.health+n.diff)/n.maxHealth()<.35)),t.R7$(),t.xc7("width",(n.entity.health+n.diff)/n.maxHealth()*100+"%"))},dependencies:[N.YU],styles:[".health-bar[_ngcontent-%COMP%]{width:100%;height:100%;border:none;background-color:transparent}.health-bar[_ngcontent-%COMP%]   .health-bar-value[_ngcontent-%COMP%]{height:100%;max-width:1000%;transition:width calc(var(--ghs-animation-speed) * .5s);background-color:var(--ghs-color-lightgreen)}.health-bar.critical[_ngcontent-%COMP%]   .health-bar-value[_ngcontent-%COMP%]{background-color:var(--ghs-color-red)}"]})}return i})();const a4=(i,r,e,a,n)=>({"active-border":i,disabled:r,off:e,"no-artwork":a,modern:n});let js=(()=>{class i{character;characterManager=s.E.characterManager;gameManager=s.E;settingsManager=m.f;GameState=T.mk;static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-character-image"]],inputs:{character:"character"},standalone:!1,decls:3,vars:13,consts:[[1,"image-container",3,"ngClass","ghs-label","ghs-label-attribute"],[1,"image",3,"src"],[3,"entity"]],template:function(a,n){1&a&&(t.j41(0,"a",0),t.nrm(1,"img",1)(2,"ghs-healthbar",2),t.k0s()),2&a&&(t.xc7("--ghs-character-color",n.character.color),t.Y8G("ngClass",t.s1E(7,a4,n.character.active,n.character.absent,n.character.off||n.character.exhausted||n.character.health<=0,n.character.noThumbnail||!n.settingsManager.settings.artwork,"modern"==n.settingsManager.settings.theme))("ghs-label",n.gameManager.game.state==n.GameState.next?n.character.active?"game.figure.endTurn":"game.figure.startTurn":"game.figure.setInitiative")("ghs-label-attribute","title"),t.R7$(),t.Y8G("src",n.character.noThumbnail||!n.settingsManager.settings.artwork?n.character.iconUrl:n.characterManager.characterThumbnail(n.character),t.B4B),t.R7$(),t.Y8G("entity",n.character))},dependencies:[N.YU,tt,Rs],styles:[".image-container[_ngcontent-%COMP%]{position:relative;display:block;width:100%;height:100%;cursor:pointer;border-radius:calc(var(--ghs-unit) * 1);overflow:hidden;transition:box-shadow calc(var(--ghs-animation-speed) * .1s) ease-in-out}.image-container.disabled[_ngcontent-%COMP%]{pointer-events:none}.image-container[_ngcontent-%COMP%]:not(.active-border){border:calc(var(--ghs-unit) * .01) solid transparent;box-shadow:0 0 calc(var(--ghs-unit) * .5) calc(var(--ghs-unit) * .1) var(--ghs-color-darkgray)}.image-container.no-artwork[_ngcontent-%COMP%]{background-color:var(--ghs-color-darkgray);border-color:var(--ghs-character-color)}.image-container[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:auto;height:100%}.image-container[_ngcontent-%COMP%]   ghs-healthbar[_ngcontent-%COMP%]{position:absolute;bottom:0;width:100%;height:5%;left:0}.image-container.off[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{filter:grayscale(.7)}.image-container.modern[_ngcontent-%COMP%]{border-radius:0;-webkit-mask:url(char-image-mask.be960a101527d144.png);mask:url(char-image-mask.be960a101527d144.png);-webkit-mask-size:100% 100%;mask-size:100% 100%}.image-container.modern.active-border[_ngcontent-%COMP%]{border:none!important;box-shadow:none}.number-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,calc(var(--ghs-unit) * 8))}.number-container[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7);width:calc(var(--ghs-unit) * 7);font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3);color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7);width:calc(var(--ghs-unit) * 7);cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3);color:var(--ghs-color-gray);text-shadow:var(--ghs-outline)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}"]})}return i})();const o4=["initiativeInput"],s4=i=>({empty:i}),r4=i=>({hidden:i});function c4(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",6),t.bIt("click",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.enableReveal(n))}),t.EFF(1,"??"),t.k0s()}}function l4(i,r){if(1&i){const e=t.RV6();t.j41(0,"img",7),t.bIt("click",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.longRestOff(n))}),t.k0s()}2&i&&t.Y8G("ghs-label","game.figure.longRestOff")("ghs-label-attribute","title")}let xa=(()=>{class i{dialog;overlay;elementRef;figure;initiativeInput;characterManager=s.E.characterManager;gameManager=s.E;settingsManager=m.f;GameState=T.mk;character;objectiveContainer;reveal=0;constructor(e,a,n){this.dialog=e,this.overlay=a,this.elementRef=n}ngOnInit(){this.figure instanceof q.K?this.character=this.figure:this.figure instanceof mt.$e&&(this.objectiveContainer=this.figure)}ngAfterViewInit(){this.initiativeInput&&this.initiativeInput.nativeElement.addEventListener("keydown",e=>{if(m.f.settings.keyboardShortcuts){const a=this.tabindex();if("Tab"!==e.key&&"Enter"!==e.key||s.E.game.state!=T.mk.draw){if("Escape"===e.key){const n=document.getElementById("initiative-input-"+a);n&&document.activeElement==n&&(n.blur(),e.preventDefault(),e.stopPropagation())}else if(!e.ctrlKey&&!e.shiftKey&&"n"===e.key.toLowerCase()){const n=document.getElementById("initiative-input-"+a);n&&document.activeElement==n&&n.blur()}}else{let n=e.shiftKey?a-1:a+1,o=document.getElementById("initiative-input-"+n);if(!o&&a>0)o=document.getElementById("initiative-input-0");else if(n<0)for(n=s.E.game.figures.filter(g=>g instanceof q.K&&!g.absent&&(g.initiativeVisible||!g.initiative)).length-1,o=document.getElementById("initiative-input-"+n);!o&&n>0;)n--,o=document.getElementById("initiative-input-"+n);o&&o.focus(),e.preventDefault(),e.stopPropagation()}}})}initiativeHidden(){return s.E.game.state==T.mk.draw&&this.figure instanceof q.K&&!this.figure.initiativeVisible}updateInitiative(e){this.reveal&&this.disableReveal();const a=isNaN(+e.target.value)?0:+e.target.value;((s.E.game.state==T.mk.draw||!m.f.settings.initiativeRequired)&&a>=0||a>0)&&a<100?this.setInitiative(a):e.target.value=(this.figure.initiative<10?"0":"")+this.figure.initiative}enableReveal(e){this.initiativeInput&&(this.reveal=this.figure.initiative,this.figure.initiative=0,setTimeout(()=>{this.initiativeInput.nativeElement.focus()},1),e.preventDefault(),e.stopPropagation())}disableReveal(){this.reveal&&(this.figure.initiative=this.reveal,this.reveal=0)}setInitiative(e){((s.E.game.state==T.mk.draw||!m.f.settings.initiativeRequired)&&e>=0||e>0)&&e<100&&e!=this.figure.initiative&&(this.character&&(s.E.stateManager.before("setInitiative",s.E.characterManager.characterName(this.character),""+e),this.character.initiativeVisible=!0,("prism"!=this.character.name||-1==this.character.tags.indexOf("long_rest"))&&(this.character.longRest=!1),99==e&&(this.character.longRest=!0)),this.figure.initiative=e,s.E.game.state==T.mk.next&&s.E.sortFigures(this.character),s.E.stateManager.after())}longRestOff(e){this.character&&this.character.longRest&&(s.E.stateManager.before("characterLongRestOff",s.E.characterManager.characterName(this.character)),this.character.longRest=!1,s.E.game.state==T.mk.next&&s.E.sortFigures(this.character),s.E.stateManager.after(),e.preventDefault())}open(e){this.dialog.open(ma,{panelClass:["dialog"],data:this.figure,positionStrategy:this.overlay.position().flexibleConnectedTo(this.elementRef).withPositions((0,V.yE)())})}tabindex(){return s.E.game.figures.filter(e=>e instanceof q.K&&!e.absent&&!e.exhausted&&(e.initiativeVisible||!e.initiative)).indexOf(this.figure)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG),t.rXU(zt.hJ),t.rXU(t.aKT))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-character-initiative"]],viewQuery:function(a,n){if(1&a&&t.GBs(o4,5),2&a){let o;t.mGM(o=t.lsd())&&(n.initiativeInput=o.first)}},inputs:{figure:"figure"},standalone:!1,decls:6,vars:13,consts:[["initiativeInput",""],[1,"initiative",3,"ngClass","ghs-label","ghs-label-attribute"],["src","./assets/images/initiative.svg",1,"ghs-svg",3,"click"],["type","number","max","99","maxlength","2",3,"change","focus","blur","ngClass","value","min","id"],[1,"hidden-initiative"],["src","./assets/images/long-rest.svg",1,"ghs-svg","long-rest",3,"ghs-label","ghs-label-attribute"],[1,"hidden-initiative",3,"click"],["src","./assets/images/long-rest.svg",1,"ghs-svg","long-rest",3,"click","ghs-label","ghs-label-attribute"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",1)(1,"img",2),t.bIt("click",function(_){return t.eBV(o),t.Njj(n.open(_))}),t.k0s(),t.j41(2,"input",3,0),t.bIt("change",function(_){return t.eBV(o),t.Njj(n.updateInitiative(_))})("focus",function(){t.eBV(o);const _=t.sdS(3);return t.Njj(_.select())})("blur",function(){return t.eBV(o),t.Njj(n.disableReveal())}),t.k0s(),t.nVh(4,c4,2,0,"span",4),t.nVh(5,l4,1,2,"img",5),t.k0s()}2&a&&(t.Y8G("ngClass",t.eq3(9,s4,n.figure.initiative<=0&&(!n.settingsManager.settings.initiativeRequired||n.character&&n.character.exhausted)))("ghs-label","game.figure.setInitiative")("ghs-label-attribute","title"),t.R7$(2),t.Y8G("ngClass",t.eq3(11,r4,n.figure.initiative>0&&n.initiativeHidden()&&!n.reveal))("value",n.figure.initiative>0&&(n.figure.initiative<10&&n.figure.initiative>0?"0"+n.figure.initiative:n.figure.initiative)||"")("min",n.gameManager.game.state==n.GameState.draw?0:1)("id","initiative-input-"+n.tabindex()),t.R7$(2),t.vxM(n.figure.initiative>0&&n.initiativeHidden()&&!n.reveal?4:-1),t.R7$(),t.vxM(n.character&&!n.initiativeHidden()&&n.character.longRest?5:-1))},dependencies:[N.YU,tt],styles:[".initiative[_ngcontent-%COMP%]{position:relative;display:flex;height:100%;flex-direction:column;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline);transition:width calc(var(--ghs-animation-speed) * .5s) ease-in-out;width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor))}.initiative[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{cursor:pointer;width:calc(var(--ghs-unit) * 2.7 * var(--ghs-text-factor));height:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.initiative[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.initiative[_ngcontent-%COMP%]   img.long-rest[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));position:absolute;bottom:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.initiative[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:pointer;text-align:center;border:none;background:none;width:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 6.5 * var(--ghs-text-factor));margin-top:calc(var(--ghs-unit) * -.7 * var(--ghs-text-factor));padding:0;font-family:var(--ghs-font-title);color:var(--ghs-color-white);text-shadow:var(--ghs-outline);font-size:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor));-moz-appearance:textfield}.initiative[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-outer-spin-button, .initiative[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.initiative[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .initiative[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus-visible, .initiative[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active, .initiative[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover{border:none;outline:none!important}.initiative[_ngcontent-%COMP%]   input.hidden[_ngcontent-%COMP%]{display:none}.initiative[_ngcontent-%COMP%]   .hidden-initiative[_ngcontent-%COMP%]{display:block;text-align:center;margin-top:calc(var(--ghs-unit) * -.7 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 6.5 * var(--ghs-text-factor))}.initiative.empty[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor))}.initiative.empty[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .initiative.empty[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{visibility:hidden;opacity:0;transition:opacity calc(var(--ghs-animation-speed) * .5s) ease-in-out}.initiative.empty[_ngcontent-%COMP%]:hover{width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor))}.initiative.empty[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%], .initiative.empty[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%]{visibility:visible;opacity:1}"]})}return i})();const g4=(i,r)=>({active:i,disabled:r}),d4=i=>({active:i}),Gs=i=>({disabled:i}),h4=i=>({spent:i}),_4=(i,r)=>r.edition+"-"+r.id;function m4(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",10),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openShop())}),t.nrm(1,"img",11)(2,"span",12),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("src",e.settingsManager.settings.fhStyle?"./assets/images/fh/items/item-back-fh.png":"./assets/images/items/item-back.png",t.B4B),t.R7$(),t.Y8G("ghs-label","game.items.character.empty")}}function p4(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",2),t.nrm(1,"ghs-character-item",13),t.j41(2,"a",14),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.openItemDialog(n))}),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(4,h4,!a.setup&&a.countFlag(e,a.ItemFlags.spent))),t.R7$(),t.Y8G("character",a.character)("item",e)("setup",a.setup)}}let u4=(()=>{class i{dialog;character;gameManager=s.E;settingsManager=m.f;setup=!1;items=[];ItemFlags=bt.Tr;GameState=T.mk;constructor(e){this.dialog=e}ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.setup=s.E.game.state==T.mk.draw&&s.E.roundManager.firstRound,this.items=(s.E.bbRules()?s.E.itemManager.getItems("bb"):this.character.progress.items.map(e=>s.E.itemManager.getItem(e.name,e.edition,!0))).filter(e=>e&&(this.setup||!m.f.settings.characterItemsPermanentEquipped||this.equipped(e))).map(e=>e).sort((e,a)=>this.sortItems(e,a))}sortItems(e,a){if(!m.f.settings.characterItemsPermanentSorted)return 0;if(!this.setup){if(this.equipped(e)&&!this.equipped(a))return-1;if(this.equipped(a)&&!this.equipped(e)||this.countFlag(e,bt.Tr.consumed)&&!this.countFlag(a,bt.Tr.consumed))return 1;if(this.countFlag(a,bt.Tr.consumed)&&!this.countFlag(e,bt.Tr.consumed))return-1}return e.slot&&!a.slot?-1:a.slot&&!e.slot?1:e.slot&&a.slot?Object.values(bt.o8).indexOf(e.slot)-Object.values(bt.o8).indexOf(a.slot):0}equipped(e){return this.character.progress.equippedItems.find(a=>a.name==""+e.id&&a.edition==e.edition)}countFlag(e,a){const n=this.equipped(e);return n&&n.tags&&n.tags.filter(o=>o==a).length||0}toggleEquipped(){m.f.settings.characterItemsPermanentEquipped=!m.f.settings.characterItemsPermanentEquipped,m.f.storeSettings()}toggleSorted(){m.f.settings.characterItemsPermanentSorted=!m.f.settings.characterItemsPermanentSorted,m.f.storeSettings()}zoom(e){m.f.settings.characterItemsPermanentZoom+=e,m.f.settings.characterItemsPermanentZoom<.5?m.f.settings.characterItemsPermanentZoom=.5:m.f.settings.characterItemsPermanentZoom>1.5&&(m.f.settings.characterItemsPermanentZoom=1.5),m.f.storeSettings(),m.f.settings.animations&&setTimeout(()=>{s.E.uiChange.emit()},500*m.f.settings.animationSpeed)}resetZoom(){m.f.settings.characterItemsPermanentZoom=1,m.f.storeSettings(),m.f.settings.animations&&setTimeout(()=>{s.E.uiChange.emit()},500*m.f.settings.animationSpeed)}openShop(){this.dialog.open(Bn,{panelClass:["dialog"],data:{edition:s.E.game.edition,select:this.character,affordable:!0}})}openItemDialog(e){this.dialog.open(Me,{panelClass:["fullscreen-panel"],disableClose:!0,data:{item:e,character:this.character,setup:this.setup}})}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-character-item-list"]],inputs:{character:"character"},standalone:!1,decls:13,vars:22,consts:[[1,"item-list"],[1,"empty"],[1,"item-container",3,"ngClass"],[1,"menu"],[3,"click","ngClass","ghs-tooltip","overlayX","overlayY"],["src","./assets/images/check.svg",1,"toggle","ghs-svg"],["src","./assets/images/sort.svg",1,"toggle","ghs-svg"],["ghs-pointer-input","",3,"singleClick","doubleClick","ngClass"],["src","./assets/images/zoom-in.svg",1,"ghs-svg"],["src","./assets/images/zoom-out.svg",1,"ghs-svg"],[1,"empty",3,"click"],[3,"src"],[1,"text",3,"ghs-label"],[3,"character","item","setup"],[1,"open-dialog",3,"click"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nVh(1,m4,3,2,"div",1),t.Z7z(2,p4,3,6,"div",2,_4),t.j41(4,"div",3)(5,"a",4),t.bIt("click",function(){return n.toggleEquipped()}),t.nrm(6,"img",5),t.k0s(),t.j41(7,"a",4),t.bIt("click",function(){return n.toggleSorted()}),t.nrm(8,"img",6),t.k0s(),t.j41(9,"a",7),t.bIt("singleClick",function(){return n.zoom(.075)})("doubleClick",function(){return n.resetZoom()}),t.nrm(10,"img",8),t.k0s(),t.j41(11,"a",7),t.bIt("singleClick",function(){return n.zoom(-.075)})("doubleClick",function(){return n.resetZoom()}),t.nrm(12,"img",9),t.k0s()()()),2&a&&(t.xc7("--ghs-item-list-zoom",n.settingsManager.settings.characterItemsPermanentZoom),t.R7$(),t.vxM(0==n.items.length?1:-1),t.R7$(),t.Dyx(n.items),t.R7$(3),t.Y8G("ngClass",t.l_i(13,g4,n.settingsManager.settings.characterItemsPermanentEquipped,n.setup))("ghs-tooltip","game.items.character.toggleEquipped")("overlayX","end")("overlayY","bottom"),t.R7$(2),t.Y8G("ngClass",t.eq3(16,d4,n.settingsManager.settings.characterItemsPermanentSorted))("ghs-tooltip","game.items.character.toggleSorted")("overlayX","end")("overlayY","bottom"),t.R7$(2),t.Y8G("ngClass",t.eq3(18,Gs,n.settingsManager.settings.characterItemsPermanentZoom>=1.5)),t.R7$(2),t.Y8G("ngClass",t.eq3(20,Gs,n.settingsManager.settings.characterItemsPermanentZoom<=.5)))},dependencies:[N.YU,la,tt,ft,rt],styles:[".item-list[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;flex-wrap:wrap;padding-right:calc(var(--ghs-unit) * 4.5);--ghs-item-list-zoom: 1;min-height:calc(var(--ghs-unit) * 18 * var(--ghs-item-list-zoom))}.item-list[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;justify-content:center;align-items:center;margin:calc(var(--ghs-unit) * .5);margin-bottom:0;width:calc(var(--ghs-unit) * 12 * var(--ghs-item-list-zoom));height:calc(var(--ghs-unit) * 18 * var(--ghs-item-list-zoom));border-radius:calc(var(--ghs-unit) * 1 * var(--ghs-item-list-zoom));overflow:hidden}.item-list[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;filter:grayscale(.7)}.item-list[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{text-align:center;font-size:calc(var(--ghs-unit) * 2.6 * var(--ghs-item-list-zoom));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.item-list[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]:hover{opacity:.7}.item-list[_ngcontent-%COMP%]   .item-container[_ngcontent-%COMP%]{position:relative;margin:calc(var(--ghs-unit) * .5);margin-bottom:0;width:calc(var(--ghs-unit) * 12 * var(--ghs-item-list-zoom));height:calc(var(--ghs-unit) * 18 * var(--ghs-item-list-zoom));transition:all calc(var(--ghs-animation-speed) * .5s) ease-in-out}.item-list[_ngcontent-%COMP%]   .item-container.spent[_ngcontent-%COMP%]{transform:rotate(90deg);transform-origin:center center;margin:0 calc(var(--ghs-unit) * 3 * var(--ghs-item-list-zoom));margin-bottom:0}.item-list[_ngcontent-%COMP%]   .item-container[_ngcontent-%COMP%]   ghs-character-item[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}.item-list[_ngcontent-%COMP%]   .item-container[_ngcontent-%COMP%]   .open-dialog[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:0;left:0;width:100%;height:45%}.item-list[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;right:0;z-index:2;display:flex;flex-direction:column;flex-wrap:wrap-reverse;justify-content:flex-start;align-items:flex-end;margin-top:calc(var(--ghs-unit) * 1)}.item-list[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;margin:0 calc(var(--ghs-unit) * 1);color:var(--ghs-color-darkgray)}.item-list[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.5);height:calc(var(--ghs-unit) * 2.5);filter:var(--ghs-filter-darkgray)}.item-list[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ghs-svg.toggle[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-outline)}.item-list[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]{filter:var(--ghs-filter-green) var(--ghs-filter-outline)}.item-list[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}.item-list[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.7}.item-list[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}.item-list[_ngcontent-%COMP%]   .zoom-bar[_ngcontent-%COMP%]{z-index:1;position:absolute;display:block;height:calc(var(--ghs-unit) * 8 * var(--ghs-item-list-zoom));top:0;left:0;right:0}"]})}return i})(),xi=(()=>{class i{el;entityAnimation;constructor(e){this.el=e}ngOnChanges(e){if(e&&e.entityAnimation){const a=e.entityAnimation;a.currentValue!=a.previousValue&&(a.currentValue?(this.el.nativeElement.classList.add("entity-dead"),setTimeout(()=>{this.el.nativeElement.classList.remove("entity-dead"),s.E.uiChange.emit()},m.f.settings.animations?1500*m.f.settings.animationSpeed:0)):a.currentValue||(this.el.nativeElement.classList.add("entity-alive"),setTimeout(()=>{this.el.nativeElement.classList.remove("entity-alive"),s.E.uiChange.emit()},m.f.settings.animations?1500*m.f.settings.animationSpeed:0)))}}static \u0275fac=function(a){return new(a||i)(t.rXU(t.aKT))};static \u0275dir=t.FsC({type:i,selectors:[["","entityAnimation",""]],inputs:{entityAnimation:"entityAnimation"},standalone:!1,features:[t.OA$]})}return i})();function f4(i,r){1&i&&(t.j41(0,"a"),t.nrm(1,"img",1),t.k0s())}const C4=()=>[];function M4(i,r){if(1&i&&(t.j41(0,"div",2)(1,"span",3),t.nrm(2,"span",4),t.k0s(),t.nrm(3,"span",5),t.k0s()),2&i){const e=r.$implicit;t.R7$(2),t.Y8G("ghs-label","game.figure.error."+e.type),t.R7$(),t.Y8G("ghs-label","game.figure.error."+e.type+".hint")("ghs-label-args",e.args)("ghs-label-args-replace",!1)}}let Ts=(()=>{class i{dialog;figure;constructor(e){this.dialog=e}ngOnInit(){this.figure.errors||(this.figure.errors=[])}open(e){this.dialog.open(v4,{panelClass:["dialog"],data:this.figure})}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-figure-errors"]],inputs:{figure:"figure"},standalone:!1,decls:2,vars:3,consts:[[1,"button",3,"click"],["src","./assets/images/warning.svg",1,"ghs-svg"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.bIt("click",function(g){return n.open(g)}),t.nVh(1,f4,2,0,"a"),t.k0s()),2&a&&(t.xc7("display",n.figure.errors&&n.figure.errors.length>0?"":"none"),t.R7$(),t.vxM(n.figure.errors&&n.figure.errors.length>0?1:-1))},styles:[".button[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));display:flex;width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));filter:var(--ghs-filter-yellow) var(--ghs-filter-shadow)}.button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}"]})}return i})(),v4=(()=>{class i{figure;constructor(e){this.figure=e}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-figure-errors-dialog"]],standalone:!1,decls:4,vars:1,consts:[[1,"figure-errors-dialog"],[1,"figure-errors"],[1,"figure-error"],[1,"error"],[3,"ghs-label"],[1,"hint",3,"ghs-label","ghs-label-args","ghs-label-args-replace"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.Z7z(2,M4,4,4,"div",2,t.fX1),t.k0s()()),2&a&&(t.R7$(2),t.Dyx(n.figure.errors||t.lJ4(0,C4)))},dependencies:[tt],styles:[".figure-errors[_ngcontent-%COMP%]{display:flex;flex-direction:column;text-align:center}.figure-errors[_ngcontent-%COMP%]   .figure-error[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) 0}.figure-errors[_ngcontent-%COMP%]   .figure-error[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-red)}.figure-errors[_ngcontent-%COMP%]   .figure-error[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}"]})}return i})();const O4=(i,r)=>({apply:i,double:r}),P4=(i,r)=>r.name+r.value;function b4(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",8),t.bIt("singleClick",function(n){t.eBV(e);const o=t.XpG().$implicit,g=t.XpG(2);return t.Njj(g.declineApplyCondition(o.name,n))}),t.nrm(1,"img",9),t.k0s()}if(2&i){const e=t.XpG().$implicit;t.Y8G("conditionHighlight",e)}}function k4(i,r){if(1&i&&(t.j41(0,"span",5),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.value)}}function y4(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",10),t.bIt("singleClick",function(n){t.eBV(e);const o=t.XpG().$implicit,g=t.XpG(2);return t.Njj(g.applyCondition(o.name,n,!0))}),t.nrm(1,"img",4),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.Y8G("conditionHighlight",e),t.R7$(),t.Y8G("src","./assets/images"+(a.settingsManager.settings.fhStyle?"/fh":"")+"/attackmodifier/icons/double.png",t.B4B)}}function x4(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",11),t.bIt("singleClick",function(n){t.eBV(e);const o=t.XpG().$implicit,g=t.XpG(2);return t.Njj(g.applyCondition(o.name,n))}),t.nrm(1,"img",12),t.k0s()}if(2&i){const e=t.XpG().$implicit;t.Y8G("conditionHighlight",e)}}function E4(i,r){if(1&i&&(t.j41(0,"span",1),t.nVh(1,b4,2,1,"a",2),t.j41(2,"span",3),t.nrm(3,"img",4),t.nVh(4,k4,2,1,"span",5),t.k0s(),t.nVh(5,y4,2,2,"a",6),t.nVh(6,x4,2,1,"a",7),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("conditionHighlight",e)("ngClass",t.l_i(7,O4,a.settingsManager.settings.applyConditions&&a.settingsManager.settings.activeApplyConditions&&!e.expired&&-1==a.settingsManager.settings.activeApplyConditionsExcludes.indexOf(e.name)&&-1!=e.types.indexOf(a.ConditionType.apply),-1!=e.types.indexOf(a.ConditionType.double))),t.R7$(),t.vxM(a.settingsManager.settings.applyConditions&&a.settingsManager.settings.activeApplyConditions&&!e.expired&&-1==a.settingsManager.settings.activeApplyConditionsExcludes.indexOf(e.name)&&-1!=e.types.indexOf(a.ConditionType.apply)?1:-1),t.R7$(2),t.Y8G("src","./assets/images"+(a.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+e.name+".svg",t.B4B),t.R7$(),t.vxM(-1!=e.types.indexOf(a.ConditionType.value)?4:-1),t.R7$(),t.vxM(a.settingsManager.settings.applyConditions&&a.settingsManager.settings.activeApplyConditions&&!e.expired&&-1==a.settingsManager.settings.activeApplyConditionsExcludes.indexOf(e.name)&&-1!=e.types.indexOf(a.ConditionType.apply)&&-1!=e.types.indexOf(a.ConditionType.double)?5:-1),t.R7$(),t.vxM(a.settingsManager.settings.applyConditions&&a.settingsManager.settings.activeApplyConditions&&!e.expired&&-1==a.settingsManager.settings.activeApplyConditionsExcludes.indexOf(e.name)&&-1!=e.types.indexOf(a.ConditionType.apply)?6:-1)}}function w4(i,r){if(1&i&&(t.j41(0,"div",0),t.Z7z(1,E4,7,10,"span",1,P4),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.highlightedConditions)}}let Ei=(()=>{class i{entity;figure;gameManager=s.E;settingsManager=m.f;ConditionType=j.GV;highlightedConditions=[];ngOnInit(){this.update(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.highlightedConditions=s.E.entityManager.highlightedConditions(this.entity)}applyCondition(e,a,n=!1){a.stopPropagation(),s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.figure,"applyCondition"),e),s.E.entityManager.applyCondition(this.entity,this.figure,e),n&&s.E.entityManager.applyCondition(this.entity,this.figure,e),this.after()}declineApplyCondition(e,a){a.stopPropagation(),s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.figure,"declineApplyCondition"),e),s.E.entityManager.declineApplyCondition(this.entity,this.figure,e),this.after()}after(){s.E.entityManager.checkHealth(this.entity,this.figure),this.figure instanceof P.R&&this.entity instanceof Rt.I&&this.entity.dead&&(0==this.entity.entityConditions.length||this.entity.entityConditions.every(e=>!e.highlight||-1==e.types.indexOf(j.GV.turn)&&-1==e.types.indexOf(j.GV.apply)))?setTimeout(()=>{this.figure instanceof P.R&&this.entity instanceof Rt.I&&(s.E.monsterManager.removeMonsterEntity(this.figure,this.entity),this.figure.entities.every(e=>!s.E.entityManager.isAlive(e))&&this.figure.active&&s.E.roundManager.toggleFigure(this.figure)),s.E.stateManager.after()},m.f.settings.animations?1500*m.f.settings.animationSpeed:0):s.E.stateManager.after()}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-highlight-conditions"]],inputs:{entity:"entity",figure:"figure"},standalone:!1,decls:1,vars:1,consts:[[1,"highlight-conditions"],[1,"condition",3,"conditionHighlight","ngClass"],["ghs-pointer-input","",1,"close",3,"conditionHighlight"],[1,"condition-image"],[3,"src"],[1,"value"],["ghs-pointer-input","",1,"double",3,"conditionHighlight"],["ghs-pointer-input","",1,"check",3,"conditionHighlight"],["ghs-pointer-input","",1,"close",3,"singleClick","conditionHighlight"],["src","./assets/images/close_dialog.svg",1,"ghs-svg"],["ghs-pointer-input","",1,"double",3,"singleClick","conditionHighlight"],["ghs-pointer-input","",1,"check",3,"singleClick","conditionHighlight"],["src","./assets/images/check.svg",1,"ghs-svg"]],template:function(a,n){1&a&&t.nVh(0,w4,3,0,"div",0),2&a&&t.vxM(n.highlightedConditions.length>0?0:-1)},dependencies:()=>[N.YU,R4,rt],styles:['.highlight-conditions[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-end;align-items:center;width:0;height:0;overflow:visible}.highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;transform:scale(0);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}@keyframes _ngcontent-%COMP%_condition-highlight{0%{transform:scale(0) translateY(0)}25%,60%{transform:scale(1) translateY(-70%)}to{transform:scale(0) translateY(0)}}.highlight-conditions[_ngcontent-%COMP%]   .condition.animation[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_condition-highlight calc(var(--ghs-animation-speed) * 1s) ease-in-out}.highlight-conditions[_ngcontent-%COMP%]   .condition.apply[_ngcontent-%COMP%]{transform:scale(1)}.highlight-conditions[_ngcontent-%COMP%]   .condition.apply[_ngcontent-%COMP%]:not(.animation):before{content:" ";position:absolute;top:calc(var(--ghs-unit) * -.5 * var(--ghs-text-factor));bottom:0;left:calc(var(--ghs-unit) * -.5 * var(--ghs-text-factor));right:calc(var(--ghs-unit) * -.5 * var(--ghs-text-factor));background-color:var(--ghs-color-darkgray);border-radius:30%;opacity:.5}.highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .condition-image[_ngcontent-%COMP%]{position:relative;z-index:1}.highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .condition-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));width:auto}.highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .condition-image[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));left:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));color:var(--ghs-color-white);text-shadow:none;transform:translate(-50%)}.highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .double[_ngcontent-%COMP%]{cursor:pointer;width:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));height:auto;z-index:2;margin-top:calc(var(--ghs-unit) * .8 * var(--ghs-text-factor))}.highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .close.animation[_ngcontent-%COMP%], .highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .check.animation[_ngcontent-%COMP%], .highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .double.animation[_ngcontent-%COMP%]{animation:hide-animation calc(var(--ghs-animation-speed) * .95s) ease-in-out}.highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .double[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:hover, .highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]:hover, .highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .double[_ngcontent-%COMP%]:hover{transition:all calc(var(--ghs-animation-speed) * .1s);transform:scale(1.2)}.highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .double[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * -7 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 4.7 * var(--ghs-text-factor))}.highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-shadow);margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.highlight-conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{filter:var(--ghs-filter-green) var(--ghs-filter-shadow);margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.highlight-conditions[_ngcontent-%COMP%]   .condition.double[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 6.5 * var(--ghs-text-factor))}.highlight-conditions[_ngcontent-%COMP%]   .condition.double[_ngcontent-%COMP%]:not(.animation):before{top:calc(var(--ghs-unit) * -5.5 * var(--ghs-text-factor))}']})}return i})(),R4=(()=>{class i{el;condition;constructor(e){this.el=e}ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.condition.highlight&&!this.condition.expired&&(!m.f.settings.applyConditions||!m.f.settings.activeApplyConditions||-1!=m.f.settings.activeApplyConditionsExcludes.indexOf(this.condition.name))&&this.playAnimation()}}),this.playAnimation()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}playAnimation(){this.el.nativeElement.classList.add("animation"),setTimeout(()=>{this.el.nativeElement.classList.remove("animation"),(-1!=this.condition.types.indexOf(j.GV.turn)||!m.f.settings.applyConditions||!m.f.settings.activeApplyConditions||-1!=m.f.settings.activeApplyConditionsExcludes.indexOf(this.condition.name))&&(this.condition.highlight=!1,s.E.stateManager.saveLocal())},m.f.settings.animations?1100*m.f.settings.animationSpeed:0)}static \u0275fac=function(a){return new(a||i)(t.rXU(t.aKT))};static \u0275dir=t.FsC({type:i,selectors:[["","conditionHighlight",""]],inputs:{condition:[0,"conditionHighlight","condition"]},standalone:!1})}return i})();const j4=["standee"],G4=(i,r,e,a,n,o,g,_,y,B,nt,Z,W,et)=>({dead:i,off:r,dormant:e,revealed:a,"revealed-active":n,active:o,"active-focus":g,monster:_,objective:y,summon:B,denied:nt,"action-hint-border":Z,fh:W,modern:et}),T4=(i,r,e,a)=>({"monster-standee":i,"objective-standee":r,"summon-standee":e,"bb-elite":a}),S4=i=>({damage:i}),$4=(i,r,e,a)=>({active:i,new:r,center:e,fh:a}),Ss=i=>({center:i}),D4=i=>({retaliate:i}),I4=(i,r,e)=>({center:i,expired:r,fh:e}),A4=()=>[],V4=(i,r)=>({active:i,new:r}),F4=(i,r)=>r.type+i,X4=(i,r)=>r.name+r.value;function B4(i,r){if(1&i&&(t.j41(0,"div",4),t.nrm(1,"ghs-summon-sheet",23),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("summon",e.gameManager.toSummon(e.entity))}}function Y4(i,r){if(1&i&&t.nrm(0,"div",24),2&i){const e=t.XpG();t.xc7("background-image",!e.figure.noThumbnail&&e.settingsManager.settings.artwork&&e.gameManager.isMonster(e.figure)?"url("+e.gameManager.monsterManager.monsterThumbnail(e.gameManager.toMonster(e.figure))+")":"")}}function N4(i,r){if(1&i&&t.nrm(0,"div",24),2&i){const e=t.XpG();t.xc7("background-image",e.gameManager.toSummon(e.entity).thumbnailUrl?"url("+e.gameManager.toSummon(e.entity).thumbnailUrl+")":"url(./assets/images/summons/thumbnail/"+e.gameManager.toSummon(e.entity).thumbnail+".png)")}}function z4(i,r){if(1&i&&t.nrm(0,"img",25),2&i){const e=t.XpG(2);t.Y8G("src",t.VkB("./assets/images/summons/",e.gameManager.toSummon(e.entity).color,".png"),t.B4B)}}function L4(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function U4(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.JRh(e.gameManager.toSummon(e.entity).number)}}function q4(i,r){if(1&i&&(t.j41(0,"span",9),t.nVh(1,z4,1,2,"img",25),t.j41(2,"span",26),t.nVh(3,L4,2,0,"span"),t.nVh(4,U4,2,1,"span"),t.k0s()()),2&i){const e=t.XpG();t.Y8G("ngClass",t.ziG(4,$4,e.gameManager.toSummon(e.entity).state==e.SummonState.true,e.gameManager.toSummon(e.entity).state==e.SummonState.new,e.gameManager.toSummon(e.entity).entityConditions.length%2==0,e.gameManager.toSummon(e.entity).color==e.SummonColor.fh)),t.R7$(),t.vxM(e.gameManager.toSummon(e.entity).color!=e.SummonColor.fh?1:-1),t.R7$(2),t.vxM(0==e.gameManager.toSummon(e.entity).number?3:-1),t.R7$(),t.vxM(e.gameManager.toSummon(e.entity).number>0?4:-1)}}function H4(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsMinZero"),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.SpI(" ",t.bMT(2,1,e.entity.health+e.health)," ")}}function K4(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsMinZero"),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Lme(" ",e.maxHp,"/",t.bMT(2,2,e.maxHp-e.entity.health+e.health)," ")}}function W4(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsMinZero"),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.SpI(" ",t.bMT(2,1,e.entity.health+e.health)," ")}}function J4(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function Z4(i,r){if(1&i&&(t.j41(0,"span",29),t.nrm(1,"img",25),t.j41(2,"span",8),t.EFF(3),t.k0s()()),2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(),t.Y8G("src","./assets/images/"+(a.settingsManager.settings.fhStyle?"fh/":"")+"action/range.svg",t.B4B),t.R7$(2),t.JRh(e.range)}}function Q4(i,r){if(1&i&&(t.j41(0,"span",12)(1,"span",27),t.nrm(2,"img",25),t.j41(3,"span",28),t.EFF(4),t.k0s(),t.nVh(5,Z4,4,2,"span",29),t.k0s()()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG();t.Y8G("ngClass",t.eq3(5,Ss,n.actionHints.length%2==1&&a==n.actionHints.length-1)),t.R7$(2),t.Y8G("src","./assets/images/"+(n.settingsManager.settings.fhStyle?"fh/":"")+"action/hint/"+e.type+".svg",t.B4B),t.R7$(),t.Y8G("ngClass",t.eq3(7,D4,"retaliate"==e.type)),t.R7$(),t.JRh(e.value),t.R7$(),t.vxM(e.range?5:-1)}}function tE(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",30),t.bIt("doubleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.removeMarker())}),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ghs-label","%game.mapMarker."+e.marker+"%")}}function eE(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",31),t.bIt("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.removeCharacterMarker(n))}),t.nrm(1,"img",25),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.R7$(),t.Y8G("src",a.gameManager.characterManager.characterIcon(e),t.B4B)}}function nE(i,r){if(1&i&&t.nrm(0,"img",37),2&i){const e=r.$implicit,a=t.XpG(2),n=a.$implicit,o=a.$index,g=t.XpG();t.xc7("z-index",10*o+n.value-e-1),t.Y8G("src","./assets/images"+(g.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+n.name+".svg",t.B4B)}}function iE(i,r){if(1&i&&(t.Z7z(0,nE,1,3,"img",36,t.fX1),t.nI1(2,"ghsRange")),2&i){const e=t.XpG().$implicit;t.Dyx(t.i5U(2,0,t.lJ4(3,A4),e.value-1))}}function aE(i,r){if(1&i&&(t.j41(0,"span",8),t.EFF(1),t.k0s()),2&i){const e=t.XpG(),a=e.$implicit;t.xc7("z-index",10*e.$index+a.value+1),t.R7$(),t.JRh(a.value)}}function oE(i,r){if(1&i&&t.nrm(0,"span",38),2&i){const e=t.XpG();t.xc7("z-index",10*e.$index+e.$implicit.value+2)}}function sE(i,r){if(1&i&&t.nrm(0,"span",39),2&i){const e=t.XpG();t.xc7("z-index",10*e.$index+e.$implicit.value+3)}}function rE(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",12)(1,"span",32),t.bIt("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.removeCondition(n))}),t.nrm(2,"img",25),t.nVh(3,iE,3,4),t.nVh(4,aE,2,3,"span",33),t.nVh(5,oE,1,2,"span",34),t.nVh(6,sE,1,2,"span",35),t.k0s()()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG();t.Y8G("ngClass",t.sMw(8,I4,(n.gameManager.isMonsterEntity(n.entity)&&n.gameManager.toMonsterEntity(n.entity).summon==n.SummonState.false||n.gameManager.isSummon(n.entity)||n.gameManager.isObjectiveEntity(n.entity))&&n.activeConditions.length%2==1&&n.activeConditions.length==a+1,e.expired,n.settingsManager.settings.fhStyle)),t.R7$(2),t.xc7("z-index",10*a+e.value),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+e.name+".svg",t.B4B),t.R7$(),t.vxM(-1!=e.types.indexOf(n.ConditionType.stack)?3:-1),t.R7$(),t.vxM(-1!=e.types.indexOf(n.ConditionType.value)&&-1==e.types.indexOf(n.ConditionType.stack)?4:-1),t.R7$(),t.vxM(-1!=n.entity.immunities.indexOf(e.name)?5:-1),t.R7$(),t.vxM(e.permanent?6:-1)}}function cE(i,r){if(1&i&&(t.j41(0,"span",18)(1,"span",40),t.nrm(2,"img",25),t.k0s()()),2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(4,Ss,e.entity.entityConditions.length%2==0)),t.R7$(),t.Y8G("ngClass",t.l_i(6,V4,e.gameManager.isMonsterEntity(e.entity)&&e.gameManager.toMonsterEntity(e.entity).summon==e.SummonState.true,e.gameManager.isMonsterEntity(e.entity)&&e.gameManager.toMonsterEntity(e.entity).summon==e.SummonState.new)),t.R7$(),t.Y8G("src",t.VkB("./assets/images/summons/",e.gameManager.toMonster(e.figure).summonColor,".png"),t.B4B)}}let wi=(()=>{class i{element;dialog;overlay;standee;gameManager=s.E;settingsManager=m.f;figure;entity;Conditions=j.kW;AttackModifierType=Y.Yn;SummonState=lt.N5;SummonColor=lt.rX;ConditionName=j.r5;ConditionType=j.GV;MonsterType=S.N;health=0;maxHp=0;activeConditions=[];actionHints=[];activeIndex=-1;marker="";specialActionsMarker=[];objectiveData;EntityValueFunction=$.hZ;constructor(e,a,n){this.element=e,this.dialog=a,this.overlay=n}ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}additionalType(){return this.entity instanceof Rt.I?this.entity.type:this.entity instanceof lt.up?this.entity.name:""}update(){if(this.activeConditions=s.E.entityManager.activeConditions(this.entity,!0),this.entity.immunities.forEach(e=>{this.activeConditions.find(a=>a.name==e)||this.activeConditions.push(new j.BR(e))}),this.actionHints=[],m.f.settings.standeeStats&&(this.actionHints=s.E.actionsManager.calcActionHints(this.figure,this.entity)),this.entity.revealed){const e=s.E.game.figures.find(a=>a.active);if(e){const a=s.E.game.figures.indexOf(e);-1!=a&&(-1==this.activeIndex?this.activeIndex=a:this.activeIndex!=a&&this.entity.number>0&&(this.entity.revealed=!1))}}this.marker=this.entity instanceof Rt.I||this.entity instanceof oe.X?this.entity.marker:"",this.figure instanceof mt.$e&&this.figure.entities.flatMap(e=>e.marker).every((e,a,n)=>0==n.indexOf(e))&&(this.marker=""),this.maxHp=(0,$.hZ)(this.entity.maxHealth),this.specialActionsMarker=[],this.entity.tags.forEach(e=>{this.figure instanceof q.K&&"prism"==this.figure.name&&this.figure.specialActions.find(a=>a.name==e&&a.summon)&&"prism_mode"==e&&this.specialActionsMarker.push("mode")}),this.figure instanceof mt.$e&&this.figure.objectiveId&&(this.objectiveData=s.E.objectiveManager.objectiveDataByObjectiveIdentifier(this.figure.objectiveId))}dragHpMove(e){((0,$.hZ)(this.entity.maxHealth)>0||this.objectiveData&&this.objectiveData.trackDamage)&&(!(this.figure instanceof P.R)||!this.figure.immortal)&&(this.health=e,(!this.objectiveData||!this.objectiveData.trackDamage)&&this.entity.health+this.health>(0,$.hZ)(this.entity.maxHealth)&&(this.health=(0,$.hZ)(this.entity.maxHealth)-this.entity.health))}dragHpEnd(e){if(0!=this.health&&((0,$.hZ)(this.entity.maxHealth)>0||this.objectiveData&&this.objectiveData.trackDamage)&&(!(this.figure instanceof P.R)||!this.figure.immortal)){let a=this.figure.name;!a&&this.figure instanceof mt.$e&&(a=this.figure.title,a||(a=this.figure.escort?"%escort%":"%objective%")),s.E.stateManager.before(this.figure.type+"ChangeEntityHp",a,""+this.entity.number,""+this.health,this.additionalType()),s.E.entityManager.changeHealth(this.entity,this.figure,this.health),this.figure instanceof P.R&&this.figure.entities.every(n=>n.dead)&&this.figure.active&&s.E.roundManager.toggleFigure(this.figure),s.E.stateManager.after()}this.health=0}dragHpCancel(e){this.health=0}removeCondition(e){s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.figure,"removeCondition"),e.name,this.entity instanceof Rt.I?"monster."+this.entity.type+" ":""),e.types.indexOf(j.GV.stackable)&&e.value>1?e.value--:s.E.entityManager.removeCondition(this.entity,this.figure,e,e.permanent),s.E.stateManager.after()}removeMarker(){(this.entity instanceof Rt.I||this.entity instanceof oe.X)&&this.entity.marker&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.figure,"removeEntityMarker"),this.marker),this.entity.marker="",s.E.stateManager.after())}removeCharacterMarker(e){const a=new q.K(s.E.getCharacterData(e),1),n=s.E.characterManager.characterName(a),o=a.name;s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.figure,"removeMarker"),n,o),this.entity.markers=this.entity.markers.filter(g=>g!=e),s.E.stateManager.after()}doubleClick(e){this.entity.revealed?this.entity.revealed=!1:m.f.settings.activeStandees&&this.entity instanceof Rt.I?(s.E.stateManager.before(this.figure.type+(this.entity.active?"UnsetEntityActive":"SetEntityActive"),this.figure.name,""+this.entity.number,this.additionalType()),s.E.entityManager.toggleActive(this.figure,this.entity),s.E.stateManager.after()):m.f.settings.activeSummons&&this.entity instanceof lt.up&&this.toggleActive()}toggleActive(){if(this.entity instanceof lt.up&&this.figure instanceof q.K)if(this.entity.active)s.E.stateManager.before("summonInactive",s.E.characterManager.characterName(this.figure),"data.summon."+this.entity.name),m.f.settings.activeSummons&&this.figure.active?s.E.roundManager.toggleFigure(this.figure):this.entity.active=!1,s.E.stateManager.after();else{s.E.stateManager.before("summonActive",s.E.characterManager.characterName(this.figure),"data.summon."+this.entity.name);const e=this.figure.summons.find(a=>a.active);if(m.f.settings.activeSummons&&this.figure.active&&s.E.entityManager.isAlive(this.entity,!0)&&(!e||this.figure.summons.indexOf(e)<this.figure.summons.indexOf(this.entity)))for(;!this.entity.active;)s.E.roundManager.toggleFigure(this.figure);else this.figure.summons.forEach(a=>a.active=!1),this.entity.active=!0;s.E.stateManager.after()}}openEntityMenu(e){if(this.entity.number<0&&this.figure instanceof P.R&&this.entity instanceof Rt.I)if(m.f.settings.randomStandees){const a=s.E.monsterManager.monsterRandomStandee(this.figure);s.E.stateManager.before("addRandomStandee","data.monster."+this.figure.name,"monster."+this.entity.type,""+a),this.entity.number=a,s.E.stateManager.after()}else this.dialog.open(li,{panelClass:["dialog"],data:{monster:this.figure,type:this.entity.type,range:[],entity:this.entity,entities:this.figure.entities},positionStrategy:this.overlay.position().flexibleConnectedTo(this.standee).withPositions((0,V.yE)())});else this.dialog.open(Xn,{panelClass:["dialog"],data:{entity:this.entity,figure:this.figure,positionElement:this.standee},positionStrategy:this.overlay.position().flexibleConnectedTo(this.standee).withPositions((0,V.yE)())}).closed.subscribe({next:()=>{(this.entity instanceof Rt.I||this.entity instanceof oe.X)&&this.entity.dead&&(this.element.nativeElement.classList.add("dead"),s.E.uiChange.emit())}})}static \u0275fac=function(a){return new(a||i)(t.rXU(t.aKT),t.rXU(v.lG),t.rXU(zt.hJ))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-standee"]],viewQuery:function(a,n){if(1&a&&t.GBs(j4,5),2&a){let o;t.mGM(o=t.lsd())&&(n.standee=o.first)}},inputs:{figure:"figure",entity:"entity"},standalone:!1,decls:33,vars:54,consts:[["standee",""],[1,"entity-border",3,"ngClass","entityAnimation"],[1,"entity",3,"ngClass"],[1,"standee",3,"ngClass"],[1,"sheet"],[1,"background-image-container"],[1,"background-image",3,"background-image"],[1,"number",3,"ngClass"],[1,"value"],[1,"summon-state",3,"ngClass"],[1,"health",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"conditions","actions"],[1,"condition-container",3,"ngClass"],[1,"markers"],["ghs-pointer-input","",1,"placeholder","placeholder-marker",3,"ghs-label"],["ghs-pointer-input","",1,"marker"],[3,"entity","figure"],[1,"conditions"],[1,"summon-container",3,"ngClass"],[1,"value-overlay",3,"value-sign","hideEmpty","reverse","invert","container"],[3,"entity","diff"],[3,"entity"],[1,"drag-hp",3,"dragMove","dragEnd","dragCancel","singleClick","doubleClick","relative","screenWidth","fastShift"],[3,"summon"],[1,"background-image"],[3,"src"],[1,"summon-number"],[1,"condition","action-hint"],[1,"value",3,"ngClass"],[1,"range"],["ghs-pointer-input","",1,"placeholder","placeholder-marker",3,"doubleClick","ghs-label"],["ghs-pointer-input","",1,"marker",3,"doubleClick"],["ghs-pointer-input","",1,"condition",3,"doubleClick"],[1,"value",3,"z-index"],[1,"condition","immunity","condition-overlay",3,"z-index"],[1,"condition","permanent","condition-overlay",3,"z-index"],[1,"stack",3,"z-index","src"],[1,"stack",3,"src"],[1,"condition","immunity","condition-overlay"],[1,"condition","permanent","condition-overlay"],[1,"summon",3,"ngClass"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3,0),t.nVh(4,B4,2,1,"div",4),t.j41(5,"div",5),t.nVh(6,Y4,1,2,"div",6),t.nVh(7,N4,1,2,"div",6),t.k0s(),t.j41(8,"span",7)(9,"span",8),t.EFF(10),t.k0s()(),t.nVh(11,q4,5,9,"span",9),t.j41(12,"span",10),t.nVh(13,H4,3,3,"span"),t.nVh(14,K4,3,4,"span"),t.nVh(15,W4,3,3,"span"),t.nVh(16,J4,2,0,"span"),t.k0s()(),t.j41(17,"div",11),t.Z7z(18,Q4,6,9,"span",12,F4),t.k0s(),t.j41(20,"div",13),t.nVh(21,tE,1,1,"span",14),t.Z7z(22,eE,2,1,"span",15,t.fX1),t.k0s(),t.nrm(24,"ghs-highlight-conditions",16),t.j41(25,"div",17),t.Z7z(26,rE,7,12,"span",12,X4),t.nVh(28,cE,3,9,"span",18),t.k0s(),t.nrm(29,"span",19)(30,"ghs-healthbar",20)(31,"ghs-entity-index-key",21),t.k0s(),t.j41(32,"ghs-pointer-input",22),t.bIt("dragMove",function(_){return t.eBV(o),t.Njj(n.dragHpMove(_))})("dragEnd",function(_){return t.eBV(o),t.Njj(n.dragHpEnd(_))})("dragCancel",function(_){return t.eBV(o),t.Njj(n.dragHpCancel(_))})("singleClick",function(_){return t.eBV(o),t.Njj(n.openEntityMenu(_))})("doubleClick",function(_){return t.eBV(o),t.Njj(n.doubleClick(_))}),t.k0s()()}2&a&&(t.Y8G("ngClass",t.zJS(32,G4,[n.entity.dead,!n.entity.dormant&&n.entity.off,n.entity.dormant,!n.entity.dormant&&n.entity.revealed&&n.settingsManager.settings.scenarioRooms,n.figure.active&&!n.entity.dormant&&n.entity.revealed&&n.settingsManager.settings.scenarioRooms&&n.settingsManager.settings.activeStandees,!n.entity.dormant&&(n.gameManager.isMonsterEntity(n.entity)&&n.entity.active&&n.settingsManager.settings.activeStandees||n.gameManager.isSummon(n.entity)&&n.entity.active&&n.settingsManager.settings.activeSummons),!n.entity.dormant&&n.entity.active&&n.settingsManager.settings.activeStandees&&!n.figure.active,n.gameManager.isMonsterEntity(n.entity),n.gameManager.isObjectiveEntity(n.entity),n.gameManager.isSummon(n.entity),n.gameManager.isMonster(n.figure)&&!n.gameManager.stateManager.monsterPermissions[n.figure.name+"|"+n.figure.edition]||n.gameManager.isObjectiveContainer(n.figure)&&n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.characters||n.gameManager.isCharacter(n.figure)&&!n.gameManager.stateManager.characterPermissions[n.figure.name+"|"+n.figure.edition],n.actionHints.length>0&&n.actionHints.length%2==1&&0==n.activeConditions.length&&(n.gameManager.isObjectiveEntity(n.entity)&&n.gameManager.isMonsterEntity(n.entity)&&n.gameManager.toMonsterEntity(n.entity).summon==n.SummonState.false||n.gameManager.isSummon(n.entity)&&n.gameManager.toSummon(n.entity).state==n.SummonState.false),"fh"==n.settingsManager.settings.theme,"modern"==n.settingsManager.settings.theme]))("entityAnimation",n.entity.dead),t.R7$(),t.Y8G("ngClass",n.gameManager.isMonsterEntity(n.entity)?n.gameManager.toMonsterEntity(n.entity).type:""),t.R7$(),t.Y8G("ngClass",t.ziG(47,T4,n.gameManager.isMonsterEntity(n.entity),n.gameManager.isObjectiveEntity(n.entity),n.gameManager.isSummon(n.entity),n.gameManager.isMonster(n.figure)&&n.gameManager.toMonster(n.figure).bb&&n.gameManager.isMonsterEntity(n.entity)&&n.gameManager.toMonsterEntity(n.entity).type==n.MonsterType.elite)),t.R7$(2),t.vxM(n.gameManager.isSummon(n.entity)&&n.gameManager.toSummon(n.entity).active?4:-1),t.R7$(2),t.vxM(n.gameManager.isMonsterEntity(n.entity)?6:-1),t.R7$(),t.vxM(n.gameManager.isSummon(n.entity)&&n.settingsManager.settings.artwork&&(n.gameManager.toSummon(n.entity).thumbnail&&!n.gameManager.toSummon(n.entity).noThumbnail||n.gameManager.toSummon(n.entity).thumbnailUrl)?7:-1),t.R7$(),t.Y8G("ngClass",(n.gameManager.isMonster(n.figure)&&n.gameManager.toMonster(n.figure).bb?"bb-"+n.entity.number:"")+(n.entity.number<1&&n.settingsManager.settings.animations?" highlight":"")),t.R7$(2),t.JRh(n.entity.number<0?"?":n.entity.number),t.R7$(),t.vxM(n.gameManager.isSummon(n.entity)?11:-1),t.R7$(),t.Y8G("ghs-label","game.health")("ghs-label-attribute","title")("ngClass",t.eq3(52,S4,n.settingsManager.settings.damageHP||n.objectiveData&&n.objectiveData.trackDamage)),t.R7$(),t.vxM(n.maxHp&&!n.settingsManager.settings.damageHP?13:-1),t.R7$(),t.vxM(n.maxHp&&n.settingsManager.settings.damageHP?14:-1),t.R7$(),t.vxM(n.objectiveData&&n.objectiveData.trackDamage?15:-1),t.R7$(),t.vxM(n.objectiveData&&n.objectiveData.trackDamage||n.maxHp?-1:16),t.R7$(2),t.Dyx(n.actionHints),t.R7$(3),t.vxM(n.marker?21:-1),t.R7$(),t.Dyx(n.entity.markers),t.R7$(2),t.Y8G("entity",n.entity)("figure",n.figure),t.R7$(2),t.Dyx(n.activeConditions),t.R7$(2),t.vxM(n.gameManager.isMonsterEntity(n.entity)&&n.gameManager.toMonsterEntity(n.entity).summon!=n.SummonState.false?28:-1),t.R7$(),t.Y8G("value-sign",n.health)("hideEmpty",!0)("reverse",n.settingsManager.settings.damageHP)("invert",!!n.objectiveData&&n.objectiveData.trackDamage)("container",!0),t.R7$(),t.Y8G("entity",n.entity)("diff",n.health),t.R7$(),t.Y8G("entity",n.entity),t.R7$(),t.Y8G("relative",!0)("screenWidth",!0)("fastShift",!0))},dependencies:[N.YU,xi,pi,tt,Rs,Ei,rt,Ma,Fn,hi,Tt],styles:['.entity-border[_ngcontent-%COMP%]{position:relative;touch-action:none;height:calc(var(--ghs-unit) * 7 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]:hover{z-index:999}.entity-border[_ngcontent-%COMP%]:before{content:" ";display:block;position:absolute;top:calc(var(--ghs-unit) * 1.6 * var(--ghs-text-factor));left:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));bottom:calc(var(--ghs-unit) * 1.1 * var(--ghs-text-factor));right:calc(var(--ghs-unit) * 2.1 * var(--ghs-text-factor));border-width:calc(var(--ghs-unit) * .4);border-style:solid;border-color:var(--ghs-color-gray);border-radius:calc(var(--ghs-unit) * .7)}.entity-border.action-hint-border[_ngcontent-%COMP%]:before{right:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]:not(.dead){opacity:1;transform:translate(0)}.entity-border.dead[_ngcontent-%COMP%]{opacity:0;max-width:0;transform:translateY(100%)}@keyframes _ngcontent-%COMP%_monster-entity-active-focus{0%{box-shadow:0 0 calc(var(--ghs-unit) * 1) calc(var(--ghs-unit) * .3) var(--ghs-color-red)}40%,60%{box-shadow:0 0 calc(var(--ghs-unit) * 1) calc(var(--ghs-unit) * .6) var(--ghs-color-red)}to{box-shadow:0 0 calc(var(--ghs-unit) * 1) calc(var(--ghs-unit) * .3) var(--ghs-color-red)}}.entity-border.active.active-focus[_ngcontent-%COMP%]   .monster-standee[_ngcontent-%COMP%], .entity-border.active.active-focus[_ngcontent-%COMP%]   .objective-standee[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_monster-entity-active-focus calc(var(--ghs-animation-speed) * 1s) ease-in-out infinite}.entity-border.active[_ngcontent-%COMP%]   .monster-standee[_ngcontent-%COMP%], .entity-border.active[_ngcontent-%COMP%]   .objective-standee[_ngcontent-%COMP%]{box-shadow:0 0 calc(var(--ghs-unit) * 1) calc(var(--ghs-unit) * .5) var(--ghs-color-red)}@keyframes _ngcontent-%COMP%_monster-entity-revealed{0%{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .1) var(--ghs-color-white)}40%,60%{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .3) var(--ghs-color-white)}to{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .1) var(--ghs-color-white)}}@keyframes _ngcontent-%COMP%_monster-entity-revealed-elite{0%{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .1) var(--ghs-color-yellow)}40%,60%{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .3) var(--ghs-color-yellow)}to{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .1) var(--ghs-color-yellow)}}@keyframes _ngcontent-%COMP%_monster-entity-revealed-boss{0%{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .1) var(--ghs-color-red)}40%,60%{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .3) var(--ghs-color-red)}to{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .1) var(--ghs-color-red)}}.entity-border.revealed[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .monster-standee[_ngcontent-%COMP%], .entity-border.revealed[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .objective-standee[_ngcontent-%COMP%]{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .3) var(--ghs-color-white)}.entity-border.revealed[_ngcontent-%COMP%]   .entity.elite[_ngcontent-%COMP%]   .monster-standee[_ngcontent-%COMP%]{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .3) var(--ghs-color-yellow)}.entity-border.revealed[_ngcontent-%COMP%]   .entity.boss[_ngcontent-%COMP%]   .monster-standee[_ngcontent-%COMP%]{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .3) var(--ghs-color-red)}.entity-border.revealed.revealed-active[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .monster-standee[_ngcontent-%COMP%], .entity-border.revealed.revealed-active[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .objective-standee[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_monster-entity-revealed calc(var(--ghs-animation-speed) * 1s) ease-in-out infinite}.entity-border.revealed.revealed-active[_ngcontent-%COMP%]   .entity.elite[_ngcontent-%COMP%]   .monster-standee[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_monster-entity-revealed-elite calc(var(--ghs-animation-speed) * 1s) ease-in-out infinite}.entity-border.revealed.revealed-active[_ngcontent-%COMP%]   .entity.boss[_ngcontent-%COMP%]   .monster-standee[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_monster-entity-revealed-boss calc(var(--ghs-animation-speed) * 1s) ease-in-out infinite}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]{position:relative;display:flex;cursor:pointer;height:calc(var(--ghs-unit) * 7 * var(--ghs-text-factor));text-align:center;color:var(--ghs-color-white);text-shadow:var(--ghs-outline);width:100%;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));margin-top:calc(var(--ghs-unit) * .25 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]{position:relative;display:flex;height:100%;width:calc(var(--ghs-unit) * 9 * var(--ghs-text-factor));border:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor)) solid var(--ghs-color-black);border-bottom-width:calc(var(--ghs-unit) * .35 * var(--ghs-text-factor));border-top-left-radius:25%;border-top-right-radius:25%;background-color:var(--ghs-color-black);filter:var(--ghs-filter-outline)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee.bb-elite[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor)) solid var(--ghs-color-yellow);border-top:none;border-left:none}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .background-image-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;border-top-left-radius:25%;border-top-right-radius:25%;overflow:hidden;z-index:0}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .background-image-container[_ngcontent-%COMP%]   .background-image[_ngcontent-%COMP%]{position:absolute;top:-7%;left:0;width:100%;height:150%;background-color:var(--ghs-color-darkgray);background-size:calc(var(--ghs-unit) * 9.5 * var(--ghs-text-factor)) AUTO;background-repeat:no-repeat;filter:brightness(70%)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{display:flex;width:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));justify-content:center;align-items:center;font-family:var(--ghs-font-gh-normal);flex-shrink:0;z-index:1}@keyframes _ngcontent-%COMP%_number-pulse{0%{transform:scale(.9)}50%{transform:scale(1.1)}to{transform:scale(.9)}}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray);background-color:var(--ghs-color-white);border-bottom-right-radius:50%;border-top-left-radius:35%;height:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));text-shadow:none}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.highlight[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_number-pulse calc(var(--ghs-animation-speed) * 2s) ease-in-out infinite}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor));position:relative;top:calc(var(--ghs-unit) * 1.2 * var(--ghs-text-factor));left:0;height:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]:before{content:" ";position:absolute;left:50%;top:calc(var(--ghs-unit) * -.9 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));background-image:url(health.8d6a842a197d29d3.svg);background-size:contain;background-repeat:no-repeat;transform:translate(-50%)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .health.damage[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .health.damage[_ngcontent-%COMP%]:before{background-image:url(damage.9a6bcf7352ecd379.svg);width:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));filter:var(--ghs-filter-red) brightness(.7) var(--ghs-filter-outline-thin-black)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;max-height:calc(var(--ghs-unit) * 7 * var(--ghs-text-factor));padding-left:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]   .placeholder-marker[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1.3 * var(--ghs-text-factor));font-size:calc(var(--ghs-unit) * 3.2 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]   ghs-element-icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));margin-top:calc(var(--ghs-unit) * 1.4 * var(--ghs-text-factor));margin-left:calc(var(--ghs-unit) * -.5 * var(--ghs-text-factor));margin-right:calc(var(--ghs-unit) * -.5 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));background-color:var(--ghs-color-darkgray);border-radius:100%;height:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));margin-top:calc(var(--ghs-unit) * .8 * var(--ghs-text-factor));margin-left:calc(var(--ghs-unit) * -1 * var(--ghs-text-factor));margin-right:calc(var(--ghs-unit) * -1 * var(--ghs-text-factor));border-width:calc(var(--ghs-unit) * .4);border-style:solid;border-color:var(--ghs-color-gray)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   ghs-highlight-conditions[_ngcontent-%COMP%]{z-index:20;position:absolute;bottom:0;left:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]{position:relative;display:grid;grid-template-rows:repeat(2,auto);grid-auto-flow:column;height:calc(var(--ghs-unit) * 7.5 * var(--ghs-text-factor));margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));margin-right:calc(var(--ghs-unit) * -.5 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;margin-left:calc(var(--ghs-unit) * -.5 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container.expired[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container.expired[_ngcontent-%COMP%]{opacity:.6}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));overflow:visible}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));margin:0}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img.stack[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]   img.stack[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img.stack[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]   img.stack[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * -2 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition.condition-overlay[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .summon.condition-overlay[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .condition.condition-overlay[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .summon.condition-overlay[_ngcontent-%COMP%]{position:absolute;width:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));top:0;left:0;pointer-events:none;z-index:2}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));color:var(--ghs-color-white);position:absolute;top:calc(var(--ghs-unit) * 2.1 * var(--ghs-text-factor));left:50%;text-shadow:none;transform:translate(-50%)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]:hover{transform-origin:center center;z-index:999}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]:nth-child(2n)   .condition[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]:nth-child(2n)   .summon[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]:nth-child(2n)   .condition[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]:nth-child(2n)   .summon[_ngcontent-%COMP%]:hover{transform:scale(2) translateY(-25%)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]:nth-child(odd)   .condition[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]:nth-child(odd)   .summon[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]:nth-child(odd)   .condition[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container[_ngcontent-%COMP%]:nth-child(odd)   .summon[_ngcontent-%COMP%]:hover{transform:scale(2) translateY(25%)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container.center[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container.center[_ngcontent-%COMP%]{grid-row:span 2}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container.center[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition-container.center[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container.center[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:hover, .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon-container.center[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]:hover{transform:scale(2)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions.actions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions.actions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{position:absolute;top:0;left:0;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));height:100%;transform:none;color:var(--ghs-color-white);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3.3 * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));text-shadow:var(--ghs-outline-thin);filter:invert(1)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions.actions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value.retaliate[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));top:calc(var(--ghs-unit) * .7 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions.actions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));height:auto;filter:var(--ghs-filter-white) var(--ghs-filter-outline)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions.actions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .range[_ngcontent-%COMP%]{position:relative;top:20%}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions.actions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .range[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.3 * var(--ghs-text-factor));height:auto}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions.actions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .range[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.3 * var(--ghs-text-factor));left:calc(var(--ghs-unit) * -.3 * var(--ghs-text-factor));top:calc(var(--ghs-unit) * .3 * var(--ghs-text-factor));font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .summon.new[_ngcontent-%COMP%]:before{content:" ";display:block;position:absolute;width:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));background-image:url(minus.97c98a810771fceb.svg);background-size:cover}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   ghs-healthbar[_ngcontent-%COMP%]{position:absolute;bottom:calc(var(--ghs-unit) * .2 * var(--ghs-text-factor));left:calc(var(--ghs-unit) * .4 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 8.2 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * .75 * var(--ghs-text-factor));z-index:0;border-radius:15%;overflow:hidden}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   ghs-entity-index-key[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));top:calc(var(--ghs-unit) * -3.5 * var(--ghs-text-factor))}.entity-border[_ngcontent-%COMP%]   .entity.normal[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{background-color:var(--ghs-color-white)}.entity-border[_ngcontent-%COMP%]   .entity.elite[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{background-color:var(--ghs-color-yellow)}.entity-border[_ngcontent-%COMP%]   .entity.boss[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{background-color:var(--ghs-color-red)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-1[_ngcontent-%COMP%]{background-color:var(--ghs-color-bb-1)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-2[_ngcontent-%COMP%]{background-color:var(--ghs-color-bb-2)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-3[_ngcontent-%COMP%]{background-color:var(--ghs-color-bb-3)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-4[_ngcontent-%COMP%]{background-color:var(--ghs-color-bb-4)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-5[_ngcontent-%COMP%]{background-color:var(--ghs-color-bb-5)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-6[_ngcontent-%COMP%]{background-color:var(--ghs-color-bb-6)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-7[_ngcontent-%COMP%]{background-color:var(--ghs-color-bb-7)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-8[_ngcontent-%COMP%]{background-color:var(--ghs-color-bb-8)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-9[_ngcontent-%COMP%]{background-color:var(--ghs-color-bb-9)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-10[_ngcontent-%COMP%]{background-color:var(--ghs-color-bb-10)}.entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-1[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-2[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-3[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-4[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-5[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-6[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-7[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-8[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-9[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .entity-border[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]   .number.bb-10[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--ghs-color-white);filter:var(--ghs-filter-shadow)}.entity-border.dormant[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]{filter:grayscale(.4)}.entity-border.dormant[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .background-image-container[_ngcontent-%COMP%], .entity-border.dormant[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   ghs-healthbar[_ngcontent-%COMP%]{filter:grayscale(.8)}.entity-border[_ngcontent-%COMP%]   .drag-hp[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:calc(var(--ghs-unit) * 9 * var(--ghs-text-factor));height:100%;z-index:4}.entity-border[_ngcontent-%COMP%]   .value-overlay[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));top:calc(var(--ghs-unit) * -3 * var(--ghs-text-factor));font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor));z-index:1000}.entity-border.summon[_ngcontent-%COMP%]{transition:height calc(var(--ghs-animation-speed) * .5s) ease-out}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]{transition:width calc(var(--ghs-animation-speed) * .5s) ease-out}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]{background-color:var(--ghs-color-darkgray);transition:height calc(var(--ghs-animation-speed) * .5s) ease-out,width calc(var(--ghs-animation-speed) * .5s) ease-out}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{display:none}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * .5);left:0;width:calc(var(--ghs-unit) * 4);height:calc(var(--ghs-unit) * 4);transition:top calc(var(--ghs-animation-speed) * .5s) ease-out,left calc(var(--ghs-animation-speed) * .5s) ease-out}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .summon-state.new[_ngcontent-%COMP%]:before{content:" ";display:block;position:absolute;width:calc(var(--ghs-unit) * 4);height:calc(var(--ghs-unit) * 4);background-image:url(minus.97c98a810771fceb.svg);background-size:cover;z-index:2}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%]{position:absolute;display:flex;justify-content:center;align-items:center;top:0;left:calc(var(--ghs-unit) * -.1);height:calc(var(--ghs-unit) * 4);width:calc(var(--ghs-unit) * 2);font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5);color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray);border-top-left-radius:calc(var(--ghs-unit) * 4);border-bottom-left-radius:calc(var(--ghs-unit) * 4);z-index:3;opacity:.9;transition:top calc(var(--ghs-animation-speed) * .5s) ease-out,left calc(var(--ghs-animation-speed) * .5s) ease-out}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .summon-state.fh[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 1);width:calc(var(--ghs-unit) * 3.5);height:calc(var(--ghs-unit) * 3.5)}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .summon-state.fh.new[_ngcontent-%COMP%]:before{right:calc(var(--ghs-unit) * -.7);top:calc(var(--ghs-unit) * .8);width:calc(var(--ghs-unit) * 2);height:calc(var(--ghs-unit) * 2);background-image:url(minus.4a3eac90cfce6ac6.svg);z-index:4}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .summon-state.fh[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5);height:calc(var(--ghs-unit) * 3.5);font-family:var(--ghs-font-gh-title);font-size:calc(var(--ghs-unit) * 2.5);color:var(--ghs-color-white);border:calc(var(--ghs-unit) * .3) solid var(--ghs-color-white);border-radius:100%}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .background-image-container[_ngcontent-%COMP%]{transition:height calc(var(--ghs-animation-speed) * .5s) ease-out,width calc(var(--ghs-animation-speed) * .5s) ease-out,top calc(var(--ghs-animation-speed) * .5s) ease-out,left calc(var(--ghs-animation-speed) * .5s) ease-out}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .background-image-container[_ngcontent-%COMP%]   .background-image[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * -1.3 * var(--ghs-text-factor));left:calc(var(--ghs-unit) * -.8 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 9.5 * var(--ghs-text-factor));height:150%;background-size:100% AUTO;background-color:transparent;transition:height calc(var(--ghs-animation-speed) * .5s) ease-out,width calc(var(--ghs-animation-speed) * .5s) ease-out,top calc(var(--ghs-animation-speed) * .5s) ease-out,left calc(var(--ghs-animation-speed) * .5s) ease-out}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 1.2 * var(--ghs-text-factor));left:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));transition:top calc(var(--ghs-animation-speed) * .5s) ease-out,left calc(var(--ghs-animation-speed) * .5s) ease-out}.entity-border.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   ghs-healthbar[_ngcontent-%COMP%]{transition:width calc(var(--ghs-animation-speed) * .5s) ease-out}.entity-border.summon[_ngcontent-%COMP%]   .value-overlay[_ngcontent-%COMP%]{top:initial;bottom:calc(var(--ghs-unit) * -2.5 * var(--ghs-text-factor))}.entity-border.active.summon[_ngcontent-%COMP%]{z-index:15}.entity-border.active.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 12 * var(--ghs-text-factor))}.entity-border.active.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 30 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 12 * var(--ghs-text-factor));font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor))}.entity-border.active.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 11 * var(--ghs-text-factor))}.entity-border.active.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .background-image-container[_ngcontent-%COMP%]{top:5%;left:0;height:75%;width:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor))}.entity-border.active.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .background-image-container[_ngcontent-%COMP%]   .background-image[_ngcontent-%COMP%]{top:8%;left:-35%;width:calc(var(--ghs-unit) * 6 * var(--ghs-text-factor))}.entity-border.active.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   ghs-summon-sheet[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}.entity-border.active.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * -1);left:calc(var(--ghs-unit) * -2)}.entity-border.active.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 6.5 * var(--ghs-text-factor));left:calc(var(--ghs-unit) * 1)}.entity-border.active.summon[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .value-overlay[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 0 * var(--ghs-text-factor));bottom:calc(var(--ghs-unit) * -3 * var(--ghs-text-factor))}.entity-border.active.summon[_ngcontent-%COMP%]   ghs-healthbar[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * .4 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 29.2 * var(--ghs-text-factor))}.entity-border.active.summon.fh[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .background-image-container[_ngcontent-%COMP%]{top:25%;height:85%;width:calc(var(--ghs-unit) * 9.5 * var(--ghs-text-factor))}.entity-border.active.summon.fh[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .background-image-container[_ngcontent-%COMP%]   .background-image[_ngcontent-%COMP%]{top:0;left:-10%;width:calc(var(--ghs-unit) * 9.5 * var(--ghs-text-factor))}.entity-border.active.summon.fh[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .summon-standee[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 2)}.entity-border.active.summon[_ngcontent-%COMP%]   ghs-pointer-input.drag-hp[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 30 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 12 * var(--ghs-text-factor))}@keyframes _ngcontent-%COMP%_monster-entity-active-focus-fh{0%{box-shadow:0 0 calc(var(--ghs-unit) * 1) calc(var(--ghs-unit) * .3) var(--ghs-color-blue)}40%,60%{box-shadow:0 0 calc(var(--ghs-unit) * 1) calc(var(--ghs-unit) * .6) var(--ghs-color-blue)}to{box-shadow:0 0 calc(var(--ghs-unit) * 1) calc(var(--ghs-unit) * .3) var(--ghs-color-blue)}}.entity-border.fh.active.active-focus[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_monster-entity-active-focus-fh calc(var(--ghs-animation-speed) * 1s) ease-in-out infinite}.entity-border.fh.active[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]{box-shadow:0 0 calc(var(--ghs-unit) * 1) calc(var(--ghs-unit) * .5) var(--ghs-color-blue)}@keyframes _ngcontent-%COMP%_monster-entity-revealed-fh{0%{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .1) var(--ghs-color-darkgray)}40%,60%{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .3) var(--ghs-color-darkgray)}to{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .1) var(--ghs-color-darkgray)}}.entity-border.fh.revealed[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]{box-shadow:0 0 calc(var(--ghs-unit) * .6) calc(var(--ghs-unit) * .3) var(--ghs-color-darkgray);animation:_ngcontent-%COMP%_monster-entity-revealed-fh calc(var(--ghs-animation-speed) * 1s) ease-in-out infinite}.entity-border.fh.revealed[_ngcontent-%COMP%]   .entity.elite[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_monster-entity-revealed-elite calc(var(--ghs-animation-speed) * 1s) ease-in-out infinite}.entity-border.fh.revealed[_ngcontent-%COMP%]   .entity.boss[_ngcontent-%COMP%]   .standee[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_monster-entity-revealed-boss calc(var(--ghs-animation-speed) * 1s) ease-in-out infinite}.entity-border.fh[_ngcontent-%COMP%]   .entity[_ngcontent-%COMP%]   .conditions.actions[_ngcontent-%COMP%]   .condition-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value.retaliate[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 1.1 * var(--ghs-text-factor))}.entity-border.modern[_ngcontent-%COMP%]:not(.active)   .standee[_ngcontent-%COMP%]{box-shadow:none;filter:none}']})}return i})();const lE=["charactertitle"],gE=["characterName"],dE=["summonButton"],hE=(i,r,e,a,n,o,g,_,y,B)=>({off:i,denied:r,absent:e,dimmed:a,compact:n,short:o,menu:g,fh:_,modern:y,"active-border":B}),$s=(i,r)=>({empty:i,off:r}),Ds=(i,r)=>({empty:i,disabled:r}),_E=i=>({"outer-denied":i}),Ea=i=>({active:i}),mE=i=>({identities:i}),pE=i=>({damage:i}),uE=i=>({fh:i}),fE=()=>[],CE=i=>({disabled:i}),wa=i=>({bb:i}),ME=i=>({drawing:i}),vE=i=>({"hand-size-margin":i}),Is=(i,r)=>r.name+r.color+r.number,OE=(i,r)=>r.name+r.value,As=(i,r)=>r.type+i,PE=(i,r)=>r.name;function bE(i,r){if(1&i&&t.nrm(0,"ghs-standee",23),2&i){const e=r.$implicit,a=t.XpG(3);t.Y8G("figure",a.character)("entity",e)}}function kE(i,r){if(1&i&&(t.j41(0,"div",22),t.Z7z(1,bE,1,2,"ghs-standee",23,Is),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Dyx(e.summons)}}function yE(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",2),t.nrm(1,"span",7),t.j41(2,"span",19),t.bIt("click",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.openEntitiesMenu(n))}),t.nrm(3,"img",20)(4,"img",21),t.k0s(),t.nVh(5,kE,3,0,"div",22),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.l_i(5,$s,0==e.summonCount,e.character.off||e.character.exhausted||e.character.health<=0)),t.R7$(2),t.Y8G("ngClass",t.l_i(8,Ds,0==e.summonCount,e.summonCount<2))("entityAnimation",0==e.summonCount),t.R7$(),t.Y8G("src",e.character.iconUrl,t.B4B),t.R7$(2),t.vxM(e.summonCount?5:-1)}}function xE(i,r){if(1&i&&t.nrm(0,"ghs-character-initiative",25),2&i){const e=t.XpG(2);t.Y8G("figure",e.character)}}function EE(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",27)(1,"div",29)(2,"ghs-attackmodifier-deck",30),t.bIt("before",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.beforeAttackModifierDeck(n))})("after",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.afterAttackModifierDeck(n))}),t.k0s()(),t.j41(3,"div",31),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.toggleAttackModifierDeckVisible())}),t.k0s()()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Ea,e.character.attackModifierDeckVisible)),t.R7$(2),t.Y8G("character",e.character)}}function wE(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",35),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openLootDeckDialog())}),t.nrm(1,"ghs-loot",36),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(3);t.R7$(),t.Y8G("loot",a.gameManager.game.lootDeck.cards[e])("flipped",!0)("disableFlip",!0)}}function RE(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",28)(1,"div",29)(2,"div",32),t.Z7z(3,wE,2,3,"div",33,t.fX1),t.k0s()(),t.j41(5,"div",34),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.toggleLootCardsVisible())}),t.k0s()()}if(2&i){const e=t.XpG(2);t.R7$(3),t.Dyx(e.character.lootCards)}}function jE(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-pointer-input",24),t.bIt("dragMove",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.gameManager.stateManager.characterPermissions[o.character.name+"|"+o.character.edition]&&o.dragInitiativeMove(n))})("dragEnd",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.gameManager.stateManager.characterPermissions[o.character.name+"|"+o.character.edition]&&o.dragInitiativeEnd(n))})("singleClick",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.toggleFigure(n))})("doubleClick",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.gameManager.stateManager.characterPermissions[o.character.name+"|"+o.character.edition]&&o.initiativeDoubleClick(n))}),t.k0s(),t.nVh(1,xE,1,1,"ghs-character-initiative",25),t.nrm(2,"ghs-highlight-conditions",26),t.nVh(3,EE,4,4,"div",27),t.nVh(4,RE,6,0,"div",28)}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(6,_E,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.round&&!e.gameManager.stateManager.characterPermissions[e.character.name+"|"+e.character.edition])),t.R7$(),t.vxM(e.short?-1:1),t.R7$(),t.Y8G("entity",e.character)("figure",e.character),t.R7$(),t.vxM((e.bb||e.settingsManager.settings.characterSheet)&&e.settingsManager.settings.characterAttackModifierDeck&&!e.settingsManager.settings.characterAttackModifierDeckPermanent?3:-1),t.R7$(),t.vxM(!e.bb&&e.settingsManager.settings.lootDeck&&e.character.lootCardsVisible?4:-1)}}function GE(i,r){if(1&i&&t.nrm(0,"ghs-character-initiative",25),2&i){const e=t.XpG(2);t.Y8G("figure",e.character)}}function TE(i,r){if(1&i&&t.nrm(0,"ghs-character-initiative",15),2&i){const e=t.XpG(2);t.Y8G("figure",e.character)}}function SE(i,r){1&i&&t.nrm(0,"img",45)}function $E(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",57),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openEntityMenu())})("doubleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.removeShield())}),t.nrm(1,"ghs-action",58),t.k0s()}if(2&i){const e=t.XpG(3);t.R7$(),t.Aen("fh"),t.Y8G("action",e.character.shield)}}function DE(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",57),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openEntityMenu())})("doubleClick",function(){const n=t.eBV(e).$index,o=t.XpG(3);return t.Njj(o.removeRetaliate(n))}),t.nrm(1,"ghs-action",58),t.k0s()}if(2&i){const e=r.$implicit;t.R7$(),t.Aen("fh"),t.Y8G("action",e)}}function IE(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",57),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openEntityMenu())})("doubleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.removeShieldPersistent())}),t.j41(1,"span",59),t.nrm(2,"span",60),t.k0s(),t.nrm(3,"ghs-action",58),t.k0s()}if(2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","%game.card.persistent%"),t.R7$(),t.Aen("fh"),t.Y8G("action",e.character.shieldPersistent)}}function AE(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",57),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openEntityMenu())})("doubleClick",function(){const n=t.eBV(e).$index,o=t.XpG(3);return t.Njj(o.removeRetaliatePersistent(n))}),t.j41(1,"span",59),t.nrm(2,"span",60),t.k0s(),t.nrm(3,"ghs-action",58),t.k0s()}if(2&i){const e=r.$implicit;t.R7$(2),t.Y8G("ghs-label","%game.card.persistent%"),t.R7$(),t.Aen("fh"),t.Y8G("action",e)}}function VE(i,r){if(1&i&&(t.j41(0,"span",46),t.nVh(1,$E,2,3,"span",56),t.Z7z(2,DE,2,3,"span",56,As),t.nVh(4,IE,4,4,"span",56),t.Z7z(5,AE,4,4,"span",56,As),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.vxM(e.character.shield?1:-1),t.R7$(),t.Dyx(e.character.retaliate),t.R7$(2),t.vxM(e.character.shieldPersistent?4:-1),t.R7$(),t.Dyx(e.character.retaliatePersistent)}}function FE(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",61),t.bIt("dragMove",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.dragTokenMove(n))})("dragEnd",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.dragTokenEnd(n))})("dragCancel",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.dragCancel(n))})("singleClick",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.nextIdentity(n))}),t.EFF(1,">"),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","%data.characterToken."+e.character.name+"%")("relative",!0)("screenWidth",!0)}}function XE(i,r){if(1&i&&(t.j41(0,"span",49)(1,"span"),t.EFF(2),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(2),t.SpI("x",e.character.token+(e.character.primaryToken<0?e.token:0))}}function BE(i,r){if(1&i&&t.nrm(0,"span",62),2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.Y8G("ghs-label","%data.characterToken."+a.character.name+"."+e+"%")}}function YE(i,r){if(1&i&&(t.j41(0,"span",49)(1,"span"),t.EFF(2),t.k0s()()),2&i){const e=t.XpG().$index,a=t.XpG(2);t.R7$(2),t.SpI("x",a.character.tokenValues[e]+(a.character.primaryToken==e?a.token:0))}}function NE(i,r){if(1&i&&(t.nVh(0,BE,1,1,"span",62),t.nVh(1,YE,3,1,"span",49)),2&i){const e=r.$index,a=t.XpG(2);t.vxM(a.character.tokenValues[e]+(a.character.primaryToken==e?a.token:0)>0?0:-1),t.R7$(),t.vxM(a.character.tokenValues[e]+(a.character.primaryToken==e?a.token:0)>1?1:-1)}}function zE(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsMinZero"),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Lme(" ",t.bMT(2,2,e.character.health+e.health),"/",e.character.maxHealth," ")}}function LE(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsMinZero"),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Lme(" ",e.character.maxHealth,"/",t.bMT(2,2,e.character.maxHealth-(e.character.health+e.health))," ")}}function UE(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",63),t.bIt("dragMove",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.dragHpMove(n))})("dragEnd",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.dragHpEnd(n))})("dragCancel",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.dragCancel(n))})("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openEntityMenu())})("doubleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.toggleDamageHP())}),t.nrm(1,"img",43),t.nVh(2,zE,3,4,"span"),t.nVh(3,LE,3,4,"span"),t.nrm(4,"span",64),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","game.health")("ghs-label-attribute","title")("relative",!0)("screenWidth",!0)("fastShift",!0),t.R7$(),t.Y8G("ngClass",t.eq3(13,pE,e.settingsManager.settings.damageHP))("src","./assets/images/"+(e.settingsManager.settings.damageHP?"action/damage.svg":"status/health.svg"),t.B4B),t.R7$(),t.vxM(e.settingsManager.settings.damageHP?-1:2),t.R7$(),t.vxM(e.settingsManager.settings.damageHP?3:-1),t.R7$(),t.Y8G("value-sign",e.health)("hideEmpty",!0)("reverse",e.settingsManager.settings.damageHP)("container",!0)}}function qE(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",65),t.bIt("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.removeMarker(n))}),t.nrm(1,"img",66),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(),t.Y8G("src",a.gameManager.characterManager.characterIcon(e),t.B4B)}}function HE(i,r){if(1&i&&t.nrm(0,"img",72),2&i){const e=r.$implicit,a=t.XpG(2),n=a.$implicit,o=a.$index,g=t.XpG(2);t.xc7("z-index",10*o+n.value-e-1),t.Y8G("src","./assets/images"+(g.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+n.name+".svg",t.B4B)}}function KE(i,r){if(1&i&&(t.Z7z(0,HE,1,3,"img",71,t.fX1),t.nI1(2,"ghsRange")),2&i){const e=t.XpG().$implicit;t.Dyx(t.i5U(2,0,t.lJ4(3,fE),e.value-1))}}function WE(i,r){if(1&i&&(t.j41(0,"span",73),t.EFF(1),t.k0s()),2&i){const e=t.XpG(),a=e.$implicit;t.xc7("z-index",10*e.$index+a.value+1),t.R7$(),t.JRh(a.value)}}function JE(i,r){if(1&i&&t.nrm(0,"span",74),2&i){const e=t.XpG();t.xc7("z-index",10*e.$index+e.$implicit.value+2)}}function ZE(i,r){if(1&i&&t.nrm(0,"span",75),2&i){const e=t.XpG();t.xc7("z-index",10*e.$index+e.$implicit.value+3)}}function QE(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",67),t.bIt("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.removeCondition(n))}),t.nrm(1,"img",66),t.nVh(2,KE,3,4),t.nVh(3,WE,2,3,"span",68),t.nVh(4,JE,1,2,"span",69),t.nVh(5,ZE,1,2,"span",70),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.Y8G("ngClass",t.eq3(8,uE,n.settingsManager.settings.fhStyle)),t.R7$(),t.xc7("z-index",10*a+e.value),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+e.name+".svg",t.B4B),t.R7$(),t.vxM(-1!=e.types.indexOf(n.ConditionType.stack)?2:-1),t.R7$(),t.vxM(-1!=e.types.indexOf(n.ConditionType.value)&&-1==e.types.indexOf(n.ConditionType.stack)?3:-1),t.R7$(),t.vxM(-1!=n.character.immunities.indexOf(e.name)?4:-1),t.R7$(),t.vxM(e.permanent?5:-1)}}function tw(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",37),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openEntityMenu())})("doubleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.compact&&n.openCharacterSheet())}),t.k0s(),t.j41(1,"div",38)(2,"div",37),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openEntityMenu())})("doubleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.compact&&n.openCharacterSheet())}),t.k0s(),t.nVh(3,GE,1,1,"ghs-character-initiative",25),t.j41(4,"div",39)(5,"div",37),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openEntityMenu())})("doubleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.compact&&n.openCharacterSheet())}),t.k0s(),t.j41(6,"span",40)(7,"span",41,0)(9,"span",42),t.bIt("dragMove",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.dragTokenMove(n))})("dragEnd",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.dragTokenEnd(n))})("dragCancel",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.dragCancel(n))})("singleClick",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.nextIdentity(n))}),t.nrm(10,"img",43),t.k0s(),t.nVh(11,TE,1,1,"ghs-character-initiative",15),t.j41(12,"span",44),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openEntityMenu())})("doubleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.compact&&n.openCharacterSheet())}),t.EFF(13),t.nVh(14,SE,1,0,"img",45),t.k0s()(),t.nVh(15,VE,7,2,"span",46),t.j41(16,"span",47),t.nVh(17,FE,2,3,"span",48),t.nVh(18,XE,3,1,"span",49),t.Z7z(19,NE,2,2,null,null,t.fX1),t.k0s()(),t.j41(21,"div",50),t.nVh(22,UE,5,15,"div",51),t.j41(23,"div",52),t.Z7z(24,qE,2,1,"span",53,t.fX1),t.k0s(),t.j41(26,"div",54),t.Z7z(27,QE,6,10,"span",55,OE),t.k0s()()()()}if(2&i){const e=t.XpG();t.R7$(3),t.vxM(e.short?3:-1),t.R7$(6),t.Y8G("relative",!0)("screenWidth",!0),t.R7$(),t.Y8G("ngClass",t.eq3(12,mE,e.settingsManager.settings.characterIdentities&&e.character.identities&&e.character.identities.length>1))("src",0!=e.character.identities.length&&e.settingsManager.settings.characterIdentities?e.gameManager.characterManager.characterIdentityIcon(e.character.name,e.character.identity):e.character.iconUrl,t.B4B),t.R7$(),t.vxM(e.compact?11:-1),t.R7$(2),t.SpI(" ",e.characterTitle," "),t.R7$(),t.vxM(e.character.exhausted?14:-1),t.R7$(),t.vxM(e.settingsManager.settings.characterShieldRetaliate?15:-1),t.R7$(2),t.vxM(e.character.token+(e.character.primaryToken<0?e.token:0)>0?17:-1),t.R7$(),t.vxM(e.character.token+(e.character.primaryToken<0?e.token:0)>1?18:-1),t.R7$(),t.Dyx(e.character.tokens),t.R7$(3),t.vxM(e.settingsManager.settings.hideCharacterHP?-1:22),t.R7$(2),t.Dyx(e.character.markers),t.R7$(3),t.Dyx(e.activeConditions)}}function ew(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",79),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openEntityMenu())})("doubleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.compact&&n.openCharacterSheet())}),t.k0s()}}function nw(i,r){1&i&&t.nrm(0,"img",45)}function iw(i,r){if(1&i&&(t.nVh(0,ew,1,0,"div",76),t.j41(1,"div",77,0)(3,"span",78),t.nrm(4,"img",66),t.k0s(),t.EFF(5),t.nVh(6,nw,1,0,"img",45),t.k0s()),2&i){const e=t.XpG();t.vxM(e.character.absent?0:-1),t.R7$(4),t.Y8G("src",e.character.iconUrl,t.B4B),t.R7$(),t.SpI(" ",e.gameManager.characterManager.characterName(e.character,e.character.absent)," "),t.R7$(),t.vxM(e.character.exhausted?6:-1)}}function aw(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",92),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.toggleLootCardsVisible())}),t.nrm(1,"img",93),t.j41(2,"span",94),t.EFF(3),t.k0s()()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(2,CE,e.character.lootCardsVisible)),t.R7$(3),t.JRh(e.character.lootCards.length)}}function ow(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",95),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.toggleAttackModifierDeckVisible())}),t.nrm(1,"img",96),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","game.attackModifiers")("ghs-label-attribute","title")("ngClass",t.eq3(3,wa,e.bb))}}function sw(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",83)(1,"ghs-attackmodifier-draw",97),t.bIt("drawing",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.amAnimationDrawing=n)}),t.k0s()()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(3,ME,e.amAnimationDrawing))("ngClass",t.eq3(5,wa,e.bb)),t.R7$(),t.Y8G("character",e.character)}}function rw(i,r){1&i&&t.nrm(0,"img",99)}function cw(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",98),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openBattleGoals())}),t.nrm(1,"img",66),t.nVh(2,rw,1,0,"img",99),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","game.battleGoals")("ghs-label-attribute","title"),t.R7$(),t.Y8G("src",e.settingsManager.settings.fhStyle?"./assets/images/fh/battlegoals/battle-goal-back-fh.png":"./assets/images/battlegoals/battle-goal-back.png",t.B4B),t.R7$(),t.vxM(e.character.battleGoal&&e.character.battleGoals.length>0?2:-1)}}function lw(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",100),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openItems())})("doubleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openItems(!0))}),t.nrm(1,"img",66),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","game.items")("ghs-label-attribute","title")("ngClass",t.eq3(4,wa,e.bb)),t.R7$(),t.Y8G("src",e.settingsManager.settings.fhStyle?"./assets/images/fh/items/item-back-fh.png":"./assets/images/items/item-back.png",t.B4B)}}function gw(i,r){1&i&&t.nrm(0,"div",86)}function dw(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",87)(1,"div",37),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openEntityMenu())})("doubleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.compact&&n.openCharacterSheet())}),t.k0s(),t.j41(2,"a",101,1),t.bIt("singleClick",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.openSummonDialog(n))}),t.nrm(4,"img",102),t.k0s()()}2&i&&(t.R7$(2),t.Y8G("ghs-label","summon")("ghs-label-attribute","title"))}function hw(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",88)(1,"div",103),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openEntityMenu())}),t.k0s(),t.j41(2,"a",104),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.shortMenu=!n.shortMenu)}),t.nrm(3,"img",105),t.k0s()()}}function _w(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",106),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.addExperience(1))})("doubleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.addExperience(-1))})("dragMove",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.dragXpMove(n))})("dragEnd",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.dragXpEnd(n))})("dragCancel",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.dragCancel(n))}),t.EFF(1),t.nrm(2,"img",107)(3,"span",108),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","game.experience")("ghs-label-attribute","title")("relative",!0)("screenWidth",!0),t.R7$(),t.SpI(" ",e.character.experience+e.experience," "),t.R7$(2),t.Y8G("value-sign",e.experience)("hideEmpty",!0)("container",!0)}}function mw(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",109),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.addLoot(1))})("doubleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.addLoot(-1))})("dragMove",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.dragLootMove(n))})("dragEnd",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.dragLootEnd(n))})("dragCancel",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.dragCancel(n))}),t.EFF(1),t.nrm(2,"img",110)(3,"span",108),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","game.loot")("ghs-label-attribute","title")("relative",!0)("screenWidth",!0),t.R7$(),t.SpI(" ",e.character.loot+e.loot," "),t.R7$(2),t.Y8G("value-sign",e.loot)("hideEmpty",!0)("container",!0)}}function pw(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",80),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openEntityMenu())})("doubleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.compact&&n.openCharacterSheet())}),t.k0s(),t.nVh(1,aw,4,4,"div",81),t.nVh(2,ow,2,5,"span",82),t.nVh(3,sw,2,7,"span",83),t.nVh(4,cw,3,4,"div",84),t.nVh(5,lw,2,6,"div",85),t.nVh(6,gw,1,0,"div",86),t.nVh(7,dw,5,2,"div",87),t.nVh(8,hw,4,0,"div",88),t.j41(9,"div",89)(10,"div",37),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openEntityMenu())})("doubleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.compact&&n.openCharacterSheet())}),t.k0s(),t.nVh(11,_w,4,8,"span",90),t.nVh(12,mw,4,8,"span",91),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.vxM(!e.bb&&e.settingsManager.settings.lootDeck&&e.character.lootCards&&e.character.lootCards.length>0&&!e.settingsManager.settings.hideCharacterLoot?1:-1),t.R7$(),t.vxM((e.bb||e.settingsManager.settings.characterSheet)&&e.settingsManager.settings.characterAttackModifierDeck?2:-1),t.R7$(),t.vxM(!e.bb&&!e.settingsManager.settings.characterSheet||!e.settingsManager.settings.characterAttackModifierDeck||!e.settingsManager.settings.characterAttackModifierAnimate||e.character.attackModifierDeckVisible||e.settingsManager.settings.characterAttackModifierDeckPermanentActive&&e.character.active?-1:3),t.R7$(),t.vxM(e.bb||!e.gameManager.game.scenario||!e.settingsManager.settings.battleGoals||!e.gameManager.roundManager.firstRound&&!e.settingsManager.settings.battleGoalsCharacter&&e.settingsManager.settings.characterSheet&&e.settingsManager.settings.characterAttackModifierDeck?-1:4),t.R7$(),t.vxM(e.settingsManager.settings.characterItems?5:-1),t.R7$(),t.vxM(e.bb?6:-1),t.R7$(),t.vxM(!e.bb&&e.settingsManager.settings.summons?7:-1),t.R7$(),t.vxM(e.compact&&e.short?8:-1),t.R7$(3),t.vxM(e.bb||e.settingsManager.settings.hideCharacterXP?-1:11),t.R7$(),t.vxM(e.bb||e.settingsManager.settings.lootDeck&&(e.settingsManager.settings.alwaysLootDeck||e.gameManager.fhRules())||e.settingsManager.settings.hideCharacterLoot?-1:12)}}function uw(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",111),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.settingsManager.settings.characterSheet?n.openCharacterSheet():n.openEntityMenu())})("doubleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.characterFullView())}),t.nrm(1,"img",66),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ghs-label","character.progress")("ghs-label-attribute","title")("ngClass",t.eq3(4,vE,e.settingsManager.settings.characterHandSize)),t.R7$(),t.Y8G("src",e.character.iconUrl,t.B4B)}}function fw(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",112),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openEntityMenu())})("doubleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openAbilityCards())}),t.EFF(1),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.SpI(" ",e.character.handSize," ")}}function Cw(i,r){if(1&i&&(t.j41(0,"div",10),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.SpI(" ",e.character.level-1,"|4 ")}}function Mw(i,r){if(1&i&&(t.j41(0,"div",11),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.SpI(" ",e.character.level," ")}}function vw(i,r){if(1&i&&(t.j41(0,"div",12),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.SpI(" #",e.character.number," ")}}function Ow(i,r){1&i&&t.nrm(0,"span",115)}function Pw(i,r){1&i&&(t.j41(0,"span",115),t.EFF(1,"|"),t.k0s())}function bw(i,r){1&i&&t.nrm(0,"span",115)}function kw(i,r){if(1&i&&(t.nVh(0,Ow,1,0,"span",115),t.nrm(1,"span",116),t.nVh(2,Pw,2,0,"span",115),t.nVh(3,bw,1,0,"span",115)),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.vxM(0==a?0:-1),t.R7$(),t.Y8G("ghs-label","data.character.traits."+e),t.R7$(),t.vxM(a<n.character.traits.length-1?2:-1),t.R7$(),t.vxM(a==n.character.traits.length-1?3:-1)}}function yw(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",113),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openEntityMenu())})("doubleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.compact&&n.openCharacterSheet())}),t.j41(1,"span",78),t.nrm(2,"img",114),t.k0s(),t.Z7z(3,kw,4,4,null,null,t.fX1),t.k0s()}if(2&i){const e=t.XpG();t.R7$(3),t.Dyx(e.character.traits)}}function xw(i,r){1&i&&(t.j41(0,"span",118),t.EFF(1,"|"),t.k0s())}function Ew(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",117),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openEntityMenu())})("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.removeSpecialAction(n.name))}),t.k0s(),t.nVh(1,xw,2,0,"span",118)}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.Y8G("ghs-label","data.character."+n.character.edition+"."+n.character.name+"."+e.name)("ghs-tooltip","data.character."+n.character.edition+"."+n.character.name+"."+e.name+".hint")("originY","top")("overlayY","bottom")("originX","center")("overlayX","center"),t.R7$(),t.vxM(a<n.specialActions.length-1&&n.specialActions.length>1?1:-1)}}function ww(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",14)(1,"div",37),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openEntityMenu())})("doubleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.compact&&n.openCharacterSheet())}),t.k0s(),t.Z7z(2,Ew,2,7,null,null,PE),t.k0s()}if(2&i){const e=t.XpG();t.R7$(2),t.Dyx(e.specialActions)}}function Rw(i,r){if(1&i&&t.nrm(0,"ghs-standee",119),2&i){const e=r.$implicit,a=t.XpG(3);t.Y8G("ngClass",t.eq3(3,Ea,e.active))("figure",a.character)("entity",e)}}function jw(i,r){if(1&i&&(t.j41(0,"div",22),t.Z7z(1,Rw,1,5,"ghs-standee",119,Is),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Dyx(e.skullSpirits)}}function Gw(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",16),t.nrm(1,"span",7),t.j41(2,"span",19),t.bIt("click",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.openEntitiesMenu(n))}),t.nrm(3,"img",20)(4,"img",21),t.k0s(),t.nVh(5,jw,3,0,"div",22),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.l_i(5,$s,0==e.skullSpiritCount,e.character.off||e.character.exhausted||e.character.health<=0)),t.R7$(2),t.Y8G("ngClass",t.l_i(8,Ds,0==e.skullSpiritCount,e.skullSpiritCount<2))("entityAnimation",0==e.skullSpiritCount),t.R7$(),t.Y8G("src",e.character.iconUrl,t.B4B),t.R7$(2),t.vxM(e.skullSpiritCount?5:-1)}}function Tw(i,r){if(1&i&&(t.j41(0,"div",17),t.nrm(1,"ghs-character-item-list",5),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("character",e.character)}}function Sw(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",18)(1,"div",29)(2,"ghs-attackmodifier-deck",30),t.bIt("before",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.beforeAttackModifierDeck(n))})("after",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.afterAttackModifierDeck(n))}),t.k0s()()()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(2,Ea,e.character.attackModifierDeckVisible||e.settingsManager.settings.characterAttackModifierDeckPermanentActive&&e.character.active)),t.R7$(2),t.Y8G("character",e.character)}}let Vs=(()=>{class i{dialog;overlay;character;titleInput;characterName;summonButton;gameManager=s.E;settingsManager=m.f;characterManager=s.E.characterManager;GameState=T.mk;ConditionType=j.GV;AttackModifierType=Y.Yn;levelDialog=!1;characterTitle="";initiative=-1;health=0;experience=0;loot=0;maxHp=0;token=0;amAnimationDrawing=!1;compact=!1;short=!1;shortMenu=!1;summons=[];skullSpirits=[];summonCount=0;skullSpiritCount=0;activeConditions=[];specialActions=[];bb=!1;constructor(e,a){this.dialog=e,this.overlay=a}ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.characterTitle=s.E.characterManager.characterName(this.character),this.summons=this.character.summons.filter(e=>-1==e.tags.indexOf("cs-skull-spirit")),this.skullSpirits=this.character.summons.filter(e=>-1!=e.tags.indexOf("cs-skull-spirit")),this.summonCount=this.summons.filter(e=>s.E.entityManager.isAlive(e)).length,this.skullSpiritCount=this.skullSpirits.filter(e=>s.E.entityManager.isAlive(e)).length,this.activeConditions=s.E.entityManager.activeConditions(this.character),this.character.immunities.forEach(e=>{this.activeConditions.find(a=>a.name==e)||this.activeConditions.push(new j.BR(e))}),m.f.settings.characterAttackModifierDeckPermanent&&m.f.settings.characterAttackModifierDeckPermanentActive&&s.E.game.state==T.mk.next&&this.character.active&&(this.character.attackModifierDeck.active=!0),this.compact=m.f.settings.characterCompact&&"modern"!=m.f.settings.theme,this.short=!(m.f.settings.abilities&&m.f.settings.stats||"modern"==m.f.settings.theme),this.shortMenu=!1,this.bb=s.E.bbRules()||this.character.bb,this.specialActions=this.character.specialActions.filter(e=>-1!=this.character.tags.indexOf(e.name))}beforeAttackModifierDeck(e){s.E.stateManager.before("updateAttackModifierDeck."+e.type,s.E.characterManager.characterName(this.character),...e.values)}afterAttackModifierDeck(e){this.character.attackModifierDeck=e.deck,s.E.stateManager.after()}exhausted(){this.character.exhausted=!this.character.exhausted,this.character.exhausted?(this.character.off=!0,this.character.active=!1):this.character.off=!1,s.E.sortFigures(this.character)}dragInitiativeMove(e){e>99?e=99:e<0&&(e=0),s.E.game.state==T.mk.next&&0==e&&m.f.settings.initiativeRequired&&(e=1),-1==this.initiative&&(this.initiative=this.character.initiative),this.character.initiative=e,this.character.initiativeVisible=!0,("prism"!=this.character.name||-1==this.character.tags.indexOf("long_rest"))&&(this.character.longRest=!1),99==e&&(this.character.longRest=!0)}dragInitiativeEnd(e){e>99?e=99:e<0&&(e=0),s.E.game.state==T.mk.next&&0==e&&m.f.settings.initiativeRequired&&(e=1),this.character.initiative!=this.initiative&&(this.character.initiative=this.initiative,s.E.stateManager.before("setInitiative",s.E.characterManager.characterName(this.character),""+e),this.character.initiative=e,99==e?this.character.longRest=!0:(!e||"prism"!=this.character.name||-1==this.character.tags.indexOf("long_rest"))&&(this.character.longRest=!1),this.initiative=-1,this.character instanceof q.K&&(this.character.initiativeVisible=!0),s.E.game.state==T.mk.next&&s.E.sortFigures(this.character),s.E.stateManager.after())}toggleFigure(e){if(!this.character.absent)if(s.E.game.state!=T.mk.next||this.character.exhausted||m.f.settings.initiativeRequired&&!(this.character.initiative>0))(m.f.settings.initiativeRequired&&this.character.initiative<=0||s.E.game.state==T.mk.draw)&&this.openInitiativeDialog(e);else{const a=this.character.summons.find(o=>o.active),n=this.character.summons.filter(o=>-1!=o.tags.indexOf("cs-skull-spirit"));m.f.settings.activeSummons&&!a&&this.character.active&&n.length&&!n.find(o=>o.active)?(s.E.stateManager.before("summonInactive",s.E.characterManager.characterName(this.character),"data.summon."+n[0].name),n.forEach(o=>o.tags.push("cs-skull-spirit-turn"))):m.f.settings.activeSummons&&this.character.active&&a?s.E.stateManager.before("summonInactive",s.E.characterManager.characterName(this.character),"data.summon."+a.name):s.E.stateManager.before(this.character.active?"unsetActive":"setActive",s.E.characterManager.characterName(this.character)),s.E.roundManager.toggleFigure(this.character),s.E.stateManager.after()}}nextIdentity(e){if(m.f.settings.characterIdentities&&this.character.identities&&this.character.identities.length>1){let a="blinkblade"==this.character.name&&this.character.tags.find(o=>"time_tokens"===o)&&0==this.character.primaryToken;if((s.E.game.state==T.mk.next||s.E.game.state==T.mk.draw&&0==this.character.identity&&0==this.character.tokenValues[0])&&a)return;let n=this.character.identity+1;n>=this.character.identities.length&&(n=0),s.E.stateManager.before("nextIdentity",s.E.characterManager.characterName(this.character,!1,!1,!1),this.character.name,this.character.identities[this.character.identity],this.character.identities[n],this.character.edition),this.character.identity=n,s.E.stateManager.after(),e.preventDefault()}else this.openEntityMenu()}openInitiativeDialog(e){this.dialog.open(ma,{panelClass:["dialog"],data:this.character,positionStrategy:this.overlay.position().flexibleConnectedTo(e.target).withPositions((0,V.yE)())})}initiativeDoubleClick(e){this.character.active&&this.character.summons.filter(a=>s.E.entityManager.isAlive(a)&&a.state!=lt.N5.new).find((a,n,o)=>a.active&&n<o.length-1)?this.character.summons.forEach(a=>a.active=!1):this.openInitiativeDialog(e)}dragHpMove(e){this.health=e;let a=(0,$.hZ)(this.character.maxHealth);"lightning"==this.character.name&&this.character.tags.find(n=>"unbridled-power"===n)&&(a=Math.max(a,26)),this.character.health+this.health>a&&(this.health=a-this.character.health)}dragHpEnd(e){0!=this.health&&(s.E.stateManager.before("changeHP",s.E.characterManager.characterName(this.character),(0,V.n1)(this.health)),s.E.entityManager.changeHealth(this.character,this.character,this.health),this.health=0,s.E.stateManager.after())}dragXpMove(e){this.experience=e,this.character.experience+this.experience<0&&(this.experience=-this.character.experience)}dragXpEnd(e){0!=this.experience&&(s.E.stateManager.before("changeXP",s.E.characterManager.characterName(this.character),(0,V.n1)(this.experience)),this.character.experience+=this.experience,this.experience=0,s.E.stateManager.after())}addExperience(e){this.experience=e,this.character.experience+this.experience>=0&&(s.E.stateManager.before("changeXP",s.E.characterManager.characterName(this.character),(0,V.n1)(this.experience)),this.character.experience+=this.experience,s.E.stateManager.after()),this.experience=0}dragTokenMove(e){this.token=e,this.character.primaryToken<0&&this.character.token+this.token<0?this.token=-this.character.token:this.character.primaryToken>=0&&this.character.tokenValues[this.character.primaryToken]+this.token<0?this.token=-this.character.tokenValues[this.character.primaryToken]:"blinkblade"==this.character.name&&this.character.tags.find(a=>["time_tokens","resonance_token"].indexOf(a)>=0)&&0==this.character.primaryToken&&this.character.tokenValues[0]+this.token>5&&(this.token=5-this.character.tokenValues[this.character.primaryToken])}dragTokenEnd(e){0!=this.token&&(this.character.primaryToken<0?(s.E.stateManager.before("setCharacterToken",s.E.characterManager.characterName(this.character),this.character.token+this.token),this.character.token+=this.token,this.token=0,s.E.stateManager.after()):(s.E.stateManager.before("setCharacterTokenValue",s.E.characterManager.characterName(this.character),"%data.characterToken."+this.character.name+"."+this.character.tokens[this.character.primaryToken]+"%",this.character.token+this.token),this.character.tokenValues[this.character.primaryToken]+=this.token,"blinkblade"==this.character.name&&this.character.tags.find(a=>["time_tokens","resonance_token"].indexOf(a)>=0)&&0==this.character.primaryToken&&this.character.tokenValues[0]>5&&(this.character.tokenValues[0]=5),this.token=0,s.E.stateManager.after()))}dragLootMove(e){this.loot=e,this.character.loot+this.loot<0&&(this.loot=-this.character.loot)}dragLootEnd(e){0!=this.loot&&(s.E.stateManager.before("changeLoot",s.E.characterManager.characterName(this.character),(0,V.n1)(this.loot)),this.character.loot+=this.loot,this.loot=0,s.E.stateManager.after())}addLoot(e){this.loot=e,this.character.loot+this.loot>=0&&(s.E.stateManager.before("changeLoot",s.E.characterManager.characterName(this.character),(0,V.n1)(this.loot)),this.character.loot+=this.loot,s.E.stateManager.after()),this.loot=0}dragCancel(e){this.health=0,this.experience=0,this.loot=0,this.token=0}openEntityMenu(){this.dialog.open(Xn,{panelClass:["dialog"],data:{entity:this.character,figure:this.character},positionStrategy:this.overlay.position().flexibleConnectedTo(this.characterName).withPositions((0,V.yE)())})}toggleDamageHP(){this.compact?this.openCharacterSheet():m.f.settings.damageHPToggle&&m.f.toggle("damageHP")}openEntitiesMenu(e){this.dialog.open(ra,{panelClass:["dialog"],data:{character:this.character},positionStrategy:this.overlay.position().flexibleConnectedTo(e.target).withPositions((0,V.yE)())})}openSummonDialog(e){this.dialog.open(Eb,{panelClass:["dialog"],data:this.character,positionStrategy:this.overlay.position().flexibleConnectedTo(this.summonButton).withPositions((0,V.yE)("left"))})}openCharacterSheet(){this.dialog.open(Re,{panelClass:["dialog-invert"],data:{character:this.character}})}removeCondition(e){s.E.stateManager.before(...s.E.entityManager.undoInfos(this.character,this.character,"removeCondition"),e.name);const a=this.character.immunities.indexOf(e.name);-1!=a&&this.character.immunities.splice(a,1),e.types.indexOf(j.GV.stackable)&&e.value>1?e.value--:s.E.entityManager.removeCondition(this.character,this.character,e,e.permanent),s.E.stateManager.after()}removeMarker(e){const a=new q.K(s.E.getCharacterData(e),1),n=s.E.characterManager.characterName(a),o=a.name;s.E.stateManager.before(...s.E.entityManager.undoInfos(this.character,this.character,"removeMarker"),n,o),this.character.markers=this.character.markers.filter(g=>g!=e),s.E.stateManager.after()}openBattleGoals(){this.dialog.open(oa,{panelClass:["dialog"],data:{character:this.character,draw:!this.character.battleGoals||0==this.character.battleGoals.length}})}openItems(e=!1){m.f.settings.characterItemsPermanent&&!e?(this.character.itemsVisible=!this.character.itemsVisible,s.E.stateManager.saveLocal(),s.E.uiChange.emit()):0!=this.character.progress.items.length&&!e||this.bb?this.dialog.open(Zo,{panelClass:["dialog"],data:this.character}):this.dialog.open(Bn,{panelClass:["dialog"],data:{edition:s.E.game.edition,select:this.character,affordable:!0}})}characterFullView(){m.f.settings.characterFullView?(s.E.game.figures.forEach(e=>{e instanceof q.K&&(e.fullview=!1)}),this.character.fullview=!0,s.E.stateManager.saveLocal(),s.E.uiChange.emit()):m.f.settings.characterSheet?this.openCharacterSheet():this.openEntityMenu()}toggleAttackModifierDeckVisible(){if(!this.character.attackModifierDeckVisible||m.f.settings.characterAttackModifierDeckPermanent&&m.f.settings.characterAttackModifierDeckPermanentActive&&this.character.active)if(m.f.settings.characterAttackModifierDeckPermanent)this.character.attackModifierDeck.active=!0,this.character.attackModifierDeckVisible=!0,this.character.lootCardsVisible=!1;else if(m.f.settings.automaticAttackModifierFullscreen&&m.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)){this.character.lootCardsVisible=!1;const e=new t.bkB,a=new t.bkB;e.subscribe({next:o=>this.beforeAttackModifierDeck(o)}),a.subscribe({next:o=>this.afterAttackModifierDeck(o)}),this.dialog.open(na,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:{deck:this.character.attackModifierDeck,character:this.character,ally:!1,numeration:""+this.character.number,before:e,after:a}}).closed.subscribe({next:()=>{e.unsubscribe(),a.unsubscribe()}})}else this.character.attackModifierDeck.active=!0,this.character.attackModifierDeckVisible=!0,this.character.lootCardsVisible=!1;else this.character.attackModifierDeck.active=!1,this.character.attackModifierDeckVisible=!1;s.E.stateManager.saveLocal(),s.E.uiChange.emit()}toggleLootCardsVisible(){this.character.lootCardsVisible?this.character.lootCardsVisible=!1:m.f.settings.automaticAttackModifierFullscreen&&m.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)?(this.character.lootCardsVisible=!1,this.openLootDeckDialog()):(this.character.lootCardsVisible=!0,this.character.attackModifierDeck.active=!1,this.character.attackModifierDeckVisible=!1),s.E.stateManager.saveLocal()}openLootDeckDialog(){this.dialog.open(db,{panelClass:["dialog"],data:this.character})}removeShield(){s.E.stateManager.before(...s.E.entityManager.undoInfos(this.character,this.character,"removeEntityShield")),this.character.shield=void 0,s.E.stateManager.after()}removeShieldPersistent(){s.E.stateManager.before(...s.E.entityManager.undoInfos(this.character,this.character,"removeEntityShieldPersistent")),this.character.shieldPersistent=void 0,s.E.stateManager.after()}removeRetaliate(e){let a=JSON.parse(JSON.stringify(this.character.retaliate));a.splice(e,1),a.length>0?s.E.stateManager.before(...s.E.entityManager.undoInfos(this.character,this.character,"setEntityRetaliate"),a.map(n=>"%game.action.retaliate% "+(0,$.hZ)(n.value)+(n.subActions&&n.subActions[0]&&n.subActions[0].type==G.X2.range&&(0,$.hZ)(n.subActions[0].value)>1?" %game.action.range% "+(0,$.hZ)(n.subActions[0].value):"")).join(", ")):s.E.stateManager.before(...s.E.entityManager.undoInfos(this.character,this.character,"removeEntityRetaliate")),this.character.retaliate=a,s.E.stateManager.after()}removeRetaliatePersistent(e){let a=JSON.parse(JSON.stringify(this.character.retaliatePersistent));a.splice(e,1),a.length>0?s.E.stateManager.before(...s.E.entityManager.undoInfos(this.character,this.character,"setEntityRetaliatePersistent"),a.map(n=>"%game.action.retaliate% "+(0,$.hZ)(n.value)+(n.subActions&&n.subActions[0]&&n.subActions[0].type==G.X2.range&&(0,$.hZ)(n.subActions[0].value)>1?" %game.action.range% "+(0,$.hZ)(n.subActions[0].value):"")).join(", ")):s.E.stateManager.before(...s.E.entityManager.undoInfos(this.character,this.character,"removeEntityRetaliatePersistent")),this.character.retaliatePersistent=a,s.E.stateManager.after()}removeSpecialAction(e){s.E.stateManager.before("removeSpecialTags",s.E.characterManager.characterName(this.character),"%data.character."+this.character.edition+"."+this.character.name+"."+e+"%"),this.character.tags=this.character.tags.filter(a=>a!=e),"lightning"==this.character.name&&"careless-charge"==e&&(this.character.immunities=[]),"boneshaper"==this.character.name&&("solid-bones"==e||"unholy-prowess"==e)&&this.character.summons.forEach(a=>{"shambling-skeleton"===a.name&&(a.maxHealth-=1,a.health>a.maxHealth&&(a.health=a.maxHealth),"solid-bones"==e&&(a.movement-=1,a.action=void 0))}),"astral"==this.character.name&&("veil-of-protection"==e&&(this.character.health-=3,this.character.maxHealth-=3,this.character.summons.forEach(a=>{a.health-=3,a.maxHealth-=3})),"imbue-with-life"==e&&(this.character.entityConditions=this.character.entityConditions.filter(a=>a.name!=j.r5.disarm||!a.permanent))),s.E.stateManager.after()}openAbilityCards(){s.E.deckData(this.character,!0).abilities.length>0&&this.dialog.open(Ps,{panelClass:["dialog"],data:{character:this.character}})}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG),t.rXU(zt.hJ))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-character"]],viewQuery:function(a,n){if(1&a&&(t.GBs(lE,5),t.GBs(gE,5),t.GBs(dE,5)),2&a){let o;t.mGM(o=t.lsd())&&(n.titleInput=o.first),t.mGM(o=t.lsd())&&(n.characterName=o.first),t.mGM(o=t.lsd())&&(n.summonButton=o.first)}},inputs:{character:"character"},standalone:!1,decls:21,vars:32,consts:[["characterName",""],["summonButton",""],[1,"summons-container",3,"ngClass"],[1,"character",3,"ngClass"],[3,"entity"],[3,"character"],[1,"stats"],[1,"spacer"],["ghs-pointer-input","",1,"character-sheet-button",3,"ghs-label","ghs-label-attribute","ngClass"],["ghs-pointer-input","",1,"hand-size"],[1,"hand-size"],[1,"character-level"],[1,"player-number"],["ghs-pointer-input","",1,"character-traits"],[1,"special-actions"],[3,"figure"],[1,"summons-container","spirits",3,"ngClass"],[1,"items-container-permanent"],[1,"attack-modifierdeck-container","permanent",3,"ngClass"],[1,"entities-menu",3,"click","ngClass","entityAnimation"],[1,"icon",3,"src"],["src","./assets/images/up.svg",1,"menu"],[1,"summons"],[3,"figure","entity"],[1,"drag-initiative",3,"dragMove","dragEnd","singleClick","doubleClick","ngClass"],[1,"initiative",3,"figure"],[3,"entity","figure"],[1,"attack-modifierdeck-container",3,"ngClass"],[1,"loot-cards-container"],[1,"scroll-container"],[3,"before","after","character"],[1,"attack-modifierdeck-close",3,"click"],[1,"loot-cards"],[1,"loot-card"],[1,"loot-cards-close",3,"click"],[1,"loot-card",3,"click"],[3,"loot","flipped","disableFlip"],["ghs-pointer-input","",1,"entity-menu-container",3,"singleClick","doubleClick"],[1,"column","col-1"],[1,"bar-container"],[1,"title-bar"],[1,"title"],["ghs-pointer-input","",1,"icon",3,"dragMove","dragEnd","dragCancel","singleClick","relative","screenWidth"],[3,"ngClass","src"],["ghs-pointer-input","",1,"name",3,"singleClick","doubleClick"],["src","./assets/images/status/exhausted.svg",1,"ghs-svg","exhausted"],[1,"actions"],[1,"token-container"],["ghs-pointer-input","",1,"token",3,"ghs-label","relative","screenWidth"],[1,"token","value"],[1,"status-bar"],["ghs-pointer-input","",1,"health",3,"ghs-label","ghs-label-attribute","relative","screenWidth","fastShift"],[1,"markers"],["ghs-pointer-input","",1,"marker"],[1,"conditions"],["ghs-pointer-input","",1,"condition",3,"ngClass"],["ghs-pointer-input","",1,"action"],["ghs-pointer-input","",1,"action",3,"singleClick","doubleClick"],[3,"action"],[1,"action-overlay"],[1,"text-white",3,"ghs-label"],["ghs-pointer-input","",1,"token",3,"dragMove","dragEnd","dragCancel","singleClick","ghs-label","relative","screenWidth"],[1,"token",3,"ghs-label"],["ghs-pointer-input","",1,"health",3,"dragMove","dragEnd","dragCancel","singleClick","doubleClick","ghs-label","ghs-label-attribute","relative","screenWidth","fastShift"],[1,"value-overlay",3,"value-sign","hideEmpty","reverse","container"],["ghs-pointer-input","",1,"marker",3,"doubleClick"],[3,"src"],["ghs-pointer-input","",1,"condition",3,"doubleClick","ngClass"],[1,"value",3,"z-index"],[1,"condition","immunity","condition-overlay",3,"z-index"],[1,"condition","permanent","condition-overlay",3,"z-index"],[1,"stack",3,"z-index","src"],[1,"stack",3,"src"],[1,"value"],[1,"condition","immunity","condition-overlay"],[1,"condition","permanent","condition-overlay"],["ghs-pointer-input","",1,"absent-menu"],[1,"title","absent"],[1,"icon"],["ghs-pointer-input","",1,"absent-menu",3,"singleClick","doubleClick"],["ghs-pointer-input","",1,"spacer",3,"singleClick","doubleClick"],["ghs-pointer-input","",1,"loot-cards-button",3,"ngClass"],["ghs-pointer-input","",1,"attack-modifier-button",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"attack-modifier-draw",3,"ngClass"],["ghs-pointer-input","",1,"battlegoals-button",3,"ghs-label","ghs-label-attribute"],["ghs-pointer-input","",1,"items-button",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"bb-spacer"],[1,"summon-dialog"],[1,"short-menu"],[1,"column","col-2"],["ghs-pointer-input","",1,"experience",3,"ghs-label","ghs-label-attribute","relative","screenWidth"],["ghs-pointer-input","",1,"loot",3,"ghs-label","ghs-label-attribute","relative","screenWidth"],["ghs-pointer-input","",1,"loot-cards-button",3,"singleClick","ngClass"],["src","./assets/images/fh/loot-token.png"],[1,"badge"],["ghs-pointer-input","",1,"attack-modifier-button",3,"singleClick","ghs-label","ghs-label-attribute","ngClass"],["src","./assets/images/attackmodifier/icon.png"],[3,"drawing","character"],["ghs-pointer-input","",1,"battlegoals-button",3,"singleClick","ghs-label","ghs-label-attribute"],["src","./assets/images/check.svg",1,"check"],["ghs-pointer-input","",1,"items-button",3,"singleClick","doubleClick","ghs-label","ghs-label-attribute","ngClass"],["ghs-pointer-input","",1,"summon-dialog-button",3,"singleClick","ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg",1,"ghs-svg"],["ghs-pointer-input","",1,"entity-menu-container",3,"singleClick"],["ghs-pointer-input","",1,"toggle-menu",3,"singleClick"],["src","./assets/images/menu.svg",1,"ghs-svg"],["ghs-pointer-input","",1,"experience",3,"singleClick","doubleClick","dragMove","dragEnd","dragCancel","ghs-label","ghs-label-attribute","relative","screenWidth"],["src","./assets/images/status/experience.svg"],[1,"value-overlay",3,"value-sign","hideEmpty","container"],["ghs-pointer-input","",1,"loot",3,"singleClick","doubleClick","dragMove","dragEnd","dragCancel","ghs-label","ghs-label-attribute","relative","screenWidth"],["src","./assets/images/status/loot.svg"],["ghs-pointer-input","",1,"character-sheet-button",3,"singleClick","doubleClick","ghs-label","ghs-label-attribute","ngClass"],["ghs-pointer-input","",1,"hand-size",3,"singleClick","doubleClick"],["ghs-pointer-input","",1,"character-traits",3,"singleClick","doubleClick"],["src","./assets/images/fh/character/traits/trait.svg",1,"ghs-svg"],[1,"divider"],[1,"trait",3,"ghs-label"],["ghs-pointer-input","",1,"special-tag","text-white",3,"singleClick","doubleClick","ghs-label","ghs-tooltip","originY","overlayY","originX","overlayX"],[1,"separator"],[3,"ngClass","figure","entity"]],template:function(a,n){1&a&&(t.nVh(0,yE,6,11,"div",2),t.j41(1,"div",3),t.nrm(2,"ghs-entity-index-key",4)(3,"ghs-character-image",5),t.nVh(4,jE,5,8),t.j41(5,"div",6),t.nVh(6,tw,29,14),t.nVh(7,iw,7,4),t.nrm(8,"span",7),t.nVh(9,pw,13,10),t.nVh(10,uw,2,6,"a",8),t.nVh(11,fw,2,1,"div",9),t.nVh(12,Cw,2,1,"div",10),t.nVh(13,Mw,2,1,"div",11),t.nVh(14,vw,2,1,"div",12),t.nVh(15,yw,5,0,"div",13),t.nVh(16,ww,4,0,"div",14),t.k0s(),t.nrm(17,"ghs-figure-errors",15),t.k0s(),t.nVh(18,Gw,6,11,"div",16),t.nVh(19,Tw,2,1,"div",17),t.nVh(20,Sw,3,4,"div",18)),2&a&&(t.vxM(!n.character.absent&&n.settingsManager.settings.summons?0:-1),t.R7$(),t.xc7("--ghs-character-color",n.character.color),t.Y8G("ngClass",t.zJS(21,hE,[n.character.off||n.character.exhausted||n.character.health<=0||n.character.absent,!n.gameManager.stateManager.characterPermissions[n.character.name+"|"+n.character.edition],n.character.absent,(n.bb||n.settingsManager.settings.characterSheet)&&n.settingsManager.settings.characterAttackModifierDeck&&n.character.attackModifierDeckVisible&&!n.settingsManager.settings.characterAttackModifierDeckPermanent||n.settingsManager.settings.lootDeck&&n.settingsManager.settings.applyLoot&&n.character.lootCardsVisible,n.compact,n.short,n.shortMenu,"fh"==n.settingsManager.settings.theme,"modern"==n.settingsManager.settings.theme,n.character.active&&("modern"==n.settingsManager.settings.theme||n.compact)])),t.R7$(),t.Y8G("entity",n.character),t.R7$(),t.Y8G("character",n.character),t.R7$(),t.vxM(n.character.absent?-1:4),t.R7$(2),t.vxM(n.character.absent?-1:6),t.R7$(),t.vxM(n.character.absent?7:-1),t.R7$(2),t.vxM(n.character.absent?-1:9),t.R7$(),t.vxM(n.bb?-1:10),t.R7$(),t.vxM(n.character.bb||!n.settingsManager.settings.characterHandSize||n.character.absent?-1:11),t.R7$(),t.vxM(n.character.bb&&n.settingsManager.settings.characterHandSize&&!n.character.absent?12:-1),t.R7$(),t.vxM(n.settingsManager.settings.characterHandSize&&!n.character.absent?13:-1),t.R7$(),t.vxM(!n.character.bb&&n.settingsManager.settings.playerNumber?14:-1),t.R7$(),t.vxM(n.settingsManager.settings.characterTraits&&!n.character.absent&&n.character.traits.length>0?15:-1),t.R7$(),t.vxM(n.character.specialActions?16:-1),t.R7$(),t.Y8G("figure",n.character),t.R7$(),t.vxM(!n.character.absent&&n.settingsManager.settings.summons?18:-1),t.R7$(),t.vxM(n.settingsManager.settings.characterItems&&n.settingsManager.settings.characterItemsPermanent&&(n.character.itemsVisible||n.settingsManager.settings.characterItemsPermanentActive&&n.character.active&&n.character.progress.items.length>0)?19:-1),t.R7$(),t.vxM((n.bb||n.settingsManager.settings.characterSheet)&&n.settingsManager.settings.characterAttackModifierDeck&&n.settingsManager.settings.characterAttackModifierDeckPermanent?20:-1))},dependencies:[N.YU,ae,yn,n4,js,xa,u4,xi,pi,Ts,tt,ft,Ei,vi,rt,wi,Fn,hi,Tt],styles:['.attack-modifierdeck-container[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:5;width:0;height:0;visibility:hidden}.attack-modifierdeck-container[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;width:100%;overflow-x:auto;overflow-y:hidden}.attack-modifierdeck-container[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{position:absolute;display:flex;top:calc(var(--ghs-unit) * 1.5);left:calc(var(--ghs-unit) * 21.5);width:calc(var(--ghs-unit) * 37.5);height:calc(var(--ghs-unit) * 10);z-index:5}.attack-modifierdeck-container.active[_ngcontent-%COMP%], .attack-modifierdeck-container.loot-cards-container[_ngcontent-%COMP%], .loot-cards-container.active[_ngcontent-%COMP%], .loot-cards-container.loot-cards-container[_ngcontent-%COMP%]{visibility:visible;width:100%;height:100%}.attack-modifierdeck-container.permanent.active[_ngcontent-%COMP%], .loot-cards-container.permanent.active[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 98);height:calc(var(--ghs-unit) * 15.6)}.attack-modifierdeck-container.permanent.active[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%], .loot-cards-container.permanent.active[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 20)}.attack-modifierdeck-container.permanent.active[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%], .loot-cards-container.permanent.active[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 2.3);left:calc(var(--ghs-unit) * 17);width:calc(var(--ghs-unit) * 45);height:calc(var(--ghs-unit) * 12)}.attack-modifierdeck-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]{position:absolute;display:flex;top:calc(var(--ghs-unit) * .5 / var(--ghs-text-factor) / var(--ghs-text-factor));left:calc(var(--ghs-unit) * 21.5);z-index:3}.attack-modifierdeck-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 8.6666666667 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 13 * var(--ghs-text-factor));margin-right:calc(var(--ghs-unit) * .5 / var(--ghs-text-factor) / var(--ghs-text-factor))}.attack-modifierdeck-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]   ghs-loot[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]   ghs-loot[_ngcontent-%COMP%]{position:absolute;inset:0;display:block}.attack-modifierdeck-container[_ngcontent-%COMP%]   .attack-modifierdeck-close[_ngcontent-%COMP%], .attack-modifierdeck-container[_ngcontent-%COMP%]   .loot-cards-close[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .attack-modifierdeck-close[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .loot-cards-close[_ngcontent-%COMP%]{display:inline-block;position:relative;cursor:zoom-out;top:0;left:0;z-index:2;width:100%;height:100%}.summons-container[_ngcontent-%COMP%]{position:relative;z-index:2;display:flex;align-items:center;transition:max-height calc(var(--ghs-animation-speed) * 2s) ease-out;max-height:100%;min-width:calc(var(--ghs-unit) * 7);max-width:calc(var(--ghs-unit) * 96)}.summons-container.empty[_ngcontent-%COMP%]{max-height:0}.summons-container[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{flex:none;width:calc(var(--ghs-unit) * 10.5);height:100%}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:block;width:auto;height:calc(var(--ghs-unit) * 6);margin-right:calc(var(--ghs-unit) * 1)}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{height:100%;width:auto;filter:var(--ghs-filter-shadow)}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]   img.menu[_ngcontent-%COMP%]{position:absolute;top:50%;left:calc(var(--ghs-unit) * -4);transform:translateY(-50%);width:calc(var(--ghs-unit) * 3.7 * var(--ghs-text-factor));height:auto;filter:var(--ghs-filter-darkgray);opacity:.5}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]:not(.empty){opacity:1;transform:translate(0)}.summons-container[_ngcontent-%COMP%]   .entities-menu.empty[_ngcontent-%COMP%]{opacity:0;max-width:0;height:0;transform:translateY(100%)}.summons-container[_ngcontent-%COMP%]   .entities-menu.disabled[_ngcontent-%COMP%]{cursor:initial;pointer-events:none}.summons-container[_ngcontent-%COMP%]   .entities-menu.disabled[_ngcontent-%COMP%]   img.menu[_ngcontent-%COMP%]{display:none}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]:hover   img.icon[_ngcontent-%COMP%]{opacity:.5}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]:hover   img.menu[_ngcontent-%COMP%]{opacity:1}.summons-container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;max-width:calc(var(--ghs-unit) * 77.5)}.summons-container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   ghs-standee[_ngcontent-%COMP%]{position:relative;margin-bottom:calc(var(--ghs-unit) * 1)}.summons-container.spirits[_ngcontent-%COMP%]   ghs-standee[_ngcontent-%COMP%]{transition:top calc(var(--ghs-animation-speed) * .5s) ease-in-out}.summons-container.spirits[_ngcontent-%COMP%]   ghs-standee.active[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * -5)}.summons-container.off[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{filter:grayscale(100%)}.character[_ngcontent-%COMP%]{position:relative;z-index:1;height:100%;width:calc(var(--ghs-unit) * 98);height:calc(var(--ghs-unit) * 14);background-color:var(--ghs-character-color);background-image:url(char-mat.5a0fee77df1ff44e.png),url(char-mat.5a0fee77df1ff44e.png);background-blend-mode:multiply,overlay;background-size:100% 100%;display:flex;--ghs-character-color: #000;border-radius:calc(var(--ghs-unit) * .5);filter:var(--ghs-filter-outline);transition:background-color calc(var(--ghs-animation-speed) * .15s) ease-in-out,background-image calc(var(--ghs-animation-speed) * .15s) ease-in-out,background-blend-mode calc(var(--ghs-animation-speed) * .15s) ease-in-out}.character.dimmed[_ngcontent-%COMP%]{background-color:var(--ghs-color-gray);background-image:url(char-mat.5a0fee77df1ff44e.png);background-blend-mode:multiply}.character.dimmed[_ngcontent-%COMP%]   ghs-character-image[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   ghs-character-initiative[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .summon-dialog[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .short-menu[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .player-number[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]{filter:grayscale(.15);opacity:.5}.character[_ngcontent-%COMP%]   ghs-entity-index-key[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 5);left:calc(var(--ghs-unit) * 3.2);z-index:6}.character[_ngcontent-%COMP%]   ghs-character-image[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 9.5);height:calc(var(--ghs-unit) * 9.5);margin:calc(var(--ghs-unit) * 2.1) calc(var(--ghs-unit) * 3.4);left:calc(var(--ghs-unit) * 2.4)}.character[_ngcontent-%COMP%]   ghs-character-initiative[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   ghs-character-image[_ngcontent-%COMP%]{z-index:2}.character[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 2.1);left:calc(var(--ghs-unit) * 6);width:calc(var(--ghs-unit) * 9.5);height:calc(var(--ghs-unit) * 9.5);z-index:4}.character[_ngcontent-%COMP%]   .drag-initiative.dragging[_ngcontent-%COMP%]{left:0!important;width:100%!important}.character[_ngcontent-%COMP%]   ghs-highlight-conditions[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 10.5);bottom:calc(var(--ghs-unit) * 2.5);z-index:20}.character[_ngcontent-%COMP%]   .entity-menu-container[_ngcontent-%COMP%]{cursor:pointer;position:absolute;inset:0}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{height:100%;display:flex;flex-basis:100%;cursor:pointer;margin-left:calc(var(--ghs-unit) * 1)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:flex-start}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 13);max-width:calc(var(--ghs-unit) * 10);overflow:visible}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .bar-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:flex-start}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-2[_ngcontent-%COMP%]{width:auto;z-index:2}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]{display:flex;align-items:center;z-index:2}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5);color:var(--ghs-color-white);text-shadow:var(--ghs-outline);display:flex;align-items:center;white-space:nowrap}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:calc(var(--ghs-unit) * 5.5);margin-left:calc(var(--ghs-unit) * -1.1);margin-right:calc(var(--ghs-unit) * .5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:auto}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   img.exhausted[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1);height:calc(var(--ghs-unit) * 4);width:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .token-container[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--ghs-color-white);font-family:var(--ghs-font-text);margin-left:calc(var(--ghs-unit) * .5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .token-container[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.7);margin:0 calc(var(--ghs-unit) * .1)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .token-container[_ngcontent-%COMP%]   .token.placeholder[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * -.5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{position:relative;display:flex;margin-left:calc(var(--ghs-unit) * .5);font-size:calc(var(--ghs-unit) * 2)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{position:relative;margin-left:calc(var(--ghs-unit) * .5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]:hover{transform:translate(50%,50%) scale(2);transform-origin:center center;z-index:999}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]:hover:before{content:" ";position:absolute;top:calc(var(--ghs-unit) * -1);left:calc(var(--ghs-unit) * -1);right:calc(var(--ghs-unit) * -1);bottom:calc(var(--ghs-unit) * -1);background-color:var(--ghs-color-darkgray);opacity:.5;border-radius:calc(var(--ghs-unit) * 1)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .action-overlay[_ngcontent-%COMP%]{position:absolute;z-index:1;top:calc(var(--ghs-unit) * 1);left:calc(var(--ghs-unit) * -.5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .status-bar[_ngcontent-%COMP%]{display:flex;align-items:center;z-index:2;touch-action:none}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));width:auto}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]   img.damage[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) brightness(.7) var(--ghs-filter-outline-thin-black)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]   .value-overlay[_ngcontent-%COMP%]{position:absolute;left:100%;top:50%;transform:translateY(-50%);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor));z-index:1000}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;max-height:calc(var(--ghs-unit) * 7 * var(--ghs-text-factor));padding:0 calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));background-color:var(--ghs-color-darkgray);border-radius:100%;height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));margin-right:calc(var(--ghs-unit) * -1 * var(--ghs-text-factor));border-width:calc(var(--ghs-unit) * .4);border-style:solid;border-color:var(--ghs-color-gray)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.7 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 2.7 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]{position:relative;display:flex}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;margin-right:calc(var(--ghs-unit) * -.5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));overflow:visible}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));margin:0}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img.stack[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * -2 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition.condition-overlay[_ngcontent-%COMP%]{position:absolute;width:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));top:0;left:0;pointer-events:none;z-index:2}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));color:var(--ghs-color-white);position:absolute;top:calc(var(--ghs-unit) * 2.1 * var(--ghs-text-factor));left:50%;text-shadow:none;transform:translate(-50%)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:hover{transform:scale(2);transform-origin:center center;z-index:999}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw[_ngcontent-%COMP%]{position:relative;z-index:999;width:0;height:0;top:50%;left:calc(var(--ghs-unit) * -3);overflow:visible}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw[_ngcontent-%COMP%]   ghs-attackmodifier-draw[_ngcontent-%COMP%]{position:absolute;width:0;height:0}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw.drawing[_ngcontent-%COMP%]   ghs-attackmodifier-draw[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 18);height:calc(var(--ghs-unit) * 12)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;align-self:center;z-index:1}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor) * var(--ghs-text-factor));height:auto;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%]:hover, .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%]:hover, .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%]:hover, .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%]:hover{opacity:.7}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.disabled[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.disabled[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.disabled[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.disabled[_ngcontent-%COMP%]{pointer-events:none}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.loot-cards-button[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.loot-cards-button[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.loot-cards-button[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.loot-cards-button[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{position:absolute;bottom:calc(var(--ghs-unit) * -1.5 * var(--ghs-text-factor));right:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));color:var(--ghs-color-white)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.battlegoals-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.items-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.battlegoals-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.items-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.battlegoals-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.items-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.battlegoals-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.items-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));border-radius:calc(var(--ghs-unit) * .3 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.battlegoals-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.items-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.battlegoals-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.items-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.battlegoals-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.items-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.battlegoals-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.items-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-70%,-50%);width:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));filter:var(--ghs-filter-green) var(--ghs-filter-outline)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.attack-modifier-button.bb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.attack-modifier-button.bb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.attack-modifier-button.bb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.attack-modifier-button.bb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor) * var(--ghs-text-factor));height:auto}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.items-button.bb[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.items-button.bb[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.items-button.bb[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.items-button.bb[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .bb-spacer[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 7 / var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));filter:var(--ghs-filter-shadow);width:calc(var(--ghs-unit) * 6.5);margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));margin-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .experience.experience[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot.experience[_ngcontent-%COMP%]{color:var(--ghs-color-blue)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .experience.loot[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot.loot[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.character.absent[_ngcontent-%COMP%]{cursor:initial;opacity:.6}.character.absent[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{cursor:initial}.character[_ngcontent-%COMP%]   .absent-menu[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:calc(var(--ghs-unit) * 82);height:calc(var(--ghs-unit) * 14);cursor:pointer;z-index:2}.character[_ngcontent-%COMP%]   .summon-dialog[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .short-menu[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .summon-dialog-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .toggle-menu[_ngcontent-%COMP%]{position:relative;display:flex;width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));cursor:pointer;font-size:calc(var(--ghs-unit) * 10 * var(--ghs-text-factor));color:var(--ghs-color-gray);filter:var(--ghs-filter-gray);stroke:var(--ghs-color-black);stroke-width:calc(var(--ghs-unit) * 1.5)}.character[_ngcontent-%COMP%]   .summon-dialog-button[_ngcontent-%COMP%]:hover, .character[_ngcontent-%COMP%]   .toggle-menu[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white);filter:var(--ghs-filter-white)}.character[_ngcontent-%COMP%]   .summon-dialog-button.toggle-menu[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .toggle-menu.toggle-menu[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   ghs-figure-errors[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 14.5);top:50%;transform:translateY(-50%);z-index:99}.character[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]{position:relative;cursor:pointer;height:100%;width:calc(var(--ghs-unit) * 10);display:flex;justify-content:center;align-items:center;margin-right:calc(var(--ghs-unit) * 4);margin-left:calc(var(--ghs-unit) * 2)}.character[_ngcontent-%COMP%]   .character-sheet-button.hand-size-margin[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 4.5)}.character[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 8);width:auto;filter:var(--ghs-filter-shadow)}.character[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%]{position:absolute;right:calc(var(--ghs-unit) * 14);top:calc(var(--ghs-unit) * 4);width:calc(var(--ghs-unit) * 4.2);height:calc(var(--ghs-unit) * 5);display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.4);padding-right:calc(var(--ghs-unit) * .4);z-index:1}.character[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%]:after{content:" ";position:absolute;inset:0;background-color:var(--ghs-character-color);-webkit-mask-image:url(hand-size-mask.5857c02745e3d418.svg);mask-image:url(hand-size-mask.5857c02745e3d418.svg);-webkit-mask-size:100%;mask-size:100%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;filter:brightness(1.6);z-index:-1}.character[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]{position:absolute;right:calc(var(--ghs-unit) * 13.3);top:calc(var(--ghs-unit) * 10);width:calc(var(--ghs-unit) * 4.2);height:calc(var(--ghs-unit) * 5);display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.4);padding-right:calc(var(--ghs-unit) * .4);z-index:1}.character[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:0;left:calc(var(--ghs-unit) * -.5);bottom:0;right:0;background-color:var(--ghs-character-color);-webkit-mask-image:url(level.38e1f58a07dc5898.svg);mask-image:url(level.38e1f58a07dc5898.svg);-webkit-mask-size:100%;mask-size:100%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;z-index:-1}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 24.5);top:calc(var(--ghs-unit) * .5);width:calc(var(--ghs-unit) * 33);height:calc(var(--ghs-unit) * 2.64);display:flex;justify-content:space-evenly;align-items:center}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:0;background-color:var(--ghs-character-color);-webkit-mask-image:url(outer-mask.f0af43cfab648186.svg);mask-image:url(outer-mask.f0af43cfab648186.svg);-webkit-mask-size:100%;mask-size:100%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;z-index:0}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]:after{content:" ";position:absolute;inset:0;background-color:var(--ghs-character-color);-webkit-mask-image:url(inner-mask.f2d18d4a7559b09e.svg);mask-image:url(inner-mask.f2d18d4a7559b09e.svg);-webkit-mask-size:100%;mask-size:100%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;filter:brightness(.5);z-index:1}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]   .trait[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.5);color:var(--ghs-character-color);z-index:2}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{position:absolute;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 1.8);height:calc(var(--ghs-unit) * 1.8);left:0;top:50%;transform:translateY(-45%) rotate(45deg);border:calc(var(--ghs-unit) * .2) solid var(--ghs-character-color);z-index:2}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:110%;width:auto;filter:var(--ghs-filter-white);transform:rotate(-45deg);z-index:1}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:0;background-color:var(--ghs-character-color);z-index:0;filter:brightness(.5)}.character[_ngcontent-%COMP%]   .player-number[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 1.8);top:calc(var(--ghs-unit) * 4.3);width:calc(var(--ghs-unit) * 5);height:calc(var(--ghs-unit) * 5);display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.7);z-index:1;border:calc(var(--ghs-unit) * .2) solid var(--ghs-color-gray);border-top-left-radius:80%;border-bottom-left-radius:80%;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}.character[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 18 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 62 * var(--ghs-text-factor));bottom:calc(var(--ghs-unit) * .5);color:var(--ghs-color-white);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2);display:flex;justify-content:center;align-items:center}.character[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * .2 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]:before{transition:filter calc(var(--ghs-animation-speed) * .15s) ease-in-out}.character.off[_ngcontent-%COMP%]{background-color:var(--ghs-color-gray);background-image:url(char-mat.5a0fee77df1ff44e.png);background-blend-mode:multiply}.character.off[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .summon-dialog[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .short-menu[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]:before{filter:grayscale(1)!important}.character.denied[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .attack-modifierdeck-close[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .loot-cards-close[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{pointer-events:initial}.character.fh[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]:after{top:calc(var(--ghs-unit) * -.5)}.character.short[_ngcontent-%COMP%]:not(.compact){width:calc(var(--ghs-unit) * 57);height:calc(var(--ghs-unit) * 28);background-image:url(char-mat-short.a094776e83c7bcfc.png),url(char-mat-short.a094776e83c7bcfc.png)}.character.short[_ngcontent-%COMP%]:not(.compact)   ghs-character-image[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * 2.8) calc(var(--ghs-unit) * 2)}.character.short[_ngcontent-%COMP%]:not(.compact)   ghs-highlight-conditions[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 9);bottom:calc(var(--ghs-unit) * 16)}.character.short[_ngcontent-%COMP%]:not(.compact)   .drag-initiative[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 2.8);left:calc(var(--ghs-unit) * 4.3)}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 2);right:calc(var(--ghs-unit) * 2);height:calc(var(--ghs-unit) * 26.5);flex-wrap:wrap}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 12);width:100%;max-width:initial;flex-direction:row;justify-content:flex-start;align-items:center}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   ghs-character-initiative[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 10);margin-top:calc(var(--ghs-unit) * 1);margin-left:initial}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 2);margin-right:calc(var(--ghs-unit) * 2);margin-top:calc(var(--ghs-unit) * 2);height:auto}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 16);left:calc(var(--ghs-unit) * 0);right:initial}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 20.5);left:calc(var(--ghs-unit) * .2);right:initial}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .player-number[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 4.8);left:calc(var(--ghs-unit) * -6.7)}.character.compact[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 10.25);background-image:url(char-mat_compact.b0d0dd33f05dffe7.png),url(char-mat_compact.b0d0dd33f05dffe7.png)}.character.compact[_ngcontent-%COMP%]   ghs-entity-index-key[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 3.1)}.character.compact[_ngcontent-%COMP%]   ghs-character-image[_ngcontent-%COMP%], .character.compact[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]{display:none}.character.compact[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 2.5);left:calc(var(--ghs-unit) * 6.5);width:calc(var(--ghs-unit) * 5);height:calc(var(--ghs-unit) * 5)}.character.compact[_ngcontent-%COMP%]   .attack-modifierdeck-container[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 1 / var(--ghs-text-factor));left:calc(var(--ghs-unit) * 13);width:calc(var(--ghs-unit) * 30 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 8 * var(--ghs-text-factor))}.character.compact[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * .5 / var(--ghs-text-factor) / var(--ghs-text-factor));left:calc(var(--ghs-unit) * 8)}.character.compact[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 6 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 9 * var(--ghs-text-factor))}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 7)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%], .character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .bar-container[_ngcontent-%COMP%]{flex-direction:row;justify-content:flex-start;align-items:center}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * .5);margin-left:calc(var(--ghs-unit) * -.5)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4.5)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 7 * var(--ghs-text-factor));padding-top:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-2[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 7)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%], .character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 6)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw.drawing[_ngcontent-%COMP%]   ghs-attackmodifier-draw[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 13.5);height:calc(var(--ghs-unit) * 9)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 1.4);right:calc(var(--ghs-unit) * 2);left:initial}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 6);right:calc(var(--ghs-unit) * 1.8);left:initial}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 11)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .player-number[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 3.3);left:calc(var(--ghs-unit) * 1.7);width:calc(var(--ghs-unit) * 3.5);height:calc(var(--ghs-unit) * 3.5);font-size:calc(var(--ghs-unit) * 2);border-radius:80%}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]{display:none}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 10);width:calc(var(--ghs-unit) * 70);justify-content:flex-start}.character.compact.short[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 57)}.character.compact.short[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 2)}.character.compact.short[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * .5)}.character.compact.short[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3);white-space:initial}.character.compact.short[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .status-bar[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{width:auto}.character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1.5)}.character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .summon-dialog[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-2[_ngcontent-%COMP%]{display:none}.character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .short-menu[_ngcontent-%COMP%]{position:absolute;top:0;right:calc(var(--ghs-unit) * 6);bottom:0}.character.compact.short.menu[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   ghs-highlight-conditions[_ngcontent-%COMP%]{display:none}.character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 4.5)}.character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{display:none}.character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .summon-dialog[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-2[_ngcontent-%COMP%]{display:inherit}.character.modern[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 16);border-top-left-radius:calc(var(--ghs-unit) * 13);border-top-right-radius:calc(var(--ghs-unit) * 12);border-bottom-right-radius:calc(var(--ghs-unit) * 12);background-image:url(char-mat_modern.2238b82519930f08.png);background-blend-mode:hard-light;filter:none;overflow:hidden}.character.modern.dimmed[_ngcontent-%COMP%]{background-image:url(char-mat_modern.2238b82519930f08.png)}.character.modern[_ngcontent-%COMP%]   ghs-entity-index-key[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * .5);left:calc(var(--ghs-unit) * 13.7)}.character.modern[_ngcontent-%COMP%]   ghs-character-image[_ngcontent-%COMP%], .character.modern[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{top:0;left:0;width:calc(var(--ghs-unit) * 16);height:calc(var(--ghs-unit) * 16);margin:0}.character.modern[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:grayscale(1) brightness(.3)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 2.5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * -1 / var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4.5);filter:grayscale(1) brightness(.3);margin-left:calc(var(--ghs-unit) * -.5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .status-bar[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 2.5);min-height:calc(var(--ghs-unit) * 5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 5.5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .summon-dialog-button[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .col-2[_ngcontent-%COMP%]{padding-top:calc(var(--ghs-unit) * 5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 6.5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * 13.9);top:0}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]:after{top:calc(var(--ghs-unit) * -.5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 18);top:initial;bottom:0}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]:before{transform:rotate(180deg)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]:after{transform:rotate(180deg)}.character.modern[_ngcontent-%COMP%]   .attack-modifierdeck-container[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 3 / var(--ghs-text-factor) / var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * .5 / var(--ghs-text-factor) / var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 10 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 15 * var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 17);width:calc(var(--ghs-unit) * 55);justify-content:flex-start}']})}return i})();var xn=M(49819),En=M(93417);const St=i=>[i],nn=(i,r)=>r.edition+"-"+r.name;function $w(i,r){1&i&&t.nrm(0,"div",2)}function Dw(i,r){if(1&i&&(t.j41(0,"th")(1,"span",4),t.nrm(2,"img",5),t.j41(3,"span",6),t.EFF(4),t.k0s()()()),2&i){const e=r.$implicit,a=t.XpG();t.R7$(2),t.Y8G("src",e.iconUrl,t.B4B),t.R7$(2),t.SpI(" ",a.gameManager.characterManager.characterName(e)," ")}}function Iw(i,r){1&i&&(t.j41(0,"th"),t.nrm(1,"span",3),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","scenario.stats.total"))}function Aw(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s(),t.j41(2,"span",7),t.EFF(3),t.k0s(),t.j41(4,"span",8),t.EFF(5),t.k0s()),2&i){const e=t.XpG().$index,a=t.XpG();t.R7$(),t.JRh(a.scenarios[e][0]),t.R7$(2),t.JRh(a.scenarios[e][1]),t.R7$(2),t.JRh(a.scenarios[e][2])}}function Vw(i,r){if(1&i&&(t.j41(0,"td"),t.nVh(1,Aw,6,3),t.k0s()),2&i){const e=r.$index,a=t.XpG();t.R7$(),t.vxM(a.scenarios[e]&&a.scenarios[e].length>2?1:-1)}}function Fw(i,r){if(1&i&&(t.j41(0,"td")(1,"span"),t.EFF(2),t.k0s(),t.j41(3,"span",7),t.EFF(4),t.k0s(),t.j41(5,"span",8),t.EFF(6),t.k0s()()),2&i){const e=t.XpG();t.R7$(2),t.JRh(e.scenarios[e.characters.length][0]),t.R7$(2),t.JRh(e.scenarios[e.characters.length][1]),t.R7$(2),t.JRh(e.scenarios[e.characters.length][2])}}function Xw(i,r){if(1&i&&(t.j41(0,"td"),t.nrm(1,"span",9)(2,"span",9)(3,"span",9),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.dealtDamage")("ghs-label-args",t.eq3(15,St,e.scenarioStats.dealtDamage))("ghs-tooltip","scenario.stats.dealtDamage.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.monsterDamage")("ghs-label-args",t.eq3(17,St,e.scenarioStats.monsterDamage))("ghs-tooltip","scenario.stats.monsterDamage.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.otherDamage")("ghs-label-args",t.eq3(19,St,e.scenarioStats.otherDamage))("ghs-tooltip","scenario.stats.otherDamage.hint")}}function Bw(i,r){if(1&i&&(t.j41(0,"td"),t.nrm(1,"span",9)(2,"span",9)(3,"span",9),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.dealtDamage")("ghs-label-args",t.eq3(15,St,e.overall.dealtDamage))("ghs-tooltip","scenario.stats.dealtDamage.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.monsterDamage")("ghs-label-args",t.eq3(17,St,e.overall.monsterDamage))("ghs-tooltip","scenario.stats.monsterDamage.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.otherDamage")("ghs-label-args",t.eq3(19,St,e.overall.otherDamage))("ghs-tooltip","scenario.stats.otherDamage.hint")}}function Yw(i,r){if(1&i&&(t.j41(0,"td"),t.nrm(1,"span",9)(2,"span",9),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.heals")("ghs-label-args",t.eq3(10,St,e.scenarioStats.heals))("ghs-tooltip","scenario.stats.heals.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.healedDamage")("ghs-label-args",t.eq3(12,St,e.scenarioStats.healedDamage))("ghs-tooltip","scenario.stats.healedDamage.hint")}}function Nw(i,r){if(1&i&&(t.j41(0,"td"),t.nrm(1,"span",9)(2,"span",9),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.heals")("ghs-label-args",t.eq3(10,St,e.overall.heals))("ghs-tooltip","scenario.stats.heals.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.healedDamage")("ghs-label-args",t.eq3(12,St,e.overall.healedDamage))("ghs-tooltip","scenario.stats.healedDamage.hint")}}function zw(i,r){if(1&i&&t.nrm(0,"span",12),2&i){const e=t.XpG().$implicit;t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.normalKills")("ghs-label-args",t.eq3(5,St,e.scenarioStats.normalKills))("ghs-tooltip","scenario.stats.normalKills.hint")}}function Lw(i,r){if(1&i&&t.nrm(0,"span",9),2&i){const e=t.XpG().$implicit;t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.eliteKills")("ghs-label-args",t.eq3(5,St,e.scenarioStats.eliteKills))("ghs-tooltip","scenario.stats.eliteKills.hint")}}function Uw(i,r){if(1&i&&t.nrm(0,"span",9),2&i){const e=t.XpG().$implicit;t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.bossKills")("ghs-label-args",t.eq3(5,St,e.scenarioStats.bossKills))("ghs-tooltip","scenario.stats.bossKills.hint")}}function qw(i,r){if(1&i&&(t.j41(0,"td"),t.nVh(1,zw,1,7,"span",10),t.nVh(2,Lw,1,7,"span",11),t.nVh(3,Uw,1,7,"span",11),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.vxM(e.scenarioStats.normalKills?1:-1),t.R7$(),t.vxM(e.scenarioStats.eliteKills?2:-1),t.R7$(),t.vxM(e.scenarioStats.bossKills?3:-1)}}function Hw(i,r){if(1&i&&t.nrm(0,"span",12),2&i){const e=t.XpG(2);t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.normalKills")("ghs-label-args",t.eq3(5,St,e.overall.normalKills))("ghs-tooltip","scenario.stats.normalKills.hint")}}function Kw(i,r){if(1&i&&t.nrm(0,"span",9),2&i){const e=t.XpG(2);t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.eliteKills")("ghs-label-args",t.eq3(5,St,e.overall.eliteKills))("ghs-tooltip","scenario.stats.eliteKills.hint")}}function Ww(i,r){if(1&i&&t.nrm(0,"span",9),2&i){const e=t.XpG(2);t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.bossKills")("ghs-label-args",t.eq3(5,St,e.overall.bossKills))("ghs-tooltip","scenario.stats.bossKills.hint")}}function Jw(i,r){if(1&i&&(t.j41(0,"td"),t.nVh(1,Hw,1,7,"span",10),t.nVh(2,Kw,1,7,"span",11),t.nVh(3,Ww,1,7,"span",11),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.vxM(e.overall.normalKills?1:-1),t.R7$(),t.vxM(e.overall.eliteKills?2:-1),t.R7$(),t.vxM(e.overall.bossKills?3:-1)}}function Zw(i,r){if(1&i&&(t.j41(0,"td"),t.nrm(1,"span",9)(2,"span",9),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.maxDealtDamage")("ghs-label-args",t.eq3(10,St,e.scenarioStats.maxDealtDamage))("ghs-tooltip","scenario.stats.maxDealtDamage.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.maxDamage")("ghs-label-args",t.eq3(12,St,e.scenarioStats.maxDamage))("ghs-tooltip","scenario.stats.maxDamage.hint")}}function Qw(i,r){if(1&i&&(t.j41(0,"td"),t.nrm(1,"span",9)(2,"span",9),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.maxDealtDamage")("ghs-label-args",t.eq3(10,St,e.overall.maxDealtDamage))("ghs-tooltip","scenario.stats.maxDealtDamage.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.maxDamage")("ghs-label-args",t.eq3(12,St,e.overall.maxDamage))("ghs-tooltip","scenario.stats.maxDamage.hint")}}function t7(i,r){if(1&i&&(t.j41(0,"td"),t.nrm(1,"span",9)(2,"span",9)(3,"span",9),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.gold")("ghs-label-args",t.eq3(15,St,e.scenarioStats.gold))("ghs-tooltip","scenario.stats.gold.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.xp")("ghs-label-args",t.eq3(17,St,e.scenarioStats.xp))("ghs-tooltip","scenario.stats.xp.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.treasures")("ghs-label-args",t.eq3(19,St,e.scenarioStats.treasures))("ghs-tooltip","scenario.stats.treasures.hint")}}function e7(i,r){if(1&i&&(t.j41(0,"td"),t.nrm(1,"span",9)(2,"span",9)(3,"span",9),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.gold")("ghs-label-args",t.eq3(15,St,e.overall.gold))("ghs-tooltip","scenario.stats.gold.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.xp")("ghs-label-args",t.eq3(17,St,e.overall.xp))("ghs-tooltip","scenario.stats.xp.hint"),t.R7$(),t.Aen("fh"),t.Y8G("ghs-label","scenario.stats.treasures")("ghs-label-args",t.eq3(19,St,e.overall.treasures))("ghs-tooltip","scenario.stats.treasures.hint")}}let Fs=(()=>{class i{character;characters=[];scenarios=[];overall=new xn.yn;retired=!1;available=!1;gameManager=s.E;constructor(e){this.character=e}ngOnInit(){this.update()}update(){this.character?this.characters=[this.character]:(this.characters=s.E.game.figures.filter(e=>e instanceof q.K).map(e=>{const a=new q.K(e,e.level);return a.fromModel(e.toModel()),a}),this.retired&&this.characters.push(...s.E.game.party.retirements.map(e=>{const a=new q.K(s.E.getCharacterData(e.name,e.edition),e.level);return a.fromModel(e),a})),this.available&&this.characters.push(...s.E.game.party.availableCharacters.map(e=>{const a=new q.K(s.E.getCharacterData(e.name,e.edition),e.level);return a.fromModel(e),a}))),this.characters.forEach((e,a)=>{e.scenarioStats=new xn.yn,this.scenarios[a]=[0,0,0],e.progress.scenarioStats.length&&(e.scenarioStats=this.scenarioStatisticsSum(e.progress.scenarioStats),this.scenarios[a]=[e.progress.scenarioStats.length,e.progress.scenarioStats.filter(n=>n.success).length,e.progress.scenarioStats.filter(n=>!n.success).length])}),this.overall=this.scenarioStatisticsSum(this.characters.map(e=>e.scenarioStats)),this.scenarios[this.characters.length]=this.scenarios.reduce((e,a)=>[e[0]+a[0],e[1]+a[1],e[2]+a[2]])}scenarioStatisticsSum(e){let a=new xn.yn,n=this.damageStatisticsSum(e);return a.dealtDamage=n.dealtDamage,a.monsterDamage=n.monsterDamage,a.otherDamage=n.otherDamage,a.healedDamage=n.healedDamage,a.heals=n.monsterDamage,a.normalKills=n.normalKills,a.eliteKills=n.eliteKills,a.bossKills=n.bossKills,a.exhausts=n.exhausts,a.maxDealtDamage=n.maxDealtDamage,a.maxDamage=n.maxDamage,e.length&&(a.gold=e.map(o=>o.gold).reduce((o,g)=>o+g),a.xp=e.map(o=>o.xp).reduce((o,g)=>o+g),a.treasures=e.map(o=>o.treasures).reduce((o,g)=>o+g),a.loot=e.map(o=>o.loot).reduce((o,g)=>{let _={};return _.arrowvine=(o.arrowvine||0)+(g.arrowvine||0),_.axenut=(o.axenut||0)+(g.axenut||0),_.corpsecap=(o.corpsecap||0)+(g.corpsecap||0),_.flamefruit=(o.flamefruit||0)+(g.flamefruit||0),_.hide=(o.hide||0)+(g.hide||0),_.lumber=(o.lumber||0)+(g.lumber||0),_.metal=(o.metal||0)+(g.metal||0),_.money=(o.money||0)+(g.money||0),_.random_item=(o.random_item||0)+(g.random_item||0),_.rockroot=(o.rockroot||0)+(g.rockroot||0),_.snowthistle=(o.snowthistle||0)+(g.snowthistle||0),_}),a.summons=this.damageStatisticsSum(e.filter(o=>o.summons).map(o=>o.summons))),a}damageStatisticsSum(e){let a=new xn.F3;return e.length&&(a.dealtDamage=e.map(n=>n.dealtDamage).reduce((n,o)=>n+o),a.monsterDamage=e.map(n=>n.monsterDamage).reduce((n,o)=>n+o),a.otherDamage=e.map(n=>n.otherDamage).reduce((n,o)=>n+o),a.healedDamage=e.map(n=>n.healedDamage).reduce((n,o)=>n+o),a.heals=e.map(n=>n.heals).reduce((n,o)=>n+o),a.normalKills=e.map(n=>n.normalKills).reduce((n,o)=>n+o),a.eliteKills=e.map(n=>n.eliteKills).reduce((n,o)=>n+o),a.bossKills=e.map(n=>n.bossKills).reduce((n,o)=>n+o),a.exhausts=e.map(n=>n.exhausts).reduce((n,o)=>n+o),a.maxDealtDamage=Math.max(...e.map(n=>n.maxDealtDamage)),a.maxDamage=Math.max(...e.map(n=>n.maxDamage))),a}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-statistics-dialog"]],standalone:!1,decls:48,vars:15,consts:[[1,"statistics-dialog"],[1,"scroll-container"],[1,"header"],[3,"ghs-label"],[1,"character"],[1,"icon","character-icon",3,"src"],[1,"name"],[1,"success"],[1,"failure"],[3,"ghs-label","ghs-label-args","ghs-tooltip"],[1,"text-black",3,"ghs-label","ghs-label-args","style","ghs-tooltip"],[3,"ghs-label","ghs-label-args","style","ghs-tooltip"],[1,"text-black",3,"ghs-label","ghs-label-args","ghs-tooltip"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.nVh(2,$w,1,0,"div",2),t.j41(3,"table")(4,"thead")(5,"tr")(6,"th"),t.nrm(7,"span",3),t.k0s(),t.Z7z(8,Dw,5,2,"th",null,nn),t.nVh(10,Iw,2,1,"th"),t.k0s()(),t.j41(11,"tbody")(12,"tr")(13,"th"),t.nrm(14,"span",3),t.k0s(),t.Z7z(15,Vw,2,1,"td",null,nn),t.nVh(17,Fw,7,3,"td"),t.k0s(),t.j41(18,"tr")(19,"th"),t.nrm(20,"span",3),t.k0s(),t.Z7z(21,Xw,4,21,"td",null,nn),t.nVh(23,Bw,4,21,"td"),t.k0s(),t.j41(24,"tr")(25,"th"),t.nrm(26,"span",3),t.k0s(),t.Z7z(27,Yw,3,14,"td",null,nn),t.nVh(29,Nw,3,14,"td"),t.k0s(),t.j41(30,"tr")(31,"th"),t.nrm(32,"span",3),t.k0s(),t.Z7z(33,qw,4,3,"td",null,nn),t.nVh(35,Jw,4,3,"td"),t.k0s(),t.j41(36,"tr")(37,"th"),t.nrm(38,"span",3),t.k0s(),t.Z7z(39,Zw,3,14,"td",null,nn),t.nVh(41,Qw,3,14,"td"),t.k0s(),t.j41(42,"tr")(43,"th"),t.nrm(44,"span",3),t.k0s(),t.Z7z(45,t7,4,21,"td",null,nn),t.nVh(47,e7,4,21,"td"),t.k0s()()()()()),2&a&&(t.R7$(2),t.vxM(n.character?-1:2),t.R7$(5),t.Y8G("ghs-label","scenario.stats"),t.R7$(),t.Dyx(n.characters),t.R7$(2),t.vxM(n.character?-1:10),t.R7$(4),t.Y8G("ghs-label","scenario.stats.scenarios"),t.R7$(),t.Dyx(n.characters),t.R7$(2),t.vxM(!n.character&&n.scenarios.length==n.characters.length+1&&n.scenarios[n.characters.length].length>2?17:-1),t.R7$(3),t.Y8G("ghs-label","scenario.stats.damage"),t.R7$(),t.Dyx(n.characters),t.R7$(2),t.vxM(n.character?-1:23),t.R7$(3),t.Y8G("ghs-label","scenario.stats.heal"),t.R7$(),t.Dyx(n.characters),t.R7$(2),t.vxM(n.character?-1:29),t.R7$(3),t.Y8G("ghs-label","scenario.stats.kills"),t.R7$(),t.Dyx(n.characters),t.R7$(2),t.vxM(n.character?-1:35),t.R7$(3),t.Y8G("ghs-label","scenario.stats.max"),t.R7$(),t.Dyx(n.characters),t.R7$(2),t.vxM(n.character?-1:41),t.R7$(3),t.Y8G("ghs-label","scenario.stats.progress"),t.R7$(),t.Dyx(n.characters),t.R7$(2),t.vxM(n.character?-1:47))},dependencies:[tt,ft],styles:[".statistics-dialog[_ngcontent-%COMP%]{position:relative;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor))}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{border-collapse:collapse;width:100%;margin:0;padding:0}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{margin:0;padding:0;border-bottom:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-darkgray)}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(odd){background-color:var(--ghs-color-lightgray)}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:var(--ghs-color-yellow-light)}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle;padding:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));border-right:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-darkgray)}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:right;font-family:var(--ghs-font-title);font-weight:initial}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);text-align:center}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor))}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .success[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .failure[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.statistics-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:auto}"]})}return i})();const n7=i=>({absent:i}),Xs=i=>({disabled:i});function i7(i,r){if(1&i){const e=t.RV6();t.j41(0,"label"),t.nrm(1,"img",11)(2,"span",3),t.k0s(),t.j41(3,"a",12),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.changeLoot(n,-1))}),t.nrm(4,"img",13),t.k0s(),t.j41(5,"span",14),t.EFF(6),t.k0s(),t.j41(7,"a",12),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.changeLoot(n,1))}),t.nrm(8,"img",15),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+(e==a.LootType.special1||e==a.LootType.special2?a.LootType.money:e)+".svg",t.B4B),t.R7$(),t.Y8G("ghs-label","game.loot."+e),t.R7$(),t.Y8G("ngClass",t.eq3(8,Xs,!a.loot[e]||0==a.loot[e])),t.R7$(2),t.Y8G("ghs-label","game.loot."+e)("ghs-label-attribute","title"),t.R7$(),t.Lme(" ",a.loot[e]||"-"," / ",a.character.progress.loot[e]," "),t.R7$(),t.Y8G("ngClass",t.eq3(10,Xs,a.loot[e]==a.character.progress.loot[e]))}}function a7(i,r){if(1&i&&t.nVh(0,i7,9,12),2&i){const e=r.$implicit,a=t.XpG();t.vxM(a.character.progress.loot[e]?0:-1)}}let Ra=(()=>{class i{data;dialogRef;gameManager=s.E;character;lootTypes=Object.values(ot.r6);LootType=ot.r6;loot={};constructor(e,a){this.data=e,this.dialogRef=a,this.character=e.character,e.all&&this.lootTypes.forEach(n=>{this.loot[n]=this.character.progress.loot[n]||0})}ngOnInit(){this.character.progress||(this.character.progress=new xn.lv)}changeLoot(e,a){this.loot[e]||(this.loot[e]=0),this.loot[e]=this.loot[e]+a,this.loot[e]<0?this.loot[e]=0:(!this.character.progress.loot[e]||this.loot[e]>this.character.progress.loot[e])&&(this.loot[e]=this.character.progress.loot[e]||0)}moveLoot(){Object.keys(this.loot).forEach(e=>{const a=e;let n=this.loot[a]||0;(this.character.progress.loot[a]||0)<n&&(n=this.character.progress.loot[a]||0),n>0&&(s.E.stateManager.before("moveResource",s.E.characterManager.characterName(this.character),"game.loot."+a,n),s.E.game.party.loot[a]=(s.E.game.party.loot[a]||0)+n,this.character.progress.loot[a]=(this.character.progress.loot[a]||0)-n,s.E.stateManager.after())}),this.close()}close(){(0,V.co)(this.dialogRef)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-character-move-resources"]],standalone:!1,decls:16,vars:8,consts:[[1,"move-resources-dialog"],[1,"scroll-container"],[1,"title"],[3,"ghs-label"],[1,"name"],[1,"icon","character-icon",3,"src"],[1,"character-title",3,"ngClass"],[1,"values"],[1,"menu"],[1,"cancel",3,"click"],[1,"apply",3,"click"],[1,"ghs-svg",3,"src"],[1,"button",3,"click","ngClass"],["src","./assets/images/minus.svg",1,"ghs-svg"],[1,"value",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg",1,"ghs-svg"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"label",2),t.nrm(3,"span",3),t.j41(4,"span",4),t.nrm(5,"img",5),t.j41(6,"span",6),t.EFF(7),t.k0s()()(),t.j41(8,"div",7),t.Z7z(9,a7,1,1,null,null,t.fX1),t.k0s(),t.j41(11,"div",8)(12,"a",9),t.bIt("click",function(){return n.close()}),t.nrm(13,"span",3),t.k0s(),t.j41(14,"a",10),t.bIt("click",function(){return n.moveLoot()}),t.nrm(15,"span",3),t.k0s()()()()),2&a&&(t.R7$(3),t.Y8G("ghs-label","character.progress.resources.move"),t.R7$(2),t.Y8G("src",n.character.iconUrl,t.B4B),t.R7$(),t.Y8G("ngClass",t.eq3(6,n7,n.character.absent)),t.R7$(),t.JRh(n.gameManager.characterManager.characterName(n.character,!0)),t.R7$(2),t.Dyx(n.lootTypes),t.R7$(4),t.Y8G("ghs-label","cancel"),t.R7$(2),t.Y8G("ghs-label","character.progress.resources.apply"))},dependencies:[N.YU,tt],styles:[".move-resources-dialog[_ngcontent-%COMP%]{padding:.5em}.move-resources-dialog[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1em;width:auto;margin:0 .3em;filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline);margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);min-width:calc(var(--ghs-unit) * 44 * var(--ghs-dialog-factor))}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));width:auto;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .character-title[_ngcontent-%COMP%]{display:flex;align-items:center}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .character-title.absent[_ngcontent-%COMP%]{text-decoration:line-through}.move-resources-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto auto auto;font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor))}.move-resources-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-white);display:flex;justify-content:flex-start;align-items:center;white-space:nowrap}.move-resources-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white);margin-right:.3em}.move-resources-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--ghs-color-white);display:flex;justify-content:center;align-items:center;padding:.3em;white-space:nowrap}.move-resources-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;padding:.3em}.move-resources-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.move-resources-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .button.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:2em;padding:.3em}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}"]})}return i})();var Ge=M(51571);const Te=i=>[i],Un=i=>({"already-unlocked":i}),re=(i,r)=>[i,r],o7=()=>["2"];function s7(i,r){if(1&i&&t.nrm(0,"span",15),2&i){const e=r.$implicit;t.Y8G("ghs-label","character.progress.retirement.event"+(-1==e.indexOf(":")?"s":""))("ghs-label-args",-1==e.indexOf(":")?t.eq3(2,Te,e):t.l_i(4,re,e.split(":")[0],e.split(":")[1]))}}function r7(i,r){if(1&i&&(t.j41(0,"div",8),t.Z7z(1,s7,1,7,"span",15,t.fX1),t.k0s()),2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(1,Un,e.alreadyRetired)),t.R7$(),t.Dyx(e.character.retireEvent.split("|"))}}function c7(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",9)(1,"a",16),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openConclusion())}),t.nrm(2,"span",15),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","character.progress.retirement.conclusion")("ghs-label-args",t.eq3(2,Te,e.conclusion.index))}}function l7(i,r){if(1&i&&t.nrm(0,"div",17),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(3,Un,e.characterAlreadyUnlocked))("ghs-label","character.progress.personalQuest.unlockCharacter")("ghs-label-args",t.eq3(5,Te,e.personalQuest.unlockCharacter))}}function g7(i,r){if(1&i&&t.nrm(0,"div",15),2&i){const e=t.XpG(2);t.Y8G("ghs-label","character.progress.personalQuest.unlockCharacter.randomScenario")("ghs-label-args",t.l_i(2,re,e.characterScenario.index,e.characterScenario.name))}}function d7(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",23),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.itemDialog(n.characterItemDesign))}),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","character.progress.personalQuest.unlockCharacter.itemDesign")("ghs-label-args",t.l_i(2,re,e.characterItemDesign.id,e.characterItemDesign.edition))}}function h7(i,r){if(1&i&&t.nrm(0,"span",15),2&i){const e=r.$implicit;t.Y8G("ghs-label","character.progress.retirement.event"+(-1==e.indexOf(":")?"s":""))("ghs-label-args",-1==e.indexOf(":")?t.eq3(2,Te,e):t.l_i(4,re,e.split(":")[0],e.split(":")[1]))}}function _7(i,r){if(1&i&&(t.j41(0,"div",19),t.Z7z(1,h7,1,7,"span",15,t.fX1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Dyx(e.unlockEvent.split("|"))}}function m7(i,r){if(1&i&&t.nrm(0,"span",25),2&i){const e=t.XpG(3);t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.building")("ghs-label-args",t.l_i(2,re,e.personalQuestBuilding.id,e.personalQuestBuilding.name))}}function p7(i,r){if(1&i&&(t.j41(0,"div",20),t.nrm(1,"span",24),t.nVh(2,m7,1,5,"span",25),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope"+(e.personalQuest.openEnvelope.split(":").length>1?".alt":""))("ghs-label-args",e.personalQuest.openEnvelope.split(":"))("ngClass",t.eq3(4,Un,e.envelopeAlreadyUnlocked)),t.R7$(),t.vxM(e.personalQuestBuilding?2:-1)}}function u7(i,r){if(1&i&&t.nrm(0,"div",15),2&i){const e=t.XpG(2);t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.randomScenario")("ghs-label-args",t.l_i(2,re,e.envelopeSection.index,e.envelopeSection.unlocks&&e.envelopeSection.unlocks[0]))}}function f7(i,r){1&i&&t.nrm(0,"div",21),2&i&&t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.inspiration")}function C7(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",23),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.itemDialog(n.envelopeItemBlueprint))}),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.itemBlueprint")("ghs-label-args",t.l_i(2,re,e.envelopeItemBlueprint.id,e.envelopeItemBlueprint.edition))}}function M7(i,r){if(1&i&&t.nrm(0,"div",15),2&i){const e=t.XpG(2);t.Y8G("ghs-label","character.progress.personalQuest.unlockPQ")("ghs-label-args",t.eq3(2,Te,e.personalQuest.unlockPQ))}}function v7(i,r){1&i&&t.nrm(0,"div",21),2&i&&t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.inspiration")}function O7(i,r){if(1&i&&(t.j41(0,"div",22),t.nrm(1,"span",2),t.EFF(2,":\xa0"),t.nrm(3,"span",26),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","errata"),t.R7$(2),t.Y8G("ghs-label","data.custom."+e.personalQuest.edition+".errata."+e.personalQuest.errata)}}function P7(i,r){if(1&i&&(t.j41(0,"div",10),t.nVh(1,l7,1,7,"div",17),t.nVh(2,g7,1,5,"div",15),t.nVh(3,d7,1,5,"div",18),t.nVh(4,_7,3,0,"div",19),t.nVh(5,p7,3,6,"div",20),t.nVh(6,u7,1,5,"div",15),t.nVh(7,f7,1,1,"div",21),t.nVh(8,C7,1,5,"div",18),t.nVh(9,M7,1,4,"div",15),t.nVh(10,v7,1,1,"div",21),t.nVh(11,O7,4,2,"div",22),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.vxM(e.personalQuest.unlockCharacter?1:-1),t.R7$(),t.vxM(e.characterScenario?2:-1),t.R7$(),t.vxM(e.characterItemDesign?3:-1),t.R7$(),t.vxM(e.unlockEvent?4:-1),t.R7$(),t.vxM(e.personalQuest.openEnvelope?5:-1),t.R7$(),t.vxM(e.envelopeSection?6:-1),t.R7$(),t.vxM(e.envelopeAlreadyUnlocked&&!e.envelopeSection?7:-1),t.R7$(),t.vxM(e.envelopeItemBlueprint?8:-1),t.R7$(),t.vxM(e.personalQuest.unlockPQ?9:-1),t.R7$(),t.vxM(e.envelopeAlreadyUnlocked&&!e.envelopeItemBlueprint?10:-1),t.R7$(),t.vxM(e.settingsManager.settings.errata&&e.personalQuest.errata?11:-1)}}function b7(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",11)(1,"a",16),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.moveResources())}),t.nrm(2,"span",2),t.k0s()()}2&i&&(t.R7$(2),t.Y8G("ghs-label","character.progress.retirement.moveSupply"))}function k7(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",11)(1,"a",16),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.additional=!n.additional)}),t.nrm(2,"span",2),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","character.progress.retirement.additionalPQ"+(e.additional?".cancel":""))}}function y7(i,r){if(1&i){const e=t.RV6();t.j41(0,"input",30),t.bIt("change",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.changeAdditionalPQ(n))}),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("value",e.additionalPQ&&e.additionalPQ.cardId||"")}}function x7(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.SpI("\xa0(",e.additionalPQ.altId,")")}}function E7(i,r){if(1&i&&(t.j41(0,"span",29),t.nrm(1,"span",2),t.nVh(2,x7,2,1,"span"),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","data.personalQuest."+e.additionalPQ.edition+"."+e.additionalPQ.cardId),t.R7$(),t.vxM(e.additionalPQ.altId?2:-1)}}function w7(i,r){if(1&i&&t.nrm(0,"div",24),2&i){const e=t.XpG(2);t.Y8G("ghs-label","character.progress.personalQuest.unlockCharacter")("ghs-label-args",t.eq3(3,Te,e.additionalPQ.unlockCharacter))("ngClass",t.eq3(5,Un,e.additionalCharacterAlreadyUnlocked))}}function R7(i,r){if(1&i&&t.nrm(0,"div",15),2&i){const e=t.XpG(2);t.Y8G("ghs-label","character.progress.personalQuest.unlockCharacter.randomScenario")("ghs-label-args",t.l_i(2,re,e.additionalCharacterScenario.index,e.additionalCharacterScenario.name))}}function j7(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",23),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.itemDialog(n.additionalCharacterItemDesign))}),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","character.progress.personalQuest.unlockCharacter.itemDesign")("ghs-label-args",t.l_i(2,re,e.additionalCharacterItemDesign.id,e.additionalCharacterItemDesign.edition))}}function G7(i,r){if(1&i&&t.nrm(0,"span",15),2&i){const e=r.$implicit;t.Y8G("ghs-label","character.progress.retirement.event"+(-1==e.indexOf(":")?"s":""))("ghs-label-args",-1==e.indexOf(":")?t.eq3(2,Te,e):t.l_i(4,re,e.split(":")[0],e.split(":")[1]))}}function T7(i,r){if(1&i&&(t.j41(0,"div",19),t.Z7z(1,G7,1,7,"span",15,t.fX1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Dyx(e.additionalUnlockEvent.split("|"))}}function S7(i,r){if(1&i&&t.nrm(0,"span",25),2&i){const e=t.XpG(3);t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.building")("ghs-label-args",t.l_i(2,re,e.additionalPQBuilding.id,e.additionalPQBuilding.name))}}function $7(i,r){if(1&i&&(t.j41(0,"div",20),t.nrm(1,"span",24),t.nVh(2,S7,1,5,"span",25),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope"+(e.additionalPQ.openEnvelope.split(":").length>1?".alt":""))("ghs-label-args",e.additionalPQ.openEnvelope.split(":"))("ngClass",t.eq3(4,Un,e.additionalEnvelopeAlreadyUnlocked)),t.R7$(),t.vxM(e.additionalPQBuilding?2:-1)}}function D7(i,r){if(1&i&&t.nrm(0,"div",15),2&i){const e=t.XpG(2);t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.randomScenario")("ghs-label-args",t.l_i(2,re,e.additionalEnvelopeSection.index,e.additionalEnvelopeSection.unlocks&&e.additionalEnvelopeSection.unlocks[0]))}}function I7(i,r){1&i&&t.nrm(0,"div",21),2&i&&t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.inspiration")}function A7(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",23),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.itemDialog(n.additionalEnvelopeItemBlueprint))}),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.itemBlueprint")("ghs-label-args",t.l_i(2,re,e.additionalEnvelopeItemBlueprint.id,e.additionalEnvelopeItemBlueprint.edition))}}function V7(i,r){1&i&&t.nrm(0,"div",21),2&i&&t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope.inspiration")}function F7(i,r){if(1&i&&t.nrm(0,"div",15),2&i){const e=t.XpG(2);t.Y8G("ghs-label","character.progress.personalQuest.unlockPQ")("ghs-label-args",t.eq3(2,Te,e.additionalPQ.unlockPQ))}}function X7(i,r){if(1&i&&(t.j41(0,"div",22),t.nrm(1,"span",2),t.EFF(2,":\xa0"),t.nrm(3,"span",26),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","errata"),t.R7$(2),t.Y8G("ghs-label","data.custom."+e.additionalPQ.edition+".errata."+e.additionalPQ.errata)}}function B7(i,r){if(1&i&&(t.j41(0,"div",10)(1,"div",27),t.nVh(2,y7,1,1,"input",28),t.nVh(3,E7,3,2,"span",29),t.k0s(),t.nrm(4,"span",2)(5,"span",7),t.nVh(6,w7,1,7,"div",24),t.nVh(7,R7,1,5,"div",15),t.nVh(8,j7,1,5,"div",18),t.nVh(9,T7,3,0,"div",19),t.nVh(10,$7,3,6,"div",20),t.nVh(11,D7,1,5,"div",15),t.nVh(12,I7,1,1,"div",21),t.nVh(13,A7,1,5,"div",18),t.nVh(14,V7,1,1,"div",21),t.nVh(15,F7,1,4,"div",15),t.nVh(16,X7,4,2,"div",22),t.k0s()),2&i){const e=t.XpG();t.R7$(2),t.vxM(e.additional?2:-1),t.R7$(),t.vxM(e.additionalPQ?3:-1),t.R7$(),t.Y8G("ghs-label","character.progress.retirement.additionalPQ.inspiration"),t.R7$(),t.Y8G("ghs-label","character.progress.retirement.prosperity")("ghs-label-args",t.lJ4(16,o7)),t.R7$(),t.vxM(e.additionalPQ&&e.additionalPQ.unlockCharacter?6:-1),t.R7$(),t.vxM(e.additionalCharacterScenario?7:-1),t.R7$(),t.vxM(e.additionalCharacterItemDesign?8:-1),t.R7$(),t.vxM(e.additionalUnlockEvent?9:-1),t.R7$(),t.vxM(e.additionalPQ&&e.additionalPQ.openEnvelope?10:-1),t.R7$(),t.vxM(e.additionalEnvelopeSection?11:-1),t.R7$(),t.vxM(e.additionalEnvelopeAlreadyUnlocked&&!e.additionalEnvelopeSection?12:-1),t.R7$(),t.vxM(e.additionalEnvelopeItemBlueprint?13:-1),t.R7$(),t.vxM(e.additionalEnvelopeAlreadyUnlocked&&!e.additionalEnvelopeItemBlueprint?14:-1),t.R7$(),t.vxM(e.additionalPQ&&e.additionalPQ.unlockPQ?15:-1),t.R7$(),t.vxM(e.settingsManager.settings.errata&&e.additionalPQ&&e.additionalPQ.errata?16:-1)}}let Y7=(()=>{class i{character;dialogRef;dialog;gameManager=s.E;settingsManager=m.f;conclusion;personalQuest;personalQuestBuilding;unlockEvent="";alreadyRetired=!1;characterAlreadyUnlocked=!1;characterScenario;characterItemDesign;envelopeAlreadyUnlocked=!1;envelopeSection;envelopeItemBlueprint;additional=!1;additionalPQ;additionalPQBuilding;additionalUnlockEvent="";additionalCharacterAlreadyUnlocked=!1;additionalCharacterScenario;additionalCharacterItemDesign;additionalEnvelopeAlreadyUnlocked=!1;additionalEnvelopeSection;additionalEnvelopeItemBlueprint;hasResources=!1;constructor(e,a,n){this.character=e,this.dialogRef=a,this.dialog=n,this.conclusion=s.E.sectionData(this.character.edition).find(o=>o.retirement==this.character.name&&o.conclusion),this.character.progress.personalQuest&&(this.personalQuest=s.E.characterManager.personalQuestByCard(s.E.currentEdition(),this.character.progress.personalQuest),m.f.settings.unlockEnvelopeBuildings&&this.personalQuest&&this.personalQuest.openEnvelope&&(this.personalQuestBuilding=this.buildingsEnvelopeHelper(this.personalQuest.openEnvelope)));for(let o of Object.keys(this.character.progress.loot)){const g=o;-1!=ot.s$.indexOf(g)&&this.character.progress.loot[g]&&(this.hasResources=!0)}if(this.personalQuest){if(this.personalQuest.unlockCharacter)if(this.characterAlreadyUnlocked=-1!=s.E.game.unlockedCharacters.indexOf(this.personalQuest.edition+":"+this.personalQuest.unlockCharacter),this.characterAlreadyUnlocked)this.characterScenario=s.E.scenarioManager.drawRandomScenario(s.E.currentEdition()),this.characterItemDesign=s.E.itemManager.drawRandomItem(s.E.currentEdition());else{const o=s.E.charactersData(this.personalQuest.edition).find(g=>this.personalQuest&&g.edition==this.personalQuest.edition&&g.name==this.personalQuest.unlockCharacter);this.unlockEvent=o&&o.unlockEvent||""}this.personalQuest.openEnvelope&&s.E.fhRules()&&(this.envelopeAlreadyUnlocked=!this.buildingsEnvelopeHelper(this.personalQuest.openEnvelope,!1)&&!this.buildingsEnvelopeHelper(this.personalQuest.openEnvelope),this.envelopeAlreadyUnlocked&&(this.envelopeSection=s.E.scenarioManager.drawRandomScenarioSection(s.E.currentEdition()),this.envelopeItemBlueprint=s.E.itemManager.drawRandomItem(s.E.currentEdition(),!0)))}this.alreadyRetired=null!=s.E.game.party.retirements.find(o=>o.edition==this.character.edition&&o.name==this.character.name)}openConclusion(){this.conclusion&&this.dialog.open(Yt,{panelClass:["dialog"],data:{scenario:this.conclusion,conclusionOnly:!0,rewardsOnly:null!=s.E.game.party.conclusions.find(e=>this.conclusion&&e.edition==this.conclusion.edition&&e.group==this.conclusion.group&&e.index==this.conclusion.index)}})}moveResources(){this.dialog.open(Ra,{panelClass:["dialog"],data:{character:this.character,all:!0}})}apply(){if((0,V.co)(this.dialogRef,!0),s.E.stateManager.before("setRetired",s.E.characterManager.characterName(this.character)),this.character.progress.retired=!0,s.E.game.party.retirements.push(this.character.toModel()),s.E.characterManager.removeCharacter(this.character,!0),this.personalQuest&&this.personalQuest.unlockCharacter&&m.f.settings.automaticUnlocking&&-1==s.E.game.unlockedCharacters.indexOf(this.personalQuest.edition+":"+this.personalQuest.unlockCharacter)&&(s.E.game.unlockedCharacters.push(this.personalQuest.edition+":"+this.personalQuest.unlockCharacter),m.f.settings.events)){const e=s.E.getCharacterData(this.personalQuest.unlockCharacter);e.unlockEvent&&e.unlockEvent.split("|").forEach(a=>{a.split(":").length>1?s.E.eventCardManager.addEvent(a.split(":")[0],a.split(":")[1],!0):(s.E.eventCardManager.addEvent("city",a,!0),s.E.eventCardManager.addEvent("road",a,!0))})}if(this.characterAlreadyUnlocked&&(this.characterScenario&&s.E.game.party.manualScenarios.push(new ht.Ag(this.characterScenario.index,this.characterScenario.edition,this.characterScenario.group)),this.characterItemDesign&&s.E.game.party.unlockedItems.push(new vt.VP(""+this.characterItemDesign.id,this.characterItemDesign.edition))),this.additionalCharacterAlreadyUnlocked&&(this.additionalCharacterScenario&&s.E.game.party.manualScenarios.push(new ht.Ag(this.additionalCharacterScenario.index,this.additionalCharacterScenario.edition,this.additionalCharacterScenario.group)),this.additionalCharacterItemDesign&&s.E.game.party.unlockedItems.push(new vt.VP(""+this.additionalCharacterItemDesign.id,this.additionalCharacterItemDesign.edition))),this.envelopeAlreadyUnlocked&&(this.envelopeSection?(s.E.game.party.conclusions.push(new ht.Ag(""+this.envelopeSection.index,this.envelopeSection.edition,this.envelopeSection.group)),this.envelopeSection.unlocks&&this.envelopeSection.unlocks.forEach(e=>{this.envelopeSection&&s.E.game.party.manualScenarios.push(new ht.Ag(e,this.envelopeSection.edition))})):s.E.game.party.inspiration+=1,this.envelopeItemBlueprint?s.E.game.party.unlockedItems.push(new vt.VP(""+this.envelopeItemBlueprint.id,this.envelopeItemBlueprint.edition)):s.E.game.party.inspiration+=1),this.additionalEnvelopeAlreadyUnlocked&&(this.additionalEnvelopeSection?(s.E.game.party.conclusions.push(new ht.Ag(""+this.additionalEnvelopeSection.index,this.additionalEnvelopeSection.edition,this.additionalEnvelopeSection.group)),this.additionalEnvelopeSection.unlocks&&this.additionalEnvelopeSection.unlocks.forEach(e=>{this.envelopeSection&&s.E.game.party.manualScenarios.push(new ht.Ag(e,this.envelopeSection.edition))})):s.E.game.party.inspiration+=1,this.additionalEnvelopeItemBlueprint?s.E.game.party.unlockedItems.push(new vt.VP(""+this.additionalEnvelopeItemBlueprint.id,this.additionalEnvelopeItemBlueprint.edition)):s.E.game.party.inspiration+=1),this.additional&&(s.E.game.party.inspiration-=15,s.E.game.party.prosperity+=2,this.additionalPQ&&this.additionalPQ.unlockCharacter&&m.f.settings.automaticUnlocking&&-1==s.E.game.unlockedCharacters.indexOf(this.additionalPQ.edition+":"+this.additionalPQ.unlockCharacter)&&(s.E.game.unlockedCharacters.push(this.additionalPQ.edition+":"+this.additionalPQ.unlockCharacter),m.f.settings.events))){const e=s.E.getCharacterData(this.additionalPQ.unlockCharacter);e.unlockEvent&&e.unlockEvent.split("|").forEach(a=>{a.split(":").length>1?s.E.eventCardManager.addEvent(a.split(":")[0],a.split(":")[1],!0):(s.E.eventCardManager.addEvent("city",a,!0),s.E.eventCardManager.addEvent("road",a,!0))})}m.f.settings.unlockEnvelopeBuildings&&(this.personalQuestBuilding&&s.E.game.party.buildings.push(new Ge.k(this.personalQuestBuilding.name,0)),this.additionalPQBuilding&&s.E.game.party.buildings.push(new Ge.k(this.additionalPQBuilding.name,0))),s.E.stateManager.after(),this.conclusion&&!s.E.game.party.conclusions.find(e=>this.conclusion&&e.edition==this.conclusion.edition&&e.group==this.conclusion.group&&e.index==this.conclusion.index)&&this.openConclusion()}buildingsEnvelopeHelper(e,a=!0){const n=s.E.campaignData().buildings;if(n){const o=e.split(":").map(g=>n.find(_=>_.id===g)).filter(g=>g).map(g=>g);if(o.length>0){if(!(s.E.game.party.buildings.find(g=>g.name==o[0].name)||this.personalQuestBuilding&&this.personalQuestBuilding==o[0]))return o[0];if(a&&o.length>1&&!s.E.game.party.buildings.find(g=>g.name==o[1].name))return o[1]}}}changeAdditionalPQ(e){if(this.additionalPQ=s.E.characterManager.personalQuestByCard(s.E.currentEdition(),e.target.value),this.additionalPQ){if(m.f.settings.unlockEnvelopeBuildings&&this.additionalPQ.openEnvelope&&(this.additionalPQBuilding=this.buildingsEnvelopeHelper(this.additionalPQ.openEnvelope)),this.additionalPQ.unlockCharacter)if(this.additionalCharacterAlreadyUnlocked=-1!=s.E.game.unlockedCharacters.indexOf(this.additionalPQ.edition+":"+this.additionalPQ.unlockCharacter),this.characterAlreadyUnlocked)this.additionalCharacterScenario=s.E.scenarioManager.drawRandomScenario(s.E.currentEdition()),this.additionalCharacterItemDesign=s.E.itemManager.drawRandomItem(s.E.currentEdition());else{const a=s.E.charactersData(this.additionalPQ.edition).find(n=>this.additionalPQ&&n.edition==this.additionalPQ.edition&&n.name==this.additionalPQ.unlockCharacter);this.additionalUnlockEvent=a&&a.unlockEvent||""}this.additionalPQ.openEnvelope&&s.E.fhRules()&&(this.additionalEnvelopeAlreadyUnlocked=!this.buildingsEnvelopeHelper(this.additionalPQ.openEnvelope,!1)&&!this.buildingsEnvelopeHelper(this.additionalPQ.openEnvelope),this.additionalEnvelopeAlreadyUnlocked&&(this.additionalEnvelopeSection=s.E.scenarioManager.drawRandomScenarioSection(s.E.currentEdition()),this.additionalEnvelopeItemBlueprint=s.E.itemManager.drawRandomItem(s.E.currentEdition(),!0)))}}itemDialog(e){this.dialog.open(Me,{panelClass:["fullscreen-panel"],disableClose:!0,data:{item:e}})}close(){(0,V.co)(this.dialogRef)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-character-retirement-dialog"]],standalone:!1,decls:20,vars:15,consts:[[1,"retirement-dialog"],[1,"title"],[3,"ghs-label"],[1,"name"],[1,"icon","character-icon",3,"src"],[1,"character-title"],[1,"rewards"],[3,"ghs-label","ghs-label-args"],[1,"event",3,"ngClass"],[1,"conclusion"],[1,"personal-quest"],[1,"additional"],[1,"menu"],[1,"cancel",3,"click"],[1,"apply",3,"click"],[1,"text-white",3,"ghs-label","ghs-label-args"],[3,"click"],[1,"text-white",3,"ngClass","ghs-label","ghs-label-args"],[1,"text-white","link",3,"ghs-label","ghs-label-args"],[1,"event"],[1,"envelope"],[1,"text-white",3,"ghs-label"],[1,"errata","text-white"],[1,"text-white","link",3,"click","ghs-label","ghs-label-args"],[1,"text-white",3,"ghs-label","ghs-label-args","ngClass"],[1,"building",3,"ghs-label","ghs-label-args"],[1,"text",3,"ghs-label"],[1,"personal-quest-card"],["type","text",1,"card-id",3,"value"],[1,"personal-quest-name"],["type","text",1,"card-id",3,"change","value"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"label",1),t.nrm(2,"span",2),t.j41(3,"span",3),t.nrm(4,"img",4),t.j41(5,"span",5),t.EFF(6),t.k0s()()(),t.j41(7,"div",6),t.nrm(8,"span",7),t.k0s(),t.nVh(9,r7,3,3,"div",8),t.nVh(10,c7,3,4,"div",9),t.nVh(11,P7,12,11,"div",10),t.nVh(12,b7,3,1,"div",11),t.nVh(13,k7,3,1,"div",11),t.nVh(14,B7,17,17,"div",10),t.j41(15,"div",12)(16,"a",13),t.bIt("click",function(){return n.close()}),t.nrm(17,"span",2),t.k0s(),t.j41(18,"a",14),t.bIt("click",function(){return n.apply()}),t.nrm(19,"span",2),t.k0s()()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","character.progress.retirement"),t.R7$(2),t.Y8G("src",n.character.iconUrl,t.B4B),t.R7$(2),t.JRh(n.gameManager.characterManager.characterName(n.character,!0)),t.R7$(2),t.Y8G("ghs-label","character.progress.retirement.prosperity")("ghs-label-args",t.eq3(13,Te,n.gameManager.fhRules(!0)?"2":"1")),t.R7$(),t.vxM(n.character.retireEvent?9:-1),t.R7$(),t.vxM(n.conclusion?10:-1),t.R7$(),t.vxM(n.personalQuest?11:-1),t.R7$(),t.vxM(n.gameManager.fhRules()&&n.hasResources?12:-1),t.R7$(),t.vxM(n.gameManager.fhRules(!0)&&n.gameManager.game.party.inspiration>14?13:-1),t.R7$(),t.vxM(n.additional?14:-1),t.R7$(3),t.Y8G("ghs-label","cancel"),t.R7$(2),t.Y8G("ghs-label","character.progress.retirement.apply"))},dependencies:[N.YU,tt],styles:[".retirement-dialog[_ngcontent-%COMP%]{padding:.5em;color:var(--ghs-color-white)}.retirement-dialog[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1em;width:auto;margin:0 .3em;filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.retirement-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline);margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.retirement-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);min-width:calc(var(--ghs-unit) * 44 * var(--ghs-dialog-factor))}.retirement-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));width:auto;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.retirement-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .character-title[_ngcontent-%COMP%]{display:flex;align-items:center}.retirement-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .character-title.absent[_ngcontent-%COMP%]{text-decoration:line-through}.retirement-dialog[_ngcontent-%COMP%]   .rewards[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;min-width:calc(var(--ghs-unit) * 35 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));padding-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray)}.retirement-dialog[_ngcontent-%COMP%]   .rewards[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{cursor:pointer}.retirement-dialog[_ngcontent-%COMP%]   .event[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2.6 * var(--ghs-dialog-factor))}.retirement-dialog[_ngcontent-%COMP%]   .conclusion[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);display:flex;flex-direction:column;justify-content:center;align-items:center}.retirement-dialog[_ngcontent-%COMP%]   .conclusion[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:1.5em;padding:.2em}.retirement-dialog[_ngcontent-%COMP%]   .conclusion[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}.retirement-dialog[_ngcontent-%COMP%]   .already-unlocked[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-darkgray)}.retirement-dialog[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{cursor:pointer}.retirement-dialog[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]:hover{opacity:.7}.retirement-dialog[_ngcontent-%COMP%]   .personal-quest[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center}.retirement-dialog[_ngcontent-%COMP%]   .envelope[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column}.retirement-dialog[_ngcontent-%COMP%]   .envelope[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.retirement-dialog[_ngcontent-%COMP%]   .errata[_ngcontent-%COMP%]{text-align:justify;max-width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor))}.retirement-dialog[_ngcontent-%COMP%]   .errata[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-style:italic}.retirement-dialog[_ngcontent-%COMP%]   .additional[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);display:flex;flex-direction:column;justify-content:center;align-items:center;margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));padding-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray)}.retirement-dialog[_ngcontent-%COMP%]   .additional[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:1.5em;padding:.2em}.retirement-dialog[_ngcontent-%COMP%]   .additional-card[_ngcontent-%COMP%]{display:flex;align-items:center}.retirement-dialog[_ngcontent-%COMP%]   .additional-card[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.retirement-dialog[_ngcontent-%COMP%]   .personal-quest-card[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.retirement-dialog[_ngcontent-%COMP%]   .personal-quest-card[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{text-align:right;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor) * var(--ghs-text-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor) * var(--ghs-text-factor));min-width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor) * var(--ghs-text-factor))}.retirement-dialog[_ngcontent-%COMP%]   .personal-quest-card[_ngcontent-%COMP%]   .personal-quest-name[_ngcontent-%COMP%]{font-family:var(--ghs-font-title)}.retirement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.retirement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:2em;padding:.3em}.retirement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.retirement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.retirement-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}"]})}return i})();const Bs=i=>({disabled:i}),N7=(i,r)=>[i,r],Ys=i=>[i],z7=i=>({ignore:i}),L7=(i,r)=>r.edition+"-"+r.id;function U7(i,r){if(1&i&&t.nrm(0,"img",9),2&i){const e=t.XpG().$implicit;t.Y8G("src","./assets/images/items/slots/"+e.slot+".svg",t.B4B)}}function q7(i,r){if(1&i&&t.nrm(0,"span",10),2&i){const e=t.XpG().$implicit;t.Y8G("ghs-label","%game.itemFh."+e.id+"%")}}function H7(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1,"\xa0("),t.nrm(2,"span",1),t.EFF(3,")"),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(2),t.Y8G("ghs-label","data.edition."+e.edition)}}function K7(i,r){1&i&&(t.j41(0,"span",14),t.nrm(1,"img",22),t.k0s())}function W7(i,r){1&i&&(t.j41(0,"div",15),t.nrm(1,"img",23),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-tooltip","game.items.effect")("hint",!0))}function J7(i,r){if(1&i&&(t.j41(0,"span",16),t.nrm(1,"img",24),t.EFF(2),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(2,z7,a.gameManager.characterManager.ignoreNegativeItemEffects(a.character))),t.R7$(2),t.SpI(" x",e.minusOne," ")}}function Z7(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",25),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.distillItem(n))}),t.nrm(1,"img",26),t.k0s()}if(2&i){const e=t.XpG().$implicit;t.Y8G("ghs-tooltip","game.items.distilling")("ghs-label-args",t.eq3(2,Ys,"data.items."+e.edition+"-"+e.id))}}function Q7(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",3)(1,"span",8),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.openItem(n))}),t.nVh(2,U7,1,1,"img",9),t.nVh(3,q7,1,1,"span",10),t.k0s(),t.j41(4,"span",11),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.openItem(n))}),t.EFF(5),t.k0s(),t.j41(6,"span",12),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.toggleEquippedItem(n))})("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.toggleEquippedItem(n,!0))}),t.nrm(7,"span",1),t.nVh(8,H7,4,1,"span"),t.k0s(),t.nrm(9,"span",13),t.nVh(10,K7,2,0,"span",14),t.nVh(11,W7,2,2,"div",15),t.nVh(12,J7,3,4,"span",16),t.nVh(13,Z7,2,4,"a",17),t.j41(14,"a",18),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.sellItem(n))}),t.nrm(15,"img",19),t.EFF(16),t.k0s(),t.j41(17,"a",20),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.removeItem(n))}),t.nrm(18,"img",21),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG();t.R7$(2),t.vxM(e.slot?2:-1),t.R7$(),t.vxM(e.slot?-1:3),t.R7$(2),t.SpI("",e.id,"."),t.R7$(),t.Y8G("ngClass",t.eq3(15,Bs,a.gameManager.game.state!=a.GameState.draw||a.gameManager.game.round>0)),t.R7$(),t.Y8G("ghs-label","data.items."+e.edition+"-"+e.id),t.R7$(),t.vxM(e.edition!=a.itemEdition?8:-1),t.R7$(2),t.vxM(a.isEquipped(e)?10:-1),t.R7$(),t.vxM(a.gameManager.characterManager.itemEffect(e)?11:-1),t.R7$(),t.vxM(a.isEquipped(e)&&e.minusOne?12:-1),t.R7$(),t.vxM(a.gameManager.itemManager.canDistill(e)?13:-1),t.R7$(),t.Y8G("ghs-tooltip","game.items.sell")("ghs-label-args",t.l_i(17,N7,"data.items."+e.edition+"-"+e.id,a.gameManager.itemManager.itemSellValue(e))),t.R7$(2),t.SpI(" ",a.gameManager.itemManager.itemSellValue(e)," "),t.R7$(),t.Y8G("ghs-tooltip","game.items.remove")("ghs-label-args",t.eq3(20,Ys,"data.items."+e.edition+"-"+e.id))}}function tR(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",27),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.brewDialog())})("doubleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.brewDialog(!0))}),t.nrm(1,"img",26)(2,"span",1),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(2,Bs,e.gameManager.itemManager.brewingDisabled())),t.R7$(2),t.Y8G("ghs-label","game.items.brewing")}}let eR=(()=>{class i{dialog;character;items=[];item;itemIndex=1;itemEdition="";brewing=0;herbs=[ot.r6.rockroot,ot.r6.snowthistle,ot.r6.axenut,ot.r6.flamefruit,ot.r6.corpsecap,ot.r6.arrowvine];gameManager=s.E;settingsManager=m.f;GameState=T.mk;constructor(e){this.dialog=e}ngOnInit(){this.updateItems(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.updateItems()}}),this.itemEdition||(this.itemEdition=s.E.currentEdition(this.character.edition)),this.editionChange()}uiChangeSubscription;ngOnDestroy(){this.itemEdition&&(this.itemEdition=s.E.currentEdition(this.character.edition)),this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}updateItems(){if(this.items=[],this.character.progress.items&&(this.character.progress.items.forEach(e=>{const a=s.E.itemManager.getItem(e.name,e.edition,!0);a?this.items.push(a):console.warn("Unknown Item for edition '"+e.edition+"': "+e.name)}),this.items.sort(s.E.itemManager.sortItems)),this.brewing=0,s.E.fhRules()&&s.E.game.party.campaignMode&&s.E.game.party.buildings){const e=s.E.game.party.buildings.find(a=>"alchemist"==a.name);e&&e.level&&(this.brewing=e.level<3?2:3)}}brewDialog(e=!1){(!s.E.itemManager.brewingDisabled()||e)&&this.dialog.open(Uo,{panelClass:["dialog"],data:this.character})}itemDialog(){this.dialog.open(Bn,{panelClass:["dialog"],data:{edition:s.E.game.edition,select:this.character}})}itemChange(e=0){setTimeout(()=>{if(0!=e){const a=s.E.itemManager.maxItemIndex(this.itemEdition||this.character.edition);for(this.itemIndex+=e,this.itemIndex<1&&(this.itemIndex=a),this.item=s.E.itemManager.getItem(this.itemIndex,this.itemEdition&&this.itemEdition||this.character.edition,!1);!this.item&&this.itemIndex>0&&this.itemIndex<a;)this.itemIndex+=e,this.item=s.E.itemManager.getItem(this.itemIndex,this.itemEdition||this.character.edition,!1);this.itemIndex>a&&(this.itemIndex=1,this.item=s.E.itemManager.getItem(this.itemIndex,this.itemEdition||this.character.edition,!1))}else this.item=s.E.itemManager.getItem(this.itemIndex,this.itemEdition||this.character.edition,!1)})}editionChange(){if(this.itemIndex=1,this.itemEdition){const e=s.E.editionData.find(a=>a.edition==this.itemEdition);e&&e.items&&(this.itemIndex=Math.min(...e.items.filter(a=>"number"==typeof a.id).map(a=>+a.id)))}this.itemChange()}canAdd(e){if(e){const a=this.assigned(e);if(e.count&&a<e.count&&!this.character.progress.items.find(n=>e&&n.name==""+e.id&&n.edition==e.edition))return!0}return!1}assigned(e){return s.E.game.figures.filter(a=>a instanceof q.K&&a.progress&&a.progress.items).map(a=>a).map(a=>a.progress&&a.progress.items).reduce((a,n)=>a&&n&&a.concat(n)).filter(a=>e&&a.name==""+e.id&&a.edition==e.edition).length}canBuy(e,a=0){return e&&e.cost&&e.cost+s.E.itemManager.pricerModifier()+a<=this.character.progress.gold&&this.canAdd(e)||!1}canCraft(e,a={}){if(e){let n=!0;return e.resources&&Object.keys(e.resources).forEach(o=>{const g=o,_=(e.resources[g]||0)+(a[g]||0);n=(0,ot.hV)(g)==ot.hM.herb_resources?n&&((this.character.progress.loot[g]||0)>=_||(s.E.game.party.loot[g]||0)>=_):n&&(this.character.progress.loot[g]||0)>=_}),e.requiredItems&&e.requiredItems.forEach(o=>{if(o!=e.id){const g=s.E.itemManager.getItem(o,e.edition,!0);g?this.items.find(_=>_.id==g.id&&_.edition==g.edition)||(n=n&&(this.canCraft(g,e.resources||{})||this.canBuy(g,e.cost))):console.error("Missing required item '"+o+"' for item '"+e.id+"' ("+e.name+")")}}),n}return!1}addItem(e,a=!1){e&&(this.canAdd(e)||a)&&(s.E.stateManager.before("addItem",s.E.characterManager.characterName(this.character),e.id+"",e.edition),this.character.progress.items.push(new vt.gw(e.id+"",e.edition)),this.items.push(e),this.items.sort(s.E.itemManager.sortItems),s.E.stateManager.after(),this.itemChange())}buyItem(e){e&&this.canBuy(e)&&(s.E.stateManager.before("buyItem",s.E.characterManager.characterName(this.character),e.id+"",e.edition),this.character.progress.gold-=e.cost+s.E.itemManager.pricerModifier(),this.character.progress.items.push(new vt.gw(e.id+"",e.edition)),this.items.push(e),this.items.sort(s.E.itemManager.sortItems),s.E.stateManager.after(),this.itemChange())}craftItemResources(e){this.canCraft(e)&&(e.resources&&Object.keys(e.resources).forEach(a=>{const n=a,o=e.resources[n]||0;(0,ot.hV)(n)==ot.hM.herb_resources?(this.character.progress.loot[n]||0)>=o?this.character.progress.loot[n]=(this.character.progress.loot[n]||0)-o:s.E.game.party.loot[n]=(s.E.game.party.loot[n]||0)-o:this.character.progress.loot[n]=(this.character.progress.loot[n]||0)-o}),e.requiredItems&&e.requiredItems.forEach(a=>{if(a!=e.id){const n=s.E.itemManager.getItem(a,e.edition,!0);if(n)if(this.items.find(o=>o.id==n.id&&o.edition==n.edition)){const o=this.character.progress.items.find(g=>g.name==""+n.id&&g.edition==n.edition);if(o){const g=this.character.progress.items.indexOf(o);this.character.progress.items.splice(g,1),this.character.progress.equippedItems=this.character.progress.equippedItems.filter(_=>_.name!=""+n.id||_.edition!=n.edition),this.items.splice(g,1)}}else this.canBuy(n)?this.character.progress.gold-=e.cost+s.E.itemManager.pricerModifier():this.craftItemResources(n);else console.error("Missing required item '"+a+"' for item '"+e.id+"' ("+e.name+")")}}))}craftItem(e){e&&this.canCraft(e)&&(s.E.stateManager.before("craftItem",s.E.characterManager.characterName(this.character),e.id+"",e.edition),this.craftItemResources(e),this.character.progress.items.push(new vt.gw(e.id+"",e.edition)),this.items.push(e),this.items.sort(s.E.itemManager.sortItems),s.E.stateManager.after(),this.itemChange())}openItem(e){this.dialog.open(Me,{panelClass:["fullscreen-panel"],data:{character:m.f.settings.characterItems?this.character:void 0,item:e,setup:s.E.game.state==T.mk.draw&&s.E.roundManager.firstRound}})}removeItem(e){const a=this.character.progress.items.find(n=>n.name==""+e.id&&n.edition==e.edition);a&&this.dialog.open(ea,{panelClass:["dialog"],data:{label:"game.items.remove",args:["data.items."+a.edition+"-"+e.id]}}).closed.subscribe({next:n=>{if(n){const o=this.character.progress.items.indexOf(a);s.E.stateManager.before("removeItem",s.E.characterManager.characterName(this.character),this.character.progress.items[o].name,this.character.progress.items[o].edition),this.character.progress.items.splice(o,1),this.character.progress.equippedItems=this.character.progress.equippedItems.filter(g=>g.name!=""+e.id||g.edition!=e.edition),this.items.splice(o,1),s.E.stateManager.after(),this.itemChange()}}})}sellItem(e){const a=this.character.progress.items.find(n=>n.name==""+e.id&&n.edition==e.edition);a&&s.E.itemManager.itemSellValue(e)&&this.dialog.open(ea,{panelClass:["dialog"],data:{label:"game.items.sell",args:["data.items."+a.edition+"-"+e.id,s.E.itemManager.itemSellValue(e)]}}).closed.subscribe({next:n=>{if(n){const o=this.character.progress.items.indexOf(a);s.E.stateManager.before("sellItem",s.E.characterManager.characterName(this.character),this.character.progress.items[o].name,this.character.progress.items[o].edition),this.character.progress.gold+=s.E.itemManager.itemSellValue(e),this.character.progress.items.splice(o,1),this.character.progress.equippedItems=this.character.progress.equippedItems.filter(g=>g.name!=""+e.id||g.edition!=e.edition),this.items.splice(o,1),s.E.stateManager.after(),this.itemChange()}}})}distillItem(e){this.dialog.open(Ho,{panelClass:["dialog"],data:{character:this.character,item:e}})}isEquipped(e){return this.character.progress.equippedItems.find(a=>a.name==""+e.id&&a.edition==e.edition)}toggleEquippedItem(e,a=!1){(!(s.E.game.state!=T.mk.draw||s.E.game.round>0)||a)&&null!=this.character.progress.items.find(o=>o.name==""+e.id&&o.edition==e.edition)&&(s.E.stateManager.before(s.E.itemManager.isEquipped(e,this.character)?"unequipItem":"equipItem",s.E.characterManager.characterName(this.character),e.id,e.edition),s.E.itemManager.toggleEquippedItem(e,this.character,a),s.E.stateManager.after())}setItemNotes(e){this.character.progress.itemNotes!=e.target.value&&(s.E.stateManager.before("setItems",s.E.characterManager.characterName(this.character),e.target.value),this.character.progress.itemNotes=e.target.value,s.E.stateManager.after())}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-character-items"]],inputs:{character:"character"},standalone:!1,decls:12,vars:3,consts:[[1,"items"],[3,"ghs-label"],[1,"item-list"],[1,"item-entry"],[1,"item-form"],[1,"shop",3,"click"],["src","./assets/images/items/item.svg"],["ghs-pointer-input","",3,"ngClass"],["ghs-pointer-input","",1,"icon","item-dialog",3,"singleClick"],[3,"src"],[1,"item","placeholder",3,"ghs-label"],["ghs-pointer-input","",1,"id","item-dialog",3,"singleClick"],["ghs-pointer-input","",1,"name",3,"singleClick","doubleClick","ngClass"],[1,"spacer"],[1,"equipped"],[1,"effect","hint-container"],[1,"minus-one",3,"ngClass"],[1,"button","distill",3,"ghs-tooltip","ghs-label-args"],[1,"button","loot",3,"click","ghs-tooltip","ghs-label-args"],["src","./assets/images/loot.svg"],[1,"button","remove",3,"click","ghs-tooltip","ghs-label-args"],["src","./assets/images/close.svg"],["src","./assets/images/check.svg"],["src","./assets/images/hint.svg",1,"hint-trigger","ghs-svg",3,"ghs-tooltip","hint"],["src","./assets/images/action/card/minus1.svg"],[1,"button","distill",3,"click","ghs-tooltip","ghs-label-args"],["src","./assets/images/fh/brewing.svg"],["ghs-pointer-input","",3,"singleClick","doubleClick","ngClass"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"label"),t.nrm(2,"span",1),t.EFF(3,":"),t.k0s(),t.j41(4,"div",2),t.Z7z(5,Q7,19,22,"div",3,L7),t.k0s(),t.j41(7,"div",4)(8,"a",5),t.bIt("click",function(){return n.itemDialog()}),t.nrm(9,"img",6)(10,"span",1),t.k0s(),t.nVh(11,tR,3,4,"a",7),t.k0s()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","game.items"),t.R7$(3),t.Dyx(n.items),t.R7$(5),t.Y8G("ghs-label","game.items.character.shop"),t.R7$(),t.vxM(n.brewing?11:-1))},dependencies:[N.YU,tt,ft,rt],styles:[".items{display:flex;flex-direction:column}.items img{width:auto;height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.items .button{cursor:pointer;display:flex;align-items:center}.items .button.add img{filter:var(--ghs-filter-green)}.items .button.remove img{filter:var(--ghs-filter-red)}.items .button.loot{margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));color:var(--ghs-color-yellow)}.items .button.loot img{filter:var(--ghs-filter-yellow);width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.items .button.distill{margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));color:var(--ghs-color-yellow)}.items .button.distill img{filter:var(--ghs-filter-blue);width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.items .button.craft{margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));color:var(--ghs-color-black)}.items .button.craft .resource{display:flex;align-items:center;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items .button.craft .resource img{width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.items .button.craft .item{margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items .button.disabled{color:var(--ghs-color-darkgray)!important}.items .button.disabled img{filter:var(--ghs-filter-darkgray)!important}.items .button.disabled .item,.items .button.disabled .resource img{opacity:.6}.items .button:hover{opacity:.8}.items .item-list{font-family:var(--ghs-font-text);display:flex;flex-direction:column;overflow:visible}.items .item-list .item-entry{display:flex;align-items:center;margin:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor))}.items .item-list .item-entry .item-dialog{cursor:zoom-in}.items .item-list .item-entry .icon{display:flex;justify-content:center;align-items:center;position:relative;width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.items .item-list .item-entry .id{text-align:right;margin-right:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.items .item-list .item-entry .id{display:flex;justify-content:flex-end;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.items .item-list .item-entry .name{cursor:pointer;display:inline-block;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.items .item-list .item-entry .name.disabled{cursor:initial}.items .item-list .item-entry .edition{font-size:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.items .item-list .item-entry .action-icon{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));display:flex;justify-content:center;align-items:center}.items .item-list .item-entry .action-icon img{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:auto}.items .item-list .item-entry .loot{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.items .item-list .item-entry .equipped{display:flex;justify-content:center;align-items:center;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items .item-list .item-entry .equipped img{filter:var(--ghs-filter-green);height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));width:auto}.items .item-list .item-entry .effect.hint-container .hint-trigger.ghs-svg{filter:var(--ghs-filter-gray)}.items .item-list .item-entry .effect.hint-container .hint{left:initial;right:0}.items .item-list .item-entry .minus-one{font-family:var(--ghs-font-title);display:flex;justify-content:center;align-items:center;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items .item-list .item-entry .minus-one img{margin-right:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.items .item-list .item-entry .minus-one.ignore{opacity:.5}.items .item-form{display:flex;justify-content:space-evenly;align-items:center;max-width:calc(var(--ghs-unit) * 33 * var(--ghs-dialog-factor))}.items .item-form a{cursor:pointer;color:var(--ghs-color-black);display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.items .item-form a img{height:1em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.items .item-form a:hover{opacity:.7}.items .item-form a.disabled{cursor:initial;opacity:.8}.items .item-form a.disabled:hover{opacity:.6}\n"],encapsulation:2})}return i})();function nR(i,r){1&i&&t.nrm(0,"span",3),2&i&&t.Y8G("ghs-label","and")}function iR(i,r){if(1&i&&(t.nrm(0,"span",2),t.nVh(1,nR,1,1,"span",3)),2&i){const e=t.XpG();t.Y8G("ghs-label",e.perk.custom),t.R7$(),t.vxM(e.perk.type!=e.PerkType.custom?1:-1)}}function aR(i,r){if(1&i&&t.nrm(0,"span",1),2&i){const e=t.XpG();t.Y8G("ghs-label","game.attackModifiers.perks.type."+e.perk.type)("ghs-label-args",e.perkLabel(e.perk))}}let Ns=(()=>{class i{perk;PerkType=En.RU;perkLabel(e){let a=[],n=[];if(e.cards){if(e.cards.forEach(o=>{n.push(m.f.getLabel("game.attackModifiers.perks.cardLabel",["game.attackModifiers.perks.cards."+o.count,this.attackModifierHtml(o.attackModifier),o.count>1?"game.attackModifiers.perks.cards":"game.attackModifiers.perks.card"]))}),e.type==En.RU.replace){const o=s.E.attackModifierManager.replaceCount(e);if(1==o&&2==n.length)a=n;else{if(o>1){let g="";for(let _=o-1;_>=0;_--)g=g?m.f.getLabel("game.attackModifiers.perks.additional",[n[_],g]):n[_];a.push(g)}else a.push(n[0]);if(n.length-o==1)a.push(n[o]);else{let g="";for(let _=n.length;_>=o;_--)g=g?m.f.getLabel("game.attackModifiers.perks.additional",[n[_],g]):n[_];a.push(g)}}}n.length<2?a=n:n.forEach((o,g,_)=>{g%2==0&&g<_.length-1&&a.push(m.f.getLabel("game.attackModifiers.perks.additional",[o,n[g+1]]))})}return a}attackModifierHtml(e){let a="";return e=new Y.uU(e.type,e.value,e.valueType,e.id,e.effects,e.rolling,e.active,e.shuffle),a+='<span class="attack-modifier-container">',!m.f.settings.fhStyle&&e.rolling&&(a+='<span class="attack-modifier-effect rolling">&zwj;<img class="action-icon sw" src="./assets/images/attackmodifier/rolling.svg"></span>'),(!e.rolling||e.type!=Y.Yn.plus0)&&(a+=e.valueType==Y.tW.minus?'<span class="attack-modifier-icon'+(e.value>9?" small":"")+'">-'+e.value+"</span>":e.type!=Y.Yn.null&&e.valueType==Y.tW.multiply?'<span class="attack-modifier-icon'+(e.value>9?" small":"")+'">'+e.value+"x</span>":e.type==Y.Yn.null?'<span class="attack-modifier-icon">&zwj;<img class="null" src="./assets/images/attackmodifier/null.svg"></span>':e.type==Y.Yn.plusX?'<span class="attack-modifier-icon">+X</span>':'<span class="attack-modifier-icon'+(e.value>9?" small":"")+'">+'+e.value+"</span>"),e.effects&&(e.effects.length>1&&(a+='"'),e.effects.forEach((n,o)=>{o>0&&(a+=","),a+=this.attackModifierEffectHtml(n,e.effects.length>1)}),e.effects.length>1&&(a+='"')),e.shuffle&&e.type!=Y.Yn.null&&(a+='<span class="attack-modifier-effect shuffle">&zwj;<img class="action-icon sw" src="./assets/images/shuffle.svg"></span>'),m.f.settings.fhStyle&&e.rolling&&(a+='<span class="attack-modifier-effect rolling">&zwj;<img class="action-icon sw" src="./assets/images/attackmodifier/rolling.svg"></span>'),a+="</span>",a}attackModifierEffectHtml(e,a=!1){let n="",o=!1;switch(e.type){case Y.hY.condition:let g=e.value.split(":")[0];g=g.replace("_x",""),n+='<span class="attack-modifier-effect condition">'+(m.f.settings.fhStyle?"":m.f.getLabel("game.condition."+g))+'<img class="action-icon sw" src="./assets/images/'+(m.f.settings.fhStyle?"fh/":"")+"condition/"+g+'.svg">',e.value.split(":").length>1&&(n+=e.value.split(":")[1]),n+="</span>";break;case Y.hY.element:n+='<span class="attack-modifier-effect element"><img class="action-icon sw" src="./assets/images/'+(m.f.settings.fhStyle?"fh/":"")+"element/"+e.value+'.svg"></span>';break;case Y.hY.elementHalf:const _=e.value.split("|");n+='<span class="attack-modifier-effect element-half-placeholder'+(m.f.settings.fhStyle?" fh":"")+'"><span class="element-half-container"><span class="element-half"><img src="./assets/images/'+(m.f.settings.fhStyle?"fh/":"")+"element/"+_[0]+'.svg"></span><span class="element-half"><img src="./assets/images/'+(m.f.settings.fhStyle?"fh/":"")+"element/"+_[1]+'.svg"></span></span></span>';break;case Y.hY.elementConsume:return n+='<span class="attack-modifier-effect element consume"><img class="action-icon sw" src="./assets/images/'+(m.f.settings.fhStyle?"fh/":"")+"element/"+e.value+'.svg"></span>',e.effects&&(n+=":",e.effects.forEach(y=>{n+=this.attackModifierEffectHtml(y,!0)})),a?n:'"'+n+'"';case Y.hY.target:n+=m.f.settings.fhStyle?'<span class="placeholder attack-modifier-effect target">+'+e.value+'<img class="action-icon" src="./assets/images/fh/attackmodifier/target.svg"></span>':'<span class="placeholder attack-modifier-effect target">'+m.f.getLabel(+e.value<=1?"game.custom.perks.addTarget":"game.custom.perks.addTargets",[e.value+""])+'<img class="action-icon" src="./assets/images/attackmodifier/target.svg"></span>';break;case Y.hY.specialTarget:e.value.split(":").length>1?n+='<span class="placeholder attack-modifier-effect special-target">'+m.f.getLabel("game.specialTarget."+e.value.split(":")[0],e.value.split(":").slice(1))+"</span>":n+=m.f.settings.fhStyle&&"allyShort"==e.value?'<span class="placeholder attack-modifier-effect special-target">'+m.f.getLabel("game.specialTarget.ally")+"</span>":'<span class="placeholder attack-modifier-effect special-target">'+m.f.getLabel("game.specialTarget."+e.value)+"</span>";break;case Y.hY.refreshItem:n+='<span class="placeholder attack-modifier-effect card">'+m.f.getLabel("game.attackModifiers.perks.effects."+e.type+(m.f.settings.fhStyle?"Fh":""))+"</span>";break;case Y.hY.refreshSpentItem:case Y.hY.recoverRandomDiscard:n+='<span class="placeholder attack-modifier-effect card">'+m.f.getLabel("game.attackModifiers.perks.effects."+e.type)+"</span>";break;case Y.hY.custom:n+=e.hint?'<span class="placeholder attack-modifier-effect custom-hint">'+m.f.getLabel(e.hint)+"</span>":'<span class="placeholder attack-modifier-effect custom">'+m.f.getLabel(""+e.value)+"</span>",o=!0;break;case Y.hY.or:return e.effects&&e.effects.forEach((y,B)=>{n+=this.attackModifierEffectHtml(y,!0),B<e.effects.length-1&&(n+=" "+m.f.getLabel("or")+" ")}),a?n:'"'+n+'"';case Y.hY.changeType:return e.value.startsWith("plus")?n+='<span class="attack-modifier-icon">+'+e.value.replace("plus","")+"</span>":e.value.startsWith("minus")?n+='<span class="attack-modifier-icon">-'+e.value.replace("minus","")+"</span>":e.value.startsWith("multiply")&&(n+='<span class="attack-modifier-icon">x'+e.value.replace("multiply","")+"</span>"),e.effects&&e.effects.forEach(y=>{n+=this.attackModifierEffectHtml(y,!0)}),a||(n='"'+n+'"'),n;case Y.hY.required:return n+=e.value?"<span>"+e.value+"</span>":"<span>!</span>",e.effects&&e.effects.forEach(y=>{n+=this.attackModifierEffectHtml(y,!0)}),a||(n='"'+n+'"'),n;default:n+='<span class="placeholder attack-modifier-effect default '+e.type+'">'+(m.f.settings.fhStyle?"":m.f.getLabel("game.action."+e.type))+'<img  class="action-icon" src="./assets/images/'+(m.f.settings.fhStyle?"fh/":"")+"action/"+e.type+'.svg"><span class="value">'+e.value+"</span></span>",-1==[Y.hY.pull,Y.hY.push,Y.hY.swing,Y.hY.pierce].indexOf(e.type)&&(o=!0)}return e.effects&&(o=!0,e.effects.forEach(g=>{n+=","+this.attackModifierEffectHtml(g,!0)})),o&&!a&&(n='"'+n+'"'),n}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-perk-label"]],inputs:{perk:"perk"},standalone:!1,decls:3,vars:2,consts:[[1,"perk-label","capitalize"],[1,"label",3,"ghs-label","ghs-label-args"],[3,"ghs-label"],[1,"and",3,"ghs-label"]],template:function(a,n){1&a&&(t.j41(0,"span",0),t.nVh(1,iR,2,2),t.nVh(2,aR,1,2,"span",1),t.k0s()),2&a&&(t.R7$(),t.vxM(n.perk.custom?1:-1),t.R7$(),t.vxM(n.perk.type!=n.PerkType.custom?2:-1))},dependencies:[tt],styles:['.perk-label{display:inline-block;line-height:1em}.perk-label:first-letter{text-transform:uppercase}.perk-label .and{margin:0 calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor))}.perk-label .attack-modifier-container{white-space:nowrap}.perk-label .attack-modifier-container *{white-space:initial}.perk-label .attack-modifier-effect{position:relative;margin-left:calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor))}.perk-label .attack-modifier-effect img.action-icon{position:relative;height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor));width:auto;vertical-align:middle}.perk-label .attack-modifier-effect img.action-icon.sw{filter:invert(1) contrast(1) grayscale(1) brightness(2.5);filter:none}.perk-label .attack-modifier-effect img.action-icon.circled{border:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);border-radius:100%}.perk-label .attack-modifier-effect.rolling img.action-icon,.perk-label .attack-modifier-effect.condition img.action-icon,.perk-label .attack-modifier-effect.target img.action-icon,.perk-label .attack-modifier-effect.pierce img.action-icon,.perk-label .attack-modifier-effect.pull img.action-icon,.perk-label .attack-modifier-effect.push img.action-icon,.perk-label .attack-modifier-effect.element img.action-icon,.perk-label .attack-modifier-effect.element-half img.action-icon{height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.perk-label .attack-modifier-effect .value{margin-left:calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor))}.perk-label .attack-modifier-effect.condition,.perk-label .attack-modifier-effect.target,.perk-label .attack-modifier-effect.pierce{text-transform:uppercase}.perk-label .attack-modifier-effect.element img{margin:0}.perk-label .attack-modifier-effect.element-half-placeholder{display:inline-block;position:relative;width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:0}.perk-label .attack-modifier-effect.element-half-placeholder .element-half-container{position:absolute;width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * -1.6 * var(--ghs-dialog-factor))}.perk-label .attack-modifier-effect.element-half-placeholder.fh{width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor))}.perk-label .attack-modifier-effect.element-half-placeholder.fh .element-half-container{width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:initial}.perk-label .attack-modifier-effect .placeholder-action{vertical-align:middle}.perk-label .attack-modifier-icon{position:relative;display:inline-flex;justify-content:center;align-items:center;font-family:var(--ghs-font-gh-title);font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor));vertical-align:middle}.perk-label .attack-modifier-icon.small{font-size:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor))}.perk-label .attack-modifier-icon img.null{filter:var(--ghs-filter-black);width:70%;height:70%}.perk-label .attack-modifier-icon:before{content:" ";position:absolute;left:0;top:calc(var(--ghs-unit) * -.15 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);border-radius:100%}\n'],encapsulation:2})}return i})();const oR=["charactertitle"],sR=(i,r,e,a)=>({"cs-sheet":i,"fh-sheet":r,"gh2e-sheet":e,compact:a}),zs=(i,r)=>({denied:i,"view-only":r}),rR=(i,r)=>[i,r],wn=()=>[],qn=i=>({checked:i}),Ls=i=>[i],Hn=i=>({disabled:i}),cR=i=>({combined:i}),lR=(i,r)=>({checked:i,disabled:r}),gR=(i,r)=>r.type+i;function dR(i,r){if(1&i){const e=t.RV6();t.j41(0,"input",65,0),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.titleChange())}),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("value",e.character.title)}}function hR(i,r){if(1&i){const e=t.RV6();t.nrm(0,"img",7),t.j41(1,"input",65),t.bIt("change",function(n){const o=t.eBV(e).$implicit,g=t.XpG(2);return t.Njj(g.setTitle(n,o))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("src",a.gameManager.characterManager.characterIdentityIcon(a.character.name,e),t.B4B),t.R7$(),t.Y8G("value",a.titles[e])}}function _R(i,r){if(1&i&&(t.Z7z(0,hR,2,2,null,null,t.fX1),t.nI1(2,"ghsRange")),2&i){const e=t.XpG();t.Dyx(t.i5U(2,0,t.lJ4(3,wn),e.character.identities.length))}}function mR(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",66),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.setLevel(n+1))}),t.EFF(1),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(2,qn,a.character.level>e)),t.R7$(),t.JRh(e+1)}}function pR(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",67),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.setLevel(n+1))}),t.EFF(1),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(2,qn,a.character.progress.experience>=a.gameManager.characterManager.xpMap[e])),t.R7$(),t.SpI(" ",a.gameManager.characterManager.xpMap[e]," ")}}function uR(i,r){1&i&&(t.j41(0,"span"),t.nrm(1,"span",14),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","character.progress.notes"))}function fR(i,r){1&i&&(t.j41(0,"label"),t.nrm(1,"span",14),t.EFF(2,":"),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","character.progress.gold-notes"))}function CR(i,r){1&i&&(t.j41(0,"label"),t.nrm(1,"span",14)(2,"img",68),t.EFF(3,":"),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","character.progress.gold"))}function MR(i,r){if(1&i&&(t.j41(0,"span",27),t.nrm(1,"span",10),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","character.progress.donations")("ghs-label-args",t.eq3(2,Ls,e.character.progress.donations))}}function vR(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",28),t.nrm(1,"span",14),t.EFF(2,": "),t.j41(3,"a",69),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.donate())}),t.j41(4,"span",70),t.nrm(5,"img",71),t.EFF(6),t.k0s()()()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","character.progress.donate"),t.R7$(2),t.Y8G("ngClass",t.eq3(3,Hn,e.character.progress.gold<(e.fhSheet?5:10)||e.gameManager.game.round>0)),t.R7$(3),t.JRh(e.fhSheet?5:10)}}function OR(i,r){1&i&&t.nrm(0,"hr",29)}function PR(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",30)(1,"label"),t.nrm(2,"span",14),t.EFF(3,":"),t.k0s(),t.j41(4,"a",72),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.moveResources())}),t.nrm(5,"span",14),t.k0s(),t.j41(6,"div",73)(7,"div",74)(8,"div",75),t.nrm(9,"img",76),t.j41(10,"input",25),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setResource(o.LootType.lumber,n))}),t.k0s()(),t.j41(11,"div",77),t.nrm(12,"img",78),t.j41(13,"input",25),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setResource(o.LootType.metal,n))}),t.k0s()(),t.j41(14,"div",79),t.nrm(15,"img",80),t.j41(16,"input",25),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setResource(o.LootType.hide,n))}),t.k0s()()(),t.j41(17,"div",81)(18,"div",82),t.nrm(19,"img",83),t.j41(20,"input",25),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setResource(o.LootType.arrowvine,n))}),t.k0s()(),t.j41(21,"div",84),t.nrm(22,"img",85),t.j41(23,"input",25),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setResource(o.LootType.axenut,n))}),t.k0s()(),t.j41(24,"div",86),t.nrm(25,"img",87),t.j41(26,"input",25),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setResource(o.LootType.corpsecap,n))}),t.k0s()(),t.j41(27,"div",88),t.nrm(28,"img",89),t.j41(29,"input",25),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setResource(o.LootType.flamefruit,n))}),t.k0s()(),t.j41(30,"div",90),t.nrm(31,"img",91),t.j41(32,"input",25),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setResource(o.LootType.rockroot,n))}),t.k0s()(),t.j41(33,"div",92),t.nrm(34,"img",93),t.j41(35,"input",25),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setResource(o.LootType.snowthistle,n))}),t.k0s()()()()()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","character.progress.resources"),t.R7$(3),t.Y8G("ghs-label","character.progress.resources.move"),t.R7$(5),t.Y8G("value",e.character.progress.loot.lumber),t.R7$(3),t.Y8G("value",e.character.progress.loot.metal),t.R7$(3),t.Y8G("value",e.character.progress.loot.hide),t.R7$(4),t.Y8G("value",e.character.progress.loot.arrowvine),t.R7$(3),t.Y8G("value",e.character.progress.loot.axenut),t.R7$(3),t.Y8G("value",e.character.progress.loot.corpsecap),t.R7$(3),t.Y8G("value",e.character.progress.loot.flamefruit),t.R7$(3),t.Y8G("value",e.character.progress.loot.rockroot),t.R7$(3),t.Y8G("value",e.character.progress.loot.snowthistle)}}function bR(i,r){1&i&&(t.j41(0,"span",99),t.EFF(1,"-"),t.k0s())}function kR(i,r){if(1&i&&(t.nrm(0,"span",98),t.nVh(1,bR,2,0,"span",99)),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.Y8G("ghs-label","data.character.traits."+e),t.R7$(),t.vxM(a<n.character.traits.length-1?1:-1)}}function yR(i,r){if(1&i&&(t.j41(0,"div",94)(1,"span",96),t.nrm(2,"img",97),t.k0s(),t.Z7z(3,kR,2,2,null,null,t.fX1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(3),t.Dyx(e.character.traits)}}function xR(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",31)(1,"label"),t.nrm(2,"span",14),t.EFF(3,": "),t.nVh(4,yR,5,0,"div",94),t.k0s(),t.j41(5,"textarea",95),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setNotes(n))}),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","character.progress.notes"),t.R7$(2),t.vxM(e.character.traits.length>0?4:-1),t.R7$(),t.Y8G("readOnly",!e.gameManager.stateManager.characterPermissions[e.character.name+"|"+e.character.edition])("value",e.character.progress.notes)("ghs-label","character.progress.notes")("ghs-label-attribute","placeholder")}}function ER(i,r){if(1&i&&t.nrm(0,"ghs-character-items",32),2&i){const e=t.XpG();t.Y8G("character",e.character)}}function wR(i,r){1&i&&t.nrm(0,"hr",29)}function RR(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",101)(1,"span",102),t.nrm(2,"img",103),t.EFF(3,":"),t.k0s(),t.j41(4,"span",104),t.bIt("click",function(){const n=t.eBV(e).$index,o=t.XpG(2);return t.Njj(o.toggleMastery(n))}),t.k0s(),t.nrm(5,"span",105),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.R7$(4),t.Y8G("ngClass",t.eq3(2,qn,-1!=n.character.progress.masteries.indexOf(a))),t.R7$(),t.Y8G("ghs-label",e)}}function jR(i,r){if(1&i&&(t.j41(0,"div",33)(1,"label"),t.nrm(2,"span",14),t.EFF(3,":"),t.k0s(),t.j41(4,"div",100),t.Z7z(5,RR,6,4,"div",101,t.fX1),t.k0s()()),2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","character.progress.masteries"),t.R7$(3),t.Dyx(e.character.masteries)}}function GR(i,r){1&i&&t.nrm(0,"hr",29)}function TR(i,r){1&i&&(t.j41(0,"label",36),t.nrm(1,"span",14),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","game.attackModifiers.perks"))}function SR(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",109),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG().$index,g=t.XpG();return t.Njj(g.addPerk(o,n+1))})("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG().$index,g=t.XpG();return t.Njj(g.addPerk(o,n+1,!0))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG().$index,n=t.XpG();t.Y8G("ngClass",t.l_i(1,lR,n.character.progress.perks[a]&&n.character.progress.perks[a]>e,!n.forceEdit&&(n.gameManager.game.state!=n.GameState.draw||n.gameManager.game.round>0)||n.character.progress.perks[a]<=e&&n.availablePerks<e-n.character.progress.perks[a]+1))}}function $R(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",38)(1,"div",106),t.Z7z(2,SR,1,4,"span",107,t.fX1),t.nI1(4,"ghsRange"),t.k0s(),t.j41(5,"ghs-perk-label",108),t.bIt("singleClick",function(){const n=t.eBV(e).$index,o=t.XpG();return t.Njj(o.togglePerk(n))})("doubleClick",function(){const n=t.eBV(e).$index,o=t.XpG();return t.Njj(o.togglePerk(n,!0))}),t.k0s()()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(6,cR,e.combined)),t.R7$(),t.Dyx(t.i5U(4,3,t.lJ4(8,wn),e.count)),t.R7$(3),t.Y8G("ngClass",t.eq3(9,Hn,n.gameManager.game.state!=n.GameState.draw||n.gameManager.game.round>0||0==n.availablePerks&&!n.character.progress.perks[a]))("perk",e)}}function DR(i,r){1&i&&(t.j41(0,"div",39),t.nrm(1,"img",110)(2,"span",14),t.k0s()),2&i&&(t.Y8G("ghs-label","game.attackModifiers.perks.warning")("ghs-label-attribute","title"),t.R7$(2),t.Y8G("ghs-label","game.attackModifiers.perks.warning"))}function IR(i,r){1&i&&(t.j41(0,"div",40),t.nrm(1,"img",110)(2,"span",14),t.k0s()),2&i&&(t.Y8G("ghs-label","wip")("ghs-label-attribute","title"),t.R7$(2),t.Y8G("ghs-label","game.attackModifiers.perks.wip"))}function AR(i,r){1&i&&(t.j41(0,"label",36),t.nrm(1,"span",14),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","game.battleGoals"))}function VR(i,r){1&i&&(t.j41(0,"label",36),t.nrm(1,"span",14),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","game.attackModifiers.perks"))}function FR(i,r){if(1&i&&(t.j41(0,"span",102),t.nrm(1,"img",7),t.EFF(2,":"),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("src","./assets/images/"+(e.gh2eSheet||e.fhSheet?"checkmark":"check")+".svg",t.B4B)}}function XR(i,r){if(1&i){const e=t.RV6();t.nVh(0,FR,3,1,"span",102),t.j41(1,"span",111),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.setBattleGoals(n+1))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.vxM(e%3==0?0:-1),t.R7$(),t.Y8G("ngClass",t.eq3(2,qn,a.character.progress.battleGoals>=e+1))}}function BR(i,r){1&i&&t.nrm(0,"hr",29)}function YR(i,r){1&i&&(t.j41(0,"label",36),t.nrm(1,"span",14),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","character.progress.notes"))}function NR(i,r){if(1&i){const e=t.RV6();t.j41(0,"textarea",95),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setNotes(n))}),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("readOnly",!e.gameManager.stateManager.characterPermissions[e.character.name+"|"+e.character.edition])("value",e.character.progress.notes)("ghs-label","character.progress.notes")("ghs-label-attribute","placeholder")}}function zR(i,r){if(1&i&&t.nrm(0,"ghs-character-items",45),2&i){const e=t.XpG();t.Y8G("character",e.character)}}function LR(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"/"),t.k0s())}function UR(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.SpI(" ",e.gameManager.game.party.players[e.character.number-1])}}function qR(i,r){if(1&i){const e=t.RV6();t.j41(0,"label",119),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.retire())})("doubleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.retire(!0))}),t.nrm(1,"img",120)(2,"span",14),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Hn,!e.retireEnabled)),t.R7$(2),t.Y8G("ghs-label","character.progress.retirement")}}function HR(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.SpI("\xa0(",e.personalQuest.altId,")")}}function KR(i,r){if(1&i&&(t.j41(0,"span",115),t.nrm(1,"span",14),t.nVh(2,HR,2,1,"span"),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","data.personalQuest."+e.personalQuest.edition+"."+e.personalQuest.cardId),t.R7$(),t.vxM(e.personalQuest.altId&&e.personalQuest.altId!=e.personalQuest.cardId?2:-1)}}function WR(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",124),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openTrial())}),t.nrm(1,"img",125),t.k0s()}}function JR(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",116)(1,"label"),t.nrm(2,"span",14),t.EFF(3,":"),t.k0s(),t.j41(4,"div",121)(5,"input",122,1),t.bIt("change",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.setTrial(n))})("keyup",function(){t.eBV(e);const n=t.sdS(6);return t.Njj(n.classList.remove("error"))}),t.k0s(),t.nVh(7,WR,2,0,"a",123),t.k0s()()}if(2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","character.progress.trial"),t.R7$(3),t.Y8G("value",e.character.progress.trial?e.settingsManager.settings.fhSecondEdition?e.gameManager.trialsManager.cardIdSecondPrinting(+e.character.progress.trial.name):e.character.progress.trial.name:""),t.R7$(2),t.vxM(e.fhSheet&&e.character.progress.trial?7:-1)}}function ZR(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG(3);t.R7$(),t.Lme("\xa0",o.character.progress.personalQuestProgress[n]||0,"/",o.EntityValueFunction(a.counter))}}function QR(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",131),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2).$index,g=t.XpG(3);return t.Njj(g.setPersonalQuestProgress(o,n+1))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2).$index,n=t.XpG(3);t.Y8G("ngClass",t.eq3(3,qn,n.character.progress.personalQuestProgress[a]>e))("ghs-label","character.progress.personalQuest.counter")("ghs-label-attribute","title")}}function tj(i,r){if(1&i&&(t.Z7z(0,QR,1,5,"span",130,t.fX1),t.nI1(2,"ghsRange")),2&i){const e=t.XpG().$implicit,a=t.XpG(3);t.Dyx(t.i5U(2,0,t.lJ4(3,wn),a.EntityValueFunction(e.counter)))}}function ej(i,r){if(1&i){const e=t.RV6();t.j41(0,"input",132),t.bIt("change",function(n){t.eBV(e);const o=t.XpG().$index,g=t.XpG(3);return t.Njj(g.setPersonalQuestProgress(o,n))}),t.k0s()}if(2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG(3);t.Y8G("value",o.character.progress.personalQuestProgress[n])("max",o.EntityValueFunction(a.counter))}}function nj(i,r){if(1&i&&(t.j41(0,"div",126)(1,"span",127),t.nrm(2,"span",14),t.EFF(3,":"),t.nVh(4,ZR,2,2,"span"),t.k0s(),t.j41(5,"span",128),t.nVh(6,tj,3,4),t.nVh(7,ej,1,2,"input",129),t.k0s()()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.Y8G("ngClass",t.eq3(5,Hn,e.requires&&e.requires.length>0&&!n.personalQuestRequirementUnlocked(a))),t.R7$(2),t.Y8G("ghs-label",e.name),t.R7$(2),t.vxM(n.EntityValueFunction(e.counter)>1?4:-1),t.R7$(2),t.vxM(n.EntityValueFunction(e.counter)<11?6:-1),t.R7$(),t.vxM(n.EntityValueFunction(e.counter)>10?7:-1)}}function ij(i,r){if(1&i&&(t.j41(0,"div",117),t.Z7z(1,nj,8,7,"div",126,t.fX1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Dyx(e.personalQuest.requirements)}}function aj(i,r){if(1&i&&t.nrm(0,"div",133),2&i){const e=t.XpG(3);t.Y8G("ghs-label","character.progress.personalQuest.unlockCharacter")("ghs-label-args",t.eq3(2,Ls,e.personalQuest.unlockCharacter))}}function oj(i,r){if(1&i&&t.nrm(0,"div",133),2&i){const e=t.XpG(3);t.Y8G("ghs-label","character.progress.personalQuest.openEnvelope"+(e.personalQuest.openEnvelope.split(":").length>1?".alt":""))("ghs-label-args",e.personalQuest.openEnvelope.split(":"))}}function sj(i,r){if(1&i&&(t.j41(0,"div",118),t.nVh(1,aj,1,4,"div",133),t.nVh(2,oj,1,2,"div",133),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.vxM(e.personalQuest.unlockCharacter?1:-1),t.R7$(),t.vxM(e.personalQuest.openEnvelope?2:-1)}}function rj(i,r){if(1&i){const e=t.RV6();t.j41(0,"label",119),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.retire())})("doubleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.retire(!0))}),t.nrm(1,"img",120)(2,"span",14),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Hn,!e.retireEnabled)),t.R7$(2),t.Y8G("ghs-label","character.progress.retirement")}}function cj(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",52)(1,"label"),t.nrm(2,"span",14),t.EFF(3,":"),t.k0s(),t.j41(4,"div",112)(5,"input",113),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setPersonalQuest(n))}),t.k0s(),t.nVh(6,qR,3,4,"label",114),t.nVh(7,KR,3,2,"span",115),t.k0s(),t.nVh(8,JR,8,3,"div",116),t.nVh(9,ij,3,0,"div",117),t.nVh(10,sj,3,2,"div",118),t.nVh(11,rj,3,4,"label",114),t.k0s()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","character.progress.personalQuest"),t.R7$(3),t.Y8G("value",e.character.progress.personalQuest),t.R7$(),t.vxM(e.editable&&!e.personalQuest?6:-1),t.R7$(),t.vxM(e.personalQuest?7:-1),t.R7$(),t.vxM(e.gameManager.trialsManager.trialsEnabled?8:-1),t.R7$(),t.vxM(e.personalQuest?9:-1),t.R7$(),t.vxM(e.personalQuest?10:-1),t.R7$(),t.vxM(e.editable&&e.personalQuest?11:-1)}}function lj(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",53)(1,"label"),t.nrm(2,"span",14),t.EFF(3,":"),t.k0s(),t.j41(4,"input",55),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setRetirements(n))})("keyup",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setRetirements(n))}),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","character.progress.retirements"),t.R7$(2),t.Y8G("value",e.character.progress.retirements)}}function gj(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",56)(1,"label",134),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.setAside())}),t.nrm(2,"img",135)(3,"span",14),t.k0s()()}2&i&&(t.R7$(3),t.Y8G("ghs-label","character.setAside"))}function dj(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",56)(1,"label",136),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.replay())}),t.nrm(2,"img",135)(3,"span",14),t.k0s()()}2&i&&(t.R7$(3),t.Y8G("ghs-label","character.replay"))}function hj(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",137),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openAbilityCards())}),t.k0s()}}let Us=(()=>{class i{dialog;character;editable=!0;forceEdit=!1;standalone=!1;dialogRef;titleInput;gameManager=s.E;settingsManager=m.f;ghsInputFullScreenCheck=V.It;EntityValueFunction=$.hZ;GameState=T.mk;PerkType=En.RU;LootType=ot.r6;availablePerks=0;personalQuest;retireEnabled=!1;hasAbilities=!1;goldTimeout=null;xpTimeout=null;replayable=!1;fhSheet=!1;gh2eSheet=!1;csSheet=!1;donations=!0;titles=[];constructor(e){this.dialog=e}ngOnInit(){if(this.character.identities&&this.character.identities.length>1&&m.f.settings.characterIdentities){if(this.titles=this.character.title.split("|"),this.titles.length<this.character.identities.length)for(let e=this.titles.length;e<this.character.identities.length;e++)this.titles.push("");for(let e=0;e<this.titles.length;e++)this.titles[e]||(this.titles[e]=m.f.getLabel("data.character."+this.character.edition+"."+this.character.name.toLowerCase()))}this.character.progress||(this.character.progress=new xn.lv),this.character.progress.perks=this.character.progress.perks||[],this.fhSheet=s.E.fhRules(!0),this.gh2eSheet=!s.E.fhRules()&&s.E.fhRules(!0),this.csSheet=!this.fhSheet&&("cs"==this.character.edition||-1!=s.E.editionExtensions(this.character.edition).indexOf("cs")),this.donations=!this.fhSheet;for(let e=0;e<15;e++)this.character.progress.perks[e]||(this.character.progress.perks[e]=0);if(this.fhSheet){for(let e in ot.r6)this.character.progress.loot[e]=this.character.progress.loot[e]||0;s.E.game.party.buildings.find(e=>"temple"==e.name&&e.level>0&&"wrecked"!=e.state)&&(this.donations=!0)}this.character.progress.experience<s.E.characterManager.xpMap[this.character.level-1]&&(this.character.progress.experience=s.E.characterManager.xpMap[this.character.level-1]),this.availablePerks=this.character.level+Math.min(6,Math.floor(this.character.progress.battleGoals/3))-(this.character.progress.perks&&this.character.progress.perks.length>0?this.character.progress.perks.reduce((e,a)=>e+a):0)-1+this.character.progress.extraPerks+this.character.progress.retirements+this.character.progress.masteries.length,this.character.progress.personalQuest&&(this.personalQuest=s.E.characterManager.personalQuestByCard(s.E.currentEdition(),this.character.progress.personalQuest),this.character.progress.personalQuestProgress||(this.character.progress.personalQuestProgress=[])),s.E.game.scenario||(this.retireEnabled=!this.personalQuest||this.personalQuest.requirements.every((e,a)=>this.character.progress.personalQuestProgress[a]>=(0,$.hZ)(e.counter))),this.hasAbilities=s.E.deckData(this.character,!0).abilities.length>0,this.replayable=!s.E.game.scenario&&null==s.E.game.figures.find(e=>e instanceof q.K&&e.name==this.character.name&&e.number==this.character.number),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.availablePerks=this.character.level+Math.min(6,Math.floor(this.character.progress.battleGoals/3))-(this.character.progress.perks&&this.character.progress.perks.length>0?this.character.progress.perks.reduce((e,a)=>e+a):0)-1+this.character.progress.extraPerks+this.character.progress.retirements+this.character.progress.masteries.length;for(let e=0;e<15;e++)this.character.progress.perks[e]||(this.character.progress.perks[e]=0);this.retireEnabled=!1,s.E.game.scenario||(this.retireEnabled=!this.personalQuest||this.personalQuest.requirements.every((e,a)=>this.character.progress.personalQuestProgress[a]>=(0,$.hZ)(e.counter)))}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}applyValues(){let e="";if(this.titleInput&&(e=this.titleInput.nativeElement.value),this.titles.length>0){for(let a=0;a<this.titles.length;a++)this.titles[a]==m.f.getLabel("data.character."+this.character.edition+"."+this.character.name.toLowerCase())&&(this.titles[a]="");for(e=this.titles.join("|");e.endsWith("|");)e=e.substring(0,e.length-1)}e!=m.f.getLabel("data.character."+this.character.edition+"."+this.character.name.toLowerCase())?this.character.title!=e&&(s.E.stateManager.before("setTitle",s.E.characterManager.characterName(this.character),e),this.character.title=e,s.E.stateManager.after()):""!=this.character.title&&(s.E.stateManager.before("unsetTitle",s.E.characterManager.characterName(this.character),this.character.title),this.character.title="",s.E.stateManager.after())}titleChange(){this.standalone&&this.applyValues()}ngAfterViewInit(){this.titleInput&&(this.titleInput.nativeElement.value=this.character.title||m.f.getLabel("data.character."+this.character.edition+"."+this.character.name.toLowerCase()))}toggleCharacterAbsent(){(this.character.absent||s.E.characterManager.characterCount()>1)&&(s.E.stateManager.before(this.character.absent?"unsetAbsent":"setAbsent",s.E.characterManager.characterName(this.character)),this.character.absent=!this.character.absent,this.character.absent&&this.character.active&&s.E.roundManager.toggleFigure(this.character),s.E.stateManager.after())}setTitle(e,a){this.titles[a]=e.target.value,this.titleChange()}setLevel(e){this.character.level==e&&e--,e<1?e=1:e>9&&(e=9),s.E.stateManager.before("setLevel",s.E.characterManager.characterName(this.character),""+e),s.E.characterManager.setLevel(this.character,e),s.E.stateManager.after()}setXP(e){!isNaN(+e.target.value)&&this.character.progress.experience!=+e.target.value&&(this.xpTimeout&&(clearTimeout(this.xpTimeout),this.xpTimeout=null),this.xpTimeout=setTimeout(()=>{s.E.stateManager.before("setXP",s.E.characterManager.characterName(this.character),(0,V.n1)(+e.target.value-this.character.progress.experience)),s.E.characterManager.addXP(this.character,e.target.value-this.character.progress.experience,!s.E.game.scenario&&s.E.roundManager.firstRound),s.E.stateManager.after(),this.xpTimeout=null},500))}setGold(e){!isNaN(+e.target.value)&&this.character.progress.gold!=+e.target.value&&(this.goldTimeout&&(clearTimeout(this.goldTimeout),this.goldTimeout=null),this.goldTimeout=setTimeout(()=>{s.E.stateManager.before("setGold",s.E.characterManager.characterName(this.character),e.target.value),this.character.progress.gold=+e.target.value,s.E.stateManager.after(),this.goldTimeout=null},500))}setResource(e,a){isNaN(+a.target.value)||(s.E.stateManager.before("setResource",s.E.characterManager.characterName(this.character),"game.loot."+e,a.target.value),this.character.progress.loot[e]=+a.target.value,s.E.stateManager.after())}donate(){s.E.game.round<1&&this.character.progress.gold>9&&(s.E.stateManager.before("donate",s.E.characterManager.characterName(this.character)),this.character.progress.donations+=1,this.character.donations+=1,s.E.game.party.donations+=1,this.character.progress.gold-=this.fhSheet?5:10,s.E.stateManager.after())}setPersonalQuest(e){this.character.progress.personalQuest!=e.target.value&&(s.E.stateManager.before("setPQ",s.E.characterManager.characterName(this.character),e.target.value),this.character.progress.personalQuest=e.target.value,this.character.progress.personalQuestProgress=[],this.personalQuest=s.E.characterManager.personalQuestByCard(s.E.currentEdition(),this.character.progress.personalQuest),this.personalQuest&&(this.character.progress.personalQuest=this.personalQuest.cardId,this.retireEnabled=this.personalQuest.requirements.every((a,n)=>this.character.progress.personalQuestProgress[n]>=(0,$.hZ)(a.counter))),s.E.stateManager.after())}setPersonalQuestProgress(e,a){for(let o=0;o<=e;o++)this.character.progress.personalQuestProgress[o]||(this.character.progress.personalQuestProgress[o]=0);let n=0;if(n="number"==typeof a?a:+a.target.value,this.character.progress.personalQuestProgress[e]==n&&n--,s.E.stateManager.before("setPQProgress",s.E.characterManager.characterName(this.character),e+1,n),this.character.progress.personalQuestProgress[e]=n,s.E.stateManager.after(),!s.E.game.scenario){const o=this.retireEnabled;this.personalQuest&&(this.retireEnabled=this.personalQuest.requirements.every((g,_)=>this.character.progress.personalQuestProgress[_]>=(0,$.hZ)(g.counter))),!o&&this.retireEnabled&&m.f.settings.applyRetirement&&s.E.game.party.campaignMode&&this.retire(!1,!0)}}retire(e=!1,a=!1){(e||this.retireEnabled)&&(m.f.settings.applyRetirement&&s.E.game.party.campaignMode?this.dialog.open(Y7,{panelClass:["dialog"],data:this.character}).closed.subscribe({next:n=>{n&&this.dialogRef&&(0,V.co)(this.dialogRef)}}):a||(this.dialogRef&&(0,V.co)(this.dialogRef),s.E.stateManager.before(this.character.progress.retired?"setRetired":"unsetRetired",s.E.characterManager.characterName(this.character)),this.character.progress.retired=!0,s.E.game.party.campaignMode&&(s.E.game.party.retirements.push(this.character.toModel()),s.E.characterManager.removeCharacter(this.character)),s.E.stateManager.after()))}personalQuestRequirementUnlocked(e){return null!=this.personalQuest&&null!=this.personalQuest.requirements[e]&&this.personalQuest.requirements[e].requires&&this.personalQuest.requirements[e].requires.every(a=>this.personalQuest&&this.character.progress.personalQuestProgress[a-1]>=(0,$.hZ)(this.personalQuest.requirements[a-1].counter))}setExtraPerks(e){!isNaN(+e.target.value)&&this.character.progress.extraPerks!=+e.target.value&&(s.E.stateManager.before("setExtraPerks",s.E.characterManager.characterName(this.character),e.target.value),this.character.progress.extraPerks=+e.target.value,s.E.stateManager.after())}setRetirements(e){!isNaN(+e.target.value)&&this.character.progress.retirements!=+e.target.value&&(s.E.stateManager.before("setRetirements",s.E.characterManager.characterName(this.character),e.target.value),this.character.progress.retirements=+e.target.value,s.E.stateManager.after())}setPlayerNumber(e){if(!isNaN(+e.target.value)&&this.character.number!=+e.target.value&&+e.target.value>0){s.E.stateManager.before("setPlayerNumber",s.E.characterManager.characterName(this.character),e.target.value);const a=s.E.game.figures.find(n=>n instanceof q.K&&n.number==+e.target.value);a&&(a.number=this.character.number),this.character.number=+e.target.value,s.E.stateManager.after()}}setBattleGoals(e){this.character.progress.battleGoals==e&&e--,e<0?e=0:e>18&&(e=18),this.character.progress.battleGoals!=e&&(s.E.stateManager.before("setBG",s.E.characterManager.characterName(this.character),""+e),this.character.progress.battleGoals=e,s.E.stateManager.after())}setNotes(e){this.character.progress.notes!=e.target.value&&(s.E.stateManager.before("setNotes",s.E.characterManager.characterName(this.character),e.target.value),this.character.progress.notes=e.target.value,s.E.stateManager.after())}toggleMastery(e){this.character.progress.masteries||(this.character.progress.masteries=[]),-1==this.character.progress.masteries.indexOf(e)?(s.E.stateManager.before("addMastery",s.E.characterManager.characterName(this.character),""+e),this.character.progress.masteries.push(e)):(s.E.stateManager.before("removeMastery",s.E.characterManager.characterName(this.character),""+e),this.character.progress.masteries.splice(this.character.progress.masteries.indexOf(e),1)),s.E.stateManager.after()}togglePerk(e,a=!1){let n=this.character.progress.perks[e]+1;n>this.character.perks[e].count&&(n=0),!a&&0==this.availablePerks&&0!=n&&this.character.progress.perks[e]&&(n=this.character.progress.perks[e]-1),!a&&(s.E.game.state!=T.mk.draw||s.E.game.round>0||0==this.availablePerks&&!this.character.progress.perks[e])&&n>1&&(n=0),this.addPerk(e,n,a)}addPerk(e,a,n=!1){if(!(!this.forceEdit&&(s.E.game.state!=T.mk.draw||s.E.game.round>0)||this.character.progress.perks[e]<a&&this.availablePerks<a-this.character.progress.perks[e])||n&&!m.f.settings.characterSheetLocked&&this.editable){s.E.stateManager.before("setPerk",s.E.characterManager.characterName(this.character),""+e,""+a);const g="shackles"==this.character.name&&"fh"==this.character.edition&&11==e&&2==this.character.progress.perks[e];this.character.progress.perks[e]&&this.character.progress.perks[e]==a?this.character.progress.perks[e]--:this.character.progress.perks[e]=a,this.character.mergeAttackModifierDeck(s.E.attackModifierManager.buildCharacterAttackModifierDeck(this.character)),s.E.attackModifierManager.shuffleModifiers(this.character.attackModifierDeck),"shackles"==this.character.name&&"fh"==this.character.edition&&11==e&&(2==this.character.progress.perks[e]?this.character.maxHealth+=5:g&&(this.character.maxHealth-=5),this.character.health=this.character.maxHealth),s.E.stateManager.after()}}moveResources(){this.dialog.open(Ra,{panelClass:["dialog"],data:{character:this.character}})}exportCharacter(){const e=document.createElement("a");e.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(this.character.toModel()))),e.setAttribute("download",(this.character.title?this.character.title+"_":"")+this.character.name+".json"),document.body.appendChild(e),e.click(),document.body.removeChild(e)}importCharacter(e){const a=e.target.parentElement;a.classList.remove("error");try{const n=new FileReader;n.addEventListener("load",o=>{const g=Object.assign(new q.K(this.character,this.character.level).toModel(),JSON.parse(o.target.result));g.name!=this.character.name||g.edition!=this.character.edition?a.classList.add("error"):(s.E.stateManager.before("importCharacter",s.E.characterManager.characterName(this.character)),this.character.fromModel(g),s.E.stateManager.after())}),n.readAsText(e.target.files[0])}catch(n){console.warn(n),a.classList.add("error")}}setAside(){s.E.stateManager.before("characterSetAside",s.E.characterManager.characterName(this.character,!0,!0),s.E.game.party.players[this.character.number-1]?s.E.game.party.players[this.character.number-1]:""+this.character.number),s.E.game.party.availableCharacters=s.E.game.party.availableCharacters||[],s.E.game.party.availableCharacters.push(this.character.toModel()),s.E.characterManager.removeCharacter(this.character),s.E.stateManager.after(),this.dialogRef&&(0,V.co)(this.dialogRef)}replay(){this.replayable&&(s.E.stateManager.before("characterReplay",s.E.characterManager.characterName(this.character,!0,!0),s.E.game.party.players[this.character.number-1]?s.E.game.party.players[this.character.number-1]:""+this.character.number),s.E.game.party.availableCharacters=s.E.game.party.availableCharacters.filter(e=>e.name!=this.character.name||e.edition!=this.character.edition||e.number!=this.character.number),s.E.game.figures.forEach(e=>{e instanceof q.K&&e.number==this.character.number&&(s.E.game.party.availableCharacters.push(e.toModel()),s.E.characterManager.removeCharacter(e))}),s.E.game.figures.push(this.character),s.E.stateManager.after(),this.dialogRef&&(0,V.co)(this.dialogRef))}toggleFhSheet(){this.fhSheet=!this.fhSheet,this.gh2eSheet=!this.gh2eSheet&&!s.E.fhRules()&&s.E.fhRules(!0),this.csSheet=!this.fhSheet&&("cs"==this.character.edition||-1!=s.E.editionExtensions(this.character.edition).indexOf("cs"))}openAbilityCards(){this.dialog.open(Ps,{panelClass:["dialog"],data:{character:this.character}})}statistics(){this.dialog.open(Fs,{panelClass:["dialog-invert"],data:this.character})}openTrial(){this.character.progress.trial&&this.dialog.open(ns,{panelClass:["fullscreen-panel"],data:{edition:this.character.progress.trial.edition,trial:+this.character.progress.trial.name}})}setTrial(e){e.target.classList.add("error");let a=+e.target.value;if(m.f.settings.fhSecondEdition&&(a=s.E.trialsManager.cardIdSecondPrinting(a)),!this.character.progress.trial||this.character.progress.trial.name!=""+a){const n=s.E.editionData.find(o=>o.edition==s.E.currentEdition()&&o.trials&&o.trials.length);if(n&&n.trials.find(g=>g.cardId==a&&g.edition==s.E.currentEdition()))if(e.target.classList.remove("error"),e.target.classList.add("warning"),s.E.game.figures.find(g=>g instanceof q.K&&g.progress.trial&&g.progress.trial.edition==s.E.currentEdition()&&g.progress.trial.name==""+a))this.character.progress.trial&&(a=m.f.settings.fhSecondEdition?s.E.trialsManager.cardIdSecondPrinting(+this.character.progress.trial.name):+this.character.progress.trial.name,e.target.value=a);else{s.E.stateManager.before("setTrial",s.E.characterManager.characterName(this.character),e.target.value),this.character.progress.trial=new vt.gw(""+a,s.E.currentEdition());const g=Math.max(...s.E.game.figures.filter(_=>_ instanceof q.K).map(_=>n.trials.find(y=>_.progress.trial&&y.cardId==+_.progress.trial.name&&y.edition==_.progress.trial.edition)).map(_=>_?n.trials.indexOf(_):-1));(!s.E.game.party.trials||s.E.game.party.trials!=g)&&(s.E.game.party.trials=g),e.target.classList.remove("warning"),s.E.stateManager.after()}}}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-character-sheet"]],viewQuery:function(a,n){if(1&a&&t.GBs(oR,5),2&a){let o;t.mGM(o=t.lsd())&&(n.titleInput=o.first)}},inputs:{character:"character",editable:"editable",forceEdit:"forceEdit",standalone:"standalone",dialogRef:"dialogRef"},standalone:!1,decls:114,vars:87,consts:[["charactertitle",""],["trialIndex",""],[1,"light","character-sheet",3,"ngClass"],[1,"container",3,"ngClass"],[1,"columns"],[1,"column","column-left"],[1,"row","title"],[3,"src"],[1,"headline",3,"ghs-label","ghs-label-attribute"],[1,"character-title"],[3,"ghs-label","ghs-label-args"],[1,"absent",3,"click","src","ghs-label","ghs-label-attribute"],[1,"row","base"],[1,"name"],[3,"ghs-label"],["type","text",3,"value"],[1,"level"],[1,"column"],["src","./assets/images/level.svg"],["src","./assets/images/experience.svg"],[1,"level-grid"],[1,"checkbox","level-item",3,"ngClass"],[1,"xp-item",3,"ngClass"],[1,"xp-gold-container"],[1,"row","xp-notes"],["type","number","min","0",3,"change","value"],[1,"row","gold-notes"],[1,"donations"],[1,"donate"],[1,"compact-separator"],[1,"row","resources"],[1,"row","notes"],[1,"row",3,"character"],[1,"row","masteries"],[1,"column","column-right"],[1,"row","perks"],[1,"headline"],[1,"list","ignore-denied",3,"ngClass"],[1,"perk"],[1,"warning",3,"ghs-label","ghs-label-attribute"],[1,"wip",3,"ghs-label","ghs-label-attribute"],[1,"row","battlegoals"],[1,"battlegoals-grid"],[1,"additional"],[1,"ignore-denied",3,"readOnly","value","ghs-label","ghs-label-attribute"],[3,"character"],[1,"column","column-right","notes"],[1,"spacer"],[1,"ignore-denied",3,"click","ghs-tooltip"],["src","./assets/images/stats.svg",1,"ghs-svg"],[1,"player-number"],["type","number","min","1",3,"change","keyup","value"],[1,"personal-quest"],[1,"retirements"],[1,"extra-perks"],["type","number","min","0",3,"change","keyup","value"],[1,"set-aside"],[1,"import-export"],[1,"export","ignore-denied",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/export.svg"],[1,"import",3,"click","ghs-label","ghs-label-attribute"],["type","file","accept","application/json",3,"change"],["src","./assets/images/import.svg"],[1,"toggle-fh-sheet","ignore-denied",3,"click"],[1,"ability-cards"],["type","text",3,"change","value"],[1,"checkbox","level-item",3,"click","ngClass"],[1,"xp-item",3,"click","ngClass"],["src","./assets/images/fh/loot.svg"],[3,"click","ngClass"],[1,"price"],["src","./assets/images/loot.svg"],[1,"move",3,"click"],[1,"resource-table"],[1,"materials"],[1,"resource","lumber"],["src","./assets/images/fh/loot/lumber.svg"],[1,"resource","metal"],["src","./assets/images/fh/loot/metal.svg"],[1,"resource","hide"],["src","./assets/images/fh/loot/hide.svg"],[1,"herbs"],[1,"resource","arrowvine"],["src","./assets/images/fh/loot/arrowvine.svg"],[1,"resource","axenut"],["src","./assets/images/fh/loot/axenut.svg"],[1,"resource","corpsecap"],["src","./assets/images/fh/loot/corpsecap.svg"],[1,"resource","flamefruit"],["src","./assets/images/fh/loot/flamefruit.svg"],[1,"resource","rockroot"],["src","./assets/images/fh/loot/rockroot.svg"],[1,"resource","snowthistle"],["src","./assets/images/fh/loot/snowthistle.svg"],[1,"traits"],[1,"ignore-denied",3,"change","readOnly","value","ghs-label","ghs-label-attribute"],[1,"icon"],["src","./assets/images/fh/character/traits/trait.svg",1,"ghs-svg"],[1,"trait",3,"ghs-label"],[1,"divider"],[1,"masteries-list"],[1,"mastery"],[1,"checkmark"],["src","./assets/images/close.svg"],[1,"mastery-check","checkbox",3,"click","ngClass"],[1,"placeholder","text",3,"ghs-label"],[1,"checkboxes",3,"ngClass"],["ghs-pointer-input","",1,"checkbox",3,"ngClass"],["ghs-pointer-input","",3,"singleClick","doubleClick","ngClass","perk"],["ghs-pointer-input","",1,"checkbox",3,"singleClick","doubleClick","ngClass"],["src","./assets/images/warning.svg",1,"ghs-svg"],[1,"battlegoal","checkbox",3,"click","ngClass"],[1,"personal-quest-card"],["type","text",1,"card-id",3,"change","value"],["ghs-pointer-input","",1,"retire-button",3,"ngClass"],[1,"personal-quest-name"],[1,"trial"],[1,"requirements"],[1,"rewards"],["ghs-pointer-input","",1,"retire-button",3,"singleClick","doubleClick","ngClass"],["src","./assets/images/trophy.svg",1,"ghs-svg"],[1,"trial-card"],["type","text",1,"card-id",3,"change","keyup","value"],[1,"open","ignore-denied"],[1,"open","ignore-denied",3,"click"],["src","./assets/images/fh/trials/trial.png"],[1,"requirement",3,"ngClass"],[1,"requirement-name"],[1,"counter"],["type","number","min","0",3,"value","max"],[1,"checkbox",3,"ngClass","ghs-label","ghs-label-attribute"],[1,"checkbox",3,"click","ngClass","ghs-label","ghs-label-attribute"],["type","number","min","0",3,"change","value","max"],[1,"reward",3,"ghs-label","ghs-label-args"],[3,"click"],["src","./assets/images/long-rest.svg"],[1,"ignore-denied",3,"click"],[1,"ability-cards",3,"click"]],template:function(a,n){1&a&&(t.j41(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6),t.nrm(5,"img",7),t.j41(6,"label",8)(7,"div",9),t.nrm(8,"span",10),t.k0s(),t.j41(9,"img",11),t.bIt("click",function(){return n.toggleCharacterAbsent()}),t.k0s()()(),t.j41(10,"div",12)(11,"div",13)(12,"label"),t.nrm(13,"span",14),t.EFF(14,":"),t.k0s(),t.nVh(15,dR,2,1,"input",15),t.nVh(16,_R,3,4),t.k0s(),t.j41(17,"div",16)(18,"div",4)(19,"div",17)(20,"label"),t.nrm(21,"span",14)(22,"img",18),t.EFF(23,":"),t.k0s(),t.j41(24,"label"),t.nrm(25,"span",14)(26,"img",19),t.EFF(27,":"),t.k0s()(),t.j41(28,"div",17)(29,"div",20),t.Z7z(30,mR,2,4,"div",21,t.fX1),t.nI1(32,"ghsRange"),t.Z7z(33,pR,2,4,"div",22,t.fX1),t.nI1(35,"ghsRange"),t.k0s()()()()(),t.j41(36,"div",23)(37,"div",24)(38,"label"),t.nrm(39,"span",14)(40,"img",19),t.nVh(41,uR,2,1,"span"),t.EFF(42,":"),t.k0s(),t.j41(43,"input",25),t.bIt("change",function(g){return n.setXP(g)}),t.k0s()(),t.j41(44,"div",26),t.nVh(45,fR,3,1,"label"),t.nVh(46,CR,4,1,"label"),t.j41(47,"input",25),t.bIt("change",function(g){return n.setGold(g)}),t.k0s(),t.nVh(48,MR,2,4,"span",27),t.nVh(49,vR,7,5,"span",28),t.k0s()(),t.nVh(50,OR,1,0,"hr",29),t.nVh(51,PR,36,11,"div",30),t.nrm(52,"hr",29),t.nVh(53,xR,6,6,"div",31),t.nVh(54,ER,1,1,"ghs-character-items",32),t.nVh(55,wR,1,0,"hr",29),t.nVh(56,jR,7,1,"div",33),t.k0s(),t.j41(57,"div",34),t.nVh(58,GR,1,0,"hr",29),t.j41(59,"div",35),t.nVh(60,TR,2,1,"label",36),t.j41(61,"div",37),t.Z7z(62,$R,6,11,"div",38,gR),t.k0s(),t.nVh(64,DR,3,3,"div",39),t.nVh(65,IR,3,3,"div",40),t.k0s(),t.j41(66,"div",41),t.nVh(67,AR,2,1,"label",36),t.nVh(68,VR,2,1,"label",36),t.j41(69,"div",42),t.Z7z(70,XR,2,4,null,null,t.fX1),t.nI1(72,"ghsRange"),t.k0s()(),t.nVh(73,BR,1,0,"hr",29),t.k0s()(),t.j41(74,"div",43),t.nrm(75,"hr",29),t.nVh(76,YR,2,1,"label",36),t.j41(77,"div",4)(78,"div",5),t.nVh(79,NR,1,4,"textarea",44),t.nVh(80,zR,1,1,"ghs-character-items",45),t.k0s(),t.j41(81,"div",46)(82,"div",13),t.nVh(83,LR,2,0,"span"),t.nVh(84,UR,2,1,"span"),t.nrm(85,"span",47),t.j41(86,"a",48),t.bIt("click",function(){return n.statistics()}),t.nrm(87,"img",49),t.k0s()(),t.j41(88,"div",50)(89,"label"),t.nrm(90,"span",14),t.EFF(91,":"),t.k0s(),t.j41(92,"input",51),t.bIt("change",function(g){return n.setPlayerNumber(g)})("keyup",function(g){return n.setPlayerNumber(g)}),t.k0s()(),t.nVh(93,cj,12,8,"div",52),t.nVh(94,lj,5,2,"div",53),t.j41(95,"div",54)(96,"label"),t.nrm(97,"span",14),t.EFF(98,":"),t.k0s(),t.j41(99,"input",55),t.bIt("change",function(g){return n.setExtraPerks(g)})("keyup",function(g){return n.setExtraPerks(g)}),t.k0s()(),t.nVh(100,gj,4,1,"div",56),t.nVh(101,dj,4,1,"div",56),t.nrm(102,"hr",29),t.j41(103,"div",57)(104,"label",58),t.bIt("click",function(){return n.exportCharacter()}),t.nrm(105,"img",59)(106,"span",14),t.k0s(),t.j41(107,"label",60),t.bIt("click",function(){return n.ghsInputFullScreenCheck()}),t.j41(108,"input",61),t.bIt("change",function(g){return n.importCharacter(g)}),t.k0s(),t.nrm(109,"img",62)(110,"span",14),t.k0s()(),t.j41(111,"span",63),t.bIt("click",function(){return n.toggleFhSheet()}),t.nrm(112,"span",14),t.k0s()()()()(),t.nVh(113,hj,1,0,"div",64),t.k0s()),2&a&&(t.xc7("--ghs-character-color",n.character.color),t.Y8G("ngClass",t.ziG(70,sR,n.csSheet,n.fhSheet,n.gh2eSheet,n.settingsManager.settings.characterSheetCompact)),t.R7$(),t.Y8G("ngClass",t.l_i(75,zs,!n.forceEdit&&(!n.editable||!n.gameManager.stateManager.characterPermissions[n.character.name+"|"+n.character.edition])||n.settingsManager.settings.characterSheetLocked,!n.forceEdit&&!n.editable||n.settingsManager.settings.characterSheetLocked)),t.R7$(4),t.Y8G("src",n.character.iconUrl,t.B4B),t.R7$(),t.Y8G("ghs-label",n.character.absent?"character.absent":"character.present")("ghs-label-attribute","title"),t.R7$(2),t.Y8G("ghs-label","character.progress.title")("ghs-label-args",t.l_i(78,rR,"data.character."+n.character.edition+"."+n.character.name,n.character.characterClass?"character.class."+(n.character.gender?n.character.gender+".":"")+n.character.characterClass:"")),t.R7$(),t.Y8G("src","./assets/images/status/"+(n.character.absent?"absent":"present")+".svg",t.B4B)("ghs-label",n.character.absent?"character.present":"character.absent")("ghs-label-attribute","title"),t.R7$(4),t.Y8G("ghs-label","character.progress.name"),t.R7$(2),t.vxM(0!=n.titles.length&&n.settingsManager.settings.characterIdentities?-1:15),t.R7$(),t.vxM(n.titles.length>0&&n.settingsManager.settings.characterIdentities?16:-1),t.R7$(5),t.Y8G("ghs-label","character.progress.level"),t.R7$(4),t.Y8G("ghs-label","character.progress.xp"),t.R7$(5),t.Dyx(t.i5U(32,61,t.lJ4(81,wn),9)),t.R7$(3),t.Dyx(t.i5U(35,64,t.lJ4(82,wn),9)),t.R7$(6),t.Y8G("ghs-label","character.progress.xp"),t.R7$(2),t.vxM(n.fhSheet?-1:41),t.R7$(2),t.Y8G("value",n.character.progress.experience),t.R7$(2),t.vxM(n.fhSheet?-1:45),t.R7$(),t.vxM(n.fhSheet?46:-1),t.R7$(),t.Y8G("value",n.character.progress.gold),t.R7$(),t.vxM(n.donations?48:-1),t.R7$(),t.vxM(n.donations?49:-1),t.R7$(),t.vxM(n.fhSheet?50:-1),t.R7$(),t.vxM(n.fhSheet&&!n.gh2eSheet?51:-1),t.R7$(2),t.vxM(n.fhSheet?53:-1),t.R7$(),t.vxM(n.fhSheet?-1:54),t.R7$(),t.vxM(n.fhSheet?55:-1),t.R7$(),t.vxM(n.fhSheet?56:-1),t.R7$(2),t.vxM(n.fhSheet?-1:58),t.R7$(2),t.vxM(n.fhSheet?-1:60),t.R7$(),t.Y8G("ngClass",t.l_i(83,zs,!n.editable||n.settingsManager.settings.characterSheetLocked||!n.gameManager.stateManager.characterPermissions[n.character.name+"|"+n.character.edition],!n.editable||n.settingsManager.settings.characterSheetLocked)),t.R7$(),t.Dyx(n.character.perks),t.R7$(2),t.vxM(n.availablePerks<0?64:-1),t.R7$(),t.vxM(n.character.perkWarning?65:-1),t.R7$(2),t.vxM(n.fhSheet||n.csSheet?-1:67),t.R7$(),t.vxM(n.fhSheet?68:-1),t.R7$(2),t.Dyx(t.i5U(72,67,t.lJ4(86,wn),18)),t.R7$(3),t.vxM(n.fhSheet?73:-1),t.R7$(3),t.vxM(n.settingsManager.settings.characterSheetCompact&&n.fhSheet?-1:76),t.R7$(3),t.vxM(n.fhSheet?-1:79),t.R7$(),t.vxM(n.fhSheet?80:-1),t.R7$(3),t.vxM(0==n.character.number||n.character.number>n.gameManager.game.party.players.length||!n.gameManager.game.party.players[n.character.number-1]?83:-1),t.R7$(),t.vxM(n.character.number>0&&n.character.number<=n.gameManager.game.party.players.length&&n.gameManager.game.party.players[n.character.number-1]?84:-1),t.R7$(2),t.Y8G("ghs-tooltip","scenario.stats"),t.R7$(4),t.Y8G("ghs-label","character.playerNumber"),t.R7$(2),t.Y8G("value",n.character.number),t.R7$(),t.vxM(n.gameManager.editionRules("jotl")?-1:93),t.R7$(),t.vxM(n.gameManager.editionRules("jotl")?-1:94),t.R7$(3),t.Y8G("ghs-label","character.progress.perks.extra"),t.R7$(2),t.Y8G("value",n.character.progress.extraPerks),t.R7$(),t.vxM(n.editable&&n.settingsManager.settings.partySheet&&!n.gameManager.game.scenario?100:-1),t.R7$(),t.vxM(n.replayable&&n.settingsManager.settings.partySheet?101:-1),t.R7$(3),t.Y8G("ghs-label","character.progress.export")("ghs-label-attribute","title"),t.R7$(2),t.Y8G("ghs-label","character.progress.export"),t.R7$(),t.Y8G("ghs-label","character.progress.import")("ghs-label-attribute","title"),t.R7$(3),t.Y8G("ghs-label","character.progress.import"),t.R7$(2),t.Y8G("ghs-label","character.progress.fh."+(n.fhSheet?"disable":"enable")),t.R7$(),t.vxM(n.hasAbilities?113:-1))},dependencies:[N.YU,eR,tt,ft,Ns,rt,Tt],styles:['.character-sheet{position:relative;background-color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.character-sheet .denied.view-only{cursor:initial!important}.character-sheet .container{width:calc(var(--ghs-unit) * 62 * var(--ghs-dialog-factor));height:100%;background-image:url(character-sheet.70b336945f4b7a49.svg);background-position:top center;background-repeat:no-repeat;background-size:contain;padding-left:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor))}.character-sheet .container .compact-separator{display:none}.character-sheet .container .columns{display:flex}.character-sheet .container .columns .column{display:flex;flex-direction:column}.character-sheet .container .columns .column.column-left{width:calc(var(--ghs-unit) * 33 * var(--ghs-dialog-factor))}.character-sheet .container .columns .column.column-right{margin-left:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 25 * var(--ghs-dialog-factor))}.character-sheet .container .columns .column .row{display:flex}.character-sheet .container label{display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));white-space:nowrap}.character-sheet .container label img{width:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));height:auto;margin:0 calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.character-sheet .container label.headline{width:100%;justify-content:center}.character-sheet .container label.headline.absent{text-decoration:line-through}.character-sheet .container .title{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor))}.character-sheet .container .title img{width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:auto}.character-sheet .container .title label{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));padding-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));overflow:hidden}.character-sheet .container .title label .character-title{display:table;align-self:center}.character-sheet .container .title label .absent{cursor:pointer}.character-sheet .container .base{flex-direction:column;height:calc(var(--ghs-unit) * 10 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.character-sheet .container .base .level-grid{margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));display:grid;grid-template-columns:repeat(9,1fr)}.character-sheet .container .base .level-grid .level-item{cursor:pointer;position:relative;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);margin-left:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor));z-index:2}.character-sheet .container .base .level-grid .level-item.checked:before{opacity:.8}.character-sheet .container .base .level-grid .xp-item{cursor:pointer;position:relative;display:flex;justify-content:center;align-items:flex-end;width:calc(var(--ghs-unit) * 2.8 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));border-right:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);margin-top:calc(var(--ghs-unit) * -1 * var(--ghs-dialog-factor))}.character-sheet .container .base .level-grid .xp-item:last-child{border-right:none}.character-sheet .container .base .level-grid .xp-item:before{content:" ";position:absolute;top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));background-image:url(initiative.a7663b57012bb669.svg);background-position:center;background-repeat:no-repeat;background-size:contain}.character-sheet .container .base .level-grid .xp-item.checked:after{content:" ";position:absolute;top:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));clip-path:polygon(10% 100%,25% 100%,85% 0,70% 0);background-color:var(--ghs-color-black)}.character-sheet .container .xp-gold-container{display:flex;flex-direction:column}.character-sheet .container .xp-notes,.character-sheet .container .gold-notes{flex-direction:column;height:calc(var(--ghs-unit) * 10 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.character-sheet .container .gold-notes .donations{display:flex;align-items:center;line-height:.5em;margin-top:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor))}.character-sheet .container .gold-notes .donate{display:flex;align-items:center}.character-sheet .container .gold-notes .donate a{display:flex;align-items:center;cursor:pointer;color:var(--ghs-color-darkgray);margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet .container .gold-notes .donate a:hover{color:var(--ghs-color-black)}.character-sheet .container .gold-notes .donate a.disabled{pointer-events:none;color:var(--ghs-color-gray)}.character-sheet .container .gold-notes .donate a .price{display:flex;align-items:center;color:var(--ghs-color-yellow);margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet .container .gold-notes .donate a .price img{margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));filter:var(--ghs-filter-yellow);width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.character-sheet .container .notes,.character-sheet .container ghs-character-items{height:calc(var(--ghs-unit) * 34 * var(--ghs-dialog-factor));width:100%;margin-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.character-sheet .container .notes .items,.character-sheet .container ghs-character-items .items{width:100%}.character-sheet .container .notes .item-list,.character-sheet .container ghs-character-items .item-list{height:calc(var(--ghs-unit) * 27 * var(--ghs-dialog-factor));max-height:calc(var(--ghs-unit) * 27 * var(--ghs-dialog-factor));overflow:auto}.character-sheet .container .perks{flex-direction:column;height:calc(var(--ghs-unit) * 67 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet .container .perks .list{display:flex;flex-direction:column;height:calc(var(--ghs-unit) * 63.5 * var(--ghs-dialog-factor));overflow-y:auto}.character-sheet .container .perks .list .perk{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 1.9 * var(--ghs-dialog-factor) * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor) * var(--ghs-text-factor));margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));display:flex}.character-sheet .container .perks .list .perk .checkboxes{display:flex}.character-sheet .container .perks .list .perk .checkboxes .checkbox{margin-top:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor) * var(--ghs-text-factor) * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor) * var(--ghs-text-factor) * var(--ghs-text-factor))}.character-sheet .container .perks .list .perk .checkboxes .checkbox.disabled{pointer-events:initial;cursor:not-allowed}.character-sheet .container .perks .list .perk .checkboxes.combined{flex-direction:column;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet .container .perks .list .perk .checkboxes.combined .checkbox{border-top-style:dashed;border-bottom-style:dashed;margin:0}.character-sheet .container .perks .list .perk .checkboxes.combined .checkbox:nth-child(1){border-top-style:solid}.character-sheet .container .perks .list .perk .checkboxes.combined .checkbox:nth-last-child(1){border-bottom-style:solid}.character-sheet .container .perks .list .perk ghs-perk-label{cursor:pointer}.character-sheet .container .perks .list .perk ghs-perk-label.disabled{cursor:initial}.character-sheet .container .perks .wip,.character-sheet .container .perks .warning{flex-basis:0}.character-sheet .container .battlegoals{flex-direction:column;height:calc(var(--ghs-unit) * 9 * var(--ghs-dialog-factor))}.character-sheet .container .battlegoals .battlegoals-grid{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));display:grid;grid-template-columns:repeat(12,1fr);align-items:center}.character-sheet .container .battlegoals .battlegoals-grid img{width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));height:auto}.character-sheet .container .battlegoals .battlegoals-grid .battlegoal{width:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.character-sheet .container .battlegoals .battlegoals-grid .checkmark{height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));display:flex;align-items:center}.character-sheet .container .personal-quest{flex-direction:column}.character-sheet .container .personal-quest .personal-quest-card{display:flex;align-items:center}.character-sheet .container .personal-quest .personal-quest-card .card-id{text-align:right;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor) * var(--ghs-text-factor));min-width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor) * var(--ghs-text-factor))}.character-sheet .container .personal-quest .personal-quest-card .personal-quest-name{font-family:var(--ghs-font-title)}.character-sheet .container .personal-quest .requirements{display:flex;flex-direction:column;margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.character-sheet .container .personal-quest .requirements .requirement{display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet .container .personal-quest .requirements .requirement.disabled{pointer-events:none;opacity:.7}.character-sheet .container .personal-quest .requirements .requirement .requirement-name{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.character-sheet .container .personal-quest .requirements .requirement .counter{display:flex;align-items:center;flex-grow:1}.character-sheet .container .personal-quest .requirements .requirement .counter .checkbox{margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet .container .personal-quest .requirements .requirement .counter input[type=number]{margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor) * var(--ghs-text-factor));min-width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor) * var(--ghs-text-factor));flex-grow:1;text-align:right;border:none;border-bottom-width:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor));border-bottom-style:solid;border-bottom-color:var(--ghs-color-gray)}.character-sheet .container .personal-quest .rewards{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-black)}.character-sheet .container .personal-quest .retire-button{cursor:pointer;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));display:flex;align-items:center}.character-sheet .container .personal-quest .retire-button:hover{opacity:.7}.character-sheet .container .personal-quest .retire-button.disabled{cursor:initial;color:var(--ghs-color-gray)}.character-sheet .container .personal-quest .retire-button.disabled .ghs-svg{filter:var(--ghs-filter-gray)}.character-sheet .container .trial{flex-direction:column}.character-sheet .container .trial .trial-card{display:flex;align-items:center}.character-sheet .container .trial .trial-card .card-id{text-align:right;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor) * var(--ghs-text-factor));min-width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor) * var(--ghs-text-factor))}.character-sheet .container .trial .trial-card .open{cursor:pointer}.character-sheet .container .trial .trial-card .open img{width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:auto}.character-sheet .container .notes{display:flex;flex-direction:column;height:calc(var(--ghs-unit) * 15 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor))}.character-sheet .container .notes .columns{margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));flex-grow:1}.character-sheet .container .notes .column-right{justify-content:space-between}.character-sheet .container .notes .name{display:flex;justify-content:initial;align-items:center}.character-sheet .container .notes .name a{cursor:pointer}.character-sheet .container .notes .name a:hover{opacity:.7}.character-sheet .container .notes .personal-quest,.character-sheet .container .notes .trial,.character-sheet .container .notes .extra-perks,.character-sheet .container .notes .retirements,.character-sheet .container .notes .player-number,.character-sheet .container .notes .set-aside{margin-top:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor));display:flex;align-items:center}.character-sheet .container .notes .personal-quest label,.character-sheet .container .notes .trial label,.character-sheet .container .notes .extra-perks label,.character-sheet .container .notes .retirements label,.character-sheet .container .notes .player-number label,.character-sheet .container .notes .set-aside label{flex-shrink:0;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.character-sheet .container .notes .personal-quest input[type=number],.character-sheet .container .notes .trial input[type=number],.character-sheet .container .notes .extra-perks input[type=number],.character-sheet .container .notes .retirements input[type=number],.character-sheet .container .notes .player-number input[type=number],.character-sheet .container .notes .set-aside input[type=number]{flex-grow:1;flex-basis:0;min-width:auto}.character-sheet .container .notes .personal-quest .checkbox,.character-sheet .container .notes .trial .checkbox,.character-sheet .container .notes .extra-perks .checkbox,.character-sheet .container .notes .retirements .checkbox,.character-sheet .container .notes .player-number .checkbox,.character-sheet .container .notes .set-aside .checkbox{flex-shrink:0;margin-left:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor))}.character-sheet .container .notes .personal-quest.set-aside label,.character-sheet .container .notes .trial.set-aside label,.character-sheet .container .notes .extra-perks.set-aside label,.character-sheet .container .notes .retirements.set-aside label,.character-sheet .container .notes .player-number.set-aside label,.character-sheet .container .notes .set-aside.set-aside label{cursor:pointer;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor))}.character-sheet .container .notes .personal-quest.set-aside label:hover,.character-sheet .container .notes .trial.set-aside label:hover,.character-sheet .container .notes .extra-perks.set-aside label:hover,.character-sheet .container .notes .retirements.set-aside label:hover,.character-sheet .container .notes .player-number.set-aside label:hover,.character-sheet .container .notes .set-aside.set-aside label:hover{opacity:.7}.character-sheet .container .notes .personal-quest.personal-quest,.character-sheet .container .notes .personal-quest.trial,.character-sheet .container .notes .trial.personal-quest,.character-sheet .container .notes .trial.trial,.character-sheet .container .notes .extra-perks.personal-quest,.character-sheet .container .notes .extra-perks.trial,.character-sheet .container .notes .retirements.personal-quest,.character-sheet .container .notes .retirements.trial,.character-sheet .container .notes .player-number.personal-quest,.character-sheet .container .notes .player-number.trial,.character-sheet .container .notes .set-aside.personal-quest,.character-sheet .container .notes .set-aside.trial{align-items:flex-start}.character-sheet .container .import-export{display:flex;justify-content:space-around}.character-sheet .container .import-export label{cursor:pointer}.character-sheet .container .import-export label input[type=file]{width:0;height:0;margin:0;padding:0;visibility:hidden}.character-sheet .container .import-export label:hover{opacity:.7}.character-sheet .container .wip,.character-sheet .container .warning{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));display:flex;justify-content:center;align-items:center;color:var(--ghs-color-red)}.character-sheet .container .wip.warning,.character-sheet .container .warning.warning{color:var(--ghs-color-yellow)}.character-sheet .container .wip img,.character-sheet .container .warning img{width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:auto;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));filter:var(--ghs-filter-red)}.character-sheet .container .wip.warning img,.character-sheet .container .warning.warning img{filter:var(--ghs-filter-yellow)}.character-sheet .container .checkbox{cursor:pointer;position:relative;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);border-radius:calc(var(--ghs-unit) * .15 * var(--ghs-dialog-factor));box-shadow:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * .15 * var(--ghs-dialog-factor)) var(--ghs-color-gray);z-index:2}.character-sheet .container .checkbox:before{content:" ";position:absolute;left:50%;top:50%;width:115%;height:115%;transform:scale(0);transform-origin:top left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;z-index:1;background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;filter:var(--ghs-filter-darkgray)}.character-sheet .container .checkbox.checked:before{transform:scale(1) translate(-50%,-50%)}.character-sheet .container .checkbox.checked.check:before{transform:scale(1)}.character-sheet .container .checkbox.disabled{top:calc(var(--ghs-unit) * .15 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * .15 * var(--ghs-dialog-factor));pointer-events:none;border-color:var(--ghs-color-gray);box-shadow:none}.character-sheet .container input[type=text]{margin:0;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));color:var(--ghs-color-black);background-color:transparent;border:none;border-bottom-width:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor));border-bottom-style:solid;border-bottom-color:var(--ghs-color-gray);user-select:auto;-webkit-user-select:auto;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.character-sheet .container input[type=number]{margin:0;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));color:var(--ghs-color-black);background-color:transparent;border:none;user-select:auto;-webkit-user-select:auto;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor))}.character-sheet .container textarea{color:var(--ghs-color-black);background-color:transparent;border:none;user-select:auto;-webkit-user-select:auto;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));width:100%;height:100%}.character-sheet .container .name{display:flex;align-items:center}.character-sheet .container .name img{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:auto}.character-sheet .container .name input[type=text]{min-width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.character-sheet.cs-sheet .container{background-image:url(character-sheet.00b73de5eb36d58f.svg)}.character-sheet.cs-sheet .columns .column.column-right .perks{margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 70 * var(--ghs-dialog-factor))}.character-sheet.cs-sheet .columns .column.column-right .perks .list{height:calc(var(--ghs-unit) * 69.5 * var(--ghs-dialog-factor))}.character-sheet .additional{margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet .additional .headline{margin-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .container{background-image:url(character-sheet.546b1024f4246598.svg)}.character-sheet.fh-sheet .xp-gold-container{display:grid;grid-template-columns:1fr 1fr;column-gap:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .xp-gold-container .xp-notes,.character-sheet.fh-sheet .xp-gold-container .gold-notes{margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .notes{position:relative;height:calc(var(--ghs-unit) * 11 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .notes .traits{position:relative;display:flex;justify-content:space-evenly;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor));flex-grow:1}.character-sheet.fh-sheet .notes .traits .icon{width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .notes .traits .icon .ghs-svg{height:100%;width:auto}.character-sheet.fh-sheet ghs-character-items{margin-top:0;height:auto}.character-sheet.fh-sheet ghs-character-items .item-list{height:auto!important}.character-sheet.fh-sheet .resources{position:relative;height:calc(var(--ghs-unit) * 19 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));flex-direction:column}.character-sheet.fh-sheet .resources .move{cursor:pointer;position:absolute;top:0;right:0;color:var(--ghs-color-black)}.character-sheet.fh-sheet .resources .move:hover{opacity:.5}.character-sheet.fh-sheet .resources .resource-table{display:flex;flex-direction:column;margin-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .resources .resource-table .resource{display:flex;padding:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .resources .resource-table .resource img{width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:auto}.character-sheet.fh-sheet .resources .resource-table .resource input{min-width:0;flex-grow:1}.character-sheet.fh-sheet .resources .resource-table .materials{display:grid;grid-template-columns:repeat(3,calc(var(--ghs-unit) * 11.1 * var(--ghs-dialog-factor)))}.character-sheet.fh-sheet .resources .resource-table .materials .resource{flex-direction:column;height:calc(var(--ghs-unit) * 5.5 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .resources .resource-table .materials .resource input{width:100%;margin-left:0}.character-sheet.fh-sheet .resources .resource-table .herbs{display:grid;grid-template-columns:repeat(3,calc(var(--ghs-unit) * 11.1 * var(--ghs-dialog-factor)))}.character-sheet.fh-sheet .resources .resource-table .herbs .resource{height:calc(var(--ghs-unit) * 4.7 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .masteries{height:calc(var(--ghs-unit) * 14 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));display:flex;flex-direction:column;overflow:auto}.character-sheet.fh-sheet .masteries .mastery{display:flex}.character-sheet.fh-sheet .masteries .mastery .mastery-check{flex-shrink:0;width:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .masteries .mastery .checkmark{flex-shrink:0;height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));display:flex;align-items:center}.character-sheet.fh-sheet .masteries .mastery .checkmark img{width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));height:auto}.character-sheet.fh-sheet .masteries .mastery .text{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 1.9 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .columns .column.column-right{flex-direction:column-reverse}.character-sheet.fh-sheet .columns .column.column-right .battlegoals{margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .columns .column.column-right .perks{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 65 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .columns .column.column-right .perks .list{height:calc(var(--ghs-unit) * 65 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .notes,.character-sheet.fh-sheet .additional{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.character-sheet.fh-sheet .notes .columns .column.column-right,.character-sheet.fh-sheet .additional .columns .column.column-right{flex-direction:column;justify-content:flex-start}.character-sheet.gh2e-sheet .container{background-image:url(character-sheet.a4c938b6ef4aae81.svg)}.character-sheet.gh2e-sheet .columns .column.column-right .battlegoals{position:relative;top:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor))}.character-sheet.gh2e-sheet .columns .column.column-right .battlegoals .battlegoals-grid{margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet.gh2e-sheet .notes{position:relative;margin-top:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 30 * var(--ghs-dialog-factor))}.character-sheet.compact .container{background-image:none;width:initial;max-width:calc(var(--ghs-unit) * 50 * var(--ghs-dialog-factor))}.character-sheet.compact .container .compact-separator{display:block;width:100%;margin:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor)) 0}.character-sheet.compact .container label.headline{justify-content:flex-start}.character-sheet.compact .container .checkbox{width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor) * var(--ghs-text-factor))!important;height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor) * var(--ghs-text-factor))!important}.character-sheet.compact .container input[type=number],.character-sheet.compact .container input[type=text]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor) * var(--ghs-text-factor))}.character-sheet.compact .container .notes{height:initial}.character-sheet.compact .container .columns{flex-direction:column}.character-sheet.compact .container .columns .column{width:auto!important;justify-content:center}.character-sheet.compact .container .columns .column.column-right{margin-left:0!important}.character-sheet.compact .container .columns .column .xp-gold-container{display:flex;flex-direction:column}.character-sheet.compact .container .columns .column .xp-gold-container .row{flex-direction:row}.character-sheet.compact .container .columns .column .xp-gold-container .row .donate{margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.character-sheet.compact .container .columns .column .row{height:auto!important;margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))!important}.character-sheet.compact .container .columns .column .row.perks .list{height:auto!important;overflow-y:initial}.character-sheet.compact .container .columns .column .row.perks .list .perk{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor) * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor) * var(--ghs-text-factor))}.character-sheet.compact .container .columns .column .row label.headline{width:auto!important}.character-sheet.compact .container .columns .column .row .resource-table .materials,.character-sheet.compact .container .columns .column .row .resource-table .herbs{grid-template-columns:repeat(3,1fr)}.character-sheet.compact .container .columns .column .row .resource-table .materials .resource,.character-sheet.compact .container .columns .column .row .resource-table .herbs .resource{display:grid;grid-template-columns:.3fr 1fr;align-items:center}.character-sheet.compact .container .columns .column .row .resource-table .materials .resource input,.character-sheet.compact .container .columns .column .row .resource-table .herbs .resource input{width:100%;margin-left:0}.character-sheet.compact .container .columns .column ghs-character-items .item-list{height:auto!important}.character-sheet.compact .level .columns{flex-direction:row}.character-sheet.compact .level .columns .column{width:auto!important}.character-sheet.compact .level .columns .column .level-item{width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor) * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor) * var(--ghs-text-factor));font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor) * var(--ghs-text-factor));border-width:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor) * var(--ghs-text-factor));margin-left:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor) * var(--ghs-text-factor))}.character-sheet.compact .level .columns .column .xp-item{width:calc(var(--ghs-unit) * 2.8 * var(--ghs-dialog-factor) * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor) * var(--ghs-text-factor));font-size:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor) * var(--ghs-text-factor));border-right-width:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor) * var(--ghs-text-factor));margin-top:calc(var(--ghs-unit) * -1 * var(--ghs-dialog-factor) / var(--ghs-text-factor))}.character-sheet.compact .level .columns .column .xp-item:before{top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor) * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor) * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor) * var(--ghs-text-factor))}.character-sheet.compact .level .columns .column .xp-item.checked:after{top:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor) * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor) * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor) * var(--ghs-text-factor))}.character-sheet.compact .battlegoals .battlegoals-grid{grid-template-columns:repeat(12,calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor)))}.character-sheet.compact .masteries .mastery .text{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor) * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor) * var(--ghs-text-factor))}.character-sheet .scroll-container.denied .export,.character-sheet .scroll-container.denied .export *{pointer-events:initial}.character-sheet .toggle-fh-sheet{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));cursor:pointer;display:flex;justify-content:flex-end;width:100%;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.character-sheet .ability-cards{position:absolute;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 30.5 * var(--ghs-dialog-factor));cursor:pointer;width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));z-index:1}.character-sheet .ability-cards:after{content:" ";position:absolute;inset:0;background-color:var(--ghs-character-color);-webkit-mask-image:url(hand-size.7a3c0915c9cd2c92.svg);mask-image:url(hand-size.7a3c0915c9cd2c92.svg);-webkit-mask-size:100%;mask-size:100%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;z-index:-1}\n'],encapsulation:2})}return i})();const _j=(i,r)=>({empty:i,off:r}),mj=i=>({empty:i}),pj=i=>({denied:i}),uj=i=>({"outer-denied":i}),fj=()=>[],Cj=(i,r)=>r.name+r.color+r.number,Mj=(i,r)=>r.name+r.value;function vj(i,r){if(1&i&&t.nrm(0,"ghs-standee",6),2&i){const e=r.$implicit,a=t.XpG();t.Y8G("figure",a.character)("entity",e)}}function Oj(i,r){if(1&i&&t.nrm(0,"img",25),2&i){const e=r.$implicit,a=t.XpG(2).$implicit,n=t.XpG();t.xc7("z-index",a.value-e-1),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+a.name+".svg",t.B4B)}}function Pj(i,r){if(1&i&&(t.Z7z(0,Oj,1,3,"img",24,t.fX1),t.nI1(2,"ghsRange")),2&i){const e=t.XpG().$implicit;t.Dyx(t.i5U(2,0,t.lJ4(3,fj),e.value-1))}}function bj(i,r){if(1&i&&(t.j41(0,"span",23),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.value)}}function kj(i,r){if(1&i&&(t.j41(0,"span",14),t.nrm(1,"img",4),t.nVh(2,Pj,3,4),t.nVh(3,bj,2,1,"span",23),t.k0s()),2&i){const e=r.$implicit,a=t.XpG();t.R7$(),t.xc7("z-index",e.value),t.Y8G("src","./assets/images"+(a.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+e.name+".svg",t.B4B),t.R7$(),t.vxM(-1!=e.types.indexOf(a.ConditionType.stack)?2:-1),t.R7$(),t.vxM(-1!=e.types.indexOf(a.ConditionType.value)?3:-1)}}let yj=(()=>{class i extends Vs{cancel(){this.character.fullview=!1,s.E.stateManager.saveLocal(),s.E.uiChange.emit()}static \u0275fac=(()=>{let e;return function(n){return(e||(e=t.xGo(i)))(n||i)}})();static \u0275cmp=t.VBU({type:i,selectors:[["ghs-character-fullview"]],standalone:!1,features:[t.Vt3],decls:30,vars:28,consts:[[1,"container"],[1,"summons-container",3,"ngClass"],[1,"spacer"],[1,"icon",3,"ngClass","entityAnimation"],[3,"src"],[1,"summons"],[3,"figure","entity"],[1,"fullview"],[1,"row"],[3,"character","ngClass"],[1,"drag-initiative",3,"dragMove","dragEnd","singleClick","doubleClick","ngClass"],[3,"figure"],[3,"entity","figure"],[1,"conditions"],[1,"condition"],[1,"dialog"],[1,"dialog-container"],["type","character",3,"entity","figure","entityConditions","immunities","columns"],[1,"row","sheet"],[3,"character","standalone"],[1,"wip",3,"click"],["src","./assets/images/warning.svg",1,"ghs-svg"],[3,"ghs-label"],[1,"value"],[1,"stack",3,"z-index","src"],[1,"stack",3,"src"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"span",2),t.j41(3,"span",3),t.nrm(4,"img",4),t.k0s(),t.j41(5,"div",5),t.Z7z(6,vj,1,2,"ghs-standee",6,Cj),t.k0s()(),t.j41(8,"div",7)(9,"div",8),t.nrm(10,"ghs-character-image",9),t.j41(11,"ghs-pointer-input",10),t.bIt("dragMove",function(g){return n.gameManager.stateManager.characterPermissions[n.character.name+"|"+n.character.edition]&&n.dragInitiativeMove(g)})("dragEnd",function(g){return n.gameManager.stateManager.characterPermissions[n.character.name+"|"+n.character.edition]&&n.dragInitiativeEnd(g)})("singleClick",function(g){return n.toggleFigure(g)})("doubleClick",function(g){return n.gameManager.stateManager.characterPermissions[n.character.name+"|"+n.character.edition]&&n.initiativeDoubleClick(g)}),t.k0s(),t.nrm(12,"ghs-character-initiative",11)(13,"ghs-highlight-conditions",12),t.k0s(),t.j41(14,"div",8)(15,"div",13),t.Z7z(16,kj,4,5,"span",14,Mj),t.k0s()(),t.j41(18,"div",8)(19,"div",15)(20,"div",16),t.nrm(21,"ghs-conditions",17),t.k0s()()(),t.j41(22,"div",18),t.nrm(23,"ghs-character-sheet",19),t.k0s()(),t.j41(24,"a",20),t.bIt("click",function(){return n.cancel()}),t.nrm(25,"img",21)(26,"span",22),t.EFF(27,"!\xa0"),t.nrm(28,"span",22),t.EFF(29,"! "),t.k0s()()),2&a&&(t.R7$(),t.Y8G("ngClass",t.l_i(19,_j,0==n.summonCount,n.character.off||n.character.exhausted||n.character.health<=0)),t.R7$(2),t.Y8G("ngClass",t.eq3(22,mj,0==n.summonCount))("entityAnimation",0==n.summonCount),t.R7$(),t.Y8G("src",n.character.iconUrl,t.B4B),t.R7$(2),t.Dyx(n.character.summons),t.R7$(4),t.Y8G("character",n.character)("ngClass",t.eq3(24,pj,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.round)),t.R7$(),t.Y8G("ngClass",t.eq3(26,uj,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.round&&!n.gameManager.stateManager.characterPermissions[n.character.name+"|"+n.character.edition])),t.R7$(),t.Y8G("figure",n.character),t.R7$(),t.Y8G("entity",n.character)("figure",n.character),t.R7$(3),t.Dyx(n.activeConditions),t.R7$(5),t.Y8G("entity",n.character)("figure",n.character)("entityConditions",n.character.entityConditions)("immunities",n.character.immunities)("columns",6),t.R7$(2),t.Y8G("character",n.character)("standalone",!0),t.R7$(3),t.Y8G("ghs-label","wip"),t.R7$(2),t.Y8G("ghs-label","cancel"))},dependencies:[N.YU,js,xa,Us,mi,xi,tt,Ei,rt,wi,Tt],styles:['.attack-modifierdeck-container[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:5;width:0;height:0;visibility:hidden}.attack-modifierdeck-container[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;width:100%;overflow-x:auto;overflow-y:hidden}.attack-modifierdeck-container[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{position:absolute;display:flex;top:calc(var(--ghs-unit) * 1.5);left:calc(var(--ghs-unit) * 21.5);width:calc(var(--ghs-unit) * 37.5);height:calc(var(--ghs-unit) * 10);z-index:5}.attack-modifierdeck-container.active[_ngcontent-%COMP%], .attack-modifierdeck-container.loot-cards-container[_ngcontent-%COMP%], .loot-cards-container.active[_ngcontent-%COMP%], .loot-cards-container.loot-cards-container[_ngcontent-%COMP%]{visibility:visible;width:100%;height:100%}.attack-modifierdeck-container.permanent.active[_ngcontent-%COMP%], .loot-cards-container.permanent.active[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 98);height:calc(var(--ghs-unit) * 15.6)}.attack-modifierdeck-container.permanent.active[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%], .loot-cards-container.permanent.active[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 20)}.attack-modifierdeck-container.permanent.active[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%], .loot-cards-container.permanent.active[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 2.3);left:calc(var(--ghs-unit) * 17);width:calc(var(--ghs-unit) * 45);height:calc(var(--ghs-unit) * 12)}.attack-modifierdeck-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]{position:absolute;display:flex;top:calc(var(--ghs-unit) * .5 / var(--ghs-text-factor) / var(--ghs-text-factor));left:calc(var(--ghs-unit) * 21.5);z-index:3}.attack-modifierdeck-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 8.6666666667 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 13 * var(--ghs-text-factor));margin-right:calc(var(--ghs-unit) * .5 / var(--ghs-text-factor) / var(--ghs-text-factor))}.attack-modifierdeck-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]   ghs-loot[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]   ghs-loot[_ngcontent-%COMP%]{position:absolute;inset:0;display:block}.attack-modifierdeck-container[_ngcontent-%COMP%]   .attack-modifierdeck-close[_ngcontent-%COMP%], .attack-modifierdeck-container[_ngcontent-%COMP%]   .loot-cards-close[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .attack-modifierdeck-close[_ngcontent-%COMP%], .loot-cards-container[_ngcontent-%COMP%]   .loot-cards-close[_ngcontent-%COMP%]{display:inline-block;position:relative;cursor:zoom-out;top:0;left:0;z-index:2;width:100%;height:100%}.summons-container[_ngcontent-%COMP%]{position:relative;z-index:2;display:flex;align-items:center;transition:max-height calc(var(--ghs-animation-speed) * 2s) ease-out;max-height:100%;min-width:calc(var(--ghs-unit) * 7);max-width:calc(var(--ghs-unit) * 96)}.summons-container.empty[_ngcontent-%COMP%]{max-height:0}.summons-container[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{flex:none;width:calc(var(--ghs-unit) * 10.5);height:100%}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:block;width:auto;height:calc(var(--ghs-unit) * 6);margin-right:calc(var(--ghs-unit) * 1)}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{height:100%;width:auto;filter:var(--ghs-filter-shadow)}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]   img.menu[_ngcontent-%COMP%]{position:absolute;top:50%;left:calc(var(--ghs-unit) * -4);transform:translateY(-50%);width:calc(var(--ghs-unit) * 3.7 * var(--ghs-text-factor));height:auto;filter:var(--ghs-filter-darkgray);opacity:.5}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]:not(.empty){opacity:1;transform:translate(0)}.summons-container[_ngcontent-%COMP%]   .entities-menu.empty[_ngcontent-%COMP%]{opacity:0;max-width:0;height:0;transform:translateY(100%)}.summons-container[_ngcontent-%COMP%]   .entities-menu.disabled[_ngcontent-%COMP%]{cursor:initial;pointer-events:none}.summons-container[_ngcontent-%COMP%]   .entities-menu.disabled[_ngcontent-%COMP%]   img.menu[_ngcontent-%COMP%]{display:none}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]:hover   img.icon[_ngcontent-%COMP%]{opacity:.5}.summons-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]:hover   img.menu[_ngcontent-%COMP%]{opacity:1}.summons-container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;max-width:calc(var(--ghs-unit) * 77.5)}.summons-container[_ngcontent-%COMP%]   .summons[_ngcontent-%COMP%]   ghs-standee[_ngcontent-%COMP%]{position:relative;margin-bottom:calc(var(--ghs-unit) * 1)}.summons-container.spirits[_ngcontent-%COMP%]   ghs-standee[_ngcontent-%COMP%]{transition:top calc(var(--ghs-animation-speed) * .5s) ease-in-out}.summons-container.spirits[_ngcontent-%COMP%]   ghs-standee.active[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * -5)}.summons-container.off[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{filter:grayscale(100%)}.character[_ngcontent-%COMP%]{position:relative;z-index:1;height:100%;width:calc(var(--ghs-unit) * 98);height:calc(var(--ghs-unit) * 14);background-color:var(--ghs-character-color);background-image:url(char-mat.5a0fee77df1ff44e.png),url(char-mat.5a0fee77df1ff44e.png);background-blend-mode:multiply,overlay;background-size:100% 100%;display:flex;--ghs-character-color: #000;border-radius:calc(var(--ghs-unit) * .5);filter:var(--ghs-filter-outline);transition:background-color calc(var(--ghs-animation-speed) * .15s) ease-in-out,background-image calc(var(--ghs-animation-speed) * .15s) ease-in-out,background-blend-mode calc(var(--ghs-animation-speed) * .15s) ease-in-out}.character.dimmed[_ngcontent-%COMP%]{background-color:var(--ghs-color-gray);background-image:url(char-mat.5a0fee77df1ff44e.png);background-blend-mode:multiply}.character.dimmed[_ngcontent-%COMP%]   ghs-character-image[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   ghs-character-initiative[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .summon-dialog[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .short-menu[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .player-number[_ngcontent-%COMP%], .character.dimmed[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]{filter:grayscale(.15);opacity:.5}.character[_ngcontent-%COMP%]   ghs-entity-index-key[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 5);left:calc(var(--ghs-unit) * 3.2);z-index:6}.character[_ngcontent-%COMP%]   ghs-character-image[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 9.5);height:calc(var(--ghs-unit) * 9.5);margin:calc(var(--ghs-unit) * 2.1) calc(var(--ghs-unit) * 3.4);left:calc(var(--ghs-unit) * 2.4)}.character[_ngcontent-%COMP%]   ghs-character-initiative[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   ghs-character-image[_ngcontent-%COMP%]{z-index:2}.character[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 2.1);left:calc(var(--ghs-unit) * 6);width:calc(var(--ghs-unit) * 9.5);height:calc(var(--ghs-unit) * 9.5);z-index:4}.character[_ngcontent-%COMP%]   .drag-initiative.dragging[_ngcontent-%COMP%]{left:0!important;width:100%!important}.character[_ngcontent-%COMP%]   ghs-highlight-conditions[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 10.5);bottom:calc(var(--ghs-unit) * 2.5);z-index:20}.character[_ngcontent-%COMP%]   .entity-menu-container[_ngcontent-%COMP%]{cursor:pointer;position:absolute;inset:0}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{height:100%;display:flex;flex-basis:100%;cursor:pointer;margin-left:calc(var(--ghs-unit) * 1)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:flex-start}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 13);max-width:calc(var(--ghs-unit) * 10);overflow:visible}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .bar-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:flex-start}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-2[_ngcontent-%COMP%]{width:auto;z-index:2}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]{display:flex;align-items:center;z-index:2}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5);color:var(--ghs-color-white);text-shadow:var(--ghs-outline);display:flex;align-items:center;white-space:nowrap}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:calc(var(--ghs-unit) * 5.5);margin-left:calc(var(--ghs-unit) * -1.1);margin-right:calc(var(--ghs-unit) * .5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:auto}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   img.exhausted[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1);height:calc(var(--ghs-unit) * 4);width:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .token-container[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--ghs-color-white);font-family:var(--ghs-font-text);margin-left:calc(var(--ghs-unit) * .5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .token-container[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.7);margin:0 calc(var(--ghs-unit) * .1)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .token-container[_ngcontent-%COMP%]   .token.placeholder[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * -.5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{position:relative;display:flex;margin-left:calc(var(--ghs-unit) * .5);font-size:calc(var(--ghs-unit) * 2)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{position:relative;margin-left:calc(var(--ghs-unit) * .5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]:hover{transform:translate(50%,50%) scale(2);transform-origin:center center;z-index:999}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]:hover:before{content:" ";position:absolute;top:calc(var(--ghs-unit) * -1);left:calc(var(--ghs-unit) * -1);right:calc(var(--ghs-unit) * -1);bottom:calc(var(--ghs-unit) * -1);background-color:var(--ghs-color-darkgray);opacity:.5;border-radius:calc(var(--ghs-unit) * 1)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .action-overlay[_ngcontent-%COMP%]{position:absolute;z-index:1;top:calc(var(--ghs-unit) * 1);left:calc(var(--ghs-unit) * -.5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .status-bar[_ngcontent-%COMP%]{display:flex;align-items:center;z-index:2;touch-action:none}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));width:auto}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]   img.damage[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) brightness(.7) var(--ghs-filter-outline-thin-black)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]   .value-overlay[_ngcontent-%COMP%]{position:absolute;left:100%;top:50%;transform:translateY(-50%);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor));z-index:1000}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;max-height:calc(var(--ghs-unit) * 7 * var(--ghs-text-factor));padding:0 calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));background-color:var(--ghs-color-darkgray);border-radius:100%;height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));margin-right:calc(var(--ghs-unit) * -1 * var(--ghs-text-factor));border-width:calc(var(--ghs-unit) * .4);border-style:solid;border-color:var(--ghs-color-gray)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.7 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 2.7 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]{position:relative;display:flex}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;margin-right:calc(var(--ghs-unit) * -.5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));overflow:visible}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));margin:0}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img.stack[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * -2 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition.condition-overlay[_ngcontent-%COMP%]{position:absolute;width:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));top:0;left:0;pointer-events:none;z-index:2}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));color:var(--ghs-color-white);position:absolute;top:calc(var(--ghs-unit) * 2.1 * var(--ghs-text-factor));left:50%;text-shadow:none;transform:translate(-50%)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:hover{transform:scale(2);transform-origin:center center;z-index:999}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw[_ngcontent-%COMP%]{position:relative;z-index:999;width:0;height:0;top:50%;left:calc(var(--ghs-unit) * -3);overflow:visible}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw[_ngcontent-%COMP%]   ghs-attackmodifier-draw[_ngcontent-%COMP%]{position:absolute;width:0;height:0}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw.drawing[_ngcontent-%COMP%]   ghs-attackmodifier-draw[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 18);height:calc(var(--ghs-unit) * 12)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;align-self:center;z-index:1}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor) * var(--ghs-text-factor));height:auto;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%]:hover, .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%]:hover, .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%]:hover, .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%]:hover{opacity:.7}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.disabled[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.disabled[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.disabled[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.disabled[_ngcontent-%COMP%]{pointer-events:none}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.loot-cards-button[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.loot-cards-button[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.loot-cards-button[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.loot-cards-button[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{position:absolute;bottom:calc(var(--ghs-unit) * -1.5 * var(--ghs-text-factor));right:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));color:var(--ghs-color-white)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.battlegoals-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.items-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.battlegoals-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.items-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.battlegoals-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.items-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.battlegoals-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.items-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));border-radius:calc(var(--ghs-unit) * .3 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.battlegoals-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.items-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.battlegoals-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.items-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.battlegoals-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.items-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.battlegoals-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.items-button[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-70%,-50%);width:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));filter:var(--ghs-filter-green) var(--ghs-filter-outline)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.attack-modifier-button.bb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.attack-modifier-button.bb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.attack-modifier-button.bb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.attack-modifier-button.bb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor) * var(--ghs-text-factor));height:auto}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button.items-button.bb[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button.items-button.bb[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button.items-button.bb[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button.items-button.bb[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 5)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .bb-spacer[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 7 / var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));filter:var(--ghs-filter-shadow);width:calc(var(--ghs-unit) * 6.5);margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));margin-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .experience.experience[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot.experience[_ngcontent-%COMP%]{color:var(--ghs-color-blue)}.character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .experience.loot[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot.loot[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.character.absent[_ngcontent-%COMP%]{cursor:initial;opacity:.6}.character.absent[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{cursor:initial}.character[_ngcontent-%COMP%]   .absent-menu[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:calc(var(--ghs-unit) * 82);height:calc(var(--ghs-unit) * 14);cursor:pointer;z-index:2}.character[_ngcontent-%COMP%]   .summon-dialog[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .short-menu[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .summon-dialog-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .toggle-menu[_ngcontent-%COMP%]{position:relative;display:flex;width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));cursor:pointer;font-size:calc(var(--ghs-unit) * 10 * var(--ghs-text-factor));color:var(--ghs-color-gray);filter:var(--ghs-filter-gray);stroke:var(--ghs-color-black);stroke-width:calc(var(--ghs-unit) * 1.5)}.character[_ngcontent-%COMP%]   .summon-dialog-button[_ngcontent-%COMP%]:hover, .character[_ngcontent-%COMP%]   .toggle-menu[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white);filter:var(--ghs-filter-white)}.character[_ngcontent-%COMP%]   .summon-dialog-button.toggle-menu[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .toggle-menu.toggle-menu[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   ghs-figure-errors[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 14.5);top:50%;transform:translateY(-50%);z-index:99}.character[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]{position:relative;cursor:pointer;height:100%;width:calc(var(--ghs-unit) * 10);display:flex;justify-content:center;align-items:center;margin-right:calc(var(--ghs-unit) * 4);margin-left:calc(var(--ghs-unit) * 2)}.character[_ngcontent-%COMP%]   .character-sheet-button.hand-size-margin[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 4.5)}.character[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 8);width:auto;filter:var(--ghs-filter-shadow)}.character[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%]{position:absolute;right:calc(var(--ghs-unit) * 14);top:calc(var(--ghs-unit) * 4);width:calc(var(--ghs-unit) * 4.2);height:calc(var(--ghs-unit) * 5);display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.4);padding-right:calc(var(--ghs-unit) * .4);z-index:1}.character[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%]:after{content:" ";position:absolute;inset:0;background-color:var(--ghs-character-color);-webkit-mask-image:url(hand-size-mask.5857c02745e3d418.svg);mask-image:url(hand-size-mask.5857c02745e3d418.svg);-webkit-mask-size:100%;mask-size:100%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;filter:brightness(1.6);z-index:-1}.character[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]{position:absolute;right:calc(var(--ghs-unit) * 13.3);top:calc(var(--ghs-unit) * 10);width:calc(var(--ghs-unit) * 4.2);height:calc(var(--ghs-unit) * 5);display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.4);padding-right:calc(var(--ghs-unit) * .4);z-index:1}.character[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:0;left:calc(var(--ghs-unit) * -.5);bottom:0;right:0;background-color:var(--ghs-character-color);-webkit-mask-image:url(level.38e1f58a07dc5898.svg);mask-image:url(level.38e1f58a07dc5898.svg);-webkit-mask-size:100%;mask-size:100%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;z-index:-1}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 24.5);top:calc(var(--ghs-unit) * .5);width:calc(var(--ghs-unit) * 33);height:calc(var(--ghs-unit) * 2.64);display:flex;justify-content:space-evenly;align-items:center}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:0;background-color:var(--ghs-character-color);-webkit-mask-image:url(outer-mask.f0af43cfab648186.svg);mask-image:url(outer-mask.f0af43cfab648186.svg);-webkit-mask-size:100%;mask-size:100%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;z-index:0}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]:after{content:" ";position:absolute;inset:0;background-color:var(--ghs-character-color);-webkit-mask-image:url(inner-mask.f2d18d4a7559b09e.svg);mask-image:url(inner-mask.f2d18d4a7559b09e.svg);-webkit-mask-size:100%;mask-size:100%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;filter:brightness(.5);z-index:1}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]   .trait[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.5);color:var(--ghs-character-color);z-index:2}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{position:absolute;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 1.8);height:calc(var(--ghs-unit) * 1.8);left:0;top:50%;transform:translateY(-45%) rotate(45deg);border:calc(var(--ghs-unit) * .2) solid var(--ghs-character-color);z-index:2}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:110%;width:auto;filter:var(--ghs-filter-white);transform:rotate(-45deg);z-index:1}.character[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:0;background-color:var(--ghs-character-color);z-index:0;filter:brightness(.5)}.character[_ngcontent-%COMP%]   .player-number[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 1.8);top:calc(var(--ghs-unit) * 4.3);width:calc(var(--ghs-unit) * 5);height:calc(var(--ghs-unit) * 5);display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.7);z-index:1;border:calc(var(--ghs-unit) * .2) solid var(--ghs-color-gray);border-top-left-radius:80%;border-bottom-left-radius:80%;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}.character[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 18 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 62 * var(--ghs-text-factor));bottom:calc(var(--ghs-unit) * .5);color:var(--ghs-color-white);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2);display:flex;justify-content:center;align-items:center}.character[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * .2 * var(--ghs-text-factor))}.character[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%], .character[_ngcontent-%COMP%]:before{transition:filter calc(var(--ghs-animation-speed) * .15s) ease-in-out}.character.off[_ngcontent-%COMP%]{background-color:var(--ghs-color-gray);background-image:url(char-mat.5a0fee77df1ff44e.png);background-blend-mode:multiply}.character.off[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .summon-dialog[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .short-menu[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%], .character.off[_ngcontent-%COMP%]:before{filter:grayscale(1)!important}.character.denied[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .attack-modifierdeck-close[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .loot-cards-close[_ngcontent-%COMP%], .character.denied[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{pointer-events:initial}.character.fh[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]:after{top:calc(var(--ghs-unit) * -.5)}.character.short[_ngcontent-%COMP%]:not(.compact){width:calc(var(--ghs-unit) * 57);height:calc(var(--ghs-unit) * 28);background-image:url(char-mat-short.a094776e83c7bcfc.png),url(char-mat-short.a094776e83c7bcfc.png)}.character.short[_ngcontent-%COMP%]:not(.compact)   ghs-character-image[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * 2.8) calc(var(--ghs-unit) * 2)}.character.short[_ngcontent-%COMP%]:not(.compact)   ghs-highlight-conditions[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 9);bottom:calc(var(--ghs-unit) * 16)}.character.short[_ngcontent-%COMP%]:not(.compact)   .drag-initiative[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 2.8);left:calc(var(--ghs-unit) * 4.3)}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 2);right:calc(var(--ghs-unit) * 2);height:calc(var(--ghs-unit) * 26.5);flex-wrap:wrap}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 12);width:100%;max-width:initial;flex-direction:row;justify-content:flex-start;align-items:center}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   ghs-character-initiative[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 10);margin-top:calc(var(--ghs-unit) * 1);margin-left:initial}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 2);margin-right:calc(var(--ghs-unit) * 2);margin-top:calc(var(--ghs-unit) * 2);height:auto}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 16);left:calc(var(--ghs-unit) * 0);right:initial}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 20.5);left:calc(var(--ghs-unit) * .2);right:initial}.character.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .player-number[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 4.8);left:calc(var(--ghs-unit) * -6.7)}.character.compact[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 10.25);background-image:url(char-mat_compact.b0d0dd33f05dffe7.png),url(char-mat_compact.b0d0dd33f05dffe7.png)}.character.compact[_ngcontent-%COMP%]   ghs-entity-index-key[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 3.1)}.character.compact[_ngcontent-%COMP%]   ghs-character-image[_ngcontent-%COMP%], .character.compact[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]{display:none}.character.compact[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 2.5);left:calc(var(--ghs-unit) * 6.5);width:calc(var(--ghs-unit) * 5);height:calc(var(--ghs-unit) * 5)}.character.compact[_ngcontent-%COMP%]   .attack-modifierdeck-container[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 1 / var(--ghs-text-factor));left:calc(var(--ghs-unit) * 13);width:calc(var(--ghs-unit) * 30 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 8 * var(--ghs-text-factor))}.character.compact[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * .5 / var(--ghs-text-factor) / var(--ghs-text-factor));left:calc(var(--ghs-unit) * 8)}.character.compact[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 6 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 9 * var(--ghs-text-factor))}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 7)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%], .character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .bar-container[_ngcontent-%COMP%]{flex-direction:row;justify-content:flex-start;align-items:center}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * .5);margin-left:calc(var(--ghs-unit) * -.5)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4.5)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 7 * var(--ghs-text-factor));padding-top:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-2[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 7)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .experience[_ngcontent-%COMP%], .character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 6)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw.drawing[_ngcontent-%COMP%]   ghs-attackmodifier-draw[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 13.5);height:calc(var(--ghs-unit) * 9)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 1.4);right:calc(var(--ghs-unit) * 2);left:initial}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 6);right:calc(var(--ghs-unit) * 1.8);left:initial}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 11)}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .player-number[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 3.3);left:calc(var(--ghs-unit) * 1.7);width:calc(var(--ghs-unit) * 3.5);height:calc(var(--ghs-unit) * 3.5);font-size:calc(var(--ghs-unit) * 2);border-radius:80%}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]{display:none}.character.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 10);width:calc(var(--ghs-unit) * 70);justify-content:flex-start}.character.compact.short[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 57)}.character.compact.short[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 2)}.character.compact.short[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * .5)}.character.compact.short[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3);white-space:initial}.character.compact.short[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .status-bar[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{width:auto}.character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1.5)}.character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .summon-dialog[_ngcontent-%COMP%], .character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-2[_ngcontent-%COMP%]{display:none}.character.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .short-menu[_ngcontent-%COMP%]{position:absolute;top:0;right:calc(var(--ghs-unit) * 6);bottom:0}.character.compact.short.menu[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   ghs-highlight-conditions[_ngcontent-%COMP%]{display:none}.character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 4.5)}.character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{display:none}.character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-draw[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .summon-dialog[_ngcontent-%COMP%], .character.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-2[_ngcontent-%COMP%]{display:inherit}.character.modern[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 16);border-top-left-radius:calc(var(--ghs-unit) * 13);border-top-right-radius:calc(var(--ghs-unit) * 12);border-bottom-right-radius:calc(var(--ghs-unit) * 12);background-image:url(char-mat_modern.2238b82519930f08.png);background-blend-mode:hard-light;filter:none;overflow:hidden}.character.modern.dimmed[_ngcontent-%COMP%]{background-image:url(char-mat_modern.2238b82519930f08.png)}.character.modern[_ngcontent-%COMP%]   ghs-entity-index-key[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * .5);left:calc(var(--ghs-unit) * 13.7)}.character.modern[_ngcontent-%COMP%]   ghs-character-image[_ngcontent-%COMP%], .character.modern[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{top:0;left:0;width:calc(var(--ghs-unit) * 16);height:calc(var(--ghs-unit) * 16);margin:0}.character.modern[_ngcontent-%COMP%]   .character-sheet-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:grayscale(1) brightness(.3)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 2.5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * -1 / var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4.5);filter:grayscale(1) brightness(.3);margin-left:calc(var(--ghs-unit) * -.5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .status-bar[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 2.5);min-height:calc(var(--ghs-unit) * 5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .battlegoals-button[_ngcontent-%COMP%], .character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .items-button[_ngcontent-%COMP%], .character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .attack-modifier-button[_ngcontent-%COMP%], .character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .loot-cards-button[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 5.5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .summon-dialog-button[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .col-2[_ngcontent-%COMP%]{padding-top:calc(var(--ghs-unit) * 5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .hand-size[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 6.5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * 13.9);top:0}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-level[_ngcontent-%COMP%]:after{top:calc(var(--ghs-unit) * -.5)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 18);top:initial;bottom:0}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]:before{transform:rotate(180deg)}.character.modern[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .character-traits[_ngcontent-%COMP%]:after{transform:rotate(180deg)}.character.modern[_ngcontent-%COMP%]   .attack-modifierdeck-container[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 3 / var(--ghs-text-factor) / var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * .5 / var(--ghs-text-factor) / var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .loot-cards[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 10 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 15 * var(--ghs-text-factor))}.character.modern[_ngcontent-%COMP%]   .special-actions[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 17);width:calc(var(--ghs-unit) * 55);justify-content:flex-start}',"[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%;height:100%;overflow:auto}.container[_ngcontent-%COMP%]{height:100%}.fullview[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;align-items:center}.fullview[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1);position:relative;display:flex}.fullview[_ngcontent-%COMP%]   ghs-character-image[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 15);height:calc(var(--ghs-unit) * 15);border-radius:calc(var(--ghs-unit) * 2)}.fullview[_ngcontent-%COMP%]   ghs-highlight-conditions[_ngcontent-%COMP%]{position:absolute;left:0;top:50%;transform:translateY(-50%);width:calc(var(--ghs-unit) * 15);z-index:5}.fullview[_ngcontent-%COMP%]   ghs-pointer-input.drag-initiative[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:calc(var(--ghs-unit) * 15);height:100%;z-index:4}.fullview[_ngcontent-%COMP%]   ghs-pointer-input.drag-initiative.dragging[_ngcontent-%COMP%]{left:0;width:100%}.fullview[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]{position:relative;display:flex;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.fullview[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{position:relative;display:flex;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.fullview[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));margin:0}.fullview[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img.stack[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * -3 * var(--ghs-text-factor))}.fullview[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-text-factor));color:var(--ghs-color-white);position:absolute;top:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));left:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));text-shadow:none;transform:translate(-50%)}.fullview[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]{padding:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));background-color:var(--ghs-color-white)}.wip[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;color:var(--ghs-color-red);font-size:calc(var(--ghs-unit) * 4)}.wip[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow) var(--ghs-filter-shadow);width:calc(var(--ghs-unit) * 4);height:auto;margin-right:calc(var(--ghs-unit) * 1)}.wip[_ngcontent-%COMP%]:hover{color:var(--ghs-color-black)}"]})}return i})();const xj=["menu"],Ej=(i,r,e)=>({fh:i,modern:r,"has-removed":e}),ja=(i,r)=>[i,r],Ga=i=>({edit:i}),qs=i=>({disabled:i}),wj=(i,r)=>({active:i,keep:r}),Ri=(i,r)=>r.cardId;function Rj(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",21),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.reveal=(n.reveal+1)%3)}),t.nrm(1,"span",20),t.k0s()}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label",2==e.reveal?"game.cards.coverAll":0==e.reveal?"game.cards.revealAll":"game.cards.revealAllConfirm")}}function jj(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",22),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.drawCard())}),t.nrm(1,"span",20),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(2,qs,e.drawDisabled)),t.R7$(),t.Y8G("ghs-label","game.cards.draw")}}function Gj(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",23),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.shuffle())})("doubleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.shuffle(!0))}),t.nrm(1,"span",20),t.k0s()}2&i&&(t.Y8G("ghs-tooltip","game.cards.shuffle.upcomingHint")("overlayX","center"),t.R7$(),t.Y8G("ghs-label","game.cards.shuffle"))}function Tj(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",24),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.toggleEdit())}),t.k0s(),t.nrm(2,"span",20),t.k0s()}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("checked",e.edit),t.R7$(),t.Y8G("ghs-label","game.cards.edit")}}function Sj(i,r){if(1&i){const e=t.RV6();t.nVh(0,Rj,2,1,"a"),t.nVh(1,jj,2,4,"a",17),t.nVh(2,Gj,2,3,"a",18),t.j41(3,"a",19),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.clear())})("doubleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.clear(!1))}),t.nrm(4,"span",20),t.k0s(),t.nVh(5,Tj,3,2,"label")}if(2&i){const e=t.XpG();t.vxM(e.edit?0:-1),t.R7$(),t.vxM(e.edit?-1:1),t.R7$(),t.vxM(e.edit?2:-1),t.R7$(),t.Y8G("ngClass",t.eq3(6,qs,e.deck.current<=e.deck.finished)),t.R7$(),t.Y8G("ghs-label","challenges.deck.clear"+(e.drawAvailable>1?".multiple":"")),t.R7$(),t.vxM(e.gameManager.game.scenario?5:-1)}}function $j(i,r){if(1&i&&t.nrm(0,"span",20),2&i){const e=t.XpG(2);t.Y8G("ghs-label","challenges.deck.hint.drawAvailable"+(e.drawAvailable>1?".multiple":""))}}function Dj(i,r){if(1&i&&t.nrm(0,"span",20),2&i){const e=t.XpG(2);t.Y8G("ghs-label","challenges.deck.hint.select"+(e.keepAvailable>1?".multiple":""))}}function Ij(i,r){if(1&i&&t.nrm(0,"span",20),2&i){const e=t.XpG(2);t.Y8G("ghs-label","challenges.deck.hint.current"+(e.keepAvailable>1?".multiple":""))}}function Aj(i,r){if(1&i&&(t.j41(0,"div",7),t.nVh(1,$j,1,1,"span",20),t.nVh(2,Dj,1,1,"span",20),t.nVh(3,Ij,1,1,"span",20),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.vxM(e.drawDisabled?-1:1),t.R7$(),t.vxM(!e.disabled&&e.drawDisabled?2:-1),t.R7$(),t.vxM(e.disabled&&e.drawDisabled?3:-1)}}function Vj(i,r){1&i&&t.nrm(0,"div",11)}function Fj(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",28),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$index,o=t.XpG();return t.Njj(o.remove(n+o.deck.current+1))}),t.nrm(1,"img",29),t.k0s()}}function Xj(i,r){1&i&&t.nrm(0,"div",27)}function Bj(i,r){if(1&i&&(t.j41(0,"div",12),t.nrm(1,"ghs-challenge-card",25),t.nVh(2,Fj,2,0,"a",26),t.nVh(3,Xj,1,0,"div",27),t.k0s()),2&i){const e=r.$implicit,a=t.XpG();t.R7$(),t.Y8G("challenge",e)("reveal",!0)("flipped",2==a.reveal),t.R7$(),t.vxM(a.edit?2:-1),t.R7$(),t.vxM(a.edit?3:-1)}}function Yj(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",28),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$index,o=t.XpG();return t.Njj(o.remove(o.deck.current-n))}),t.nrm(1,"img",29),t.k0s()}}function Nj(i,r){1&i&&t.nrm(0,"div",27)}function zj(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",14)(1,"ghs-challenge-card",30),t.bIt("singleClick",function(){const n=t.eBV(e).$index,o=t.XpG();return t.Njj(o.toggleKeep(o.deck.current-n))})("doubleClick",function(){const n=t.eBV(e).$index,o=t.XpG();return t.Njj(o.toggleKeep(o.deck.current-n,!0))}),t.k0s(),t.nVh(2,Yj,2,0,"a",26),t.nVh(3,Nj,1,0,"div",27),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG();t.Y8G("ngClass",t.l_i(6,wj,!n.edit&&!!n.gameManager.game.scenario&&n.gameManager.roundManager.firstRound&&n.gameManager.game.state==n.GameState.draw,!n.disabled&&-1!=n.deck.keep.indexOf(n.deck.current-a))),t.R7$(),t.Y8G("challenge",e)("keep",-1!=n.deck.keep.indexOf(n.deck.current-a))("flipped",!0),t.R7$(),t.vxM(n.edit?2:-1),t.R7$(),t.vxM(n.edit?3:-1)}}function Lj(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",28),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$index,o=t.XpG();return t.Njj(o.remove(o.deck.finished-n))}),t.nrm(1,"img",29),t.k0s()}}function Uj(i,r){1&i&&t.nrm(0,"div",27)}function qj(i,r){if(1&i&&(t.j41(0,"div",12),t.nrm(1,"ghs-challenge-card",31),t.nVh(2,Lj,2,0,"a",26),t.nVh(3,Uj,1,0,"div",27),t.k0s()),2&i){const e=r.$implicit,a=t.XpG();t.R7$(),t.Y8G("challenge",e)("flipped",!0),t.R7$(),t.vxM(a.edit?2:-1),t.R7$(),t.vxM(a.edit?3:-1)}}function Hj(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",12),t.nrm(1,"ghs-challenge-card",31),t.j41(2,"a",32),t.bIt("click",function(){const n=t.eBV(e).$index,o=t.XpG(2);return t.Njj(o.restoreCard(n))}),t.nrm(3,"img",33),t.k0s()()}if(2&i){const e=r.$implicit;t.R7$(),t.Y8G("challenge",e)("flipped",!0)}}function Kj(i,r){if(1&i&&(t.j41(0,"div",16),t.nrm(1,"div",10),t.Z7z(2,Hj,4,2,"div",12,Ri),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","challenges.deck.removed"),t.R7$(),t.Dyx(e.removedCards)}}let Hs=(()=>{class i{data;dialogRef;menuElement;gameManager=s.E;settingsManager=m.f;GameState=T.mk;reveal=0;edit=!1;apply=!0;maxHeight="";deck;before;after;current=-1;drawing=!1;disabled=!1;drawDisabled=!1;drawAvailable=0;keepAvailable=0;upcomingCards=[];discardedCards=[];finishedCards=[];removedCards=[];constructor(e,a){this.data=e,this.dialogRef=a,this.deck=e.deck,this.before=e.before,this.after=e.after}ngOnInit(){setTimeout(()=>{this.maxHeight="calc(80vh - "+this.menuElement.nativeElement.offsetHeight+"px)"},m.f.settings.animations?250*m.f.settings.animationSpeed:0),this.update(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.update()}),this.edit=!s.E.game.scenario}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.upcomingCards=this.deck.cards.filter((a,n)=>n>this.deck.current),this.discardedCards=this.deck.cards.filter((a,n)=>n<=this.deck.current&&n>this.deck.finished).reverse(),this.finishedCards=this.deck.cards.filter((a,n)=>n<=this.deck.finished).reverse(),this.removedCards=s.E.challengesData(s.E.game.edition).filter(a=>null==this.deck.cards.find(n=>n.cardId==a.cardId));const e=s.E.game.party.buildings.find(a=>"town-hall"==a.name&&a.level&&"wrecked"!=a.state);e&&(this.drawAvailable=e.level,this.keepAvailable=Math.ceil(e.level/2)),this.disabled=!s.E.roundManager.firstRound||s.E.game.state==T.mk.next||!s.E.game.scenario||!this.deck.cards.length,this.drawDisabled=this.disabled||this.deck.current-this.deck.finished>=this.drawAvailable}toggleEdit(){this.edit=!this.edit,setTimeout(()=>{this.maxHeight="calc(80vh - "+this.menuElement.nativeElement.offsetHeight+"px)"},0)}shuffle(e=!1){this.before.emit(new It(this.deck,"challengeDeck.shuffle"+(e?"Upcoming":""))),s.E.challengesManager.shuffleDeck(this.deck,e),this.after.emit(new It(this.deck,"challengeDeck.shuffle"+(e?"Upcoming":""))),this.update()}clear(e=!0){this.before.emit(new It(this.deck,"challengeDeck.clear")),s.E.challengesManager.clearDrawn(this.deck,e),this.after.emit(new It(this.deck,"challengeDeck.clear")),this.update()}drawCard(){!this.disabled&&this.deck.cards.length>0&&(this.before.emit(new It(this.deck,"challengeDeck.draw")),s.E.challengesManager.drawCard(this.deck),this.after.emit(new It(this.deck,"challengeDeck.draw")))}dropUpcoming(e){this.before.emit(new It(this.deck,"challengeDeck.reorder"));let a=0,n=0,o=0;e.container==e.previousContainer?(a=this.deck.current+1,n=e.previousIndex+a,o=e.currentIndex+a,(0,D.HD)(this.deck.cards,n,o)):"listFinished"==e.previousContainer.id?(a=this.deck.finished,n=a-e.previousIndex,o=e.currentIndex+this.deck.current,this.deck.finished=this.deck.finished-1,this.deck.current=this.deck.current-1,(0,D.HD)(this.deck.cards,n,o)):(a=this.deck.current,n=a-e.previousIndex,o=e.currentIndex+a,this.deck.current=this.deck.current-1,(0,D.HD)(this.deck.cards,n,o)),this.after.emit(new It(this.deck,"challengeDeck.reorder")),this.update()}dropDiscarded(e){this.before.emit(new It(this.deck,"challengeDeck.reorder"));let a=0,n=0,o=0;e.container==e.previousContainer?(a=this.deck.current,n=a-e.previousIndex,o=a-e.currentIndex,(0,D.HD)(this.deck.cards,n,o)):"listFinished"==e.previousContainer.id?(a=this.deck.finished,n=a-e.previousIndex,this.deck.finished=this.deck.finished-1,o=this.deck.current-e.currentIndex,(0,D.HD)(this.deck.cards,n,o)):(this.deck.current=this.deck.current+1,a=this.deck.current,n=a+e.previousIndex,o=a-e.currentIndex,(0,D.HD)(this.deck.cards,n,o)),this.after.emit(new It(this.deck,"challengeDeck.reorder")),this.update()}dropFinished(e){this.before.emit(new It(this.deck,"challengeDeck.reorder"));let a=0,n=0,o=0;e.container==e.previousContainer?(a=this.deck.finished,n=a-e.previousIndex,o=a-e.currentIndex,(0,D.HD)(this.deck.cards,n,o)):"listDiscarded"==e.previousContainer.id?(this.deck.finished=this.deck.finished+1,a=this.deck.finished,n=this.deck.current-e.previousIndex,o=a-e.currentIndex,(0,D.HD)(this.deck.cards,n,o)):(this.deck.finished=this.deck.finished+1,this.deck.current=this.deck.current+1,a=this.deck.finished,n=this.deck.current+e.previousIndex,o=a-e.currentIndex,(0,D.HD)(this.deck.cards,n,o)),this.after.emit(new It(this.deck,"challengeDeck.reorder")),this.update()}toggleKeep(e,a=!1){e<=this.deck.current&&(a||!this.edit&&s.E.game.scenario&&s.E.roundManager.firstRound&&s.E.game.state==T.mk.draw)&&(this.before.emit(new It(this.deck,"challengeDeck.toggle",e)),s.E.challengesManager.toggleKeep(this.deck,e,this.keepAvailable),this.after.emit(new It(this.deck,"challengeDeck.toggle",e)))}remove(e){this.before.emit(new It(this.deck,"challengeDeck.removeCard",e)),e<=this.deck.current&&(this.deck.current--,this.current=this.deck.current),this.deck.cards.splice(e,1),this.after.emit(new It(this.deck,"challengeDeck.removeCard",e)),this.update()}restoreCard(e){const a=this.removedCards[e];a&&(this.before.emit(new It(this.deck,"challengeDeck.restoreCard",a.cardId)),e=Math.floor(Math.random()*(this.deck.cards.length-this.deck.current))+this.deck.current+1,this.deck.cards.splice(e,0,a),this.after.emit(new It(this.deck,"challengeDeck.restoreCard")),this.update())}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-challenges-dialog"]],viewQuery:function(a,n){if(1&a&&t.GBs(xj,5),2&a){let o;t.mGM(o=t.lsd())&&(n.menuElement=o.first)}},standalone:!1,decls:26,vars:41,consts:[["menu",""],["upcomingList","cdkDropList"],["discardedList","cdkDropList"],["finishedList","cdkDropList"],[1,"challenge-deck-dialog"],[1,"scroll-container"],[1,"menu"],[1,"hint"],[1,"challenge-deck-container",3,"ngClass"],["cdkDropList","","id","listUpcomping",1,"upcoming","drop-list",3,"cdkDropListDropped","cdkDropListDisabled","cdkDropListConnectedTo","cdkDropListAutoScrollStep","ngClass"],[1,"title",3,"ghs-label"],[1,"empty"],["cdkDrag","",1,"challenge-container"],["cdkDropList","","id","listDiscarded",1,"discarded","drop-list",3,"cdkDropListDropped","cdkDropListDisabled","cdkDropListConnectedTo","cdkDropListAutoScrollStep","ngClass"],["cdkDrag","",1,"challenge-container",3,"ngClass"],["cdkDropList","","id","listFinished",1,"finished","drop-list",3,"cdkDropListDropped","cdkDropListDisabled","cdkDropListConnectedTo","cdkDropListAutoScrollStep","ngClass"],[1,"removed","edit"],[3,"ngClass"],["ghs-pointer-input","",3,"ghs-tooltip","overlayX"],["ghs-pointer-input","",3,"singleClick","doubleClick","ngClass"],[3,"ghs-label"],[3,"click"],[3,"click","ngClass"],["ghs-pointer-input","",3,"singleClick","doubleClick","ghs-tooltip","overlayX"],["type","checkbox",3,"click","checked"],[1,"drag-hidden",3,"challenge","reveal","flipped"],[1,"button-remove"],["cdkDragHandle","",1,"drag-handle"],[1,"button-remove",3,"click"],["src","./assets/images/minus.svg",1,"ghs-svg"],["ghs-pointer-input","",1,"drag-hidden",3,"singleClick","doubleClick","challenge","keep","flipped"],[1,"drag-hidden",3,"challenge","flipped"],[1,"button-restore",3,"click"],["src","./assets/images/plus.svg",1,"ghs-svg"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",4)(1,"div",5)(2,"div",6,0),t.nVh(4,Sj,6,8),t.k0s(),t.nVh(5,Aj,4,3,"div",7),t.j41(6,"div",8)(7,"div",9,1),t.bIt("cdkDropListDropped",function(_){return t.eBV(o),t.Njj(n.dropUpcoming(_))}),t.nrm(9,"div",10),t.nVh(10,Vj,1,0,"div",11),t.Z7z(11,Bj,4,5,"div",12,Ri),t.k0s(),t.j41(13,"div",13,2),t.bIt("cdkDropListDropped",function(_){return t.eBV(o),t.Njj(n.dropDiscarded(_))}),t.nrm(15,"div",10)(16,"div",11),t.Z7z(17,zj,4,9,"div",14,Ri),t.k0s(),t.j41(19,"div",15,3),t.bIt("cdkDropListDropped",function(_){return t.eBV(o),t.Njj(n.dropFinished(_))}),t.nrm(21,"div",10)(22,"div",11),t.Z7z(23,qj,4,4,"div",12,Ri),t.k0s(),t.nVh(25,Kj,4,1,"div",16),t.k0s()()()}if(2&a){const o=t.sdS(8),g=t.sdS(14),_=t.sdS(20);t.R7$(4),t.vxM(n.deck.cards.length>0?4:-1),t.R7$(),t.vxM(!n.edit&&n.gameManager.game.scenario?5:-1),t.R7$(),t.xc7("max-height",n.maxHeight),t.Y8G("ngClass",t.sMw(22,Ej,"fh"==n.settingsManager.settings.theme,"modern"==n.settingsManager.settings.theme,n.removedCards.length)),t.R7$(),t.Y8G("cdkDropListDisabled",!n.edit)("cdkDropListConnectedTo",t.l_i(26,ja,g,_))("cdkDropListAutoScrollStep",20)("ngClass",t.eq3(29,Ga,n.edit)),t.R7$(2),t.Y8G("ghs-label","challenges.deck.upcoming"),t.R7$(),t.vxM(0==n.upcomingCards.length?10:-1),t.R7$(),t.Dyx(n.upcomingCards),t.R7$(2),t.Y8G("cdkDropListDisabled",!n.edit)("cdkDropListConnectedTo",t.l_i(31,ja,o,_))("cdkDropListAutoScrollStep",20)("ngClass",t.eq3(34,Ga,n.edit)),t.R7$(2),t.Y8G("ghs-label","challenges.deck.current"),t.R7$(2),t.Dyx(n.discardedCards),t.R7$(2),t.Y8G("cdkDropListDisabled",!n.edit)("cdkDropListConnectedTo",t.l_i(36,ja,o,g))("cdkDropListAutoScrollStep",20)("ngClass",t.eq3(39,Ga,n.edit)),t.R7$(2),t.Y8G("ghs-label","challenges.deck.finished"),t.R7$(2),t.Dyx(n.finishedCards),t.R7$(2),t.vxM(n.edit&&n.removedCards.length?25:-1)}},dependencies:[N.YU,D.O7,D.T1,D.Fb,Ci,tt,ft,rt],styles:['.challenge-deck-dialog[_ngcontent-%COMP%]{position:relative}.challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;flex-wrap:wrap;max-width:calc(var(--ghs-unit) * 90 * var(--ghs-dialog-factor))}.challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-darkgray)}.challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{cursor:pointer;appearance:none;background-color:var(--form-background);width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));border-width:calc(var(--ghs-unit) * .3);border-style:solid;display:grid;place-content:center;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before{left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));position:relative;content:" ";width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));transform:scale(0);transform-origin:bottom left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;clip-path:polygon(14% 44%,0 65%,50% 100%,100% 16%,80% 0%,43% 62%);color:var(--ghs-color-gray);background-color:var(--ghs-color-gray)}.challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked:before{transform:scale(1)}.challenge-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover:before{background-color:var(--ghs-color-white)}.challenge-deck-dialog[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.challenge-deck-dialog[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1em;width:auto;margin:0 .3em;filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.challenge-deck-dialog[_ngcontent-%COMP%]   .drop-list[_ngcontent-%COMP%]{position:relative}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]{display:flex;width:calc(var(--ghs-unit) * 90 * var(--ghs-dialog-factor));overflow:auto}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container.has-removed[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 120 * var(--ghs-dialog-factor))}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;overflow-y:auto;overflow-x:hidden;width:calc(var(--ghs-unit) * 30 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);display:none;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 30 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);z-index:2}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.edit[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.edit[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.edit[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.edit[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.upcoming[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.finished[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.removed[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.upcoming[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.finished[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.removed[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.upcoming[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.finished[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.removed[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.upcoming[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.finished[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.removed[_ngcontent-%COMP%]{display:none}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.upcoming.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.finished.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.removed.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.upcoming.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.finished.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.removed.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.upcoming.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.finished.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.removed.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.upcoming.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.finished.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.removed.edit[_ngcontent-%COMP%]{display:flex}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.discarded[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.discarded[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.discarded[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.discarded[_ngcontent-%COMP%]{flex-direction:row;flex-wrap:wrap;width:calc(var(--ghs-unit) * 90 * var(--ghs-dialog-factor));min-height:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor))}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.discarded.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.discarded.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.discarded.edit[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.discarded.edit[_ngcontent-%COMP%]{flex-direction:column;flex-wrap:initial;width:calc(var(--ghs-unit) * 30 * var(--ghs-dialog-factor))}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.discarded.edit[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.discarded.edit[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.discarded.edit[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.discarded.edit[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 4.2 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{position:relative;display:flex;transition:none;width:calc(var(--ghs-unit) * 25.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 38.25 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));flex-shrink:0;flex-grow:0;border:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) solid transparent;border-radius:5%}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%]   ghs-challenge-card[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   ghs-challenge-card[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%]   ghs-challenge-card[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   ghs-challenge-card[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%]   ghs-challenge-card[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   ghs-challenge-card[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%]   ghs-challenge-card[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   ghs-challenge-card[_ngcontent-%COMP%]{position:absolute;display:flex;top:0;left:0;width:100%;height:100%}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .challenge-container.keep[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty.keep[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .challenge-container.keep[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .empty.keep[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .challenge-container.keep[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .empty.keep[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .challenge-container.keep[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .empty.keep[_ngcontent-%COMP%]{border-color:var(--ghs-color-blue)}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 4.2 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));display:block;border-style:dashed;border-width:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor));border-color:var(--ghs-color-white);width:calc(var(--ghs-unit) * 24 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 37 * var(--ghs-dialog-factor));border-radius:5%}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]{z-index:1;position:absolute;display:flex;cursor:pointer;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-filter-white) var(--ghs-filter-shadow)}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:100%;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-remove.button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-restore.button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-remove.button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-restore.button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .button-remove.button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .button-restore.button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .button-remove.button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .button-restore.button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-shadow)}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-remove.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-restore.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-remove.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-restore.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .button-remove.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .button-restore.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .button-remove.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .button-restore.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-green) var(--ghs-filter-shadow)}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.discarded[_ngcontent-%COMP%]   .challenge-container.active[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.discarded[_ngcontent-%COMP%]   .challenge-container.active[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.discarded[_ngcontent-%COMP%]   .challenge-container.active[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.discarded[_ngcontent-%COMP%]   .challenge-container.active[_ngcontent-%COMP%]{cursor:pointer}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming.finished[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded.finished[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished.finished[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed.finished[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%]{filter:grayscale(.9)}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{position:absolute;cursor:grab;left:50%;top:65%;width:60%;height:70%;transform:translate(-50%,-50%)}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container.fh[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container.fh[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container.fh[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container.fh[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container.modern[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container.modern[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container.modern[_ngcontent-%COMP%]   .finished[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .challenge-deck-dialog[_ngcontent-%COMP%]   .challenge-deck-container.modern[_ngcontent-%COMP%]   .removed[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.cdk-drag-preview[_ngcontent-%COMP%]{opacity:0;cursor:grabbing;z-index:999}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.5;cursor:grabbing}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}']})}return i})();const Wj=i=>({vertical:i});let Ks=(()=>{class i{data;dialogRef;deck;before;after;constructor(e,a){this.data=e,this.dialogRef=a,this.deck=e.deck,this.before=e.before,this.after=e.after}vertical(){return window.innerWidth<800}beforeChallengeDeck(e){this.before.emit(e)}afterChallengeDeck(e){this.after.emit(e)}close(){(0,V.co)(this.dialogRef)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-challenge-deck-fullscreen"]],standalone:!1,decls:4,vars:6,consts:[[1,"challenge-deck-fullscreen",3,"ngClass"],[3,"before","after","deck","fullscreen","vertical"],[1,"close-container",3,"click"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"ghs-challenge-deck",1),t.bIt("before",function(g){return n.beforeChallengeDeck(g)})("after",function(g){return n.afterChallengeDeck(g)}),t.k0s(),t.j41(2,"div",2),t.bIt("click",function(){return n.close()}),t.k0s()(),t.j41(3,"div",2),t.bIt("click",function(){return n.close()}),t.k0s()),2&a&&(t.Y8G("ngClass",t.eq3(4,Wj,n.vertical())),t.R7$(),t.Y8G("deck",n.deck)("fullscreen",!1)("vertical",n.vertical()))},styles:[".challenge-deck-fullscreen[_ngcontent-%COMP%]{width:100vw;height:100vh;overflow-x:auto;overflow-y:auto;display:flex;flex-direction:column;justify-content:flex-start;align-items:center;z-index:3}.challenge-deck-fullscreen[_ngcontent-%COMP%]   ghs-challenge-deck[_ngcontent-%COMP%]{display:flex;width:99vw;max-width:600px;height:100vw;max-height:420px;z-index:4;margin-top:2em;margin-left:1%}.challenge-deck-fullscreen.vertical[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden}.challenge-deck-fullscreen.vertical[_ngcontent-%COMP%]   ghs-challenge-deck[_ngcontent-%COMP%]{width:98vw;margin-right:1%;height:132vw;max-height:800px;transform:none}.challenge-deck-fullscreen[_ngcontent-%COMP%]   .close-container[_ngcontent-%COMP%]{cursor:zoom-out;position:absolute;display:flex;width:100%;height:100%;z-index:2;top:0;left:0}"]})}return i})();const Jj=(i,r,e)=>({disabled:i,vertical:r,denied:e}),Zj=i=>({disabled:i}),Qj=(i,r)=>({vertical:i,minimize:r}),t5=(i,r,e)=>({vertical:i,"without-fullscreen":r,minimize:e}),e5=(i,r,e,a)=>({discarded:i,current:r,bottom:e,unkept:a}),n5=(i,r)=>r.cardId+"-"+i;function i5(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",7),t.bIt("click",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.openFullscreen(n))}),t.nrm(1,"img",8),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ghs-label","game.cards.fullscreen")("ghs-label-attribute","title")("ngClass",t.l_i(3,Qj,e.vertical,!e.deck.active))}}function a5(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",9),t.bIt("click",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.open(n))}),t.nrm(1,"img",10),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ghs-label","game.cards.openDialog")("ghs-label-attribute","title")("ngClass",t.sMw(3,t5,e.vertical,!e.fullscreen,!e.deck.active))}}function o5(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",12),t.bIt("singleClick",function(n){t.eBV(e);const o=t.XpG().$index,g=t.XpG();return t.Njj(g.clickCard(o,n))})("doubleClick",function(n){t.eBV(e);const o=t.XpG().$index,g=t.XpG();return t.Njj(g.doubleClickCard(o,n))}),t.nrm(1,"ghs-challenge-card",13),t.k0s()}if(2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG();t.xc7("z-index",n>o.current?o.deck.cards.length-n:o.deck.cards.length+n+1+(-1!=o.deck.keep.indexOf(n)?5:0))("right",n<o.current?55+25*(o.current-n-1)+"%":""),t.Y8G("ngClass",t.ziG(9,e5,n<o.current,n==o.current,o.bottom,-1==o.deck.keep.indexOf(n))),t.R7$(),t.Y8G("challenge",a)("keep",-1!=o.deck.keep.indexOf(n))("flipped",n<=o.current)("disableFlip",!o.drawing||n!=o.current)}}function s5(i,r){if(1&i&&t.nVh(0,o5,2,14,"div",11),2&i){const e=r.$index,a=t.XpG();t.vxM(e>a.current-3&&e>a.deck.finished?0:-1)}}class It{deck;type;values;constructor(r,e,...a){this.deck=r,this.type=e,this.values=a}}let Ws=(()=>{class i{element;dialog;deck;bottom=!1;fullscreen=!0;vertical=!1;before=new t.bkB;after=new t.bkB;initTimeout=1500;gameManager=s.E;settingsManager=m.f;current=-1;internalDraw=-99;GameState=T.mk;drawing=!1;drawTimeout=null;queue=0;queueTimeout=null;compact=!1;disabled=!1;drawDisabled=!1;init=!1;initServer=!1;drawAvailable=0;keepAvailable=0;constructor(e,a){this.element=e,this.dialog=a,this.element.nativeElement.addEventListener("pointerdown",n=>{let o=document.elementsFromPoint(n.clientX,n.clientY);o[0].classList.contains("deck")&&o.length>2&&o[2].click()})}ngOnInit(){this.current=this.deck.current,this.internalDraw=-99,this.compact=this.deck.cards.length>0&&m.f.settings.automaticAttackModifierFullscreen&&m.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400);const e=s.E.game.party.buildings.find(a=>"town-hall"==a.name&&a.level&&"wrecked"!=a.state);e&&(this.drawAvailable=e.level,this.keepAvailable=Math.ceil(e.level/2)),this.disabled=!s.E.roundManager.firstRound||s.E.game.state==T.mk.next||!s.E.game.scenario||!this.deck.cards.length,this.drawDisabled=this.disabled||this.deck.current-this.deck.finished>=this.drawAvailable,this.init||(this.drawTimeout=setTimeout(()=>{this.current=this.deck.current,this.drawTimeout=null,this.init=!0},m.f.settings.animations?this.initTimeout*m.f.settings.animationSpeed:0)),this.uiChangeSubscription=s.E.uiChange.subscribe({next:a=>{this.update(a)}}),window.addEventListener("resize",a=>{this.compact=this.deck.cards.length>0&&m.f.settings.automaticAttackModifierFullscreen&&m.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)}),window.addEventListener("fullscreenchange",a=>{this.compact=this.deck.cards.length>0&&m.f.settings.automaticAttackModifierFullscreen&&m.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}ngOnChanges(e){e.deck&&this.update()}update(e=!1){const a=s.E.game.party.buildings.find(n=>"town-hall"==n.name&&n.level&&"wrecked"!=n.state);a&&(this.drawAvailable=a.level,this.keepAvailable=Math.ceil(a.level/2)),this.disabled=!s.E.roundManager.firstRound||s.E.game.state==T.mk.next||!s.E.game.scenario||!this.deck.cards.length,this.drawDisabled=this.disabled||this.deck.current-this.deck.finished>=this.drawAvailable,this.initServer&&s.E.stateManager.wsState()!=WebSocket.OPEN&&(this.initServer=!1),this.deck.active?!this.init||e&&!this.initServer?(this.current=this.deck.current,e&&!this.initServer&&(this.initServer=!0)):this.current<this.deck.current?(this.queue=Math.max(0,this.deck.current-this.current),this.queueTimeout||(this.queue--,this.current++,this.drawQueue(e))):(!this.queueTimeout||this.deck.current<this.current+this.queue)&&(this.queueTimeout&&(clearTimeout(this.queueTimeout),this.queueTimeout=null),this.queue=0,this.drawing=!1,this.current=this.deck.current):(this.queueTimeout&&(clearTimeout(this.queueTimeout),this.queueTimeout=null),this.queue=0,this.drawing=!1,this.current=this.deck.current,this.initServer=s.E.stateManager.wsState()==WebSocket.OPEN),this.compact=m.f.settings.automaticAttackModifierFullscreen&&m.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)}drawQueue(e){this.drawing=!0,this.element.nativeElement.getElementsByClassName("deck")[0].classList.add("drawing"),this.queueTimeout=setTimeout(()=>{this.drawing=!1,this.queueTimeout=null,this.queue>0?(this.queue--,this.current++,this.drawQueue(e)):(this.element.nativeElement.getElementsByClassName("deck")[0].classList.remove("drawing"),this.queue<0&&(this.queue=0))},m.f.settings.animations?1050*m.f.settings.animationSpeed:0)}draw(e){this.compact&&this.fullscreen?this.openFullscreen(e):!this.drawDisabled&&this.deck.cards.length>0?!this.drawTimeout&&this.deck.current<this.deck.cards.length-(0==this.queue?0:1)&&(this.drawTimeout=setTimeout(()=>{this.before.emit(new It(this.deck,"challengeDeck.draw")),s.E.challengesManager.drawCard(this.deck),this.after.emit(new It(this.deck,"challengeDeck.draw")),this.drawTimeout=null},m.f.settings.animations?150*m.f.settings.animationSpeed:0)):this.dialog.open(Hs,{panelClass:["dialog"],data:{deck:this.deck,before:this.before,after:this.after}})}openFullscreen(e){this.fullscreen&&(this.dialog.open(Ks,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:{deck:this.deck,before:this.before,after:this.after}}),e.preventDefault(),e.stopPropagation())}clickCard(e,a){this.disabled?this.open(a):e<=this.current&&(this.before.emit(new It(this.deck,"challengeDeck.toggle",e)),s.E.challengesManager.toggleKeep(this.deck,e,this.keepAvailable),this.after.emit(new It(this.deck,"challengeDeck.toggle",e)))}doubleClickCard(e,a){(!this.drawing||e>this.current)&&this.open(a)}open(e){this.deck.cards.length>0&&this.fullscreen&&m.f.settings.automaticAttackModifierFullscreen&&m.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)?this.openFullscreen(e):this.dialog.open(Hs,{panelClass:["dialog"],data:{deck:this.deck,before:this.before,after:this.after}}),e.preventDefault(),e.stopPropagation()}static \u0275fac=function(a){return new(a||i)(t.rXU(t.aKT),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-challenge-deck"]],inputs:{deck:"deck",bottom:"bottom",fullscreen:"fullscreen",vertical:"vertical",initTimeout:"initTimeout"},outputs:{before:"before",after:"after"},standalone:!1,features:[t.OA$],decls:10,vars:15,consts:[["card",""],[1,"deck",3,"ngClass"],[1,"challenge-container","draw"],[1,"challenge-card",3,"click","ngClass"],[1,"number"],[1,"fullscreen",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"settings",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"fullscreen",3,"click","ghs-label","ghs-label-attribute","ngClass"],["src","./assets/images/fullscreen.svg"],[1,"settings",3,"click","ghs-label","ghs-label-attribute","ngClass"],["src","./assets/images/settings.svg",1,"ghs-svg"],["ghs-pointer-input","",1,"challenge-container",3,"z-index","ngClass","right"],["ghs-pointer-input","",1,"challenge-container",3,"singleClick","doubleClick","ngClass"],[1,"challenge-card",3,"challenge","keep","flipped","disableFlip"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3,0),t.bIt("click",function(_){return t.eBV(o),t.Njj(n.draw(_))}),t.j41(4,"span",4),t.EFF(5),t.k0s()(),t.nVh(6,i5,2,6,"span",5),t.nVh(7,a5,2,7,"span",6),t.k0s(),t.Z7z(8,s5,1,1,null,null,n5),t.k0s()}if(2&a){const o=t.sdS(3);t.Y8G("ngClass",t.sMw(9,Jj,n.disabled,n.vertical,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.scenario)),t.R7$(),t.xc7("z-index",n.deck.cards.length+1),t.R7$(),t.xc7("font-size",.08*o.offsetWidth+"px"),t.Y8G("ngClass",t.eq3(13,Zj,n.drawDisabled)),t.R7$(3),t.JRh(n.deck.current<n.deck.cards.length-1?n.deck.cards.length-n.deck.current-1+"/"+n.deck.cards.length:0),t.R7$(),t.vxM(n.fullscreen&&!n.compact?6:-1),t.R7$(),t.vxM(!n.compact||n.vertical?7:-1),t.R7$(),t.Dyx(n.deck.cards)}},dependencies:[N.YU,Ci,tt,rt],styles:[".deck[_ngcontent-%COMP%]{position:relative;width:100%;height:100%}.deck[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%]{position:absolute;width:30%;padding-top:45%;bottom:0;right:0}.deck[_ngcontent-%COMP%]   .challenge-card[_ngcontent-%COMP%]{position:absolute;inset:0;cursor:pointer;display:block;transition:filter calc(var(--ghs-animation-speed) * 1s) ease-in-out}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .challenge-card[_ngcontent-%COMP%]{cursor:pointer;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(challenge-back.73584a0c39f15db5.png);border-radius:5%;transition:filter calc(var(--ghs-animation-speed) * 1s) ease-in-out}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .challenge-card[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);position:absolute;font-size:2em;line-height:1em;left:5%;bottom:0%;z-index:500}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .challenge-card.disabled[_ngcontent-%COMP%]{cursor:initial;filter:grayscale(.7)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .challenge-card.disabled[_ngcontent-%COMP%]:hover{transition:filter calc(var(--ghs-animation-speed) * .25s) linear,transform calc(var(--ghs-animation-speed) * .8s) cubic-bezier(.75,0,.85,1),top calc(var(--ghs-animation-speed) * .5s) linear,left calc(var(--ghs-animation-speed) * .5s) linear;filter:grayscale(15%)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]{cursor:pointer;right:-14%;font-family:var(--ghs-font-gh-title);display:flex;justify-content:center;position:absolute;color:var(--ghs-color-white);width:22%;height:15%;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-character-icon.83c1ab396221d56b.png);transition:transform calc(var(--ghs-animation-speed) * .5s) ease-in-out;transform:scale(1.1)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.minimize[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.minimize[_ngcontent-%COMP%]{transform:scale(0)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.fullscreen[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.fullscreen[_ngcontent-%COMP%]{cursor:zoom-in;bottom:32.5%}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.settings[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.settings[_ngcontent-%COMP%]{cursor:help;bottom:-4%}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.settings.without-fullscreen[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.settings.without-fullscreen[_ngcontent-%COMP%]{top:50%;bottom:initial;transform:translateY(-50%)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:60%;width:auto;align-self:center;filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}@keyframes _ngcontent-%COMP%_challenge-draw{0%{transform:scale(1) translate(102%,16.5%)}35%,70%{transform:scale(1.1) translate(51%,25%)}to{transform:scale(1) translate(0)}}@keyframes _ngcontent-%COMP%_challenge-draw-bottom{0%{transform:scale(1) translate(102%,-16.5%)}35%,70%{transform:scale(1.6) translate(110%,-90%)}to{transform:scale(1) translate(0)}}@keyframes _ngcontent-%COMP%_challenge-last{0%{right:42%;transform:rotate(0)}70%{right:42%;transform:rotate(0)}to{right:75%;transform:rotate(-5deg)}}.deck[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{position:absolute;bottom:0;right:31.5%;z-index:1}.deck[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]{position:absolute;bottom:0;right:55%;transform:rotate(-5deg);z-index:0}.deck[_ngcontent-%COMP%]   .discarded.last[_ngcontent-%COMP%]:hover{z-index:100!important}.deck.drawing[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]{cursor:wait!important}.deck.drawing[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{cursor:wait!important;animation:_ngcontent-%COMP%_challenge-draw calc(var(--ghs-animation-speed) * 1s) ease-in-out;animation-iteration-count:1}.deck.drawing[_ngcontent-%COMP%]   .current.bottom[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_challenge-draw-bottom calc(var(--ghs-animation-speed) * 1s) ease-in-out}.deck.drawing[_ngcontent-%COMP%]   .last[_ngcontent-%COMP%]{cursor:wait!important;animation:_ngcontent-%COMP%_challenge-last calc(var(--ghs-animation-speed) * 1s) ease-in-out;animation-iteration-count:1}.deck[_ngcontent-%COMP%]   .unkept[_ngcontent-%COMP%]{filter:grayscale(.9)}.vertical[_ngcontent-%COMP%]   .challenge-container[_ngcontent-%COMP%]{top:0;bottom:initial;left:0}.vertical[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{top:0;bottom:initial;position:absolute;transform:translateY(110%);z-index:1}.vertical[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%], .vertical[_ngcontent-%COMP%]   .last[_ngcontent-%COMP%]{position:absolute;top:0;bottom:initial;left:30%;transform:translateY(118%) rotate(5deg);z-index:0}@keyframes _ngcontent-%COMP%_challenge-draw-vertical{0%{transform:scale(1)}35%,70%{transform:scale(1.1) translate(15%,125%)}to{transform:scale(1) translateY(110%)}}@keyframes _ngcontent-%COMP%_challenge-last-vertical{0%{left:0;transform:translateY(110%) rotate(0)}70%{left:0;transform:translateY(110%) rotate(0)}to{left:30%;transform:translateY(118%) rotate(5deg)}}.vertical.drawing[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_challenge-draw-vertical calc(var(--ghs-animation-speed) * 1s) ease-in-out}.vertical.drawing[_ngcontent-%COMP%]   .last[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_challenge-last-vertical calc(var(--ghs-animation-speed) * 1s) ease-in-out}"]})}return i})();const r5=["menu"],Js=i=>[i],Zs=i=>({disabled:i}),c5=()=>[],Ta=(i,r)=>r.cardId;function l5(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",16),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return n.configuration=!n.configuration,t.Njj(n.enhancements=!1)}),t.nrm(1,"img",17)(2,"span",8),t.k0s()}if(2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","game.loot.config."+(e.configuration?"hide":"show"))}}function g5(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",12),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.reveal=(n.reveal+1)%3)}),t.nrm(1,"span",8),t.k0s(),t.j41(2,"a",13),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.shuffle())})("doubleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.shuffle(!0))}),t.nrm(3,"span",8),t.k0s(),t.j41(4,"label")(5,"input",14),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleEdit())}),t.k0s(),t.nrm(6,"span",8),t.k0s(),t.nVh(7,l5,3,1,"a",15)}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label",2==e.reveal?"game.cards.coverAll":0==e.reveal?"game.cards.revealAll":"game.cards.revealAllConfirm"),t.R7$(),t.Y8G("ghs-tooltip","game.cards.shuffle.upcomingHint")("overlayX","center"),t.R7$(),t.Y8G("ghs-label","game.cards.shuffle"),t.R7$(2),t.Y8G("checked",e.edit),t.R7$(),t.Y8G("ghs-label","game.cards.edit"),t.R7$(),t.vxM(e.edit?7:-1)}}function d5(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",14),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleSpecial(n.LootType.special1))}),t.k0s(),t.nrm(2,"span",18),t.k0s(),t.j41(3,"label")(4,"input",14),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleSpecial(n.LootType.special2))}),t.k0s(),t.nrm(5,"span",18),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("checked",-1!=e.gameManager.game.lootDeckFixed.indexOf(e.LootType.special1)),t.R7$(),t.Y8G("ghs-label","game.loot.toggleSpecial")("ghs-label-args",t.eq3(6,Js,e.LootType.special1)),t.R7$(2),t.Y8G("checked",-1!=e.gameManager.game.lootDeckFixed.indexOf(e.LootType.special2)),t.R7$(),t.Y8G("ghs-label","game.loot.toggleSpecial")("ghs-label-args",t.eq3(8,Js,e.LootType.special2))}}function h5(i,r){if(1&i){const e=t.RV6();t.j41(0,"label"),t.nrm(1,"img",7)(2,"span",8),t.k0s(),t.j41(3,"a",22),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.changeType(n,-1))}),t.nrm(4,"img",23),t.k0s(),t.j41(5,"span",24),t.EFF(6),t.k0s(),t.j41(7,"a",22),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.changeType(n,1))}),t.nrm(8,"img",25),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+(e==a.LootType.special1||e==a.LootType.special2?a.LootType.money:e)+".svg",t.B4B),t.R7$(),t.Y8G("ghs-label","game.loot."+e),t.R7$(),t.Y8G("ngClass",t.eq3(7,Zs,!a.lootDeckConfig[e]||e==a.LootType.random_item&&a.gameManager.lootManager.randomItemLooted())),t.R7$(2),t.Y8G("ghs-label","game.loot."+e)("ghs-label-attribute","title"),t.R7$(),t.SpI(" ",a.lootDeckConfig[e]&&"x"+a.lootDeckConfig[e]||"-"," "),t.R7$(),t.Y8G("ngClass",t.eq3(9,Zs,a.lootDeckConfig[e]==a.maxValue(e)||e==a.LootType.random_item&&a.gameManager.lootManager.randomItemLooted()))}}function _5(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",12),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.currentConfig())}),t.nrm(1,"span",8),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","game.loot.config.discard"))}function m5(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",9)(1,"label",19),t.nrm(2,"span",8),t.k0s(),t.j41(3,"div",20),t.Z7z(4,h5,9,11,null,null,t.fX1),t.k0s(),t.j41(6,"div",21),t.nVh(7,_5,2,1,"a"),t.j41(8,"a",12),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.applyConfig())}),t.nrm(9,"span",8),t.k0s()()()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","game.loot.config"),t.R7$(2),t.Dyx(e.types),t.R7$(3),t.vxM(e.deck.cards.length>0?7:-1),t.R7$(2),t.Y8G("ghs-label","game.loot.config."+(0==e.deck.cards.length?"create":"apply"))}}function p5(i,r){if(1&i){const e=t.RV6();t.j41(0,"img",32),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2).$implicit,o=t.XpG(2);return t.Njj(o.unenhanceCard(n))}),t.k0s()}2&i&&t.Y8G("ghs-label","game.loot.enhancements.remove")("ghs-label-attribute","title")}function u5(i,r){if(1&i&&(t.j41(0,"div",30),t.Z7z(1,p5,1,2,"img",31,t.fX1),t.nI1(3,"ghsRange"),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.Dyx(t.i5U(3,0,t.lJ4(3,c5),e.enhancements))}}function f5(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",26),t.nrm(1,"ghs-loot",27),t.j41(2,"a",28),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.enhanceCard(n))}),t.nrm(3,"img",29),t.k0s(),t.nVh(4,u5,4,4,"div",30),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(),t.Y8G("loot",e)("flipped",!0)("highlight",!1)("apply",a.apply),t.R7$(),t.Y8G("ghs-label","game.loot.enhancements.add")("ghs-label-attribute","title"),t.R7$(2),t.vxM(e.enhancements>0?4:-1)}}function C5(i,r){if(1&i&&(t.j41(0,"div",10),t.Z7z(1,f5,5,7,"div",26,Ta),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.enhancementDeck)}}function M5(i,r){1&i&&t.nrm(0,"div",35)}function v5(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",41),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$index,o=t.XpG(2);return t.Njj(o.remove(n+o.deck.current+1))}),t.nrm(1,"img",23),t.k0s()}}function O5(i,r){1&i&&t.nrm(0,"div",40)}function P5(i,r){if(1&i&&(t.j41(0,"div",36),t.nrm(1,"ghs-loot",38),t.nVh(2,v5,2,0,"a",39),t.nVh(3,O5,1,0,"div",40),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.R7$(),t.Y8G("loot",e)("reveal",!0)("flipped",2==n.reveal)("index",n.deck.current+a+1)("character",n.getCharacter(n.deck.current+a+1))("apply",n.apply),t.R7$(),t.vxM(n.edit?2:-1),t.R7$(),t.vxM(n.edit?3:-1)}}function b5(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",41),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$index,o=t.XpG(2);return t.Njj(o.remove(o.deck.current-n))}),t.nrm(1,"img",23),t.k0s()}}function k5(i,r){1&i&&t.nrm(0,"div",40)}function y5(i,r){if(1&i&&(t.j41(0,"div",36),t.nrm(1,"ghs-loot",42),t.nVh(2,b5,2,0,"a",39),t.nVh(3,k5,1,0,"div",40),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.R7$(),t.Y8G("loot",e)("flipped",!0)("index",n.deck.current-a)("character",n.getCharacter(n.deck.current-a))("edit",n.edit)("looted",!0)("apply",n.apply),t.R7$(),t.vxM(n.edit?2:-1),t.R7$(),t.vxM(n.edit?3:-1)}}function x5(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",33)(1,"div",34,1),t.bIt("cdkDropListDropped",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.dropUpcoming(n))}),t.nVh(3,M5,1,0,"div",35),t.Z7z(4,P5,4,8,"div",36,Ta),t.k0s(),t.j41(6,"div",37,2),t.bIt("cdkDropListDropped",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.dropDiscarded(n))}),t.nrm(8,"div",35),t.Z7z(9,y5,4,9,"div",36,Ta),t.k0s()()}if(2&i){const e=t.sdS(2),a=t.sdS(7),n=t.XpG();t.xc7("max-height",n.maxHeight),t.R7$(),t.Y8G("cdkDropListDisabled",!n.edit)("cdkDropListConnectedTo",a)("cdkDropListAutoScrollStep",20),t.R7$(2),t.vxM(0==n.upcomingCards.length?3:-1),t.R7$(),t.Dyx(n.upcomingCards),t.R7$(2),t.Y8G("cdkDropListDisabled",!n.edit)("cdkDropListConnectedTo",e)("cdkDropListAutoScrollStep",20),t.R7$(3),t.Dyx(n.discardedCards)}}let Qs=(()=>{class i{data;dialogRef;menuElement;gameManager=s.E;GameState=T.mk;reveal=0;edit=!1;apply=!0;maxHeight="";deck;before;after;types=Object.values(ot.r6);lootDeckConfig={};startlootDeckConfig={};LootType=ot.r6;type=ot.r6.money;current=-1;drawing=!1;configuration=!1;enhancements=!1;characters=!0;upcomingCards=[];discardedCards=[];enhancementDeck=[];constructor(e,a){this.data=e,this.dialogRef=a,this.deck=e.deck,this.characters=e.characters,this.before=e.before,this.after=e.after,this.apply=e.apply}ngOnInit(){this.currentConfig(),setTimeout(()=>{this.maxHeight="calc(80vh - "+this.menuElement.nativeElement.offsetHeight+"px)"},m.f.settings.animations?250*m.f.settings.animationSpeed:0),0==this.deck.cards.length&&(this.edit=!0,this.configuration=!0),this.dialogRef.closed.subscribe({next:()=>{let e=new ot.yX;JSON.stringify(this.startlootDeckConfig)!=JSON.stringify(this.lootDeckConfig)&&(s.E.lootManager.apply(e,this.lootDeckConfig),this.applyConfig())}}),this.enhancementDeck=s.E.lootManager.fullLootDeck().filter(e=>-1!=ot.rz.indexOf(e.type)).sort((e,a)=>e.cardId-a.cardId),this.update(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.update()})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.upcomingCards=this.deck.cards.filter((e,a)=>a>this.deck.current),this.discardedCards=this.deck.cards.filter((e,a)=>a<=this.deck.current).reverse()}enhanceCard(e){this.before.emit(new Nt(this.deck,"lootDeckAddEnhancement",e.type,s.E.lootManager.valueLabel(e))),e.enhancements++,s.E.game.lootDeckEnhancements=this.enhancementDeck.filter(a=>a.enhancements>0),this.after.emit(new Nt(this.deck,"lootDeckAddEnhancement",e.type,s.E.lootManager.valueLabel(e))),this.update()}unenhanceCard(e){e.enhancements>0&&(this.before.emit(new Nt(this.deck,"lootDeckRemoveEnhancement",e.type,s.E.lootManager.valueLabel(e))),e.enhancements--,s.E.game.lootDeckEnhancements=this.enhancementDeck.filter(a=>a.enhancements>0),this.after.emit(new Nt(this.deck,"lootDeckRemoveEnhancement",e.type,s.E.lootManager.valueLabel(e)))),this.update()}toggleEdit(){this.edit=!this.edit,this.edit||(this.configuration=!1,this.enhancements=!1),setTimeout(()=>{this.maxHeight="calc(80vh - "+this.menuElement.nativeElement.offsetHeight+"px)"},0)}toggleEnhancements(){this.enhancements=!this.enhancements,this.edit=!1,this.configuration=!1,!this.enhancements&&0==this.deck.cards.length&&(this.edit=!0,this.configuration=!0)}toggleSpecial(e){const a=s.E.game.lootDeckFixed.indexOf(e),n=0!=this.deck.cards.length;this.before.emit(new Nt(this.deck,"lootDeckChangeConfig")),-1==a?(s.E.game.lootDeckFixed.push(e),n&&(this.lootDeckConfig[e]=1)):(s.E.game.lootDeckFixed.splice(a,1),n&&(this.lootDeckConfig[e]=0)),this.after.emit(new Nt(this.deck,"lootDeckChangeConfig")),this.update()}maxValue(e){return s.E.lootManager.fullLootDeck().filter(a=>a.type==e).length}currentConfig(){this.types.forEach(e=>{const a=this.deck.cards.filter(n=>n.type==e).length;this.lootDeckConfig[e]=a>0?a:void 0}),this.startlootDeckConfig=JSON.parse(JSON.stringify(this.lootDeckConfig))}applyConfig(){const e=0==this.deck.cards.length;(Object.values(this.lootDeckConfig).reduce((a,n)=>(a||0)+(n||0))>0||!e)&&(this.before.emit(new Nt(this.deck,"lootDeckChangeConfig")),s.E.lootManager.apply(this.deck,this.lootDeckConfig),s.E.lootManager.shuffleDeck(this.deck),this.types.forEach(a=>{0==this.lootDeckConfig[a]&&(this.lootDeckConfig[a]=void 0)}),this.after.emit(new Nt(this.deck,"lootDeckChangeConfig")),this.deck.cards.length>0&&(e?(0,V.co)(this.dialogRef):this.toggleEdit())),this.update()}changeType(e,a){this.lootDeckConfig[e]=(this.lootDeckConfig[e]||0)+a,0==this.lootDeckConfig[e]&&(this.lootDeckConfig[e]=void 0),this.update()}shuffle(e=!1){this.before.emit(new Nt(this.deck,"lootDeckShuffle"+(e?"Upcoming":""))),s.E.lootManager.shuffleDeck(this.deck,e),s.E.game.figures.forEach(a=>{a instanceof q.K&&(a.lootCards=a.lootCards.filter(n=>n<=this.deck.current))}),this.after.emit(new Nt(this.deck,"lootDeckShuffle"+(e?"Upcoming":""))),this.update()}dropUpcoming(e){this.before.emit(new Nt(this.deck,"lootDeckReorder"));let a=0,n=0,o=0;e.container==e.previousContainer?(a=this.deck.current+1,n=e.previousIndex+a,o=e.currentIndex+a,(0,D.HD)(this.deck.cards,n,o)):(a=this.deck.current,n=a-e.previousIndex,o=e.currentIndex+a,(0,D.HD)(this.deck.cards,n,o),this.deck.current=this.deck.current-1),s.E.game.figures.forEach(g=>{g instanceof q.K&&g.lootCards&&(g.lootCards=g.lootCards.map(_=>(n<o&&_>n&&_<=o?_--:n>o&&_>=o&&_<n?_++:_==n&&(_=o),_)).sort((_,y)=>_-y))}),s.E.game.figures.forEach(g=>{g instanceof q.K&&(g.lootCards=g.lootCards.filter(_=>_<=this.deck.current))}),this.after.emit(new Nt(this.deck,"lootDeckReorder")),this.update()}dropDiscarded(e){this.before.emit(new Nt(this.deck,"lootDeckReorder"));let a=0,n=0,o=0;e.container==e.previousContainer?(a=this.deck.current,n=a-e.previousIndex,o=a-e.currentIndex,(0,D.HD)(this.deck.cards,n,o)):(this.deck.current=this.deck.current+1,a=this.deck.current,n=a+e.previousIndex,o=a-e.currentIndex,(0,D.HD)(this.deck.cards,n,o)),s.E.game.figures.forEach(g=>{g instanceof q.K&&g.lootCards&&(g.lootCards=g.lootCards.map(_=>(n<o&&_>n&&_<=o?_--:n>o&&_>=o&&_<n?_++:_==n&&(_=o),_)).sort((_,y)=>_-y))}),this.after.emit(new Nt(this.deck,"lootDeckReorder")),this.update()}remove(e){this.before.emit(new Nt(this.deck,"lootDeckRemoveCard",e)),e<=this.deck.current&&(this.deck.current--,this.current=this.deck.current),this.deck.cards.splice(e,1),this.after.emit(new Nt(this.deck,"lootDeckRemoveCard",e)),this.update()}countLoot(e){return this.deck.cards.filter(a=>a.type==e).length}countDrawnLoot(e){return this.deck.cards.filter((a,n)=>a.type==e&&n<=this.deck.current).length}countUpcomingLoot(e){return this.deck.cards.filter((a,n)=>a.type==e&&n>this.deck.current).length}getCharacter(e){if(this.characters){const a=s.E.game.figures.find(n=>n instanceof q.K&&n.lootCards&&-1!=n.lootCards.indexOf(e));if(a)return a.name}return""}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-loot-deck-dialog"]],viewQuery:function(a,n){if(1&a&&t.GBs(r5,5),2&a){let o;t.mGM(o=t.lsd())&&(n.menuElement=o.first)}},standalone:!1,decls:12,vars:7,consts:[["menu",""],["upcomingList","cdkDropList"],["discardedList","cdkDropList"],[1,"loot-deck-dialog"],[1,"scroll-container"],[1,"menu"],[1,"toggle-enhancements",3,"click"],[1,"ghs-svg",3,"src"],[3,"ghs-label"],[1,"config"],[1,"enhancements"],[1,"loot-deck-container",3,"maxHeight"],[3,"click"],["ghs-pointer-input","",3,"singleClick","doubleClick","ghs-tooltip","overlayX"],["type","checkbox",3,"click","checked"],[1,"toggle-config"],[1,"toggle-config",3,"click"],["src","./assets/images/settings.svg",1,"ghs-svg"],[3,"ghs-label","ghs-label-args"],[1,"title"],[1,"values"],[1,"config-menu"],[1,"button",3,"click","ngClass"],["src","./assets/images/minus.svg",1,"ghs-svg"],[1,"value",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg",1,"ghs-svg"],[1,"loot-container"],[1,"drag-hidden",3,"loot","flipped","highlight","apply"],[1,"button-enhance",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/fh/loot/plus1.svg",1,"ghs-svg"],[1,"remove-enhancements"],["src","./assets/images/fh/loot/plus1.svg",1,"ghs-svg",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/fh/loot/plus1.svg",1,"ghs-svg",3,"click","ghs-label","ghs-label-attribute"],[1,"loot-deck-container"],["cdkDropList","",1,"upcoming","drop-list",3,"cdkDropListDropped","cdkDropListDisabled","cdkDropListConnectedTo","cdkDropListAutoScrollStep"],[1,"empty"],["cdkDrag","",1,"loot-container"],["cdkDropList","",1,"discarded","drop-list",3,"cdkDropListDropped","cdkDropListDisabled","cdkDropListConnectedTo","cdkDropListAutoScrollStep"],[1,"drag-hidden",3,"loot","reveal","flipped","index","character","apply"],[1,"button-remove"],["cdkDragHandle","",1,"drag-handle"],[1,"button-remove",3,"click"],[1,"drag-hidden",3,"loot","flipped","index","character","edit","looted","apply"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",3)(1,"div",4)(2,"div",5,0),t.nVh(4,g5,8,7),t.j41(5,"a",6),t.bIt("click",function(){return t.eBV(o),t.Njj(n.toggleEnhancements())}),t.nrm(6,"img",7)(7,"span",8),t.k0s(),t.nVh(8,d5,6,10),t.k0s(),t.nVh(9,m5,10,3,"div",9),t.nVh(10,C5,3,0,"div",10),t.nVh(11,x5,11,9,"div",11),t.k0s()()}2&a&&(t.R7$(4),t.vxM(n.deck.cards.length>0?4:-1),t.R7$(2),t.Y8G("src","./assets/images/fh/loot/"+(n.enhancements?"money":"plus1")+".svg",t.B4B),t.R7$(),t.Y8G("ghs-label","game.loot."+(n.enhancements&&n.gameManager.game.scenario?"deck":"enhancements")),t.R7$(),t.vxM(n.enhancements?8:-1),t.R7$(),t.vxM(n.configuration?9:-1),t.R7$(),t.vxM(n.enhancements?10:-1),t.R7$(),t.vxM(n.configuration||n.enhancements?-1:11))},dependencies:[N.YU,D.O7,D.T1,D.Fb,tt,ft,vi,rt,Tt],styles:['.loot-deck-dialog[_ngcontent-%COMP%]{position:relative}.loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;flex-wrap:wrap;max-width:calc(var(--ghs-unit) * 60 * var(--ghs-dialog-factor))}.loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]{pointer-events:none}.loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{cursor:pointer;appearance:none;background-color:var(--form-background);width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));border-width:calc(var(--ghs-unit) * .3);border-style:solid;display:grid;place-content:center;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before{left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));position:relative;content:" ";width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));transform:scale(0);transform-origin:bottom left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;clip-path:polygon(14% 44%,0 65%,50% 100%,100% 16%,80% 0%,43% 62%);color:var(--ghs-color-gray);background-color:var(--ghs-color-gray)}.loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked:before{transform:scale(1)}.loot-deck-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover:before{background-color:var(--ghs-color-white)}.loot-deck-dialog[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1em;width:auto;margin:0 .3em;filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.loot-deck-dialog[_ngcontent-%COMP%]   .config[_ngcontent-%COMP%]{margin-bottom:5%;min-height:500px}.loot-deck-dialog[_ngcontent-%COMP%]   .config[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline);margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.loot-deck-dialog[_ngcontent-%COMP%]   .config[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto auto auto;font-size:1.5em}.loot-deck-dialog[_ngcontent-%COMP%]   .config[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-white);display:flex;justify-content:flex-start;align-items:center;white-space:nowrap}.loot-deck-dialog[_ngcontent-%COMP%]   .config[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white);margin-right:.3em}.loot-deck-dialog[_ngcontent-%COMP%]   .config[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--ghs-color-white);display:flex;justify-content:center;align-items:center;padding:.3em}.loot-deck-dialog[_ngcontent-%COMP%]   .config[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;padding:.3em}.loot-deck-dialog[_ngcontent-%COMP%]   .config[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.loot-deck-dialog[_ngcontent-%COMP%]   .config[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .button.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}.loot-deck-dialog[_ngcontent-%COMP%]   .config[_ngcontent-%COMP%]   .config-menu[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.loot-deck-dialog[_ngcontent-%COMP%]   .config[_ngcontent-%COMP%]   .config-menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:2em;padding:.3em}.loot-deck-dialog[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-evenly;align-items:center;overflow-y:auto;overflow-x:hidden;width:calc(var(--ghs-unit) * 57 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.loot-deck-dialog[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]{position:relative;display:flex;transition:none;width:calc(var(--ghs-unit) * 25.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 38.25 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) 0;flex-shrink:0;flex-grow:0}.loot-deck-dialog[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]   ghs-loot[_ngcontent-%COMP%]{position:absolute;display:flex;top:0;left:0;width:100%;height:100%;z-index:1}.loot-deck-dialog[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]   .button-enhance[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:2}.loot-deck-dialog[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]   .button-enhance[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));height:auto}.loot-deck-dialog[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]   .button-enhance[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]:hover{filter:var(--ghs-filter-gray) brightness(1.5)}.loot-deck-dialog[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]   .remove-enhancements[_ngcontent-%COMP%]{position:absolute;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;top:50%;left:50%;height:50%;width:100%;transform:translate(-50%,-50%);z-index:2}.loot-deck-dialog[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]   .remove-enhancements[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{cursor:pointer;width:20%;height:auto;margin:5%;transition:all calc(var(--ghs-animation-speed) * .1s) ease-in-out;filter:none}.loot-deck-dialog[_ngcontent-%COMP%]   .enhancements[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]   .remove-enhancements[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]:hover{filter:var(--ghs-filter-red);opacity:.6}.loot-deck-dialog[_ngcontent-%COMP%]   .drop-list[_ngcontent-%COMP%]{position:relative}.loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]{display:flex;width:calc(var(--ghs-unit) * 60 * var(--ghs-dialog-factor));overflow:auto}.loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;overflow-y:auto;overflow-x:hidden;width:calc(var(--ghs-unit) * 30 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{position:relative;display:flex;transition:none;width:calc(var(--ghs-unit) * 25.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 38.25 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) 0;flex-shrink:0;flex-grow:0}.loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]   ghs-loot[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   ghs-loot[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]   ghs-loot[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   ghs-loot[_ngcontent-%COMP%]{position:absolute;display:flex;top:0;left:0;width:100%;height:100%}.loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .7 * var(--ghs-dialog-factor));display:block;border-style:dashed;border-width:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor));border-color:var(--ghs-color-white);width:calc(var(--ghs-unit) * 25.1 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 37 * var(--ghs-dialog-factor));border-radius:5%}.loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]{z-index:1;position:absolute;display:flex;cursor:pointer;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-filter-white) var(--ghs-filter-shadow)}.loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:100%;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-shadow)}.loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%], .loot-deck-dialog[_ngcontent-%COMP%]   .loot-deck-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{position:absolute;cursor:grab;left:50%;top:65%;width:60%;height:70%;transform:translate(-50%,-50%)}.cdk-drag-preview[_ngcontent-%COMP%]{opacity:0;cursor:grabbing;z-index:999}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.5;cursor:grabbing}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}']})}return i})();const E5=i=>({vertical:i});let tr=(()=>{class i{data;dialogRef;configuration=!1;deck;before;after;constructor(e,a){this.data=e,this.dialogRef=a,this.deck=e.deck,this.before=e.before,this.after=e.after}ngOnInit(){0==this.deck.cards.length&&(this.configuration=!0)}vertical(){return window.innerWidth<800}beforeLootDeck(e){this.before.emit(e)}afterLootDeck(e){this.after.emit(e)}close(){(0,V.co)(this.dialogRef)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-loot-deck-fullscreen"]],standalone:!1,decls:4,vars:6,consts:[[1,"loot-deck-fullscreen",3,"ngClass"],[3,"before","after","deck","fullscreen","vertical"],[1,"close-container",3,"click"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"ghs-loot-deck",1),t.bIt("before",function(g){return n.beforeLootDeck(g)})("after",function(g){return n.afterLootDeck(g)}),t.k0s(),t.j41(2,"div",2),t.bIt("click",function(){return n.close()}),t.k0s()(),t.j41(3,"div",2),t.bIt("click",function(){return n.close()}),t.k0s()),2&a&&(t.Y8G("ngClass",t.eq3(4,E5,n.vertical())),t.R7$(),t.Y8G("deck",n.deck)("fullscreen",!1)("vertical",n.vertical()))},styles:[".loot-deck-fullscreen[_ngcontent-%COMP%]{width:100vw;height:100vh;overflow-x:auto;overflow-y:auto;display:flex;flex-direction:column;justify-content:flex-start;align-items:center;z-index:3}.loot-deck-fullscreen[_ngcontent-%COMP%]   ghs-loot-deck[_ngcontent-%COMP%]{display:flex;width:99vw;max-width:600px;height:100vw;max-height:420px;z-index:4;margin-top:2em;margin-left:1%}.loot-deck-fullscreen.vertical[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden}.loot-deck-fullscreen.vertical[_ngcontent-%COMP%]   ghs-loot-deck[_ngcontent-%COMP%]{width:98vw;margin-right:1%;height:132vw;max-height:800px;transform:none}.loot-deck-fullscreen[_ngcontent-%COMP%]   .close-container[_ngcontent-%COMP%]{cursor:zoom-out;position:absolute;display:flex;width:100%;height:100%;z-index:2;top:0;left:0}"]})}return i})();const w5=(i,r,e)=>({disabled:i,vertical:r,denied:e}),er=i=>({disabled:i}),R5=(i,r)=>({vertical:i,minimize:r}),j5=(i,r,e)=>({vertical:i,"without-fullscreen":r,minimize:e}),G5=(i,r,e,a)=>({discarded:i,current:r,last:e,bottom:a}),T5=(i,r)=>r.cardId+"-"+i;function S5(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",7),t.bIt("click",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.openFullscreen(n))}),t.nrm(1,"img",8),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ghs-label","game.cards.fullscreen")("ghs-label-attribute","title")("ngClass",t.l_i(3,R5,e.vertical,!e.deck.active))}}function $5(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",9),t.bIt("click",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.open(n))}),t.nrm(1,"img",10),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ghs-label","game.cards.openDialog")("ghs-label-attribute","title")("ngClass",t.sMw(3,j5,e.vertical,!e.fullscreen,!e.deck.active))}}function D5(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",12),t.bIt("click",function(n){t.eBV(e);const o=t.XpG().$index,g=t.XpG();return t.Njj(g.clickCard(o,n))}),t.nrm(1,"ghs-loot",13),t.k0s()}if(2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG();t.xc7("z-index",n>o.current?o.deck.cards.length-n:o.deck.cards.length+n+1),t.Y8G("ngClass",t.ziG(11,G5,n<o.current-1,n==o.current,n==o.current-1,o.bottom)),t.R7$(),t.Y8G("loot",a)("flipped",n<=o.current)("looted",n<=o.current)("index",n)("disableFlip",!o.drawing||n!=o.current)("character",o.getCharacter(n))("apply",!o.standalone)("ngClass",t.eq3(16,er,o.disabled))}}function I5(i,r){if(1&i&&t.nVh(0,D5,2,18,"div",11),2&i){const e=r.$index,a=t.XpG();t.vxM(e>a.current-3?0:-1)}}class Nt{deck;type;values;constructor(r,e,...a){this.deck=r,this.type=e,this.values=a}}let Sa=(()=>{class i{element;dialog;deck;bottom=!1;characters=!0;fullscreen=!0;vertical=!1;standalone=!1;before=new t.bkB;after=new t.bkB;initTimeout=1500;gameManager=s.E;settingsManager=m.f;lootManager=s.E.lootManager;current=-1;internalDraw=-99;LootType=ot.r6;GameState=T.mk;drawing=!1;drawTimeout=null;queue=0;queueTimeout=null;compact=!1;disabled=!1;init=!1;initServer=!1;constructor(e,a){this.element=e,this.dialog=a,this.element.nativeElement.addEventListener("pointerdown",n=>{let o=document.elementsFromPoint(n.clientX,n.clientY);o[0].classList.contains("deck")&&o.length>2&&o[2].click()})}ngOnInit(){this.current=this.deck.current,this.internalDraw=-99,this.compact=this.deck.cards.length>0&&m.f.settings.automaticAttackModifierFullscreen&&m.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400),this.disabled=!this.standalone&&s.E.game.state==T.mk.draw,this.init||(this.drawTimeout=setTimeout(()=>{this.current=this.deck.current,this.drawTimeout=null,this.init=!0},m.f.settings.animations?this.initTimeout*m.f.settings.animationSpeed:0)),this.uiChangeSubscription=s.E.uiChange.subscribe({next:e=>{this.update(e)}}),window.addEventListener("resize",e=>{this.compact=this.deck.cards.length>0&&m.f.settings.automaticAttackModifierFullscreen&&m.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)}),window.addEventListener("fullscreenchange",e=>{this.compact=this.deck.cards.length>0&&m.f.settings.automaticAttackModifierFullscreen&&m.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}ngOnChanges(e){e.deck&&this.update()}update(e=!1){this.disabled=!this.standalone&&s.E.game.state==T.mk.draw,this.initServer&&s.E.stateManager.wsState()!=WebSocket.OPEN&&(this.initServer=!1),this.deck.active||this.standalone?!this.init||e&&!this.initServer?(this.current=this.deck.current,e&&!this.initServer&&(this.initServer=!0)):this.current<this.deck.current?(this.queue=Math.max(0,this.deck.current-this.current),this.queueTimeout||(this.queue--,this.current++,this.drawQueue(e))):(!this.queueTimeout||this.deck.current<this.current+this.queue)&&(this.queueTimeout&&(clearTimeout(this.queueTimeout),this.queueTimeout=null),this.queue=0,this.drawing=!1,this.current=this.deck.current):(this.queueTimeout&&(clearTimeout(this.queueTimeout),this.queueTimeout=null),this.queue=0,this.drawing=!1,this.current=this.deck.current,this.initServer=s.E.stateManager.wsState()==WebSocket.OPEN),this.compact=m.f.settings.automaticAttackModifierFullscreen&&m.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)}drawQueue(e){this.drawing=!0,this.element.nativeElement.getElementsByClassName("deck")[0].classList.add("drawing"),this.queueTimeout=setTimeout(()=>{this.drawing=!1,this.queueTimeout=null;const a=this.current,n=this.deck.cards[a];if(this.queue>0?(this.queue--,this.current++,this.drawQueue(e)):(this.element.nativeElement.getElementsByClassName("deck")[0].classList.remove("drawing"),this.queue<0&&(this.queue=0)),!e&&n&&null!=ot.mn.indexOf(n.type)&&m.f.settings.applyLoot&&!this.standalone&&s.E.game.figures.find(o=>o instanceof q.K&&s.E.gameplayFigure(o))){let o=s.E.game.figures.find(g=>g instanceof q.K&&g.active);!o||m.f.settings.alwaysLootApplyDialog?this.dialog.open(ts,{panelClass:["dialog"],data:{loot:n}}).closed.subscribe({next:_=>{if(_){const y=s.E.game.figures.find(B=>B instanceof q.K&&B.name==_);y instanceof q.K&&this.applyLoot(y,n,a)}}}):o&&this.applyLoot(o,n,a)}},m.f.settings.animations?1050*m.f.settings.animationSpeed:0)}applyLoot(e,a,n){if(-1==e.lootCards.indexOf(n)){s.E.stateManager.before(a.type==ot.r6.random_item?"lootRandomItem":"addResource",s.E.characterManager.characterName(e),"game.loot."+a.type,this.lootManager.getValue(a));const o=s.E.lootManager.applyLoot(a,e,n);s.E.stateManager.after(),o&&this.dialog.open(pa,{panelClass:["dialog"],data:{item:o,character:e}}).closed.subscribe({next:g=>{if(g){const _=g;s.E.stateManager.before("lootRandomItem",_.id,_.edition,_.name,s.E.characterManager.characterName(e));let y=new vt.gw(""+_.id,_.edition);s.E.itemManager.addItemCount(_),-1==e.lootCards.indexOf(n)&&(e.lootCards.push(n),e.lootCards.sort((B,nt)=>B-nt)),null!=e.progress.items.find(B=>B.name==""+_.id&&B.edition==_.edition)?e.progress.gold+=s.E.itemManager.itemSellValue(_):(e.progress.items.push(y),e.progress.equippedItems.push(new vt.h5(y.name,y.edition,void 0,"loot-random-item"))),s.E.stateManager.after()}else e.lootCards=e.lootCards.filter(_=>_!=_)}})}}draw(e,a=!1){if(this.compact&&this.fullscreen&&!a)this.openFullscreen(e);else if(!this.disabled&&this.deck.cards.length>0){if(!this.drawTimeout&&this.deck.current<this.deck.cards.length-(0==this.queue?0:1)){const n=s.E.game.figures.find(o=>o instanceof q.K&&o.active);this.drawTimeout=setTimeout(()=>{if(this.before.emit(new Nt(this.deck,"lootDeckDraw")),!m.f.settings.alwaysLootApplyDialog&&n instanceof q.K){const o=s.E.lootManager.drawCard(this.deck,n);o&&setTimeout(()=>{this.dialog.open(pa,{panelClass:["dialog"],data:{item:o,character:n}}).closed.subscribe({next:g=>{if(g){const _=g;s.E.stateManager.before("lootRandomItem",_.id,_.edition,_.name,s.E.characterManager.characterName(n));let y=new vt.gw(""+_.id,_.edition);s.E.itemManager.addItemCount(_),-1==n.lootCards.indexOf(this.current)&&(n.lootCards.push(this.current),n.lootCards.sort((B,nt)=>B-nt)),null!=n.progress.items.find(B=>B.name==""+_.id&&B.edition==_.edition)?n.progress.gold+=s.E.itemManager.itemSellValue(_):(n.progress.items.push(y),n.progress.equippedItems.push(new vt.h5(y.name,y.edition,void 0,"loot-random-item"))),s.E.stateManager.after()}else n.lootCards=n.lootCards.filter(_=>_!=this.current)}})},m.f.settings.animations?1050*m.f.settings.animationSpeed:0)}else s.E.lootManager.drawCard(this.deck,void 0);this.after.emit(new Nt(this.deck,"lootDeckDraw")),this.drawTimeout=null},m.f.settings.animations?150*m.f.settings.animationSpeed:0)}}else this.dialog.open(Qs,{panelClass:["dialog"],data:{deck:this.deck,characters:this.characters,before:this.before,after:this.after,apply:!this.standalone}})}openFullscreen(e){this.fullscreen&&(this.dialog.open(tr,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:{deck:this.deck,before:this.before,after:this.after}}),e.preventDefault(),e.stopPropagation())}clickCard(e,a){(!this.drawing||e>this.current)&&this.open(a)}getCharacter(e){if(this.characters){const a=s.E.game.figures.find(n=>n instanceof q.K&&n.lootCards&&-1!=n.lootCards.indexOf(e));if(a)return a.name}return""}open(e){this.deck.cards.length>0&&s.E.game.state==T.mk.next&&this.fullscreen&&m.f.settings.automaticAttackModifierFullscreen&&m.f.settings.portraitMode&&(window.innerWidth<800||window.innerHeight<400)?this.openFullscreen(e):this.dialog.open(Qs,{panelClass:["dialog"],data:{deck:this.deck,characters:this.characters,before:this.before,after:this.after,apply:!this.standalone}}),e.preventDefault(),e.stopPropagation()}static \u0275fac=function(a){return new(a||i)(t.rXU(t.aKT),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-loot-deck"]],inputs:{deck:"deck",bottom:"bottom",characters:"characters",fullscreen:"fullscreen",vertical:"vertical",standalone:"standalone",initTimeout:"initTimeout"},outputs:{before:"before",after:"after"},standalone:!1,features:[t.OA$],decls:10,vars:15,consts:[["card",""],[1,"deck",3,"ngClass"],[1,"loot-container","draw"],[1,"loot-card",3,"click","ngClass"],[1,"number"],[1,"fullscreen",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"settings",3,"ghs-label","ghs-label-attribute","ngClass"],[1,"fullscreen",3,"click","ghs-label","ghs-label-attribute","ngClass"],["src","./assets/images/fullscreen.svg"],[1,"settings",3,"click","ghs-label","ghs-label-attribute","ngClass"],["src","./assets/images/settings.svg",1,"ghs-svg"],[1,"loot-container",3,"z-index","ngClass"],[1,"loot-container",3,"click","ngClass"],[1,"loot-card",3,"loot","flipped","looted","index","disableFlip","character","apply","ngClass"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3,0),t.bIt("click",function(_){return t.eBV(o),t.Njj(n.draw(_))}),t.j41(4,"span",4),t.EFF(5),t.k0s()(),t.nVh(6,S5,2,6,"span",5),t.nVh(7,$5,2,7,"span",6),t.k0s(),t.Z7z(8,I5,1,1,null,null,T5),t.k0s()}if(2&a){const o=t.sdS(3);t.Y8G("ngClass",t.sMw(9,w5,!n.standalone&&n.gameManager.game.state==n.GameState.draw,n.vertical,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.lootDeck)),t.R7$(),t.xc7("z-index",n.deck.cards.length+1),t.R7$(),t.xc7("font-size",.08*o.offsetWidth+"px"),t.Y8G("ngClass",t.eq3(13,er,n.disabled)),t.R7$(3),t.JRh(n.deck.current<n.deck.cards.length-1?n.deck.cards.length-n.deck.current-1+"/"+n.deck.cards.length:0),t.R7$(),t.vxM(n.fullscreen&&!n.compact?6:-1),t.R7$(),t.vxM(!n.compact||n.vertical?7:-1),t.R7$(),t.Dyx(n.deck.cards)}},dependencies:[N.YU,tt,vi],styles:[".deck[_ngcontent-%COMP%]{position:relative;width:100%;height:100%}.deck[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]{position:absolute;width:40%;padding-top:60%;bottom:0;right:0}.deck[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]{position:absolute;inset:0;cursor:pointer;display:block;transition:filter calc(var(--ghs-animation-speed) * 1s) ease-in-out}.deck[_ngcontent-%COMP%]   .loot-card.disabled[_ngcontent-%COMP%]{filter:grayscale(.8)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]{cursor:pointer;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(loot-back.b3962872f80142fe.png);border-radius:5%;transition:filter calc(var(--ghs-animation-speed) * 1s) ease-in-out}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .loot-card[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);position:absolute;font-size:2em;line-height:1em;left:5%;bottom:0%;z-index:500}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .loot-card.disabled[_ngcontent-%COMP%]{cursor:initial;filter:grayscale(.7)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]{cursor:pointer;right:-14%;font-family:var(--ghs-font-gh-title);display:flex;justify-content:center;position:absolute;color:var(--ghs-color-white);width:22%;height:15%;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-character-icon.83c1ab396221d56b.png);transition:transform calc(var(--ghs-animation-speed) * .5s) ease-in-out;transform:scale(1.1)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.minimize[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.minimize[_ngcontent-%COMP%]{transform:scale(0)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.fullscreen[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.fullscreen[_ngcontent-%COMP%]{cursor:zoom-in;bottom:32.5%}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.settings[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.settings[_ngcontent-%COMP%]{cursor:help;bottom:-4%}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings.settings.without-fullscreen[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen.settings.without-fullscreen[_ngcontent-%COMP%]{top:50%;bottom:initial;transform:translateY(-50%)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:60%;width:auto;align-self:center;filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}@keyframes _ngcontent-%COMP%_loot-draw{0%{transform:scale(1) translate(102%,16.5%)}35%,70%{transform:scale(1.1) translate(51%,25%)}to{transform:scale(1) translate(0)}}@keyframes _ngcontent-%COMP%_loot-draw-bottom{0%{transform:scale(1) translate(102%,-16.5%)}35%,70%{transform:scale(1.6) translate(110%,-90%)}to{transform:scale(1) translate(0)}}@keyframes _ngcontent-%COMP%_loot-last{0%{right:42%;transform:rotate(0)}70%{right:42%;transform:rotate(0)}to{right:75%;transform:rotate(-5deg)}}.deck[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{position:absolute;bottom:0;right:42%;z-index:1}.deck[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .last[_ngcontent-%COMP%]{position:absolute;bottom:0;right:75%;transform:rotate(-5deg);z-index:0}.deck[_ngcontent-%COMP%]   .discarded.last[_ngcontent-%COMP%]:hover, .deck[_ngcontent-%COMP%]   .last.last[_ngcontent-%COMP%]:hover{z-index:100!important}.deck[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{filter:grayscale(.8)}.deck[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]:hover{transition:filter calc(var(--ghs-animation-speed) * .25s) linear,transform calc(var(--ghs-animation-speed) * .8s) cubic-bezier(.75,0,.85,1),top calc(var(--ghs-animation-speed) * .5s) linear,left calc(var(--ghs-animation-speed) * .5s) linear;filter:grayscale(15%)}.deck.drawing[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]{cursor:wait!important}.deck.drawing[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{cursor:wait!important;animation:_ngcontent-%COMP%_loot-draw calc(var(--ghs-animation-speed) * 1s) ease-in-out;animation-iteration-count:1}.deck.drawing[_ngcontent-%COMP%]   .current.bottom[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_loot-draw-bottom calc(var(--ghs-animation-speed) * 1s) ease-in-out}.deck.drawing[_ngcontent-%COMP%]   .last[_ngcontent-%COMP%]{cursor:wait!important;animation:_ngcontent-%COMP%_loot-last calc(var(--ghs-animation-speed) * 1s) ease-in-out;animation-iteration-count:1}.vertical[_ngcontent-%COMP%]   .loot-container[_ngcontent-%COMP%]{top:0;bottom:initial;left:0}.vertical[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{top:0;bottom:initial;position:absolute;transform:translateY(110%);z-index:1}.vertical[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%], .vertical[_ngcontent-%COMP%]   .last[_ngcontent-%COMP%]{position:absolute;top:0;bottom:initial;left:30%;transform:translateY(118%) rotate(5deg);z-index:0}@keyframes _ngcontent-%COMP%_loot-draw-vertical{0%{transform:scale(1)}35%,70%{transform:scale(1.1) translate(15%,125%)}to{transform:scale(1) translateY(110%)}}@keyframes _ngcontent-%COMP%_loot-last-vertical{0%{left:0;transform:translateY(110%) rotate(0)}70%{left:0;transform:translateY(110%) rotate(0)}to{left:30%;transform:translateY(118%) rotate(5deg)}}.vertical.drawing[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_loot-draw-vertical calc(var(--ghs-animation-speed) * 1s) ease-in-out}.vertical.drawing[_ngcontent-%COMP%]   .last[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_loot-last-vertical calc(var(--ghs-animation-speed) * 1s) ease-in-out}"]})}return i})();const A5=(i,r)=>[i,r],V5=(i,r)=>r.edition+"-"+r.index;function F5(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",8),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.close(n))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ghs-label","scenario.section.conclusion"+(a.data.parent.conclusion?".continue":"")+(e.named?".named":""))("ghs-label-args",t.l_i(2,A5,"%data.section:"+e.index+"%",e.named?a.gameManager.scenarioManager.scenarioTitle(e,!0):""))}}let Se=(()=>{class i{data;dialogRef;gameManager=s.E;constructor(e,a){this.data=e,this.dialogRef=a,1==this.data.conclusions.length&&this.close(this.data.conclusions[0])}close(e=void 0){(0,V.co)(this.dialogRef,e)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-scenario-conclusion-dialog"]],standalone:!1,decls:10,vars:2,consts:[[1,"section-popup"],[1,"header"],["src","./assets/images/scenario/conclusion.svg",1,"ghs-svg"],[3,"ghs-label"],[1,"conclusions"],[1,"placeholder","text-white","conclusion",3,"ghs-label","ghs-label-args"],[1,"buttons"],[1,"cancel",3,"click"],[1,"placeholder","text-white","conclusion",3,"click","ghs-label","ghs-label-args"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"img",2)(3,"span",3),t.k0s(),t.j41(4,"div",4),t.Z7z(5,F5,1,5,"span",5,V5),t.k0s(),t.j41(7,"div",6)(8,"a",7),t.bIt("click",function(){return n.close()}),t.nrm(9,"span",3),t.k0s()()()),2&a&&(t.R7$(3),t.Y8G("ghs-label","scenario.section.conclusion.select"),t.R7$(2),t.Dyx(n.data.conclusions),t.R7$(4),t.Y8G("ghs-label","scenario.section.cancel"))},dependencies:[tt],styles:[".section-popup[_ngcontent-%COMP%]{text-align:center;min-width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor));padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.section-popup[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.section-popup[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-white)}.section-popup[_ngcontent-%COMP%]   .conclusions[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.section-popup[_ngcontent-%COMP%]   .conclusions[_ngcontent-%COMP%]   .conclusion[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.section-popup[_ngcontent-%COMP%]   .conclusions[_ngcontent-%COMP%]   .conclusion[_ngcontent-%COMP%]:hover{opacity:.7}.section-popup[_ngcontent-%COMP%]   .conclusions[_ngcontent-%COMP%]   .conclusion[_ngcontent-%COMP%]:not(:first-child){border-top:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray)}.section-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly}.section-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}.section-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.section-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}"]})}return i})();const X5=i=>[i];function B5(i,r){1&i&&(t.j41(0,"p"),t.nrm(1,"span",3),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","round.hint.empty"))}function Y5(i,r){1&i&&(t.j41(0,"p"),t.nrm(1,"span",3),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","round.hint.missingInitiative"))}function N5(i,r){1&i&&(t.j41(0,"p"),t.nrm(1,"span",3),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","round.hint.active"))}function z5(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",4),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.confirm())}),t.nrm(1,"span",3),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","round.hint.confirm"))}function L5(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",5),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.next())}),t.nrm(1,"span",3),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","round.hint.confirmTurns"))}function U5(i,r){1&i&&(t.j41(0,"p"),t.nrm(1,"span",3),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","round.hint.finish"))}function q5(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",4),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.finishScenario(!0))}),t.nrm(1,"span",3),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","round.hint.confirmFinish"))}function H5(i,r){1&i&&(t.j41(0,"p"),t.nrm(1,"span",3),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","round.hint.failed"))}function K5(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",4),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.finishScenario(!1))}),t.nrm(1,"span",3),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","round.hint.confirmFailed"))}function W5(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",4),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.resetScenario())}),t.nrm(1,"span",3),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","round.hint.confirmReset"))}function J5(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",4),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.confirm())}),t.nrm(1,"span",3),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label",e.gameManager.game.state==e.GameState.next?"round.hint.continueNext":"round.hint.continueDraw")}}function Z5(i,r){1&i&&(t.j41(0,"p"),t.nrm(1,"span",3),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","round.hint.battleGoals"))}function Q5(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",4),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.confirm())}),t.nrm(1,"span",3),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","round.hint.confirm"))}function tG(i,r){if(1&i&&(t.j41(0,"p"),t.nrm(1,"span",6),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","round.hint.eventDraw")("ghs-label-args",t.eq3(2,X5,e.gameManager.game.eventDraw))}}function eG(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",4),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.confirm())}),t.nrm(1,"span",3),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","round.hint.confirm"))}let nG=(()=>{class i{dialogRef;dialog;gameManager=s.E;GameState=T.mk;constructor(e,a){this.dialogRef=e,this.dialog=a}confirm(){s.E.game.figures.find(a=>a.active)&&(s.E.stateManager.before("endAllTurns"),s.E.game.figures.forEach(a=>s.E.roundManager.afterTurn(a)),s.E.stateManager.after()),this.next()}next(){(0,V.co)(this.dialogRef,!0)}finishScenario(e){if(s.E.game.scenario){const a=s.E.sectionData(s.E.game.scenario.edition).filter(n=>!!s.E.game.scenario&&n.edition==s.E.game.scenario.edition&&n.parent==s.E.game.scenario.index&&n.group==s.E.game.scenario.group&&n.conclusion&&0==s.E.scenarioManager.getRequirements(n).length);0!=a.length&&e?this.dialog.open(Se,{panelClass:["dialog"],data:{conclusions:a,parent:s.E.game.scenario}}).closed.subscribe({next:n=>{n&&this.dialog.open(Yt,{panelClass:["dialog"],data:{scenario:s.E.game.scenario,conclusion:n,success:e}})}}):this.dialog.open(Yt,{panelClass:["dialog"],data:{scenario:s.E.game.scenario,success:e}}),(0,V.co)(this.dialogRef,!1)}}resetScenario(){s.E.stateManager.before("resetScenario",...s.E.scenarioManager.scenarioUndoArgs()),s.E.roundManager.resetScenario(),s.E.scenarioManager.setScenario(s.E.game.scenario),s.E.stateManager.after(),(0,V.co)(this.dialogRef)}empty(){return 0==s.E.game.figures.length}missingInitiative(){return s.E.game.figures.some(e=>m.f.settings.initiativeRequired&&(e instanceof q.K&&s.E.entityManager.isAlive(e)&&!e.absent||e instanceof mt.$e)&&e.getInitiative()<=0)}active(){return null!=s.E.game.figures.find(e=>e.active&&!e.off)}battleGoals(){return!this.missingInitiative()&&m.f.settings.battleGoals&&m.f.settings.battleGoalsReminder&&null!=s.E.game.scenario&&s.E.roundManager.firstRound&&!s.E.game.figures.every(e=>!(e instanceof q.K)||e.battleGoal||e.absent)&&!s.E.bbRules()}eventDraw(){return!this.missingInitiative()&&!m.f.settings.eventsDraw&&m.f.settings.eventsDrawReminder&&null!=s.E.game.scenario&&s.E.roundManager.firstRound&&null!=s.E.game.eventDraw}finish(){return!1}failed(){return!this.active()&&!this.empty()&&s.E.game.figures.some(e=>e instanceof q.K)&&s.E.game.figures.every(e=>!(e instanceof q.K)||e instanceof q.K&&(!s.E.entityManager.isAlive(e)||e.absent))}onKeyEnter(e){m.f.settings.keyboardShortcuts&&"Enter"===e.key&&(this.active()?this.confirm():this.finish()?this.finishScenario(!0):this.failed()?this.finishScenario(!1):(this.battleGoals()||this.eventDraw())&&this.confirm(),e.preventDefault(),e.stopPropagation())}static \u0275fac=function(a){return new(a||i)(t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-hint-dialog"]],hostBindings:function(a,n){1&a&&t.bIt("keydown",function(g){return n.onKeyEnter(g)},t.EBC)},standalone:!1,decls:17,vars:15,consts:[[1,"hint-dialog"],[1,"hint"],[1,"small"],[3,"ghs-label"],[3,"click"],[1,"small",3,"click"],[3,"ghs-label","ghs-label-args"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.nVh(2,B5,2,1,"p"),t.nVh(3,Y5,2,1,"p"),t.nVh(4,N5,2,1,"p"),t.nVh(5,z5,2,1,"a"),t.nVh(6,L5,2,1,"a",2),t.nVh(7,U5,2,1,"p"),t.nVh(8,q5,2,1,"a"),t.nVh(9,H5,2,1,"p"),t.nVh(10,K5,2,1,"a"),t.nVh(11,W5,2,1,"a"),t.nVh(12,J5,2,1,"a"),t.nVh(13,Z5,2,1,"p"),t.nVh(14,Q5,2,1,"a"),t.nVh(15,tG,2,4,"p"),t.nVh(16,eG,2,1,"a"),t.k0s()()),2&a&&(t.R7$(2),t.vxM(n.empty()?2:-1),t.R7$(),t.vxM(n.missingInitiative()?3:-1),t.R7$(),t.vxM(n.active()?4:-1),t.R7$(),t.vxM(n.active()?5:-1),t.R7$(),t.vxM(n.active()?6:-1),t.R7$(),t.vxM(n.finish()?7:-1),t.R7$(),t.vxM(n.finish()?8:-1),t.R7$(),t.vxM(n.failed()?9:-1),t.R7$(),t.vxM(n.failed()?10:-1),t.R7$(),t.vxM(n.failed()?11:-1),t.R7$(),t.vxM(n.finish()||n.failed()?12:-1),t.R7$(),t.vxM(n.battleGoals()?13:-1),t.R7$(),t.vxM(n.battleGoals()?14:-1),t.R7$(),t.vxM(n.eventDraw()&&n.gameManager.game.eventDraw?15:-1),t.R7$(),t.vxM(n.eventDraw()?16:-1))},dependencies:[tt],styles:[".hint-dialog[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);text-align:center}.hint-dialog[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;min-height:calc(var(--ghs-unit) * 6 * var(--ghs-text-factor))}.hint-dialog[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));color:var(--ghs-color-gray);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor))}.hint-dialog[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));color:var(--ghs-color-gray);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.hint-dialog[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.hint-dialog[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   a.small[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));font-style:italic}"]})}return i})();const nr=i=>({disabled:i});function iG(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",5),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.change(-n))}),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ngClass",t.eq3(4,nr,a.min&&a.model-e<a.min)),t.R7$(),t.SpI(" ",t.bMT(2,2,a.relative?-e:a.model-e)," ")}}function aG(i,r){if(1&i&&(t.j41(0,"div",1),t.Z7z(1,iG,3,6,"div",4,t.fX1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.stepsNegative)}}function oG(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.JRh(e.model)}}function sG(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.JRh(t.bMT(2,1,e.model))}}function rG(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",5),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.change(n))}),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(4,nr,a.max&&a.model+e>a.max)),t.R7$(),t.SpI(" ",t.bMT(2,2,a.relative?e:a.model+e)," ")}}let cG=(()=>{class i{model=0;modelChange=new t.bkB;steps=[1,2];negative=!0;min=0;max=void 0;relative=!1;stepsNegative=this.steps.map(e=>e).reverse();ngOnInit(){this.stepsNegative=this.steps.map(e=>e).reverse()}change(e){this.modelChange.emit(this.model+e)}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-number-input"]],inputs:{model:"model",steps:"steps",negative:"negative",min:"min",max:"max",relative:"relative"},outputs:{modelChange:"modelChange"},standalone:!1,decls:8,vars:3,consts:[[1,"number-input-container"],[1,"value-container","negative"],[1,"current"],[1,"value-container"],["tabclick","",1,"value",3,"ngClass"],["tabclick","",1,"value",3,"click","ngClass"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nVh(1,aG,3,0,"div",1),t.j41(2,"div",2),t.nVh(3,oG,2,1,"span"),t.nVh(4,sG,3,3,"span"),t.k0s(),t.j41(5,"div",3),t.Z7z(6,rG,3,6,"div",4,t.fX1),t.k0s()()),2&a&&(t.R7$(),t.vxM(n.negative?1:-1),t.R7$(2),t.vxM(n.relative?3:-1),t.R7$(),t.vxM(n.relative?-1:4),t.R7$(2),t.Dyx(n.steps))},dependencies:[N.YU,At,Cn],styles:[".number-input-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:1em}.number-input-container[_ngcontent-%COMP%]   .value-container[_ngcontent-%COMP%]{display:flex}.number-input-container[_ngcontent-%COMP%]   .value-container[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{cursor:pointer;font-size:1em;margin:.2em;filter:brightness(.8)}.number-input-container[_ngcontent-%COMP%]   .value-container[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:hover{filter:brightness(1.5)}.number-input-container[_ngcontent-%COMP%]   .value-container[_ngcontent-%COMP%]   .value.disabled[_ngcontent-%COMP%]{pointer-events:none;visibility:hidden}.number-input-container[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{font-size:1.5em;margin:.2em}"]})}return i})();const lG=i=>({denied:i}),gG=i=>({disabled:i}),ir=(i,r)=>({active:i,scenariolevel:r}),dG=i=>[i],hG=()=>[],_G=i=>({current:i}),mG=(i,r,e,a)=>({"level-1":i,"level-2":r,"level-3":e,"level-4":a});function pG(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",10),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.setLevelCalculation(!n.gameManager.game.levelCalculation))}),t.k0s(),t.nrm(2,"span",4),t.k0s()}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("checked",e.gameManager.game.levelCalculation),t.R7$(),t.Y8G("ghs-label","settings.levelCalculation")}}function uG(i,r){if(1&i){const e=t.RV6();t.j41(0,"label"),t.nrm(1,"span",4),t.EFF(2," :\xa0 "),t.j41(3,"ghs-number-input",5),t.bIt("modelChange",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.setLevelAdjustment(n))}),t.k0s()()}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","settings.levelAdjustment"),t.R7$(2),t.Y8G("model",e.gameManager.game.levelAdjustment)("min",-6)("max",6)}}function fG(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",10),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.setGe5Player(!n.gameManager.game.ge5Player))}),t.k0s(),t.nrm(2,"span",4),t.k0s()}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("checked",e.gameManager.game.ge5Player),t.R7$(),t.Y8G("ghs-label","settings.ge5Player")}}function CG(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",28),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(2);return t.Njj(o.setLevel(n))}),t.EFF(1),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.Y8G("ngClass",t.l_i(2,ir,e==a.gameManager.game.level,a.gameManager.game.playerCount<1&&e==a.gameManager.levelManager.scenarioLevel())),t.R7$(),t.JRh(e)}}function MG(i,r){if(1&i&&(t.j41(0,"a",27),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.Y8G("ngClass",t.l_i(2,ir,e==a.gameManager.game.level,a.gameManager.game.playerCount<1&&e==a.gameManager.levelManager.scenarioLevel())),t.R7$(),t.JRh(e)}}function vG(i,r){if(1&i&&(t.j41(0,"span",7),t.nVh(1,CG,2,5,"a",26),t.nVh(2,MG,2,5,"a",27),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.vxM(e.gameManager.game.levelCalculation?-1:1),t.R7$(),t.vxM(e.gameManager.game.levelCalculation?2:-1)}}function OG(i,r){if(1&i&&t.nrm(0,"span",17),2&i){const e=t.XpG(2);t.Y8G("ghs-label","data.favors.fh.wealth.level")("ghs-label-args",t.eq3(2,dG,e.gameManager.trialsManager.activeFavor("fh","wealth")))}}function PG(i,r){if(1&i){const e=t.RV6();t.j41(0,"input",29,0),t.bIt("keyup",function(){return t.eBV(e),t.Njj(0)})("change",function(){t.eBV(e);const n=t.sdS(1),o=t.XpG(2);return t.Njj(o.setPlayerCount(+n.value))}),t.k0s()}if(2&i){const e=t.sdS(1),a=t.XpG(2);t.Y8G("value",a.gameManager.game.playerCount)("size",e.value.length)("ghs-label","settings.playerCount")("ghs-label-attribute","placeholder")}}function bG(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",3),t.nVh(1,pG,3,2,"label"),t.nVh(2,uG,4,4,"label"),t.j41(3,"label"),t.nrm(4,"span",4),t.EFF(5," :\xa0 "),t.j41(6,"ghs-number-input",5),t.bIt("modelChange",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setBonusAdjustment(n))}),t.k0s()(),t.nVh(7,fG,3,2,"label"),t.k0s(),t.j41(8,"div",6)(9,"span",7),t.nrm(10,"img",8),t.k0s(),t.Z7z(11,vG,3,2,"span",7,t.fX1),t.j41(13,"div",9)(14,"label")(15,"input",10),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.setSolo(!n.gameManager.game.solo))}),t.k0s(),t.nrm(16,"span",4),t.k0s()()(),t.j41(17,"div",11)(18,"div",12)(19,"span",13),t.nrm(20,"img",14),t.EFF(21,":"),t.k0s(),t.j41(22,"span",15),t.EFF(23),t.k0s(),t.j41(24,"span",16),t.nrm(25,"span",4),t.EFF(26,"\xa0"),t.nVh(27,OG,1,4,"span",17),t.k0s()(),t.j41(28,"div",18)(29,"span",13),t.nrm(30,"img",19),t.EFF(31,":"),t.k0s(),t.j41(32,"span",15),t.EFF(33),t.k0s(),t.j41(34,"span",16),t.nrm(35,"span",4),t.k0s()(),t.j41(36,"div",20)(37,"span",13),t.nrm(38,"img",21),t.EFF(39,":"),t.k0s(),t.j41(40,"span",15),t.EFF(41),t.k0s(),t.j41(42,"span",16),t.nrm(43,"span",4),t.k0s()(),t.j41(44,"div",22)(45,"span",13),t.nrm(46,"img",23),t.EFF(47,":"),t.k0s(),t.j41(48,"span",15),t.EFF(49),t.k0s(),t.j41(50,"span",16),t.nrm(51,"span",4),t.k0s()()(),t.j41(52,"label",24)(53,"input",10),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.togglePlayerCount(n))}),t.k0s(),t.nrm(54,"span",4),t.nVh(55,PG,2,4,"input",25),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.vxM(e.gameManager.game.playerCount<1?1:-1),t.R7$(),t.vxM(e.gameManager.game.levelCalculation?2:-1),t.R7$(2),t.Y8G("ghs-label","settings.bonusAdjustment"),t.R7$(2),t.Y8G("model",e.gameManager.game.bonusAdjustment)("min",-6)("max",6),t.R7$(),t.vxM(e.ge5Player()?7:-1),t.R7$(),t.Y8G("ngClass",t.eq3(23,gG,e.gameManager.game.levelCalculation)),t.R7$(3),t.Dyx(e.levels),t.R7$(4),t.Y8G("checked",e.gameManager.game.solo),t.R7$(),t.Y8G("ghs-label","game.solo"),t.R7$(4),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/loot.svg",t.B4B),t.R7$(3),t.SpI("x",e.loot),t.R7$(2),t.Y8G("ghs-label","game.level.loot"),t.R7$(2),t.vxM(e.gameManager.trialsManager.activeFavor("fh","wealth")?27:-1),t.R7$(6),t.JRh(e.trap),t.R7$(2),t.Y8G("ghs-label","game.level.trap"),t.R7$(6),t.SpI("+",e.experience),t.R7$(2),t.Y8G("ghs-label","game.level.experience"),t.R7$(6),t.JRh(e.hazardousTerrain),t.R7$(2),t.Y8G("ghs-label","game.level.hazardousTerrain"),t.R7$(2),t.Y8G("checked",e.gameManager.game.playerCount>0),t.R7$(),t.Y8G("ghs-label","settings.playerCount"),t.R7$(),t.vxM(e.gameManager.game.playerCount>0?55:-1)}}function kG(i,r){1&i&&t.nrm(0,"img",34)}function yG(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",32),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.setBbMonsterDifficutly(n))}),t.nrm(1,"span",33),t.nVh(2,kG,1,0,"img",34),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ngClass",t.eq3(4,_G,a.gameManager.game.levelAdjustment+2==e)),t.R7$(),t.Y8G("ngClass",t.ziG(6,mG,0==e,1==e,3==e,4==e))("ghs-label","game.level.bb.monsterDifficulty."+e),t.R7$(),t.vxM(a.gameManager.game.levelAdjustment+2==e?2:-1)}}function xG(i,r){1&i&&(t.j41(0,"div",2)(1,"span",30),t.nrm(2,"img",31)(3,"span",4),t.EFF(4,":"),t.k0s(),t.Z7z(5,yG,3,11,"span",27,t.fX1),t.nI1(7,"ghsRange"),t.k0s()),2&i&&(t.R7$(3),t.Y8G("ghs-label","game.level.bb.monsterDifficulty"),t.R7$(2),t.Dyx(t.i5U(7,1,t.lJ4(4,hG),5)))}let EG=(()=>{class i{gameManager=s.E;settingsManager=m.f;trap=0;experience=0;loot=0;hazardousTerrain=0;levels=[0,1,2,3,4,5,6,7];ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.calculateValues()}}),this.calculateValues()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}setLevelCalculation(e){s.E.stateManager.before(e?"enableAutomaticLevel":"disabledAutomaticLevel"),s.E.game.levelCalculation=e,s.E.game.levelCalculation&&s.E.levelManager.calculateScenarioLevel(),s.E.stateManager.after()}setLevelAdjustment(e){s.E.stateManager.before("updateLevelAdjustment",(0,V.n1)(e)),s.E.game.levelAdjustment=e,s.E.game.levelCalculation&&s.E.levelManager.calculateScenarioLevel(),s.E.stateManager.after()}setBbMonsterDifficutly(e){s.E.stateManager.before("updateLevelAdjustmentBb",e),s.E.game.levelAdjustment=e-2;const a=s.E.editionData.find(n=>"bb"==n.edition&&n.monsterAmTables&&n.monsterAmTables.length);if(a){const n=s.E.levelManager.bbMonsterDifficutly();s.E.game.monsterAttackModifierDeck.attackModifiers=a.monsterAmTables[n].map(o=>new Y.uU(o)),s.E.game.monsterAttackModifierDeck.cards=a.monsterAmTables[n].map(o=>new Y.uU(o))}s.E.game.monsterAttackModifierDeck.bb=m.f.settings.bbAm,s.E.stateManager.after()}setBonusAdjustment(e){s.E.stateManager.before("updateBonusAdjustment",(0,V.n1)(e)),s.E.game.bonusAdjustment=e,s.E.game.levelCalculation&&s.E.levelManager.calculateScenarioLevel(),s.E.stateManager.after()}setGe5Player(e){s.E.stateManager.before(e?"enabledGe5Player":"disabledGe5Player"),s.E.game.ge5Player=e,s.E.game.levelCalculation&&s.E.levelManager.calculateScenarioLevel(),s.E.stateManager.after()}ge5Player(){return s.E.game.playerCount<1&&s.E.characterManager.characterCount()>4}togglePlayerCount(e){s.E.stateManager.before(e.target.checked?"enabledManualPlayerCount":"disabledManualPlayerCount"),s.E.game.playerCount=e.target.checked?2:-1,e.target.checked?s.E.game.levelCalculation=!1:s.E.game.levelCalculation&&s.E.levelManager.calculateScenarioLevel(),s.E.stateManager.after()}setPlayerCount(e){s.E.stateManager.before("updateManualPlayerCount",e),s.E.game.playerCount=e,s.E.game.levelCalculation&&s.E.levelManager.calculateScenarioLevel(),s.E.stateManager.after()}setLevel(e){s.E.stateManager.before("setScenarioLevel",""+e),s.E.levelManager.setLevel(e),s.E.game.levelCalculation=!1,s.E.stateManager.after()}setSolo(e){s.E.stateManager.before(e?"enableSolo":"disableSolo"),s.E.game.solo=e,s.E.stateManager.after()}calculateValues(){this.trap=s.E.levelManager.trap(),this.experience=s.E.levelManager.experience(),this.loot=s.E.levelManager.loot(),this.hazardousTerrain=s.E.levelManager.terrain(),s.E.trialsManager.activeFavor("fh","wealth")&&(this.loot+=s.E.trialsManager.activeFavor("fh","wealth"))}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-level-dialog"]],standalone:!1,decls:3,vars:5,consts:[["playerCount",""],[1,"level-dialog",3,"ngClass"],[1,"bb"],[1,"menu"],[3,"ghs-label"],[3,"modelChange","model","min","max"],[1,"level-container",3,"ngClass"],[1,"item"],["src","./assets/images/level.svg"],[1,"solo"],["tabclick","","type","checkbox",3,"change","checked"],[1,"values"],[1,"loot"],[1,"icon"],[1,"ghs-svg",3,"src"],[1,"value"],[1,"hint"],[3,"ghs-label","ghs-label-args"],[1,"trap"],["src","./assets/images/trap.svg",1,"ghs-svg"],[1,"experience"],["src","./assets/images/experience.svg",1,"ghs-svg"],[1,"terrain"],["src","./assets/images/terrain.svg",1,"ghs-svg"],[1,"player-count"],["tabclick","","type","number","min","1",3,"value","size","ghs-label","ghs-label-attribute"],["tabclick","",1,"level",3,"ngClass"],[1,"level",3,"ngClass"],["tabclick","",1,"level",3,"click","ngClass"],["tabclick","","type","number","min","1",3,"keyup","change","value","size","ghs-label","ghs-label-attribute"],[1,"title"],["src","./assets/images/bb/monster.svg",1,"ghs-svg"],[1,"level",3,"click","ngClass"],[1,"scenario-level",3,"ngClass","ghs-label"],["src","./assets/images/check.svg",1,"ghs-svg"]],template:function(a,n){1&a&&(t.j41(0,"div",1),t.nVh(1,bG,56,25),t.nVh(2,xG,8,5,"div",2),t.k0s()),2&a&&(t.Y8G("ngClass",t.eq3(3,lG,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.level)),t.R7$(),t.vxM(n.gameManager.bbRules()?-1:1),t.R7$(),t.vxM(n.gameManager.bbRules()?2:-1))},dependencies:[N.YU,tt,cG,At,Tt],styles:['.level-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column}.level-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;margin-bottom:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.level-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{width:2em}.level-dialog[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline)}.level-dialog[_ngcontent-%COMP%]   label.player-count[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor))}.level-dialog[_ngcontent-%COMP%]   span.item[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.level-dialog[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:auto}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor)));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) auto}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .level.scenariolevel[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) / 4) var(--ghs-color-darkgray) solid;border-radius:100%}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .level.active[_ngcontent-%COMP%]{pointer-events:none;border:calc(var(--ghs-unit) / 4) var(--ghs-color-white) solid;border-radius:100%}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.level-dialog[_ngcontent-%COMP%]   .level-container.disabled[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}.level-dialog[_ngcontent-%COMP%]   .level-container.disabled[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{pointer-events:none}.level-dialog[_ngcontent-%COMP%]   .level-container.disabled[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:not(.active){color:var(--ghs-color-darkgray)}.level-dialog[_ngcontent-%COMP%]   .solo[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.level-dialog[_ngcontent-%COMP%]   .solo[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.level-dialog[_ngcontent-%COMP%]   .solo[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{cursor:pointer;appearance:none;background-color:var(--form-background);width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));border-width:calc(var(--ghs-unit) * .3);border-style:solid;display:grid;place-content:center;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.level-dialog[_ngcontent-%COMP%]   .solo[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before{left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));position:relative;content:" ";width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));transform:scale(0);transform-origin:bottom left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;clip-path:polygon(14% 44%,0 65%,50% 100%,100% 16%,80% 0%,43% 62%);color:var(--ghs-color-gray);background-color:var(--ghs-color-gray)}.level-dialog[_ngcontent-%COMP%]   .solo[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked:before{transform:scale(1)}.level-dialog[_ngcontent-%COMP%]   .solo[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover:before{background-color:var(--ghs-color-white)}.level-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]{display:flex;flex-direction:column;color:var(--ghs-color-gray);font-size:1.6em;font-family:var(--ghs-font-normal)}.level-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:grid;grid-template-columns:.2fr .2fr 1fr;align-items:center;justify-content:center;margin-bottom:.2em}.level-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{text-align:center}.level-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{text-align:left}.level-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.level-dialog[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:1.3em;height:auto;filter:var(--ghs-filter-gray)}.level-dialog[_ngcontent-%COMP%]   .bb[_ngcontent-%COMP%]{display:flex;flex-direction:column;color:var(--ghs-color-gray);font-size:1.6em;font-family:var(--ghs-font-normal)}.level-dialog[_ngcontent-%COMP%]   .bb[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;align-items:center}.level-dialog[_ngcontent-%COMP%]   .bb[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-right:.5em;width:1.3em;height:auto;filter:var(--ghs-filter-gray)}.level-dialog[_ngcontent-%COMP%]   .bb[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;font-size:.8em;margin:.2em}.level-dialog[_ngcontent-%COMP%]   .bb[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{float:left;margin-left:.2em;width:1em;height:auto;filter:var(--ghs-filter-white)}.level-dialog[_ngcontent-%COMP%]   .bb[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]   .scenario-level[_ngcontent-%COMP%]{width:10em;text-align:center}.level-dialog[_ngcontent-%COMP%]   .bb[_ngcontent-%COMP%]   .level.current[_ngcontent-%COMP%]   .scenario-level[_ngcontent-%COMP%]{width:8.8em}.level-dialog[_ngcontent-%COMP%]   .bb[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover{opacity:.7}']})}return i})();const wG=["levelButton"];function RG(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",3),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.open())}),t.j41(1,"span",4),t.nrm(2,"img",5),t.EFF(3),t.k0s(),t.j41(4,"span",6),t.nrm(5,"img",7),t.EFF(6),t.k0s(),t.j41(7,"span",8),t.nrm(8,"img",9),t.EFF(9),t.k0s(),t.j41(10,"span",10),t.nrm(11,"img",11),t.EFF(12),t.k0s(),t.j41(13,"span",12),t.nrm(14,"img",13),t.j41(15,"span"),t.EFF(16),t.k0s()()()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","game.level")("ghs-label-attribute","title"),t.R7$(2),t.SpI(" ",e.gameManager.game.level),t.R7$(),t.Y8G("ghs-label","game.level.loot")("ghs-label-attribute","title"),t.R7$(),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/loot.svg",t.B4B),t.R7$(),t.SpI(" x",e.loot),t.R7$(),t.Y8G("ghs-label","game.level.trap")("ghs-label-attribute","title"),t.R7$(2),t.SpI(" ",e.trap),t.R7$(),t.Y8G("ghs-label","game.level.experience")("ghs-label-attribute","title"),t.R7$(2),t.SpI(" +",e.experience),t.R7$(),t.Y8G("ghs-label","game.level.hazardousTerrain")("ghs-label-attribute","title"),t.R7$(3),t.JRh(e.hazardousTerrain)}}function jG(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",3),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.open())}),t.j41(1,"span",14),t.nrm(2,"img",15)(3,"span",16),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","game.level.bb.monsterDifficulty")("ghs-label-attribute","title"),t.R7$(2),t.Y8G("ghs-label","game.level.bb.monsterDifficulty."+e.monsterDifficulty)}}let GG=(()=>{class i{dialog;overlay;levelButton;gameManager=s.E;settingsManager=m.f;trap=0;experience=0;loot=0;hazardousTerrain=0;monsterDifficulty=0;constructor(e,a){this.dialog=e,this.overlay=a}ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.calculateValues()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}open(){const e=[new zt.uH({originX:"center",originY:"top"},{overlayX:"center",overlayY:"bottom"}),new zt.uH({originX:"start",originY:"top"},{overlayX:"start",overlayY:"bottom"}),new zt.uH({originX:"end",originY:"top"},{overlayX:"end",overlayY:"bottom"})];this.dialog.open(EG,{panelClass:["dialog"],positionStrategy:this.overlay.position().flexibleConnectedTo(this.levelButton).withPositions(e).withDefaultOffsetY(-10)})}calculateValues(){this.trap=s.E.levelManager.trap(),this.experience=s.E.levelManager.experience(),this.loot=s.E.levelManager.loot(),this.hazardousTerrain=s.E.levelManager.terrain(),this.monsterDifficulty=s.E.levelManager.bbMonsterDifficutly(),s.E.trialsManager.activeFavor("fh","wealth")&&(this.loot+=s.E.trialsManager.activeFavor("fh","wealth"))}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG),t.rXU(zt.hJ))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-level"]],viewQuery:function(a,n){if(1&a&&t.GBs(wG,5),2&a){let o;t.mGM(o=t.lsd())&&(n.levelButton=o.first)}},standalone:!1,decls:4,vars:2,consts:[["levelButton",""],[1,"level-status"],[1,"values"],[1,"values",3,"click"],[1,"level",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/level.svg",1,"ghs-svg"],[1,"loot",3,"ghs-label","ghs-label-attribute"],[1,"ghs-svg",3,"src"],[1,"trap",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/trap.svg",1,"ghs-svg"],[1,"experience",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/experience.svg",1,"ghs-svg"],[1,"terrain",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/terrain.svg",1,"ghs-svg"],[3,"ghs-label","ghs-label-attribute"],["src","./assets/images/bb/monster.svg",1,"ghs-svg"],[3,"ghs-label"]],template:function(a,n){1&a&&(t.j41(0,"div",1,0),t.nVh(2,RG,17,16,"div",2),t.nVh(3,jG,4,3,"div",2),t.k0s()),2&a&&(t.R7$(2),t.vxM(n.gameManager.bbRules()?-1:2),t.R7$(),t.vxM(n.gameManager.bbRules()?3:-1))},dependencies:[tt],styles:[".level-status[_ngcontent-%COMP%]{position:relative;display:flex;height:100%;align-items:center;flex-direction:column;justify-content:space-evenly;text-align:center}.level-status[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]{cursor:pointer;display:flex;flex-wrap:wrap;align-items:center;width:100%;justify-content:center}.level-status[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-barsize));color:var(--ghs-color-gray);margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-barsize));text-shadow:var(--ghs-outline-thin)}.level-status[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-barsize));width:calc(var(--ghs-unit) * 3 * var(--ghs-barsize));height:auto;display:inline-block;filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.level-status[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.level-status[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}"]})}return i})();var xt=M(67114),an=M(98635);const TG=(i,r)=>({narrative:i,fh:r}),SG=(i,r)=>({"text-white":i,debug:r}),ar=(i,r)=>({"text-white":i,disabled:r}),$G=(i,r,e,a)=>({"text-white":i,inline:r,lowercase:e,disabled:a}),ji=i=>({"text-white":i}),DG=i=>[0,i],IG=()=>[];function AG(i,r){if(1&i&&(t.j41(0,"span",1),t.nrm(1,"span",3),t.k0s()),2&i){const e=t.XpG();t.Y8G("ngClass",t.l_i(3,SG,e.light,e.debug)),t.R7$(),t.Y8G("ngClass",t.l_i(6,ar,e.light,e.selected&&e.disabled))("ghs-label",e.conditionString)}}function VG(i,r){if(1&i&&t.nrm(0,"span",5),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(4,ji,e.light))("ghs-label","game.events.conditions."+e.conditionObject.type)("ghs-label-args",e.labelArgs)("slice",e.inline?t.eq3(6,DG,-1):t.lJ4(8,IG))}}function FG(i,r){if(1&i&&t.nrm(0,"span",3),2&i){const e=t.XpG(4);t.Y8G("ngClass",t.eq3(2,ji,e.light))("ghs-label","game.events.conditions.and")}}function XG(i,r){if(1&i&&(t.nVh(0,FG,1,4,"span",3),t.nrm(1,"ghs-event-card-condition",8)),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.vxM(a>0?0:-1),t.R7$(),t.Y8G("condition",e)("edition",n.edition)("eventType",n.eventType)("light",n.light)("inline",!0)("disabled",n.selected&&n.disabledConditions[a])("selected",n.selected)}}function BG(i,r){if(1&i&&(t.j41(0,"span",6),t.Z7z(1,XG,2,8,null,null,t.fX1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Dyx(e.conditions)}}function YG(i,r){if(1&i&&t.nrm(0,"span",9),2&i){const e=t.XpG().$index,a=t.XpG(3);t.Y8G("ngClass",t.l_i(2,ar,a.light,a.selected&&(a.disabledConditions[e-1]||a.disabledConditions[e])))("ghs-label","game.events.conditions.payCollectiveGoldConditional.connector")}}function NG(i,r){if(1&i&&(t.nVh(0,YG,1,5,"span",9),t.nrm(1,"ghs-event-card-condition",10)),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.vxM(a>0?0:-1),t.R7$(),t.Y8G("condition",e)("edition",n.edition)("eventType",n.eventType)("light",n.light)("inline",!0)("lowercase",!0)("disabled",n.selected&&n.disabledConditions[a])("selected",n.selected)}}function zG(i,r){if(1&i&&(t.j41(0,"span",7),t.nrm(1,"span",3),t.Z7z(2,NG,2,9,null,null,t.fX1),t.nrm(4,"span",3),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(4,ji,e.light))("ghs-label","game.events.conditions.payCollectiveGoldConditional.prefix"),t.R7$(),t.Dyx(e.conditions),t.R7$(2),t.Y8G("ngClass",t.eq3(6,ji,e.light))("ghs-label","game.events.conditions.payCollectiveGoldConditional.suffix")}}function LG(i,r){if(1&i&&(t.j41(0,"span",4),t.nVh(1,VG,1,9,"span",5),t.nVh(2,BG,3,0,"span",6),t.nVh(3,zG,5,8,"span",7),t.k0s()),2&i){const e=t.XpG();t.HbH(t.VkB("text ","condition-"+e.conditionObject.type)),t.Y8G("ngClass",t.ziG(7,$G,e.light,e.inline,e.lowercase,e.disabled)),t.R7$(),t.vxM(e.conditionObject.type&&-1==e.special.indexOf(e.conditionObject.type)?1:-1),t.R7$(),t.vxM("and"==e.conditionObject.type?2:-1),t.R7$(),t.vxM("payCollectiveGoldConditional"==e.conditionObject.type?3:-1)}}let $a=(()=>{class i{condition;edition;eventType;disabled=!1;narrative=!1;light=!0;inline=!1;lowercase=!1;selected=!1;debug=!1;conditionString;conditionObject;labelArgs=[];conditions=[];disabledConditions=[];special=[xt.iH.and,xt.iH.payCollectiveGoldConditional];ngOnInit(){if("string"==typeof this.condition)this.conditionString=this.condition;else if(this.condition){if(this.conditionObject=this.condition,this.labelArgs=this.conditionObject.values?this.conditionObject.values.filter(e=>"number"==typeof e||"string"==typeof e):[],this.conditions=this.conditionObject.values?this.conditionObject.values.filter(e=>"number"!=typeof e):[],this.conditions.forEach((e,a)=>{this.disabledConditions[a]=!s.E.eventCardManager.resolvableCondition(e)}),this.conditionObject.type===xt.iH.character&&(this.labelArgs=[this.labelArgs.map(e=>"%game.characterIcon."+e+"%").join("")]),this.conditionObject.type==xt.iH.building){let e="";this.conditionObject.values.filter(a=>"string"==typeof a).map(a=>"%game.fhIcon:"+a+"%").forEach((a,n,o)=>{e+=a,o.length>1&&(n<o.length-2?e+=", ":n<o.length-1&&(e+=" %and% "))}),this.labelArgs=[e]}if(this.conditionObject.type==xt.iH.traits){let e="";this.conditionObject.values.filter(a=>"string"==typeof a).map(a=>a in an.iq?"%character.class."+a+"%":"%data.character.traits."+a+"%").forEach((a,n,o)=>{e+=a,o.length>1&&(n<o.length-2?e+=", ":n<o.length-1&&(e+=" %or% "))}),this.labelArgs=[e]}this.labelArgs.push(this.edition)}}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-event-card-condition"]],inputs:{condition:"condition",edition:"edition",eventType:"eventType",disabled:"disabled",narrative:"narrative",light:"light",inline:"inline",lowercase:"lowercase",selected:"selected",debug:"debug"},standalone:!1,decls:3,vars:6,consts:[[1,"condition",3,"ngClass"],[1,"text",3,"ngClass"],[1,"condition-object",3,"class","ngClass"],[3,"ngClass","ghs-label"],[1,"condition-object",3,"ngClass"],[3,"ngClass","ghs-label","ghs-label-args","slice"],[1,"and-container"],[1,"conditional-container"],[3,"condition","edition","eventType","light","inline","disabled","selected"],[1,"inline",3,"ngClass","ghs-label"],[3,"condition","edition","eventType","light","inline","lowercase","disabled","selected"]],template:function(a,n){1&a&&(t.j41(0,"span",0),t.nVh(1,AG,2,9,"span",1),t.nVh(2,LG,4,12,"span",2),t.k0s()),2&a&&(t.Y8G("ngClass",t.l_i(3,TG,n.narrative,"fh"==n.edition)),t.R7$(),t.vxM(n.conditionString?1:-1),t.R7$(),t.vxM(n.conditionObject?2:-1))},dependencies:[N.YU,i,tt],styles:[".condition[_ngcontent-%COMP%]{font-family:var(--ghs-font-text)}.condition.fh[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-normal)}.condition[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{opacity:.4}.condition[_ngcontent-%COMP%]   .text.debug[_ngcontent-%COMP%]{color:red}.condition.narrative[_ngcontent-%COMP%]{font-style:italic;text-transform:uppercase}.condition.narrative[_ngcontent-%COMP%]   .condition-character[_ngcontent-%COMP%]{font-size:1.1em}.condition.narrative[_ngcontent-%COMP%]   .lowercase[_ngcontent-%COMP%]{text-transform:initial}.condition[_ngcontent-%COMP%]   .condition-object[_ngcontent-%COMP%]   .and-container[_ngcontent-%COMP%]   ghs-event-card-condition[_ngcontent-%COMP%], .condition[_ngcontent-%COMP%]   .condition-object[_ngcontent-%COMP%]   .conditional-container[_ngcontent-%COMP%]   ghs-event-card-condition[_ngcontent-%COMP%]{margin:0 .2em}"]})}return i})();const UG=(i,r,e,a)=>({fh:i,city:r,disabled:e,selected:a}),qG=(i,r,e)=>({concatenated:i,inline:r,debug:e}),Rn=i=>({"text-white":i}),HG=(i,r)=>({light:i,inline:r}),KG=(i,r)=>({"text-white":i,concatenated:r}),WG=i=>[0,i],JG=()=>[],ZG=i=>({"has-value":i}),QG=(i,r)=>({checked:i,light:r}),tT=i=>({light:i}),Da=(i,r)=>("object"==typeof r?r.type:r)+i;function eT(i,r){if(1&i&&(t.j41(0,"span",1),t.nrm(1,"span",3),t.k0s()),2&i){const e=t.XpG();t.Y8G("ngClass",t.sMw(3,qG,e.concatenated,e.inline,e.debug)),t.R7$(),t.Y8G("ngClass",t.eq3(7,Rn,e.light))("ghs-label",e.effectString)}}function nT(i,r){if(1&i&&t.nrm(0,"ghs-event-card-condition",4),2&i){const e=t.XpG(2);t.Y8G("condition",e.effectObject.condition)("edition",e.edition)("eventType",e.eventType)("light",e.light)}}function iT(i,r){1&i&&(t.j41(0,"span",5),t.EFF(1,":"),t.k0s())}function aT(i,r){if(1&i&&t.nrm(0,"span",6),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.l_i(4,KG,e.light,e.concatenated))("ghs-label","game.events.effects."+e.effectObject.type+(e.effectObject.alt?".alt":""))("ghs-label-args",e.labelArgs)("slice",e.concatenated?t.eq3(7,WG,-1):t.lJ4(9,JG))}}function oT(i,r){if(1&i&&t.nrm(0,"span",3),2&i){const e=t.XpG(4);t.Y8G("ngClass",t.eq3(2,Rn,e.light))("ghs-label","game.events.effects.choose.connector")}}function sT(i,r){if(1&i&&(t.nVh(0,oT,1,4,"span",3),t.nrm(1,"ghs-event-card-effect",12)),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.vxM(a>0?0:-1),t.R7$(),t.Y8G("effect",e)("edition",n.edition)("eventType",n.eventType)("light",n.light)("concatenated",!0)}}function rT(i,r){if(1&i&&(t.j41(0,"span",7),t.nrm(1,"span",3),t.Z7z(2,sT,2,6,null,null,Da),t.nrm(4,"span",3),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(4,Rn,e.light))("ghs-label","game.events.effects.choose.prefix"),t.R7$(),t.Dyx(e.effects),t.R7$(2),t.Y8G("ngClass",t.eq3(6,Rn,e.light))("ghs-label","game.events.effects.choose.suffix")}}function cT(i,r){if(1&i&&t.nrm(0,"ghs-event-card-effect",13),2&i){const e=t.XpG(3);t.Y8G("effect",e.effects[0])("edition",e.edition)("eventType",e.eventType)("light",e.light)("inline",!0)("concatenated",!0)("selected",e.selected)}}function lT(i,r){if(1&i&&(t.j41(0,"span",8),t.nrm(1,"span",3),t.nVh(2,cT,1,7,"ghs-event-card-effect",13),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(3,Rn,e.light))("ghs-label","game.events.effects.additionally"),t.R7$(),t.vxM(1==e.effects.length?2:-1)}}function gT(i,r){if(1&i&&t.nrm(0,"span",3),2&i){const e=t.XpG(4);t.Y8G("ngClass",t.eq3(2,Rn,e.light))("ghs-label","game.events.effects.and")}}function dT(i,r){if(1&i&&(t.nVh(0,gT,1,4,"span",3),t.nrm(1,"ghs-event-card-effect",14)),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.vxM(a>0?0:-1),t.R7$(),t.Y8G("effect",e)("edition",n.edition)("eventType",n.eventType)("light",n.light)("concatenated",!0)("selected",n.selected)}}function hT(i,r){if(1&i&&(t.j41(0,"span",9),t.Z7z(1,dT,2,7,null,null,Da),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Dyx(e.effects)}}function _T(i,r){if(1&i&&t.nrm(0,"ghs-event-card-effect",17),2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG(3);t.Y8G("effect",a)("edition",o.edition)("eventType",o.eventType)("light",o.light)("inline",!0)("selected",o.checks>n)}}function mT(i,r){if(1&i){const e=t.RV6();t.j41(0,"label",15)(1,"span",16),t.bIt("singleClick",function(){const n=t.eBV(e).$index,o=t.XpG(3);return t.Njj(o.check(n))}),t.k0s(),t.nVh(2,_T,1,6,"ghs-event-card-effect",17),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.Y8G("ngClass",t.eq3(3,ZG,e)),t.R7$(),t.Y8G("ngClass",t.l_i(5,QG,n.checks>a,n.light)),t.R7$(),t.vxM(e?2:-1)}}function pT(i,r){if(1&i&&(t.j41(0,"span",10),t.Z7z(1,mT,3,8,"label",15,Da),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Dyx(e.effects)}}function uT(i,r){if(1&i&&(t.j41(0,"span",11),t.nrm(1,"img",18),t.k0s()),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(2,tT,e.light))("ghs-tooltip","game.events.effects.automation")}}function fT(i,r){if(1&i&&(t.j41(0,"span",2),t.nVh(1,nT,1,4,"ghs-event-card-condition",4),t.nVh(2,iT,2,0,"span",5),t.nVh(3,aT,1,10,"span",6),t.nVh(4,rT,5,8,"span",7),t.nVh(5,lT,3,5,"span",8),t.nVh(6,hT,3,0,"span",9),t.nVh(7,pT,3,0,"span",10),t.nVh(8,uT,2,4,"span",11),t.k0s()),2&i){const e=t.XpG();t.Y8G("ngClass",t.l_i(9,HG,e.light,e.inline||e.concatenated)),t.R7$(),t.vxM(e.effectObject.condition?1:-1),t.R7$(),t.vxM(e.effectObject.condition?2:-1),t.R7$(),t.vxM(e.effectObject.type&&-1==e.special.indexOf(e.effectObject.type)?3:-1),t.R7$(),t.vxM("choose"==e.effectObject.type?4:-1),t.R7$(),t.vxM("additionally"==e.effectObject.type?5:-1),t.R7$(),t.vxM("and"==e.effectObject.type?6:-1),t.R7$(),t.vxM("checkbox"==e.effectObject.type?7:-1),t.R7$(),t.vxM(!e.concatenated&&e.settingsManager.settings.eventsApply&&e.applicable?8:-1)}}let Ia=(()=>{class i{effect;edition;eventType;light=!0;concatenated=!1;inline=!1;selected=!1;checks=0;debug=!1;onCheck=new t.bkB;effectString;effectObject;labelArgs=[];effects=[];disabled=!1;applicable=!1;settingsManager=m.f;special=[xt.Yj.additionally,xt.Yj.and,xt.Yj.checkbox,xt.Yj.choose];ngOnInit(){if("string"==typeof this.effect)this.effectString=this.effect;else if(this.effect){if(this.effectObject=this.effect,this.labelArgs=this.effectObject.values?this.effectObject.values.filter(e=>"number"==typeof e||"string"==typeof e):[],this.effects=this.effectObject.values?this.effectObject.values.filter(e=>"number"!=typeof e):[],this.applicable=s.E.eventCardManager.applicableEffect(this.effectObject),(this.effectObject.type==xt.Yj.and||this.effectObject.type==xt.Yj.additionally)&&(this.applicable=this.effects.some(e=>"object"==typeof e&&s.E.eventCardManager.applicableEffect(e))),this.disabled=this.effectObject.condition&&!s.E.eventCardManager.resolvableCondition(this.effectObject.condition)||!1,this.effectObject.type==xt.Yj.scenarioCondition){let e="";this.effectObject.values.filter(a=>"string"==typeof a).map(a=>{const n=a.split(":");return 2==n.length?"%game.condition."+n[0]+"% x"+n[1]:"%game.condition."+n[0]+"%"}).forEach((a,n,o)=>{e+=a,o.length>1&&(n<o.length-2?e+=", ":n<o.length-1&&(e+=" %and% "))}),this.labelArgs=[e]}this.labelArgs.push(this.edition)}}check(e){this.selected&&(this.checks=this.checks==e+1?e:e+1,this.onCheck.emit(this.checks))}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-event-card-effect"]],inputs:{effect:"effect",edition:"edition",eventType:"eventType",light:"light",concatenated:"concatenated",inline:"inline",selected:"selected",checks:"checks",debug:"debug"},outputs:{onCheck:"onCheck"},standalone:!1,decls:3,vars:8,consts:[[1,"effect",3,"ngClass"],[1,"text",3,"ngClass"],[1,"effect-object",3,"ngClass"],[3,"ngClass","ghs-label"],[3,"condition","edition","eventType","light"],[1,"condition-spacer"],[1,"text",3,"ngClass","ghs-label","ghs-label-args","slice"],[1,"choose-container"],[1,"additional-container"],[1,"and-container"],[1,"checkbox-container"],[1,"automation-icon",3,"ngClass","ghs-tooltip"],[3,"effect","edition","eventType","light","concatenated"],[3,"effect","edition","eventType","light","inline","concatenated","selected"],[3,"effect","edition","eventType","light","concatenated","selected"],[3,"ngClass"],["ghs-pointer-input","",1,"checkbox",3,"singleClick","ngClass"],[3,"effect","edition","eventType","light","inline","selected"],["src","./assets/images/automation.svg",1,"hint-trigger","ghs-svg"]],template:function(a,n){1&a&&(t.j41(0,"span",0),t.nVh(1,eT,2,9,"span",1),t.nVh(2,fT,9,12,"span",2),t.k0s()),2&a&&(t.Y8G("ngClass",t.ziG(3,UG,"fh"==n.edition,"city"==n.eventType,n.disabled,n.selected)),t.R7$(),t.vxM(n.effectString?1:-1),t.R7$(),t.vxM(n.effectObject?2:-1))},dependencies:[N.YU,$a,i,tt,ft,rt],styles:['.effect[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-weight:700;opacity:.7}.effect.selected[_ngcontent-%COMP%]{opacity:1}.effect.city[_ngcontent-%COMP%]{font-weight:400}.effect.fh[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-normal)}.effect.fh[_ngcontent-%COMP%]   ghs-event-card-condition[_ngcontent-%COMP%]{font-weight:400;font-style:italic;text-transform:uppercase}.effect.disabled[_ngcontent-%COMP%]{opacity:.5}.effect[_ngcontent-%COMP%]   .text.concatenated[_ngcontent-%COMP%]{display:inline}.effect[_ngcontent-%COMP%]   .text.concatenated[_ngcontent-%COMP%]:first-letter{text-transform:lowercase}.effect[_ngcontent-%COMP%]   .text.debug[_ngcontent-%COMP%]{color:red}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]{position:relative;display:block}.effect[_ngcontent-%COMP%]   .effect-object.inline[_ngcontent-%COMP%]{display:inline;margin-left:.1em}.effect[_ngcontent-%COMP%]   .effect-object.inline[_ngcontent-%COMP%]   .automation-icon[_ngcontent-%COMP%]{position:relative;top:.2em;left:initial;margin:0 .1em;transform:none}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .automation-icon[_ngcontent-%COMP%]{position:absolute;top:50%;left:-1.1em;display:inline-flex;width:.9em;height:.9em;transform:translateY(-50%)}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .automation-icon[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:100%;height:auto;filter:var(--ghs-filter-black);margin-left:0}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .automation-icon.light[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .automation-icon.light[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .condition-spacer[_ngcontent-%COMP%]{margin-right:.2em}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .choose-container[_ngcontent-%COMP%]   ghs-event-card-effect[_ngcontent-%COMP%]{font-size:.834em;margin:0 .2em}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .choose-container[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]:last-child{margin-left:-.2em}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .and-container[_ngcontent-%COMP%]   ghs-event-card-effect[_ngcontent-%COMP%]{margin:0 .2em}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .and-container[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]:last-child{margin-left:-.2em}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]{display:inline-flex;flex-wrap:wrap}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;justify-content:center;align-items:center;width:.8em;height:.8em;border:.15em solid var(--ghs-color-black);background-color:var(--ghs-color-white);border-radius:.1em;box-shadow:.15em .15em var(--ghs-color-gray);z-index:2;margin-right:.4em}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:before{content:" ";position:absolute;left:50%;top:50%;width:115%;height:115%;transform:scale(0);transform-origin:top left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;z-index:1;background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;filter:var(--ghs-filter-darkgray)}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .checkbox.checked[_ngcontent-%COMP%]:before{transform:scale(1) translate(-50%,-50%)}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .checkbox.checked.check[_ngcontent-%COMP%]:before{transform:scale(1)}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .checkbox.light[_ngcontent-%COMP%]{border:.1em solid var(--ghs-color-white);background-color:transparent}.effect[_ngcontent-%COMP%]   .effect-object[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .checkbox.light[_ngcontent-%COMP%]:before{filter:var(--ghs-filter-white)}']})}return i})();const CT=i=>({selected:i}),MT=i=>({light:i}),Aa=i=>({"text-white":i});function vT(i,r){if(1&i&&t.nrm(0,"span",6),2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(2,Aa,e.light))("ghs-label",e.attack.targetDescription)}}function OT(i,r){if(1&i&&t.nrm(0,"span",8),2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(2,Aa,e.light))("ghs-label",e.attack.narrative)}}function PT(i,r){if(1&i&&t.nrm(0,"ghs-event-card-effect",10),2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("effect",e)("edition",a.edition)("eventType",a.eventType)("light",a.light)("selected",!0)("debug",a.debug)}}function bT(i,r){if(1&i&&(t.j41(0,"div",9),t.Z7z(1,PT,1,6,"ghs-event-card-effect",10,t.fX1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.attack.effects)}}let Va=(()=>{class i{attack;edition;eventType;selected=!1;targetDescription=!0;narrative=!0;effects=!0;disabled=!1;light=!1;onToggle=new t.bkB;debug=!1;toggleSelected(){this.disabled||(this.selected=!this.selected,this.onToggle.emit(this.selected))}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-event-card-attack"]],inputs:{attack:"attack",edition:"edition",eventType:"eventType",selected:"selected",targetDescription:"targetDescription",narrative:"narrative",effects:"effects",disabled:"disabled",light:"light",debug:"debug"},outputs:{onToggle:"onToggle"},standalone:!1,decls:12,vars:14,consts:[["ghs-pointer-input","",1,"attack",3,"doubleClick","ngClass"],[1,"main",3,"ngClass"],[1,"attack-value"],["src","./assets/images/fh/action/attack.svg"],[1,"target-number"],["src","./assets/images/fh/action/target.svg"],[1,"target-description",3,"ngClass","ghs-label"],[1,"text",3,"ngClass"],[1,"text",3,"ngClass","ghs-label"],[1,"effects"],[3,"effect","edition","eventType","light","selected","debug"]],template:function(a,n){1&a&&(t.j41(0,"span",0),t.bIt("doubleClick",function(){return n.toggleSelected()}),t.j41(1,"div",1)(2,"span",2),t.nrm(3,"img",3),t.EFF(4),t.k0s(),t.j41(5,"span",4),t.nrm(6,"img",5),t.EFF(7),t.k0s()(),t.nVh(8,vT,1,4,"span",6),t.j41(9,"span",7),t.nVh(10,OT,1,4,"span",8),t.k0s(),t.nVh(11,bT,3,0,"div",9),t.k0s()),2&a&&(t.Y8G("ngClass",t.eq3(8,CT,n.selected)),t.R7$(),t.Y8G("ngClass",t.eq3(10,MT,n.light)),t.R7$(3),t.JRh(n.attack.attackValue),t.R7$(3),t.JRh(n.attack.targetNumber),t.R7$(),t.vxM(n.targetDescription&&n.attack.targetDescription?8:-1),t.R7$(),t.Y8G("ngClass",t.eq3(12,Aa,n.light)),t.R7$(),t.vxM(n.narrative&&n.attack.narrative?10:-1),t.R7$(),t.vxM(n.effects&&n.attack.effects?11:-1))},dependencies:[N.YU,Ia,tt,rt],styles:[".attack[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;opacity:.5}.attack.selected[_ngcontent-%COMP%]{opacity:1}.attack[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.attack[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .attack-value[_ngcontent-%COMP%], .attack[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .target-number[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-fh-normal);font-weight:700;margin:.3em}.attack[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .attack-value[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .attack[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .target-number[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:.9em;width:auto}.attack[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .attack-value.attack-value[_ngcontent-%COMP%], .attack[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .target-number.attack-value[_ngcontent-%COMP%]{font-size:2.5em}.attack[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .attack-value.target-number[_ngcontent-%COMP%], .attack[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .target-number.target-number[_ngcontent-%COMP%]{font-size:1.6em}.attack[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .attack-value.target-number[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .attack[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .target-number.target-number[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-right:.1em}.attack[_ngcontent-%COMP%]   .main.light[_ngcontent-%COMP%]   .attack-value[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .attack[_ngcontent-%COMP%]   .main.light[_ngcontent-%COMP%]   .target-number[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.attack[_ngcontent-%COMP%]   .target-description[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-normal);font-weight:700;text-align:center}.attack[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-normal);font-style:italic;margin:.5em 0}.attack[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]{align-self:flex-start}"]})}return i})();const kT=(i,r,e)=>({flipped:i,disabled:r,"show-debug":e}),yT=i=>({spoiler:i}),xT=i=>({single:i}),Fa=i=>[i],Xa=i=>({light:i}),ET=i=>({"no-label":i}),wT=(i,r,e,a)=>({selected:i,single:r,"no-label":e,attack:a}),RT=(i,r,e,a)=>({selected:i,disabled:r,"expand-to-bottom":e,margin:a}),jT=(i,r)=>({"text-white":i,inline:r}),GT=i=>({inline:i}),or=(i,r)=>(r.label||"")+i,TT=(i,r)=>("object"==typeof r?r.type:r)+i;function ST(i,r){if(1&i&&t.nrm(0,"span",15),2&i){const e=t.XpG(2).$implicit;t.Y8G("ghs-label","game.events.option")("ghs-label-args",t.eq3(2,Fa,e.label))}}function $T(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",14),t.bIt("singleClick",function(n){t.eBV(e);const o=t.XpG().$index,g=t.XpG(2);return t.Njj(g.selectOption(o,!1,n))}),t.nVh(1,ST,1,4,"span",15),t.nrm(2,"span",16),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.Y8G("ngClass",t.eq3(3,xT,1==a.event.options.length||!e.label)),t.R7$(),t.vxM(e.label?1:-1),t.R7$(),t.Y8G("ghs-label",e.narrative)}}function DT(i,r){1&i&&t.nVh(0,$T,3,5,"div",13),2&i&&t.vxM(r.$implicit.narrative?0:-1)}function IT(i,r){if(1&i&&(t.j41(0,"div",10),t.nrm(1,"span",17)(2,"span",17),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","game.events.requirements")("ghs-label-args",t.eq3(4,Fa,e.event.requirement.partyAchievement)),t.R7$(),t.Y8G("ghs-label","game.events.requirements.partyAchievement")("ghs-label-args",t.eq3(6,Fa,e.event.requirement.partyAchievement))}}function AT(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",11)(1,"a",18),t.bIt("singleClick",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.setSpoilerFree(!1,n))}),t.EFF(2),t.k0s()()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Xa,e.light)),t.R7$(2),t.JRh(e.event.cardId)}}function VT(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",6)(1,"div",7),t.nrm(2,"div",8),t.j41(3,"div",9),t.Z7z(4,DT,1,1,null,null,or),t.k0s()(),t.nVh(6,IT,3,8,"div",10),t.k0s(),t.nVh(7,AT,3,4,"div",11),t.j41(8,"div",12),t.bIt("singleClick",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setSpoilerFree(!0,n))}),t.EFF(9),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(5,yT,e.spoilerFree)),t.R7$(2),t.Y8G("ghs-label",e.event.narrative),t.R7$(2),t.Dyx(e.event.options),t.R7$(2),t.vxM(e.event.requirement&&e.event.requirement.partyAchievement?6:-1),t.R7$(),t.vxM(e.spoilerFree?7:-1),t.R7$(2),t.SpI("",e.event.cardId," ")}}function FT(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",19),t.bIt("singleClick",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.toggleShowDebug(n))}),t.nrm(1,"img",20),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(1,Xa,e.light))}}function XT(i,r){if(1&i&&t.nrm(0,"ghs-event-card-condition",27),2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG().$index,g=t.XpG(2);t.Y8G("condition",a.condition)("narrative",!0)("edition",g.event.edition)("eventType",g.event.type)("light",g.light)("selected",-1==g.selected&&g.flipped||g.selected==o&&-1!=g.subSelections.indexOf(n))("debug",g.debug)}}function BT(i,r){1&i&&(t.j41(0,"span",28),t.EFF(1,":"),t.k0s())}function YT(i,r){if(1&i&&t.nrm(0,"span",29),2&i){const e=t.XpG().$implicit,a=t.XpG(3);t.Y8G("ngClass",t.l_i(2,jT,a.light,e.inlineEffects&&e.effects.length))("ghs-label",e.narrative)}}function NT(i,r){if(1&i&&t.nrm(0,"ghs-event-card-effect",33),2&i){const e=r.$implicit,a=t.XpG(2),n=a.$implicit,o=a.$index,g=t.XpG().$index,_=t.XpG(2);t.Y8G("effect",e)("edition",_.event.edition)("eventType",_.event.type)("light",_.light)("selected",-1==_.selected&&_.flipped||_.selected==g&&-1!=_.subSelections.indexOf(o))("inline",n.inlineEffects||!1)("debug",_.debug)}}function zT(i,r){if(1&i&&(t.j41(0,"div",30),t.Z7z(1,NT,1,7,"ghs-event-card-effect",33,TT),t.k0s()),2&i){const e=t.XpG().$implicit;t.Y8G("ngClass",t.eq3(1,GT,e.inlineEffects)),t.R7$(),t.Dyx(e.effects)}}function LT(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-event-card-attack",34),t.bIt("onToggle",function(n){t.eBV(e);const o=t.XpG(4);return t.Njj(o.toggleAttack(n))}),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG(3);t.Y8G("attack",e.attack)("edition",a.event.edition)("eventType",a.event.type)("light",a.light)("selected",a.attack)("debug",a.debug)}}function UT(i,r){1&i&&t.nrm(0,"img",35)}function qT(i,r){1&i&&t.nrm(0,"img",36)}function HT(i,r){if(1&i&&(t.j41(0,"div",32),t.nVh(1,UT,1,0,"img",35),t.nVh(2,qT,1,0,"img",36),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG().$implicit;t.R7$(),t.vxM(e.returnToDeck||a.returnToDeck?1:-1),t.R7$(),t.vxM(e.removeFromDeck||a.removeFromDeck?2:-1)}}function KT(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",26),t.bIt("singleClick",function(n){const o=t.eBV(e).$index,g=t.XpG().$index,_=t.XpG(2);return t.Njj(_.selectSub(g,o,n))})("doubleClick",function(n){const o=t.eBV(e).$index,g=t.XpG().$index,_=t.XpG(2);return t.Njj(_.selectSub(g,o,!0,n))}),t.nVh(1,XT,1,7,"ghs-event-card-condition",27),t.nVh(2,BT,2,0,"span",28),t.nVh(3,YT,1,5,"span",29),t.nVh(4,zT,3,3,"div",30),t.nVh(5,LT,1,6,"ghs-event-card-attack",31),t.nVh(6,HT,3,2,"div",32),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(),o=n.$implicit,g=n.$index,_=t.XpG(2);t.Y8G("ngClass",t.ziG(7,RT,-1!=_.subSelections.indexOf(a)||-1==_.selected&&_.flipped||!o.label&&e.attack,_.resolvable[g]&&0==_.resolvable[g][a]&&-1==_.subSelections.indexOf(a)&&-1!=_.selected,a==o.outcomes.length-1&&(o.returnToDeck||o.removeFromDeck),e.condition||e.narrative)),t.R7$(),t.vxM(e.condition?1:-1),t.R7$(),t.vxM(e.condition?2:-1),t.R7$(),t.vxM(e.narrative?3:-1),t.R7$(),t.vxM(e.effects&&e.effects.length?4:-1),t.R7$(),t.vxM(e.attack?5:-1),t.R7$(),t.vxM(e.returnToDeck||e.removeFromDeck||a==o.outcomes.length-1&&(o.returnToDeck||o.removeFromDeck)?6:-1)}}function WT(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",24),t.bIt("doubleClick",function(n){const o=t.eBV(e).$index,g=t.XpG(2);return t.Njj(g.selectOption(g.selected==o?-1:o,!1,n))}),t.Z7z(1,KT,7,12,"div",25,t.Vm6),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.HbH(t.ai1("option ","option-"+(e.label||"no-label")," ","option-bg-"+(n.event.options.length-a))),t.Y8G("ngClass",t.ziG(5,wT,!e.label||n.selected==a||-1==n.selected&&n.flipped,1==n.event.options.length,!e.label,n.attackIndex==a)),t.R7$(),t.Dyx(e.outcomes)}}function JT(i,r){if(1&i&&(t.j41(0,"div",21),t.Z7z(1,WT,3,10,"div",22,or),t.k0s(),t.j41(3,"div",23),t.EFF(4),t.k0s()),2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(2,ET,e.noLabel)),t.R7$(),t.Dyx(e.event.options),t.R7$(3),t.JRh(e.event.cardId)}}function ZT(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",19),t.bIt("singleClick",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.toggleShowDebug(n))}),t.nrm(1,"img",20),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(1,Xa,e.light))}}let Gi=(()=>{class i{gameManager=s.E;settingsManager=m.f;event;identifier;select=-1;subSelect=[];checks=[];flipped=!1;disabled=!1;spoiler=!1;debug=!1;onSelect=new t.bkB;selected=-1;subSelections=[];attackIndex=-1;attack=!1;light=!1;spoilerFree=!1;noLabel=!1;resolvable=[];showDebug=!1;ngOnInit(){this.event&&(this.event.options.forEach((e,a)=>{e.outcomes&&(this.resolvable[a]=this.resolvable[a]||[],e.outcomes.forEach((n,o)=>{this.resolvable[a][o]=!n.condition||!!n.condition&&s.E.eventCardManager.resolvableCondition(n.condition),n.attack&&(this.attackIndex=a,this.attack=!0)}))}),this.noLabel=this.event.options.every(e=>!e.label)),this.spoilerFree=this.spoiler,this.selected=this.select,this.subSelections=this.subSelect}ngOnChanges(e){e.identifier&&e.identifier.previousValue!=e.identifier.currentValue?!this.event&&this.identifier&&(this.event=s.E.eventCardManager.getEventCardForEdition(this.identifier.edition,this.identifier.type,this.identifier.cardId),this.event&&(this.selected=this.identifier.selected,this.subSelections=this.identifier.subSelections)):e.select&&e.select.previousValue!=e.select.currentValue&&this.selected!=this.select?this.selectOption(this.select,!0):e.spoiler&&e.spoiler.previousValue!=e.spoiler.currentValue&&(this.spoilerFree=this.spoiler),this.light=this.event&&-1!=["city"].indexOf(this.event.type)||!1}selectOption(e,a,n=void 0){-1!=this.attackIndex&&this.attackIndex==e||(this.event&&!this.disabled&&this.selected!=e&&(this.attack=-1!=this.attackIndex,this.selected=e,this.subSelections=[],this.selected<-1&&(this.selected=-1),this.subSelections=[],e>-1&&this.event.options[e]&&this.event.options[e].outcomes.forEach((o,g)=>{this.resolvable[e]&&this.resolvable[e][g]&&("string"!=typeof o.condition&&o.condition&&o.condition.type===xt.iH.otherwise&&this.resolvable[e].some((_,y)=>this.event&&_&&y<g&&!!this.event.options[e].outcomes[y].condition)||this.subSelections.push(g),-1!=this.subSelections.indexOf(g)&&o.effects&&o.effects.some(_=>"object"==typeof _&&_.type==xt.Yj.skipThreat)&&(this.attack=!1))}),a||this.onSelect.emit(new xt.Qc(this.event.cardId,this.event.edition,this.event.type,this.selected,this.subSelections,this.checks,this.attack,!1)),this.event.options[e]&&!this.event.options[e].label&&(this.flipped=!0,this.selected=-1)),n&&n.preventDefault())}selectSub(e,a,n=!1,o=void 0){if(-1==this.attackIndex||this.attackIndex!=a){if(this.event&&!this.disabled&&this.selected==e){if(-1!=this.subSelections.indexOf(a))this.subSelections.splice(this.subSelections.indexOf(a),1);else if((this.resolvable[this.selected]&&this.resolvable[this.selected][a]||n)&&(this.subSelections.push(a),!n)){const g=this.event.options[this.selected].outcomes[a].condition;if(g&&"string"!=typeof g&&g.type==xt.iH.otherwise)this.subSelections=[a];else{const _=this.event.options[this.selected].outcomes.find(y=>y.condition&&"string"!=typeof y.condition&&y.condition.type==xt.iH.otherwise);_&&(this.subSelections=this.subSelections.splice(this.event.options[this.selected].outcomes.indexOf(_),1))}}this.onSelect.emit(new xt.Qc(this.event.cardId,this.event.edition,this.event.type,this.selected,this.subSelections,this.checks,this.attack,!1))}else n&&this.selectOption(e,!1);o&&o.preventDefault()}}toggleAttack(e){this.attack=e,this.event&&this.onSelect.emit(new xt.Qc(this.event.cardId,this.event.edition,this.event.type,this.selected,this.subSelections,this.checks,this.attack,!1))}setSpoilerFree(e,a=void 0){this.spoilerFree=e,a&&a.preventDefault()}toggleShowDebug(e=void 0){this.showDebug=!this.showDebug,e&&e.preventDefault()}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-event-card"]],inputs:{event:"event",identifier:"identifier",select:"select",subSelect:"subSelect",checks:"checks",flipped:"flipped",disabled:"disabled",spoiler:"spoiler",debug:"debug"},outputs:{onSelect:"onSelect"},standalone:!1,features:[t.OA$],decls:9,vars:20,consts:[["container",""],[1,"event-card-container"],[3,"ngClass"],[1,"card-back",3,"ngClass"],["ghs-pointer-input","",1,"show-debug-toggle",3,"ngClass"],[1,"card-front",3,"ngClass"],[1,"wrapper",3,"ngClass"],[1,"content"],[1,"text","placeholder",3,"ghs-label"],[1,"options"],[1,"requirement","party-achievement"],[1,"spoiler-free",3,"ngClass"],["ghs-pointer-input","",1,"card-id",3,"singleClick"],["ghs-pointer-input","",1,"option",3,"ngClass"],["ghs-pointer-input","",1,"option",3,"singleClick","ngClass"],[1,"title",3,"ghs-label","ghs-label-args"],[1,"choice",3,"ghs-label"],[3,"ghs-label","ghs-label-args"],["ghs-pointer-input","",3,"singleClick"],["ghs-pointer-input","",1,"show-debug-toggle",3,"singleClick","ngClass"],["src","./assets/images/debug.svg"],[1,"options",3,"ngClass"],["ghs-pointer-input","",3,"class","ngClass"],[1,"card-id"],["ghs-pointer-input","",3,"doubleClick","ngClass"],["ghs-pointer-input","",1,"outcome",3,"ngClass"],["ghs-pointer-input","",1,"outcome",3,"singleClick","doubleClick","ngClass"],[3,"condition","narrative","edition","eventType","light","selected","debug"],[1,"condition-spacer"],[1,"text",3,"ngClass","ghs-label"],[1,"effects",3,"ngClass"],[3,"attack","edition","eventType","light","selected","debug"],[1,"card-action"],[3,"effect","edition","eventType","light","selected","inline","debug"],[3,"onToggle","attack","edition","eventType","light","selected","debug"],["src","./assets/images/eventcards/return.svg",1,"ghs-svg"],["src","./assets/images/eventcards/remove.svg",1,"ghs-svg"]],template:function(a,n){if(1&a&&(t.j41(0,"div",1,0)(2,"div",2)(3,"div",3),t.nVh(4,VT,10,7),t.nVh(5,FT,2,3,"div",4),t.k0s(),t.j41(6,"div",5),t.nVh(7,JT,5,4),t.nVh(8,ZT,2,3,"div",4),t.k0s()()()),2&a){const o=t.sdS(1);t.R7$(2),t.HbH(t.VkB("card vertical reverse event ",n.selected)),t.xc7("font-size",.07*o.offsetWidth+"px"),t.Y8G("ngClass",t.sMw(16,kT,-1!=n.selected||n.flipped&&!n.spoilerFree,n.disabled,n.showDebug)),t.R7$(),t.xc7("background-image",n.showDebug&&n.event?"url('./assets/artwork/events/debug/"+n.event.edition+"/"+n.event.type+"/"+n.event.cardId+"-back.png')":""),t.Y8G("ngClass",n.event?n.event.type:""),t.R7$(),t.vxM(n.event?4:-1),t.R7$(),t.vxM(n.settingsManager.settings.debugEventCards?5:-1),t.R7$(),t.xc7("background-image",n.showDebug&&n.event?"url('./assets/artwork/events/debug/"+n.event.edition+"/"+n.event.type+"/"+n.event.cardId+"-front.png')":""),t.Y8G("ngClass",n.event?n.event.type:""),t.R7$(),t.vxM(n.event?7:-1),t.R7$(),t.vxM(n.settingsManager.settings.debugEventCards?8:-1)}},dependencies:[N.YU,Va,$a,Ia,tt,rt],styles:['.event-card-container[_ngcontent-%COMP%]{position:relative;width:100%;padding-bottom:147%}.event[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;border:.2em solid transparent;border-radius:.5em}.event.show-debug[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%], .event.show-debug[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event.show-debug[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%], .event.show-debug[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%], .event.show-debug[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event.show-debug[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]{display:none}.event[_ngcontent-%COMP%]   .show-debug-toggle[_ngcontent-%COMP%]{display:block;position:absolute;bottom:.1em;left:50%;transform:translate(-50%);width:.8em;height:.8em;cursor:help;z-index:999}.event[_ngcontent-%COMP%]   .show-debug-toggle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:block;width:100%;height:auto}.event[_ngcontent-%COMP%]   .show-debug-toggle.light[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]{background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:.5em;background-color:var(--ghs-color-lightgray)}.event[_ngcontent-%COMP%]   .card-front.city[_ngcontent-%COMP%]{background-image:url(city-front.72f7a8a684e5519e.png);color:var(--ghs-color-white)}.event[_ngcontent-%COMP%]   .card-front.city[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.event[_ngcontent-%COMP%]   .card-front.city[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.event[_ngcontent-%COMP%]   .card-front.road[_ngcontent-%COMP%]{background-image:url(road-front.b4152d88c7f5410f.png);color:var(--ghs-color-darkgray)}.event[_ngcontent-%COMP%]   .card-front.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before{color:var(--ghs-color-brown)}.event[_ngcontent-%COMP%]   .card-front.road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(2):before{filter:grayscale(.7)}.event[_ngcontent-%COMP%]   .card-front.rift[_ngcontent-%COMP%]{background-image:url(rift-front.958e71aca4e5e468.png);color:var(--ghs-color-darkgray)}.event[_ngcontent-%COMP%]   .card-front.rift[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before{color:var(--ghs-color-purple);filter:brightness(.5)}.event[_ngcontent-%COMP%]   .card-front.rift[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(2):before{filter:brightness(.5) grayscale(.6)}.event[_ngcontent-%COMP%]   .card-front.rift[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-black)}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]{padding-left:2.5em;padding-right:1em;padding-top:.5em;font-size:.65em;max-height:initial}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before{z-index:1;font-family:var(--ghs-font-fh-text);font-size:1.6em;left:.5em;top:.7em}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:first-child, .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:first-child, .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:first-child, .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:first-child, .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:first-child{padding-top:1em}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(2):before, .event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(3):before, .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(2):before, .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(3):before, .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(2):before, .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(3):before, .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(2):before, .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(3):before, .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(2):before, .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:nth-child(3):before{top:.4em}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.no-label[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.no-label[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.no-label[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.no-label[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.no-label[_ngcontent-%COMP%]:before{display:none}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:-1em;left:0;width:100%;height:calc(100% + 1em);background-color:#c5cdcc;-webkit-mask:url(fh-option-2-mask.29440ac7bef2beb4.png) no-repeat;mask:url(fh-option-2-mask.29440ac7bef2beb4.png) no-repeat;-webkit-mask-size:100% auto;mask-size:100% auto;-webkit-mask-position:center bottom;mask-position:center bottom;z-index:0;filter:brightness(1.2)}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]{padding-bottom:.5em}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%]{top:-1em;padding-top:1.5em;padding-bottom:.5em}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%]:before{top:1em}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%] + .option-bg-1[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%] + .option-bg-1[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%] + .option-bg-1[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%] + .option-bg-1[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%] + .option-bg-2[_ngcontent-%COMP%] + .option-bg-1[_ngcontent-%COMP%]{margin-top:-1.5em}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:0;left:0;width:100%;height:100%;background-color:#9ea5a4;-webkit-mask:url(fh-option-3-mask.d56ca294e38ee47b.png) no-repeat;mask:url(fh-option-3-mask.d56ca294e38ee47b.png) no-repeat;-webkit-mask-size:100% auto;mask-size:100% auto;-webkit-mask-position:center bottom;mask-position:center bottom;z-index:0;filter:brightness(1.4)}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected.option-bg-3[_ngcontent-%COMP%]:after{filter:none}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]{z-index:1}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-normal)}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   ghs-event-card-effect[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   ghs-event-card-effect[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   ghs-event-card-effect[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   ghs-event-card-effect[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   ghs-event-card-effect[_ngcontent-%COMP%]{font-size:.96em;margin-bottom:.1em}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%]{right:-.5em;bottom:-.5em}.event[_ngcontent-%COMP%]   .card-front.boat[_ngcontent-%COMP%]   .options.no-label[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-road[_ngcontent-%COMP%]   .options.no-label[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-road[_ngcontent-%COMP%]   .options.no-label[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.winter-outpost[_ngcontent-%COMP%]   .options.no-label[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-front.summer-outpost[_ngcontent-%COMP%]   .options.no-label[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]{padding-left:1.5em}.event[_ngcontent-%COMP%]   .card-front.boat.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after{background-color:#d1ded8}.event[_ngcontent-%COMP%]   .card-front.boat.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost.boat[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after{background-color:#a3bdb1}.event[_ngcontent-%COMP%]   .card-front.boat.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.boat.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-2[_ngcontent-%COMP%]:after{background-color:#e5ded3}.event[_ngcontent-%COMP%]   .card-front.boat.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.boat.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-road.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-road.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.winter-outpost.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost.summer-outpost[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after, .event[_ngcontent-%COMP%]   .card-front.summer-outpost.summer-road[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-bg-3[_ngcontent-%COMP%]:after{background-color:#b5a281}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:flex-start;width:100%;height:100%}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;font-size:.6em;line-height:.9em;letter-spacing:-.01em;padding-top:1.5em;padding-left:4em;padding-right:2em;overflow:auto;max-height:50%;flex:1 1 auto}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.single[_ngcontent-%COMP%]{max-height:100%;padding-left:2em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.single[_ngcontent-%COMP%]:before{display:none}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:first-child{padding-top:2em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:before{position:absolute;left:1em;top:1.5em;font-family:var(--ghs-font-title);font-size:2em;opacity:.3}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-A[_ngcontent-%COMP%]{z-index:3}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-A[_ngcontent-%COMP%]:before{content:"A."}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-B[_ngcontent-%COMP%]{z-index:2}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-B[_ngcontent-%COMP%]:before{content:"B.";top:1em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-C[_ngcontent-%COMP%]{z-index:1}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.option-C[_ngcontent-%COMP%]:before{content:"C.";top:1em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]{position:relative;filter:grayscale(.7);opacity:.3}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome.margin[_ngcontent-%COMP%]{margin-bottom:.5em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome.expand-to-bottom[_ngcontent-%COMP%]{flex-grow:1}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   ghs-event-card-condition[_ngcontent-%COMP%]{margin-right:.1em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .condition-spacer[_ngcontent-%COMP%]{margin-right:.2em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-style:italic;margin-bottom:.5em;letter-spacing:-.03em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .text.inline[_ngcontent-%COMP%]{margin-right:.2em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin-top:.5em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   ghs-event-card-effect[_ngcontent-%COMP%]{font-size:1.2em;display:flex;position:relative;width:100%;margin-bottom:.4em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .effects.inline[_ngcontent-%COMP%]{display:inline;margin-top:0}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .effects.inline[_ngcontent-%COMP%]   ghs-event-card-effect[_ngcontent-%COMP%]{display:inline;width:auto;margin-bottom:0}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%]{position:absolute;bottom:0;right:-1em}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:2em;height:auto}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:hover:not(.selected):before, .event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:hover:not(.selected)   .outcome[_ngcontent-%COMP%]{opacity:.7}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected[_ngcontent-%COMP%]{filter:none}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected[_ngcontent-%COMP%]:before{opacity:1}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]{filter:none;cursor:pointer;opacity:1}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected[_ngcontent-%COMP%]   .outcome.selected[_ngcontent-%COMP%]{opacity:1}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected[_ngcontent-%COMP%]   .outcome.disabled[_ngcontent-%COMP%]{opacity:.5;cursor:not-allowed}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.selected[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]:hover{opacity:.8}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.attack[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]{cursor:initial}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.attack[_ngcontent-%COMP%]   .outcome[_ngcontent-%COMP%]:hover{opacity:initial}.event[_ngcontent-%COMP%]   .card-front[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{position:absolute;font-size:.5em;bottom:0;right:.5em}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]{background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:.5em;background-color:var(--ghs-color-lightgray)}.event[_ngcontent-%COMP%]   .card-back.city[_ngcontent-%COMP%]{background-image:url(city-back.76f420e28fe4e8ae.png);color:var(--ghs-color-white)}.event[_ngcontent-%COMP%]   .card-back.city[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before{filter:none}.event[_ngcontent-%COMP%]   .card-back.city[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.event[_ngcontent-%COMP%]   .card-back.road[_ngcontent-%COMP%]{background-image:url(road-back.1c00d9852038e905.png);color:var(--ghs-color-darkgray)}.event[_ngcontent-%COMP%]   .card-back.road[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.event[_ngcontent-%COMP%]   .card-back.rift[_ngcontent-%COMP%]{background-image:url(rift-back.726d02a7f4704dce.png);color:var(--ghs-color-darkgray)}.event[_ngcontent-%COMP%]   .card-back.rift[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .requirement[_ngcontent-%COMP%]{background-image:url(rift-requirement.134b7a3d05ada5e4.png)}.event[_ngcontent-%COMP%]   .card-back.rift[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.event[_ngcontent-%COMP%]   .card-back.boat[_ngcontent-%COMP%]{background-image:url(boat-back.a728bbf99ac0d75a.png)}.event[_ngcontent-%COMP%]   .card-back.winter-road[_ngcontent-%COMP%]{background-image:url(winter-road-back.4f4ee110f797d4c6.png)}.event[_ngcontent-%COMP%]   .card-back.summer-road[_ngcontent-%COMP%]{background-image:url(summer-road-back.5cc710f4ef0f36c9.png)}.event[_ngcontent-%COMP%]   .card-back.summer-outpost[_ngcontent-%COMP%]{background-image:url(summer-outpost-back.8c9fa7a4ca8bc325.png)}.event[_ngcontent-%COMP%]   .card-back.winter-outpost[_ngcontent-%COMP%]{background-image:url(winter-outpost-back.16845c4c5fde4961.png)}.event[_ngcontent-%COMP%]   .card-back.boat[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.winter-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.summer-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]:before{display:none}.event[_ngcontent-%COMP%]   .card-back.boat[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:5% 10% 0}.event[_ngcontent-%COMP%]   .card-back.boat[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.winter-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.summer-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]:before{display:none}.event[_ngcontent-%COMP%]   .card-back.boat[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-normal)}.event[_ngcontent-%COMP%]   .card-back.boat[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.winter-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.summer-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before, .event[_ngcontent-%COMP%]   .card-back.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before{left:0;width:100%}.event[_ngcontent-%COMP%]   .card-back.boat[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-road[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-normal)}.event[_ngcontent-%COMP%]   .card-back.boat.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.boat.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-road.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-road.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-road.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-road.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-outpost.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-outpost.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-outpost.winter-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-outpost.summer-outpost[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding-top:0}.event[_ngcontent-%COMP%]   .card-back.boat[_ngcontent-%COMP%]   .spoiler-free[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-road[_ngcontent-%COMP%]   .spoiler-free[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-road[_ngcontent-%COMP%]   .spoiler-free[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-outpost[_ngcontent-%COMP%]   .spoiler-free[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-outpost[_ngcontent-%COMP%]   .spoiler-free[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-title)}.event[_ngcontent-%COMP%]   .card-back.boat[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-road[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-road[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.winter-outpost[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   .card-back.summer-outpost[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-title);transform:rotate(90deg);font-size:.8em;left:initial;right:-8%;width:22%;height:6%;top:78%;background-size:100% 100%;background-position:top left;background-repeat:no-repeat;background-image:url(fh-card-id.ed6ecd3d94902ee6.png);filter:var(--ghs-filter-shadow)}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]{position:absolute;top:12%;width:100%;height:88%;margin:0;z-index:1;opacity:1;transition:opacity calc(var(--ghs-animation-speed) * .75s) ease-in-out}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]:before{content:" ";float:left;height:100%;width:50%;shape-outside:polygon(100% 7%,100% 0%,0% 0%,0% 100%,22% 100%,22% 28%,30% 18%,38% 11%,70% 5.5%);shape-margin:3%}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper.spoiler[_ngcontent-%COMP%]{opacity:0}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{width:100%;height:100%}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]:before{content:" ";float:right;height:100%;width:50%;shape-outside:polygon(0% 7%,0% 0%,100% 0%,100% 100%,78% 100%,78% 28%,70% 18%,62% 11%,30% 5.5%);shape-margin:3%}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:.6em;line-height:.9em;letter-spacing:-.01em;font-style:italic;min-height:65%;text-align:justify}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]{position:relative;margin-top:.5em;padding-top:.1em}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:-.1em;left:12%;height:.1em;width:76%;background-size:100% 100%;background-image:url(divider.3702ad44044cacd0.png);filter:brightness(0)}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]{cursor:pointer;margin-top:.4em;font-family:var(--ghs-font-text);font-size:.6em;line-height:.9em;letter-spacing:-.01em}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:700;margin-right:.3em}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:hover{opacity:.7}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.single[_ngcontent-%COMP%]{font-weight:700}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .option.single[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:none}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .requirement[_ngcontent-%COMP%]{position:absolute;right:-88%;bottom:-15%;width:100%;height:11%;transform:rotate(-90deg);transform-origin:left top;display:flex;align-items:center;justify-content:center;color:var(--ghs-color-white);font-size:.6em;background-size:100% 100%;background-position:top left;background-repeat:no-repeat;background-image:url(city-requirement.c033e246fae6b4e4.png)}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .requirement[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:.1em}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .spoiler-free[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;z-index:3}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .spoiler-free[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:zoom-in;text-transform:uppercase;font-family:var(--ghs-font-title);font-size:3em;color:var(--ghs-color-darkgray)}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .spoiler-free.light[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--ghs-color-gray)}.event[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{position:absolute;top:89%;left:50%;width:60%;height:10%;display:flex;justify-content:center;align-items:center;text-align:center;text-transform:uppercase;transform:translate(-50%);font-family:var(--ghs-font-title);font-size:.6em;padding-top:.1em;z-index:2;cursor:zoom-out}.event.disabled[_ngcontent-%COMP%]{cursor:initial}']})}return i})();const QT=(i,r)=>({closed:i,opened:r}),sr=()=>[];let rr=(()=>{class i{dialogRef;eventCard;interactive;spoiler;id;opened=!1;gameManager=s.E;constructor(e,a){this.dialogRef=a,this.eventCard=e.eventCard,this.interactive=e.interactive,this.spoiler=e.spoiler,this.id=e.id}ngOnInit(){this.opened=!0}close(){this.opened=!1,setTimeout(()=>{this.dialogRef.close()},m.f.settings.animations?1e3*m.f.settings.animationSpeed:0)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-event-card-dialog"]],standalone:!1,decls:4,vars:12,consts:[["ghs-pointer-input","",1,"event-card-dialog",3,"singleClick","ngClass"],[1,"event-card-container"],[3,"event","spoiler","disabled","select","subSelect","checks"],[1,"close-container",3,"click"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.bIt("singleClick",function(){return n.close()}),t.j41(1,"div",1),t.nrm(2,"ghs-event-card",2),t.k0s()(),t.j41(3,"div",3),t.bIt("click",function(){return n.close()}),t.k0s()),2&a&&(t.Y8G("ngClass",t.l_i(7,QT,!n.opened,n.opened)),t.R7$(2),t.Y8G("event",n.eventCard)("spoiler",n.spoiler)("disabled",!n.interactive)("select",n.id?n.id.selected:-1)("subSelect",n.id?n.id.subSelections:t.lJ4(10,sr))("checks",n.id?n.id.checks:t.lJ4(11,sr)))},dependencies:[N.YU,Gi,rt],styles:["[_nghost-%COMP%]{background-color:transparent;padding:0;margin:0;border:0}.event-card-dialog[_ngcontent-%COMP%]{position:relative;width:100vw;height:100vh;border-image:none;background:none;transition:transform calc(var(--ghs-animation-speed) * .15s) ease-in-out;transform:scale(0);z-index:2;overflow:auto;display:flex;justify-content:center;align-items:center;-ms-overflow-style:none;scrollbar-width:none}.event-card-dialog[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.event-card-dialog.opened[_ngcontent-%COMP%]{transform:scale(1)}.event-card-dialog.closed[_ngcontent-%COMP%]{transform:scale(0);transition-delay:.8s}.event-card-dialog[_ngcontent-%COMP%]   .event-card-container[_ngcontent-%COMP%]{overflow:visible;width:100vw;max-width:600px;max-height:100vh}.event-card-dialog[_ngcontent-%COMP%]   .event-card-container[_ngcontent-%COMP%]   ghs-event-card[_ngcontent-%COMP%]{height:150vw;max-height:900px}.close-container[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1}"]})}return i})();const t8=i=>({disabled:i});function e8(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",6)(1,"a",11),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.drawNew())}),t.k0s()()}2&i&&(t.R7$(),t.Y8G("ghs-label","game.events.requirements.warning"))}function n8(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",11),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.accept(!1))}),t.k0s()}2&i&&t.Y8G("ghs-label","game.events.accept.notApply")}function i8(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"ghs-event-card",3),t.bIt("onSelect",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.select(n))}),t.k0s(),t.j41(4,"a",4),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.showEventCard(n.event))}),t.nrm(5,"img",5),t.k0s()()(),t.nVh(6,e8,2,1,"div",6),t.j41(7,"div",7)(8,"a",8),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.cancel())}),t.k0s(),t.nVh(9,n8,1,1,"a",9),t.j41(10,"a",10),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.accept())}),t.k0s()()()}if(2&i){const e=t.XpG();t.R7$(3),t.Y8G("event",e.event),t.R7$(),t.Y8G("ghs-tooltip","game.events.deck.show"),t.R7$(2),t.vxM(e.requirementWarning?6:-1),t.R7$(2),t.Y8G("ghs-label","cancel"),t.R7$(),t.vxM(e.settingsManager.settings.eventsApply?9:-1),t.R7$(),t.Y8G("ngClass",t.eq3(7,t8,-1==e.selected))("ghs-label","game.events.accept")}}let Ti=(()=>{class i{dialogRef;dialog;event;selected=-1;subSelections=[];checks=[];globalDraw=!1;requirementWarning=!1;attack=!1;settingsManager=m.f;constructor(e,a,n){this.dialogRef=a,this.dialog=n;const o=s.E.game.party.eventDecks[e.type];this.globalDraw=null!=s.E.game.eventDraw,o&&(this.event=s.E.eventCardManager.getEventCardForEdition(e.edition,e.type,e.cardId||o[0])),this.event||(console.debug("No event card found for",e.edition,e.type),this.dialogRef.close()),this.event&&this.event.requirement&&this.event.requirement.partyAchievement&&(this.requirementWarning=-1==s.E.game.party.achievementsList.indexOf(this.event.requirement.partyAchievement)),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.globalDraw&&!s.E.game.eventDraw&&this.dialogRef.close()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}select(e){this.selected=e.selected,this.subSelections=e.subSelections,this.checks=e.checks,this.attack=e.attack}cancel(){s.E.stateManager.before("eventDraw.cancel"),s.E.game.eventDraw=void 0,s.E.stateManager.after(),(0,V.co)(this.dialogRef)}accept(e=!0){if(this.event&&(-1!=this.selected||!e)){s.E.stateManager.before("eventDraw.accept"),s.E.game.eventDraw=void 0;const a=s.E.eventCardManager.applyEvent(this.event,this.selected,this.subSelections,this.checks,null!=s.E.game.scenario&&s.E.roundManager.firstRound,this.attack,e);s.E.stateManager.after(m.f.settings.animations?1e3:250),(0,V.co)(this.dialogRef,a.length?a:void 0)}}drawNew(){if(this.event){const e=this.event.edition,a=this.event.type,n=this.event.cardId;s.E.stateManager.before("eventDraw.new"),s.E.eventCardManager.removeEvent(a,n);const o=s.E.game.party.eventDecks[a];o&&(this.event=s.E.eventCardManager.getEventCardForEdition(e,a,o[0]),this.event&&(this.requirementWarning=!1,this.event.requirement&&this.event.requirement.partyAchievement&&(this.requirementWarning=-1==s.E.game.party.achievementsList.indexOf(this.event.requirement.partyAchievement)))),s.E.eventCardManager.addEvent(a,n),s.E.stateManager.after()}}showEventCard(e){this.dialog.open(rr,{panelClass:["fullscreen-panel"],disableClose:!0,data:{eventCard:e,interactive:!0,id:-1!=this.selected?new xt.Qc(e.cardId,e.edition,e.type,this.selected,this.subSelections,this.checks,this.attack,!1):void 0}})}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-event-card-draw"]],standalone:!1,decls:1,vars:1,consts:[[1,"event-card-dialog"],[1,"scroll-container","event-card-container"],[1,"event-card"],[3,"onSelect","event"],[1,"open",3,"click","ghs-tooltip"],["src","./assets/images/fullscreen.svg",1,"ghs-svg"],[1,"warning"],[1,"menu"],[1,"cancel",3,"click","ghs-label"],[3,"ghs-label"],[1,"accept",3,"click","ngClass","ghs-label"],[3,"click","ghs-label"]],template:function(a,n){1&a&&t.nVh(0,i8,11,9,"div",0),2&a&&t.vxM(n.event?0:-1)},dependencies:[N.YU,Gi,tt,ft],styles:[".event-card-dialog[_ngcontent-%COMP%]{position:relative}.event-card-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{text-align:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.event-card-dialog[_ngcontent-%COMP%]   .event-card-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.event-card-dialog[_ngcontent-%COMP%]   .event-card-container[_ngcontent-%COMP%]   .event-card[_ngcontent-%COMP%]{position:relative;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 45 * var(--ghs-dialog-factor))}.event-card-dialog[_ngcontent-%COMP%]   .event-card-container[_ngcontent-%COMP%]   .event-card[_ngcontent-%COMP%]   ghs-event-card[_ngcontent-%COMP%]{display:block;width:100%}.event-card-dialog[_ngcontent-%COMP%]   .event-card-container[_ngcontent-%COMP%]   .event-card[_ngcontent-%COMP%]   .open[_ngcontent-%COMP%]{z-index:1;position:absolute;display:flex;cursor:pointer;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-filter-white) var(--ghs-filter-shadow)}.event-card-dialog[_ngcontent-%COMP%]   .event-card-container[_ngcontent-%COMP%]   .event-card[_ngcontent-%COMP%]   .open[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.event-card-dialog[_ngcontent-%COMP%]   .event-card-container[_ngcontent-%COMP%]   .event-card[_ngcontent-%COMP%]   .open[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.event-card-dialog[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.event-card-dialog[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;color:var(--ghs-color-yellow);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor))}.event-card-dialog[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}.event-card-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor)) 0;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly;align-items:center}.event-card-dialog[_ngcontent-%COMP%]   .menu.small[_ngcontent-%COMP%]{justify-content:center;margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor)) 0;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.7 * var(--ghs-dialog-factor))}.event-card-dialog[_ngcontent-%COMP%]   .menu.small[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{min-width:auto}.event-card-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;display:flex;flex-grow:1;justify-content:center;margin:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.event-card-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.event-card-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.accept[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.event-card-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.event-card-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-darkgray)}"]})}return i})();const a8=i=>({resolved:i}),o8=(i,r,e)=>({fh:i,modern:r,resolved:e}),cr=(i,r)=>[i,r],Si=i=>[i],s8=i=>({active:i}),lr=(i,r)=>r.edition+"-"+r.cardId,r8=(i,r)=>r.identifier.edition+"-"+r.identifier.cardId;function c8(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",18),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.selectType(n))}),t.nrm(1,"span",19),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(2,s8,a.type==e)),t.R7$(),t.Y8G("ghs-label","game.events.type."+e)}}function l8(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",20),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.drawEvent())}),t.nrm(1,"span",12),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","scenario.eventEffects.drawEvent")("ghs-label-args",t.eq3(2,Si,e.type))}}function g8(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",21),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleAllTypes())}),t.k0s(),t.nrm(2,"span",19),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("checked",e.allTypes),t.R7$(),t.Y8G("ghs-label","game.events.deck.allTypes")}}function d8(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",22),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.resolved,n)||(o.resolved=n),t.Njj(n)}),t.k0s(),t.nrm(2,"span",19),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.R50("ngModel",e.resolved),t.R7$(),t.Y8G("ghs-label","game.events.deck.resolved")}}function h8(i,r){1&i&&t.nrm(0,"div",15)}function _8(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",23),t.nrm(1,"ghs-event-card",24),t.j41(2,"a",25),t.nrm(3,"img",26),t.k0s(),t.j41(4,"a",27),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.showEventCard(n))}),t.nrm(5,"img",28),t.k0s(),t.j41(6,"a",29),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.removeCard(n))}),t.nrm(7,"img",30),t.k0s(),t.j41(8,"a",31),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.drawEvent(n.cardId))}),t.nrm(9,"span",32),t.k0s()()}if(2&i){const e=t.XpG().$implicit;t.R7$(),t.Y8G("event",e)("spoiler",!0),t.R7$(3),t.Y8G("ghs-tooltip","game.events.deck.show"),t.R7$(2),t.Y8G("ghs-tooltip","game.events.deck.removeCard"),t.R7$(2),t.Y8G("ghs-tooltip","game.events.deck.draw"),t.R7$(),t.Y8G("ghs-label","%action.card.recover%")}}function m8(i,r){if(1&i&&t.nVh(0,_8,10,6,"div",23),2&i){const e=r.$implicit,a=t.XpG();t.vxM(a.filter&&-1==e.cardId.indexOf(a.filter)?-1:0)}}function p8(i,r){1&i&&t.nrm(0,"div",15)}function u8(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",23),t.nrm(1,"ghs-event-card",24),t.j41(2,"a",25),t.nrm(3,"img",26),t.k0s(),t.j41(4,"a",27),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.showEventCard(n))}),t.nrm(5,"img",28),t.k0s(),t.j41(6,"a",33),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.addCard(n))}),t.nrm(7,"img",34),t.k0s(),t.j41(8,"a",31),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.drawEvent(n.cardId))}),t.nrm(9,"span",32),t.k0s()()}if(2&i){const e=t.XpG().$implicit;t.R7$(),t.Y8G("event",e)("spoiler",!0),t.R7$(3),t.Y8G("ghs-tooltip","game.events.deck.show"),t.R7$(2),t.Y8G("ghs-tooltip","game.events.deck.addCard"),t.R7$(2),t.Y8G("ghs-tooltip","game.events.deck.draw"),t.R7$(),t.Y8G("ghs-label","%action.card.recover%")}}function f8(i,r){if(1&i&&t.nVh(0,u8,10,6,"div",23),2&i){const e=r.$implicit,a=t.XpG();t.vxM(a.filter&&-1==e.cardId.indexOf(a.filter)?-1:0)}}function C8(i,r){1&i&&t.nrm(0,"div",15)}function M8(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",27),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2).$implicit,o=t.XpG();return t.Njj(o.showEventCard(n.card,n.identifier))}),t.nrm(1,"img",28),t.k0s()}2&i&&t.Y8G("ghs-tooltip","game.events.deck.show")}function v8(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",41),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2).$implicit,o=t.XpG();return t.Njj(o.updateDrawnSelect(n.identifier))}),t.nrm(1,"img",42),t.k0s()}2&i&&t.Y8G("ghs-tooltip","game.events.deck.removeSelection")}function O8(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",43),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2).$implicit,o=t.XpG();return t.Njj(o.addCard(n.card))}),t.nrm(1,"img",44),t.k0s()}2&i&&t.Y8G("ghs-tooltip","game.events.deck.addCard")}function P8(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",35)(1,"ghs-event-card",36),t.bIt("onSelect",function(n){t.eBV(e);const o=t.XpG().$implicit,g=t.XpG();return t.Njj(g.updateDrawnSelect(o.identifier,n))}),t.k0s(),t.nVh(2,M8,2,1,"a",37),t.nVh(3,v8,2,1,"a",38),t.j41(4,"a",29),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.removeDrawn(n.identifier))}),t.nrm(5,"img",39),t.k0s(),t.nVh(6,O8,2,1,"a",40),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(),t.Y8G("event",e.card)("select",e.identifier.selected)("subSelect",e.identifier.subSelections)("checks",e.identifier.checks),t.R7$(),t.vxM(e.card?2:-1),t.R7$(),t.vxM(-1!=e.identifier.selected?3:-1),t.R7$(),t.Y8G("ghs-tooltip","game.events.deck.removeDrawn"),t.R7$(2),t.vxM(e.card&&-1==a.upcomingCards.indexOf(e.card)&&-1==a.newCards.indexOf(e.card)?6:-1)}}function b8(i,r){if(1&i&&t.nVh(0,P8,7,8,"div",35),2&i){const e=r.$implicit,a=t.XpG();t.vxM(a.filter&&-1==e.identifier.cardId.indexOf(a.filter)?-1:0)}}let Ba=(()=>{class i{dialogRef;dialog;edition;type;types=[];upcomingCards=[];newCards=[];drawnCards=[];filter="";allTypes=!1;allTypesToggle=!1;resolved=!1;settingsManager=m.f;constructor(e,a,n){this.dialogRef=a,this.dialog=n,this.edition=e.edition,this.types=s.E.eventCardManager.getEventTypesForEdition(this.edition).filter(o=>this.allTypes||s.E.game.party.eventDecks[o]&&s.E.game.party.eventDecks[o].length),this.allTypesToggle=s.E.eventCardManager.getEventTypesForEdition(this.edition).length!=this.types.length,this.type=e.type||this.types[0],this.update(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.update()})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){const e=s.E.eventCardManager.getEventCardsForEdition(this.edition,this.type),a=s.E.game.party.eventDecks[this.type]||[];this.upcomingCards=a.map(n=>e.find(o=>o.cardId==n)).filter(n=>n).map(n=>n),this.newCards=e.filter(n=>-1==a.indexOf(n.cardId)&&!s.E.game.party.eventCards.find(o=>o.type==this.type&&o.cardId==n.cardId)),this.drawnCards=s.E.game.party.eventCards.filter(n=>e.find(o=>o.edition==n.edition&&o.type==n.type&&o.cardId==n.cardId)).map(n=>({identifier:n,card:e.find(o=>o.cardId==n.cardId)}))}selectType(e){this.type=e,this.update()}toggleAllTypes(){this.allTypes=!this.allTypes,this.types=s.E.eventCardManager.getEventTypesForEdition(this.edition).filter(e=>this.allTypes||s.E.game.party.eventDecks[e]&&s.E.game.party.eventDecks[e].length)}shuffle(){s.E.stateManager.before("events.deck.shuffle",this.type),s.E.eventCardManager.shuffleEvents(this.type),s.E.stateManager.after()}dropUpcoming(e){s.E.stateManager.before("events.deck.reorder",this.type),e.container==e.previousContainer?(0,D.HD)(s.E.game.party.eventDecks[this.type]||[],e.previousIndex,e.currentIndex):(s.E.game.party.eventDecks[this.type]||[]).splice(e.currentIndex<0?0:e.currentIndex,0,this.newCards[e.previousIndex].cardId),s.E.stateManager.after()}dropNew(e){s.E.stateManager.before("events.deck.reorder",this.type),e.container==e.previousContainer?(0,D.HD)(this.newCards,e.previousIndex,e.currentIndex):(s.E.game.party.eventDecks[this.type]||[]).splice(e.previousIndex,1),s.E.stateManager.after()}dropDrawn(e){let a;"new-list"==e.previousContainer.id?a=this.newCards[e.previousIndex]:"upcoming-list"==e.previousContainer.id&&(a=this.upcomingCards[e.previousIndex]),a&&(s.E.stateManager.before("events.deck.markDrawn",a.type,a.cardId),s.E.game.party.eventCards.splice(e.currentIndex,0,new xt.Qc(a.cardId,a.edition,a.type,-1,[],[],!1,!1)),s.E.stateManager.after())}removeCard(e){s.E.stateManager.before("events.deck.removeEvent",this.type,e.cardId),s.E.eventCardManager.removeEvent(e.type,e.cardId),s.E.stateManager.after()}addCard(e){s.E.stateManager.before("events.deck.addEvent",this.type,e.cardId),s.E.eventCardManager.addEvent(e.type,e.cardId),s.E.stateManager.after()}removeDrawn(e){const a=s.E.game.party.eventCards.indexOf(e);-1!=a&&(s.E.stateManager.before("events.deck.removeDrawn",this.type,e.cardId),s.E.game.party.eventCards.splice(a,1),s.E.stateManager.after())}updateDrawnSelect(e,a=void 0){const n=a?a.selected:-1,o=a?a.subSelections:[];(e.selected!=n||e.subSelections.length!=o.length||e.subSelections.some(g=>-1==o.indexOf(g)))&&(s.E.stateManager.before("events.deck.changeSelection",this.type,e.cardId),e.selected=n,e.subSelections=o,s.E.stateManager.after(a?0:750))}showEventCard(e,a=void 0){this.dialog.open(rr,{panelClass:["fullscreen-panel"],disableClose:!0,data:{eventCard:e,interactive:!0,id:a}})}drawEvent(e=void 0){this.dialog.open(Ti,{panelClass:["dialog"],data:{edition:this.edition,type:this.type,cardId:e}}).closed.subscribe({next:a=>{m.f.settings.eventsApply&&a&&a.length&&this.dialog.open(ni,{panelClass:["dialog"],data:{eventResults:a}})}})}close(){(0,V.co)(this.dialogRef)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-event-card-deck"]],standalone:!1,decls:35,vars:41,consts:[["menu",""],["upcomingList","cdkDropList"],["newList","cdkDropList"],["drawnList","cdkDropList"],[1,"events-dialog"],[1,"menu",3,"ngClass"],[1,"event-type",3,"ngClass"],["type","text",3,"ngModelChange","ngModel","ghs-label","ghs-label-attribute"],[1,"scroll-container"],[1,"events-container",3,"ngClass"],["id","upcoming-list","cdkDropList","",1,"upcoming","drop-list",3,"cdkDropListDropped","cdkDropListConnectedTo","cdkDropListAutoScrollStep"],[1,"title"],[3,"ghs-label","ghs-label-args"],[3,"click","ghs-tooltip"],["src","./assets/images/shuffle.svg",1,"ghs-svg"],[1,"empty"],["id","new-list","cdkDropList","",1,"new","drop-list",3,"cdkDropListDropped","cdkDropListConnectedTo","cdkDropListAutoScrollStep"],["cdkDropList","",1,"drawn","drop-list",3,"cdkDropListDropped","cdkDropListAutoScrollStep"],[1,"event-type",3,"click","ngClass"],[3,"ghs-label"],[3,"click"],["type","checkbox",3,"click","checked"],["type","checkbox",3,"ngModelChange","ngModel"],["cdkDrag","",1,"container","drag-hidden"],[3,"event","spoiler"],["cdkDragHandle","",1,"button","drag-handle"],["src","./assets/images/menu.svg",1,"ghs-svg"],[1,"button","open",3,"click","ghs-tooltip"],["src","./assets/images/fullscreen.svg",1,"ghs-svg"],[1,"button","remove",3,"click","ghs-tooltip"],["src","./assets/images/eventcards/remove.svg",1,"ghs-svg"],[1,"button","draw",3,"click","ghs-tooltip"],[1,"text-white",3,"ghs-label"],[1,"button","add",3,"click","ghs-tooltip"],["src","./assets/images/eventcards/return.svg",1,"ghs-svg"],["drag-hidden","","cdkDrag","",1,"container"],[3,"onSelect","event","select","subSelect","checks"],[1,"button","open",3,"ghs-tooltip"],[1,"button","reset",3,"ghs-tooltip"],["src","./assets/images/minus.svg",1,"ghs-svg"],[1,"button","add","restore",3,"ghs-tooltip"],[1,"button","reset",3,"click","ghs-tooltip"],["src","./assets/images/long-rest.svg",1,"ghs-svg"],[1,"button","add","restore",3,"click","ghs-tooltip"],["src","./assets/images/plus.svg",1,"ghs-svg"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",4)(1,"div",5,0),t.Z7z(3,c8,2,4,"a",6,t.fX1),t.nVh(5,l8,2,4,"a"),t.nVh(6,g8,3,2,"label"),t.nVh(7,d8,3,2,"label"),t.j41(8,"label")(9,"input",7),t.mxI("ngModelChange",function(_){return t.eBV(o),t.DH7(n.filter,_)||(n.filter=_),t.Njj(_)}),t.bIt("ngModelChange",function(){return t.eBV(o),t.Njj(n.update())}),t.k0s()()(),t.j41(10,"div",8)(11,"div",9)(12,"div",10,1),t.bIt("cdkDropListDropped",function(_){return t.eBV(o),t.Njj(n.dropUpcoming(_))}),t.j41(14,"div",11),t.nrm(15,"span",12),t.j41(16,"a",13),t.bIt("click",function(){return t.eBV(o),t.Njj(n.shuffle())}),t.nrm(17,"img",14),t.k0s()(),t.nVh(18,h8,1,0,"div",15),t.Z7z(19,m8,1,1,null,null,lr),t.k0s(),t.j41(21,"div",16,2),t.bIt("cdkDropListDropped",function(_){return t.eBV(o),t.Njj(n.dropNew(_))}),t.j41(23,"div",11),t.nrm(24,"span",12),t.k0s(),t.nVh(25,p8,1,0,"div",15),t.Z7z(26,f8,1,1,null,null,lr),t.k0s(),t.j41(28,"div",17,3),t.bIt("cdkDropListDropped",function(_){return t.eBV(o),t.Njj(n.dropDrawn(_))}),t.j41(30,"div",11),t.nrm(31,"span",12),t.k0s(),t.nVh(32,C8,1,0,"div",15),t.Z7z(33,b8,1,1,null,null,r8),t.k0s()()()()}if(2&a){const o=t.sdS(13),g=t.sdS(22),_=t.sdS(29);t.R7$(),t.Y8G("ngClass",t.eq3(23,a8,n.resolved)),t.R7$(2),t.Dyx(n.types),t.R7$(2),t.vxM(n.upcomingCards.length?5:-1),t.R7$(),t.vxM(n.allTypesToggle?6:-1),t.R7$(),t.vxM(n.drawnCards.length||n.resolved?7:-1),t.R7$(2),t.R50("ngModel",n.filter),t.Y8G("ghs-label","game.events.deck.filter")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ngClass",t.sMw(25,o8,"fh"==n.settingsManager.settings.theme,"modern"==n.settingsManager.settings.theme,n.resolved)),t.R7$(),t.Y8G("cdkDropListConnectedTo",t.l_i(29,cr,g,_))("cdkDropListAutoScrollStep",20),t.R7$(3),t.Y8G("ghs-label","game.events.deck.upcoming")("ghs-label-args",t.eq3(32,Si,n.upcomingCards.length)),t.R7$(),t.Y8G("ghs-tooltip","game.events.deck.shuffle"),t.R7$(2),t.vxM(0==n.upcomingCards.length?18:-1),t.R7$(),t.Dyx(n.upcomingCards),t.R7$(2),t.Y8G("cdkDropListConnectedTo",t.l_i(34,cr,o,_))("cdkDropListAutoScrollStep",20),t.R7$(3),t.Y8G("ghs-label","game.events.deck.new")("ghs-label-args",t.eq3(37,Si,n.newCards.length)),t.R7$(),t.vxM(0==n.newCards.length?25:-1),t.R7$(),t.Dyx(n.newCards),t.R7$(2),t.Y8G("cdkDropListAutoScrollStep",20),t.R7$(3),t.Y8G("ghs-label","game.events.deck.drawn")("ghs-label-args",t.eq3(39,Si,n.drawnCards.length)),t.R7$(),t.vxM(0==n.drawnCards.length?32:-1),t.R7$(),t.Dyx(n.drawnCards)}},dependencies:[N.YU,O.me,O.Zm,O.BC,O.vS,D.O7,D.T1,D.Fb,Gi,tt,ft],styles:[".events-dialog[_ngcontent-%COMP%]{position:relative}.events-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;flex-wrap:wrap;max-width:calc(var(--ghs-unit) * 80 * var(--ghs-text-factor))}.events-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);margin:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.events-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.event-type[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label.event-type[_ngcontent-%COMP%]{font-family:var(--ghs-font-text)}.events-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .events-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .events-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label.active[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.events-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));min-width:initial}.events-dialog[_ngcontent-%COMP%]   .menu.resolved[_ngcontent-%COMP%]{max-width:calc(var(--ghs-unit) * 120 * var(--ghs-text-factor))}.events-dialog[_ngcontent-%COMP%]   .drop-list[_ngcontent-%COMP%]{position:relative}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]{display:flex;margin:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 78 * var(--ghs-text-factor));max-height:80vh}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;margin:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 38 * var(--ghs-text-factor))}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming.drawn[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new.drawn[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn.drawn[_ngcontent-%COMP%]{display:none}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 36.5 * var(--ghs-dialog-factor));min-height:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);z-index:2}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-white)}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{opacity:.7}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));flex-grow:1;text-align:center}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 36 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 54 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));flex-shrink:0;flex-grow:0}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ghs-event-card[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ghs-event-card[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ghs-event-card[_ngcontent-%COMP%]{display:block;width:100%;height:100%}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{z-index:1;position:absolute;display:flex;cursor:pointer;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-filter-white) var(--ghs-filter-shadow)}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-shadow)}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.add[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.add[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.add[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-green) var(--ghs-filter-shadow)}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.drag-handle[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.drag-handle[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.drag-handle[_ngcontent-%COMP%]{cursor:grab;right:initial;left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.open[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.open[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.open[_ngcontent-%COMP%]{cursor:nesw-resize;right:50%;transform:translate(50%)}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.reset[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.reset[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.reset[_ngcontent-%COMP%]{right:initial;left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.reset[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.reset[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.reset[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow) var(--ghs-filter-shadow)}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.restore[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.restore[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.restore[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor))}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.draw[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.draw[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.draw[_ngcontent-%COMP%]{top:initial;left:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));right:initial;bottom:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 5.5 * var(--ghs-text-factor));left:calc(var(--ghs-unit) * .3 * var(--ghs-text-factor));display:block;margin:calc(var(--ghs-unit) * .7 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 35 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 51.7 * var(--ghs-text-factor));border-radius:calc(var(--ghs-unit) * 1);border-style:dashed;border-width:calc(var(--ghs-unit) * .2);border-color:var(--ghs-color-white)}.events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming.upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.add[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming.upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.remove[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming.new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.add[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .upcoming.new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.remove[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new.upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.add[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new.upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.remove[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new.new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.add[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .new.new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.remove[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn.upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.add[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn.upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.remove[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn.new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.add[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container[_ngcontent-%COMP%]   .drawn.new[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button.remove[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.events-dialog[_ngcontent-%COMP%]   .events-container.resolved[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 117 * var(--ghs-text-factor))}.events-dialog[_ngcontent-%COMP%]   .events-container.resolved[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]{display:flex}.events-dialog[_ngcontent-%COMP%]   .events-container.fh[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container.fh[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container.fh[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.events-dialog[_ngcontent-%COMP%]   .events-container.modern[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container.modern[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .events-dialog[_ngcontent-%COMP%]   .events-container.modern[_ngcontent-%COMP%]   .drawn[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.events-dialog[_ngcontent-%COMP%]   .cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.5}.events-dialog[_ngcontent-%COMP%]   .cdk-drag-animating[_ngcontent-%COMP%]{transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}.events-dialog[_ngcontent-%COMP%]   .cdk-drop-list-dragging[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}"]})}return i})();var $i=M(71891),$e=M(1270),on=M(88826),k8=M(66367);class Kn{label;value;revelead;group;constructor(r,e="",a=!1,n=""){this.label=r,this.value=e,this.revelead=a,this.group=n}}let y8=(()=>{class i{el;values=[];spoiler=!1;emptyLabel="";select=new t.bkB;constructor(e){this.el=e}ngOnInit(){let e=document.createElement("div");this.el.nativeElement.after(e);const a=this.select;(0,k8.A)({input:this.el.nativeElement,container:e,emptyMsg:this.emptyLabel?m.f.getLabel(this.emptyLabel):"",minLength:3,disableAutoSelect:!0,fetch:(n,o)=>{o(this.values.filter(g=>g.label&&g.label.toLowerCase().startsWith(n.toLowerCase())).sort((g,_)=>g.revelead&&!_.revelead?-1:_.revelead&&!g.revelead?1:0))},onSelect:n=>{this.el.nativeElement.value=n.label||"",a.emit(n.label)},render:(n,o,g)=>{const _=document.createElement("div");return _.textContent=n.label,n.revelead&&_.classList.add("revealed"),_},customize:()=>{if(this.spoiler&&(e.children.length>1||this.el.nativeElement.value.length<6))for(let n=0;n<e.children.length;n++){const o=e.children[n];o.classList.contains("selected")?o.classList.remove("spoiler"):(o.classList.add("spoiler"),o.addEventListener("touchstart",g=>{o.classList.contains("spoiler")&&(g.preventDefault(),g.stopPropagation())}),o.addEventListener("touchend",g=>{if(o.classList.contains("spoiler")){g.preventDefault(),g.stopPropagation(),o.classList.remove("spoiler");for(let _=0;_<e.children.length;_++)e.children[_]!=o&&e.children[_].classList.add("spoiler")}}))}else for(let n=0;n<e.children.length;n++)e.children[n].classList.remove("spoiler")},keyup:n=>{switch(n.event.key){case"ArrowUp":case"ArrowDown":case"Escape":if(this.spoiler&&(e.children.length>1||this.el.nativeElement.value.length<6))for(let g=0;g<e.children.length;g++){const _=e.children[g];_.classList.contains("selected")?_.classList.remove("spoiler"):_.classList.add("spoiler")}else for(let g=0;g<e.children.length;g++)e.children[g].classList.remove("spoiler")}}})}static \u0275fac=function(a){return new(a||i)(t.rXU(t.aKT))};static \u0275dir=t.FsC({type:i,selectors:[["","autocomplete",""]],inputs:{values:[0,"autocomplete","values"],spoiler:"spoiler",emptyLabel:"emptyLabel"},outputs:{select:"keyup.enter"},standalone:!1})}return i})();const x8=(i,r)=>({fh:i,modern:r}),Le=i=>[i],gr=i=>({force:i}),E8=i=>({active:i}),w8=(i,r,e,a)=>({first:i,costs:r,some:e,full:a}),R8=i=>({absent:i}),j8=(i,r)=>({some:i,full:r}),Kt=i=>({disabled:i}),Ya=(i,r,e)=>({costs:i,some:r,full:e}),Wn=(i,r)=>r.edition+"-"+r.name;function G8(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.SpI("(",e.building.data.id,")")}}function T8(i,r){if(1&i&&(t.j41(0,"span",2),t.nrm(1,"span",11),t.nVh(2,G8,2,1,"span"),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","data.buildings."+e.building.data.name),t.R7$(),t.vxM(e.building.data.id?2:-1)}}function S8(i,r){if(1&i&&(t.j41(0,"span",3),t.nrm(1,"img",14)(2,"span",15),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("src","./assets/images/fh/buildings/"+e.action+".svg",t.B4B),t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.buildings."+e.action+".action")("ghs-label-args",t.eq3(3,Le,""+(e.building.model.level+(e.rewardsOnly?0:1))))}}function $8(i,r){1&i&&(t.j41(0,"span",2),t.nrm(1,"span",11),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","data.buildings.barracks.soldiers"))}function D8(i,r){if(1&i&&(t.j41(0,"span",16),t.nrm(1,"img",17),t.EFF(2),t.k0s()),2&i){const e=t.XpG(2);t.R7$(2),t.SpI(" ",e.costs.lumber)}}function I8(i,r){if(1&i&&(t.j41(0,"span",16),t.nrm(1,"img",18),t.EFF(2),t.k0s()),2&i){const e=t.XpG(2);t.R7$(2),t.SpI(" ",e.costs.metal)}}function A8(i,r){if(1&i&&(t.j41(0,"span",16),t.nrm(1,"img",19),t.EFF(2),t.k0s()),2&i){const e=t.XpG(2);t.R7$(2),t.SpI(" ",e.costs.hide)}}function V8(i,r){if(1&i&&(t.j41(0,"span",16),t.nrm(1,"img",20),t.EFF(2),t.k0s()),2&i){const e=t.XpG(2);t.R7$(2),t.SpI(" ",e.costs.gold)}}function F8(i,r){if(1&i&&(t.j41(0,"span",4),t.nVh(1,D8,3,1,"span",16),t.nVh(2,I8,3,1,"span",16),t.nVh(3,A8,3,1,"span",16),t.nVh(4,V8,3,1,"span",16),t.k0s()),2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(5,gr,e.force)),t.R7$(),t.vxM(!e.repair&&e.costs.lumber?1:-1),t.R7$(),t.vxM(!e.repair&&e.costs.metal?2:-1),t.R7$(),t.vxM(!e.repair&&e.costs.hide?3:-1),t.R7$(),t.vxM(e.costs.gold?4:-1)}}function X8(i,r){if(1&i&&(t.j41(0,"span",4),t.nrm(1,"span",15),t.j41(2,"span",16),t.nrm(3,"img",21),t.k0s(),t.j41(4,"span",16),t.nrm(5,"img",22),t.k0s(),t.j41(6,"span",16),t.nrm(7,"img",23),t.k0s()()),2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(3,gr,e.force)),t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.buildings.repair.costs")("ghs-label-args",t.eq3(5,Le,e.repair))}}function B8(i,r){1&i&&(t.j41(0,"div",5),t.nrm(1,"span",24),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.buildings.discount"))}function Y8(i,r){if(1&i&&t.nrm(0,"span",6),2&i){const e=t.XpG();t.Y8G("ghs-label","party.campaign.sheet.buildings.rewards.loseMorale")("ghs-label-args",t.eq3(2,Le,""+e.rewards.loseMorale))}}function N8(i,r){if(1&i&&t.nrm(0,"span",25),2&i){const e=t.XpG(2);t.Y8G("ghs-label","party.campaign.sheet.buildings.rewards.prosperity")("ghs-label-args",t.eq3(2,Le,""+e.rewards.prosperity))}}function z8(i,r){if(1&i&&t.nrm(0,"span",26),2&i){const e=t.XpG(2);t.Y8G("ghs-label","party.campaign.sheet.buildings.rewards.defense")("ghs-label-args",t.eq3(2,Le,""+e.rewards.defense))}}function L8(i,r){if(1&i&&t.nrm(0,"span",27),2&i){const e=t.XpG(2);t.Y8G("ghs-label","party.campaign.sheet.buildings.rewards.soldiers")("ghs-label-args",t.eq3(2,Le,""+e.rewards.soldiers))}}function U8(i,r){if(1&i&&t.nrm(0,"span",28),2&i){const e=t.XpG(2);t.Y8G("ghs-label","party.campaign.sheet.buildings.rewards.plot"+(e.rewards.plots>0?"s":""))("ghs-label-args",t.eq3(2,Le,""+e.rewards.plots))}}function q8(i,r){if(1&i&&t.nrm(0,"span",29),2&i){const e=t.XpG(2);t.Y8G("ghs-label","party.campaign.sheet.buildings.rewards.items")("ghs-label-args",e.rewards.items.split("-"))}}function H8(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",32),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.sectionRewards(n.rewards.section))}),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(3,E8,e.rewardsOnly))("ghs-label","party.campaign.sheet.buildings.rewards.section")("ghs-label-args",t.eq3(5,Le,e.rewards.section))}}function K8(i,r){if(1&i&&(t.j41(0,"span",31),t.nrm(1,"span",11),t.EFF(2,":\xa0"),t.nrm(3,"span",33),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","errata"),t.R7$(2),t.Y8G("ghs-label","data.custom."+e.building.data.edition+".errata."+e.rewards.errata)}}function W8(i,r){if(1&i&&(t.j41(0,"div",7),t.nVh(1,N8,1,4,"span",25),t.nVh(2,z8,1,4,"span",26),t.nVh(3,L8,1,4,"span",27),t.nVh(4,U8,1,4,"span",28),t.nVh(5,q8,1,2,"span",29),t.nVh(6,H8,1,7,"span",30),t.nVh(7,K8,4,2,"span",31),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.vxM(e.rewards.prosperity?1:-1),t.R7$(),t.vxM(e.rewards.defense?2:-1),t.R7$(),t.vxM(e.rewards.soldiers?3:-1),t.R7$(),t.vxM(e.rewards.plots?4:-1),t.R7$(),t.vxM(e.rewards.items?5:-1),t.R7$(),t.vxM(e.rewards.section?6:-1),t.R7$(),t.vxM(e.building&&e.rewards.errata?7:-1)}}function J8(i,r){if(1&i&&(t.j41(0,"span",5)(1,"span",37),t.EFF(2),t.k0s(),t.EFF(3),t.k0s()),2&i){const e=t.XpG(2);t.R7$(2),t.JRh(e.paidResources||"-"),t.R7$(),t.SpI(" / ",e.repair||"-"," ")}}function Z8(i,r){1&i&&t.nrm(0,"span",11),2&i&&t.Y8G("ghs-label","party.campaign.sheet.buildings.costs")}function Q8(i,r){if(1&i&&(t.j41(0,"span",36),t.nrm(1,"img",38),t.j41(2,"span",39),t.EFF(3),t.k0s()()),2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(),t.Y8G("src",e.iconUrl,t.B4B),t.R7$(),t.Y8G("ngClass",t.eq3(3,R8,e.absent)),t.R7$(),t.SpI(" ",a.gameManager.characterManager.characterName(e,e.absent)," ")}}function tS(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",43),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$index,o=t.XpG(3);return t.Njj(o.changeValue("gold",o.characterSpent[n],-1))}),t.nrm(1,"img",44),t.k0s(),t.j41(2,"span",45),t.EFF(3),t.k0s(),t.j41(4,"a",43),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$index,o=t.XpG(3);return t.Njj(o.changeValue("gold",o.characterSpent[n],1))}),t.nrm(5,"img",46),t.k0s()}if(2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG(3);t.Y8G("ngClass",t.eq3(6,Kt,0==o.characterSpent[n].gold)),t.R7$(2),t.Y8G("ghs-label","game.loot.")("ghs-label-attribute","title"),t.R7$(),t.Lme(" ",o.characterSpent[n].gold||"-"," / ",a.progress.gold," "),t.R7$(),t.Y8G("ngClass",t.eq3(8,Kt,0==a.progress.gold||a.progress.gold==o.characterSpent[n].gold||o.spent.gold==o.costs.gold))}}function eS(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function nS(i,r){if(1&i&&(t.j41(0,"span",42),t.nVh(1,tS,6,10),t.nVh(2,eS,2,0,"span"),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.vxM(e.progress.gold?1:-1),t.R7$(),t.vxM(e.progress.gold?-1:2)}}function iS(i,r){if(1&i&&(t.j41(0,"span",40),t.nrm(1,"img",41),t.j41(2,"span",16)(3,"span",37),t.EFF(4),t.k0s(),t.EFF(5),t.k0s()(),t.j41(6,"span",42),t.EFF(7," - "),t.k0s(),t.Z7z(8,nS,3,2,"span",42,Wn)),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.l_i(4,j8,e.spent.gold,e.spent.gold==e.costs.gold)),t.R7$(),t.Y8G("src","./assets/images/"+(e.settingsManager.settings.fhStyle?"fh/":"")+"loot.svg",t.B4B),t.R7$(3),t.JRh(e.spent.gold||"-"),t.R7$(),t.SpI(" / ",e.costs.gold),t.R7$(3),t.Dyx(e.characters)}}function aS(i,r){if(1&i&&(t.j41(0,"span",16)(1,"span",37),t.EFF(2),t.k0s(),t.EFF(3),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.JRh(e.spent.lumber||"-"),t.R7$(),t.SpI(" / ",e.costs.lumber)}}function oS(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",43),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.changeValue("lumber",n.fhSupportSpent,-1))}),t.nrm(1,"img",44),t.k0s(),t.j41(2,"span",45),t.EFF(3),t.k0s(),t.j41(4,"a",43),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.changeValue("lumber",n.fhSupportSpent,1))}),t.nrm(5,"img",46),t.k0s()}if(2&i){const e=t.XpG(3);t.Y8G("ngClass",t.eq3(6,Kt,0==e.fhSupportSpent.lumber)),t.R7$(2),t.Y8G("ghs-label","game.loot.")("ghs-label-attribute","title"),t.R7$(),t.Lme(" ",e.fhSupportSpent.lumber||"-"," / ",e.gameManager.game.party.loot.lumber||0," "),t.R7$(),t.Y8G("ngClass",t.eq3(8,Kt,!e.gameManager.game.party.loot.lumber||e.gameManager.game.party.loot.lumber==e.fhSupportSpent.lumber||e.spent.lumber==e.costs.lumber||e.repair&&e.paidResources==e.repair))}}function sS(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function rS(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",43),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$index,o=t.XpG(3);return t.Njj(o.changeValue("lumber",o.characterSpent[n],-1))}),t.nrm(1,"img",44),t.k0s(),t.j41(2,"span",45),t.EFF(3),t.k0s(),t.j41(4,"a",43),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$index,o=t.XpG(3);return t.Njj(o.changeValue("lumber",o.characterSpent[n],1))}),t.nrm(5,"img",46),t.k0s()}if(2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG(3);t.Y8G("ngClass",t.eq3(6,Kt,0==o.characterSpent[n].lumber)),t.R7$(2),t.Y8G("ghs-label","game.loot.")("ghs-label-attribute","title"),t.R7$(),t.Lme(" ",o.characterSpent[n].lumber||"-"," / ",a.progress.loot.lumber||0," "),t.R7$(),t.Y8G("ngClass",t.eq3(8,Kt,!a.progress.loot.lumber||a.progress.loot.lumber==o.characterSpent[n].lumber||o.spent.lumber==o.costs.lumber||o.repair&&o.paidResources==o.repair))}}function cS(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function lS(i,r){if(1&i&&(t.j41(0,"span",42),t.nVh(1,rS,6,10),t.nVh(2,cS,2,0,"span"),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.vxM(e.progress.loot.lumber?1:-1),t.R7$(),t.vxM(e.progress.loot.lumber?-1:2)}}function gS(i,r){if(1&i&&(t.j41(0,"span",47),t.nrm(1,"img",17),t.nVh(2,aS,4,2,"span",16),t.k0s(),t.j41(3,"span",42),t.nVh(4,oS,6,10),t.nVh(5,sS,2,0,"span"),t.k0s(),t.Z7z(6,lS,3,2,"span",42,Wn)),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.sMw(4,Ya,!e.repair,e.spent.lumber,e.spent.lumber==e.costs.lumber||e.requiredResources-(e.discount?1:0)==e.paidResources)),t.R7$(2),t.vxM(e.repair?-1:2),t.R7$(2),t.vxM(e.gameManager.game.party.loot.lumber?4:-1),t.R7$(),t.vxM(e.gameManager.game.party.loot.lumber?-1:5),t.R7$(),t.Dyx(e.characters)}}function dS(i,r){if(1&i&&(t.j41(0,"span",16)(1,"span",37),t.EFF(2),t.k0s(),t.EFF(3),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.JRh(e.spent.metal||"-"),t.R7$(),t.SpI(" / ",e.costs.metal)}}function hS(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",43),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.changeValue("metal",n.fhSupportSpent,-1))}),t.nrm(1,"img",44),t.k0s(),t.j41(2,"span",45),t.EFF(3),t.k0s(),t.j41(4,"a",43),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.changeValue("metal",n.fhSupportSpent,1))}),t.nrm(5,"img",46),t.k0s()}if(2&i){const e=t.XpG(3);t.Y8G("ngClass",t.eq3(6,Kt,0==e.fhSupportSpent.metal)),t.R7$(2),t.Y8G("ghs-label","game.loot.")("ghs-label-attribute","title"),t.R7$(),t.Lme(" ",e.fhSupportSpent.metal||"-"," / ",e.gameManager.game.party.loot.metal||0," "),t.R7$(),t.Y8G("ngClass",t.eq3(8,Kt,!e.gameManager.game.party.loot.metal||e.gameManager.game.party.loot.metal==e.fhSupportSpent.metal||e.spent.metal==e.costs.metal||e.repair&&e.paidResources==e.repair))}}function _S(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function mS(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",43),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$index,o=t.XpG(3);return t.Njj(o.changeValue("metal",o.characterSpent[n],-1))}),t.nrm(1,"img",44),t.k0s(),t.j41(2,"span",45),t.EFF(3),t.k0s(),t.j41(4,"a",43),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$index,o=t.XpG(3);return t.Njj(o.changeValue("metal",o.characterSpent[n],1))}),t.nrm(5,"img",46),t.k0s()}if(2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG(3);t.Y8G("ngClass",t.eq3(6,Kt,0==o.characterSpent[n].metal)),t.R7$(2),t.Y8G("ghs-label","game.loot.")("ghs-label-attribute","title"),t.R7$(),t.Lme(" ",o.characterSpent[n].metal||"-"," / ",a.progress.loot.metal||0," "),t.R7$(),t.Y8G("ngClass",t.eq3(8,Kt,!a.progress.loot.metal||a.progress.loot.metal==o.characterSpent[n].metal||o.spent.metal==o.costs.metal||o.repair&&o.paidResources==o.repair))}}function pS(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function uS(i,r){if(1&i&&(t.j41(0,"span",42),t.nVh(1,mS,6,10),t.nVh(2,pS,2,0,"span"),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.vxM(e.progress.loot.metal?1:-1),t.R7$(),t.vxM(e.progress.loot.metal?-1:2)}}function fS(i,r){if(1&i&&(t.j41(0,"span",47),t.nrm(1,"img",18),t.nVh(2,dS,4,2,"span",16),t.k0s(),t.j41(3,"span",42),t.nVh(4,hS,6,10),t.nVh(5,_S,2,0,"span"),t.k0s(),t.Z7z(6,uS,3,2,"span",42,Wn)),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.sMw(4,Ya,!e.repair,e.spent.metal,e.spent.metal==e.costs.metal||e.requiredResources-(e.discount?1:0)==e.paidResources)),t.R7$(2),t.vxM(e.repair?-1:2),t.R7$(2),t.vxM(e.gameManager.game.party.loot.metal?4:-1),t.R7$(),t.vxM(e.gameManager.game.party.loot.metal?-1:5),t.R7$(),t.Dyx(e.characters)}}function CS(i,r){if(1&i&&(t.j41(0,"span",16)(1,"span",37),t.EFF(2),t.k0s(),t.EFF(3),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.JRh(e.spent.hide||"-"),t.R7$(),t.SpI(" / ",e.costs.hide)}}function MS(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",43),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.changeValue("hide",n.fhSupportSpent,-1))}),t.nrm(1,"img",44),t.k0s(),t.j41(2,"span",45),t.EFF(3),t.k0s(),t.j41(4,"a",43),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.changeValue("hide",n.fhSupportSpent,1))}),t.nrm(5,"img",46),t.k0s()}if(2&i){const e=t.XpG(3);t.Y8G("ngClass",t.eq3(6,Kt,0==e.fhSupportSpent.hide)),t.R7$(2),t.Y8G("ghs-label","game.loot.")("ghs-label-attribute","title"),t.R7$(),t.Lme(" ",e.fhSupportSpent.hide||"-"," / ",e.gameManager.game.party.loot.hide||0," "),t.R7$(),t.Y8G("ngClass",t.eq3(8,Kt,!e.gameManager.game.party.loot.hide||e.gameManager.game.party.loot.hide==e.fhSupportSpent.hide||e.spent.hide==e.costs.hide||e.repair&&e.paidResources==e.repair))}}function vS(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function OS(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",43),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$index,o=t.XpG(3);return t.Njj(o.changeValue("hide",o.characterSpent[n],-1))}),t.nrm(1,"img",44),t.k0s(),t.j41(2,"span",45),t.EFF(3),t.k0s(),t.j41(4,"a",43),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$index,o=t.XpG(3);return t.Njj(o.changeValue("hide",o.characterSpent[n],1))}),t.nrm(5,"img",46),t.k0s()}if(2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG(3);t.Y8G("ngClass",t.eq3(6,Kt,0==o.characterSpent[n].hide)),t.R7$(2),t.Y8G("ghs-label","game.loot.")("ghs-label-attribute","title"),t.R7$(),t.Lme(" ",o.characterSpent[n].hide||"-"," / ",a.progress.loot.hide||0," "),t.R7$(),t.Y8G("ngClass",t.eq3(8,Kt,!a.progress.loot.hide||a.progress.loot.hide==o.characterSpent[n].hide||o.spent.hide==o.costs.hide||o.repair&&o.paidResources==o.repair))}}function PS(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function bS(i,r){if(1&i&&(t.j41(0,"span",42),t.nVh(1,OS,6,10),t.nVh(2,PS,2,0,"span"),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.vxM(e.progress.loot.hide?1:-1),t.R7$(),t.vxM(e.progress.loot.hide?-1:2)}}function kS(i,r){if(1&i&&(t.j41(0,"span",47),t.nrm(1,"img",19),t.nVh(2,CS,4,2,"span",16),t.k0s(),t.j41(3,"span",42),t.nVh(4,MS,6,10),t.nVh(5,vS,2,0,"span"),t.k0s(),t.Z7z(6,bS,3,2,"span",42,Wn)),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.sMw(4,Ya,!e.repair,e.spent.hide,e.spent.hide==e.costs.hide||e.requiredResources-(e.discount?1:0)==e.paidResources)),t.R7$(2),t.vxM(e.repair?-1:2),t.R7$(2),t.vxM(e.gameManager.game.party.loot.hide?4:-1),t.R7$(),t.vxM(e.gameManager.game.party.loot.hide?-1:5),t.R7$(),t.Dyx(e.characters)}}function yS(i,r){if(1&i&&(t.j41(0,"div",34)(1,"span",35),t.nVh(2,J8,4,2,"span",5),t.nVh(3,Z8,1,1,"span",11),t.k0s(),t.j41(4,"span",36),t.nrm(5,"span",11),t.k0s(),t.Z7z(6,Q8,4,5,"span",36,Wn),t.nVh(8,iS,10,7),t.nVh(9,gS,8,8),t.nVh(10,fS,8,8),t.nVh(11,kS,8,8),t.k0s()),2&i){const e=t.XpG();t.xc7("--ghs-summary-columns",2+e.characters.length),t.R7$(),t.Y8G("ngClass",t.ziG(10,w8,!e.repair,e.repair,e.paidResources,e.requiredResources-(e.discount?1:0)<=e.paidResources)),t.R7$(),t.vxM(e.repair?2:-1),t.R7$(),t.vxM(e.repair?-1:3),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.supply"),t.R7$(),t.Dyx(e.characters),t.R7$(2),t.vxM(e.costs.gold?8:-1),t.R7$(),t.vxM(e.costs.lumber?9:-1),t.R7$(),t.vxM(e.costs.metal?10:-1),t.R7$(),t.vxM(e.costs.hide?11:-1)}}function xS(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",48),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.confirm(!0))}),t.nrm(1,"span",11),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.buildings.selectResources.morale"))}function ES(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",49),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.confirm())}),t.nrm(1,"span",11),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(2,Kt,!e.force&&(e.requiredResources-(e.discount?1:0)>e.paidResources||e.costs.gold&&e.costs.gold>e.spent.gold||!1))),t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.buildings.selectResources.confirm")}}let Jn=(()=>{class i{data;dialogRef;dialog;gameManager=s.E;settingsManager=m.f;building;action;costs;requiredResources;paidResources=0;repair;force;characters=[];characterSpent=[];fhSupportSpent={gold:0,hide:0,lumber:0,metal:0,prosperity:0,manual:0};spent={gold:0,hide:0,lumber:0,metal:0,prosperity:0,manual:0};rewards;rewardsOnly;discount;constructor(e,a,n){if(this.data=e,this.dialogRef=a,this.dialog=n,this.repair=e.repair||0,this.requiredResources=this.repair,this.building=e.building,this.action=e.action,this.force=e.force||!1,this.rewardsOnly="rewards"==this.action,this.discount=null!=s.E.game.party.buildings.find(o=>"carpenter"==o.name&&o.level>0&&"wrecked"!=o.state)&&!this.repair,!this.repair&&this.building){this.costs=e.costs||{gold:0,hide:0,lumber:0,metal:0,prosperity:0,manual:0},this.costs.gold=this.costs.gold||0,this.costs.hide=this.costs.hide||0,this.costs.lumber=this.costs.lumber||0,this.costs.metal=this.costs.metal||0,this.requiredResources=this.costs.hide+this.costs.lumber+this.costs.metal;let o=this.discount;this.fhSupportSpent.lumber=this.costs.lumber-(o?1:0),o=!1,this.fhSupportSpent.lumber>(s.E.game.party.loot[ot.r6.lumber]||0)&&(this.fhSupportSpent.lumber=s.E.game.party.loot[ot.r6.lumber]||0,o=this.discount),this.spent[ot.r6.lumber]=this.fhSupportSpent.lumber,this.paidResources+=this.fhSupportSpent.lumber,this.fhSupportSpent.metal=this.costs.metal-(o?1:0),o=!1,this.fhSupportSpent.metal>(s.E.game.party.loot[ot.r6.metal]||0)&&(this.fhSupportSpent.metal=s.E.game.party.loot[ot.r6.metal]||0,o=this.discount),this.spent[ot.r6.metal]=this.fhSupportSpent.metal,this.paidResources+=this.fhSupportSpent.metal,this.fhSupportSpent.hide=this.costs.hide-(o?1:0),o=!1,this.fhSupportSpent.hide>(s.E.game.party.loot[ot.r6.hide]||0)&&(this.fhSupportSpent.hide=s.E.game.party.loot[ot.r6.hide]||0,o=this.discount),this.spent[ot.r6.hide]=this.fhSupportSpent.hide,this.paidResources+=this.fhSupportSpent.hide,("build"==this.action||"upgrade"==this.action)&&this.building.data.rewards&&this.building.data.rewards[this.building.model.level]?this.rewards=this.building.data.rewards[this.building.model.level]:"rewards"==this.action&&this.building.data.rewards&&this.building.data.rewards[this.building.model.level-1]&&(this.rewards=this.building.data.rewards[this.building.model.level-1])}else this.costs={gold:e.costs&&e.costs.gold||0,hide:this.repair,lumber:this.repair,metal:this.repair,prosperity:0,manual:0};this.characters=s.E.game.figures.filter(o=>o instanceof q.K).map(o=>o),this.characters.forEach((o,g)=>{this.characterSpent[g]={gold:0,hide:0,lumber:0,metal:0,prosperity:0,manual:0}})}ngOnInit(){this.force&&(!m.f.settings.applyBuildingRewards||!s.E.game.party.campaignMode)&&this.dialogRef.close(!0)}changeValue(e,a,n){a[e]+=n,this.spent[e]+=n,"gold"!=e&&"prosperity"!=e&&(this.paidResources+=n)}sectionRewards(e,a=""){const n=s.E.sectionData(a||s.E.currentEdition()).find(o=>o.index==e);if(this.rewardsOnly&&n){const o=s.E.buildingsManager.rewardSection(n),g=s.E.sectionData(n.edition).filter(_=>_.conclusion&&!_.parent&&_.parentSections&&_.parentSections.find(y=>1==y.length&&-1!=y.indexOf(n.index))&&0==s.E.scenarioManager.getRequirements(_).length);if(o||0==g.length){const _=new ht.Nz(o||n);this.close(),this.dialog.open(Yt,{panelClass:["dialog"],data:{scenario:_,success:!0,conclusionOnly:!0,rewardsOnly:null!=o}})}else g.length>0&&this.dialog.open(Se,{panelClass:["dialog"],data:{conclusions:g,parent:n}}).closed.subscribe({next:_=>{_&&this.sectionRewards(_.index,_.edition)}})}}confirm(e=!1){this.force?(0,V.co)(this.dialogRef,!0):e?(0,V.co)(this.dialogRef,new $e.CS(this.characters,this.characterSpent,this.fhSupportSpent,1)):this.paidResources>=this.requiredResources-(this.discount?1:0)&&(!this.costs.gold||this.costs.gold==this.spent.gold)&&(0,V.co)(this.dialogRef,new $e.CS(this.characters,this.characterSpent,this.fhSupportSpent))}close(){(0,V.co)(this.dialogRef)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-buildings-upgrade-dialog"]],standalone:!1,decls:16,vars:16,consts:[[1,"move-resources-dialog",3,"ngClass"],[1,"title"],[1,"name"],[1,"building"],[1,"costs",3,"ngClass"],[1,"costs"],[1,"lose-morale",3,"ghs-label","ghs-label-args"],[1,"rewards"],[1,"table",3,"--ghs-summary-columns"],[1,"menu"],[1,"cancel",3,"click"],[3,"ghs-label"],[1,"morale"],[1,"apply",3,"ngClass"],[1,"action",3,"src"],[3,"ghs-label","ghs-label-args"],[1,"cost"],["src","./assets/images/fh/loot/lumber.svg",1,"ghs-svg"],["src","./assets/images/fh/loot/metal.svg",1,"ghs-svg"],["src","./assets/images/fh/loot/hide.svg",1,"ghs-svg"],["src","./assets/images/fh/loot.svg",1,"ghs-svg"],["src","./assets/images/fh/loot/lumber.svg"],["src","./assets/images/fh/loot/metal.svg"],["src","./assets/images/fh/loot/hide.svg"],[1,"cost",3,"ghs-label"],[1,"text-white","prosperity",3,"ghs-label","ghs-label-args"],[1,"text-white","defense",3,"ghs-label","ghs-label-args"],[1,"text-white","soldiers",3,"ghs-label","ghs-label-args"],[1,"text-white","plots",3,"ghs-label","ghs-label-args"],[1,"text-white","items",3,"ghs-label","ghs-label-args"],[1,"text-white","section",3,"ngClass","ghs-label","ghs-label-args"],[1,"text-white","errata"],[1,"text-white","section",3,"click","ngClass","ghs-label","ghs-label-args"],[1,"text",3,"ghs-label"],[1,"table"],[1,"head-col",3,"ngClass"],[1,"first"],[1,"current"],[1,"icon","character-icon",3,"src"],[1,"name",3,"ngClass"],[1,"head-col","calc-col","costs",3,"ngClass"],[1,"ghs-svg",3,"src"],[1,"calc-col"],[1,"button",3,"click","ngClass"],["src","./assets/images/minus.svg",1,"ghs-svg"],[1,"value",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg",1,"ghs-svg"],[1,"head-col","calc-col",3,"ngClass"],[1,"morale",3,"click"],[1,"apply",3,"click","ngClass"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"label",1),t.nVh(2,T8,3,2,"span",2),t.nVh(3,S8,3,5,"span",3),t.nVh(4,$8,2,1,"span",2),t.nVh(5,F8,5,7,"span",4),t.nVh(6,X8,8,7,"span",4),t.nVh(7,B8,2,1,"div",5),t.nVh(8,Y8,1,4,"span",6),t.nVh(9,W8,8,7,"div",7),t.k0s(),t.nVh(10,yS,12,15,"div",8),t.j41(11,"div",9)(12,"a",10),t.bIt("click",function(){return n.close()}),t.nrm(13,"span",11),t.k0s(),t.nVh(14,xS,2,1,"a",12),t.nVh(15,ES,2,4,"a",13),t.k0s()()),2&a&&(t.Y8G("ngClass",t.l_i(13,x8,"fh"==n.settingsManager.settings.theme,"modern"==n.settingsManager.settings.theme)),t.R7$(2),t.vxM(n.building?2:-1),t.R7$(),t.vxM(n.building?3:-1),t.R7$(),t.vxM(n.building||"soldiers"!=n.action?-1:4),t.R7$(),t.vxM(n.rewardsOnly?-1:5),t.R7$(),t.vxM(n.repair&&!n.rewardsOnly?6:-1),t.R7$(),t.vxM(n.discount&&!n.force?7:-1),t.R7$(),t.vxM(n.rewards&&n.rewards.loseMorale?8:-1),t.R7$(),t.vxM(n.rewards?9:-1),t.R7$(),t.vxM(!(n.costs.gold||n.costs.hide||n.costs.lumber||n.costs.metal)||n.force||n.rewardsOnly?-1:10),t.R7$(3),t.Y8G("ghs-label",n.rewardsOnly?"close":"cancel"),t.R7$(),t.vxM(!n.rewardsOnly&&n.repair&&n.gameManager.game.party.morale>0?14:-1),t.R7$(),t.vxM(n.rewardsOnly?-1:15))},dependencies:[N.YU,tt],styles:[".move-resources-dialog[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto;margin:0 .3em}.move-resources-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline);margin-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   img.action[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2.6 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor))}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]   .cost[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]   .cost[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .costs.force[_ngcontent-%COMP%]   .cost[_ngcontent-%COMP%]{color:var(--ghs-color-gray);text-shadow:none;opacity:.5}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .costs.force[_ngcontent-%COMP%]   .cost[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .lose-morale[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));color:#000;text-shadow:none;padding:.1em 1em;margin-top:.5em;background:radial-gradient(ellipse at center,#98c2c0,#4b9490 75%);clip-path:polygon(100% 0%,93% 50%,100% 100%,0 100%,7% 50%,0 0%)}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .rewards[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;min-width:calc(var(--ghs-unit) * 35 * var(--ghs-dialog-factor));margin-top:.5em;padding-top:.5em;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));border-top:.1em solid var(--ghs-color-gray)}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .rewards[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{cursor:pointer}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .rewards[_ngcontent-%COMP%]   .errata[_ngcontent-%COMP%]{text-align:justify;max-width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor))}.move-resources-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .rewards[_ngcontent-%COMP%]   .errata[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-style:italic}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]{--ghs-summary-columns: 5;font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));display:grid;grid-template-columns:repeat(var(--ghs-summary-columns),auto);padding-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));color:var(--ghs-color-white);overflow:auto}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-white)}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;text-align:center;padding:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));border-bottom:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-white);border-right:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-darkgray)}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-weight:700;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));flex-direction:row;justify-content:flex-end;background-image:url(dialog_background.fa4ff388462f6a00.png);position:sticky;left:0;z-index:1}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col.calc-col[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:.6}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col.costs[_ngcontent-%COMP%]   .cost[_ngcontent-%COMP%]{white-space:nowrap}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col.costs[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-red)}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col.costs[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col.costs.some[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col.costs.some[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col.costs.full[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col.costs.full[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .calc-col[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:.6}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .first[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);border-top:none}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--ghs-color-white);display:flex;justify-content:center;align-items:center;padding:0 .15em;white-space:nowrap}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;padding:0 .15em}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.move-resources-dialog[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .button.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important;opacity:.6}.move-resources-dialog.fh[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.move-resources-dialog.modern[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:2em;padding:.3em}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.morale[_ngcontent-%COMP%]{color:var(--ghs-color-blue)}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}.move-resources-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}"]})}return i})();const dr=i=>({disabled:i}),Na=i=>({total:i}),Di=(i,r)=>r.edition+"-"+r.name;function wS(i,r){if(1&i&&(t.j41(0,"th")(1,"span",10),t.nrm(2,"img",11),t.j41(3,"span",12),t.EFF(4),t.k0s()()()),2&i){const e=r.$implicit,a=t.XpG();t.R7$(2),t.Y8G("src",e.iconUrl,t.B4B),t.R7$(2),t.SpI(" ",a.gameManager.characterManager.characterName(e,!0)," ")}}function RS(i,r){if(1&i&&(t.j41(0,"span",7),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.progress.gold||"-")}}function jS(i,r){if(1&i){const e=t.RV6();t.j41(0,"input",14),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG().$implicit;return t.DH7(o.progress.gold,n)||(o.progress.gold=n),t.Njj(n)}),t.bIt("change",function(n){t.eBV(e);const o=t.XpG().$implicit,g=t.XpG();return t.Njj(g.changeGold(o,n))}),t.k0s()}if(2&i){const e=t.XpG().$implicit;t.R50("ngModel",e.progress.gold)}}function GS(i,r){if(1&i&&(t.j41(0,"td"),t.nVh(1,RS,2,1,"span",7),t.nVh(2,jS,1,1,"input",13),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.vxM(e.edit?-1:1),t.R7$(),t.vxM(e.edit?2:-1)}}function TS(i,r){if(1&i&&(t.j41(0,"span",7),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.progress.experience||"-")}}function SS(i,r){if(1&i){const e=t.RV6();t.j41(0,"input",14),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG().$implicit;return t.DH7(o.progress.experience,n)||(o.progress.experience=n),t.Njj(n)}),t.bIt("change",function(n){t.eBV(e);const o=t.XpG().$implicit,g=t.XpG();return t.Njj(g.changeXP(o,n))}),t.k0s()}if(2&i){const e=t.XpG().$implicit;t.R50("ngModel",e.progress.experience)}}function $S(i,r){if(1&i&&(t.j41(0,"td"),t.nVh(1,TS,2,1,"span",7),t.nVh(2,SS,1,1,"input",13),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.vxM(e.edit?-1:1),t.R7$(),t.vxM(e.edit?2:-1)}}function DS(i,r){if(1&i&&(t.j41(0,"span",7),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(),t.JRh(a.party.loot[e]||"-")}}function IS(i,r){if(1&i){const e=t.RV6();t.j41(0,"input",14),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG().$implicit,g=t.XpG();return t.DH7(g.party.loot[o],n)||(g.party.loot[o]=n),t.Njj(n)}),t.bIt("change",function(n){t.eBV(e);const o=t.XpG().$implicit,g=t.XpG();return t.Njj(g.changeLoot(void 0,o,n))}),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG();t.R50("ngModel",a.party.loot[e])}}function AS(i,r){if(1&i&&(t.j41(0,"span",7),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG().$implicit;t.R7$(),t.JRh(e.progress.loot[a]||"-")}}function VS(i,r){if(1&i){const e=t.RV6();t.j41(0,"input",14),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG().$implicit,g=t.XpG().$implicit;return t.DH7(o.progress.loot[g],n)||(o.progress.loot[g]=n),t.Njj(n)}),t.bIt("change",function(n){t.eBV(e);const o=t.XpG().$implicit,g=t.XpG().$implicit,_=t.XpG();return t.Njj(_.changeLoot(o,g,n))}),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG().$implicit;t.R50("ngModel",e.progress.loot[a])}}function FS(i,r){if(1&i&&(t.j41(0,"td"),t.nVh(1,AS,2,1,"span",7),t.nVh(2,VS,1,1,"input",13),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.vxM(e.edit?-1:1),t.R7$(),t.vxM(e.edit?2:-1)}}function XS(i,r){if(1&i&&(t.j41(0,"tr")(1,"th",5),t.nrm(2,"img",6),t.k0s(),t.j41(3,"td"),t.nVh(4,DS,2,1,"span",7),t.nVh(5,IS,1,1,"input",13),t.k0s(),t.Z7z(6,FS,3,2,"td",null,Di),t.j41(8,"td")(9,"span",8),t.EFF(10),t.k0s()()()),2&i){const e=r.$implicit,a=t.XpG();t.R7$(),t.Y8G("ghs-tooltip","game.loot."+e),t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+e+".svg",t.B4B),t.R7$(2),t.vxM(a.edit?-1:4),t.R7$(),t.vxM(a.edit?5:-1),t.R7$(),t.Dyx(a.characters),t.R7$(3),t.Y8G("ngClass",t.eq3(6,Na,a.total[e])),t.R7$(),t.JRh(a.total[e]||"-")}}function BS(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",9)(1,"a",15),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.close())}),t.nrm(2,"span",3),t.k0s(),t.j41(3,"a",16),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.apply())}),t.nrm(4,"span",3),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","cancel"),t.R7$(),t.Y8G("ngClass",t.eq3(3,dr,!e.edited)),t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.supply.apply")}}let hr=(()=>{class i{dialogRef;dialog;gameManager=s.E;party=new $i.r;characters=[];total={};totalGold=0;totalXP=0;lootColumns=ot.s$;edit=!1;edited=!1;constructor(e,a){this.dialogRef=e,this.dialog=a,this.edit=e.disableClose||!1}ngOnInit(){this.party=JSON.parse(JSON.stringify(s.E.game.party)),this.characters=s.E.game.figures.filter(e=>e instanceof q.K).map(e=>JSON.parse(JSON.stringify(e))),this.update()}toggleEdit(){this.dialogRef.close(),this.dialog.open(i,this.edit?{panelClass:["dialog","no-open-animation"]}:{panelClass:["dialog","no-open-animation"],disableClose:!0})}update(){this.lootColumns.forEach(e=>{this.total[e]=s.E.game.party.loot[e]||0,this.characters.length>0&&(this.total[e]=(this.total[e]||0)+this.characters.map(a=>a.progress.loot[e]||0).reduce((a,n)=>a+n))}),this.characters.length&&(this.totalGold=this.characters.map(e=>e.progress.gold||0).reduce((e,a)=>e+a),this.totalXP=this.characters.map(e=>e.progress.experience||0).reduce((e,a)=>e+a))}changeLoot(e,a,n){e?e.progress.loot[a]=+n.target.value||void 0:this.party.loot[a]=+n.target.value||void 0,this.update(),this.edited=!0}changeGold(e,a){e.progress.gold=+a.target.value,this.update(),this.edited=!0}changeXP(e,a){e.progress.experience=+a.target.value,this.update(),this.edited=!0}apply(){s.E.stateManager.before("applyResourceChange"),s.E.game.party.loot=this.party.loot,s.E.game.figures.filter(e=>e instanceof q.K).forEach(e=>{const a=this.characters.find(n=>n.edition==e.edition&&n.name==e.name);a&&(e.progress=a.progress)}),s.E.stateManager.after(),(0,V.co)(this.dialogRef)}close(){(0,V.co)(this.dialogRef)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-party-resources"]],standalone:!1,decls:41,vars:20,consts:[[1,"resources-dialog"],[1,"scroll-container"],[3,"click","ngClass"],[3,"ghs-label"],["type","checkbox",3,"checked"],[3,"ghs-tooltip"],[1,"ghs-svg",3,"src"],[1,"loot"],[1,"loot",3,"ngClass"],[1,"buttons"],[1,"character"],[1,"icon","character-icon",3,"src"],[1,"name"],["type","number","min","0",3,"ngModel"],["type","number","min","0",3,"ngModelChange","change","ngModel"],[1,"cancel",3,"click"],[1,"apply",3,"click","ngClass"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"table")(3,"thead")(4,"tr")(5,"th")(6,"label",2),t.bIt("click",function(){return n.toggleEdit()}),t.nrm(7,"span",3)(8,"input",4),t.k0s()(),t.j41(9,"th"),t.nrm(10,"span",3),t.k0s(),t.Z7z(11,wS,5,2,"th",null,Di),t.j41(13,"th"),t.nrm(14,"span",3),t.k0s()()(),t.j41(15,"tbody")(16,"tr")(17,"th",5),t.nrm(18,"img",6),t.k0s(),t.j41(19,"td")(20,"span",7),t.EFF(21,"-"),t.k0s()(),t.Z7z(22,GS,3,2,"td",null,Di),t.j41(24,"td")(25,"span",8),t.EFF(26),t.k0s()()(),t.j41(27,"tr")(28,"th",5),t.nrm(29,"img",6),t.k0s(),t.j41(30,"td")(31,"span",7),t.EFF(32,"-"),t.k0s()(),t.Z7z(33,$S,3,2,"td",null,Di),t.j41(35,"td")(36,"span",8),t.EFF(37),t.k0s()()(),t.Z7z(38,XS,11,8,"tr",null,t.fX1),t.k0s()()(),t.nVh(40,BS,5,5,"div",9),t.k0s()),2&a&&(t.R7$(6),t.Y8G("ngClass",t.eq3(14,dr,n.edited)),t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.supply.edit"),t.R7$(),t.Y8G("checked",n.edit),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.supply"),t.R7$(),t.Dyx(n.characters),t.R7$(3),t.Y8G("ghs-label","party.campaign.sheet.supply.total"),t.R7$(3),t.Y8G("ghs-tooltip","character.progress.gold"),t.R7$(),t.Y8G("src","./assets/images/loot.svg",t.B4B),t.R7$(4),t.Dyx(n.characters),t.R7$(3),t.Y8G("ngClass",t.eq3(16,Na,n.totalGold)),t.R7$(),t.JRh(n.totalGold||"-"),t.R7$(2),t.Y8G("ghs-tooltip","game.experience"),t.R7$(),t.Y8G("src","./assets/images/experience.svg",t.B4B),t.R7$(4),t.Dyx(n.characters),t.R7$(3),t.Y8G("ngClass",t.eq3(18,Na,n.totalXP)),t.R7$(),t.JRh(n.totalXP||"-"),t.R7$(),t.Dyx(n.lootColumns),t.R7$(2),t.vxM(n.edit||n.edited?40:-1))},dependencies:[N.YU,O.me,O.Q0,O.BC,O.VZ,O.vS,tt,ft],styles:['.resources-dialog[_ngcontent-%COMP%]{position:relative;color:var(--ghs-color-white)}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{border-collapse:collapse;width:100%;margin:0;padding:0;font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor))}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{margin:0;padding:0;border-bottom:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-darkgray)}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));display:flex;justify-content:flex-end;align-items:center}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.5}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:relative;z-index:1}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:relative;z-index:2}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));max-width:100%;text-align:center;border:none;outline:none}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(odd)   td[_ngcontent-%COMP%]:before, .resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(odd)   th[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:0;background-color:var(--ghs-color-darkgray);opacity:.3;z-index:0}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]:before, .resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   th[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:0;background-color:var(--ghs-color-yellow);opacity:.5;z-index:0}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle;padding:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));border-right:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-darkgray)}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:right;font-family:var(--ghs-font-title);font-weight:initial}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);text-align:center}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.resources-dialog[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-white)}.resources-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-between;align-items:center}.resources-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;min-width:33%;display:flex;justify-content:center}.resources-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.resources-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.resources-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.resources-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}']})}return i})();var _r=M(67381),sn=M.n(_r);const YS=(i,r)=>({looted:i,highlight:r}),NS=(i,r)=>({selected:i,disabled:r}),zS=(i,r)=>[i,r],za=i=>[i],LS=(i,r)=>r.edition+"-"+r.name;function US(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function qS(i,r){if(1&i&&(t.j41(0,"span"),t.nVh(1,US,2,0,"span"),t.EFF(2),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.vxM(!(""+e).startsWith("G")&&+e<10&&+e>=0?1:-1),t.R7$(),t.JRh(e)}}function HS(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"???"),t.k0s())}function KS(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",8),t.bIt("click",function(){const n=t.eBV(e).$index,o=t.XpG();return t.Njj(o.toggleTreasure(n))}),t.nVh(1,qS,3,2,"span"),t.nVh(2,HS,2,0,"span"),t.nrm(3,"img",9),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG();t.Y8G("ngClass",t.l_i(3,YS,-1!=n.looted.indexOf(a),a==n.treasureIndex)),t.R7$(),t.vxM((""+e).startsWith("G")||+e>=0?1:-1),t.R7$(),t.vxM(!(""+e).startsWith("G")&&+e<0?2:-1)}}function WS(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function JS(i,r){if(1&i&&(t.j41(0,"span"),t.nVh(1,WS,2,0,"span"),t.EFF(2),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.vxM(!(""+e).startsWith("G")&&+e<10&&+e>=0?1:-1),t.R7$(),t.SpI(" ",(""+e).startsWith("G-")?"G":(""+e).split(":")[0]," ")}}function ZS(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"???"),t.k0s())}function QS(i,r){if(1&i&&t.nrm(0,"ghs-treasure-label",16),2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.Y8G("edition",a.edition)("index",+(""+e).split(":")[0]-1)("rewardResults",a.gameManager.scenarioManager.treasureRewardsFromString(""+e))}}function t$(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",13)(1,"div",14),t.bIt("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG().$implicit,g=t.XpG();return t.Njj(g.removeTreasure(o,n))}),t.nVh(2,JS,3,2,"span"),t.nVh(3,ZS,2,0,"span"),t.k0s(),t.j41(4,"span",15),t.nVh(5,QS,1,3,"ghs-treasure-label",16),t.k0s()()}if(2&i){const e=r.$implicit;t.R7$(2),t.vxM((""+e).startsWith("G")||+(""+e).split(":")[0]>=0?2:-1),t.R7$(),t.vxM(!(""+e).startsWith("G")&&+(""+e).split(":")[0]<0?3:-1),t.R7$(2),t.vxM((""+e).startsWith("G-")?-1:5)}}function e$(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",10),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.toggleCharacter(n))}),t.nrm(1,"img",11),t.j41(2,"span",12),t.EFF(3),t.k0s(),t.j41(4,"div",3),t.Z7z(5,t$,6,3,"div",13,t.fX1),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.l_i(3,NS,a.character==e,a.treasures.length==a.looted.length)),t.R7$(),t.Y8G("src",e.iconUrl,t.B4B),t.R7$(2),t.SpI(" ",a.gameManager.characterManager.characterName(e,!0)," "),t.R7$(2),t.Dyx(e.treasures)}}function n$(i,r){if(1&i){const e=t.RV6();t.j41(0,"p"),t.nrm(1,"span",17),t.k0s(),t.j41(2,"div",18),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.lootTreasure())}),t.nrm(3,"span",2),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","game.loot.lootTreasure")("ghs-label-args",t.l_i(3,zS,e.character.title||"%data.character."+e.character.edition+"."+e.character.name+"%",(""+e.treasures[e.treasureIndex]).startsWith("G")||+e.treasures[e.treasureIndex]>=0?e.treasures[e.treasureIndex]:"'???'")),t.R7$(2),t.Y8G("ghs-label","game.loot.lootTreasure.confirm")}}function i$(i,r){if(1&i&&(t.j41(0,"p"),t.nrm(1,"span",17),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","game.loot.lootTreasure.selectTreasure")("ghs-label-args",t.eq3(2,za,e.character.title||"%data.character."+e.character.edition+"."+e.character.name+"%"))}}function a$(i,r){if(1&i&&(t.j41(0,"p"),t.nrm(1,"span",17),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","game.loot.lootTreasure.selectCharacter")("ghs-label-args",t.eq3(2,za,(""+e.treasures[e.treasureIndex]).startsWith("G-")?"G":+e.treasures[e.treasureIndex]>=0?""+e.treasures[e.treasureIndex]:"'???'"))}}function o$(i,r){1&i&&(t.j41(0,"span"),t.nrm(1,"span",2),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","game.loot.treasures.rewards.goal"))}function s$(i,r){if(1&i&&t.nrm(0,"ghs-treasure-label",19),2&i){const e=t.XpG(2);t.Y8G("edition",e.edition)("index",+e.treasures[e.treasureIndex]-1)("rewardResults",e.rewardResults)("itemCards",!0)}}function r$(i,r){if(1&i&&(t.j41(0,"p"),t.nrm(1,"span",17),t.k0s(),t.nVh(2,o$,2,1,"span"),t.nVh(3,s$,1,4,"ghs-treasure-label",19)),2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","game.loot.lootTreasure.looted")("ghs-label-args",t.eq3(4,za,e.character.title||"%data.character."+e.character.edition+"."+e.character.name+"%")),t.R7$(),t.vxM("G"==e.treasures[e.treasureIndex]?2:-1),t.R7$(),t.vxM("G"!=e.treasures[e.treasureIndex]?3:-1)}}let La=(()=>{class i{data;gameManager=s.E;scenario;characters=[];character;treasures=[];treasureIndex=-1;edition="";looted=[];rewardResults=[];init=!0;constructor(e,a){this.data=e,s.E.game.scenario||e.treasures&&e.edition?e&&e.treasures&&e.edition?(this.treasures=e.treasures,this.edition=e.edition):s.E.game.scenario&&(this.scenario=s.E.game.scenario||s.E.scenarioManager.createScenario(),this.edition=this.scenario.edition):(0,V.co)(a)}ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.update()}}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.scenario=s.E.game.scenario||s.E.scenarioManager.createScenario(),this.characters=s.E.game.figures.filter(a=>a instanceof q.K&&!a.absent&&s.E.entityManager.isAlive(a)).map(a=>a),this.scenario&&(!this.data||!this.data.treasures)&&(this.edition=this.scenario.edition,this.treasures=s.E.scenarioManager.getTreasures(this.scenario,s.E.game.sections)),this.looted=[];let e=-1;this.treasures.forEach((a,n)=>{-1==this.looted.indexOf(n)&&(this.characters.find(o=>s.E.lootManager.hasTreasure(o,a,n))||s.E.game.party.treasures.find(o=>o.name==""+a&&o.edition==this.edition))?this.looted.push(n):e=n}),this.init&&this.treasures.length==this.looted.length+1&&this.treasureIndex!=e&&-1==this.looted.indexOf(e)&&(this.treasureIndex=e),!this.character&&this.treasures.length!=this.looted.length&&(this.character=this.characters.find(a=>a.active)||this.characters.length>0&&this.characters[0]||void 0)}toggleCharacter(e){this.character!=e&&this.treasures.length!=this.looted.length?(this.character=e,-1!=this.treasureIndex&&-1!=this.looted.indexOf(this.treasureIndex)&&(this.treasureIndex=-1)):this.character=void 0}toggleTreasure(e){this.treasureIndex=this.treasureIndex!=e?e:-1}removeTreasure(e,a){"number"==typeof a?(s.E.stateManager.before("removeCharTresure",a>=0?""+a:"???",this.edition,s.E.characterManager.characterName(e)),this.looted.splice(this.treasures.indexOf(a),1)):(s.E.stateManager.before("removeCharTresure","G",this.edition),this.looted.splice(+a.replace("G-",""),1)),e.treasures.splice(e.treasures.indexOf(a),1),"number"==typeof a&&(s.E.game.party.treasures=s.E.game.party.treasures.filter(n=>n.edition!=this.edition||n.name!=""+a)),s.E.stateManager.after()}lootTreasure(){if(-1!=this.treasureIndex){this.init=!1,this.rewardResults=[];const e=this.treasures[this.treasureIndex];this.character&&e&&-1==this.character.treasures.indexOf("G"==e?"G-"+this.treasureIndex:e)&&(s.E.stateManager.before("lootCharTreasure",(""+e).startsWith("G")||+e>=0?""+e:"???",this.edition,s.E.characterManager.characterName(this.character)),this.looted.push(this.treasureIndex),"G"!=e&&m.f.settings.treasuresLoot&&(this.rewardResults=s.E.lootManager.lootTreasure(this.character,e-1,this.edition)),this.character.treasures=this.character.treasures||[],this.character.treasures.push("G"==e?"G-"+this.treasureIndex:this.rewardResults.some(a=>a.length>0)?e+":"+this.rewardResults.map(a=>a.join("+")).join("|"):e),"number"==typeof e&&s.E.game.party.treasures.push(new vt.gw(""+e,this.edition)),s.E.stateManager.after())}}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-scenario-treasures-dialog"]],standalone:!1,decls:14,vars:5,consts:[[1,"treasures-popup"],[1,"title"],[3,"ghs-label"],[1,"treasures"],[1,"treasure",3,"ngClass"],[1,"characters"],[1,"character",3,"ngClass"],[1,"loot"],[1,"treasure",3,"click","ngClass"],["src","./assets/images/check.svg",1,"overlay","check"],[1,"character",3,"click","ngClass"],[1,"icon",3,"src"],[1,"name"],[1,"hint-container"],["ghs-pointer-input","",1,"treasure","hint-trigger",3,"doubleClick"],[1,"hint","center"],[1,"text","placeholder","text-white",3,"edition","index","rewardResults"],[3,"ghs-label","ghs-label-args"],[1,"button",3,"click"],[1,"placeholder","text-white",3,"edition","index","rewardResults","itemCards"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"span",2),t.k0s(),t.j41(3,"div",3),t.Z7z(4,KS,4,6,"div",4,t.fX1),t.k0s(),t.j41(6,"div",5),t.Z7z(7,e$,7,6,"div",6,LS),t.k0s(),t.j41(9,"div",7),t.nVh(10,n$,4,6),t.nVh(11,i$,2,4,"p"),t.nVh(12,a$,2,4,"p"),t.nVh(13,r$,4,6),t.k0s()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","game.loot.treasures"),t.R7$(2),t.Dyx(n.treasures),t.R7$(3),t.Dyx(n.characters),t.R7$(3),t.vxM(n.character&&-1!=n.treasureIndex&&!n.gameManager.lootManager.hasTreasure(n.character,n.treasures[n.treasureIndex],n.treasureIndex)?10:-1),t.R7$(),t.vxM(n.character&&-1==n.treasureIndex?11:-1),t.R7$(),t.vxM(n.character||-1==n.treasureIndex?-1:12),t.R7$(),t.vxM(n.character&&-1!=n.treasureIndex&&n.gameManager.lootManager.hasTreasure(n.character,n.treasures[n.treasureIndex],n.treasureIndex)?13:-1))},dependencies:[N.YU,tt,rt,Pn],styles:[".treasures-popup[_ngcontent-%COMP%]{text-align:center;color:var(--ghs-color-white);padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 35 * var(--ghs-dialog-factor))}.treasures-popup[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;justify-content:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.treasures-popup[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap}.treasures-popup[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;justify-content:center;background-image:url(treasure.0792d529e76ec279.png);background-size:contain;background-repeat:no-repeat;background-position:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-black);width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));transition:translate calc(var(--ghs-animation-speed) * .5s) ease-in-out}.treasures-popup[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{display:none;position:absolute;top:30%;left:50%;transform:translate(-50%);height:50%;width:auto}.treasures-popup[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .overlay.check[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.treasures-popup[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]:hover{opacity:.8;transform:scale(1.1)}.treasures-popup[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.looted[_ngcontent-%COMP%]{pointer-events:none;opacity:.4}.treasures-popup[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.looted[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .treasures-popup[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.highlight[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{display:block}.treasures-popup[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.treasures-popup[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;margin:.25em;padding:.25em;border:1px solid transparent}.treasures-popup[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline)}.treasures-popup[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:1.5em;height:auto;margin-right:.2em;filter:grayscale(.7)}.treasures-popup[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]:hover{color:var(--ghs-color-darkgray);border-color:var(--ghs-color-darkgray)}.treasures-popup[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]:hover   .icon[_ngcontent-%COMP%]{filter:grayscale(.3)}.treasures-popup[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character.disabled[_ngcontent-%COMP%]{cursor:initial!important;border-color:transparent}.treasures-popup[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character.selected[_ngcontent-%COMP%]{color:var(--ghs-color-white);border-color:var(--ghs-color-gray)}.treasures-popup[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character.selected[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{filter:none}.treasures-popup[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]{position:relative}.treasures-popup[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]{cursor:help!important;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.treasures-popup[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));min-height:calc(var(--ghs-unit) * 10 * var(--ghs-dialog-factor))}.treasures-popup[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:0;margin:0}.treasures-popup[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));color:var(--ghs-color-green)}.treasures-popup[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{opacity:.6}"]})}return i})();const c$=["treasureIndex"],l$=(i,r)=>({looted:i,highlight:r}),mr=i=>({disabled:i}),g$=(i,r)=>r.edition+"-"+r.index;function d$(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",11),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.batchSelect,n)||(o.batchSelect=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.update())}),t.k0s(),t.nrm(2,"span",4),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.R50("ngModel",e.batchSelect),t.R7$(),t.Y8G("ghs-label","party.campaign.treasures.batchSelect")}}function h$(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function _$(i,r){if(1&i&&(t.j41(0,"span",18),t.nrm(1,"ghs-treasure-label",19),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG().$implicit;t.R7$(),t.Y8G("edition",a.edition)("index",e)}}function m$(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",14)(1,"div",15),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.toggleTreasure(n))}),t.nVh(2,h$,2,0,"span"),t.EFF(3),t.nrm(4,"img",16)(5,"img",17),t.k0s(),t.nVh(6,_$,2,2,"span",18),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.l_i(4,l$,-1!=a.looted.indexOf(e),-1!=a.selected.indexOf(e))),t.R7$(),t.vxM(e<10?2:-1),t.R7$(),t.SpI("",e," "),t.R7$(3),t.vxM(-1!=a.looted.indexOf(e)?6:-1)}}function p$(i,r){if(1&i&&(t.j41(0,"div",6)(1,"div",2),t.nrm(2,"span",12)(3,"span",12),t.k0s(),t.j41(4,"div",13),t.Z7z(5,m$,7,7,"div",14,t.fX1),t.k0s()()),2&i){const e=r.$implicit,a=t.XpG();t.R7$(2),t.Y8G("ghs-label","%data.scenarioNumber:"+e.index+"%"),t.R7$(),t.Y8G("ghs-label",a.gameManager.scenarioManager.scenarioTitle(e)),t.R7$(2),t.Dyx(a.treasures[e.index])}}function u$(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",20),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleTreasure(n.selected[0],!0))}),t.nrm(1,"span",4),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(2,mr,0==e.selected.length)),t.R7$(),t.Y8G("ghs-label","party.campaign.treasures.loot")}}function f$(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",21),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.apply())}),t.nrm(1,"span",4),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(2,mr,0==e.selected.length)),t.R7$(),t.Y8G("ghs-label","party.campaign.treasures.applySelect")}}let pr=(()=>{class i{data;dialogRef;dialog;treasureIndex;gameManager=s.E;edition;scenarios=[];treasures={};looted=[];selected=[];batchSelect=!0;constructor(e,a,n){this.data=e,this.dialogRef=a,this.dialog=n,this.edition=e.edition,this.batchSelect=null==e.scenario}ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.update()}}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.scenarios=[],this.treasures={},this.looted=[],this.selected=[],s.E.scenarioManager.scenarioData(this.edition).filter(e=>!this.data.scenario&&(s.E.scenarioManager.isSuccess(e)||s.E.game.party.casualScenarios.find(a=>e.index==a.index&&e.edition==a.edition&&e.group==a.group))||this.data.scenario&&e.edition==this.data.scenario.edition&&e.index==this.data.scenario.index&&e.group==this.data.scenario.group).forEach(e=>{let a=s.E.scenarioManager.getAllTreasures(e).filter(n=>"number"==typeof n).map(n=>+n);this.batchSelect||(a=a.filter(n=>!this.hasTreasure(""+n,this.edition))),a.length>0&&(this.scenarios.push(e),this.treasures[e.index]=a,a.forEach(n=>{this.hasTreasure(""+n,this.edition)&&this.looted.push(n)}))})}toggleTreasure(e,a=!1){this.batchSelect&&!a?-1==this.selected.indexOf(e)?this.selected.push(e):this.selected.splice(this.selected.indexOf(e),1):this.data.scenario&&!a?-1==this.selected.indexOf(e)?(this.selected=[],this.selected.push(e)):this.selected.splice(this.selected.indexOf(e),1):-1==this.looted.indexOf(e)&&this.dialog.open(La,{panelClass:["dialog"],data:{treasures:[e],edition:this.edition}})}hasTreasure(e,a){return s.E.game.party.treasures&&s.E.game.party.treasures.some(n=>n.name==e&&n.edition==a)}apply(){const e=this.selected.filter(n=>-1!=this.looted.indexOf(n)),a=this.selected.filter(n=>-1==this.looted.indexOf(n));e.length>0&&(s.E.stateManager.before("removeTreasures",this.edition,"["+e.join(",")+"]"),s.E.game.party.treasures=s.E.game.party.treasures.filter(n=>n.edition!=this.edition||isNaN(+n.name)||-1==e.indexOf(+n.name)),s.E.stateManager.after()),a.length>0&&(s.E.stateManager.before("addTreasures",this.edition,"["+a.join(",")+"]"),s.E.game.party.treasures.push(...a.map(n=>new vt.gw(""+n,this.edition))),s.E.stateManager.after()),this.update()}close(){(0,V.co)(this.dialogRef)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-treasures-dialog"]],viewQuery:function(a,n){if(1&a&&t.GBs(c$,5),2&a){let o;t.mGM(o=t.lsd())&&(n.treasureIndex=o.first)}},standalone:!1,decls:14,vars:5,consts:[[1,"treasures-dialog"],[1,"header"],[1,"title"],["src","./assets/images/scenario/treasure.svg",1,"icon"],[3,"ghs-label"],[1,"scenarios"],[1,"scenario"],[1,"buttons"],[1,"cancel",3,"click"],[1,"loot",3,"ngClass"],[1,"apply",3,"ngClass"],["type","checkbox",3,"ngModelChange","change","ngModel"],[1,"text-white",3,"ghs-label"],[1,"treasures"],[1,"hint-container"],[1,"treasure","hint-trigger",3,"click","ngClass"],["src","./assets/images/check.svg",1,"overlay","check"],["src","./assets/images/close.svg",1,"overlay","uncheck"],[1,"hint","center"],[1,"text","placeholder","text-white",3,"edition","index"],[1,"loot",3,"click","ngClass"],[1,"apply",3,"click","ngClass"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.nrm(3,"img",3)(4,"span",4),t.k0s(),t.nVh(5,d$,3,2,"label"),t.k0s(),t.j41(6,"div",5),t.Z7z(7,p$,7,2,"div",6,g$),t.k0s(),t.j41(9,"div",7)(10,"a",8),t.bIt("click",function(){return n.close()}),t.nrm(11,"span",4),t.k0s(),t.nVh(12,u$,2,4,"a",9),t.nVh(13,f$,2,4,"a",10),t.k0s()()),2&a&&(t.R7$(4),t.Y8G("ghs-label","party.campaign.treasures"),t.R7$(),t.vxM(n.data.scenario?-1:5),t.R7$(2),t.Dyx(n.scenarios),t.R7$(4),t.Y8G("ghs-label","cancel"),t.R7$(),t.vxM(n.data.scenario?12:-1),t.R7$(),t.vxM(n.batchSelect||n.data.scenario?13:-1))},dependencies:[N.YU,O.Zm,O.BC,O.vS,tt,Pn],styles:[".treasures-dialog[_ngcontent-%COMP%]{color:var(--ghs-color-white);min-width:25vw}.treasures-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.treasures-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-yellow)}.treasures-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));width:auto;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));filter:var(--ghs-filter-yellow)}.treasures-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer;color:var(--ghs-color-white);margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow:auto;max-height:70vh}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;margin:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;justify-content:center;background-image:url(treasure.0792d529e76ec279.png);background-size:contain;background-repeat:no-repeat;background-position:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-black);width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));transition:translate calc(var(--ghs-animation-speed) * .5s) ease-in-out}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{display:none;position:absolute;top:30%;left:50%;transform:translate(-50%);height:50%;width:auto}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .overlay.check[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .overlay.uncheck[_ngcontent-%COMP%]{filter:var(--ghs-filter-red)}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]:hover{opacity:.8;transform:scale(1.1)}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.looted[_ngcontent-%COMP%]{cursor:initial;opacity:.4}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.looted[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.highlight[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{display:block}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.highlight.looted[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{display:none}.treasures-dialog[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.highlight.looted[_ngcontent-%COMP%]   .uncheck[_ngcontent-%COMP%]{display:block}.treasures-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-between;align-items:center}.treasures-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;min-width:33%;display:flex;justify-content:center}.treasures-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.treasures-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.treasures-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.treasures-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.treasures-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.treasures-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .loot.disabled[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray)}"]})}return i})();const C$=(i,r)=>({fh:i,modern:r}),M$=i=>({"bottom-actions":i}),v$=(i,r)=>r.cardId;function O$(i,r){if(1&i&&t.nrm(0,"img",8),2&i){const e=t.XpG();t.Y8G("src",e.gameManager.monsterManager.monsterThumbnail(e.monster),t.B4B)}}function P$(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.JRh(e[0])}}function b$(i,r){if(1&i&&(t.j41(0,"span",9),t.Z7z(1,P$,2,1,"span",null,t.fX1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.settingsManager.getLabel("data.monster."+e.monster.name).split(" "))}}function k$(i,r){1&i&&(t.j41(0,"span",10),t.nrm(1,"img",18),t.k0s())}function y$(i,r){1&i&&(t.j41(0,"span",11),t.EFF(1,"*"),t.k0s())}function x$(i,r){if(1&i&&t.nrm(0,"p",14),2&i){const e=t.XpG();t.Y8G("ghs-label",e.statEffectNote)}}function E$(i,r){if(1&i&&(t.j41(0,"div",16),t.nrm(1,"ghs-monster-stats",19),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("monster",e.monster)("forceStats",!0)}}function w$(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",20),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.close())})("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.openAbility(n))}),t.nrm(1,"ghs-ability",21),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(7,M$,a.gameManager.hasBottomAbility(e))),t.R7$(),t.Y8G("ability",e)("monster",a.monster)("flipped",!0)("reveal",!0)("relative",!0)("statsCalculation",!1)}}let Ua=(()=>{class i{data;dialogRef;dialog;gameManager=s.E;settingsManager=m.f;monster;hideStats;statEffectNote;constructor(e,a,n){this.data=e,this.dialogRef=a,this.dialog=n,this.monster=e.monster,this.hideStats=e.hideStats,this.statEffectNote=e.statEffectNote||""}openAbility(e){this.dialog.open(Ca,{panelClass:["fullscreen-panel"],disableClose:!0,data:{ability:e,monster:this.monster,relative:!0}})}close(){(0,V.co)(this.dialogRef)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-stats-list"]],standalone:!1,decls:20,vars:11,consts:[[1,"stats-dialog"],[1,"scroll-container"],[1,"header",3,"ngClass"],[1,"title"],[1,"image"],[1,"outer-border"],[1,"inner-border"],[1,"image-container"],[3,"src"],[1,"letter"],[1,"boss"],[1,"custom"],[1,"name"],[3,"ghs-label"],[1,"stat-effect","text-white",3,"ghs-label"],[1,"container"],[1,"stats"],["ghs-pointer-input","",1,"ability",3,"ngClass"],["src","./assets/images/monster/enemy.png"],[3,"monster","forceStats"],["ghs-pointer-input","",1,"ability",3,"singleClick","doubleClick","ngClass"],[3,"ability","monster","flipped","reveal","relative","statsCalculation"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7),t.nVh(8,O$,1,1,"img",8),t.nVh(9,b$,3,0,"span",9),t.k0s()()(),t.nVh(10,k$,2,0,"span",10),t.nVh(11,y$,2,0,"span",11),t.k0s(),t.j41(12,"div",12),t.nrm(13,"span",13),t.k0s()(),t.nVh(14,x$,1,1,"p",14),t.k0s(),t.j41(15,"div",15),t.nVh(16,E$,2,2,"div",16),t.k0s(),t.j41(17,"div",15),t.Z7z(18,w$,2,9,"div",17,v$),t.k0s()()()),2&a&&(t.R7$(2),t.Y8G("ngClass",t.l_i(8,C$,"fh"==n.settingsManager.settings.theme,"modern"==n.settingsManager.settings.theme)),t.R7$(6),t.vxM(!n.monster.noThumbnail&&n.settingsManager.settings.artwork?8:-1),t.R7$(),t.vxM(n.monster.noThumbnail||!n.settingsManager.settings.artwork?9:-1),t.R7$(),t.vxM(n.monster.boss||-1!=n.monster.tags.indexOf("boss")?10:-1),t.R7$(),t.vxM(n.monster.standeeShare||n.monster.statEffect||n.statEffectNote?11:-1),t.R7$(2),t.Y8G("ghs-label","data.monster."+n.monster.name),t.R7$(),t.vxM(n.statEffectNote?14:-1),t.R7$(2),t.vxM(n.hideStats?-1:16),t.R7$(2),t.Dyx(n.gameManager.abilities(n.monster)))},styles:[".stats-dialog[_ngcontent-%COMP%]{position:relative}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{position:sticky;top:0;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:999;background-image:url(dialog_background.fa4ff388462f6a00.png)}.stats-dialog[_ngcontent-%COMP%]   .header.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.stats-dialog[_ngcontent-%COMP%]   .header.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{position:relative}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 11 * .866025 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 11 * var(--ghs-dialog-factor));background-color:var(--ghs-color-white);clip-path:polygon(50% 0,100% 25%,100% 75%,50% 100%,0 75%,0 25%)}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 10.3 * .866025 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 10.3 * var(--ghs-dialog-factor));background-color:var(--ghs-color-red);clip-path:polygon(50% 0,100% 25%,100% 75%,50% 100%,0 75%,0 25%)}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 9 * .866025 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 9 * var(--ghs-dialog-factor));background-color:var(--ghs-color-darkgray);clip-path:polygon(50% 0,100% 25%,100% 75%,50% 100%,0 75%,0 25%)}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 9 * var(--ghs-dialog-factor));height:auto}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .letter[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-white);font-family:var(--ghs-font-title)}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .boss[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));position:absolute;top:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * -1 * var(--ghs-dialog-factor));background-color:var(--ghs-color-darkred);border:2px solid var(--ghs-color-gray);border-radius:100%}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .boss[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.7 * var(--ghs-dialog-factor));height:auto}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .custom[_ngcontent-%COMP%]{display:flex;justify-content:center;width:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));position:absolute;bottom:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * -1 * var(--ghs-dialog-factor));font-family:var(--ghs-font-gh-title);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 9 * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 9 * var(--ghs-text-factor));background-color:var(--ghs-color-darkgray);border:2px solid var(--ghs-color-gray);border-radius:100%}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{color:var(--ghs-color-gray);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));padding:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.stats-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]{color:var(--ghs-color-white);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));max-width:calc(var(--ghs-unit) * 42 * var(--ghs-dialog-factor));text-align:center}.stats-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;min-width:calc(var(--ghs-unit) * 42 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.stats-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{cursor:pointer;position:relative;width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor));min-height:calc(var(--ghs-unit) * 21.5 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.stats-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   ghs-monster-stats[_ngcontent-%COMP%]{display:block;width:100%;height:auto}.stats-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .ability[_ngcontent-%COMP%]{cursor:pointer!important;position:relative;width:calc(var(--ghs-unit) * 33.55 * var(--ghs-dialog-factor));min-height:calc(var(--ghs-unit) * 21.5 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));flex-shrink:0;flex-grow:0}.stats-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .ability.bottom-actions[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 49.95 * var(--ghs-dialog-factor))}.stats-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .ability[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:auto}"]})}return i})();const R$=(i,r)=>({ally:i,allied:r}),j$=(i,r)=>({current:i,active:r});function G$(i,r){1&i&&(t.j41(0,"span",4),t.nrm(1,"span",3),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","game.ally"))}function T$(i,r){1&i&&(t.j41(0,"span",5),t.nrm(1,"span",3),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","game.allied"))}function S$(i,r){if(1&i&&(t.j41(0,"span",6),t.EFF(1,"["),t.nrm(2,"span",3),t.EFF(3,"]"),t.k0s()),2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","data.edition."+e.getEdition())}}function $$(i,r){if(1&i){const e=t.RV6();t.j41(0,"span")(1,"a",12),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.setLevel(n))}),t.EFF(2),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG();t.R7$(),t.Y8G("ngClass",t.l_i(2,j$,e==a.gameManager.game.level,e==a.monster.level)),t.R7$(),t.JRh(e)}}let D$=(()=>{class i{monster;dialogRef;levels=[0,1,2,3,4,5,6,7];gameManager=s.E;constructor(e,a){this.monster=e,this.dialogRef=a}setLevel(e){(0,V.co)(this.dialogRef,e)}getEdition(){return s.E.getEdition(this.monster)}toggleAlly(){s.E.stateManager.before(this.monster.isAlly?"unsetAlly":"setAlly","data.monster."+this.monster.name),this.monster.isAlly=!this.monster.isAlly,s.E.stateManager.after()}toggleallied(){s.E.stateManager.before(this.monster.isAllied?"unsetAllied":"setAllied","data.monster."+this.monster.name),this.monster.isAllied=!this.monster.isAllied,s.E.stateManager.after()}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-monster-level-dialog"]],standalone:!1,decls:15,vars:9,consts:[[1,"level-dialog"],[1,"title"],[1,"name"],[3,"ghs-label"],[1,"ally"],[1,"allied"],[1,"edition"],[1,"level-container"],[1,"item"],["src","./assets/images/status/level.svg"],["ghs-pointer-input","",1,"toggle-ally",3,"singleClick","doubleClick","ngClass"],["src","./assets/images/monster/enemy.png"],[1,"level",3,"click","ngClass"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"span",1)(2,"span",2),t.nrm(3,"span",3),t.nVh(4,G$,2,1,"span",4),t.nVh(5,T$,2,1,"span",5),t.nVh(6,S$,4,1,"span",6),t.k0s(),t.nrm(7,"span",3),t.k0s(),t.j41(8,"div",7)(9,"span",8),t.nrm(10,"img",9),t.k0s(),t.Z7z(11,$$,3,5,"span",null,t.fX1),t.j41(13,"span",10),t.bIt("singleClick",function(){return n.toggleAlly()})("doubleClick",function(){return n.toggleallied()}),t.nrm(14,"img",11),t.k0s()()()),2&a&&(t.R7$(3),t.Y8G("ghs-label","data.monster."+n.monster.name),t.R7$(),t.vxM(n.monster.isAlly?4:-1),t.R7$(),t.vxM(n.monster.isAllied?5:-1),t.R7$(),t.vxM(n.getEdition()?6:-1),t.R7$(),t.Y8G("ghs-label","game.level"),t.R7$(4),t.Dyx(n.levels),t.R7$(2),t.Y8G("ngClass",t.l_i(6,R$,n.monster.isAlly,n.monster.isAllied)))},dependencies:[N.YU,tt,rt],styles:['.level-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column}.level-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-family:var(--ghs-font-title);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));text-align:center;width:100%}.level-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{color:var(--ghs-color-gray);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor)));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   span.item[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:auto}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover, .level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .level.current[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .level.active[_ngcontent-%COMP%]{pointer-events:none;border:calc(var(--ghs-unit) / 4) var(--ghs-color-white) solid;border-radius:100%}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .max-health[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .toggle-ally[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));cursor:pointer;display:flex;justify-content:center;align-items:center;z-index:4}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .toggle-ally[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:auto}.level-dialog[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   .toggle-ally.ally[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:50%;left:50%;width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));transform:translate(-50%,-50%);background-color:var(--ghs-color-red);clip-path:polygon(10% 0,0 10%,40% 50%,0 90%,10% 100%,50% 60%,90% 100%,100% 90%,60% 50%,100% 10%,90% 0,50% 40%)}']})}return i})();const I$=(i,r)=>({closed:i,opened:r}),A$=i=>({flipped:i});let qa=(()=>{class i{data;dialogRef;opened=!1;monster;forceStats;constructor(e,a){this.data=e,this.dialogRef=a,this.monster=e.monster,this.forceStats=e.forceStats}ngOnInit(){this.opened=!0}close(){this.opened=!1,setTimeout(()=>{this.dialogRef.close()},m.f.settings.animations?1e3*m.f.settings.animationSpeed:0)}getBackside(){let e=new P.R(this.monster);return e.boss?s.E.monsterManager.addMonsterEntity(e,1,S.N.boss):(s.E.monsterManager.addMonsterEntity(e,1,S.N.normal),s.E.monsterManager.addMonsterEntity(e,1,S.N.elite)),e.isAlly=this.monster.isAlly,e.isAllied=this.monster.isAllied,e.level=this.monster.level<4?this.monster.level+4:this.monster.level-4,e.errors=this.monster.errors,e}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-stat-dialog"]],standalone:!1,decls:9,vars:15,consts:[[1,"stat-dialog",3,"click","ngClass"],[1,"stat-container"],[1,"card-container"],[1,"card","reverse",3,"ngClass"],[1,"card-back"],[3,"monster","noClick","disablePoup","forceStats"],[1,"card-front"],[1,"close-container",3,"click"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.bIt("click",function(){return n.close()}),t.j41(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),t.nrm(5,"ghs-monster-stats",5),t.k0s(),t.j41(6,"div",6),t.nrm(7,"ghs-monster-stats",5),t.k0s()()()()(),t.j41(8,"div",7),t.bIt("click",function(){return n.close()}),t.k0s()),2&a&&(t.Y8G("ngClass",t.l_i(10,I$,!n.opened,n.opened)),t.R7$(3),t.Y8G("ngClass",t.eq3(13,A$,n.opened)),t.R7$(2),t.Y8G("monster",n.getBackside())("noClick",!0)("disablePoup",!0)("forceStats",n.forceStats),t.R7$(2),t.Y8G("monster",n.monster)("noClick",!0)("disablePoup",!0)("forceStats",n.forceStats))},styles:["[_nghost-%COMP%]{background-color:transparent;padding:0;margin:0;border:0}.stat-dialog[_ngcontent-%COMP%]{position:relative;width:100vw;height:100vh;border-image:none;background:none;transition:transform calc(var(--ghs-animation-speed) * .15s) ease-in-out;transform:scale(0);z-index:2;overflow:auto;display:flex;justify-content:center;align-items:center;-ms-overflow-style:none;scrollbar-width:none}.stat-dialog[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.stat-dialog.opened[_ngcontent-%COMP%]{transform:scale(1)}.stat-dialog.closed[_ngcontent-%COMP%]{transform:scale(0);transition-delay:.8s}.stat-dialog[_ngcontent-%COMP%]   .stat-container[_ngcontent-%COMP%]{overflow:visible;width:100vw;max-width:600px;max-height:100vh}.stat-dialog[_ngcontent-%COMP%]   .stat-container[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]{width:100%;height:100%;margin:1vh 0}.close-container[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1}"]})}return i})();const V$=(i,r)=>({fh:i,modern:r}),F$=i=>[i],X$=(i,r)=>r.edition+"-"+r.name;function B$(i,r){1&i&&(t.j41(0,"span",3),t.nrm(1,"span",2),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","game.ally"))}function Y$(i,r){1&i&&(t.j41(0,"span",4),t.nrm(1,"span",2),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","game.allied"))}function N$(i,r){if(1&i&&(t.j41(0,"span",5),t.EFF(1,"["),t.nrm(2,"span",2),t.EFF(3,"]"),t.k0s()),2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","data.edition."+e.edition)}}function z$(i,r){if(1&i&&(t.j41(0,"span",19)(1,"span",20),t.nrm(2,"img",21),t.k0s(),t.nrm(3,"span",22),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/stats/hp.svg",t.B4B),t.R7$(),t.Y8G("value-sign",e.EntityValueFunction(e.monster.statEffect.health))}}function L$(i,r){if(1&i&&(t.j41(0,"span",19)(1,"span",20),t.nrm(2,"img",21),t.k0s(),t.nrm(3,"span",22),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/stats/"+(e.monster.flying?"fly":"move")+".svg",t.B4B),t.R7$(),t.Y8G("value-sign",e.EntityValueFunction(e.monster.statEffect.movement))}}function U$(i,r){if(1&i&&(t.j41(0,"span",19)(1,"span",20),t.nrm(2,"img",21),t.k0s(),t.nrm(3,"span",22),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/stats/attack.svg",t.B4B),t.R7$(),t.Y8G("value-sign",e.EntityValueFunction(e.monster.statEffect.attack))}}function q$(i,r){if(1&i&&(t.j41(0,"span",19)(1,"span",20),t.nrm(2,"img",21),t.k0s(),t.nrm(3,"span",22),t.k0s()),2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/stats/range.svg",t.B4B),t.R7$(),t.Y8G("value-sign",e.EntityValueFunction(e.monster.statEffect.range))}}function H$(i,r){if(1&i&&(t.nVh(0,z$,4,2,"span",19),t.nVh(1,L$,4,2,"span",19),t.nVh(2,U$,4,2,"span",19),t.nVh(3,q$,4,2,"span",19)),2&i){const e=t.XpG(2);t.vxM(e.monster.statEffect.health?0:-1),t.R7$(),t.vxM(e.monster.statEffect.movement?1:-1),t.R7$(),t.vxM(e.monster.statEffect.attack?2:-1),t.R7$(),t.vxM(e.monster.statEffect.range?3:-1)}}function K$(i,r){if(1&i&&(t.j41(0,"span",19)(1,"span",20),t.nrm(2,"img",21),t.k0s(),t.j41(3,"span"),t.EFF(4,"= "),t.nrm(5,"span",2),t.k0s()()),2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/stats/hp.svg",t.B4B),t.R7$(3),t.Y8G("ghs-label",e.monster.statEffect.health)}}function W$(i,r){if(1&i&&(t.j41(0,"span",19)(1,"span",20),t.nrm(2,"img",21),t.k0s(),t.j41(3,"span"),t.EFF(4,"= "),t.nrm(5,"span",2),t.k0s()()),2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/stats/"+(e.monster.flying?"fly":"move")+".svg",t.B4B),t.R7$(3),t.Y8G("ghs-label",e.monster.statEffect.movement)}}function J$(i,r){if(1&i&&(t.j41(0,"span",19)(1,"span",20),t.nrm(2,"img",21),t.k0s(),t.j41(3,"span"),t.EFF(4,"= "),t.nrm(5,"span",2),t.k0s()()),2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/stats/attack.svg",t.B4B),t.R7$(3),t.Y8G("ghs-label",e.monster.statEffect.attack)}}function Z$(i,r){if(1&i&&(t.j41(0,"span",19)(1,"span",20),t.nrm(2,"img",21),t.k0s(),t.j41(3,"span"),t.EFF(4,"= "),t.nrm(5,"span",2),t.k0s()()),2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/stats/range.svg",t.B4B),t.R7$(3),t.Y8G("ghs-label",e.monster.statEffect.range)}}function Q$(i,r){if(1&i&&(t.nVh(0,K$,6,2,"span",19),t.nVh(1,W$,6,2,"span",19),t.nVh(2,J$,6,2,"span",19),t.nVh(3,Z$,6,2,"span",19)),2&i){const e=t.XpG(2);t.vxM(e.monster.statEffect.health?0:-1),t.R7$(),t.vxM(e.monster.statEffect.movement?1:-1),t.R7$(),t.vxM(e.monster.statEffect.attack?2:-1),t.R7$(),t.vxM(e.monster.statEffect.range?3:-1)}}function tD(i,r){if(1&i&&t.nrm(0,"ghs-actions",15),2&i){const e=t.XpG(2);t.Y8G("actions",e.monster.statEffect.actions)("relative",!0)("inline",!0)("statsCalculation",!1)}}function eD(i,r){if(1&i&&(t.j41(0,"span",23),t.nrm(1,"img",24),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(3);t.R7$(),t.Y8G("src","./assets/images"+(a.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+e+".svg",t.B4B)}}function nD(i,r){if(1&i&&(t.j41(0,"div",16),t.Z7z(1,eD,2,1,"span",23,t.fX1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Dyx(e.monster.statEffect.immunities)}}function iD(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",25),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openAbilities())}),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","monster.statEffect.deck")("ghs-label-args",t.eq3(2,F$,e.monster.statEffect.note))}}function aD(i,r){if(1&i&&t.nrm(0,"span",18),2&i){const e=t.XpG(2);t.Y8G("ghs-label",e.monster.statEffect.note)}}function oD(i,r){if(1&i&&(t.j41(0,"div",10),t.nrm(1,"div",13),t.j41(2,"div",14),t.nVh(3,H$,4,4),t.nVh(4,Q$,4,4),t.k0s(),t.nVh(5,tD,1,4,"ghs-actions",15),t.nVh(6,nD,3,0,"div",16),t.nVh(7,iD,1,4,"span",17),t.nVh(8,aD,1,1,"span",18),t.k0s()),2&i){const e=t.XpG();t.Y8G("ngClass",t.l_i(8,V$,"fh"==e.settingsManager.settings.theme,"modern"==e.settingsManager.settings.theme)),t.R7$(),t.Y8G("ghs-label","monster.statEffect"),t.R7$(2),t.vxM(e.monster.statEffect.absolute?-1:3),t.R7$(),t.vxM(e.monster.statEffect.absolute?4:-1),t.R7$(),t.vxM(e.monster.statEffect.actions?5:-1),t.R7$(),t.vxM(e.monster.statEffect.immunities?6:-1),t.R7$(),t.vxM(e.monster.statEffect.deck?7:-1),t.R7$(),t.vxM(e.monster.statEffect.initiative?8:-1)}}function sD(i,r){if(1&i&&(t.j41(0,"div",12),t.nrm(1,"ghs-monster-stats",26),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.Y8G("monster",e)("forceStats",!0)("noClick",!0)}}let ur=(()=>{class i{monster;dialogRef;dialog;settingsManager=m.f;levels=[0,1,2,3,4,5,6,7];monsters=[];edition="";EntityValueFunction=$.hZ;dormant=!1;constructor(e,a,n){this.monster=e,this.dialogRef=a,this.dialog=n,this.levels.forEach(o=>{this.monsters.push(this.getMonsterForLevel(o))}),this.edition=s.E.getEdition(this.monster),this.dormant=this.monster.entities.every(o=>o.dormant)}getMonsterForLevel(e){let a=new P.R(this.monster,e);return a.isAlly=this.monster.isAlly,a.isAllied=this.monster.isAllied,a.errors=this.monster.errors,a.statEffect=this.monster.statEffect,a.flying=this.monster.flying&&(!this.monster.statEffect||"disabled"!=this.monster.statEffect.flying)||null!=this.monster.statEffect&&1==this.monster.statEffect.flying,a}toggleAlly(){s.E.stateManager.before(this.monster.isAlly?"unsetAlly":"setAlly","data.monster."+this.monster.name),this.monster.isAlly=!this.monster.isAlly,s.E.stateManager.after()}toggleDormant(){s.E.stateManager.before(this.dormant?"unsetDormant":"setDormant","data.monster."+this.monster.name),this.dormant=!this.dormant,this.monster.entities.forEach(e=>e.dormant=this.dormant),s.E.stateManager.after()}toggleAllied(){s.E.stateManager.before(this.monster.isAllied?"unsetAllied":"setAllied","data.monster."+this.monster.name),this.monster.isAllied=!this.monster.isAllied,s.E.stateManager.after()}openStatPopup(e){const a=new P.R(this.monster,e);this.dialog.open(qa,{panelClass:["fullscreen-panel"],disableClose:!0,data:{monster:a,forceStats:!0}})}openAbilities(){const e=new P.R(this.monster,this.monster.level);e.statEffect=this.monster.statEffect,s.E.monsterManager.resetMonsterAbilities(e),e.statEffect&&this.dialog.open(Ua,{panelClass:["dialog"],data:{monster:e,hideStats:!0,statEffectNote:e.statEffect.note}})}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-monster-stats-popup"]],standalone:!1,decls:15,vars:8,consts:[[1,"stats-dialog"],[1,"name"],[3,"ghs-label"],[1,"ally"],[1,"allied"],[1,"edition"],[1,"menu"],[1,"toggle-dormant",3,"click","ghs-label"],[1,"toggle-ally",3,"click","ghs-label"],[1,"toggle-allied",3,"click","ghs-label"],[1,"stat-effect",3,"ngClass"],[1,"stats-container"],[1,"stats"],[1,"title",3,"ghs-label"],[1,"stat-changes"],[3,"actions","relative","inline","statsCalculation"],[1,"immunities"],[1,"deck","text-white",3,"ghs-label","ghs-label-args"],[1,"deck","text-white",3,"ghs-label"],[1,"stat"],[1,"type"],[3,"src"],[3,"value-sign"],[1,"condition","immunity"],[1,"icon",3,"src"],[1,"deck","text-white",3,"click","ghs-label","ghs-label-args"],[3,"monster","forceStats","noClick"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"span",1),t.nrm(2,"span",2),t.nVh(3,B$,2,1,"span",3),t.nVh(4,Y$,2,1,"span",4),t.nVh(5,N$,4,1,"span",5),t.k0s(),t.j41(6,"div",6)(7,"a",7),t.bIt("click",function(){return n.toggleDormant()}),t.k0s()(),t.j41(8,"div",6)(9,"a",8),t.bIt("click",function(){return n.toggleAlly()}),t.k0s(),t.j41(10,"a",9),t.bIt("click",function(){return n.toggleAllied()}),t.k0s()(),t.nVh(11,oD,9,11,"div",10),t.j41(12,"div",11),t.Z7z(13,sD,2,3,"div",12,X$),t.k0s()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","data.monster."+n.monster.name),t.R7$(),t.vxM(n.monster.isAlly?3:-1),t.R7$(),t.vxM(n.monster.isAllied?4:-1),t.R7$(),t.vxM(n.edition?5:-1),t.R7$(2),t.Y8G("ghs-label","monster.toggleDormant."+(n.dormant?"off":"on")),t.R7$(2),t.Y8G("ghs-label","monster.toggleAlly."+(n.monster.isAlly?"off":"on")),t.R7$(),t.Y8G("ghs-label","monster.toggleAllied."+(n.monster.isAllied?"off":"on")),t.R7$(),t.vxM(n.monster.statEffect?11:-1),t.R7$(2),t.Dyx(n.monsters))},styles:[".stats-dialog[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 46 * var(--ghs-dialog-factor));display:flex;flex-direction:column}.stats-dialog[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap;font-family:var(--ghs-font-title);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));text-align:center;width:100%}.stats-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;align-items:center}.stats-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-family:var(--ghs-font-text);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.stats-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ally[_ngcontent-%COMP%]{text-decoration:line-through}.stats-dialog[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;align-items:center;color:var(--ghs-color-white);z-index:2;overflow:auto;max-height:calc(var(--ghs-unit) * 20 * var(--ghs-dialog-factor))}.stats-dialog[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{position:sticky;top:0;font-size:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:2;text-align:center;width:100%;padding-bottom:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.stats-dialog[_ngcontent-%COMP%]   .stat-effect.fh[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.stats-dialog[_ngcontent-%COMP%]   .stat-effect.modern[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.stats-dialog[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]   .stat-changes[_ngcontent-%COMP%]{z-index:1;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;max-width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor))}.stats-dialog[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]   .stat-changes[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor)) 0}.stats-dialog[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]   .stat-changes[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:1.5em;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.stats-dialog[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]   .stat-changes[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1.2em;width:auto;filter:var(--ghs-filter-white)}.stats-dialog[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]{z-index:1;display:flex;flex-wrap:wrap;justify-content:center;align-items:center}.stats-dialog[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:1.5em;height:1.5em;margin:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor))}.stats-dialog[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.stats-dialog[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]{z-index:1;cursor:pointer;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));text-align:center}.stats-dialog[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]{position:relative;text-align:initial;display:flex;flex-direction:column;align-items:center;margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));max-height:calc(var(--ghs-unit) * 55 * var(--ghs-dialog-factor));overflow-y:auto;overflow-x:hidden}.stats-dialog[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{cursor:pointer;position:relative;width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor));height:auto;margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));z-index:1}.stats-dialog[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   ghs-monster-stats[_ngcontent-%COMP%]{display:block;position:relative;top:0;left:0;width:100%;height:100%;transform-origin:top left}"]})}return i})();const rD=["levelButton"],cD=(i,r,e,a,n)=>({boss:i,bb:r,fh:e,"no-click":a,denied:n}),lD=(i,r,e)=>({"is-ally":i,"is-allied":r,bb:e}),gD=i=>({catched:i}),dD=(i,r)=>({hidden:i,range:r}),Wt=i=>({hidden:i}),Ha=(i,r)=>({hidden:i,bordered:r}),hD=i=>({boss:i}),_D=i=>({range:i});function mD(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",23,1),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openLevelDialog())}),t.EFF(2),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ghs-label","game.level")("ghs-label-attribute","title"),t.R7$(2),t.SpI("",e.monster.level," ")}}function pD(i,r){1&i&&t.nrm(0,"div",4)}function uD(i,r){1&i&&t.nrm(0,"div",5)}function fD(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1,"\xa0("),t.nrm(2,"span",8),t.EFF(3,")"),t.k0s()),2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","data.monster."+e.monster.name)}}function CD(i,r){1&i&&(t.j41(0,"span",9),t.EFF(1,"\xa0"),t.nrm(2,"span",8),t.k0s()),2&i&&(t.R7$(2),t.Y8G("ghs-label","%game.monsterType.elite%"))}function MD(i,r){1&i&&(t.j41(0,"span",10),t.EFF(1,"*"),t.k0s())}function vD(i,r){1&i&&(t.j41(0,"span",11),t.nrm(1,"span",8),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","game.ally"))}function OD(i,r){1&i&&(t.j41(0,"span",12),t.nrm(1,"span",8),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","game.allied"))}function PD(i,r){if(1&i&&(t.j41(0,"span",13),t.nrm(1,"img",17),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/action/fly.svg",t.B4B)}}function bD(i,r){if(1&i&&(t.j41(0,"span",14),t.EFF(1,"["),t.nrm(2,"span",8),t.EFF(3,"]"),t.k0s()),2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","data.edition."+e.edition)}}function kD(i,r){if(1&i&&(t.j41(0,"span",15),t.nrm(1,"img",24),t.k0s()),2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(1,gD,e.catched))}}function yD(i,r){if(1&i&&(t.j41(0,"span",28),t.nrm(1,"span",26),t.k0s(),t.j41(2,"span",27),t.nrm(3,"img",17),t.k0s()),2&i){const e=t.XpG(3);t.Y8G("ngClass",t.eq3(5,Wt,e.hideStats)),t.R7$(),t.Y8G("value-calc",e.stats.range)("level",e.monster.level)("empty",!0),t.R7$(2),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/stats/range.svg",t.B4B)}}function xD(i,r){if(1&i&&(t.j41(0,"span",25),t.nrm(1,"span",26),t.k0s(),t.j41(2,"span",27),t.nrm(3,"img",17),t.k0s(),t.j41(4,"span",28),t.nrm(5,"span",26),t.k0s(),t.j41(6,"span",27),t.nrm(7,"img",17),t.k0s(),t.nVh(8,yD,4,7)),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(11,Wt,e.hideStats)),t.R7$(),t.Y8G("value-calc",e.stats.movement)("level",e.monster.level)("empty",!0),t.R7$(2),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/stats/"+(e.flying?"fly":"move")+".svg",t.B4B),t.R7$(),t.Y8G("ngClass",t.l_i(13,Ha,e.hideStats,e.hideStats||e.stats.range)),t.R7$(),t.Y8G("value-calc",e.stats.attack)("level",e.monster.level)("empty",!0),t.R7$(2),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/stats/attack.svg",t.B4B),t.R7$(),t.vxM(e.hideStats||e.stats.range?8:-1)}}function ED(i,r){if(1&i&&(t.j41(0,"div",18)(1,"span",25),t.nrm(2,"span",26),t.k0s(),t.j41(3,"span",27),t.nrm(4,"img",17),t.k0s(),t.nVh(5,xD,9,16),t.k0s()),2&i){const e=t.XpG();t.Y8G("ngClass",t.l_i(7,dD,e.hideStats,e.hideStats||e.stats.range)),t.R7$(),t.Y8G("ngClass",t.eq3(10,Wt,e.hideStats)),t.R7$(),t.Y8G("value-calc",e.stats.health)("level",e.monster.level)("empty",!0),t.R7$(2),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/stats/hp.svg",t.B4B),t.R7$(),t.vxM(e.monster.boss?5:-1)}}function wD(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-pointer-input",29),t.bIt("singleClick",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.openEntityMenu(n))}),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(1,hD,e.monster.boss))}}function RD(i,r){if(1&i&&(t.j41(0,"span",32),t.nrm(1,"span",26),t.k0s(),t.j41(2,"span",27),t.nrm(3,"img",17),t.k0s(),t.j41(4,"span",33),t.nrm(5,"span",26),t.k0s()),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(9,Wt,e.hideStats)),t.R7$(),t.Y8G("value-calc",e.stats.range)("level",e.monster.level)("empty",!0),t.R7$(2),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/stats/range.svg",t.B4B),t.R7$(),t.Y8G("ngClass",t.eq3(11,Wt,e.hideEliteStats)),t.R7$(),t.Y8G("value-calc",e.eliteStats.range)("level",e.monster.level)("empty",!0)}}function jD(i,r){if(1&i&&(t.j41(0,"div",20)(1,"span",30),t.nrm(2,"span",26),t.k0s(),t.j41(3,"span",27),t.nrm(4,"img",17),t.k0s(),t.j41(5,"span",31),t.nrm(6,"span",26),t.k0s(),t.j41(7,"span",30),t.nrm(8,"span",26),t.k0s(),t.j41(9,"span",27),t.nrm(10,"img",17),t.k0s(),t.j41(11,"span",31),t.nrm(12,"span",26),t.k0s(),t.j41(13,"span",32),t.nrm(14,"span",26),t.k0s(),t.j41(15,"span",27),t.nrm(16,"img",17),t.k0s(),t.j41(17,"span",33),t.nrm(18,"span",26),t.k0s(),t.nVh(19,RD,6,13),t.k0s()),2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(29,_D,e.hideStats&&e.hideEliteStats||e.stats.range||e.eliteStats.range)),t.R7$(),t.Y8G("ngClass",t.eq3(31,Wt,e.hideStats)),t.R7$(),t.Y8G("value-calc",e.stats.health)("level",e.monster.level)("empty",!0),t.R7$(2),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/stats/hp.svg",t.B4B),t.R7$(),t.Y8G("ngClass",t.eq3(33,Wt,e.hideEliteStats)),t.R7$(),t.Y8G("value-calc",e.eliteStats.health)("level",e.monster.level)("empty",!0),t.R7$(),t.Y8G("ngClass",t.eq3(35,Wt,e.hideStats)),t.R7$(),t.Y8G("value-calc",e.stats.movement)("level",e.monster.level)("empty",!0),t.R7$(2),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/stats/"+(e.flying?"fly":"move")+".svg",t.B4B),t.R7$(),t.Y8G("ngClass",t.eq3(37,Wt,e.hideEliteStats)),t.R7$(),t.Y8G("value-calc",e.eliteStats.movement)("level",e.monster.level)("empty",!0),t.R7$(),t.Y8G("ngClass",t.l_i(39,Ha,e.hideStats,e.hideStats&&e.hideStats||e.stats.range||e.eliteStats.range)),t.R7$(),t.Y8G("value-calc",e.stats.attack)("level",e.monster.level)("empty",!0),t.R7$(2),t.Y8G("src","./assets/images"+(e.settingsManager.settings.fhStyle?"/fh":"")+"/stats/attack.svg",t.B4B),t.R7$(),t.Y8G("ngClass",t.l_i(42,Ha,e.hideEliteStats,e.hideStats&&e.hideStats||e.stats.range||e.eliteStats.range)),t.R7$(),t.Y8G("value-calc",e.eliteStats.attack)("level",e.monster.level)("empty",!0),t.R7$(),t.vxM(e.hideStats&&e.hideEliteStats||e.stats.range||e.eliteStats.range?19:-1)}}function GD(i,r){if(1&i&&(t.j41(0,"div",38)(1,"span",45),t.EFF(2),t.k0s(),t.nrm(3,"ghs-actions",46),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.R7$(2),t.SpI("",a+1,":"),t.R7$(),t.Y8G("actions",e)("inline",!0)("statsCalculation",n.settingsManager.settings.calculate)("right",!0)("hexSize",.5)("monster",n.monsterCopy)("monsterType",n.MonsterType.normal)}}function TD(i,r){if(1&i&&(t.j41(0,"span",40),t.nrm(1,"img",47),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(),t.Y8G("src","./assets/images"+(a.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+e+".svg",t.B4B)}}function SD(i,r){if(1&i&&(t.j41(0,"div",38)(1,"span",45),t.EFF(2),t.k0s(),t.nrm(3,"ghs-actions",48),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.R7$(2),t.SpI("",a+1,":"),t.R7$(),t.Y8G("actions",e)("inline",!0)("statsCalculation",n.settingsManager.settings.calculate)("hexSize",.5)("monster",n.monsterCopy)("monsterType",n.MonsterType.elite)}}function $D(i,r){if(1&i&&(t.j41(0,"span",40),t.nrm(1,"img",47),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(),t.Y8G("src","./assets/images"+(a.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+e+".svg",t.B4B)}}function DD(i,r){if(1&i&&(t.j41(0,"div",34),t.nrm(1,"div",35),t.j41(2,"div",36),t.nrm(3,"ghs-actions",37),t.k0s(),t.Z7z(4,GD,4,8,"div",38,t.fX1),t.k0s(),t.j41(6,"div",39),t.Z7z(7,TD,2,1,"span",40,t.fX1),t.k0s(),t.j41(9,"div",41),t.nrm(10,"div",42),t.j41(11,"div",36),t.nrm(12,"ghs-actions",43),t.k0s(),t.Z7z(13,SD,4,7,"div",38,t.fX1),t.k0s(),t.j41(15,"div",44),t.Z7z(16,$D,2,1,"span",40,t.fX1),t.k0s()),2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(21,Wt,e.hideStats)),t.R7$(),t.Y8G("ghs-label",e.stats.note),t.R7$(2),t.Y8G("actions",e.stats.actions)("inline",!0)("statsCalculation",e.settingsManager.settings.calculate)("right",!0)("hexSize",.5)("highlightActions",e.highlightActions)("monster",e.monsterCopy)("monsterType",e.MonsterType.normal),t.R7$(),t.Dyx(e.stats.special),t.R7$(2),t.Y8G("ngClass",t.eq3(23,Wt,e.hideStats)),t.R7$(),t.Dyx(e.stats.immunities),t.R7$(2),t.Y8G("ngClass",t.eq3(25,Wt,e.hideEliteStats)),t.R7$(),t.Y8G("ghs-label",e.eliteStats.note),t.R7$(2),t.Y8G("actions",e.eliteStats.actions)("inline",!0)("statsCalculation",e.settingsManager.settings.calculate)("hexSize",.5)("highlightActions",e.highlightActions)("monster",e.monsterCopy)("monsterType",e.MonsterType.elite),t.R7$(),t.Dyx(e.eliteStats.special),t.R7$(2),t.Y8G("ngClass",t.eq3(27,Wt,e.hideEliteStats)),t.R7$(),t.Dyx(e.eliteStats.immunities)}}function ID(i,r){if(1&i&&(t.j41(0,"div",38)(1,"span",45),t.EFF(2),t.k0s(),t.nrm(3,"ghs-actions",48),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.R7$(2),t.SpI("",a+1,":"),t.R7$(),t.Y8G("actions",e)("inline",!0)("statsCalculation",n.settingsManager.settings.calculate)("hexSize",.5)("monster",n.monsterCopy)("monsterType",n.MonsterType.boss)}}function AD(i,r){if(1&i&&(t.j41(0,"div",21),t.nrm(1,"div",42),t.j41(2,"div",36),t.nrm(3,"ghs-actions",43),t.k0s(),t.Z7z(4,ID,4,7,"div",38,t.fX1),t.k0s()),2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(9,Wt,e.hideStats)),t.R7$(),t.Y8G("ghs-label",e.stats.note),t.R7$(2),t.Y8G("actions",e.stats.actions)("inline",!0)("statsCalculation",e.settingsManager.settings.calculate)("hexSize",.5)("highlightActions",e.highlightActions)("monster",e.monsterCopy)("monsterType",e.MonsterType.boss),t.R7$(),t.Dyx(e.stats.special)}}function VD(i,r){if(1&i&&(t.j41(0,"span",40),t.nrm(1,"img",47),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(),t.Y8G("src","./assets/images"+(a.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+e+".svg",t.B4B)}}function FD(i,r){if(1&i&&(t.j41(0,"div",22),t.Z7z(1,VD,2,1,"span",40,t.fX1),t.k0s()),2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(1,Wt,e.hideStats)),t.R7$(),t.Dyx(e.stats.immunities)}}let jn=(()=>{class i{dialog;overlay;element;monster;forceStats=!1;relative=!1;noClick=!1;disablePoup=!1;MonsterType=S.N;gameManager=s.E;settingsManager=m.f;stats=new Lt.f(S.N.normal);hideStats=!1;eliteStats=new Lt.f(S.N.elite);hideEliteStats=!1;statOverview=!1;highlightActions=[];edition="";catching=!1;catched=!1;flying=!1;monsterCopy;levelButton;constructor(e,a,n){this.dialog=e,this.overlay=a,this.element=n}ngOnInit(){this.monsterCopy=JSON.parse(JSON.stringify(this.monster)),this.update(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.highlightActions=m.f.settings.statAnimations?[G.X2.shield,G.X2.retaliate,G.X2.custom]:[],this.edition=s.E.getEdition(this.monster),this.catching=null!=this.monster.pet&&s.E.buildingsManager.petsAvailable,this.catched=this.catching&&s.E.buildingsManager.petsEnabled&&null!=s.E.game.party.pets.find(e=>e.edition==this.monster.edition&&e.name==this.monster.pet),this.setStats(),this.flying=this.monster.flying&&(!this.monster.statEffect||"disabled"!=this.monster.statEffect.flying)||null!=this.monster.statEffect&&1==this.monster.statEffect.flying}setStats(){if(this.monster.boss)this.stats=s.E.monsterManager.getStat(this.monster,S.N.boss),this.hideStats=!this.forceStats&&m.f.settings.hideStats&&this.monster.entities.every(e=>e.dead||e.type!=S.N.boss);else{const e=this.monster.bb&&-1!=this.monster.tags.indexOf("bb-elite")?S.N.elite:S.N.normal;this.stats=s.E.monsterManager.getStat(this.monster,e),this.hideStats=!this.forceStats&&m.f.settings.hideStats&&this.monster.entities.every(a=>a.dead||a.type!=e),this.monster.bb||(this.eliteStats=s.E.monsterManager.getStat(this.monster,S.N.elite),this.hideEliteStats=!this.forceStats&&m.f.settings.hideStats&&this.monster.entities.every(a=>a.dead||a.type!=S.N.elite))}}statsForType(e){return s.E.monsterManager.getStat(this.monster,e)}setLevel(e){e!=this.monster.level&&(s.E.stateManager.before("setLevel","data.monster."+this.monster.name,e),s.E.monsterManager.setLevel(this.monster,e),s.E.monsterManager.setLevel(this.monsterCopy,e),this.setStats(),s.E.stateManager.after())}openLevelDialog(){this.dialog.open(D$,{panelClass:["dialog"],data:this.monster,positionStrategy:this.overlay.position().flexibleConnectedTo(this.levelButton).withPositions((0,V.yE)())}).closed.subscribe({next:a=>{"number"==typeof a&&this.setLevel(a)}})}openStatsPopup(){this.noClick||this.monster.bb?this.disablePoup||this.openStatPopup():this.dialog.open(ur,{panelClass:["dialog"],data:this.monster})}openStatPopup(){!this.noClick&&!this.disablePoup&&this.dialog.open(qa,{panelClass:["fullscreen-panel"],disableClose:!0,data:{monster:this.monster,forceStats:this.forceStats}})}openEntityMenu(e){this.noClick||this.dialog.open(Xn,{panelClass:["dialog"],data:{entity:void 0,figure:this.monster},positionStrategy:this.overlay.position().flexibleConnectedTo(this.element).withPositions((0,V.yE)())})}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG),t.rXU(zt.hJ),t.rXU(t.aKT))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-monster-stats"]],viewQuery:function(a,n){if(1&a&&t.GBs(rD,5,t.aKT),2&a){let o;t.mGM(o=t.lsd())&&(n.levelButton=o.first)}},inputs:{monster:"monster",forceStats:"forceStats",relative:"relative",noClick:"noClick",disablePoup:"disablePoup"},standalone:!1,decls:24,vars:33,consts:[["card",""],["levelButton",""],[1,"stats-container",3,"ngClass"],[1,"level",3,"ghs-label","ghs-label-attribute"],[1,"filter-stats","normal"],[1,"filter-stats","elite"],["ghs-pointer-input","",1,"name-container",3,"singleClick","doubleClick"],[1,"name"],[3,"ghs-label"],[1,"elite"],[1,"stat-effect"],[1,"ally"],[1,"allied"],[1,"flying"],[1,"edition"],[1,"catching",3,"ngClass"],[1,"toggle-ally",3,"ngClass"],[3,"src"],[1,"stats","boss",3,"ngClass"],[1,"entity-menu",3,"ngClass"],[1,"stats",3,"ngClass"],[1,"extra","boss",3,"ngClass"],[1,"immunities","boss",3,"ngClass"],[1,"level",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/fh/catching.svg",1,"ghs-svg"],[1,"stat","boss","bordered",3,"ngClass"],[1,"value",3,"value-calc","level","empty"],[1,"stat-icon"],[1,"stat","boss",3,"ngClass"],[1,"entity-menu",3,"singleClick","ngClass"],[1,"stat","normal","bordered",3,"ngClass"],[1,"stat","elite","bordered",3,"ngClass"],[1,"stat","normal",3,"ngClass"],[1,"stat","elite",3,"ngClass"],[1,"extra","normal",3,"ngClass"],[1,"notes",3,"ghs-label"],[1,"additional"],[3,"actions","inline","statsCalculation","right","hexSize","highlightActions","monster","monsterType"],[1,"specials"],[1,"immunities","normal",3,"ngClass"],[1,"immunity"],[1,"extra","elite",3,"ngClass"],[1,"notes","text-white",3,"ghs-label"],[3,"actions","inline","statsCalculation","hexSize","highlightActions","monster","monsterType"],[1,"immunities","elite",3,"ngClass"],[1,"special"],[3,"actions","inline","statsCalculation","right","hexSize","monster","monsterType"],[1,"icon",3,"src"],[3,"actions","inline","statsCalculation","hexSize","monster","monsterType"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",2,0),t.nVh(2,mD,3,3,"div",3),t.nVh(3,pD,1,0,"div",4),t.nVh(4,uD,1,0,"div",5),t.j41(5,"div",6),t.bIt("singleClick",function(){return t.eBV(o),t.Njj(n.openStatsPopup())})("doubleClick",function(){return t.eBV(o),t.Njj(n.openStatPopup())}),t.j41(6,"span",7),t.nrm(7,"span",8),t.nVh(8,fD,4,1,"span"),t.nVh(9,CD,3,1,"span",9),t.nVh(10,MD,2,0,"span",10),t.nVh(11,vD,2,1,"span",11),t.nVh(12,OD,2,1,"span",12),t.k0s(),t.nVh(13,PD,2,1,"span",13),t.nVh(14,bD,4,1,"span",14),t.nVh(15,kD,2,3,"span",15),t.k0s(),t.j41(16,"span",16),t.nrm(17,"img",17),t.k0s(),t.nVh(18,ED,6,12,"div",18),t.nVh(19,wD,1,3,"ghs-pointer-input",19),t.nVh(20,jD,20,45,"div",20),t.nVh(21,DD,18,29),t.nVh(22,AD,6,11,"div",21),t.nVh(23,FD,3,3,"div",22),t.k0s()}if(2&a){const o=t.sdS(1);t.xc7("font-size",.03*o.offsetWidth+"px"),t.Y8G("ngClass",t.s1E(23,cD,n.monster.boss,n.monster.bb,n.settingsManager.settings.fhStyle,n.noClick,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.monsterPermissions[n.monster.name+"|"+n.monster.edition])),t.R7$(2),t.vxM(n.monster.bb?-1:2),t.R7$(),t.vxM(!n.settingsManager.settings.standees&&n.hideStats?3:-1),t.R7$(),t.vxM(!n.settingsManager.settings.standees&&n.hideEliteStats?4:-1),t.R7$(3),t.Y8G("ghs-label","data.monster."+(n.monster.statEffect&&n.monster.statEffect.name?n.monster.statEffect.name:n.monster.name)),t.R7$(),t.vxM(n.monster.statEffect&&n.monster.statEffect.name?8:-1),t.R7$(),t.vxM(-1!=n.monster.tags.indexOf("bb-elite")?9:-1),t.R7$(),t.vxM(n.monster.statEffect?10:-1),t.R7$(),t.vxM(n.monster.isAlly?11:-1),t.R7$(),t.vxM(n.monster.isAllied?12:-1),t.R7$(),t.vxM(n.flying?13:-1),t.R7$(),t.vxM(n.edition?14:-1),t.R7$(),t.vxM(n.catching?15:-1),t.R7$(),t.Y8G("ngClass",t.sMw(29,lD,n.monster.isAlly,n.monster.isAllied,n.monster.bb)),t.R7$(),t.Y8G("src",n.monster.bb?"./assets/images/bb/monster.svg":"./assets/images/monster/enemy.png",t.B4B),t.R7$(),t.vxM(n.monster.boss||n.monster.bb?18:-1),t.R7$(),t.vxM(!n.settingsManager.settings.standees&&n.gameManager.gameplayFigure(n.monster)?19:-1),t.R7$(),t.vxM(n.monster.boss||n.monster.bb?-1:20),t.R7$(),t.vxM(n.monster.boss||n.monster.bb?-1:21),t.R7$(),t.vxM(n.monster.boss||n.monster.bb?22:-1),t.R7$(),t.vxM(n.monster.boss||n.monster.bb?23:-1)}},dependencies:[N.YU,vn,tt,rt,Ut],styles:['.stats-container[_ngcontent-%COMP%]{width:100%;height:100%;position:relative;display:flex;border-radius:1em}.stats-container[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:opacity calc(var(--ghs-animation-speed) * 1s) ease-in-out}.stats-container[_ngcontent-%COMP%]   .hidden[_ngcontent-%COMP%]{opacity:0}.stats-container[_ngcontent-%COMP%]:before{content:" ";position:absolute;width:100%;height:100%;background-image:url(standard.7d991728789d4251.png);background-position:top;background-size:100% auto;background-repeat:no-repeat;border-radius:1em;z-index:0}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]{position:absolute;top:.4em;right:1.8em;width:11.3em;display:flex;font-family:var(--ghs-font-title);color:var(--ghs-color-white);font-size:2.1em;filter:drop-shadow(.1em .1em .1em var(--ghs-color-black));text-align:left;white-space:nowrap;overflow-x:auto;overflow-y:hidden;z-index:4}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{display:flex;align-items:center}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]{margin-left:.1em}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]   .flying[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:auto;margin-left:.3em}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]   .flying[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]   .catching[_ngcontent-%COMP%]{position:absolute;right:1em;top:50%;width:1.2em;height:auto;filter:var(--ghs-filter-white);transform:translateY(-50%)}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]   .catching.catched[_ngcontent-%COMP%]{filter:var(--ghs-filter-green) brightness(.7)}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]   .stat-effect[_ngcontent-%COMP%]{display:flex;justify-content:center;width:calc(var(--ghs-unit) * 2);height:calc(var(--ghs-unit) * 2);position:relative;top:calc(var(--ghs-unit) * -.6);left:calc(var(--ghs-unit) * -.3);font-family:var(--ghs-font-gh-title);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 4.5);line-height:calc(var(--ghs-unit) * 4);background-color:var(--ghs-color-darkgray);border:2px solid var(--ghs-color-gray);border-radius:100%}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]:hover{cursor:pointer;color:var(--ghs-color-gray)}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]:hover   .flying[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]:hover   .catching[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]:hover   .catching.catched[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.stats-container[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]:hover   .stat-effect[_ngcontent-%COMP%]{filter:brightness(.4)}.stats-container[_ngcontent-%COMP%]   .entity-menu[_ngcontent-%COMP%]{position:absolute;inset:0 38%;z-index:3}.stats-container[_ngcontent-%COMP%]   .entity-menu.boss[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .entity-menu.bb[_ngcontent-%COMP%]{left:25%;right:55%}.stats-container[_ngcontent-%COMP%]   .toggle-ally[_ngcontent-%COMP%]{position:absolute;top:.2em;right:.8em;height:3.4em;width:2.4em;cursor:pointer;display:flex;justify-content:center;align-items:center;z-index:4}.stats-container[_ngcontent-%COMP%]   .toggle-ally[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.stats-container[_ngcontent-%COMP%]   .toggle-ally.is-ally[_ngcontent-%COMP%]:after{content:" ";position:absolute;inset:.5em .1em;background-color:var(--ghs-color-red);clip-path:polygon(10% 0,0 10%,40% 50%,0 90%,10% 100%,50% 60%,90% 100%,100% 90%,60% 50%,100% 10%,90% 0,50% 40%)}.stats-container[_ngcontent-%COMP%]   .toggle-ally.bb[_ngcontent-%COMP%]{top:.1em;left:1em;right:initial}.stats-container[_ngcontent-%COMP%]   .toggle-ally.bb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow) brightness(.8)}.stats-container[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{position:absolute;top:.2em;left:.7em;font-family:var(--ghs-font-gh-title);font-size:3em;text-shadow:var(--ghs-outline);color:var(--ghs-color-gray);cursor:pointer;z-index:4}.stats-container[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover, .stats-container[_ngcontent-%COMP%]   .level.active-button[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{position:absolute;top:4.8em;left:16.5em;width:calc(8.4em * var(--ghs-fontsize));height:11.4em;display:grid;grid-template-columns:50% 0 50%;grid-template-rows:repeat(3,33%);filter:drop-shadow(.01em .01em .01em var(--ghs-color-black));z-index:1;transform:translate(-50%)}.stats-container[_ngcontent-%COMP%]   .stats.boss[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .stats.bb[_ngcontent-%COMP%]{top:5.2em;left:9.6em;grid-template-columns:8em 0}.stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{position:relative;font-size:2.4em;line-height:1.7em;padding-top:0;width:100%;display:flex}.stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:calc(1em * var(--ghs-fontsize));display:block;width:100%;white-space:nowrap;overflow-x:auto;overflow-y:hidden}.stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.normal[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.boss[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.bb[_ngcontent-%COMP%]{justify-self:end;justify-content:flex-end;filter:drop-shadow(.01em .01em .01em var(--ghs-color-white));padding-right:.8em}.stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.normal[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.boss[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.bb[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{text-align:right}.stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.normal.bordered[_ngcontent-%COMP%]:before, .stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.boss.bordered[_ngcontent-%COMP%]:before, .stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.bb.bordered[_ngcontent-%COMP%]:before{content:" ";position:absolute;bottom:0;right:0;height:1px;width:calc(100% / var(--ghs-fontsize));background:linear-gradient(to right,transparent,var(--ghs-color-darkred))}.stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.elite[_ngcontent-%COMP%]{justify-self:start;color:var(--ghs-color-white);filter:drop-shadow(.01em .01em .01em var(--ghs-color-black));padding-left:.8em}.stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.elite.bordered[_ngcontent-%COMP%]:before{content:" ";position:absolute;bottom:0;left:0;height:1px;width:calc(100% / var(--ghs-fontsize));background:linear-gradient(to right,var(--ghs-color-white),transparent)}.stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{position:relative;justify-self:center;align-self:center;width:2.5em;height:2.5em;display:flex;justify-content:center;align-items:center;z-index:1}.stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:50%;left:50%;width:2em;height:2em;background-color:var(--ghs-color-darkgray);border:.25em solid var(--ghs-color-white);z-index:1;transform:translate(-50%,-50%) rotate(45deg);filter:var(--ghs-filter-outline-thin)}.stats-container[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white);height:1.4em;width:auto;z-index:2}.stats-container[_ngcontent-%COMP%]   .stats.range[_ngcontent-%COMP%]{grid-template-rows:repeat(4,25%)}.stats-container[_ngcontent-%COMP%]   .stats.range.boss[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .stats.range.bb[_ngcontent-%COMP%]{top:29%}.stats-container[_ngcontent-%COMP%]   .stats.range[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{line-height:1.3em}.stats-container[_ngcontent-%COMP%]   .stats.range[_ngcontent-%COMP%]   .stat.normal[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .stats.range[_ngcontent-%COMP%]   .stat.boss[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .stats.range[_ngcontent-%COMP%]   .stat.bb[_ngcontent-%COMP%]{padding-right:.7em}.stats-container[_ngcontent-%COMP%]   .stats.range[_ngcontent-%COMP%]   .stat.elite[_ngcontent-%COMP%]{padding-left:.6em}.stats-container[_ngcontent-%COMP%]   .stats.range[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]:before{width:1.4em;height:1.4em}.stats-container[_ngcontent-%COMP%]   .stats.range[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em}.stats-container.boss[_ngcontent-%COMP%]:before{background-image:url(boss.13ca65d90664eb7d.png)}.stats-container.bb[_ngcontent-%COMP%]:before{background-image:url(bb-standard.fc2741f757bfac9f.png)}.stats-container[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]{position:relative;margin-top:3em;padding-bottom:.4em;width:7.5em;display:flex;flex-direction:column;font-size:1.6em;min-height:8.2em;z-index:2;overflow:auto}.stats-container[_ngcontent-%COMP%]   .extra.normal[_ngcontent-%COMP%]{left:0;text-align:right}.stats-container[_ngcontent-%COMP%]   .extra.normal[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{justify-content:end}.stats-container[_ngcontent-%COMP%]   .extra.normal[_ngcontent-%COMP%]   .placeholder[_ngcontent-%COMP%]{filter:drop-shadow(.01em .01em .01em var(--ghs-color-gray))}.stats-container[_ngcontent-%COMP%]   .extra.elite[_ngcontent-%COMP%]{left:5.6em;color:var(--ghs-color-white)}.stats-container[_ngcontent-%COMP%]   .extra.boss[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .extra.bb[_ngcontent-%COMP%]{width:10.7em;height:auto;left:10em;color:var(--ghs-color-white)}.stats-container[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]{margin-top:2.3%;line-height:.8em;filter:drop-shadow(.01em .01em .01em var(--ghs-color-black))}.stats-container[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .additional[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .specials[_ngcontent-%COMP%]{display:flex;align-items:baseline;font-size:calc(1em * var(--ghs-fontsize))}.stats-container[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .additional[_ngcontent-%COMP%]   ghs-actions[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .specials[_ngcontent-%COMP%]   ghs-actions[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.stats-container[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .additional[_ngcontent-%COMP%]   ghs-actions[_ngcontent-%COMP%]:first-child, .stats-container[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .specials[_ngcontent-%COMP%]   ghs-actions[_ngcontent-%COMP%]:first-child{margin-top:2.3%}.stats-container[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .additional.specials[_ngcontent-%COMP%]   .special[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .specials.specials[_ngcontent-%COMP%]   .special[_ngcontent-%COMP%]{margin-right:.5%}.stats-container[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]{position:absolute;top:calc(7.85em - 2.25em * var(--ghs-fontsize));left:calc(2.525em - 1.125em * var(--ghs-fontsize));display:grid;justify-items:center;align-items:center;grid-template-columns:repeat(5,calc(2.25em * var(--ghs-fontsize)));grid-template-rows:repeat(8,calc(1.125em * var(--ghs-fontsize)));column-gap:calc(.4em * var(--ghs-fontsize));row-gap:calc(.2em * var(--ghs-fontsize));z-index:0}.stats-container[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]{position:relative;display:block;width:calc(2.25em * var(--ghs-fontsize));height:calc(2.25em * var(--ghs-fontsize))}.stats-container[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;width:100%;z-index:1}.stats-container[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(1){grid-column:1;grid-row:2}.stats-container[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(2){grid-column-start:1;grid-column-end:3;grid-row:3}.stats-container[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(3){grid-column:2;grid-row:4}.stats-container[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(4){grid-column-start:2;grid-column-end:4;grid-row:5}.stats-container[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(5){grid-column-start:1;grid-column-end:3;grid-row:1}.stats-container[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(6){grid-column:2;grid-row:2}.stats-container[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(7){grid-column-start:2;grid-column-end:4;grid-row:3}.stats-container[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(8){grid-column:3;grid-row:4}.stats-container[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(9){grid-column-start:2;grid-column-end:4;grid-row:1}.stats-container[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(10){grid-column:3;grid-row:2}.stats-container[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(11){grid-column-start:3;grid-column-end:5;grid-row:3}.stats-container[_ngcontent-%COMP%]   .immunities[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(12){grid-column-start:3;grid-row:1;grid-column-end:5}.stats-container[_ngcontent-%COMP%]   .immunities.normal[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(5){grid-column:3;grid-row:6}.stats-container[_ngcontent-%COMP%]   .immunities.normal[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(6){grid-column-start:3;grid-column-end:5;grid-row:7}.stats-container[_ngcontent-%COMP%]   .immunities.normal[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(7){grid-column-start:1;grid-column-end:3;grid-row:1}.stats-container[_ngcontent-%COMP%]   .immunities.normal[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(8){grid-column:2;grid-row:2}.stats-container[_ngcontent-%COMP%]   .immunities.normal[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(9){grid-column-start:2;grid-column-end:4;grid-row:3}.stats-container[_ngcontent-%COMP%]   .immunities.normal[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(10){grid-column:3;grid-row:4}.stats-container[_ngcontent-%COMP%]   .immunities.normal[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(11){grid-column-start:3;grid-column-end:5;grid-row:5}.stats-container[_ngcontent-%COMP%]   .immunities.normal[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(12){grid-column:4;grid-row:6}.stats-container[_ngcontent-%COMP%]   .immunities.elite[_ngcontent-%COMP%]{left:initial;right:1.4em}.stats-container[_ngcontent-%COMP%]   .immunities.elite[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(1){grid-column:5;grid-row:2}.stats-container[_ngcontent-%COMP%]   .immunities.elite[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(2){grid-column-start:4;grid-column-end:6;grid-row:3}.stats-container[_ngcontent-%COMP%]   .immunities.elite[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(3){grid-column:4;grid-row:4}.stats-container[_ngcontent-%COMP%]   .immunities.elite[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(4){grid-column-start:3;grid-column-end:5;grid-row:5}.stats-container[_ngcontent-%COMP%]   .immunities.elite[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(5){grid-column:3;grid-row:6}.stats-container[_ngcontent-%COMP%]   .immunities.elite[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(6){grid-column-start:2;grid-column-end:4;grid-row:7}.stats-container[_ngcontent-%COMP%]   .immunities.elite[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(7){grid-column-start:4;grid-column-end:6;grid-row:1}.stats-container[_ngcontent-%COMP%]   .immunities.elite[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(8){grid-column:4;grid-row:2}.stats-container[_ngcontent-%COMP%]   .immunities.elite[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(9){grid-column-start:3;grid-column-end:5;grid-row:3}.stats-container[_ngcontent-%COMP%]   .immunities.elite[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(10){grid-column:3;grid-row:4}.stats-container[_ngcontent-%COMP%]   .immunities.elite[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(11){grid-column-start:2;grid-column-end:4;grid-row:5}.stats-container[_ngcontent-%COMP%]   .immunities.elite[_ngcontent-%COMP%]   .immunity[_ngcontent-%COMP%]:nth-child(12){grid-column:2;grid-row:6}.stats-container[_ngcontent-%COMP%]   .immunities.boss[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%]   .immunities.bb[_ngcontent-%COMP%]{z-index:1}.stats-container.no-click[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%], .stats-container.no-click[_ngcontent-%COMP%]   .toggle-ally[_ngcontent-%COMP%]{pointer-events:none}.stats-container.no-click[_ngcontent-%COMP%]   .entity-menu[_ngcontent-%COMP%]{display:none}.stats-container[_ngcontent-%COMP%]   .filter-stats[_ngcontent-%COMP%]{display:none;position:absolute;inset:0;background-color:var(--ghs-color-darkgray);opacity:.4;z-index:3}.stats-container[_ngcontent-%COMP%]   .filter-stats.normal[_ngcontent-%COMP%]{right:50%}.stats-container[_ngcontent-%COMP%]   .filter-stats.elite[_ngcontent-%COMP%]{left:50%;right:0}.stats-editor[_nghost-%COMP%]   .extra[_ngcontent-%COMP%], .stats-editor[_nghost-%COMP%]   .name-container[_ngcontent-%COMP%]{display:none!important}']})}return i})();const XD=i=>({detailed:i}),BD=i=>({checked:i}),YD=(i,r)=>r.edition+"-"+r.name,ND=(i,r)=>r.type;function zD(i,r){1&i&&(t.j41(0,"span",1)(1,"span"),t.nrm(2,"span",8),t.k0s()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","scenario.setup"))}function LD(i,r){if(1&i){const e=t.RV6();t.j41(0,"label",3)(1,"input",9),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.detailed,n)||(o.detailed=n),t.Njj(n)}),t.k0s(),t.nrm(2,"span",8),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.R50("ngModel",e.detailed),t.R7$(),t.Y8G("ghs-label","scenario.setup.detailed")}}function UD(i,r){if(1&i){const e=t.RV6();t.j41(0,"label",3)(1,"input",10),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.spoiler,n)||(o.spoiler=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.updateMonster())}),t.k0s(),t.nrm(2,"span",8),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.R50("ngModel",e.spoiler),t.R7$(),t.Y8G("ghs-label","scenario.setup.spoiler")}}function qD(i,r){1&i&&t.nrm(0,"span",13)}function HD(i,r){if(1&i&&t.nrm(0,"span",14),2&i){const e=t.XpG(3);t.Y8G("ngClass",t.eq3(1,BD,e.lootRandomItem))}}function KD(i,r){if(1&i&&(t.j41(0,"div",12),t.nVh(1,qD,1,0,"span",13),t.nVh(2,HD,1,3,"span",14),t.nrm(3,"img",15),t.j41(4,"span",16),t.EFF(5,"x"),t.k0s(),t.EFF(6),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.vxM("random_item"!=e.type?1:-1),t.R7$(),t.vxM("random_item"==e.type?2:-1),t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+e.type+".svg",t.B4B),t.R7$(3),t.SpI("",e.value," ")}}function WD(i,r){if(1&i&&(t.j41(0,"div",5),t.nrm(1,"div",11),t.Z7z(2,KD,7,4,"div",12,ND),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","game.loot"),t.R7$(),t.Dyx(e.lootConfig)}}function JD(i,r){if(1&i&&t.nrm(0,"img",22),2&i){const e=t.XpG().$implicit,a=t.XpG();t.Y8G("src",a.gameManager.monsterManager.monsterThumbnail(e),t.B4B)}}function ZD(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.JRh(e[0])}}function QD(i,r){if(1&i&&(t.j41(0,"span",23),t.Z7z(1,ZD,2,1,"span",null,t.fX1),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(),t.Dyx(a.settingsManager.getLabel("data.monster."+e.name).split(" "))}}function t6(i,r){1&i&&(t.j41(0,"span",24),t.nrm(1,"img",28),t.k0s())}function e6(i,r){1&i&&(t.j41(0,"span",25),t.EFF(1,"*"),t.k0s())}function n6(i,r){if(1&i&&t.nrm(0,"ghs-monster-stats",27),2&i){const e=t.XpG().$implicit;t.Y8G("monster",e)("forceStats",!0)("noClick",!0)("disablePoup",!0)}}function i6(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",17),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.openStats(n))}),t.j41(1,"div",18)(2,"div",19)(3,"div",20)(4,"div",21),t.nVh(5,JD,1,1,"img",22),t.nVh(6,QD,3,0,"span",23),t.k0s()()(),t.nVh(7,t6,2,0,"span",24),t.nVh(8,e6,2,0,"span",25),t.k0s(),t.j41(9,"div",26),t.nrm(10,"span",8),t.k0s(),t.nVh(11,n6,1,4,"ghs-monster-stats",27),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.R7$(5),t.vxM(!e.noThumbnail&&a.settingsManager.settings.artwork?5:-1),t.R7$(),t.vxM(e.noThumbnail||!a.settingsManager.settings.artwork?6:-1),t.R7$(),t.vxM(e.boss||-1!=e.tags.indexOf("boss")?7:-1),t.R7$(),t.vxM(e.standeeShare||e.statEffect?8:-1),t.R7$(2),t.Y8G("ghs-label","data.monster."+e.name),t.R7$(),t.vxM(a.detailed?11:-1)}}let fr=(()=>{class i{dialog;scenario;spoiler=!1;title=!0;details=!0;gameManager=s.E;settingsManager=m.f;monsters=[];lootConfig=[];lootRandomItem=!1;hasSpoiler=!1;detailed=!1;constructor(e){this.dialog=e}ngOnInit(){if(this.updateMonster(),this.scenario.lootDeckConfig)for(let e in ot.r6){const a=e;this.scenario.lootDeckConfig[a]&&(this.lootConfig.push({type:a,value:this.scenario.lootDeckConfig[a]||0}),a==ot.r6.random_item&&s.E.game.party.randomItemLooted.find(n=>n.edition==this.scenario.edition&&n.group==this.scenario.group&&n.index==this.scenario.index)&&(this.lootRandomItem=!0))}}updateMonster(){this.monsters=[];const e=s.E.editionRules("cs"),a=!s.E.editionRules("fc")||this.spoiler;this.hasSpoiler=!1,!a&&s.E.scenarioManager.getMonsters(this.scenario,!1,this.scenario.custom).length!=s.E.scenarioManager.getMonsters(this.scenario,!0,this.scenario.custom).length&&(this.hasSpoiler=!0),s.E.scenarioManager.getMonsters(this.scenario,a,this.scenario.custom).forEach(n=>{let o=new P.R(n,s.E.game.level);if(this.spoiler||!o.standeeShare||s.E.scenarioManager.openRooms().find(y=>y.initial&&y.monster.find(B=>B.name.split(":")[0]==o.name))||s.E.game.figures.some(y=>y instanceof P.R&&y.name==o.name&&y.edition==o.edition))this.monsters.find(y=>y.edition==o.edition&&y.name==o.name)||(o.tags=[],this.monsters.push(o));else{const y=s.E.monstersData().find(B=>B.name==o.standeeShare&&B.edition==(o.standeeShareEdition||o.edition));if(y){const B=new P.R(JSON.parse(JSON.stringify(y)));B.tags=B.tags||[],e&&o.boss&&B.tags.push("boss");const nt=this.monsters.find(Z=>Z.name==B.name&&Z.edition==B.edition);nt?!this.spoiler&&e&&(nt.tags=nt.tags||[],o.boss&&(this.hasSpoiler=!0,nt.tags.push("boss"))):(this.hasSpoiler=!0,this.monsters.push(B))}}let g=this.scenario.rules?this.scenario.rules.filter(y=>y.statEffects).flatMap(y=>y.statEffects):[],_=g.find(y=>s.E.figuresByIdentifier(y.identifier,!1,[o]).length);_||s.E.scenarioManager.getSections(this.scenario).forEach(y=>{!_&&y.rules&&(g=y.rules.filter(B=>B.statEffects).flatMap(B=>B.statEffects),_=g.find(B=>s.E.figuresByIdentifier(B.identifier,!1,[o]).length))}),_&&(this.hasSpoiler=!0,this.spoiler&&(o.statEffect=_.statEffect,o.statEffect.note=_.note))}),this.monsters=this.monsters.filter((n,o,g)=>!g.find(_=>n.standeeShare==_.edition&&n.standeeShareEdition==_.name)).sort((n,o)=>m.f.getLabel("data.monster."+n.name).toLowerCase()<m.f.getLabel("data.monster."+o.name).toLowerCase()?-1:1)}openStats(e){s.E.monsterManager.resetMonsterAbilities(e),this.dialog.open(Ua,{panelClass:["dialog"],data:{monster:e,statEffectNote:e.statEffect?e.statEffect.note:""}})}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-scenario-setup"]],inputs:{scenario:"scenario",spoiler:"spoiler",title:"title",details:"details"},standalone:!1,decls:10,vars:7,consts:[[1,"setup"],[1,"title"],[1,"setup-container"],[1,"checkbox"],[1,"setup-container",3,"ngClass"],[1,"loot-config"],[1,"monsters"],["tabclick","",1,"monster"],[3,"ghs-label"],["tabclick","","type","checkbox",3,"ngModelChange","ngModel"],["tabclick","","type","checkbox",3,"ngModelChange","change","ngModel"],[1,"title",3,"ghs-label"],[1,"loot"],[1,"spacer"],["tabclick","",1,"checkbox",3,"ngClass"],[1,"ghs-svg",3,"src"],[1,"sign"],["tabclick","",1,"monster",3,"click"],[1,"image"],[1,"outer-border"],[1,"inner-border"],[1,"image-container"],[3,"src"],[1,"letter"],[1,"boss"],[1,"custom"],[1,"name"],[3,"monster","forceStats","noClick","disablePoup"],["src","./assets/images/monster/enemy.png"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nVh(1,zD,3,1,"span",1),t.j41(2,"div",2),t.nVh(3,LD,3,2,"label",3),t.nVh(4,UD,3,2,"label",3),t.k0s(),t.j41(5,"div",4),t.nVh(6,WD,4,1,"div",5),t.j41(7,"div",6),t.Z7z(8,i6,12,6,"div",7,YD),t.k0s()()()),2&a&&(t.R7$(),t.vxM(n.title?1:-1),t.R7$(2),t.vxM(n.details?3:-1),t.R7$(),t.vxM(n.hasSpoiler||n.spoiler?4:-1),t.R7$(),t.Y8G("ngClass",t.eq3(5,XD,n.detailed)),t.R7$(),t.vxM(n.lootConfig.length>0?6:-1),t.R7$(2),t.Dyx(n.monsters))},dependencies:[N.YU,O.Zm,O.BC,O.vS,tt,jn,At],styles:['.setup[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;color:var(--ghs-color-white);margin-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.setup[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;text-align:center;color:var(--ghs-color-gray);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor))}.setup[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{cursor:pointer;display:flex;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.setup[_ngcontent-%COMP%]   .loot-config[_ngcontent-%COMP%]{display:flex;flex-direction:column;background-color:var(--ghs-color-gray);margin-right:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));border-top-left-radius:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));border-top-right-radius:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));border-bottom-left-radius:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));border-bottom-right-radius:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));padding-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.setup[_ngcontent-%COMP%]   .loot-config[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;justify-content:center;color:var(--ghs-color-white);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));background-color:var(--ghs-color-darkgray);padding:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));border-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor)) solid var(--ghs-color-black);border-top-left-radius:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));border-top-right-radius:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.setup[_ngcontent-%COMP%]   .loot-config[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--ghs-color-black);font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor))}.setup[_ngcontent-%COMP%]   .loot-config[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{cursor:initial;display:inline-block;position:relative;width:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));color:var(--ghs-color-black);border:calc(var(--ghs-unit) * .4 * var(--ghs-text-factor)) solid var(--ghs-color-black);background-color:var(--ghs-color-white);margin:0;margin-top:calc(var(--ghs-unit) * .2 * var(--ghs-text-factor));margin-right:calc(var(--ghs-unit) * -.2 * var(--ghs-text-factor))}.setup[_ngcontent-%COMP%]   .loot-config[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:before{position:absolute;left:-10%;top:-56%;content:" ";width:150%;height:160%;transform:scale(0);transform-origin:bottom left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;clip-path:polygon(14% 44%,0 65%,50% 100%,100% 16%,80% 0%,43% 62%);color:var(--ghs-color-gray);background-color:var(--ghs-color-gray)}.setup[_ngcontent-%COMP%]   .loot-config[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]   .checkbox.checked[_ngcontent-%COMP%]:before{transform:scale(1);color:var(--ghs-color-black);background-color:var(--ghs-color-black)}.setup[_ngcontent-%COMP%]   .loot-config[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]   .sign[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.7 * var(--ghs-text-factor))}.setup[_ngcontent-%COMP%]   .loot-config[_ngcontent-%COMP%]   .loot[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1.3em;width:auto;filter:var(--ghs-filter-black);margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:flex-start;flex-wrap:wrap;height:100%}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;flex-direction:column;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 13 * var(--ghs-dialog-factor))}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]:hover{opacity:.7}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{position:relative}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 11 * .866025 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 11 * var(--ghs-dialog-factor));background-color:var(--ghs-color-white);clip-path:polygon(50% 0,100% 25%,100% 75%,50% 100%,0 75%,0 25%)}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 10.3 * .866025 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 10.3 * var(--ghs-dialog-factor));background-color:var(--ghs-color-red);clip-path:polygon(50% 0,100% 25%,100% 75%,50% 100%,0 75%,0 25%)}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 9 * .866025 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 9 * var(--ghs-dialog-factor));background-color:var(--ghs-color-darkgray);clip-path:polygon(50% 0,100% 25%,100% 75%,50% 100%,0 75%,0 25%)}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 9 * var(--ghs-dialog-factor));height:auto}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .letter[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-white);font-family:var(--ghs-font-title)}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .boss[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));position:absolute;top:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * -1 * var(--ghs-dialog-factor));background-color:var(--ghs-color-darkred);border:2px solid var(--ghs-color-gray);border-radius:100%}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .boss[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.7 * var(--ghs-dialog-factor));height:auto}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .custom[_ngcontent-%COMP%]{display:flex;justify-content:center;width:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));position:absolute;bottom:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * -1 * var(--ghs-dialog-factor));font-family:var(--ghs-font-gh-title);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 9 * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 9 * var(--ghs-text-factor));background-color:var(--ghs-color-darkgray);border:2px solid var(--ghs-color-gray);border-radius:100%}.setup[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{text-align:center;color:var(--ghs-color-gray);font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));padding:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.setup[_ngcontent-%COMP%]   .setup-container[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));display:flex;align-items:center}.setup[_ngcontent-%COMP%]   .setup-container.detailed[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor))}.setup[_ngcontent-%COMP%]   .setup-container.detailed[_ngcontent-%COMP%]   .monsters[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]   ghs-monster-stats[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 21.5 * var(--ghs-dialog-factor))}']})}return i})();const Cr=i=>({visible:i}),a6=(i,r,e,a)=>({casual:i,success:r,locked:e,blocked:a}),o6=i=>({looted:i}),s6=(i,r)=>r.edition+r.index;function r6(i,r){if(1&i&&t.nrm(0,"span",2),2&i){const e=t.XpG();t.Y8G("ghs-label","data.custom."+e.scenario.edition+".flowChartGroup."+e.scenario.flowChartGroup)}}function c6(i,r){if(1&i&&(t.j41(0,"div",6),t.nrm(1,"label",10)(2,"ghs-requirements",17)(3,"div",18),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","scenario.requirements"),t.R7$(),t.Y8G("scenarioData",e.scenarioData)("all",!0)("allToggle",!1)}}function l6(i,r){1&i&&t.nrm(0,"label",10),2&i&&t.Y8G("ghs-label","scenario.chart.setup")}function g6(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function d6(i,r){if(1&i&&(t.j41(0,"span"),t.nVh(1,g6,2,0,"span"),t.EFF(2),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.vxM(!(""+e).startsWith("G")&&+e<10&&+e>=0?1:-1),t.R7$(),t.SpI(" ",(""+e).startsWith("G-")?"G":(""+e).split(":")[0]," ")}}function h6(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"???"),t.k0s())}function _6(i,r){if(1&i&&t.nrm(0,"ghs-treasure-label",22),2&i){const e=t.XpG().$implicit,a=t.XpG();t.Y8G("edition",a.scenario.edition)("index",+(""+e).split(":")[0]-1)("rewardResults",a.gameManager.scenarioManager.treasureRewardsFromString(""+e))}}function m6(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",12)(1,"div",19),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.openTreasureDialog(+n.split(":")[0]))}),t.nVh(2,d6,3,2,"span"),t.nVh(3,h6,2,0,"span"),t.nrm(4,"img",20),t.k0s(),t.j41(5,"span",21),t.nVh(6,_6,1,3,"ghs-treasure-label",22),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(4,o6,-1!=a.lootedTreasures.indexOf(+e.split(":")[0]))),t.R7$(),t.vxM((""+e).startsWith("G")||+(""+e).split(":")[0]>=0?2:-1),t.R7$(),t.vxM(!(""+e).startsWith("G")&&+(""+e).split(":")[0]<0?3:-1),t.R7$(3),t.vxM((""+e).startsWith("G-")?-1:6)}}function p6(i,r){1&i&&t.nrm(0,"label",10),2&i&&t.Y8G("ghs-label","scenario.chart.treasures.empty")}function u6(i,r){1&i&&t.nrm(0,"label",10),2&i&&t.Y8G("ghs-label","scenario.chart.treasures")}function f6(i,r){1&i&&t.nrm(0,"img",23)}function C6(i,r){if(1&i&&(t.nVh(0,f6,1,0,"img",23),t.nrm(1,"span",24)),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.vxM(a>0&&a<n.predecessors.length?0:-1),t.R7$(),t.Y8G("ghs-label","%game.scenarioNumber:"+e.index+"%")}}function M6(i,r){if(1&i&&(t.j41(0,"span",13),t.Z7z(1,C6,2,2,null,null,s6),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.predecessors)}}function v6(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",25),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.addSuccess())}),t.k0s()}2&i&&t.Y8G("ghs-label","scenario.chart.success")}let Mr=(()=>{class i{scenarioData;dialogRef;dialog;gameManager=s.E;scenario;isSuccess=!1;showSetup=!1;showTreasures=!1;hasRequirements=!1;hasMissingRequirements=!1;allRequirements=!1;predecessors=[];treasures=[];lootedTreasures=[];constructor(e,a,n){this.scenarioData=e,this.dialogRef=a,this.dialog=n,this.scenario=new ht.Nz(e),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.isSuccess=s.E.scenarioManager.isSuccess(this.scenario),this.showSetup=this.isSuccess,this.hasRequirements=s.E.scenarioManager.getRequirements(this.scenario,!0).length>0,this.hasMissingRequirements=s.E.scenarioManager.getRequirements(this.scenario).length>0,this.lootedTreasures=[],this.treasures=s.E.scenarioManager.getTreasures(this.scenario,s.E.scenarioManager.getSections(this.scenario).map(a=>new ht.Nz(a)),!1,!0).filter(a=>"G"!=a).map(a=>{a=+a;const n=s.E.game.party.treasures.find(o=>o.edition==this.scenario.edition&&(o.name==""+a||o.name.startsWith(a+":")));return n?(this.lootedTreasures.push(a),n.name):""+a}),this.showTreasures=this.treasures.length>0&&this.treasures.length==this.lootedTreasures.length||this.showSetup,this.predecessors=[];let e=s.E.scenarioManager.scenarioData(this.scenario.edition).find(a=>a.group==this.scenario.group&&a.unlocks&&-1!=a.unlocks.indexOf(this.scenario.index)&&(!s.E.game.party.campaignMode||s.E.scenarioManager.isSuccess(a)));for(e||(e=s.E.sectionData(this.scenario.edition).find(a=>a.conclusion&&a.group==this.scenario.group&&a.parent&&a.unlocks&&-1!=a.unlocks.indexOf(this.scenario.index)&&s.E.game.party.conclusions.find(n=>n.edition==a.edition&&n.group==a.group&&n.index==a.index)),e&&(e=s.E.scenarioManager.scenarioData(e.edition).find(a=>e&&a.group==e.group&&a.index==e.parent&&(!s.E.game.party.campaignMode||s.E.scenarioManager.isSuccess(a)))));e;){this.predecessors.unshift(e);let a=s.E.scenarioManager.scenarioData(e.edition).find(n=>e&&n.group==e.group&&n.unlocks&&-1!=n.unlocks.indexOf(e.index)&&(!s.E.game.party.campaignMode||s.E.scenarioManager.isSuccess(n)));a||(a=s.E.sectionData(e.edition).find(n=>e&&n.conclusion&&n.group==e.group&&n.parent&&n.unlocks&&-1!=n.unlocks.indexOf(e.index)&&s.E.game.party.conclusions.find(o=>o.edition==n.edition&&o.group==n.group&&o.index==n.index)),a&&(a=s.E.scenarioManager.scenarioData(e.edition).find(n=>a&&n.group==a.group&&n.index==a.parent&&(!s.E.game.party.campaignMode||s.E.scenarioManager.isSuccess(n))))),e=a,e&&-1!=this.predecessors.indexOf(e)&&(e=void 0)}}setScenario(){s.E.scenarioManager.isCurrent(this.scenario)||(s.E.scenarioManager.isLocked(this.scenario)?this.dialog.open(Mi,{panelClass:["dialog"],data:{scenarioData:this.scenario}}).closed.subscribe({next:e=>{e&&this.dialogRef.close(e)}}):(s.E.stateManager.before("setScenario",...s.E.scenarioManager.scenarioUndoArgs(new ht.Nz(this.scenario))),s.E.scenarioManager.setScenario(new ht.Nz(this.scenario)),s.E.stateManager.after(),(0,V.co)(this.dialogRef,!0)))}openTreasureDialog(e){-1==this.lootedTreasures.indexOf(e)&&this.dialog.open(pr,{panelClass:["dialog"],data:{edition:this.scenario.edition,scenario:this.scenario}})}addSuccess(){const e=s.E.sectionData(this.scenario.edition).filter(a=>a.edition==this.scenario.edition&&a.parent==this.scenario.index&&a.group==this.scenario.group&&a.conclusion&&0==s.E.scenarioManager.getRequirements(a).length);0==e.length?this.addSuccessIntern():this.dialog.open(Se,{panelClass:["dialog"],data:{conclusions:e,parent:this.scenario}}).closed.subscribe({next:a=>{a&&this.addSuccessIntern(a)}})}addSuccessIntern(e=void 0){s.E.stateManager.before("finishScenario.success",...s.E.scenarioManager.scenarioUndoArgs(new ht.Nz(this.scenario))),s.E.scenarioManager.finishScenario(new ht.Nz(this.scenario),!0,e,!1,!1,!1,s.E.game.party.campaignMode&&0==this.countFinished(),!0),s.E.stateManager.after(),this.update()}countFinished(){return(s.E.game.party.campaignMode?s.E.game.party.scenarios:s.E.game.party.casualScenarios).filter(e=>this.scenario.index==e.index&&this.scenario.edition==e.edition&&this.scenario.group==e.group).length}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-scneario-chart-popup"]],standalone:!1,decls:22,vars:26,consts:[[1,"scenario-chart-popup","scroll-container"],[1,"header"],[1,"subtitle",3,"ghs-label"],[1,"title"],[1,"number","text-white",3,"ghs-label"],[1,"name","text-white",3,"ghs-label"],[1,"spoiler-block","visible"],[1,"spoiler-block",3,"ngClass"],[3,"scenario","details","title","spoiler"],[1,"background",3,"click"],[3,"ghs-label"],[1,"treasures"],[1,"hint-container"],[1,"predecessors"],[1,"buttons"],[1,"play",3,"click","ngClass","ghs-label"],[1,"success",3,"ghs-label"],[3,"scenarioData","all","allToggle"],[1,"background"],[1,"treasure","hint-trigger",3,"click","ngClass"],["src","./assets/images/check.svg",1,"overlay","check"],[1,"hint","above","center"],[1,"text","placeholder","text-white",3,"edition","index","rewardResults"],["src","./assets/images/arrow-up.svg",1,"ghs-svg"],[1,"text-white",3,"ghs-label"],[1,"success",3,"click","ghs-label"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.nVh(2,r6,1,1,"span",2),t.j41(3,"span",3),t.nrm(4,"span",4)(5,"span",5),t.k0s()(),t.nVh(6,c6,4,4,"div",6),t.j41(7,"div",7),t.nrm(8,"ghs-scenario-setup",8),t.j41(9,"div",9),t.bIt("click",function(){return n.showSetup=!0}),t.nVh(10,l6,1,1,"label",10),t.k0s()(),t.j41(11,"div",7)(12,"div",11),t.Z7z(13,m6,7,6,"div",12,t.fX1),t.k0s(),t.nVh(15,p6,1,1,"label",10),t.j41(16,"div",9),t.bIt("click",function(){return n.showTreasures=!0}),t.nVh(17,u6,1,1,"label",10),t.k0s()(),t.nVh(18,M6,3,0,"span",13),t.j41(19,"div",14)(20,"a",15),t.bIt("click",function(){return n.setScenario()}),t.k0s(),t.nVh(21,v6,1,1,"a",16),t.k0s()()),2&a&&(t.R7$(2),t.vxM(n.scenario.flowChartGroup?2:-1),t.R7$(2),t.Y8G("ghs-label","%game.scenarioNumber:"+n.scenario.index+"%"),t.R7$(),t.Y8G("ghs-label",n.gameManager.scenarioManager.scenarioTitle(n.scenarioData)),t.R7$(),t.vxM(n.hasRequirements?6:-1),t.R7$(),t.Y8G("ngClass",t.eq3(17,Cr,n.showSetup)),t.R7$(),t.Y8G("scenario",n.scenario)("details",!1)("title",!1)("spoiler",n.gameManager.scenarioManager.isSuccess(n.scenario)),t.R7$(2),t.vxM(n.showSetup?-1:10),t.R7$(),t.Y8G("ngClass",t.eq3(19,Cr,n.showTreasures)),t.R7$(2),t.Dyx(n.treasures),t.R7$(2),t.vxM(n.showTreasures&&0==n.treasures.length?15:-1),t.R7$(2),t.vxM(n.showTreasures?-1:17),t.R7$(),t.vxM(n.predecessors.length?18:-1),t.R7$(2),t.Y8G("ngClass",t.ziG(21,a6,!n.gameManager.game.party.campaignMode,n.gameManager.scenarioManager.isSuccess(n.scenario),n.gameManager.scenarioManager.isLocked(n.scenario),n.gameManager.scenarioManager.isBlocked(n.scenario)))("ghs-label","scenario.chart.start"),t.R7$(),t.vxM(n.isSuccess?-1:21))},dependencies:[N.YU,tt,es,fr,Pn],styles:['.scenario-chart-popup[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.scenario-chart-popup[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-family:var(--ghs-font-normal);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor))}.scenario-chart-popup[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center}.scenario-chart-popup[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.scenario-chart-popup[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor))}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:center;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));padding:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor))}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   ghs-scenario-setup[_ngcontent-%COMP%]{visibility:hidden;z-index:2}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]{visibility:hidden;display:flex;justify-content:center;align-items:center;flex-wrap:wrap;z-index:2;min-height:calc(var(--ghs-unit) * 10 * var(--ghs-dialog-factor))}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;background-image:url(treasure.0792d529e76ec279.png);background-size:contain;background-repeat:no-repeat;background-position:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-black);width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));transition:translate calc(var(--ghs-animation-speed) * .5s) ease-in-out}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{display:none;position:absolute;top:30%;left:50%;transform:translate(-50%);height:50%;width:auto}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .overlay.check[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%] + .hint[_ngcontent-%COMP%]{display:none}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.looted[_ngcontent-%COMP%]{cursor:pointer}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.looted[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{display:block}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.looted[_ngcontent-%COMP%]:hover{opacity:.8;transform:scale(1.1)}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure.looted[_ngcontent-%COMP%] + .hint[_ngcontent-%COMP%]{display:block}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .background[_ngcontent-%COMP%]{cursor:pointer;position:absolute;inset:0;z-index:1}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .background[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;position:absolute;inset:0;display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));color:var(--ghs-color-white);z-index:2}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .background[_ngcontent-%COMP%]:before{content:" ";position:absolute;inset:0;background-color:var(--ghs-color-darkgray);border-radius:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));opacity:.3;z-index:0}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .background[_ngcontent-%COMP%]:hover   label[_ngcontent-%COMP%]{opacity:.7}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block[_ngcontent-%COMP%]   .background[_ngcontent-%COMP%]:hover:before{opacity:.5}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block.visible[_ngcontent-%COMP%]   ghs-scenario-setup[_ngcontent-%COMP%], .scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block.visible[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]{visibility:visible}.scenario-chart-popup[_ngcontent-%COMP%]   .spoiler-block.visible[_ngcontent-%COMP%]   .background[_ngcontent-%COMP%]{pointer-events:none}.scenario-chart-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly;align-items:center}.scenario-chart-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.scenario-chart-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.scenario-chart-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .play[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.scenario-chart-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .play.casual[_ngcontent-%COMP%]{color:var(--ghs-color-gray)}.scenario-chart-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .play[_ngcontent-%COMP%]:not(.casual).success{cursor:initial;color:var(--ghs-color-darkgray)}.scenario-chart-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .play[_ngcontent-%COMP%]:not(.casual).locked:not(.blocked){cursor:initial;color:var(--ghs-color-yellow)}.scenario-chart-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .play[_ngcontent-%COMP%]:not(.casual).blocked{cursor:initial;color:var(--ghs-color-red)}.scenario-chart-popup[_ngcontent-%COMP%]   .predecessors[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.scenario-chart-popup[_ngcontent-%COMP%]   .predecessors[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white);transform:rotate(90deg);height:1em;width:auto;margin:0 .1em}']})}return i})();const O6=i=>({highlighting:i});let Zn=(()=>{class i{edition;dialogRef;dialog;gameManager=s.E;settingsManager=m.f;map;worldMap;mapEdition;scenarios=[];conclusions=[];buildings=[];columns=[];rows=[];offsetX=[];offsetY=[];success=[];scale=1;zooming=!1;showExtended=!1;campaignSheet=!1;constructor(e,a,n){this.edition=e,this.dialogRef=a,this.dialog=n;const o=m.f.settings.pinchZoom;m.f.settings.pinchZoom=!1,this.mapEdition=this.edition,this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.updateMap()}),this.update(),this.dialogRef.closed.subscribe({next:()=>{m.f.settings.pinchZoom=o}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){let e=s.E.editionData.find(a=>a.edition==this.edition);e&&!e.worldMap&&e.extendWorldMap&&(e=s.E.editionData.find(a=>e&&a.edition==e.extendWorldMap&&a.worldMap)),e&&e.worldMap&&(this.worldMap=e.worldMap,this.mapEdition=e.edition,this.worldMap&&(this.scenarios=s.E.scenarioManager.scenarioData(this.edition).filter(a=>a.coordinates),this.mapEdition!=this.edition&&this.showExtended&&this.scenarios.push(...s.E.scenarioManager.scenarioData(this.mapEdition).filter(a=>a.coordinates)),s.E.sectionData(this.edition).filter(a=>a.conclusion&&a.coordinates&&a.unlocks&&a.unlocks.length).forEach(a=>{(!s.E.game.party.campaignMode||s.E.game.party.conclusions.find(o=>o.edition==a.edition&&o.index==a.index&&o.group==a.group))&&a.unlocks.forEach(o=>{let g=s.E.scenarioData(a.edition).find(_=>_.edition==a.edition&&_.group==a.group&&_.index==o&&!_.coordinates);if(g){const _=new Vn.tB(g);_.coordinates=a.coordinates,this.scenarios.push(_)}})}),this.conclusions=s.E.sectionData(this.edition).filter(a=>a.conclusion&&a.rewards&&(a.rewards.overlayCampaignSticker||a.rewards.overlaySticker)),this.mapEdition!=this.edition&&this.showExtended&&this.conclusions.push(...s.E.sectionData(this.mapEdition).filter(a=>a.conclusion&&a.rewards&&(a.rewards.overlayCampaignSticker||a.rewards.overlaySticker))),e.campaign&&e.campaign.buildings&&(this.buildings=e.campaign.buildings.filter(a=>a.coordinates&&a.coordinates.length))))}updateMap(){this.update(),this.map&&this.map.remove(),this.ngAfterViewInit()}ngAfterViewInit(){if(this.worldMap){const a=this.worldMap.width,n=this.worldMap.height;this.map=sn().map("map",{crs:sn().CRS.Simple,maxBounds:[[-.5*n,-.5*a],[1.5*n,1.5*a]],minZoom:-4,zoomDelta:.25,zoomSnap:.25,wheelPxPerZoomLevel:240,attributionControl:!1});var e=[[0,0],[n,a]];sn().imageOverlay("./assets/images/world-map/"+this.mapEdition+"/map.jpg",e).addTo(this.map),this.map.fitBounds(e),this.map.zoomIn(),this.scenarios.forEach((o,g)=>{if(o.coordinates){const _=s.E.scenarioManager.isSuccess(o);_&&(this.success[g]=!0);let y=o.index.replaceAll(/[a-zA-Z]+/g,"");for(;y.length<3;)y="0"+y;if(_&&o.rewards&&o.rewards.overlayCampaignSticker){const W=o.rewards.overlayCampaignSticker.coordinates.image||o.edition+"-"+o.rewards.overlayCampaignSticker.name.toLowerCase(),et=this.placeOverlay("./assets/images/world-map/"+o.edition+"/overlays/"+W+".png",o.rewards.overlayCampaignSticker.coordinates,n,g+3);et.addTo(this.map);const it=et.getElement();it&&it.classList.add("building")}if((!s.E.game.party.campaignMode||_)&&o.rewards&&o.rewards.overlaySticker){const W=o.rewards.overlaySticker.coordinates.image||o.edition+"-"+o.rewards.overlaySticker.name.toLowerCase(),et=this.placeOverlay("./assets/images/world-map/"+o.edition+"/overlays/"+W+".png",o.rewards.overlaySticker.coordinates,n,-1);et.addTo(this.map);const it=et.getElement();it&&it.classList.add("overlay")}const nt=this.placeOverlay("./assets/images/world-map/"+o.edition+"/scenarios/"+(o.coordinates.image||o.edition+"-"+y)+".png",o.coordinates,n,g);nt.on("mouseover",W=>{W.target.setZIndex(this.scenarios.length+2)}),nt.on("mouseout",W=>{W.target.setZIndex(g+2)}),nt.on("click",()=>{m.f.settings.debugEditWorldMap||s.E.stateManager.permissions&&!s.E.stateManager.permissions.scenario||this.dialog.open(Mr,{panelClass:["dialog"],data:this.scenarios[g]}).closed.subscribe({next:et=>{et&&this.dialogRef.close()}})}),nt.addTo(this.map);const Z=nt.getElement();if(Z){let W=["scenario"];_&&W.push("success"),s.E.scenarioManager.isBlocked(o)?W.push("blocked"):s.E.scenarioManager.isLocked(o)&&W.push("locked"),W.forEach(et=>Z.classList.add(et))}}}),this.conclusions.forEach((o,g)=>{const _=s.E.game.party.conclusions.find(y=>y.edition==o.edition&&y.index==o.index&&y.group==o.group);if(!s.E.game.party.campaignMode||_){if(o.rewards&&o.rewards.overlayCampaignSticker){const y=o.rewards.overlayCampaignSticker.coordinates.image||o.edition+"-"+o.rewards.overlayCampaignSticker.name.toLowerCase(),B=this.placeOverlay("./assets/images/world-map/"+o.edition+"/overlays/"+y+".png",o.rewards.overlayCampaignSticker.coordinates,n,-1);B.addTo(this.map);const nt=B.getElement();nt&&nt.classList.add("building"),B.on("click",()=>{const Z=this.conclusions[g];let W;Z.parent&&(W=s.E.scenarioData(Z.edition).find(et=>et.edition==Z.edition&&et.group==Z.group&&et.index==Z.parent)),this.dialog.open(Yt,{panelClass:["dialog"],data:{scenario:new ht.Nz(W||Z),conclusion:Z,conclusionOnly:!0}})})}if(o.rewards&&o.rewards.overlaySticker){const y=o.rewards.overlaySticker.coordinates.image||o.edition+"-"+o.rewards.overlaySticker.name.toLowerCase(),B=this.placeOverlay("./assets/images/world-map/"+o.edition+"/overlays/"+y+".png",o.rewards.overlaySticker.coordinates,n,-1);B.addTo(this.map);const nt=B.getElement();nt&&nt.classList.add("overlay")}}}),this.buildings.forEach(o=>{const g=s.E.game.party.buildings.find(y=>y.name==o.name),_=g?g.level:s.E.buildingsManager.initialBuilding(o)?1:s.E.buildingsManager.availableBuilding(o)?0:void 0;if(null!=_&&o.coordinates&&o.coordinates.length){const y=o.coordinates[_||0];if(y){const nt=this.placeOverlay("./assets/images/world-map/"+o.edition+"/buildings/"+(y.image||o.edition+"-"+(o.id?o.id+"-":"")+o.name+(o.upgrades.length?"-"+(_??"0"):""))+".png",y,n,-1);nt.addTo(this.map);const Z=nt.getElement();Z&&Z.classList.add("building")}}})}}placeOverlay(e,a,n,o){let g=sn().imageOverlay(e,[[n-a.y,a.x],[n-a.y-a.height,a.x+a.width]],{interactive:!0});return g.setZIndex(o+2),g.on("mousedown",_=>this.editStartDrag(_)),g.on("mouseleave",_=>this.editStopDrag(_)),g.on("mousemove",_=>this.editMoveDrag(_)),g}editStartDrag(e){if(m.f.settings.debugEditWorldMap){const a=e.target,n=a.getElement();n&&!n.getAttribute("drag")?(this.map.dragging.disable(),n.setAttribute("drag","true"),n.setAttribute("dragLat",""+e.latlng.lat),n.setAttribute("dragLng",""+e.latlng.lng),a.setOpacity(.5)):this.editStopDrag(e)}}editStopDrag(e){if(m.f.settings.debugEditWorldMap){const a=e.target,n=a.getElement();n&&n.getAttribute("drag")&&(this.map.dragging.enable(),this.worldMap&&console.debug('"x": '+a.getBounds().getSouthWest().lng+',\n"y": '+(this.worldMap.height-a.getBounds().getNorthEast().lat)+","),n.removeAttribute("drag"),n.removeAttribute("dragLat"),n.removeAttribute("dragLng"),a.setOpacity(1))}}editMoveDrag(e){if(m.f.settings.debugEditWorldMap){const a=e.target,n=a.getElement();if(n&&n.getAttribute("drag")){let o,g;if(o=+(n.getAttribute("dragLat")||0),g=+(n.getAttribute("dragLng")||0),o&&g){o=e.latlng.lat-o,g=e.latlng.lng-g;const _=new _r.LatLngBounds([a.getBounds().getSouthWest().lat+o,a.getBounds().getSouthWest().lng+g],[a.getBounds().getNorthEast().lat+o,a.getBounds().getNorthEast().lng+g]);a.setBounds(_),e.target.getElement().setAttribute("dragLat",""+e.latlng.lat),e.target.getElement().setAttribute("dragLng",""+e.latlng.lng),e.originalEvent.preventDefault(),e.originalEvent.stopPropagation()}}}}keyboardShortcuts(e){m.f.settings.keyboardShortcuts&&!this.campaignSheet&&(e.ctrlKey||e.shiftKey||"p"!==e.key.toLowerCase()||!m.f.settings.partySheet?e.ctrlKey||e.shiftKey||"c"!==e.key.toLowerCase()||!s.E.game.edition?!e.ctrlKey&&!e.shiftKey&&"h"===e.key.toLowerCase()&&(m.f.toggle("globalMapHighlighting"),e.stopPropagation(),e.preventDefault()):(this.openFlowChart(),e.stopPropagation(),e.preventDefault()):(this.openCampaignSheet(),e.stopPropagation(),e.preventDefault()))}openFlowChart(){this.dialogRef.close(),setTimeout(()=>{this.dialog.open(Qn,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:{edition:this.edition}})},1)}openCampaignSheet(){this.campaignSheet||(this.campaignSheet=!0,this.dialog.open(Ue,{panelClass:["dialog-invert"],data:{disableShortcuts:!0}}).closed.subscribe({next:()=>this.campaignSheet=!1}))}close(){(0,V.co)(this.dialogRef)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-world-map"]],hostBindings:function(a,n){1&a&&t.bIt("keydown",function(g){return n.keyboardShortcuts(g)},t.EBC)},standalone:!1,decls:11,vars:11,consts:[["map",""],[1,"world-map-container"],["id","map",1,"world-map",3,"ngClass"],[1,"menu"],[3,"click","ghs-tooltip","originY","overlayY"],["src","./assets/images/chart.svg"],["src","./assets/images/sheet.svg"],["type","checkbox",3,"click","checked"],[3,"ghs-label"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",1),t.nrm(1,"div",2,0),t.j41(3,"div",3)(4,"a",4),t.bIt("click",function(){return t.eBV(o),t.Njj(n.openFlowChart())}),t.nrm(5,"img",5),t.k0s(),t.j41(6,"a",4),t.bIt("click",function(){return t.eBV(o),t.Njj(n.openCampaignSheet())}),t.nrm(7,"img",6),t.k0s(),t.j41(8,"label")(9,"input",7),t.bIt("click",function(){return t.eBV(o),t.Njj(n.settingsManager.toggle("globalMapHighlighting"))}),t.k0s(),t.nrm(10,"span",8),t.k0s()()()}2&a&&(t.R7$(),t.Y8G("ngClass",t.eq3(9,O6,n.settingsManager.settings.globalMapHighlighting)),t.R7$(3),t.Y8G("ghs-tooltip","scenario.chart")("originY","top")("overlayY","bottom"),t.R7$(2),t.Y8G("ghs-tooltip","party.campaign.manage")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("checked",n.settingsManager.settings.globalMapHighlighting),t.R7$(),t.Y8G("ghs-label","campaign.map.highlighting"))},dependencies:[N.YU,tt,ft],styles:[".world-map-container{position:absolute;top:0;left:0;width:100vw;height:100vh}.world-map-container .world-map{position:relative;width:100%;height:100%;max-width:100%;max-height:100%;overflow:auto;background:none;z-index:1}.world-map-container .world-map .scenario{z-index:2}.world-map-container .world-map .scenario:hover{cursor:pointer;filter:brightness(1.1);opacity:.9}.world-map-container .world-map .building:hover,.world-map-container .world-map.highlighting .scenario{filter:brightness(1.2) drop-shadow(4px 4px 4px var(--ghs-color-darkgray)) drop-shadow(-4px -4px 4px var(--ghs-color-darkgray))}.world-map-container .world-map.highlighting .scenario:hover{cursor:pointer;filter:brightness(1.1);opacity:.9}.world-map-container .world-map.highlighting .scenario.success{cursor:initial;z-index:2;filter:brightness(.8) hue-rotate(30deg)}.world-map-container .world-map.highlighting .scenario.success:hover{cursor:initial;filter:none}.world-map-container .world-map.highlighting .scenario.locked:not(.blocked){cursor:initial;z-index:1;filter:brightness(1)}.world-map-container .world-map.highlighting .scenario.locked:not(.blocked):hover{cursor:initial;filter:brightness(.8) grayscale(.8)}.world-map-container .world-map.highlighting .scenario.blocked{cursor:initial;z-index:1;filter:brightness(.8) sepia(3) hue-rotate(340deg)}.world-map-container .world-map.highlighting .scenario.blocked:hover{cursor:initial;filter:brightness(.8) grayscale(.8)}.world-map-container .world-map.highlighting .scenario.blocked.success{filter:brightness(.8) hue-rotate(30deg) grayscale(.6)}.world-map-container .world-map.highlighting .scenario.blocked.success:hover{filter:brightness(.6) hue-rotate(30deg) grayscale(.6)}.world-map-container .menu{position:absolute;left:0;bottom:0;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);display:flex;align-items:center;z-index:2;background-color:var(--ghs-color-darkgray);border-top-right-radius:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.world-map-container .menu a,.world-map-container .menu label{cursor:pointer;display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.world-map-container .menu a img,.world-map-container .menu label img{filter:var(--ghs-filter-gray);height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));width:auto}.world-map-container .menu a:hover,.world-map-container .menu label:hover{color:var(--ghs-color-white)}.world-map-container .menu a:hover img,.world-map-container .menu label:hover img{filter:var(--ghs-filter-white)}\n"],encapsulation:2})}return i})();const P6=i=>({open:i});function b6(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",10),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openWorldMap())}),t.nrm(1,"img",11),t.k0s()}2&i&&t.Y8G("ghs-tooltip","party.campaign.map")("originY","top")("overlayY","bottom")}function k6(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",10),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openCampaignSheet())}),t.nrm(1,"img",12),t.k0s()}2&i&&t.Y8G("ghs-tooltip","party.campaign.manage")("originY","top")("overlayY","bottom")}function y6(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",13),t.bIt("singleClick",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.toggleCampaignMode(n))})("doubleClick",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.toggleCampaignMode(n,!0))}),t.nrm(1,"input",14)(2,"span",8),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ghs-tooltip","scenario.chart.campaign."+(e.campaignMode?"force":"back"))("originY","top")("overlayY","bottom"),t.R7$(),t.Y8G("checked",e.campaignMode),t.R7$(),t.Y8G("ghs-label","scenario.chart.campaign")}}function x6(i,r){1&i&&(t.j41(0,"ul")(1,"li",4)(2,"span",15),t.EFF(3,"U"),t.k0s(),t.nrm(4,"span",8),t.k0s(),t.j41(5,"li",4)(6,"span",16),t.EFF(7,"S"),t.k0s(),t.nrm(8,"span",8),t.k0s(),t.j41(9,"li",4)(10,"span",17),t.EFF(11,"L"),t.k0s(),t.nrm(12,"span",8),t.k0s(),t.j41(13,"li",4)(14,"span",18),t.EFF(15,"B"),t.k0s(),t.nrm(16,"span",8),t.k0s(),t.j41(17,"li",4)(18,"span",19),t.EFF(19,"SL"),t.k0s(),t.nrm(20,"span",8),t.k0s(),t.j41(21,"li",4)(22,"span",20),t.EFF(23,"SB"),t.k0s(),t.nrm(24,"span",8),t.k0s(),t.j41(25,"li",4)(26,"span",21),t.EFF(27,"NC"),t.k0s(),t.nrm(28,"span",8),t.k0s(),t.j41(29,"li",4)(30,"span",22),t.EFF(31,"NU"),t.k0s(),t.nrm(32,"span",8),t.k0s()()),2&i&&(t.R7$(),t.Y8G("ghs-tooltip","scenario.chart.legend.unplayed.hint")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("ghs-label","scenario.chart.legend.unplayed"),t.R7$(),t.Y8G("ghs-tooltip","scenario.chart.legend.success.hint")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("ghs-label","scenario.chart.legend.success"),t.R7$(),t.Y8G("ghs-tooltip","scenario.chart.legend.locked.hint")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("ghs-label","scenario.chart.legend.locked"),t.R7$(),t.Y8G("ghs-tooltip","scenario.chart.legend.blocked.hint")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("ghs-label","scenario.chart.legend.blocked"),t.R7$(),t.Y8G("ghs-tooltip","scenario.chart.legend.success-locked.hint")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("ghs-label","scenario.chart.legend.success-locked"),t.R7$(),t.Y8G("ghs-tooltip","scenario.chart.legend.success-blocked.hint")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("ghs-label","scenario.chart.legend.success-blocked"),t.R7$(),t.Y8G("ghs-tooltip","scenario.chart.legend.not-campaign.hint")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("ghs-label","scenario.chart.legend.not-campaign"),t.R7$(),t.Y8G("ghs-tooltip","scenario.chart.legend.not-unlocked.hint")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("ghs-label","scenario.chart.legend.not-unlocked"))}let Qn=(()=>{class i{data;dialogRef;dialog;overlay;flow=[];flowString="";edition;group;worldMap=!1;campaignSheet=!1;campaignMode=!0;legend=!1;chart;mermaid=null;gameManager=s.E;constructor(e,a,n,o){this.data=e,this.dialogRef=a,this.dialog=n,this.overlay=o,this.edition=e.edition,this.group=e.group,this.campaignMode=s.E.game.party.campaignMode}ngOnInit(){var e=this;return(0,X.A)(function*(){if(!e.mermaid){const a=yield Promise.all([M.e(911),M.e(879)]).then(M.bind(M,3939));e.mermaid=a.default,e.mermaid.initialize({startOnLoad:!1,flowchart:{useMaxWidth:!0,htmlLabels:!0,curve:"linear",subGraphTitleMargin:{bottom:10}},theme:"base",themeVariables:{fontSize:"calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))",fontFamily:"var(--ghs-font-text)",darkMode:!0,primaryColor:"#202830",secondaryColor:"transparent",tertiaryColor:"#52565f",tertiaryBorderColor:"#202830",tertiaryTextColor:"#eeeeee"},wrap:!1,securityLevel:"loose",logLevel:5})}e.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>e.updateMap()}),e.update()})()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){let a;this.flow=["flowchart LR","classDef default stroke-width:4, r:32px;","classDef success stroke:#7da82a;","classDef unplayed stroke:#56c8ef;","classDef blocked stroke:#e2421f;","classDef locked stroke:#eca610;","classDef success-blocked fill:#7da82a,stroke:#e2421f;","classDef success-locked fill:#7da82a,stroke:#eca610;","linkStyle default stroke-width:5"],this.worldMap=!1;const n=s.E.editionData.find(_=>this.edition&&_.edition==this.edition);n&&(n.worldMap||n.extendWorldMap)&&(this.worldMap=!0);const o=s.E.scenarioManager.scenarioData(this.edition,!this.campaignMode).filter(_=>_.group==this.group).sort(s.E.scenarioManager.sortScenarios).sort((_,y)=>_.flowChartGroup==y.flowChartGroup?0:!_.flowChartGroup&&y.flowChartGroup?-1:_.flowChartGroup&&!y.flowChartGroup?1:_.flowChartGroup&&y.flowChartGroup?_.flowChartGroup<y.flowChartGroup?-1:1:0);o.forEach(_=>{let y=":::unplayed";const B=this.campaignMode&&s.E.scenarioManager.isSuccess(_);if(B&&(y=":::success"),this.campaignMode&&s.E.scenarioManager.isBlocked(_)?y=B?":::success-blocked":":::blocked":this.campaignMode&&s.E.scenarioManager.isLocked(_)&&(y=B?":::success-locked":":::locked"),_.flowChartGroup&&_.flowChartGroup!=a||!_.flowChartGroup&&_.group&&_.group!=a)if(a&&this.flow.push("end"),_.flowChartGroup)if(o.find(Z=>Z!=_&&Z.flowChartGroup==_.flowChartGroup)){const Z=""+m.f.getLabel("data.custom."+this.edition+".flowChartGroup."+_.flowChartGroup);this.flow.push("subgraph "+Z),a=_.flowChartGroup}else a=void 0;else o.find(Z=>Z!=_&&!Z.flowChartGroup&&Z.group==_.group)?(this.flow.push('subgraph "'+m.f.getLabel("data.scenario.group."+_.group)+'"'),a=_.group):a=void 0;const nt=_.index.match(/\d+/g)?("000"+_.index).slice(-3):_.index;this.flow.push("\t"+_.index+"(("+nt+"))"+y)}),a&&this.flow.push("end");let g=[];o.forEach(_=>{const y=this.campaignMode&&s.E.scenarioManager.isSuccess(_),B=!this.campaignMode||y;let nt=[],Z=[];B&&(_.unlocks&&_.unlocks.forEach(W=>{let et=" --\x3e ";const it=s.E.scenarioManager.getScenario(W,_.edition,_.group);it&&(s.E.scenarioManager.isBlocked(it)?(et=" --x ",this.flow.push("\t"+_.index+et+it.index)):s.E.scenarioManager.isLocked(it)?(et=" --o ",this.flow.push("\t"+_.index+et+it.index)):g.find(st=>st.a==_.index&&st.b==it.index)||(g.push({a:_.index,b:it.index}),this.flow.push("\t"+_.index+et+it.index)))}),_.links&&_.links.forEach(W=>{let et=" .->|\u{1f517}| ";const it=s.E.scenarioManager.getScenario(W,_.edition,_.group);it&&-1==nt.indexOf(W)&&o.find(st=>st.edition==it.edition&&st.group==it.group&&st.index==it.index)&&(s.E.scenarioManager.isBlocked(it)?et=" .-x|\u{1f517}| ":s.E.scenarioManager.isLocked(it)&&(et=" .-o|\u{1f517}| "),this.flow.push("\t"+_.index+et+W),nt.push(W))}),_.forcedLinks&&_.forcedLinks.forEach(W=>{let et=" .->|\u2757\u{1f517}| ";const it=s.E.scenarioManager.getScenario(W,_.edition,_.group);it&&-1==Z.indexOf(W)&&(s.E.scenarioManager.isBlocked(it)?et=" .-x|\u2757\u{1f517}| ":s.E.scenarioManager.isLocked(it)&&(et=" .-o|\u2757\u{1f517}| "),this.flow.push("\t"+_.index+et+W),Z.push(W))})),B&&s.E.scenarioManager.getSections(_).filter(W=>W.unlocks&&W.unlocks.length).forEach(W=>{const et=this.campaignMode&&null!=s.E.game.party.conclusions.find(st=>st.edition==W.edition&&st.group==W.group&&st.index==W.index);(!this.campaignMode||et)&&W.unlocks&&(W.unlocks.forEach(st=>{const pt=s.E.scenarioManager.getScenario(st,_.edition,_.group);pt&&(g.find(te=>te.a==_.index&&te.b==pt.index)||(g.push({a:_.index,b:pt.index}),this.flow.push("\t"+_.index+" --\x3e "+pt.index)))}),W.links&&W.links.forEach(st=>{let Et=" .->|\u{1f517}| ";const pt=s.E.scenarioManager.getScenario(st,_.edition,_.group);pt&&-1==nt.indexOf(st)&&(s.E.scenarioManager.isBlocked(pt)?Et=" .-x|\u{1f517}| ":s.E.scenarioManager.isLocked(pt)&&(Et=" .-o|\u{1f517}| "),this.flow.push("\t"+_.index+Et+st),nt.push(st))}),W.forcedLinks&&W.forcedLinks.forEach(st=>{let Et=" .->|\u2757\u{1f517}| ";const pt=s.E.scenarioManager.getScenario(st,_.edition,_.group);pt&&-1==Z.indexOf(st)&&(s.E.scenarioManager.isBlocked(pt)?Et=" .-x|\u2757\u{1f517}| ":s.E.scenarioManager.isLocked(pt)&&(Et=" .-o|\u2757\u{1f517}| "),this.flow.push("\t"+_.index+Et+st),Z.push(st))}))})}),this.flowString=this.flow.join("\n")}updateMap(){this.update(),this.chart&&this.chart.remove(),this.ngAfterViewInit()}ngAfterViewInit(){var e=this;return(0,X.A)(function*(){if(!e.mermaid){const ke=yield Promise.all([M.e(911),M.e(879)]).then(M.bind(M,3939));e.mermaid=ke.default}const{svg:a,bindFunctions:n}=yield e.mermaid.render("graphDiv",e.flowString);var g=(new DOMParser).parseFromString(a,"image/svg+xml").lastChild;let _=g.getElementsByClassName("clusters").length?g.getElementsByClassName("clusters")[0].getElementsByTagName("rect"):[];for(let ke=0;ke<_.length;ke++){const de=_[ke];de&&(de.setAttribute("rx","20"),de.setAttribute("ry","20"))}const B=(g.getAttribute("viewBox")||"0 0 600 600").split(/\s+|,/),nt=+B[2],Z=+B[3],W=Math.max(nt,600),et=Math.max(Z,600),it=W>nt?(W-nt)/2:0,st=et>Z?et-Z:0;e.chart=sn().map("chart",{crs:sn().CRS.Simple,maxBounds:[[-.5*et,-.5*W],[1.5*et,1.5*W]],minZoom:-4,zoomDelta:.25,zoomSnap:.25,wheelPxPerZoomLevel:240,attributionControl:!1}),e.chart.fitBounds([[0,0],[1.5*et,1.5*W]]),e.chart.zoomIn();const pt=sn().svgOverlay(g,[[Z+st,it],[st,nt+it]],{interactive:!0});g.addEventListener("pointerdown",ke=>{let de=ke.target;if("P"==de.tagName.toUpperCase()&&de.parentElement&&(de=de.parentElement),de&&de.classList.contains("nodeLabel")){let Ie=de.parentElement;for(;Ie&&!Ie.classList.contains("node");)Ie=Ie.parentElement;if(Ie&&"id"in Ie){const xc=Ie.id.split("-").length>1?Ie.id.split("-")[1]:"";if(xc){const Ec=s.E.scenarioData(e.edition).find(zi=>Ie&&zi.group==e.group&&zi.index==xc);Ec&&e.dialog.open(Mr,{panelClass:["dialog"],data:Ec,positionStrategy:e.overlay.position().flexibleConnectedTo(de).withPositions((0,V.yE)())}).closed.subscribe({next:zi=>{zi&&e.dialogRef.close()}})}}}}),pt.addTo(e.chart);const te=e.chart.getContainer();n&&n(te)})()}keyboardShortcuts(e){m.f.settings.keyboardShortcuts&&!this.campaignSheet&&(e.ctrlKey||e.shiftKey||"p"!==e.key.toLowerCase()||!m.f.settings.partySheet?!e.ctrlKey&&!e.shiftKey&&"g"===e.key.toLowerCase()&&this.worldMap&&(this.openWorldMap(),e.stopPropagation(),e.preventDefault()):(this.openCampaignSheet(),e.stopPropagation(),e.preventDefault()))}toggleCampaignMode(e,a=!1){(!this.campaignMode||a)&&(this.campaignMode=!this.campaignMode,this.updateMap()),e.preventDefault(),e.stopPropagation()}openWorldMap(){this.worldMap&&(this.dialogRef.close(),setTimeout(()=>{this.dialog.open(Zn,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:this.edition})},1))}openCampaignSheet(){this.campaignSheet||(this.campaignSheet=!0,this.dialog.open(Ue,{panelClass:["dialog-invert"],data:{disableShortcuts:!0}}).closed.subscribe({next:()=>this.campaignSheet=!1}))}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG),t.rXU(zt.hJ))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-scenario-chart"]],hostBindings:function(a,n){1&a&&t.bIt("keydown",function(g){return n.keyboardShortcuts(g)},t.EBC)},standalone:!1,decls:13,vars:8,consts:[["chart",""],[1,"scenario-chart-container"],["id","chart",1,"scenario-chart"],[1,"menu"],[3,"ghs-tooltip","originY","overlayY"],["ghs-pointer-input","",1,"checkbox-container",3,"ghs-tooltip","originY","overlayY"],[1,"menu","right"],[1,"legend",3,"click","ngClass"],[3,"ghs-label"],["src","./assets/images/select-arrow.svg",1,"ghs-svg"],[3,"click","ghs-tooltip","originY","overlayY"],["src","./assets/images/map.svg"],["src","./assets/images/sheet.svg"],["ghs-pointer-input","",1,"checkbox-container",3,"singleClick","doubleClick","ghs-tooltip","originY","overlayY"],["type","checkbox",3,"checked"],[1,"symbol","unplayed"],[1,"symbol","success"],[1,"symbol","locked"],[1,"symbol","blocked"],[1,"symbol","success-locked"],[1,"symbol","success-blocked"],[1,"symbol","not-campaign"],[1,"symbol","not-unlocked"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",1),t.nrm(1,"div",2,0),t.j41(3,"div",3),t.nVh(4,b6,2,3,"a",4),t.nVh(5,k6,2,3,"a",4),t.nVh(6,y6,3,5,"div",5),t.k0s(),t.j41(7,"div",6)(8,"div",7),t.bIt("click",function(){return t.eBV(o),t.Njj(n.legend=!n.legend)}),t.j41(9,"a"),t.nrm(10,"span",8)(11,"img",9),t.k0s(),t.nVh(12,x6,33,32,"ul"),t.k0s()()()}2&a&&(t.R7$(4),t.vxM(n.worldMap?4:-1),t.R7$(),t.vxM(n.gameManager.bbRules()?-1:5),t.R7$(),t.vxM(n.gameManager.game.party.campaignMode?6:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(6,P6,n.legend)),t.R7$(2),t.Y8G("ghs-label","scenario.chart.legend"),t.R7$(2),t.vxM(n.legend?12:-1))},dependencies:[N.YU,tt,ft,rt],styles:['.scenario-chart-container{position:absolute;top:0;left:0;width:100vw;height:100vh}.scenario-chart-container .scenario-chart{position:relative;width:100%;height:100%;max-width:100%;max-height:100%;overflow:auto;background:none;line-height:initial!important;z-index:1}.scenario-chart-container .scenario-chart svg{cursor:grab}.scenario-chart-container .scenario-chart svg .node{cursor:pointer}.scenario-chart-container .scenario-chart svg .node:hover{opacity:.7}.scenario-chart-container .scenario-chart svg .node.success,.scenario-chart-container .scenario-chart svg .node.locked:not(.blocked),.scenario-chart-container .scenario-chart svg .node.blocked{cursor:initial}.scenario-chart-container .scenario-chart svg .node.locked:before{content:"!";position:absolute;top:-1em;left:-1em;color:var(--ghs-color-yellow)}.scenario-chart-container .scenario-chart svg .node.blocked:before{content:"x";position:absolute;top:-1em;left:-1em;color:var(--ghs-color-red)}.scenario-chart-container .scenario-chart svg .labelBkg{background:none!important}.scenario-chart-container .scenario-chart svg .edge-pattern-dotted{stroke-width:3!important;stroke-dasharray:5!important}.scenario-chart-container .menu{position:absolute;left:0;bottom:0;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);display:flex;align-items:center;background-color:var(--ghs-color-darkgray);border-top-right-radius:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));z-index:2}.scenario-chart-container .menu a,.scenario-chart-container .menu .checkbox-container{cursor:pointer;display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.scenario-chart-container .menu a img,.scenario-chart-container .menu .checkbox-container img{filter:var(--ghs-filter-gray);height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));width:auto}.scenario-chart-container .menu a:hover,.scenario-chart-container .menu .checkbox-container:hover{color:var(--ghs-color-white)}.scenario-chart-container .menu a:hover img,.scenario-chart-container .menu .checkbox-container:hover img{filter:var(--ghs-filter-white)}.scenario-chart-container .menu .legend{display:flex;flex-direction:column;justify-content:center;align-items:flex-start;cursor:zoom-in}.scenario-chart-container .menu .legend.open{cursor:zoom-out}.scenario-chart-container .menu .legend.open a img{transform:rotate(180deg)}.scenario-chart-container .menu .legend ul{margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));padding:0}@media (max-width: 600px),(orientation: portrait){.scenario-chart-container .menu .legend ul{margin-bottom:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor))}}.scenario-chart-container .menu .legend ul li{display:flex;justify-content:flex-start;align-items:center;margin-bottom:.2em}.scenario-chart-container .menu .legend ul li .symbol{display:inline-flex;justify-content:center;align-items:center;width:2.3em;height:2.3em;border:.2em solid var(--ghs-color-gray);border-radius:100%;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray);margin-right:1em;font-family:var(--ghs-font-gh-title);font-size:.6em}.scenario-chart-container .menu .legend ul li .symbol.unplayed{border-color:var(--ghs-color-blue)}.scenario-chart-container .menu .legend ul li .symbol.success{border-color:var(--ghs-color-green)}.scenario-chart-container .menu .legend ul li .symbol.locked{border-color:var(--ghs-color-yellow)}.scenario-chart-container .menu .legend ul li .symbol.blocked{border-color:var(--ghs-color-red)}.scenario-chart-container .menu .legend ul li .symbol.success-locked{border-color:var(--ghs-color-yellow);background-color:var(--ghs-color-green)}.scenario-chart-container .menu .legend ul li .symbol.success-blocked{border-color:var(--ghs-color-red);background-color:var(--ghs-color-green)}.scenario-chart-container .menu .legend ul li .symbol.not-unlocked{border-radius:0}.scenario-chart-container .menu.right{left:initial;right:0;border-top-right-radius:initial;border-top-left-radius:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));z-index:1}\n'],encapsulation:2})}return i})();const vr=i=>[i],E6=i=>({finish:i});function w6(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",12),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.openConclusions(n))}),t.nrm(1,"img",13)(2,"span",14),t.k0s()}2&i&&(t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.weekSections.openConclusion"))}function R6(i,r){if(1&i&&(t.j41(0,"span",6),t.nrm(1,"img",10),t.EFF(2),t.nVh(3,w6,3,1,"a",11),t.k0s()),2&i){const e=r.$implicit,a=t.XpG();t.R7$(),t.Y8G("src","./assets/images/"+(a.isSolved(e)?"scenario/conclusion.svg":"fh/party/section.svg"),t.B4B),t.R7$(),t.SpI(" ",e," "),t.R7$(),t.vxM(a.hasConclusions(e)?3:-1)}}function j6(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",12),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.openConclusions(n))}),t.nrm(1,"img",13)(2,"span",14),t.k0s()}2&i&&(t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.weekSections.openConclusion"))}function G6(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",6)(1,"span",15),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.finishConclusion(n))}),t.nrm(2,"img",10),t.EFF(3),t.k0s(),t.nVh(4,j6,3,1,"a",11),t.nrm(5,"span",16),t.j41(6,"img",17),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.removeSection(n))}),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(4,E6,a.isConclusion(e))),t.R7$(),t.Y8G("src","./assets/images/"+(a.isSolved(e)?"scenario/conclusion.svg":"fh/party/section.svg"),t.B4B),t.R7$(),t.SpI(" ",e," "),t.R7$(),t.vxM(a.hasConclusions(e)?4:-1)}}let T6=(()=>{class i{week;dialog;gameManager=s.E;constructor(e,a){this.week=e,this.dialog=a}sectionsFixed(){const e=s.E.campaignData();return e.weeks&&e.weeks[this.week]&&e.weeks[this.week]||[]}sections(){return s.E.game.party.weekSections[this.week]||[]}isConclusion(e){return null!=s.E.sectionData(s.E.currentEdition()).find(a=>a.index==e&&!a.group&&a.conclusion)}isSolved(e){return null!=s.E.game.party.conclusions.find(a=>a.edition==s.E.game.edition&&a.index==e)}hasConclusions(e){const a=s.E.sectionData(s.E.game.edition).filter(n=>n.conclusion&&!n.parent&&n.parentSections&&1==n.parentSections.length&&n.parentSections.find(o=>1==o.length&&-1!=o.indexOf(e)));return a.length>0&&a.every(n=>!s.E.game.party.conclusions.find(o=>o.edition==n.edition&&o.index==n.index&&o.group==n.group))}finishConclusion(e){const a=s.E.sectionData(s.E.currentEdition()).find(n=>n.index==e&&n.conclusion);if(a){const n=new ht.Nz(a),o=this.isSolved(e);this.dialog.open(Yt,{panelClass:["dialog"],data:{scenario:n,conclusionOnly:!0,rewardsOnly:o,success:o}})}}openConclusions(e){let a=s.E.sectionData(s.E.game.edition).filter(n=>n.conclusion&&!n.parent&&n.parentSections&&1==n.parentSections.length&&n.parentSections.find(o=>1==o.length&&-1!=o.indexOf(e))&&0==s.E.scenarioManager.getRequirements(n).length).map(n=>(n.name="",n));a.length>0&&this.dialog.open(Se,{panelClass:["dialog"],data:{conclusions:a,parent:s.E.sectionData(s.E.game.edition).find(n=>n.index==e&&!n.group)}}).closed.subscribe({next:n=>{if(n){const o=new ht.Nz(n);s.E.stateManager.before("finishConclusion",...s.E.scenarioManager.scenarioUndoArgs(o)),s.E.scenarioManager.finishScenario(o,!0,void 0,!1,!1,!1,s.E.game.party.campaignMode,!0),o.repeatable||(s.E.game.party.weekSections[this.week]=[...s.E.game.party.weekSections[this.week]||[],o.index]),s.E.stateManager.after(),this.dialog.open(Yt,{panelClass:["dialog"],data:{scenario:o,conclusionOnly:!0}})}}})}addSection(e){e.classList.add("error"),(!s.E.game.party.weekSections[this.week]||-1==s.E.game.party.weekSections[this.week]?.indexOf(e.value))&&(s.E.stateManager.before("addPartyWeekSection",s.E.game.party.name,this.week,e.value),s.E.game.party.weekSections[this.week]=[...s.E.game.party.weekSections[this.week]||[],e.value],e.classList.remove("error"),e.value="",s.E.stateManager.after())}removeSection(e){s.E.game.party.weekSections[this.week]&&-1!=s.E.game.party.weekSections[this.week]?.indexOf(e)&&(s.E.stateManager.before("removePartyWeekSection",s.E.game.party.name,this.week,e),s.E.game.party.weekSections[this.week]?.splice(s.E.game.party.weekSections[this.week]?.indexOf(e)||-1,1),0==s.E.game.party.weekSections[this.week]?.length&&delete s.E.game.party.weekSections[this.week],this.isSolved(e)&&(s.E.game.party.conclusions=s.E.game.party.conclusions.filter(a=>a.edition!=s.E.game.edition||a.index!=e)),s.E.stateManager.after())}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-party-week-dialog"]],standalone:!1,decls:14,vars:12,consts:[["scenario",""],[1,"week-dialog"],[1,"title"],[3,"ghs-label","ghs-label-args"],[1,"sub-title"],[1,"sections"],[1,"section"],[1,"add-section"],[3,"keyup","keyup.enter","ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg",1,"button",3,"click","ghs-label","ghs-label-attribute"],[3,"src"],[1,"conclusion"],[1,"conclusion",3,"click"],["src","./assets/images/hint.svg"],[3,"ghs-label"],[1,"index",3,"click","ngClass"],[1,"spacer"],["src","./assets/images/close.svg",1,"button",3,"click"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",1)(1,"div",2),t.nrm(2,"span",3),t.j41(3,"span",4),t.nrm(4,"span",3),t.k0s()(),t.j41(5,"div",5),t.Z7z(6,R6,4,3,"span",6,t.fX1),t.Z7z(8,G6,7,6,"span",6,t.fX1),t.k0s(),t.j41(10,"div",7)(11,"input",8,0),t.bIt("keyup",function(){t.eBV(o);const _=t.sdS(12);return _.classList.remove("error"),t.Njj(_.classList.remove("error"))})("keyup.enter",function(){t.eBV(o);const _=t.sdS(12);return t.Njj(n.addSection(_))}),t.k0s(),t.j41(13,"img",9),t.bIt("click",function(){t.eBV(o);const _=t.sdS(12);return t.Njj(n.addSection(_))}),t.k0s()()()}2&a&&(t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.weekSections")("ghs-label-args",t.eq3(8,vr,n.week+"")),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.weekSections.calc")("ghs-label-args",t.eq3(10,vr,n.week-n.gameManager.game.party.weeks+"")),t.R7$(2),t.Dyx(n.sectionsFixed()),t.R7$(2),t.Dyx(n.sections()),t.R7$(3),t.Y8G("ghs-label","party.campaign.sheet.weekSections.section")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.weekSections.addSection")("ghs-label-attribute","title"))},dependencies:[N.YU,tt],styles:[".week-dialog[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.week-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.week-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .sub-title[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.week-dialog[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));width:auto;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.week-dialog[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{cursor:pointer}.week-dialog[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{opacity:.8}.week-dialog[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]{display:flex;flex-direction:column}.week-dialog[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%], .week-dialog[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{display:flex;align-items:center}.week-dialog[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{filter:var(--ghs-filter-red)}.week-dialog[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .finish[_ngcontent-%COMP%]{cursor:pointer}.week-dialog[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .conclusion[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;color:var(--ghs-color-black)}.week-dialog[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .conclusion[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto;margin-right:.3em}.week-dialog[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .conclusion[_ngcontent-%COMP%]:hover{opacity:.7}.week-dialog[_ngcontent-%COMP%]   .add-section[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.week-dialog[_ngcontent-%COMP%]   .add-section[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .05 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray);outline:none}"]})}return i})(),Or=(()=>{class i{party;gameManager=s.E;settingsManager=m.f;buildings=[];ngOnInit(){this.updateBuildings(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.party=s.E.game.party,this.updateBuildings()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}updateBuildings(){this.buildings=[];const e=s.E.campaignData();e.buildings.filter(a=>s.E.buildingsManager.initialBuilding(a)).forEach(a=>{this.party.buildings.find(n=>a.name==n.name)||(this.party.buildings.push(new Ge.k(a.name,1)),a.rewards[0]&&s.E.buildingsManager.applyRewards(a.rewards[0]))}),e.buildings.filter(a=>a.prosperityUnlock&&a.costs.prosperity<=s.E.prosperityLevel()).forEach(a=>{this.party.buildings.find(n=>a.name==n.name)||(!a.requires||this.party.buildings.find(n=>n.name==a.requires&&n.level))&&this.party.buildings.push(new Ge.k(a.name,0))}),this.party.buildings.forEach(a=>{const n=e.buildings.find(o=>o.name==a.name);n&&this.buildings.push({model:a,data:n})}),this.buildings.sort((a,n)=>a.model.level&&!n.model.level?-1:!a.model.level&&n.model.level?1:a.data.id&&n.data.id?a.data.id<n.data.id?-1:1:a.data.id?-1:n.data.id?1:a.model.level==n.model.level?a.data.name<n.data.name?-1:1:n.model.level-a.model.level)}unlockBuilding(e){const a=e.value;this.party.buildings=this.party.buildings||[];const n=s.E.campaignData();if(n.buildings&&a){const o=n.buildings.find(g=>g.name==a.toLowerCase().replaceAll(" ","-")||g.id==a||!isNaN(+g.id)&&!isNaN(+a)&&+g.id==+a);o&&!this.party.buildings.find(g=>g.name==o.name)&&(s.E.stateManager.before("addBuilding",o.id,o.name),this.party.buildings.push(new Ge.k(o.name,0)),this.updateBuildings(),e.value="",s.E.stateManager.after())}}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-party-buildings"]],inputs:{party:"party"},standalone:!1,decls:9,vars:4,consts:[["building",""],[1,"buildings-container"],[1,"header",3,"submit"],["src","./assets/images/fh/buildings/build.svg"],[3,"ghs-label"],["type","text",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg",3,"click"],[3,"change","buildings"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",1)(1,"form",2),t.bIt("submit",function(){t.eBV(o);const _=t.sdS(6);return t.Njj(n.unlockBuilding(_))}),t.j41(2,"label"),t.nrm(3,"img",3)(4,"span",4),t.k0s(),t.nrm(5,"input",5,0),t.j41(7,"img",6),t.bIt("click",function(){t.eBV(o);const _=t.sdS(6);return t.Njj(n.unlockBuilding(_))}),t.k0s()(),t.j41(8,"ghs-buildings-list",7),t.bIt("change",function(){return t.eBV(o),t.Njj(n.updateBuildings())}),t.k0s()()}2&a&&(t.R7$(4),t.Y8G("ghs-label","party.campaign.sheet.buildings"),t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.buildings.unlock")("ghs-label-attribute","placeholder"),t.R7$(3),t.Y8G("buildings",n.buildings))},styles:[".buildings-container[_ngcontent-%COMP%]{flex-direction:column;display:flex}.buildings-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex}.buildings-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor))}.buildings-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:.8em;width:auto;margin:0 calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.buildings-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{cursor:pointer;height:1.2em;width:auto}.buildings-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:0;min-width:initial;max-width:initial;margin:0;color:var(--ghs-color-black);background-color:var(--form-background);border:none;border-bottom-width:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor));border-bottom-style:solid;border-bottom-color:var(--ghs-color-gray);user-select:auto;-webkit-user-select:auto;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));flex-grow:1;margin-left:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor))}"]})}return i})();const S6=["itemIndex"],$6=["treasureIndex"],ti=i=>({denied:i}),D6=(i,r,e)=>({"fh-container":i,"gh2e-container":r,"campaign-container":e}),Pr=i=>({"fh-sheet":i}),Xt=()=>[],Qt=i=>({checked:i}),br=i=>({active:i}),Pe=i=>({highlight:i}),I6=i=>({permissive:i}),A6=(i,r,e)=>({checked:i,section:r,locked:e}),Ii=i=>({disabled:i}),kr=i=>({conclusion:i}),V6=(i,r)=>({checked:i,disabled:r}),F6=(i,r)=>({collapsed:i,full:r}),X6=(i,r)=>[i,r],B6=(i,r,e,a)=>[i,r,e,a],yr=(i,r)=>({section:i,"prosperity-tick":r}),Y6=(i,r,e)=>({large:i,section:r,break:e}),xr=(i,r)=>({checked:i,highlight:r}),N6=i=>[i],z6=(i,r)=>({blocked:i,locked:r}),L6=(i,r)=>({fh:i,wrapped:r}),U6=(i,r)=>({large:i,section:r}),q6=(i,r)=>({checked:i,prosperity:r}),Er=i=>({edition:i}),H6=(i,r)=>r.edition+"-"+r.name,K6=(i,r)=>r&&r.edition+"-"+r.id,W6=(i,r)=>r.edition+"-"+r.index+(r.group?"-"+r.group:"");function J6(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.name)}}function Z6(i,r){if(1&i&&(t.j41(0,"span"),t.nrm(1,"span",21),t.EFF(2),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.Y8G("ghs-label","party.campaign"),t.R7$(),t.SpI("\xa0",e.id)}}function Q6(i,r){if(1&i&&(t.j41(0,"option",52),t.nVh(1,J6,2,1,"span"),t.nVh(2,Z6,3,2,"span"),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(3);t.Y8G("value",t.mNQ(e.id))("selected",e.id==a.party.id)("disabled",e.id==a.party.id),t.R7$(),t.vxM(e.name?1:-1),t.R7$(),t.vxM(e.name?-1:2)}}function tI(i,r){if(1&i){const e=t.RV6();t.j41(0,"select",51),t.bIt("change",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.selectParty(n))}),t.Z7z(1,Q6,3,6,"option",52,t.fX1),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ghs-label","party.change")("ghs-label-attribute","title"),t.R7$(),t.Dyx(e.gameManager.game.parties)}}function eI(i,r){if(1&i){const e=t.RV6();t.j41(0,"img",55),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openMap())}),t.k0s()}2&i&&t.Y8G("ghs-tooltip","party.campaign.map")}function nI(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",25)(1,"img",53),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openFlowChart())}),t.k0s(),t.nVh(2,eI,1,1,"img",54),t.k0s()}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-tooltip","scenario.chart"),t.R7$(),t.vxM(e.worldMap?2:-1)}}function iI(i,r){if(1&i){const e=t.RV6();t.j41(0,"img",58),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.removeParty())}),t.k0s()}2&i&&t.Y8G("ghs-label","party.remove")("ghs-label-attribute","title")}function aI(i,r){if(1&i){const e=t.RV6();t.nVh(0,iI,1,2,"img",56),t.nrm(1,"span",24),t.j41(2,"img",57),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.newParty())}),t.k0s()}if(2&i){const e=t.XpG(2);t.vxM(e.gameManager.game.parties.length>1?0:-1),t.R7$(2),t.Y8G("ghs-label","party.new")("ghs-label-attribute","title")}}function oI(i,r){1&i&&(t.j41(0,"div",28),t.nrm(1,"img",59),t.j41(2,"span",60)(3,"span",61),t.nrm(4,"span",21),t.k0s()()()),2&i&&(t.R7$(4),t.Y8G("ghs-label","party.new.hint"))}function sI(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.SpI(" ",e.split(":")[1],"x\xa0 ")}}function rI(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",34),t.nVh(1,sI,2,1,"span"),t.nrm(2,"span",21)(3,"span",24),t.j41(4,"span",62),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.removeAchievement(n))}),t.nrm(5,"img",63),t.k0s()()}if(2&i){const e=r.$implicit;t.R7$(),t.vxM(e.split(":").length>0&&"1"!=e.split(":")[1]?1:-1),t.R7$(),t.Y8G("ghs-label","data.partyAchievements."+e.split(":")[0])}}function cI(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",64),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.setReputation(40-n-20))}),t.k0s(),t.j41(1,"span",65),t.EFF(2),t.nI1(3,"ghsValueSign"),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ngClass",t.eq3(4,Qt,a.party.reputation==40-e-20)),t.R7$(2),t.JRh(t.bMT(3,2,40-e-20))}}function lI(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsValueSign"),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.JRh(t.bMT(2,1,-5+e))}}function gI(i,r){1&i&&(t.j41(0,"span"),t.nrm(1,"span",21),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","party.shop.none"))}function dI(i,r){if(1&i&&(t.j41(0,"div",44),t.nVh(1,lI,3,3,"span"),t.nVh(2,gI,2,1,"span"),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ngClass",t.eq3(3,br,a.priceModifier==-5+e)),t.R7$(),t.vxM(5!=e?1:-1),t.R7$(),t.vxM(5==e?2:-1)}}function hI(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",11)(1,"div",16)(2,"div",17)(3,"div",18)(4,"span",19),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.campaign=!0)}),t.nrm(5,"img",20)(6,"span",21),t.k0s(),t.j41(7,"label",22),t.nrm(8,"span",21),t.k0s(),t.nVh(9,tI,3,2,"select",23),t.nrm(10,"span",24),t.nVh(11,nI,3,2,"span",25),t.k0s(),t.j41(12,"div",26)(13,"label"),t.nrm(14,"span",21),t.EFF(15,":"),t.k0s(),t.j41(16,"input",27),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setName(n))}),t.k0s(),t.nVh(17,aI,3,3),t.nVh(18,oI,5,1,"div",28),t.k0s(),t.j41(19,"div",29)(20,"label"),t.nrm(21,"span",21),t.EFF(22,":"),t.k0s(),t.j41(23,"input",27),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setLocation(n))}),t.k0s()(),t.j41(24,"div",30)(25,"label"),t.nrm(26,"span",21),t.EFF(27,":"),t.k0s(),t.j41(28,"textarea",27),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setNotes(n))}),t.k0s()(),t.j41(29,"div",31)(30,"label"),t.nrm(31,"span",21),t.EFF(32,":"),t.k0s(),t.j41(33,"div",32)(34,"div",33),t.Z7z(35,rI,6,2,"div",34,t.fX1),t.k0s(),t.j41(37,"div",35)(38,"input",36,0),t.bIt("keyup.enter",function(){t.eBV(e);const n=t.sdS(39),o=t.XpG();return t.Njj(o.addAchievement(n))}),t.k0s(),t.j41(40,"a",37),t.bIt("click",function(){t.eBV(e);const n=t.sdS(39),o=t.XpG();return t.Njj(o.addAchievement(n))}),t.nrm(41,"img",38),t.k0s()()()()(),t.j41(42,"div",39)(43,"div",16)(44,"div",40)(45,"label"),t.nrm(46,"span",21),t.k0s(),t.j41(47,"div",41),t.Z7z(48,cI,4,6,null,null,t.fX1),t.nI1(50,"ghsRange"),t.k0s()(),t.j41(51,"div",42)(52,"label"),t.nrm(53,"span",21),t.k0s(),t.j41(54,"div",43),t.Z7z(55,dI,3,5,"div",44,t.fX1),t.nI1(57,"ghsRange"),t.k0s()()(),t.j41(58,"div",45)(59,"label",46),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.exportParty())}),t.nrm(60,"img",47),t.j41(61,"span"),t.nrm(62,"span",21),t.k0s()(),t.j41(63,"label",48),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.ghsInputFullScreenCheck())}),t.j41(64,"input",49),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.importParty(n))}),t.k0s(),t.nrm(65,"img",50),t.j41(66,"span"),t.nrm(67,"span",21),t.k0s()()()()()()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(41,Pr,e.fhSheet)),t.R7$(6),t.Y8G("ghs-label","party.campaign"),t.R7$(2),t.Y8G("ghs-label","party.sheet"),t.R7$(),t.vxM(e.gameManager.game.parties.length>1&&!e.gameManager.game.scenario?9:-1),t.R7$(2),t.vxM(e.disableShortcuts?-1:11),t.R7$(3),t.Y8G("ghs-label","party.name"),t.R7$(2),t.Y8G("value",e.party.name)("ghs-label","party.name")("ghs-label-attribute","placeholder"),t.R7$(),t.vxM(e.gameManager.game.scenario?-1:17),t.R7$(),t.vxM(e.gameManager.game.scenario?18:-1),t.R7$(3),t.Y8G("ghs-label","party.location"),t.R7$(2),t.Y8G("value",e.party.location)("ghs-label","party.location")("ghs-label-attribute","placeholder"),t.R7$(3),t.Y8G("ghs-label","party.notes"),t.R7$(2),t.Y8G("value",e.party.notes)("ghs-label","party.notes")("ghs-label-attribute","placeholder"),t.R7$(3),t.Y8G("ghs-label","party.achievements"),t.R7$(4),t.Dyx(e.partyAchievementsList),t.R7$(3),t.Y8G("autocomplete",e.partyAchievements)("spoiler",!0)("emptyLabel","party.addPartyAchievement.empty")("ghs-label","party.addPartyAchievement")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","party.addPartyAchievement")("ghs-label-attribute","title"),t.R7$(6),t.Y8G("ghs-label","party.reputation"),t.R7$(2),t.Dyx(t.i5U(50,35,t.lJ4(43,Xt),41)),t.R7$(5),t.Y8G("ghs-label","party.shop"),t.R7$(2),t.Dyx(t.i5U(57,38,t.lJ4(44,Xt),11)),t.R7$(4),t.Y8G("ghs-label","party.export")("ghs-label-attribute","title"),t.R7$(3),t.Y8G("ghs-label","party.export"),t.R7$(),t.Y8G("ghs-label","party.import")("ghs-label-attribute","title"),t.R7$(4),t.Y8G("ghs-label","party.import")}}function _I(i,r){if(1&i){const e=t.RV6();t.j41(0,"img",55),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openMap())}),t.k0s()}2&i&&t.Y8G("ghs-tooltip","party.campaign.map")}function mI(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",25)(1,"img",53),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openFlowChart())}),t.k0s(),t.nVh(2,_I,1,1,"img",54),t.k0s()}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-tooltip","scenario.chart"),t.R7$(),t.vxM(e.worldMap?2:-1)}}function pI(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",131),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.setWeek(n.party.weeks+1))}),t.nrm(1,"span",21)(2,"img",132),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.nextWeek"))}function uI(i,r){if(1&i&&(t.j41(0,"div",134),t.nrm(1,"img",75),t.EFF(2),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(3);t.R7$(),t.Y8G("src","./assets/images/"+(a.hasConclusions(e)?"hint.svg":a.isConclusion(e)?"scenario/conclusion.svg":"fh/party/section.svg"),t.B4B),t.R7$(),t.SpI(" ",e," ")}}function fI(i,r){if(1&i&&(t.j41(0,"div",135),t.nrm(1,"img",75),t.EFF(2),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(3);t.R7$(),t.Y8G("src","./assets/images/"+(a.hasConclusions(e)?"hint.svg":a.isConclusion(e)?"scenario/conclusion.svg":"fh/party/section.svg"),t.B4B),t.R7$(),t.SpI(" ",e," ")}}function CI(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",133),t.bIt("singleClick",function(){const n=t.eBV(e).$index,o=t.XpG(2);return t.Njj(o.setWeek(n+1+80*o.calendarSheet))})("doubleClick",function(){const n=t.eBV(e).$index,o=t.XpG(2);return t.Njj(o.setWeekSection(n+1+80*o.calendarSheet))}),t.Z7z(1,uI,3,2,"div",134,t.fX1),t.Z7z(3,fI,3,2,"div",135,t.fX1),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.Y8G("ghs-tooltip","party.campaign.sheet.weekSections.hint")("ngClass",t.sMw(2,A6,n.party.weeks>a+80*n.calendarSheet,n.sectionsForWeekFixed(e+80*n.calendarSheet).length>0||n.sectionsForWeek(e+80*n.calendarSheet).length>0,n.settingsManager.settings.calendarLocked&&("permissive"!=n.settingsManager.settings.calendarLocked||n.party.weeks!=a+80*n.calendarSheet&&n.party.weeks!=a+80*n.calendarSheet+1))),t.R7$(),t.Dyx(n.sectionsForWeekFixed(e+80*n.calendarSheet)),t.R7$(2),t.Dyx(n.sectionsForWeek(e+80*n.calendarSheet))}}function MI(i,r){if(1&i){const e=t.RV6();t.j41(0,"img",58),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.removeParty())}),t.k0s()}2&i&&t.Y8G("ghs-label","party.remove")("ghs-label-attribute","title")}function vI(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.name)}}function OI(i,r){if(1&i&&(t.j41(0,"span"),t.nrm(1,"span",21),t.EFF(2),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.Y8G("ghs-label","party.campaign"),t.R7$(),t.SpI("\xa0",e.id)}}function PI(i,r){if(1&i&&(t.j41(0,"option",52),t.nVh(1,vI,2,1,"span"),t.nVh(2,OI,3,2,"span"),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(4);t.Y8G("value",t.mNQ(e.id))("selected",e.id==a.party.id)("disabled",e.id==a.party.id),t.R7$(),t.vxM(e.name?1:-1),t.R7$(),t.vxM(e.name?-1:2)}}function bI(i,r){if(1&i){const e=t.RV6();t.j41(0,"select",51),t.bIt("change",function(n){t.eBV(e);const o=t.XpG(3);return t.Njj(o.selectParty(n))}),t.Z7z(1,PI,3,6,"option",52,t.fX1),t.k0s()}if(2&i){const e=t.XpG(3);t.Y8G("ghs-label","party.change")("ghs-label-attribute","title"),t.R7$(),t.Dyx(e.gameManager.game.parties)}}function kI(i,r){if(1&i){const e=t.RV6();t.nVh(0,MI,1,2,"img",56),t.nVh(1,bI,3,2,"select",23),t.j41(2,"img",57),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.newParty())}),t.k0s()}if(2&i){const e=t.XpG(2);t.vxM(e.gameManager.game.parties.length>1?0:-1),t.R7$(),t.vxM(e.gameManager.game.parties.length>1&&!e.gameManager.game.scenario?1:-1),t.R7$(),t.Y8G("ghs-label","party.new")("ghs-label-attribute","title")}}function yI(i,r){1&i&&(t.j41(0,"div",28),t.nrm(1,"img",59),t.j41(2,"span",60)(3,"span",61),t.nrm(4,"span",21),t.k0s()()()),2&i&&(t.R7$(4),t.Y8G("ghs-label","party.new.hint"))}function xI(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",139),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.moveResources(n))}),t.nrm(1,"img",75),t.k0s()}if(2&i){const e=r.$implicit;t.R7$(),t.Y8G("src",e.iconUrl,t.B4B)}}function EI(i,r){if(1&i&&(t.j41(0,"div",83)(1,"span",136),t.nrm(2,"span",21),t.EFF(3,":"),t.k0s(),t.j41(4,"div",137),t.Z7z(5,xI,2,1,"span",138,H6),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","character.progress.resources.move"),t.R7$(3),t.Dyx(e.characters)}}function wI(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",142),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG().$implicit,g=t.XpG(2);return t.Njj(g.setSoldiers(n+(o>0?2+2*o:0)+1))})("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG().$implicit,g=t.XpG(2);return t.Njj(g.setSoldiers(n+(o>0?2+2*o:0)+1,!0))}),t.nrm(1,"img",143)(2,"div",144),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG().$implicit,n=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Ii,e+(a>0?2+2*a:0)>=n.party.soldiers+(n.soldierAvailable()?1:0))),t.R7$(2),t.Y8G("ngClass",t.eq3(4,Qt,e+(a>0?2+2*a:0)<n.party.soldiers))}}function RI(i,r){if(1&i&&(t.j41(0,"div",111)(1,"label")(2,"span",61),t.nrm(3,"span",21),t.k0s(),t.j41(4,"span"),t.EFF(5),t.k0s()(),t.j41(6,"div",140),t.Z7z(7,wI,3,6,"div",141,t.fX1),t.nI1(9,"ghsRange"),t.k0s()()),2&i){const e=r.$implicit;t.R7$(3),t.Y8G("ghs-label","party.campaign.sheet.soldierLevel"),t.R7$(2),t.JRh(e+1),t.R7$(2),t.Dyx(t.i5U(9,2,t.lJ4(5,Xt),e>0?2:4))}}function jI(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",64),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.setMorale(20-n))}),t.j41(1,"span",65),t.EFF(2),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Qt,a.party.morale==20-e)),t.R7$(2),t.JRh(20-e)}}function GI(i,r){if(1&i&&(t.j41(0,"span",117),t.nrm(1,"img",145),t.EFF(2),t.k0s()),2&i){const e=r.$index,a=t.XpG(2);t.Y8G("ngClass",t.eq3(2,kr,a.isConclusion(a.gameManager.campaignData().highMorale[e]))),t.R7$(2),t.SpI(" ",a.gameManager.campaignData().highMorale[e]||""," ")}}function TI(i,r){if(1&i&&(t.j41(0,"span",117),t.nrm(1,"img",145),t.EFF(2),t.k0s()),2&i){const e=r.$index,a=t.XpG(2);t.Y8G("ngClass",t.eq3(2,kr,a.isConclusion(a.gameManager.campaignData().lowMorale[e]))),t.R7$(2),t.SpI(" ",a.gameManager.campaignData().lowMorale[e]||""," ")}}function SI(i,r){1&i&&(t.j41(0,"span",146),t.nrm(1,"img",148),t.EFF(2,":"),t.k0s())}function $I(i,r){if(1&i){const e=t.RV6();t.nVh(0,SI,3,0,"span",146),t.j41(1,"span",147),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.setTownGuardPerks(n+1))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.vxM(e%3==0?0:-1),t.R7$(),t.Y8G("ngClass",t.eq3(2,Qt,a.party.townGuardPerks>=e+1))}}function DI(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",152),t.nI1(1,"ghsFloor"),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.toggleTownGuardPerkSection(n))})("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.toggleTownGuardPerkSection(n,!0))}),t.nrm(2,"img",145),t.EFF(3),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(3);t.Y8G("ngClass",t.l_i(4,V6,-1!=a.party.townGuardPerkSections.indexOf(e),-1==a.party.townGuardPerkSections.indexOf(e)&&a.party.townGuardPerkSections.length>=t.bMT(1,2,a.party.townGuardPerks/3))),t.R7$(3),t.SpI(" ",e," ")}}function II(i,r){if(1&i&&(t.j41(0,"div",121)(1,"div",149),t.Z7z(2,DI,4,7,"div",150,t.fX1),t.k0s(),t.nrm(4,"ghs-perk-label",151),t.k0s()),2&i){const e=r.$implicit;t.R7$(2),t.Dyx(e.sections),t.R7$(2),t.Y8G("perk",e.perk)}}function AI(i,r){1&i&&(t.j41(0,"div",122),t.nrm(1,"img",153)(2,"span",21),t.k0s()),2&i&&(t.Y8G("ghs-label","game.attackModifiers.perks.warning")("ghs-label-attribute","title"),t.R7$(2),t.Y8G("ghs-label","game.attackModifiers.perks.warning"))}function VI(i,r){if(1&i&&t.nrm(0,"span",154),2&i){const e=t.XpG().$implicit;t.Y8G("ghs-label","data.campaignSticker."+e)}}function FI(i,r){if(1&i&&t.nrm(0,"img",155),2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG(2);t.Y8G("src",o.campaignStickerImage(a,n),t.B4B)("ghs-tooltip","data.campaignSticker."+a)}}function XI(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",128),t.nVh(1,VI,1,1,"span",154),t.nVh(2,FI,1,2,"img",155),t.j41(3,"img",156),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.removeCampaignSticker(n))}),t.k0s()()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.R7$(),t.vxM(n.campaignStickerImage(e,a)?-1:1),t.R7$(),t.vxM(n.campaignStickerImage(e,a)?2:-1)}}function BI(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",130)(1,"div",157)(2,"ghs-attackmodifier-deck",158),t.bIt("before",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.beforeTownGuardDeck(n))})("after",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.afterTownGuardDeck(n))}),t.k0s(),t.j41(3,"div",159),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.toggleTownGuardDeck())}),t.nrm(4,"span",160),t.k0s()()()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(4,br,e.townGuardDeck.active)),t.R7$(),t.Y8G("ngClass",t.l_i(6,F6,!e.townGuardDeck.active,e.townGuardDeck.active)),t.R7$(),t.Y8G("deck",e.townGuardDeck)("townGuard",!0)}}function YI(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",12)(1,"div",66)(2,"label",67),t.nrm(3,"img",68)(4,"span",21),t.k0s(),t.j41(5,"label",69),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.campaign=!0)}),t.nrm(6,"span",21),t.j41(7,"span",70),t.nrm(8,"img",20)(9,"span",21),t.k0s()(),t.j41(10,"label",71),t.nrm(11,"span",21)(12,"img",72),t.k0s()(),t.j41(13,"div",73)(14,"a",74),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.settingsManager.toggle("calendarLocked"))})("doubleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.settingsManager.set("calendarLocked","permissive"==n.settingsManager.settings.calendarLocked||"permissive"))}),t.nrm(15,"img",75),t.k0s()(),t.nVh(16,mI,3,2,"span",25),t.nVh(17,pI,3,1,"span",76),t.j41(18,"div",77),t.Z7z(19,CI,5,6,"div",78,t.fX1),t.nI1(21,"ghsRange"),t.k0s(),t.j41(22,"div",79)(23,"label"),t.nrm(24,"span",21),t.k0s(),t.j41(25,"input",27),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setName(n))}),t.k0s(),t.nVh(26,kI,3,4),t.nVh(27,yI,5,1,"div",28),t.k0s(),t.j41(28,"div",80)(29,"div",81)(30,"label",82),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openResources())}),t.nrm(31,"span",21),t.EFF(32,":"),t.k0s(),t.nrm(33,"span",24),t.nVh(34,EI,7,1,"div",83),t.k0s(),t.j41(35,"div",84)(36,"div",85)(37,"div",86),t.nrm(38,"img",87),t.j41(39,"input",88),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setResource(o.LootType.lumber,n))}),t.k0s()(),t.j41(40,"div",89),t.nrm(41,"img",90),t.j41(42,"input",88),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setResource(o.LootType.metal,n))}),t.k0s()(),t.j41(43,"div",91),t.nrm(44,"img",92),t.j41(45,"input",88),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setResource(o.LootType.hide,n))}),t.k0s()()(),t.j41(46,"div",93)(47,"div",94),t.nrm(48,"img",95),t.j41(49,"input",88),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setResource(o.LootType.arrowvine,n))}),t.k0s()(),t.j41(50,"div",96),t.nrm(51,"img",97),t.j41(52,"input",88),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setResource(o.LootType.axenut,n))}),t.k0s()(),t.j41(53,"div",98),t.nrm(54,"img",99),t.j41(55,"input",88),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setResource(o.LootType.corpsecap,n))}),t.k0s()(),t.j41(56,"div",100),t.nrm(57,"img",101),t.j41(58,"input",88),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setResource(o.LootType.flamefruit,n))}),t.k0s()(),t.j41(59,"div",102),t.nrm(60,"img",103),t.j41(61,"input",88),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setResource(o.LootType.rockroot,n))}),t.k0s()(),t.j41(62,"div",104),t.nrm(63,"img",105),t.j41(64,"input",88),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setResource(o.LootType.snowthistle,n))}),t.k0s()()()()(),t.j41(65,"div",106)(66,"label"),t.nrm(67,"span",21),t.EFF(68,":"),t.k0s(),t.j41(69,"input",107),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setInspiration(n))}),t.k0s()(),t.j41(70,"div",108)(71,"label"),t.nrm(72,"span",21),t.EFF(73,":"),t.k0s(),t.j41(74,"input",107),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setTotalDefense(n))}),t.k0s()(),t.j41(75,"div",109)(76,"label"),t.nrm(77,"span",21),t.EFF(78,":"),t.k0s(),t.j41(79,"div",110),t.Z7z(80,RI,10,6,"div",111,t.fX1),t.nI1(82,"ghsRange"),t.k0s()(),t.j41(83,"div",112)(84,"label"),t.nrm(85,"span",21),t.k0s(),t.j41(86,"div",113),t.Z7z(87,jI,3,4,"span",44,t.fX1),t.nI1(89,"ghsRange"),t.k0s()(),t.j41(90,"div",114)(91,"label"),t.nrm(92,"span",21),t.k0s(),t.j41(93,"div",115)(94,"span",116),t.Z7z(95,GI,3,4,"span",117,t.fX1),t.nI1(97,"slice"),t.k0s(),t.j41(98,"span",44),t.EFF(99,"+15"),t.k0s(),t.j41(100,"span",44),t.EFF(101,"+10"),t.k0s(),t.j41(102,"span",44),t.EFF(103,"+5"),t.k0s(),t.j41(104,"span",44),t.EFF(105,"0"),t.k0s(),t.j41(106,"span",44),t.EFF(107,"-5"),t.k0s(),t.j41(108,"span",44),t.EFF(109,"-10"),t.k0s(),t.j41(110,"span",116),t.Z7z(111,TI,3,4,"span",117,t.fX1),t.nI1(113,"slice"),t.k0s()()(),t.j41(114,"div",118)(115,"label"),t.nrm(116,"span",21),t.k0s(),t.j41(117,"div",119),t.Z7z(118,$I,2,4,null,null,t.fX1),t.nI1(120,"ghsRange"),t.k0s(),t.j41(121,"div",120),t.Z7z(122,II,5,1,"div",121,t.fX1),t.k0s(),t.nVh(124,AI,3,3,"div",122),t.nI1(125,"ghsFloor"),t.k0s(),t.j41(126,"div",123)(127,"form",124),t.bIt("submit",function(){t.eBV(e);const n=t.sdS(131),o=t.XpG();return t.Njj(o.addCampaignSticker(n))}),t.j41(128,"label"),t.nrm(129,"span",21),t.k0s(),t.j41(130,"input",125,1),t.bIt("keyup.enter",function(){t.eBV(e);const n=t.sdS(131),o=t.XpG();return t.Njj(o.addCampaignSticker(n))}),t.k0s(),t.j41(132,"img",126),t.bIt("click",function(){t.eBV(e);const n=t.sdS(131),o=t.XpG();return t.Njj(o.addCampaignSticker(n))}),t.k0s()(),t.j41(133,"div",127),t.Z7z(134,XI,4,2,"div",128,t.fX1),t.k0s()(),t.nrm(136,"ghs-party-buildings",129),t.nVh(137,BI,5,9,"div",130),t.k0s()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("ngClass",t.eq3(79,Pe,e.summer)),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.summer"),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet"),t.R7$(3),t.Y8G("ghs-label","party.campaign.manage"),t.R7$(),t.Y8G("ngClass",t.eq3(81,Pe,!e.summer)),t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.winter"),t.R7$(2),t.Y8G("ghs-tooltip","party.campaign.sheet.weekSections.lock")("ngClass",t.eq3(83,I6,"permissive"==e.settingsManager.settings.calendarLocked)),t.R7$(2),t.Y8G("src","./assets/images/lock"+(e.settingsManager.settings.calendarLocked?"":"-open")+".svg",t.B4B),t.R7$(),t.vxM(e.disableShortcuts?-1:16),t.R7$(),t.vxM(e.party.weeks==80+80*e.calendarSheet?17:-1),t.R7$(2),t.Dyx(t.i5U(21,57,t.lJ4(85,Xt),80)),t.R7$(5),t.Y8G("ghs-label","party.campaign.sheet.name"),t.R7$(),t.Y8G("value",e.party.name)("ghs-label","party.campaign.sheet.name")("ghs-label-attribute","placeholder"),t.R7$(),t.vxM(e.gameManager.game.scenario?-1:26),t.R7$(),t.vxM(e.gameManager.game.scenario?27:-1),t.R7$(4),t.Y8G("ghs-label","party.campaign.sheet.supply"),t.R7$(3),t.vxM(e.characters.length>0?34:-1),t.R7$(5),t.Y8G("value",e.party.loot.lumber||0),t.R7$(3),t.Y8G("value",e.party.loot.metal||0),t.R7$(3),t.Y8G("value",e.party.loot.hide||0),t.R7$(4),t.Y8G("value",e.party.loot.arrowvine||0),t.R7$(3),t.Y8G("value",e.party.loot.axenut||0),t.R7$(3),t.Y8G("value",e.party.loot.corpsecap||0),t.R7$(3),t.Y8G("value",e.party.loot.flamefruit||0),t.R7$(3),t.Y8G("value",e.party.loot.rockroot||0),t.R7$(3),t.Y8G("value",e.party.loot.snowthistle||0),t.R7$(3),t.Y8G("ghs-label","party.inspiration"),t.R7$(2),t.Y8G("value",e.party.inspiration||0)("ghs-label","party.inspiration")("ghs-label-attribute","placeholder"),t.R7$(3),t.Y8G("ghs-label","party.campaign.sheet.totalDefense"),t.R7$(2),t.Y8G("value",(e.party.defense||0)+e.moraleDefense)("ghs-label","party.campaign.sheet.totalDefense")("ghs-label-attribute","placeholder"),t.R7$(3),t.Y8G("ghs-label","party.campaign.sheet.soldiers"),t.R7$(3),t.Dyx(t.i5U(82,60,t.lJ4(86,Xt),4)),t.R7$(5),t.Y8G("ghs-label","party.morale"),t.R7$(2),t.Dyx(t.i5U(89,63,t.lJ4(87,Xt),21)),t.R7$(5),t.Y8G("ghs-label","party.campaign.sheet.defense"),t.R7$(2),t.Y8G("ngClass",t.eq3(88,Pe,e.party.morale>19)),t.R7$(),t.Dyx(t.brH(97,66,e.gameManager.campaignData().highMorale||t.lJ4(90,Xt),0,e.highMoraleSolved+1)),t.R7$(3),t.Y8G("ngClass",t.eq3(91,Pe,15==e.moraleDefense)),t.R7$(2),t.Y8G("ngClass",t.eq3(93,Pe,10==e.moraleDefense)),t.R7$(2),t.Y8G("ngClass",t.eq3(95,Pe,5==e.moraleDefense)),t.R7$(2),t.Y8G("ngClass",t.eq3(97,Pe,0==e.moraleDefense)),t.R7$(2),t.Y8G("ngClass",t.eq3(99,Pe,-5==e.moraleDefense)),t.R7$(2),t.Y8G("ngClass",t.eq3(101,Pe,-10==e.moraleDefense)),t.R7$(2),t.Y8G("ngClass",t.eq3(103,Pe,e.party.morale<1)),t.R7$(),t.Dyx(t.brH(113,70,e.gameManager.campaignData().lowMorale||t.lJ4(105,Xt),0,e.lowMoraleSolved+1)),t.R7$(5),t.Y8G("ghs-label","party.campaign.sheet.townGuardPerks"),t.R7$(2),t.Dyx(t.i5U(120,74,t.lJ4(106,Xt),45)),t.R7$(4),t.Dyx(e.gameManager.campaignData().townGuardPerks),t.R7$(2),t.vxM(e.party.townGuardPerkSections.length>t.bMT(125,77,e.party.townGuardPerks/3)?124:-1),t.R7$(5),t.Y8G("ghs-label","party.campaign.sheet.campaignStickers"),t.R7$(),t.Y8G("autocomplete",e.campaignStickers)("emptyLabel","party.campaign.sheet.campaignStickers.empty")("ghs-label","party.campaign.sheet.campaignStickers")("ghs-label-attribute","placeholder"),t.R7$(3),t.Y8G("ngClass",t.eq3(107,ti,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.party)),t.R7$(),t.Dyx(e.party.campaignStickers),t.R7$(2),t.Y8G("party",e.party),t.R7$(),t.vxM(e.townGuardDeck&&e.townGuardDeck.cards.length>0?137:-1)}}function NI(i,r){if(1&i){const e=t.RV6();t.j41(0,"img",58),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.removeParty())}),t.k0s()}2&i&&t.Y8G("ghs-label","party.remove")("ghs-label-attribute","title")}function zI(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.name)}}function LI(i,r){if(1&i&&(t.j41(0,"span"),t.nrm(1,"span",21),t.EFF(2),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.Y8G("ghs-label","party.campaign"),t.R7$(),t.SpI("\xa0",e.id)}}function UI(i,r){if(1&i&&(t.j41(0,"option",52),t.nVh(1,zI,2,1,"span"),t.nVh(2,LI,3,2,"span"),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(4);t.Y8G("value",t.mNQ(e.id))("selected",e.id==a.party.id)("disabled",e.id==a.party.id),t.R7$(),t.vxM(e.name?1:-1),t.R7$(),t.vxM(e.name?-1:2)}}function qI(i,r){if(1&i){const e=t.RV6();t.j41(0,"select",51),t.bIt("change",function(n){t.eBV(e);const o=t.XpG(3);return t.Njj(o.selectParty(n))}),t.Z7z(1,UI,3,6,"option",52,t.fX1),t.k0s()}if(2&i){const e=t.XpG(3);t.Y8G("ghs-label","party.change")("ghs-label-attribute","title"),t.R7$(),t.Dyx(e.gameManager.game.parties)}}function HI(i,r){if(1&i){const e=t.RV6();t.nVh(0,NI,1,2,"img",56),t.nVh(1,qI,3,2,"select",23),t.j41(2,"img",57),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.newParty())}),t.k0s()}if(2&i){const e=t.XpG(2);t.vxM(e.gameManager.game.parties.length>1?0:-1),t.R7$(),t.vxM(e.gameManager.game.parties.length>1&&!e.gameManager.game.scenario?1:-1),t.R7$(),t.Y8G("ghs-label","party.new")("ghs-label-attribute","title")}}function KI(i,r){1&i&&(t.j41(0,"div",28),t.nrm(1,"img",59),t.j41(2,"span",60)(3,"span",61),t.nrm(4,"span",21),t.k0s()()()),2&i&&(t.R7$(4),t.Y8G("ghs-label","party.new.hint"))}function WI(i,r){if(1&i){const e=t.RV6();t.nrm(0,"span",178),t.j41(1,"span",179),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG().$implicit,g=t.XpG(2);return t.Njj(g.unlockConclusion(g.reputationSectionsMapped[o][n].section,(g.party.factionReputation[o]||0)>=30-n-10))})("doubleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG().$implicit,g=t.XpG(2);return t.Njj(g.unlockConclusion(g.reputationSectionsMapped[o][n].section,(g.party.factionReputation[o]||0)>=30-n-10,!0))}),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG().$implicit,n=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Qt,n.isConclusion(n.reputationSectionsMapped[a][e].section))),t.R7$(),t.Y8G("ghs-label","%game.section:"+n.reputationSectionsMapped[a][e].section+"%")}}function JI(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",175)(1,"span",64),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG().$implicit,g=t.XpG(2);return t.Njj(g.setFactionReputation(o,30-n-10))}),t.k0s(),t.j41(2,"span",177),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG().$implicit,g=t.XpG(2);return t.Njj(g.setFactionReputation(o,30-n-10))}),t.EFF(3),t.k0s(),t.j41(4,"span",134),t.nVh(5,WI,2,4),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG().$implicit,n=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(3,Qt,n.party.factionReputation[a]==30-e-10)),t.R7$(2),t.JRh(30-e-10),t.R7$(2),t.vxM(n.reputationSectionsMapped[a]&&n.reputationSectionsMapped[a][e]?5:-1)}}function ZI(i,r){if(1&i&&(t.j41(0,"div",162)(1,"label"),t.nrm(2,"img",75)(3,"span",21),t.k0s(),t.j41(4,"div",41),t.Z7z(5,JI,6,5,"div",175,t.fX1),t.nI1(7,"ghsRange"),t.k0s(),t.nrm(8,"span",176),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(2),t.Y8G("src","./assets/images/gh2e/faction/"+e+".svg",t.B4B),t.R7$(),t.Y8G("ghs-label","party.reputation"),t.R7$(2),t.Dyx(t.i5U(7,3,t.lJ4(6,Xt),31)),t.R7$(3),t.Y8G("ngClass",t.eq3(7,Qt,(a.party.factionReputation[e]||0)>12))}}function QI(i,r){if(1&i&&(t.j41(0,"div",134),t.nrm(1,"span",178)(2,"span",180),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(3,Qt,a.isConclusion(e.section)||a.additionalReputation(e))),t.R7$(),t.Y8G("ghs-label","party.reputation.additional.special."+e.section.split(":")[0])("ghs-label-args",t.l_i(5,X6,e.section.split(":")[1],e.value))}}function tA(i,r){1&i&&t.nVh(0,QI,3,8,"div",134),2&i&&t.vxM("special"==r.$implicit.faction?0:-1)}function eA(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",134),t.nrm(1,"span",178),t.j41(2,"span",181),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(3);return t.Njj(o.unlockConclusion(n.section,o.additionalReputation(n)))})("doubleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(3);return t.Njj(o.unlockConclusion(n.section,o.additionalReputation(n),!0))}),t.k0s()()}if(2&i){const e=t.XpG().$implicit,a=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(3,Qt,a.isConclusion(e.section)||a.additionalReputation(e))),t.R7$(),t.Y8G("ghs-label","party.reputation.additional.sectionRequires"+(e.requires.length>1?".multiple":""))("ghs-label-args",t.ziG(5,B6,e.section,e.value,e.faction,e.requires.join(" & ")))}}function nA(i,r){if(1&i&&t.nVh(0,eA,3,10,"div",134),2&i){const e=r.$implicit,a=t.XpG().$implicit;t.vxM(e.faction==a&&e.requires&&e.requires.length?0:-1)}}function iA(i,r){if(1&i&&(t.j41(0,"div",162)(1,"div",81),t.nrm(2,"img",75),t.k0s(),t.Z7z(3,nA,1,1,null,null,t.fX1),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(2),t.Y8G("src","./assets/images/gh2e/faction/"+e+".svg",t.B4B),t.R7$(),t.Dyx(a.reputationSections)}}function aA(i,r){1&i&&(t.j41(0,"span",134),t.EFF(1," +1 "),t.nrm(2,"img",185),t.k0s())}function oA(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",186),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG().$implicit,g=t.XpG(2);return t.Njj(g.unlockConclusion(g.imbuementSections[10*o+n+1],g.party.imbuement>=10*o+n+1))})("doubleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG().$implicit,g=t.XpG(2);return t.Njj(g.unlockConclusion(g.imbuementSections[10*o+n+1],g.party.imbuement>=10*o+n+1,!0))}),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG().$implicit,n=t.XpG(2);t.Y8G("ghs-label","%game.section:"+n.imbuementSections[10*a+e+1]+"%")}}function sA(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",182)(1,"div",178)(2,"span",183),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG().$implicit,g=t.XpG(2);return t.Njj(g.setImbuement(10*o+n+1))}),t.k0s(),t.nVh(3,aA,3,0,"span",134),t.nVh(4,oA,1,1,"span",184),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG().$implicit,n=t.XpG(2);t.Y8G("ngClass",t.l_i(4,yr,e%10==4||n.imbuementSections[10*a+e+1],e%10==4)),t.R7$(),t.Y8G("ngClass",t.eq3(7,Qt,n.party.imbuement>=10*a+e+1)),t.R7$(2),t.vxM(e%10==4?3:-1),t.R7$(),t.vxM(n.imbuementSections[10*a+e+1]?4:-1)}}function rA(i,r){1&i&&(t.j41(0,"div",165)(1,"div",168),t.Z7z(2,sA,5,9,"div",182,t.fX1),t.nI1(4,"ghsRange"),t.k0s()()),2&i&&(t.R7$(2),t.Dyx(t.i5U(4,0,t.lJ4(3,Xt),10)))}function cA(i,r){1&i&&(t.j41(0,"div",134),t.EFF(1," +1 "),t.nrm(2,"img",185),t.k0s())}function lA(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",182)(1,"div",187),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG().$implicit,g=t.XpG(2);return t.Njj(g.setDonations(10*o+n+1))}),t.nVh(2,cA,3,0,"div",134),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG().$implicit,n=t.XpG(2);t.Y8G("ngClass",t.l_i(3,yr,e%5==4,e%5==4)),t.R7$(),t.Y8G("ngClass",t.eq3(6,Qt,n.party.donations>=10*a+e+1)),t.R7$(),t.vxM(e%5==4?2:-1)}}function gA(i,r){1&i&&(t.j41(0,"div",165)(1,"div",168),t.Z7z(2,lA,3,8,"div",182,t.fX1),t.nI1(4,"ghsRange"),t.k0s()()),2&i&&(t.R7$(2),t.Dyx(t.i5U(4,0,t.lJ4(3,Xt),10)))}function dA(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",188),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$index,o=t.XpG(2);return t.Njj(o.setProsperity(n+1))}),t.EFF(1),t.k0s()}if(2&i){const e=t.XpG().$index,a=t.XpG(2);t.R7$(),t.SpI(" ",a.prosperitySteps.indexOf(e)+2," ")}}function hA(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",186),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG().$index,o=t.XpG(2);return t.Njj(o.unlockConclusion(o.prosperitySections[n],o.gameManager.prosperityTicks()>n))})("doubleClick",function(){t.eBV(e);const n=t.XpG().$index,o=t.XpG(2);return t.Njj(o.unlockConclusion(o.prosperitySections[n],o.gameManager.prosperityTicks()>n,!0))}),t.k0s()}if(2&i){const e=t.XpG().$index,a=t.XpG(2);t.Y8G("ghs-label","%game.section:"+a.prosperitySections[e]+"%")}}function _A(i,r){1&i&&t.nrm(0,"div",24)}function mA(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",182),t.nVh(1,dA,2,1,"div",173),t.j41(2,"div",178)(3,"span",183),t.bIt("singleClick",function(){const n=t.eBV(e).$index,o=t.XpG(2);return t.Njj(o.setProsperity(n+1))}),t.k0s(),t.nVh(4,hA,1,1,"span",184),t.k0s()(),t.nVh(5,_A,1,0,"div",24)}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.Y8G("ngClass",t.sMw(5,Y6,-1!=n.prosperitySteps.indexOf(a),n.prosperitySections[a],33==e)),t.R7$(),t.vxM(-1!=n.prosperitySteps.indexOf(a)?1:-1),t.R7$(),t.Y8G("ngClass",t.l_i(9,xr,n.gameManager.prosperityTicks()>a,-1==n.prosperitySteps.indexOf(a)&&-1!=n.prosperityHighlightSteps.indexOf(a))),t.R7$(2),t.vxM(n.prosperitySections[a]?4:-1),t.R7$(),t.vxM(32==e?5:-1)}}function pA(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",13)(1,"div",66)(2,"label",69),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.campaign=!0)}),t.nrm(3,"span",21),t.j41(4,"span",70),t.nrm(5,"img",20)(6,"span",21),t.k0s()()(),t.j41(7,"div",79)(8,"label"),t.nrm(9,"span",21),t.k0s(),t.j41(10,"input",27),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setName(n))}),t.k0s(),t.nVh(11,HI,3,4),t.nVh(12,KI,5,1,"div",28),t.k0s(),t.j41(13,"div",106)(14,"label"),t.nrm(15,"span",21),t.EFF(16,":"),t.k0s(),t.j41(17,"input",107),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setInspiration(n))}),t.k0s()(),t.j41(18,"div",161),t.Z7z(19,ZI,9,9,"div",162,t.fX1),t.k0s(),t.j41(21,"div",163)(22,"label"),t.nrm(23,"span",21),t.k0s(),t.j41(24,"div",162),t.Z7z(25,tA,1,1,null,null,t.fX1),t.k0s(),t.Z7z(27,iA,5,1,"div",162,t.fX1),t.k0s(),t.j41(29,"div",30)(30,"label"),t.nrm(31,"span",21),t.EFF(32,":"),t.k0s(),t.j41(33,"textarea",27),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.setNotes(n))}),t.k0s()(),t.j41(34,"div",164)(35,"label"),t.nrm(36,"span",21),t.k0s(),t.Z7z(37,rA,5,4,"div",165,t.fX1),t.nI1(39,"ghsRange"),t.k0s(),t.j41(40,"div",166)(41,"label"),t.nrm(42,"span",21),t.k0s(),t.Z7z(43,gA,5,4,"div",165,t.fX1),t.nI1(45,"ghsRange"),t.k0s(),t.j41(46,"div",167)(47,"div",168)(48,"div",169)(49,"span",170),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.setProsperity(0))}),t.k0s(),t.nrm(50,"img",171),t.j41(51,"span"),t.EFF(52,":"),t.k0s()(),t.j41(53,"div",172),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.setProsperity(0))}),t.j41(54,"div",173),t.EFF(55,"1"),t.k0s(),t.nrm(56,"div",174),t.k0s(),t.Z7z(57,mA,6,12,null,null,t.fX1),t.nI1(59,"ghsRange"),t.k0s()()()}if(2&i){const e=t.XpG();t.R7$(3),t.Y8G("ghs-label","party.campaign.sheet"),t.R7$(3),t.Y8G("ghs-label","party.campaign.manage"),t.R7$(3),t.Y8G("ghs-label","party.campaign.sheet.name"),t.R7$(),t.Y8G("value",e.party.name)("ghs-label","party.campaign.sheet.name")("ghs-label-attribute","placeholder"),t.R7$(),t.vxM(e.gameManager.game.scenario?-1:11),t.R7$(),t.vxM(e.gameManager.game.scenario?12:-1),t.R7$(3),t.Y8G("ghs-label","party.inspiration"),t.R7$(2),t.Y8G("value",e.party.inspiration||0)("ghs-label","party.inspiration")("ghs-label-attribute","placeholder"),t.R7$(2),t.Dyx(e.factions),t.R7$(4),t.Y8G("ghs-label","party.reputation.additional"),t.R7$(2),t.Dyx(e.reputationSections),t.R7$(2),t.Dyx(e.factions),t.R7$(4),t.Y8G("ghs-label","party.notes"),t.R7$(2),t.Y8G("value",e.party.notes)("ghs-label","party.notes")("ghs-label-attribute","placeholder"),t.R7$(3),t.Y8G("ghs-label","party.imbuement"),t.R7$(),t.Dyx(t.i5U(39,23,t.lJ4(32,Xt),8)),t.R7$(5),t.Y8G("ghs-label","party.greatOak"),t.R7$(),t.Dyx(t.i5U(45,26,t.lJ4(33,Xt),10)),t.R7$(6),t.Y8G("ghs-label","party.prosperity")("ghs-tooltip","party.prosperity.reset"),t.R7$(),t.Y8G("ghs-tooltip","party.prosperity.reset"),t.R7$(3),t.Y8G("ghs-tooltip","party.prosperity.reset"),t.R7$(4),t.Dyx(t.i5U(59,29,t.lJ4(34,Xt),e.prosperitySteps[e.prosperitySteps.length-1]+1))}}function uA(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",189),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleFhSheet())}),t.nrm(1,"span",21),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","party.campaign.sheet."+(e.fhSheet?"disable":"enable"))}}function fA(i,r){if(1&i){const e=t.RV6();t.j41(0,"img",55),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openMap())}),t.k0s()}2&i&&t.Y8G("ghs-tooltip","party.campaign.map")}function CA(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",25)(1,"img",53),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openFlowChart())}),t.k0s(),t.nVh(2,fA,1,1,"img",54),t.k0s()}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-tooltip","scenario.chart"),t.R7$(),t.vxM(e.worldMap?2:-1)}}function MA(i,r){if(1&i&&(t.j41(0,"option",193),t.nrm(1,"span",21),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("selected",e==a.partyEdition)("value",e),t.R7$(),t.Y8G("ghs-label","data.edition."+e)}}function vA(i,r){1&i&&t.nrm(0,"div",225)}function OA(i,r){if(1&i&&(t.j41(0,"div",226)(1,"span",229),t.nrm(2,"span",21),t.k0s()()),2&i){const e=t.XpG().$implicit;t.R7$(2),t.Y8G("ghs-label","data.edition."+e)}}function PA(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function bA(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function kA(i,r){if(1&i&&(t.EFF(0," #"),t.nVh(1,PA,2,0,"span"),t.nVh(2,bA,2,0,"span"),t.EFF(3)),2&i){const e=t.XpG().$implicit,a=t.XpG().$implicit,n=t.XpG(2);t.R7$(),t.vxM(n.maxScenario(n.scenarios[a])>2&&e.index.length<3?1:-1),t.R7$(),t.vxM(n.maxScenario(n.scenarios[a])>1&&e.index.length<2?2:-1),t.R7$(),t.SpI("",e.index," ")}}function yA(i,r){if(1&i&&t.nrm(0,"img",230),2&i){const e=t.XpG().$implicit,a=t.XpG(3);t.Y8G("src",a.characterIcon(e.solo),t.B4B)}}function xA(i,r){if(1&i&&t.nrm(0,"span",21),2&i){const e=t.XpG().$implicit;t.Y8G("ghs-label","data.scenario.group."+e.group)}}function EA(i,r){1&i&&t.nrm(0,"img",148)}function wA(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",237),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(3);return t.Njj(o.removeManual(n))}),t.nrm(1,"img",238)(2,"img",239),t.k0s()}2&i&&t.Y8G("ghs-label","party.campaign.scenarios.removeManual")("ghs-label-attribute","title")}function RA(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",240),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(3);return t.Njj(o.scenarioRequirements(n))}),t.nrm(1,"img",153),t.k0s()}2&i&&t.Y8G("ghs-tooltip","scenario.locked")}function jA(i,r){1&i&&(t.j41(0,"span",234),t.nrm(1,"img",241),t.k0s()),2&i&&t.Y8G("ghs-tooltip","scenario.summary.randomItemLooted")}function GA(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",242),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(3);return t.Njj(o.scenarioRewards(n))}),t.nrm(1,"img",243),t.k0s()}2&i&&t.Y8G("ghs-tooltip","scenario.summary.rewards")}function TA(i,r){if(1&i){const e=t.RV6();t.j41(0,"span")(1,"a",244),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(3);return t.Njj(o.removeSuccess(n))}),t.nrm(2,"img",245)(3,"img",239),t.k0s()()}2&i&&(t.R7$(),t.Y8G("ghs-label","party.campaign.scenarios.removeSuccess")("ghs-label-attribute","title"))}function SA(i,r){if(1&i){const e=t.RV6();t.j41(0,"span")(1,"a",246),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(3);return t.Njj(o.removeSuccess(n,!0))}),t.nrm(2,"img",245)(3,"img",239),t.k0s()()}2&i&&(t.R7$(),t.Y8G("ghs-label","party.campaign.scenarios.removeSuccessCasual")("ghs-label-attribute","title"))}function $A(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",227)(1,"span"),t.nVh(2,kA,4,3),t.nVh(3,yA,1,1,"img",230),t.k0s(),t.j41(4,"span"),t.nVh(5,xA,1,1,"span",21),t.k0s(),t.j41(6,"span",231),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.scenarioRequirements(n))}),t.nVh(7,EA,1,0,"img",148),t.nrm(8,"span",21),t.k0s(),t.j41(9,"span"),t.nrm(10,"span",24),t.nVh(11,wA,3,2,"a",232),t.nVh(12,RA,2,1,"span",233),t.nVh(13,jA,2,1,"span",234),t.nVh(14,GA,2,1,"span",234),t.Z7z(15,TA,4,2,"span",null,t.fX1),t.nI1(17,"ghsRange"),t.Z7z(18,SA,4,2,"span",null,t.fX1),t.nI1(20,"ghsRange"),t.j41(21,"a",235),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.addSuccess(n))})("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.addSuccess(n,!0))}),t.nrm(22,"img",236),t.k0s()()()}if(2&i){const e=r.$implicit,a=t.XpG(3);t.R7$(2),t.vxM(e.solo?-1:2),t.R7$(),t.vxM(e.solo?3:-1),t.R7$(2),t.vxM(e.group?5:-1),t.R7$(),t.Y8G("ngClass",t.l_i(21,z6,e.isBlocked,!e.isBlocked&&e.isLocked))("ghs-tooltip",e.isBlocked?"scenario.blocked":e.isLocked?"scenario.locked":"")("toggable",!1),t.R7$(),t.vxM(e.isBlocked||e.isLocked?7:-1),t.R7$(),t.Y8G("ghs-label",a.gameManager.scenarioManager.scenarioTitle(e)),t.R7$(3),t.vxM(a.isManual(e)&&a.countFinished(e)<1?11:-1),t.R7$(),t.vxM(e.isLocked?12:-1),t.R7$(),t.vxM(a.hasRandomItemLooted(e)?13:-1),t.R7$(),t.vxM(a.countFinished(e)?14:-1),t.R7$(),t.Dyx(t.i5U(17,15,t.lJ4(24,Xt),a.countFinished(e))),t.R7$(3),t.Dyx(t.i5U(20,18,t.lJ4(25,Xt),a.countFinished(e,!0))),t.R7$(3),t.Y8G("ghs-label",e.isBlocked?"scenario.blocked":e.isLocked?"scenario.locked":"party.campaign.scenarios.addSuccess")("ghs-label-attribute","title")("ngClass",t.eq3(26,Ii,e.isBlocked||e.isLocked))}}function DA(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",228)(1,"input",247,4),t.bIt("keyup",function(){t.eBV(e);const n=t.sdS(2),o=t.sdS(4);return n.classList.remove("error"),t.Njj(o.classList.remove("error"))})("keyup.enter",function(){t.eBV(e);const n=t.sdS(2),o=t.sdS(4),g=t.XpG().$implicit,_=t.XpG(2);return t.Njj(_.unlockScenario(n,o,g))}),t.k0s(),t.j41(3,"input",247,5),t.bIt("keyup",function(){t.eBV(e);const n=t.sdS(2),o=t.sdS(4);return n.classList.remove("error"),t.Njj(o.classList.remove("error"))})("keyup.enter",function(){t.eBV(e);const n=t.sdS(2),o=t.sdS(4),g=t.XpG().$implicit,_=t.XpG(2);return t.Njj(_.unlockScenario(n,o,g))}),t.k0s(),t.j41(5,"a",37),t.bIt("click",function(){t.eBV(e);const n=t.sdS(2),o=t.sdS(4),g=t.XpG().$implicit,_=t.XpG(2);return t.Njj(_.unlockScenario(n,o,g))}),t.nrm(6,"span",21),t.EFF(7,"\xa0"),t.nrm(8,"img",38),t.k0s()()}2&i&&(t.R7$(),t.Y8G("ghs-label","party.campaign.scenarios.index")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","party.campaign.scenarios.group")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","party.campaign.scenarios.unlock")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","party.campaign.scenarios.unlock"))}function IA(i,r){if(1&i&&(t.nVh(0,vA,1,0,"div",225),t.nVh(1,OA,3,1,"div",226),t.Z7z(2,$A,23,28,"div",227,t.fX1),t.nVh(4,DA,9,7,"div",228)),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.vxM(a>0?0:-1),t.R7$(),t.vxM(n.scenarioEditions.length>1?1:-1),t.R7$(),t.Dyx(n.scenarios[e]),t.R7$(2),t.vxM(1==n.scenarioEditions.length?4:-1)}}function AA(i,r){1&i&&t.nrm(0,"div",225)}function VA(i,r){if(1&i&&(t.j41(0,"div",226)(1,"span",229),t.nrm(2,"span",21),t.k0s()()),2&i){const e=t.XpG().$implicit;t.R7$(2),t.Y8G("ghs-label","data.edition."+e)}}function FA(i,r){1&i&&t.nrm(0,"div",225)}function XA(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function BA(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function YA(i,r){if(1&i&&t.nrm(0,"span",21),2&i){const e=t.XpG().$implicit;t.Y8G("ghs-label","data.scenario.group."+e.group)}}function NA(i,r){if(1&i&&t.nrm(0,"span",21),2&i){const e=t.XpG().$implicit,a=t.XpG(5);t.Y8G("ghs-label",a.gameManager.scenarioManager.scenarioTitle(e,!0))}}function zA(i,r){if(1&i&&t.nrm(0,"span",21),2&i){const e=t.XpG().$implicit;t.Y8G("ghs-label","%data.scenarioNumber:"+e.parent+"%")}}function LA(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",227)(1,"span"),t.EFF(2," #"),t.nVh(3,XA,2,0,"span"),t.nVh(4,BA,2,0,"span"),t.EFF(5),t.k0s(),t.j41(6,"span"),t.nVh(7,YA,1,1,"span",21),t.k0s(),t.j41(8,"span",248),t.nVh(9,NA,1,1,"span",21),t.nVh(10,zA,1,1,"span",21),t.k0s(),t.j41(11,"span"),t.nrm(12,"span",24),t.j41(13,"span",242),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(5);return t.Njj(o.scenarioRewards(n,!0))}),t.nrm(14,"img",243),t.k0s(),t.j41(15,"a",244),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2).$implicit,g=t.XpG(3);return t.Njj(g.removeConclusion(n.index,o))}),t.nrm(16,"img",245)(17,"img",239),t.k0s()()()}if(2&i){const e=r.$implicit,a=t.XpG(2).$implicit,n=t.XpG(3);t.R7$(3),t.vxM(n.maxScenario(n.conclusions[a])>2&&e.index.length<3?3:-1),t.R7$(),t.vxM(n.maxScenario(n.conclusions[a])>1&&e.index.length<2?4:-1),t.R7$(),t.SpI("",e.index," "),t.R7$(2),t.vxM(e.group?7:-1),t.R7$(2),t.vxM(e.named?9:-1),t.R7$(),t.vxM(e.parent?10:-1),t.R7$(3),t.Y8G("ghs-tooltip","scenario.summary.rewards"),t.R7$(2),t.Y8G("ghs-label","party.campaign.scenarios.removeSuccess")("ghs-label-attribute","title")}}function UA(i,r){if(1&i&&(t.nVh(0,FA,1,0,"div",225),t.j41(1,"div",226)(2,"span",229),t.nrm(3,"span",21),t.k0s()(),t.Z7z(4,LA,18,9,"div",227,W6)),2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG(3);t.vxM(n>0?0:-1),t.R7$(3),t.Y8G("ghs-label","party.campaign.scenarios.conclusions"),t.R7$(),t.Dyx(o.conclusions[a])}}function qA(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",228),t.nrm(1,"img",243),t.EFF(2," / "),t.nrm(3,"img",249),t.j41(4,"input",247,6),t.bIt("keyup",function(){t.eBV(e);const n=t.sdS(5);return t.Njj(n.classList.remove("error"))})("keyup.enter",function(){t.eBV(e);const n=t.sdS(5),o=t.XpG(4);return t.Njj(o.selectFinishConclusion(n))}),t.k0s(),t.j41(6,"a",37),t.bIt("click",function(){t.eBV(e);const n=t.sdS(5),o=t.XpG(4);return t.Njj(o.selectFinishConclusion(n))}),t.nrm(7,"span",21),t.EFF(8,"\xa0"),t.nrm(9,"img",38),t.k0s()()}2&i&&(t.R7$(4),t.Y8G("ghs-label","party.campaign.scenarios.index")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","party.campaign.scenarios.addConclusion")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","party.campaign.scenarios.addConclusion"))}function HA(i,r){if(1&i&&(t.nVh(0,AA,1,0,"div",225),t.nVh(1,VA,3,1,"div",226),t.nVh(2,UA,6,2),t.nVh(3,qA,10,5,"div",228)),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(3);t.vxM(a>0?0:-1),t.R7$(),t.vxM(n.scenarioEditions.length>1?1:-1),t.R7$(),t.vxM(n.conclusions[e]&&n.conclusions[e].length>0?2:-1),t.R7$(),t.vxM(1==n.scenarioEditions.length?3:-1)}}function KA(i,r){if(1&i&&(t.j41(0,"div",194)(1,"div",194),t.Z7z(2,HA,4,4,null,null,t.fX1),t.k0s()()),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(2,ti,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.party)),t.R7$(),t.Y8G("ngClass",t.eq3(4,ti,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.party)),t.R7$(),t.Dyx(e.scenarioEditions)}}function WA(i,r){if(1&i){const e=t.RV6();t.j41(0,"img",253),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.setProsperity(0))}),t.k0s()}2&i&&t.Y8G("ghs-tooltip","party.prosperity.reset")}function JA(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",254),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.setProsperity(0))}),t.nrm(1,"span",174),t.j41(2,"span"),t.EFF(3,":"),t.k0s()()}2&i&&t.Y8G("ghs-tooltip","party.prosperity.reset")}function ZA(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",188),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$index,o=t.XpG(3);return t.Njj(o.setProsperity(n+1))}),t.EFF(1),t.k0s()}if(2&i){const e=t.XpG().$index,a=t.XpG(3);t.R7$(),t.SpI(" ",a.prosperitySteps.indexOf(e)+2," ")}}function QA(i,r){if(1&i&&t.nrm(0,"span",255),2&i){const e=t.XpG().$index,a=t.XpG(3);t.Y8G("ghs-label","%game.section:"+a.prosperitySections[e]+"%")}}function tV(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",252),t.nVh(1,ZA,2,1,"div",173),t.j41(2,"div",187),t.bIt("click",function(){const n=t.eBV(e).$index,o=t.XpG(3);return t.Njj(o.setProsperity(n+1))}),t.nVh(3,QA,1,1,"span",255),t.k0s()()}if(2&i){const e=r.$index,a=t.XpG(3);t.Y8G("autoscroll",a.gameManager.prosperityTicks()==e+1||0==a.gameManager.prosperityTicks()&&0==e)("ngClass",t.l_i(5,U6,-1!=a.prosperitySteps.indexOf(e),a.prosperitySections[e])),t.R7$(),t.vxM(-1!=a.prosperitySteps.indexOf(e)?1:-1),t.R7$(),t.Y8G("ngClass",t.l_i(8,xr,a.gameManager.prosperityTicks()>e,-1!=a.prosperityHighlightSteps.indexOf(e))),t.R7$(),t.vxM(a.prosperitySections[e]?3:-1)}}function eV(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",196)(1,"div",169)(2,"div",173)(3,"span",170),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.setProsperity(0))}),t.k0s(),t.nVh(4,WA,1,1,"img",171),t.j41(5,"span"),t.EFF(6,":"),t.k0s(),t.j41(7,"img",250),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.settingsManager.toggle("wrapProsperity"))}),t.k0s()(),t.nVh(8,JA,4,1,"div",251),t.k0s(),t.j41(9,"div",168),t.Z7z(10,tV,4,11,"div",252,t.fX1),t.nI1(12,"ghsRange"),t.k0s()()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.l_i(10,L6,e.fhSheet,e.settingsManager.settings.wrapProsperity)),t.R7$(3),t.Y8G("ghs-label","party.prosperity")("ghs-tooltip","party.prosperity.reset"),t.R7$(),t.vxM(e.fhSheet?4:-1),t.R7$(3),t.Y8G("ghs-tooltip","party.prosperity.wrap."+(e.settingsManager.settings.wrapProsperity?"shrink":"expand"))("src","./assets/images/"+(e.settingsManager.settings.wrapProsperity?"shrink":"expand")+".svg",t.B4B),t.R7$(),t.vxM(e.fhSheet?-1:8),t.R7$(2),t.Dyx(t.i5U(12,7,t.lJ4(13,Xt),e.prosperitySteps[e.prosperitySteps.length-1]+1))}}function nV(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",256)(1,"div",257)(2,"div",187),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.setDonations(n+1))}),t.k0s(),t.nrm(3,"img",258),t.j41(4,"span",259),t.EFF(5,"+10g"),t.k0s()()()}if(2&i){const e=r.$implicit,a=t.XpG(3);t.R7$(2),t.Y8G("ngClass",t.eq3(1,Qt,a.party.donations>e))}}function iV(i,r){1&i&&(t.j41(0,"div",197)(1,"label"),t.nrm(2,"span",21),t.EFF(3,":"),t.k0s(),t.j41(4,"div",168),t.Z7z(5,nV,6,3,"div",256,t.fX1),t.nI1(7,"ghsRange"),t.k0s()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","party.campaign.donations"),t.R7$(3),t.Dyx(t.i5U(7,1,t.lJ4(4,Xt),10)))}function aV(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",262)(1,"span",263),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG().$implicit,g=t.XpG(4);return t.Njj(g.setDonations(10+n+18*o+1))}),t.k0s(),t.j41(2,"span",259),t.EFF(3),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG().$implicit,n=t.XpG(4);t.R7$(),t.Y8G("ngClass",t.l_i(2,q6,n.party.donations>10+e+18*a,10+e+18*a<40?(10+e+18*a)%5==4:(10+e+18*a)%10==9)),t.R7$(2),t.JRh(10*(11+e+18*a))}}function oV(i,r){1&i&&(t.j41(0,"div",111),t.Z7z(1,aV,4,5,"div",262,t.fX1),t.nI1(3,"ghsRange"),t.k0s()),2&i&&(t.R7$(),t.Dyx(t.i5U(3,0,t.lJ4(3,Xt),18)))}function sV(i,r){1&i&&(t.j41(0,"div",261),t.Z7z(1,oV,4,4,"div",111,t.fX1),t.nI1(3,"ghsRange"),t.k0s()),2&i&&(t.R7$(),t.Dyx(t.i5U(3,0,t.lJ4(3,Xt),5)))}function rV(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",198)(1,"label",260),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.toggleEnvelopeB())}),t.nrm(2,"div",178)(3,"span",21),t.k0s(),t.nVh(4,sV,4,4,"div",261),t.k0s()}if(2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ngClass",t.eq3(3,Qt,e.party.envelopeB)),t.R7$(),t.Y8G("ghs-label","party.campaign.envelopeB"),t.R7$(),t.vxM(e.party.envelopeB?4:-1)}}function cV(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.SpI(" ",e.split(":")[1],"x\xa0 ")}}function lV(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",34),t.nVh(1,cV,2,1,"span"),t.nrm(2,"span",21)(3,"span",24),t.j41(4,"span",62),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.removeGlobalAchievement(n))}),t.nrm(5,"img",63),t.k0s()()}if(2&i){const e=r.$implicit;t.R7$(),t.vxM(e.split(":").length>0&&"1"!=e.split(":")[1]?1:-1),t.R7$(),t.Y8G("ghs-label","data.globalAchievements."+e.split(":")[0])}}function gV(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",199)(1,"label"),t.nrm(2,"span",21),t.EFF(3,":"),t.k0s(),t.j41(4,"div",32)(5,"div",33),t.Z7z(6,lV,6,2,"div",34,t.fX1),t.k0s(),t.j41(8,"div",35)(9,"input",125,7),t.bIt("keyup.enter",function(){t.eBV(e);const n=t.sdS(10),o=t.XpG(2);return t.Njj(o.addGlobalAchievement(n))}),t.k0s(),t.j41(11,"a",37),t.bIt("click",function(){t.eBV(e);const n=t.sdS(10),o=t.XpG(2);return t.Njj(o.addGlobalAchievement(n))}),t.nrm(12,"img",38),t.k0s()()()()}if(2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","party.campaign.achievements"),t.R7$(4),t.Dyx(e.globalAchievementsList),t.R7$(3),t.Y8G("autocomplete",e.globalAchievements)("emptyLabel","party.addGlobalAchievement.empty")("ghs-label","party.addGlobalAchievement")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","party.addGlobalAchievement")("ghs-label-attribute","title")}}function dV(i,r){if(1&i&&(t.j41(0,"option",192),t.nrm(1,"span",21),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("value",e)("selected",e==a.itemEdition),t.R7$(),t.Y8G("ghs-label","data.edition."+e)}}function hV(i,r){if(1&i&&(t.j41(0,"span",273),t.EFF(1,"["),t.nrm(2,"span",21),t.EFF(3,"]"),t.k0s()),2&i){const e=t.XpG(2).$implicit;t.R7$(2),t.Y8G("ghs-label","data.edition."+e.edition)}}function _V(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",264),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(2);return t.Njj(o.openItem(n))}),t.nrm(1,"img",265),t.j41(2,"span",266),t.EFF(3),t.k0s()(),t.j41(4,"span",267),t.EFF(5,":"),t.k0s(),t.j41(6,"span",268),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(2);return t.Njj(o.removeItem(n))}),t.nrm(7,"img",269)(8,"img",270),t.k0s(),t.j41(9,"span",271),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(2);return t.Njj(o.openItem(n))}),t.k0s(),t.j41(10,"span",272),t.bIt("click",function(){t.eBV(e);const n=t.XpG(),o=n.$implicit,g=n.$index,_=t.XpG(2);return t.Njj(_.incItemCount(o,_.itemIdentifier[g]))}),t.EFF(11),t.k0s(),t.nVh(12,hV,4,1,"span",273)}if(2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG(2);t.R7$(),t.Y8G("src",a.slot?"./assets/images/items/slots/"+a.slot+".svg":"",t.B4B),t.R7$(2),t.JRh(a.id),t.R7$(6),t.Y8G("ghs-label","data.items."+a.edition+"-"+a.id),t.R7$(2),t.SpI(" ",o.itemIdentifier[n].count>0?o.itemIdentifier[n].count:"-"," "),t.R7$(),t.vxM(o.partyEdition&&o.itemEdition?-1:12)}}function mV(i,r){if(1&i&&(t.j41(0,"label",207),t.nVh(1,_V,13,5),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Er,!a.partyEdition||!a.itemEdition)),t.R7$(),t.vxM(e?1:-1)}}function pV(i,r){if(1&i&&(t.j41(0,"option",192),t.nrm(1,"span",21),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("value",e)("selected",e==a.treasureEdition),t.R7$(),t.Y8G("ghs-label","data.edition."+e)}}function uV(i,r){if(1&i&&(t.j41(0,"span",61),t.EFF(1,"["),t.nrm(2,"span",21),t.EFF(3,"]"),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(2),t.Y8G("ghs-label","data.edition."+e.edition)}}function fV(i,r){if(1&i){const e=t.RV6();t.j41(0,"label",213)(1,"span",274),t.nrm(2,"img",210),t.j41(3,"span",266),t.EFF(4),t.k0s()(),t.j41(5,"span",267),t.EFF(6,":"),t.k0s(),t.j41(7,"span",268),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.removeTreasure(n))}),t.nrm(8,"img",269)(9,"img",270),t.k0s(),t.j41(10,"span",61),t.nrm(11,"ghs-treasure-label",275),t.k0s(),t.nrm(12,"span"),t.nVh(13,uV,4,1,"span",61),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ngClass",t.eq3(5,Er,!a.treasureEdition)),t.R7$(4),t.JRh(e.name),t.R7$(7),t.Y8G("edition",e.edition)("index",+e.name-1),t.R7$(2),t.vxM(a.treasureEdition?-1:13)}}function CV(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",279),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(4);return t.Njj(o.openCharacterSheet(n))})("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(4);return t.Njj(o.replayCharacter(n))}),t.nrm(1,"img",75),t.k0s()}if(2&i){const e=r.$implicit;t.Y8G("ghs-tooltip","character.replay.hint"),t.R7$(),t.Y8G("src","./assets/images/character/icons/"+e.edition+"-"+e.name+".svg",t.B4B)}}function MV(i,r){if(1&i&&(t.j41(0,"div",277),t.Z7z(1,CV,2,2,"a",278,t.fX1),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.R7$(),t.Dyx(a.availableCharacters[e])}}function vV(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",216)(1,"span",266),t.EFF(2),t.k0s(),t.j41(3,"input",276),t.bIt("change",function(n){const o=t.eBV(e).$implicit,g=t.XpG(2);return t.Njj(g.changePlayer(n,o))}),t.k0s(),t.nVh(4,MV,3,0,"div",277),t.j41(5,"a",62),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.removePlayer(n))}),t.nrm(6,"img",148),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(2),t.SpI("#",e+1),t.R7$(),t.Y8G("value",a.party.players[e]),t.R7$(),t.vxM(a.availableCharacters[e]?4:-1)}}function OV(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",218)(1,"a",260),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.setupEvents())}),t.nrm(2,"span",21),t.k0s()()}2&i&&(t.R7$(2),t.Y8G("ghs-label","game.events.deck.setup"))}function PV(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",219)(1,"a",260),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.battleGoalSetup())}),t.nrm(2,"span",21),t.k0s()()}2&i&&(t.R7$(2),t.Y8G("ghs-label","game.battleGoals.setup"))}function bV(i,r){1&i&&(t.j41(0,"div",175)(1,"label"),t.nrm(2,"span",21),t.EFF(3,":"),t.k0s()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","party.campaign.retirements"))}function kV(i,r){1&i&&(t.j41(0,"span"),t.nrm(1,"span",21),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","party.campaign.retirements.masteries"))}function yV(i,r){1&i&&(t.j41(0,"span"),t.nrm(1,"img",245),t.k0s())}function xV(i,r){if(1&i&&t.Z7z(0,yV,2,0,"span",null,t.fX1),2&i){const e=t.XpG(2).$implicit;t.Dyx(e.progress.masteries)}}function EV(i,r){if(1&i&&(t.j41(0,"span"),t.nVh(1,xV,2,0),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.vxM(e.progress?1:-1)}}function wV(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",138)(1,"span"),t.EFF(2," #"),t.j41(3,"input",282),t.bIt("change",function(n){const o=t.eBV(e).$implicit,g=t.XpG(3);return t.Njj(g.setPlayerNumber(o,n))})("keyup",function(n){const o=t.eBV(e).$implicit,g=t.XpG(3);return t.Njj(g.setPlayerNumber(o,n))}),t.k0s()(),t.j41(4,"span",283),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.openCharacterSheet(n))})("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.openCharacterSheet(n,!1))}),t.EFF(5),t.k0s(),t.j41(6,"span",284),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.openCharacterSheet(n))})("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.openCharacterSheet(n,!1))}),t.k0s(),t.j41(7,"span"),t.EFF(8),t.k0s(),t.j41(9,"span"),t.EFF(10),t.k0s(),t.nVh(11,EV,2,1,"span"),t.j41(12,"span",285),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.reactivateCharacter(n))}),t.nrm(13,"img",286),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG(3);t.R7$(3),t.Y8G("value",e.number),t.R7$(2),t.JRh(e.title),t.R7$(),t.Y8G("ghs-label","data.character."+e.edition+"."+e.name),t.R7$(2),t.JRh(e.level),t.R7$(2),t.JRh(a.characterPerks(e)||"/"),t.R7$(),t.vxM(a.fhSheet?11:-1),t.R7$(),t.Y8G("ghs-label","party.campaign.retirements.reactivate")("ghs-label-attribute","title")}}function RV(i,r){if(1&i&&(t.j41(0,"div",220)(1,"div",280)(2,"div",281)(3,"span"),t.nrm(4,"span",21),t.k0s(),t.j41(5,"span"),t.nrm(6,"span",21),t.k0s(),t.j41(7,"span"),t.nrm(8,"span",21),t.k0s(),t.j41(9,"span"),t.nrm(10,"span",21),t.k0s(),t.j41(11,"span"),t.nrm(12,"span",21),t.k0s(),t.nVh(13,kV,2,1,"span"),t.nrm(14,"span"),t.k0s(),t.Z7z(15,wV,14,8,"div",138,t.fX1),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(7,Pr,e.fhSheet)),t.R7$(3),t.Y8G("ghs-label","party.campaign.retirements.player"),t.R7$(2),t.Y8G("ghs-label","party.campaign.retirements.character"),t.R7$(2),t.Y8G("ghs-label","party.campaign.retirements.class"),t.R7$(2),t.Y8G("ghs-label","party.campaign.retirements.level"),t.R7$(2),t.Y8G("ghs-label","party.campaign.retirements.perks"),t.R7$(),t.vxM(e.fhSheet?13:-1),t.R7$(2),t.Dyx(e.party.retirements)}}function jV(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",15)(1,"div",18)(2,"span",19),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.campaign=!1)}),t.nrm(3,"img",20)(4,"span",21),t.k0s(),t.j41(5,"label",22),t.nrm(6,"span",21),t.k0s(),t.j41(7,"span",190),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleCampaignMode())}),t.nrm(8,"span",178)(9,"span",21),t.k0s(),t.nVh(10,CA,3,2,"span",25),t.k0s(),t.j41(11,"div",18)(12,"label",22),t.nrm(13,"span",21),t.k0s(),t.j41(14,"select",191),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.changeEdition(n))}),t.j41(15,"option",192),t.nrm(16,"span",21),t.k0s(),t.Z7z(17,MA,2,3,"option",193,t.fX1),t.k0s()(),t.j41(19,"div",194)(20,"div",195)(21,"span"),t.nrm(22,"span",21),t.k0s(),t.j41(23,"span"),t.nrm(24,"span",21),t.k0s(),t.j41(25,"span"),t.nrm(26,"span",21),t.k0s(),t.j41(27,"span"),t.nrm(28,"span",21),t.k0s()(),t.Z7z(29,IA,5,3,null,null,t.fX1),t.k0s(),t.nVh(31,KA,4,6,"div",194),t.nVh(32,eV,13,14,"div",196),t.nVh(33,iV,8,5,"div",197),t.nVh(34,rV,5,5,"div",198),t.j41(35,"div",175),t.nVh(36,gV,13,7,"div",199),t.k0s(),t.j41(37,"div",175)(38,"div",200)(39,"label"),t.nrm(40,"span",21),t.EFF(41,":"),t.k0s(),t.j41(42,"div",201)(43,"input",202,2),t.bIt("focus",function(){t.eBV(e);const n=t.sdS(44);return t.Njj(n.select())})("keyup",function(){t.eBV(e);const n=t.sdS(44);return n.classList.remove("error"),t.Njj(n.classList.remove("warning"))})("keyup.enter",function(){t.eBV(e);const n=t.sdS(44),o=t.XpG();return t.Njj(o.addItem(n,o.itemEdition||""))}),t.k0s(),t.j41(45,"a",203),t.bIt("click",function(){t.eBV(e);const n=t.sdS(44),o=t.XpG();return t.Njj(o.addItem(n,o.itemEdition||""))}),t.nrm(46,"img",38),t.k0s(),t.j41(47,"select",204),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.itemEdition,n)||(o.itemEdition=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.update())}),t.j41(48,"option",205),t.nrm(49,"span",21),t.k0s(),t.Z7z(50,dV,2,3,"option",192,t.fX1),t.k0s()(),t.j41(52,"div",206),t.Z7z(53,mV,2,4,"label",207,K6),t.k0s()()(),t.j41(55,"div",175)(56,"div",208)(57,"label",209),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.treasuresDialog())}),t.nrm(58,"img",210)(59,"span",21),t.EFF(60,":"),t.k0s(),t.j41(61,"div",211)(62,"input",202,3),t.bIt("focus",function(){t.eBV(e);const n=t.sdS(63);return t.Njj(n.select())})("keyup",function(){t.eBV(e);const n=t.sdS(63);return n.classList.remove("error"),t.Njj(n.classList.remove("warning"))})("keyup.enter",function(){t.eBV(e);const n=t.sdS(63),o=t.XpG();return t.Njj(o.addTreasure(n,o.treasureEdition))}),t.k0s(),t.j41(64,"a",203),t.bIt("click",function(){t.eBV(e);const n=t.sdS(63),o=t.XpG();return t.Njj(o.addTreasure(n,o.treasureEdition))}),t.nrm(65,"img",38),t.k0s(),t.j41(66,"select",204),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.treasureEdition,n)||(o.treasureEdition=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.update())}),t.j41(67,"option",205),t.nrm(68,"span",21),t.k0s(),t.Z7z(69,pV,2,3,"option",192,t.fX1),t.k0s()(),t.j41(71,"div",212),t.Z7z(72,fV,14,7,"label",213,t.fX1),t.k0s()()(),t.j41(74,"div",16)(75,"div",214)(76,"div",175)(77,"label"),t.nrm(78,"span",21),t.EFF(79,":"),t.k0s()(),t.j41(80,"div",215),t.Z7z(81,vV,7,3,"div",216,t.fX1),t.nI1(83,"ghsRange"),t.j41(84,"a",217),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.party.players[n.party.players.length]="")}),t.nrm(85,"img",38)(86,"span",21),t.k0s()()(),t.j41(87,"div",214),t.nVh(88,OV,3,1,"div",218),t.nVh(89,PV,3,1,"div",219),t.k0s()(),t.nVh(90,bV,4,1,"div",175),t.nVh(91,RV,17,9,"div",220),t.j41(92,"div",221),t.nrm(93,"span",222),t.nI1(94,"ghsDurationLabel"),t.nrm(95,"span",24),t.j41(96,"a",223),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.statistics())}),t.nrm(97,"img",224),t.k0s()()()}if(2&i){const e=t.sdS(44),a=t.sdS(63),n=t.XpG();t.R7$(4),t.Y8G("ghs-label","party.sheet"),t.R7$(2),t.Y8G("ghs-label","party.campaign"),t.R7$(2),t.Y8G("ngClass",t.eq3(44,Qt,n.party.campaignMode)),t.R7$(),t.Y8G("ghs-label","party.campaignMode"),t.R7$(),t.vxM(n.disableShortcuts?-1:10),t.R7$(3),t.Y8G("ghs-label","party.campaign.scenarios"),t.R7$(2),t.Y8G("value",void 0)("selected",!n.partyEdition),t.R7$(),t.Y8G("ghs-label","edition.all"),t.R7$(),t.Dyx(n.gameManager.editions()),t.R7$(2),t.Y8G("ngClass",t.eq3(46,ti,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.party)),t.R7$(3),t.Y8G("ghs-label","party.campaign.scenarios.index"),t.R7$(2),t.Y8G("ghs-label","party.campaign.scenarios.group"),t.R7$(2),t.Y8G("ghs-label","party.campaign.scenarios.name"),t.R7$(2),t.Y8G("ghs-label","party.campaign.scenarios.finished"),t.R7$(),t.Dyx(n.scenarioEditions),t.R7$(2),t.vxM(n.manualConclusions?31:-1),t.R7$(),t.vxM(n.gameManager.fhRules()||n.gameManager.editionRules("gh")?32:-1),t.R7$(),t.vxM(!n.fhSheet&&n.gameManager.editionRules("gh")?33:-1),t.R7$(),t.vxM(!n.fhSheet&&n.party.donations>9&&n.gameManager.editionRules("gh")?34:-1),t.R7$(2),t.vxM(n.gameManager.editionRules("gh")?36:-1),t.R7$(4),t.Y8G("ghs-label","party.campaign.items"),t.R7$(5),t.Y8G("ngClass",t.eq3(48,Ii,!n.itemEdition||!e.value||+e.value<1||n.hasItem(e.value,n.itemEdition))),t.R7$(2),t.R50("ngModel",n.itemEdition),t.R7$(),t.Y8G("selected",!n.itemEdition),t.R7$(),t.Y8G("ghs-label","edition.all"),t.R7$(),t.Dyx(n.gameManager.editions()),t.R7$(3),t.Dyx(n.items),t.R7$(6),t.Y8G("ghs-label","party.campaign.treasures"),t.R7$(5),t.Y8G("ngClass",t.eq3(50,Ii,!n.treasureEdition||!a.value||+a.value<1||n.hasTreasure(a.value,n.treasureEdition))),t.R7$(2),t.R50("ngModel",n.treasureEdition),t.R7$(),t.Y8G("selected",!n.treasureEdition),t.R7$(),t.Y8G("ghs-label","edition.all"),t.R7$(),t.Dyx(n.gameManager.editions()),t.R7$(3),t.Dyx(n.treasures()),t.R7$(6),t.Y8G("ghs-label","party.campaign.players"),t.R7$(3),t.Dyx(t.i5U(83,38,t.lJ4(52,Xt),n.party.players.length)),t.R7$(5),t.Y8G("ghs-label","party.campaign.players.add"),t.R7$(2),t.vxM(n.settingsManager.settings.events?88:-1),t.R7$(),t.vxM(n.settingsManager.settings.battleGoals?89:-1),t.R7$(),t.vxM(n.party.retirements&&n.party.retirements.length>0?90:-1),t.R7$(),t.vxM(n.party.retirements&&n.party.retirements.length>0?91:-1),t.R7$(2),t.Y8G("ghs-label","party.campaign.totalTime")("ghs-label-args",t.eq3(53,N6,t.i5U(94,41,n.gameManager.game.totalSeconds,!0))),t.R7$(3),t.Y8G("ghs-tooltip","scenario.stats")}}let Ue=(()=>{class i{data;dialogRef;dialog;gameManager=s.E;settingsManager=m.f;ghsInputFullScreenCheck=V.It;party;prosperitySteps=on.yF;prosperityHighlightSteps=on.yF;prosperitySections={};imbuementSections={};factions=[];reputationSections=[];reputationSectionsMapped={};priceModifier=0;moraleDefense=0;campaign=!1;partyEdition="";scenarioEditions=[];scenarios={};conclusions={};characters=[];worldMap=!1;items=[];itemIdentifier=[];itemEdition="";treasureEdition="";partyAchievements=[];globalAchievements=[];campaignStickers=[];manualConclusions=!1;partyAchievementsList=[];globalAchievementsList=[];availableCharacters=[];fhSheet=!1;gh2eSheet=!1;csSheet=!1;disableShortcuts=!1;LootType=ot.r6;townGuardDeck;calendarSheet=0;summer=!1;lowMoraleSolved=0;highMoraleSolved=0;itemIndex;treasureIndex;constructor(e,a,n){this.data=e,this.dialogRef=a,this.dialog=n,this.campaign=e&&e.campaign,this.party=s.E.game.party,this.disableShortcuts=e&&e.disableShortcuts,s.E.game.edition&&!this.party.edition&&(this.party.edition=s.E.game.edition),this.party.edition&&(this.partyEdition=this.party.edition),this.party.casualScenarios=this.party.casualScenarios||[],this.party.scenarios=this.party.scenarios||[],this.party.availableCharacters=this.party.availableCharacters||[],this.campaign||e&&e.partySheet||"jotl"!=this.partyEdition||(this.campaign=!0),s.E.game.conditions&&!this.party.conditions&&(this.party.conditions=s.E.game.conditions),s.E.game.battleGoalEditions&&!this.party.battleGoalEditions&&(this.party.battleGoalEditions=s.E.game.battleGoalEditions),s.E.game.filteredBattleGoals&&!this.party.filteredBattleGoals&&(this.party.filteredBattleGoals=s.E.game.filteredBattleGoals),s.E.game.unlockedCharacters&&!this.party.unlockedCharacters&&(this.party.unlockedCharacters=s.E.game.unlockedCharacters),s.E.game.lootDeckEnhancements&&!this.party.lootDeckEnhancements&&(this.party.lootDeckEnhancements=s.E.game.lootDeckEnhancements),s.E.game.lootDeckFixed&&!this.party.lootDeckFixed&&(this.party.lootDeckFixed=s.E.game.lootDeckFixed),s.E.game.lootDeckSections&&!this.party.lootDeckSections&&(this.party.lootDeckSections=s.E.game.lootDeckSections),s.E.game.figures.filter(o=>o instanceof q.K).map(o=>o).forEach(o=>{this.party.players[o.number-1]||(this.party.players[o.number-1]="")}),this.party.availableCharacters.forEach(o=>{this.party.players[o.number-1]||(this.party.players[o.number-1]="")}),this.itemEdition=this.partyEdition,this.treasureEdition=this.partyEdition}ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:e=>{this.party!=s.E.game.party?(this.party=s.E.game.party,this.update()):this.updateAlways(),e&&this.townGuardDeck&&this.party.townGuardDeck&&s.E.attackModifierManager.fromModel(this.townGuardDeck,this.party.townGuardDeck)}}),this.update(),this.dialogRef.closed.subscribe({next:()=>{s.E.trialsManager.applyTrialCards()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}keyboardShortcuts(e){m.f.settings.keyboardShortcuts&&!this.disableShortcuts&&(!window.document.activeElement||"INPUT"!=window.document.activeElement.tagName&&"SELECT"!=window.document.activeElement.tagName&&"TEXTAREA"!=window.document.activeElement.tagName)&&(e.ctrlKey||e.shiftKey||"g"!==e.key.toLowerCase()||!this.worldMap?!e.ctrlKey&&!e.shiftKey&&"c"===e.key.toLowerCase()&&s.E.game.edition&&(this.openFlowChart(),e.stopPropagation(),e.preventDefault()):(this.openMap(),e.stopPropagation(),e.preventDefault()))}close(){(0,V.co)(this.dialogRef)}toggleCampaignMode(){s.E.stateManager.before(this.party.campaignMode?"disablePartyCampaignMode":"enablePartyCampaignMode"),this.party.campaignMode=!this.party.campaignMode,s.E.stateManager.after(),this.update()}openMap(){this.worldMap&&(this.dialogRef.close(),this.dialog.open(Zn,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:this.partyEdition}))}openFlowChart(){this.dialogRef.close(),this.dialog.open(Qn,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:{edition:this.partyEdition}})}changePlayer(e,a){s.E.stateManager.before("setPlayer",e.target.value,a+1),this.party.players[a]=e.target.value,s.E.stateManager.after()}removePlayer(e){s.E.stateManager.before("removePlayer",this.party.players[e],e+1),this.party.players.splice(e,1),s.E.stateManager.after()}unlockScenario(e,a,n){let o=e.value,g=a.value||void 0;const _=s.E.scenarioManager.scenarioData(n,!0).find(y=>y.index==o&&y.group==g);e.classList.add("error"),a.classList.add("error"),_&&!this.scenarios[n].find(y=>y.edition==_.edition&&y.group==_.group&&y.index==_.index)&&!this.party.manualScenarios.some(y=>y.index==_.index&&y.edition==_.edition&&y.group==_.group&&!y.isCustom)&&(s.E.stateManager.before("addManualScenario",...s.E.scenarioManager.scenarioUndoArgs(new ht.Nz(_))),s.E.game.party.manualScenarios.push(new ht.Ag(_.index,_.edition,_.group)),s.E.stateManager.after(),e.classList.remove("error"),e.value="",a.classList.remove("error"),a.value="",this.update())}setName(e){this.party.name!=e.target.value&&(s.E.stateManager.before("setPartyName",e.target.value),this.party.name=e.target.value,s.E.stateManager.after())}setLocation(e){this.party.location!=e.target.value&&(s.E.stateManager.before("setPartyLocation",e.target.value),this.party.location=e.target.value,s.E.stateManager.after())}setNotes(e){this.party.notes!=e.target.value&&(s.E.stateManager.before("setPartyNotes",e.target.value),this.party.notes=e.target.value,s.E.stateManager.after())}addAchievement(e){if(e.value){let a=e.value;Object.keys(m.f.label.data.partyAchievements).forEach(n=>{m.f.label.data.partyAchievements[n].toLowerCase()==a.toLowerCase()&&(a=n)}),s.E.stateManager.before("addPartyAchievement",a),this.party.achievementsList.push(a),s.E.stateManager.after(),e.value="",this.update()}}removeAchievement(e){const a=e.split(":")[0];s.E.stateManager.before("removePartyAchievement",a),this.party.achievementsList.splice(this.party.achievementsList.lastIndexOf(a),1),s.E.stateManager.after(),this.update()}addGlobalAchievement(e){if(e.value){let a=e.value;Object.keys(m.f.label.data.globalAchievements).forEach(n=>{m.f.label.data.globalAchievements[n].toLowerCase()==a.toLowerCase()&&(a=n)}),s.E.stateManager.before("addGlobalAchievement",a),this.party.globalAchievementsList.push(a),s.E.stateManager.after(),e.value="",this.update()}}removeGlobalAchievement(e){const a=e.split(":")[0];s.E.stateManager.before("removeGlobalAchievement",a),this.party.globalAchievementsList.splice(this.party.globalAchievementsList.lastIndexOf(a),1),s.E.stateManager.after(),this.update()}setReputation(e){this.party.reputation!=e&&(s.E.stateManager.before("setPartyReputation",e),e>20?e=20:e<-20&&(e=-20),this.party.reputation=e,s.E.stateManager.after(),this.update())}setFactionReputation(e,a){this.party.factionReputation[e]!=a&&(s.E.stateManager.before("setFactionReputation",e,a),a>20?a=20:a<-10&&(a=-10),this.party.factionReputation[e]=a,s.E.stateManager.after(),this.reputationSections.filter(n=>n.faction==e&&a>=n.value&&!this.party.conclusions.find(o=>o.edition==s.E.game.edition&&o.index==n.section)&&(!n.requires||0==n.requires.length||n.requires.every(o=>this.party.scenarios.find(g=>g.edition==s.E.game.edition&&g.index==o)))).reverse().forEach(n=>{this.unlockConclusion(n.section,!0)}),this.update())}additionalReputation(e){return"special"!=e.faction||e.requires&&0!=e.requires.length?(this.party.factionReputation[e.faction]||0)>=e.value&&null!=e.requires&&e.requires.every(a=>null!=this.party.scenarios.find(n=>n.edition==s.E.currentEdition()&&n.index==a&&!n.group)):Object.keys(this.party.factionReputation).some(a=>(this.party.factionReputation[a]||0)>e.value)}unlockConclusion(e,a,n=!1){this.party.conclusions.find(o=>o.edition==s.E.game.edition&&o.index==e)?s.E.game.edition&&n?this.removeConclusion(e,s.E.game.edition):this.finishConclusion(e,!0):(a||n)&&this.finishConclusion(e,n)}characterPerks(e){return e.progress&&e.progress.perks&&e.progress.perks.length>0?e.progress.perks.reduce((a,n)=>a+n):0}setPlayerNumber(e,a){!isNaN(+a.target.value)&&e.number!=+a.target.value&&+a.target.value>0&&(s.E.stateManager.before("setPlayerNumber","data.character."+e.edition+"."+e.name,a.target.value),e.number=+a.target.value,s.E.stateManager.after())}reactivateCharacter(e){if(!s.E.game.figures.find(a=>a instanceof q.K&&a.name==e.name&&a.edition==e.edition)&&!s.E.game.party.availableCharacters.find(a=>a.name==e.name&&a.edition==e.edition)){s.E.stateManager.before("unsetRetired","data.character."+e.edition+"."+e.name);let a=new q.K(s.E.getCharacterData(e.name,e.edition),e.level);a.fromModel(e),a.progress.retired=!1,a.progress.personalQuestProgress=[],s.E.game.figures.push(a),this.party.retirements.splice(this.party.retirements.indexOf(e),1),s.E.stateManager.after()}}replayCharacter(e){let a=new q.K(s.E.getCharacterData(e.name,e.edition),e.level);a.fromModel(e),s.E.stateManager.before("characterReplay",s.E.characterManager.characterName(a,!0,!0),this.party.players[e.number-1]?this.party.players[e.number-1]:""+e.number),s.E.game.party.availableCharacters=s.E.game.party.availableCharacters.filter(n=>n.name!=a.name||n.edition!=a.edition||n.number!=a.number),s.E.game.figures.forEach(n=>{n instanceof q.K&&n.number==a.number&&(s.E.game.party.availableCharacters.push(n.toModel()),s.E.characterManager.removeCharacter(n))}),s.E.game.figures.push(a),s.E.stateManager.after(),this.update()}openCharacterSheet(e,a=!0){let n=new q.K(s.E.getCharacterData(e.name,e.edition),e.level);n.fromModel(e),this.dialog.open(Re,{panelClass:["dialog-invert"],data:{character:n,viewOnly:a}}).closed.subscribe({next:()=>{if(e.progress&&JSON.stringify(e.progress.enhancements)!=JSON.stringify(n.progress.enhancements)){s.E.stateManager.before("changeRetiredCharacterEnhancements",s.E.characterManager.characterName(n,!0)),e.progress.enhancements=n.progress.enhancements;const o=s.E.game.figures.find(g=>g instanceof q.K&&g.edition==n.edition&&g.name==n.name);o&&s.E.characterManager.previousEnhancements(o,s.E.enhancementsManager.temporary),s.E.stateManager.after()}}})}removeParty(){s.E.game.parties.length>1&&(s.E.stateManager.before("removeParty",this.party.name||"%party% "+this.party.id),s.E.game.parties.splice(s.E.game.parties.indexOf(this.party),1),this.changeParty(s.E.game.parties[0]),s.E.stateManager.after())}newParty(){let e=new $i.r;s.E.stateManager.before("addParty",e.name||"%party% "+e.id),this.addParty(e),s.E.stateManager.after()}addParty(e){let a=0;for(;s.E.game.parties.some(n=>n.id==a);)a++;e.id=a,s.E.game.parties.push(e),this.changeParty(e)}selectParty(e){const a=s.E.game.parties.find(n=>n.id==e.target.value);a&&(s.E.stateManager.before("changeParty",a.name||"%party% "+a.id),this.changeParty(a),s.E.stateManager.after())}changeParty(e){s.E.changeParty(e),this.update()}setDonations(e){this.party.donations==e&&e--,e<0&&(e=0),s.E.stateManager.before("setPartyDonations",""+e),this.party.donations=e,e<10&&(this.party.envelopeB=!1),s.E.stateManager.after()}toggleEnvelopeB(){s.E.stateManager.before(this.party.envelopeB?"disableEnvelopeB":"enableEnvelopeB"),this.party.envelopeB=!this.party.envelopeB,this.party.donations>10&&(this.party.donations=10),s.E.stateManager.after()}setProsperity(e){e-=s.E.prosperityTicks()-this.party.prosperity,this.party.prosperity==e&&e--,e>this.prosperitySteps[this.prosperitySteps.length-1]+1?e=this.prosperitySteps[this.prosperitySteps.length-1]+1:e<0&&(e=0),s.E.stateManager.before("setPartyProsperity",""+e),this.party.prosperity=e,s.E.stateManager.after(),Object.keys(this.prosperitySections).reverse().forEach(a=>{e>=+a&&!this.party.conclusions.find(n=>n.edition==s.E.game.edition&&n.index==this.prosperitySections[+a])&&this.unlockConclusion(this.prosperitySections[+a],!0)})}setImbuement(e){this.party.imbuement==e&&e--,e<0&&(e=0),s.E.stateManager.before("setPartyImbuement",""+e),this.party.imbuement=e,s.E.stateManager.after(),Object.keys(this.imbuementSections).reverse().forEach(a=>{e>=+a&&!this.party.conclusions.find(n=>n.edition==s.E.game.edition&&n.index==this.imbuementSections[+a])&&this.unlockConclusion(this.imbuementSections[+a],!0)})}exportParty(){const e=document.createElement("a");e.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(this.party))),e.setAttribute("download",(this.party.name?this.party.name+"_":"")+"campaign.json"),document.body.appendChild(e),e.click(),document.body.removeChild(e)}importParty(e){const a=e.target.parentElement;a.classList.remove("error");try{const n=new FileReader;n.addEventListener("load",o=>{const g=Object.assign(new $i.r,JSON.parse(o.target.result));g?(s.E.stateManager.before("importParty"),g.id==this.party.id&&g.name&&g.name==this.party.name?s.E.game.party=g:this.addParty(g),this.party=s.E.game.party,s.E.stateManager.after()):a.classList.add("error")}),n.readAsText(e.target.files[0])}catch(n){console.warn(n),a.classList.add("error")}}countFinished(e,a=!1){return(a?this.party.casualScenarios:this.party.scenarios).filter(n=>e.index==n.index&&e.edition==n.edition&&e.group==n.group).length}hasRandomItemLooted(e){return null!=s.E.game.party.randomItemLooted.find(a=>a.edition==e.edition&&a.group==e.group&&a.index==e.index)}isManual(e){return null!=this.party.manualScenarios.find(a=>e.index==a.index&&e.edition==a.edition&&e.group==a.group)}addSuccess(e,a=!1){if(!s.E.scenarioManager.isBlocked(e)&&!s.E.scenarioManager.isLocked(e)||a){const n=s.E.sectionData(e.edition).filter(o=>o.edition==e.edition&&o.parent==e.index&&o.group==e.group&&o.conclusion&&0==s.E.scenarioManager.getRequirements(o).length);0==n.length?this.addSuccessIntern(e):this.dialog.open(Se,{panelClass:["dialog"],data:{conclusions:n,parent:e}}).closed.subscribe({next:o=>{o&&this.addSuccessIntern(e,o)}})}}addSuccessIntern(e,a=void 0){s.E.stateManager.before("finishScenario.success",...s.E.scenarioManager.scenarioUndoArgs(new ht.Nz(e))),s.E.scenarioManager.finishScenario(new ht.Nz(e),!0,a,!1,!1,!1,s.E.game.party.campaignMode&&0==this.countFinished(e),!0),s.E.stateManager.after(),this.update()}removeSuccess(e,a=!1){const n=a?this.party.casualScenarios:this.party.scenarios,o=n.find(g=>g.index==e.index&&g.edition==e.edition&&g.group==e.group);o&&(s.E.stateManager.before("finishScenario.remove"+(a?"Casual":""),...s.E.scenarioManager.scenarioUndoArgs(new ht.Nz(e))),n.splice(n.indexOf(o),1),s.E.stateManager.after()),this.update()}removeManual(e){const a=this.party.manualScenarios.find(n=>n.index==e.index&&n.edition==e.edition&&n.group==e.group);a&&(s.E.stateManager.before("removeManualScenario",...s.E.scenarioManager.scenarioUndoArgs(new ht.Nz(e))),this.party.manualScenarios.splice(this.party.manualScenarios.indexOf(a),1),s.E.stateManager.after()),this.update()}scenarioRewards(e,a=!1){const n=this.party.conclusions.filter(o=>o.edition==e.edition).map(o=>s.E.sectionData(e.edition).find(g=>g.index==o.index&&g.edition==o.edition&&g.group==o.group)).find(o=>o.parent==e.index&&o.group==e.group);this.dialog.open(Yt,{panelClass:["dialog"],data:{scenario:new ht.Nz(e),conclusion:n,success:!0,rewardsOnly:!0,conclusionOnly:a}})}scenarioRequirements(e){s.E.scenarioManager.isLocked(e)&&this.dialog.open(Mi,{panelClass:["dialog"],data:{scenarioData:e,hideMenu:!0}})}maxScenario(e){return Math.max(...e.map(a=>a.index.length))}changeEdition(e){this.partyEdition="undefined"!=e.target.value&&e.target.value||"",this.itemEdition=this.partyEdition,this.treasureEdition=this.partyEdition,this.update()}toggleFhSheet(){this.fhSheet=!this.fhSheet,this.fhSheet&&(this.csSheet=!1,this.gh2eSheet=!1),this.update(!this.fhSheet&&!s.E.fhRules())}update(e=!0){e&&(this.fhSheet=s.E.fhRules(),this.csSheet=!this.fhSheet&&s.E.editionRules("cs"),this.gh2eSheet=!this.csSheet&&s.E.gh2eRules());const a=this.partyEdition&&[this.partyEdition]||s.E.editions();this.scenarioEditions=[],a.forEach(g=>{let _=s.E.scenarioManager.scenarioData(g).filter(y=>!y.hideIndex&&(!y.spoiler||-1!=m.f.settings.spoilers.indexOf(y.name)||y.solo&&-1!=s.E.game.unlockedCharacters.indexOf(y.edition+":"+y.solo))).map(y=>new ht.jW(y,this.countFinished(y)>0,s.E.scenarioManager.isBlocked(y),s.E.scenarioManager.isLocked(y)));_.length>0&&(this.scenarios[g]=_.sort((y,B)=>y.group&&!B.group?1:!y.group&&B.group?-1:y.group&&B.group&&y.group!=B.group?y.group<B.group?-1:1:isNaN(+y.index)||isNaN(+B.index)?y.index.toLowerCase()<B.index.toLowerCase()?-1:1:+y.index-+B.index),this.scenarioEditions.push(g)),this.conclusions[g]=this.party.conclusions.filter(y=>y.edition==g).map(y=>s.E.sectionData(g).find(B=>B.index==y.index&&B.edition==y.edition&&B.group==y.group)).filter(y=>y&&!this.party.scenarios.find(B=>B.edition==y.edition&&B.group==y.group&&B.index==y.parent))}),this.manualConclusions=this.partyEdition&&null!=s.E.sectionData(this.partyEdition).find(g=>g.conclusion&&!g.parent)||!1,this.priceModifier=this.party.reputation>=0?-1*Math.ceil((this.party.reputation-2)/4):-1*Math.floor((this.party.reputation+2)/4),this.moraleDefense=this.party.morale<3?-10:this.party.morale<5?-5:this.party.morale<8?0:this.party.morale<11?5:this.party.morale<14?10:15;const n=s.E.campaignData();if(n.townGuardPerks&&(this.townGuardDeck=s.E.attackModifierManager.buildTownGuardAttackModifierDeck(this.party,n),this.party.townGuardDeck?s.E.attackModifierManager.fromModel(this.townGuardDeck,this.party.townGuardDeck):(s.E.attackModifierManager.shuffleModifiers(this.townGuardDeck),this.townGuardDeck.active=!1,this.party.townGuardDeck=this.townGuardDeck.toModel())),n.factions&&(this.factions=n.factions,this.factions.forEach(g=>{this.party.factionReputation[g]||(this.party.factionReputation[g]=0)})),n.reputationSections&&(this.reputationSections=n.reputationSections,this.reputationSectionsMapped={},this.reputationSections.forEach(g=>{this.reputationSectionsMapped[g.faction]=this.reputationSectionsMapped[g.faction]||[],(!g.requires||0==g.requires.length)&&(this.reputationSectionsMapped[g.faction][30-g.value-10]=g)})),this.calendarSheet=Math.floor(Math.max(this.party.weeks-1,0)/80),this.characters=s.E.game.figures.filter(g=>g instanceof q.K&&Object.keys(g.progress.loot).some(_=>g.progress.loot[_])).map(g=>g),this.prosperitySteps=this.fhSheet?on.b9:this.gh2eSheet?on.fH:on.yF,this.fhSheet&&(this.prosperityHighlightSteps=[],this.prosperitySteps.forEach((g,_)=>{const y=_>0?this.prosperitySteps[_-1]+1:0;for(let B=y;B<g;B++)(B-y)%5==4&&this.prosperityHighlightSteps.push(B)})),this.gh2eSheet){this.prosperityHighlightSteps=[];for(let g=0;g<=Math.max(...this.prosperitySteps);g++)g%5==3&&this.prosperityHighlightSteps.push(g)}else this.prosperityHighlightSteps=this.prosperitySteps;n&&n.prosperitySections&&(this.prosperitySections=n.prosperitySections),n&&n.imbuementSections&&(this.imbuementSections=n.imbuementSections),this.partyAchievements=[],this.globalAchievements=[],this.campaignStickers=[],this.worldMap=!1;const o=s.E.editionData.find(g=>this.partyEdition&&g.edition==this.partyEdition);if(o&&((o.worldMap||o.extendWorldMap)&&(this.worldMap=!0),this.updateAchievements(o),!o.additional&&o.extensions&&o.extensions.forEach(g=>{const _=s.E.editionData.find(y=>y.edition==g);_&&this.updateAchievements(_)})),this.partyAchievementsList=this.party.achievementsList.map((g,_,y)=>g+":"+y.filter(B=>B==g).length).filter((g,_,y)=>y.indexOf(g)==_),this.globalAchievementsList=this.party.globalAchievementsList.map((g,_,y)=>g+":"+y.filter(B=>B==g).length).filter((g,_,y)=>y.indexOf(g)==_),this.itemIdentifier=this.party.unlockedItems.filter(g=>!this.itemEdition||g.edition==this.itemEdition).sort((g,_)=>this.partyEdition||g.edition==_.edition?+g.name-+_.name:s.E.editions().indexOf(g.edition)-s.E.editions().indexOf(_.edition)),this.items=this.itemIdentifier.map(g=>s.E.itemManager.getItem(g.name,g.edition,!0)),this.summer=Math.max(this.party.weeks-1,0)%20<10,n){if(n.lowMorale&&n.lowMorale.length)for(this.lowMoraleSolved=0;this.isConclusion(n.lowMorale[this.lowMoraleSolved])&&this.lowMoraleSolved<n.lowMorale.length;)this.lowMoraleSolved++;if(n.highMorale&&n.highMorale.length)for(this.highMoraleSolved=0;this.isConclusion(n.highMorale[this.highMoraleSolved])&&this.highMoraleSolved<n.highMorale.length;)this.highMoraleSolved++}this.updateAlways()}updateAchievements(e){e.label&&e.label[m.f.settings.locale]&&e.label[m.f.settings.locale].partyAchievements?this.partyAchievements.push(...Object.keys(e.label[m.f.settings.locale].partyAchievements).map(a=>new Kn(e.label[m.f.settings.locale].partyAchievements[a],a,-1!=this.party.achievementsList.indexOf(a)))):e.label&&e.label.en&&e.label.en.partyAchievements&&this.partyAchievements.push(...Object.keys(e.label.en.partyAchievements).map(a=>new Kn(e.label.en.partyAchievements[a],a,-1!=this.party.achievementsList.indexOf(a)))),e.label&&e.label[m.f.settings.locale]&&e.label[m.f.settings.locale].globalAchievements&&this.globalAchievements.push(...Object.keys(e.label[m.f.settings.locale].globalAchievements).map(a=>new Kn(e.label[m.f.settings.locale].globalAchievements[a],a,-1!=this.party.globalAchievementsList.indexOf(a)))),e.label&&e.label.en&&e.label.en.globalAchievements&&Object.keys(e.label.en.globalAchievements).map(a=>new Kn(e.label.en.globalAchievements[a],a,-1!=this.party.globalAchievementsList.indexOf(a))).forEach(a=>{this.globalAchievements.every(n=>a.value!=n.value)&&this.globalAchievements.push(a)}),e.campaign&&e.campaign.campaignStickers&&this.campaignStickers.push(...e.campaign.campaignStickers.map(a=>(a=a.split(":")[0],new Kn(m.f.getLabel("data.campaignSticker."+a),a,-1!=this.party.campaignStickers.indexOf(a)))))}updateAlways(){this.availableCharacters=[],this.party.availableCharacters.forEach(e=>{this.availableCharacters[e.number-1]=this.availableCharacters[e.number-1]||[],this.availableCharacters[e.number-1].push(e)})}characterIcon(e){return s.E.characterManager.characterIcon(e)}addItem(e,a){const n=e.value;if(n&&a)if(this.hasItem(n,a))e.classList.add("warning");else{e.classList.add("error");const o=s.E.itemManager.getItems(a,!0).find(g=>n==""+g.id);o&&(s.E.stateManager.before("addUnlockedItem",a,n,o.name),this.party.unlockedItems=this.party.unlockedItems||[],this.party.unlockedItems.push(new vt.VP(n,a)),this.itemIndex.nativeElement.value="",e.classList.remove("error"),s.E.stateManager.after(),this.update())}}hasItem(e,a){return this.party.unlockedItems&&this.party.unlockedItems.some(n=>n.name==e&&n.edition==a)}removeItem(e){const a=this.party.unlockedItems.find(n=>n.name==""+e.id&&n.edition==e.edition);a&&(s.E.stateManager.before("removeUnlockedItem",e.edition,e.id,e.name),this.party.unlockedItems.splice(this.party.unlockedItems.indexOf(a),1),s.E.stateManager.after(),this.update())}openItem(e){this.dialog.open(Me,{panelClass:["fullscreen-panel"],disableClose:!0,data:{item:e}})}incItemCount(e,a){s.E.stateManager.before("updateUnlockedItemCount",e.edition,e.id,e.name),a.count<0?a.count=1:(a.count+=1,a.count>=e.count&&(a.count=-1)),s.E.stateManager.after()}treasuresDialog(){this.dialog.open(pr,{panelClass:["dialog"],data:{party:this.party,edition:this.treasureEdition}})}treasures(){return this.party.treasures.filter(e=>!this.treasureEdition||e.edition==this.treasureEdition).sort((e,a)=>this.treasureEdition||e.edition==a.edition?+e.name-+a.name:s.E.editions().indexOf(e.edition)-s.E.editions().indexOf(a.edition))}addTreasure(e,a){const n=e.value;if(n&&!isNaN(+n)&&a)if(this.hasTreasure(n,a))e.classList.add("warning");else{e.classList.add("error");const o=s.E.editionData.find(g=>g.edition==a);if(o&&o.treasures){const g=+n-(o.treasureOffset||0)-1;g>=0&&g<o.treasures.length&&(s.E.stateManager.before("addTreasure",a,n),this.party.treasures=this.party.treasures||[],this.party.treasures.push(new vt.gw(n,a)),this.treasureIndex.nativeElement.value="",e.classList.remove("error"),s.E.stateManager.after())}}}hasTreasure(e,a){return this.party.treasures&&this.party.treasures.some(n=>n.name==e&&n.edition==a)}removeTreasure(e){s.E.stateManager.before("removeTreasure",e.edition,e.name),this.party.treasures.splice(this.party.treasures.indexOf(e),1),s.E.stateManager.after()}sectionsForWeekFixed(e){const a=s.E.campaignData();return a.weeks&&a.weeks[e+1]&&a.weeks[e+1]||[]}sectionsForWeek(e){return this.party.weekSections&&this.party.weekSections[e+1]&&this.party.weekSections[e+1]||[]}isConclusion(e){return!!e&&null!=this.party.conclusions.find(a=>a.edition==s.E.game.edition&&a.index==e)}hasConclusions(e){const a=s.E.sectionData(s.E.game.edition).filter(n=>n.conclusion&&!n.parent&&n.parentSections&&n.parentSections.find(o=>1==o.length&&-1!=o.indexOf(e)));return a.length>0&&a.every(n=>!s.E.game.party.conclusions.find(o=>o.edition==n.edition&&o.index==n.index&&o.group==n.group))}openConclusions(e,a=-1){let n=s.E.sectionData(s.E.game.edition).filter(o=>o.conclusion&&!o.parent&&o.parentSections&&o.parentSections.find(g=>1==g.length&&-1!=g.indexOf(e))&&0==s.E.scenarioManager.getRequirements(o).length).map(o=>o);n.length>0&&this.dialog.open(Se,{panelClass:["dialog"],data:{conclusions:n,parent:s.E.sectionData(s.E.game.edition).find(o=>o.index==e&&!o.group)}}).closed.subscribe({next:o=>{if(o){const g=new ht.Nz(o);-1!=a?(s.E.stateManager.before("finishConclusion",...s.E.scenarioManager.scenarioUndoArgs(g)),s.E.scenarioManager.finishScenario(g,!0,g,!1,!1,!1,s.E.game.party.campaignMode,!0),g.repeatable||(this.party.weekSections[a]=[...this.party.weekSections[a]||[],g.index]),s.E.stateManager.after(),this.dialog.open(Yt,{panelClass:["dialog"],data:{scenario:g,conclusionOnly:!0}})):this.finishConclusion(g.index)}}})}selectFinishConclusion(e,a=!1){let n=e.value;e.classList.add("error");const o=s.E.sectionData(this.partyEdition||s.E.currentEdition()).find(g=>g.index==n);o&&(e.classList.remove("error"),a||!this.party.conclusions.find(g=>g.edition==o.edition&&g.group==o.group&&g.index==o.index)?(e.value="",this.finishConclusion(n,a)):e.classList.add("warning"))}finishConclusion(e,a=!1){const n=s.E.sectionData(this.partyEdition||s.E.currentEdition()).find(o=>o.index==e);if(n&&(a||!this.party.conclusions.find(o=>o.edition==n.edition&&o.group==n.group&&o.index==n.index))){const o=new ht.Nz(n);this.hasConclusions(o.index)?this.openConclusions(o.index):this.dialog.open(Yt,{panelClass:["dialog"],data:{scenario:o,conclusionOnly:!0}}).closed.subscribe({next:()=>this.update()})}}removeConclusion(e,a){s.E.stateManager.before("removeConclusion",s.E.game.party.name,e),s.E.game.party.conclusions=s.E.game.party.conclusions.filter(n=>n.edition!=a||n.index!=e),s.E.stateManager.after(),this.update()}setWeek(e){if(m.f.settings.calendarLocked&&("permissive"!=m.f.settings.calendarLocked||this.party.weeks!=e-1&&this.party.weeks!=e))return;this.party.weeks==e&&e--,e<0&&(e=0);let a=[];for(let n=this.party.weeks;n<e;n++)this.sectionsForWeekFixed(n).forEach(o=>{this.hasConclusions(o)&&-1==a.indexOf(o)&&a.push(o)}),this.sectionsForWeek(n).forEach(o=>{this.hasConclusions(o)&&-1==a.indexOf(o)&&a.push(o)});a.forEach(n=>{this.openConclusions(n,e)}),s.E.stateManager.before("setPartyWeeks",""+e);for(let n=this.party.weeks;n<e;n++)[...this.sectionsForWeekFixed(n),...this.sectionsForWeek(n)].forEach(g=>{const _=s.E.sectionData(s.E.game.edition).find(y=>y.index==g&&y.conclusion);_&&!s.E.game.party.conclusions.find(y=>y.edition==_.edition&&y.index==_.index&&y.group==_.group)&&s.E.scenarioManager.finishScenario(new ht.Nz(_),!0,void 0,!1,!1,!1,s.E.game.party.campaignMode,!0)});this.party.weeks=e,s.E.stateManager.after(),this.update()}setWeekSection(e){this.dialog.open(T6,{panelClass:["dialog-invert"],data:e})}setResource(e,a){isNaN(+a.target.value)||(s.E.stateManager.before("setPartyResource",this.party.name,"game.loot."+e,a.target.value),this.party.loot[e]=+a.target.value,s.E.stateManager.after())}moveResources(e){this.dialog.open(Ra,{panelClass:["dialog"],data:{character:e}}).closed.subscribe({next:()=>this.update()})}openResources(){this.dialog.open(hr,{panelClass:["dialog"]})}setInspiration(e){!isNaN(+e.target.value)&&this.party.inspiration!=+e.target.value&&(s.E.stateManager.before("setPartyInspiration",this.party.name,e.target.value),this.party.inspiration=+e.target.value,s.E.stateManager.after())}setTotalDefense(e){if(!isNaN(+e.target.value)){const a=+e.target.value-this.moraleDefense;this.party.defense!=a&&(s.E.stateManager.before("setPartyTotalDefense",this.party.name,a),this.party.defense=a,s.E.stateManager.after())}}setSoldiers(e,a=!1){this.party.soldiers==e&&e--,e<0&&(e=0),e<this.party.soldiers||a?(s.E.stateManager.before("setPartySoldiers",""+e),this.party.soldiers=e,s.E.stateManager.after()):this.soldierAvailable()&&e==this.party.soldiers+1&&this.dialog.open(Jn,{panelClass:["dialog"],data:{costs:{gold:3},repair:1,action:"soldiers"}}).closed.subscribe({next:n=>{n&&(s.E.stateManager.before("setPartySoldiers",""+e),this.party.soldiers=e,n instanceof $e.CS&&s.E.lootManager.applySelectResources(n),s.E.stateManager.after())}})}soldierAvailable(){if(!this.party.campaignMode)return!0;const e=this.party.buildings.find(a=>"barracks"==a.name&&a.level>0&&"normal"==a.state);if(e&&this.party.soldiers<2+2*e.level){const a=s.E.game.figures.filter(n=>n instanceof q.K).map(n=>n);if(a.length>0){const n=a.map(_=>_.progress.gold).reduce((_,y)=>_+y),o=a.map(_=>(_.progress.loot.hide||0)+(_.progress.loot.lumber||0)+(_.progress.loot.metal||0)).reduce((_,y)=>_+y);if(n>3&&o+((this.party.loot.hide||0)+(this.party.loot.lumber||0)+(this.party.loot.metal||0))>0)return!0}}return!1}setMorale(e){this.party.morale==e&&e--,e<0&&(e=0),e>20&&(e=20),s.E.stateManager.before("setPartyMorale",""+e),this.party.morale=e;const a=s.E.campaignData();0==e&&a&&a.lowMorale&&this.lowMoraleSolved<=a.lowMorale.length?this.lowMoraleSolved<a.lowMorale.length?this.finishConclusion(a.lowMorale[this.lowMoraleSolved]):(this.party.conclusions=this.party.conclusions.filter(n=>n.edition!=s.E.game.edition||n.index!=a.lowMorale[this.lowMoraleSolved-1]),this.finishConclusion(a.lowMorale[this.lowMoraleSolved-1])):20==e&&a&&a.highMorale&&this.highMoraleSolved<a.highMorale.length&&this.finishConclusion(a.highMorale[this.highMoraleSolved]),s.E.stateManager.after(),this.update()}setTownGuardPerks(e){this.party.townGuardPerks==e&&e--,e<0&&(e=0),s.E.stateManager.before("setPartyTownGuardPerks",""+e),this.party.townGuardPerks=e,s.E.stateManager.after()}toggleTownGuardPerkSection(e,a=!1){this.party.townGuardPerkSections=this.party.townGuardPerkSections||[];const n=this.party.townGuardPerkSections.indexOf(e);if(-1!=n||this.party.townGuardPerkSections.length<Math.floor(this.party.townGuardPerks/3)||a){s.E.stateManager.before(-1==n?"addPartyTownGuardPerkSection":"removePartyTownGuardPerkSection",e),-1==n?(this.party.townGuardPerkSections.push(e),this.finishConclusion(e)):this.party.townGuardPerkSections.splice(n,1);const o=this.townGuardDeck&&this.townGuardDeck.active||!1;this.townGuardDeck=s.E.attackModifierManager.buildTownGuardAttackModifierDeck(this.party,s.E.campaignData()),this.townGuardDeck.active=o,s.E.attackModifierManager.shuffleModifiers(this.townGuardDeck),this.party.townGuardDeck=this.townGuardDeck.toModel(),s.E.stateManager.after()}}addCampaignSticker(e){const a=e.value,n=this.campaignStickers.find(o=>o.label==a);if(n){this.party.campaignStickers=this.party.campaignStickers||[];let o=0;const g=s.E.campaignData();if(g.campaignStickers){const y=g.campaignStickers.find(B=>B.startsWith(n.value));y&&(o=-1!=y.indexOf(":")?+y.split(":")[1]:1)}this.party.campaignStickers.filter(y=>y.toLowerCase()==n.value).length<o&&(s.E.stateManager.before("addCampaignSticker",n.label),this.party.campaignStickers.push(n.value),e.value="",s.E.stateManager.after(),this.update())}}removeCampaignSticker(e){const a=this.party.campaignStickers.indexOf(e);-1!=a&&(s.E.stateManager.before("removeCampaignSticker",e),this.party.campaignStickers.splice(a,1),s.E.stateManager.after(),this.update())}campaignStickerImage(e,a){const n=s.E.campaignData();let o=0;if(n.campaignStickers){const g=n.campaignStickers.find(_=>_==e||_.startsWith(e));g&&(o=-1!=g.indexOf(":")?+g.split(":")[1]:1)}if(1==o)return"./assets/images/fh/party/campaign-stickers/"+e+".png";if(o>1){const _=this.party.campaignStickers.map((y,B)=>({sticker:y.toLowerCase().replaceAll(" ","-"),origIndex:B})).filter(y=>y.sticker==e).map((y,B)=>({sticker:y.sticker,origIndex:y.origIndex,index:B+1})).find(y=>y.origIndex==a);if(_)return"./assets/images/fh/party/campaign-stickers/"+e+"-"+_.index+".png"}}beforeTownGuardDeck(e){s.E.stateManager.before("updateAttackModifierDeck."+e.type,"party.campaign.townGuard",...e.values)}afterTownGuardDeck(e){this.townGuardDeck=e.deck,this.party.townGuardDeck=this.townGuardDeck.toModel(),s.E.stateManager.after()}toggleTownGuardDeck(){this.townGuardDeck&&(this.beforeTownGuardDeck(new _t(this.townGuardDeck,this.townGuardDeck.active&&!s.E.game.lootDeck.active?"amDeckHide":"amDeckShow")),this.townGuardDeck.active=!this.townGuardDeck.active,this.afterTownGuardDeck(new _t(this.townGuardDeck,this.townGuardDeck.active?"amDeckShow":"amDeckHide")))}battleGoalSetup(){this.dialog.open(_i,{panelClass:["dialog"]})}setupEvents(e=""){this.dialog.open(Ba,{panelClass:["dialog"],data:{type:e,edition:s.E.game.edition||s.E.currentEdition()}})}statistics(){this.dialog.open(Fs,{panelClass:["dialog-invert"]})}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-party-sheet-dialog"]],viewQuery:function(a,n){if(1&a&&(t.GBs(S6,5),t.GBs($6,5)),2&a){let o;t.mGM(o=t.lsd())&&(n.itemIndex=o.first),t.mGM(o=t.lsd())&&(n.treasureIndex=o.first)}},hostBindings:function(a,n){1&a&&t.bIt("keydown",function(g){return n.keyboardShortcuts(g)},t.EBC)},standalone:!1,decls:8,vars:13,consts:[["partyAchievementInput",""],["campaignStickerEl",""],["itemIndex",""],["treasureIndex",""],["unlockScenarioIndex",""],["unlockScenarioGroup",""],["unlockConclusionIndex",""],["globalAchievementInput",""],[1,"light","party-sheet-dialog"],[1,"scroll-container",3,"ngClass"],[1,"container",3,"ngClass"],[1,"sheet",3,"ngClass"],[1,"sheet","fh-sheet"],[1,"sheet","gh2e-sheet"],[1,"toggle-fh-sheet","ignore-denied"],[1,"campaign"],[1,"columns"],[1,"column","column-left"],[1,"row","title"],[1,"campaign-toggle","ignore-denied",3,"click"],["src","./assets/images/left.svg"],[3,"ghs-label"],[1,"headline"],[1,"select-party",3,"ghs-label","ghs-label-attribute"],[1,"spacer"],[1,"map","ignore-denied"],[1,"row","name"],["type","text",3,"change","value","ghs-label","ghs-label-attribute"],[1,"hint-container","new-party-hint"],[1,"row","location"],[1,"row","notes"],[1,"row","achievements"],[1,"achievements-container"],[1,"list"],[1,"achievement"],[1,"form"],["type","text",3,"keyup.enter","autocomplete","spoiler","emptyLabel","ghs-label","ghs-label-attribute"],[1,"addScenario",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg"],[1,"column","column-right"],[1,"column","reputation"],[1,"grid"],[1,"column","shop"],[1,"table"],[1,"value",3,"ngClass"],[1,"import-export"],[1,"export",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/export.svg"],[1,"import",3,"click","ghs-label","ghs-label-attribute"],["type","file","accept","application/json",3,"change"],["src","./assets/images/import.svg"],[1,"select-party",3,"change","ghs-label","ghs-label-attribute"],[3,"selected","disabled","value"],["src","./assets/images/chart.svg",3,"click","ghs-tooltip"],["src","./assets/images/map.svg",3,"ghs-tooltip"],["src","./assets/images/map.svg",3,"click","ghs-tooltip"],["src","./assets/images/minus.svg",1,"remove-party",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg",1,"new-party",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/minus.svg",1,"remove-party",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg",1,"hint-trigger","ghs-svg"],[1,"hint"],[1,"text"],[1,"remove",3,"click"],["src","./assets/images/close.svg",1,"ghs-svg"],[1,"value",3,"click","ngClass"],[1,"key"],[1,"title"],[1,"summer",3,"ngClass"],["src","./assets/images/fh/party/summer.svg"],[1,"headline","ignore-denied",3,"click"],[1,"management"],[1,"winter",3,"ngClass"],["src","./assets/images/fh/party/winter.svg"],[1,"calendar-lock-toggle",3,"ghs-tooltip","ngClass"],["ghs-pointer-input","",3,"singleClick","doubleClick"],[3,"src"],[1,"next"],[1,"weeks"],["ghs-pointer-input","",1,"week",3,"ghs-tooltip","ngClass"],[1,"name"],[1,"resources"],[1,"header"],[1,"supply",3,"click"],[1,"move-resources"],[1,"resource-table"],[1,"materials"],[1,"resource","lumber"],["src","./assets/images/fh/loot/lumber.svg"],["type","number","min","0",3,"change","value"],[1,"resource","metal"],["src","./assets/images/fh/loot/metal.svg"],[1,"resource","hide"],["src","./assets/images/fh/loot/hide.svg"],[1,"herbs"],[1,"resource","arrowvine"],["src","./assets/images/fh/loot/arrowvine.svg"],[1,"resource","axenut"],["src","./assets/images/fh/loot/axenut.svg"],[1,"resource","corpsecap"],["src","./assets/images/fh/loot/corpsecap.svg"],[1,"resource","flamefruit"],["src","./assets/images/fh/loot/flamefruit.svg"],[1,"resource","rockroot"],["src","./assets/images/fh/loot/rockroot.svg"],[1,"resource","snowthistle"],["src","./assets/images/fh/loot/snowthistle.svg"],[1,"inspiration"],["type","number",3,"change","value","ghs-label","ghs-label-attribute"],[1,"total-defense"],[1,"soldiers"],[1,"soldier-table"],[1,"line"],[1,"morale"],[1,"grid","morale-grid"],[1,"defense"],[1,"grid","defense-grid"],[1,"sections",3,"ngClass"],[1,"section",3,"ngClass"],[1,"town-guard-perks"],[1,"town-guard-perks-grid"],[1,"perk-list"],[1,"perk"],[1,"warning",3,"ghs-label","ghs-label-attribute"],[1,"campaign-stickers"],[1,"header",3,"submit"],["type","text",3,"keyup.enter","autocomplete","emptyLabel","ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg",3,"click"],[1,"stickers","ignore-denied",3,"ngClass"],[1,"sticker"],[3,"party"],[1,"town-guard-deck-container",3,"ngClass"],[1,"next",3,"click"],["src","./assets/images/right.svg"],["ghs-pointer-input","",1,"week",3,"singleClick","doubleClick","ghs-tooltip","ngClass"],[1,"section"],[1,"section","manual"],[1,"label"],[1,"characters"],[1,"character"],[1,"character",3,"click"],[1,"soldiers-line"],["ghs-pointer-input","",1,"soldier",3,"ngClass"],["ghs-pointer-input","",1,"soldier",3,"singleClick","doubleClick","ngClass"],["src","./assets/images/fh/party/soldier.svg"],[1,"check",3,"ngClass"],["src","./assets/images/fh/party/section.svg"],[1,"checkmark"],[1,"townguard-perk","checkbox",3,"click","ngClass"],["src","./assets/images/close.svg"],[1,"sections"],["ghs-pointer-input","",1,"section",3,"ngClass"],[3,"perk"],["ghs-pointer-input","",1,"section",3,"singleClick","doubleClick","ngClass"],["src","./assets/images/warning.svg",1,"ghs-svg"],[1,"text",3,"ghs-label"],[1,"image",3,"src","ghs-tooltip"],["src","./assets/images/minus.svg",1,"remove",3,"click"],[1,"town-guard-deck",3,"ngClass"],[3,"before","after","deck","townGuard"],[1,"active-toggle",3,"click"],[1,"numeration"],[1,"factions"],[1,"faction-reputation"],[1,"additional-factions"],[1,"imbuement"],[1,"checklist-container"],[1,"donations"],[1,"prosperity","gh2e","wrapped"],[1,"checklist"],[1,"legend"],[3,"click","ghs-label","ghs-tooltip"],["src","./assets/images/fh/prosperity.svg",3,"ghs-tooltip"],[1,"tick","large",3,"click","ghs-tooltip"],[1,"level"],[1,"checkbox","checked","disabled"],[1,"row"],[1,"checkbox","limit",3,"ngClass"],[1,"key",3,"click"],[1,"checkbox",3,"ngClass"],["ghs-pointer-input","",1,"text",3,"singleClick","doubleClick","ghs-label"],[1,"text",3,"ghs-label","ghs-label-args"],["ghs-pointer-input","",1,"text",3,"singleClick","doubleClick","ghs-label","ghs-label-args"],[1,"tick",3,"ngClass"],["ghs-pointer-input","",1,"click",3,"singleClick"],["ghs-pointer-input","",1,"section",3,"ghs-label"],["src","./assets/images/fh/prosperity.svg"],["ghs-pointer-input","",1,"section",3,"singleClick","doubleClick","ghs-label"],[1,"checkbox",3,"click","ngClass"],[1,"level",3,"click"],[1,"toggle-fh-sheet","ignore-denied",3,"click"],[1,"campaign-mode",3,"click"],[3,"change"],[3,"value","selected"],[3,"selected","value"],[1,"row","scenarios","ignore-denied",3,"ngClass"],[1,"scenario","header","legend","seperator"],[1,"prosperity",3,"ngClass"],[1,"row","donations"],[1,"row","envelope-b"],[1,"achievements"],[1,"items"],[1,"item-add"],["min","1","type","number","value","",3,"focus","keyup","keyup.enter"],[3,"click","ngClass"],[3,"ngModelChange","change","ngModel"],["value","",3,"selected"],[1,"item-list"],[1,"item",3,"ngClass"],[1,"treasures"],[1,"treasures-title",3,"click"],["src","./assets/images/scenario/treasure.svg",1,"icon"],[1,"treasure-add"],[1,"treasure-list"],[1,"treasure",3,"ngClass"],[1,"column"],[1,"row","players"],[1,"player"],[1,"add",3,"click"],[1,"row","events"],[1,"row","battle-goals"],[1,"row","retirements"],[1,"row","bottom-sheet"],[3,"ghs-label","ghs-label-args"],[3,"click","ghs-tooltip"],["src","./assets/images/stats.svg",1,"ghs-svg"],[1,"scenario","seperator"],[1,"scenario","header"],[1,"scenario"],[1,"scenario","unlock"],[1,"span"],[1,"ghs-svg","solo",3,"src"],[1,"scenario-title",3,"click","ngClass","ghs-tooltip","toggable"],[1,"toggle-manual",3,"ghs-label","ghs-label-attribute"],[1,"locked",3,"ghs-tooltip"],[1,"rewards",3,"ghs-tooltip"],["ghs-pointer-input","",1,"add-success",3,"singleClick","doubleClick","ghs-label","ghs-label-attribute","ngClass"],["src","./assets/images/check.svg"],[1,"toggle-manual",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/hint.svg",1,"manual"],["src","./assets/images/close.svg",1,"remove"],[1,"locked",3,"click","ghs-tooltip"],["src","./assets/images/fh/loot/random_item.svg",1,"ghs-svg"],[1,"rewards",3,"click","ghs-tooltip"],["src","./assets/images/scenario/conclusion.svg",1,"ghs-svg"],[1,"toggle-success",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/check.svg",1,"success"],[1,"toggle-success","casual",3,"click","ghs-label","ghs-label-attribute"],[3,"keyup","keyup.enter","ghs-label","ghs-label-attribute"],[1,"scenario-title"],["src","./assets/images/fh/puzzle.svg",1,"ghs-svg"],[1,"toggle-wrapped",3,"click","ghs-tooltip","src"],[1,"check",3,"ghs-tooltip"],[1,"tick",3,"autoscroll","ngClass"],["src","./assets/images/fh/prosperity.svg",3,"click","ghs-tooltip"],[1,"check",3,"click","ghs-tooltip"],[1,"section",3,"ghs-label"],[1,"tick"],[1,"donation"],["src","./assets/images/coin.png"],[1,"value"],[3,"click"],[1,"lines"],[1,"item"],[1,"checkpoint",3,"click","ngClass"],[1,"item-index","open-item",3,"click"],[1,"icon",3,"src"],[1,"index"],[1,"separator"],[1,"checkbox",3,"click"],["src","./assets/images/check.svg",1,"check"],["src","./assets/images/close.svg",1,"close"],[1,"text","open-item",3,"click","ghs-label"],[1,"count",3,"click"],[1,"text","edition"],[1,"treasure-index"],[3,"edition","index"],["type","text",3,"change","value"],[1,"available-characters"],["ghs-pointer-input","",1,"available-character",3,"ghs-tooltip"],["ghs-pointer-input","",1,"available-character",3,"singleClick","doubleClick","ghs-tooltip"],[1,"list",3,"ngClass"],[1,"character","header","legend","seperator"],["type","number","min","1",3,"change","keyup","value"],["ghs-pointer-input","",1,"link",3,"singleClick","doubleClick"],["ghs-pointer-input","",1,"link",3,"singleClick","doubleClick","ghs-label"],[1,"reactivate",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/long-rest.svg",1,"ghs-svg"]],template:function(a,n){1&a&&(t.j41(0,"div",8)(1,"div",9)(2,"div",10),t.nVh(3,hI,68,45,"div",11),t.nVh(4,YI,138,109,"div",12),t.nVh(5,pA,60,35,"div",13),t.nVh(6,uA,2,1,"span",14),t.nVh(7,jV,98,55,"div",15),t.k0s()()()),2&a&&(t.R7$(),t.Y8G("ngClass",t.eq3(7,ti,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.party)),t.R7$(),t.Y8G("ngClass",t.sMw(9,D6,!n.campaign&&n.fhSheet,!n.campaign&&n.gh2eSheet,n.campaign)),t.R7$(),t.vxM(n.campaign||n.fhSheet||n.gh2eSheet?-1:3),t.R7$(),t.vxM(!n.campaign&&n.fhSheet?4:-1),t.R7$(),t.vxM(!n.campaign&&n.gh2eSheet?5:-1),t.R7$(),t.vxM(n.campaign?-1:6),t.R7$(),t.vxM(n.campaign?7:-1))},dependencies:[N.YU,O.qT,O.xH,O.y7,O.wz,O.BC,O.cb,O.vS,O.cV,yn,y8,xo,tt,ft,Or,Ns,rt,Pn,N.P9,ia,$o,Tt,Cn],styles:['.party-sheet-dialog[_ngcontent-%COMP%]{position:relative;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;width:calc(var(--ghs-unit) * 62 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .campaign-toggle[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .campaign-toggle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .campaign-toggle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{filter:var(--ghs-filter-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));justify-content:center;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{z-index:99}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));height:auto;margin:0 calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   label.headline[_ngcontent-%COMP%]{width:100%;justify-content:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   img.new-party[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   img.remove-party[_ngcontent-%COMP%]{cursor:pointer;height:1.2em;width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   select.select-party[_ngcontent-%COMP%]{cursor:pointer;position:relative;width:20px;appearance:none;color:transparent;border:none;background:transparent url(select-arrow.ed190f6187dac3c2.svg) no-repeat right center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);border-radius:calc(var(--ghs-unit) * .15 * var(--ghs-dialog-factor));box-shadow:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * .15 * var(--ghs-dialog-factor)) var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:before{content:" ";position:absolute;left:50%;top:50%;width:110%;height:110%;transform:scale(0);transform-origin:top left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;z-index:1;background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;filter:var(--ghs-filter-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .checkbox.checked[_ngcontent-%COMP%]:before{transform:scale(1) translate(-50%,-50%)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .checkbox.check[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));box-shadow:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor)) var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .checkbox.check[_ngcontent-%COMP%]:before{left:calc(var(--ghs-unit) * -.1 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));background-image:url(check.9a2e06a3b28f9de1.svg);transform-origin:bottom left}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .checkbox.checked.check[_ngcontent-%COMP%]:before{transform:scale(1)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .checkbox.highlight[_ngcontent-%COMP%]{background-color:var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .checkbox.disabled[_ngcontent-%COMP%]{pointer-events:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .checkbox.checked[_ngcontent-%COMP%]:hover:before{opacity:.6}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:not(.checked):hover:before{transform:scale(1) translate(-50%,-50%);opacity:.6}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{margin:0;color:var(--ghs-color-black);background-color:transparent;border:none;border-bottom-width:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor));border-bottom-style:solid;border-bottom-color:var(--ghs-color-gray);user-select:auto;-webkit-user-select:auto;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));flex-grow:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{margin:0;color:var(--ghs-color-black);background-color:transparent;border:none;user-select:auto;-webkit-user-select:auto;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));width:100%}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{color:var(--ghs-color-black);background-color:transparent;border:none;user-select:auto;-webkit-user-select:auto;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));width:100%;height:100%}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{display:flex;border:none;background:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:calc(var(--ghs-unit) * 27 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;column-gap:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 24 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor));overflow:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .achievement[_ngcontent-%COMP%]{display:flex}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .achievement[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{min-width:0;border:none;outline:none;flex-shrink:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .achievement[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]{cursor:pointer;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .achievement[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]:hover{opacity:.7}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]{position:relative;display:flex;font-family:var(--ghs-font-text);align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);width:100%;min-width:0;margin:0}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);display:flex;cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-green);width:auto;height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 62 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 76 * var(--ghs-dialog-factor));background-image:url(party-sheet.44d63853d27ff30a.svg);background-position:top center;background-repeat:no-repeat;background-size:contain;padding-left:calc(var(--ghs-unit) * 1.2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.column-left[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.column-right[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 17 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]{flex-grow:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{display:flex;height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .location[_ngcontent-%COMP%]{display:flex;height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:calc(var(--ghs-unit) * 25 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop[_ngcontent-%COMP%]{display:flex;flex-direction:column}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 5.6 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * .01 * var(--ghs-dialog-factor));display:grid;grid-template-columns:repeat(2,calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor)))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:flex;justify-content:center;position:relative;font-family:var(--ghs-font-normal);height:calc(var(--ghs-unit) * 1.635 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 2.1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .value.checked[_ngcontent-%COMP%]:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:hover:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .value.checked[_ngcontent-%COMP%]:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:hover:before{content:" ";position:absolute;top:0;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;filter:var(--ghs-filter-red);z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:hover:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:hover:before{opacity:.5}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.shop[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.shop[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]{display:flex;flex-direction:column}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));width:100%;height:calc(var(--ghs-unit) * 6.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(1), .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(1){height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(6), .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(6){height:calc(var(--ghs-unit) * 8.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(11), .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(11){height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .reputation.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value.active[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .shop.shop[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .value.active[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .column-right[_ngcontent-%COMP%]{position:relative}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .column-right[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .column-right[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:0;height:calc(var(--ghs-unit) * 73 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 14 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));background:linear-gradient(transparent 0%,var(--ghs-color-darkgray) 100%);opacity:.2;z-index:0}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .import-export[_ngcontent-%COMP%]{display:flex;justify-content:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .import-export[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .import-export[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .import-export[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{width:0;height:0;margin:0;padding:0;visibility:hidden}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet[_ngcontent-%COMP%]   .import-export[_ngcontent-%COMP%]   label.error[_ngcontent-%COMP%]{animation:shake calc(var(--ghs-animation-speed) * .5s) linear;color:var(--ghs-color-red)!important}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 120.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 98.5 * var(--ghs-dialog-factor));background-image:url(party-sheet.0bbd7284c0358ddf.svg)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .checkbox.checked[_ngcontent-%COMP%]:before{clip-path:none;background-color:transparent;background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;z-index:1;filter:var(--ghs-filter-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-top:0;display:flex;position:absolute;justify-content:space-between;top:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor));left:0;width:calc(var(--ghs-unit) * 120.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]{cursor:pointer;display:flex;flex-direction:column;justify-content:center;align-items:center;margin-left:calc(var(--ghs-unit) * -4 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2.4 * var(--ghs-dialog-factor));text-transform:uppercase;flex-grow:initial}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]:hover{color:var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]   .management[_ngcontent-%COMP%]{display:flex;align-items:center;font-family:var(--ghs-font-text)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]   .management[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .summer[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .winter[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * -1.8 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .summer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .winter[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1.2em;width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .summer.summer[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .winter.summer[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .summer.summer.highlight[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .winter.summer.highlight[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .summer.summer.highlight[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .winter.summer.highlight[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .summer.winter[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .winter.winter[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .summer.winter.highlight[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .winter.winter.highlight[_ngcontent-%COMP%]{color:var(--ghs-color-blue)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .summer.winter.highlight[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .winter.winter.highlight[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-blue)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .calendar-lock-toggle[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * .6 * var(--ghs-dialog-factor));z-index:2}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .calendar-lock-toggle[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 3.8 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .calendar-lock-toggle[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .calendar-lock-toggle.permissive[_ngcontent-%COMP%]{opacity:.6}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .next[_ngcontent-%COMP%]{cursor:pointer;position:absolute;right:calc(var(--ghs-unit) * 11.5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2.4 * var(--ghs-dialog-factor));display:flex;justify-content:center;align-items:center;background:var(--ghs-color-white);width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor));border-bottom-right-radius:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .next[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto;margin-left:.2em}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .next[_ngcontent-%COMP%]:hover{color:var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .next[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 6.3 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 118.9 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 18.7 * var(--ghs-dialog-factor));display:grid;grid-template-columns:repeat(20,1fr);z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]   .week[_ngcontent-%COMP%]{position:relative;cursor:pointer;width:calc(var(--ghs-unit) * 5.9 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4.6 * var(--ghs-dialog-factor));padding:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor));display:flex;flex-direction:column;overflow-x:hidden;overflow-y:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]   .week.locked[_ngcontent-%COMP%]{cursor:initial}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]   .week.checked[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:10%;left:10%;width:80%;height:80%;background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]   .week.section.checked[_ngcontent-%COMP%]:after{top:initial;bottom:0;left:20%;width:60%;height:60%;filter:var(--ghs-filter-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]   .week[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));z-index:2;color:var(--ghs-color-darkgray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]   .week[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1.2em;width:auto;margin-right:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]   .week[_ngcontent-%COMP%]   .section.manual[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);color:var(--ghs-color-black)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]   .week[_ngcontent-%COMP%]   .section.manual[_ngcontent-%COMP%]   .manual-icon[_ngcontent-%COMP%]{height:.9em;width:auto;margin-right:0;margin-left:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]   .week[_ngcontent-%COMP%]:hover ~ [_ngcontent-%COMP%]:after{display:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]   .week[_ngcontent-%COMP%]:hover ~ .checked[_ngcontent-%COMP%]:after{display:block;opacity:.3}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .weeks[_ngcontent-%COMP%]:hover   .week[_ngcontent-%COMP%]:not(.locked):after{content:" ";position:absolute;top:10%;left:10%;width:80%;height:80%;background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;z-index:1;opacity:.7}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 26.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 59 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-top:0;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 7.5 * var(--ghs-dialog-factor));justify-content:flex-end}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-align:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex:1 1 auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 32 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 61 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 19 * var(--ghs-dialog-factor));display:flex;flex-direction:column}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .supply[_ngcontent-%COMP%]{cursor:help;min-width:calc(var(--ghs-unit) * 24 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .move-resources[_ngcontent-%COMP%]{display:flex;height:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .move-resources[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));white-space:nowrap}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .move-resources[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]{display:flex}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .move-resources[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .move-resources[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource-table[_ngcontent-%COMP%]{display:flex;flex-direction:column}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource-table[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]{display:flex;margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource-table[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource-table[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));min-width:0;flex-grow:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource-table[_ngcontent-%COMP%]   .materials[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr;padding-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .resources[_ngcontent-%COMP%]   .resource-table[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .inspiration[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .total-defense[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 51 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 20 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 21 * var(--ghs-dialog-factor));margin-top:0;display:flex;flex-direction:column}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .inspiration[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .total-defense[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:center;align-self:center;font-size:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .inspiration.total-defense[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .total-defense.total-defense[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 24 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .inspiration.total-defense[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .total-defense.total-defense[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .soldiers[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 51 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 46 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 15 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 21 * var(--ghs-dialog-factor));margin-top:0;display:flex;flex-direction:column}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .soldiers[_ngcontent-%COMP%]   .soldier-table[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:calc(var(--ghs-unit) * -.3 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .soldiers[_ngcontent-%COMP%]   .soldier-table[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;margin-top:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .soldiers[_ngcontent-%COMP%]   .soldier-table[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);display:flex;flex-direction:column;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .soldiers[_ngcontent-%COMP%]   .soldier-table[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .soldiers[_ngcontent-%COMP%]   .soldier-table[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .soldiers-line[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-grow:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .soldiers[_ngcontent-%COMP%]   .soldier-table[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .soldiers-line[_ngcontent-%COMP%]   .soldier[_ngcontent-%COMP%]{position:relative}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .soldiers[_ngcontent-%COMP%]   .soldier-table[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .soldiers-line[_ngcontent-%COMP%]   .soldier[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2.6 * var(--ghs-dialog-factor));height:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .soldiers[_ngcontent-%COMP%]   .soldier-table[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .soldiers-line[_ngcontent-%COMP%]   .soldier[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{cursor:pointer;position:relative;width:calc(var(--ghs-unit) * 2.6 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.6 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) dashed var(--ghs-color-black);border-radius:100%}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .soldiers[_ngcontent-%COMP%]   .soldier-table[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .soldiers-line[_ngcontent-%COMP%]   .soldier[_ngcontent-%COMP%]   .check.checked[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:10%;left:10%;width:80%;height:80%;background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;z-index:1;filter:var(--ghs-filter-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .soldiers[_ngcontent-%COMP%]   .soldier-table[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .soldiers-line[_ngcontent-%COMP%]   .soldier.disabled[_ngcontent-%COMP%]{cursor:initial;opacity:.7}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 26.5 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 64 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 10.8 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 43.2 * var(--ghs-dialog-factor));display:flex;flex-direction:column;z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));justify-content:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale.defense[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense.defense[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 75.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.morale-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.morale-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{position:relative;cursor:pointer;display:flex;justify-content:center;align-items:center;width:100%;height:calc(var(--ghs-unit) * 1.92 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.morale-grid[_ngcontent-%COMP%]   .value.checked[_ngcontent-%COMP%]:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.morale-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:hover:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.morale-grid[_ngcontent-%COMP%]   .value.checked[_ngcontent-%COMP%]:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.morale-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:hover:before{content:" ";position:absolute;top:0;left:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));background-image:url(checkmark.437dd8c56b3be0e8.svg);background-position:center center;background-repeat:no-repeat;z-index:1;filter:var(--ghs-filter-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.morale-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:hover:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.morale-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:hover:before{opacity:.5}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;flex-wrap:wrap;width:100%;height:calc(var(--ghs-unit) * 1.92 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor));z-index:2}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{display:flex;align-items:center;margin-left:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section.conclusion[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section.conclusion[_ngcontent-%COMP%]{text-decoration:line-through}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:100%;height:calc(var(--ghs-unit) * 5.7 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(2), .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(2){height:calc(var(--ghs-unit) * 11.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(6), .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(7), .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(6), .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid.defense-grid[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:nth-child(7){height:calc(var(--ghs-unit) * 3.9 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .highlight[_ngcontent-%COMP%]:after, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .highlight[_ngcontent-%COMP%]:after{content:" ";position:absolute;inset:0;opacity:.3;background-color:var(--ghs-color-gray);z-index:-1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 26.2 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 90 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 28 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 72 * var(--ghs-dialog-factor));flex-direction:column;display:flex;z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.4 * var(--ghs-dialog-factor));justify-content:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .town-guard-perks-grid[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor));display:grid;grid-template-columns:repeat(12,1fr);align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .town-guard-perks-grid[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));height:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .town-guard-perks-grid[_ngcontent-%COMP%]   .town-guard-perk[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .town-guard-perks-grid[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));display:flex;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .perk-list[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-top:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor));display:flex;flex-direction:column;height:calc(var(--ghs-unit) * 54.5 * var(--ghs-dialog-factor));overflow-y:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .perk-list[_ngcontent-%COMP%]   .perk[_ngcontent-%COMP%]{display:grid;grid-template-columns:calc(var(--ghs-unit) * 6.2 * var(--ghs-dialog-factor)) auto;margin-bottom:calc(var(--ghs-unit) * .57 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .perk-list[_ngcontent-%COMP%]   .perk[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .perk-list[_ngcontent-%COMP%]   .perk[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;align-items:center;margin-top:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1.4 * var(--ghs-dialog-factor));background-color:var(--ghs-color-white)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .perk-list[_ngcontent-%COMP%]   .perk[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:.9em;width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .perk-list[_ngcontent-%COMP%]   .perk[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:hover{background-color:var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .perk-list[_ngcontent-%COMP%]   .perk[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section.disabled[_ngcontent-%COMP%]{pointer-events:initial;cursor:not-allowed;border-color:var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .perk-list[_ngcontent-%COMP%]   .perk[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section.disabled[_ngcontent-%COMP%]:hover{background-color:transparent}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-perks[_ngcontent-%COMP%]   .perk-list[_ngcontent-%COMP%]   .perk[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section.checked[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:10%;left:calc(var(--ghs-unit) * -1.2 * var(--ghs-dialog-factor));width:80%;height:80%;background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;z-index:1;filter:var(--ghs-filter-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .campaign-stickers[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * 70.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 86.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 28 * var(--ghs-dialog-factor));flex-direction:column;display:flex}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .campaign-stickers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .campaign-stickers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{cursor:pointer;height:1.2em;width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .campaign-stickers[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));width:0;flex-grow:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .campaign-stickers[_ngcontent-%COMP%]   .stickers[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;width:100%;height:calc(var(--ghs-unit) * 25 * var(--ghs-dialog-factor));overflow-y:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .campaign-stickers[_ngcontent-%COMP%]   .stickers[_ngcontent-%COMP%]   .sticker[_ngcontent-%COMP%]{position:relative;height:calc(var(--ghs-unit) * 14 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .campaign-stickers[_ngcontent-%COMP%]   .stickers[_ngcontent-%COMP%]   .sticker[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .campaign-stickers[_ngcontent-%COMP%]   .stickers[_ngcontent-%COMP%]   .sticker[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{height:100%;width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .campaign-stickers[_ngcontent-%COMP%]   .stickers[_ngcontent-%COMP%]   .sticker[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:0;right:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .campaign-stickers[_ngcontent-%COMP%]   .stickers[_ngcontent-%COMP%]   .sticker[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]:hover{opacity:.5}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]{position:absolute;z-index:3;left:calc(var(--ghs-unit) * 115 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * 19 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));height:0;transition:top calc(var(--ghs-animation-speed) * .5s) ease-in-out,width calc(var(--ghs-animation-speed) * .5s) ease-in-out,left calc(var(--ghs-animation-speed) * .5s) ease-in-out;overflow:visible}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]:before{content:" ";position:sticky;display:block;top:0;left:0;width:calc(var(--ghs-unit) * 119.5 * var(--ghs-dialog-factor));height:0;background-color:var(--ghs-color-darkgray);opacity:0;transition:opacity calc(var(--ghs-animation-speed) * .5s) ease-in-out,height calc(var(--ghs-animation-speed) * .5s) ease-in-out;z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container.active[_ngcontent-%COMP%]{z-index:3;top:calc(var(--ghs-unit) * 6.3 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 119.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 19 * var(--ghs-dialog-factor));overflow:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container.active[_ngcontent-%COMP%]:before{height:calc(var(--ghs-unit) * 19 * var(--ghs-dialog-factor));opacity:.5}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]   .town-guard-deck[_ngcontent-%COMP%]{position:absolute;right:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 37.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 10 * var(--ghs-dialog-factor));transition:transform calc(var(--ghs-animation-speed) * .5s) ease-in-out;z-index:2}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]   .town-guard-deck[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * -2.5 * var(--ghs-dialog-factor));bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * -5 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray);background-color:var(--ghs-color-darkgray);border-radius:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]   .town-guard-deck[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{position:relative;z-index:2}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]   .town-guard-deck.full[_ngcontent-%COMP%]{transform:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]   .town-guard-deck.collapsed[_ngcontent-%COMP%]{transform:translate(calc(var(--ghs-unit) * 41.5 * var(--ghs-dialog-factor)))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]   .town-guard-deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]{cursor:pointer;position:absolute;left:calc(var(--ghs-unit) * -5.5 * var(--ghs-dialog-factor) * var(--ghs-barsize));top:50%;transform:translateY(-50%);width:13%;height:50%;z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]   .town-guard-deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]:hover{filter:brightness(.7) grayscale(.3)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]   .town-guard-deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]:active, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]   .town-guard-deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]:focus{filter:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]   .town-guard-deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]   .numeration[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);display:flex;justify-content:center;position:absolute;color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor) * var(--ghs-barsize));line-height:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor) * var(--ghs-barsize));width:100%;height:100%;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(icon.5a11343c46ebf913.png)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.fh-sheet[_ngcontent-%COMP%]   ghs-party-buildings[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * 101.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 118.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 28 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 120.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 94 * var(--ghs-dialog-factor));background-image:url(party-sheet.e3d7a607caf90387.svg)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-title)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-top:0;display:flex;position:absolute;justify-content:center;top:calc(var(--ghs-unit) * -.4 * var(--ghs-dialog-factor));left:0;width:calc(var(--ghs-unit) * 120.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]{cursor:pointer;display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2.4 * var(--ghs-dialog-factor));text-transform:uppercase;flex-grow:initial}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]:hover{color:var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]   .management[_ngcontent-%COMP%]{display:flex;align-items:center;font-family:var(--ghs-font-text);font-size:.65em;margin-top:calc(var(--ghs-unit) * -.8 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]   .management[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 3.7 * var(--ghs-dialog-factor));left:0;width:calc(var(--ghs-unit) * 58 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-top:0;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 7.5 * var(--ghs-dialog-factor));justify-content:flex-end}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-align:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex:1 1 auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .inspiration[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 3.2 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 62 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 56 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));margin-top:0;display:flex;flex-direction:row;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .inspiration[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));text-align:center;align-self:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 12 * var(--ghs-dialog-factor));left:0;display:flex}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 17 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 67 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * 1.7 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]:last-child{margin-right:0}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2.1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1.2 * var(--ghs-dialog-factor));display:flex;flex-direction:column}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:grid;grid-template-columns:calc(var(--ghs-unit) * 2.8 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * 12 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;position:relative;font-family:var(--ghs-font-fh-text);height:calc(var(--ghs-unit) * 2.02 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 2.1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 2.8 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.02 * var(--ghs-dialog-factor));display:flex;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{pointer-events:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]:hover.checked:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]:hover   .value[_ngcontent-%COMP%]:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .value.checked.checked[_ngcontent-%COMP%]:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .value.checked[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:0;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;filter:var(--ghs-filter-red);z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]:hover   .value[_ngcontent-%COMP%]:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .value.checked[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]:before{opacity:.5}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]   .limit[_ngcontent-%COMP%]{pointer-events:none;position:absolute;top:calc(var(--ghs-unit) * 19.6 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 13 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .additional-factions[_ngcontent-%COMP%]{position:absolute;display:flex;flex-direction:column;top:calc(var(--ghs-unit) * 12.2 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 56 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 35 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 48 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .additional-factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:calc(var(--ghs-unit) * .7 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .additional-factions[_ngcontent-%COMP%]   .faction-reputation[_ngcontent-%COMP%]:first-of-type{margin-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .additional-factions[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{justify-content:center;margin-bottom:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .additional-factions[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{position:relative}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .additional-factions[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .additional-factions[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:calc(var(--ghs-unit) * .6 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 31 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));background-image:url(reputation-separator.86318fdb72c86cd2.svg);background-size:100% 100%;background-repeat:no-repeat}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .additional-factions[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{display:flex;align-items:center;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * -1 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .additional-factions[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:last-child{margin-bottom:0}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .additional-factions[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{pointer-events:none;margin-right:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));min-height:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .additional-factions[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 61 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 57.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 32 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 18 * var(--ghs-dialog-factor));margin-top:0}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .imbuement[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .donations[_ngcontent-%COMP%]{position:absolute;display:flex;flex-direction:column;top:calc(var(--ghs-unit) * 12.2 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 93 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 26.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 33 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .imbuement[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .donations[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{justify-content:center;margin-bottom:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .imbuement.donations[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .donations.donations[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 50.8 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 42 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1.7 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]:first-of-type{margin-top:0}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]{display:flex;align-items:center;height:100%}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]:not(:first-child){margin-left:calc(var(--ghs-unit) * -.2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));box-shadow:none;z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .click[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * -.1 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:before{top:0;left:0;transform:scale(0) translate(-37%,-10%)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox.checked[_ngcontent-%COMP%]:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover:before{transform:scale(1) translate(-37%,-10%)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * -.1 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor));display:flex;justify-content:flex-end;align-items:center;font-family:var(--ghs-font-fh-text);font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor));z-index:2}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * -.6 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));background-size:100% 100%;background-image:url(right.237a6836b42aa12a.svg)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section.prosperity-tick[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section.prosperity-tick[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section.prosperity-tick[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-title);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * -.1 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section.prosperity-tick[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .checklist-container[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section.prosperity-tick[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:before{margin-top:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 82 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 90 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-title);flex-direction:row;align-self:flex-start;font-size:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));align-items:center;width:auto;margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));height:auto;align-self:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]{position:relative;margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]:not(:first-child){margin-left:calc(var(--ghs-unit) * -.2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.break[_ngcontent-%COMP%]{margin-left:0}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));box-shadow:none;z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .click[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-normal);position:absolute;top:calc(var(--ghs-unit) * 1.9 * var(--ghs-dialog-factor));left:0;right:initial;z-index:2;color:var(--ghs-color-white);background:var(--ghs-color-darkgray);width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.1 * var(--ghs-dialog-factor));clip-path:polygon(0% 0%,0% 65%,50% 100%,100% 65%,100% 0%)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.large[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * -.1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.large[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-bottom:calc(var(--ghs-unit) * -.2 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 8.5 * var(--ghs-dialog-factor));min-width:calc(var(--ghs-unit) * 8.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:before{top:0;left:0;transform:scale(0) translate(-37%,-10%)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox.checked[_ngcontent-%COMP%]:before, .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover:before{transform:scale(1) translate(-37%,-10%)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * -.1 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor));display:flex;justify-content:flex-end;align-items:center;z-index:2}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.section[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * -.6 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));background-size:100% 100%;background-image:url(right.237a6836b42aa12a.svg)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .sheet.gh2e-sheet[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{flex-basis:100%}.party-sheet-dialog[_ngcontent-%COMP%]   .container.fh-container[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 120.5 * var(--ghs-dialog-factor));overflow-x:hidden}.party-sheet-dialog[_ngcontent-%COMP%]   .container.gh2e-container[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 120.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .toggle-fh-sheet[_ngcontent-%COMP%]{cursor:pointer;position:relative;bottom:0;left:49%;transform:translate(-50%);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .wip[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));display:flex;justify-content:center;align-items:center;height:100%;color:var(--ghs-color-red);flex-basis:0}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .wip.warning[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .warning.warning[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .wip[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:auto;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));filter:var(--ghs-filter-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .wip.warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .warning.warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]{display:flex;width:calc(var(--ghs-unit) * 62 * var(--ghs-dialog-factor));max-width:100%;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-end;align-items:flex-end;width:calc(var(--ghs-unit) * 12 * var(--ghs-dialog-factor));height:100%;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   .toggle-wrapped[_ngcontent-%COMP%]{cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{display:flex;height:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]{display:flex;align-items:flex-end;height:100%;overflow:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor));margin-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity.fh[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity.fh[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]{flex-direction:row;align-items:center;justify-content:flex-start}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity.fh[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity.fh[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]{position:relative}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity.fh[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]:not(:first-child){margin-left:calc(var(--ghs-unit) * -.1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity.fh[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);box-shadow:none;z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity.fh[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor));font-family:var(--ghs-font-normal);position:absolute;top:0;left:0;right:0;z-index:2}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity.fh[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.large[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity.fh[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .tick.large[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-bottom:calc(var(--ghs-unit) * -.3 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity.wrapped[_ngcontent-%COMP%]{height:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .prosperity.wrapped[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]{flex-wrap:wrap}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 62 * var(--ghs-dialog-factor));max-width:100%}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]{width:100%}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{justify-content:space-between}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .campaign-mode[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .campaign-mode[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow-y:auto;max-height:30vh}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]{position:relative;display:grid;grid-template-columns:.7fr .7fr 2fr 1fr;text-align:left;width:calc(var(--ghs-unit) * 62 * var(--ghs-dialog-factor));max-width:100%;padding:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-bottom:calc(var(--ghs-unit) * .05 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario.header[_ngcontent-%COMP%]{font-weight:700;border-bottom:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario.header.legend[_ngcontent-%COMP%]{position:sticky;top:0;background-color:var(--ghs-color-white);z-index:1;padding:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario.header.legend[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(4){justify-content:flex-start}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]:not(.header):nth-child(odd):before{content:" ";position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--ghs-color-lightgray);z-index:-1}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:1/span 4;text-align:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .scenario-title[_ngcontent-%COMP%]{position:relative}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .blocked[_ngcontent-%COMP%]{text-decoration:line-through}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .blocked[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .locked[_ngcontent-%COMP%]{color:var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .locked[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario.seperator[_ngcontent-%COMP%]{border-bottom:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) solid var(--ghs-color-black)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   img.ghs-svg.solo[_ngcontent-%COMP%]{filter:none;height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2), .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(4){justify-content:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-manual[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-manual[_ngcontent-%COMP%]   img.manual[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-manual[_ngcontent-%COMP%]   img.remove[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-shadow);height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));display:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-manual[_ngcontent-%COMP%]:hover   img.remove[_ngcontent-%COMP%]{display:inline-block}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-manual[_ngcontent-%COMP%]:hover   img.manual[_ngcontent-%COMP%]{display:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .locked[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .locked[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:auto;filter:var(--ghs-filter-yellow)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .rewards[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .rewards[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor));width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-success[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-success[_ngcontent-%COMP%]   img.success[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 1.3 * var(--ghs-dialog-factor));filter:var(--ghs-filter-green)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-success[_ngcontent-%COMP%]   img.remove[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 1.3 * var(--ghs-dialog-factor));filter:var(--ghs-filter-red) var(--ghs-filter-shadow);display:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-success.casual[_ngcontent-%COMP%]   img.success[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));filter:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-success.casual[_ngcontent-%COMP%]   img.remove[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-success[_ngcontent-%COMP%]:hover   img.remove[_ngcontent-%COMP%]{display:inline-block}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .toggle-success[_ngcontent-%COMP%]:hover   img.success[_ngcontent-%COMP%]{display:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .add-success[_ngcontent-%COMP%]{position:relative;cursor:pointer;border:calc(var(--ghs-unit) * .05 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .add-success[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:none;position:absolute}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .add-success[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{display:inline-block}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .add-success.disabled[_ngcontent-%COMP%]{pointer-events:initial;cursor:not-allowed;border-color:var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .add-success.disabled[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{display:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario.unlock[_ngcontent-%COMP%]{position:sticky;bottom:0;display:flex;align-items:center;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .05 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray);background-color:var(--ghs-color-white)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario.unlock[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 1.4 * var(--ghs-dialog-factor));width:auto;margin:0 calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario.unlock[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) * .05 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray);outline:none;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));width:0;flex-grow:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario.unlock[_ngcontent-%COMP%]   .addScenario[_ngcontent-%COMP%]{color:var(--ghs-color-black);cursor:pointer;display:flex;justify-content:flex-end;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario.unlock[_ngcontent-%COMP%]   .addScenario[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 1.3 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .scenarios[_ngcontent-%COMP%]   .scenario.unlock[_ngcontent-%COMP%]   .addScenario[_ngcontent-%COMP%]:hover{opacity:.7}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]{display:flex;flex-direction:column}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .player[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .player[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{padding-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));border-right:2px solid var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .player[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex-grow:1;font-size:1em;line-height:.7em;margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .player[_ngcontent-%COMP%]   .available-characters[_ngcontent-%COMP%]{display:flex}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .player[_ngcontent-%COMP%]   .available-characters[_ngcontent-%COMP%]   .available-character[_ngcontent-%COMP%]{cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .player[_ngcontent-%COMP%]   .available-characters[_ngcontent-%COMP%]   .available-character[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .player[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .player[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));filter:var(--ghs-filter-red) var(--ghs-filter-shadow)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .player[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]:hover{opacity:.7}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;color:var(--ghs-color-black);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .players[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]:hover{opacity:.7}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .battle-goals[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .events[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;color:var(--ghs-color-black);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow-y:auto;max-height:30vh}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{position:relative;display:grid;grid-template-columns:1fr 2fr 1.8fr 1fr 1fr .5fr;text-align:left;width:calc(var(--ghs-unit) * 62 * var(--ghs-dialog-factor));max-width:100%;padding:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-bottom:calc(var(--ghs-unit) * .05 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character.header[_ngcontent-%COMP%]{font-weight:700;border-bottom:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character.header.legend[_ngcontent-%COMP%]{position:sticky;top:0;background-color:var(--ghs-color-white);z-index:1;padding:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character.header.legend[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{overflow:hidden;justify-content:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:1/span 4;text-align:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:center;border:none;outline:none;min-width:0}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character.seperator[_ngcontent-%COMP%]{border-bottom:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) solid var(--ghs-color-black)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{display:flex;align-items:center;padding:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   span.link[_ngcontent-%COMP%]{cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   span.link[_ngcontent-%COMP%]:hover{opacity:.7}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]:not(.separator) > span[_ngcontent-%COMP%]{border-bottom:calc(var(--ghs-unit) * .05 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray);border-right:calc(var(--ghs-unit) * .05 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:none;height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(1), .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(4), .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(5), .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(6), .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(7){justify-content:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .reactivate[_ngcontent-%COMP%]{cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .retirements[_ngcontent-%COMP%]   .list.fh-sheet[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{grid-template-columns:1fr 2fr 1.8fr 1fr 1fr 1.4fr .5fr}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .bottom-sheet[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .bottom-sheet[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .bottom-sheet[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]{height:auto;display:flex;flex-direction:column;margin-top:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .treasures-title[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasures-title[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .treasures-title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasures-title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]{height:auto;width:100%}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .achievements[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .achievements-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{width:initial}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);display:grid;grid-template-columns:.5fr .2fr 2fr;border-bottom:calc(var(--ghs-unit) * .05 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);width:100%;min-width:0;margin:0;text-align:right}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);display:flex;cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-green);width:auto;height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-add[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-add[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]{max-height:calc(var(--ghs-unit) * 20 * var(--ghs-dialog-factor));overflow-y:auto;font-size:.9em}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]{display:grid;grid-template-columns:.3fr .2fr .2fr 2fr .2fr;align-items:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%] > *[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%] > *[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%] > *[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%] > *[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%] > *[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%] > *[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%] > *[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:100%}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item.edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure.edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item.edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure.edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item.edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure.edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item.edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure.edition[_ngcontent-%COMP%]{grid-template-columns:.3fr .2fr .2fr 2fr .2fr 1fr}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:.9em;justify-self:end}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;justify-self:initial}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .treasure-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .item-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .treasure-index.treasure-index[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%]{cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .open-item[_ngcontent-%COMP%]:hover{opacity:.7}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{cursor:crosshair;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));text-align:center}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]:hover{opacity:.7}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]{text-align:right}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:.9em;justify-self:start}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{cursor:pointer;justify-self:start;position:relative;border:calc(var(--ghs-unit) * .05 * var(--ghs-dialog-factor)) solid var(--ghs-color-black);display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{position:absolute}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{top:0;left:calc(var(--ghs-unit) * -.8 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));filter:var(--ghs-filter-red);display:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover, .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover{border:none;box-shadow:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .check[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .check[_ngcontent-%COMP%]{display:none}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .close[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]:hover   .close[_ngcontent-%COMP%]{display:inline-block}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .treasure-list[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:.9em;justify-self:start;white-space:nowrap;overflow-x:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .donations[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:calc(var(--ghs-unit) * 10 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .donations[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]{display:flex;align-items:center;height:100%;overflow:auto}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .donations[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .donation[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 6.2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 6.2 * var(--ghs-dialog-factor));overflow:hidden}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .donations[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .donation[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{position:absolute;left:0;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));z-index:2}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .donations[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .donation[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{z-index:2}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .donations[_ngcontent-%COMP%]   .checklist[_ngcontent-%COMP%]   .donation[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:0;left:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor));width:100%;height:100%;z-index:1}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .envelope-b[_ngcontent-%COMP%]{display:flex;flex-direction:column}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .envelope-b[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .envelope-b[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * .5)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .envelope-b[_ngcontent-%COMP%]   .lines[_ngcontent-%COMP%]{display:flex;flex-direction:column}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .envelope-b[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .envelope-b[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;margin:calc(var(--ghs-unit) * .5);font-size:.8em;font-family:var(--ghs-font-gh-title)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .envelope-b[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkpoint[_ngcontent-%COMP%]{display:block;position:relative;border-radius:100%;width:calc(var(--ghs-unit) * 2.3);height:calc(var(--ghs-unit) * 2.3);cursor:pointer}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .envelope-b[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkpoint[_ngcontent-%COMP%]:after{content:" ";position:absolute;inset:0;border-radius:100%;background-color:var(--ghs-color-gray);-webkit-mask-image:url(env-b.4ee9bb75787ae4e2.svg);mask-image:url(env-b.4ee9bb75787ae4e2.svg);-webkit-mask-size:100% 100%;mask-size:100% 100%}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .envelope-b[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkpoint.prosperity[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-yellow);-webkit-mask-image:url(env-b-prosp.fe4db76e5ece856d.svg);mask-image:url(env-b-prosp.fe4db76e5ece856d.svg)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .envelope-b[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkpoint[_ngcontent-%COMP%]:before{content:" ";position:absolute;left:50%;top:50%;width:110%;height:110%;transform:scale(0);transform-origin:top left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;z-index:1;background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;filter:var(--ghs-filter-red)}.party-sheet-dialog[_ngcontent-%COMP%]   .container.campaign-container[_ngcontent-%COMP%]   .campaign[_ngcontent-%COMP%]   .envelope-b[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .checkpoint.checked[_ngcontent-%COMP%]:before{transform:scale(1) translate(-50%,-50%)}.party-sheet-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%}.party-sheet-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;margin-left:calc(var(--ghs-unit) * -4 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2.4 * var(--ghs-dialog-factor));text-transform:uppercase;flex-basis:initial}.party-sheet-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.party-sheet-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]:hover{color:var(--ghs-color-gray)}.party-sheet-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.party-sheet-dialog[_ngcontent-%COMP%]   .scroll-container.denied[_ngcontent-%COMP%]   .campaign-toggle[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .scroll-container.denied[_ngcontent-%COMP%]   .campaign-toggle[_ngcontent-%COMP%]   *[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .scroll-container.denied[_ngcontent-%COMP%]   .export[_ngcontent-%COMP%], .party-sheet-dialog[_ngcontent-%COMP%]   .scroll-container.denied[_ngcontent-%COMP%]   .export[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{pointer-events:initial}']})}return i})();const Ka=i=>({disabled:i}),GV=(i,r,e)=>[i,r,e],TV=()=>[],SV=(i,r)=>({none:i,manual:r});function $V(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",15),t.bIt("singleClick",function(){const n=t.eBV(e).$index,o=t.XpG();return t.Njj(o.unspentPoints(n))})("doubleClick",function(){const n=t.eBV(e).$index,o=t.XpG();return t.Njj(o.unspentPoints(n,!0))}),t.nrm(1,"span",16),t.k0s()}if(2&i){const e=r.$implicit;t.R7$(),t.Y8G("ghs-placeholder","game.attackmodifier.minus"+e)}}function DV(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",17),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.addSpentPoints(n))})("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.addSpentPoints(n,!0))}),t.nrm(1,"span",16),t.k0s()}if(2&i){const e=r.$implicit;t.R7$(),t.Y8G("ghs-placeholder","game.attackmodifier.minus"+e)}}function IV(i,r){if(1&i&&(t.j41(0,"div",19),t.nrm(1,"img",25),t.j41(2,"span",21)(3,"div",22),t.nrm(4,"span",5),t.k0s()()()),2&i){const e=t.XpG().$implicit;t.R7$(),t.Y8G("ngClass",t.l_i(2,SV,!e.automation,"manual"==e.automation)),t.R7$(3),t.Y8G("ghs-label","game.data.favors."+e.edition+"."+e.name+".automation")}}function AV(i,r){1&i&&t.nrm(0,"span")}function VV(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",26),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.unselectFavor(n))})("doubleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.unselectFavor(n,!0))}),t.nrm(1,"img",27),t.k0s()}}function FV(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",10)(1,"label",18),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.selectFavor(n))})("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.selectFavor(n,!0))}),t.k0s(),t.j41(2,"div",19),t.nrm(3,"img",20),t.j41(4,"span",21)(5,"div",22),t.nrm(6,"span",5),t.k0s()()(),t.nVh(7,IV,5,5,"div",19),t.nVh(8,AV,1,0,"span"),t.j41(9,"div",23),t.Z7z(10,VV,2,0,"span",24,t.fX1),t.nI1(12,"ghsRange"),t.k0s()()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG();t.Y8G("ngClass",t.eq3(9,Ka,n.availablePoints<e.points)),t.R7$(),t.Y8G("ghs-label","scenario.favors.label"+(e.points>1?".multiple":""))("ghs-label-args",t.sMw(11,GV,e.edition,e.name,""+e.points)),t.R7$(5),t.Y8G("ghs-label","game.data.favors."+e.edition+"."+e.name+".text"),t.R7$(),t.vxM(n.settingsManager.settings.fhTrialsApply?7:-1),t.R7$(),t.vxM(n.settingsManager.settings.fhTrialsApply?-1:8),t.R7$(2),t.Dyx(t.i5U(12,6,t.lJ4(15,TV),n.activeFavors[a]))}}let wr=(()=>{class i{dialogRef;favors=[];activeFavors=[];availablePoints=0;spentPoints=0;leftPoints=[];gameFavors=[];gameFavorPoints=[];change=!1;disabled=!1;gameManager=s.E;settingsManager=m.f;constructor(e){this.dialogRef=e}ngOnInit(){const e=s.E.editionData.find(a=>a.edition==s.E.currentEdition()&&a.favors);e&&(this.favors=e.favors),this.gameFavors=s.E.game.favors.map(a=>new vt.gw(a.name,a.edition)),this.gameFavorPoints=s.E.game.favorPoints.map(a=>+a),this.update(!1)}update(e=!0){this.change=e,this.disabled=!s.E.roundManager.firstRound,this.activeFavors=[],this.favors.forEach((a,n)=>{this.activeFavors[n]=this.gameFavors.filter(o=>o.edition==a.edition&&o.name==a.name).length}),this.spentPoints=this.activeFavors.length?this.activeFavors.map((a,n)=>a*this.favors[n].points).reduce((a,n)=>a+n):0,this.availablePoints=Math.min(Math.max((this.gameFavorPoints.length?this.gameFavorPoints.reduce((a,n)=>a+n):0)-this.spentPoints,0),7),this.leftPoints=s.E.game.monsterAttackModifierDeck.cards.filter(a=>a.type==Y.Yn.minus1||a.type==Y.Yn.minus2).map(a=>a.type==Y.Yn.minus1?1:2),this.gameFavorPoints.forEach(a=>{this.leftPoints.splice(this.leftPoints.indexOf(a),1)})}toggleKeep(){s.E.stateManager.before(s.E.game.keepFavors?"favorKeepOff":"favorKeepOn"),s.E.game.keepFavors=!s.E.game.keepFavors,s.E.stateManager.after()}addSpentPoints(e,a=!1){(!this.disabled&&-1!=this.leftPoints.indexOf(e)&&(!this.gameFavorPoints.length||this.gameFavorPoints.reduce((n,o)=>n+o)+e<=7)||a)&&(this.gameFavorPoints.push(e),this.update())}unspentPoints(e,a=!1){(!this.disabled&&this.gameFavorPoints.reduce((n,o)=>n+o)-this.gameFavorPoints[e]>=this.spentPoints||a)&&(this.gameFavorPoints.splice(e,1),this.update())}selectFavor(e,a=!1){(!this.disabled&&this.availablePoints>=e.points||a)&&(this.gameFavors.push(new vt.gw(e.name,e.edition)),this.update())}unselectFavor(e,a=!1){const n=this.gameFavors.find(o=>o.edition==e.edition&&o.name==e.name);n&&(!this.disabled||a)&&(this.gameFavors.splice(this.gameFavors.indexOf(n),1),this.update())}close(){this.dialogRef.close()}apply(){if(this.change){for(s.E.stateManager.before("applyFavorSelection");this.availablePoints;)this.availablePoints>2&&-1!=this.gameFavorPoints.indexOf(2)?(this.gameFavorPoints.splice(this.gameFavorPoints.indexOf(2),1),this.availablePoints-=2):(this.gameFavorPoints.splice(this.gameFavorPoints.indexOf(1),1),this.availablePoints--);s.E.game.favors=this.gameFavors,s.E.game.favorPoints=this.gameFavorPoints,s.E.stateManager.after(),this.dialogRef.close()}}confirm(e){m.f.settings.keyboardShortcuts&&"Enter"===e.key&&(this.apply(),e.preventDefault(),e.stopPropagation())}static \u0275fac=function(a){return new(a||i)(t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-favors"]],hostBindings:function(a,n){1&a&&t.bIt("keydown",function(g){return n.confirm(g)},t.EBC)},standalone:!1,decls:21,vars:11,consts:[[1,"favors-container",3,"ngClass"],[1,"header"],[1,"title",3,"ghs-label"],[1,"header-menu"],["tabclick","","type","checkbox",3,"change","checked"],[3,"ghs-label"],[1,"points"],["ghs-pointer-input","",1,"point","spent"],["ghs-pointer-input","",1,"point","left"],[1,"favors"],[1,"favor",3,"ngClass"],[1,"buttons"],[1,"cancel",3,"click"],[1,"spacer"],["ghs-pointer-input","",1,"apply",3,"singleClick","ngClass"],["ghs-pointer-input","",1,"point","spent",3,"singleClick","doubleClick"],[3,"ghs-placeholder"],["ghs-pointer-input","",1,"point","left",3,"singleClick","doubleClick"],["ghs-pointer-input","",1,"text-white",3,"singleClick","doubleClick","ghs-label","ghs-label-args"],[1,"hint-container"],["src","./assets/images/hint.svg",1,"hint-trigger","ghs-svg"],[1,"hint"],[1,"text"],[1,"checks"],["ghs-pointer-input","",1,"check"],["src","./assets/images/automation.svg",1,"hint-trigger","automation","ghs-svg",3,"ngClass"],["ghs-pointer-input","",1,"check",3,"singleClick","doubleClick"],["src","./assets/images/check.svg",1,"ghs-svg"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"span",2),t.k0s(),t.j41(3,"div",3)(4,"label")(5,"input",4),t.bIt("change",function(){return n.toggleKeep()}),t.k0s(),t.nrm(6,"span",5),t.k0s()(),t.j41(7,"div",6),t.Z7z(8,$V,2,1,"div",7,t.fX1),t.Z7z(10,DV,2,1,"div",8,t.fX1),t.k0s(),t.j41(12,"div",9),t.Z7z(13,FV,13,16,"div",10,t.fX1),t.k0s(),t.j41(15,"div",11)(16,"a",12),t.bIt("click",function(){return n.close()}),t.nrm(17,"span",5),t.k0s(),t.nrm(18,"span",13),t.j41(19,"a",14),t.bIt("singleClick",function(){return n.apply()}),t.nrm(20,"span",5),t.k0s()()()),2&a&&(t.Y8G("ngClass",t.eq3(7,Ka,n.disabled)),t.R7$(2),t.Y8G("ghs-label","scenario.favors"),t.R7$(3),t.Y8G("checked",n.gameManager.game.keepFavors),t.R7$(),t.Y8G("ghs-label","scenario.favors.keep"),t.R7$(2),t.Dyx(n.gameFavorPoints),t.R7$(2),t.Dyx(n.leftPoints),t.R7$(3),t.Dyx(n.favors),t.R7$(4),t.Y8G("ghs-label","cancel"),t.R7$(2),t.Y8G("ngClass",t.eq3(9,Ka,!n.change)),t.R7$(),t.Y8G("ghs-label","scenario.favors.apply"))},dependencies:[N.YU,tt,Zl,rt,At,Tt],styles:[".favors-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;color:var(--ghs-color-white)}.favors-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;justify-content:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.favors-container[_ngcontent-%COMP%]   .points[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.favors-container[_ngcontent-%COMP%]   .points[_ngcontent-%COMP%]   .point[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));margin:0 calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor))}.favors-container[_ngcontent-%COMP%]   .points[_ngcontent-%COMP%]   .point.spent[_ngcontent-%COMP%]{filter:grayscale(.5) brightness(.5)}.favors-container[_ngcontent-%COMP%]   .header-menu[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.favors-container[_ngcontent-%COMP%]   .header-menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));display:flex;justify-content:center;align-items:center}.favors-container[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));display:flex;flex-direction:column}.favors-container[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]   .favor[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr .5fr .5fr 1fr;font-family:var(--ghs-font-text);width:calc(var(--ghs-unit) * 35 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.favors-container[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]   .favor[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer}.favors-container[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]   .favor.disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{opacity:.5}.favors-container[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]   .favor[_ngcontent-%COMP%]   .automation[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.favors-container[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]   .favor[_ngcontent-%COMP%]   .automation.manual[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.favors-container[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]   .favor[_ngcontent-%COMP%]   .automation.none[_ngcontent-%COMP%]{filter:var(--ghs-filter-red)}.favors-container[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]   .favor[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;flex-wrap:wrap}.favors-container[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]   .favor[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{cursor:zoom-out;display:flex;justify-content:center;align-items:center;margin:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor))}.favors-container[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]   .favor[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:auto;filter:var(--ghs-filter-white)}.favors-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly}.favors-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}.favors-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.favors-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.favors-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.favors-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-darkgray)}.favors-container.disabled[_ngcontent-%COMP%]   .points[_ngcontent-%COMP%]   .point[_ngcontent-%COMP%], .favors-container.disabled[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]   .favor[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .favors-container.disabled[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{cursor:initial}"]})}return i})();const XV=i=>({disabled:i}),Wa=(i,r)=>({active:i,disabled:r}),BV=(i,r,e,a)=>({"level-1":i,"level-2":r,"level-3":e,"level-4":a}),YV=()=>[],NV=(i,r,e)=>({harvest:i,plant:r,disabled:e}),zV=(i,r)=>r.edition+"-"+r.name;function LV(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",20),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.harvest())}),t.k0s()}2&i&&t.Y8G("ghs-label","data.buildings.garden.plots.harvest")}function UV(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",21),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.setActive(n))})("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.setActive(n,!0))}),t.nrm(1,"img",22),t.j41(2,"span",16),t.EFF(3),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.l_i(3,Wa,a.activeHerb==e,a.activeHerb!=e&&!a.resources[e]||a.garden.flipped)),t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+e+".svg",t.B4B),t.R7$(2),t.JRh(a.resources[e])}}function qV(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",15),t.bIt("click",function(){const n=t.eBV(e).$index,o=t.XpG();return t.Njj(o.selectSource(n))}),t.nrm(1,"img",23),t.j41(2,"span",16),t.EFF(3),t.k0s()()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG();t.Y8G("ngClass",t.l_i(3,Wa,n.currentSource==a,!n.currentResources[a])),t.R7$(),t.Y8G("src",e.iconUrl,t.B4B),t.R7$(2),t.JRh(n.currentResources[a])}}function HV(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",24),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.plantHerb(n))})("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.plantHerb(n,!0))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.HbH("plot-"+(e+1)+(a.garden.plots[e]?" "+a.garden.plots[e]:"")+(a.activeHerb?" plant-"+a.activeHerb:"")),t.Y8G("ngClass",t.sMw(3,NV,a.garden.plots[e],!a.garden.plots[e],a.garden.plots[e]==a.activeHerb||a.disabled))}}let KV=(()=>{class i{level=0;slots=0;garden;herbs=ot.Pr;activeHerb;disabled=!1;resources={};currentResources=[];characters=[];currentSource=-1;harvested=!1;settingsManager=m.f;ngOnInit(){this.update(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.update()})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.garden=s.E.game.party.garden||new Ge.j;const e=s.E.game.party.buildings.find(a=>"garden"==a.name&&a.level);if(e){switch(this.level=e.level,this.level){case 1:this.slots=1;break;case 2:case 3:this.slots=2;break;case 4:this.slots=3}e.level>2&&this.garden.flipped&&(this.garden.flipped=!1)}this.disabled=null!=s.E.game.scenario,this.resources={},this.characters=s.E.game.figures.filter(a=>a instanceof q.K).map(a=>a),this.herbs.forEach(a=>{this.resources[a]=s.E.game.party.loot[a]||0,this.characters.forEach(n=>{this.resources[a]=(this.resources[a]||0)+(n.progress.loot[a]||0)}),!this.activeHerb&&this.resources[a]&&(this.activeHerb=a)}),this.activeHerb&&(this.currentResources=[],this.currentSource=-1,this.characters.forEach((a,n)=>{this.activeHerb&&(this.currentResources[n]=a.progress.loot[this.activeHerb]||0,this.currentResources[n]&&-1==this.currentSource&&(this.currentSource=n))}),this.currentResources[this.characters.length]=s.E.game.party.loot[this.activeHerb]||0,this.currentResources[this.characters.length]&&(this.currentSource=this.characters.length))}setActive(e,a=!1){(this.activeHerb==e||this.resources[e]||a)&&(this.activeHerb=this.activeHerb==e?void 0:e),this.update()}selectSource(e){this.currentResources[e]&&(this.currentSource=e)}plantHerb(e,a=!1){if(this.activeHerb&&(!this.disabled&&(this.level>2||!this.garden.flipped)&&-1!=this.currentSource&&this.currentResources[this.currentSource]||a)&&e>=0&&e<this.slots&&-1!=this.herbs.indexOf(this.activeHerb)&&this.garden.plots[e]!=this.activeHerb){if(s.E.stateManager.before("buildings.garden.plant",this.activeHerb,e),this.garden.plots=this.garden.plots||[],this.garden.plots[e]=this.activeHerb,!a)if(this.currentSource==this.characters.length)s.E.game.party.loot[this.activeHerb]=(s.E.game.party.loot[this.activeHerb]||1)-1;else{const n=this.characters[this.currentSource];n&&(n.progress.loot[this.activeHerb]=(n.progress.loot[this.activeHerb]||1)-1)}s.E.game.party.garden=Object.assign(new Ge.j,this.garden),s.E.stateManager.after()}}flipGarden(e=!1){(!this.disabled||e)&&this.level&&this.level<3&&(s.E.stateManager.before("buildings.garden."+(this.garden.flipped?"flipPlant":"flipHarvest")),this.garden.flipped=!this.garden.flipped,s.E.game.party.garden=Object.assign(new Ge.j,this.garden),s.E.stateManager.after())}toggleAutomation(){m.f.settings.automaticPassTime&&(s.E.stateManager.before("buildings.garden."+(this.garden.automated?"automationOff":"automationOn")),this.garden.automated=!this.garden.automated,s.E.game.party.garden=Object.assign(new Ge.j,this.garden),s.E.stateManager.after())}harvest(){s.E.stateManager.before("buildings.garden.harvest"),this.garden.plots.forEach(e=>{s.E.game.party.loot[e]=(s.E.game.party.loot[e]||0)+1}),this.harvested=!0,this.update(),s.E.stateManager.after()}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-garden"]],standalone:!1,decls:28,vars:26,consts:[[1,"garden-container"],[1,"menu"],[1,"title",3,"ghs-label"],[1,"state-menu"],["ghs-pointer-input","",1,"state",3,"doubleClick","ghs-label"],[1,"hint-container"],[3,"ngClass"],["type","checkbox",3,"change","checked","disabled"],[3,"ghs-label"],["src","./assets/images/hint.svg",1,"hint-trigger","ghs-svg"],[1,"hint"],[1,"text",3,"ghs-label"],[1,"herbs"],["ghs-pointer-input","",1,"herb",3,"ngClass"],[1,"sources"],[1,"source",3,"click","ngClass"],[1,"value"],[1,"source",3,"ngClass"],[1,"garden",3,"ngClass"],["ghs-pointer-input","",1,"plot",3,"class","ngClass"],[3,"click","ghs-label"],["ghs-pointer-input","",1,"herb",3,"singleClick","doubleClick","ngClass"],[1,"ghs-svg",3,"src"],[1,"character-icon",3,"src"],["ghs-pointer-input","",1,"plot",3,"singleClick","doubleClick","ngClass"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"div",2),t.j41(3,"div",3)(4,"div",4),t.bIt("doubleClick",function(){return n.flipGarden(!0)}),t.k0s(),t.j41(5,"div",5)(6,"label",6)(7,"input",7),t.bIt("change",function(){return n.toggleAutomation()}),t.k0s(),t.nrm(8,"span",8),t.k0s(),t.nrm(9,"img",9),t.j41(10,"span",10),t.nrm(11,"span",11),t.k0s()(),t.nVh(12,LV,1,1,"a",8),t.k0s(),t.j41(13,"div",12),t.Z7z(14,UV,4,6,"a",13,t.fX1),t.k0s(),t.j41(16,"div",14)(17,"a",15),t.bIt("click",function(){return n.selectSource(n.characters.length)}),t.nrm(18,"span",8),t.EFF(19,":\xa0 "),t.j41(20,"span",16),t.EFF(21),t.k0s()(),t.Z7z(22,qV,4,6,"a",17,zV),t.k0s()(),t.j41(24,"div",18),t.Z7z(25,HV,1,7,"div",19,t.fX1),t.nI1(27,"ghsRange"),t.k0s()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","data.buildings.garden.plots"),t.R7$(2),t.Y8G("ghs-label",n.level<3?n.garden.flipped?"data.buildings.garden.plots.state.harvest":"data.buildings.garden.plots.state.plant":"data.buildings.garden.plots.state.both"),t.R7$(2),t.Y8G("ngClass",t.eq3(15,XV,!n.settingsManager.settings.automaticPassTime)),t.R7$(),t.Y8G("checked",n.garden.automated&&n.settingsManager.settings.automaticPassTime)("disabled",!n.settingsManager.settings.automaticPassTime),t.R7$(),t.Y8G("ghs-label","data.buildings.garden.plots.automated"),t.R7$(3),t.Y8G("ghs-label","data.buildings.garden.plots.automated.hint"),t.R7$(),t.vxM(n.garden.automated&&n.settingsManager.settings.automaticPassTime||n.harvested?-1:12),t.R7$(2),t.Dyx(n.herbs),t.R7$(3),t.Y8G("ngClass",t.l_i(17,Wa,n.currentSource==n.characters.length,!n.currentResources[n.characters.length])),t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.supply"),t.R7$(3),t.JRh(n.currentResources[n.characters.length]),t.R7$(),t.Dyx(n.characters),t.R7$(2),t.Y8G("ngClass",t.ziG(20,BV,1==n.level,2==n.level,3==n.level,4==n.level)),t.R7$(),t.Dyx(t.i5U(27,12,t.lJ4(25,YV),n.slots)))},dependencies:[N.YU,tt,rt,Tt],styles:[".garden-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;color:var(--ghs-color-white)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;flex-direction:column}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{text-align:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .state-menu[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .state-menu[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .state-menu[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .state-menu[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]{cursor:not-allowed}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .state-menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:space-evenly;align-items:center;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:auto}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]   img.character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]   img.character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]   img.character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]   img.character-icon[_ngcontent-%COMP%]{filter:grayscale(.2) brightness(.6)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb.active[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source.active[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb.active[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source.active[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb.active[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source.active[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb.active[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source.active[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb.active[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source.active[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb.active[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source.active[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%]{filter:none}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]:hover, .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]:hover, .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]:hover, .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]:hover   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]:hover   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb[_ngcontent-%COMP%]:hover   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source[_ngcontent-%COMP%]:hover   .character-icon[_ngcontent-%COMP%]{filter:none}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-darkgray)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%]   .character-icon[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-darkgray)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%]:hover   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%]:hover   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%]:hover   .character-icon[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%]:hover   .character-icon[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-darkgray)}.garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%]:hover   .value[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .herbs[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%]:hover   .value[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .herb.disabled[_ngcontent-%COMP%]:hover   .value[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .sources[_ngcontent-%COMP%]   .source.disabled[_ngcontent-%COMP%]:hover   .value[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray)}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]{position:relative;display:block;width:calc(var(--ghs-unit) * 31 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 27.1 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));background-repeat:no-repeat;background-size:contain}.garden-container[_ngcontent-%COMP%]   .garden.level-1[_ngcontent-%COMP%]{background-image:url(fh-24-garden-1.9156a2b827c26633.png)}.garden-container[_ngcontent-%COMP%]   .garden.level-2[_ngcontent-%COMP%]{background-image:url(fh-24-garden-2.f4c51e673dc61afd.png)}.garden-container[_ngcontent-%COMP%]   .garden.level-3[_ngcontent-%COMP%]{background-image:url(fh-24-garden-3.c3ac289e59e46fea.png)}.garden-container[_ngcontent-%COMP%]   .garden.level-4[_ngcontent-%COMP%]{background-image:url(fh-24-garden-4.37718a973baa6031.png)}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot[_ngcontent-%COMP%]{position:absolute;display:block;width:calc(var(--ghs-unit) * 5.7 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 9.9 * var(--ghs-dialog-factor));background-repeat:no-repeat;background-size:0;transform:rotate(-45deg);cursor:pointer}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot[_ngcontent-%COMP%]:hover{background-size:contain;filter:brightness(1.2)}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.disabled[_ngcontent-%COMP%]{cursor:initial}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.disabled[_ngcontent-%COMP%]:hover{filter:brightness(.7) grayscale(.3)}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.arrowvine[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.plant-arrowvine[_ngcontent-%COMP%]:hover{background-image:url(fh-24-garden-arrowvine.5c560f7204eeeb02.png)}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.axenut[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.plant-axenut[_ngcontent-%COMP%]:hover{background-image:url(fh-24-garden-axenut.6052f52ce4efb6d2.png)}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.corpsecap[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.plant-corpsecap[_ngcontent-%COMP%]:hover{background-image:url(fh-24-garden-corpsecap.5c223c12cf589bbe.png)}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.flamefruit[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.plant-flamefruit[_ngcontent-%COMP%]:hover{background-image:url(fh-24-garden-flamefruit.c0ef615e88b2f29c.png)}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.rockroot[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.plant-rockroot[_ngcontent-%COMP%]:hover{background-image:url(fh-24-garden-rockroot.bbb895ccd29d00d4.png)}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.snowthistle[_ngcontent-%COMP%], .garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.plant-snowthistle[_ngcontent-%COMP%]:hover{background-image:url(fh-24-garden-snowthistle.4c3f99f6db17caf8.png)}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.harvest[_ngcontent-%COMP%]{background-size:contain}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.plot-1[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 14.3 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 12.5 * var(--ghs-dialog-factor))}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.plot-2[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 7.2 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 5.5 * var(--ghs-dialog-factor))}.garden-container[_ngcontent-%COMP%]   .garden[_ngcontent-%COMP%]   .plot.plot-3[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 3.6 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 10.5 * var(--ghs-dialog-factor))}"]})}return i})();const WV=["container"],JV=i=>({flipped:i});function ZV(i,r){if(1&i&&(t.j41(0,"div",14),t.nrm(1,"ghs-action",18),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Aen("fh"),t.Y8G("action",e.petCard.action)("textBlack",!0)}}function QV(i,r){1&i&&(t.j41(0,"div",15),t.nrm(1,"span",19),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","%game.card.round%"))}function tF(i,r){1&i&&(t.j41(0,"div",16),t.nrm(1,"span",19),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","%game.card.lost%"))}function eF(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function nF(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",3),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.revealed.emit(n))}),t.j41(1,"div",4)(2,"span",5),t.nrm(3,"span",6),t.k0s(),t.j41(4,"div",7)(5,"span"),t.EFF(6),t.k0s()()(),t.j41(7,"div",8),t.nrm(8,"img",9)(9,"div",10),t.j41(10,"div",11),t.nrm(11,"span",12),t.EFF(12,": "),t.j41(13,"span",13),t.EFF(14),t.nrm(15,"br"),t.k0s()(),t.nVh(16,ZV,2,4,"div",14),t.nVh(17,QV,2,1,"div",15),t.nVh(18,tF,2,1,"div",16),t.j41(19,"div",17),t.nVh(20,eF,2,0,"span"),t.j41(21,"span"),t.EFF(22),t.k0s()()()()}if(2&i){const e=t.XpG();t.xc7("font-size",e.fontsize),t.Y8G("ngClass",t.eq3(15,JV,e.flipped))("disabled",!e.reveal||!1),t.R7$(3),t.Y8G("ghs-label","data.buildings.stables.pets.confirmAdd"),t.R7$(3),t.JRh(e.petCard.id),t.R7$(2),t.Y8G("src","./assets/artwork/pets/"+e.petCard.edition+"-"+e.petCard.id+".png",t.B4B),t.R7$(),t.Y8G("ghs-label","data.pets."+e.petCard.edition+"-"+e.petCard.id),t.R7$(2),t.Y8G("ghs-label","data.buildings.stables.pets.name"),t.R7$(3),t.JRh(e.name),t.R7$(2),t.vxM(e.petCard.action?16:-1),t.R7$(),t.vxM(e.petCard.round?17:-1),t.R7$(),t.vxM(e.petCard.lost?18:-1),t.R7$(2),t.vxM(e.petCard.cardId<1e3?20:-1),t.R7$(2),t.JRh(e.petCard.cardId)}}let iF=(()=>{class i{containerElement;petCard;flipped=!1;reveal=!1;name="";revealed=new t.bkB;settingsManager=m.f;gameManager=s.E;fontsize="1em";ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.fontsize=.072*this.containerElement.nativeElement.offsetWidth+"px"}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}ngAfterViewInit(){setTimeout(()=>{this.fontsize=.072*this.containerElement.nativeElement.offsetWidth+"px"},1)}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-pet-card"]],viewQuery:function(a,n){if(1&a&&t.GBs(WV,5),2&a){let o;t.mGM(o=t.lsd())&&(n.containerElement=o.first)}},inputs:{petCard:"petCard",flipped:"flipped",reveal:"reveal",name:"name"},outputs:{revealed:"revealed"},standalone:!1,decls:3,vars:1,consts:[["container",""],[1,"pet-container"],["card-reveal","",1,"card","vertical","reverse","pet",3,"ngClass","fontSize","disabled"],["card-reveal","",1,"card","vertical","reverse","pet",3,"change","ngClass","disabled"],[1,"card-back","back"],[1,"revealed"],[1,"text",3,"ghs-label"],[1,"id"],[1,"card-front","front"],[1,"artwork",3,"src"],[1,"title",3,"ghs-label"],[1,"name-container"],[1,"label",3,"ghs-label"],[1,"name"],[1,"action"],[1,"round"],["ghs-pointer-input","",1,"lost"],[1,"card-id"],[3,"action","textBlack"],[1,"placeholder","text-white",3,"ghs-label"]],template:function(a,n){1&a&&(t.j41(0,"div",1,0),t.nVh(2,nF,23,17,"div",2),t.k0s()),2&a&&(t.R7$(2),t.vxM(n.petCard?2:-1))},dependencies:[N.YU,ae,Be,tt,rt],styles:[".pet-container[_ngcontent-%COMP%]{position:relative;width:100%;padding-bottom:147%}.pet[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%}.pet[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]{background-image:url(pets-card-front.8af176984078531e.png);background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:.5em;background-clip:padding-box}.pet[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .artwork[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;-webkit-mask-image:url(pets-card-front-mask.ab630ec0123dc838.png);mask-image:url(pets-card-front-mask.ab630ec0123dc838.png);-webkit-mask-size:100% 100%;mask-size:100% 100%;-webkit-mask-position:center center;mask-position:center center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat}.pet[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{position:absolute;top:4%;left:0;width:100%;height:10%;display:flex;color:var(--ghs-color-white);justify-content:center;align-items:center;font-family:var(--ghs-font-fh-title);font-size:1.3em;filter:var(--ghs-filter-outline-thin)}.pet[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]{position:absolute;top:14%;left:5%;width:95%;height:8%;color:var(--ghs-color-white);font-size:.8em;font-family:var(--ghs-font-fh-normal);filter:var(--ghs-filter-outline-thin);display:flex;align-items:center}.pet[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-family:var(--ghs-font-fh-extra);font-size:1.05em;margin-left:3%;flex-grow:1}.pet[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{position:absolute;top:74%;left:5%;width:75%;height:26%;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;font-family:var(--ghs-font-fh-normal);font-size:1.25em;line-height:.8em}.pet[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round[_ngcontent-%COMP%], .pet[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .lost[_ngcontent-%COMP%]{position:absolute;top:72%;left:80%;width:20%;height:13%;display:flex;justify-content:center;align-items:center;text-align:center;font-size:1.8em}.pet[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .round.lost[_ngcontent-%COMP%], .pet[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .lost.lost[_ngcontent-%COMP%]{top:83%}.pet[_ngcontent-%COMP%]   .front[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{position:absolute;bottom:0;left:78%;width:15%;height:6%;display:flex;justify-content:flex-end;align-items:center;font-family:var(--ghs-font-gh-normal);font-size:.65em}.pet[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%]{background-image:url(pets-card-back.79996ec51190a1bf.png);background-size:100% 100%;background-position:center center;background-repeat:no-repeat;border-radius:.5em;background-clip:padding-box}.pet[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{position:absolute;top:0;left:40%;width:20%;height:7%;display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-fh-title);font-size:1.2em}.pet.confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]{position:relative;top:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;text-align:center;color:var(--ghs-color-white);font-size:1.5em;filter:drop-shadow(calc(var(--ghs-unit) * .2) calc(var(--ghs-unit) * .2) calc(var(--ghs-unit) * .2) var(--ghs-color-black))}.pet.confirm[_ngcontent-%COMP%]   .revealed[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{text-align:center}"]})}return i})();const aF=(i,r)=>({full:i,warning:r}),oF=(i,r,e)=>({selected:i,unavailable:r,disabled:e});function sF(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",7),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.edit,n)||(o.edit=n),t.Njj(n)}),t.k0s(),t.nrm(2,"span",8),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.R50("ngModel",e.edit),t.R7$(),t.Y8G("ghs-label","data.buildings.stables.pets.edit")}}function rF(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",9),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.showAll,n)||(o.showAll=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.update())}),t.k0s(),t.nrm(2,"span",8),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.R50("ngModel",e.showAll),t.R7$(),t.Y8G("ghs-label","data.buildings.stables.pets.showAll")}}function cF(i,r){1&i&&(t.j41(0,"div",5),t.nrm(1,"span",8),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","data.buildings.stables.pets.empty"))}function lF(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-pet-card",15),t.bIt("revealed",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.addPet(n))}),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG();t.Y8G("petCard",e.card)("flipped",null!=e.model)("reveal",null==e.model)("name",!a.edit&&e.model?e.model.petname:"")("ngClass",t.sMw(5,oF,(a.select||a.running)&&e.model&&e.model.active,e.model&&e.model.active&&e.model.lost,(!e.model||!e.model.active)&&!a.select&&a.running))}}function gF(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",16),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.toggleActive(n.model))})("doubleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.toggleActive(n.model,!0))}),t.k0s()}}function dF(i,r){if(1&i){const e=t.RV6();t.j41(0,"input",17),t.bIt("change",function(n){t.eBV(e);const o=t.XpG().$implicit,g=t.XpG();return t.Njj(g.updatePet(n,o.model))}),t.k0s()}if(2&i){const e=t.XpG().$implicit;t.Y8G("value",e.model.petname)}}function hF(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",18),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.removePet(n.model))}),t.nrm(1,"img",19),t.k0s()}}function _F(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",20),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.toggleLost(n.model))})("doubleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.toggleLost(n.model,!0))}),t.k0s()}}function mF(i,r){if(1&i&&(t.j41(0,"div",6),t.nVh(1,lF,1,9,"ghs-pet-card",10),t.nVh(2,gF,1,0,"div",11),t.nVh(3,dF,1,1,"input",12),t.nVh(4,hF,2,0,"a",13),t.nVh(5,_F,1,0,"a",14),t.k0s()),2&i){const e=r.$implicit,a=t.XpG();t.R7$(),t.vxM(e.card?1:-1),t.R7$(),t.vxM(!a.edit&&e.model&&(a.select||a.running)?2:-1),t.R7$(),t.vxM(a.edit&&e.model?3:-1),t.R7$(),t.vxM(a.edit&&e.model?4:-1),t.R7$(),t.vxM(!a.edit&&a.running&&e.model&&e.model.active?5:-1)}}let Rr=(()=>{class i{pets=[];edit=!1;select=!1;running=!1;showAll=!1;capacity=0;used=0;active=0;ngOnInit(){this.update(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.updateState()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.select=null!=s.E.game.scenario&&s.E.roundManager.firstRound,this.running=null!=s.E.game.scenario&&!this.select,this.used=0,this.pets=[];const e=s.E.game.party.buildings.find(a=>"stables"==a.name&&a.level);if(e&&(this.active=e.level<3?1:2,this.capacity=4+4*Math.floor(e.level/2)),this.showAll){const a=s.E.editionData.find(n=>n.edition==s.E.currentEdition());a&&a.pets&&a.pets.forEach(n=>{const o=s.E.game.party.pets.find(g=>g.edition==n.edition&&g.name==n.id);o&&this.used++,this.pets.push({card:n,model:o})})}s.E.game.party.pets.forEach(a=>{if(null==this.pets.find(n=>n.model&&n.model.edition&&a.edition&&n.model.name==a.name)){const n=s.E.editionData.find(o=>o.edition==a.edition);if(n&&n.pets){const o=n.pets.find(g=>g.edition==a.edition&&g.id==a.name);this.pets.push({card:o,model:a})}else this.pets.push({card:void 0,model:a});this.used++}}),this.pets.sort((a,n)=>a.model&&!n.model?-1:!a.model&&n.model?1:a.model&&n.model&&a.model.active!=n.model.active?a.model.active?-1:1:a.card&&n.card?a.card.id<n.card.id?-1:1:a.model&&n.model?a.model.name<n.model.name?-1:1:0)}updateState(){s.E.game.party.pets.forEach(e=>{const a=this.pets.find(n=>n.model&&n.model.edition&&e.edition&&n.model.name==e.name);a&&a.model&&(a.model.active=e.active,a.model.lost=e.lost,a.model.petname=e.petname)})}addPet(e){if(e.card&&null==s.E.game.party.pets.find(a=>e.card&&a.edition==e.card.edition&&a.name==e.card.id)){const a=new Fo.j(e.card.id,e.card.edition);s.E.stateManager.before("buildings.stables.pets.add",a.edition,a.name),s.E.game.party.pets.push(a),e.model=a,this.used++,s.E.stateManager.after()}}updatePet(e,a){if(a&&e.target){const n=e.target.value;s.E.stateManager.before(n?"buildings.stables.pets.setName":"buildings.stables.pets.unsetName",a.edition,a.name,n),a.petname=n,s.E.stateManager.after()}}removePet(e){e&&(s.E.stateManager.before("buildings.stables.pets.remove",e.edition,e.name),s.E.game.party.pets=s.E.game.party.pets.filter(a=>a.edition!=e.edition||a.name!=e.name),this.update(),s.E.stateManager.after())}toggleLost(e,a=!1){e&&(!e.lost||a)&&(s.E.stateManager.before(e.lost?"buildings.stables.pets.restore":"buildings.stables.pets.play",e.edition,e.name),e.lost=!e.lost,s.E.stateManager.after())}toggleActive(e,a=!1){if(e&&!this.edit&&(this.select||a)){s.E.stateManager.before(e.active?"buildings.stables.pets.setInactive":"buildings.stables.pets.setActive",e.edition,e.name,e.petname),e.active=!e.active;const n=s.E.game.party.buildings.find(o=>"stables"==o.name&&o.level);for(;!a&&n&&s.E.game.party.pets.filter(o=>o.active).length>(n.level<3?1:2);){const o=s.E.game.party.pets.find(g=>g.active&&g!=e);o&&(o.active=!1)}s.E.stateManager.after()}}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-stables"]],standalone:!1,decls:12,vars:9,consts:[[1,"stables-container"],[1,"menu"],[1,"capacity"],[1,"used",3,"ngClass"],[1,"scroll-container","pet-list"],[1,"empty"],[1,"pet"],["type","checkbox",3,"ngModelChange","ngModel"],[3,"ghs-label"],["type","checkbox",3,"ngModelChange","change","ngModel"],[3,"petCard","flipped","reveal","name","ngClass"],["ghs-pointer-input","",1,"toggle-active"],["type","text",1,"name",3,"value"],[1,"button-remove"],["ghs-pointer-input","",1,"button-lost"],[3,"revealed","petCard","flipped","reveal","name","ngClass"],["ghs-pointer-input","",1,"toggle-active",3,"singleClick","doubleClick"],["type","text",1,"name",3,"change","value"],[1,"button-remove",3,"click"],["src","./assets/images/minus.svg",1,"ghs-svg"],["ghs-pointer-input","",1,"button-lost",3,"singleClick","doubleClick"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"span",2)(3,"span",3),t.EFF(4),t.k0s(),t.EFF(5),t.k0s(),t.nVh(6,sF,3,2,"label"),t.nVh(7,rF,3,2,"label"),t.k0s(),t.j41(8,"div",4),t.nVh(9,cF,2,1,"div",5),t.Z7z(10,mF,6,5,"div",6,t.fX1),t.k0s()()),2&a&&(t.R7$(3),t.Y8G("ngClass",t.l_i(6,aF,n.used==n.capacity,n.used>n.capacity)),t.R7$(),t.JRh(n.used),t.R7$(),t.SpI("/",n.capacity),t.R7$(),t.vxM(n.running?-1:6),t.R7$(),t.vxM(n.running?-1:7),t.R7$(2),t.vxM(n.pets.length?-1:9),t.R7$(),t.Dyx(n.pets))},dependencies:[N.YU,O.Zm,O.BC,O.vS,tt,iF,rt],styles:[".stables-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;color:var(--ghs-color-white)}.stables-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:center;align-items:center;z-index:1}.stables-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .capacity[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.stables-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .capacity[_ngcontent-%COMP%]   .used.full[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.stables-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .capacity[_ngcontent-%COMP%]   .used.warning[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.stables-container[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer;color:var(--ghs-color-white);margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]{position:relative;display:flex;flex-wrap:wrap;justify-content:center;margin:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor)) 0;min-height:calc(var(--ghs-unit) * 40.5 * var(--ghs-dialog-factor))}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-yellow)}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]{position:relative;margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 27 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 40.5 * var(--ghs-dialog-factor))}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   ghs-pet-card[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;border:calc(var(--ghs-unit) * .35 * var(--ghs-dialog-factor)) solid transparent;border-radius:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));overflow:hidden}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   ghs-pet-card.unavailable[_ngcontent-%COMP%]{cursor:initial;border-color:var(--ghs-color-darkgray);filter:grayscale(.7)}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   ghs-pet-card.disabled[_ngcontent-%COMP%]{cursor:not-allowed;opacity:.5}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   ghs-pet-card.edit[_ngcontent-%COMP%]{cursor:initial}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   ghs-pet-card.selectable[_ngcontent-%COMP%]{cursor:pointer}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   ghs-pet-card.selected[_ngcontent-%COMP%]{border-color:var(--ghs-color-green);opacity:1}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   .toggle-active[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;z-index:2}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   input.name[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 6.2 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * 5.35 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 21 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);font-family:var(--ghs-font-fh-extra);filter:var(--ghs-filter-outline-thin);font-size:calc(var(--ghs-unit) * 1.6 * var(--ghs-dialog-factor))}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]{z-index:1;position:absolute;display:flex;cursor:pointer;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-filter-white) var(--ghs-filter-shadow)}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-shadow)}.stables-container[_ngcontent-%COMP%]   .pet-list[_ngcontent-%COMP%]   .pet[_ngcontent-%COMP%]   .button-lost[_ngcontent-%COMP%]{z-index:1;position:absolute;display:block;cursor:pointer;bottom:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * 1.2 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}"]})}return i})();const pF=(i,r,e,a)=>({short:i,"visible-effects":r,"visible-interactions":e,invert:a}),uF=i=>({buildable:i}),ei=i=>({disabled:i}),fF=i=>[i],CF=(i,r)=>r.data.name;function MF(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",9),t.nrm(1,"span",3),t.j41(2,"a",10),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.settingsManager.toggle("buildingEffectsVisible"))}),t.nrm(3,"img",11),t.k0s()(),t.j41(4,"span",12),t.nrm(5,"span",3),t.j41(6,"a",10),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.settingsManager.toggle("buildingInteractionsVisible"))}),t.nrm(7,"img",11),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.buildings.effects"),t.R7$(2),t.Y8G("src","./assets/images/"+(e.settingsManager.settings.buildingEffectsVisible?"wake-lock":"hidden")+".svg",t.B4B),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.buildings.interactions"),t.R7$(2),t.Y8G("src","./assets/images/"+(e.settingsManager.settings.buildingInteractionsVisible?"wake-lock":"hidden")+".svg",t.B4B)}}function vF(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.SpI("(",e.data.id,")")}}function OF(i,r){if(1&i&&(t.j41(0,"span",17)(1,"span",21),t.nrm(2,"img",22),t.k0s(),t.nrm(3,"span",23),t.k0s()),2&i){const e=t.XpG(2).$implicit;t.R7$(),t.Y8G("ghs-tooltip",e.data.effectNormal[e.model.level-1])("originY","top")("overlayY","bottom"),t.R7$(2),t.Y8G("ghs-label",e.data.effectNormal[e.model.level-1])}}function PF(i,r){if(1&i&&(t.j41(0,"span",17)(1,"span",24),t.nrm(2,"img",22),t.k0s(),t.nrm(3,"span",23),t.k0s()),2&i){const e=t.XpG(2).$implicit;t.R7$(),t.Y8G("ghs-tooltip",e.data.effectWrecked[e.model.level-1])("originY","top")("overlayY","bottom"),t.R7$(2),t.Y8G("ghs-label",e.data.effectWrecked[e.model.level-1])}}function bF(i,r){if(1&i&&(t.j41(0,"span",18)(1,"span",21),t.nrm(2,"img",25),t.k0s(),t.nrm(3,"span",23),t.k0s()),2&i){const e=t.XpG(2).$implicit;t.R7$(),t.Y8G("ghs-tooltip",e.data.interactionsAvailable[e.model.level-1])("originY","top")("overlayY","bottom"),t.R7$(2),t.Y8G("ghs-label",e.data.interactionsAvailable[e.model.level-1])}}function kF(i,r){if(1&i&&(t.j41(0,"span",18)(1,"span",24),t.nrm(2,"img",25),t.k0s(),t.nrm(3,"span",23),t.k0s()),2&i){const e=t.XpG(2).$implicit;t.R7$(),t.Y8G("ghs-tooltip",e.data.interactionsUnavailable[e.model.level-1])("originY","top")("overlayY","bottom"),t.R7$(2),t.Y8G("ghs-label",e.data.interactionsUnavailable[e.model.level-1])}}function yF(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",19)(1,"span",26),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openStables())}),t.nrm(2,"img",27),t.k0s(),t.j41(3,"span",28),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openStables())}),t.k0s()()}2&i&&(t.R7$(),t.Y8G("ghs-tooltip","data.buildings.stables.pets.interaction"),t.R7$(2),t.Y8G("ghs-label","data.buildings.stables.pets.interaction"))}function xF(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",20)(1,"span",26),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openGarden())}),t.nrm(2,"img",29),t.k0s(),t.j41(3,"span",28),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openGarden())}),t.k0s()()}2&i&&(t.R7$(),t.Y8G("ghs-tooltip","data.buildings.garden.plots.interaction"),t.R7$(2),t.Y8G("ghs-label","data.buildings.garden.plots.interaction"))}function EF(i,r){if(1&i&&(t.j41(0,"span",9),t.nVh(1,OF,4,4,"span",17),t.nVh(2,PF,4,4,"span",17),t.k0s(),t.j41(3,"span",12),t.nVh(4,bF,4,4,"span",18),t.nVh(5,kF,4,4,"span",18),t.nVh(6,yF,4,2,"span",19),t.nVh(7,xF,4,2,"span",20),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(),t.vxM("normal"===e.model.state&&e.data.effectNormal&&e.data.effectNormal[e.model.level-1]?1:-1),t.R7$(),t.vxM("wrecked"===e.model.state&&e.data.effectWrecked&&e.data.effectWrecked[e.model.level-1]?2:-1),t.R7$(2),t.vxM("normal"===e.model.state&&e.data.interactionsAvailable&&e.data.interactionsAvailable[e.model.level-1]?4:-1),t.R7$(),t.vxM("wrecked"===e.model.state&&e.data.interactionsUnavailable&&e.data.interactionsUnavailable[e.model.level-1]?5:-1),t.R7$(),t.vxM(a.gameManager.buildingsManager.petsEnabled&&"stables"==e.data.name?6:-1),t.R7$(),t.vxM(a.gameManager.buildingsManager.gardenEnabled&&"garden"==e.data.name?7:-1)}}function wF(i,r){if(1&i&&(t.j41(0,"span",30),t.nrm(1,"img",31),t.EFF(2),t.k0s(),t.j41(3,"span",30),t.nrm(4,"img",32),t.EFF(5),t.k0s(),t.j41(6,"span",30),t.nrm(7,"img",33),t.EFF(8),t.k0s(),t.j41(9,"span",30),t.nrm(10,"img",34),t.EFF(11),t.k0s(),t.j41(12,"span",30),t.nrm(13,"img",35),t.EFF(14),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(2),t.SpI(" ",e.data.costs.prosperity||"-"),t.R7$(3),t.SpI(" ",e.data.costs.lumber||"-"),t.R7$(3),t.SpI(" ",e.data.costs.metal||"-"),t.R7$(3),t.SpI(" ",e.data.costs.hide||"-"),t.R7$(3),t.SpI(" ",e.data.costs.gold||"-")}}function RF(i,r){if(1&i&&(t.j41(0,"span",30),t.nrm(1,"img",31),t.EFF(2),t.k0s(),t.j41(3,"span",30),t.nrm(4,"img",32),t.EFF(5),t.k0s(),t.j41(6,"span",30),t.nrm(7,"img",33),t.EFF(8),t.k0s(),t.j41(9,"span",30),t.nrm(10,"img",34),t.EFF(11),t.k0s()),2&i){const e=t.XpG(2).$implicit;t.R7$(2),t.SpI(" ",e.data.upgrades[e.model.level-1].prosperity||"-"),t.R7$(3),t.SpI(" ",e.data.upgrades[e.model.level-1].lumber||"-"),t.R7$(3),t.SpI(" ",e.data.upgrades[e.model.level-1].metal||"-"),t.R7$(3),t.SpI(" ",e.data.upgrades[e.model.level-1].hide||"-")}}function jF(i,r){1&i&&t.nrm(0,"span",38),2&i&&t.Y8G("ghs-label","party.campaign.sheet.buildings.repair.morale")}function GF(i,r){if(1&i&&(t.j41(0,"span",36),t.nrm(1,"span",37),t.j41(2,"span",30),t.nrm(3,"img",32),t.k0s(),t.j41(4,"span",30),t.nrm(5,"img",33),t.k0s(),t.j41(6,"span",30),t.nrm(7,"img",34),t.k0s(),t.nVh(8,jF,1,1,"span",38),t.k0s()),2&i){const e=t.XpG(2).$implicit,a=t.XpG();t.R7$(),t.Y8G("ghs-label","party.campaign.sheet.buildings.repair.costs")("ghs-label-args",t.eq3(3,fF,""+e.data.repair[e.model.level-1])),t.R7$(7),t.vxM(a.gameManager.game.party.morale>0?8:-1)}}function TF(i,r){if(1&i&&(t.nrm(0,"span"),t.j41(1,"span",30),t.nrm(2,"img",32),t.EFF(3),t.k0s(),t.j41(4,"span",30),t.nrm(5,"img",33),t.EFF(6),t.k0s(),t.j41(7,"span",30),t.nrm(8,"img",34),t.EFF(9),t.k0s()),2&i){const e=t.XpG(2).$implicit;t.R7$(3),t.SpI(" ",e.data.rebuild[e.model.level-1].lumber||"-"),t.R7$(3),t.SpI(" ",e.data.rebuild[e.model.level-1].metal||"-"),t.R7$(3),t.SpI(" ",e.data.rebuild[e.model.level-1].hide||"-")}}function SF(i,r){if(1&i&&(t.nVh(0,RF,12,4),t.nVh(1,GF,9,5,"span",36),t.nVh(2,TF,10,3)),2&i){const e=t.XpG().$implicit;t.vxM("normal"==e.model.state&&e.model.level<e.data.upgrades.length+1&&!e.data.upgrades[e.model.level-1].manual?0:-1),t.R7$(),t.vxM("damaged"==e.model.state&&e.data.repair?1:-1),t.R7$(),t.vxM("wrecked"==e.model.state?2:-1)}}function $F(i,r){if(1&i&&t.nrm(0,"span",3),2&i){const e=t.XpG(2).$implicit;t.Y8G("ghs-label","party.campaign.sheet.buildings."+(e.model.level>0?"upgrade":"build"))}}function DF(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",39),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.upgrade(n))})("doubleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.upgrade(n,!0))}),t.nVh(1,$F,1,1,"span",3),t.nrm(2,"img",11),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(7,ei,!a.upgradeable(e)))("ghs-tooltip","party.campaign.sheet.buildings."+(e.model.level>0?"upgrade.hint":"build.hint"))("originX","end")("originY","bottom")("overlayX","end"),t.R7$(),t.vxM(a.short?-1:1),t.R7$(),t.Y8G("src","./assets/images/fh/buildings/"+(e.model.level>0?"upgrade":"build")+".svg",t.B4B)}}function IF(i,r){1&i&&t.nrm(0,"span",3),2&i&&t.Y8G("ghs-label","party.campaign.sheet.buildings.repair")}function AF(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",39),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.repair(n))})("doubleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.repair(n,!0))}),t.nVh(1,IF,1,1,"span",3),t.nrm(2,"img",40),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(6,ei,!a.upgradeable(e)))("ghs-tooltip","party.campaign.sheet.buildings.repair.hint")("originX","end")("originY","bottom")("overlayX","end"),t.R7$(),t.vxM(a.short?-1:1)}}function VF(i,r){1&i&&t.nrm(0,"span",3),2&i&&t.Y8G("ghs-label","party.campaign.sheet.buildings.rebuild")}function FF(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",39),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.rebuild(n))})("doubleClick",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.rebuild(n,!0))}),t.nVh(1,VF,1,1,"span",3),t.nrm(2,"img",41),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(6,ei,!a.upgradeable(e)))("ghs-tooltip","party.campaign.sheet.buildings.rebuild.hint")("originX","end")("originY","bottom")("overlayX","end"),t.R7$(),t.vxM(a.short?-1:1)}}function XF(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",8)(1,"span",13),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.toggleState(n))})("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.toggleState(n,!0))}),t.nrm(2,"span")(3,"span",3),t.k0s(),t.j41(4,"span",4),t.nVh(5,vF,2,1,"span"),t.k0s(),t.j41(6,"span",14),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.rewardsDialog(n))})("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.downgrade(n))}),t.EFF(7),t.k0s(),t.nVh(8,EF,8,6),t.j41(9,"span",15),t.nVh(10,wF,15,5),t.nVh(11,SF,3,3),t.k0s(),t.j41(12,"span",7),t.nVh(13,DF,3,9,"span",16),t.nVh(14,AF,3,8,"span",16),t.nVh(15,FF,3,8,"span",16),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(17,uF,!e.model.level)),t.R7$(),t.Y8G("ngClass",t.eq3(19,ei,!e.model.level||!e.data.repair)),t.R7$(),t.HbH(t.VkB("state ",e.model.state)),t.R7$(),t.Y8G("ghs-label","data.buildings."+e.model.name),t.R7$(2),t.vxM(e.data.id?5:-1),t.R7$(),t.Y8G("ghs-tooltip","party.campaign.sheet.buildings.level.hint")("originY","bottom"),t.R7$(),t.JRh(e.model.level||"-"),t.R7$(),t.vxM(a.short?-1:8),t.R7$(),t.Y8G("ngClass",t.eq3(21,ei,!a.upgradeable(e))),t.R7$(),t.vxM(e.model.level?-1:10),t.R7$(),t.vxM(e.model.level>0?11:-1),t.R7$(2),t.vxM(e.model.level<e.data.upgrades.length+1&&"normal"==e.model.state?13:-1),t.R7$(),t.vxM("damaged"==e.model.state?14:-1),t.R7$(),t.vxM("wrecked"==e.model.state?15:-1)}}let jr=(()=>{class i{dialog;buildings=[];short=!1;invert=!1;change=new t.bkB;gameManager=s.E;settingsManager=m.f;constructor(e){this.dialog=e}upgradeable(e){let a=e.model.level?e.data.upgrades[e.model.level-1]:e.data.costs;if(e.model.level&&!e.data.repair)return!1;if(e.data.repair&&"damaged"==e.model.state){const o=e.data.repair[e.model.level-1];return this.partyResource(ot.r6.lumber)+this.partyResource(ot.r6.metal)+this.partyResource(ot.r6.hide)>o||s.E.game.party.morale>0}let n=null!=s.E.game.party.buildings.find(o=>"carpenter"==o.name&&o.level>0&&"wrecked"!=o.state);if("wrecked"==e.model.state){if(a=e.data.rebuild[e.model.level-1],a.lumber>this.partyResource(ot.r6.lumber)){if(!n||a.lumber!=this.partyResource(ot.r6.lumber)+1)return!1;n=!1}if(a.metal>this.partyResource(ot.r6.metal)){if(!n||a.metal!=this.partyResource(ot.r6.metal)+1)return!1;n=!1}if(a.hide>this.partyResource(ot.r6.hide)){if(!n||a.hide!=this.partyResource(ot.r6.hide)+1)return!1;n=!1}return!0}if(e.model.level<e.data.upgrades.length+1){if(a.prosperity&&a.prosperity>s.E.prosperityLevel())return!1;if((a.lumber||0)>this.partyResource(ot.r6.lumber)){if(!n||a.lumber!=this.partyResource(ot.r6.lumber)+1)return!1;n=!1}if((a.metal||0)>this.partyResource(ot.r6.metal)){if(!n||a.metal!=this.partyResource(ot.r6.metal)+1)return!1;n=!1}if((a.hide||0)>this.partyResource(ot.r6.hide)){if(!n||a.hide!=this.partyResource(ot.r6.hide)+1)return!1;n=!1}const o=s.E.game.figures.filter(g=>g instanceof q.K).map(g=>g.progress.gold);return!(!o.length||(a.gold||0)>o.reduce((g,_)=>g+_))}return!1}partyResource(e){return(s.E.game.party.loot[e]||0)+(0==s.E.game.figures.filter(a=>a instanceof q.K).length?0:s.E.game.figures.filter(a=>a instanceof q.K).map(a=>a.progress.loot[e]||0).reduce((a,n)=>a+n))}upgrade(e,a=!1){e.model.level<e.data.upgrades.length+1&&(this.upgradeable(e)||a)&&this.dialog.open(Jn,{panelClass:["dialog"],data:{costs:e.model.level?e.data.upgrades[e.model.level-1]:e.data.costs,building:e,action:e.model.level>0?"upgrade":"build",force:a}}).closed.subscribe({next:o=>{(a&&1==o||o instanceof $e.CS)&&setTimeout(()=>{if(s.E.stateManager.before(e.model.level?"upgradeBuilding":"buildBuilding",e.data.id,e.model.name,e.model.level+1),!a&&o instanceof $e.CS&&s.E.lootManager.applySelectResources(o),e.model.level++,s.E.game.party.campaignMode&&m.f.settings.applyBuildingRewards&&e.data.rewards&&e.data.rewards[e.model.level-1]){const g=e.data.rewards[e.model.level-1];s.E.buildingsManager.applyRewards(g),g.section&&this.openConclusion(g.section)}s.E.stateManager.after()},1)}})}openConclusion(e){const a=s.E.sectionData(s.E.currentEdition()).find(n=>n.index==e);if(a){const n=new ht.Nz(a);this.hasConclusions(n.index)?this.openConclusions(n.index):this.dialog.open(Yt,{panelClass:["dialog"],data:{scenario:n,conclusionOnly:!0}})}}hasConclusions(e){const a=s.E.sectionData(s.E.game.edition).filter(n=>n.conclusion&&!n.parent&&n.parentSections&&n.parentSections.find(o=>1==o.length&&-1!=o.indexOf(e)));return a.length>0&&a.every(n=>!s.E.game.party.conclusions.find(o=>o.edition==n.edition&&o.index==n.index&&o.group==n.group))}openConclusions(e){let a=s.E.sectionData(s.E.game.edition).filter(n=>n.conclusion&&!n.parent&&n.parentSections&&n.parentSections.find(o=>1==o.length&&-1!=o.indexOf(e))&&0==s.E.scenarioManager.getRequirements(n).length).map(n=>n);a.length>0&&this.dialog.open(Se,{panelClass:["dialog"],data:{conclusions:a,parent:s.E.sectionData(s.E.game.edition).find(n=>n.index==e&&!n.group)}}).closed.subscribe({next:n=>{if(n){const o=new ht.Nz(n);this.openConclusion(o.index)}}})}rebuild(e,a=!1){"wrecked"==e.model.state&&(this.upgradeable(e)||a)&&this.dialog.open(Jn,{panelClass:["dialog"],data:{costs:e.data.rebuild[e.model.level-1],building:e,action:"rebuild",force:a}}).closed.subscribe({next:n=>{(a&&1==n||n instanceof $e.CS)&&(s.E.stateManager.before("rebuildBuilding",e.data.id,e.model.name),!a&&n instanceof $e.CS&&s.E.lootManager.applySelectResources(n),e.model.state="normal",s.E.stateManager.after())}})}repair(e,a=!1){"damaged"==e.model.state&&(this.upgradeable(e)||a)&&this.dialog.open(Jn,{panelClass:["dialog"],data:{repair:e.data.repair&&e.data.repair[e.model.level-1],building:e,action:"repair",force:a}}).closed.subscribe({next:n=>{(a&&1==n||n instanceof $e.CS)&&(s.E.stateManager.before("repairBuilding",e.data.id,e.data.name),!a&&n instanceof $e.CS&&(n.morale?(s.E.game.party.morale-=n.morale,s.E.game.party.morale<0&&(s.E.game.party.morale=0)):s.E.lootManager.applySelectResources(n)),e.model.state="normal",s.E.stateManager.after())}})}rewardsDialog(e){if(e.data.rewards&&e.data.rewards[e.model.level-1]){const a=e.data.rewards[e.model.level-1];(a.defense||a.items||a.loseMorale||a.plots||a.prosperity||a.section||a.soldiers)&&this.dialog.open(Jn,{panelClass:["dialog"],data:{building:e,action:"rewards"}})}}toggleState(e,a=!1){e.data.repair&&e.model.level>0&&("normal"==e.model.state?(s.E.stateManager.before("changeBuildingState",e.data.id,e.model.name,"damaged"),e.model.state="damaged",s.E.stateManager.after()):"damaged"==e.model.state?(s.E.stateManager.before("changeBuildingState",e.data.id,e.model.name,"wrecked"),e.model.state="wrecked",s.E.stateManager.after()):a&&"wrecked"==e.model.state&&(s.E.stateManager.before("changeBuildingState",e.data.id,e.model.name,"normal"),e.model.state="normal",s.E.stateManager.after()))}downgrade(e,a=!1){const n=s.E.game.party.buildings.indexOf(e.model);if(-1!=n){if(s.E.buildingsManager.initialBuilding(e.data)||s.E.buildingsManager.availableBuilding(e.data)||0!=e.model.level&&!a){if(!s.E.buildingsManager.initialBuilding(e.data)&&!s.E.buildingsManager.availableBuilding(e.data)||e.model.level>1){if(s.E.stateManager.before("downgradeBuilding",e.data.id,e.model.name,e.model.level-1),e.model.level--,0==e.model.level&&(e.model.state="normal"),s.E.game.party.campaignMode&&e.data.rewards&&e.data.rewards[e.model.level]&&e.data.rewards[e.model.level].section){const o=s.E.sectionData(s.E.currentEdition()).find(g=>g.index==e.data.rewards[e.model.level].section);if(o){const g=s.E.buildingsManager.rewardSection(o);g&&(s.E.game.party.conclusions=s.E.game.party.conclusions.filter(_=>_.edition!=g.edition||_.group!=g.group||_.index!=g.index))}}s.E.stateManager.after()}}else{if(s.E.stateManager.before("removeBuilding",e.data.id,e.model.name),e.model.state="normal",s.E.game.party.buildings.splice(n,1),s.E.game.party.campaignMode&&e.data.rewards&&e.data.rewards[0]&&e.data.rewards[0].section){const o=s.E.sectionData(s.E.currentEdition()).find(g=>g.index==e.data.rewards[0].section);if(o){const g=s.E.buildingsManager.rewardSection(o);g&&(s.E.game.party.conclusions=s.E.game.party.conclusions.filter(_=>_.edition!=g.edition||_.group!=g.group||_.index!=g.index))}}s.E.stateManager.after()}this.change.emit()}}openStables(){this.dialog.open(Rr,{panelClass:["dialog"]})}openGarden(){this.dialog.open(KV,{panelClass:["dialog"]})}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-buildings-list"]],inputs:{buildings:"buildings",short:"short",invert:"invert"},outputs:{change:"change"},standalone:!1,decls:15,vars:12,consts:[[1,"buildings",3,"ngClass"],[1,"building","head"],[1,"name"],[3,"ghs-label"],[1,"id"],[1,"level"],[1,"costs"],[1,"action"],[1,"building",3,"ngClass"],[1,"effects"],[1,"toggle",3,"click"],[3,"src"],[1,"interactions"],["ghs-pointer-input","",1,"name",3,"singleClick","doubleClick","ngClass"],["ghs-pointer-input","",1,"level",3,"singleClick","doubleClick","ghs-tooltip","originY"],[1,"costs",3,"ngClass"],["ghs-pointer-input","",1,"button","upgrade",3,"ngClass","ghs-tooltip","originX","originY","overlayX"],[1,"effect"],[1,"interaction"],[1,"interaction","stables"],[1,"interaction","garden"],[1,"icon",3,"ghs-tooltip","originY","overlayY"],["src","./assets/images/fh/buildings/normal.svg"],[1,"text",3,"ghs-label"],[1,"icon","unavailable",3,"ghs-tooltip","originY","overlayY"],["src","./assets/images/fh/buildings/interaction.svg"],[1,"icon",3,"click","ghs-tooltip"],["src","./assets/images/fh/catching.svg"],[1,"text",3,"click","ghs-label"],["src","./assets/images/fh/buildings/garden.png"],[1,"cost"],["src","./assets/images/fh/buildings/prosperity.svg"],["src","./assets/images/fh/loot/lumber.svg"],["src","./assets/images/fh/loot/metal.svg"],["src","./assets/images/fh/loot/hide.svg"],["src","./assets/images/fh/loot.svg"],[1,"repair"],[3,"ghs-label","ghs-label-args"],[1,"morale",3,"ghs-label"],["ghs-pointer-input","",1,"button","upgrade",3,"singleClick","doubleClick","ngClass","ghs-tooltip","originX","originY","overlayX"],["src","./assets/images/fh/buildings/repair.svg"],["src","./assets/images/fh/buildings/rebuild.svg"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"span",2),t.nrm(3,"span",3),t.k0s(),t.j41(4,"span",4),t.nrm(5,"span",3),t.k0s(),t.j41(6,"span",5),t.nrm(7,"span",3),t.k0s(),t.nVh(8,MF,8,4),t.j41(9,"span",6),t.nrm(10,"span",3),t.k0s(),t.j41(11,"span",7),t.nrm(12,"span",3),t.k0s()(),t.Z7z(13,XF,16,23,"div",8,CF),t.k0s()),2&a&&(t.Y8G("ngClass",t.ziG(7,pF,n.short,!n.short&&n.settingsManager.settings.buildingEffectsVisible,!n.short&&n.settingsManager.settings.buildingInteractionsVisible,n.invert)),t.R7$(3),t.Y8G("ghs-label","party.campaign.sheet.buildings.name"),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.buildings.id"),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.buildings.level"),t.R7$(),t.vxM(n.short?-1:8),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.buildings.costs"),t.R7$(2),t.Y8G("ghs-label","party.campaign.sheet.buildings.action"),t.R7$(),t.Dyx(n.buildings))},dependencies:[N.YU,tt,ft,rt],styles:['.buildings[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%;overflow-y:auto;margin-top:calc(var(--ghs-unit) * .8 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2.2 * var(--ghs-dialog-factor))}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]{position:relative;display:grid;grid-template-columns:30% 5% 5% 10% 10% 20% 20%;align-items:center;margin:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) 0;transition:calc(var(--ghs-animation-speed) * .3s)}.buildings[_ngcontent-%COMP%]   .building.buildable[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 2);border-top:solid calc(var(--ghs-unit) * .1) var(--ghs-color-darkgray)}.buildings[_ngcontent-%COMP%]   .building.buildable[_ngcontent-%COMP%] ~ .buildable[_ngcontent-%COMP%]{margin-top:0;border-top:none}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]:nth-child(odd):before{content:" ";position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--ghs-color-gray);opacity:.35;z-index:0}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]:hover:before{content:" ";position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--ghs-color-yellow);opacity:.35;z-index:1}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{z-index:2}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;padding:0 .2em}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{width:0;height:1em;background-size:auto 90%;background-repeat:no-repeat;background-position:center center;display:none}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .state.normal[_ngcontent-%COMP%]{width:1em;background-image:url(damaged.4f5e0cf68a1b64dd.svg)}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .state.damaged[_ngcontent-%COMP%]{width:1em;background-image:url(wrecked.a5fd49fad8c36290.svg)}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]:hover{opacity:.7}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]:hover   .state[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .name.disabled[_ngcontent-%COMP%]{pointer-events:none}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover{opacity:.7}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .level.disabled[_ngcontent-%COMP%]{pointer-events:none}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;z-index:1}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;margin:.1em}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]:hover, .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]:hover{opacity:.7}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{display:none}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{position:relative;cursor:help;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin:0 calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor))}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2.3 * var(--ghs-dialog-factor));width:auto}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .icon.unavailable[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .icon.unavailable[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .icon.unavailable[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .icon.unavailable[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));width:auto}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .icon.unavailable[_ngcontent-%COMP%]:after, .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .icon.unavailable[_ngcontent-%COMP%]:after, .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .icon.unavailable[_ngcontent-%COMP%]:after, .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .icon.unavailable[_ngcontent-%COMP%]:after{content:" ";position:absolute;inset:0;background-image:url(unavailable.e8616ca33492ef0a.png);background-size:100% 100%;background-position:center center;background-repeat:no-repeat}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect.stables[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect.stables[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect.garden[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect.garden[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .interaction.stables[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .interaction.stables[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .interaction.garden[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .interaction.garden[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .effect.stables[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .effect.stables[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .effect.garden[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .effect.garden[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction.stables[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction.stables[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction.garden[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction.garden[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{cursor:pointer}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]{display:grid;justify-content:end;grid-template-columns:repeat(5,calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor)))}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]   .cost[_ngcontent-%COMP%]{display:flex;align-items:center}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]   .cost[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:.9em;width:auto;margin:0 calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor))}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]   .morale[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor));padding-left:calc(var(--ghs-unit) * .4 * var(--ghs-dialog-factor));border-left:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) solid var(--ghs-color-darkgray)}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]   .repair[_ngcontent-%COMP%]{grid-column:span 5;display:flex;align-items:center;justify-content:center}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]   .repair[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor))}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .costs.disabled[_ngcontent-%COMP%]{opacity:.7;color:var(--ghs-color-darkgray)}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .costs.disabled[_ngcontent-%COMP%]   .cost[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .upgrade[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;margin-left:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .upgrade[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto;margin:0 calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor))}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .upgrade[_ngcontent-%COMP%]:hover{opacity:.7}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .upgrade.disabled[_ngcontent-%COMP%]{color:var(--ghs-color-gray)}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .upgrade.disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}.buildings[_ngcontent-%COMP%]   .building.head[_ngcontent-%COMP%]{border-bottom:solid calc(var(--ghs-unit) * .1) var(--ghs-color-darkgray)}.buildings[_ngcontent-%COMP%]   .building.head[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building.head[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%], .buildings[_ngcontent-%COMP%]   .building.head[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{pointer-events:none}.buildings[_ngcontent-%COMP%]   .building.head[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding-right:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor))}.buildings[_ngcontent-%COMP%]   .building.head[_ngcontent-%COMP%]:before{opacity:.1}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]{cursor:pointer;width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-red)}.buildings[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]:hover{opacity:.5}.buildings.visible-effects[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]{grid-template-columns:20% 5% 5% 30% 10% 15% 15%;align-items:start}.buildings.visible-effects[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%], .buildings.visible-effects[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]{justify-content:flex-start;align-items:flex-start}.buildings.visible-effects[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{display:inline-block}.buildings.visible-effects[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor))}.buildings.visible-interactions[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]{grid-template-columns:20% 5% 5% 10% 30% 15% 15%;align-items:start}.buildings.visible-interactions[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%], .buildings.visible-interactions[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]{justify-content:flex-start;align-items:flex-start}.buildings.visible-interactions[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{display:inline-block}.buildings.visible-interactions[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .interaction[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor))}.buildings.visible-effects.visible-interactions[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]{grid-template-columns:20% 5% 5% 20% 20% 15% 15%}.buildings.short[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]{grid-template-columns:25% 10% 10% 45% 10%}.buildings.invert[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.buildings.invert[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%], .buildings.invert[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings.invert[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings.invert[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings.invert[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .interactions[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings.invert[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .upgrade[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .buildings.invert[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .costs[_ngcontent-%COMP%]   .cost[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.buildings.invert[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .costs.disabled[_ngcontent-%COMP%]   .cost[_ngcontent-%COMP%]{color:var(--ghs-color-gray)}.buildings.invert[_ngcontent-%COMP%]   .building[_ngcontent-%COMP%]   .costs.disabled[_ngcontent-%COMP%]   .cost[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}']})}return i})();const BF=(i,r)=>({fh:i,modern:r}),YF=()=>[],NF=i=>({checked:i}),zF=i=>({success:i}),LF=(i,r,e)=>[i,r,e],UF=i=>({disabled:i}),Gr=(i,r)=>r.data.name;function qF(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",8)(1,"input",26),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.manualAttackValue,n)||(o.manualAttackValue=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.applyBaracks())}),t.k0s(),t.j41(2,"input",26),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.manualTargetNumber,n)||(o.manualTargetNumber=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.applyBaracks())}),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(),t.R50("ngModel",e.manualAttackValue),t.R7$(),t.R50("ngModel",e.manualTargetNumber)}}function HF(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",28),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.toggleSoldier(n+1))}),t.nrm(1,"img",29)(2,"div",30),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(2),t.Y8G("ngClass",t.eq3(1,NF,a.soldiers>=e+1))}}function KF(i,r){if(1&i&&(t.Z7z(0,HF,3,3,"div",27,t.fX1),t.nI1(2,"ghsRange")),2&i){const e=t.XpG();t.Dyx(t.i5U(2,0,t.lJ4(3,YF),e.gameManager.game.party.soldiers))}}function WF(i,r){1&i&&(t.j41(0,"div",18),t.nrm(1,"img",31),t.k0s()),2&i&&t.Y8G("ghs-tooltip","party.outpostAttack.advantage")}function JF(i,r){1&i&&(t.j41(0,"div",18),t.nrm(1,"img",32),t.k0s()),2&i&&t.Y8G("ghs-tooltip","party.outpostAttack.disadvantage")}function ZF(i,r){1&i&&t.nrm(0,"span",42),2&i&&t.Y8G("ghs-label","party.outpostAttack.result.wreck")}function QF(i,r){1&i&&t.nrm(0,"span",43),2&i&&t.Y8G("ghs-label","party.outpostAttack.result.successfull")}function tX(i,r){if(1&i&&t.nrm(0,"span",44),2&i){const e=t.XpG(3);t.Y8G("ngClass",t.eq3(3,zF,e.attackResult.result>=e.EntityValueFunction(e.attack.attackValue)))("ghs-label","party.outpostAttack.result."+(e.attackResult.result>=e.EntityValueFunction(e.attack.attackValue)?"success":"damage"))("ghs-label-args",t.sMw(5,LF,e.attackResult.result,(e.gameManager.game.party.defense||0)+e.moraleDefense,e.EntityValueFunction(e.attack.attackValue)))}}function eX(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",45)(1,"ghs-attackmodifier",46),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.toggleAttackResult())}),t.k0s(),t.nrm(2,"ghs-attackmodifier",47),t.k0s()}if(2&i){const e=t.XpG(3);t.R7$(),t.Y8G("attackModifier",e.townGuardDeck.cards[e.attackResult.index+e.attackResult.chooseOffset])("townGuard",!0)("flipped",!0),t.R7$(),t.Y8G("attackModifier",e.townGuardDeck.cards[e.attackResult.index])("townGuard",!0)("flipped",!0)}}function nX(i,r){if(1&i&&(t.j41(0,"div",35),t.nVh(1,ZF,1,1,"span",42),t.nVh(2,QF,1,1,"span",43),t.nVh(3,tX,1,9,"span",44),t.nVh(4,eX,3,6,"div",45),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.vxM("wreck"==e.townGuardDeck.cards[e.attackResult.index].type?1:-1),t.R7$(),t.vxM("success"==e.townGuardDeck.cards[e.attackResult.index].type?2:-1),t.R7$(),t.vxM("wreck"!=e.townGuardDeck.cards[e.attackResult.index].type&&"success"!=e.townGuardDeck.cards[e.attackResult.index].type?3:-1),t.R7$(),t.vxM(e.attackResult.chooseOffset?4:-1)}}function iX(i,r){1&i&&t.nrm(0,"img",52)}function aX(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.SpI("(",e.data.id,")")}}function oX(i,r){1&i&&(t.j41(0,"span",57),t.nrm(1,"img",59),t.k0s()),2&i&&t.Y8G("ghs-tooltip","party.outpostAttack.buildings.damaged")}function sX(i,r){1&i&&(t.j41(0,"span",58),t.nrm(1,"img",60),t.k0s()),2&i&&t.Y8G("ghs-tooltip","party.outpostAttack.buildings.wrecked")}function rX(i,r){if(1&i&&(t.j41(0,"tr",39)(1,"td",48)(2,"a",49),t.nrm(3,"img",50),t.k0s()(),t.j41(4,"td",51)(5,"span"),t.nVh(6,iX,1,0,"img",52),t.k0s()(),t.j41(7,"td",53),t.nrm(8,"span",15),t.k0s(),t.j41(9,"td",54),t.nVh(10,aX,2,1,"span"),t.k0s(),t.j41(11,"td",55)(12,"span"),t.EFF(13),t.k0s()(),t.j41(14,"td",56),t.nVh(15,oX,2,1,"span",57),t.nVh(16,sX,2,1,"span",58),t.k0s()()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.Y8G("ngClass",t.eq3(7,UF,e.model.attacked||"number"==typeof n.attack.targetNumber&&a>=n.attacks+n.attack.targetNumber)),t.R7$(6),t.vxM(a==n.attacks&&n.attack.targetNumber?6:-1),t.R7$(2),t.Y8G("ghs-label","data.buildings."+e.model.name),t.R7$(2),t.vxM(e.data.id?10:-1),t.R7$(3),t.JRh(e.model.level||"-"),t.R7$(2),t.vxM("damaged"==e.model.state?15:-1),t.R7$(),t.vxM("wrecked"==e.model.state?16:-1)}}function cX(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.SpI("(",e.data.id,")")}}function lX(i,r){1&i&&(t.j41(0,"span",61),t.nrm(1,"img",59),t.k0s()),2&i&&t.Y8G("ghs-tooltip","party.outpostAttack.buildings.damaged")}function gX(i,r){1&i&&(t.j41(0,"span",61),t.nrm(1,"img",60),t.k0s()),2&i&&t.Y8G("ghs-tooltip","party.outpostAttack.buildings.wrecked")}function dX(i,r){if(1&i&&(t.j41(0,"tr",41)(1,"td",48)(2,"a",49),t.nrm(3,"img",50),t.k0s()(),t.nrm(4,"td",51),t.j41(5,"td",53),t.nrm(6,"span",15),t.k0s(),t.j41(7,"td",54),t.nVh(8,cX,2,1,"span"),t.k0s(),t.j41(9,"td",55),t.EFF(10),t.k0s(),t.j41(11,"td",56),t.nVh(12,lX,2,1,"span",61),t.nVh(13,gX,2,1,"span",61),t.k0s()()),2&i){const e=r.$implicit;t.R7$(6),t.Y8G("ghs-label","data.buildings."+e.model.name),t.R7$(2),t.vxM(e.data.id?8:-1),t.R7$(2),t.JRh(e.model.level||"-"),t.R7$(2),t.vxM("damaged"==e.model.state?12:-1),t.R7$(),t.vxM("wrecked"==e.model.state?13:-1)}}function hX(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",33),t.nrm(1,"span",15),t.j41(2,"span",34),t.EFF(3),t.k0s()(),t.nVh(4,nX,5,4,"div",35),t.j41(5,"div",36)(6,"table",37,0),t.bIt("cdkDropListDropped",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.dropBuildings(n))}),t.j41(8,"thead")(9,"tr"),t.nrm(10,"th",38),t.k0s()(),t.j41(11,"tbody"),t.Z7z(12,rX,17,9,"tr",39,Gr),t.k0s()(),t.j41(14,"table",40,1),t.bIt("cdkDropListDropped",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.dropDisabledBuildings(n))}),t.j41(16,"thead")(17,"tr"),t.nrm(18,"th",38),t.k0s()(),t.j41(19,"tbody"),t.Z7z(20,dX,14,5,"tr",41,Gr),t.k0s()()()}if(2&i){const e=t.sdS(7),a=t.sdS(15),n=t.XpG();t.R7$(),t.Y8G("ghs-label","party.outpostAttack.defense"),t.R7$(2),t.JRh((n.gameManager.game.party.defense||0)+n.moraleDefense),t.R7$(),t.vxM(n.attackResult?4:-1),t.R7$(2),t.Y8G("cdkDropListConnectedTo",a),t.R7$(4),t.Y8G("ghs-label","party.outpostAttack.targets"),t.R7$(2),t.Dyx(n.buildings),t.R7$(2),t.Y8G("cdkDropListConnectedTo",e),t.R7$(4),t.Y8G("ghs-label","party.outpostAttack.other"),t.R7$(2),t.Dyx(n.disabledBuildings)}}function _X(i,r){if(1&i&&t.nrm(0,"ghs-buildings-list",22),2&i){const e=t.XpG();t.Y8G("buildings",e.allBuildings)("short",!0)("invert",!0)}}function mX(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",62),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.nextTarget())}),t.k0s()}2&i&&t.Y8G("ghs-label","party.outpostAttack.next")}function pX(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",63),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.close(!0))}),t.k0s()}2&i&&t.Y8G("ghs-label","party.outpostAttack.finish")}let uX=(()=>{class i{data;dialogRef;dialog;settingsManager=m.f;gameManager=s.E;EntityValueFunction=$.hZ;attack;defaultAttack;manualAttackValue=50;manualTargetNumber=4;townGuardDeck=new Y.J;allBuildings=[];buildings=[];disabledBuildings=[];parity=0;factor=!1;lowerBoundary=0;upperBoundary=0;desc=!1;barracks=!1;soldiers=0;baracksBonus=0;moraleDefense=0;attacks=0;attackResult;deckActive=!1;constructor(e,a,n){if(this.data=e,this.dialogRef=a,this.dialog=n,this.data.attack&&(this.defaultAttack=new xt.TH(e.attack.attackValue,e.attack.targetNumber,e.attack.targetDescription,e.attack.narrative,e.attack.effects)),this.defaultAttack&&e.effects){let o=0,g=0;e.effects.forEach(_=>{_.type==xt.Yj.outpostAttack&&_.values.length&&"object"!=typeof _.values[0]?o=(0,$.hZ)(_.values[0]):_.type==xt.Yj.outpostTarget&&_.values.length&&"object"!=typeof _.values[0]&&(g=(0,$.hZ)(_.values[0]))}),o&&(this.defaultAttack.attackValue="number"==typeof this.defaultAttack.attackValue?this.defaultAttack.attackValue+o:this.defaultAttack.attackValue+" "+(0,V.n1)(o)),g&&(this.defaultAttack.targetNumber="number"==typeof this.defaultAttack.targetNumber?this.defaultAttack.targetNumber+g:this.defaultAttack.targetNumber+" "+(0,V.n1)(g))}this.attack=this.defaultAttack||new xt.TH(this.manualAttackValue,this.manualTargetNumber,"","",[]),this.deckActive=!!s.E.game.party.townGuardDeck&&s.E.game.party.townGuardDeck.active}ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.update()}),this.update(!0)}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe(),s.E.game.party.townGuardDeck&&(s.E.game.party.townGuardDeck.active=this.deckActive)}update(e=!1){this.allBuildings=[];const a=s.E.campaignData();a&&(s.E.game.party.buildings.forEach(n=>{const o=a.buildings.find(g=>g.name==n.name);o&&n.level&&o.id&&!isNaN(+o.id)&&(e&&(n.attacked=void 0),this.allBuildings.push({model:n,data:o}))}),a.townGuardPerks?(this.townGuardDeck=s.E.attackModifierManager.buildTownGuardAttackModifierDeck(s.E.game.party,a),s.E.game.party.townGuardDeck?s.E.attackModifierManager.fromModel(this.townGuardDeck,s.E.game.party.townGuardDeck):(s.E.attackModifierManager.shuffleModifiers(this.townGuardDeck),s.E.game.party.townGuardDeck=this.townGuardDeck.toModel()),this.townGuardDeck.active=!0):(console.warn("Invalid state, no Town Guard Deck found!"),this.dialogRef.close())),this.moraleDefense=s.E.game.party.morale<3?-10:s.E.game.party.morale<5?-5:s.E.game.party.morale<8?0:s.E.game.party.morale<11?5:s.E.game.party.morale<14?10:15,this.applyBaracks(),e&&this.applyFilter()}beforeTownGuardDeck(e){this.attackResult=void 0,s.E.stateManager.before("updateAttackModifierDeck."+e.type,"party.campaign.townGuard",...e.values)}afterTownGuardDeck(e){this.townGuardDeck=e.deck,s.E.game.party.townGuardDeck=this.townGuardDeck.toModel(),s.E.stateManager.after(),this.attackResult=s.E.attackModifierManager.calculateAttackResult(this.townGuardDeck,(s.E.game.party.defense||0)+this.moraleDefense)}toggleAttackResult(){this.attackResult&&this.attackResult.chooseOffset&&(this.attackResult=s.E.attackModifierManager.calculateAttackResult(this.townGuardDeck,(s.E.game.party.defense||0)+this.moraleDefense,this.attackResult.index+this.attackResult.chooseOffset))}nextTarget(){if(this.attacks<this.buildings.length&&this.attack.targetNumber){const e=this.buildings[this.attacks];let a=e.model.state;this.attackResult&&("wreck"==this.townGuardDeck.cards[this.attackResult.index].type?a="wrecked":"success"!=this.townGuardDeck.cards[this.attackResult.index].type&&this.attackResult.result<(0,$.hZ)(this.attack.attackValue)&&(a="damaged")),s.E.stateManager.before("buildingAttacked"+(a!=e.model.state?"."+a:""),e.data.id,e.data.name),s.E.game.party.soldiers-=this.soldiers,this.soldiers=0,e.model.attacked=!0,this.attacks++,e.model.state=a,this.attackResult=void 0,this.applyBaracks(),s.E.stateManager.after()}}toggleSoldier(e){this.soldiers==e?this.soldiers--:this.soldiers=e,this.applyBaracks()}applyBaracks(){const e=this.allBuildings.find(a=>"barracks"==a.model.name);if(e){if("wrecked"==e.model.state)this.barracks=!1,this.baracksBonus=0,this.soldiers=0,this.factor="disadvantage";else{switch(this.barracks=!0,this.factor=!1,e.model.level){case 1:this.baracksBonus=-5;break;case 2:this.baracksBonus=-15;break;case 3:this.baracksBonus=-25;break;case 4:this.baracksBonus=-35}this.soldiers&&(this.factor="advantage")}this.attack=new xt.TH((0,$.hZ)(this.defaultAttack?this.defaultAttack.attackValue:this.manualAttackValue)+this.soldiers*this.baracksBonus,(0,$.hZ)(this.defaultAttack?this.defaultAttack.targetNumber:this.manualTargetNumber)-this.attacks,this.defaultAttack?this.defaultAttack.targetDescription:"",this.defaultAttack?this.defaultAttack.narrative:"",this.defaultAttack?this.defaultAttack.effects:[])}else console.warn("No Barrack found!")}applyFilter(){this.buildings=this.allBuildings.filter(e=>{if(!e.data.id||isNaN(+e.data.id)||"wrecked"==e.model.state)return!1;const a=+e.data.id;return!(this.parity&&("even"==this.parity&&a%2==1||"odd"==this.parity&&a%2==0)||+this.lowerBoundary&&a<this.lowerBoundary||+this.upperBoundary&&a>this.upperBoundary)}).sort((e,a)=>+e.data.id-+a.data.id),this.desc&&this.buildings.reverse(),this.disabledBuildings=this.allBuildings.filter(e=>-1==this.buildings.indexOf(e))}randomize(){(0,V.Z)(this.buildings)}dropBuildings(e){if(e.container==e.previousContainer)(0,D.HD)(this.buildings,e.previousIndex,e.currentIndex);else{const a=this.disabledBuildings.splice(e.previousIndex,1)[0];this.buildings.splice(e.currentIndex,0,a)}}dropDisabledBuildings(e){if(e.container==e.previousContainer)(0,D.HD)(this.disabledBuildings,e.previousIndex,e.currentIndex);else{const a=this.buildings.splice(e.previousIndex,1)[0];this.disabledBuildings.splice(e.currentIndex,0,a)}}partySheet(){this.dialog.open(Ue,{panelClass:["dialog-invert"],data:s.E.currentEdition()})}worldMap(){this.dialog.open(Zn,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:s.E.currentEdition()})}close(e=!1){(0,V.co)(this.dialogRef,e)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-outpost-attack"]],standalone:!1,decls:70,vars:59,consts:[["buildingsList","cdkDropList"],["disabledBuildingsList","cdkDropList"],[1,"outpost-attack-dialog",3,"ngClass"],[1,"header"],["src","./assets/images/sheet.svg",1,"party-sheet",3,"click","ghs-tooltip"],["src","./assets/images/map.svg",1,"world-map",3,"click","ghs-tooltip"],[1,"attack"],[3,"attack","selected","narrative","effects","disabled","light"],[1,"manual-attack"],[1,"filter"],[3,"ngModelChange","change","ngModel","ghs-tooltip"],[3,"value","ghs-label"],[3,"value"],[3,"ngModelChange","change","ngModel"],["type","checkbox",3,"ngModelChange","change","ngModel"],[3,"ghs-label"],[3,"click"],[1,"baracks-bonus"],[1,"factor",3,"ghs-tooltip"],[1,"town-guard-deck-container"],[1,"town-guard-deck"],[3,"before","after","deck","townGuard"],[3,"buildings","short","invert"],[1,"menu"],[1,"cancel",3,"click","ghs-label"],[1,"finish",3,"ghs-label"],["type","number","min","0",3,"ngModelChange","change","ngModel"],[1,"soldier"],[1,"soldier",3,"click"],["src","./assets/images/fh/party/soldier.svg"],[1,"check",3,"ngClass"],["src","./assets/images/fh/condition/strengthen.svg"],["src","./assets/images/fh/condition/muddle.svg"],[1,"defense"],[1,"value"],[1,"attack-result"],[1,"buildings"],["cdkDropList","",3,"cdkDropListDropped","cdkDropListConnectedTo"],["colspan","6",3,"ghs-label"],["cdkDrag","",3,"ngClass"],["cdkDropList","",1,"other",3,"cdkDropListDropped","cdkDropListConnectedTo"],["cdkDrag",""],[1,"result","wreck",3,"ghs-label"],[1,"result","successfull",3,"ghs-label"],[1,"result",3,"ngClass","ghs-label","ghs-label-args"],[1,"choose"],[3,"click","attackModifier","townGuard","flipped"],[3,"attackModifier","townGuard","flipped"],["cdkDragHandle","",1,"drag-handle"],[1,"button"],["src","./assets/images/menu.svg",1,"ghs-svg"],[1,"target"],["src","./assets/images/attackmodifier/target.svg",1,"ghs-svg"],[1,"name"],[1,"id"],[1,"level"],[1,"state"],[1,"damaged",3,"ghs-tooltip"],[1,"wrecked",3,"ghs-tooltip"],["src","./assets/images/fh/buildings/damaged.svg",1,"ghs-svg"],["src","./assets/images/fh/buildings/wrecked.svg",1,"ghs-svg"],[3,"ghs-tooltip"],[3,"click","ghs-label"],[1,"finish",3,"click","ghs-label"]],template:function(a,n){1&a&&(t.j41(0,"div",2)(1,"div",3)(2,"img",4),t.bIt("click",function(){return n.partySheet()}),t.k0s(),t.j41(3,"img",5),t.bIt("click",function(){return n.worldMap()}),t.k0s()(),t.j41(4,"div",6),t.nrm(5,"ghs-event-card-attack",7),t.k0s(),t.nVh(6,qF,3,2,"div",8),t.j41(7,"div",9)(8,"select",10),t.mxI("ngModelChange",function(g){return t.DH7(n.lowerBoundary,g)||(n.lowerBoundary=g),g}),t.bIt("change",function(){return n.applyFilter()}),t.nrm(9,"option",11),t.j41(10,"option",12),t.EFF(11,"10"),t.k0s(),t.j41(12,"option",12),t.EFF(13,"20"),t.k0s(),t.j41(14,"option",12),t.EFF(15,"30"),t.k0s(),t.j41(16,"option",12),t.EFF(17,"40"),t.k0s(),t.j41(18,"option",12),t.EFF(19,"50"),t.k0s(),t.j41(20,"option",12),t.EFF(21,"60"),t.k0s(),t.j41(22,"option",12),t.EFF(23,"70"),t.k0s(),t.j41(24,"option",12),t.EFF(25,"80"),t.k0s(),t.j41(26,"option",12),t.EFF(27,"90"),t.k0s()(),t.j41(28,"select",10),t.mxI("ngModelChange",function(g){return t.DH7(n.upperBoundary,g)||(n.upperBoundary=g),g}),t.bIt("change",function(){return n.applyFilter()}),t.nrm(29,"option",11),t.j41(30,"option",12),t.EFF(31,"10"),t.k0s(),t.j41(32,"option",12),t.EFF(33,"20"),t.k0s(),t.j41(34,"option",12),t.EFF(35,"30"),t.k0s(),t.j41(36,"option",12),t.EFF(37,"40"),t.k0s(),t.j41(38,"option",12),t.EFF(39,"50"),t.k0s(),t.j41(40,"option",12),t.EFF(41,"60"),t.k0s(),t.j41(42,"option",12),t.EFF(43,"70"),t.k0s(),t.j41(44,"option",12),t.EFF(45,"80"),t.k0s(),t.j41(46,"option",12),t.EFF(47,"90"),t.k0s()(),t.j41(48,"select",13),t.mxI("ngModelChange",function(g){return t.DH7(n.parity,g)||(n.parity=g),g}),t.bIt("change",function(){return n.applyFilter()}),t.nrm(49,"option",11)(50,"option",11)(51,"option",11),t.k0s(),t.j41(52,"label")(53,"input",14),t.mxI("ngModelChange",function(g){return t.DH7(n.desc,g)||(n.desc=g),g}),t.bIt("change",function(){return n.applyFilter()}),t.k0s(),t.nrm(54,"span",15),t.k0s(),t.j41(55,"a",16),t.bIt("click",function(){return n.randomize()}),t.nrm(56,"span",15),t.k0s()(),t.j41(57,"div",17),t.nVh(58,KF,3,4),t.nVh(59,WF,2,1,"div",18),t.nVh(60,JF,2,1,"div",18),t.k0s(),t.j41(61,"div",19)(62,"div",20)(63,"ghs-attackmodifier-deck",21),t.bIt("before",function(g){return n.beforeTownGuardDeck(g)})("after",function(g){return n.afterTownGuardDeck(g)}),t.k0s()()(),t.nVh(64,hX,22,7),t.nVh(65,_X,1,3,"ghs-buildings-list",22),t.j41(66,"div",23)(67,"a",24),t.bIt("click",function(){return n.close()}),t.k0s(),t.nVh(68,mX,1,1,"a",15),t.nVh(69,pX,1,1,"a",25),t.k0s()()),2&a&&(t.Y8G("ngClass",t.l_i(56,BF,"fh"==n.settingsManager.settings.theme,"modern"==n.settingsManager.settings.theme)),t.R7$(2),t.Y8G("ghs-tooltip","party.outpostAttack.sheet"),t.R7$(),t.Y8G("ghs-tooltip","party.outpostAttack.map"),t.R7$(2),t.Y8G("attack",n.attack)("selected",!0)("narrative",!1)("effects",!1)("disabled",!0)("light",!0),t.R7$(),t.vxM(n.defaultAttack?-1:6),t.R7$(2),t.R50("ngModel",n.lowerBoundary),t.Y8G("ghs-tooltip","party.outpostAttack.filter.lowerBoundary"),t.R7$(),t.Y8G("value",0)("ghs-label","party.outpostAttack.filter.lowerBoundary"),t.R7$(),t.Y8G("value",10),t.R7$(2),t.Y8G("value",20),t.R7$(2),t.Y8G("value",30),t.R7$(2),t.Y8G("value",40),t.R7$(2),t.Y8G("value",50),t.R7$(2),t.Y8G("value",60),t.R7$(2),t.Y8G("value",70),t.R7$(2),t.Y8G("value",80),t.R7$(2),t.Y8G("value",90),t.R7$(2),t.R50("ngModel",n.upperBoundary),t.Y8G("ghs-tooltip","party.outpostAttack.filter.upperBoundary"),t.R7$(),t.Y8G("value",0)("ghs-label","party.outpostAttack.filter.upperBoundary"),t.R7$(),t.Y8G("value",10),t.R7$(2),t.Y8G("value",20),t.R7$(2),t.Y8G("value",30),t.R7$(2),t.Y8G("value",40),t.R7$(2),t.Y8G("value",50),t.R7$(2),t.Y8G("value",60),t.R7$(2),t.Y8G("value",70),t.R7$(2),t.Y8G("value",80),t.R7$(2),t.Y8G("value",90),t.R7$(2),t.R50("ngModel",n.parity),t.R7$(),t.Y8G("value",0)("ghs-label","party.outpostAttack.filter.parity"),t.R7$(),t.Y8G("value","even")("ghs-label","party.outpostAttack.filter.even"),t.R7$(),t.Y8G("value","odd")("ghs-label","party.outpostAttack.filter.odd"),t.R7$(2),t.R50("ngModel",n.desc),t.R7$(),t.Y8G("ghs-label","party.outpostAttack.filter.desc"),t.R7$(2),t.Y8G("ghs-label","party.outpostAttack.filter.randomize"),t.R7$(2),t.vxM(n.barracks?58:-1),t.R7$(),t.vxM("advantage"==n.factor?59:-1),t.R7$(),t.vxM("disadvantage"==n.factor?60:-1),t.R7$(3),t.Y8G("deck",n.townGuardDeck)("townGuard",!0),t.R7$(),t.vxM(n.EntityValueFunction(n.attack.targetNumber)>0&&n.attacks<n.buildings.length?64:-1),t.R7$(),t.vxM(0==n.attack.targetNumber||n.attacks>=n.buildings.length?65:-1),t.R7$(2),t.Y8G("ghs-label","cancel"),t.R7$(),t.vxM(+n.attack.targetNumber>0&&n.attacks<n.buildings.length?68:-1),t.R7$(),t.vxM(0==n.attack.targetNumber||n.attacks>=n.buildings.length?69:-1))},dependencies:[N.YU,O.xH,O.y7,O.me,O.Q0,O.Zm,O.wz,O.BC,O.VZ,O.vS,D.O7,D.T1,D.Fb,Ln,yn,jr,Va,tt,ft,Tt],styles:['.outpost-attack-dialog[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.outpost-attack-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%;margin-bottom:calc(var(--ghs-unit) * -5.5 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{cursor:pointer;width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));filter:var(--ghs-filter-white)}.outpost-attack-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{opacity:.6}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack[_ngcontent-%COMP%]   ghs-event-card-attack[_ngcontent-%COMP%]{display:block;width:calc(var(--ghs-unit) * 35 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .manual-attack[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.outpost-attack-dialog[_ngcontent-%COMP%]   .manual-attack[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor)) 0}.outpost-attack-dialog[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .outpost-attack-dialog[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .outpost-attack-dialog[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .outpost-attack-dialog[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.outpost-attack-dialog[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-family:var(--ghs-font-title);color:var(--ghs-color-white)}.outpost-attack-dialog[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.outpost-attack-dialog[_ngcontent-%COMP%]   .baracks-bonus[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.outpost-attack-dialog[_ngcontent-%COMP%]   .baracks-bonus[_ngcontent-%COMP%]   .soldier[_ngcontent-%COMP%]{position:relative}.outpost-attack-dialog[_ngcontent-%COMP%]   .baracks-bonus[_ngcontent-%COMP%]   .soldier[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));left:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3.6 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-white)}.outpost-attack-dialog[_ngcontent-%COMP%]   .baracks-bonus[_ngcontent-%COMP%]   .soldier[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{cursor:pointer;position:relative;width:calc(var(--ghs-unit) * 3.6 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3.6 * var(--ghs-dialog-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) dashed var(--ghs-color-white);border-radius:100%}.outpost-attack-dialog[_ngcontent-%COMP%]   .baracks-bonus[_ngcontent-%COMP%]   .soldier[_ngcontent-%COMP%]   .check.checked[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:10%;left:10%;width:80%;height:80%;background-image:url(checkmark.437dd8c56b3be0e8.svg);background-size:contain;background-repeat:no-repeat;background-position:center;z-index:1;filter:var(--ghs-filter-red)}.outpost-attack-dialog[_ngcontent-%COMP%]   .baracks-bonus[_ngcontent-%COMP%]   .factor[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .baracks-bonus[_ngcontent-%COMP%]   .factor[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:auto}.outpost-attack-dialog[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:1.5em;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .defense[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));font-size:1.5em}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack-result[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack-result[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]{font-size:1.5em;text-align:center;color:var(--ghs-color-black);filter:var(--ghs-filter-red)}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack-result[_ngcontent-%COMP%]   .result.wreck[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack-result[_ngcontent-%COMP%]   .result.success[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack-result[_ngcontent-%COMP%]   .result.successfull[_ngcontent-%COMP%]{filter:var(--ghs-filter-blue)}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack-result[_ngcontent-%COMP%]   .choose[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:row-reverse}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack-result[_ngcontent-%COMP%]   .choose[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%]{display:block;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 12 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));transition:transform calc(var(--ghs-animation-speed) * .15s) cubic-bezier(.75,0,.85,1);transform-origin:center center}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack-result[_ngcontent-%COMP%]   .choose[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%]:first-child{width:calc(var(--ghs-unit) * 9 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));opacity:.5;cursor:pointer}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack-result[_ngcontent-%COMP%]   .choose[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%]:first-child:hover{transform:scale(1.3333);opacity:1}.outpost-attack-dialog[_ngcontent-%COMP%]   .attack-result[_ngcontent-%COMP%]   .choose[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%]:first-child:hover + ghs-attackmodifier[_ngcontent-%COMP%]{transform:scale(.75);opacity:.5}.outpost-attack-dialog[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]{display:flex;justify-content:center;min-width:calc(var(--ghs-unit) * 55 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 20 * var(--ghs-dialog-factor));overflow-x:auto;overflow-y:visible}.outpost-attack-dialog[_ngcontent-%COMP%]   .town-guard-deck-container[_ngcontent-%COMP%]   .town-guard-deck[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 37.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 10 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:flex-start;font-size:1.5em}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   table.other[_ngcontent-%COMP%]{opacity:.6}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{opacity:.5}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   td.name[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{justify-content:flex-start}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:grab;width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:100%;height:auto;filter:var(--ghs-filter-white)}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   .target[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:auto}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;align-items:center}.outpost-attack-dialog[_ngcontent-%COMP%]   .buildings[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));width:auto;filter:var(--ghs-filter-white)}.outpost-attack-dialog[_ngcontent-%COMP%]   ghs-buildings-list[_ngcontent-%COMP%]{display:block;min-width:calc(var(--ghs-unit) * 55 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor)) 0;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly;align-items:center}.outpost-attack-dialog[_ngcontent-%COMP%]   .menu.small[_ngcontent-%COMP%]{justify-content:center;margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor)) 0;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.7 * var(--ghs-dialog-factor))}.outpost-attack-dialog[_ngcontent-%COMP%]   .menu.small[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{min-width:auto}.outpost-attack-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;display:flex;flex-grow:1;justify-content:center;margin:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.outpost-attack-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.outpost-attack-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.finish[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.outpost-attack-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.outpost-attack-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-darkgray)}.cdk-drag-preview[_ngcontent-%COMP%]{opacity:0;cursor:grabbing;z-index:999}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.5;cursor:grabbing}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}']})}return i})();const fX=(i,r)=>({fh:i,modern:r});let CX=(()=>{class i{data;dialogRef;dialog;settingsManager=m.f;gameManager=s.E;item;blueprint=!1;constructor(e,a,n){this.data=e,this.dialogRef=a,this.dialog=n,this.item=e.item,this.blueprint=e.blueprint}close(){(0,V.co)(this.dialogRef)}openDialog(){this.dialog.open(Me,{panelClass:["fullscreen-panel"],disableClose:!0,data:{item:this.item}})}apply(){(0,V.co)(this.dialogRef,this.item)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-event-random-item-dialog"]],standalone:!1,decls:10,vars:10,consts:[[1,"random-item-dialog",3,"ngClass"],[1,"scroll-container"],[1,"title",3,"ghs-label"],[1,"item"],[3,"click","item","flipped","editionLabel"],[1,"menu"],[1,"cancel",3,"click"],[3,"ghs-label"],[1,"apply",3,"click"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"span",2),t.j41(3,"div",3)(4,"ghs-item",4),t.bIt("click",function(){return n.openDialog()}),t.k0s()(),t.j41(5,"div",5)(6,"a",6),t.bIt("click",function(){return n.close()}),t.nrm(7,"span",7),t.k0s(),t.j41(8,"a",8),t.bIt("click",function(){return n.apply()}),t.nrm(9,"span",7),t.k0s()()()()),2&a&&(t.Y8G("ngClass",t.l_i(7,fX,"fh"==n.settingsManager.settings.theme,"modern"==n.settingsManager.settings.theme)),t.R7$(2),t.Y8G("ghs-label","scenario.eventEffects.drawRandomItem"+(n.blueprint?".blueprint":"")),t.R7$(2),t.Y8G("item",n.item)("flipped",!0)("editionLabel",n.gameManager.currentEdition()),t.R7$(3),t.Y8G("ghs-label","cancel"),t.R7$(2),t.Y8G("ghs-label","scenario.eventEffects.drawRandomItem.apply"))},dependencies:[N.YU,tt,je],styles:[".random-item-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;justify-content:center;font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline);margin-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.random-item-dialog.fh[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.random-item-dialog.modern[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.random-item-dialog[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:100%}.random-item-dialog[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ghs-item[_ngcontent-%COMP%]{display:block;width:calc(var(--ghs-unit) * 27 * var(--ghs-dialog-factor));height:auto}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:2em;padding:.3em}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}.random-item-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}"]})}return i})();const MX=(i,r)=>({fh:i,modern:r}),vX=(i,r,e)=>[i,r,e];let OX=(()=>{class i{data;dialogRef;settingsManager=m.f;gameManager=s.E;scenario;section=!1;unlocks="";constructor(e,a){this.data=e,this.dialogRef=a,this.scenario=e.scenario,this.section=e.section,this.section&&(this.unlocks=this.scenario.unlocks?this.scenario.unlocks.map(n=>"%data.scenarioNumber:"+n+"%").join(", "):"")}close(){(0,V.co)(this.dialogRef)}apply(){(0,V.co)(this.dialogRef,this.scenario)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-event-random-scenario-dialog"]],standalone:!1,decls:10,vars:13,consts:[[1,"random-scenario-dialog",3,"ngClass"],[1,"scroll-container"],[1,"title",3,"ghs-label"],[1,"scenario"],[1,"text-white",3,"ghs-label","ghs-label-args"],[1,"menu"],[1,"cancel",3,"click"],[3,"ghs-label"],[1,"apply",3,"click"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"span",2),t.j41(3,"div",3),t.nrm(4,"span",4),t.k0s(),t.j41(5,"div",5)(6,"a",6),t.bIt("click",function(){return n.close()}),t.nrm(7,"span",7),t.k0s(),t.j41(8,"a",8),t.bIt("click",function(){return n.apply()}),t.nrm(9,"span",7),t.k0s()()()()),2&a&&(t.Y8G("ngClass",t.l_i(6,MX,"fh"==n.settingsManager.settings.theme,"modern"==n.settingsManager.settings.theme)),t.R7$(2),t.Y8G("ghs-label","scenario.eventEffects.drawRandomScenario"),t.R7$(2),t.Y8G("ghs-label","scenario.eventEffects.drawRandomScenario."+(n.section?"section":"scenario"))("ghs-label-args",t.sMw(9,vX,n.scenario.index,n.gameManager.scenarioManager.scenarioTitle(n.scenario,n.section),n.unlocks)),t.R7$(3),t.Y8G("ghs-label","cancel"),t.R7$(2),t.Y8G("ghs-label","scenario.eventEffects.drawRandomScenario.apply"))},dependencies:[N.YU,tt],styles:[".random-scenario-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;justify-content:center;font-size:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline);margin-bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.random-scenario-dialog.fh[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.random-scenario-dialog.modern[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .head-col[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.random-scenario-dialog[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:100%;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.random-scenario-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center}.random-scenario-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:2em;padding:.3em}.random-scenario-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.random-scenario-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.random-scenario-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.random-scenario-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}.random-scenario-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}"]})}return i})();const Tr=i=>({denied:i}),PX=i=>({inactive:i}),bX=(i,r)=>({inactive:i,thumbnail:r}),kX=i=>({fh:i}),Sr=i=>({checked:i}),me=(i,r)=>({"negative-value":i,"positive-value":r}),yX=i=>({gold:i}),xX=i=>[i],rn=i=>({disabled:i}),EX=(i,r)=>r.edition+"-"+r.name,wX=(i,r)=>r.name+r.color+r.number,$r=(i,r)=>("object"==typeof r?r.type:r)+i;function RX(i,r){1&i&&(t.j41(0,"div",5),t.nrm(1,"span",4),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","scenario.eventEffects.hint"))}function jX(i,r){1&i&&t.nrm(0,"img",17)}function GX(i,r){if(1&i&&t.nrm(0,"img",21),2&i){const e=t.XpG().$implicit;t.Y8G("src",t.VkB("./assets/images/summons/",e.color,".png"),t.B4B)}}function TX(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function SX(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.number)}}function $X(i,r){if(1&i&&t.nrm(0,"div",24),2&i){const e=t.XpG().$implicit;t.xc7("background-image",e.thumbnailUrl?"url("+e.thumbnailUrl+")":"url(./assets/images/summons/thumbnail/"+e.thumbnail+".png)")}}function DX(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",19),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(4);return t.Njj(o.toggleSummon(n))}),t.j41(1,"span",20),t.nVh(2,GX,1,2,"img",21),t.j41(3,"span",22),t.nVh(4,TX,2,0,"span"),t.nVh(5,SX,2,1,"span"),t.k0s()(),t.nVh(6,$X,1,2,"div",23),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(4);t.Y8G("ngClass",t.l_i(6,bX,-1==a.activeSummons.indexOf(e),a.settingsManager.settings.artwork&&(e.thumbnail&&!e.noThumbnail||e.thumbnailUrl))),t.R7$(),t.Y8G("ngClass",t.eq3(9,kX,e.color==a.SummonColor.fh)),t.R7$(),t.vxM(e.color!=a.SummonColor.fh?2:-1),t.R7$(2),t.vxM(0==e.number?4:-1),t.R7$(),t.vxM(e.number>0?5:-1),t.R7$(),t.vxM(a.settingsManager.settings.artwork&&(e.thumbnail&&!e.noThumbnail||e.thumbnailUrl)?6:-1)}}function IX(i,r){if(1&i&&t.Z7z(0,DX,7,11,"a",18,wX),2&i){const e=t.XpG().$implicit;t.Dyx(e.summons)}}function AX(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",12)(1,"a",15),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.toggleCharacter(n))})("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.openCharacterSheet(n))}),t.nrm(2,"img",16),t.nVh(3,jX,1,0,"img",17),t.k0s(),t.nVh(4,IX,2,0),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(4,PX,-1==a.activeCharacters.indexOf(e))),t.R7$(),t.Y8G("src",e.iconUrl,t.B4B),t.R7$(),t.vxM(e.absent?3:-1),t.R7$(),t.vxM(a.gameManager.roundManager.firstRound?-1:4)}}function VX(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",25),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openFavors())}),t.nrm(1,"span",4),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","scenario.favors"))}function FX(i,r){if(1&i){const e=t.RV6();t.j41(0,"label",28),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.toggleImbuement())}),t.nrm(1,"span",29)(2,"span",4),t.k0s()}if(2&i){const e=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(2,Sr,1==e.gameManager.imbuementManager.imbuement)),t.R7$(),t.Y8G("ghs-label","scenario.gh2eImbuement.imbuement")}}function XX(i,r){if(1&i){const e=t.RV6();t.j41(0,"label",28),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.toggleImbuement(!0))}),t.nrm(1,"span",29)(2,"span",4),t.k0s()}if(2&i){const e=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(2,Sr,"advanced"==e.gameManager.imbuementManager.imbuement)),t.R7$(),t.Y8G("ghs-label","scenario.gh2eImbuement.advancedImbuement")}}function BX(i,r){if(1&i&&(t.j41(0,"div",14),t.nrm(1,"span",26),t.j41(2,"div",27),t.nVh(3,FX,3,4,"label"),t.nVh(4,XX,3,4,"label"),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.gh2eImbuement"),t.R7$(2),t.vxM("advanced"!=e.gameManager.imbuementManager.imbuement?3:-1),t.R7$(),t.vxM("advanced"==e.gameManager.imbuementManager.available&&1!=e.gameManager.imbuementManager.imbuement?4:-1)}}function YX(i,r){if(1&i&&(t.j41(0,"div",6),t.Z7z(1,AX,5,6,"div",12,EX),t.nVh(3,VX,2,1,"a",13),t.nVh(4,BX,5,3,"div",14),t.k0s()),2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(3,Tr,e.gameManager.stateManager.permissions&&(!e.gameManager.stateManager.permissions.characters||!e.gameManager.stateManager.permissions.party))),t.R7$(),t.Dyx(e.characters),t.R7$(2),t.vxM(e.gameManager.trialsManager.favorsEnabled?3:-1),t.R7$(),t.vxM(e.gameManager.imbuementManager.enabled?4:-1)}}function NX(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",8)(1,"span",30)(2,"ghs-pointer-input",31),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeHealth(-1))}),t.nrm(3,"img",32),t.k0s()(),t.j41(4,"span",33),t.nrm(5,"img",34),t.j41(6,"span",35),t.EFF(7),t.nI1(8,"ghsValueSign"),t.k0s()(),t.j41(9,"span",30)(10,"ghs-pointer-input",31),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeHealth(1))}),t.nrm(11,"img",36),t.k0s()(),t.j41(12,"span",30)(13,"ghs-pointer-input",31),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeBless(-1))}),t.nrm(14,"img",32),t.k0s()(),t.j41(15,"span",37),t.nrm(16,"img",38),t.j41(17,"span",35),t.EFF(18),t.nI1(19,"ghsValueSign"),t.k0s()(),t.j41(20,"span",30)(21,"ghs-pointer-input",31),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeBless(1))}),t.nrm(22,"img",36),t.k0s()(),t.j41(23,"span",30)(24,"ghs-pointer-input",31),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeCurse(-1))}),t.nrm(25,"img",32),t.k0s()(),t.j41(26,"span",37),t.nrm(27,"img",39),t.j41(28,"span",35),t.EFF(29),t.nI1(30,"ghsValueSign"),t.k0s()(),t.j41(31,"span",30)(32,"ghs-pointer-input",31),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeCurse(1))}),t.nrm(33,"img",36),t.k0s()()()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-label","game.health")("ghs-label-attribute","title"),t.R7$(2),t.Y8G("ngClass",t.l_i(30,me,e.minHealth()<0,e.maxHealth()>0)),t.R7$(),t.JRh(t.bMT(8,24,e.minHealth()<0?e.minHealth():e.maxHealth())),t.R7$(3),t.Y8G("repeat",!0),t.R7$(3),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-tooltip","game.condition.bless.hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom"),t.R7$(2),t.Y8G("ngClass",t.l_i(33,me,e.bless<0,e.bless>0)),t.R7$(),t.JRh(t.bMT(19,26,e.bless)),t.R7$(3),t.Y8G("repeat",!0),t.R7$(3),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-tooltip","game.condition.curse.hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom"),t.R7$(2),t.Y8G("ngClass",t.l_i(36,me,e.curse<0,e.curse>0)),t.R7$(),t.JRh(t.bMT(30,28,e.curse)),t.R7$(3),t.Y8G("repeat",!0)}}function zX(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-conditions",40),t.bIt("conditionChange",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.changeConditions(n))}),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("entities",e.activeCharacters)("entityConditions",e.entityConditions)("immunities",e.newImmunities)("type","character")}}function LX(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",30)(1,"ghs-pointer-input",31),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.changeLoot(n,-1))}),t.nrm(2,"img",32),t.k0s()(),t.j41(3,"span",33),t.nrm(4,"img",3),t.j41(5,"span",35),t.EFF(6),t.nI1(7,"ghsValueSign"),t.k0s()(),t.j41(8,"span",30)(9,"ghs-pointer-input",31),t.bIt("singleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.changeLoot(n,1))}),t.nrm(10,"img",36),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-label","game.loot."+e)("ghs-label-attribute","title"),t.R7$(),t.Y8G("src","./assets/images/fh/loot/"+e+".svg",t.B4B),t.R7$(),t.Y8G("ngClass",t.l_i(9,me,a.minLoot(e)<0,a.maxLoot(e)>0)),t.R7$(),t.JRh(t.bMT(7,7,a.minLoot(e)<0?a.minLoot(e):a.maxLoot(e))),t.R7$(3),t.Y8G("repeat",!0)}}function UX(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",8)(1,"span",41),t.nrm(2,"span",4),t.k0s(),t.j41(3,"span",30)(4,"ghs-pointer-input",31),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeExperience(-1))}),t.nrm(5,"img",32),t.k0s()(),t.j41(6,"span",33),t.nrm(7,"img",42),t.j41(8,"span",35),t.EFF(9),t.nI1(10,"ghsValueSign"),t.k0s()(),t.j41(11,"span",30)(12,"ghs-pointer-input",31),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeExperience(1))}),t.nrm(13,"img",36),t.k0s()(),t.j41(14,"span",30)(15,"ghs-pointer-input",31),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeGold(-1))}),t.nrm(16,"img",32),t.k0s()(),t.j41(17,"span",33),t.nrm(18,"img",43),t.j41(19,"span",35),t.EFF(20),t.nI1(21,"ghsValueSign"),t.k0s()(),t.j41(22,"span",30)(23,"ghs-pointer-input",31),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeGold(1))}),t.nrm(24,"img",36),t.k0s()(),t.j41(25,"span",30)(26,"ghs-pointer-input",31),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeBattleGoals(-1))}),t.nrm(27,"img",32),t.k0s()(),t.j41(28,"span",33),t.nrm(29,"input",44),t.j41(30,"span",35),t.EFF(31),t.nI1(32,"ghsValueSign"),t.k0s()(),t.j41(33,"span",30)(34,"ghs-pointer-input",31),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeBattleGoals(1))}),t.nrm(35,"img",36),t.k0s()(),t.Z7z(36,LX,11,12,null,null,t.fX1),t.k0s()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","scenario.eventEffects.progress"),t.R7$(2),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-label","game.experience")("ghs-label-attribute","title"),t.R7$(2),t.Y8G("ngClass",t.l_i(27,me,e.minExperience()<0,e.maxExperience()>0)),t.R7$(),t.JRh(t.bMT(10,21,e.minExperience()<0?e.minExperience():e.maxExperience())),t.R7$(3),t.Y8G("repeat",!0),t.R7$(3),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-label","character.progress.gold")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ngClass",t.eq3(30,yX,!e.gameManager.fhRules()))("src","./assets/images/"+(e.gameManager.fhRules()?"fh/":"")+"loot.svg",t.B4B),t.R7$(),t.Y8G("ngClass",t.l_i(32,me,e.minGold()<0,e.maxGold()>0)),t.R7$(),t.JRh(t.bMT(21,23,e.minGold()<0?e.minGold():e.maxGold())),t.R7$(3),t.Y8G("repeat",!0),t.R7$(3),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-label","game.battleGoals")("ghs-label-attribute","title"),t.R7$(2),t.Y8G("ngClass",t.l_i(35,me,e.minBattleGoals()<0,e.maxBattleGoals()>0)),t.R7$(),t.JRh(t.bMT(32,25,e.minBattleGoals()<0?e.minBattleGoals():e.maxBattleGoals())),t.R7$(3),t.Y8G("repeat",!0),t.R7$(2),t.Dyx(e.lootColumns)}}function qX(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",47)(1,"a",48),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.drawEvent(n))}),t.k0s(),t.j41(2,"img",49),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.setupEvents(n))}),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG(3);t.R7$(),t.Y8G("ghs-label","scenario.eventEffects.drawEvent")("ghs-label-args",t.eq3(4,xX,e))("ngClass",t.eq3(6,rn,!a.gameManager.game.party.eventDecks[e]||0==a.gameManager.game.party.eventDecks[e].length)),t.R7$(),t.Y8G("ghs-tooltip","game.events.deck.setup")}}function HX(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",45),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openOutpostAttack())}),t.k0s()}2&i&&t.Y8G("ghs-label","scenario.eventEffects.outpostAttack")}function KX(i,r){if(1&i&&(t.Z7z(0,qX,3,8,"span",47,t.fX1),t.nVh(2,HX,1,1,"span",46)),2&i){const e=t.XpG(2);t.Dyx(e.eventTypes),t.R7$(2),t.vxM(e.gameManager.fhRules()&&!e.eventAttack?2:-1)}}function WX(i,r){1&i&&t.nrm(0,"img",50)}function JX(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",30)(1,"ghs-pointer-input",51),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.changeReputation(-1))}),t.nrm(2,"img",32),t.k0s()(),t.j41(3,"span",33),t.nrm(4,"span",4),t.j41(5,"span",35),t.EFF(6),t.nI1(7,"ghsValueSign"),t.k0s()(),t.j41(8,"span",30)(9,"ghs-pointer-input",51),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.changeReputation(1))}),t.nrm(10,"img",36),t.k0s()()}if(2&i){const e=t.XpG(3);t.R7$(),t.Y8G("repeat",!0)("ngClass",t.eq3(11,rn,e.gameManager.game.party.reputation+e.reputation<=-20)),t.R7$(2),t.Y8G("ghs-label","party.reputation")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","party.reputation"),t.R7$(),t.Y8G("ngClass",t.l_i(13,me,e.reputation<0,e.reputation>0)),t.R7$(),t.JRh(t.bMT(7,9,e.reputation)),t.R7$(3),t.Y8G("repeat",!0)("ngClass",t.eq3(16,rn,e.gameManager.game.party.reputation+e.reputation>=20))}}function ZX(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",30)(1,"ghs-pointer-input",51),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.changeMorale(-1))}),t.nrm(2,"img",32),t.k0s()(),t.j41(3,"span",33),t.nrm(4,"span",4),t.j41(5,"span",35),t.EFF(6),t.nI1(7,"ghsValueSign"),t.k0s()(),t.j41(8,"span",30)(9,"ghs-pointer-input",51),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.changeMorale(1))}),t.nrm(10,"img",36),t.k0s()()}if(2&i){const e=t.XpG(3);t.R7$(),t.Y8G("repeat",!0)("ngClass",t.eq3(11,rn,e.gameManager.game.party.morale+e.morale<=0)),t.R7$(2),t.Y8G("ghs-label","party.morale")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","party.morale"),t.R7$(),t.Y8G("ngClass",t.l_i(13,me,e.morale<0,e.morale>0)),t.R7$(),t.JRh(t.bMT(7,9,e.morale)),t.R7$(3),t.Y8G("repeat",!0)("ngClass",t.eq3(16,rn,e.gameManager.game.party.morale+e.morale>=20))}}function QX(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",30)(1,"ghs-pointer-input",51),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.changeInspiration(-1))}),t.nrm(2,"img",32),t.k0s()(),t.j41(3,"span",33),t.nrm(4,"span",4),t.j41(5,"span",35),t.EFF(6),t.nI1(7,"ghsValueSign"),t.k0s()(),t.j41(8,"span",30)(9,"ghs-pointer-input",51),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.changeInspiration(1))}),t.nrm(10,"img",36),t.k0s()()}if(2&i){const e=t.XpG(3);t.R7$(),t.Y8G("repeat",!0)("ngClass",t.eq3(11,rn,e.gameManager.game.party.inspiration+e.inspiration<=0)),t.R7$(2),t.Y8G("ghs-label","party.inspiration")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","party.inspiration"),t.R7$(),t.Y8G("ngClass",t.l_i(13,me,e.inspiration<0,e.inspiration>0)),t.R7$(),t.JRh(t.bMT(7,9,e.inspiration)),t.R7$(3),t.Y8G("repeat",!0)("ngClass",t.eq3(16,rn,e.gameManager.game.party.inspiration+e.inspiration>=20))}}function tB(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",30)(1,"ghs-pointer-input",31),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeProsperity(-1))}),t.nrm(2,"img",32),t.k0s()(),t.j41(3,"span",33),t.nVh(4,WX,1,0,"img",50),t.nrm(5,"span",4),t.j41(6,"span",35),t.EFF(7),t.nI1(8,"ghsValueSign"),t.k0s()(),t.j41(9,"span",30)(10,"ghs-pointer-input",31),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.changeProsperity(1))}),t.nrm(11,"img",36),t.k0s()(),t.nVh(12,JX,11,18),t.nVh(13,ZX,11,18),t.nVh(14,QX,11,18)}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("repeat",!0),t.R7$(2),t.Y8G("ghs-label","party.prosperity")("ghs-label-attribute","title"),t.R7$(),t.vxM(e.gameManager.fhRules()?4:-1),t.R7$(),t.Y8G("ghs-label","party.prosperity"),t.R7$(),t.Y8G("ngClass",t.l_i(13,me,e.prosperity<0,e.prosperity>0)),t.R7$(),t.JRh(t.bMT(8,11,e.prosperity)),t.R7$(3),t.Y8G("repeat",!0),t.R7$(2),t.vxM(e.gameManager.fhRules()?-1:12),t.R7$(),t.vxM(e.gameManager.fhRules()?13:-1),t.R7$(),t.vxM(e.gameManager.fhRules()?14:-1)}}function eB(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",45),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.drawRandomItem(!0))}),t.k0s()}2&i&&t.Y8G("ghs-label","scenario.eventEffects.drawRandomItem.blueprint")}function nB(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",10)(1,"span",41),t.nrm(2,"span",4),t.k0s(),t.nVh(3,KX,3,1),t.nVh(4,tB,15,16),t.j41(5,"span",45),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.drawRandomItem())}),t.k0s(),t.nVh(6,eB,1,1,"span",46),t.j41(7,"span",45),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.drawRandomScenario(n.gameManager.fhRules()))}),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","scenario.eventEffects.campaign"),t.R7$(),t.vxM(e.settingsManager.settings.events?3:-1),t.R7$(),t.vxM(e.gameManager.roundManager.firstRound?4:-1),t.R7$(),t.Y8G("ghs-label","scenario.eventEffects.drawRandomItem"),t.R7$(),t.vxM(e.gameManager.fhRules()?6:-1),t.R7$(),t.Y8G("ghs-label","scenario.eventEffects.drawRandomScenario")}}function iB(i,r){1&i&&t.nrm(0,"span",26),2&i&&t.Y8G("ghs-label","game.events.applyManually")}function aB(i,r){1&i&&t.nrm(0,"ghs-event-card-condition",52),2&i&&t.Y8G("condition",r.$implicit)("light",!0)("selected",!0)}function oB(i,r){1&i&&t.nrm(0,"ghs-event-card-effect",53),2&i&&t.Y8G("effect",r.$implicit)("light",!0)("selected",!0)}function sB(i,r){1&i&&t.nrm(0,"span",54),2&i&&t.Y8G("ghs-label","game.events.outpostAttack")}function rB(i,r){1&i&&t.nrm(0,"span",26),2&i&&t.Y8G("ghs-label","game.events.outpostAttack.effects")}function cB(i,r){1&i&&t.nrm(0,"ghs-event-card-effect",53),2&i&&t.Y8G("effect",r.$implicit)("light",!0)("selected",!0)}function lB(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-event-card-attack",57),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openOutpostAttack())}),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("attack",e.eventAttack)("light",!0)("selected",!0)("narrative",!1)("effects",!1)("disabled",!0)}}function gB(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",11),t.nVh(1,iB,1,1,"span",26),t.Z7z(2,aB,1,3,"ghs-event-card-condition",52,t.fX1),t.Z7z(4,oB,1,3,"ghs-event-card-effect",53,$r),t.nVh(6,sB,1,1,"span",54),t.nVh(7,rB,1,1,"span",26),t.Z7z(8,cB,1,3,"ghs-event-card-effect",53,$r),t.nVh(10,lB,1,6,"ghs-event-card-attack",55),t.j41(11,"a",56),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openPartySheet())}),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(),t.vxM(e.eventEffectsManual.length||e.eventConditionManual.length?1:-1),t.R7$(),t.Dyx(e.eventConditionManual),t.R7$(2),t.Dyx(e.eventEffectsManual),t.R7$(2),t.vxM(e.eventAttack?6:-1),t.R7$(),t.vxM(e.eventOutpostAttackEffects.length?7:-1),t.R7$(),t.Dyx(e.eventOutpostAttackEffects),t.R7$(2),t.vxM(e.eventAttack?10:-1),t.R7$(),t.Y8G("ghs-label","campaign.party")}}let ni=(()=>{class i{dialog;gameManager=s.E;settingsManager=m.f;menu=!1;characters=[];activeCharacters=[];activeSummons=[];entityConditions=[];immunities=[];newImmunities=[];health=[];experience=[];gold=[];battleGoals=[];bless=0;curse=0;prosperity=0;reputation=0;morale=0;inspiration=0;loot=[];lootColumns=[];SummonColor=lt.rX;eventTypes=[];eventEffectsManual=[];eventOutpostAttackEffects=[];eventConditionManual=[];eventAttack;constructor(e,a){this.dialog=a,this.menu=e&&e.menu||!1,this.createEventResults(e&&e.eventResults||[],!0)}ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.close(),this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(e=!1){e||(this.characters=s.E.game.figures.filter(a=>a instanceof q.K).map(a=>a),this.activeCharacters=this.characters.filter(a=>!a.absent&&!a.exhausted),this.activeSummons=s.E.roundManager.firstRound?[]:this.activeCharacters.map(a=>a.summons).flat(),this.lootColumns=s.E.fhRules()?[ot.r6.lumber,ot.r6.metal,ot.r6.hide,ot.r6.arrowvine,ot.r6.axenut,ot.r6.corpsecap,ot.r6.flamefruit,ot.r6.rockroot,ot.r6.snowthistle]:[]),this.entityConditions=[],this.immunities=[],this.newImmunities=[],this.activeCharacters.forEach((a,n,o)=>{a.entityConditions.forEach(g=>{!this.entityConditions.find(_=>_.name==g.name)&&o.every(_=>_.entityConditions.find(y=>y.name==g.name&&y.state==g.state))&&this.entityConditions.push(JSON.parse(JSON.stringify(g)))}),a.immunities.forEach(g=>{!this.immunities.find(_=>_==g)&&o.every(_=>_.immunities.find(y=>y==g))&&(this.immunities.push(g),this.newImmunities.push(g))})}),this.activeSummons.forEach((a,n,o)=>{a.entityConditions.forEach(g=>{!this.entityConditions.find(_=>_.name==g.name)&&o.every(_=>_.entityConditions.find(y=>y.name==g.name&&y.state==g.state))&&this.entityConditions.push(JSON.parse(JSON.stringify(g)))}),a.immunities.forEach(g=>{!this.immunities.find(_=>_==g)&&o.every(_=>_.immunities.find(y=>y==g))&&(this.immunities.push(g),this.newImmunities.push(g))})}),this.eventTypes=Object.keys(s.E.game.party.eventDecks),"fh"==s.E.game.edition&&(this.eventTypes=Math.max(s.E.game.party.weeks-1,0)%20<10?this.eventTypes.filter(a=>!a.startsWith("winter-")):this.eventTypes.filter(a=>!a.startsWith("summer-")))}toggleCharacter(e){-1==this.activeCharacters.indexOf(e)?(this.activeCharacters.push(e),e.summons.forEach(a=>{-1==this.activeSummons.indexOf(a)&&this.activeSummons.push(a)})):(this.activeCharacters.splice(this.activeCharacters.indexOf(e),1),e.summons.forEach(a=>{const n=this.activeSummons.indexOf(a);-1!=n&&this.activeSummons.splice(n,1)})),this.update(!0)}toggleSummon(e){-1==this.activeSummons.indexOf(e)?this.activeSummons.push(e):this.activeSummons.splice(this.activeSummons.indexOf(e),1),this.update(!0)}changeHealth(e){this.activeCharacters.forEach((a,n)=>{this.health[n]=this.health[n]||0,this.health[n]+=e;let o=(0,$.hZ)(a.maxHealth);"lightning"==a.name&&a.tags.find(g=>"unbridled-power"===g)&&(o=Math.max(o,26)),a.health+this.health[n]>o?this.health[n]=o-a.health:a.health+this.health[n]<0&&(this.health[n]=-a.health)}),this.activeSummons.forEach((a,n)=>{const o=this.activeCharacters.length+n;this.health[o]=this.health[o]||0,this.health[o]+=e;const g=(0,$.hZ)(a.maxHealth);a.health+this.health[o]>g?this.health[o]=g-a.health:a.health+this.health[o]<0&&(this.health[o]=-a.health)})}minHealth(){return 0==this.health.length&&(this.health[0]=0),this.health.reduce((e,a)=>Math.min(e,a))}maxHealth(){return 0==this.health.length&&(this.health[0]=0),this.health.reduce((e,a)=>Math.max(e,a))}changeExperience(e){this.activeCharacters.forEach((a,n)=>{this.experience[n]=this.experience[n]||0,this.experience[n]+=e,a.progress.experience+this.experience[n]<0&&(this.experience[n]=-a.progress.experience)})}minExperience(){return 0==this.experience.length&&(this.experience[0]=0),this.experience.reduce((e,a)=>Math.min(e,a))}maxExperience(){return 0==this.experience.length&&(this.experience[0]=0),this.experience.reduce((e,a)=>Math.max(e,a))}changeGold(e){this.activeCharacters.forEach((a,n)=>{this.gold[n]=this.gold[n]||0,this.gold[n]+=e,a.progress.gold+this.gold[n]<0&&(this.gold[n]=-a.progress.gold)})}minGold(){return 0==this.gold.length&&(this.gold[0]=0),this.gold.reduce((e,a)=>Math.min(e,a))}maxGold(){return 0==this.gold.length&&(this.gold[0]=0),this.gold.reduce((e,a)=>Math.max(e,a))}changeBattleGoals(e){this.activeCharacters.forEach((a,n)=>{this.battleGoals[n]=this.battleGoals[n]||0,this.battleGoals[n]+=e,a.progress.battleGoals+this.battleGoals[n]<0&&(this.battleGoals[n]=-a.progress.battleGoals),this.battleGoals[n]<-a.progress.battleGoals%3&&(this.battleGoals[n]=-a.progress.battleGoals%3)})}minBattleGoals(){return 0==this.battleGoals.length&&(this.battleGoals[0]=0),this.battleGoals.reduce((e,a)=>Math.min(e,a))}maxBattleGoals(){return 0==this.battleGoals.length&&(this.battleGoals[0]=0),this.battleGoals.reduce((e,a)=>Math.max(e,a))}changeBless(e){this.bless+=e;const a=s.E.attackModifierManager.countUpcomingBlesses();a+this.bless<0?this.bless=-a:a+this.bless>10&&(this.bless=10-a)}changeCurse(e){this.curse+=e;const a=s.E.attackModifierManager.countUpcomingCurses(!1);a+this.curse<0?this.curse=-a:a+this.curse>10&&(this.curse=10-a)}changeConditions(e){this.entityConditions=e}changeProsperity(e){this.prosperity+=e,s.E.game.party.prosperity+this.prosperity<0&&(this.prosperity=-s.E.game.party.prosperity)}changeReputation(e){this.reputation+=e,s.E.game.party.reputation+this.reputation<-20?this.reputation=-s.E.game.party.reputation-20:s.E.game.party.reputation+this.reputation>20&&(this.reputation=20-s.E.game.party.reputation)}changeMorale(e){this.morale+=e,s.E.game.party.morale+this.morale<0?this.morale=-s.E.game.party.morale:s.E.game.party.morale+this.morale>20&&(this.morale=20-s.E.game.party.morale)}changeInspiration(e){this.inspiration+=e,s.E.game.party.inspiration+this.inspiration<0&&(this.inspiration=-s.E.game.party.inspiration)}changeLoot(e,a){this.activeCharacters.forEach((n,o)=>{this.loot[o]=this.loot[o]||{},this.loot[o][e]=(this.loot[o][e]||0)+a,(n.progress.loot[e]||0)+(this.loot[o][e]||0)<0&&(this.loot[o][e]=-(n.progress.loot[e]||0))})}minLoot(e){return 0==this.loot.length&&(this.loot[0]={},this.loot[0][e]=0),this.loot.map(a=>a[e]||0).reduce((a,n)=>Math.min(a,n))}maxLoot(e){return 0==this.loot.length&&(this.loot[0]={},this.loot[0][e]=0),this.loot.map(a=>a[e]||0).reduce((a,n)=>Math.max(a,n))}drawRandomItem(e=!1){let a=s.E.itemManager.drawRandomItem(s.E.currentEdition(),e);a?this.dialog.open(CX,{panelClass:["dialog"],data:{item:a,blueprint:e}}).closed.subscribe({next:n=>{if(n){const o=n;s.E.stateManager.before("eventEffect.drawRandomItem"+(e?"Blueprint":""),o.id,o.edition,o.name),s.E.game.party.unlockedItems.push(new vt.VP(""+o.id,o.edition)),s.E.stateManager.after()}}}):e&&this.inspiration++}drawRandomScenario(e=!1){let a=e?s.E.scenarioManager.drawRandomScenarioSection(s.E.currentEdition()):s.E.scenarioManager.drawRandomScenario(s.E.currentEdition());a?this.dialog.open(OX,{panelClass:["dialog"],data:{scenario:a,section:e}}).closed.subscribe({next:n=>{if(n){const o=n;if(e){const g=o.unlocks?o.unlocks.map(_=>"%data.scenarioNumber:"+_+"%").join(", "):"";s.E.stateManager.before("eventEffect.drawRandomScenarioSection",o.index,o.edition,o.name,g),s.E.game.party.conclusions.push(new ht.Ag(""+o.index,o.edition,o.group)),s.E.stateManager.after()}else s.E.stateManager.before("eventEffect.drawRandomScenario",o.index,o.edition,o.name),s.E.game.party.manualScenarios.push(new ht.Ag(o.index,o.edition,o.group)),s.E.stateManager.after()}}}):e&&this.inspiration++}drawEvent(e){this.dialog.open(Ti,{panelClass:["dialog"],data:{edition:s.E.game.party.edition||s.E.currentEdition(),type:e}}).closed.subscribe({next:a=>{m.f.settings.eventsApply&&a&&this.createEventResults(a)}})}createEventResults(e,a=!1){this.eventEffectsManual=[],this.eventOutpostAttackEffects=[],this.eventConditionManual=[],this.eventAttack=void 0,e.forEach(n=>{"type"in n&&n.type in xt.Yj?n.type==xt.Yj.outpostAttack||n.type==xt.Yj.outpostTarget?this.eventOutpostAttackEffects.push(n):this.eventEffectsManual.push(n):"type"in n&&n.type in xt.iH?this.eventConditionManual.push(n):"type"in n||(this.eventAttack=n)})}openOutpostAttack(){this.dialog.open(uX,{panelClass:["dialog"],data:{attack:this.eventAttack,effects:this.eventOutpostAttackEffects}}).closed.subscribe({next:e=>{e&&(this.eventAttack=void 0,this.eventOutpostAttackEffects=[])}})}close(){const e=this.activeCharacters.map(a=>"%game.characterIconColored."+a.name+"%").join(",");if(this.entityConditions.filter(a=>a.state==j.mg.new||a.state==j.mg.removed).forEach(a=>{s.E.stateManager.before(a.state==j.mg.removed?"eventEffect.removeCondition":"eventEffect.addCondition",a.name,e),this.activeCharacters.forEach(n=>{a.state==j.mg.removed?s.E.entityManager.removeCondition(n,n,a,a.permanent):s.E.entityManager.addCondition(n,n,a,a.permanent)}),this.characters.forEach(n=>{n.summons.forEach(o=>{-1!=this.activeSummons.indexOf(o)&&(a.state==j.mg.removed?s.E.entityManager.removeCondition(o,n,a,a.permanent):s.E.entityManager.addCondition(o,n,a,a.permanent))})}),s.E.stateManager.after()}),this.entityConditions.forEach(a=>{this.activeCharacters.find(n=>n.entityConditions.find(o=>o.name==a.name&&!o.expired&&o.value!=a.value))&&(s.E.stateManager.before("eventEffect.setConditionValue",a.name,""+a.value,e),this.activeCharacters.forEach(n=>{const o=n.entityConditions.find(g=>g.name==a.name&&!g.expired);o&&o.value!=a.value&&(o.value=a.value)}),this.characters.forEach(n=>{n.summons.forEach(o=>{if(-1!=this.activeSummons.indexOf(o)){const g=o.entityConditions.find(_=>_.name==a.name&&!_.expired);g&&g.value!=a.value&&(g.value=a.value)}})}),s.E.stateManager.after())}),this.immunities.forEach(a=>{-1==this.newImmunities.indexOf(a)&&(s.E.stateManager.before("eventEffect.removeImmunity",a,e),this.activeCharacters.forEach(n=>{n.immunities=n.immunities.filter(o=>o!=a)}),this.characters.forEach(n=>{n.summons.forEach(o=>{-1!=this.activeSummons.indexOf(o)&&(o.immunities=o.immunities.filter(g=>g!=a))})}),s.E.stateManager.after())}),this.newImmunities.forEach(a=>{-1==this.immunities.indexOf(a)&&(s.E.stateManager.before("eventEffect.addImmunity",a,e),this.activeCharacters.find(n=>{n.immunities.push(a)}),this.characters.find(n=>{n.summons.forEach(o=>{-1!=this.activeSummons.indexOf(o)&&o.immunities.push(a)})}),s.E.stateManager.after())}),(0!=this.minHealth()||0!=this.maxHealth())&&(s.E.stateManager.before("eventEffect.changeCharacterHP",(0,V.n1)(0!=this.minHealth()?this.minHealth():this.maxHealth()),e),this.activeCharacters.forEach((a,n)=>{this.health[n]&&0!=this.health[n]&&(s.E.entityManager.changeHealth(a,a,this.health[n]),this.health[n]=0),(a.maxHealth>0&&a.health<=0||a.exhausted)&&(a.exhausted=!0)}),this.characters.forEach(a=>{a.summons.forEach(n=>{const o=this.activeSummons.indexOf(n);if(-1!=o){const g=this.activeCharacters.length+o;this.health[g]&&0!=this.health[g]&&(s.E.entityManager.changeHealth(n,a,this.health[g]),this.health[g]=0),(n.maxHealth>0&&n.health<=0||n.dead)&&(n.dead=!0)}})}),s.E.stateManager.after()),(0!=this.minExperience()||0!=this.maxExperience())&&(s.E.stateManager.before("eventEffect.changeCharacterXP",(0,V.n1)(0!=this.minExperience()?this.minExperience():this.maxExperience()),e),this.activeCharacters.forEach((a,n)=>{this.experience[n]&&0!=this.experience[n]&&(a.progress.experience+=this.experience[n],this.experience[n]=0)}),s.E.stateManager.after()),(0!=this.minGold()||0!=this.maxGold())&&(s.E.stateManager.before("eventEffect.changeCharacterGold",(0,V.n1)(0!=this.minGold()?this.minGold():this.maxGold()),e),this.activeCharacters.forEach((a,n)=>{this.gold[n]&&0!=this.gold[n]&&(a.progress.gold+=this.gold[n],this.gold[n]=0)}),s.E.stateManager.after()),(0!=this.minBattleGoals()||0!=this.maxBattleGoals())&&(s.E.stateManager.before("eventEffect.changeCharacterBattleGoals",(0,V.n1)(0!=this.minBattleGoals()?this.minBattleGoals():this.maxBattleGoals()),e),this.activeCharacters.forEach((a,n)=>{this.battleGoals[n]&&0!=this.battleGoals[n]&&(a.progress.battleGoals+=this.battleGoals[n],this.battleGoals[n]=0)}),s.E.stateManager.after()),0!=this.bless){s.E.stateManager.before("eventEffect.changeCharacterBless",(0,V.n1)(this.bless),e);let a=Math.abs(this.bless),n=0;for(;a>0;){const o=this.activeCharacters[n%this.activeCharacters.length];if(this.bless<0){let g=o.attackModifierDeck.cards.find((_,y)=>_.type==Y.Yn.bless&&y>o.attackModifierDeck.current);g&&(o.attackModifierDeck.cards.splice(o.attackModifierDeck.cards.indexOf(g),1),a--)}else s.E.attackModifierManager.addModifier(o.attackModifierDeck,new Y.uU(Y.Yn.bless)),a--;n++}s.E.stateManager.after()}if(0!=this.curse){s.E.stateManager.before("eventEffect.changeCharacterCurse",(0,V.n1)(this.curse),e);let a=Math.abs(this.curse),n=0;for(;a>0;){const o=this.activeCharacters[n%this.activeCharacters.length];if(this.curse<0){let g=o.attackModifierDeck.cards.find((_,y)=>_.type==Y.Yn.curse&&y>o.attackModifierDeck.current);g&&(o.attackModifierDeck.cards.splice(o.attackModifierDeck.cards.indexOf(g),1),a--)}else s.E.attackModifierManager.addModifier(o.attackModifierDeck,new Y.uU(Y.Yn.curse)),a--;n++}s.E.stateManager.after()}0!=this.prosperity&&(s.E.stateManager.before("eventEffect.prosperity",(0,V.n1)(this.prosperity)),s.E.game.party.prosperity+=this.prosperity,s.E.stateManager.after()),0!=this.reputation&&(s.E.stateManager.before("eventEffect.reputation",(0,V.n1)(this.reputation)),s.E.game.party.reputation+=this.reputation,s.E.stateManager.after()),0!=this.morale&&(s.E.stateManager.before("eventEffect.morale",(0,V.n1)(this.morale)),s.E.game.party.morale+=this.morale,s.E.stateManager.after()),0!=this.inspiration&&(s.E.stateManager.before("eventEffect.inspiration",(0,V.n1)(this.inspiration)),s.E.game.party.inspiration+=this.inspiration,s.E.stateManager.after()),this.lootColumns.forEach(a=>{(0!=this.minLoot(a)||0!=this.maxLoot(a))&&(s.E.stateManager.before("eventEffect.changeCharacterResource",a,(0,V.n1)(0!=this.minLoot(a)?this.minLoot(a):this.maxLoot(a)),e),this.activeCharacters.forEach((n,o)=>{this.loot[o]&&this.loot[o][a]&&(n.progress.loot[a]=(n.progress.loot[a]||0)+(this.loot[o][a]||0),this.loot[o][a]=0)}),s.E.stateManager.after())})}openFavors(){this.dialog.open(wr,{panelClass:["dialog"]})}toggleImbuement(e=!1){s.E.imbuementManager.imbuement?(s.E.stateManager.before("gh2eImbuement.disable"),s.E.imbuementManager.disable(s.E.game.monsterAttackModifierDeck)):e?(s.E.stateManager.before("gh2eImbuement.advanced"),s.E.imbuementManager.advanced(s.E.game.monsterAttackModifierDeck)):(s.E.stateManager.before("gh2eImbuement"),s.E.imbuementManager.enable(s.E.game.monsterAttackModifierDeck)),s.E.stateManager.after()}setupEvents(e){this.dialog.open(Ba,{panelClass:["dialog"],data:{type:e,edition:s.E.game.edition||s.E.currentEdition()}})}openPartySheet(){this.dialog.open(Ue,{panelClass:["dialog-invert"],data:{partySheet:!0}})}openCharacterSheet(e){this.dialog.open(Re,{panelClass:["dialog-invert"],data:{character:e}})}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-event-effects"]],standalone:!1,decls:13,vars:12,consts:[[1,"event-effects-dialog"],[1,"header"],[1,"name"],[1,"ghs-svg",3,"src"],[3,"ghs-label"],[1,"text"],[1,"characters",3,"ngClass"],[1,"scroll-container","container",3,"ngClass"],[1,"entity-container"],[3,"entities","entityConditions","immunities","type"],[1,"entity-container","campaign"],[1,"entity-container","event-outcomes"],[1,"character-container"],[1,"favors"],[1,"imbuement"],["tabclick","","ghs-pointer-input","",1,"character",3,"singleClick","doubleClick","ngClass"],[1,"icon",3,"src"],["src","./assets/images/status/absent.svg",1,"absent"],["tabclick","",1,"summon",3,"ngClass"],["tabclick","",1,"summon",3,"click","ngClass"],[1,"summon-state",3,"ngClass"],[3,"src"],[1,"summon-number"],[1,"background-image",3,"background-image"],[1,"background-image"],[1,"favors",3,"click"],[1,"title",3,"ghs-label"],[1,"checkboxes"],[3,"click"],[1,"input-checkbox",3,"ngClass"],[1,"item"],["tabclick","",1,"button",3,"singleClick","repeat"],["src","./assets/images/minus.svg",1,"ghs-svg"],[1,"item",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/status/health.svg"],[1,"badge",3,"ngClass"],["src","./assets/images/plus.svg",1,"ghs-svg"],[1,"item",3,"ghs-tooltip","originX","overlayX","originY","overlayY"],["src","./assets/images/status/bless.svg"],["src","./assets/images/status/curse.svg"],[3,"conditionChange","entities","entityConditions","immunities","type"],[1,"progress"],["src","./assets/images/status/experience.svg"],[1,"ghs-svg",3,"ngClass","src"],["type","checkbox","disabled","true","checked","true"],["tabclick","",1,"action",3,"click","ghs-label"],["tabclick","",1,"action",3,"ghs-label"],[1,"event-deck-container"],["tabclick","",1,"action",3,"click","ghs-label","ghs-label-args","ngClass"],["src","./assets/images/settings.svg",1,"ghs-svg",3,"click","ghs-tooltip"],["src","./assets/images/fh/prosperity.svg",1,"ghs-svg"],["tabclick","",1,"button",3,"singleClick","repeat","ngClass"],[3,"condition","light","selected"],[3,"effect","light","selected"],[1,"title","outpost",3,"ghs-label"],[3,"attack","light","selected","narrative","effects","disabled"],[1,"action",3,"click","ghs-label"],[3,"click","attack","light","selected","narrative","effects","disabled"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.nrm(3,"img",3)(4,"span",4),t.k0s(),t.nVh(5,RX,2,1,"div",5),t.nVh(6,YX,5,5,"div",6),t.k0s(),t.j41(7,"div",7),t.nVh(8,NX,34,39,"div",8),t.nVh(9,zX,1,4,"ghs-conditions",9),t.nVh(10,UX,38,38,"div",8),t.nVh(11,nB,8,6,"div",10),t.nVh(12,gB,12,5,"div",11),t.k0s()()),2&a&&(t.R7$(3),t.Y8G("src","./assets/images/event"+(n.menu?"-effects":"")+".svg",t.B4B),t.R7$(),t.Y8G("ghs-label","scenario.eventEffects"+(n.menu?".hint":"")),t.R7$(),t.vxM(!n.menu&&n.characters.length?5:-1),t.R7$(),t.vxM(n.characters.length?6:-1),t.R7$(),t.Y8G("ngClass",t.eq3(10,Tr,n.gameManager.stateManager.permissions&&(!n.gameManager.stateManager.permissions.characters||!n.gameManager.stateManager.permissions.party))),t.R7$(),t.vxM(n.gameManager.game.scenario&&n.characters.length?8:-1),t.R7$(),t.vxM(n.gameManager.game.scenario&&n.characters.length?9:-1),t.R7$(),t.vxM(n.characters.length?10:-1),t.R7$(),t.vxM(n.settingsManager.settings.partySheet?11:-1),t.R7$(),t.vxM(n.eventEffectsManual.length||n.eventConditionManual.length||n.eventAttack||n.eventOutpostAttackEffects.length?12:-1))},dependencies:[N.YU,mi,Va,$a,Ia,tt,ft,rt,At,Cn],styles:[".event-effects-dialog[_ngcontent-%COMP%]{position:relative}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-barsize))}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:flex-start;flex-wrap:wrap;margin:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor)) 0}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:flex-start;flex-wrap:wrap}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]{position:relative;cursor:pointer;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 6.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 6.5 * var(--ghs-dialog-factor));margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-white);border-radius:100%}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));width:auto}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   .absent[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]   .absent[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0;height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));width:auto;filter:var(--ghs-filter-white)}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character.inactive[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon.inactive[_ngcontent-%COMP%]{filter:grayscale(.7);border-color:transparent}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]:hover, .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon[_ngcontent-%COMP%]:hover{filter:none;opacity:.7;border-color:var(--ghs-color-gray)}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character.summon[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon.summon[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 4);height:calc(var(--ghs-unit) * 4)}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character.summon[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon.summon[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character.summon[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon.summon[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%]{position:absolute;display:flex;justify-content:center;align-items:center;top:0;left:calc(var(--ghs-unit) * -.1);height:calc(var(--ghs-unit) * 4);width:calc(var(--ghs-unit) * 2);font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5);color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray);border-top-left-radius:calc(var(--ghs-unit) * 4);border-bottom-left-radius:calc(var(--ghs-unit) * 4);z-index:3;opacity:.9;transition:top calc(var(--ghs-animation-speed) * .5s) ease-out,left calc(var(--ghs-animation-speed) * .5s) ease-out}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character.summon[_ngcontent-%COMP%]   .summon-state.fh[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon.summon[_ngcontent-%COMP%]   .summon-state.fh[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5);height:calc(var(--ghs-unit) * 3.5)}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character.summon[_ngcontent-%COMP%]   .summon-state.fh[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon.summon[_ngcontent-%COMP%]   .summon-state.fh[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5);height:calc(var(--ghs-unit) * 3.5);font-family:var(--ghs-font-gh-title);font-size:calc(var(--ghs-unit) * 2.5);color:var(--ghs-color-white);border:calc(var(--ghs-unit) * .3) solid var(--ghs-color-white);border-radius:100%}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character.summon.inactive[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon.summon.inactive[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]   .summon-number[_ngcontent-%COMP%]{filter:brightness(.7);color:var(--ghs-color-gray);border-color:var(--ghs-color-gray)}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character.summon.thumbnail[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon.summon.thumbnail[_ngcontent-%COMP%]   .summon-state[_ngcontent-%COMP%]{position:absolute;top:70%;left:60%;transform:translateY(-50%);z-index:2}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character.summon.thumbnail[_ngcontent-%COMP%]   .background-image[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon.summon.thumbnail[_ngcontent-%COMP%]   .background-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:150%;background-size:100% AUTO;background-color:transparent;background-repeat:no-repeat;z-index:1}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .character.summon.thumbnail.inactive[_ngcontent-%COMP%]   .background-image[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character-container[_ngcontent-%COMP%]   .summon.summon.thumbnail.inactive[_ngcontent-%COMP%]   .background-image[_ngcontent-%COMP%]{filter:brightness(.7) grayscale(.5)}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));cursor:pointer;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .imbuement[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));font-family:var(--ghs-font-text);color:var(--ghs-color-gray);display:flex;flex-direction:column}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .imbuement[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .imbuement[_ngcontent-%COMP%]   .checkboxes[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.event-effects-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .imbuement[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));display:flex;align-items:center;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));cursor:pointer}.event-effects-dialog[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{display:flex;max-height:calc(90vh - var(--ghs-unit) * 25 * var(--ghs-dialog-factor))}.event-effects-dialog[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]{display:flex;justify-content:center;grid-column:span 3;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor)));align-content:start;margin:0 auto}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   span.item[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   span.item[_ngcontent-%COMP%]   img.gold[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   ghs-pointer-input[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   a.button[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   ghs-pointer-input.button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   a.button[_ngcontent-%COMP%]:hover, .event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   ghs-pointer-input.button[_ngcontent-%COMP%]:hover{opacity:.4}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   ghs-pointer-input.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray)}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   ghs-pointer-input.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)!important}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:auto}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0;color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));text-shadow:var(--ghs-outline);text-align:center}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;grid-column:span 3;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));margin:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]:hover{opacity:.7}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container[_ngcontent-%COMP%]   .action.disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.5}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container.campaign[_ngcontent-%COMP%]{grid-template-columns:repeat(3,auto)}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container.campaign[_ngcontent-%COMP%]   span.item[_ngcontent-%COMP%]{color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));width:auto;padding:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container.campaign[_ngcontent-%COMP%]   .event-deck-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;grid-column:span 3}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container.campaign[_ngcontent-%COMP%]   .event-deck-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{cursor:pointer;height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));filter:var(--ghs-filter-gray)}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container.campaign[_ngcontent-%COMP%]   .event-deck-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{opacity:.7}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container.event-outcomes[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));color:var(--ghs-color-white);display:flex;flex-direction:column;padding:0 calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));max-width:calc(var(--ghs-unit) * 35 * var(--ghs-dialog-factor))}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container.event-outcomes[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container.event-outcomes[_ngcontent-%COMP%]   .title.outpost[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));font-family:var(--ghs-font-normal)}.event-effects-dialog[_ngcontent-%COMP%]   .entity-container.event-outcomes[_ngcontent-%COMP%]   ghs-event-card-attack[_ngcontent-%COMP%]{cursor:pointer}"]})}return i})();const dB=(i,r)=>({flipped:i,fh:r}),Dr=()=>[],Ja=(i,r)=>({normal:i,elite:r}),hB=(i,r,e,a,n,o)=>({obstacle:i,"difficult-terrain":r,"hazardous-terrain":e,trap:a,treasure:n,loot:o});function _B(i,r){if(1&i&&(t.j41(0,"div",7),t.nrm(1,"img",10),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("src","./assets/images/"+(e.fh?"fh/":"")+"element/"+e.element+".svg",t.B4B)}}function mB(i,r){if(1&i&&(t.j41(0,"div",11)(1,"div",13)(2,"div",14)(3,"div",15)(4,"div",16),t.nrm(5,"img",10),t.k0s()()()(),t.j41(6,"span",17),t.nrm(7,"span",15),t.k0s(),t.j41(8,"span",18),t.nrm(9,"span",15),t.k0s(),t.j41(10,"span",19),t.nrm(11,"span",15),t.k0s()()),2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(5),t.Y8G("src",a.gameManager.monsterManager.monsterThumbnail(a.monster[e]),t.B4B),t.R7$(),t.Y8G("ngClass",t.l_i(4,Ja,"normal"==a.standees[e].type||"normal"==a.standees[e].player2,"elite"==a.standees[e].type||"elite"==a.standees[e].player2)),t.R7$(2),t.Y8G("ngClass",t.l_i(7,Ja,"normal"==a.standees[e].type||"normal"==a.standees[e].player3,"elite"==a.standees[e].type||"elite"==a.standees[e].player3)),t.R7$(2),t.Y8G("ngClass",t.l_i(10,Ja,"normal"==a.standees[e].type||"normal"==a.standees[e].player4,"elite"==a.standees[e].type||"elite"==a.standees[e].player4))}}function pB(i,r){if(1&i&&(t.j41(0,"div",22)(1,"span",23),t.EFF(2,":"),t.k0s(),t.nrm(3,"span",24),t.k0s()),2&i){const e=t.XpG(2).$implicit,a=t.XpG();t.R7$(3),t.Y8G("ghs-label","scenario.random.treasure."+a.overlays[e].value)("ghs-label-args",a.overlays[e].values||t.lJ4(2,Dr))}}function uB(i,r){if(1&i&&t.nrm(0,"img",10),2&i){const e=r.$implicit,a=t.XpG(4);t.Y8G("src","./assets/images/"+(a.fh?"fh/":"")+"condition/"+e+".svg",t.B4B)}}function fB(i,r){if(1&i&&(t.j41(0,"div",22)(1,"span",23),t.EFF(2,":"),t.k0s(),t.j41(3,"span",25),t.Z7z(4,uB,1,1,"img",10,t.fX1),t.k0s()()),2&i){const e=t.XpG(2).$implicit,a=t.XpG();t.R7$(4),t.Dyx(a.overlays[e].values)}}function CB(i,r){if(1&i&&(t.j41(0,"div",12)(1,"div",20)(2,"div",21)(3,"div",16),t.nrm(4,"img",10),t.k0s()()(),t.nVh(5,pB,4,3,"div",22),t.nVh(6,fB,6,0,"div",22),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(),t.Y8G("ngClass",t.l4e(4,hB,"obstacle"==a.overlays[e].type,"difficultTerrain"==a.overlays[e].type,"hazardousTerrain"==a.overlays[e].type,"trap"==a.overlays[e].type,"treasure"==a.overlays[e].type,"loot"==a.overlays[e].type)),t.R7$(3),t.Y8G("src","./assets/images/scenario/random/overlays/"+(a.fh?"fh/":"")+("loot"==a.overlays[e].type||"treasure"==a.overlays[e].type?a.overlays[e].type:a.overlays[e].value)+".png",t.B4B),t.R7$(),t.vxM("treasure"==a.overlays[e].type&&a.overlays[e].value?5:-1),t.R7$(),t.vxM("treasure"!=a.overlays[e].type&&a.overlays[e].values?6:-1)}}function MB(i,r){if(1&i&&(t.j41(0,"div",9)(1,"label"),t.EFF(2),t.k0s(),t.nVh(3,mB,12,13,"div",11),t.nVh(4,CB,7,11,"div",12),t.k0s()),2&i){const e=r.$implicit,a=t.XpG();t.R7$(2),t.JRh(e+1),t.R7$(),t.vxM(a.monster[e]?3:-1),t.R7$(),t.vxM(a.overlays[e]?4:-1)}}let Ir=(()=>{class i{section;flipped=!1;standees=[];monster=[];overlays=[];fh=!1;element;gameManager=s.E;ngOnInit(){this.update()}update(){this.fh="fh"==this.section.edition||-1!=s.E.editionExtensions(this.section.edition).indexOf("fh"),this.element=this.section.rules&&this.section.rules.find(e=>e.elements&&e.elements.length)?.elements[0].type||void 0,this.standees=[],this.section.rooms.length&&this.section.rooms[0]&&this.section.rooms[0].monster&&this.section.rooms[0].monster.forEach(e=>{if(!isNaN(+e.marker)){this.standees[+e.marker-1]=e;const a=s.E.monstersData().find(n=>n.name==e.name&&(n.edition==this.section.edition||-1!=s.E.editionExtensions(this.section.edition).indexOf(n.edition)));a&&(this.monster[+e.marker-1]=a)}}),this.overlays=[],this.section.overlays&&this.section.overlays.forEach(e=>{isNaN(+e.marker)||(this.overlays[+e.marker-1]=e)})}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-random-monster-card"]],inputs:{section:"section",flipped:"flipped"},standalone:!1,decls:13,vars:13,consts:[["container",""],[1,"random-monster-card-container"],[1,"card","vertical","random-monster-card",3,"ngClass"],[1,"card-back","random-monster-card-back"],[1,"card-front","random-monster-card-front"],[1,"name",3,"ghs-label"],[1,"index"],[1,"element"],[1,"slots"],[1,"slot-container"],[3,"src"],[1,"slot","monster"],[1,"slot","overlay"],[1,"image"],[1,"outer-border"],[1,"inner-border"],[1,"image-container"],[1,"type","player2",3,"ngClass"],[1,"type","player3",3,"ngClass"],[1,"type","player4",3,"ngClass"],[1,"image",3,"ngClass"],[1,"border"],[1,"value"],[1,"separator"],[1,"values",3,"ghs-label","ghs-label-args"],[1,"values"]],template:function(a,n){if(1&a&&(t.j41(0,"div",1,0)(2,"div",2),t.nrm(3,"div",3),t.j41(4,"div",4),t.nrm(5,"div",5),t.j41(6,"div",6),t.EFF(7),t.k0s(),t.nVh(8,_B,2,1,"div",7),t.j41(9,"div",8),t.Z7z(10,MB,5,3,"div",9,t.fX1),t.nI1(12,"ghsRange"),t.k0s()()()()),2&a){const o=t.sdS(1);t.R7$(2),t.xc7("font-size",.05*o.offsetWidth+"px"),t.Y8G("ngClass",t.l_i(9,dB,n.flipped,n.fh)),t.R7$(3),t.Y8G("ghs-label","data.section.title."+n.section.name),t.R7$(2),t.JRh(n.section.index),t.R7$(),t.vxM(n.element?8:-1),t.R7$(2),t.Dyx(t.i5U(12,6,t.lJ4(12,Dr),12))}},dependencies:[N.YU,tt,Tt],styles:['.random-monster-card-container[_ngcontent-%COMP%]{position:relative;width:100%;padding-bottom:150%}.random-monster-card[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-back[_ngcontent-%COMP%], .random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]{min-height:16em;display:flex;flex-direction:column;justify-content:center;text-align:center;border-radius:3.5%}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]{position:relative;z-index:1}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]:before{content:" ";position:absolute;width:100%;height:100%;background-image:url(random-monster-card-front.c61145f8bd93b116.png);background-position:center;background-size:100% auto;background-repeat:no-repeat;z-index:0}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;top:6%;left:15%;width:70%;display:flex;justify-content:center;color:var(--ghs-color-brown);font-size:1.3em;font-family:var(--ghs-font-gh-title)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%]{position:absolute;top:4%;left:7%;width:2.6em;height:2.6em;display:flex;justify-content:center;align-items:center;border:.1em solid var(--ghs-color-brown);border-radius:100%;background-image:url(random-monster-card-front.c61145f8bd93b116.png);background-position:center}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:82%;height:auto}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{position:absolute;bottom:5.5%;left:15%;width:70%;display:flex;justify-content:center;color:var(--ghs-color-brown);font-size:.75em;font-family:var(--ghs-font-gh-normal);font-weight:700}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;position:absolute;top:13%;left:10%;width:80%;height:80%}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]{position:relative}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{position:absolute;top:0;left:0;display:flex;justify-content:center;align-items:center;border:.1em solid var(--ghs-color-brown);border-radius:100%;color:var(--ghs-color-brown);font-size:1em;width:1.3em;height:1.3em;font-family:var(--ghs-font-gh-title)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]{position:absolute;top:0;left:15%;width:85%;height:100%}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{position:relative}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:4em;height:3.68em;background-color:var(--ghs-color-white);clip-path:polygon(0 50%,25% 0%,75% 0%,100% 50%,75% 100%,25% 100%)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:3.7em;height:3.404em;background-color:var(--ghs-color-red);clip-path:polygon(0 50%,25% 0%,75% 0%,100% 50%,75% 100%,25% 100%)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:3.2em;height:2.944em;background-color:var(--ghs-color-darkgray);clip-path:polygon(0 50%,25% 0%,75% 0%,100% 50%,75% 100%,25% 100%);overflow:hidden}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:3.2em;height:auto}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{position:absolute;bottom:.2em;left:1.24em;width:1.5em;height:.5em;clip-path:polygon(0 100%,0% 30%,50% 0%,100% 30%,100% 100%);background-color:var(--ghs-color-white)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]{position:absolute;bottom:10%;left:5%;width:90%;height:75%;clip-path:polygon(0 100%,0% 30%,50% 0%,100% 30%,100% 100%);background-color:var(--ghs-color-black)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type.normal[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]{background-color:var(--ghs-color-white)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type.elite[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]{background-color:var(--ghs-color-yellow)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type.player2[_ngcontent-%COMP%]{transform:rotate(118deg);left:0;bottom:initial;top:1em}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type.player3[_ngcontent-%COMP%]{transform:rotate(-118deg);left:2.5em;bottom:initial;top:1em}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;margin-left:.3em}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{position:relative}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:3.2042925em;height:3.7em;background-color:var(--ghs-color-darkgray);clip-path:polygon(50% 0,100% 25%,100% 75%,50% 100%,0 75%,0 25%)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:2.77128em;height:3.2em;clip-path:polygon(50% 0,100% 25%,100% 75%,50% 100%,0 75%,0 25%);overflow:hidden}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:4em;height:auto}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image.obstacle[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{background-color:var(--ghs-color-green)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image.difficult-terrain[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{background-color:var(--ghs-color-purple)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image.hazardous-terrain[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{background-color:var(--ghs-color-orange)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image.trap[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{background-color:var(--ghs-color-red)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image.treasure[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{background-color:var(--ghs-color-yellow)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image.loot[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{clip-path:none;background-color:var(--ghs-color-white);border-radius:100%;width:2.7em;height:2.7em}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image.loot[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{clip-path:none;background-color:var(--ghs-color-yellow);border-radius:100%;width:2.3em;height:2.3em}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:flex;align-items:center;height:100%}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{font-size:1.3em;font-family:var(--ghs-font-gh-title)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:.7em;font-family:var(--ghs-font-gh-title)}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:1.8em;height:auto;margin:.05em}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{position:relative}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]{clip-path:none;background-color:transparent}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]{width:3.2042925em;height:3.7em;background-color:var(--ghs-color-black);clip-path:polygon(50% 0,100% 25%,100% 75%,50% 100%,0 75%,0 25%)}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{width:2.944485em;height:3.4em;clip-path:polygon(50% 0,100% 25%,100% 75%,50% 100%,0 75%,0 25%)}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .outer-border[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:3.5em;height:auto}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{position:absolute;bottom:.6em;left:.5em;width:.8em;height:1.1em;clip-path:polygon(0% 0%,100% 44%,100% 100%,0% 56%);background-color:var(--ghs-color-black)}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]{position:absolute;bottom:7%;left:5%;width:90%;height:85%;clip-path:polygon(0% 0%,100% 44%,100% 100%,0% 56%);background-color:var(--ghs-color-darkgray);filter:brightness(1.4)}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type.normal[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]{background-color:var(--ghs-color-gray)}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type.elite[_ngcontent-%COMP%]   .inner-border[_ngcontent-%COMP%]{background-color:var(--ghs-color-yellow);filter:brightness(1)}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type.player2[_ngcontent-%COMP%]{top:initial;transform:none;bottom:1.8em;left:.5em}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.monster[_ngcontent-%COMP%]   .type.player3[_ngcontent-%COMP%]{top:initial;transform:none;bottom:1.2em;left:.5em}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:3em;width:auto}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image.treasure[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:3em;height:auto}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image.loot[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{border-radius:0;background-color:transparent}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image.loot[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{border-radius:0;background-color:transparent;overflow:visible}.random-monster-card.fh[_ngcontent-%COMP%]   .random-monster-card-front[_ngcontent-%COMP%]   .slots[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]   .slot.overlay[_ngcontent-%COMP%]   .image.loot[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:3.5em;height:auto}.random-monster-card[_ngcontent-%COMP%]   .random-monster-card-back[_ngcontent-%COMP%]{background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(random-monster-card-back.fefa4f425fbb0fa2.png);z-index:1}']})}return i})();const vB=(i,r)=>({closed:i,opened:r});let Ar=(()=>{class i{dialogRef;section;opened=!1;gameManager=s.E;constructor(e,a){this.dialogRef=a,this.section=e}ngOnInit(){this.opened=!0}close(){this.opened=!1,setTimeout(()=>{this.dialogRef.close()},m.f.settings.animations?1e3*m.f.settings.animationSpeed:0)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-random-monster-card-dialog"]],standalone:!1,decls:4,vars:6,consts:[["ghs-pointer-input","",1,"random-monster-card-dialog",3,"singleClick","ngClass"],[1,"random-monster-card-container"],[3,"section","flipped"],[1,"close-container",3,"click"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.bIt("singleClick",function(){return n.close()}),t.j41(1,"div",1),t.nrm(2,"ghs-random-monster-card",2),t.k0s()(),t.j41(3,"div",3),t.bIt("click",function(){return n.close()}),t.k0s()),2&a&&(t.Y8G("ngClass",t.l_i(3,vB,!n.opened,n.opened)),t.R7$(2),t.Y8G("section",n.section)("flipped",n.opened))},dependencies:[N.YU,rt,Ir],styles:["[_nghost-%COMP%]{background-color:transparent;padding:0;margin:0;border:0}.random-monster-card-dialog[_ngcontent-%COMP%]{position:relative;width:100vw;height:100vh;border-image:none;background:none;transition:transform calc(var(--ghs-animation-speed) * .15s) ease-in-out;transform:scale(0);z-index:2;overflow:auto;display:flex;justify-content:center;align-items:center;-ms-overflow-style:none;scrollbar-width:none}.random-monster-card-dialog[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.random-monster-card-dialog.opened[_ngcontent-%COMP%]{transform:scale(1)}.random-monster-card-dialog.closed[_ngcontent-%COMP%]{transform:scale(0);transition-delay:.8s}.random-monster-card-dialog[_ngcontent-%COMP%]   .random-monster-card-container[_ngcontent-%COMP%]{overflow:visible;width:100vw;max-width:500px;max-height:100vh}.random-monster-card-dialog[_ngcontent-%COMP%]   .random-monster-card-container[_ngcontent-%COMP%]   ghs-random-monster-card[_ngcontent-%COMP%]{display:block;margin:1vh 0;height:150vw;max-height:750px}.close-container[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1}"]})}return i})();const OB=(i,r,e,a,n,o)=>({new:i,full:r,half:e,inert:a,always:n,consumed:o});let Vr=(()=>{class i{sanitizer;type;element;ElementState=yt.e_;svg="";constructor(e){this.sanitizer=e}ngOnInit(){this.type&&!this.element&&(this.element=new yt.em(this.type),this.element.state=yt.e_.strong),fetch("./assets/images/element/"+this.element.type+".svg").then(e=>e.text()).then(e=>{this.svg=this.sanitizer.bypassSecurityTrustHtml(e)}).catch(e=>{console.error("Invalid src: ./assets/images/element/"+this.element.type+".svg")})}static \u0275fac=function(a){return new(a||i)(t.rXU(C.up))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-element-icon"]],inputs:{type:"type",element:"element"},standalone:!1,decls:1,vars:13,consts:[[1,"element-svg",3,"innerHTML","ghs-label","ghs-label-attribute","ngClass"]],template:function(a,n){1&a&&t.nrm(0,"span",0),2&a&&(t.HbH(n.element.type),t.Y8G("innerHTML",n.svg,t.npT)("ghs-label","game.element."+n.element.type)("ghs-label-attribute","title")("ngClass",t.l4e(6,OB,n.element.state==n.ElementState.new,n.element.state==n.ElementState.strong,n.element.state==n.ElementState.waning,n.element.state==n.ElementState.inert,n.element.state==n.ElementState.always,n.element.state==n.ElementState.consumed||n.element.state==n.ElementState.partlyConsumed)))},dependencies:[N.YU,tt],styles:[".element-svg{display:flex;justify-content:center;align-items:center;width:100%;height:100%}.element-svg svg{width:100%;height:100%}.element-svg #bg{transition:clip-path calc(var(--ghs-animation-speed) * 1s)}.element-svg.inert #bg{clip-path:inset(100% 0px 0px 0px)}.element-svg.full #bg,.element-svg.always #bg,.element-svg.new #bg{clip-path:inset(0% 0px 0px 0px)}.element-svg.new{opacity:.7}.element-svg.consumed #bg{opacity:.3!important}.element-svg.half #bg{clip-path:inset(50% 0px 0px 0px)}\n"],encapsulation:2})}return i})();const PB=(i,r,e,a)=>[i,r,e,a],Za=(i,r,e)=>[i,r,e],bB=i=>[i],kB=(i,r,e,a,n,o)=>[i,r,e,a,n,o],Fr=(i,r)=>[i,r],yB=(i,r)=>r.roomNumber,xB=(i,r)=>r.edition+"-"+r.index;function EB(i,r){if(1&i&&t.nrm(0,"p",1),2&i){const e=t.XpG();t.Y8G("ghs-label",e.rule.noteTop)}}function wB(i,r){1&i&&t.nrm(0,"span",10),2&i&&t.Y8G("ghs-label","and")}function RB(i,r){if(1&i){const e=t.RV6();t.j41(0,"input",13),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG().$implicit;return t.DH7(o.count,n)||(o.count=n),t.Njj(n)}),t.k0s()}if(2&i){const e=t.XpG().$implicit;t.R50("ngModel",e.count),t.Y8G("min",e.manualMin||0)("max",e.manualMax||"")}}function jB(i,r){if(1&i&&(t.nVh(0,wB,1,1,"span",10),t.nrm(1,"span",11),t.nVh(2,RB,1,3,"input",12)),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.vxM(a>0?0:-1),t.R7$(),t.Y8G("ghs-label","scenario.rules.spawn"+(e.marker?"Marker":""))("ghs-label-args",t.ziG(4,PB,e.monster.name,n.gameManager.scenarioRulesManager.spawnType(e.monster)||"",e.count?n.gameManager.scenarioRulesManager.spawnCount(n.rule,e)+" ":"",e.marker)),t.R7$(),t.vxM(e.manual?2:-1)}}function GB(i,r){if(1&i&&(t.j41(0,"div",2),t.Z7z(1,jB,3,9,null,null,t.fX1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.gameManager.scenarioRulesManager.spawns(e.rule))}}function TB(i,r){1&i&&t.nrm(0,"span",10),2&i&&t.Y8G("ghs-label","and")}function SB(i,r){if(1&i){const e=t.RV6();t.j41(0,"input",15),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG().$implicit;return t.DH7(o.count,n)||(o.count=n),t.Njj(n)}),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.R50("ngModel",e.count),t.Y8G("min",e.manualMin||0)("max",e.manualMax||"")("value",a.EntityValueFunction(e.count||1))}}function $B(i,r){if(1&i&&(t.nVh(0,TB,1,1,"span",10),t.nrm(1,"span",11),t.nVh(2,SB,1,4,"input",14)),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.vxM(a>0?0:-1),t.R7$(),t.Y8G("ghs-label","scenario.rules.spawnObjective"+(n.EntityValueFunction(e.count||1)>1?"s":"")+(e.objective.escort?"Escort":"")+(e.marker?"Marker":""))("ghs-label-args",t.sMw(4,Za,e.objective.name?"data.objective."+e.objective.name:"",n.EntityValueFunction(e.count||1)+" ",e.marker)),t.R7$(),t.vxM(e.manual?2:-1)}}function DB(i,r){if(1&i&&(t.j41(0,"div",3),t.Z7z(1,$B,3,8,null,null,t.fX1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.rule.objectiveSpawns)}}function IB(i,r){1&i&&(t.j41(0,"span",16),t.EFF(1,","),t.k0s())}function AB(i,r){if(1&i&&(t.nVh(0,IB,2,0,"span",16),t.j41(1,"span",17),t.nrm(2,"ghs-element-icon",18),t.j41(3,"span"),t.nrm(4,"span",19),t.k0s(),t.j41(5,"span"),t.nrm(6,"span",19),t.k0s()()),2&i){const e=r.$implicit;t.vxM(r.$index>0?0:-1),t.R7$(2),t.Y8G("element",e),t.R7$(2),t.Y8G("ghs-label","game.element."+e.type),t.R7$(2),t.Y8G("ghs-label","game.element.state."+e.state)}}function VB(i,r){if(1&i&&(t.j41(0,"div",4),t.Z7z(1,AB,7,4,null,null,t.fX1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.rule.elements)}}function FB(i,r){if(1&i&&(t.j41(0,"span",20),t.nrm(1,"img",21)(2,"span",22),t.k0s()),2&i){const e=r.$implicit;t.R7$(2),t.Y8G("ghs-label",e.marker?"scenario.rules.openRoomMarker":"scenario.rules.openRoom")("ghs-label-args",t.eq3(2,bB,e.marker||""))}}function XB(i,r){if(1&i&&(t.j41(0,"div",5),t.Z7z(1,FB,3,4,"span",20,yB),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.rooms())}}function BB(i,r){1&i&&(t.j41(0,"span",16),t.EFF(1,","),t.k0s())}function YB(i,r){if(1&i&&t.nrm(0,"span",22),2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.Y8G("ghs-label",(e.marker?"scenario.rules.addSectionMarker":"scenario.rules.addSection")+(e.hideIndex?"":"Index"))("ghs-label-args",t.sMw(2,Za,e.index,a.gameManager.scenarioManager.scenarioTitle(e,!0),e.marker||""))}}function NB(i,r){if(1&i&&t.nrm(0,"span",22),2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.Y8G("ghs-label","scenario.rules.finishWithConclusion")("ghs-label-args",t.sMw(2,Za,e.index,a.gameManager.scenarioManager.scenarioTitle(e,!0),e.marker||""))}}function zB(i,r){if(1&i&&(t.nVh(0,BB,2,0,"span",16),t.j41(1,"span",23),t.nrm(2,"img",24),t.nVh(3,YB,1,6,"span",22),t.nVh(4,NB,1,6,"span",22),t.k0s()),2&i){const e=r.$implicit;t.vxM(r.$index>0?0:-1),t.R7$(3),t.vxM(e.conclusion?-1:3),t.R7$(),t.vxM(e.conclusion?4:-1)}}function LB(i,r){if(1&i&&(t.j41(0,"div",6),t.Z7z(1,zB,5,3,null,null,xB),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.sections())}}function UB(i,r){1&i&&(t.j41(0,"span",26),t.nrm(1,"span",19),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","scenario.rules.figures.scenarioEffect"))}function qB(i,r){if(1&i&&(t.j41(0,"span",25),t.nrm(1,"span",22),t.nVh(2,UB,2,1,"span",26),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.rules.figures."+e.type)("ghs-label-args",t.l4e(3,kB,a.figureNames(e),e.value||"",a.settingsManager.settings.calculate&&("damage"==e.type&&e.value&&-1==e.value.indexOf("H")||("setHp"==e.type||"heal"==e.type)&&e.value&&-1==e.value.indexOf("H"))?a.EntityValueFunction(e.value||""):e.value||"","amAdd"==e.type||"amRemove"==e.type?e.value.split(":")[0]:"","amAdd"==e.type||"amRemove"==e.type||"transfer"==e.type&&e.value&&e.value.split(":").length>1?e.value.split(":")[1]:"","transferEntities"==e.type&&e.identifier&&e.identifier.number?e.identifier.number:"")),t.R7$(),t.vxM(e.scenarioEffect?2:-1)}}function HB(i,r){if(1&i&&(t.j41(0,"div",7),t.Z7z(1,qB,3,10,"span",25,t.fX1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.figureRules())}}function KB(i,r){if(1&i&&t.nrm(0,"p",22),2&i){const e=t.XpG(2);t.Y8G("ghs-label","scenario.rules.randomDungeon.dungeon"+(e.rule.randomDungeon.dungeonCards&&e.rule.randomDungeon.dungeonCards.length?".cards":""))("ghs-label-args",t.l_i(2,Fr,e.rule.randomDungeon.dungeonCount,e.randomDungeonsDungeonLabel().toString()))}}function WB(i,r){1&i&&t.nrm(0,"br")}function JB(i,r){if(1&i&&t.nrm(0,"p",22),2&i){const e=t.XpG(2);t.Y8G("ghs-label","scenario.rules.randomDungeon.monster"+(e.rule.randomDungeon.monsterCards&&e.rule.randomDungeon.monsterCards.length?".cards":""))("ghs-label-args",t.l_i(2,Fr,e.rule.randomDungeon.monsterCount,e.randomDungeonsMonsterLabel(e.rule).toString()))}}function ZB(i,r){if(1&i&&(t.j41(0,"div",8),t.nVh(1,KB,1,5,"p",22),t.nVh(2,WB,1,0,"br"),t.nVh(3,JB,1,5,"p",22),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.vxM(e.rule.randomDungeon.dungeonCount?1:-1),t.R7$(),t.vxM(e.rule.randomDungeon.dungeonCount&&e.rule.randomDungeon.monsterCount?2:-1),t.R7$(),t.vxM(e.rule.randomDungeon.monsterCount?3:-1)}}function QB(i,r){1&i&&t.nrm(0,"div",27),2&i&&t.Y8G("ghs-label",r.$implicit.note)}function tY(i,r){if(1&i&&(t.j41(0,"div",9),t.Z7z(1,QB,1,1,"div",27,t.fX1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.rule.statEffects)}}function eY(i,r){if(1&i&&t.nrm(0,"p",1),2&i){const e=t.XpG();t.Y8G("ghs-label","scenario.rules.finish."+e.rule.finish)}}function nY(i,r){if(1&i&&t.nrm(0,"p",1),2&i){const e=t.XpG();t.Y8G("ghs-label",e.rule.note)}}function iY(i,r){if(1&i&&t.nrm(0,"p",1),2&i){const e=t.XpG();t.Y8G("ghs-label","scenario.rules.alwaysApplyTurn."+e.rule.alwaysApplyTurn)}}let Xr=(()=>{class i{rule;identifier;gameManager=s.E;settingsManager=m.f;EntityValueFunction=$.hZ;ngOnInit(){this.rule.figures&&this.rule.figures.forEach(e=>{e.value&&(e.value=""+e.value)})}randomDungeonsMonsterLabel(e){return e.randomDungeon&&e.randomDungeon.monsterCards&&e.randomDungeon.monsterCards.length?e.randomDungeon.monsterCards.filter(a=>!s.E.game.scenario||!s.E.game.scenario.additionalSections||-1==s.E.game.scenario.additionalSections.indexOf(a)).map(a=>{if(s.E.game.scenario){const n=s.E.sectionData(s.E.game.scenario.edition,!0).find(o=>o.index==a&&"randomMonsterCard"==o.group);if(n)return"&nbsp%"+s.E.scenarioManager.scenarioTitle(n,!0)+"% (#"+n.index+")"}return"&nbsp"+a}):[]}randomDungeonsDungeonLabel(){return this.rule.randomDungeon&&this.rule.randomDungeon.dungeonCards&&this.rule.randomDungeon.dungeonCards.length?this.rule.randomDungeon.dungeonCards.filter(e=>!s.E.game.scenario||!s.E.game.scenario.additionalSections||-1==s.E.game.scenario.additionalSections.indexOf(e)).map(e=>{if(s.E.game.scenario){const a=s.E.sectionData(s.E.game.scenario.edition,!0).find(n=>n.index==e&&"randomDungeonCard"==n.group);if(a)return"&nbsp%"+s.E.scenarioManager.scenarioTitle(a,!0)+"% (#"+a.index+")"}return"&nbsp"+e}):[]}prevent(e){e.preventDefault(),e.stopPropagation()}sections(){const e=s.E.scenarioRulesManager.getScenarioForRule(this.identifier).scenario;return e&&this.rule.sections?s.E.sectionData(e.edition).filter(a=>!s.E.game.sections.find(n=>n.edition==a.edition&&n.group==e.group&&n.index==a.index)&&a.group==e.group&&-1!=this.rule.sections.indexOf(a.index)):[]}rooms(){let e=[];if(this.rule.rooms){const a=s.E.scenarioRulesManager.getScenarioForRule(this.identifier).scenario;this.rule.rooms.forEach(n=>{if(a){const o=a.rooms.find(g=>g.roomNumber==n);o&&s.E.game.scenario&&-1==s.E.game.scenario.revealedRooms.indexOf(n)&&e.push(o)}})}return e}figureRules(){return this.rule.figures&&this.rule.figures.filter(e=>{if(-1!=Pi.uh.indexOf(e.type))return!1;const a=s.E.scenarioRulesManager.figuresByFigureRule(e,this.rule);return 0!=a.length&&("gainCondition"==e.type||"permanentCondition"==e.type||"loseCondition"==e.type?a.some(n=>{if("gainCondition"==e.type){let o=s.E.entityManager.entities(n),g=new j.kW(e.value);if(o.every(_=>s.E.entityManager.hasCondition(_,g)))return!1}else if("permanentCondition"==e.type){let o=s.E.entityManager.entities(n),g=new j.kW(e.value);if(o.every(_=>s.E.entityManager.hasCondition(_,g,!0)))return!1}else if("loseCondition"==e.type){let o=s.E.entityManager.entities(n),g=new j.kW(e.value);if(o.every(_=>!s.E.entityManager.hasCondition(_,g)))return!1}return!0}):"toggleOn"!=e.type&&"toggleOff"!=e.type||a.some(n=>n.off==("toggleOn"==e.type)))})||[]}figureNames(e){let a="";return e.identifier&&(a="all"==e.identifier.type?m.f.getLabel("scenario.rules.figures.all"):s.E.scenarioRulesManager.figuresByFigureRule(e,this.rule).filter(n=>{if("gainCondition"==e.type){let o=s.E.entityManager.entities(n),g=new j.kW(e.value);if(o.every(_=>s.E.entityManager.hasCondition(_,g)))return!1}else if("permanentCondition"==e.type){let o=s.E.entityManager.entities(n),g=new j.kW(e.value);if(o.every(_=>s.E.entityManager.hasCondition(_,g,!0)))return!1}else if("loseCondition"==e.type){let o=s.E.entityManager.entities(n),g=new j.kW(e.value);if(o.every(_=>!s.E.entityManager.hasCondition(_,g)))return!1}else if("toggleOn"==e.type||"toggleOff"==e.type)return n.off==("toggleOn"==e.type);return!0}).map(n=>{if(n instanceof q.K)return m.f.getLabel("%game.characterIconColored."+n.name+"%")+s.E.characterManager.characterName(n);if(n instanceof mt.$e)return(n.title||m.f.getLabel("data.objective."+n.name))+(n.marker?" %game.mapMarker."+n.marker+"%":"")+(e.identifier&&e.identifier.marker?" %game.mapMarker."+e.identifier.marker+"%":"");if(n instanceof P.R){const o=n.statEffect&&n.statEffect.name?n.statEffect.name:n.name;return"removeEntity"==e.type?m.f.getLabel("data.monster."+o)+" ["+s.E.scenarioRulesManager.entitiesByFigureRule(e,this.rule).filter(g=>g instanceof Rt.I&&-1!=n.entities.indexOf(g)).map(g=>""+g.number).join(", ")+"]":m.f.getLabel("data.monster."+o)}return n.name}).join(", ")),a}figureNamesByIdenfifier(e){return s.E.figuresByIdentifier(e).map(a=>a instanceof q.K?m.f.getLabel("%game.characterIconColored."+a.name+"%")+s.E.characterManager.characterName(a):a instanceof mt.$e?(a.title||m.f.getLabel("data.objective."+a.name))+(a.marker?" %game.mapMarker."+a.marker+"%":"")+(e.marker?" %game.mapMarker."+e.marker+"%":""):a instanceof P.R?m.f.getLabel("data.monster."+(a.statEffect&&a.statEffect.name?a.statEffect.name:a.name)):a.name).join(", ")}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-scenario-rule"]],inputs:{rule:"rule",identifier:"identifier"},standalone:!1,decls:13,vars:12,consts:[[1,"rule"],[1,"text-white",3,"ghs-label"],[1,"spawns"],[1,"objective-spawns"],[1,"elements"],[1,"sections","rooms"],[1,"sections"],[1,"figures"],[1,"random-dungeon"],[1,"stat-effects"],[1,"and",3,"ghs-label"],[1,"text-white","text",3,"ghs-label","ghs-label-args"],["type","number",3,"ngModel","min","max"],["type","number",3,"ngModelChange","ngModel","min","max"],["type","number",3,"ngModel","min","max","value"],["type","number",3,"ngModelChange","ngModel","min","max","value"],[1,"and"],[1,"element"],[3,"element"],[3,"ghs-label"],[1,"section","room"],["src","./assets/images/scenario/door.svg",1,"ghs-svg"],[1,"text-white",3,"ghs-label","ghs-label-args"],[1,"section"],["src","./assets/images/lock.svg",1,"ghs-svg"],[1,"figure"],[1,"text-white"],[1,"text","text-white",3,"ghs-label"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nVh(1,EB,1,1,"p",1),t.nVh(2,GB,3,0,"div",2),t.nVh(3,DB,3,0,"div",3),t.nVh(4,VB,3,0,"div",4),t.nVh(5,XB,3,0,"div",5),t.nVh(6,LB,3,0,"div",6),t.nVh(7,HB,3,0,"div",7),t.nVh(8,ZB,4,3,"div",8),t.nVh(9,tY,3,0,"div",9),t.nVh(10,eY,1,1,"p",1),t.nVh(11,nY,1,1,"p",1),t.nVh(12,iY,1,1,"p",1),t.k0s()),2&a&&(t.R7$(),t.vxM(n.rule.noteTop?1:-1),t.R7$(),t.vxM(n.gameManager.scenarioRulesManager.spawns(n.rule).length>0?2:-1),t.R7$(),t.vxM(n.rule.objectiveSpawns&&n.rule.objectiveSpawns.length>0?3:-1),t.R7$(),t.vxM(n.rule.elements&&n.rule.elements.length>0?4:-1),t.R7$(),t.vxM(n.rooms().length>0?5:-1),t.R7$(),t.vxM(n.sections().length>0?6:-1),t.R7$(),t.vxM(n.figureRules().length>0?7:-1),t.R7$(),t.vxM(n.rule.randomDungeon?8:-1),t.R7$(),t.vxM(n.rule.statEffects&&n.rule.statEffects.length?9:-1),t.R7$(),t.vxM(n.rule.finish?10:-1),t.R7$(),t.vxM(n.rule.note?11:-1),t.R7$(),t.vxM(n.rule.alwaysApplyTurn?12:-1))},dependencies:[O.me,O.Q0,O.BC,O.VZ,O.zX,O.vS,Vr,tt],styles:[".rule[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor))}.rule[_ngcontent-%COMP%]   .and[_ngcontent-%COMP%]{margin:0 .2em}.rule[_ngcontent-%COMP%]   .spawns[_ngcontent-%COMP%], .rule[_ngcontent-%COMP%]   .objective-spawns[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;padding:.5em}.rule[_ngcontent-%COMP%]   .spawns[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .rule[_ngcontent-%COMP%]   .objective-spawns[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:nowrap}.rule[_ngcontent-%COMP%]   .spawns[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .rule[_ngcontent-%COMP%]   .objective-spawns[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));font-family:var(--ghs-font-text);width:2em;background-color:transparent;z-index:1;margin:0 .2em}.rule[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.rule[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%] > .element[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.rule[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%] > .element[_ngcontent-%COMP%]   ghs-element-icon[_ngcontent-%COMP%]{width:2em;height:2em;margin-right:.15em}.rule[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%] > .element[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:0 .2em}.rule[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.rule[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]{display:inline-flex}.rule[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.rule[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap}.rule[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{padding:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.rule[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:not(:first-child){border-left:calc(var(--ghs-unit) * .1 * var(--ghs-barsize)) solid var(--ghs-color-white)}.rule[_ngcontent-%COMP%]   .figures[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column}.rule[_ngcontent-%COMP%]   .figures[_ngcontent-%COMP%]   .figure[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:0 .1em}.rule[_ngcontent-%COMP%]   .stat-effects[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor)) 0}.rule[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor))}"]})}return i})();function aY(i,r){1&i&&t.nrm(0,"h2",1),2&i&&t.Y8G("ghs-label","scenario.rules.show.applied")}function oY(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-scenario-rule",6),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.discardScenarioRule(n))}),t.k0s()}if(2&i){const e=r.$implicit;t.Y8G("rule",e.rule)("identifier",e.identifier)}}function sY(i,r){if(1&i&&t.nrm(0,"ghs-scenario-rule",3),2&i){const e=r.$implicit;t.Y8G("rule",e.rule)("identifier",e.identifier)}}function rY(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",7),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.clearDiscardedScenarioRules())}),t.k0s()}2&i&&t.Y8G("ghs-label","scenario.rules.clearDiscarded")}let cY=(()=>{class i{dialogRef;gameManager=s.E;appliedScenarioRules=[];discardedScenarioRules=[];constructor(e){this.dialogRef=e}ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.update()}}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.appliedScenarioRules=[],s.E.game.appliedScenarioRules.forEach(e=>{const a=s.E.scenarioRulesManager.getScenarioForRule(e).scenario;a&&a.rules&&a.rules.length>e.index&&e.index>=0&&(a.rules[e.index].spawns&&a.rules[e.index].spawns.forEach(n=>{n.manual&&!n.count&&(n.count="1")}),this.appliedScenarioRules.push({identifier:e,rule:a.rules[e.index]}))}),this.discardedScenarioRules=[],s.E.game.discardedScenarioRules.forEach(e=>{const a=s.E.scenarioRulesManager.getScenarioForRule(e).scenario;a&&a.rules&&a.rules.length>e.index&&e.index>=0&&(a.rules[e.index].spawns&&a.rules[e.index].spawns.forEach(n=>{n.manual&&!n.count&&(n.count="1")}),this.discardedScenarioRules.push({identifier:e,rule:a.rules[e.index]}))}),!this.appliedScenarioRules.length&&!this.discardedScenarioRules.length&&(0,V.co)(this.dialogRef)}clearDiscardedScenarioRules(){s.E.stateManager.before("clearDiscardedScenarioRules"),s.E.game.discardedScenarioRules=[],s.E.stateManager.after()}discardScenarioRule(e){s.E.stateManager.before("removeScenarioRule"),s.E.game.appliedScenarioRules.splice(s.E.game.appliedScenarioRules.indexOf(e.identifier),1),(e.rule.once||e.rule.alwaysApplyTurn)&&s.E.game.discardedScenarioRules.push(e.identifier),s.E.stateManager.after()}static \u0275fac=function(a){return new(a||i)(t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-scenario-rules-dialog"]],standalone:!1,decls:11,vars:3,consts:[[1,"scenario-rules-dialog"],[3,"ghs-label"],[1,"applied"],[3,"rule","identifier"],[1,"discarded"],[1,"menu"],[3,"click","rule","identifier"],[3,"click","ghs-label"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nVh(1,aY,1,1,"h2",1),t.j41(2,"div",2),t.Z7z(3,oY,1,2,"ghs-scenario-rule",3,t.fX1),t.k0s(),t.nrm(5,"h2",1),t.j41(6,"div",4),t.Z7z(7,sY,1,2,"ghs-scenario-rule",3,t.fX1),t.k0s(),t.j41(9,"div",5),t.nVh(10,rY,1,1,"a",1),t.k0s()()),2&a&&(t.R7$(),t.vxM(n.appliedScenarioRules.length?1:-1),t.R7$(2),t.Dyx(n.appliedScenarioRules),t.R7$(2),t.Y8G("ghs-label","scenario.rules.show.discarded"),t.R7$(2),t.Dyx(n.discardedScenarioRules),t.R7$(3),t.vxM(n.discardedScenarioRules.length?10:-1))},dependencies:[tt,Xr],styles:["h2[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));color:var(--ghs-color-darkgray);margin:0;padding:0}.applied[_ngcontent-%COMP%]   ghs-scenario-rule[_ngcontent-%COMP%]{cursor:zoom-out}.applied[_ngcontent-%COMP%]   ghs-scenario-rule[_ngcontent-%COMP%]:hover{opacity:.6}.menu[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}"]})}return i})();const lY=(i,r)=>[i,r],gY=i=>[i];function dY(i,r){if(1&i&&t.nrm(0,"p",1),2&i){const e=t.XpG();t.Y8G("ghs-label",(e.sectionData.marker?"scenario.section.addMarker":"scenario.section.add")+(e.sectionData.hideIndex?"":"Index"))("ghs-label-args",t.l_i(2,lY,e.sectionData.index,e.sectionData.marker||""))}}function hY(i,r){if(1&i&&t.nrm(0,"p",1),2&i){const e=t.XpG();t.Y8G("ghs-label","scenario.section.conclusion")("ghs-label-args",t.eq3(2,gY,e.sectionData.name?e.gameManager.scenarioManager.scenarioTitle(e.sectionData,!0):"%scenario.section% #"+e.sectionData.index))}}let Br=(()=>{class i{sectionData;dialog;dialogRef;gameManager=s.E;constructor(e,a,n){this.sectionData=e,this.dialog=a,this.dialogRef=n}addSection(){this.sectionData.conclusion?(this.dialog.open(Yt,{panelClass:["dialog"],data:{scenario:s.E.game.scenario,success:!0,conclusion:this.sectionData}}),this.close(!0)):(s.E.stateManager.before("addSection",this.sectionData.index,s.E.scenarioManager.scenarioTitle(this.sectionData,!0),"data.edition."+this.sectionData.edition),s.E.scenarioManager.addSection(this.sectionData),s.E.stateManager.after(),this.close(!0))}close(e){(0,V.co)(this.dialogRef,e)}confirm(e){m.f.settings.keyboardShortcuts&&"Enter"===e.key&&(this.addSection(),e.preventDefault(),e.stopPropagation())}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.lG),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-section-dialog"]],hostBindings:function(a,n){1&a&&t.bIt("keydown",function(g){return n.confirm(g)},t.EBC)},standalone:!1,decls:9,vars:4,consts:[[1,"section-popup"],[3,"ghs-label","ghs-label-args"],[1,"buttons"],[1,"cancel",3,"click"],[3,"ghs-label"],[1,"spacer"],[1,"add",3,"click"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nVh(1,dY,1,5,"p",1),t.nVh(2,hY,1,4,"p",1),t.j41(3,"div",2)(4,"a",3),t.bIt("click",function(){return n.close(!1)}),t.nrm(5,"span",4),t.k0s(),t.nrm(6,"span",5),t.j41(7,"a",6),t.bIt("click",function(){return n.addSection()}),t.nrm(8,"span",4),t.k0s()()()),2&a&&(t.R7$(),t.vxM(n.sectionData.conclusion?-1:1),t.R7$(),t.vxM(n.sectionData.conclusion?2:-1),t.R7$(3),t.Y8G("ghs-label","scenario.section.cancel"),t.R7$(3),t.Y8G("ghs-label","scenario.section.confirm"))},dependencies:[tt],styles:[".section-popup[_ngcontent-%COMP%]{text-align:center;color:var(--ghs-color-white);min-width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor));padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.section-popup[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.section-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly}.section-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}.section-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.section-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.section-popup[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{color:var(--ghs-color-green)}"]})}return i})();const _Y=["setupComponent"],mY=i=>({denied:i}),pY=i=>[i],uY=i=>({"random-monster-card":i}),fY=(i,r)=>[i,r],Yr=(i,r)=>r.roomNumber,Nr=(i,r)=>r.edition+"-"+r.index;function CY(i,r){if(1&i&&(t.j41(0,"span",4),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.SpI("#",e.scenario.index)}}function MY(i,r){if(1&i&&(t.j41(0,"span",7),t.nrm(1,"span",27),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","scenario.level")("ghs-label-args",t.eq3(3,pY,e.scenario.level+""))("ngClass","level-"+e.scenario.level)}}function vY(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",28),t.bIt("click",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.openTreasures(n))}),t.nrm(1,"img",29),t.k0s()}}function OY(i,r){if(1&i&&t.nrm(0,"ghs-scenario-setup",9,0),2&i){const e=t.XpG();t.Y8G("scenario",e.scenario)}}function PY(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",30),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openFavors())}),t.nrm(1,"span",6),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","scenario.favors"))}function bY(i,r){if(1&i&&t.nrm(0,"span",32),2&i){const e=t.XpG().$implicit;t.Y8G("ghs-label","%game.mapMarker."+e.marker+"%")}}function kY(i,r){if(1&i&&(t.j41(0,"span",12),t.nrm(1,"img",31),t.EFF(2),t.nVh(3,bY,1,1,"span",32),t.k0s()),2&i){const e=r.$implicit;t.R7$(2),t.SpI(" ",e.ref," "),t.R7$(),t.vxM(e.marker?3:-1)}}function yY(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1," \xa0"),t.nrm(2,"span",6),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(2),t.Y8G("ghs-label",a.gameManager.scenarioManager.scenarioTitle(e,!0))}}function xY(i,r){if(1&i&&t.nrm(0,"span",32),2&i){const e=t.XpG().$implicit;t.Y8G("ghs-label","%game.mapMarker."+e.marker+"%")}}function EY(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",33),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.openRandomMonsterCard(n))}),t.EFF(1),t.nVh(2,yY,3,1,"span"),t.nVh(3,xY,1,1,"span",32),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(4,uY,"randomMonsterCard"==e.group)),t.R7$(),t.SpI(" #",e.index," "),t.R7$(),t.vxM(a.scenario&&e.name==a.scenario.name?-1:2),t.R7$(),t.vxM(e.marker?3:-1)}}function wY(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",34),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.openRoom(n))}),t.nrm(1,"img",35)(2,"span",36),t.k0s()}if(2&i){const e=r.$implicit;t.R7$(2),t.Y8G("ghs-label",e.marker?"scenario.openRoomMarkerRef":"scenario.openRoomRef")("ghs-label-args",t.l_i(2,fY,e.ref,e.marker||""))}}function RY(i,r){1&i&&t.nrm(0,"img",38)}function jY(i,r){1&i&&t.nrm(0,"img",39)}function GY(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.SpI("#",e.index)}}function TY(i,r){if(1&i&&t.nrm(0,"span",32),2&i){const e=t.XpG().$implicit;t.Y8G("ghs-label","%game.mapMarker."+e.marker+"%")}}function SY(i,r){if(1&i&&(t.j41(0,"span",5),t.EFF(1," \xa0"),t.nrm(2,"span",6),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(2),t.Y8G("ghs-label",a.gameManager.scenarioManager.scenarioTitle(e,!0))}}function $Y(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",37),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.addSection(n))}),t.nVh(1,RY,1,0,"img",38),t.nVh(2,jY,1,0,"img",39),t.nVh(3,GY,2,1,"span"),t.nVh(4,TY,1,1,"span",32),t.nVh(5,SY,3,1,"span",5),t.k0s()}if(2&i){const e=r.$implicit;t.R7$(),t.vxM(e.conclusion?-1:1),t.R7$(),t.vxM(e.conclusion?2:-1),t.R7$(),t.vxM(e.conclusion&&e.name?-1:3),t.R7$(),t.vxM(e.marker?4:-1),t.R7$(),t.vxM(e.conclusion&&e.name?5:-1)}}function DY(i,r){if(1&i){const e=t.RV6();t.j41(0,"label",17)(1,"input",40),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.setup,n)||(o.setup=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.setupComponent&&n.setupComponent.updateMonster())}),t.k0s(),t.nrm(2,"span",6),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.R50("ngModel",e.setup),t.R7$(),t.Y8G("ghs-label","scenario.setup")}}function IY(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",30),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openFavors())}),t.nrm(1,"span",6),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","scenario.favors"))}function AY(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",41),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.showScenarioRules())}),t.nrm(1,"span",6),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","scenario.rules.show"))}function VY(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",26)(1,"a",25),t.bIt("click",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.openEventEffects(n))}),t.nrm(2,"img",42)(3,"span",6),t.k0s()()}2&i&&(t.R7$(3),t.Y8G("ghs-label","scenario.eventEffects"))}let FY=(()=>{class i{scenario;dialogRef;dialog;gameManager=s.E;settingsManager=m.f;setupComponent;setup=!1;openRooms=[];closedRooms=[];availableSections=[];constructor(e,a,n){this.scenario=e,this.dialogRef=a,this.dialog=n,this.openRooms=s.E.scenarioManager.openRooms(),this.closedRooms=s.E.scenarioManager.closedRooms(),this.availableSections=s.E.scenarioManager.availableSections()}finishScenario(e){this.close();const a=s.E.scenarioManager.availableSections(!0).filter(n=>n.edition==this.scenario.edition&&n.parent==this.scenario.index&&n.group==this.scenario.group&&n.conclusion&&0==s.E.scenarioManager.getRequirements(n).length);a.length<2||!e?this.dialog.open(Yt,{panelClass:["dialog"],data:{scenario:this.scenario,conclusion:1==a.length?a[0]:void 0,success:e}}):this.dialog.open(Se,{panelClass:["dialog"],data:{conclusions:a,parent:this.scenario}}).closed.subscribe({next:n=>{n&&this.dialog.open(Yt,{panelClass:["dialog"],data:{scenario:this.scenario,conclusion:n,success:e}})}})}resetScenario(){this.close(),s.E.stateManager.before("resetScenario",...s.E.scenarioManager.scenarioUndoArgs()),s.E.roundManager.resetScenario(),s.E.scenarioManager.setScenario(this.scenario),s.E.stateManager.after()}cancelScenario(){this.close(),s.E.stateManager.before("cancelScenario",...s.E.scenarioManager.scenarioUndoArgs()),s.E.scenarioManager.setScenario(void 0),s.E.stateManager.after(1e3)}showScenarioRules(){this.dialog.open(cY,{panelClass:["dialog"]}),this.close()}openTreasures(e){this.dialog.open(La,{panelClass:["dialog"]})}openEventEffects(e){this.dialog.open(ni,{panelClass:["dialog"]}),this.close()}openRoom(e){s.E.editionData.find(n=>n.edition==this.scenario.edition)?(s.E.stateManager.before(e.marker?"openRoomMarker":"openRoom",this.scenario.index,s.E.scenarioManager.scenarioTitle(this.scenario),e.ref,e.marker||""),s.E.scenarioManager.openRoom(e,this.scenario,!1),s.E.stateManager.after(),this.setupComponent&&this.setupComponent.updateMonster()):console.error("Could not find edition data!")}addSection(e){this.dialog.open(Br,{panelClass:["dialog"],data:e}).closed.subscribe({next:a=>{a&&this.close()}})}openFavors(){this.dialog.open(wr,{panelClass:["dialog"]})}openRandomMonsterCard(e){"randomMonsterCard"==e.group&&this.dialog.open(Ar,{panelClass:["fullscreen-panel"],disableClose:!0,data:e})}close(){(0,V.co)(this.dialogRef)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-scenario-dialog"]],viewQuery:function(a,n){if(1&a&&t.GBs(_Y,5),2&a){let o;t.mGM(o=t.lsd())&&(n.setupComponent=o.first)}},standalone:!1,decls:39,vars:18,consts:[["setupComponent",""],[1,"scenario-popup",3,"ngClass"],[1,"scroll-container"],[1,"title"],[1,"index"],[1,"name"],[3,"ghs-label"],[1,"scenario-level-container"],["tabclick","",1,"treasures"],[3,"scenario"],[1,"favors"],[1,"sections"],[1,"section","room"],[1,"section",3,"ngClass"],[1,"open-sections"],["tabclick","",1,"section","room","available"],["tabclick","",1,"section","available"],[1,"setup-checkbox"],[1,"additional"],[1,"menu"],[1,"buttons"],["tabclick","",1,"failure",3,"click"],[1,"spacer"],["tabclick","",1,"success",3,"click"],[1,"cancel"],["tabclick","",3,"click"],[1,"event-effects"],[1,"scenario-level",3,"ghs-label","ghs-label-args","ngClass"],["tabclick","",1,"treasures",3,"click"],["src","./assets/images/scenario/treasure.svg",1,"ghs-svg"],[1,"favors",3,"click"],["src","./assets/images/scenario/door-open.svg",1,"ghs-svg"],[1,"marker",3,"ghs-label"],[1,"section",3,"click","ngClass"],["tabclick","",1,"section","room","available",3,"click"],["src","./assets/images/scenario/door.svg",1,"ghs-svg"],[3,"ghs-label","ghs-label-args"],["tabclick","",1,"section","available",3,"click"],["src","./assets/images/lock.svg",1,"ghs-svg"],["src","./assets/images/scenario/conclusion.svg",1,"ghs-svg"],["type","checkbox",3,"ngModelChange","change","ngModel"],[3,"click"],["src","./assets/images/event.svg",1,"ghs-svg"]],template:function(a,n){1&a&&(t.j41(0,"div",1)(1,"div",2)(2,"div",3),t.nVh(3,CY,2,1,"span",4),t.j41(4,"span",5),t.nrm(5,"span",6),t.k0s(),t.nVh(6,MY,2,5,"span",7),t.nVh(7,vY,2,0,"span",8),t.k0s(),t.nVh(8,OY,2,1,"ghs-scenario-setup",9),t.nVh(9,PY,2,1,"a",10),t.j41(10,"div",11),t.Z7z(11,kY,4,2,"span",12,Yr),t.Z7z(13,EY,4,6,"span",13,Nr),t.k0s(),t.j41(15,"div",14),t.Z7z(16,wY,3,5,"span",15,Yr),t.Z7z(18,$Y,6,5,"span",16,Nr),t.k0s(),t.nVh(20,DY,3,2,"label",17),t.nVh(21,IY,2,1,"a",10),t.j41(22,"div",18),t.nVh(23,AY,2,1,"a"),t.k0s(),t.j41(24,"div",19)(25,"label"),t.nrm(26,"span",6),t.k0s(),t.j41(27,"div",20)(28,"a",21),t.bIt("click",function(){return n.finishScenario(!1)}),t.nrm(29,"span",6),t.k0s(),t.nrm(30,"span",22),t.j41(31,"a",23),t.bIt("click",function(){return n.finishScenario(!0)}),t.nrm(32,"span",6),t.k0s()(),t.j41(33,"div",24)(34,"a",25),t.bIt("click",function(){return n.cancelScenario()}),t.nrm(35,"span",6),t.k0s(),t.j41(36,"a",25),t.bIt("click",function(){return n.resetScenario()}),t.nrm(37,"span",6),t.k0s()()(),t.nVh(38,VY,4,1,"div",26),t.k0s()()),2&a&&(t.Y8G("ngClass",t.eq3(16,mY,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.scenario)),t.R7$(3),t.vxM(n.scenario.index&&!n.scenario.hideIndex?3:-1),t.R7$(2),t.Y8G("ghs-label",n.scenario.name?n.gameManager.scenarioManager.scenarioTitle(n.scenario):n.scenario.custom?"scenario.custom":"scenario"),t.R7$(),t.vxM(n.scenario.level?6:-1),t.R7$(),t.vxM(n.settingsManager.settings.scenarioRooms&&n.settingsManager.settings.treasures&&n.gameManager.scenarioManager.getTreasures(n.scenario,n.gameManager.game.sections).length>0?7:-1),t.R7$(),t.vxM(n.setup||n.gameManager.game.round<1?8:-1),t.R7$(),t.vxM(n.gameManager.game.round<1&&n.gameManager.trialsManager.favorsEnabled?9:-1),t.R7$(2),t.Dyx(n.openRooms),t.R7$(2),t.Dyx(n.gameManager.game.sections),t.R7$(3),t.Dyx(n.closedRooms),t.R7$(2),t.Dyx(n.availableSections),t.R7$(2),t.vxM(n.gameManager.game.round>0?20:-1),t.R7$(),t.vxM(n.gameManager.game.round>0&&n.gameManager.trialsManager.favorsEnabled?21:-1),t.R7$(2),t.vxM(n.gameManager.game.appliedScenarioRules.length||n.gameManager.game.discardedScenarioRules.length?23:-1),t.R7$(3),t.Y8G("ghs-label","scenario.finish"),t.R7$(3),t.Y8G("ghs-label","scenario.finish.failure"),t.R7$(3),t.Y8G("ghs-label","scenario.finish.success"),t.R7$(3),t.Y8G("ghs-label","scenario.cancel"),t.R7$(2),t.Y8G("ghs-label","scenario.reset"),t.R7$(),t.vxM(n.settingsManager.settings.partySheet||n.gameManager.characterManager.characterCount(!0)>0?38:-1))},dependencies:[N.YU,O.Zm,O.BC,O.vS,tt,fr,At],styles:[".scenario-popup[_ngcontent-%COMP%]{position:relative;text-align:center;color:var(--ghs-color-white);min-width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%]{padding:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;justify-content:center;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;height:1em;width:auto;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow);height:.8em;width:auto}.scenario-popup[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .scenario-level-container[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * .7 * var(--ghs-dialog-factor));margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .favors[_ngcontent-%COMP%]{cursor:pointer;font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.scenario-popup[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.scenario-popup[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));display:flex;justify-content:center;flex-wrap:wrap}.scenario-popup[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{padding:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:not(:first-child){border-left:calc(var(--ghs-unit) * .1 * var(--ghs-barsize)) solid var(--ghs-color-white)}.scenario-popup[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section.random-monster-card[_ngcontent-%COMP%]{cursor:pointer}.scenario-popup[_ngcontent-%COMP%]   .open-sections[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));display:flex;flex-direction:column}.scenario-popup[_ngcontent-%COMP%]   .open-sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:hover{cursor:pointer;color:var(--ghs-color-white);text-shadow:var(--ghs-outline-thin)}.scenario-popup[_ngcontent-%COMP%]   .open-sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.scenario-popup[_ngcontent-%COMP%]   .open-sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:hover   .marker[_ngcontent-%COMP%]{filter:grayscale(.3)}.scenario-popup[_ngcontent-%COMP%]   .setup-checkbox[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;margin-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .setup-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .setup-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before{left:calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * -.25 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .additional[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.scenario-popup[_ngcontent-%COMP%]   .additional[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .additional[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.scenario-popup[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .2 * var(--ghs-barsize)) solid var(--ghs-color-white);margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));padding-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}.scenario-popup[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.scenario-popup[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex}.scenario-popup[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .failure[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.scenario-popup[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .success[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.scenario-popup[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:not(:first-child){margin-left:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.scenario-popup[_ngcontent-%COMP%]   .event-effects[_ngcontent-%COMP%]{cursor:pointer;font-family:var(--ghs-font-title);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-barsize));padding-top:calc(var(--ghs-unit) * 1.5 * var(--ghs-barsize));border-top:calc(var(--ghs-unit) * .2 * var(--ghs-barsize)) solid var(--ghs-color-white)}.scenario-popup[_ngcontent-%COMP%]   .event-effects[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.scenario-popup[_ngcontent-%COMP%]   .event-effects[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-barsize))}"]})}return i})();const XY=i=>({setup:i}),BY=i=>({denied:i}),YY=i=>[i],NY=i=>({unlooted:i}),zY=(i,r)=>[i,r],zr=(i,r)=>r.edition+"-"+r.index,Lr=(i,r)=>r.roomNumber;function LY(i,r){if(1&i&&(t.j41(0,"span",7),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.SpI("#",e.gameManager.game.scenario.index)}}function UY(i,r){if(1&i&&(t.j41(0,"span",8),t.nrm(1,"span",11),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label",e.gameManager.game.scenario.name?e.gameManager.scenarioManager.scenarioTitle(e.gameManager.game.scenario):e.gameManager.game.scenario.custom?"scenario.custom":"scenario.set")}}function qY(i,r){if(1&i&&(t.j41(0,"span",9),t.nrm(1,"span",12),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","scenario.level")("ghs-label-args",t.eq3(3,YY,e.gameManager.game.scenario.level+""))("ngClass","level-"+e.gameManager.game.scenario.level)}}function HY(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",13),t.bIt("click",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.openTreasures(n))}),t.nrm(1,"img",14),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(1,NY,e.gameManager.scenarioManager.getTreasures(e.gameManager.game.scenario,e.gameManager.game.sections,!0).length>0))}}function KY(i,r){if(1&i&&(t.j41(0,"div",2),t.nVh(1,LY,2,1,"span",7),t.nVh(2,UY,2,1,"span",8),t.nVh(3,qY,2,5,"span",9),t.nVh(4,HY,2,3,"span",10),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.vxM(e.gameManager.game.scenario.index&&!e.gameManager.game.scenario.hideIndex?1:-1),t.R7$(),t.vxM(e.gameManager.game.scenario?2:-1),t.R7$(),t.vxM(e.gameManager.game.scenario.level?3:-1),t.R7$(),t.vxM(e.settingsManager.settings.scenarioRooms&&e.settingsManager.settings.treasures&&e.gameManager.scenarioManager.getTreasures(e.gameManager.game.scenario,e.gameManager.game.sections).length>0?4:-1)}}function WY(i,r){1&i&&(t.j41(0,"div",3),t.nrm(1,"img",15)(2,"span",11),t.k0s()),2&i&&(t.R7$(2),t.Y8G("ghs-label","scenario.eventEffects"))}function JY(i,r){if(1&i&&t.nrm(0,"span",19),2&i){const e=t.XpG().$implicit;t.Y8G("ghs-label","%game.mapMarker."+e.marker+"%")}}function ZY(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",17),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.open())}),t.nrm(1,"img",18),t.EFF(2),t.nVh(3,JY,1,1,"span",19),t.k0s()}if(2&i){const e=r.$implicit;t.R7$(2),t.SpI(" ",e.ref," "),t.R7$(),t.vxM(e.marker?3:-1)}}function QY(i,r){if(1&i&&t.Z7z(0,ZY,4,2,"span",16,Lr),2&i){const e=t.XpG();t.Dyx(e.gameManager.scenarioManager.openRooms())}}function t9(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.SpI("#",e.index)}}function e9(i,r){if(1&i&&(t.j41(0,"span",8),t.EFF(1," \xa0"),t.nrm(2,"span",11),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(2),t.Y8G("ghs-label",a.gameManager.scenarioManager.scenarioTitle(e,!0))}}function n9(i,r){if(1&i&&t.nrm(0,"span",19),2&i){const e=t.XpG().$implicit;t.Y8G("ghs-label","%game.mapMarker."+e.marker+"%")}}function i9(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",20),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.open())})("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.openRandomMonsterCard(n))}),t.nrm(1,"img",21),t.nVh(2,t9,2,1,"span"),t.nVh(3,e9,3,1,"span",8),t.nVh(4,n9,1,1,"span",19),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.R7$(2),t.vxM(e.hideIndex?-1:2),t.R7$(),t.vxM(a.gameManager.game.scenario&&e.name==a.gameManager.game.scenario.name?-1:3),t.R7$(),t.vxM(e.marker?4:-1)}}function a9(i,r){if(1&i&&t.nrm(0,"span",19),2&i){const e=t.XpG().$implicit;t.Y8G("ghs-label","%game.mapMarker."+e.marker+"%")}}function o9(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",23),t.bIt("click",function(n){const o=t.eBV(e).$implicit,g=t.XpG(2);return t.Njj(g.openRoom(o,n))}),t.nrm(1,"img",24),t.j41(2,"span",25),t.EFF(3),t.k0s(),t.nVh(4,a9,1,1,"span",19),t.k0s()}if(2&i){const e=r.$implicit;t.Y8G("ghs-tooltip",(e.marker?"scenario.openRoomMarker":"scenario.openRoom")+(e.ref?"Ref":""))("ghs-label-args",t.l_i(8,zY,e.ref||"",e.marker||""))("originX","center")("overlayY","center")("originY","top")("overlayY","bottom"),t.R7$(3),t.JRh(e.ref),t.R7$(),t.vxM(e.marker?4:-1)}}function s9(i,r){if(1&i&&t.Z7z(0,o9,5,11,"span",22,Lr),2&i){const e=t.XpG();t.Dyx(e.gameManager.scenarioManager.closedRooms())}}function r9(i,r){1&i&&t.nrm(0,"img",27)}function c9(i,r){1&i&&t.nrm(0,"img",28)}function l9(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.SpI("#",e.index)}}function g9(i,r){if(1&i&&t.nrm(0,"span",19),2&i){const e=t.XpG().$implicit;t.Y8G("ghs-label","%game.mapMarker."+e.marker+"%")}}function d9(i,r){if(1&i&&(t.j41(0,"span",8),t.EFF(1," \xa0"),t.nrm(2,"span",11),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(2),t.Y8G("ghs-label",a.gameManager.scenarioManager.scenarioTitle(e,!0))}}function h9(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",26),t.bIt("click",function(n){const o=t.eBV(e).$implicit,g=t.XpG();return t.Njj(g.addSection(o,n))}),t.nVh(1,r9,1,0,"img",27),t.nVh(2,c9,1,0,"img",28),t.nVh(3,l9,2,1,"span"),t.nVh(4,g9,1,1,"span",19),t.nVh(5,d9,3,1,"span",8),t.k0s()}if(2&i){const e=r.$implicit;t.R7$(),t.vxM(e.conclusion?-1:1),t.R7$(),t.vxM(e.conclusion?2:-1),t.R7$(),t.vxM(e.conclusion&&e.name||e.hideIndex?-1:3),t.R7$(),t.vxM(e.marker?4:-1),t.R7$(),t.vxM((e.conclusion||e.named)&&e.name?5:-1)}}let _9=(()=>{class i{dialog;gameManager=s.E;settingsManager=m.f;constructor(e){this.dialog=e}ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{if(s.E.game.scenario&&s.E.game.finish&&!s.E.stateManager.scenarioSummary){const e=s.E.game.finish.conclusion?s.E.sectionData(s.E.game.finish.conclusion.edition).find(a=>s.E.game.finish&&s.E.game.finish.conclusion&&a.index==s.E.game.finish.conclusion.index&&a.group==s.E.game.finish.conclusion.group&&a.conclusion):void 0;this.dialog.open(Yt,{panelClass:["dialog"],disableClose:!0,data:{scenario:s.E.game.scenario,conclusion:e,success:s.E.game.finish.success}})}else s.E.game.eventDraw&&m.f.settings.eventsDraw&&!this.dialog.openDialogs.find(e=>e.componentInstance&&e.componentInstance instanceof Ti)&&this.dialog.open(Ti,{panelClass:["dialog"],disableClose:!0,data:{edition:s.E.game.edition||s.E.currentEdition(),type:s.E.game.eventDraw}}).closed.subscribe({next:e=>{m.f.settings.eventsApply&&e&&e.length&&this.dialog.open(ni,{panelClass:["dialog"],data:{eventResults:e}})}})}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}open(){s.E.game.scenario?this.dialog.open(FY,{data:s.E.game.scenario,panelClass:["dialog"]}):this.dialog.open(ni,{panelClass:["dialog"]})}openTreasures(e){e.preventDefault(),e.stopPropagation(),s.E.game.scenario&&this.dialog.open(La,{panelClass:["dialog"]})}openRandomMonsterCard(e){"randomMonsterCard"==e.group?this.dialog.open(Ar,{panelClass:["fullscreen-panel"],disableClose:!0,data:e}):this.open()}availableSections(){return s.E.scenarioManager.availableSections().sort((e,a)=>e.marker&&a.marker&&!e.marker.startsWith("element")&&!a.marker.startsWith("element")?e.marker<a.marker?-1:1:0)}openRoom(e,a){a.preventDefault(),a.stopPropagation();const n=s.E.game.scenario;if(n)if(s.E.roundManager.firstRound)this.open();else{if(!s.E.editionData.find(g=>s.E.game.scenario&&g.edition==s.E.game.scenario.edition))return void console.error("Could not find edition data!");s.E.stateManager.before(e.marker?"openRoomMarker":"openRoom",n.index,s.E.scenarioManager.scenarioTitle(n),e.ref,e.marker||""),s.E.scenarioManager.openRoom(e,n,!1),s.E.stateManager.after()}}addSection(e,a){a.preventDefault(),a.stopPropagation(),s.E.roundManager.firstRound?this.open():this.dialog.open(Br,{panelClass:["dialog"],data:e})}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-scenario"]],standalone:!1,decls:11,vars:10,consts:[[1,"scenario-container",3,"ngClass"],[1,"button",3,"click"],[1,"scenario"],[1,"event-effects"],[1,"sections","rooms",3,"ngClass"],["ghs-pointer-input","",1,"section"],[1,"section","available"],[1,"index"],[1,"name"],[1,"scenario-level-container"],[1,"treasures",3,"ngClass"],[3,"ghs-label"],[1,"scenario-level",3,"ghs-label","ghs-label-args","ngClass"],[1,"treasures",3,"click","ngClass"],["src","./assets/images/scenario/treasure.svg",1,"ghs-svg"],["src","./assets/images/event.svg",1,"ghs-svg"],[1,"section","room"],[1,"section","room",3,"click"],["src","./assets/images/scenario/door-open.svg",1,"ghs-svg"],[1,"marker",3,"ghs-label"],["ghs-pointer-input","",1,"section",3,"singleClick","doubleClick"],["src","./assets/images/lock-open.svg",1,"ghs-svg"],[1,"section","room","available",3,"ghs-tooltip","ghs-label-args","originX","overlayY","originY"],[1,"section","room","available",3,"click","ghs-tooltip","ghs-label-args","originX","overlayY","originY"],["src","./assets/images/scenario/door.svg",1,"ghs-svg"],[1,"ref"],[1,"section","available",3,"click"],["src","./assets/images/lock.svg",1,"ghs-svg"],["src","./assets/images/scenario/conclusion.svg",1,"ghs-svg"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.bIt("click",function(){return n.open()}),t.nVh(2,KY,5,4,"div",2),t.nVh(3,WY,3,1,"div",3),t.k0s(),t.j41(4,"div",4),t.nVh(5,QY,2,0),t.Z7z(6,i9,5,3,"span",5,zr),t.nVh(8,s9,2,0),t.Z7z(9,h9,6,5,"span",6,zr),t.k0s()()),2&a&&(t.Y8G("ngClass",t.eq3(6,XY,n.gameManager.game.round<1)),t.R7$(2),t.vxM(n.gameManager.game.scenario?2:-1),t.R7$(),t.vxM(n.gameManager.bbRules()||n.gameManager.game.scenario||!(n.gameManager.characterManager.characterCount(!0)>0||n.settingsManager.settings.partySheet)?-1:3),t.R7$(),t.Y8G("ngClass",t.eq3(8,BY,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.scenario)),t.R7$(),t.vxM(n.settingsManager.settings.scenarioRooms?5:-1),t.R7$(),t.Dyx(n.gameManager.game.sections),t.R7$(2),t.vxM(n.settingsManager.settings.scenarioRooms?8:-1),t.R7$(),t.Dyx(n.availableSections()))},dependencies:[N.YU,tt,ft,rt],styles:[".scenario-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-barsize));margin-bottom:calc(var(--ghs-unit) * -1 * var(--ghs-barsize));color:var(--ghs-color-gray)}.scenario-container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{cursor:pointer;display:flex;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.8 * var(--ghs-barsize) * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 2.3 * var(--ghs-barsize) * var(--ghs-text-factor));text-shadow:var(--ghs-outline-thin)}.scenario-container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-barsize))}.scenario-container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.scenario-container[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap}.scenario-container[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;height:1em;width:auto;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-barsize))}.scenario-container[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .treasures[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray);height:.8em;width:auto}.scenario-container[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .treasures.unlooted[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.scenario-container[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .scenario-level-container[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-barsize) * var(--ghs-text-factor));margin-top:calc(var(--ghs-unit) * -.2 * var(--ghs-barsize));margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-barsize))}.scenario-container[_ngcontent-%COMP%]   .event-effects[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.scenario-container[_ngcontent-%COMP%]   .event-effects[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-barsize))}.scenario-container[_ngcontent-%COMP%]   .event-effects[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.scenario-container[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-barsize) * var(--ghs-text-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline-thin);max-height:calc(var(--ghs-unit) * 3.5 * var(--ghs-barsize) * var(--ghs-text-factor));overflow:auto}.scenario-container[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;padding:0 calc(var(--ghs-unit) * .5 * var(--ghs-barsize))}.scenario-container[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:not(:first-child){border-left:calc(var(--ghs-unit) * .1 * var(--ghs-barsize)) solid var(--ghs-color-gray)}.scenario-container[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}.scenario-container[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:not(.available)   .marker[_ngcontent-%COMP%]{filter:grayscale(.9);opacity:.8}.scenario-container[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section.available[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white);text-shadow:var(--ghs-outline-thin)}.scenario-container[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section.available[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.scenario-container[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section.available[_ngcontent-%COMP%]:hover   .marker[_ngcontent-%COMP%]{filter:grayscale(.3)}@media (max-width: 791px){.scenario-container[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]{max-height:calc(var(--ghs-unit) * 7 * var(--ghs-barsize))}.scenario-container[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{display:none}}"]})}return i})();const m9=i=>({denied:i});function p9(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",8)(1,"a",10),t.bIt("click",function(){t.eBV(e),t.XpG();const n=t.sdS(1),o=t.XpG().$index,g=t.XpG();return t.Njj(g.applyRule(n,o))}),t.nrm(2,"span",5)(3,"img",11),t.k0s()()}if(2&i){const e=t.XpG(2).$implicit;t.R7$(2),t.Y8G("ghs-label",e.rule.alwaysApply||e.rule.alwaysApplyTurn?"scenario.rules.alwaysApply":"scenario.rules.apply")}}function u9(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",2,0)(2,"div",3)(3,"div",4),t.bIt("click",function(){t.eBV(e);const n=t.sdS(1),o=t.XpG().$index,g=t.XpG();return t.Njj(g.hideRule(n,o))}),t.nrm(4,"span",5)(5,"img",6),t.k0s(),t.nrm(6,"ghs-scenario-rule",7),t.nVh(7,p9,4,1,"div",8),t.j41(8,"div",9),t.bIt("click",function(){t.eBV(e);const n=t.sdS(1),o=t.XpG().$index,g=t.XpG();return t.Njj(g.close(n,o))}),t.k0s()()()}if(2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(4),t.Y8G("ghs-label","scenario.rules.hide"),t.R7$(2),t.Y8G("rule",e.rule)("identifier",e.identifier),t.R7$(),t.vxM(a.apply(e.rule)?7:-1),t.R7$(),t.Y8G("ghs-label","scenario.rules.dismiss")("ghs-label-attribute","title")}}function f9(i,r){if(1&i&&t.nVh(0,u9,9,6,"div",2),2&i){const e=r.$index,a=t.XpG();t.vxM(a.visible(e)?0:-1)}}let C9=(()=>{class i{dialog;gameManager=s.E;settingsManager=m.f;EntityValueFunction=$.hZ;constructor(e){this.dialog=e}randomDungeonsMonsterLabel(e){return e.randomDungeon&&e.randomDungeon.monsterCards&&e.randomDungeon.monsterCards.length?e.randomDungeon.monsterCards.filter(a=>!s.E.game.scenario||!s.E.game.scenario.additionalSections||-1==s.E.game.scenario.additionalSections.indexOf(a)).map(a=>{if(s.E.game.scenario){const n=s.E.sectionData(s.E.game.scenario.edition,!0).find(o=>o.index==a&&"randomMonsterCard"==o.group);if(n)return"&nbsp%"+s.E.scenarioManager.scenarioTitle(n,!0)+"% (#"+n.index+")"}return"&nbsp"+a}):[]}randomDungeonsDungeonLabel(e){return e.randomDungeon&&e.randomDungeon.dungeonCards&&e.randomDungeon.dungeonCards.length?e.randomDungeon.dungeonCards.filter(a=>!s.E.game.scenario||!s.E.game.scenario.additionalSections||-1==s.E.game.scenario.additionalSections.indexOf(a)).map(a=>{if(s.E.game.scenario){const n=s.E.sectionData(s.E.game.scenario.edition,!0).find(o=>o.index==a&&"randomDungeonCard"==o.group);if(n)return"&nbsp%"+s.E.scenarioManager.scenarioTitle(n,!0)+"% (#"+n.index+")"}return"&nbsp"+a}):[]}prevent(e){e.preventDefault(),e.stopPropagation()}sections(e){if(s.E.game.scenarioRules[e]){const a=s.E.scenarioRulesManager.getScenarioForRule(s.E.game.scenarioRules[e].identifier).scenario;if(a){const n=s.E.game.scenarioRules[e].rule;if(n&&n.sections)return s.E.sectionData(a.edition).filter(o=>!s.E.game.sections.find(g=>g.edition==o.edition&&g.group==a.group&&g.index==o.index)&&o.group==a.group&&-1!=n.sections.indexOf(o.index))}}return[]}rooms(e){let a=[];if(s.E.game.scenarioRules[e]){const n=s.E.scenarioRulesManager.getScenarioForRule(s.E.game.scenarioRules[e].identifier).scenario;if(n){const o=s.E.game.scenarioRules[e].rule;o&&o.rooms&&o.rooms.forEach(g=>{const _=n.rooms.find(y=>y.roomNumber==g);_&&s.E.game.scenario&&-1==s.E.game.scenario.revealedRooms.indexOf(g)&&a.push(_)})}}return a}figureRules(e){return e.figures&&e.figures.filter(a=>{if(-1!=Pi.uh.indexOf(a.type))return!1;const n=s.E.scenarioRulesManager.figuresByFigureRule(a,e);return 0!=n.length&&("gainCondition"==a.type||"permanentCondition"==a.type||"loseCondition"==a.type?n.some(o=>{if("gainCondition"==a.type){let g=s.E.entityManager.entities(o),_=new j.kW(a.value);if(g.every(y=>s.E.entityManager.hasCondition(y,_)))return!1}else if("permanentCondition"==a.type){let g=s.E.entityManager.entities(o),_=new j.kW(a.value);if(g.every(y=>s.E.entityManager.hasCondition(y,_,!0)))return!1}else if("loseCondition"==a.type){let g=s.E.entityManager.entities(o),_=new j.kW(a.value);if(g.every(y=>!s.E.entityManager.hasCondition(y,_)))return!1}return!0}):"toggleOn"!=a.type&&"toggleOff"!=a.type||n.some(o=>o.off==("toggleOn"==a.type)))})||[]}visible(e){if(s.E.game.scenarioRules[e]){const a=s.E.game.scenarioRules[e].rule;if(a.disablingRules&&a.disablingRules.length>0&&a.disablingRules.some(n=>s.E.game.scenarioRules.find((o,g)=>e!=g&&n.edition==o.identifier.edition&&n.group==o.identifier.group&&(n.index==o.identifier.index||-1==n.index)&&n.scenario==o.identifier.scenario&&n.section==o.identifier.section&&this.visible(g))))return!1;if(s.E.scenarioRulesManager.spawns(a).length>0||a.objectiveSpawns&&a.objectiveSpawns.length>0||a.elements&&a.elements.length>0&&a.elements.some(n=>s.E.game.elementBoard.find(o=>o.type==n.type)?.state!=n.state)||this.sections(e).length>0||this.rooms(e).length>0||this.figureRules(a).length>0||a.note||a.finish||a.randomDungeon||a.statEffects&&a.statEffects.length)return!0}return!1}apply(e){return s.E.scenarioRulesManager.spawns(e).length>0||e.objectiveSpawns&&e.objectiveSpawns.length>0||e.elements&&e.elements.length>0||e.finish||m.f.settings.scenarioRooms&&e.rooms&&e.rooms.length>0||e.sections&&e.sections.length>0||e.randomDungeon||e.figures&&e.figures.length>0&&e.figures.some(a=>-1==Pi.uh.indexOf(a.type))||e.statEffects&&e.statEffects.length}applyRule(e,a){if(s.E.game.scenarioRules[a]){const n=s.E.game.scenarioRules[a].rule,o=s.E.game.scenarioRules[a].identifier,g=s.E.scenarioRulesManager.getScenarioForRule(o).scenario;g&&(s.E.stateManager.before("applyScenarioRule"),n.alwaysApplyTurn||(s.E.scenarioRulesManager.applyRule(n,o),n.rooms&&this.rooms(a).forEach(_=>{s.E.scenarioManager.openRoom(_,g,s.E.game.scenarioRules[a].identifier.section)}),n.sections&&this.sections(a).forEach(_=>{_.conclusion?this.dialog.open(Yt,{panelClass:["dialog"],data:{scenario:s.E.game.scenario,success:!0,conclusion:_}}):s.E.scenarioManager.addSection(_)}),n.finish&&-1!=["won","lost"].indexOf(n.finish)&&this.dialog.open(Yt,{panelClass:["dialog"],data:{scenario:g,success:"won"==n.finish}})),e.classList.add("closed"),setTimeout(()=>{(n.once||n.alwaysApply||n.alwaysApplyTurn)&&s.E.game.appliedScenarioRules.push(o),s.E.game.scenarioRules.splice(a,1),"round"==n.finish&&s.E.roundManager.nextGameState(),s.E.stateManager.after()},m.f.settings.animations?100*m.f.settings.animationSpeed:0))}}hideRule(e,a){e.classList.add("closed"),setTimeout(()=>{s.E.stateManager.before("hideScenarioRule");const n=s.E.game.scenarioRules.splice(a,1)[0];s.E.game.discardedScenarioRules.push(n.identifier),s.E.stateManager.after()},m.f.settings.animations?100*m.f.settings.animationSpeed:0)}close(e,a){e.classList.add("closed"),setTimeout(()=>{s.E.stateManager.before("removeScenarioRule");const n=s.E.game.scenarioRules.splice(a,1)[0];(n.rule.once||n.rule.alwaysApplyTurn||n.rule.alwaysApply)&&s.E.game.discardedScenarioRules.push(n.identifier),s.E.stateManager.after()},m.f.settings.animations?100*m.f.settings.animationSpeed:0)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-scenario-rules"]],standalone:!1,decls:3,vars:3,consts:[["ruleElement",""],[1,"rules-dialog",3,"ngClass"],[1,"rule-dialog","dialog"],[1,"dialog-container"],[1,"hide",3,"click"],[3,"ghs-label"],["src","./assets/images/close.svg"],[3,"rule","identifier"],[1,"menu"],[1,"close",3,"click","ghs-label","ghs-label-attribute"],[1,"apply",3,"click"],["src","./assets/images/check.svg"]],template:function(a,n){1&a&&(t.j41(0,"div",1),t.Z7z(1,f9,1,1,null,null,t.fX1),t.k0s()),2&a&&(t.Y8G("ngClass",t.eq3(1,m9,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.scenario)),t.R7$(),t.Dyx(n.gameManager.game.scenarioRules))},dependencies:[N.YU,tt,Xr],styles:[".rules-dialog[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));color:var(--ghs-color-gray);font-family:var(--ghs-font-text);text-align:center}.rules-dialog[_ngcontent-%COMP%]   .hide[_ngcontent-%COMP%]{position:relative;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));color:var(--ghs-color-darkgray);cursor:pointer;display:flex;justify-content:flex-end;align-items:center;z-index:1;margin-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.rules-dialog[_ngcontent-%COMP%]   .hide[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto;margin:0 .2em;filter:var(--ghs-filter-darkgray)}.rules-dialog[_ngcontent-%COMP%]   .hide[_ngcontent-%COMP%]:hover{color:var(--ghs-color-gray)}.rules-dialog[_ngcontent-%COMP%]   .hide[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}.rules-dialog[_ngcontent-%COMP%]   .rule-dialog[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;min-height:calc(var(--ghs-unit) * 6 * var(--ghs-text-factor));margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));transition:all calc(var(--ghs-animation-speed) * .1s) ease-in-out;overflow:hidden;width:100%}.rules-dialog[_ngcontent-%COMP%]   .rule-dialog[_ngcontent-%COMP%]   .dialog-container[_ngcontent-%COMP%]{padding-bottom:0}.rules-dialog[_ngcontent-%COMP%]   .rule-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.rules-dialog[_ngcontent-%COMP%]   .rule-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;z-index:1;flex-grow:1;padding-bottom:calc(var(--ghs-unit) * 2)}.rules-dialog[_ngcontent-%COMP%]   .rule-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}.rules-dialog[_ngcontent-%COMP%]   .rule-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));height:auto;margin:0 .2em}.rules-dialog[_ngcontent-%COMP%]   .rule-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]{color:var(--ghs-color-green)}.rules-dialog[_ngcontent-%COMP%]   .rule-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a.apply[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-green)}.rules-dialog[_ngcontent-%COMP%]   .rule-dialog[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 2);left:calc(var(--ghs-unit) * 2);right:calc(var(--ghs-unit) * 2);bottom:calc(var(--ghs-unit) * 2);z-index:0;cursor:zoom-out}.rules-dialog[_ngcontent-%COMP%]   .rule-dialog.closed[_ngcontent-%COMP%]{padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;height:0;min-height:initial;width:100%}"]})}return i})();const M9=["nextButton"],v9=["footer"],O9=["monsterDeck"],P9=["ghsLevel"],b9=["ghsScenario"],k9=["monsterAttackModifierDeck"],y9=["allyAttackModifierDeck"],x9=["lootDeck"],E9=i=>({compact:i}),w9=i=>({denied:i}),R9=i=>({disabled:i}),j9=(i,r,e,a,n)=>({collapsed:i,initial:r,partial:e,full:a,"no-monster-deck":n}),Ai=(i,r)=>({inactive:i,denied:r}),Ur=(i,r,e,a)=>({collapsed:i,initial:r,partial:e,full:a}),G9=(i,r,e,a,n)=>({collapsed:i,initial:r,partial:e,"partial-2":a,full:n});function T9(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.JRh(e.round())}}function S9(i,r){if(1&i&&(t.j41(0,"span",13),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.SpI("\xa0(",e.totalRounds(),")")}}function $9(i,r){if(1&i&&(t.j41(0,"span",14),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.JRh(e.currentTime)}}function D9(i,r){1&i&&t.nrm(0,"ghs-scenario-rules")}function I9(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",18)(1,"ghs-attackmodifier-deck",22,5),t.bIt("before",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.beforeAllyAttackModifierDeck(n))})("after",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.afterAllyAttackModifierDeck(n))}),t.k0s(),t.j41(3,"div",23)(4,"span",24),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleActiveAllyAttackModifierDeck())}),t.EFF(5,"A"),t.k0s()()()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.s1E(5,j9,!e.gameManager.game.allyAttackModifierDeck.active||e.compact&&(e.gameManager.game.lootDeck.active||e.gameManager.game.challengeDeck.active),e.gameManager.game.allyAttackModifierDeck.active&&e.gameManager.game.allyAttackModifierDeck.current<0,e.gameManager.game.allyAttackModifierDeck.active&&0==e.gameManager.game.allyAttackModifierDeck.current,e.gameManager.game.allyAttackModifierDeck.active&&e.gameManager.game.allyAttackModifierDeck.current>0,!e.settingsManager.settings.monsterAttackModifierDeck)),t.R7$(),t.Y8G("deck",e.gameManager.game.allyAttackModifierDeck)("ally",!0)("bottom",!0),t.R7$(2),t.Y8G("ngClass",t.l_i(11,Ai,!e.gameManager.game.allyAttackModifierDeck.active,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.lootDeck))}}function A9(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",19,6)(2,"ghs-attackmodifier-deck",25,7),t.bIt("before",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.beforeMonsterAttackModifierDeck(n))})("after",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.afterMonsterAttackModifierDeck(n))}),t.k0s(),t.j41(4,"div",23)(5,"span",24),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleActiveMonsterAttackModifierDeck())}),t.EFF(6,"m"),t.k0s()()()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.ziG(4,Ur,!e.gameManager.game.monsterAttackModifierDeck.active||e.compact&&(e.gameManager.game.lootDeck.active||e.gameManager.game.challengeDeck.active),e.gameManager.game.monsterAttackModifierDeck.active&&e.gameManager.game.monsterAttackModifierDeck.current<0,e.gameManager.game.monsterAttackModifierDeck.active&&(0==e.gameManager.game.monsterAttackModifierDeck.current||e.gameManager.game.monsterAttackModifierDeck.bb&&e.gameManager.game.monsterAttackModifierDeck.current>=0&&!e.gameManager.game.monsterAttackModifierDeck.state),e.gameManager.game.monsterAttackModifierDeck.active&&(!e.gameManager.game.monsterAttackModifierDeck.bb&&e.gameManager.game.monsterAttackModifierDeck.current>0||e.gameManager.game.monsterAttackModifierDeck.bb&&e.gameManager.game.monsterAttackModifierDeck.current>=0&&e.gameManager.game.monsterAttackModifierDeck.state))),t.R7$(2),t.Y8G("deck",e.gameManager.game.monsterAttackModifierDeck)("bottom",!0),t.R7$(2),t.Y8G("ngClass",t.l_i(9,Ai,!e.gameManager.game.monsterAttackModifierDeck.active,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.attackModifiers))}}function V9(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",20)(1,"ghs-loot-deck",26,8),t.bIt("before",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.beforeLootDeck(n))})("after",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.afterLootDeck(n))}),t.k0s(),t.j41(3,"div",23)(4,"span",24),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleLootDeck())}),t.nrm(5,"img",27),t.k0s()()()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.ziG(4,Ur,!e.gameManager.game.lootDeck.active,e.gameManager.game.lootDeck.active&&e.gameManager.game.lootDeck.current<0,e.gameManager.game.lootDeck.active&&0==e.gameManager.game.lootDeck.current,e.gameManager.game.lootDeck.active&&e.gameManager.game.lootDeck.current>0)),t.R7$(),t.Y8G("deck",e.gameManager.game.lootDeck)("bottom",!0),t.R7$(2),t.Y8G("ngClass",t.l_i(9,Ai,!e.gameManager.game.lootDeck.active,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.attackModifiers))}}function F9(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",21)(1,"ghs-challenge-deck",26),t.bIt("before",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.beforeChallengeDeck(n))})("after",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.afterChallengeDeck(n))}),t.k0s(),t.j41(2,"div",23)(3,"span",24),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleChallengeDeck())}),t.nrm(4,"img",28),t.k0s()()()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.s1E(4,G9,!e.gameManager.game.challengeDeck.active,e.gameManager.game.challengeDeck.active&&e.gameManager.game.challengeDeck.current<=e.gameManager.game.challengeDeck.finished,e.gameManager.game.challengeDeck.current>e.gameManager.game.challengeDeck.finished,e.gameManager.game.challengeDeck.current>e.gameManager.game.challengeDeck.finished+1,e.gameManager.game.challengeDeck.active&&e.gameManager.game.challengeDeck.current>e.gameManager.game.challengeDeck.finished+2)),t.R7$(),t.Y8G("deck",e.gameManager.game.challengeDeck)("bottom",!0),t.R7$(),t.Y8G("ngClass",t.l_i(10,Ai,!e.gameManager.game.challengeDeck.active,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.scenario))}}let X9=(()=>{class i{dialog;overlay;nextButton;footer;monsterDeck;ghsLevel;ghsScenario;monsterAttackModifierDeck;allyAttackModifierDeck;lootDeck;gameManager=s.E;settingsManager=m.f;GameState=T.mk;currentTime="";hasAllyAttackModifierDeck=!1;lootDeckEnabeld=!1;compact=!1;nextHint=!1;constructor(e,a){this.dialog=e,this.overlay=a}ngOnInit(){this.hasAllyAttackModifierDeck=m.f.settings.allyAttackModifierDeck&&(m.f.settings.alwaysAllyAttackModifierDeck||s.E.fhRules()&&s.E.game.figures.some(e=>e instanceof P.R&&(e.isAlly||e.isAllied)||e instanceof mt.$e&&e.objectiveId&&s.E.objectiveManager.objectiveDataByObjectiveIdentifier(e.objectiveId)?.allyDeck)||s.E.game.scenario&&s.E.game.scenario.allyDeck)||!1,this.lootDeckEnabeld=m.f.settings.lootDeck&&Object.keys(s.E.game.lootDeck.cards).length>0,this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.hasAllyAttackModifierDeck=m.f.settings.allyAttackModifierDeck&&(m.f.settings.alwaysAllyAttackModifierDeck||s.E.fhRules()&&s.E.game.figures.some(e=>e instanceof P.R&&(e.isAlly||e.isAllied)||e instanceof mt.$e&&e.objectiveId&&s.E.objectiveManager.objectiveDataByObjectiveIdentifier(e.objectiveId)?.allyDeck)||s.E.game.scenario&&s.E.game.scenario.allyDeck)||!1,this.lootDeckEnabeld=m.f.settings.lootDeck&&Object.keys(s.E.game.lootDeck.cards).length>0}}),setInterval(()=>{s.E.game.playSeconds++;let e=s.E.game.playSeconds;this.currentTime="",e/3600>=1&&(this.currentTime+=Math.floor(e/3600)+"h ",e%=3600),e/60>=1&&(this.currentTime+=(this.currentTime&&this.currentTime&&Math.floor(e/60)<10?"0":"")+Math.floor(e/60)+"m ",e%=60),this.currentTime+=(this.currentTime&&e<10?"0":"")+Math.floor(e)+"s",(new Date).getTime()/1e3-s.E.stateManager.lastSaveTimestamp/1e3>30&&s.E.stateManager.saveLocal()},1e3),setTimeout(()=>{this.compact=this.monsterDeck&&this.monsterDeck.nativeElement.clientWidth>.3*this.footer.nativeElement.clientWidth},100),window.addEventListener("resize",e=>{this.compact=this.monsterDeck&&this.monsterDeck.nativeElement.clientWidth>.3*this.footer.nativeElement.clientWidth})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}next(e=!1){!e&&this.disabled()?(this.nextHint=!0,this.dialog.open(nG,{panelClass:["dialog"],positionStrategy:this.overlay.position().flexibleConnectedTo(this.nextButton).withPositions([new zt.uH({originX:"end",originY:"bottom"},{overlayX:"start",overlayY:"bottom"})]).withDefaultOffsetX(10).withDefaultOffsetY(-10)}).closed.subscribe({next:n=>{this.nextHint=!1,n&&this.nextState()}})):this.nextState()}nextState(){var e=this;return(0,X.A)(function*(){if(s.E.stateManager.before(s.E.game.state==T.mk.next?"nextRound":"draw"),s.E.game.state==T.mk.next)if(m.f.settings.turnConfirmation){const a=s.E.game.figures.find(n=>n.active&&!n.off);!e.activeHint()&&a&&s.E.roundManager.afterTurn(a)}else{let a=s.E.game.figures.find(n=>s.E.gameplayFigure(n)&&!n.off);for(;a;)s.E.roundManager.toggleFigure(a),a=s.E.game.figures.find(n=>s.E.gameplayFigure(n)&&!n.off)}s.E.roundManager.nextGameState(),s.E.stateManager.after(1e3)})()}beforeMonsterAttackModifierDeck(e){s.E.stateManager.before("updateAttackModifierDeck."+e.type,"monster",...e.values)}afterMonsterAttackModifierDeck(e){s.E.game.monsterAttackModifierDeck=e.deck,s.E.stateManager.after()}beforeAllyAttackModifierDeck(e){s.E.stateManager.before("updateAttackModifierDeck."+e.type,"ally",...e.values)}afterAllyAttackModifierDeck(e){s.E.game.allyAttackModifierDeck=e.deck,s.E.stateManager.after()}beforeLootDeck(e){s.E.stateManager.before(e.type,...e.values)}afterLootDeck(e){s.E.game.lootDeck=e.deck,s.E.stateManager.after()}beforeChallengeDeck(e){s.E.stateManager.before(e.type,...e.values)}afterChallengeDeck(e){s.E.game.challengeDeck=e.deck,s.E.stateManager.after()}confirmTurns(){s.E.game.figures.forEach(e=>s.E.roundManager.afterTurn(e)),this.next(!0)}finishScenario(e){if(s.E.game.scenario){const a=s.E.sectionData(s.E.game.scenario.edition).filter(n=>!!s.E.game.scenario&&n.edition==s.E.game.scenario.edition&&n.parent==s.E.game.scenario.index&&n.group==s.E.game.scenario.group&&n.conclusion&&0==s.E.scenarioManager.getRequirements(n).length);0!=a.length&&e?this.dialog.open(Se,{panelClass:["dialog"],data:{conclusions:a,parent:s.E.game.scenario}}).closed.subscribe({next:n=>{n&&this.dialog.open(Yt,{panelClass:["dialog"],data:{scenario:s.E.game.scenario,conclusion:n,success:e}})}}):this.dialog.open(Yt,{panelClass:["dialog"],data:{scenario:s.E.game.scenario,success:e}})}}resetScenario(){s.E.stateManager.before("resetScenario",...s.E.scenarioManager.scenarioUndoArgs()),s.E.roundManager.resetScenario(),s.E.stateManager.after(1e3)}empty(){return 0==s.E.game.figures.length}round(){const e=(s.E.game.round>0||s.E.game.roundResets.length>0||s.E.game.roundResetsHidden.length>0)&&s.E.game.state==T.mk.draw?1:0;return 0==s.E.game.roundResetsHidden.length?s.E.game.round+e:s.E.game.round+e+s.E.game.roundResetsHidden.reduce((a,n)=>(a||0)+(n||0))}totalRounds(){return 0==s.E.game.roundResets.length?0:s.E.game.roundResets.reduce((e,a)=>(e||0)+(a||0))+this.round()}missingInitiative(){return s.E.game.figures.some(e=>m.f.settings.initiativeRequired&&(e instanceof q.K&&s.E.entityManager.isAlive(e)&&!e.absent||e instanceof mt.$e)&&e.getInitiative()<=0)}active(){return null!=s.E.game.figures.find(e=>e.active&&!e.off&&(!(e instanceof q.K)||!e.absent))}battleGoals(){return!this.missingInitiative()&&m.f.settings.battleGoals&&m.f.settings.battleGoalsReminder&&null!=s.E.game.scenario&&s.E.roundManager.firstRound&&!s.E.game.figures.every(e=>!(e instanceof q.K)||e.battleGoal||e.absent)&&!s.E.bbRules()}eventDraw(){return!this.missingInitiative()&&!m.f.settings.eventsDraw&&m.f.settings.eventsDrawReminder&&null!=s.E.game.scenario&&s.E.roundManager.firstRound&&null!=s.E.game.eventDraw}activeHint(){return this.active()&&m.f.settings.turnConfirmation&&(m.f.settings.expireConditions||m.f.settings.applyConditions)}finish(){return!1}failed(){return!this.active()&&!this.empty()&&s.E.game.figures.some(e=>e instanceof q.K)&&s.E.game.figures.every(e=>!(e instanceof q.K)||e instanceof q.K&&(e.exhausted||e.health<=0||e.absent))}disabled(){return s.E.game.state==T.mk.draw&&this.drawDisabled()||s.E.game.state==T.mk.next&&this.nextDisabled()}drawDisabled(){return this.empty()||this.missingInitiative()||this.battleGoals()||this.finish()||this.failed()||this.eventDraw()}nextDisabled(){return this.activeHint()||this.finish()||this.failed()}toggleActiveAllyAttackModifierDeck(){this.beforeAllyAttackModifierDeck(new _t(s.E.game.allyAttackModifierDeck,!s.E.game.allyAttackModifierDeck.active||this.compact&&s.E.game.lootDeck.active?"amDeckShow":"amDeckHide")),this.compact&&s.E.game.lootDeck.active?(s.E.game.lootDeck.active=!1,s.E.game.allyAttackModifierDeck.active=!0):s.E.game.allyAttackModifierDeck.active=!s.E.game.allyAttackModifierDeck.active,this.afterAllyAttackModifierDeck(new _t(s.E.game.allyAttackModifierDeck,s.E.game.allyAttackModifierDeck.active?"amDeckShow":"amDeckHide"))}toggleActiveMonsterAttackModifierDeck(){this.beforeMonsterAttackModifierDeck(new _t(s.E.game.monsterAttackModifierDeck,!s.E.game.monsterAttackModifierDeck.active||this.compact&&s.E.game.lootDeck.active?"amDeckShow":"amDeckHide")),this.compact&&(s.E.game.lootDeck.active||s.E.game.challengeDeck.active)?(s.E.game.lootDeck.active=!1,s.E.game.challengeDeck.active=!1,s.E.game.monsterAttackModifierDeck.active=!0):s.E.game.monsterAttackModifierDeck.active=!s.E.game.monsterAttackModifierDeck.active,this.afterMonsterAttackModifierDeck(new _t(s.E.game.monsterAttackModifierDeck,s.E.game.monsterAttackModifierDeck.active?"amDeckShow":"amDeckHide"))}toggleLootDeck(){this.beforeLootDeck(new Nt(s.E.game.lootDeck,s.E.game.lootDeck.active?"lootDeckHide":"lootDeckShow")),s.E.game.lootDeck.active=!s.E.game.lootDeck.active,this.afterLootDeck(new Nt(s.E.game.lootDeck,s.E.game.lootDeck.active?"lootDeckShow":"lootDeckHide"))}toggleChallengeDeck(){this.beforeChallengeDeck(new It(s.E.game.challengeDeck,s.E.game.challengeDeck.active?"challengeDeck.hide":"challengeDeck.show")),s.E.game.challengeDeck.active=!s.E.game.challengeDeck.active,this.afterChallengeDeck(new It(s.E.game.challengeDeck,s.E.game.challengeDeck.active?"challengeDeck.show":"challengeDeck.hide"))}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG),t.rXU(zt.hJ))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-footer"]],viewQuery:function(a,n){if(1&a&&(t.GBs(M9,5),t.GBs(v9,5),t.GBs(O9,5),t.GBs(P9,5),t.GBs(b9,5),t.GBs(k9,5),t.GBs(y9,5),t.GBs(x9,5)),2&a){let o;t.mGM(o=t.lsd())&&(n.nextButton=o.first),t.mGM(o=t.lsd())&&(n.footer=o.first),t.mGM(o=t.lsd())&&(n.monsterDeck=o.first),t.mGM(o=t.lsd())&&(n.ghsLevel=o.first),t.mGM(o=t.lsd())&&(n.ghsScenario=o.first),t.mGM(o=t.lsd())&&(n.monsterAttackModifierDeck=o.first),t.mGM(o=t.lsd())&&(n.allyAttackModifierDeck=o.first),t.mGM(o=t.lsd())&&(n.lootDeck=o.first)}},standalone:!1,decls:26,vars:20,consts:[["footer",""],["nextButton",""],["button",""],["ghsScenario",""],["ghsLevel",""],["allyAttackModifierDeck",""],["monsterDeck",""],["monsterAttackModifierDeck",""],["lootDeck",""],[3,"ngClass"],[1,"round-container",3,"click","ngClass"],[3,"ghs-label"],[1,"round"],[1,"total-rounds"],[1,"time"],[1,"flex-shrink"],[1,"level-container"],[1,"attack-modifier-spacer"],[1,"deck","am-deck","ally-deck",3,"ngClass"],[1,"deck","am-deck","monster-deck",3,"ngClass"],[1,"deck","loot-deck",3,"ngClass"],[1,"deck","challenge-deck",3,"ngClass"],["numeration","A",3,"before","after","deck","ally","bottom"],[1,"active-toggle",3,"ngClass"],[1,"numeration",3,"click"],["numeration","m",3,"before","after","deck","bottom"],[3,"before","after","deck","bottom"],["src","./assets/images/fh/loot-token.png"],["src","./assets/images/fh/challenges/challenge.png"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"footer",9,0)(2,"div",9)(3,"div",10,1),t.bIt("click",function(){return t.eBV(o),t.Njj(n.next())}),t.j41(5,"a"),t.nrm(6,"span",11),t.k0s(),t.j41(7,"span",12),t.nVh(8,T9,2,1,"span"),t.nVh(9,S9,2,1,"span",13),t.k0s(),t.nVh(10,$9,2,1,"span",14),t.nrm(11,"span",null,2),t.k0s()(),t.nrm(13,"div",15),t.j41(14,"div",16),t.nrm(15,"ghs-scenario",null,3)(17,"ghs-level",null,4),t.k0s(),t.nVh(19,D9,1,0,"ghs-scenario-rules"),t.nrm(20,"div",15)(21,"div",17),t.nVh(22,I9,6,14,"div",18),t.nVh(23,A9,7,12,"div",19),t.nVh(24,V9,6,12,"div",20),t.nVh(25,F9,5,13,"div",21),t.k0s()}2&a&&(t.HbH(n.settingsManager.settings.theme),t.Y8G("ngClass",t.eq3(14,E9,n.compact)),t.R7$(2),t.Y8G("ngClass",t.eq3(16,w9,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.round)),t.R7$(),t.Y8G("ngClass",t.eq3(18,R9,n.disabled())),t.R7$(3),t.Y8G("ghs-label",n.gameManager.game.state==n.GameState.next?"round.next":"round.draw"),t.R7$(2),t.vxM(n.round()>0?8:-1),t.R7$(),t.vxM(n.totalRounds()>0?9:-1),t.R7$(),t.vxM(n.gameManager.game.scenario?10:-1),t.R7$(9),t.vxM(n.settingsManager.settings.scenarioRules?19:-1),t.R7$(3),t.vxM(n.hasAllyAttackModifierDeck?22:-1),t.R7$(),t.vxM(n.settingsManager.settings.monsterAttackModifierDeck?23:-1),t.R7$(),t.vxM(n.settingsManager.settings.lootDeck&&(n.lootDeckEnabeld||n.settingsManager.settings.alwaysLootDeck||n.gameManager.fhRules())?24:-1),t.R7$(),t.vxM(n.settingsManager.settings.fhChallenges&&n.gameManager.challengesManager.enabled?25:-1))},dependencies:[N.YU,yn,Ws,tt,GG,Sa,_9,C9],styles:['footer[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 11 * var(--ghs-text-factor) * var(--ghs-barsize));display:flex;position:relative}footer[_ngcontent-%COMP%]   .flex-shrink[_ngcontent-%COMP%]{flex-basis:100%;flex-shrink:1}footer[_ngcontent-%COMP%]   .attack-modifier-spacer[_ngcontent-%COMP%]{height:100%;width:calc(var(--ghs-unit) * 38 * var(--ghs-text-factor) * var(--ghs-barsize));flex-shrink:0}footer[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]{transition:transform calc(var(--ghs-animation-speed) * .5s) ease-in-out}footer[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor) * var(--ghs-barsize));left:calc(var(--ghs-unit) * -2.5 * var(--ghs-text-factor) * var(--ghs-barsize));bottom:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor) * var(--ghs-barsize));right:calc(var(--ghs-unit) * -5 * var(--ghs-text-factor) * var(--ghs-barsize));border:calc(var(--ghs-unit) * .3 * var(--ghs-text-factor) * var(--ghs-barsize)) solid var(--ghs-color-gray);background-color:var(--ghs-color-darkgray);border-radius:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor) * var(--ghs-barsize))}footer[_ngcontent-%COMP%]   .deck.initial[_ngcontent-%COMP%]{transform:translate(59%)}footer[_ngcontent-%COMP%]   .deck.partial[_ngcontent-%COMP%]{transform:translate(17%)}footer[_ngcontent-%COMP%]   .deck.full[_ngcontent-%COMP%]{transform:none}footer[_ngcontent-%COMP%]   .deck.collapsed[_ngcontent-%COMP%]{transform:translate(100%)}footer[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]{cursor:pointer;position:absolute;left:calc(var(--ghs-unit) * -5 * var(--ghs-text-factor) * var(--ghs-barsize));top:50%;width:13%;height:50%;z-index:1;transition:transform calc(var(--ghs-animation-speed) * .5s) ease-in-out;transform:translateY(-50%) scale(1)}footer[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   .active-toggle.inactive[_ngcontent-%COMP%]{transform:translateY(-50%) scale(1.3)}footer[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]:hover{filter:brightness(.7) grayscale(.3)}footer[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]:active, footer[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]:focus{filter:none}footer[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]   .numeration[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);display:flex;justify-content:center;position:absolute;color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor) * var(--ghs-barsize));line-height:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor) * var(--ghs-barsize));width:100%;height:100%;background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-character-icon.83c1ab396221d56b.png)}footer[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]   .numeration[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:60%;width:auto;align-self:center}footer[_ngcontent-%COMP%]   .ally-deck[_ngcontent-%COMP%]{position:fixed;right:0;width:calc(var(--ghs-unit) * 37.5 * var(--ghs-text-factor) * var(--ghs-barsize));height:calc(var(--ghs-unit) * 10 * var(--ghs-text-factor) * var(--ghs-barsize));bottom:calc(var(--ghs-unit) * 15 * var(--ghs-text-factor) * var(--ghs-barsize));z-index:1}footer[_ngcontent-%COMP%]   .monster-deck[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .ally-deck.no-monster-deck[_ngcontent-%COMP%]{position:fixed;right:0;width:calc(var(--ghs-unit) * 37.5 * var(--ghs-text-factor) * var(--ghs-barsize));height:calc(var(--ghs-unit) * 10 * var(--ghs-text-factor) * var(--ghs-barsize));bottom:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor) * var(--ghs-barsize));z-index:2}footer[_ngcontent-%COMP%]   .loot-deck[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck[_ngcontent-%COMP%]{position:fixed;left:0;width:calc(var(--ghs-unit) * 37.5 * var(--ghs-text-factor) * var(--ghs-barsize));height:calc(var(--ghs-unit) * 10 * var(--ghs-text-factor) * var(--ghs-barsize));bottom:calc(var(--ghs-unit) * 12.5 * var(--ghs-text-factor) * var(--ghs-barsize));z-index:2}footer[_ngcontent-%COMP%]   .loot-deck[_ngcontent-%COMP%]:before, footer[_ngcontent-%COMP%]   .challenge-deck[_ngcontent-%COMP%]:before{right:calc(var(--ghs-unit) * -2.5 * var(--ghs-text-factor) * var(--ghs-barsize));left:calc(var(--ghs-unit) * -5 * var(--ghs-text-factor) * var(--ghs-barsize))}footer[_ngcontent-%COMP%]   .loot-deck.initial[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck.initial[_ngcontent-%COMP%]{transform:translate(-59%)}footer[_ngcontent-%COMP%]   .loot-deck.partial[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck.partial[_ngcontent-%COMP%]{transform:translate(-17%)}footer[_ngcontent-%COMP%]   .loot-deck.full[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck.full[_ngcontent-%COMP%]{transform:none}footer[_ngcontent-%COMP%]   .loot-deck.collapsed[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck.collapsed[_ngcontent-%COMP%]{transform:translate(-100%)}footer[_ngcontent-%COMP%]   .loot-deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]{left:initial;right:calc(var(--ghs-unit) * -5 * var(--ghs-text-factor) * var(--ghs-barsize))}footer[_ngcontent-%COMP%]   .loot-deck.challenge-deck[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck.challenge-deck[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 50 * var(--ghs-text-factor) * var(--ghs-barsize));bottom:calc(var(--ghs-unit) * 36.5 * var(--ghs-text-factor) * var(--ghs-barsize))}footer[_ngcontent-%COMP%]   .loot-deck.challenge-deck.initial[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck.challenge-deck.initial[_ngcontent-%COMP%]{transform:translate(-69.5%)}footer[_ngcontent-%COMP%]   .loot-deck.challenge-deck.partial[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck.challenge-deck.partial[_ngcontent-%COMP%]{transform:translate(-37.5%)}footer[_ngcontent-%COMP%]   .loot-deck.challenge-deck.partial-2[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck.challenge-deck.partial-2[_ngcontent-%COMP%]{transform:translate(-17%)}footer[_ngcontent-%COMP%]   .loot-deck.challenge-deck.full[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck.challenge-deck.full[_ngcontent-%COMP%]{transform:none}footer[_ngcontent-%COMP%]   .loot-deck.challenge-deck.collapsed[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck.challenge-deck.collapsed[_ngcontent-%COMP%]{transform:translate(-100%)}footer[_ngcontent-%COMP%]   .loot-deck.challenge-deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .challenge-deck.challenge-deck[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]{width:10%;height:50%}footer[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   ghs-loot-deck[_ngcontent-%COMP%]{position:relative;z-index:2}footer[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:0;left:0;width:100%;height:100%;background-image:url(bar.e331a4ef847b1c19.jpg);background-size:100% 105%;background-position:bottom right;background-repeat:no-repeat;transform:scale(-1);z-index:-1}footer.fh[_ngcontent-%COMP%]:before{background-image:url(bar.56898105bfacea25.jpg)}footer.modern[_ngcontent-%COMP%]:before{background-image:url(dialog_background_modern.c233015926c13e5e.png)}footer.bb[_ngcontent-%COMP%]:before{background-image:url(bar.aaa276b0e222bb54.jpg)}footer.modern[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:0;left:0;width:100%;height:4%;background:linear-gradient(90deg,var(--ghs-color-darkgray) 0%,var(--ghs-color-white) 35%,var(--ghs-color-white) 65%,var(--ghs-color-darkgray) 100%);opacity:.2}footer[_ngcontent-%COMP%]   .round-container[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;align-items:center;justify-content:center;width:calc(var(--ghs-unit) * 15 * var(--ghs-text-factor) * var(--ghs-barsize));word-wrap:break-word;text-align:center}footer[_ngcontent-%COMP%]   .round-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor) * var(--ghs-barsize));line-height:calc(var(--ghs-unit) * 3.4 * var(--ghs-text-factor) * var(--ghs-barsize));display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 11 * var(--ghs-text-factor) * var(--ghs-barsize));width:calc(var(--ghs-unit) * 12 * var(--ghs-text-factor) * var(--ghs-barsize))}footer[_ngcontent-%COMP%]   .round-container[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);position:absolute;font-size:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor) * var(--ghs-barsize));left:50%;transform:translate(-50%);bottom:calc(var(--ghs-unit) * .2 * var(--ghs-text-factor) * var(--ghs-barsize))}footer[_ngcontent-%COMP%]   .round-container[_ngcontent-%COMP%]   .round[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);position:absolute;font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor) * var(--ghs-barsize));left:calc(var(--ghs-unit) * 12 * var(--ghs-text-factor) * var(--ghs-barsize));bottom:0}footer[_ngcontent-%COMP%]   .round-container[_ngcontent-%COMP%]   .round[_ngcontent-%COMP%]   .total-rounds[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor) * var(--ghs-barsize))}footer[_ngcontent-%COMP%]   .round-container[_ngcontent-%COMP%]:hover   a[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   .round-container[_ngcontent-%COMP%]:hover   .round[_ngcontent-%COMP%]{color:var(--ghs-color-white)}footer[_ngcontent-%COMP%]   .round-container.disabled[_ngcontent-%COMP%]{cursor:help}footer[_ngcontent-%COMP%]   ghs-scenario-rules[_ngcontent-%COMP%]{position:absolute;left:50%;bottom:calc(var(--ghs-unit) * 11 * var(--ghs-text-factor) * var(--ghs-barsize));transform:translate(-50%);z-index:3}footer[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;flex-shrink:0;max-width:calc(100% - var(--ghs-unit) * 15 * var(--ghs-text-factor) * var(--ghs-barsize) - var(--ghs-unit) * 38 * var(--ghs-text-factor) * var(--ghs-barsize))}footer[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   ghs-scenario[_ngcontent-%COMP%]{height:100%}footer[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]   ghs-level[_ngcontent-%COMP%]{height:100%;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor) * var(--ghs-barsize));margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor) * var(--ghs-barsize))}footer.compact[_ngcontent-%COMP%]   .attack-modifier-spacer[_ngcontent-%COMP%]{display:none}footer.compact[_ngcontent-%COMP%]   .ally-deck[_ngcontent-%COMP%]{bottom:calc(var(--ghs-unit) * 26 * var(--ghs-text-factor) * var(--ghs-barsize))}footer.compact[_ngcontent-%COMP%]   .monster-deck[_ngcontent-%COMP%], footer.compact[_ngcontent-%COMP%]   .ally-deck.no-monster-deck[_ngcontent-%COMP%]{bottom:calc(var(--ghs-unit) * 12.5 * var(--ghs-text-factor) * var(--ghs-barsize))}footer.compact[_ngcontent-%COMP%]   ghs-scenario-rules[_ngcontent-%COMP%]{width:100%}footer.compact[_ngcontent-%COMP%]   .level-container[_ngcontent-%COMP%]{--ghs-text-factor: 1.6;max-width:initial;flex-grow:1;max-width:calc(100% - var(--ghs-unit) * 12.5 * var(--ghs-text-factor) * var(--ghs-barsize))}footer.compact[_ngcontent-%COMP%]   .flex-shrink[_ngcontent-%COMP%]{flex-basis:0}']})}return i})();const qr=i=>({"has-more":i}),Hr=i=>[i],B9=(i,r)=>[i,r];function Y9(i,r){if(1&i&&(t.j41(0,"div",6),t.nrm(1,"span",9),t.nI1(2,"ghsDurationLabel"),t.k0s()),2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(5,qr,e.gameClock.length>1)),t.R7$(),t.Y8G("ghs-label","duration.gameClock.current")("ghs-label-args",t.eq3(7,Hr,t.bMT(2,3,e.current)))}}function N9(i,r){if(1&i&&(t.j41(0,"div",6),t.nrm(1,"span",9),t.nI1(2,"ghsDurationLabel"),t.k0s()),2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(5,qr,e.gameClock.length>1)),t.R7$(),t.Y8G("ghs-label","duration.gameClock.total")("ghs-label-args",t.eq3(7,Hr,t.bMT(2,3,e.total)))}}function z9(i,r){if(1&i&&(t.nrm(0,"span",9),t.nI1(1,"date"),t.nI1(2,"ghsDurationLabel")),2&i){const e=t.XpG().$implicit,a=t.XpG();t.Y8G("ghs-label","duration.gameClock.timestamp")("ghs-label-args",t.l_i(9,B9,t.ii3(1,2,e.clockIn,"short",a.timeZone,a.settingsManager.settings.locale)||"",t.bMT(2,7,(e.clockOut-e.clockIn)/1e3)))}}function L9(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",10),t.bIt("doubleClick",function(){const n=t.eBV(e).$index,o=t.XpG();return t.Njj(o.merge(n))}),t.nVh(1,z9,3,12,"span",9),t.k0s()}if(2&i){const e=r.$implicit;t.R7$(),t.vxM(e.clockOut?1:-1)}}function U9(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",11),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.more())}),t.k0s()}2&i&&t.Y8G("ghs-label","duration.gameClock.more")}let q9=(()=>{class i{gameManager=s.E;settingsManager=m.f;timeZone=Intl.DateTimeFormat().resolvedOptions().timeZone;gameClock=[];current;total=0;currentIntervall;constructor(){this.more()}ngOnInit(){this.currentIntervall=setInterval(()=>this.update(),1e3)}update(){this.current=this.gameClock.length&&!this.gameClock[0].clockOut?((new Date).getTime()-this.gameClock[0].clockIn)/1e3:void 0,this.total=s.E.game.gameClock.length?s.E.game.gameClock.map(e=>((e.clockOut||(new Date).getTime())-e.clockIn)/1e3).reduce((e,a)=>e+a,0):0}ngOnDestroy(){this.currentIntervall&&clearInterval(this.currentIntervall)}more(){this.gameClock.length<s.E.game.gameClock.length&&(this.gameClock=s.E.game.gameClock.slice(0,this.gameClock.length+10)),this.update()}merge(e){e>0&&(s.E.stateManager.before("gameClock.merge"),s.E.game.gameClock[e-1].clockIn=s.E.game.gameClock[e].clockIn,s.E.game.gameClock.splice(e,1),this.gameClock=s.E.game.gameClock.slice(0,this.gameClock.length-1),this.update(),s.E.stateManager.after())}toggleGameClock(){s.E.stateManager.before("gameClock."+(this.current?"clockOut":"clockIn")),s.E.toggleGameClock(),this.gameClock=s.E.game.gameClock.slice(0,this.gameClock.length+(this.current?1:0)),this.update(),s.E.stateManager.after()}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-game-clock-dialog"]],standalone:!1,decls:11,vars:6,consts:[[1,"game-clock-dialog"],[1,"title",3,"ghs-label"],[1,"control",3,"click"],[1,"ghs-svg",3,"src"],[3,"ghs-label"],[1,"timestamps"],[1,"timestamp","current",3,"ngClass"],["ghs-pointer-input","",1,"timestamp"],[1,"more",3,"ghs-label"],[3,"ghs-label","ghs-label-args"],["ghs-pointer-input","",1,"timestamp",3,"doubleClick"],[1,"more",3,"click","ghs-label"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nrm(1,"div",1),t.j41(2,"div",2),t.bIt("click",function(){return n.toggleGameClock()}),t.nrm(3,"img",3)(4,"span",4),t.k0s(),t.j41(5,"div",5),t.nVh(6,Y9,3,9,"div",6),t.nVh(7,N9,3,9,"div",6),t.Z7z(8,L9,2,1,"div",7,t.fX1),t.nVh(10,U9,1,1,"span",8),t.k0s()()),2&a&&(t.R7$(),t.Y8G("ghs-label","duration.gameClock"),t.R7$(2),t.Y8G("src","./assets/images/"+(n.current?"clock-out":"clock-in")+".svg",t.B4B),t.R7$(),t.Y8G("ghs-label","duration.gameClock."+(n.current?"clockOut":"clockIn")),t.R7$(2),t.vxM(n.current?6:-1),t.R7$(),t.vxM(n.gameManager.game.gameClock.length>1?7:-1),t.R7$(),t.Dyx(n.gameClock),t.R7$(2),t.vxM(n.gameClock.length<n.gameManager.game.gameClock.length?10:-1))},dependencies:[N.YU,tt,rt,N.vh,ia],styles:[".game-clock-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column}.game-clock-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;justify-content:center;color:var(--ghs-color-gray);font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.game-clock-dialog[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor)) 0;border-bottom:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray)}.game-clock-dialog[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:auto;filter:var(--ghs-filter-white);margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.game-clock-dialog[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%]:hover{opacity:.7}.game-clock-dialog[_ngcontent-%COMP%]   .timestamps[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor));overflow:auto;color:var(--ghs-color-gray);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.game-clock-dialog[_ngcontent-%COMP%]   .timestamps[_ngcontent-%COMP%]   .timestamp[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) 0}.game-clock-dialog[_ngcontent-%COMP%]   .timestamps[_ngcontent-%COMP%]   .timestamp.current[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) 0;padding:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) 0;border-bottom:calc(var(--ghs-unit) * .2 * var(--ghs-dialog-factor)) solid transparent}.game-clock-dialog[_ngcontent-%COMP%]   .timestamps[_ngcontent-%COMP%]   .timestamp.current.has-more[_ngcontent-%COMP%]{border-color:var(--ghs-color-gray)}.game-clock-dialog[_ngcontent-%COMP%]   .timestamps[_ngcontent-%COMP%]   .more[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer;color:var(--ghs-color-gray)}"]})}return i})();const H9=i=>({consume:i});let K9=(()=>{class i{element;gameManager=s.E;settingsManager=m.f;GameState=T.mk;ElementState=yt.e_;toggleElement(e=!1){const a=s.E.nextElementState(this.element,e);s.E.stateManager.before("updateElement","game.element."+this.element.type,"game.element.state."+a),this.element.state=a,s.E.stateManager.after()}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-element"]],inputs:{element:"element"},standalone:!1,decls:3,vars:4,consts:[[1,"element",3,"ngClass"],[3,"element"],[3,"singleClick","doubleClick"]],template:function(a,n){1&a&&(t.j41(0,"span",0),t.nrm(1,"ghs-element-icon",1),t.j41(2,"ghs-pointer-input",2),t.bIt("singleClick",function(){return n.toggleElement()})("doubleClick",function(){return n.toggleElement(!0)}),t.k0s()()),2&a&&(t.Y8G("ngClass",t.eq3(2,H9,n.element.state==n.ElementState.consumed||n.element.state==n.ElementState.partlyConsumed)),t.R7$(),t.Y8G("element",n.element))},dependencies:[N.YU,Vr,rt],styles:["ghs-element .element{display:flex;justify-content:center;align-items:center;position:relative;width:calc(var(--ghs-unit) * 6.4 * var(--ghs-barsize));height:calc(var(--ghs-unit) * 6.4 * var(--ghs-barsize));margin:calc(var(--ghs-unit) * .5 * var(--ghs-barsize))}ghs-element .element:hover{width:calc(var(--ghs-unit) * 7.4 * var(--ghs-barsize));height:calc(var(--ghs-unit) * 7.4 * var(--ghs-barsize));margin:0}ghs-element .element ghs-pointer-input{position:absolute;top:0;left:0;width:100%;height:100%}ghs-element .element ghs-element-icon{position:absolute;top:0;left:0;width:100%;height:100%}ghs-element .element .element-svg #outline{display:none}ghs-element .element .element-svg #outline path,ghs-element .element .element-svg #symbol path{fill:var(--ghs-color-gray)!important}ghs-element .element .element-svg.dark #bg{fill:#203184!important}ghs-element .element:hover .element-svg #outline,ghs-element .element:hover .element-svg #symbol,ghs-element .element .element-svg.new #outline,ghs-element .element .element-svg.new #symbol,ghs-element .element .element-svg.full #outline,ghs-element .element .element-svg.full #symbol,ghs-element .element .element-svg.always #outline,ghs-element .element .element-svg.always #symbol,ghs-element .element .element-svg.half #outline,ghs-element .element .element-svg.half #symbol{display:inherit}ghs-element .element:hover .element-svg #outline path,ghs-element .element:hover .element-svg #symbol path,ghs-element .element .element-svg.new #outline path,ghs-element .element .element-svg.new #symbol path,ghs-element .element .element-svg.full #outline path,ghs-element .element .element-svg.full #symbol path,ghs-element .element .element-svg.always #outline path,ghs-element .element .element-svg.always #symbol path,ghs-element .element .element-svg.half #outline path,ghs-element .element .element-svg.half #symbol path{fill:var(--ghs-color-white)!important}ghs-element .element:hover .element-svg.new #outline path,ghs-element .element .element-svg.new.new #outline path,ghs-element .element .element-svg.full.new #outline path,ghs-element .element .element-svg.always.new #outline path,ghs-element .element .element-svg.half.new #outline path{fill:var(--ghs-color-gray)!important}ghs-element .element:hover .element-svg{opacity:1!important}ghs-element .element:hover .element-svg #bg{opacity:1!important}ghs-element .element:hover .element-svg.new #outline path{fill:var(--ghs-color-white)!important}ghs-element .element.consume:before{opacity:.3}ghs-element .element.consume.fh:before{left:55%;top:55%;width:50%;height:50%}\n"],encapsulation:2})}return i})(),W9=(()=>{class i{dialog;gameManager=s.E;constructor(e){this.dialog=e}open(){this.dialog.open(Ue,{panelClass:["dialog-invert"]})}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-party-sheet"]],standalone:!1,decls:2,vars:3,consts:[[1,"button",3,"click","ghs-label","ghs-label-attribute"],[3,"ghs-label"]],template:function(a,n){1&a&&(t.j41(0,"a",0),t.bIt("click",function(){return n.open()}),t.nrm(1,"span",1),t.k0s()),2&a&&(t.Y8G("ghs-label","party.sheet")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label",n.gameManager.game.party.name||"party.sheet"))},dependencies:[tt],styles:[".button[_ngcontent-%COMP%]{cursor:pointer;height:100%;display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-title);color:var(--ghs-color-gray);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-small-text-factor) * var(--ghs-barsize));text-shadow:var(--ghs-outline)}.button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}"]})}return i})();const J9=["mainMenuButton"],Z9=["partySheet"],ii=i=>({denied:i}),Q9=i=>({visible:i}),tN=(i,r)=>[i,r],eN=(i,r)=>r.type;function nN(i,r){if(1&i&&t.nrm(0,"img",6),2&i){const e=t.XpG(2);t.Y8G("ghs-tooltip",e.gameManager.stateManager.serverError)("ghs-label","server.error")("ghs-label-attribute","title")}}function iN(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",10),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openMenu(n.SubMenu.server))}),t.nrm(1,"img",11),t.k0s()}2&i&&(t.Y8G("ghs-label","server.connected")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","server.connected")("ghs-label-attribute","title"))}function aN(i,r){1&i&&t.nrm(0,"img",8),2&i&&t.Y8G("ghs-label","server.connecting")("ghs-label-attribute","title")}function oN(i,r){1&i&&t.nrm(0,"img",9),2&i&&t.Y8G("ghs-label","server.closing")("ghs-label-attribute","title")}function sN(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",10),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.settingsManager.settings.serverAutoconnect?n.gameManager.stateManager.connect():n.openMenu(n.SubMenu.server))}),t.nrm(1,"img",12)(2,"img",13),t.k0s()}2&i&&(t.Y8G("ghs-label","server.reconnected")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","server.closed")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","server.closed")("ghs-label-attribute","title"))}function rN(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",10),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.settingsManager.settings.serverAutoconnect?n.gameManager.stateManager.connect():n.openMenu(n.SubMenu.server))}),t.nrm(1,"img",14),t.k0s()}2&i&&(t.Y8G("ghs-label","server.reconnected")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","server.disconnected")("ghs-label-attribute","title"))}function cN(i,r){if(1&i&&(t.nVh(0,nN,1,3,"img",6),t.nVh(1,iN,2,4,"a",7)(2,aN,1,2,"img",8)(3,oN,1,2,"img",9)(4,sN,3,6,"a",7)(5,rN,2,4,"a",7)),2&i){let e;const a=t.XpG();t.vxM(a.gameManager.stateManager.serverError?0:-1),t.R7$(),t.vxM((e=a.gameManager.stateManager.wsState())===a.WebSocket.OPEN?1:e===a.WebSocket.CONNECTING?2:e===a.WebSocket.CLOSING?3:e===a.WebSocket.CLOSED?4:-1===e?5:-1)}}function lN(i,r){1&i&&t.nrm(0,"img",15)}function gN(i,r){1&i&&(t.j41(0,"span",16),t.EFF(1,"\xb0"),t.k0s())}function dN(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",26),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openMenu(n.SubMenu.character_add))}),t.nrm(1,"span",27),t.k0s()}if(2&i){const e=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(2,ii,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.characters))("ghs-label","hints.addCharacters")}}function hN(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",28)(1,"span",29),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openMenu(n.SubMenu.scenario))}),t.k0s()(),t.nrm(2,"span",25),t.j41(3,"a",28)(4,"span",29),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openMenu(n.SubMenu.monster_add))}),t.k0s()()}if(2&i){const e=t.XpG(3);t.Y8G("ngClass",t.eq3(5,ii,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.scenario)),t.R7$(),t.Y8G("ghs-label","hints.setScenario"),t.R7$(),t.Y8G("ghs-label","or"),t.R7$(),t.Y8G("ngClass",t.eq3(7,ii,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.monsters)),t.R7$(),t.Y8G("ghs-label","hints.addMonsters")}}function _N(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",26),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openMenu(n.SubMenu.monster_add))}),t.nrm(1,"span",27),t.k0s()}if(2&i){const e=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(2,ii,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.monsters))("ghs-label","hints.addMonsters")}}function mN(i,r){if(1&i&&t.nrm(0,"span",25),2&i){const e=t.XpG(3);t.Y8G("ghs-label","hints."+e.hintState)}}function pN(i,r){if(1&i&&(t.j41(0,"div",17),t.nVh(1,dN,2,4,"a",24)(2,hN,5,9)(3,_N,2,4,"a",24)(4,mN,1,1,"span",25),t.k0s()),2&i){let e;const a=t.XpG(2);t.Y8G("ngClass",t.eq3(2,Q9,a.init)),t.R7$(),t.vxM("characters"===(e=a.hintState)?1:"scenario"===e?2:"monsters"===e?3:4)}}function uN(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",30),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openEventEffects())}),t.nrm(1,"img",31),t.k0s()}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("src","./assets/images/event"+(e.gameManager.game.round>0||e.gameManager.game.state==e.GameState.next?"-effects":"")+".svg",t.B4B)}}function fN(i,r){1&i&&t.nrm(0,"ghs-party-sheet",null,1)}function CN(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",32),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openPets())}),t.nrm(1,"img",33),t.k0s()}}function MN(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",34),t.nI1(1,"ghsDurationLabel"),t.nI1(2,"ghsDurationLabel"),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openGameClockDialog())})("doubleClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.toggleGameClock())}),t.nrm(3,"img",31),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ghs-tooltip","duration.gameClock."+(e.lastGameClockTimestamp&&!e.lastGameClockTimestamp.clockOut?e.currentGameClock==e.overallGameClock?"running":"runningTotal":e.overallGameClock?"paused":"off"))("ghs-label-args",t.l_i(8,tN,e.overallGameClock?t.bMT(1,4,e.overallGameClock):"",e.currentGameClock?t.bMT(2,6,e.currentGameClock):""))("overlayX","center"),t.R7$(3),t.Y8G("src","./assets/images/"+(e.lastGameClockTimestamp&&!e.lastGameClockTimestamp.clockOut?"clock-out":"clock-in")+".svg",t.B4B)}}function vN(i,r){1&i&&t.nrm(0,"ghs-element",23),2&i&&t.Y8G("element",r.$implicit)}function ON(i,r){if(1&i&&(t.nVh(0,lN,1,0,"img",15),t.nVh(1,gN,2,0,"span",16),t.nVh(2,pN,5,4,"div",17),t.nrm(3,"span",18),t.nVh(4,uN,2,1,"div",19),t.nVh(5,fN,2,0,"ghs-party-sheet"),t.nVh(6,CN,2,0,"div",20),t.nVh(7,MN,4,11,"div",21),t.nrm(8,"span",18),t.j41(9,"div",22),t.Z7z(10,vN,1,1,"ghs-element",23,eN),t.k0s()),2&i){const e=t.XpG();t.vxM(e.syncing()?0:-1),t.R7$(),t.vxM(!e.syncing()&&-99!=e.gameManager.stateManager.wsState()&&e.gameManager.game.server?1:-1),t.R7$(),t.vxM(e.settingsManager.settings.hints?2:-1),t.R7$(2),t.vxM(!e.gameManager.bbRules()&&e.gameManager.game.scenario&&(e.gameManager.characterManager.characterCount(!0)>0||e.settingsManager.settings.partySheet)?4:-1),t.R7$(),t.vxM(!e.gameManager.bbRules()&&e.settingsManager.settings.partySheet?5:-1),t.R7$(),t.vxM(e.gameManager.buildingsManager.petsEnabled?6:-1),t.R7$(),t.vxM(e.settingsManager.settings.gameClock?7:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(8,ii,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.elements)),t.R7$(),t.Dyx(e.gameManager.game.elementBoard)}}let ge=(()=>{class i{dialog;overlay;standalone=!1;connection=!1;mainMenuButton;partySheet;gameManager=s.E;settingsManager=m.f;GameState=T.mk;WebSocket=WebSocket;SubMenu=we;menuState=we.main;elements=[yt.Hg.fire,yt.Hg.ice,yt.Hg.air,yt.Hg.earth,yt.Hg.light,yt.Hg.dark];init=!1;hintState="";lastGameClockTimestamp;overallGameClock=0;currentGameClock=0;gameClockInterval;constructor(e,a){this.dialog=e,this.overlay=a}ngOnInit(){setTimeout(()=>{this.init=!0},m.f.settings.animations?1500*m.f.settings.animationSpeed:0),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.hintStateValue()!=this.hintState&&(this.init=!1,setTimeout(()=>{this.hintState=this.hintStateValue(),this.init=!0},m.f.settings.animations?500*m.f.settings.animationSpeed:0)),this.updateClock()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe(),this.gameClockInterval&&clearInterval(this.gameClockInterval)}syncing(){return window.document.body.classList.contains("server-sync")}hintStateValue(){return s.E.game.playerCount<1&&s.E.game.figures.every(e=>!(e instanceof q.K||e instanceof P.R))?"characters":!s.E.game.scenario&&s.E.game.figures.every(e=>!(e instanceof P.R))?"scenario":s.E.game.figures.every(e=>!(e instanceof P.R))?"monsters":s.E.game.figures.every(e=>!(e instanceof P.R)||0==e.entities.length)?"addMonsterEntities":s.E.game.figures.some(e=>e.active)?s.E.game.round<3?"active-full":"active":s.E.game.state==T.mk.draw?s.E.game.figures.some(e=>e instanceof q.K&&!e.absent&&s.E.entityManager.isAlive(e)&&m.f.settings.initiativeRequired&&e.initiative<=0)?s.E.game.round<3?"draw-full":"draw-short":"draw":s.E.game.state==T.mk.next?"next":""}openMenu(e=void 0){this.dialog.open(So,{panelClass:["dialog"],data:{subMenu:e??we.main,standalone:this.standalone},maxWidth:"90vw",positionStrategy:this.overlay.position().flexibleConnectedTo(this.mainMenuButton).withPositions([new zt.uH({originX:"end",originY:"top"},{overlayX:"start",overlayY:"top"})]).withDefaultOffsetX(10)})}openEventEffects(){this.dialog.open(ni,{panelClass:["dialog"],data:{menu:s.E.game.round>0||s.E.game.state==T.mk.next}})}openPets(){this.dialog.open(Rr,{panelClass:["dialog"]})}updateClock(){this.lastGameClockTimestamp=s.E.game.gameClock.length?s.E.game.gameClock[0]:void 0,this.overallGameClock=s.E.game.gameClock.length?s.E.game.gameClock.map(e=>((e.clockOut||(new Date).getTime())-e.clockIn)/1e3).reduce((e,a)=>e+a,0):0,this.currentGameClock=this.lastGameClockTimestamp&&!this.lastGameClockTimestamp.clockOut?((new Date).getTime()-this.lastGameClockTimestamp.clockIn)/1e3:0,this.gameClockInterval||(this.gameClockInterval=setInterval(()=>{this.updateClock()},1e3))}openGameClockDialog(){this.dialog.open(q9,{panelClass:["dialog"]})}toggleGameClock(){s.E.stateManager.before("gameClock."+(this.lastGameClockTimestamp&&!this.lastGameClockTimestamp.clockOut?"clockOut":"clockIn")),s.E.toggleGameClock(),s.E.stateManager.after()}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG),t.rXU(zt.hJ))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-header"]],viewQuery:function(a,n){if(1&a&&(t.GBs(J9,5),t.GBs(Z9,5)),2&a){let o;t.mGM(o=t.lsd())&&(n.mainMenuButton=o.first),t.mGM(o=t.lsd())&&(n.partySheet=o.first)}},inputs:{standalone:"standalone",connection:"connection"},standalone:!1,decls:7,vars:5,consts:[["mainMenuButton",""],["partySheet",""],[3,"ngClass"],[1,"main-menu"],[1,"menu-button","active-outline",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/menu.svg",1,"ghs-svg"],["src","./assets/images/warning.svg",1,"ghs-svg","server-connection","closed",3,"ghs-tooltip","ghs-label","ghs-label-attribute"],[1,"server-connection-status",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/server-connection.svg",1,"ghs-svg","server-connection","connecting",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/server-connection.svg",1,"ghs-svg","server-connection","closing",3,"ghs-label","ghs-label-attribute"],[1,"server-connection-status",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/server-connection.svg",1,"ghs-svg","server-connection","connected",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/warning.svg",1,"ghs-svg","server-connection","closed",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/server-connection.svg",1,"ghs-svg","server-connection","closed",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/server-connection.svg",1,"ghs-svg","server-connection","disconnected",3,"ghs-label","ghs-label-attribute"],["src","./assets/images/shuffle.svg",1,"server-connection","syncing"],[1,"game-server"],[1,"hints",3,"ngClass"],[1,"spacer"],[1,"event-effects"],[1,"pets"],["ghs-pointer-input","",1,"game-clock",3,"ghs-tooltip","ghs-label-args","overlayX"],[1,"elements",3,"ngClass"],[3,"element"],[1,"menu-hint"],[3,"ghs-label"],[1,"menu-hint",3,"click"],[3,"ngClass","ghs-label"],[1,"menu-hint",3,"ngClass"],[3,"click","ghs-label"],[1,"event-effects",3,"click"],[1,"ghs-svg",3,"src"],[1,"pets",3,"click"],["src","./assets/images/fh/catching.svg",1,"ghs-svg"],["ghs-pointer-input","",1,"game-clock",3,"singleClick","doubleClick","ghs-tooltip","ghs-label-args","overlayX"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"header",2)(1,"div",3)(2,"a",4,0),t.bIt("click",function(){return t.eBV(o),t.Njj(n.openMenu())}),t.nrm(4,"img",5),t.k0s()(),t.nVh(5,cN,6,2),t.nVh(6,ON,12,10),t.k0s()}2&a&&(t.Y8G("ngClass",n.settingsManager.settings.theme),t.R7$(2),t.Y8G("ghs-label","menu.main")("ghs-label-attribute","title"),t.R7$(3),t.vxM(!n.standalone||n.connection?5:-1),t.R7$(),t.vxM(n.standalone?-1:6))},dependencies:[N.YU,K9,tt,ft,W9,rt,ia],styles:['header[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 8 * var(--ghs-text-factor) * var(--ghs-barsize));display:flex;position:relative;overflow:hidden}header[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:0;left:0;width:100%;height:100%;background-image:url(bar.e331a4ef847b1c19.jpg);background-size:100% 105%;background-position:bottom left;background-repeat:no-repeat;z-index:-1}header.fh[_ngcontent-%COMP%]:before{background-image:url(bar.56898105bfacea25.jpg)}header.modern[_ngcontent-%COMP%]:before{background-image:url(dialog_background_modern.c233015926c13e5e.png)}header.bb[_ngcontent-%COMP%]:before{background-image:url(bar.aaa276b0e222bb54.jpg)}header.modern[_ngcontent-%COMP%]:after{content:" ";position:absolute;bottom:0;left:0;width:100%;height:4%;background:linear-gradient(90deg,var(--ghs-color-darkgray) 0%,var(--ghs-color-white) 35%,var(--ghs-color-white) 65%,var(--ghs-color-darkgray) 100%);opacity:.2}header[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:relative;font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor) * var(--ghs-barsize));text-shadow:var(--ghs-outline);color:var(--ghs-color-gray);filter:var(--ghs-filter-gray);width:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor) * var(--ghs-barsize));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor) * var(--ghs-barsize));margin:calc(var(--ghs-unit) * 2.2 * var(--ghs-text-factor) * var(--ghs-barsize));cursor:pointer}header[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]:hover, header[_ngcontent-%COMP%]   .menu-button.active-button[_ngcontent-%COMP%]{color:var(--ghs-color-white);filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}header[_ngcontent-%COMP%]   a.server-connection-status[_ngcontent-%COMP%]{display:flex;cursor:pointer}header[_ngcontent-%COMP%]   .game-server[_ngcontent-%COMP%]{color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor) * var(--ghs-barsize));align-self:center;margin-top:calc(var(--ghs-unit) * -.75 * var(--ghs-text-factor) * var(--ghs-barsize));margin-left:calc(var(--ghs-unit) * -1.2 * var(--ghs-text-factor) * var(--ghs-barsize));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor) * var(--ghs-barsize))}header[_ngcontent-%COMP%]   .server-connection[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor) * var(--ghs-barsize));height:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor) * var(--ghs-barsize));margin-right:calc(var(--ghs-unit) * 1);align-self:center}header[_ngcontent-%COMP%]   .server-connection.connected[_ngcontent-%COMP%]{filter:var(--ghs-filter-green) var(--ghs-filter-shadow)}header[_ngcontent-%COMP%]   .server-connection.connecting[_ngcontent-%COMP%]{filter:var(--ghs-filter-blue) var(--ghs-filter-shadow)}header[_ngcontent-%COMP%]   .server-connection.closing[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow) var(--ghs-filter-shadow)}header[_ngcontent-%COMP%]   .server-connection.closed[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-shadow)}header[_ngcontent-%COMP%]   .server-connection.disconnected[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}header[_ngcontent-%COMP%]   .server-connection.syncing[_ngcontent-%COMP%]{filter:var(--ghs-filter-white);animation:ghs-spinning calc(var(--ghs-animation-speed) * 1.5s) linear infinite}header[_ngcontent-%COMP%]   .hints[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--ghs-color-gray);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-small-text-factor) * var(--ghs-barsize));opacity:0;transition:opacity calc(var(--ghs-animation-speed) * .5s) ease-in-out}header[_ngcontent-%COMP%]   .hints.visible[_ngcontent-%COMP%]{opacity:1}header[_ngcontent-%COMP%]   .hints[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor) * var(--ghs-barsize))}header[_ngcontent-%COMP%]   .hints[_ngcontent-%COMP%]   .menu-hint[_ngcontent-%COMP%]{cursor:pointer;font-family:var(--ghs-font-title);color:var(--ghs-color-gray);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-small-text-factor) * var(--ghs-barsize));text-shadow:var(--ghs-outline)}header[_ngcontent-%COMP%]   .hints[_ngcontent-%COMP%]   .menu-hint[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}@media (max-width: 600px),(orientation: portrait){header[_ngcontent-%COMP%]   .hints[_ngcontent-%COMP%]{flex-direction:column;justify-content:center}}header[_ngcontent-%COMP%]   .event-effects[_ngcontent-%COMP%], header[_ngcontent-%COMP%]   .pets[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;justify-content:center;height:100%;margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor) * var(--ghs-barsize))}header[_ngcontent-%COMP%]   .event-effects[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], header[_ngcontent-%COMP%]   .pets[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray);height:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor) * var(--ghs-barsize));width:auto}header[_ngcontent-%COMP%]   .event-effects[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%], header[_ngcontent-%COMP%]   .pets[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}header[_ngcontent-%COMP%]   .game-clock[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;height:100%;margin:0 calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor) * var(--ghs-barsize))}header[_ngcontent-%COMP%]   .game-clock[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray);height:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor) * var(--ghs-barsize));width:auto}header[_ngcontent-%COMP%]   .game-clock[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}header[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]{display:flex;height:100%;align-items:center}header[_ngcontent-%COMP%]   .elements[_ngcontent-%COMP%]   ghs-element[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * .25 * var(--ghs-barsize));width:calc(var(--ghs-unit) * 7.4 * var(--ghs-barsize));height:calc(var(--ghs-unit) * 7.4 * var(--ghs-barsize))}']})}return i})(),Vi=(()=>{class i{dialog;header;footer;allowed=["undo","zoom","menu"];scrollTimeout=null;zoomInterval=null;currentZoom=0;dialogOpen=!1;dialogClosing=!1;keydown;keyup;timeout;constructor(e){this.dialog=e,this.dialog.afterOpened.subscribe({next:()=>{this.dialogOpen=!0,this.dialogClosing=!1}}),this.dialog.afterAllClosed.subscribe({next:()=>{this.dialogClosing=!0,setTimeout(()=>{this.dialogClosing&&(this.dialogOpen=!1)},250)}})}applySelect(){const e=s.E.entityManager.getIndexedEntities("w"===s.E.stateManager.keyboardSelecting);s.E.stateManager.keyboardSelect>0&&s.E.stateManager.keyboardSelect<=e.length&&(this.dialog.open(Xn,{panelClass:["dialog"],data:{entity:e[s.E.stateManager.keyboardSelect-1].entity,figure:e[s.E.stateManager.keyboardSelect-1].figure,entityIndexKey:!0}}),s.E.stateManager.keyboardSelecting=!1),s.E.stateManager.keyboardSelect=-1}ngOnInit(){this.currentZoom=m.f.settings.zoom,this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.currentZoom=m.f.settings.zoom}),this.keydown=window.addEventListener("keydown",e=>{if(m.f.settings.keyboardShortcuts&&(0,V.bb)(e))if(s.E.stateManager.keyboardSelecting){if("Escape"===e.key||"s"===e.key||"w"===e.key)s.E.stateManager.keyboardSelect=-1,s.E.stateManager.keyboardSelecting=!1;else if("Enter"===e.key)this.applySelect();else if(e.key in["0","1","2","3","4","5","6","7","8","9"]){const a=s.E.entityManager.getIndexedEntities("w"===s.E.stateManager.keyboardSelecting),n=+e.key;this.timeout?(clearTimeout(this.timeout),this.timeout=void 0,s.E.stateManager.keyboardSelect=10*s.E.stateManager.keyboardSelect+n,this.applySelect()):10*n<a.length?(s.E.stateManager.keyboardSelect=n,this.timeout=setTimeout(()=>{this.applySelect()},1e3)):(s.E.stateManager.keyboardSelect=n,this.applySelect())}e.preventDefault(),e.stopPropagation()}else if(this.dialogOpen&&-1==this.allowed.indexOf("undo")||!e.ctrlKey||e.altKey||e.shiftKey||"z"!==e.key.toLowerCase())if((!this.dialogOpen||-1!=this.allowed.indexOf("undo"))&&e.ctrlKey&&!e.altKey&&!e.shiftKey&&"y"===e.key||e.ctrlKey&&e.shiftKey&&"z"===e.key.toLowerCase())s.E.stateManager.redo(),e.preventDefault();else if(this.dialogOpen&&-1==this.allowed.indexOf("zoom")||e.ctrlKey||e.altKey||e.shiftKey||this.zoomInterval||"ArrowUp"!==e.key&&"+"!==e.key)if(this.dialogOpen&&-1==this.allowed.indexOf("zoom")||e.ctrlKey||e.altKey||e.shiftKey||this.zoomInterval||"ArrowDown"!==e.key&&"-"!==e.key)if(this.dialogOpen&&-1==this.allowed.indexOf("zoom")||!e.ctrlKey||e.altKey||e.shiftKey||this.zoomInterval||"r"!==e.key.toLowerCase())if(this.dialogOpen&&-1==this.allowed.indexOf("round")||!this.footer||e.ctrlKey||e.altKey||e.shiftKey||this.zoomInterval||"n"!==e.key.toLowerCase())if(this.dialogOpen&&-1==this.allowed.indexOf("am")||e.ctrlKey||e.altKey||e.shiftKey||this.zoomInterval||s.E.game.state!=T.mk.next||"m"!==e.key.toLowerCase()&&(!m.f.settings.amAdvantage||"a"!==e.key.toLowerCase()&&"d"!==e.key.toLowerCase()))if(!(this.dialogOpen&&-1==this.allowed.indexOf("loot")||s.E.game.state!=T.mk.next||e.ctrlKey||e.altKey||e.shiftKey||this.zoomInterval||"l"!==e.key.toLowerCase())&&m.f.settings.lootDeck&&s.E.game.lootDeck.cards.length>0&&this.footer&&this.footer.lootDeck)this.footer.lootDeck.deck.active||this.footer.toggleLootDeck(),this.footer.lootDeck.draw(e,!0),e.preventDefault();else if(!this.dialogOpen&&!e.ctrlKey&&!e.altKey&&"Tab"===e.key&&s.E.game.figures.length>0){if(s.E.game.state==T.mk.next)this.toggleEntity(e.shiftKey);else{let a=!0;if(s.E.game.figures.filter(n=>n instanceof q.K&&!n.absent).forEach((n,o)=>{const g=document.getElementById("initiative-input-"+o);document.activeElement==g&&(a=!1)}),a){const n=document.getElementById("initiative-input-0");n&&n.focus()}e.stopPropagation()}e.preventDefault()}else if(this.dialogOpen&&-1==this.allowed.indexOf("level")||!this.footer||e.ctrlKey||e.altKey||e.shiftKey||"x"!==e.key.toLowerCase()||!this.footer.ghsLevel)if(this.dialogOpen&&-1==this.allowed.indexOf("scenario")||e.ctrlKey||e.altKey||e.shiftKey||"e"!==e.key.toLowerCase())if(this.dialogOpen&&-1==this.allowed.indexOf("scenario")||!this.footer||e.ctrlKey||e.altKey||e.shiftKey||"f"!==e.key.toLowerCase())if(this.dialogOpen&&-1==this.allowed.indexOf("scenario")||!this.footer||e.ctrlKey||e.altKey||!e.shiftKey||"f"!==e.key.toLowerCase()||!this.footer.ghsScenario||!s.E.game.scenario)if(this.dialogOpen&&-1==this.allowed.indexOf("party")||e.ctrlKey||e.altKey||e.shiftKey||"p"!==e.key.toLowerCase()||!m.f.settings.partySheet)if(this.dialogOpen&&-1==this.allowed.indexOf("map")||e.ctrlKey||e.altKey||e.shiftKey||"g"!==e.key.toLowerCase()||!s.E.game.edition)if(this.dialogOpen&&-1==this.allowed.indexOf("chart")||e.ctrlKey||e.altKey||e.shiftKey||"c"!==e.key.toLowerCase()||!s.E.game.edition)if(this.dialogOpen||e.ctrlKey||e.altKey||!this.header||"Escape"!==e.key)if(this.dialogOpen&&-1==this.allowed.indexOf("element")||e.ctrlKey||e.altKey||e.shiftKey||-1==["1","2","3","4","5","6"].indexOf(e.key))if(this.dialogOpen&&-1==this.allowed.indexOf("absent")||e.ctrlKey||e.altKey||e.shiftKey||"h"!==e.key)if(this.dialogOpen&&-1==this.allowed.indexOf("handSize")||e.ctrlKey||e.altKey||!e.shiftKey||"H"!==e.key)if(this.dialogOpen&&-1==this.allowed.indexOf("traits")||e.ctrlKey||e.altKey||e.shiftKey||"t"!==e.key)if(this.dialogOpen&&-1==this.allowed.indexOf("playerNumber")||e.ctrlKey||e.altKey||"#"!==e.key)if(this.dialogOpen&&-1==this.allowed.indexOf("damageHP")||e.ctrlKey||e.altKey||e.shiftKey||"i"!==e.key)if(this.dialogOpen&&-1==this.allowed.indexOf("select")||e.ctrlKey||e.altKey||e.shiftKey||"s"!==e.key&&"w"!==e.key)if(this.dialogOpen||e.ctrlKey||e.altKey||"?"!==e.key)if(this.dialogOpen||e.ctrlKey||!(e.altKey&&"x"===e.key||e.shiftKey&&"X"===e.key)){if(!this.dialogOpen&&!e.ctrlKey&&("l"===e.key||e.shiftKey&&"L"===e.key)){const a=s.E.game.figures.find(n=>n instanceof q.K&&n.active);if(a&&!s.E.fhRules())switch(e.key){case"l":s.E.stateManager.before("changeLoot",s.E.characterManager.characterName(a),(0,V.n1)(1)),a.loot+=1,s.E.stateManager.after();break;case"L":s.E.stateManager.before("changeLoot",s.E.characterManager.characterName(a),(0,V.n1)(-1)),a.loot-=1,a.loot<0&&(a.loot=0),s.E.stateManager.after()}}}else{const a=s.E.game.figures.find(n=>n instanceof q.K&&n.active);if(a)switch(e.key){case"x":s.E.stateManager.before("changeXP",s.E.characterManager.characterName(a),(0,V.n1)(1)),a.experience+=1,s.E.stateManager.after();break;case"X":s.E.stateManager.before("changeXP",s.E.characterManager.characterName(a),(0,V.n1)(-1)),a.experience-=1,a.experience<0&&(a.experience=0),s.E.stateManager.after()}}else this.dialog.open(yo,{panelClass:["dialog"]}),e.preventDefault();else s.E.stateManager.keyboardSelecting=e.key,s.E.uiChange.emit();else m.f.toggle("damageHP"),e.preventDefault();else m.f.toggle("playerNumber"),e.preventDefault();else m.f.toggle("characterTraits"),e.preventDefault();else m.f.toggle("characterHandSize"),e.preventDefault();else m.f.toggle("hideAbsent"),e.preventDefault();else{const n=s.E.game.elementBoard[+e.key-1],o=s.E.nextElementState(n,!1,!0);s.E.stateManager.before("updateElement","game.element."+n.type,"game.element.state."+o),n.state=o,s.E.stateManager.after(),e.preventDefault()}else this.header.openMenu(),e.stopPropagation(),e.preventDefault();else this.dialogOpen&&this.dialog.closeAll(),this.dialog.open(Qn,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:{edition:s.E.game.edition}}),e.stopPropagation(),e.preventDefault();else{const a=s.E.editionData.find(n=>n.edition==s.E.game.edition);a&&(a.worldMap||a.extendWorldMap)&&(this.dialogOpen&&this.dialog.closeAll(),this.dialog.open(Zn,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:s.E.game.edition}),e.stopPropagation(),e.preventDefault())}else this.dialog.open(Ue,{panelClass:["dialog-invert"],data:{partySheet:!0}}),e.stopPropagation(),e.preventDefault();else this.footer.ghsScenario.open();else m.f.toggle("fullscreen");else(m.f.settings.partySheet||s.E.characterManager.characterCount(!0)>0)&&(s.E.game.scenario&&this.header?this.header.openEventEffects():!s.E.game.scenario&&this.footer&&this.footer.ghsScenario&&this.footer.ghsScenario.open());else this.footer.ghsLevel.open();else{const a=s.E.game.figures.find(g=>g.active);let n;const o=m.f.settings.amAdvantage&&"a"===e.key.toLowerCase()?"advantage":m.f.settings.amAdvantage&&"d"===e.key.toLowerCase()?"disadvantage":void 0;if(!a||a instanceof P.R&&(!a.isAlly&&!a.isAllied||!s.E.fhRules()&&!m.f.settings.alwaysAllyAttackModifierDeck||!m.f.settings.allyAttackModifierDeck))s.E.stateManager.before("updateAttackModifierDeck.draw"+(o||""),"monster"),n=s.E.game.monsterAttackModifierDeck;else if(a instanceof P.R)s.E.stateManager.before("updateAttackModifierDeck.draw"+(o||""),"ally"),n=s.E.game.allyAttackModifierDeck;else if(a instanceof q.K)m.f.settings.characterAttackModifierDeck?a.attackModifierDeckVisible?(s.E.stateManager.before("updateAttackModifierDeck.draw"+(o||""),s.E.characterManager.characterName(a)),n=a.attackModifierDeck):a.attackModifierDeckVisible=!0:(s.E.stateManager.before("updateAttackModifierDeck.draw"+(o||""),"monster"),n=s.E.game.monsterAttackModifierDeck);else if(a instanceof mt.$e)if(a.amDeck&&"M"!=a.amDeck&&("A"!=a.amDeck||(s.E.fhRules()||m.f.settings.alwaysAllyAttackModifierDeck)&&m.f.settings.allyAttackModifierDeck)){if("A"==a.amDeck&&m.f.settings.allyAttackModifierDeck&&(s.E.fhRules()||m.f.settings.alwaysAllyAttackModifierDeck))s.E.stateManager.before("updateAttackModifierDeck.draw"+(o||""),"ally"),n=s.E.game.allyAttackModifierDeck;else if(a.amDeck){const g=s.E.game.figures.find(_=>_ instanceof q.K&&_.name==a.amDeck);g&&m.f.settings.characterAttackModifierDeck?g.attackModifierDeckVisible?(s.E.stateManager.before("updateAttackModifierDeck.draw"+(o||""),s.E.characterManager.characterName(g)),n=g.attackModifierDeck):g.attackModifierDeckVisible=!0:(s.E.stateManager.before("updateAttackModifierDeck.draw"+(o||""),"monster"),n=s.E.game.monsterAttackModifierDeck)}}else s.E.stateManager.before("updateAttackModifierDeck.draw"+(o||""),"monster"),n=s.E.game.monsterAttackModifierDeck;n&&(n.active=!0,s.E.attackModifierManager.drawModifier(n,o),s.E.stateManager.after()),e.preventDefault()}else this.footer.next();else this.currentZoom=100,m.f.setZoom(this.currentZoom),document.body.style.setProperty("--ghs-factor",this.currentZoom+""),e.preventDefault();else this.zoom(1),this.zoomInterval=setInterval(()=>{this.zoom(1)},30),e.preventDefault();else this.zoom(-1),this.zoomInterval=setInterval(()=>{this.zoom(-1)},30),e.preventDefault();else s.E.stateManager.undo(),e.preventDefault()}),this.keyup=window.addEventListener("keyup",e=>{m.f.settings.keyboardShortcuts&&(0,V.bb)(e)&&this.zoomInterval&&("ArrowUp"===e.key||"+"===e.key||"ArrowDown"===e.key||"-"===e.key)&&(clearInterval(this.zoomInterval),this.zoomInterval=null,m.f.settings.zoom!=this.currentZoom&&m.f.setZoom(this.currentZoom),e.preventDefault())})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe(),window.removeEventListener("keydown",this.keydown),window.removeEventListener("keyup",this.keyup)}zoom(e){this.currentZoom+=e,document.body.style.setProperty("--ghs-factor",this.currentZoom+"");const a=+window.getComputedStyle(document.body).getPropertyValue("min-width").replace("px","");e<0&&a>=window.innerWidth&&(this.currentZoom-=e,document.body.style.setProperty("--ghs-factor",this.currentZoom+""))}toggleEntity(e){const a=s.E.game.figures.filter(o=>s.E.gameplayFigure(o));let n=a.find(o=>o.active);if(!n&&e)n=a[a.length-1];else if(n&&e&&a.indexOf(n)>0)if(n instanceof q.K){const o=n.summons.filter(_=>s.E.entityManager.isAlive(_)&&_.state!=lt.N5.new);let g=o.find(_=>_.active);(!g||g&&0==o.indexOf(g))&&(n.summons.forEach(_=>_.active=!1),n=a[a.indexOf(n)-1])}else n=a[a.indexOf(n)-1];if(n)if(n instanceof q.K){const o=n.summons.find(_=>_.active),g=n.summons.filter(_=>-1!=_.tags.indexOf("cs-skull-spirit"));m.f.settings.activeSummons&&!o&&n.active&&g.length&&!g.find(_=>_.active)?(s.E.stateManager.before("summonInactive",s.E.characterManager.characterName(n),"data.summon."+g[0].name),g.forEach(_=>_.tags.push("cs-skull-spirit-turn"))):m.f.settings.activeSummons&&n.active&&o?s.E.stateManager.before("summonInactive",s.E.characterManager.characterName(n),"data.summon."+o.name):s.E.stateManager.before(n.active?"unsetActive":"setActive",s.E.characterManager.characterName(n)),s.E.roundManager.toggleFigure(n),s.E.stateManager.after()}else if(n instanceof P.R){let o=!0;const g=n.entities.filter(_=>s.E.entityManager.isAlive(_)&&_.summon!=lt.N5.new);if(m.f.settings.activeStandees){let _=g.find(y=>y.active);!_&&g.length>0&&e&&n.active?(_=g[g.length-1],s.E.stateManager.before(_?"unsetEntityActive":"setEntityActive","data.monster."+n.name,"monster."+_.type,""+_.number),s.E.monsterManager.toggleActive(n,_),_.active=!0,o=!1,s.E.stateManager.after()):_&&!e&&(s.E.stateManager.before(_?"unsetEntityActive":"setEntityActive","data.monster."+n.name,"monster."+_.type,""+_.number),s.E.monsterManager.toggleActive(n,_),g.indexOf(_)<g.length-1&&(g[g.indexOf(_)+1].active=!0),o=!1,s.E.stateManager.after())}o&&(s.E.stateManager.before(n.active?"unsetActive":"setActive","data.monster."+n.name),e&&!n.active&&m.f.settings.activeStandees&&n.entities.forEach(_=>{s.E.entityManager.isAlive(_)&&(_.active=!0,_.off=!1)}),s.E.roundManager.toggleFigure(n),s.E.stateManager.after())}else n instanceof mt.$e&&(s.E.stateManager.before(n.active?"unsetActive":"setActive",n.title||n.name),s.E.roundManager.toggleFigure(n),s.E.stateManager.after())}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG))};static \u0275dir=t.FsC({type:i,selectors:[["","ghs-keyboard-shortcuts",""]],inputs:{header:"header",footer:"footer",allowed:"allowed"},standalone:!1})}return i})();const PN=["menu"],bN=i=>({edit:i}),kN=i=>({denied:i}),yN=i=>({"has-deleted":i}),xN=(i,r,e)=>({"expanded-ability":i,"bottom-actions":r,drawn:e}),Kr=(i,r)=>({"expanded-ability":i,"bottom-actions":r}),Qa=(i,r)=>r.cardId;function EN(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",5),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.draw())}),t.nrm(1,"span",6),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","game.cards.drawAnother"))}function wN(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",5),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.restoreDefault())}),t.nrm(1,"span",6),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","game.cards.restore"))}function RN(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",5),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.defaultSort())}),t.nrm(1,"span",6),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","game.cards.defaultSort"))}function jN(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",8),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleDrawExtra())}),t.k0s(),t.nrm(2,"span",6),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("checked",e.monster.drawExtra),t.R7$(),t.Y8G("ghs-label","game.cards.drawExtra")}}function GN(i,r){1&i&&t.nrm(0,"div",13)}function TN(i,r){1&i&&t.nrm(0,"div",18)}function SN(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",20),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$index,o=t.XpG();return t.Njj(o.remove(n+o.monster.ability+1))}),t.nrm(1,"img",21),t.k0s()}}function $N(i,r){if(1&i&&(t.j41(0,"div",14),t.nrm(1,"ghs-ability",17),t.nVh(2,TN,1,0,"div",18),t.nVh(3,SN,2,0,"a",19),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG();t.Y8G("ngClass",t.sMw(7,xN,n.settingsManager.settings.showExpandedAbilityCard&&(2==n.reveal||e.revealed),n.gameManager.hasBottomAbility(e),a<n.gameManager.monsterManager.drawnAbilities(n.monster)-n.monster.ability-1)),t.R7$(),t.Y8G("ability",e)("monster",n.monster)("flipped",2==n.reveal||a<n.gameManager.monsterManager.drawnAbilities(n.monster)-n.monster.ability-1)("reveal",!0),t.R7$(),t.vxM(n.edit?2:-1),t.R7$(),t.vxM(n.edit?3:-1)}}function DN(i,r){1&i&&t.nrm(0,"div",18)}function IN(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",20),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$index,o=t.XpG();return t.Njj(o.remove(o.discardedCards.length-n-1))}),t.nrm(1,"img",21),t.k0s()}}function AN(i,r){if(1&i&&(t.j41(0,"div",14),t.nrm(1,"ghs-ability",22),t.nVh(2,DN,1,0,"div",18),t.nVh(3,IN,2,0,"a",19),t.k0s()),2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.l_i(6,Kr,a.settingsManager.settings.showExpandedAbilityCard,a.gameManager.hasBottomAbility(e))),t.R7$(),t.Y8G("ability",e)("monster",a.monster)("flipped",!0),t.R7$(),t.vxM(a.edit?2:-1),t.R7$(),t.vxM(a.edit?3:-1)}}function VN(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",25),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(2);return t.Njj(o.restore(n))}),t.nrm(1,"img",26),t.k0s()}}function FN(i,r){if(1&i&&(t.j41(0,"div",23),t.nrm(1,"ghs-ability",22),t.nVh(2,VN,2,0,"a",24),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ngClass",t.l_i(5,Kr,a.settingsManager.settings.showExpandedAbilityCard,a.gameManager.hasBottomAbility(e))),t.R7$(),t.Y8G("ability",e)("monster",a.monster)("flipped",!0),t.R7$(),t.vxM(a.edit?2:-1)}}function XN(i,r){if(1&i&&(t.j41(0,"div",16),t.Z7z(1,FN,3,8,"div",23,Qa),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.deletedCards)}}let BN=(()=>{class i{monster;dialogRef;menuElement;reveal=0;gameManager=s.E;settingsManager=m.f;GameState=T.mk;edit=!1;maxHeight="";bottomActions=!1;upcomingCards=[];discardedCards=[];deletedCards=[];constructor(e,a){this.monster=e,this.dialogRef=a}ngOnInit(){setTimeout(()=>{this.menuElement&&(this.maxHeight="calc(80vh - "+this.menuElement.nativeElement.offsetHeight+"px)")},m.f.settings.animations?250*m.f.settings.animationSpeed:0),this.bottomActions=s.E.monsterManager.hasBottomActions(this.monster),this.update(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.update()})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}toggleEdit(){this.edit=!this.edit,setTimeout(()=>{this.maxHeight="calc(80vh - "+this.menuElement.nativeElement.offsetHeight+"px)"},0)}update(){let e=this.monster.ability;this.upcomingCards=this.monster.abilities.filter((a,n)=>n>e).map(a=>s.E.abilities(this.monster)[a]),this.discardedCards=this.monster.abilities.filter((a,n)=>n<=e).map(a=>s.E.abilities(this.monster)[a]).reverse(),this.deletedCards=s.E.deckData(this.monster).abilities.filter((a,n)=>-1==this.monster.abilities.indexOf(n))}abilityIndex(e){return s.E.abilities(this.monster).indexOf(e)}shuffle(e=!1){s.E.stateManager.before("shuffleAbilityDeck"+(e?"Upcoming":""),"data.monster."+this.monster.name),s.E.monsterManager.shuffleAbilities(this.monster,e),s.E.sortFigures(),s.E.stateManager.after(),this.update()}draw(){s.E.stateManager.before("drawAbility","data.monster."+this.monster.name),s.E.monsterManager.drawAbility(this.monster),s.E.sortFigures(),s.E.stateManager.after(),this.update()}toggleDrawExtra(){this.monster.drawExtra?(s.E.stateManager.before("unsetDrawExtraAbility","data.monster."+this.monster.name),this.monster.drawExtra=!1,s.E.monsterManager.applySameDeck(this.monster),s.E.stateManager.after()):s.E.monsterManager.applySameDeck(this.monster)&&(s.E.stateManager.before("setDrawExtraAbility","data.monster."+this.monster.name),this.monster.drawExtra=!0,s.E.game.state==T.mk.next&&s.E.monsterManager.drawExtra(this.monster),s.E.sortFigures(),s.E.stateManager.after()),this.update()}dropUpcoming(e){if(s.E.stateManager.before("reorderAbilities","data.monster."+this.monster.name),e.container==e.previousContainer){const n=this.monster.ability+1;(0,D.HD)(this.monster.abilities,e.previousIndex+n,e.currentIndex+n)}else{const n=this.monster.ability;(0,D.HD)(this.monster.abilities,n-e.previousIndex,e.currentIndex+n),this.monster.ability=this.monster.ability-1}const a=s.E.monsterManager.getSameDeckMonster(this.monster);a&&s.E.monsterManager.applySameDeck(a),s.E.stateManager.after(),this.update()}dropDiscarded(e){if(s.E.stateManager.before("reorderAbilities","data.monster."+this.monster.name),e.container==e.previousContainer)(0,D.HD)(this.monster.abilities,this.monster.ability-e.previousIndex,this.monster.ability-e.currentIndex);else{this.monster.ability=this.monster.ability+1;const n=this.monster.ability;(0,D.HD)(this.monster.abilities,e.previousIndex+n,n-e.currentIndex)}const a=s.E.monsterManager.getSameDeckMonster(this.monster);a&&s.E.monsterManager.applySameDeck(a),s.E.sortFigures(),s.E.stateManager.after(),this.update()}restoreDefault(){s.E.stateManager.before("restoreDefaultAbilities","data.monster."+this.monster.name),s.E.monsterManager.restoreDefaultAbilities(this.monster),s.E.stateManager.after(),this.update()}remove(e){const a=s.E.abilities(this.monster)[this.monster.abilities[e]];s.E.stateManager.before("removeAbility","data.monster."+this.monster.name,a.name?this.abilityLabel(a):""+a.cardId),s.E.monsterManager.removeAbility(this.monster,e),s.E.stateManager.after(),this.update()}restore(e){s.E.stateManager.before("restoreAbility","data.monster."+this.monster.name,e.name?this.abilityLabel(e):""+e.cardId),s.E.monsterManager.restoreAbility(this.monster,e),s.E.stateManager.after(),this.update()}abilityLabel(e){let a="data.monster."+this.monster.name;return e&&e.name?a="data.ability."+e.name:this.monster.deck!=this.monster.name&&(a="data.deck."+this.monster.deck,a.split(".")[a.split(".").length-1]===Qe(m.f.getLabel(a))&&this.monster.deck&&(a="data.monster."+this.monster.deck)),Qe(m.f.getLabel(a))}defaultSort(){this.monster.abilities=this.monster.abilities.sort((e,a)=>e-a),this.update()}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-abilities-dialog"]],viewQuery:function(a,n){if(1&a&&t.GBs(PN,5),2&a){let o;t.mGM(o=t.lsd())&&(n.menuElement=o.first)}},standalone:!1,decls:28,vars:29,consts:[["menu",""],["upcomingList","cdkDropList"],["discardedList","cdkDropList"],[1,"abilities-dialog",3,"ngClass"],[1,"menu",3,"ngClass"],[3,"click"],[3,"ghs-label"],["ghs-pointer-input","",3,"singleClick","doubleClick","ghs-tooltip","overlayX"],["type","checkbox",3,"click","checked"],[1,"insert-menu"],[1,"scroll-container"],[1,"abilities-container",3,"ngClass"],["cdkDropList","",1,"upcoming","drop-list",3,"cdkDropListDropped","cdkDropListDisabled","cdkDropListConnectedTo","cdkDropListAutoScrollStep"],[1,"empty"],["cdkDrag","",1,"container","drag-hidden",3,"ngClass"],["cdkDropList","",1,"discarded","drop-list",3,"cdkDropListDropped","cdkDropListDisabled","cdkDropListConnectedTo","cdkDropListAutoScrollStep"],[1,"deleted","drop-list"],[3,"ability","monster","flipped","reveal"],["cdkDragHandle","",1,"drag-handle"],[1,"button-remove"],[1,"button-remove",3,"click"],["src","./assets/images/minus.svg",1,"ghs-svg"],[3,"ability","monster","flipped"],[1,"container",3,"ngClass"],[1,"button-restore"],[1,"button-restore",3,"click"],["src","./assets/images/plus.svg",1,"ghs-svg"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",3)(1,"div",4,0)(3,"a",5),t.bIt("click",function(){return t.eBV(o),t.Njj(n.reveal=(n.reveal+1)%3)}),t.nrm(4,"span",6),t.k0s(),t.j41(5,"a",7),t.bIt("singleClick",function(){return t.eBV(o),t.Njj(n.shuffle())})("doubleClick",function(){return t.eBV(o),t.Njj(n.shuffle(!0))}),t.nrm(6,"span",6),t.k0s(),t.j41(7,"label")(8,"input",8),t.bIt("click",function(){return t.eBV(o),t.Njj(n.toggleEdit())}),t.k0s(),t.nrm(9,"span",6),t.k0s(),t.j41(10,"div",9),t.nVh(11,EN,2,1,"a"),t.nVh(12,wN,2,1,"a"),t.nVh(13,RN,2,1,"a"),t.nVh(14,jN,3,2,"label"),t.k0s()(),t.j41(15,"div",10)(16,"div",11)(17,"div",12,1),t.bIt("cdkDropListDropped",function(_){return t.eBV(o),t.Njj(n.dropUpcoming(_))}),t.nVh(19,GN,1,0,"div",13),t.Z7z(20,$N,4,11,"div",14,Qa),t.k0s(),t.j41(22,"div",15,2),t.bIt("cdkDropListDropped",function(_){return t.eBV(o),t.Njj(n.dropDiscarded(_))}),t.nrm(24,"div",13),t.Z7z(25,AN,4,9,"div",14,Qa),t.k0s(),t.nVh(27,XN,3,0,"div",16),t.k0s()()()}if(2&a){const o=t.sdS(18),g=t.sdS(23);t.Y8G("ngClass",t.eq3(23,bN,n.edit)),t.R7$(),t.Y8G("ngClass",t.eq3(25,kN,n.monster&&n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.monsterPermissions[n.monster.name+"|"+n.monster.edition])),t.R7$(3),t.Y8G("ghs-label",2==n.reveal?"game.cards.coverAll":0==n.reveal?"game.cards.revealAll":"game.cards.revealAllConfirm"),t.R7$(),t.Y8G("ghs-tooltip","game.cards.shuffle.upcomingHint")("overlayX","center"),t.R7$(),t.Y8G("ghs-label","game.cards.shuffle"),t.R7$(2),t.Y8G("checked",n.edit),t.R7$(),t.Y8G("ghs-label","game.cards.edit"),t.R7$(2),t.vxM(n.edit||n.bottomActions?11:-1),t.R7$(),t.vxM(n.edit?12:-1),t.R7$(),t.vxM(n.edit?13:-1),t.R7$(),t.vxM(n.gameManager.monsterManager.getSameDeckMonster(n.monster)?14:-1),t.R7$(2),t.xc7("max-height",n.maxHeight),t.Y8G("ngClass",t.eq3(27,yN,n.edit&&n.deletedCards.length)),t.R7$(),t.Y8G("cdkDropListDisabled",!n.edit)("cdkDropListConnectedTo",g)("cdkDropListAutoScrollStep",20),t.R7$(2),t.vxM(0==n.upcomingCards.length?19:-1),t.R7$(),t.Dyx(n.upcomingCards),t.R7$(2),t.Y8G("cdkDropListDisabled",!n.edit)("cdkDropListConnectedTo",o)("cdkDropListAutoScrollStep",20),t.R7$(3),t.Dyx(n.discardedCards),t.R7$(2),t.vxM(n.edit&&n.deletedCards.length?27:-1)}},dependencies:[N.YU,D.O7,D.T1,D.Fb,en,tt,ft,rt],styles:['.abilities-dialog[_ngcontent-%COMP%]{position:relative}.abilities-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;flex-wrap:wrap}.abilities-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline)}.abilities-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .abilities-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.abilities-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{cursor:pointer;appearance:none;background-color:var(--form-background);width:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));border-width:calc(var(--ghs-unit) * .3);border-style:solid;display:grid;place-content:center;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));color:var(--ghs-color-gray)}.abilities-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before{left:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));top:calc(var(--ghs-unit) * -.5 * var(--ghs-text-factor));position:relative;content:" ";width:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));transform:scale(0);transform-origin:bottom left;transition:transform calc(var(--ghs-animation-speed) * .12s) ease-in-out;clip-path:polygon(14% 44%,0 65%,50% 100%,100% 16%,80% 0%,43% 62%);color:var(--ghs-color-gray);background-color:var(--ghs-color-gray)}.abilities-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked:before{transform:scale(1)}.abilities-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover:before{background-color:var(--ghs-color-white)}.abilities-dialog[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .insert-menu[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-evenly;flex-basis:100%;flex-shrink:0}.abilities-dialog[_ngcontent-%COMP%]   .drop-list[_ngcontent-%COMP%]{position:relative}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]{display:flex;margin:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 80 * var(--ghs-text-factor));max-height:80vh}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;padding:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 40 * var(--ghs-text-factor))}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 37 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 23.7 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));flex-shrink:0;flex-grow:0}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container.expanded-ability[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container.expanded-ability[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container.expanded-ability[_ngcontent-%COMP%]{height:auto;min-height:calc(var(--ghs-unit) * 23.7 * var(--ghs-text-factor))}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container.drawn[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container.drawn[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container.drawn[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{opacity:.5}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container.bottom-actions[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container.bottom-actions[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container.bottom-actions[_ngcontent-%COMP%]{min-height:initial;height:calc(var(--ghs-unit) * 49.95 * var(--ghs-text-factor))}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{display:block;width:100%;height:100%}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{position:absolute;cursor:grab;left:50%;top:50%;width:50%;height:70%;transform:translate(-50%,-50%)}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]{z-index:1;position:absolute;display:flex;cursor:pointer;top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-filter-white) var(--ghs-filter-shadow)}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) var(--ghs-filter-shadow)}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-remove.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .button-restore.button-restore[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-green) var(--ghs-filter-shadow)}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming.deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded.deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted.deleted[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{opacity:.5}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .upcoming[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .discarded[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%], .abilities-dialog[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * .9 * var(--ghs-text-factor));display:block;margin:calc(var(--ghs-unit) * .7 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 36.6 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 23.3 * var(--ghs-text-factor));border-radius:calc(var(--ghs-unit) * 1);border-style:dashed;border-width:calc(var(--ghs-unit) * .2);border-color:var(--ghs-color-white)}.abilities-dialog[_ngcontent-%COMP%]   .abilities-container.has-deleted[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 120 * var(--ghs-text-factor))}.abilities-dialog[_ngcontent-%COMP%]   .cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.5}.abilities-dialog[_ngcontent-%COMP%]   .cdk-drag-animating[_ngcontent-%COMP%]{transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}.abilities-dialog[_ngcontent-%COMP%]   .cdk-drop-list-dragging[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}']})}return i})();const YN=(i,r,e,a,n,o,g,_)=>({flipped:i,"full-ability":r,"expanded-ability":e,"bottom-actions":a,"second-ability":n,fh:o,disabled:g,denied:_});function NN(i,r){1&i&&t.nrm(0,"div",1)}function zN(i,r){1&i&&t.nrm(0,"div",2)}function LN(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-ability",3),t.bIt("singleClick",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.openAbilities(n))})("doubleClick",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.openAbility(n))}),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ability",e.secondAbility)("monster",e.monster)("flipped",e.flipped)("activeActions",!!e.monster.firstActiveAction&&("bottom"==e.monster.firstActiveAction?"top":"bottom"))("interactiveAbilities",e.settingsManager.settings.interactiveAbilities)}}function UN(i,r){if(1&i&&(t.j41(0,"span",5),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Lme(" ",e.monster.abilities.length-e.drawnAbilities,"/",e.monster.abilities.length,"\n")}}let qN=(()=>{class i{dialog;monster;index=-1;ability=void 0;secondAbility=void 0;gameManager=s.E;settingsManager=m.f;flipped=!1;hasBottomActions=!1;drawnAbilities=0;constructor(e){this.dialog=e}ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.hasBottomActions=s.E.monsterManager.hasBottomActions(this.monster),this.drawnAbilities=s.E.monsterManager.drawnAbilities(this.monster),this.flipped=this.calcFlipped()}calcFlipped(){if(!m.f.settings.abilities||s.E.game.state==T.mk.draw||(this.ability=-1==this.index?s.E.monsterManager.getAbility(this.monster):s.E.abilities(this.monster)[this.index],!this.ability))return!1;s.E.hasBottomAbility(this.ability)&&(this.ability=s.E.monsterManager.getAbility(this.monster,!0),this.secondAbility=s.E.monsterManager.getAbility(this.monster));let e=!s.E.roundManager.working&&s.E.game.state==T.mk.next&&s.E.gameplayFigure(this.monster),a=m.f.settings.abilityReveal||this.monster.active||this.monster.off&&(s.E.game.figures.some((n,o,g)=>n.active&&o>g.indexOf(this.monster))||s.E.game.figures.every(n=>!n.active));return s.E.game.state==T.mk.next&&a&&(e=e||s.E.game.state==T.mk.next&&this.monster.lastDraw==s.E.game.round),e&&a}openAbilities(e){m.f.settings.abilities&&(!e.srcEvent||!e.srcEvent.defaultPrevented)&&this.dialog.open(BN,{panelClass:["dialog"],data:this.monster})}openAbility(e){m.f.settings.abilities&&(this.flipped?this.dialog.open(Ca,{panelClass:["fullscreen-panel"],disableClose:!0,data:{monster:this.monster,interactive:m.f.settings.interactiveAbilities}}):this.openAbilities(e))}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-monster-ability-card"]],inputs:{monster:"monster",index:"index"},standalone:!1,decls:6,vars:19,consts:[[1,"container",3,"ngClass"],[1,"hover-effect","initiative"],[1,"hover-effect","title"],["ghs-pointer-input","",3,"singleClick","doubleClick","ability","monster","flipped","activeActions","interactiveAbilities"],["ghs-pointer-input","",3,"ability","monster","flipped","activeActions","interactiveAbilities"],[1,"left-abilities"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nVh(1,NN,1,0,"div",1),t.nVh(2,zN,1,0,"div",2),t.j41(3,"ghs-ability",3),t.bIt("singleClick",function(g){return n.openAbilities(g)})("doubleClick",function(g){return n.openAbility(g)}),t.k0s(),t.nVh(4,LN,1,5,"ghs-ability",4),t.k0s(),t.nVh(5,UN,2,2,"span",5)),2&a&&(t.Y8G("ngClass",t.lV(10,YN,n.flipped,n.settingsManager.settings.showFullAbilityCard||n.settingsManager.settings.showExpandedAbilityCard,n.settingsManager.settings.showExpandedAbilityCard&&n.flipped,n.hasBottomActions&&n.ability&&n.secondAbility,n.secondAbility,n.settingsManager.settings.fhStyle,!n.settingsManager.settings.abilities,n.monster&&n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.monsterPermissions[n.monster.name+"|"+n.monster.edition])),t.R7$(),t.vxM(n.secondAbility||n.settingsManager.settings.showFullAbilityCard||n.settingsManager.settings.showExpandedAbilityCard?-1:1),t.R7$(),t.vxM(n.secondAbility||n.settingsManager.settings.showFullAbilityCard||n.settingsManager.settings.showExpandedAbilityCard?-1:2),t.R7$(),t.Y8G("ability",n.ability)("monster",n.monster)("flipped",n.flipped)("activeActions",!!n.monster.firstActiveAction&&("bottom"==n.monster.firstActiveAction?"bottom":"top"))("interactiveAbilities",n.settingsManager.settings.interactiveAbilities),t.R7$(),t.vxM(n.secondAbility?4:-1),t.R7$(),t.vxM(n.settingsManager.settings.abilities?5:-1))},dependencies:[N.YU,en,rt],styles:['[_nghost-%COMP%]{position:relative}.container[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 40);height:calc(var(--ghs-unit) * 21.5);overflow:hidden;border-radius:calc(var(--ghs-unit) * 1);cursor:help}.container[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{display:inline-block;position:relative;top:calc(var(--ghs-unit) * -3);left:0;width:calc(var(--ghs-unit) * 40);height:calc(var(--ghs-unit) * 25.5);transition:top calc(var(--ghs-animation-speed) * .25s) ease-in-out;z-index:3}.container[_ngcontent-%COMP%]   ghs-pointer-input[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:2}.container.disabled[_ngcontent-%COMP%]{pointer-events:none}.container.flipped[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * -4)}.container.flipped.fh[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * -3.5)}.container.flipped[_ngcontent-%COMP%]   .hover-effect[_ngcontent-%COMP%]{content:" ";display:block;position:absolute;top:0;left:0;z-index:4}.container.flipped[_ngcontent-%COMP%]   .hover-effect.initiative[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 8.5);height:calc(var(--ghs-unit) * 5)}.container.flipped[_ngcontent-%COMP%]   .hover-effect.title[_ngcontent-%COMP%]{width:100%;height:calc(var(--ghs-unit) * 1.5)}.container.flipped[_ngcontent-%COMP%]   .hover-effect[_ngcontent-%COMP%]:hover.initiative{height:calc(var(--ghs-unit) * 9)}.container.flipped[_ngcontent-%COMP%]   .hover-effect[_ngcontent-%COMP%]:hover.title{height:calc(var(--ghs-unit) * 4)}.container.flipped[_ngcontent-%COMP%]   .hover-effect[_ngcontent-%COMP%]:hover ~ ghs-ability[_ngcontent-%COMP%]{top:0}.container.second-ability[_ngcontent-%COMP%]{display:flex}.container.second-ability[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{top:0;width:calc(var(--ghs-unit) * 20);height:calc(var(--ghs-unit) * 10.75)}.container.second-ability[_ngcontent-%COMP%]   ghs-pointer-input[_ngcontent-%COMP%]{position:absolute;inset:0 50% 0 0}.container.second-ability[_ngcontent-%COMP%]   ghs-pointer-input[_ngcontent-%COMP%]:nth-of-type(2){left:50%;right:0}.container.bottom-actions[_ngcontent-%COMP%]{overflow-y:auto}.container.bottom-actions[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{top:0;height:calc(var(--ghs-unit) * 54)}.container.bottom-actions.second-ability[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 27)}.container.full-ability[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 37);height:calc(var(--ghs-unit) * 24)}.container.full-ability[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{top:0;width:calc(var(--ghs-unit) * 37);height:calc(var(--ghs-unit) * 24)}.container.full-ability.fh[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{top:0}.container.full-ability.second-ability[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 18.5);height:calc(var(--ghs-unit) * 12)}.container.full-ability.bottom-actions[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 38.2)}.container.full-ability.bottom-actions.second-ability[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 25)}.container.expanded-ability[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 37);height:auto;min-height:calc(var(--ghs-unit) * 24)}.container.expanded-ability[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{top:0;width:calc(var(--ghs-unit) * 37);height:auto;min-height:calc(var(--ghs-unit) * 24)}.container.expanded-ability.fh[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{top:0}.container.expanded-ability.bottom-actions[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 38.2)}.container.expanded-ability.bottom-actions[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 38.2)}.container.expanded-ability.bottom-actions.second-ability[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 25)}.container.expanded-ability.second-ability[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 25)}.container.expanded-ability.second-ability[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 18.5);height:calc(var(--ghs-unit) * 12);min-height:initial}.left-abilities[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2);position:absolute;color:var(--ghs-color-gray);right:calc(var(--ghs-unit) * .5);bottom:calc(var(--ghs-unit) * 0);z-index:4}']})}return i})();const HN=(i,r,e)=>({disabled:i,"full-ability":r,modern:e}),KN=i=>({"active-border":i}),WN=(i,r)=>({"active-border":i,off:r});function JN(i,r){if(1&i&&t.nrm(0,"img",1),2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(2,KN,e.monster.active))("src",e.gameManager.monsterManager.monsterThumbnail(e.monster),t.B4B)}}function ZN(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.JRh(e[0])}}function QN(i,r){if(1&i&&(t.j41(0,"span",2)(1,"span",3),t.Z7z(2,ZN,2,1,"span",null,t.fX1),t.k0s(),t.j41(4,"span",4),t.nrm(5,"span",5),t.k0s()()),2&i){const e=t.XpG();t.Y8G("ngClass",t.l_i(2,WN,e.monster.active,e.monster.off)),t.R7$(2),t.Dyx(e.settingsManager.getLabel("data.monster."+e.monster.name).split(" ")),t.R7$(3),t.Y8G("ghs-label","data.monster."+e.monster.name)}}const tz=(i,r)=>({closed:i,opened:r});let ez=(()=>{class i{dialog;monster;gameManager=s.E;settingsManager=m.f;GameState=T.mk;constructor(e){this.dialog=e}toggleFigure(){s.E.game.state==T.mk.next&&s.E.monsterManager.monsterEntityCount(this.monster)?(s.E.stateManager.before(this.monster.active?"unsetActive":"setActive","data.monster."+this.monster.name),s.E.roundManager.toggleFigure(this.monster),s.E.stateManager.after()):this.imageDialog()}imageDialog(){m.f.settings.artwork&&(!this.monster.noArtwork||!this.monster.noThumbnail)&&this.dialog.open(nz,{data:this.monster})}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-monster-image"]],inputs:{monster:"monster"},standalone:!1,decls:3,vars:10,consts:[["ghs-pointer-input","",1,"image",3,"singleClick","doubleClick","onRelease","ngClass","ghs-label","ghs-label-attribute"],[3,"ngClass","src"],[1,"no-artwork",3,"ngClass"],[1,"letter"],[1,"name"],[3,"ghs-label"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.bIt("singleClick",function(){return n.toggleFigure()})("doubleClick",function(){return n.imageDialog()}),t.nVh(1,JN,1,4,"img",1),t.nVh(2,QN,6,5,"span",2),t.k0s()),2&a&&(t.Y8G("onRelease",!0)("ngClass",t.sMw(6,HN,n.gameManager.game.state==n.GameState.draw||0==n.monster.entities.length,n.settingsManager.settings.showFullAbilityCard,"modern"==n.settingsManager.settings.theme))("ghs-label",n.gameManager.game.state==n.GameState.next?n.monster.active?"game.figure.endTurn":"game.figure.startTurn":"")("ghs-label-attribute","title"),t.R7$(),t.vxM(!n.monster.noThumbnail&&n.settingsManager.settings.artwork?1:-1),t.R7$(),t.vxM(n.monster.noThumbnail||!n.settingsManager.settings.artwork?2:-1))},dependencies:[N.YU,tt,rt],styles:[".image[_ngcontent-%COMP%]{position:relative;display:flex;width:calc(var(--ghs-unit) * 16);height:calc(var(--ghs-unit) * 16);flex-direction:column;justify-content:center;align-items:center;text-align:center;cursor:pointer}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto;border-radius:100%;transition:box-shadow calc(var(--ghs-animation-speed) * .1s) ease-in-out}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:not(.active-border){box-shadow:0 0 calc(var(--ghs-unit) * .5) calc(var(--ghs-unit) * .1) var(--ghs-color-darkgray)}.image[_ngcontent-%COMP%]   .no-artwork[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;font-family:var(--ghs-font-title);width:100%;height:100%;border-radius:100%;transition:box-shadow calc(var(--ghs-animation-speed) * .1s) ease-in-out;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray);border-color:var(--ghs-character-color)}.image[_ngcontent-%COMP%]   .no-artwork.off[_ngcontent-%COMP%]{color:var(--ghs-color-gray)}.image[_ngcontent-%COMP%]   .no-artwork[_ngcontent-%COMP%]:not(.active-border){box-shadow:0 0 calc(var(--ghs-unit) * .5) calc(var(--ghs-unit) * .1) var(--ghs-color-darkgray)}.image[_ngcontent-%COMP%]   .no-artwork[_ngcontent-%COMP%]   .letter[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 6)}.image[_ngcontent-%COMP%]   .no-artwork[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * -1);font-size:calc(var(--ghs-unit) * 2)}.image.disabled[_ngcontent-%COMP%]{cursor:initial}.image.full-ability[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 17.5);height:calc(var(--ghs-unit) * 17.5)}.image.modern[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:not(.active-border){box-shadow:none}"]})}return i})(),nz=(()=>{class i{monster;dialogRef;gameManager=s.E;opened=!1;constructor(e,a){this.monster=e,this.dialogRef=a}ngOnInit(){this.opened=!0}close(){this.opened=!1,setTimeout(()=>{(0,V.co)(this.dialogRef)},400)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.Qs),t.rXU(v.ce))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-monster-image-dialog"]],standalone:!1,decls:3,vars:5,consts:[[1,"monster-image-dialog",3,"ngClass"],[3,"src"],[1,"close-container",3,"click"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nrm(1,"img",1),t.k0s(),t.j41(2,"div",2),t.bIt("click",function(){return n.close()}),t.k0s()),2&a&&(t.Y8G("ngClass",t.l_i(2,tz,!n.opened,n.opened)),t.R7$(),t.Y8G("src",n.gameManager.monsterManager.monsterArtwork(n.monster),t.B4B))},dependencies:[N.YU],styles:["[_nghost-%COMP%]{background-color:transparent;padding:0;margin:0;border:0}.monster-image-dialog[_ngcontent-%COMP%]{width:100vw;max-width:600px;height:100vw;max-height:600px;border-image:none;background:none;transition:transform calc(var(--ghs-animation-speed) * .25s) ease-in-out;transform:scale(0);display:flex;justify-content:center;align-items:center}.monster-image-dialog[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80%;height:auto;border-radius:2%;filter:var(--ghs-filter-shadow)}.monster-image-dialog.opened[_ngcontent-%COMP%]{transform:scale(1)}.monster-image-dialog.closed[_ngcontent-%COMP%]{transform:scale(0);transition-delay:.1s}.close-container[_ngcontent-%COMP%]{cursor:zoom-out;position:absolute;inset:0}"]})}return i})();const iz=i=>({disabled:i});function az(i,r){1&i&&t.nrm(0,"img",2)}function oz(i,r){1&i&&t.nrm(0,"img",3)}let sz=(()=>{class i{elementRef;dialog;overlay;monster;type;range=[];nonDead=0;count=0;settingsManager=m.f;maxStandees=0;usedStandees=0;constructor(e,a,n){this.elementRef=e,this.dialog=a,this.overlay=n}ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.maxStandees=s.E.monsterManager.monsterStandeeMax(this.monster),this.usedStandees=s.E.monsterManager.monsterStandeeCount(this.monster)}hasEntity(){return null!=this.monster.entities.find(e=>s.E.entityManager.isAlive(e)&&e.type==this.type)}open(){if(!m.f.settings.standees)return this.hasEntity()?this.monster.entities=this.monster.entities.filter(e=>e.type!=this.type):this.nextStandee(),void s.E.uiChange.emit();if(!(this.nonDead>=this.count))if(this.maxStandees==this.count&&this.nonDead==this.count-1&&this.monster.entities.every(e=>e.number>0))for(let e=0;e<this.count;e++)this.monster.entities.some(a=>s.E.entityManager.isAlive(a)&&a.number==e+1)||this.pickNumber(e+1);else m.f.settings.randomStandees?this.randomStandee():this.dialog.open(li,{panelClass:["dialog"],data:{monster:this.monster,type:this.type,range:this.range},positionStrategy:this.overlay.position().flexibleConnectedTo(this.elementRef).withPositions((0,V.yE)(this.type==S.N.elite?"left":"right"))})}randomStandee(){const e=s.E.monsterManager.monsterRandomStandee(this.monster);this.pickNumber(e,!0,!1)}nextStandee(){let e=1;for(;this.monster.entities.some(a=>a.number==e);)e+=1;this.pickNumber(e,!0,!0)}pickNumber(e,a=!1,n=!1){if(!s.E.monsterManager.monsterStandeeUsed(this.monster,e)&&this.type){let o="addStandee";a&&!n?o="addRandomStandee":a&&(o="addNextStandee"),s.E.stateManager.before(o,"data.monster."+this.monster.name,"monster."+this.type,""+e);const g=this.monster.entities.find(y=>y.number==e);g&&s.E.monsterManager.removeMonsterEntity(this.monster,g);const _=s.E.monsterManager.addMonsterEntity(this.monster,e,this.monster.bb&&-1!=this.monster.tags.indexOf("bb-elite")?S.N.elite:this.type,!1);s.E.game.state==T.mk.next&&_&&(this.monster.active=!s.E.game.figures.some(y=>y.active),this.monster.active&&(s.E.sortFigures(this.monster),_.active=!0)),s.E.stateManager.after()}}static \u0275fac=function(a){return new(a||i)(t.rXU(t.aKT),t.rXU(v.lG),t.rXU(zt.hJ))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-monster-numberpicker"]],inputs:{monster:"monster",type:"type",range:"range",nonDead:"nonDead",count:"count"},standalone:!1,decls:4,vars:10,consts:[["button",""],["ghs-pointer-input","",3,"singleClick","ngClass","ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg",1,"ghs-svg"],["src","./assets/images/minus.svg",1,"ghs-svg"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"a",1,0),t.bIt("singleClick",function(){return t.eBV(o),t.Njj(n.open())}),t.nVh(2,az,1,0,"img",2),t.nVh(3,oz,1,0,"img",3),t.k0s()}2&a&&(t.HbH(t.VkB("button active-outline ",n.type)),t.Y8G("ngClass",t.eq3(8,iz,n.settingsManager.settings.standees&&(n.nonDead>=n.count||n.usedStandees>=n.maxStandees)))("ghs-label","monster.addEntity."+n.type)("ghs-label-attribute","title"),t.R7$(2),t.vxM(n.settingsManager.settings.standees||!n.hasEntity()?2:-1),t.R7$(),t.vxM(!n.settingsManager.settings.standees&&n.hasEntity()?3:-1))},dependencies:[N.YU,tt,rt],styles:[".button[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;cursor:pointer;font-size:calc(var(--ghs-unit) * 8 * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));color:var(--ghs-color-gray);filter:var(--ghs-filter-gray) var(--ghs-filter-shadow);text-shadow:var(--ghs-outline);font-weight:700;width:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));text-align:center;stroke:var(--ghs-color-black);stroke-width:calc(var(--ghs-unit) * 2)}.button[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:100%;height:auto}.button.elite[_ngcontent-%COMP%]{color:var(--ghs-color-yellow);filter:var(--ghs-filter-yellow) var(--ghs-filter-shadow)}.button.boss[_ngcontent-%COMP%]{color:var(--ghs-color-red);filter:var(--ghs-filter-red) var(--ghs-filter-shadow)}.button[_ngcontent-%COMP%]:hover, .button.active-button[_ngcontent-%COMP%]{color:var(--ghs-color-white);filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-gray);filter:var(--ghs-filter-gray) var(--ghs-filter-shadow);opacity:.5}.number-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor)))}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.number-container[_ngcontent-%COMP%]   .number-button.elite[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.number-container[_ngcontent-%COMP%]   .number-button.boss[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.number-container[_ngcontent-%COMP%]   .number-button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-darkgray)}.number-container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.number-container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]   img.summon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.number-container[_ngcontent-%COMP%]   .summon-button[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.number-container[_ngcontent-%COMP%]   .summon-button.active[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) / 5) var(--ghs-color-white) solid;border-radius:100%}"]})}return i})();const rz=(i,r,e,a,n,o)=>({off:i,"full-ability":r,modern:e,short:a,"short-abilities":n,"short-stats":o}),cz=i=>({denied:i}),lz=i=>({"full-ability":i}),to=(i,r)=>({disabled:i,denied:r}),gz=(i,r,e)=>({empty:i,"full-ability":r,denied:e}),dz=i=>({disabled:i}),hz=(i,r)=>r.number;function _z(i,r){if(1&i&&t.nrm(0,"ghs-monster-ability-card",2),2&i){const e=t.XpG();t.Y8G("monster",e.monster)}}function mz(i,r){if(1&i&&t.nrm(0,"ghs-monster-stats",2),2&i){const e=t.XpG();t.Y8G("monster",e.monster)}}function pz(i,r){if(1&i&&t.nrm(0,"ghs-monster-numberpicker",4),2&i){const e=t.XpG();t.Y8G("monster",e.monster)("type",e.MonsterType.normal)("nonDead",e.nonDead)("count",e.count)("ngClass",t.l_i(5,to,e.settingsManager.settings.standees&&e.nonDead>=e.count,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.monsterPermissions[e.monster.name+"|"+e.monster.edition]))}}function uz(i,r){if(1&i&&t.nrm(0,"ghs-monster-numberpicker",5),2&i){const e=t.XpG();t.Y8G("monster",e.monster)("type",e.MonsterType.elite)("nonDead",e.nonDead)("count",e.count)("ngClass",t.l_i(5,to,e.settingsManager.settings.standees&&e.nonDead>=e.count,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.monsterPermissions[e.monster.name+"|"+e.monster.edition]))}}function fz(i,r){if(1&i&&t.nrm(0,"ghs-monster-numberpicker",6),2&i){const e=t.XpG();t.Y8G("monster",e.monster)("type",e.MonsterType.boss)("nonDead",e.nonDead)("count",e.count)("ngClass",t.l_i(5,to,e.settingsManager.settings.standees&&e.nonDead>=e.count,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.monsterPermissions[e.monster.name+"|"+e.monster.edition]))}}function Cz(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",17),t.bIt("click",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.entitiesMenu(n,o.MonsterType.boss))}),t.nrm(1,"img",11),t.k0s()}2&i&&t.Y8G("ghs-label","game.monster.selectStandees.boss")("ghs-label-attribute","title")}function Mz(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",18),t.bIt("click",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.entitiesMenu(n,o.MonsterType.elite))}),t.nrm(1,"img",11),t.k0s()}2&i&&t.Y8G("ghs-label","game.monster.selectStandees.elite")("ghs-label-attribute","title")}function vz(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",19),t.bIt("click",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.entitiesMenu(n,o.MonsterType.normal))}),t.nrm(1,"img",11),t.k0s()}2&i&&t.Y8G("ghs-label","game.monster.selectStandees.normal")("ghs-label-attribute","title")}function Oz(i,r){if(1&i&&t.nrm(0,"ghs-standee",16),2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("figure",a.monster)("entity",e)}}function Pz(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",8)(1,"div",9)(2,"a",10),t.bIt("click",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.entitiesMenu(n))}),t.nrm(3,"img",11),t.k0s(),t.nVh(4,Cz,2,2,"a",12),t.nVh(5,Mz,2,2,"a",13),t.nVh(6,vz,2,2,"a",14),t.k0s(),t.j41(7,"div",15),t.Z7z(8,Oz,1,2,"ghs-standee",16,hz),t.k0s()()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.sMw(7,gz,0==e.nonDead,e.settingsManager.settings.showFullAbilityCard||e.settingsManager.settings.showExpandedAbilityCard,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.monsterPermissions[e.monster.name+"|"+e.monster.edition])),t.R7$(),t.Y8G("ngClass",t.eq3(11,dz,e.nonDead<2)),t.R7$(),t.Y8G("ghs-label","game.monster.selectStandees.all")("ghs-label-attribute","title"),t.R7$(2),t.vxM(e.entityTypeCount(e.MonsterType.boss)?4:-1),t.R7$(),t.vxM(e.entityTypeCount(e.MonsterType.elite)?5:-1),t.R7$(),t.vxM(e.entityTypeCount(e.MonsterType.normal)?6:-1),t.R7$(2),t.Dyx(e.sortedEntites)}}let bz=(()=>{class i{dialog;overlay;monster;MonsterType=S.N;gameManager=s.E;settingsManager=m.f;nonDead=0;count=0;sortedEntites=[];constructor(e,a){this.dialog=e,this.overlay=a}ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.nonDead=s.E.monsterManager.monsterEntityCount(this.monster),this.count=s.E.monsterManager.monsterStandeeMax(this.monster),this.sortedEntites=this.monster.entities.sort(m.f.settings.eliteFirst?s.E.monsterManager.sortEntities:s.E.monsterManager.sortEntitiesByNumber)}isNormal(){return this.monster.stats.some(e=>e.type==S.N.normal||e.type==S.N.elite)}getEntities(e){return this.monster.entities.filter(a=>a.type==e).sort((a,n)=>a.number-n.number)}getEdition(){return s.E.getEdition(this.monster)}entityTypeCount(e){const a=this.monster.entities.filter(n=>n.type==e).length;return a>1&&a<this.nonDead}entitiesMenu(e,a=void 0){this.dialog.open(ra,{panelClass:["dialog"],data:{monster:this.monster,type:a},positionStrategy:this.overlay.position().flexibleConnectedTo(e.target).withPositions((0,V.yE)())})}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG),t.rXU(zt.hJ))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-monster"]],inputs:{monster:"monster"},standalone:!1,decls:10,vars:22,consts:[[1,"monster",3,"ngClass"],[3,"monster","ngClass"],[3,"monster"],[1,"stats-container",3,"ngClass"],[1,"normal",3,"monster","type","nonDead","count","ngClass"],[1,"elite",3,"monster","type","nonDead","count","ngClass"],[1,"boss",3,"monster","type","nonDead","count","ngClass"],[3,"figure"],[1,"entities-container",3,"ngClass"],[1,"spacer",3,"ngClass"],[1,"entities-menu","all",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/up.svg"],[1,"entities-menu","boss",3,"ghs-label","ghs-label-attribute"],[1,"entities-menu","elite",3,"ghs-label","ghs-label-attribute"],[1,"entities-menu","normal",3,"ghs-label","ghs-label-attribute"],[1,"entities"],[3,"figure","entity"],[1,"entities-menu","boss",3,"click","ghs-label","ghs-label-attribute"],[1,"entities-menu","elite",3,"click","ghs-label","ghs-label-attribute"],[1,"entities-menu","normal",3,"click","ghs-label","ghs-label-attribute"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nrm(1,"ghs-monster-image",1),t.nVh(2,_z,1,1,"ghs-monster-ability-card",2),t.j41(3,"div",3),t.nVh(4,mz,1,1,"ghs-monster-stats",2),t.nVh(5,pz,1,8,"ghs-monster-numberpicker",4),t.nVh(6,uz,1,8,"ghs-monster-numberpicker",5),t.nVh(7,fz,1,8,"ghs-monster-numberpicker",6),t.k0s(),t.nrm(8,"ghs-figure-errors",7),t.k0s(),t.nVh(9,Pz,10,13,"div",8)),2&a&&(t.Y8G("ngClass",t.l4e(11,rz,n.monster.off||0==n.nonDead,n.settingsManager.settings.showFullAbilityCard||n.settingsManager.settings.showExpandedAbilityCard,"modern"==n.settingsManager.settings.theme,!n.settingsManager.settings.abilities||!n.settingsManager.settings.stats,!n.settingsManager.settings.stats,!n.settingsManager.settings.abilities)),t.R7$(),t.Y8G("monster",n.monster)("ngClass",t.eq3(18,cz,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.round&&!n.gameManager.stateManager.monsterPermissions[n.monster.name+"|"+n.monster.edition])),t.R7$(),t.vxM(n.settingsManager.settings.abilities?2:-1),t.R7$(),t.Y8G("ngClass",t.eq3(20,lz,n.settingsManager.settings.showFullAbilityCard||n.settingsManager.settings.showExpandedAbilityCard)),t.R7$(),t.vxM(n.settingsManager.settings.stats?4:-1),t.R7$(),t.vxM(n.monster.boss?-1:5),t.R7$(),t.vxM(n.monster.boss||n.monster.bb?-1:6),t.R7$(),t.vxM(n.monster.boss?7:-1),t.R7$(),t.Y8G("figure",n.monster),t.R7$(),t.vxM(n.settingsManager.settings.standees?9:-1))},dependencies:[N.YU,Ts,tt,qN,ez,sz,jn,wi],styles:[".monster[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 98);z-index:1}.monster[_ngcontent-%COMP%]   ghs-monster-ability-card[_ngcontent-%COMP%], .monster[_ngcontent-%COMP%]   ghs-monster-stats[_ngcontent-%COMP%], .monster[_ngcontent-%COMP%]   ghs-monster-image[_ngcontent-%COMP%]{transition:filter calc(var(--ghs-animation-speed) * .15s) ease-in-out}.monster[_ngcontent-%COMP%]   ghs-monster-ability-card[_ngcontent-%COMP%]:not(ghs-monster-image), .monster[_ngcontent-%COMP%]   ghs-monster-stats[_ngcontent-%COMP%]:not(ghs-monster-image), .monster[_ngcontent-%COMP%]   ghs-monster-image[_ngcontent-%COMP%]:not(ghs-monster-image){filter:var(--ghs-filter-outline)}.monster.off[_ngcontent-%COMP%]   ghs-monster-ability-card[_ngcontent-%COMP%], .monster.off[_ngcontent-%COMP%]   ghs-monster-stats[_ngcontent-%COMP%], .monster.off[_ngcontent-%COMP%]   ghs-monster-image[_ngcontent-%COMP%]{filter:grayscale(.7)}.monster.off[_ngcontent-%COMP%]   ghs-monster-ability-card[_ngcontent-%COMP%]:not(ghs-monster-image), .monster.off[_ngcontent-%COMP%]   ghs-monster-stats[_ngcontent-%COMP%]:not(ghs-monster-image), .monster.off[_ngcontent-%COMP%]   ghs-monster-image[_ngcontent-%COMP%]:not(ghs-monster-image){filter:grayscale(1) var(--ghs-filter-outline)}.monster[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 40);height:calc(var(--ghs-unit) * 21.5)}.monster[_ngcontent-%COMP%]   .stats-container.full-ability[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 24)}.monster[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   ghs-monster-stats[_ngcontent-%COMP%]{width:100%;height:100%}.monster[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   ghs-monster-numberpicker[_ngcontent-%COMP%]{position:absolute;z-index:2}.monster[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   ghs-monster-numberpicker.normal[_ngcontent-%COMP%], .monster[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   ghs-monster-numberpicker.boss[_ngcontent-%COMP%]{bottom:calc(var(--ghs-unit) * 1);left:calc(var(--ghs-unit) * 1)}.monster[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   ghs-monster-numberpicker.elite[_ngcontent-%COMP%]{bottom:calc(var(--ghs-unit) * 1);left:initial;right:calc(var(--ghs-unit) * 1)}.monster[_ngcontent-%COMP%]   ghs-figure-errors[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 14.5);top:50%;transform:translateY(-50%)}.monster[_ngcontent-%COMP%]   ghs-monster-image[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * -.5);margin-right:calc(var(--ghs-unit) * .5)}.monster[_ngcontent-%COMP%]   ghs-monster-ability-card[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * .5);overflow:hidden;border-radius:calc(var(--ghs-unit) * 1)}.monster.full-ability[_ngcontent-%COMP%]   ghs-monster-ability-card[_ngcontent-%COMP%]{margin:0 calc(var(--ghs-unit) * 1.25)}.monster.full-ability[_ngcontent-%COMP%]   ghs-monster-numberpicker.normal[_ngcontent-%COMP%], .monster.full-ability[_ngcontent-%COMP%]   ghs-monster-numberpicker.boss[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 57.5)}.monster.full-ability[_ngcontent-%COMP%]   ghs-monster-numberpicker.elite[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * 2.5)}.monster.modern[_ngcontent-%COMP%]   ghs-monster-ability-card[_ngcontent-%COMP%], .monster.modern[_ngcontent-%COMP%]   ghs-monster-stats[_ngcontent-%COMP%], .monster.modern[_ngcontent-%COMP%]   ghs-monster-image[_ngcontent-%COMP%]{filter:none}.monster.modern.off[_ngcontent-%COMP%]   ghs-monster-ability-card[_ngcontent-%COMP%], .monster.modern.off[_ngcontent-%COMP%]   ghs-monster-stats[_ngcontent-%COMP%], .monster.modern.off[_ngcontent-%COMP%]   ghs-monster-image[_ngcontent-%COMP%]{filter:grayscale(.7)}.monster.short[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 57)}.monster.short.short-abilities[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]{position:absolute;left:0;bottom:0;width:calc(var(--ghs-unit) * 15.4);height:calc(var(--ghs-unit) * 5)}.monster.short.short-abilities[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   ghs-monster-numberpicker[_ngcontent-%COMP%]{bottom:calc(var(--ghs-unit) * .5)}.monster.short.short-abilities[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   ghs-monster-numberpicker.normal[_ngcontent-%COMP%], .monster.short.short-abilities[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   ghs-monster-numberpicker.boss[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 0)}.monster.short.short-abilities[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   ghs-monster-numberpicker.elite[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 11);right:initial}.monster.short.short-stats.short-abilities[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 17);float:left}.monster.short.short-stats.short-abilities[_ngcontent-%COMP%] + .entities-container[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 40)}.monster.short.short-stats.short-abilities[_ngcontent-%COMP%] + .entities-container[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{width:auto}.entities-container[_ngcontent-%COMP%]{position:relative;display:flex;transition:max-height calc(var(--ghs-animation-speed) * 1s) ease-out;max-height:100%;max-width:calc(var(--ghs-unit) * 96);margin-top:calc(var(--ghs-unit) * .25 * var(--ghs-text-factor));z-index:2}.entities-container.empty[_ngcontent-%COMP%]{max-height:0}.entities-container[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{flex:none;width:calc(var(--ghs-unit) * 17.5);min-height:100%;display:flex;justify-content:center;align-items:center}.entities-container[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer;margin:0 calc(var(--ghs-unit) * .8)}.entities-container[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{opacity:.5;width:calc(var(--ghs-unit) * 3.7 * var(--ghs-text-factor));height:auto;filter:var(--ghs-filter-darkgray)}.entities-container[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]   .entities-menu.normal[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.entities-container[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]   .entities-menu.elite[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-yellow)}.entities-container[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]   .entities-menu.boss[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red)}.entities-container[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{opacity:1}.entities-container[_ngcontent-%COMP%]   .spacer.disabled[_ngcontent-%COMP%]{pointer-events:none}.entities-container[_ngcontent-%COMP%]   .spacer.disabled[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]{display:none}.entities-container[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;max-width:calc(var(--ghs-unit) * 77.5)}.entities-container[_ngcontent-%COMP%]   .entities.normal[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 0)}.entities-container[_ngcontent-%COMP%]   .entities.elite[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * 0)}.entities-container[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   ghs-standee[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * .5);transition:all calc(var(--ghs-animation-speed) * 1s) ease-out}.entities-container.full-ability[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 19.5)}.entities-container.full-ability[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]{max-width:calc(var(--ghs-unit) * 75.5)}ghs-monster-numberpicker.disabled[_ngcontent-%COMP%]{pointer-events:none;display:none}.modern.short.short-stats.short-abilities[_ngcontent-%COMP%] + .entities-container[_ngcontent-%COMP%]{width:auto}"]})}return i})();const kz=["objectiveTitle"],yz=(i,r,e,a,n,o,g)=>({off:i,escort:r,denied:e,compact:a,short:n,menu:o,actions:g}),xz=i=>({entity:i}),Ez=i=>({"outer-denied":i}),wz=i=>({empty:i}),Rz=(i,r)=>({empty:i,disabled:r}),eo=i=>({"active-border":i}),jz=i=>({damage:i}),Gz=i=>({fh:i}),Tz=()=>[],Sz=(i,r)=>r.name+r.value,$z=(i,r)=>r.number;function Dz(i,r){if(1&i&&(t.j41(0,"span",2),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(2,eo,e.objective.active)),t.R7$(),t.JRh(e.entity.marker)}}function Iz(i,r){if(1&i&&(t.nVh(0,Dz,2,4,"span",2),t.j41(1,"span",24),t.EFF(2),t.k0s()),2&i){const e=t.XpG();t.vxM(e.entity.marker?0:-1),t.R7$(2),t.SpI(" ",e.entity.number," ")}}function Az(i,r){if(1&i&&(t.j41(0,"span",2),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(2,eo,e.objective.active)),t.R7$(),t.JRh(e.marker)}}function Vz(i,r){if(1&i&&(t.j41(0,"span",3),t.nrm(1,"img",18),t.k0s()),2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(2,eo,e.objective.active)),t.R7$(),t.Y8G("src","./assets/images/objective/"+(e.objective.escort?"escort":"objective")+".svg",t.B4B)}}function Fz(i,r){if(1&i&&t.nrm(0,"ghs-character-initiative",5),2&i){const e=t.XpG();t.Y8G("figure",e.objective)}}function Xz(i,r){if(1&i&&t.nrm(0,"ghs-highlight-conditions",6),2&i){const e=t.XpG();t.Y8G("entity",e.entity)}}function Bz(i,r){if(1&i&&t.nrm(0,"ghs-character-initiative",27),2&i){const e=t.XpG(2);t.Y8G("figure",e.objective)}}function Yz(i,r){if(1&i&&t.nrm(0,"img",31),2&i){const e=t.XpG(2);t.Y8G("src","./assets/images/objective/"+(e.objective.escort?"escort":"objective")+".svg",t.B4B)}}function Nz(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.SpI(" ",e.objective.title)}}function zz(i,r){if(1&i&&t.nrm(0,"span",32),2&i){const e=t.XpG(2);t.Y8G("ghs-label",e.objective.name?"data.objective."+e.objective.name:e.objective.escort?"escort":"objective")}}function Lz(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",42),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openEntityMenu())})("doubleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.removeShield())}),t.nrm(1,"ghs-action",43),t.k0s()}if(2&i){const e=t.XpG(3);t.R7$(),t.Aen("fh"),t.Y8G("action",e.entity.shield)}}function Uz(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",42),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openEntityMenu())})("doubleClick",function(){const n=t.eBV(e).$index,o=t.XpG(3);return t.Njj(o.removeRetaliate(n))}),t.nrm(1,"ghs-action",43),t.k0s()}if(2&i){const e=r.$implicit;t.R7$(),t.Aen("fh"),t.Y8G("action",e)}}function qz(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",42),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openEntityMenu())})("doubleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.removeShieldPersistent())}),t.j41(1,"span",44),t.nrm(2,"span",45),t.k0s(),t.nrm(3,"ghs-action",43),t.k0s()}if(2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","%game.card.persistent%"),t.R7$(),t.Aen("fh"),t.Y8G("action",e.entity.shieldPersistent)}}function Hz(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",42),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.openEntityMenu())})("doubleClick",function(){const n=t.eBV(e).$index,o=t.XpG(3);return t.Njj(o.removeRetaliatePersistent(n))}),t.j41(1,"span",44),t.nrm(2,"span",45),t.k0s(),t.nrm(3,"ghs-action",43),t.k0s()}if(2&i){const e=r.$implicit;t.R7$(2),t.Y8G("ghs-label","%game.card.persistent%"),t.R7$(),t.Aen("fh"),t.Y8G("action",e)}}function Kz(i,r){if(1&i&&(t.j41(0,"span",33),t.nVh(1,Lz,2,3,"span",41),t.Z7z(2,Uz,2,3,"span",41,t.fX1),t.nVh(4,qz,4,4,"span",41),t.Z7z(5,Hz,4,4,"span",41,t.fX1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.vxM(e.entity.shield?1:-1),t.R7$(),t.Dyx(e.entity.retaliate),t.R7$(2),t.vxM(e.entity.shieldPersistent?4:-1),t.R7$(),t.Dyx(e.entity.retaliatePersistent)}}function Wz(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsMinZero"),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Lme(" ",t.bMT(2,2,e.entity.health+e.health),"/",e.entity.maxHealth," ")}}function Jz(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsMinZero"),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Lme(" ",e.entity.maxHealth,"/",t.bMT(2,2,e.entity.maxHealth-(e.entity.health+e.health))," ")}}function Zz(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"ghsMinZero"),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.SpI(" ",t.bMT(2,1,e.entity.health+e.health)," ")}}function Qz(i,r){if(1&i&&(t.nVh(0,Wz,3,4,"span"),t.nVh(1,Jz,3,4,"span"),t.nVh(2,Zz,3,3,"span"),t.nrm(3,"span",46)),2&i){const e=t.XpG(2);t.vxM(e.settingsManager.settings.damageHP||e.objectiveData&&e.objectiveData.trackDamage?-1:0),t.R7$(),t.vxM(e.settingsManager.settings.damageHP?1:-1),t.R7$(),t.vxM(e.objectiveData&&e.objectiveData.trackDamage?2:-1),t.R7$(),t.Y8G("value-sign",e.health)("hideEmpty",!0)("reverse",e.settingsManager.settings.damageHP)("container",!0)("invert",!!e.objectiveData&&e.objectiveData.trackDamage)}}function tL(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"-"),t.k0s())}function eL(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",47),t.bIt("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.removeMarker(n))}),t.nrm(1,"img",18),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(),t.Y8G("src",a.gameManager.characterManager.characterIcon(e),t.B4B)}}function nL(i,r){if(1&i&&t.nrm(0,"img",53),2&i){const e=r.$implicit,a=t.XpG(2),n=a.$implicit,o=a.$index,g=t.XpG(2);t.xc7("z-index",10*o+n.value-e-1),t.Y8G("src","./assets/images"+(g.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+n.name+".svg",t.B4B)}}function iL(i,r){if(1&i&&(t.Z7z(0,nL,1,3,"img",52,t.fX1),t.nI1(2,"ghsRange")),2&i){const e=t.XpG().$implicit;t.Dyx(t.i5U(2,0,t.lJ4(3,Tz),e.value-1))}}function aL(i,r){if(1&i&&(t.j41(0,"span",54),t.EFF(1),t.k0s()),2&i){const e=t.XpG(),a=e.$implicit;t.xc7("z-index",10*e.$index+a.value+1),t.R7$(),t.JRh(a.value)}}function oL(i,r){if(1&i&&t.nrm(0,"span",55),2&i){const e=t.XpG();t.xc7("z-index",10*e.$index+e.$implicit.value+2)}}function sL(i,r){if(1&i&&t.nrm(0,"span",56),2&i){const e=t.XpG();t.xc7("z-index",10*e.$index+e.$implicit.value+3)}}function rL(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",48),t.bIt("doubleClick",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.removeCondition(n))}),t.nrm(1,"img",18),t.nVh(2,iL,3,4),t.nVh(3,aL,2,3,"span",49),t.nVh(4,oL,1,2,"span",50),t.nVh(5,sL,1,2,"span",51),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.Y8G("ngClass",t.eq3(8,Gz,n.settingsManager.settings.fhStyle)),t.R7$(),t.xc7("z-index",10*a+e.value),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+e.name+".svg",t.B4B),t.R7$(),t.vxM(-1!=e.types.indexOf(n.ConditionType.stack)?2:-1),t.R7$(),t.vxM(-1!=e.types.indexOf(n.ConditionType.value)&&-1==e.types.indexOf(n.ConditionType.stack)?3:-1),t.R7$(),t.vxM(-1!=n.entity.immunities.indexOf(e.name)?4:-1),t.R7$(),t.vxM(e.permanent?5:-1)}}function cL(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",25),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openEntityMenu())}),t.k0s(),t.j41(1,"div",26)(2,"div",25),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openEntityMenu())}),t.k0s(),t.nVh(3,Bz,1,1,"ghs-character-initiative",27),t.j41(4,"div",28)(5,"div",29),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openEntityMenu())}),t.j41(6,"div",30),t.nVh(7,Yz,1,1,"img",31),t.nVh(8,Nz,2,1,"span"),t.nVh(9,zz,1,1,"span",32),t.nrm(10,"ghs-entity-index-key",6),t.k0s(),t.nVh(11,Kz,7,2,"span",33),t.k0s(),t.j41(12,"div",34)(13,"div",35),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openEntityMenu())})("doubleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleDamageHP())})("dragMove",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.dragHpMove(n))})("dragEnd",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.dragHpEnd(n))})("dragCancel",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.dragHpCancel(n))}),t.nrm(14,"img",36),t.nVh(15,Qz,4,8),t.nVh(16,tL,2,0,"span"),t.k0s(),t.j41(17,"div",37),t.Z7z(18,eL,2,1,"span",38,t.fX1),t.k0s(),t.j41(20,"div",39),t.Z7z(21,rL,6,10,"span",40,Sz),t.k0s()()()()}if(2&i){const e=t.XpG();t.R7$(3),t.vxM(e.short?3:-1),t.R7$(4),t.vxM(e.entity.marker?7:-1),t.R7$(),t.vxM(e.objective.title?8:-1),t.R7$(),t.vxM(e.objective.title?-1:9),t.R7$(),t.Y8G("entity",e.entity),t.R7$(),t.vxM(e.settingsManager.settings.characterShieldRetaliate?11:-1),t.R7$(2),t.Y8G("relative",!0)("screenWidth",!0)("fastShift",!0),t.R7$(),t.Y8G("ngClass",t.eq3(13,jz,e.objectiveData&&e.objectiveData.trackDamage||e.settingsManager.settings.damageHP))("src","./assets/images/"+(e.objectiveData&&e.objectiveData.trackDamage||e.settingsManager.settings.damageHP?"action/damage.svg":"status/health.svg"),t.B4B),t.R7$(),t.vxM(e.objectiveData&&e.objectiveData.trackDamage||e.entity.maxHealth>0?15:-1),t.R7$(),t.vxM(e.objectiveData&&e.objectiveData.trackDamage||0!=e.entity.maxHealth?-1:16),t.R7$(2),t.Dyx(e.entity.markers),t.R7$(3),t.Dyx(e.activeConditions)}}function lL(i,r){if(1&i&&t.nrm(0,"ghs-character-initiative",27),2&i){const e=t.XpG(2);t.Y8G("figure",e.objective)}}function gL(i,r){if(1&i&&t.nrm(0,"img",31),2&i){const e=t.XpG(2);t.Y8G("src","./assets/images/objective/"+(e.objective.escort?"escort":"objective")+".svg",t.B4B)}}function dL(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.SpI(" ",e.objective.title)}}function hL(i,r){if(1&i&&t.nrm(0,"span",32),2&i){const e=t.XpG(2);t.Y8G("ghs-label",e.objective.name?"data.objective."+e.objective.name:e.objective.escort?"escort":"objective")}}function _L(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",25),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openEntityMenu())}),t.k0s(),t.j41(1,"div",26)(2,"div",25),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openEntityMenu())}),t.k0s(),t.nVh(3,lL,1,1,"ghs-character-initiative",27),t.j41(4,"div",28)(5,"div",29),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openEntityMenu())}),t.j41(6,"div",30),t.nVh(7,gL,1,1,"img",31),t.nVh(8,dL,2,1,"span"),t.nVh(9,hL,1,1,"span",32),t.k0s()()()()}if(2&i){const e=t.XpG();t.R7$(3),t.vxM(e.short?3:-1),t.R7$(4),t.vxM(e.objective.marker?7:-1),t.R7$(),t.vxM(e.objective.title?8:-1),t.R7$(),t.vxM(e.objective.title?-1:9)}}function mL(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",57),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openEntityMenu())}),t.j41(1,"ghs-actions",58),t.bIt("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.onInteractiveActionsChange(n))}),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("objective",e.objective)("actions",e.objectiveData.actions)("interactiveActions",e.interactiveActions)}}function pL(i,r){1&i&&t.nrm(0,"div",10)}function uL(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-interactive-actions",59),t.mxI("interactiveActionsChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.interactiveActions,n)||(o.interactiveActions=n),t.Njj(n)}),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("figure",e.objective)("actions",e.objectiveData.actions),t.R50("interactiveActions",e.interactiveActions)}}function fL(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",13)(1,"div",25),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openEntityMenu())}),t.k0s(),t.j41(2,"a",60),t.bIt("singleClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.shortMenu=!n.shortMenu)}),t.nrm(3,"img",61),t.k0s()()}}function CL(i,r){if(1&i&&t.nrm(0,"ghs-standee",62),2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("figure",a.objective)("entity",e)}}function ML(i,r){if(1&i&&(t.j41(0,"div",23),t.Z7z(1,CL,1,2,"ghs-standee",62,$z),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.objective.entities)}}let vL=(()=>{class i{dialog;overlay;elementRef;objective;titleInput;characterManager=s.E.characterManager;gameManager=s.E;settingsManager=m.f;GameState=T.mk;ConditionType=j.GV;objectiveData;entity;activeConditions=[];initiative=-1;health=0;marker="";compact=!1;short=!1;shortMenu=!1;nonDead=0;interactiveActions=[];interactiveActionsChange=new t.bkB;constructor(e,a,n){this.dialog=e,this.overlay=a,this.elementRef=n}ngOnInit(){this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>this.update()}),this.update()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.nonDead=this.objective.entities.filter(e=>s.E.entityManager.isAlive(e)).length,this.activeConditions=[],this.entity=void 0,this.marker="",1==this.nonDead?(this.entity=this.objective.entities.find(e=>s.E.entityManager.isAlive(e)),this.entity&&(this.activeConditions=s.E.entityManager.activeConditions(this.entity),this.entity.immunities.forEach(e=>{this.activeConditions.find(a=>a.name==e)||this.activeConditions.push(new j.BR(e))}))):this.objective.entities.flatMap(e=>e.marker).every((e,a,n)=>0==n.indexOf(e))&&(this.marker=this.objective.entities.flatMap(e=>e.marker)[0]),this.objective.objectiveId&&(this.objectiveData=s.E.objectiveManager.objectiveDataByObjectiveIdentifier(this.objective.objectiveId)),this.compact=m.f.settings.characterCompact&&"modern"!=m.f.settings.theme,this.short=!(m.f.settings.abilities&&m.f.settings.stats||"modern"==m.f.settings.theme)}toggleFigure(e){s.E.game.state==T.mk.draw||m.f.settings.initiativeRequired&&this.objective.initiative<=0?this.openInitiativeDialog(e):(s.E.stateManager.before(this.objective.active?"unsetActive":"setActive",s.E.objectiveManager.objectiveName(this.objective)),s.E.roundManager.toggleFigure(this.objective),s.E.stateManager.after())}openInitiativeDialog(e){this.dialog.open(ma,{panelClass:["dialog"],data:this.objective,positionStrategy:this.overlay.position().flexibleConnectedTo(e.target).withPositions((0,V.yE)())})}dragInitiativeMove(e){e>99?e=99:e<0&&(e=0),0==e&&m.f.settings.initiativeRequired&&(e=1),-1==this.initiative&&(this.initiative=this.objective.initiative),this.objective.initiative=e}dragInitiativeEnd(e){e>99?e=99:e<0&&(e=0),0==e&&m.f.settings.initiativeRequired&&(e=1),this.objective.initiative!=this.initiative&&(this.objective.initiative=this.initiative,s.E.stateManager.before("setObjectiveInitiative",s.E.objectiveManager.objectiveName(this.objective),""+e),this.objective.initiative=e,this.initiative=-1,s.E.game.state==T.mk.next&&s.E.sortFigures(this.objective),s.E.stateManager.after())}dragHpMove(e){this.health=e,(!this.objectiveData||!this.objectiveData.trackDamage)&&this.entity&&this.entity.health+this.health>(0,$.hZ)(this.entity.maxHealth)&&(this.health=(0,$.hZ)(this.entity.maxHealth)-this.entity.health)}dragHpEnd(e){0!=this.health&&this.entity&&(s.E.stateManager.before("changeObjectiveEntityHP",s.E.objectiveManager.objectiveName(this.objective),(0,V.n1)(this.health),this.entity.number),s.E.entityManager.changeHealth(this.entity,this.objective,this.health),this.entity.health<=0&&this.entity.maxHealth>0&&s.E.objectiveManager.removeObjective(this.objective),this.health=0,s.E.stateManager.after())}dragHpCancel(e){this.health=0}openEntityMenu(){this.dialog.open(Xn,{panelClass:["dialog"],data:{entity:this.entity,figure:this.objective},positionStrategy:this.overlay.position().flexibleConnectedTo(this.elementRef.nativeElement.querySelector(".image-container")).withPositions((0,V.yE)())})}toggleDamageHP(){m.f.toggle("damageHP")}openEntitiesMenu(e){this.dialog.open(ra,{panelClass:["dialog"],data:{objective:this.objective},positionStrategy:this.overlay.position().flexibleConnectedTo(e.target).withPositions((0,V.yE)())})}addEntity(){const e=this.objective.entities.filter(o=>s.E.entityManager.isAlive(o)).length;let a=e%12;if(this.objective.entities.find(o=>o.number==a)&&(a=e%12,e<12))for(;this.objective.entities.find(o=>o.number-1==a);)a++;let n=this.objective.name;n||(n=this.objective.title,n||(n=this.objective.escort?"%escort%":"%objective%")),s.E.stateManager.before("addObjective.entity",a+1,n),s.E.objectiveManager.addObjectiveEntity(this.objective,a),s.E.stateManager.after()}removeCondition(e){this.entity&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.objective,"removeCondition"),e.name),e.types.indexOf(j.GV.stackable)&&e.value>1?e.value--:s.E.entityManager.removeCondition(this.entity,this.objective,e,e.permanent),s.E.stateManager.after())}removeMarker(e){if(this.entity){const a=new q.K(s.E.getCharacterData(e),1),n=s.E.characterManager.characterName(a),o=a.name;s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.objective,"removeMarker"),n,o),this.entity.markers=this.entity.markers.filter(g=>g!=e),s.E.stateManager.after()}}onInteractiveActionsChange(e){this.interactiveActionsChange.emit(e),this.interactiveActions=e}removeShield(){this.entity&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.objective,"removeEntityShield")),this.entity.shield=void 0,s.E.stateManager.after())}removeShieldPersistent(){this.entity&&(s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.objective,"removeEntityShieldPersistent")),this.entity.shieldPersistent=void 0,s.E.stateManager.after())}removeRetaliate(e){if(this.entity){let a=JSON.parse(JSON.stringify(this.entity.retaliate));a.splice(e,1),a.length>0?s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.objective,"setEntityRetaliate"),a.map(n=>"%game.action.retaliate% "+(0,$.hZ)(n.value)+(n.subActions&&n.subActions[0]&&n.subActions[0].type==G.X2.range&&(0,$.hZ)(n.subActions[0].value)>1?" %game.action.range% "+(0,$.hZ)(n.subActions[0].value):"")).join(", ")):s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.objective,"removeEntityRetaliate")),this.entity.retaliate=a,s.E.stateManager.after()}}removeRetaliatePersistent(e){if(this.entity){let a=JSON.parse(JSON.stringify(this.entity.retaliatePersistent));a.splice(e,1),a.length>0?s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.objective,"setEntityRetaliatePersistent"),a.map(n=>"%game.action.retaliate% "+(0,$.hZ)(n.value)+(n.subActions&&n.subActions[0]&&n.subActions[0].type==G.X2.range&&(0,$.hZ)(n.subActions[0].value)>1?" %game.action.range% "+(0,$.hZ)(n.subActions[0].value):"")).join(", ")):s.E.stateManager.before(...s.E.entityManager.undoInfos(this.entity,this.objective,"removeEntityRetaliatePersistent")),this.entity.retaliatePersistent=a,s.E.stateManager.after()}}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG),t.rXU(zt.hJ),t.rXU(t.aKT))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-objective-container"]],viewQuery:function(a,n){if(1&a&&t.GBs(kz,5),2&a){let o;t.mGM(o=t.lsd())&&(n.titleInput=o.first)}},inputs:{objective:"objective"},standalone:!1,decls:27,vars:38,consts:[[1,"objective",3,"ngClass"],[1,"image-container",3,"ngClass"],[1,"map-marker",3,"ngClass"],[1,"objective-icon",3,"ngClass"],[1,"drag-initiative",3,"dragMove","dragEnd","singleClick","doubleClick","ngClass"],[3,"figure"],[3,"entity"],[1,"stats"],[1,"actions-container"],["ghs-pointer-input","",1,"actions"],[1,"bottom-spacer"],[3,"figure","actions","interactiveActions"],[1,"spacer",3,"click"],[1,"short-menu"],[1,"add-entity"],["ghs-pointer-input","",1,"add-entity-button",3,"singleClick","ghs-label","ghs-label-attribute"],["src","./assets/images/plus.svg",1,"ghs-svg"],[1,"icon-container",3,"click"],[3,"src"],[1,"entities-container",3,"ngClass"],[1,"spacer"],[1,"entities-menu",3,"click","ngClass","entityAnimation"],["src","./assets/images/up.svg",1,"menu"],[1,"entities"],[1,"objective-marker"],["ghs-pointer-input","",1,"entity-menu-container",3,"singleClick"],[1,"column","col-1"],[1,"initiative",3,"figure"],[1,"bar-container"],["ghs-pointer-input","",1,"title-container",3,"singleClick"],[1,"title"],[1,"icon",3,"src"],[3,"ghs-label"],[1,"actions"],[1,"status-bar"],["ghs-pointer-input","",1,"health",3,"singleClick","doubleClick","dragMove","dragEnd","dragCancel","relative","screenWidth","fastShift"],[3,"ngClass","src"],[1,"markers"],["ghs-pointer-input","",1,"marker"],[1,"conditions"],["ghs-pointer-input","",1,"condition",3,"ngClass"],["ghs-pointer-input","",1,"action"],["ghs-pointer-input","",1,"action",3,"singleClick","doubleClick"],[3,"action"],[1,"action-overlay"],[1,"text-white",3,"ghs-label"],[1,"value-overlay",3,"value-sign","hideEmpty","reverse","container","invert"],["ghs-pointer-input","",1,"marker",3,"doubleClick"],["ghs-pointer-input","",1,"condition",3,"doubleClick","ngClass"],[1,"value",3,"z-index"],[1,"condition","immunity","condition-overlay",3,"z-index"],[1,"condition","permanent","condition-overlay",3,"z-index"],[1,"stack",3,"z-index","src"],[1,"stack",3,"src"],[1,"value"],[1,"condition","immunity","condition-overlay"],[1,"condition","permanent","condition-overlay"],["ghs-pointer-input","",1,"actions",3,"singleClick"],[3,"interactiveActionsChange","objective","actions","interactiveActions"],[3,"interactiveActionsChange","figure","actions","interactiveActions"],["ghs-pointer-input","",1,"toggle-menu",3,"singleClick"],["src","./assets/images/menu.svg",1,"ghs-svg"],[3,"figure","entity"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"a",1),t.nVh(2,Iz,3,2),t.nVh(3,Az,2,4,"span",2),t.nVh(4,Vz,2,4,"span",3),t.k0s(),t.j41(5,"ghs-pointer-input",4),t.bIt("dragMove",function(g){return(!n.gameManager.stateManager.permissions||n.gameManager.stateManager.permissions.characters)&&n.dragInitiativeMove(g)})("dragEnd",function(g){return(!n.gameManager.stateManager.permissions||n.gameManager.stateManager.permissions.characters)&&n.dragInitiativeEnd(g)})("singleClick",function(g){return n.toggleFigure(g)})("doubleClick",function(g){return(!n.gameManager.stateManager.permissions||n.gameManager.stateManager.permissions.characters)&&n.openInitiativeDialog(g)}),t.k0s(),t.nVh(6,Fz,1,1,"ghs-character-initiative",5),t.nVh(7,Xz,1,1,"ghs-highlight-conditions",6),t.j41(8,"div",7),t.nVh(9,cL,23,15),t.nVh(10,_L,10,4),t.j41(11,"div",8),t.nVh(12,mL,2,3,"div",9),t.nVh(13,pL,1,0,"div",10),t.k0s(),t.nVh(14,uL,1,3,"ghs-interactive-actions",11),t.j41(15,"span",12),t.bIt("click",function(){return n.openEntityMenu()}),t.k0s(),t.nVh(16,fL,4,0,"div",13),t.j41(17,"div",14)(18,"a",15),t.bIt("singleClick",function(){return n.addEntity()}),t.nrm(19,"img",16),t.k0s()(),t.j41(20,"div",17),t.bIt("click",function(){return n.openEntityMenu()}),t.nrm(21,"img",18),t.k0s()()(),t.j41(22,"div",19),t.nrm(23,"span",20),t.j41(24,"span",21),t.bIt("click",function(g){return n.openEntitiesMenu(g)}),t.nrm(25,"img",22),t.k0s(),t.nVh(26,ML,3,0,"div",23),t.k0s()),2&a&&(t.Y8G("ngClass",t.sGs(21,yz,n.objective.off,n.objective.escort,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.characters,n.compact,n.short,n.shortMenu,!!n.objectiveData&&n.objectiveData.actions)),t.R7$(),t.Y8G("ngClass",t.eq3(29,xz,n.entity)),t.R7$(),t.vxM(n.entity?2:-1),t.R7$(),t.vxM(n.marker?3:-1),t.R7$(),t.vxM(n.marker||n.entity&&n.entity.marker?-1:4),t.R7$(),t.Y8G("ngClass",t.eq3(31,Ez,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.round)),t.R7$(),t.vxM(n.short?-1:6),t.R7$(),t.vxM(n.entity?7:-1),t.R7$(2),t.vxM(n.entity?9:-1),t.R7$(),t.vxM(n.entity?-1:10),t.R7$(2),t.vxM(n.objectiveData&&n.objectiveData.actions?12:-1),t.R7$(),t.vxM(n.interactiveActions.length?13:-1),t.R7$(),t.vxM(n.objectiveData&&n.objectiveData.actions?14:-1),t.R7$(2),t.vxM(n.compact&&n.short?16:-1),t.R7$(2),t.Y8G("ghs-label","objective.addEntity")("ghs-label-attribute","title"),t.R7$(3),t.Y8G("src","./assets/images/objective/"+(n.objective.escort?"escort":"objective")+".svg",t.B4B),t.R7$(),t.Y8G("ngClass",t.eq3(33,wz,n.nonDead<2)),t.R7$(2),t.Y8G("ngClass",t.l_i(35,Rz,0==n.nonDead,n.nonDead<2))("entityAnimation",0==n.nonDead),t.R7$(2),t.vxM(n.nonDead>1?26:-1))},dependencies:[N.YU,ae,vn,xa,xi,pi,tt,Ei,rs,rt,wi,Fn,hi,Tt],styles:['.objective[_ngcontent-%COMP%]{position:relative;z-index:1;height:100%;width:calc(var(--ghs-unit) * 98);height:calc(var(--ghs-unit) * 14);background-color:var(--ghs-color-green);background-image:url(char-mat.5a0fee77df1ff44e.png),url(char-mat.5a0fee77df1ff44e.png);background-blend-mode:multiply,overlay;background-size:100% 100%;display:flex;border-radius:calc(var(--ghs-unit) * .5);transition:background-color calc(var(--ghs-animation-speed) * .15s) ease-in-out,background-image calc(var(--ghs-animation-speed) * .15s) ease-in-out,background-blend-mode calc(var(--ghs-animation-speed) * .15s) ease-in-out}.objective.escort[_ngcontent-%COMP%]{background-color:var(--ghs-color-red)}.objective[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .objective[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%], .objective[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%], .objective[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]{transition:filter calc(var(--ghs-animation-speed) * .15s) ease-in-out}.objective.off[_ngcontent-%COMP%]{background-color:var(--ghs-color-gray);background-image:url(char-mat.5a0fee77df1ff44e.png);background-blend-mode:multiply}.objective.off[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .objective.off[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%], .objective.off[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]{filter:grayscale(100%)}.objective[_ngcontent-%COMP%]   ghs-character-initiative[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 1)}.objective[_ngcontent-%COMP%]   ghs-highlight-conditions[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 10.5);bottom:calc(var(--ghs-unit) * 2.5);z-index:20}.objective[_ngcontent-%COMP%]   .entity-menu-container[_ngcontent-%COMP%]{cursor:pointer;position:absolute;inset:0}.objective[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 2.1);left:calc(var(--ghs-unit) * 6);width:calc(var(--ghs-unit) * 9.5);height:calc(var(--ghs-unit) * 9.5);z-index:4}.objective[_ngcontent-%COMP%]   .drag-initiative.dragging[_ngcontent-%COMP%]{left:0!important;width:100%!important}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{height:100%;display:flex;flex-basis:100%;cursor:pointer}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:flex-start;z-index:2}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 24);overflow:visible}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .bar-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:flex-start}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-2[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 8);justify-content:space-evenly}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]{display:flex;align-items:center;overflow:visible}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]   ghs-entity-index-key[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1)}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{position:relative;display:flex;margin-left:calc(var(--ghs-unit) * .5);font-size:calc(var(--ghs-unit) * 2)}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{position:relative;margin-left:calc(var(--ghs-unit) * .5)}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]:hover{transform:translate(50%,50%) scale(2);transform-origin:center center;z-index:999}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]:hover:before{content:" ";position:absolute;top:calc(var(--ghs-unit) * -1);left:calc(var(--ghs-unit) * -1);right:calc(var(--ghs-unit) * -1);bottom:calc(var(--ghs-unit) * -1);background-color:var(--ghs-color-darkgray);opacity:.5;border-radius:calc(var(--ghs-unit) * 1)}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .action-overlay[_ngcontent-%COMP%]{position:absolute;z-index:1;top:calc(var(--ghs-unit) * 1);left:calc(var(--ghs-unit) * -.5)}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{pointer-events:none;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5);color:var(--ghs-color-white);text-shadow:var(--ghs-outline);display:flex;align-items:center;white-space:nowrap}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 5);width:auto;margin-left:calc(var(--ghs-unit) * -1);margin-right:calc(var(--ghs-unit) * .5)}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .status-bar[_ngcontent-%COMP%]{display:flex;align-items:center;z-index:2;touch-action:none}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline);width:calc(var(--ghs-unit) * 11 * var(--ghs-text-factor))}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));width:auto}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]   img.damage[_ngcontent-%COMP%]{filter:var(--ghs-filter-red) brightness(.7) var(--ghs-filter-outline-thin-black)}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]   .value-overlay[_ngcontent-%COMP%]{z-index:1000}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 12);display:flex;justify-content:center;align-items:center;margin-right:calc(var(--ghs-unit) * 4)}.objective[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 8);width:auto}.objective[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]{display:flex;margin:calc(var(--ghs-unit) * 1.5) 0;margin-left:calc(var(--ghs-unit) * 1);position:relative;overflow:auto}.objective[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 28);display:flex;justify-content:center;font-size:calc(var(--ghs-unit) * 2.5)}.objective[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]   .bottom-spacer[_ngcontent-%COMP%]{display:block;position:relative;margin-top:2em}.objective[_ngcontent-%COMP%]   ghs-interactive-actions[_ngcontent-%COMP%]{position:absolute;font-size:calc(var(--ghs-unit) * 1.5);left:0;width:100%;bottom:0;z-index:999;border-bottom-left-radius:calc(var(--ghs-unit) * .5);border-bottom-right-radius:calc(var(--ghs-unit) * .5);overflow:hidden}.objective[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 9.5);height:calc(var(--ghs-unit) * 9.5);margin:calc(var(--ghs-unit) * 2.1) calc(var(--ghs-unit) * 3.4);left:calc(var(--ghs-unit) * 2.4);cursor:pointer;border-radius:calc(var(--ghs-unit) * 1);flex-shrink:0}.objective[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .objective-icon[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 9.5);height:calc(var(--ghs-unit) * 9.5);border-radius:100%;background-color:var(--ghs-color-darkgray);background:radial-gradient(circle,var(--ghs-color-black) 0%,var(--ghs-color-darkgray) 70%,var(--ghs-color-gray) 100%)}.objective[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .objective-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 8);width:auto}.objective[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .map-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 6.5)}.objective[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{position:absolute;bottom:calc(var(--ghs-unit) * -1);right:calc(var(--ghs-unit) * -1);font-size:calc(var(--ghs-unit) * 2.1);z-index:1}.objective[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;max-height:calc(var(--ghs-unit) * 7 * var(--ghs-text-factor));padding:0 calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.objective[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));background-color:var(--ghs-color-darkgray);border-radius:100%;height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));margin-right:calc(var(--ghs-unit) * -1 * var(--ghs-text-factor));border-width:calc(var(--ghs-unit) * .4);border-style:solid;border-color:var(--ghs-color-gray)}.objective[_ngcontent-%COMP%]   .markers[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 2.7 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 2.7 * var(--ghs-text-factor))}.objective[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]{position:relative;display:flex}.objective[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;margin-right:calc(var(--ghs-unit) * -.5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));overflow:visible}.objective[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));margin:0}.objective[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img.stack[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * -2 * var(--ghs-text-factor))}.objective[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition.condition-overlay[_ngcontent-%COMP%]{position:absolute;width:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.8 * var(--ghs-text-factor));top:0;left:0;pointer-events:none;z-index:2}.objective[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 1.5 * var(--ghs-text-factor));color:var(--ghs-color-white);position:absolute;top:calc(var(--ghs-unit) * 2.1 * var(--ghs-text-factor));left:50%;text-shadow:none;transform:translate(-50%)}.objective[_ngcontent-%COMP%]   .conditions[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:hover{transform:scale(2);transform-origin:center center;z-index:999}.objective[_ngcontent-%COMP%]   .add-entity[_ngcontent-%COMP%], .objective[_ngcontent-%COMP%]   .short-menu[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.objective[_ngcontent-%COMP%]   .add-entity-button[_ngcontent-%COMP%], .objective[_ngcontent-%COMP%]   .toggle-menu[_ngcontent-%COMP%]{position:relative;display:flex;width:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 5 * var(--ghs-text-factor));cursor:pointer;font-size:calc(var(--ghs-unit) * 10 * var(--ghs-text-factor));color:var(--ghs-color-gray);filter:var(--ghs-filter-gray);stroke:var(--ghs-color-black);stroke-width:calc(var(--ghs-unit) * 1.5)}.objective[_ngcontent-%COMP%]   .add-entity-button[_ngcontent-%COMP%]:hover, .objective[_ngcontent-%COMP%]   .toggle-menu[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white);filter:var(--ghs-filter-white)}.objective[_ngcontent-%COMP%]   .add-entity-button.toggle-menu[_ngcontent-%COMP%], .objective[_ngcontent-%COMP%]   .toggle-menu.toggle-menu[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor))}.objective.denied[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{pointer-events:initial}.objective.short[_ngcontent-%COMP%]:not(.compact){width:calc(var(--ghs-unit) * 57);height:calc(var(--ghs-unit) * 28);background-image:url(char-mat-short.a094776e83c7bcfc.png),url(char-mat-short.a094776e83c7bcfc.png)}.objective.short[_ngcontent-%COMP%]:not(.compact)   .image-container[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * 2.8) calc(var(--ghs-unit) * 2)}.objective.short[_ngcontent-%COMP%]:not(.compact)   ghs-highlight-conditions[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 9);bottom:calc(var(--ghs-unit) * 16)}.objective.short[_ngcontent-%COMP%]:not(.compact)   .drag-initiative[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 2.8);left:calc(var(--ghs-unit) * 4.3)}.objective.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]{position:absolute;left:calc(var(--ghs-unit) * 2);right:calc(var(--ghs-unit) * 2);height:calc(var(--ghs-unit) * 26.5);flex-wrap:wrap}.objective.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 12);width:100%;max-width:initial;flex-direction:row;justify-content:flex-start;align-items:center}.objective.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   ghs-character-initiative[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 10);margin-top:calc(var(--ghs-unit) * 1);margin-left:initial}.objective.short[_ngcontent-%COMP%]:not(.compact)   .stats[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 2)}.objective.compact[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 10.25);background-image:url(char-mat_compact.b0d0dd33f05dffe7.png),url(char-mat_compact.b0d0dd33f05dffe7.png)}.objective.compact[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 2.5);left:calc(var(--ghs-unit) * 6.5);width:calc(var(--ghs-unit) * 5);height:calc(var(--ghs-unit) * 5)}.objective.compact[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%], .objective.compact[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .objective-icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 6.5);height:calc(var(--ghs-unit) * 6.5)}.objective.compact[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .objective-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 8);width:auto}.objective.compact[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .map-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 5.2)}.objective.compact[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 1.8)}.objective.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%], .objective.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .bar-container[_ngcontent-%COMP%]{flex-direction:row;justify-content:flex-start;align-items:center}.objective.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{display:none}.objective.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]{width:auto;height:calc(var(--ghs-unit) * 7 * var(--ghs-text-factor));padding-top:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.objective.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .add-entity[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 6 * var(--ghs-text-factor))}.objective.compact[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]{display:none}.objective.compact.short[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 57)}.objective.compact.short[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 1);width:calc(var(--ghs-unit) * 4.5);height:calc(var(--ghs-unit) * 4.5);margin:calc(var(--ghs-unit) * 2.1) calc(var(--ghs-unit) * .5)}.objective.compact.short[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .objective-icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4.5);height:calc(var(--ghs-unit) * 4.5)}.objective.compact.short[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .objective-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 6);width:auto}.objective.compact.short[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .map-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3.2)}.objective.compact.short[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 1.2)}.objective.compact.short[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 2)}.objective.compact.short[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * .5)}.objective.compact.short[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3);white-space:initial}.objective.compact.short[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%]   .status-bar[_ngcontent-%COMP%]   .health[_ngcontent-%COMP%]{width:auto}.objective.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1.5)}.objective.compact.short[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .short-menu[_ngcontent-%COMP%]{display:none}.objective.compact.short.actions[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .short-menu[_ngcontent-%COMP%]{display:flex;position:absolute;top:0;right:calc(var(--ghs-unit) * 6);bottom:0}.objective.compact.short.actions[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%], .objective.compact.short.actions[_ngcontent-%COMP%]   .add-entity[_ngcontent-%COMP%], .objective.compact.short.actions[_ngcontent-%COMP%]   .column.col-2[_ngcontent-%COMP%]{display:none}.objective.compact.short.menu[_ngcontent-%COMP%]   .column.col-1[_ngcontent-%COMP%], .objective.compact.short.menu[_ngcontent-%COMP%]   .drag-initiative[_ngcontent-%COMP%], .objective.compact.short.menu[_ngcontent-%COMP%]   ghs-highlight-conditions[_ngcontent-%COMP%]{display:none}.objective.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 4.5)}.objective.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{display:none}.objective.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%], .objective.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .add-entity[_ngcontent-%COMP%], .objective.compact.short.menu[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .column.col-2[_ngcontent-%COMP%]{display:inherit}.entities-container[_ngcontent-%COMP%]{position:relative;z-index:2;display:flex;transition:max-height calc(var(--ghs-animation-speed) * 1s) ease-out;max-height:100%;max-width:calc(var(--ghs-unit) * 96);margin-top:calc(var(--ghs-unit) * .25 * var(--ghs-text-factor))}.entities-container.empty[_ngcontent-%COMP%]{max-height:0}.entities-container[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{flex:none;width:calc(var(--ghs-unit) * 17.5);min-height:100%}.entities-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:block;width:auto;height:calc(var(--ghs-unit) * 8.5);margin-right:calc(var(--ghs-unit) * 1)}.entities-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]   img.menu[_ngcontent-%COMP%]{position:absolute;top:50%;left:calc(var(--ghs-unit) * -4);transform:translateY(-50%);width:calc(var(--ghs-unit) * 3.7 * var(--ghs-text-factor));height:auto;filter:var(--ghs-filter-darkgray);opacity:.5}.entities-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]:not(.empty){opacity:1;transform:translate(0)}.entities-container[_ngcontent-%COMP%]   .entities-menu.empty[_ngcontent-%COMP%]{opacity:0;height:0;max-width:0;transform:translateY(100%)}.entities-container[_ngcontent-%COMP%]   .entities-menu.disabled[_ngcontent-%COMP%]{cursor:initial;pointer-events:none}.entities-container[_ngcontent-%COMP%]   .entities-menu.disabled[_ngcontent-%COMP%]   img.menu[_ngcontent-%COMP%]{display:none}.entities-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]:hover   img.icon[_ngcontent-%COMP%]{opacity:.5}.entities-container[_ngcontent-%COMP%]   .entities-menu[_ngcontent-%COMP%]:hover   img.menu[_ngcontent-%COMP%]{opacity:1}.entities-container[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;max-width:calc(var(--ghs-unit) * 77.5)}.entities-container[_ngcontent-%COMP%]   .entities[_ngcontent-%COMP%]   ghs-standee[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * .5);transition:all calc(var(--ghs-animation-speed) * 1s) ease-out}']})}return i})();const OL=["footer"],PL=(i,r)=>({compact:i,modern:r}),Wr=i=>[i],bL=(i,r)=>({fh:i,modern:r}),Jr=i=>({small:i}),kL=(i,r,e,a)=>({"loot-deck":i,"ally-deck":r,"drag-disabled":e,"backup-hint-spacer":a}),yL=(i,r)=>({last:i,short:r}),xL=i=>({enabled:i}),Zr=(i,r,e,a,n,o,g)=>({character:i,monster:r,"objective-container":e,"monster-full":a,"permanent-am":n,compact:o,short:g}),EL=(i,r)=>r.edition,wL=(i,r)=>r.edition+"-"+r.name;function RL(i,r){if(1&i&&(t.j41(0,"span",16),t.nrm(1,"span",18),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","server.connectionTries")("ghs-label-args",t.eq3(2,Wr,e.gameManager.stateManager.connectionTries))}}function jL(i,r){1&i&&(t.j41(0,"span",17),t.nrm(1,"span",11),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","server.connectionTries.hint"))}function GL(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",4)(1,"div",10),t.nrm(2,"span",11),t.j41(3,"div",12)(4,"a",13),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.gameManager.stateManager.forceUpdateState())}),t.nrm(5,"span",11),t.j41(6,"span",14),t.nrm(7,"span",11),t.k0s()(),t.j41(8,"a",15),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.gameManager.stateManager.connect())}),t.nrm(9,"span",11),t.nVh(10,RL,2,4,"span",16),t.nVh(11,jL,2,1,"span",17),t.k0s()()()()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","server.blocked"),t.R7$(3),t.Y8G("ghs-label","server.force"),t.R7$(2),t.Y8G("ghs-label","server.forceHint"),t.R7$(2),t.Y8G("ghs-label","server.connect"),t.R7$(),t.vxM(e.gameManager.stateManager.connectionTries>0?10:-1),t.R7$(),t.vxM(e.gameManager.stateManager.connectionTries>4?11:-1)}}function TL(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",25),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.gameManager.stateManager.install())}),t.nrm(1,"img",26)(2,"span",11),t.k0s()}2&i&&(t.R7$(2),t.Y8G("ghs-label","app.install"))}function SL(i,r){if(1&i&&t.nrm(0,"img",31),2&i){const e=t.XpG().$implicit;t.Y8G("src",e.logoUrl,t.B4B)("ghs-tooltip","data.edition."+e.edition)}}function $L(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",30),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.startCampaign(n.edition))}),t.nVh(1,SL,1,2,"img",31),t.j41(2,"span",32),t.nrm(3,"span",11),t.k0s()()}if(2&i){const e=r.$implicit;t.R7$(),t.vxM(e.logoUrl?1:-1),t.R7$(),t.Y8G("ngClass",t.eq3(3,Jr,e.logoUrl)),t.R7$(),t.Y8G("ghs-label","data.edition."+e.edition)}}function DL(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",33),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3),o=t.sdS(1);return t.Njj(o.openMenu(n.SubMenu.editions))}),t.nrm(1,"img",34)(2,"span",11),t.k0s()}2&i&&(t.R7$(2),t.Y8G("ghs-label","hints.addAdditionalContent"))}function IL(i,r){if(1&i&&(t.j41(0,"div",21),t.nrm(1,"p",11),t.j41(2,"div",27),t.Z7z(3,$L,4,5,"a",28,EL),t.nVh(5,DL,3,1,"a",29),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","welcome.chooseEdition"),t.R7$(2),t.Dyx(e.gameManager.editionsData()),t.R7$(2),t.vxM(!e.gameManager.game.edition&&e.welcomeOtherEditions?5:-1)}}function AL(i,r){if(1&i&&t.nrm(0,"img",31),2&i){const e=t.XpG(3);t.Y8G("src",e.gameManager.editionLogo(e.gameManager.game.edition),t.B4B)("ghs-tooltip","data.edition."+e.gameManager.game.edition)}}function VL(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",36)(1,"div",39)(2,"label")(3,"input",38),t.bIt("change",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.settingsManager.toggle("fhSecondEdition"))}),t.k0s(),t.nrm(4,"span",11),t.k0s(),t.nrm(5,"img",40),t.j41(6,"span",41)(7,"div",42),t.nrm(8,"span",11),t.k0s()()()()}if(2&i){const e=t.XpG(3);t.R7$(3),t.Y8G("checked",e.settingsManager.settings.fhSecondEdition),t.R7$(),t.Y8G("ghs-label","settings.fhSecondEdition"),t.R7$(4),t.Y8G("ghs-label","settings.fhSecondEdition.hint")}}function FL(i,r){if(1&i&&t.nrm(0,"p",11),2&i){const e=t.XpG(3);t.Y8G("ghs-label","data.edition."+e.gameManager.game.edition+".hint")}}function XL(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",21)(1,"div",27)(2,"a",35),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.cancelCampaign(n.gameManager.game.edition))}),t.nVh(3,AL,1,2,"img",31),t.j41(4,"span",32),t.nrm(5,"span",11),t.k0s()()(),t.nVh(6,VL,9,3,"div",36),t.j41(7,"div",37),t.nVh(8,FL,1,1,"p",11),t.j41(9,"label")(10,"input",38),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.toggleCampaignMode())}),t.k0s(),t.nrm(11,"span",11),t.k0s()()()}if(2&i){const e=t.XpG(2);t.R7$(3),t.vxM(e.gameManager.editionLogo(e.gameManager.game.edition)?3:-1),t.R7$(),t.Y8G("ngClass",t.eq3(7,Jr,e.gameManager.editionLogo(e.gameManager.game.edition))),t.R7$(),t.Y8G("ghs-label","data.edition."+e.gameManager.game.edition),t.R7$(),t.vxM("fh"==e.gameManager.game.edition?6:-1),t.R7$(2),t.vxM(e.welcomeEditionHint?8:-1),t.R7$(2),t.Y8G("checked",e.gameManager.game.party.campaignMode),t.R7$(),t.Y8G("ghs-label","party.campaignMode")}}function BL(i,r){1&i&&t.nrm(0,"p",11),2&i&&t.Y8G("ghs-label","welcome.orChooseCharacters")}function YL(i,r){1&i&&t.nrm(0,"p",11),2&i&&t.Y8G("ghs-label","welcome.chooseCharacters")}function NL(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",46),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.loading=!1)}),t.nrm(1,"span",11),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","app.loading.cancel"))}function zL(i,r){if(1&i&&(t.j41(0,"span"),t.nrm(1,"span",11),t.k0s(),t.j41(2,"div",43),t.nrm(3,"div",44),t.k0s(),t.nVh(4,NL,2,1,"a",45)),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","app.loading"),t.R7$(3),t.vxM(e.cancelLoading?4:-1)}}function LL(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",5),t.nrm(1,"img",19),t.nVh(2,TL,3,1,"a",20),t.j41(3,"h2"),t.nrm(4,"span",11),t.k0s(),t.nVh(5,IL,6,2,"div",21),t.nVh(6,XL,12,9,"div",21),t.j41(7,"div",21),t.nVh(8,BL,1,1,"p",11),t.nVh(9,YL,1,1,"p",11),t.j41(10,"a",22),t.bIt("click",function(){t.eBV(e);const n=t.XpG(),o=t.sdS(1);return t.Njj(o.openMenu(n.SubMenu.character_add))}),t.nrm(11,"span",11),t.k0s()(),t.j41(12,"div",23),t.nrm(13,"p",11),t.j41(14,"a",24),t.bIt("click",function(){t.eBV(e);const n=t.XpG(),o=t.sdS(1);return t.Njj(o.openMenu(n.SubMenu.settings))}),t.nrm(15,"span",11),t.k0s()(),t.nVh(16,zL,5,2),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.l_i(11,bL,"fh"==e.settingsManager.settings.theme,"modern"==e.settingsManager.settings.theme)),t.R7$(2),t.vxM(e.gameManager.stateManager.installPrompt?2:-1),t.R7$(2),t.Y8G("ghs-label","welcome"),t.R7$(),t.vxM(e.gameManager.game.edition?-1:5),t.R7$(),t.vxM(e.gameManager.game.edition?6:-1),t.R7$(2),t.vxM(e.gameManager.game.edition?-1:8),t.R7$(),t.vxM(e.gameManager.game.edition?9:-1),t.R7$(2),t.Y8G("ghs-label","hints.addCharacters"),t.R7$(2),t.Y8G("ghs-label","welcome.settings.text"),t.R7$(2),t.Y8G("ghs-label","welcome.settings"),t.R7$(),t.vxM(e.loading?16:-1)}}function UL(i,r){if(1&i&&t.nrm(0,"div",51),2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.Y8G("ngClass",t.sGs(2,Zr,a.gameManager.isCharacter(e),a.gameManager.isMonster(e),a.gameManager.isObjectiveContainer(e),a.settingsManager.settings.showFullAbilityCard,a.gameManager.isCharacter(e)&&a.gameManager.toCharacter(e).attackModifierDeckVisible&&a.settingsManager.settings.characterAttackModifierDeckPermanent,a.gameManager.isCharacter(e)&&a.settingsManager.settings.characterCompact,!(a.settingsManager.settings.abilities&&a.settingsManager.settings.stats||"modern"==a.settingsManager.settings.theme)))("clickBehind",!0)}}function qL(i,r){if(1&i&&t.nrm(0,"ghs-character",9),2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.Y8G("character",a.gameManager.toCharacter(e))}}function HL(i,r){if(1&i&&t.nrm(0,"ghs-monster",52),2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.Y8G("monster",a.gameManager.toMonster(e))}}function KL(i,r){if(1&i&&t.nrm(0,"ghs-objective-container",53),2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.Y8G("objective",a.gameManager.toObjectiveContainer(e))}}function WL(i,r){if(1&i&&t.nrm(0,"div",54),2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.Y8G("ngClass",t.sGs(2,Zr,a.gameManager.isCharacter(e),a.gameManager.isMonster(e),a.gameManager.isObjectiveContainer(e),a.settingsManager.settings.showFullAbilityCard,a.gameManager.isCharacter(e)&&a.gameManager.toCharacter(e).attackModifierDeckVisible&&a.settingsManager.settings.characterAttackModifierDeckPermanent,a.gameManager.isCharacter(e)&&a.settingsManager.settings.characterCompact,!(a.settingsManager.settings.abilities&&a.settingsManager.settings.stats||"modern"==a.settingsManager.settings.theme)))("clickBehind",!0)}}function JL(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",49),t.bIt("cdkDropListDropped",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.drop(n))})("cdkDropListEntered",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.entered(n))})("cdkDropListExited",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.exited(n))}),t.j41(1,"div",50,2),t.bIt("cdkDragStarted",function(n){t.eBV(e);const o=t.sdS(2),g=t.XpG(2);return t.Njj(g.startedDrag(n,o))})("cdkDragReleased",function(n){t.eBV(e);const o=t.sdS(2),g=t.XpG(2);return t.Njj(g.releasedDrag(n,o))}),t.nVh(3,UL,1,10,"div",51),t.nVh(4,qL,1,1,"ghs-character",9),t.nVh(5,HL,1,1,"ghs-monster",52),t.nVh(6,KL,1,1,"ghs-objective-container",53),t.nVh(7,WL,1,10,"div",54),t.k0s()()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.Y8G("figure-autoscroll",e)("block",a==n.lastScroll||a==n.lastScrollColumn?"end":"center")("cdkDropListData",a)("cdkDropListDisabled",!n.settingsManager.settings.dragFigures||n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.characters&&!n.gameManager.stateManager.permissions.monsters)("ngClass",t.l_i(12,yL,-1!=n.grid.indexOf(a+1)&&n.grid.indexOf(a+1)!=n.grid.length-1||a==n.figures.length-1,!(n.settingsManager.settings.abilities&&n.settingsManager.settings.stats||"modern"==n.settingsManager.settings.theme))),t.R7$(),t.Y8G("cdkDragStartDelay",n.isTouch?450:0)("ngClass",t.eq3(15,xL,n.draggingEnabled)),t.R7$(2),t.vxM(!n.gameManager.stateManager.permissions||n.gameManager.stateManager.permissions.characters||n.gameManager.stateManager.permissions.monsters?3:-1),t.R7$(),t.vxM(n.gameManager.isCharacter(e)?4:-1),t.R7$(),t.vxM(n.gameManager.isMonster(e)?5:-1),t.R7$(),t.vxM(n.gameManager.isObjectiveContainer(e)?6:-1),t.R7$(),t.vxM(!n.gameManager.stateManager.permissions||n.gameManager.stateManager.permissions.characters||n.gameManager.stateManager.permissions.monsters?7:-1)}}function ZL(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",47),t.bIt("scroll",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.onFigureScroll(n))}),t.Z7z(1,JL,8,17,"div",48,wL),t.k0s()}if(2&i){const e=t.XpG(),a=t.sdS(10);t.Y8G("ngClass",t.ziG(1,kL,a.lootDeckEnabeld,a.hasAllyAttackModifierDeck,!e.settingsManager.settings.dragFigures,e.showBackupHint)),t.R7$(),t.Dyx(e.figures)}}function QL(i,r){if(1&i&&t.nrm(0,"p",18),2&i){const e=t.XpG(2);t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrl.error.status")("ghs-label-args",t.eq3(2,Wr,e.gameManager.stateManager.backupError))}}function tU(i,r){1&i&&t.nrm(0,"p",11),2&i&&t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrl.error.unknown")}function eU(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",55),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.gameManager.stateManager.backupError=0)}),t.j41(1,"div",10),t.nrm(2,"h2",11),t.nVh(3,QL,1,4,"p",18),t.nVh(4,tU,1,1,"p",11),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrl.error"),t.R7$(),t.vxM(e.gameManager.stateManager.backupError>0?3:-1),t.R7$(),t.vxM(-1==e.gameManager.stateManager.backupError?4:-1)}}function nU(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",8)(1,"div",10)(2,"div",56),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.settingsManager.set("backupHint",!1))}),t.nrm(3,"span",11)(4,"img",57),t.k0s(),t.nrm(5,"h2",11)(6,"p",58),t.j41(7,"a",59),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.exportDataDump())}),t.nrm(8,"img",60)(9,"span",11),t.k0s(),t.j41(10,"label")(11,"input",61),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.settingsManager.setAutoBackupFinish(!n.settingsManager.settings.autoBackupFinish))}),t.k0s(),t.nrm(12,"span",11),t.k0s()()()}if(2&i){const e=t.XpG();t.R7$(3),t.Y8G("ghs-label","datamanagement.backup.download.hint.hide"),t.R7$(2),t.Y8G("ghs-label","datamanagement.backup"),t.R7$(),t.Y8G("ghs-label","datamanagement.backup.download.hint")("ghs-tooltip","datamanagement.backup.download.hint.text")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("ghs-label","datamanagement.backup.download"),t.R7$(2),t.Y8G("checked",e.settingsManager.settings.autoBackupFinish),t.R7$(),t.Y8G("ghs-label","datamanagement.backup.download.onFinish")}}function iU(i,r){if(1&i&&t.nrm(0,"ghs-character-fullview",9),2&i){const e=t.XpG();t.Y8G("character",e.fullviewChar)}}let aU=(()=>{class i{element;swUpdate;dialog;pointerInputService;gameManager=s.E;settingsManager=m.f;GameState=T.mk;figures=[];grid=[];SubMenu=we;initialized=!1;loading=!0;cancelLoading=!1;welcome=!1;welcomeOtherEditions=!1;welcomeEditionHint=!1;fullviewChar;showBackupHint=!1;draggingEnabled=!1;draggingeTimeout=null;isTouch=!1;lastScroll=-1;lastScrollColumn=-1;currentZoom=0;zoomDiff=-1;standeeDialog;standeeDialogSubscription;serverPing=0;serverPingInterval;initiativeSetDialog=!1;footer;constructor(e,a,n,o){var g=this;this.element=e,this.swUpdate=a,this.dialog=n,this.pointerInputService=o,s.E.uiChange.subscribe({next:()=>{if(this.figures=s.E.game.figures.filter(_=>(m.f.settings.monsters||!(_ instanceof P.R))&&(!(_ instanceof q.K)||!_.absent||!m.f.settings.hideAbsent)),this.initialized){const _=s.E.game.figures.find(y=>y instanceof q.K&&y.fullview);_?(this.fullviewChar=_,this.welcome=!1):0==s.E.game.figures.length?(this.welcome=!0,this.welcomeOtherEditions=m.f.settings.editions.length<s.E.editionData.length,this.welcomeEditionHint=s.E.game.edition&&"hint"!=m.f.getLabel("data.edition."+s.E.game.edition+".hint")||!1):(this.fullviewChar=void 0,this.welcome=!1,this.calcColumns(),m.f.settings.automaticStandeesDialog&&m.f.settings.automaticStandees&&m.f.settings.standees&&!m.f.settings.randomStandees&&m.f.settings.scenarioRooms&&(this.standeeDialog&&"undo"==s.E.stateManager.lastAction&&this.standeeDialog.close(),0==this.dialog.openDialogs.length?this.automaticStandeeDialogs():this.standeeDialogSubscription||(this.standeeDialogSubscription=this.dialog.afterAllClosed.subscribe({next:()=>{this.automaticStandeeDialogs()}}))),this.showBackupHint=m.f.settings.backupHint&&!this.loading&&!s.E.game.scenario&&(s.E.game.party.scenarios.length>0||s.E.game.party.casualScenarios.length>0||s.E.game.parties.some(y=>y.casualScenarios.length>0)),m.f.settings.initiativeRequired&&m.f.settings.initiativeRoundConfirm&&s.E.game.state==T.mk.draw&&s.E.game.scenario?null!=s.E.game.figures.find(y=>y instanceof q.K&&s.E.entityManager.isAlive(y)&&!y.absent)&&s.E.game.figures.every(y=>!(y instanceof q.K)||!s.E.entityManager.isAlive(y)||y.absent||y.getInitiative()>0)?this.initiativeSetDialog||(this.initiativeSetDialog=this.dialog.open(ea,{panelClass:["dialog"],data:{label:"round.hint.initiativeRoundConfirm"}}),this.initiativeSetDialog.closed.subscribe({next:y=>{this.initiativeSetDialog="discard",y&&(this.initiativeSetDialog=!1,this.footer.next())}})):(this.initiativeSetDialog instanceof v.ce&&this.initiativeSetDialog.close(),this.initiativeSetDialog=!1):s.E.game.state==T.mk.next&&(this.initiativeSetDialog=!1))}this.serverPing!=m.f.settings.serverPing&&(this.serverPingInterval&&(clearInterval(this.serverPingInterval),this.serverPingInterval=null),this.serverPing=m.f.settings.serverPing,this.serverPing>0&&(this.serverPingInterval=setInterval(()=>{s.E.stateManager.sendPing()},1e3*this.serverPing)))}}),this.swUpdate.versionUpdates.subscribe(_=>{this.loading=!1,"VERSION_READY"==_.type?s.E.stateManager.hasUpdate=!0:"VERSION_INSTALLATION_FAILED"==_.type&&console.error(`Failed to install version '${_.version.hash}': ${_.error}`)}),this.swUpdate.unrecoverable.subscribe(_=>{this.loading=!1}),this.swUpdate.isEnabled?(this.swUpdate.checkForUpdate(),setInterval(()=>{this.swUpdate.checkForUpdate()},3e4)):this.loading=!1,setInterval(()=>{this.cancelLoading=!0},1e4),window.addEventListener("beforeinstallprompt",_=>{_.preventDefault(),s.E.stateManager.installPrompt=_}),window.addEventListener("appinstalled",()=>{s.E.stateManager.installPrompt=null}),window.addEventListener("beforeunload",(0,X.A)(function*(){m.f.settings.gameClock&&m.f.settings.automaticGameClock&&!s.E.stateManager.storageBlocked&&(yield g.automaticClockOut())})),window.addEventListener("blur",(0,X.A)(function*(){m.f.settings.gameClock&&m.f.settings.automaticGameClock&&m.f.settings.automaticGameClockFocus&&!s.E.stateManager.storageBlocked&&(yield g.automaticClockOut())}))}onFigureScroll(e){this.pointerInputService.cancel()}ngOnInit(){var e=this;return(0,X.A)(function*(){e.isTouch=window.matchMedia("(pointer: coarse)").matches,document.body.classList.add("no-select");try{yield w.n.init()}catch{}yield m.f.init(!1),e.initialized=!0,yield s.E.stateManager.init(),e.currentZoom=m.f.settings.zoom,document.body.style.setProperty("--ghs-factor",m.f.settings.zoom+""),document.body.style.setProperty("--ghs-barsize",m.f.settings.barsize+""),document.body.style.setProperty("--ghs-fontsize",m.f.settings.fontsize+""),document.body.style.setProperty("--ghs-global-fontsize",m.f.settings.globalFontsize+""),document.body.style.setProperty("--ghs-animation-speed",m.f.settings.animationSpeed+""),m.f.settings.gameClock&&m.f.settings.automaticGameClock&&e.automaticClockIn();const a=e.figures.find(n=>n instanceof q.K&&n.fullview);if(a?e.fullviewChar=a:(e.fullviewChar=void 0,e.calcColumns()),(e.swUpdate.isEnabled||e.isAppDevMode())&&document.body.addEventListener("click",n=>{m.f.settings.fullscreen&&(e.swUpdate.isEnabled||e.isAppDevMode())&&!document.body.classList.contains("fullscreen")&&document.body.requestFullscreen&&document.body.requestFullscreen()}),window.addEventListener("resize",n=>{e.fullviewChar||e.calcColumns()}),window.addEventListener("fullscreenchange",n=>{e.fullviewChar||e.calcColumns()}),window.addEventListener("focus",n=>{m.f.settings.serverAutoconnect&&s.E.stateManager.wsState()!=WebSocket.OPEN&&s.E.stateManager.connect(),m.f.settings.gameClock&&m.f.settings.automaticGameClock&&m.f.settings.automaticGameClockFocus&&e.automaticClockIn()}),m.f.settings.wakeLock&&"wakeLock"in navigator){try{s.E.stateManager.wakeLock=yield navigator.wakeLock.request("screen")}catch(n){console.error(n)}document.addEventListener("visibilitychange",(0,X.A)(function*(){null!==s.E.stateManager.wakeLock&&"visible"===document.visibilityState&&(s.E.stateManager.wakeLock=yield navigator.wakeLock.request("screen"))}))}e.debugTesting()})()}automaticClockIn(){const e=s.E.game.gameClock.length?s.E.game.gameClock[0]:void 0;(!e||e.clockOut)&&(e&&e.clockOut&&(new Date).getTime()-e.clockOut<7e3?e.clockOut=void 0:s.E.toggleGameClock())}automaticClockOut(){return(0,X.A)(function*(){const e=s.E.game.gameClock.length?s.E.game.gameClock[0]:void 0;e&&!e.clockOut&&(s.E.stateManager.before("gameClock.automaticGameClockOut"),s.E.toggleGameClock(),yield s.E.stateManager.after())})()}zoom(e){this.currentZoom+=e,document.body.style.setProperty("--ghs-factor",this.currentZoom+"")}touchmove(e){if(m.f.settings.pinchZoom&&2===e.touches.length){const a=Math.abs(e.touches[0].clientX-e.touches[1].clientX);this.zoomDiff>0&&(a>this.zoomDiff&&this.zoom(-1),a<this.zoomDiff&&this.zoom(1)),this.zoomDiff=a}}touchend(e){m.f.settings.pinchZoom&&e.touches.length<2&&this.zoomDiff>-1&&(this.zoomDiff=-1,m.f.setZoom(this.currentZoom))}startCampaign(e){s.E.stateManager.before("startCampaign","data.edition."+e),s.E.game.edition=e,m.f.settings.automaticTheme&&"modern"!=m.f.settings.theme&&(m.f.set("theme","fh"==e||"bb"==e?e:"default"),"gh2e"==e&&m.f.set("fhStyle",!0)),s.E.game.party.campaignMode=!0,s.E.game.party.edition=e,this.welcomeEditionHint=e&&"hint"!=m.f.getLabel("data.edition."+e+".hint")||!1,s.E.game.party.eventDecks={},s.E.eventCardManager.buildPartyDeckMigration(e),s.E.stateManager.after()}cancelCampaign(e){s.E.stateManager.before("cancelCampaign","data.edition."+e),s.E.game.edition=void 0,s.E.game.party.campaignMode=!1,s.E.game.party.eventDecks={},s.E.stateManager.after()}toggleCampaignMode(){s.E.stateManager.before(s.E.game.party.campaignMode?"disablePartyCampaignMode":"enablePartyCampaignMode"),s.E.game.party.campaignMode=!s.E.game.party.campaignMode,s.E.stateManager.after()}calcColumns(e=void 0,a=!1){this.grid=[999],m.f.settings.columns?setTimeout(()=>{const n=this.element.nativeElement.getElementsByClassName("figures")[0];if(n){this.lastScroll=this.lastActive();const o=Array.from(n.getElementsByClassName("figure"));if(o.length>0){const g=o[0].firstChild.clientWidth;if(Math.floor(n.clientWidth/(1.025*g))>1){const y=o.slice(0,this.lastScroll+1).map(nt=>nt.clientHeight),B=this.calcColumnsHelper(y,n.clientHeight,n.clientWidth,1.025*g).filter(nt=>nt.length);this.grid=B.map((nt,Z,W)=>W.map(et=>et.length).slice(0,Z+1).reduce((et,it)=>et+it),0)}}this.lastScrollColumn=this.grid.length>1?this.grid.length-1:-1,this.translate(e,a)}},1):setTimeout(()=>{this.element.nativeElement.getElementsByClassName("figures")[0]&&this.translate(e,a)},1)}calcColumnsHelper(e,a,n,o){const g=e.reduce((it,st)=>it+st,0),_=Math.floor(n/o),y=Math.max(g/_,m.f.settings.columnsForce?0:a);let B=Array.from({length:_},()=>[]),nt=Array(_).fill(0),Z=0;e.forEach(it=>{nt[Z]+it>y&&Z<_-1&&Z++,B[Z].push(it),nt[Z]+=it}),B=B.filter(it=>it.length),nt=nt.filter(it=>it);let W=!0,et=0;for(;W;){let it=-1,st=-1,Et=0;for(let pt=0;pt<nt.length;pt++)Math.abs(nt[pt]-nt[pt+1])>Et&&(Et=Math.abs(nt[pt]-nt[pt+1]),nt[pt]<nt[pt+1]?(st=pt,it=pt+1):(st=pt+1,it=pt));if(Et<=et){W=!1;break}if(-1==st||-1==it){W=!1;break}{const pt=B[it].splice(it>st?0:B[it].length-1,1)[0];B[st].push(pt),nt[st]+=pt,nt[it]-=pt,et=Et}}return B}lastActive(){let e=0;return this.figures.forEach((a,n)=>{n>e&&s.E.gameplayFigure(a)&&(e=n)}),e}translate(e=void 0,a=!1){setTimeout(()=>{const n=this.element.nativeElement.getElementsByClassName("figures")[0];if(n){a&&n.classList.add("no-animations");const o=n.getElementsByClassName("figure"),g=Math.ceil(this.grid.length/2);for(let _=0;_<o.length;_++){let y=0,B="0",nt=this.grid.length-1,Z=0;for(let et=this.grid.length;et>0;et--)_<this.grid[et-1]&&(nt=et-1);Z=nt-g,this.grid.length%2==1&&(Z+=.5),B="calc(100% * "+Z+")",y=0==nt?0:this.grid[nt-1];let W=0;for(let et=y;et<_;et++)W+=o[et].clientHeight;o[_].style.transform="scale(1) translate("+B+","+W+"px)",e?setTimeout(()=>{e.scrollIntoView({behavior:m.f.settings.animations?"smooth":"auto",block:_==this.lastScroll||_==this.lastScrollColumn?"end":"center",inline:"center"}),a&&n.classList.remove("no-animations")},!m.f.settings.animations||a?0:250*m.f.settings.animationSpeed):a&&setTimeout(()=>{n.classList.remove("no-animations")},m.f.settings.animations?250*m.f.settings.animationSpeed:0)}}},1)}startedDrag(e,a){this.pointerInputService.cancel(),this.draggingEnabled=!0,a.classList.add("dragging"),e.source.getPlaceholderElement().classList.add("dragging"),window.document.body.classList.add("dragging"),this.draggingeTimeout&&clearTimeout(this.draggingeTimeout)}releasedDrag(e,a){this.draggingEnabled=!1,a.classList.remove("dragging"),window.document.body.classList.remove("dragging"),e.source.getPlaceholderElement().classList.remove("dragging"),this.draggingeTimeout&&clearTimeout(this.draggingeTimeout)}drop(e){if(e.previousContainer!=e.container&&(0==e.currentIndex&&e.container.data!=e.previousContainer.data+1||0!=e.currentIndex&&e.container.data!=e.previousContainer.data-e.currentIndex)){let a=e.previousContainer.data,n=e.container.data;e.currentIndex>0&&e.previousContainer.data>e.container.data?n++:0==e.currentIndex&&e.previousContainer.data<e.container.data&&n--,s.E.stateManager.before("reorder"),(0,D.HD)(s.E.game.figures,a,n),s.E.stateManager.after(),this.calcColumns(e.item.element.nativeElement,!0)}else this.translate(void 0,!0);this.draggingEnabled=!1}entered(e){this.translate()}exited(e){this.translate()}automaticStandeeDialogs(){if(!s.E.stateManager.standeeDialogCanceled&&0==this.dialog.openDialogs.length&&0==s.E.game.scenarioRules.length){const e=s.E.game.figures.find(a=>a instanceof P.R&&a.entities.find(n=>n.number<1&&s.E.entityManager.isAlive(n)));if(e){const a=e;let n=a.entities.find(o=>o.number<1&&s.E.entityManager.isAlive(o)&&(m.f.settings.eliteFirst&&o.type==S.N.elite||!m.f.settings.eliteFirst&&o.type==S.N.normal));n||(n=a.entities.find(o=>o.number<1&&s.E.entityManager.isAlive(o))),this.standeeDialog=this.dialog.open(li,{panelClass:["dialog"],disableClose:!0,data:{monster:a,type:n&&n.type,entity:n,range:[],entities:a.entities,automatic:!0}}),this.standeeDialog.closed.subscribe({next:o=>{o&&(s.E.stateManager.standeeDialogCanceled=!0),this.standeeDialog=void 0,this.standeeDialogSubscription&&(this.standeeDialogSubscription.unsubscribe(),this.standeeDialogSubscription=void 0),s.E.uiChange.emit()}})}}}exportDataDump(){return(0,X.A)(function*(){try{let e=yield w.n.datadump(),a=document.createElement("a");a.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e))),a.setAttribute("download","ghs-data-dump_"+(new Date).toISOString()+".json"),document.body.appendChild(a),a.click(),document.body.removeChild(a)}catch{console.warn("Could not read datadump")}})()}isAppDevMode(){return(0,t.naY)()}debugTesting(){}static \u0275fac=function(a){return new(a||i)(t.rXU(t.aKT),t.rXU(E.EI),t.rXU(v.lG),t.rXU(Oo))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-main"]],viewQuery:function(a,n){if(1&a&&t.GBs(OL,5),2&a){let o;t.mGM(o=t.lsd())&&(n.footer=o.first)}},standalone:!1,decls:11,vars:12,consts:[["header",""],["footer",""],["figureDrag",""],["ghs-keyboard-shortcuts","",3,"ngClass","header","footer"],[1,"dialog","blocked"],[1,"welcome",3,"ngClass"],["cdkDropListGroup","",1,"figures",3,"ngClass"],[1,"dialog","backup-error"],[1,"dialog","backup-hint"],[3,"character"],[1,"dialog-container"],[3,"ghs-label"],[1,"buttons"],[1,"force",3,"click"],[1,"force-hint"],[1,"connect",3,"click"],[1,"tries"],[1,"tries-hint"],[3,"ghs-label","ghs-label-args"],["src","./assets/images/logo-transparent.svg",1,"ghs-logo"],[1,"install"],[1,"container-row","bordered"],["tabclick","",1,"add-characters",3,"click"],[1,"container-row","settings"],["tabclick","",1,"settings-menu",3,"click"],[1,"install",3,"click"],["src","./assets/images/install.svg",1,"ghs-svg"],[1,"editions"],["tabclick","",1,"edition"],["tabclick","",1,"edition","add-additional-content"],["tabclick","",1,"edition",3,"click"],[3,"src","ghs-tooltip"],[1,"text",3,"ngClass"],["tabclick","",1,"edition","add-additional-content",3,"click"],["src","./assets/images/plus.svg",1,"ghs-svg"],["tabclick","",1,"edition","selected",3,"click"],[1,"fh-second-edition"],[1,"edition-hint"],["tabclick","","type","checkbox",3,"change","checked"],[1,"hint-container"],["src","./assets/images/hint.svg",1,"hint-trigger","ghs-svg"],[1,"hint"],[1,"text"],[1,"loading-bar-container"],[1,"loading-bar"],[1,"loading-cancel"],[1,"loading-cancel",3,"click"],["cdkDropListGroup","",1,"figures",3,"scroll","ngClass"],["cdkDropList","","cdkDropListAutoScrollStep","20",1,"figure",3,"figure-autoscroll","block","cdkDropListData","cdkDropListDisabled","ngClass"],["cdkDropList","","cdkDropListAutoScrollStep","20",1,"figure",3,"cdkDropListDropped","cdkDropListEntered","cdkDropListExited","figure-autoscroll","block","cdkDropListData","cdkDropListDisabled","ngClass"],["cdkDrag","",3,"cdkDragStarted","cdkDragReleased","cdkDragStartDelay","ngClass"],["cdkDragHandle","","ghs-pointer-input","",1,"handle",3,"ngClass","clickBehind"],[3,"monster"],[3,"objective"],["cdkDragHandle","","ghs-pointer-input","",1,"handle","right",3,"ngClass","clickBehind"],[1,"dialog","backup-error",3,"click"],[1,"hide",3,"click"],["src","./assets/images/close.svg"],[3,"ghs-label","ghs-tooltip","originY","overlayY"],[3,"click"],["src","./assets/images/export.svg",1,"ghs-svg"],["type","checkbox",3,"change","checked"]],template:function(a,n){if(1&a&&(t.nrm(0,"ghs-header",null,0),t.j41(2,"main",3),t.nVh(3,GL,12,6,"div",4),t.nVh(4,LL,17,14,"div",5),t.nVh(5,ZL,3,6,"div",6),t.nVh(6,eU,5,3,"div",7),t.nVh(7,nU,13,9,"div",8),t.nVh(8,iU,1,1,"ghs-character-fullview",9),t.k0s(),t.nrm(9,"ghs-footer",null,1)),2&a){const o=t.sdS(1),g=t.sdS(10);t.R7$(2),t.Y8G("ngClass",t.l_i(9,PL,g.compact,"modern"==n.settingsManager.settings.theme))("header",o)("footer",g),t.R7$(),t.vxM(n.gameManager.stateManager.updateBlocked&&n.settingsManager.settings.serverUrl&&n.settingsManager.settings.serverPort&&n.settingsManager.settings.serverCode?3:-1),t.R7$(),t.vxM(!n.fullviewChar&&n.welcome?4:-1),t.R7$(),t.vxM(n.fullviewChar||n.welcome?-1:5),t.R7$(),t.vxM(n.gameManager.stateManager.backupError?6:-1),t.R7$(),t.vxM(n.showBackupHint?7:-1),t.R7$(),t.vxM(n.fullviewChar?8:-1)}},dependencies:[N.YU,D.O7,D.RK,D.T1,D.Fb,Vs,yj,Wg,X9,tt,ft,ge,Vi,bz,vL,rt,At],styles:['[_nghost-%COMP%]{overflow:hidden}ghs-header[_ngcontent-%COMP%], ghs-footer[_ngcontent-%COMP%]{position:fixed;left:0;right:0;z-index:2;flex-shrink:0}ghs-header[_ngcontent-%COMP%]{top:0;height:calc(var(--ghs-unit) * 8 * var(--ghs-text-factor) * var(--ghs-barsize))}ghs-footer[_ngcontent-%COMP%]{bottom:0;height:calc(var(--ghs-unit) * 11 * var(--ghs-text-factor) * var(--ghs-barsize))}main[_ngcontent-%COMP%]{position:fixed;left:0;right:0;top:calc(var(--ghs-unit) * 8 * var(--ghs-text-factor) * var(--ghs-barsize));bottom:calc(var(--ghs-unit) * 11 * var(--ghs-text-factor) * var(--ghs-barsize));display:flex;flex-direction:column;align-items:center;z-index:1}.loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%;height:100%;overflow:auto;color:var(--ghs-color-darkgray);font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.loading[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-width:calc(var(--ghs-unit) * 30 * var(--ghs-text-factor));border-radius:5px}.loading[_ngcontent-%COMP%]   .ghs-logo[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));filter:var(--ghs-filter-outline)}.blocked[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:999;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));text-align:center;color:var(--ghs-color-white)}.blocked[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));justify-content:space-evenly;align-items:flex-start}.blocked[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;min-width:33%;display:flex;justify-content:center}.blocked[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.6}.blocked[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;color:var(--ghs-color-green)}.blocked[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%]   .tries[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.blocked[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%]   .tries-hint[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));color:var(--ghs-color-yellow-light)}.blocked[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .force[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;color:var(--ghs-color-yellow)}.blocked[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .force[_ngcontent-%COMP%]   .force-hint[_ngcontent-%COMP%]{font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));color:var(--ghs-color-yellow-light)}.welcome[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:center;width:100%;height:100%;overflow:auto}.welcome[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-width:calc(var(--ghs-unit) * 35 * var(--ghs-text-factor));border-radius:5px;filter:var(--ghs-filter-shadow)}.welcome[_ngcontent-%COMP%]   .ghs-logo[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));max-width:calc(var(--ghs-unit) * 25 * var(--ghs-text-factor));filter:var(--ghs-filter-outline)}.welcome[_ngcontent-%COMP%]   .loading-bar-container[_ngcontent-%COMP%]{height:2px;width:100%;max-width:calc(var(--ghs-unit) * 30 * var(--ghs-text-factor));overflow:hidden;position:relative;background-color:var(--ghs-color-gray);border-radius:2px}.welcome[_ngcontent-%COMP%]   .loading-bar-container[_ngcontent-%COMP%]   .loading-bar[_ngcontent-%COMP%]{height:100%;width:50%;background-color:var(--ghs-color-darkgray);position:absolute;left:-50%;animation:_ngcontent-%COMP%_loading calc(var(--ghs-animation-speed) * .2s) ease-in calc(var(--ghs-animation-speed) * .5s) infinite;border-radius:2px}@keyframes _ngcontent-%COMP%_loading{0%{transform:translate(0)}to{transform:translate(400%)}}.welcome[_ngcontent-%COMP%]   .loading-cancel[_ngcontent-%COMP%]{cursor:pointer;margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor));color:var(--ghs-color-darkgray);font-family:var(--ghs-font-text)}.welcome[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray);font-size:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor));text-align:center;margin-top:calc(var(--ghs-unit) * -7 * var(--ghs-text-factor));margin-bottom:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));text-shadow:var(--ghs-outline-white-thin)}.welcome[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray);font-family:var(--ghs-font-text);margin:calc(var(--ghs-unit) * .2 * var(--ghs-text-factor));font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));text-align:center}.welcome[_ngcontent-%COMP%]   .container-row[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;padding-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 80 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .container-row.bordered[_ngcontent-%COMP%]{border-bottom:calc(var(--ghs-unit) * .3 * var(--ghs-text-factor)) solid var(--ghs-color-darkgray)}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;max-width:calc(var(--ghs-unit) * 80 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;cursor:pointer;max-width:calc(var(--ghs-unit) * 40 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor)) calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));text-shadow:var(--ghs-outline)}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]   .text.small[_ngcontent-%COMP%]{display:none;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));color:var(--ghs-color-darkgray);text-shadow:none}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.selected[_ngcontent-%COMP%], .welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.selected[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:calc(var(--ghs-unit) * 50 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.selected[_ngcontent-%COMP%]   .text.small[_ngcontent-%COMP%]{display:block}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]:hover{filter:brightness(.8) grayscale(.4)}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]:hover   .text[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.add-additional-content[_ngcontent-%COMP%]{flex-direction:row;color:var(--ghs-color-darkgray);font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.add-additional-content[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1.2em;width:auto;margin:0 .2em;filter:var(--ghs-filter-darkgray)}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.add-additional-content[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.add-additional-content[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}@media (orientation: portrait){.welcome[_ngcontent-%COMP%]   .ghs-logo[_ngcontent-%COMP%]{max-width:calc(var(--ghs-unit) * 20 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%], .welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:calc(var(--ghs-unit) * 50 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%]   .text.small[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.selected[_ngcontent-%COMP%], .welcome[_ngcontent-%COMP%]   .editions[_ngcontent-%COMP%]   .edition.selected[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:calc(var(--ghs-unit) * 60 * var(--ghs-text-factor))}}.welcome[_ngcontent-%COMP%]   .fh-second-edition[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .fh-second-edition[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{color:var(--ghs-color-black)}.welcome[_ngcontent-%COMP%]   .fh-second-edition[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before{color:var(--ghs-color-black);background-color:var(--ghs-color-black)}.welcome[_ngcontent-%COMP%]   .fh-second-edition[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover:before{background-color:var(--ghs-color-darkgray)}.welcome[_ngcontent-%COMP%]   .fh-second-edition[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center}.welcome[_ngcontent-%COMP%]   .fh-second-edition[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   .hint-trigger.ghs-svg[_ngcontent-%COMP%]{width:auto;filter:var(--ghs-filter-black) var(--ghs-filter-shadow)}.welcome[_ngcontent-%COMP%]   .edition-hint[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.welcome[_ngcontent-%COMP%]   .edition-hint[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));color:var(--ghs-color-darkgray);text-align:justify}.welcome[_ngcontent-%COMP%]   .edition-hint[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 3 * var(--ghs-text-factor));color:var(--ghs-color-black);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .edition-hint[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{color:var(--ghs-color-black)}.welcome[_ngcontent-%COMP%]   .edition-hint[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before{color:var(--ghs-color-black);background-color:var(--ghs-color-black)}.welcome[_ngcontent-%COMP%]   .edition-hint[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover:before{background-color:var(--ghs-color-darkgray)}.welcome[_ngcontent-%COMP%]   .settings-menu[_ngcontent-%COMP%], .welcome[_ngcontent-%COMP%]   .add-characters[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray);cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 4 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .settings-menu[_ngcontent-%COMP%]:hover, .welcome[_ngcontent-%COMP%]   .add-characters[_ngcontent-%COMP%]:hover{opacity:.6}.welcome[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]   .settings-menu[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-text-factor));margin:calc(var(--ghs-unit) * .2 * var(--ghs-text-factor))}.welcome[_ngcontent-%COMP%]   .install[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;justify-content:center;color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 4.5 * var(--ghs-text-factor) * var(--ghs-barsize));z-index:2}.welcome[_ngcontent-%COMP%]   .install[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:.9em;height:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.welcome[_ngcontent-%COMP%]   .install[_ngcontent-%COMP%]:hover{color:var(--ghs-color-darkgray)}.welcome[_ngcontent-%COMP%]   .install[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)}.welcome.fh[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .welcome.fh[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .welcome.fh[_ngcontent-%COMP%]   .install[_ngcontent-%COMP%]{color:var(--ghs-color-black)}.welcome.fh[_ngcontent-%COMP%]   .install[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-black)}.welcome.fh[_ngcontent-%COMP%]   .edition[_ngcontent-%COMP%], .welcome.fh[_ngcontent-%COMP%]   .add-characters[_ngcontent-%COMP%]{color:var(--ghs-color-darkgray);filter:none}.columns[_ngcontent-%COMP%]{display:flex;width:100%;overflow:auto;-ms-overflow-style:none;scrollbar-width:none}.columns[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.figures[_ngcontent-%COMP%]{display:flex;height:100%;max-height:100%;width:100%;max-width:100%;overflow:auto;transform:translateZ(0);scroll-behavior:smooth;transform-style:preserve-3d;scrollbar-width:none;-ms-overflow-style:none}.figures[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.figures[_ngcontent-%COMP%]   .figure[_ngcontent-%COMP%]{position:absolute;top:0;left:50%;transition:transform calc(var(--ghs-animation-speed) * .25s) ease-in-out,width calc(var(--ghs-animation-speed) * .1s) ease-in-out,height calc(var(--ghs-animation-speed) * .25s) ease-in-out;transform:scale(0);overflow:unset}.figures[_ngcontent-%COMP%]   .figure[_ngcontent-%COMP%]   .cdk-drag[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 98);margin:calc(var(--ghs-unit) * .8) calc(var(--ghs-unit) * 1)}.figures[_ngcontent-%COMP%]   .figure[_ngcontent-%COMP%]   .cdk-drag[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(2){position:relative;display:block}.figures[_ngcontent-%COMP%]   .figure[_ngcontent-%COMP%]   .cdk-drag.enabled[_ngcontent-%COMP%]{cursor:grabbing}.figures[_ngcontent-%COMP%]   .figure[_ngcontent-%COMP%]   .cdk-drag.dragging[_ngcontent-%COMP%]:before{content:" ";position:absolute;top:calc(var(--ghs-unit) * -1);left:calc(var(--ghs-unit) * -1);bottom:calc(var(--ghs-unit) * -1);right:calc(var(--ghs-unit) * -1);border-radius:calc(var(--ghs-unit) * 1);background-color:var(--ghs-color-darkgray);opacity:.5}.figures[_ngcontent-%COMP%]   .figure.short[_ngcontent-%COMP%]   .cdk-drag[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 57)}.figures.ally-deck[_ngcontent-%COMP%]   .figure.last[_ngcontent-%COMP%]{padding-bottom:calc(var(--ghs-unit) * 14.5 * var(--ghs-text-factor) * var(--ghs-barsize))}.figures.loot-deck[_ngcontent-%COMP%]   .figure.last[_ngcontent-%COMP%]{padding-bottom:calc(var(--ghs-unit) * 25.5 * var(--ghs-text-factor) * var(--ghs-barsize))}.figures.backup-hint-spacer[_ngcontent-%COMP%]   .figure.last[_ngcontent-%COMP%]{padding-bottom:50%!important}.figures.drag-disabled[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{display:none}.compact[_ngcontent-%COMP%]   .figures[_ngcontent-%COMP%]   .figure.last[_ngcontent-%COMP%]{padding-bottom:calc(var(--ghs-unit) * 13.5 * var(--ghs-text-factor) * var(--ghs-barsize))}.compact[_ngcontent-%COMP%]   .figures.ally-deck[_ngcontent-%COMP%]   .figure.last[_ngcontent-%COMP%], .compact[_ngcontent-%COMP%]   .figures.loot-deck[_ngcontent-%COMP%]   .figure.last[_ngcontent-%COMP%]{padding-bottom:calc(var(--ghs-unit) * 26.5 * var(--ghs-text-factor) * var(--ghs-barsize))}.handle[_ngcontent-%COMP%]{position:absolute;cursor:grab;top:0;left:calc(var(--ghs-unit) * (-2 + var(--ghs-text-factor)));width:calc(var(--ghs-unit) * 8);height:100%;z-index:2}.handle[_ngcontent-%COMP%]:hover:before{display:block;content:" ";position:absolute;left:calc(var(--ghs-unit) * -.5);width:calc(var(--ghs-unit) * 1);height:100%;background-color:var(--ghs-color-darkgray);opacity:.5;border-radius:calc(var(--ghs-unit) * 1)}.handle.enabled[_ngcontent-%COMP%]{cursor:grabbing}.handle.short[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4)}.handle.character[_ngcontent-%COMP%], .handle.objective-container[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 14)}.handle.character.character.compact[_ngcontent-%COMP%], .handle.objective-container.character.compact[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 10.25)}.handle.monster[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 21.5)}.handle.monster.monster-full[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 24)}.handle.right[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * (-2 + var(--ghs-text-factor)));left:auto}.handle.right[_ngcontent-%COMP%]:hover:before{right:calc(var(--ghs-unit) * -.5);left:auto}.handle.right.character.compact[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4)}.modern[_ngcontent-%COMP%]   .handle.character[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 16)}.modern[_ngcontent-%COMP%]   .handle.character.character.permanent-am[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 28)}.cdk-drag-preview[_ngcontent-%COMP%]{padding:calc(var(--ghs-unit) * .5) calc(var(--ghs-unit) * 1)}.cdk-drag-preview[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{display:none}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.8;transform:initial;margin-bottom:calc(var(--ghs-unit) * .5)}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%], .cdk-drop-list-receiving[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{display:none}.cdk-drop-list-dragging[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform calc(var(--ghs-animation-speed) * .25s) cubic-bezier(0,0,.2,1)}.backup-error[_ngcontent-%COMP%]{cursor:zoom-out;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center}.backup-error[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--ghs-color-yellow);font-size:2em;padding:0;margin:calc(var(--ghs-unit) * .5) 0}.backup-error[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ghs-color-white);font-size:1.5em}.backup-hint[_ngcontent-%COMP%]{position:absolute;bottom:0;display:flex;flex-direction:column;align-items:center;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));color:var(--ghs-color-white)}.backup-hint[_ngcontent-%COMP%]   .hide[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-text-factor));color:var(--ghs-color-darkgray);cursor:pointer;display:flex;justify-content:flex-end;align-items:center;z-index:1;margin-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-text-factor))}.backup-hint[_ngcontent-%COMP%]   .hide[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;width:auto;margin:0 .2em;filter:var(--ghs-filter-darkgray)}.backup-hint[_ngcontent-%COMP%]   .hide[_ngcontent-%COMP%]:hover{color:var(--ghs-color-gray)}.backup-hint[_ngcontent-%COMP%]   .hide[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}.backup-hint[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2em;padding:0;margin:calc(var(--ghs-unit) * .5) 0}.backup-hint[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1em;padding:0;margin:calc(var(--ghs-unit) * .5) 0}.backup-hint[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer;font-size:1.5em;color:var(--ghs-color-gray);margin:calc(var(--ghs-unit) * 1.5) 0}.backup-hint[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}.backup-hint[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-gray)}.backup-hint[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer}.backup-hint[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{color:var(--ghs-color-gray);width:1.2em;height:1.2em;border-width:.1em;margin-right:.3em}.backup-hint[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before{color:var(--ghs-color-gray);background-color:var(--ghs-color-gray)}']})}return i})();const Qr=(i,r)=>r.edition+"-"+r.name;function oU(i,r){if(1&i&&(t.j41(0,"option",5),t.nrm(1,"span",3),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ghs-label","data.edition."+e)}}function sU(i,r){if(1&i&&(t.j41(0,"option",5),t.nrm(1,"span",3),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e.name),t.R7$(),t.Y8G("ghs-label","data.character."+e.edition+"."+e.name)}}function rU(i,r){if(1&i&&t.nrm(0,"ghs-attackmodifier",9),2&i){const e=r.$implicit,a=t.XpG(2).$implicit,n=t.XpG();t.Y8G("attackModifier",e)("flipped",!0)("characterIcon",n.gameManager.characterManager.characterIcon(a))("newStyle",n.settingsManager.settings.fhStyle||n.gameManager.newAmStyle(a.edition))}}function cU(i,r){if(1&i&&(t.j41(0,"div",8)(1,"h1"),t.nrm(2,"span",3),t.EFF(3),t.k0s(),t.Z7z(4,rU,1,4,"ghs-attackmodifier",9,t.fX1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(2),t.Y8G("ghs-label","data.character."+e.edition+"."+e.name),t.R7$(),t.SpI(" [",e.attackModifierDeck.cards.length,"] "),t.R7$(),t.Dyx(e.attackModifierDeck.cards)}}function lU(i,r){if(1&i&&t.nVh(0,cU,6,2,"div",8),2&i){const e=r.$implicit;t.vxM(e&&e.attackModifierDeck.cards.length>0?0:-1)}}let gU=(()=>{class i{route;router;gameManager=s.E;settingsManager=m.f;characterName=[];characters=[];filteredCharacters=[];edition;constructor(e,a){this.route=e,this.router=a}ngOnInit(){var e=this;return(0,X.A)(function*(){yield m.f.init(!1),s.E.stateManager.init(!0),e.edition=s.E.editions(!0)[0],e.update(),e.route.queryParams.subscribe({next:a=>{let n=!1;a.edition&&(e.edition=a.edition,e.edition&&s.E.editions(!0).indexOf(e.edition),n=!0),a.characters&&(e.characterName="string"==typeof a.characters?[a.characters]:a.characters,n=!0),n&&e.update()}})})()}update(){this.characters=[],s.E.charactersData(this.edition).forEach(e=>{let a=new q.K(e,0);a.attackModifierDeck.cards=[];let n=0;a.perks.forEach(o=>{o.cards&&o.cards.forEach((g,_)=>{if(o.type==En.RU.add||o.type==En.RU.replace){let y=Object.assign(new Y.uU(g.attackModifier.type),g.attackModifier);if(y.id="perk"+n,(!s.E.attackModifierManager.findByAttackModifier(Y.zs,y)||o.type==En.RU.add||_>0)&&(y.character=!0),y.character){s.E.attackModifierManager.findByAttackModifier(a.attackModifierDeck.cards,y)||n++;for(let B=0;B<g.count*o.count;B++)a.attackModifierDeck.cards.push(y)}}})}),this.characters.push(a)}),this.characters.sort((e,a)=>e.edition!=a.edition?e.edition<a.edition?-1:1:m.f.getLabel("data.character."+e.edition+"."+e.name).toLowerCase()<m.f.getLabel("data.character."+a.edition+"."+a.name).toLowerCase()?-1:1),this.filteredCharacters=[],this.characterName.forEach(e=>{const a=this.characters.find(n=>n.name==e);a&&this.filteredCharacters.push(a)})}updateQueryParams(){this.router.navigate([],{relativeTo:this.route,queryParams:{edition:this.edition||void 0,characters:this.characterName||void 0},queryParamsHandling:"merge"})}static \u0275fac=function(a){return new(a||i)(t.rXU(U.nX),t.rXU(U.Ix))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-attackmodifier-tool"]],standalone:!1,decls:16,vars:5,consts:[[1,"container"],[3,"standalone"],[1,"menu"],[3,"ghs-label"],[3,"ngModelChange","change","ngModel"],[3,"value"],["multiple","",3,"ngModelChange","change","ngModel"],[1,"characters"],[1,"character"],[3,"attackModifier","flipped","characterIcon","newStyle"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nrm(1,"ghs-header",1),t.j41(2,"div",2)(3,"label"),t.nrm(4,"span",3),t.j41(5,"select",4),t.mxI("ngModelChange",function(g){return t.DH7(n.edition,g)||(n.edition=g),g}),t.bIt("change",function(){return n.update(),n.updateQueryParams()}),t.Z7z(6,oU,2,2,"option",5,t.fX1),t.k0s()(),t.j41(8,"label"),t.nrm(9,"span",3),t.j41(10,"select",6),t.mxI("ngModelChange",function(g){return t.DH7(n.characterName,g)||(n.characterName=g),g}),t.bIt("change",function(){return n.update(),n.updateQueryParams()}),t.Z7z(11,sU,2,2,"option",5,Qr),t.k0s()()(),t.j41(13,"div",7),t.Z7z(14,lU,1,1,null,null,Qr),t.k0s()()),2&a&&(t.R7$(),t.Y8G("standalone",!0),t.R7$(3),t.Y8G("ghs-label","settings.edition"),t.R7$(),t.R50("ngModel",n.edition),t.R7$(),t.Dyx(n.gameManager.editions(!0)),t.R7$(3),t.Y8G("ghs-label","settings.character"),t.R7$(),t.R50("ngModel",n.characterName),t.R7$(),t.Dyx(n.characters),t.R7$(3),t.Dyx(n.filteredCharacters))},dependencies:[O.xH,O.y7,O.wz,O.W0,O.BC,O.vS,Ln,tt,ge],styles:[".container[_ngcontent-%COMP%]{width:100vw;height:100vh;display:flex;flex-direction:column}.container[_ngcontent-%COMP%]   ghs-header[_ngcontent-%COMP%]{z-index:2}.characters[_ngcontent-%COMP%]{display:flex;overflow:auto}.characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{display:flex;flex-direction:column}.characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   ghs-attackmodifier[_ngcontent-%COMP%]{width:300px;min-width:300px;height:200px;min-height:200px;margin:10px}"]})}return i})();const dU=i=>({"bottom-actions":i}),tc=(i,r)=>r.edition+"-"+r.name,ec=(i,r)=>r.cardId;function hU(i,r){if(1&i&&(t.j41(0,"option",5),t.nrm(1,"span",3),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ghs-label","data.edition."+e)}}function _U(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",7),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return n.settingsManager.toggle("calculateStats"),t.Njj(n.update())}),t.k0s(),t.nrm(2,"span",3),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("checked",e.settingsManager.settings.calculateStats),t.R7$(),t.Y8G("ghs-label","settings.calcStats")}}function mU(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",6),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.entity,n)||(o.entity=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return n.update(),t.Njj(n.updateQueryParams())}),t.k0s(),t.nrm(2,"span",3),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.R50("ngModel",e.entity),t.R7$(),t.Y8G("ghs-label","tools.decks.entity")}}function pU(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",6),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.elite,n)||(o.elite=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.update())}),t.k0s(),t.nrm(2,"span",3),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.R50("ngModel",e.elite),t.R7$(),t.Y8G("ghs-label","tools.decks.elite")}}function uU(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",9),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.level,n)||(o.level=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.update())}),t.k0s(),t.nrm(2,"span",3),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.R50("ngModel",e.level),t.R7$(),t.Y8G("ghs-label","tools.decks.level")}}function fU(i,r){if(1&i&&(t.j41(0,"small"),t.nrm(1,"span",3),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.R7$(),t.Y8G("ghs-label","data.deck."+a.deck(e).name)}}function CU(i,r){if(1&i&&t.nrm(0,"ghs-ability",11),2&i){const e=r.$implicit,a=t.XpG(),n=a.$implicit,o=a.$index,g=t.XpG(2);t.Y8G("ability",e)("abilities",g.deck(n).abilities)("character",g.characters[o])("flipped",!0)}}function MU(i,r){if(1&i&&(t.j41(0,"div",10)(1,"h2"),t.nrm(2,"span",3),t.nVh(3,fU,2,1,"small"),t.k0s(),t.Z7z(4,CU,1,4,"ghs-ability",11,ec),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","data.character."+e.edition+"."+e.name),t.R7$(),t.vxM(e.name!=a.deck(e).name?3:-1),t.R7$(),t.Dyx(a.deck(e).abilities)}}function vU(i,r){if(1&i&&t.Z7z(0,MU,6,2,"div",10,tc),2&i){const e=t.XpG();t.Dyx(e.characters)}}function OU(i,r){if(1&i&&(t.j41(0,"small"),t.nrm(1,"span",3),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.R7$(),t.Y8G("ghs-label","data.deck."+a.deck(e).name)}}function PU(i,r){if(1&i&&t.nrm(0,"ghs-ability",12),2&i){const e=r.$implicit,a=t.XpG(),n=a.$implicit,o=a.$index,g=t.XpG(2);t.Y8G("ability",e)("abilities",g.deck(n).abilities)("monster",g.monsters[o])("flipped",!0)("ngClass",t.eq3(5,dU,e.bottomActions&&e.bottomActions.length>0))}}function bU(i,r){if(1&i&&(t.j41(0,"div",10)(1,"h2"),t.nrm(2,"span",3),t.nVh(3,OU,2,1,"small"),t.k0s(),t.Z7z(4,PU,1,7,"ghs-ability",12,ec),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","data.monster."+e.name),t.R7$(),t.vxM(e.name!=a.deck(e).name?3:-1),t.R7$(),t.Dyx(a.deck(e).abilities)}}function kU(i,r){if(1&i&&t.Z7z(0,bU,6,2,"div",10,tc),2&i){const e=t.XpG();t.Dyx(e.monsters)}}let yU=(()=>{class i{route;router;gameManager=s.E;settingsManager=m.f;edition;monsters=[];characters=[];character=!1;entity=!0;elite=!0;level=1;constructor(e,a){this.route=e,this.router=a}ngOnInit(){var e=this;return(0,X.A)(function*(){yield m.f.init(!1),s.E.stateManager.init(!0),e.edition=s.E.editions(!0)[0],e.update(),e.route.queryParams.subscribe({next:a=>{a.edition&&(e.edition=a.edition,e.edition&&s.E.editions(!0).indexOf(e.edition),e.update())}})})()}update(){if(this.monsters=[],this.characters=[],this.character){const e=s.E.editionData.filter(a=>a.edition==this.edition).map(a=>a.characters).flat().filter(a=>s.E.decksData().some(n=>n.name==a.deck||n.name==a.name));this.characters=e.sort((a,n)=>a.name.toLowerCase()<n.name.toLowerCase()?-1:1).map(a=>new q.K(a,this.level))}else{const e=s.E.editionData.filter(a=>a.edition==this.edition).map(a=>a.monsters).flat().filter((a,n,o)=>a.replace||!a.replace&&!o.find(g=>g.replace&&g.name==a.name&&g.edition==a.edition));this.monsters=e.sort((a,n)=>a.name.toLowerCase()<n.name.toLowerCase()?-1:1).map(a=>{let n=new P.R(a,this.level);return n.boss&&this.entity&&s.E.monsterManager.addMonsterEntity(n,1,S.N.boss),!n.boss&&this.elite&&s.E.monsterManager.addMonsterEntity(n,1,S.N.elite),!n.boss&&this.entity&&s.E.monsterManager.addMonsterEntity(n,2,S.N.normal),n})}s.E.uiChange.emit()}deck(e){return s.E.deckData(e)}updateQueryParams(){this.router.navigate([],{relativeTo:this.route,queryParams:{edition:this.edition||void 0},queryParamsHandling:"merge"})}static \u0275fac=function(a){return new(a||i)(t.rXU(U.nX),t.rXU(U.Ix))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-decks-tool"]],standalone:!1,decls:24,vars:15,consts:[[1,"container"],[3,"standalone"],[1,"menu"],[3,"ghs-label"],[3,"ngModelChange","change","ngModel"],[3,"value"],["type","checkbox",3,"ngModelChange","change","ngModel"],["type","checkbox",3,"change","checked"],[1,"decks"],["type","number","min","0","max","7",3,"ngModelChange","change","ngModel"],[1,"deck"],[1,"bottom-actions",3,"ability","abilities","character","flipped"],[3,"ability","abilities","monster","flipped","ngClass"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nrm(1,"ghs-header",1),t.j41(2,"div",2)(3,"label"),t.nrm(4,"span",3),t.j41(5,"select",4),t.mxI("ngModelChange",function(g){return t.DH7(n.edition,g)||(n.edition=g),g}),t.bIt("change",function(){return n.update(),n.updateQueryParams()}),t.Z7z(6,hU,2,2,"option",5,t.fX1),t.k0s()(),t.j41(8,"label")(9,"input",6),t.mxI("ngModelChange",function(g){return t.DH7(n.character,g)||(n.character=g),g}),t.bIt("change",function(){return n.update()}),t.k0s(),t.nrm(10,"span",3),t.k0s(),t.j41(11,"label")(12,"input",7),t.bIt("change",function(){return n.settingsManager.toggle("calculate"),n.update()}),t.k0s(),t.nrm(13,"span",3),t.k0s(),t.nVh(14,_U,3,2,"label"),t.nVh(15,mU,3,2,"label"),t.nVh(16,pU,3,2,"label"),t.nVh(17,uU,3,2,"label"),t.j41(18,"label")(19,"input",7),t.bIt("change",function(){return n.settingsManager.toggle("fhStyle"),n.gameManager.uiChange.emit()}),t.k0s(),t.nrm(20,"span",3),t.k0s()(),t.j41(21,"div",8),t.nVh(22,vU,2,0),t.nVh(23,kU,2,0),t.k0s()()),2&a&&(t.R7$(),t.Y8G("standalone",!0),t.R7$(3),t.Y8G("ghs-label","settings.edition"),t.R7$(),t.R50("ngModel",n.edition),t.R7$(),t.Dyx(n.gameManager.editions(!0)),t.R7$(3),t.R50("ngModel",n.character),t.R7$(),t.Y8G("ghs-label","tools.decks.character"),t.R7$(2),t.Y8G("checked",n.settingsManager.settings.calculate),t.R7$(),t.Y8G("ghs-label","settings.calc"),t.R7$(),t.vxM(n.settingsManager.settings.calculate?14:-1),t.R7$(),t.vxM(n.settingsManager.settings.calculate&&!n.character?15:-1),t.R7$(),t.vxM(n.settingsManager.settings.calculate&&!n.character?16:-1),t.R7$(),t.vxM(n.settingsManager.settings.calculate?17:-1),t.R7$(2),t.Y8G("checked",n.settingsManager.settings.fhStyle),t.R7$(),t.Y8G("ghs-label","settings.fhStyle"),t.R7$(2),t.vxM(n.characters.length>0?22:-1),t.R7$(),t.vxM(n.monsters.length>0?23:-1))},dependencies:[N.YU,O.xH,O.y7,O.me,O.Q0,O.Zm,O.wz,O.BC,O.VZ,O.zX,O.vS,en,tt,ge],styles:[".container[_ngcontent-%COMP%]{width:100vw;height:100vh;display:flex;flex-direction:column}.container[_ngcontent-%COMP%]   ghs-header[_ngcontent-%COMP%]{z-index:2}.menu[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex}.decks[_ngcontent-%COMP%]{flex:1 1 auto;width:100%;overflow:auto;display:flex;margin-top:20px}.decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]{display:flex;flex-direction:column}.decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;margin:0}.decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{flex-shrink:0;width:400px;height:255px;margin:10px}.decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   ghs-ability.bottom-actions[_ngcontent-%COMP%]{height:540px}"]})}return i})();var Fi=M(37017),Xi=M(48374),no=M(79039);const xU=["inputDeckData"],EU=(i,r,e)=>({"bottom-actions":i,"character-actions":r,fh:e}),io=i=>({"bottom-actions":i}),be=i=>({enabled:i}),wU=(i,r)=>r.cardId;function RU(i,r){1&i&&t.nrm(0,"ghs-header",3),2&i&&t.Y8G("standalone",!0)}function jU(i,r){if(1&i){const e=t.RV6();t.j41(0,"label"),t.nrm(1,"span",7),t.k0s(),t.j41(2,"input",22),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2);return t.DH7(o.abilityColor,n)||(o.abilityColor=n),t.Njj(n)}),t.k0s()}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","editor.character.data.color"),t.R7$(),t.R50("ngModel",e.abilityColor),t.Y8G("ghs-label","editor.character.data.color")("ghs-label-attribute","placeholder")}}function GU(i,r){if(1&i){const e=t.RV6();t.j41(0,"label"),t.nrm(1,"span",7),t.k0s(),t.j41(2,"input",21),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.deckData.character,n)||(o.deckData.character=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.deckDataToJson())}),t.k0s(),t.nVh(3,jU,3,4)}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","editor.deck.character"),t.R7$(),t.R50("ngModel",e.deckData.character),t.R7$(),t.vxM(e.deckData.character?3:-1)}}function TU(i,r){if(1&i){const e=t.RV6();t.j41(0,"input",43),t.bIt("ngModelChange",function(n){t.eBV(e);const o=t.XpG().$implicit,g=t.XpG();return t.Njj(o.level=g.valueChange(n))})("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.deckDataToJson())}),t.k0s()}if(2&i){const e=t.XpG().$implicit;t.Y8G("ngModel",e.level)}}function SU(i,r){1&i&&t.nrm(0,"div",44)}function $U(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",31),t.nVh(1,SU,1,0,"div",44),t.j41(2,"span",45),t.nrm(3,"img",46),t.k0s(),t.j41(4,"ghs-action",47),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG().$implicit,g=t.XpG();return t.Njj(g.editAbilityAction(o,n))}),t.k0s()()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG().$implicit,o=t.XpG();t.R7$(),t.vxM(o.divider(n.actions,a)?1:-1),t.R7$(3),t.Y8G("action",e)("relative",!0)("character",o.getCharacter())("cardId",n.cardId)}}function DU(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",63),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2).$implicit,o=t.XpG();return n.shuffle=!n.shuffle,t.Njj(o.deckDataToJson())}),t.nrm(1,"img",64),t.k0s()}if(2&i){const e=t.XpG(2).$implicit;t.Y8G("ngClass",t.eq3(1,be,e.shuffle))}}function IU(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",32)(1,"div",48)(2,"input",49),t.bIt("ngModelChange",function(n){t.eBV(e);const o=t.XpG().$implicit;return t.Njj(o.xp=+n)})("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.deckDataToJson())}),t.k0s()(),t.j41(3,"a",50),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return n.lost=!n.lost,t.Njj(o.deckDataToJson())}),t.nrm(4,"img",51)(5,"img",52),t.k0s(),t.j41(6,"a",53),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return n.round=!n.round,t.Njj(o.deckDataToJson())}),t.nrm(7,"img",54)(8,"img",55),t.k0s(),t.j41(9,"a",56),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return n.loss=!n.loss,t.Njj(o.deckDataToJson())}),t.nrm(10,"img",57)(11,"img",58),t.k0s(),t.j41(12,"a",59),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return n.persistent=!n.persistent,t.Njj(o.deckDataToJson())}),t.nrm(13,"img",60)(14,"img",61),t.k0s(),t.nVh(15,DU,2,3,"a",62),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(2),t.Y8G("ngModel",e.xp),t.R7$(),t.Y8G("ngClass",t.eq3(6,be,e.lost)),t.R7$(3),t.Y8G("ngClass",t.eq3(8,be,e.round)),t.R7$(3),t.Y8G("ngClass",t.eq3(10,be,e.loss)),t.R7$(3),t.Y8G("ngClass",t.eq3(12,be,e.persistent)),t.R7$(3),t.vxM(a.deckData.character?-1:15)}}function AU(i,r){1&i&&t.nrm(0,"div",44)}function VU(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",31),t.nVh(1,AU,1,0,"div",44),t.j41(2,"span",45),t.nrm(3,"img",46),t.k0s(),t.j41(4,"ghs-action",47),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2).$implicit,g=t.XpG();return t.Njj(g.editAbilityActionBottom(o,n))}),t.k0s()()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2).$implicit,o=t.XpG();t.R7$(),t.vxM(o.divider(n.bottomActions,a)?1:-1),t.R7$(3),t.Y8G("action",e)("relative",!0)("character",o.getCharacter())("cardId",n.cardId)}}function FU(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",33)(1,"div",30),t.bIt("cdkDropListDropped",function(n){t.eBV(e);const o=t.XpG().$implicit,g=t.XpG();return t.Njj(g.dropAction(o.bottomActions,n))}),t.Z7z(2,VU,5,5,"div",31,t.fX1),t.k0s()()}if(2&i){const e=t.XpG().$implicit;t.R7$(2),t.Dyx(e.bottomActions)}}function XU(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",63),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2).$implicit,o=t.XpG();return n.bottomShuffle=!n.bottomShuffle,t.Njj(o.deckDataToJson())}),t.nrm(1,"img",64),t.k0s()}if(2&i){const e=t.XpG(2).$implicit;t.Y8G("ngClass",t.eq3(1,be,e.bottomShuffle))}}function BU(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",34)(1,"div",48)(2,"input",49),t.bIt("ngModelChange",function(n){t.eBV(e);const o=t.XpG().$implicit;return t.Njj(o.bottomXp=+n)})("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.deckDataToJson())}),t.k0s()(),t.j41(3,"a",50),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return n.bottomLost=!n.bottomLost,t.Njj(o.deckDataToJson())}),t.nrm(4,"img",51)(5,"img",52),t.k0s(),t.j41(6,"a",53),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return n.bottomRound=!n.bottomRound,t.Njj(o.deckDataToJson())}),t.nrm(7,"img",54)(8,"img",55),t.k0s(),t.j41(9,"a",56),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return n.bottomLoss=!n.bottomLoss,t.Njj(o.deckDataToJson())}),t.nrm(10,"img",57)(11,"img",58),t.k0s(),t.j41(12,"a",59),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return n.bottomPersistent=!n.bottomPersistent,t.Njj(o.deckDataToJson())}),t.nrm(13,"img",60)(14,"img",61),t.k0s(),t.nVh(15,XU,2,3,"a",62),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(2),t.Y8G("ngModel",e.bottomXp),t.R7$(),t.Y8G("ngClass",t.eq3(6,be,e.bottomLost)),t.R7$(3),t.Y8G("ngClass",t.eq3(8,be,e.bottomRound)),t.R7$(3),t.Y8G("ngClass",t.eq3(10,be,e.bottomLoss)),t.R7$(3),t.Y8G("ngClass",t.eq3(12,be,e.bottomPersistent)),t.R7$(3),t.vxM(a.deckData.character?-1:15)}}function YU(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",11)(1,"div",23)(2,"div",24,1)(4,"input",25),t.mxI("ngModelChange",function(n){const o=t.eBV(e).$implicit;return t.DH7(o.name,n)||(o.name=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.deckDataToJson())})("keyup",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.deckDataToJson())}),t.k0s(),t.j41(5,"span",26),t.nVh(6,TU,1,1,"input",27),t.k0s(),t.j41(7,"input",28),t.bIt("change",function(n){const o=t.eBV(e).$implicit,g=t.XpG();return t.Njj(g.changeInitiative(n,o))}),t.k0s(),t.j41(8,"div",29)(9,"div",30),t.bIt("cdkDropListDropped",function(n){const o=t.eBV(e).$implicit,g=t.XpG();return t.Njj(g.dropAction(o.actions,n))}),t.Z7z(10,$U,5,5,"div",31,t.fX1),t.k0s()(),t.nVh(12,IU,16,14,"div",32),t.nVh(13,FU,4,0,"div",33),t.nVh(14,BU,16,14,"div",34),t.j41(15,"input",35),t.bIt("change",function(n){const o=t.eBV(e).$implicit,g=t.XpG();return t.Njj(g.changeCardId(n,o))}),t.k0s(),t.j41(16,"a",36),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.removeAbility(n))}),t.nrm(17,"img",37),t.k0s()(),t.j41(18,"div",38)(19,"a",39),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.addAbilityAction(n))}),t.nrm(20,"img",13)(21,"span",7),t.k0s(),t.j41(22,"a",40),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.addAbilityActionBottom(n))}),t.nrm(23,"img",13)(24,"span",7),t.k0s()(),t.nrm(25,"ghs-ability",41),t.k0s(),t.nrm(26,"ghs-ability",42),t.k0s()}if(2&i){let e;const a=r.$implicit,n=t.sdS(3),o=t.XpG();t.R7$(2),t.xc7("font-size",.04*n.offsetWidth+"px")("--ghs-ability-color",o.getCharacter()&&(null==(e=o.getCharacter())?null:e.color)),t.Y8G("ngClass",t.sMw(31,EU,o.deckData.character||a.bottomActions&&a.bottomActions.length>0,o.deckData.character,o.settingsManager.settings.fhStyle)),t.R7$(2),t.R50("ngModel",a.name),t.Y8G("ghs-label",a.name||"editor.deck.abilityName")("ghs-label-attribute","placeholder"),t.R7$(2),t.vxM(o.deckData.character||a.bottomActions&&a.bottomActions.length>0?6:-1),t.R7$(),t.Y8G("value",a.initiative&&(a.initiative<10?"0":"")+a.initiative),t.R7$(3),t.Dyx(a.actions),t.R7$(2),t.vxM(o.deckData.character||a.bottomActions&&a.bottomActions.length>0?12:-1),t.R7$(),t.vxM(o.deckData.character||a.bottomActions&&a.bottomActions.length>0?13:-1),t.R7$(),t.vxM(o.deckData.character||a.bottomActions&&a.bottomActions.length>0?14:-1),t.R7$(),t.Y8G("value",a.cardId&&(a.cardId<100?"0":"")+(a.cardId<10?"0":"")+a.cardId),t.R7$(3),t.Y8G("ngClass",t.eq3(35,io,o.deckData.character||a.bottomActions&&a.bottomActions.length>0)),t.R7$(3),t.Y8G("ghs-label","editor.action.add"),t.R7$(3),t.Y8G("ghs-label","editor.action.addBottom"),t.R7$(),t.Y8G("ngClass",t.eq3(37,io,o.deckData.character||a.bottomActions&&a.bottomActions.length>0))("character",o.getCharacter())("monster",o.monster)("relative",!0)("flipped",!0)("statsCalculation",!1),t.R7$(),t.Y8G("ngClass",t.eq3(39,io,o.deckData.character||a.bottomActions&&a.bottomActions.length>0))("ability",a)("abilities",o.deckData.abilities)("character",o.getCharacter())("monster",o.monster)("relative",!0)("flipped",!0)("statsCalculation",!1)}}function NU(i,r){if(1&i&&(t.j41(0,"option",17),t.EFF(1),t.nrm(2,"span",7),t.EFF(3,") "),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG();t.Y8G("value",a)("selected",e.edition==n.deckData.edition&&e.name==n.deckData.name),t.R7$(),t.SpI(" ",e.name," ("),t.R7$(),t.Y8G("ghs-label","data.edition."+e.edition)}}function zU(i,r){if(1&i&&(t.j41(0,"option",16),t.nrm(1,"span",7),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ghs-label","data.edition."+e)}}function De(i){if(i.valueType&&i.valueType==G.iQ.fixed&&(i.valueType=void 0),i.subActions&&0==i.subActions.length?i.subActions=void 0:i.subActions&&i.subActions.forEach(r=>{De(r)}),i.type==G.X2.summon)try{let r=JSON.parse(i.value);"string"!=typeof r&&(Object.keys(r).forEach(e=>{(!r[e]||0==r[e])&&(r[e]=void 0)}),r.action&&De(r.action),r.additionalAction&&De(r.additionalAction)),i.value=JSON.stringify(r)}catch{}!i.value&&0!=i.value&&(i.value=void 0),i.small||(i.small=void 0)}let ao=(()=>{class i{dialog;route;router;inputDeckData;character;monster;edition;standalone=!0;gameManager=s.E;settingsManager=m.f;ActionType=G.X2;ActionValueType=G.iQ;encodeURIComponent=encodeURIComponent;deckData;decksData=[];editions=[];deckError;abilityColor="#aaaaaa";constructor(e,a,n){this.dialog=e,this.route=a,this.router=n,this.deckData=new no.m,this.deckData.abilities.push(new Xi.T)}ngOnInit(){var e=this;return(0,X.A)(function*(){e.standalone&&(yield m.f.init(!1)),e.character&&(e.deckData.character=!0),e.deckDataToJson(),e.updateDecksData(),e.inputDeckData.nativeElement.addEventListener("change",a=>{e.deckDataFromJson()}),e.editions=s.E.editions(!0),e.route.queryParams.subscribe({next:a=>{if(a.edition&&(e.edition=a.edition,e.edition&&s.E.editions(!0).indexOf(e.edition)),a.deck){const n=e.decksData.find(o=>o.name==a.deck);n&&(e.deckData=n,e.deckDataToJson())}!e.deckData.edition&&e.edition&&(e.deckData.edition=e.edition)}})})()}updateQueryParams(){!this.deckData.edition&&this.edition&&(this.deckData.edition=this.edition),this.router.navigate([],{relativeTo:this.route,queryParams:{edition:this.edition||void 0,monster:this.monster&&this.monster.name||void 0,character:this.character&&this.character.name||void 0,deck:this.deckData.name||void 0},queryParamsHandling:"merge"}),this.updateDecksData()}updateDecksData(){this.decksData=s.E.decksData(this.edition).filter(e=>this.character?e.character:!this.monster||!e.character)}deckDataToJson(){let e=JSON.parse(JSON.stringify(this.deckData));Object.keys(e).forEach(a=>{(!e[a]||0==e[a])&&(e[a]=void 0)}),e.abilities&&e.abilities.forEach(a=>{Object.keys(a).forEach(n=>{(!a[n]&&0!=a[n]||"boolean"==typeof a[n]&&0==a[n])&&(a[n]=void 0),a.revealed=void 0,"level"==n&&0==a[n]&&(a[n]=void 0),"xp"==n&&0==a[n]&&(a[n]=void 0),"bottomXp"==n&&0==a[n]&&(a[n]=void 0),a.actions&&0==a.actions.length?a.actions=void 0:a.actions&&a.actions.forEach(o=>{De(o)}),a.bottomActions&&0==a.bottomActions.length?a.bottomActions=void 0:a.bottomActions&&a.bottomActions.forEach(o=>{De(o)})})}),this.inputDeckData.nativeElement.value=JSON.stringify(e,null,2)}deckDataFromJson(){if(this.deckError="",this.inputDeckData.nativeElement.value)try{return void(this.deckData=JSON.parse(this.inputDeckData.nativeElement.value))}catch(e){this.deckData=new no.m,this.deckData.abilities.push(new Xi.T),this.deckError=e}}valueChange(e){return e&&!isNaN(+e)?+e:e}changeInitiative(e,a){a.initiative=e.target.value?+e.target.value:0,e.target.value=(a.initiative<10?"0":"")+a.initiative,this.deckDataToJson()}changeCardId(e,a){e.target.value?(a.cardId=+e.target.value,e.target.value=(a.cardId<100?"0":"")+(a.cardId<10?"0":"")+a.cardId):a.cardId=void 0,this.deckDataToJson()}addAbility(){this.deckData.abilities.push(new Xi.T),this.deckDataToJson()}removeAbility(e){this.deckData.abilities.splice(this.deckData.abilities.indexOf(e),1),this.deckDataToJson()}addAbilityAction(e){let a=new G.rc(G.X2.attack);e.actions||(e.actions=[]),e.actions.push(a),this.dialog.open(ve,{panelClass:["dialog"],data:{action:a,character:this.getCharacter(),cardId:e.cardId}}).closed.subscribe({next:o=>{0==o&&e.actions.splice(e.actions.indexOf(a),1),this.deckDataToJson()}})}editAbilityAction(e,a){this.dialog.open(ve,{panelClass:["dialog"],data:{action:a,character:this.getCharacter(),cardId:e.cardId}}).closed.subscribe({next:o=>{0==o&&e.actions.splice(e.actions.indexOf(a),1),this.deckDataToJson()}})}dropAction(e,a){(0,D.HD)(e,a.previousIndex,a.currentIndex),s.E.uiChange.emit()}addAbilityActionBottom(e){let a=new G.rc(G.X2.move);e.bottomActions||(e.bottomActions=[]),e.bottomActions.push(a),this.dialog.open(ve,{panelClass:["dialog"],data:{action:a,character:this.getCharacter(),cardId:e.cardId}}).closed.subscribe({next:o=>{0==o&&e.bottomActions.splice(e.bottomActions.indexOf(a),1),this.deckDataToJson()}})}editAbilityActionBottom(e,a){this.dialog.open(ve,{panelClass:["dialog"],data:{action:a,character:this.getCharacter(),cardId:e.cardId}}).closed.subscribe({next:o=>{0==o&&e.bottomActions.splice(e.actions.indexOf(a),1),this.deckDataToJson()}})}divider(e,a){if(a<1)return!1;const n=e[a];return!(!n||(n.type==G.X2.element||n.type==G.X2.elementHalf)&&n.valueType!=G.iQ.minus||n.type==G.X2.card||e[a-1].type==G.X2.box||n.type==G.X2.concatenation&&n.subActions.every(o=>o.type==G.X2.card||o.type==G.X2.element||o.type==G.X2.elementHalf))}getCharacter(){if(this.character)return this.character;if(this.deckData.character){const e=new an.qS;e.iconUrl="./assets/images/warning.svg";for(let a=0;a<9;a++)e.stats.push(new Fi.s(a,a));return e.color=this.abilityColor,this.edition&&(e.edition=this.edition),new q.K(e,1)}}loadDeckData(e){const a=+e.target.value;-1==a?(this.deckData=new no.m,this.deckData.abilities.push(new Xi.T),this.character&&(this.deckData.character=!0)):this.deckData=this.decksData[a],this.deckDataToJson(),this.updateQueryParams()}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG),t.rXU(U.nX),t.rXU(U.Ix))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-deck-editor"]],viewQuery:function(a,n){if(1&a&&t.GBs(xU,7),2&a){let o;t.mGM(o=t.lsd())&&(n.inputDeckData=o.first)}},inputs:{character:"character",monster:"monster",edition:"edition",standalone:"standalone"},standalone:!1,decls:42,vars:22,consts:[["inputDeckData",""],["card",""],[1,"container"],[3,"standalone"],[1,"columns"],[1,"input"],[1,"deck"],[3,"ghs-label"],[1,"base-data","dialog"],[1,"dialog-container"],[3,"ngModelChange","change","keyup","ngModel","ghs-label","ghs-label-attribute"],[1,"abilities-container"],[1,"button",3,"click"],["src","./assets/images/plus.svg",1,"ghs-icon"],[1,"output"],[3,"change"],[3,"value"],[3,"value","selected"],[3,"ngModelChange","change","ngModel"],[1,"button",3,"href","download"],["src","./assets/images/export.svg",1,"ghs-icon"],["type","checkbox",3,"ngModelChange","change","ngModel"],["type","color",3,"ngModelChange","ngModel","ghs-label","ghs-label-attribute"],[1,"ability-input"],[1,"ability-edit",3,"ngClass"],[1,"name",3,"ngModelChange","change","keyup","ngModel","ghs-label","ghs-label-attribute"],[1,"level"],[1,"text",3,"ngModel"],["min","0","max","100","type","number",1,"initiative",3,"change","value"],[1,"actions-container"],["cdkDropList","",1,"actions",3,"cdkDropListDropped"],["cdkDrag","",1,"action-container"],[1,"required-container"],[1,"actions-container","bottom"],[1,"required-container","bottom"],["type","number",1,"card-id",3,"change","value"],[1,"remove",3,"click"],["src","./assets/images/minus.svg",1,"ghs-icon"],[1,"buttons",3,"ngClass"],[1,"button","add",3,"click"],[1,"button","add","bottom",3,"click"],[3,"ngClass","character","monster","relative","flipped","statsCalculation"],[3,"ngClass","ability","abilities","character","monster","relative","flipped","statsCalculation"],[1,"text",3,"ngModelChange","change","ngModel"],[1,"divider"],["cdkDragHandle","",1,"handle"],["src","./assets/images/menu.svg",1,"ghs-icon"],[3,"click","action","relative","character","cardId"],[1,"xp"],["type","number","min","0",3,"ngModelChange","change","ngModel"],[1,"lost",3,"click","ngClass"],["src","./assets/images/action/card/lost.svg"],["src","./assets/images/action/card/overlay/lost.svg",1,"overlay"],[1,"round",3,"click","ngClass"],["src","./assets/images/action/card/round.svg"],["src","./assets/images/action/card/overlay/round.svg",1,"overlay"],[1,"loss",3,"click","ngClass"],["src","./assets/images/action/card/loss.svg"],["src","./assets/images/action/card/overlay/loss.svg",1,"overlay"],[1,"persistent",3,"click","ngClass"],["src","./assets/images/action/card/persistent.svg"],["src","./assets/images/action/card/overlay/persistent.svg",1,"overlay"],[1,"shuffle",3,"ngClass"],[1,"shuffle",3,"click","ngClass"],["src","./assets/images/shuffle.svg"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",2),t.nVh(1,RU,1,1,"ghs-header",3),t.j41(2,"div",4)(3,"div",5)(4,"div",6)(5,"h2"),t.nrm(6,"span",7),t.k0s(),t.j41(7,"div",8)(8,"div",9)(9,"label"),t.nrm(10,"span",7),t.k0s(),t.j41(11,"input",10),t.mxI("ngModelChange",function(_){return t.eBV(o),t.DH7(n.deckData.name,_)||(n.deckData.name=_),t.Njj(_)}),t.bIt("change",function(){return t.eBV(o),t.Njj(n.deckDataToJson())})("keyup",function(){return t.eBV(o),t.Njj(n.deckDataToJson())}),t.k0s(),t.j41(12,"label"),t.nrm(13,"span",7),t.k0s(),t.j41(14,"input",10),t.mxI("ngModelChange",function(_){return t.eBV(o),t.DH7(n.deckData.edition,_)||(n.deckData.edition=_),t.Njj(_)}),t.bIt("change",function(){return t.eBV(o),t.Njj(n.deckDataToJson())})("keyup",function(){return t.eBV(o),t.Njj(n.deckDataToJson())}),t.k0s(),t.nVh(15,GU,4,3),t.k0s()(),t.Z7z(16,YU,27,41,"div",11,wU),t.j41(18,"a",12),t.bIt("click",function(){return t.eBV(o),t.Njj(n.addAbility())}),t.nrm(19,"img",13)(20,"span",7),t.k0s()()(),t.j41(21,"div",14)(22,"h2"),t.nrm(23,"span",7),t.j41(24,"select",15),t.bIt("change",function(_){return t.eBV(o),t.Njj(n.loadDeckData(_))}),t.j41(25,"option",16),t.EFF(26,"<"),t.nrm(27,"span",7),t.EFF(28,">"),t.k0s(),t.Z7z(29,NU,4,4,"option",17,t.fX1),t.k0s(),t.j41(31,"select",18),t.mxI("ngModelChange",function(_){return t.eBV(o),t.DH7(n.edition,_)||(n.edition=_),t.Njj(_)}),t.bIt("change",function(){return t.eBV(o),t.Njj(n.updateQueryParams())}),t.nrm(32,"option"),t.Z7z(33,zU,2,2,"option",16,t.fX1),t.k0s()(),t.j41(35,"div"),t.EFF(36),t.k0s(),t.nrm(37,"textarea",null,0),t.j41(39,"a",19),t.nrm(40,"img",20)(41,"span",7),t.k0s()()()()}if(2&a){const o=t.sdS(38);t.xc7("--ghs-ability-color",n.abilityColor),t.R7$(),t.vxM(n.standalone?1:-1),t.R7$(5),t.Y8G("ghs-label","editor.deck"),t.R7$(4),t.Y8G("ghs-label","editor.deck.name"),t.R7$(),t.R50("ngModel",n.deckData.name),t.Y8G("ghs-label","editor.deck.name")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","editor.deck.edition"),t.R7$(),t.R50("ngModel",n.deckData.edition),t.Y8G("ghs-label","editor.deck.edition")("ghs-label-attribute","placeholder"),t.R7$(),t.vxM(n.character||n.monster?-1:15),t.R7$(),t.Dyx(n.deckData.abilities),t.R7$(4),t.Y8G("ghs-label","editor.deck.addAbility"),t.R7$(3),t.Y8G("ghs-label","editor.deck.json"),t.R7$(2),t.Y8G("value",-1),t.R7$(2),t.Y8G("ghs-label","editor.deck.new"),t.R7$(2),t.Dyx(n.decksData),t.R7$(2),t.R50("ngModel",n.edition),t.R7$(2),t.Dyx(n.editions),t.R7$(3),t.SpI(" ",n.deckError," "),t.R7$(3),t.Y8G("href","data:application/json;charset=utf-8,"+n.encodeURIComponent(o.value),t.B4B)("download",n.deckData.name+".json"),t.R7$(2),t.Y8G("ghs-label","editor.deck.json.download")}},dependencies:[N.YU,O.xH,O.y7,O.me,O.Q0,O.Zm,O.wz,O.BC,O.VZ,O.vS,D.O7,D.T1,D.Fb,en,ae,tt,ge],styles:["h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{text-align:center;margin-top:calc(var(--ghs-unit) * .7);margin-bottom:calc(var(--ghs-unit) * .2)}input[_ngcontent-%COMP%]:not([type=checkbox]), textarea[_ngcontent-%COMP%]{width:100%;min-width:initial;color:var(--ghs-color-black);background-color:var(--ghs-color-white);border:1px solid var(--ghs-color-gray)}input[_ngcontent-%COMP%]:not([type=checkbox]):hover, textarea[_ngcontent-%COMP%]:hover{border:1px solid var(--ghs-color-gray)}select[_ngcontent-%COMP%]{max-width:100%}textarea[_ngcontent-%COMP%]{width:100%;min-width:calc(var(--ghs-unit) * 20);min-height:calc(var(--ghs-unit) * 50)}.ghs-icon[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}a[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center}a[_ngcontent-%COMP%]:hover{opacity:.7}a.button[_ngcontent-%COMP%]{justify-content:center;font-family:var(--ghs-font-gh-normal);font-size:calc(var(--ghs-unit) * 3);color:var(--ghs-color-white);padding:calc(var(--ghs-unit) * 1);margin:calc(var(--ghs-unit) * 1) auto;border:1px solid var(--ghs-color-gray);background-color:var(--ghs-color-darkgray);text-decoration:none}a.button[_ngcontent-%COMP%]:hover{opacity:1;color:var(--ghs-color-gray)}a.button[_ngcontent-%COMP%]:hover   .ghs-icon[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}a[_ngcontent-%COMP%]   .ghs-icon[_ngcontent-%COMP%]:nth-child(1){margin-right:.2em}.base-data[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5);color:var(--ghs-color-white);width:70%;min-width:300px;display:grid;grid-template-columns:auto auto;grid-gap:calc(var(--ghs-unit) * 2);margin:calc(var(--ghs-unit) * 1) auto;flex-shrink:1;overflow:auto}.columns[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;max-width:100%;justify-content:space-evenly}.output[_ngcontent-%COMP%]{max-width:100%}.input[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 2)}",'.container[_ngcontent-%COMP%]{width:100vw;height:100vh;display:flex;flex-direction:column}.container[_ngcontent-%COMP%]   ghs-header[_ngcontent-%COMP%]{z-index:2}.deck[_ngcontent-%COMP%]{display:flex;flex-direction:column}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:space-around;align-items:flex-start;margin-top:calc(var(--ghs-unit) * 3);min-width:calc(var(--ghs-unit) * 82)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{display:block;width:calc(var(--ghs-unit) * 40);min-height:calc(var(--ghs-unit) * 25.5)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   ghs-ability.bottom-actions[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 54)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]{position:relative}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{position:relative;margin-top:calc(var(--ghs-unit) * -2);display:flex;justify-content:space-evenly}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2);color:var(--ghs-color-black);background-color:var(--ghs-color-gray);border-color:var(--ghs-color-darkgray);z-index:2}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:none}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]:hover{color:var(--ghs-color-darkgray)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .add.bottom[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 1.5);padding:calc(var(--ghs-unit) * .1);margin:calc(var(--ghs-unit) * 2) auto;opacity:.7}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .add.bottom[_ngcontent-%COMP%]:hover{opacity:1}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .buttons.bottom-actions[_ngcontent-%COMP%]{position:absolute;left:-3%;top:49%;z-index:2;flex-direction:column;align-items:flex-start}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .buttons.bottom-actions[_ngcontent-%COMP%]:before{background-position:top}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .buttons.bottom-actions[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .buttons.bottom-actions[_ngcontent-%COMP%]   .bottom[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2);padding:calc(var(--ghs-unit) * .2);margin:calc(var(--ghs-unit) * .5) 0;opacity:1}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;text-align:center;background-position:center;background-size:100% auto;background-repeat:no-repeat;border-radius:3.5%;width:calc(var(--ghs-unit) * 40);height:calc(var(--ghs-unit) * 25.5);z-index:2}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]:before{content:" ";position:absolute;width:100%;height:100%;z-index:0}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]:after{content:" ";position:absolute;width:100%;height:100%;z-index:-1}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * .5);right:calc(var(--ghs-unit) * 1);width:calc(var(--ghs-unit) * 3)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow);width:100%;height:auto}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);position:absolute;font-size:1.7em;top:calc(var(--ghs-unit) * .5);left:calc(var(--ghs-unit) * 7);width:calc(var(--ghs-unit) * 26);color:var(--ghs-color-white);background-color:transparent;border:1px solid var(--ghs-color-gray);z-index:2;text-align:center}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]:hover{border:1px solid var(--ghs-color-gray)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);position:absolute;font-size:2.4em;top:calc(var(--ghs-unit) * 4.5);left:calc(var(--ghs-unit) * 2);width:calc(var(--ghs-unit) * 6);color:var(--ghs-color-white);background-color:transparent;border:none;z-index:3}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]:hover{border:none}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{position:absolute;font-family:var(--ghs-font-normal);font-size:1em;filter:drop-shadow(calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) var(--ghs-color-black));bottom:calc(var(--ghs-unit) * 1);left:calc(var(--ghs-unit) * 2);width:calc(var(--ghs-unit) * 6);color:var(--ghs-color-white);background-color:transparent;border:none;z-index:3}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]:hover{border:none}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .shuffle[_ngcontent-%COMP%]{position:absolute;bottom:calc(var(--ghs-unit) * .5);right:calc(var(--ghs-unit) * .5);width:calc(var(--ghs-unit) * 3);height:calc(var(--ghs-unit) * 3);z-index:3;cursor:pointer}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .shuffle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;width:calc(var(--ghs-unit) * 3);height:calc(var(--ghs-unit) * 3);margin:0}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .shuffle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:before{width:calc(var(--ghs-unit) * 3);height:calc(var(--ghs-unit) * 3)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .shuffle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow);width:100%;height:auto}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .shuffle.enabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 4.5);height:calc(var(--ghs-unit) * 21);width:100%;z-index:1;overflow:auto}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%;min-height:100%;font-size:calc(1.7em * var(--ghs-fontsize))}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action-container[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]{width:100%;display:inline-flex;cursor:pointer}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action-container[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{width:15%;border-top:.11em var(--ghs-color-white) dotted;margin:.2em}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action-container[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{position:absolute;left:-3%;top:0;z-index:2;cursor:grab;opacity:.7}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action-container[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]:hover{opacity:1}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 54)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions.character-actions[_ngcontent-%COMP%]{overflow-x:unset;overflow-y:auto}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{top:4.5%;left:calc(var(--ghs-unit) * 7)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]{top:49%;left:52.5%;transform:translate(-50%);width:calc(var(--ghs-unit) * 6)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{left:18%;bottom:7%}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]{top:17%;left:10.6%;width:78.3%;height:30%;min-height:30%}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .actions-container.bottom[_ngcontent-%COMP%]{top:59%}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]{display:flex;z-index:3;position:absolute;bottom:49%;height:6%;right:1%}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container.bottom[_ngcontent-%COMP%]{bottom:9%}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%;width:auto;margin:.1em;filter:grayscale(.7);opacity:.5}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:hover, .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   a.enabled[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   div.enabled[_ngcontent-%COMP%]{filter:grayscale(0);opacity:1}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   a.enabled[_ngcontent-%COMP%]:hover, .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   div.enabled[_ngcontent-%COMP%]:hover{filter:grayscale(.7);opacity:.5}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   a.xp[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   div.xp[_ngcontent-%COMP%]{display:none}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:relative;top:0;left:0;height:100%;width:auto}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:nth-child(1), .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:nth-child(1){filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:nth-child(2), .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:nth-child(2){position:absolute}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{position:absolute;top:11%;left:45%;width:10%;height:6%;font-size:1.2em;font-family:var(--ghs-font-gh-title);display:flex;justify-content:center;align-items:center;background-color:var(--ghs-ability-color);-webkit-mask-image:url(level.38e1f58a07dc5898.svg);mask-image:url(level.38e1f58a07dc5898.svg);-webkit-mask-size:115% 170%;mask-size:115% 170%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-position:60% 66%;mask-position:60% 66%}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{background:inherit;-webkit-background-clip:text;background-clip:text;color:transparent;filter:invert(1) grayscale(1) contrast(100);font-family:var(--ghs-font-title);text-align:center;font-size:1em}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]:hover{border:none!important}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.bottom-actions[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{left:58%}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.character-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.bottom-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{top:5%;left:5%;background:none;-webkit-mask:none;mask:none}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.character-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.bottom-actions[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{color:var(--ghs-color-black);filter:none}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.character-actions[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.bottom-actions[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{left:10%;bottom:5%}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.character-actions[_ngcontent-%COMP%]   .required-container.bottom[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.bottom-actions[_ngcontent-%COMP%]   .required-container.bottom[_ngcontent-%COMP%]{bottom:5%}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.character-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .xp[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .xp[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;font-size:1em;background-color:var(--ghs-color-white);-webkit-mask-image:url(experience.6b7246e7470a4898.svg);mask-image:url(experience.6b7246e7470a4898.svg);-webkit-mask-size:100% 100%;mask-size:100% 100%;position:relative;width:3.5em;margin-left:-1em}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.character-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .xp[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   .ability-edit.fh.bottom-actions[_ngcontent-%COMP%]   .required-container[_ngcontent-%COMP%]   .xp[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;width:2em;font-size:1em;font-family:var(--ghs-font-title);background-color:transparent;border:none}.deck[_ngcontent-%COMP%]   .abilities-container[_ngcontent-%COMP%]   .ability-input[_ngcontent-%COMP%]   ghs-ability[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:0}']})}return i})();const LU=["inputCharacterData"],UU=()=>[],qU=(i,r)=>r.edition+"-"+r.name;function HU(i,r){if(1&i&&(t.j41(0,"option",14),t.nrm(1,"span",4),t.k0s()),2&i){const e=r.$implicit,a=t.XpG();t.Y8G("value",e)("selected",a.characterData.characterClass==e),t.R7$(),t.Y8G("ghs-label","character.class."+e)}}function KU(i,r){if(1&i&&(t.j41(0,"option",16),t.nrm(1,"span",4),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e-1),t.R7$(),t.Y8G("ghs-label","editor.character.data.hp."+(e-1))}}function WU(i,r){if(1&i){const e=t.RV6();t.j41(0,"input",25),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG().$implicit;return t.DH7(o.health,n)||(o.health=n),t.Njj(n)}),t.k0s()}if(2&i){const e=t.XpG().$implicit;t.R50("ngModel",e.health)}}function JU(i,r){if(1&i){const e=t.RV6();t.j41(0,"input",26),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG().$implicit;return t.DH7(o.health,n)||(o.health=n),t.Njj(n)}),t.k0s()}if(2&i){const e=t.XpG().$implicit;t.R50("ngModel",e.health)}}function ZU(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s(),t.nVh(2,WU,1,1,"input",23),t.nVh(3,JU,1,1,"input",24)),2&i){const e=r.$implicit,a=t.XpG();t.R7$(),t.JRh(e.level),t.R7$(),t.vxM(-1!=a.hpIndex?2:-1),t.R7$(),t.vxM(-1==a.hpIndex?3:-1)}}function QU(i,r){if(1&i&&t.nrm(0,"span",4),2&i){const e=t.XpG().$implicit;t.Y8G("ghs-label","data.character."+e.edition+"."+e.name)}}function tq(i,r){if(1&i&&(t.j41(0,"option",14),t.nVh(1,QU,1,1,"span",4),t.EFF(2),t.nrm(3,"span",4),t.EFF(4),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG();t.Y8G("value",a)("selected",e.edition==n.characterData.edition&&e.name==n.characterData.name),t.R7$(),t.vxM(n.isSpoiled(e)?1:-1),t.R7$(),t.SpI(" ",e.name," ("),t.R7$(),t.Y8G("ghs-label","data.edition."+e.edition),t.R7$(),t.SpI(") [",e.name,"] ")}}function eq(i,r){if(1&i&&(t.j41(0,"option",16),t.nrm(1,"span",4),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ghs-label","data.edition."+e)}}function nq(i,r){if(1&i&&t.nrm(0,"ghs-deck-editor",22),2&i){const e=t.XpG();t.Y8G("character",e.getCharacter())("standalone",!1)("edition",e.edition)}}let iq=(()=>{class i{route;router;inputCharacterData;gameManager=s.E;encodeURIComponent=encodeURIComponent;isSpoiled=V.DJ;characterData;characterError;edition;init=!1;hpIndex=0;CharacterClasses=Object.values(an.iq);hpValues=[[6,7,8,9,10,11,12,13,14],[8,9,11,12,14,15,17,18,20],[10,12,14,16,18,20,22,24,26]];editions=[];charactersData=[];constructor(e,a){this.route=e,this.router=a,this.characterData=new an.qS,this.characterData.iconUrl="./assets/images/warning.svg";for(let n=0;n<9;n++)this.characterData.stats.push(new Fi.s(n+1,n+6))}ngOnInit(){var e=this;return(0,X.A)(function*(){yield m.f.init(!1),e.characterDataToJson(),e.inputCharacterData.nativeElement.addEventListener("change",a=>{e.characterDataFromJson()}),e.editions=s.E.editions(!0),e.charactersData=s.E.charactersData(e.edition),e.route.queryParams.subscribe({next:a=>{if(a.edition&&(e.edition=a.edition,e.edition&&s.E.editions(!0).indexOf(e.edition),e.charactersData=s.E.charactersData(e.edition)),a.character){const n=s.E.charactersData(e.edition).find(o=>o.name==a.character);n&&(e.characterData=n,e.characterDataToJson())}!e.characterData.edition&&e.edition&&(e.characterData.edition=e.edition)}}),e.init=!0})()}getCharacter(){return new q.K(this.characterData,1)}changeHpIndex(){(this.hpIndex<-1||this.hpIndex>2)&&(this.hpIndex=-1),-1!=this.hpIndex&&this.characterData.stats.forEach(e=>{e.health=this.hpValues[this.hpIndex][e.level-1]}),this.characterDataToJson()}characterDataToJson(){this.characterData.stats.sort((a,n)=>a.level-n.level);let e=JSON.parse(JSON.stringify(this.characterData));this.inputCharacterData.nativeElement.value=JSON.stringify(e,null,2)}characterDataFromJson(){if(this.characterError="",this.inputCharacterData.nativeElement.value)try{return void(this.characterData=JSON.parse(this.inputCharacterData.nativeElement.value))}catch(e){this.characterData=new an.qS,this.characterData.iconUrl="./assets/images/warning.svg";for(let a=0;a<9;a++)this.characterData.stats.push(new Fi.s(a,a));this.characterError=e}}selectEdition(e){this.edition=-1!=this.editions.indexOf(e.target.value)?e.target.value:void 0,this.charactersData=s.E.charactersData(this.edition)}loadCharacterData(e){const a=+e.target.value;if(-1!=a)this.characterData=s.E.charactersData(this.edition)[a];else{this.characterData=new an.qS,this.characterData.iconUrl="./assets/images/warning.svg";for(let n=0;n<9;n++)this.characterData.stats.push(new Fi.s(n+1,n+6))}this.hpIndex=-1,this.hpValues.forEach((n,o)=>{n.every((g,_)=>this.characterData.stats.find(y=>y.level==_+1&&y.health==g))&&(this.hpIndex=o)}),this.characterDataToJson(),this.updateQueryParams()}updateQueryParams(){!this.characterData.edition&&this.edition&&(this.characterData.edition=this.edition),this.router.navigate([],{relativeTo:this.route,queryParams:{edition:this.edition||void 0,character:this.characterData&&this.characterData.name||void 0},queryParamsHandling:"merge"})}static \u0275fac=function(a){return new(a||i)(t.rXU(U.nX),t.rXU(U.Ix))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-character-editor"]],viewQuery:function(a,n){if(1&a&&t.GBs(LU,7),2&a){let o;t.mGM(o=t.lsd())&&(n.inputCharacterData=o.first)}},standalone:!1,decls:67,vars:38,consts:[["inputCharacterData",""],[1,"container"],[3,"standalone"],[1,"character-editor"],[3,"ghs-label"],[1,"columns"],[1,"input"],[1,"character-data"],[1,"base-data","dialog"],[1,"dialog-container"],[3,"ngModelChange","change","keyup","ngModel","ghs-label","ghs-label-attribute"],["type","color",3,"ngModelChange","change","keyup","ngModel","ghs-label","ghs-label-attribute"],["type","checkbox",3,"ngModelChange","change","ngModel"],[3,"ngModelChange","change","ngModel"],[3,"value","selected"],[1,"hp-container"],[3,"value"],[1,"hp-grid"],[1,"output"],[3,"change"],[1,"button",3,"href","download"],["src","./assets/images/export.svg",1,"ghs-icon"],[3,"character","standalone","edition"],["disabled","",3,"ngModel"],["type","number",3,"ngModel"],["disabled","",3,"ngModelChange","ngModel"],["type","number",3,"ngModelChange","ngModel"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",1),t.nrm(1,"ghs-header",2),t.j41(2,"div",3)(3,"h1"),t.nrm(4,"span",4),t.EFF(5," ("),t.nrm(6,"span",4),t.EFF(7,")"),t.k0s(),t.j41(8,"div",5)(9,"div",6)(10,"div",7)(11,"h2"),t.nrm(12,"span",4),t.k0s(),t.j41(13,"div",8)(14,"div",9)(15,"label"),t.nrm(16,"span",4),t.k0s(),t.j41(17,"input",10),t.mxI("ngModelChange",function(_){return t.eBV(o),t.DH7(n.characterData.name,_)||(n.characterData.name=_),t.Njj(_)}),t.bIt("change",function(){return t.eBV(o),t.Njj(n.characterDataToJson())})("keyup",function(){return t.eBV(o),t.Njj(n.characterDataToJson())}),t.k0s(),t.j41(18,"label"),t.nrm(19,"span",4),t.k0s(),t.j41(20,"input",10),t.mxI("ngModelChange",function(_){return t.eBV(o),t.DH7(n.characterData.edition,_)||(n.characterData.edition=_),t.Njj(_)}),t.bIt("change",function(){return t.eBV(o),t.Njj(n.characterDataToJson())})("keyup",function(){return t.eBV(o),t.Njj(n.characterDataToJson())}),t.k0s(),t.j41(21,"label"),t.nrm(22,"span",4),t.k0s(),t.j41(23,"input",11),t.mxI("ngModelChange",function(_){return t.eBV(o),t.DH7(n.characterData.color,_)||(n.characterData.color=_),t.Njj(_)}),t.bIt("change",function(){return t.eBV(o),t.Njj(n.characterDataToJson())})("keyup",function(){return t.eBV(o),t.Njj(n.characterDataToJson())}),t.k0s(),t.j41(24,"label"),t.nrm(25,"span",4),t.k0s(),t.j41(26,"input",12),t.mxI("ngModelChange",function(_){return t.eBV(o),t.DH7(n.characterData.spoiler,_)||(n.characterData.spoiler=_),t.Njj(_)}),t.bIt("change",function(){return t.eBV(o),t.Njj(n.characterDataToJson())}),t.k0s(),t.j41(27,"label"),t.nrm(28,"span",4),t.k0s(),t.j41(29,"input",10),t.mxI("ngModelChange",function(_){return t.eBV(o),t.DH7(n.characterData.deck,_)||(n.characterData.deck=_),t.Njj(_)}),t.bIt("change",function(){return t.eBV(o),t.Njj(n.characterDataToJson())})("keyup",function(){return t.eBV(o),t.Njj(n.characterDataToJson())}),t.k0s(),t.j41(30,"label"),t.nrm(31,"span",4),t.k0s(),t.j41(32,"select",13),t.mxI("ngModelChange",function(_){return t.eBV(o),t.DH7(n.characterData.characterClass,_)||(n.characterData.characterClass=_),t.Njj(_)}),t.bIt("change",function(){return t.eBV(o),t.Njj(n.characterDataToJson())}),t.Z7z(33,HU,2,3,"option",14,t.fX1),t.k0s(),t.j41(35,"label"),t.nrm(36,"span",4),t.k0s(),t.j41(37,"div",15)(38,"select",13),t.mxI("ngModelChange",function(_){return t.eBV(o),t.DH7(n.hpIndex,_)||(n.hpIndex=_),t.Njj(_)}),t.bIt("change",function(){return t.eBV(o),t.Njj(n.changeHpIndex())}),t.Z7z(39,KU,2,2,"option",16,t.fX1),t.nI1(41,"ghsRange"),t.k0s(),t.j41(42,"div",17),t.Z7z(43,ZU,4,3,null,null,t.fX1),t.k0s()()()()()(),t.j41(45,"div",18)(46,"h2"),t.nrm(47,"span",4),t.j41(48,"select",19),t.bIt("change",function(_){return t.eBV(o),t.Njj(n.loadCharacterData(_))}),t.j41(49,"option",16),t.EFF(50,"<"),t.nrm(51,"span",4),t.EFF(52,">"),t.k0s(),t.Z7z(53,tq,5,6,"option",14,qU),t.k0s(),t.j41(55,"select",19),t.bIt("change",function(_){return t.eBV(o),t.Njj(n.selectEdition(_))}),t.nrm(56,"option"),t.Z7z(57,eq,2,2,"option",16,t.fX1),t.k0s()(),t.j41(59,"div"),t.EFF(60),t.k0s(),t.nrm(61,"textarea",null,0),t.j41(63,"a",20),t.nrm(64,"img",21)(65,"span",4),t.k0s()()(),t.nVh(66,nq,1,3,"ghs-deck-editor",22),t.k0s()()}if(2&a){const o=t.sdS(62);t.R7$(),t.Y8G("standalone",!0),t.R7$(3),t.Y8G("ghs-label","editor.character"),t.R7$(2),t.Y8G("ghs-label","wip"),t.R7$(6),t.Y8G("ghs-label","editor.character.data"),t.R7$(4),t.Y8G("ghs-label","editor.character.data.name"),t.R7$(),t.R50("ngModel",n.characterData.name),t.Y8G("ghs-label","editor.character.data.name")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","edition"),t.R7$(),t.R50("ngModel",n.characterData.edition),t.Y8G("ghs-label","edition")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","editor.character.data.color"),t.R7$(),t.R50("ngModel",n.characterData.color),t.Y8G("ghs-label","editor.character.data.color")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","editor.character.data.spoiler"),t.R7$(),t.R50("ngModel",n.characterData.spoiler),t.R7$(2),t.Y8G("ghs-label","editor.character.data.deck"),t.R7$(),t.R50("ngModel",n.characterData.deck),t.Y8G("ghs-label","editor.character.data.deck")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","editor.character.data.class"),t.R7$(),t.R50("ngModel",n.characterData.characterClass),t.R7$(),t.Dyx(n.CharacterClasses),t.R7$(3),t.Y8G("ghs-label","editor.character.data.hp"),t.R7$(2),t.R50("ngModel",n.hpIndex),t.R7$(),t.Dyx(t.i5U(41,34,t.lJ4(37,UU),4)),t.R7$(4),t.Dyx(n.characterData.stats),t.R7$(4),t.Y8G("ghs-label","editor.character.data.json"),t.R7$(2),t.Y8G("value",-1),t.R7$(2),t.Y8G("ghs-label","editor.character.new"),t.R7$(2),t.Dyx(n.charactersData),t.R7$(4),t.Dyx(n.editions),t.R7$(3),t.SpI(" ",n.characterError," "),t.R7$(3),t.Y8G("href","data:application/json;charset=utf-8,"+n.encodeURIComponent(o.value),t.B4B)("download",n.characterData.name+".json"),t.R7$(2),t.Y8G("ghs-label","editor.character.data.json.download"),t.R7$(),t.vxM(n.init?66:-1)}},dependencies:[O.xH,O.y7,O.me,O.Q0,O.Zm,O.wz,O.BC,O.vS,ao,tt,ge,Tt],styles:["h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{text-align:center;margin-top:calc(var(--ghs-unit) * .7);margin-bottom:calc(var(--ghs-unit) * .2)}input[_ngcontent-%COMP%]:not([type=checkbox]), textarea[_ngcontent-%COMP%]{width:100%;min-width:initial;color:var(--ghs-color-black);background-color:var(--ghs-color-white);border:1px solid var(--ghs-color-gray)}input[_ngcontent-%COMP%]:not([type=checkbox]):hover, textarea[_ngcontent-%COMP%]:hover{border:1px solid var(--ghs-color-gray)}select[_ngcontent-%COMP%]{max-width:100%}textarea[_ngcontent-%COMP%]{width:100%;min-width:calc(var(--ghs-unit) * 20);min-height:calc(var(--ghs-unit) * 50)}.ghs-icon[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}a[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center}a[_ngcontent-%COMP%]:hover{opacity:.7}a.button[_ngcontent-%COMP%]{justify-content:center;font-family:var(--ghs-font-gh-normal);font-size:calc(var(--ghs-unit) * 3);color:var(--ghs-color-white);padding:calc(var(--ghs-unit) * 1);margin:calc(var(--ghs-unit) * 1) auto;border:1px solid var(--ghs-color-gray);background-color:var(--ghs-color-darkgray);text-decoration:none}a.button[_ngcontent-%COMP%]:hover{opacity:1;color:var(--ghs-color-gray)}a.button[_ngcontent-%COMP%]:hover   .ghs-icon[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}a[_ngcontent-%COMP%]   .ghs-icon[_ngcontent-%COMP%]:nth-child(1){margin-right:.2em}.base-data[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5);color:var(--ghs-color-white);width:70%;min-width:300px;display:grid;grid-template-columns:auto auto;grid-gap:calc(var(--ghs-unit) * 2);margin:calc(var(--ghs-unit) * 1) auto;flex-shrink:1;overflow:auto}.columns[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;max-width:100%;justify-content:space-evenly}.output[_ngcontent-%COMP%]{max-width:100%}.input[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 2)}",".container[_ngcontent-%COMP%]{width:100vw;height:100vh;display:flex;flex-direction:column}.container[_ngcontent-%COMP%]   ghs-header[_ngcontent-%COMP%]{z-index:2}.character-editor[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * 2)}.character-data[_ngcontent-%COMP%]{display:flex;flex-direction:column}.character-data[_ngcontent-%COMP%]   .hp-grid[_ngcontent-%COMP%]{max-width:600px;display:grid;grid-auto-flow:column;grid-template-rows:1fr 1fr}.character-data[_ngcontent-%COMP%]   .hp-grid[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .character-data[_ngcontent-%COMP%]   .hp-grid[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:center}.character-data[_ngcontent-%COMP%]   .hp-grid[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background-color:transparent;border:1px solid var(--ghs-color-red);color:var(--ghs-color-red);min-width:40px;font-size:1em}"]})}return i})();const aq=["inputEditionData"],oq=()=>["X"],nc=(i,r)=>r.edition,oo=(i,r)=>r.edition+"-"+r.name;function sq(i,r){if(1&i&&(t.j41(0,"option",12),t.nrm(1,"span",3),t.EFF(2),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e.edition),t.R7$(),t.Y8G("ghs-label","data.edition."+e.edition),t.R7$(),t.SpI(" [",e.edition,"] ")}}function rq(i,r){if(1&i&&(t.j41(0,"option",12),t.nrm(1,"span",25),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ghs-label","game.condition."+e)("ghs-label-args",t.lJ4(3,oq))}}function cq(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",26),t.bIt("click",function(){const n=t.eBV(e).$index,o=t.XpG();return t.Njj(o.removeCharacter(n))}),t.nrm(1,"span",3),t.EFF(2),t.k0s()}if(2&i){const e=r.$implicit;t.Y8G("ghs-label","editor.edition.character.remove")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","data.character."+e.edition+"."+e.name),t.R7$(),t.SpI(" [",e.name,"]")}}function lq(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",26),t.bIt("click",function(){const n=t.eBV(e).$index,o=t.XpG();return t.Njj(o.removeMonster(n))}),t.nrm(1,"span",3),t.EFF(2),t.k0s()}if(2&i){const e=r.$implicit;t.Y8G("ghs-label","editor.edition.monster.remove")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","data.monster."+e.name),t.R7$(),t.SpI(" [",e.name,"]")}}function gq(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",26),t.bIt("click",function(){const n=t.eBV(e).$index,o=t.XpG();return t.Njj(o.removeDeck(n))}),t.nrm(1,"span",3),t.EFF(2),t.k0s()}if(2&i){const e=r.$implicit;t.Y8G("ghs-label","editor.edition.decks.remove")("ghs-label-attribute","title"),t.R7$(),t.Y8G("ghs-label","data.deck."+e.name),t.R7$(),t.SpI(" [",e.name,"]")}}function dq(i,r){if(1&i&&(t.j41(0,"option",12),t.nrm(1,"span",3),t.EFF(2),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",r.$index),t.R7$(),t.Y8G("ghs-label","data.edition."+e.edition),t.R7$(),t.SpI(" [",e.edition,"] ")}}let hq=(()=>{class i{inputEditionData;gameManager=s.E;encodeURIComponent=encodeURIComponent;Conditions=Object.values(j.r5).filter(e=>e!=j.r5.bless&&e!=j.r5.curse);editionData;editionError;constructor(){this.editionData=new on.le("",[],[],[],[],[],[])}ngOnInit(){var e=this;return(0,X.A)(function*(){yield m.f.init(!1),e.editionDataToJson()})()}editionDataToJson(){let e=JSON.parse(JSON.stringify(this.editionData));Object.keys(e).forEach(a=>{e[a]||(e[a]=void 0)}),this.inputEditionData.nativeElement.value=JSON.stringify(e,null,2)}jsonDownload(){let e=JSON.parse(JSON.stringify(this.editionData));return Object.keys(e).forEach(a=>{e[a]||(e[a]=void 0)}),this.encodeURIComponent(JSON.stringify(e))}loadEditionData(e){const a=+e.target.value;this.editionData=-1!=a?s.E.editionData[a]:new on.le("",[],[],[],[],[],[]),this.editionDataToJson()}toggleAllConditions(e){this.editionData.conditions.length==this.Conditions.length?(this.editionData.conditions=[],e.blur()):(this.editionData.conditions=JSON.parse(JSON.stringify(this.Conditions)),e.focus()),this.editionDataToJson()}addCharacterJson(e){if(e.target.files)for(let a=0;a<e.target.files.length;a++){const n=new FileReader;n.onload=()=>{try{let o=JSON.parse(n.result);return void(o&&(this.editionData.characters.find(g=>o.name==g.name&&o.edition==g.edition)||(this.editionData.characters.push(new an.qS(o)),this.editionDataToJson())))}catch(o){console.error(o)}},n.readAsText(e.target.files[a])}e.target.value=""}removeCharacter(e){this.editionData.characters.splice(e,1),this.editionDataToJson()}addMonsterJson(e){if(e.target.files)for(let a=0;a<e.target.files.length;a++){const n=new FileReader;n.onload=()=>{try{const o=JSON.parse(n.result);return void(o&&(this.editionData.monsters.find(g=>o.name==g.name&&o.edition==g.edition)||(this.editionData.monsters.push(new mn.f(o)),this.editionDataToJson())))}catch(o){console.error(o)}},n.readAsText(e.target.files[a])}e.target.value=""}removeMonster(e){this.editionData.monsters.splice(e,1),this.editionDataToJson()}addDeckJson(e){if(e.target.files)for(let a=0;a<e.target.files.length;a++){const n=new FileReader;n.onload=()=>{try{const o=JSON.parse(n.result);return void(o&&(this.editionData.decks.find(g=>o.name==g.name&&o.edition==g.edition)||(this.editionData.decks.push(o),this.editionDataToJson())))}catch(o){console.error(o)}},n.readAsText(e.target.files[a])}e.target.value=""}removeDeck(e){this.editionData.decks.splice(e,1),this.editionDataToJson()}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-edition-editor"]],viewQuery:function(a,n){if(1&a&&t.GBs(aq,7),2&a){let o;t.mGM(o=t.lsd())&&(n.inputEditionData=o.first)}},standalone:!1,decls:70,vars:24,consts:[["conditionSelect",""],["inputEditionData",""],[1,"back",3,"routerLink"],[3,"ghs-label"],[1,"edition-editor"],[1,"columns"],[1,"input"],[1,"edition-base"],[1,"base-data","dialog"],[1,"dialog-container"],[3,"ngModelChange","change","keyup","ngModel","ghs-label","ghs-label-attribute"],["multiple","",3,"ngModelChange","change","ngModel"],[3,"value"],[1,"conditions"],[3,"click"],[1,"files"],[1,"file-list","characters"],[1,"file",3,"ghs-label","ghs-label-attribute"],["type","file","multiple","","accept","application/json",3,"change"],[1,"file-list","monsters"],[1,"file-list","decks"],[1,"output"],[3,"change"],[1,"button",3,"href","download"],["src","./assets/images/export.svg",1,"ghs-icon"],[3,"ghs-label","ghs-label-args"],[1,"file",3,"click","ghs-label","ghs-label-attribute"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"a",2),t.nrm(1,"span",3),t.k0s(),t.j41(2,"div",4)(3,"h1"),t.nrm(4,"span",3),t.EFF(5," ("),t.nrm(6,"span",3),t.EFF(7,")"),t.k0s(),t.j41(8,"div",5)(9,"div",6)(10,"div",7)(11,"h2"),t.nrm(12,"span",3),t.k0s(),t.j41(13,"div",8)(14,"div",9)(15,"label"),t.nrm(16,"span",3),t.k0s(),t.j41(17,"input",10),t.mxI("ngModelChange",function(_){return t.eBV(o),t.DH7(n.editionData.edition,_)||(n.editionData.edition=_),t.Njj(_)}),t.bIt("change",function(){return t.eBV(o),t.Njj(n.editionDataToJson())})("keyup",function(){return t.eBV(o),t.Njj(n.editionDataToJson())}),t.k0s(),t.j41(18,"label"),t.nrm(19,"span",3),t.k0s(),t.j41(20,"select",11),t.mxI("ngModelChange",function(_){return t.eBV(o),t.DH7(n.editionData.extensions,_)||(n.editionData.extensions=_),t.Njj(_)}),t.bIt("change",function(){return t.eBV(o),t.Njj(n.editionDataToJson())}),t.Z7z(21,sq,3,3,"option",12,nc),t.k0s(),t.j41(23,"label"),t.nrm(24,"span",3),t.k0s(),t.j41(25,"div",13)(26,"a",14),t.bIt("click",function(){t.eBV(o);const _=t.sdS(29);return t.Njj(n.toggleAllConditions(_))}),t.nrm(27,"span",3),t.k0s(),t.j41(28,"select",11,0),t.mxI("ngModelChange",function(_){return t.eBV(o),t.DH7(n.editionData.conditions,_)||(n.editionData.conditions=_),t.Njj(_)}),t.bIt("change",function(){return t.eBV(o),t.Njj(n.editionDataToJson())}),t.Z7z(30,rq,2,4,"option",12,t.fX1),t.k0s()()()()(),t.j41(32,"div",15)(33,"h2"),t.nrm(34,"span",3),t.k0s(),t.j41(35,"div",16),t.Z7z(36,cq,3,4,"span",17,oo),t.k0s(),t.j41(38,"input",18),t.bIt("change",function(_){return t.eBV(o),t.Njj(n.addCharacterJson(_))}),t.k0s()(),t.j41(39,"div",15)(40,"h2"),t.nrm(41,"span",3),t.k0s(),t.j41(42,"div",19),t.Z7z(43,lq,3,4,"span",17,oo),t.k0s(),t.j41(45,"input",18),t.bIt("change",function(_){return t.eBV(o),t.Njj(n.addMonsterJson(_))}),t.k0s()(),t.j41(46,"div",15)(47,"h2"),t.nrm(48,"span",3),t.k0s(),t.j41(49,"div",20),t.Z7z(50,gq,3,4,"span",17,oo),t.k0s(),t.j41(52,"input",18),t.bIt("change",function(_){return t.eBV(o),t.Njj(n.addDeckJson(_))}),t.k0s()()(),t.j41(53,"div",21)(54,"h2"),t.nrm(55,"span",3),t.j41(56,"select",22),t.bIt("change",function(_){return t.eBV(o),t.Njj(n.loadEditionData(_))}),t.j41(57,"option",12),t.EFF(58,"<"),t.nrm(59,"span",3),t.EFF(60,">"),t.k0s(),t.Z7z(61,dq,3,3,"option",12,nc),t.k0s()(),t.j41(63,"div"),t.EFF(64),t.k0s(),t.nrm(65,"textarea",null,1),t.j41(67,"a",23),t.nrm(68,"img",24)(69,"span",3),t.k0s()()()()}2&a&&(t.Y8G("routerLink","/"),t.R7$(),t.Y8G("ghs-label","tools.backToGhs"),t.R7$(3),t.Y8G("ghs-label","editor.edition"),t.R7$(2),t.Y8G("ghs-label","wip"),t.R7$(6),t.Y8G("ghs-label","editor.edition.base"),t.R7$(4),t.Y8G("ghs-label","editor.edition.edition"),t.R7$(),t.R50("ngModel",n.editionData.edition),t.Y8G("ghs-label","editor.edition.edition")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","editor.edition.extensions"),t.R7$(),t.R50("ngModel",n.editionData.extensions),t.R7$(),t.Dyx(n.gameManager.editionData),t.R7$(3),t.Y8G("ghs-label","editor.edition.conditions"),t.R7$(3),t.Y8G("ghs-label",n.editionData.conditions.length!=n.Conditions.length?"editor.edition.conditions.allSelected":"editor.edition.conditions.allHint"),t.R7$(),t.R50("ngModel",n.editionData.conditions),t.R7$(2),t.Dyx(n.Conditions),t.R7$(4),t.Y8G("ghs-label","editor.edition.character"),t.R7$(2),t.Dyx(n.editionData.characters),t.R7$(5),t.Y8G("ghs-label","editor.edition.monster"),t.R7$(2),t.Dyx(n.editionData.monsters),t.R7$(5),t.Y8G("ghs-label","editor.edition.decks"),t.R7$(2),t.Dyx(n.editionData.decks),t.R7$(5),t.Y8G("ghs-label","editor.edition.json"),t.R7$(2),t.Y8G("value",-1),t.R7$(2),t.Y8G("ghs-label","editor.edition.new"),t.R7$(2),t.Dyx(n.gameManager.editionData),t.R7$(3),t.SpI(" ",n.editionError," "),t.R7$(3),t.Y8G("href","data:application/json;charset=utf-8,"+n.jsonDownload(),t.B4B)("download",n.editionData.edition+".json"),t.R7$(2),t.Y8G("ghs-label","editor.edition.json.download"))},dependencies:[U.Wk,O.xH,O.y7,O.me,O.W0,O.BC,O.vS,tt],styles:["h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{text-align:center;margin-top:calc(var(--ghs-unit) * .7);margin-bottom:calc(var(--ghs-unit) * .2)}input[_ngcontent-%COMP%]:not([type=checkbox]), textarea[_ngcontent-%COMP%]{width:100%;min-width:initial;color:var(--ghs-color-black);background-color:var(--ghs-color-white);border:1px solid var(--ghs-color-gray)}input[_ngcontent-%COMP%]:not([type=checkbox]):hover, textarea[_ngcontent-%COMP%]:hover{border:1px solid var(--ghs-color-gray)}select[_ngcontent-%COMP%]{max-width:100%}textarea[_ngcontent-%COMP%]{width:100%;min-width:calc(var(--ghs-unit) * 20);min-height:calc(var(--ghs-unit) * 50)}.ghs-icon[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}a[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center}a[_ngcontent-%COMP%]:hover{opacity:.7}a.button[_ngcontent-%COMP%]{justify-content:center;font-family:var(--ghs-font-gh-normal);font-size:calc(var(--ghs-unit) * 3);color:var(--ghs-color-white);padding:calc(var(--ghs-unit) * 1);margin:calc(var(--ghs-unit) * 1) auto;border:1px solid var(--ghs-color-gray);background-color:var(--ghs-color-darkgray);text-decoration:none}a.button[_ngcontent-%COMP%]:hover{opacity:1;color:var(--ghs-color-gray)}a.button[_ngcontent-%COMP%]:hover   .ghs-icon[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}a[_ngcontent-%COMP%]   .ghs-icon[_ngcontent-%COMP%]:nth-child(1){margin-right:.2em}.base-data[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5);color:var(--ghs-color-white);width:70%;min-width:300px;display:grid;grid-template-columns:auto auto;grid-gap:calc(var(--ghs-unit) * 2);margin:calc(var(--ghs-unit) * 1) auto;flex-shrink:1;overflow:auto}.columns[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;max-width:100%;justify-content:space-evenly}.output[_ngcontent-%COMP%]{max-width:100%}.input[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 2)}",".files[_ngcontent-%COMP%]   .file-list[_ngcontent-%COMP%]{display:flex;flex-direction:column}.files[_ngcontent-%COMP%]   .file-list[_ngcontent-%COMP%]   .file[_ngcontent-%COMP%]{font-size:1.5em;cursor:pointer}.files[_ngcontent-%COMP%]   .file-list[_ngcontent-%COMP%]   .file[_ngcontent-%COMP%]:hover{text-decoration:line-through}.conditions[_ngcontent-%COMP%]{display:flex;flex-direction:column}.conditions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:.7em}"]})}return i})();var Bi=M(34786);const _q=["inputMonsterData"],mq=["monsterStats"],pq=["deckEditor"],ic=()=>[],ac=i=>({current:i}),uq=i=>[i],fq=(i,r)=>r.edition+"-"+r.name;function Cq(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",17),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return o.level=n,t.Njj(o.updateQueryParams())}),t.EFF(1),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(2,ac,a.level==e)),t.R7$(),t.SpI(" ",e)}}function Mq(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",32)(1,"input",35),t.bIt("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2).$implicit,g=t.XpG();return t.Njj(g.statsForType(g.MonsterType.normal,o).health=g.valueChange(n))})("change",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())})("keyup",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())}),t.k0s(),t.j41(2,"input",36),t.bIt("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2).$implicit,g=t.XpG();return t.Njj(g.statsForType(g.MonsterType.elite,o).health=g.valueChange(n))})("change",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())})("keyup",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())}),t.k0s(),t.j41(3,"input",37),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2).$implicit,g=t.XpG();return t.DH7(g.statsForType(g.MonsterType.normal,o).movement,n)||(g.statsForType(g.MonsterType.normal,o).movement=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())})("keyup",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())}),t.k0s(),t.j41(4,"input",38),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2).$implicit,g=t.XpG();return t.DH7(g.statsForType(g.MonsterType.elite,o).movement,n)||(g.statsForType(g.MonsterType.elite,o).movement=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())})("keyup",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())}),t.k0s(),t.j41(5,"input",35),t.bIt("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2).$implicit,g=t.XpG();return t.Njj(g.statsForType(g.MonsterType.normal,o).attack=g.valueChange(n))})("change",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())})("keyup",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())}),t.k0s(),t.j41(6,"input",36),t.bIt("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2).$implicit,g=t.XpG();return t.Njj(g.statsForType(g.MonsterType.elite,o).attack=g.valueChange(n))})("change",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())})("keyup",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())}),t.k0s(),t.j41(7,"input",37),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2).$implicit,g=t.XpG();return t.DH7(g.statsForType(g.MonsterType.normal,o).range,n)||(g.statsForType(g.MonsterType.normal,o).range=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())})("keyup",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())}),t.k0s(),t.j41(8,"input",38),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2).$implicit,g=t.XpG();return t.DH7(g.statsForType(g.MonsterType.elite,o).range,n)||(g.statsForType(g.MonsterType.elite,o).range=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())})("keyup",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())}),t.k0s()()}if(2&i){const e=t.XpG(2).$implicit,a=t.XpG();t.R7$(),t.Y8G("ngModel",a.statsForType(a.MonsterType.normal,e).health),t.R7$(),t.Y8G("ngModel",a.statsForType(a.MonsterType.elite,e).health),t.R7$(),t.R50("ngModel",a.statsForType(a.MonsterType.normal,e).movement),t.R7$(),t.R50("ngModel",a.statsForType(a.MonsterType.elite,e).movement),t.R7$(),t.Y8G("ngModel",a.statsForType(a.MonsterType.normal,e).attack),t.R7$(),t.Y8G("ngModel",a.statsForType(a.MonsterType.elite,e).attack),t.R7$(),t.R50("ngModel",a.statsForType(a.MonsterType.normal,e).range),t.R7$(),t.R50("ngModel",a.statsForType(a.MonsterType.elite,e).range)}}function vq(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",33)(1,"input",35),t.bIt("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2).$implicit,g=t.XpG();return t.Njj(g.statsForType(g.MonsterType.boss,o).health=g.valueChange(n))})("change",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())})("keyup",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())}),t.k0s(),t.j41(2,"input",37),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2).$implicit,g=t.XpG();return t.DH7(g.statsForType(g.MonsterType.boss,o).movement,n)||(g.statsForType(g.MonsterType.boss,o).movement=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())})("keyup",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())}),t.k0s(),t.j41(3,"input",35),t.bIt("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2).$implicit,g=t.XpG();return t.Njj(g.statsForType(g.MonsterType.boss,o).attack=g.valueChange(n))})("change",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())})("keyup",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())}),t.k0s(),t.j41(4,"input",37),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2).$implicit,g=t.XpG();return t.DH7(g.statsForType(g.MonsterType.boss,o).range,n)||(g.statsForType(g.MonsterType.boss,o).range=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())})("keyup",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.monsterDataToJson())}),t.k0s()()}if(2&i){const e=t.XpG(2).$implicit,a=t.XpG();t.R7$(),t.Y8G("ngModel",a.statsForType(a.MonsterType.boss,e).health),t.R7$(),t.R50("ngModel",a.statsForType(a.MonsterType.boss,e).movement),t.R7$(),t.Y8G("ngModel",a.statsForType(a.MonsterType.boss,e).attack),t.R7$(),t.R50("ngModel",a.statsForType(a.MonsterType.boss,e).range)}}function Oq(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",42)(1,"span",46),t.nrm(2,"img",47),t.k0s(),t.j41(3,"ghs-action",48),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(3).$implicit,g=t.XpG();return t.Njj(g.editMonsterAction(g.MonsterType.normal,n,o))}),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG(3).$implicit,n=t.XpG();t.R7$(3),t.Y8G("action",e)("monster",n.getMonsterForLevel(a))("inline",!0)("right",!0)("hexSize",.5)("relative",!0)}}function Pq(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",42)(1,"ghs-action",49),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(3).$implicit,g=t.XpG();return t.Njj(g.editMonsterAction(g.MonsterType.elite,n,o))}),t.k0s(),t.j41(2,"span",46),t.nrm(3,"img",47),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG(3).$implicit,n=t.XpG();t.R7$(),t.Y8G("action",e)("monster",n.getMonsterForLevel(a))("inline",!0)("hexSize",.5)("relative",!0)}}function bq(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",39),t.nrm(1,"div",40),t.j41(2,"div",41),t.bIt("cdkDropListDropped",function(n){t.eBV(e);const o=t.XpG(2).$implicit,g=t.XpG();return t.Njj(g.dropMonsterAction(g.MonsterType.normal,o,n))}),t.Z7z(3,Oq,4,6,"div",42,t.fX1),t.j41(5,"a",43),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2).$implicit,o=t.XpG();return t.Njj(o.addMonsterAction(o.MonsterType.normal,n))}),t.nrm(6,"img",44)(7,"span",5),t.k0s()()(),t.j41(8,"div",45),t.nrm(9,"div",40),t.j41(10,"div",41),t.bIt("cdkDropListDropped",function(n){t.eBV(e);const o=t.XpG(2).$implicit,g=t.XpG();return t.Njj(g.dropMonsterAction(g.MonsterType.elite,o,n))}),t.Z7z(11,Pq,4,5,"div",42,t.fX1),t.j41(13,"a",43),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2).$implicit,o=t.XpG();return t.Njj(o.addMonsterAction(o.MonsterType.elite,n))}),t.nrm(14,"img",44)(15,"span",5),t.k0s()()()}if(2&i){const e=t.XpG(2).$implicit,a=t.XpG();t.R7$(),t.Y8G("ghs-label",a.statsForType(a.MonsterType.normal,e).note),t.R7$(2),t.Dyx(a.statsForType(a.MonsterType.normal,e).actions),t.R7$(4),t.Y8G("ghs-label","editor.action.add"),t.R7$(2),t.Y8G("ghs-label",a.statsForType(a.MonsterType.elite,e).note),t.R7$(2),t.Dyx(a.statsForType(a.MonsterType.elite,e).actions),t.R7$(4),t.Y8G("ghs-label","editor.action.add")}}function kq(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",42)(1,"ghs-action",49),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(3).$implicit,g=t.XpG();return t.Njj(g.editMonsterAction(g.MonsterType.boss,n,o))}),t.k0s(),t.j41(2,"span",46),t.nrm(3,"img",47),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG(3).$implicit,n=t.XpG();t.R7$(),t.Y8G("action",e)("monster",n.getMonsterForLevel(a))("inline",!0)("hexSize",.5)("relative",!0)}}function yq(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-action",49),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG().$index,g=t.XpG(3).$implicit,_=t.XpG();return t.Njj(_.editSpecialAction(_.MonsterType.boss,o,n,g))}),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(4).$implicit,n=t.XpG();t.Y8G("action",e)("monster",n.getMonsterForLevel(a))("inline",!0)("hexSize",.5)("relative",!0)}}function xq(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",51)(1,"span",52),t.EFF(2),t.k0s(),t.j41(3,"div",53),t.Z7z(4,yq,1,5,"ghs-action",54,t.fX1),t.j41(6,"a",43),t.bIt("click",function(){const n=t.eBV(e).$index,o=t.XpG(3).$implicit,g=t.XpG();return t.Njj(g.addSpecialAction(g.MonsterType.boss,n,o))}),t.nrm(7,"img",44)(8,"span",5),t.k0s()()()}if(2&i){const e=r.$index,a=t.XpG(3).$implicit,n=t.XpG();t.R7$(2),t.SpI("",e+1,":"),t.R7$(2),t.Dyx(n.statsForType(n.MonsterType.boss,a).special[e]),t.R7$(4),t.Y8G("ghs-label","editor.action.add")}}function Eq(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",34),t.nrm(1,"div",40),t.j41(2,"div",41),t.bIt("cdkDropListDropped",function(n){t.eBV(e);const o=t.XpG(2).$implicit,g=t.XpG();return t.Njj(g.dropMonsterAction(g.MonsterType.boss,o,n))}),t.Z7z(3,kq,4,5,"div",42,t.fX1),t.j41(5,"a",43),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2).$implicit,o=t.XpG();return t.Njj(o.addMonsterAction(o.MonsterType.boss,n))}),t.nrm(6,"img",44)(7,"span",5),t.k0s()(),t.j41(8,"div",50),t.Z7z(9,xq,9,2,"div",51,t.fX1),t.j41(11,"a",43),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2).$implicit,o=t.XpG();return t.Njj(o.addSpecialAction(o.MonsterType.boss,o.statsForType(o.MonsterType.boss,n).special.length,n))}),t.nrm(12,"img",44)(13,"span",5),t.k0s()()()}if(2&i){const e=t.XpG(2).$implicit,a=t.XpG();t.R7$(),t.Y8G("ghs-label",a.statsForType(a.MonsterType.boss,e).note),t.R7$(2),t.Dyx(a.statsForType(a.MonsterType.boss,e).actions),t.R7$(4),t.Y8G("ghs-label","editor.action.add"),t.R7$(2),t.Dyx(a.statsForType(a.MonsterType.boss,e).special),t.R7$(4),t.Y8G("ghs-label","editor.monster.stats.addSpecial")}}function wq(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",28),t.nrm(1,"ghs-monster-stats",30),t.j41(2,"input",31),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG(2);return t.DH7(o.monsterData.name,n)||(o.monsterData.name=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.monsterDataToJson())})("keyup",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.monsterDataToJson())}),t.k0s(),t.nVh(3,Mq,9,8,"div",32),t.nVh(4,vq,5,4,"div",33),t.nVh(5,bq,16,4),t.nVh(6,Eq,14,3,"div",34),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(),t.Y8G("monster",a.getMonsterForLevel(e))("noClick",!0),t.R7$(),t.R50("ngModel",a.monsterData.name),t.R7$(),t.vxM(a.monsterData.boss?-1:3),t.R7$(),t.vxM(a.monsterData.boss?4:-1),t.R7$(),t.vxM(a.monsterData.boss?-1:5),t.R7$(),t.vxM(a.monsterData.boss?6:-1)}}function Rq(i,r){if(1&i&&(t.j41(0,"div",18),t.nVh(1,wq,7,7,"div",28),t.nrm(2,"ghs-monster-stats",29),t.k0s()),2&i){const e=r.$implicit,a=t.XpG();t.R7$(),t.vxM(-1!=e?1:-1),t.R7$(),t.Y8G("monster",a.getMonsterForLevel(e))("forceStats",!0)("relative",!0)("noClick",!0)}}function jq(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",55),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.applyToAllLevel(n.level))}),t.nrm(1,"span",5),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","editor.monster.stats.applyAll"))}function Gq(i,r){if(1&i&&(t.j41(0,"option",23),t.nrm(1,"span",5),t.EFF(2," ("),t.nrm(3,"span",5),t.EFF(4),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG();t.Y8G("value",a)("selected",e.edition==n.monsterData.edition&&e.name==n.monsterData.name),t.R7$(),t.Y8G("ghs-label","data.monster."+e.name),t.R7$(2),t.Y8G("ghs-label","data.edition."+e.edition),t.R7$(),t.SpI(") [",e.name,"] ")}}function Tq(i,r){if(1&i&&(t.j41(0,"option",22),t.nrm(1,"span",5),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ghs-label","data.edition."+e)}}function Sq(i,r){if(1&i&&t.nrm(0,"ghs-deck-editor",27,1),2&i){const e=t.XpG();t.Y8G("monster",e.getMonsterForLevel(e.level))("standalone",!1)("edition",e.edition)}}const so='{"name": "new-monster", "thumbnail" : "", "edition": "", "deck": "", "boss": false, "flying" : false, "hidden":false, "count": 10, "baseStat" : {}, "stats": []}';let $q=(()=>{class i{dialog;route;router;inputMonsterData;monsterStats;deckEditor;gameManager=s.E;MonsterType=S.N;monsterData;ActionType=G.X2;ActionValueType=G.iQ;encodeURIComponent=encodeURIComponent;levels=[0,1,2,3,4,5,6,7];level=-1;monsterError;edition;init=!1;monstersData=[];editions=[];constructor(e,a,n){this.dialog=e,this.route=a,this.router=n,this.monsterData=JSON.parse(so),this.updateType(!1)}ngOnInit(){var e=this;return(0,X.A)(function*(){yield m.f.init(!1),e.monsterDataToJson(),e.inputMonsterData.nativeElement.addEventListener("change",a=>{e.monsterDataFromJson()}),e.editions=s.E.editions(!0),e.monstersData=s.E.monstersData(e.edition),e.route.queryParams.subscribe({next:a=>{if(a.edition&&(e.edition=a.edition,e.edition&&s.E.editions(!0).indexOf(e.edition)),e.monstersData=s.E.monstersData(e.edition),a.monster){const n=e.monstersData.find(o=>o.name==a.monster);n&&(e.monsterData=n,e.monsterDataToJson())}a.level&&(e.level=+a.level,-1!=e.level&&-1==e.levels.indexOf(e.level)&&(e.level=1)),!e.monsterData.edition&&e.edition&&(e.monsterData.edition=e.edition)}}),e.init=!0})()}monsterDataToJson(){this.monsterData.stats.sort((a,n)=>a.level-n.level!=0?a.level-n.level:a.type==S.N.normal&&n.type==S.N.elite?-1:1);let e=JSON.parse(JSON.stringify(this.monsterData));if(e.baseStat.actions=e.baseStat.actions||void 0,e.baseStat.immunities=e.baseStat.immunities||void 0,e.baseStat.special=e.baseStat.special||void 0,Object.keys(e.stats[0]).forEach(a=>{e.stats.every(n=>JSON.stringify(n[a])==JSON.stringify(e.stats[0][a]))&&(e.baseStat[a]=e.stats[0][a],e.stats.forEach(n=>{n[a]=void 0}))}),!e.boss){e.baseStat.type="normal",e.stats.filter(g=>"normal"==g.type).forEach(g=>{g.type=void 0});let a=[];const n=e.stats.filter(g=>!g.type)[0];n&&Object.keys(n).forEach(g=>{n[g]&&e.stats.filter(_=>!_.type).every(_=>JSON.stringify(_[g])==JSON.stringify(n[g]))&&"type"!=g&&(e.baseStat[g]=n[g],a.push(g),e.stats.filter(_=>!_.type).forEach(_=>{_[g]=void 0}))});const o=e.stats.filter(g=>"elite"==g.type)[0];o&&Object.keys(o).forEach(g=>{o[g]&&e.stats.filter(_=>"elite"==_.type).every(_=>JSON.stringify(_[g])==JSON.stringify(o[g]))&&-1==a.indexOf(g)&&"type"!=g&&(e.baseStat[g]=o[g],e.stats.filter(_=>"elite"==_.type).forEach(_=>{_[g]=void 0}))})}Object.keys(e).forEach(a=>{e[a]||(e[a]=void 0)}),e.stats.forEach(a=>{Object.keys(a).forEach(n=>{!a[n]&&"level"!=n&&(a[n]=void 0)}),a.immunities&&0==a.immunities.length&&(a.immunities=void 0),a.actions&&0==a.actions.length?a.actions=void 0:a.actions&&a.actions.forEach(n=>De(n)),a.special&&0==a.special.length?a.special=void 0:a.special&&a.special.forEach(n=>{n.forEach(o=>De(o))})}),Object.keys(e.baseStat).forEach(a=>{e.baseStat[a]||(e.baseStat[a]=void 0)}),e.baseStat.actions&&0==e.baseStat.actions.length?e.baseStat.actions=void 0:e.baseStat.actions&&e.baseStat.actions.forEach(a=>De(a)),e.baseStat.special&&e.baseStat.special.forEach(a=>{a.forEach(n=>De(n))}),this.inputMonsterData.nativeElement.value=JSON.stringify(e,null,2)}monsterDataFromJson(){if(this.monsterError="",this.inputMonsterData.nativeElement.value)try{return this.monsterData=JSON.parse(this.inputMonsterData.nativeElement.value),void(this.monsterData&&this.updateType(!1))}catch(e){this.monsterData=JSON.parse(so),this.monsterError=e}}valueChange(e){return e&&!isNaN(+e)?+e:e}statsForType(e,a){let n=this.monsterData.stats.find(o=>this.monsterData&&o.level==a&&o.type==e);return n||(this.monsterData.errors=this.monsterData.errors||[],!this.monsterData.errors.find(o=>o.type==Bi.H.unknown)&&!this.monsterData.errors.find(o=>o.type==Bi.H.stat)&&(console.error("Could not find '"+e+"' stats for monster: "+this.monsterData.name+" level: "+a),this.monsterData.errors.push(new Bi.h(Bi.H.stat,"monster",this.monsterData.name,this.monsterData.edition,e,""+a))),n=new Lt.f(e,a),this.monsterData.stats.push(n)),n}setLevel(e){this.monsterStats.setLevel(e)}getMonsterForLevel(e){let a=new P.R(this.monsterData);return a.level=-1!=e?e:1,a}applyToAllLevel(e){this.monsterData.stats=this.monsterData.stats.filter(a=>a.level==e);for(let a of this.levels)if(a!=e)if(this.monsterData.boss){let n=JSON.parse(JSON.stringify(this.statsForType(S.N.boss,e)));n.level=a,this.monsterData.stats.push(n)}else{let n=JSON.parse(JSON.stringify(this.statsForType(S.N.normal,e)));n.level=a,this.monsterData.stats.push(n),n=JSON.parse(JSON.stringify(this.statsForType(S.N.elite,e))),n.level=a,this.monsterData.stats.push(n)}this.monsterDataToJson()}updateType(e=!0){if(this.monsterData)if(this.monsterData.boss){this.monsterData.stats=this.monsterData.stats.filter(a=>!a.type||a.type==S.N.boss);for(let a of this.levels)this.monsterData.stats.some(n=>n.level==a)||this.monsterData.stats.push(new Lt.f(S.N.boss,a))}else{this.monsterData.stats=this.monsterData.stats.filter(a=>a.type!=S.N.boss);for(let a of this.levels)this.monsterData.stats.some(n=>n.level==a&&(!n.type||n.type==S.N.normal))||this.monsterData.stats.push(new Lt.f(S.N.normal,a)),this.monsterData.stats.some(n=>n.level==a&&n.type==S.N.elite)||this.monsterData.stats.push(new Lt.f(S.N.elite,a))}e&&this.monsterDataToJson()}toggleBoss(){this.monsterData.count=this.monsterData.boss?1:10,this.updateType()}addMonsterAction(e,a){let n=new G.rc(G.X2.attack);const o=this.statsForType(e,a);o.actions.push(n),this.dialog.open(ve,{panelClass:["dialog"],data:{action:n,monster:this.getMonsterForLevel(a)}}).closed.subscribe({next:_=>{0==_&&o.actions.splice(o.actions.indexOf(n),1),this.monsterDataToJson()}})}editMonsterAction(e,a,n){this.dialog.open(ve,{panelClass:["dialog"],data:{action:a,monster:this.getMonsterForLevel(n)}}).closed.subscribe({next:g=>{if(0==g){const _=this.statsForType(e,n);_.actions.splice(_.actions.indexOf(a),1)}this.monsterDataToJson()}})}dropMonsterAction(e,a,n){const o=this.statsForType(e,a);(0,D.HD)(o.actions,n.previousIndex,n.currentIndex),s.E.uiChange.emit(),this.monsterDataToJson()}addSpecialAction(e,a,n){let o=new G.rc(G.X2.attack);const g=this.statsForType(e,n);g.special||(g.special=[]),g.special.length<=a&&(g.special[a]=[]),g.special[a].push(o),this.dialog.open(ve,{panelClass:["dialog"],data:{action:o,monster:this.getMonsterForLevel(n)}}).closed.subscribe({next:y=>{0==y&&(g.special[a].splice(g.special[a].indexOf(o),1),0==g.special[a].length&&g.special.splice(a,1)),this.monsterDataToJson()}})}editSpecialAction(e,a,n,o){this.dialog.open(ve,{panelClass:["dialog"],data:{action:n,monster:this.getMonsterForLevel(o)}}).closed.subscribe({next:_=>{if(0==_){const y=this.statsForType(e,o);y.special||(y.special=[]),y.special.length<=a&&(y.special[a]=[]),y.special[a].splice(y.special[a].indexOf(n),1),0==y.special[a].length&&y.special.splice(a,1)}this.monsterDataToJson()}})}loadMonsterData(e){const a=+e.target.value;this.monsterData=-1!=a?this.monstersData[a]:JSON.parse(so),this.updateType(),this.monsterDataToJson(),this.updateQueryParams()}updateQueryParams(){!this.monsterData.edition&&this.edition&&(this.monsterData.edition=this.edition),this.router.navigate([],{relativeTo:this.route,queryParams:{edition:this.edition||void 0,monster:this.monsterData&&this.monsterData.name||void 0,level:1!=this.level?this.level:void 0},queryParamsHandling:"merge"})}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG),t.rXU(U.nX),t.rXU(U.Ix))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-monster-editor"]],viewQuery:function(a,n){if(1&a&&(t.GBs(_q,7),t.GBs(mq,5),t.GBs(pq,5)),2&a){let o;t.mGM(o=t.lsd())&&(n.inputMonsterData=o.first),t.mGM(o=t.lsd())&&(n.monsterStats=o.first),t.mGM(o=t.lsd())&&(n.deckEditor=o.first)}},standalone:!1,decls:68,vars:47,consts:[["inputMonsterData",""],["deckEditor",""],[1,"container"],[3,"standalone"],[1,"monster-editor"],[3,"ghs-label"],[1,"columns"],[1,"input"],[1,"monster-stats"],[1,"base-data","dialog"],[1,"dialog-container"],[3,"ngModelChange","change","keyup","ngModel","ghs-label","ghs-label-attribute"],["type","checkbox",3,"ngModelChange","change","ngModel"],["type","number","min","1","max","10",3,"ngModelChange","change","keyup","ngModel","ghs-label","ghs-label-attribute"],[1,"level-select"],[1,"select"],[1,"level",3,"ngClass"],[1,"level",3,"click","ngClass"],[1,"stats-container"],[1,"button"],[1,"output"],[3,"change"],[3,"value"],[3,"value","selected"],[3,"ngModelChange","change","ngModel"],[1,"button",3,"href","download"],["src","./assets/images/export.svg",1,"ghs-icon"],[3,"monster","standalone","edition"],[1,"stats-input"],[1,"stats-preview",3,"monster","forceStats","relative","noClick"],[1,"stats-editor",3,"monster","noClick"],[1,"name",3,"ngModelChange","change","keyup","ngModel"],[1,"stats"],[1,"stats","boss"],[1,"extra","boss"],[1,"stat","end",3,"ngModelChange","change","keyup","ngModel"],[1,"stat","start",3,"ngModelChange","change","keyup","ngModel"],["type","number",1,"stat","end",3,"ngModelChange","change","keyup","ngModel"],["type","number",1,"stat","start",3,"ngModelChange","change","keyup","ngModel"],[1,"extra","normal"],[1,"notes",3,"ghs-label"],["cdkDropList","",1,"additional",3,"cdkDropListDropped"],["cdkDrag","",1,"monster-action"],[3,"click"],["src","./assets/images/plus.svg",1,"ghs-icon"],[1,"extra","elite"],["cdkDragHandle","",1,"handle"],["src","./assets/images/menu.svg",1,"ghs-icon"],[3,"click","action","monster","inline","right","hexSize","relative"],[3,"click","action","monster","inline","hexSize","relative"],[1,"specials"],[1,"special"],[1,"index"],[1,"actions"],[3,"action","monster","inline","hexSize","relative"],[1,"button",3,"click"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",2),t.nrm(1,"ghs-header",3),t.j41(2,"div",4)(3,"h1"),t.nrm(4,"span",5),t.EFF(5," ("),t.nrm(6,"span",5),t.EFF(7,")"),t.k0s(),t.j41(8,"div",6)(9,"div",7)(10,"div",8)(11,"h2"),t.nrm(12,"span",5),t.k0s(),t.j41(13,"div",9)(14,"div",10)(15,"label"),t.nrm(16,"span",5),t.k0s(),t.j41(17,"input",11),t.mxI("ngModelChange",function(_){return t.eBV(o),t.DH7(n.monsterData.edition,_)||(n.monsterData.edition=_),t.Njj(_)}),t.bIt("change",function(){return t.eBV(o),t.Njj(n.monsterDataToJson())})("keyup",function(){return t.eBV(o),t.Njj(n.monsterDataToJson())}),t.k0s(),t.j41(18,"label"),t.nrm(19,"span",5),t.k0s(),t.j41(20,"input",11),t.mxI("ngModelChange",function(_){return t.eBV(o),t.DH7(n.monsterData.deck,_)||(n.monsterData.deck=_),t.Njj(_)}),t.bIt("change",function(){return t.eBV(o),t.Njj(n.monsterDataToJson())})("keyup",function(){return t.eBV(o),t.Njj(n.monsterDataToJson())}),t.k0s(),t.j41(21,"label"),t.nrm(22,"span",5),t.k0s(),t.j41(23,"input",12),t.mxI("ngModelChange",function(_){return t.eBV(o),t.DH7(n.monsterData.boss,_)||(n.monsterData.boss=_),t.Njj(_)}),t.bIt("change",function(){return t.eBV(o),t.Njj(n.toggleBoss())}),t.k0s(),t.j41(24,"label"),t.nrm(25,"span",5),t.k0s(),t.j41(26,"input",12),t.mxI("ngModelChange",function(_){return t.eBV(o),t.DH7(n.monsterData.flying,_)||(n.monsterData.flying=_),t.Njj(_)}),t.bIt("change",function(){return t.eBV(o),t.Njj(n.updateType())}),t.k0s(),t.j41(27,"label"),t.nrm(28,"span",5),t.k0s(),t.j41(29,"input",12),t.mxI("ngModelChange",function(_){return t.eBV(o),t.DH7(n.monsterData.hidden,_)||(n.monsterData.hidden=_),t.Njj(_)}),t.bIt("change",function(){return t.eBV(o),t.Njj(n.updateType())}),t.k0s(),t.j41(30,"label"),t.nrm(31,"span",5),t.k0s(),t.j41(32,"input",13),t.mxI("ngModelChange",function(_){return t.eBV(o),t.DH7(n.monsterData.count,_)||(n.monsterData.count=_),t.Njj(_)}),t.bIt("change",function(){return t.eBV(o),t.Njj(n.monsterDataToJson())})("keyup",function(){return t.eBV(o),t.Njj(n.monsterDataToJson())}),t.k0s()()(),t.j41(33,"div",14)(34,"span",15),t.nrm(35,"span",5),t.EFF(36,":"),t.k0s(),t.Z7z(37,Cq,2,4,"div",16,t.fX1),t.nI1(39,"ghsRange"),t.j41(40,"div",17),t.bIt("click",function(){return t.eBV(o),n.level=-1,t.Njj(n.updateQueryParams())}),t.nrm(41,"span",5),t.k0s()(),t.Z7z(42,Rq,3,5,"div",18,t.fX1),t.nI1(44,"ghsRange"),t.nVh(45,jq,2,1,"a",19),t.k0s()(),t.j41(46,"div",20)(47,"h2"),t.nrm(48,"span",5),t.j41(49,"select",21),t.bIt("change",function(_){return t.eBV(o),t.Njj(n.loadMonsterData(_))}),t.j41(50,"option",22),t.EFF(51,"<"),t.nrm(52,"span",5),t.EFF(53,">"),t.k0s(),t.Z7z(54,Gq,5,5,"option",23,fq),t.k0s(),t.j41(56,"select",24),t.mxI("ngModelChange",function(_){return t.eBV(o),t.DH7(n.edition,_)||(n.edition=_),t.Njj(_)}),t.bIt("change",function(){return t.eBV(o),t.Njj(n.updateQueryParams())}),t.nrm(57,"option"),t.Z7z(58,Tq,2,2,"option",22,t.fX1),t.k0s()(),t.j41(60,"div"),t.EFF(61),t.k0s(),t.nrm(62,"textarea",null,0),t.j41(64,"a",25),t.nrm(65,"img",26)(66,"span",5),t.k0s()()(),t.nVh(67,Sq,2,3,"ghs-deck-editor",27),t.k0s()()}if(2&a){const o=t.sdS(63);t.R7$(),t.Y8G("standalone",!0),t.R7$(3),t.Y8G("ghs-label","editor.monster"),t.R7$(2),t.Y8G("ghs-label","wip"),t.R7$(6),t.Y8G("ghs-label","editor.monster.stats"),t.R7$(4),t.Y8G("ghs-label","edition"),t.R7$(),t.R50("ngModel",n.monsterData.edition),t.Y8G("ghs-label","edition")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","editor.monster.stats.deck"),t.R7$(),t.R50("ngModel",n.monsterData.deck),t.Y8G("ghs-label","editor.monster.stats.deck")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","editor.monster.stats.boss"),t.R7$(),t.R50("ngModel",n.monsterData.boss),t.R7$(2),t.Y8G("ghs-label","editor.monster.stats.flying"),t.R7$(),t.R50("ngModel",n.monsterData.flying),t.R7$(2),t.Y8G("ghs-label","editor.monster.stats.hidden"),t.R7$(),t.R50("ngModel",n.monsterData.hidden),t.R7$(2),t.Y8G("ghs-label","editor.monster.stats.count"),t.R7$(),t.R50("ngModel",n.monsterData.count),t.Y8G("ghs-label","editor.monster.count")("ghs-label-attribute","placeholder"),t.R7$(3),t.Y8G("ghs-label","editor.monster.stats.levelSelect"),t.R7$(2),t.Dyx(t.i5U(39,35,t.lJ4(41,ic),8)),t.R7$(3),t.Y8G("ngClass",t.eq3(42,ac,-1==n.level)),t.R7$(),t.Y8G("ghs-label","editor.monster.stats.allLevel"),t.R7$(),t.Dyx(-1==n.level?t.i5U(44,38,t.lJ4(44,ic),8):t.eq3(45,uq,n.level)),t.R7$(3),t.vxM(-1!=n.level?45:-1),t.R7$(3),t.Y8G("ghs-label","editor.monster.stats.json"),t.R7$(2),t.Y8G("value",-1),t.R7$(2),t.Y8G("ghs-label","editor.monster.new"),t.R7$(2),t.Dyx(n.monstersData),t.R7$(2),t.R50("ngModel",n.edition),t.R7$(2),t.Dyx(n.editions),t.R7$(3),t.SpI(" ",n.monsterError," "),t.R7$(3),t.Y8G("href","data:application/json;charset=utf-8,"+n.encodeURIComponent(o.value),t.B4B)("download",n.monsterData.name+".json"),t.R7$(2),t.Y8G("ghs-label","editor.monster.stats.json.download"),t.R7$(),t.vxM(n.init?67:-1)}},dependencies:[N.YU,O.xH,O.y7,O.me,O.Q0,O.Zm,O.wz,O.BC,O.VZ,O.zX,O.vS,D.O7,D.T1,D.Fb,ae,ao,tt,ge,jn,Tt],styles:["h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{text-align:center;margin-top:calc(var(--ghs-unit) * .7);margin-bottom:calc(var(--ghs-unit) * .2)}input[_ngcontent-%COMP%]:not([type=checkbox]), textarea[_ngcontent-%COMP%]{width:100%;min-width:initial;color:var(--ghs-color-black);background-color:var(--ghs-color-white);border:1px solid var(--ghs-color-gray)}input[_ngcontent-%COMP%]:not([type=checkbox]):hover, textarea[_ngcontent-%COMP%]:hover{border:1px solid var(--ghs-color-gray)}select[_ngcontent-%COMP%]{max-width:100%}textarea[_ngcontent-%COMP%]{width:100%;min-width:calc(var(--ghs-unit) * 20);min-height:calc(var(--ghs-unit) * 50)}.ghs-icon[_ngcontent-%COMP%]{height:1em;width:auto;filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}a[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center}a[_ngcontent-%COMP%]:hover{opacity:.7}a.button[_ngcontent-%COMP%]{justify-content:center;font-family:var(--ghs-font-gh-normal);font-size:calc(var(--ghs-unit) * 3);color:var(--ghs-color-white);padding:calc(var(--ghs-unit) * 1);margin:calc(var(--ghs-unit) * 1) auto;border:1px solid var(--ghs-color-gray);background-color:var(--ghs-color-darkgray);text-decoration:none}a.button[_ngcontent-%COMP%]:hover{opacity:1;color:var(--ghs-color-gray)}a.button[_ngcontent-%COMP%]:hover   .ghs-icon[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)}a[_ngcontent-%COMP%]   .ghs-icon[_ngcontent-%COMP%]:nth-child(1){margin-right:.2em}.base-data[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2.5);color:var(--ghs-color-white);width:70%;min-width:300px;display:grid;grid-template-columns:auto auto;grid-gap:calc(var(--ghs-unit) * 2);margin:calc(var(--ghs-unit) * 1) auto;flex-shrink:1;overflow:auto}.columns[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;max-width:100%;justify-content:space-evenly}.output[_ngcontent-%COMP%]{max-width:100%}.input[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 2)}",".container[_ngcontent-%COMP%]{width:100vw;height:100vh;display:flex;flex-direction:column}.container[_ngcontent-%COMP%]   ghs-header[_ngcontent-%COMP%]{z-index:2}.monster-editor[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * 2)}.monster-stats[_ngcontent-%COMP%]{display:flex;flex-direction:column}.monster-stats[_ngcontent-%COMP%]   .level-select[_ngcontent-%COMP%]{display:flex;grid-gap:calc(var(--ghs-unit) * 2);margin:0 auto;margin-top:calc(var(--ghs-unit) * 3)}.monster-stats[_ngcontent-%COMP%]   .level-select[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);font-size:calc(var(--ghs-unit) * 3);text-shadow:var(--ghs-outline);color:var(--ghs-color-gray);cursor:pointer}.monster-stats[_ngcontent-%COMP%]   .level-select[_ngcontent-%COMP%]   .level.current[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-darkgray)}.monster-stats[_ngcontent-%COMP%]   .level-select[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]{pointer-events:none;font-size:calc(var(--ghs-unit) * 3);color:var(--ghs-color-black)}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:space-around;align-items:center;margin-top:calc(var(--ghs-unit) * 3);min-width:calc(var(--ghs-unit) * 82)}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   ghs-monster-stats[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 40);height:calc(var(--ghs-unit) * 21.5)}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]{position:relative;width:calc(var(--ghs-unit) * 40);height:calc(var(--ghs-unit) * 21.5)}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 6.2);left:calc(var(--ghs-unit) * 15);width:calc(var(--ghs-unit) * 9.5);display:grid;grid-template-columns:1fr 1fr;column-gap:calc(var(--ghs-unit) * 2);filter:drop-shadow(calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) calc(var(--ghs-unit) * .1) var(--ghs-color-black));z-index:1}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.7 * var(--ghs-fontsize));padding:0;width:calc(var(--ghs-unit) * 4 * var(--ghs-fontsize));min-width:auto;color:var(--ghs-color-black);background-color:var(--ghs-color-white);height:calc(var(--ghs-unit) * 2.9 * var(--ghs-fontsize));border:none;margin:calc(var(--ghs-unit) * .2 * var(--ghs-fontsize)) 0}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.end[_ngcontent-%COMP%]{justify-self:end}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat.start[_ngcontent-%COMP%]{justify-self:start;text-align:left}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .stats.boss[_ngcontent-%COMP%]{top:calc(var(--ghs-unit) * 6.5);left:calc(var(--ghs-unit) * 4.5);grid-template-columns:1fr}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .stats.boss[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 6 * var(--ghs-fontsize))}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]{position:absolute;top:calc(var(--ghs-unit) * 6.5);width:calc(var(--ghs-unit) * 14);height:calc(100% - var(--ghs-unit) * 6.5);overflow-y:auto;display:flex;flex-direction:column;font-size:calc(var(--ghs-unit) * 2 * var(--ghs-fontsize))}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .monster-action[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .monster-action[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{cursor:grab}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]{cursor:pointer}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]:hover{opacity:.7}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ghs-icon[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra.normal[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * 25.5);text-align:right}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra.normal[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{justify-content:end}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra.normal[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--ghs-color-black);justify-content:flex-end}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra.normal[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .ghs-icon[_ngcontent-%COMP%]{filter:none}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra.elite[_ngcontent-%COMP%]{right:calc(var(--ghs-unit) * .5);color:var(--ghs-color-white)}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra.boss[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 21);right:calc(var(--ghs-unit) * .5);color:var(--ghs-color-white)}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .special[_ngcontent-%COMP%]{display:flex;align-items:baseline}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .special[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;flex-direction:column}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .special[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .special[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   ghs-action[_ngcontent-%COMP%]:first-child{margin-top:calc(var(--ghs-unit) * .5)}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .extra[_ngcontent-%COMP%]   .special[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * .2)}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);position:absolute;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-text-factor));top:calc(var(--ghs-unit) * .5);left:calc(var(--ghs-unit) * 7);width:calc(var(--ghs-unit) * 26);color:var(--ghs-color-white);background-color:transparent;border:1px solid var(--ghs-color-gray)}.monster-stats[_ngcontent-%COMP%]   .stats-container[_ngcontent-%COMP%]   .stats-input[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]:hover{border:1px solid var(--ghs-color-gray)}"]})}return i})();const Dq=(i,r)=>r.edition+"-"+r.cardId;function Iq(i,r){if(1&i&&(t.j41(0,"option",5),t.nrm(1,"span",3),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ghs-label","data.edition."+e)}}function Aq(i,r){if(1&i&&(t.j41(0,"option",5),t.nrm(1,"span",3),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ghs-label","game.events.type."+e)}}function Vq(i,r){if(1&i&&t.nrm(0,"ghs-event-card",10),2&i){const e=r.$implicit,a=t.XpG();t.Y8G("event",e)("select",-1!=a.selected?a.selected-1:-1)("flipped",0==a.selected)("spoiler",a.spoiler)("debug",a.debug)}}let Fq=(()=>{class i{route;router;gameManager=s.E;settingsManager=m.f;events=[];edition;types=[];type="";selected=-1;iterator=-1;spoiler=!1;debug=!0;constructor(e,a){this.route=e,this.router=a}ngOnInit(){var e=this;return(0,X.A)(function*(){yield m.f.init(!1),s.E.stateManager.init(!0),e.edition=s.E.editions(!0)[0],e.update(),e.route.queryParams.subscribe({next:a=>{let n=!1;a.edition&&(e.edition=a.edition,e.edition&&s.E.editions(!0).indexOf(e.edition),n=!0),a.type&&(e.type=a.type,n=!0),null!=a.selected&&(e.selected=+a.selected),a.iterator&&(e.iterator=+a.iterator),n&&e.update()}})})()}changeIterator(e){this.iterator+=e,this.update(),this.updateQueryParams()}update(){this.events=[],this.edition&&(this.types=s.E.eventCardManager.getEventTypesForEdition(this.edition,!1),(!this.type||-1==this.types.indexOf(this.type))&&(this.type=this.types[0]),this.events=s.E.eventCardManager.getEventCardsForEdition(this.edition,this.type,!1).filter((e,a)=>-1==this.iterator||this.iterator==a))}updateQueryParams(){this.router.navigate([],{relativeTo:this.route,queryParams:{edition:this.edition||void 0,type:this.type||void 0,selected:this.selected,iterator:-1!=this.iterator?this.iterator:void 0},queryParamsHandling:"merge"})}static \u0275fac=function(a){return new(a||i)(t.rXU(U.nX),t.rXU(U.Ix))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-event-cards-tool"]],standalone:!1,decls:39,vars:17,consts:[[1,"container"],[3,"standalone"],[1,"menu"],[3,"ghs-label"],[3,"ngModelChange","change","ngModel"],[3,"value"],[3,"click","disabled"],[3,"click"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"events"],[3,"event","select","flipped","spoiler","debug"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nrm(1,"ghs-header",1),t.j41(2,"div",2)(3,"label"),t.nrm(4,"span",3),t.j41(5,"select",4),t.mxI("ngModelChange",function(g){return t.DH7(n.edition,g)||(n.edition=g),g}),t.bIt("change",function(){return n.update(),n.updateQueryParams()}),t.Z7z(6,Iq,2,2,"option",5,t.fX1),t.k0s()(),t.j41(8,"label"),t.nrm(9,"span",3),t.j41(10,"select",4),t.mxI("ngModelChange",function(g){return t.DH7(n.type,g)||(n.type=g),g}),t.bIt("change",function(){return n.update(),n.updateQueryParams()}),t.Z7z(11,Aq,2,2,"option",5,t.fX1),t.k0s()(),t.j41(13,"label"),t.nrm(14,"span",3),t.j41(15,"select",4),t.mxI("ngModelChange",function(g){return t.DH7(n.selected,g)||(n.selected=g),g}),t.bIt("change",function(){return n.updateQueryParams()}),t.j41(16,"option",5),t.EFF(17,"none"),t.k0s(),t.j41(18,"option",5),t.EFF(19,"flip"),t.k0s(),t.j41(20,"option",5),t.EFF(21,"A."),t.k0s(),t.j41(22,"option",5),t.EFF(23,"B."),t.k0s(),t.j41(24,"option",5),t.EFF(25,"C."),t.k0s()()(),t.j41(26,"button",6),t.bIt("click",function(){return n.changeIterator(-1)}),t.EFF(27,"-"),t.k0s(),t.j41(28,"button",7),t.bIt("click",function(){return n.changeIterator(1)}),t.EFF(29,"+"),t.k0s(),t.j41(30,"label")(31,"input",8),t.mxI("ngModelChange",function(g){return t.DH7(n.spoiler,g)||(n.spoiler=g),g}),t.k0s(),t.nrm(32,"span",3),t.k0s(),t.j41(33,"label")(34,"input",8),t.mxI("ngModelChange",function(g){return t.DH7(n.debug,g)||(n.debug=g),g}),t.k0s(),t.nrm(35,"span",3),t.k0s()(),t.j41(36,"div",9),t.Z7z(37,Vq,1,5,"ghs-event-card",10,Dq),t.k0s()()),2&a&&(t.R7$(),t.Y8G("standalone",!0),t.R7$(3),t.Y8G("ghs-label","settings.edition"),t.R7$(),t.R50("ngModel",n.edition),t.R7$(),t.Dyx(n.gameManager.editions(!0)),t.R7$(3),t.Y8G("ghs-label","game.events.type"),t.R7$(),t.R50("ngModel",n.type),t.R7$(),t.Dyx(n.types),t.R7$(3),t.Y8G("ghs-label","game.events.select"),t.R7$(),t.R50("ngModel",n.selected),t.R7$(),t.Y8G("value",-1),t.R7$(2),t.Y8G("value",0),t.R7$(2),t.Y8G("value",1),t.R7$(2),t.Y8G("value",2),t.R7$(2),t.Y8G("value",3),t.R7$(2),t.Y8G("disabled",-1==n.iterator),t.R7$(5),t.R50("ngModel",n.spoiler),t.R7$(),t.Y8G("ghs-label","game.events.spoiler"),t.R7$(2),t.R50("ngModel",n.debug),t.R7$(),t.Y8G("ghs-label","game.events.debug"),t.R7$(2),t.Dyx(n.events))},dependencies:[O.xH,O.y7,O.Zm,O.wz,O.BC,O.vS,Gi,tt,ge],styles:[".menu[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex}.container[_ngcontent-%COMP%]{width:100vw;height:100vh;display:flex;flex-direction:column}.container[_ngcontent-%COMP%]   ghs-header[_ngcontent-%COMP%]{z-index:2}.events[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;overflow:auto}.events[_ngcontent-%COMP%]   ghs-event-card[_ngcontent-%COMP%]{width:400px;min-width:400px;height:600px;min-height:600px;margin:10px}"]})}return i})();const Xq=(i,r)=>r.edition+"-"+r.index;function Bq(i,r){if(1&i&&(t.j41(0,"option",5),t.nrm(1,"span",3),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ghs-label","data.edition."+e)}}function Yq(i,r){if(1&i&&(t.j41(0,"div",7),t.nrm(1,"ghs-random-monster-card",8),t.k0s()),2&i){const e=r.$implicit;t.R7$(),t.Y8G("section",e)("flipped",!0)}}function Nq(i,r){if(1&i&&(t.j41(0,"div",6),t.Z7z(1,Yq,2,2,"div",7,Xq),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.sections)}}let zq=(()=>{class i{route;router;gameManager=s.E;sections=[];edition;constructor(e,a){this.route=e,this.router=a}ngOnInit(){var e=this;return(0,X.A)(function*(){yield m.f.init(!1),s.E.stateManager.init(!0),e.edition=s.E.editions(!0)[0],e.update(),e.route.queryParams.subscribe({next:a=>{a.edition&&(e.edition=a.edition,e.edition&&s.E.editions(!0).indexOf(e.edition),e.update())}})})()}update(){this.sections=[];const e=s.E.editionData.find(a=>a.edition==this.edition);e&&e.sections&&(this.sections=e.sections.filter(a=>"randomMonsterCard"==a.group).sort((a,n)=>a.name<n.name?-1:1))}updateQueryParams(){this.router.navigate([],{relativeTo:this.route,queryParams:{edition:this.edition||void 0},queryParamsHandling:"merge"})}static \u0275fac=function(a){return new(a||i)(t.rXU(U.nX),t.rXU(U.Ix))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-random-monster-cards-tool"]],standalone:!1,decls:9,vars:4,consts:[[1,"container"],[3,"standalone"],[1,"menu"],[3,"ghs-label"],[3,"ngModelChange","change","ngModel"],[3,"value"],[1,"sections"],[1,"section"],[3,"section","flipped"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nrm(1,"ghs-header",1),t.j41(2,"div",2)(3,"label"),t.nrm(4,"span",3),t.j41(5,"select",4),t.mxI("ngModelChange",function(g){return t.DH7(n.edition,g)||(n.edition=g),g}),t.bIt("change",function(){return n.update(),n.updateQueryParams()}),t.Z7z(6,Bq,2,2,"option",5,t.fX1),t.k0s()()(),t.nVh(8,Nq,3,0,"div",6),t.k0s()),2&a&&(t.R7$(),t.Y8G("standalone",!0),t.R7$(3),t.Y8G("ghs-label","settings.edition"),t.R7$(),t.R50("ngModel",n.edition),t.R7$(),t.Dyx(n.gameManager.editions(!0)),t.R7$(2),t.vxM(n.edition?8:-1))},dependencies:[O.xH,O.y7,O.wz,O.BC,O.vS,tt,ge,Ir],styles:[".container[_ngcontent-%COMP%]{width:100vw;height:100vh;display:flex;flex-direction:column}.container[_ngcontent-%COMP%]   ghs-header[_ngcontent-%COMP%]{z-index:2}.sections[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{display:flex;margin:10px;padding:10px;background-color:var(--ghs-color-darkgray)}.sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   ghs-random-monster-card[_ngcontent-%COMP%]{display:block;width:calc(var(--ghs-unit) * 40);height:calc(var(--ghs-unit) * 60)}"]})}return i})();const Lq=["header"],Uq=(i,r)=>({vertical:i,modern:r}),ro=i=>({active:i}),qq=(i,r)=>r.edition+"-"+r.name;function Hq(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",10),t.bIt("singleClick",function(){const n=t.eBV(e).$index,o=t.XpG();return t.Njj(o.selectCharacterDeck(n))})("doubleClick",function(){const n=t.eBV(e).$index,o=t.XpG();return t.Njj(o.removeCharacter(n))}),t.nrm(1,"img",11),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG();t.Y8G("ngClass",t.eq3(2,ro,n.activeDeckIndex==a+1)),t.R7$(),t.Y8G("src",e.iconUrl,t.B4B)}}function Kq(i,r){if(1&i){const e=t.RV6();t.j41(0,"ghs-attackmodifier-deck",12),t.bIt("before",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.beforeAttackModifierDeck(n))})("after",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.afterAttackModifierDeck(n))}),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("deck",e.activeDeckIndex>0?e.characters[e.activeDeckIndex-1].attackModifierDeck:0==e.activeDeckIndex?e.gameManager.game.allyAttackModifierDeck:e.gameManager.game.monsterAttackModifierDeck)("numeration",e.activeDeckIndex>0?"":0==e.activeDeckIndex?"A":"m")("standalone",!0)("fullscreen",!1)("vertical",e.vertical())("ally",0==e.activeDeckIndex)("character",e.activeDeckIndex>0?e.characters[e.activeDeckIndex-1]:void 0)("battleGoals",!1)}}function Wq(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",16),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.openCharacterSheet())}),t.nrm(1,"img",11),t.j41(2,"span",17),t.EFF(3),t.k0s()()}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("src",e.characters[e.activeDeckIndex-1].iconUrl,t.B4B),t.R7$(2),t.JRh(e.gameManager.characterManager.characterName(e.characters[e.activeDeckIndex-1]))}}function Jq(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",9),t.nVh(1,Wq,4,2,"a",13),t.j41(2,"a",14),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.next())}),t.nrm(3,"span",15),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(),t.vxM(e.activeDeckIndex>0?1:-1),t.R7$(2),t.Y8G("ghs-label","round.next")}}let Zq=(()=>{class i{route;router;dialog;gameManager=s.E;settingsManager=m.f;characters=[];characterWarning=!1;init=!1;activeDeckIndex=-1;header;constructor(e,a,n){this.route=e,this.router=a,this.dialog=n}ngOnInit(){var e=this;return(0,X.A)(function*(){try{yield w.n.init()}catch{}yield m.f.init(!1),yield s.E.stateManager.init(!0),s.E.game.figures.forEach(a=>a.active=!1),e.characters=s.E.game.figures.filter(a=>a instanceof q.K).map(a=>a),s.E.uiChange.emit(),s.E.game.state!=T.mk.next&&s.E.roundManager.nextGameState(!0),e.route.queryParams.subscribe({next:a=>{if(e.characterWarning=!1,a.e&&a.c){let n=s.E.game.figures.find(o=>o instanceof q.K&&o.edition==a.e&&o.name==a.c);if(!n){const o=s.E.charactersData(a.e).find(g=>g.edition==a.e&&g.name==a.c);o&&(s.E.stateManager.before("addChar","data.character."+o.edition+"."+o.name),s.E.characterManager.addCharacter(o,1),s.E.stateManager.after(),n=s.E.game.figures.find(g=>g instanceof q.K&&g.edition==a.e&&g.name==a.c))}n?(e.activeDeckIndex=e.characters.indexOf(n)+1,e.updateQueryParams()):(e.characterWarning=!0,console.warn("No character available for edition '"+a.e+"' with name '"+a.c+"'!"))}else null!=a.a&&(e.activeDeckIndex=0,e.updateQueryParams());e.init=!0}}),e.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{e.characters=s.E.game.figures.filter(a=>a instanceof q.K).map(a=>a),e.activeDeckIndex>e.characters.length+1&&(e.activeDeckIndex=-1,e.updateQueryParams())}})})()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}vertical(){return window.innerWidth<800}selectMonsterDeck(){-1!=this.activeDeckIndex&&(this.activeDeckIndex=-1,this.updateQueryParams(),s.E.game.monsterAttackModifierDeck.active=!1,setTimeout(()=>{s.E.game.monsterAttackModifierDeck.active=!0},1))}selectAllyDeck(){0!=this.activeDeckIndex&&(this.activeDeckIndex=0,this.updateQueryParams(),s.E.game.allyAttackModifierDeck.active=!1,setTimeout(()=>{s.E.game.allyAttackModifierDeck.active=!0},1))}selectCharacterDeck(e){this.activeDeckIndex!=e+1&&(this.activeDeckIndex=e+1,this.updateQueryParams(),this.characters[e].attackModifierDeck.active=!1,setTimeout(()=>{this.characters[e].attackModifierDeck.active=!0},1))}removeCharacter(e){this.activeDeckIndex==e+1&&(this.activeDeckIndex--,this.updateQueryParams()),s.E.stateManager.before("addChar","data.character."+this.characters[e].edition+"."+this.characters[e].name),s.E.characterManager.removeCharacter(this.characters[e]),s.E.stateManager.after()}addCharacter(){this.header.openMenu(we.character_add)}beforeAttackModifierDeck(e){s.E.stateManager.before("updateAttackModifierDeck."+e.type,this.activeDeckIndex>0?s.E.characterManager.characterName(this.characters[this.activeDeckIndex-1]):0==this.activeDeckIndex?"ally":"monster",...e.values)}afterAttackModifierDeck(e){this.activeDeckIndex>0?this.characters[this.activeDeckIndex-1].attackModifierDeck=e.deck:0==this.activeDeckIndex?s.E.game.allyAttackModifierDeck=e.deck:s.E.game.monsterAttackModifierDeck=e.deck,s.E.stateManager.after()}next(){s.E.stateManager.before("draw"),s.E.game.state==T.mk.next&&s.E.roundManager.nextGameState(!0),s.E.roundManager.nextGameState(!0),s.E.game.figures.forEach(e=>e.active=!1),s.E.stateManager.after()}openCharacterSheet(){s.E.stateManager.updatePermissions(),this.dialog.open(Re,{panelClass:["dialog-invert"],data:{character:this.characters[this.activeDeckIndex-1],forceEdit:!0}})}updateQueryParams(){let e,a,n;0==this.activeDeckIndex?e=!0:this.activeDeckIndex>0&&(a=this.characters[this.activeDeckIndex-1].edition,n=this.characters[this.activeDeckIndex-1].name),this.router.navigate([],{relativeTo:this.route,queryParams:{a:e,e:a,c:n},queryParamsHandling:"merge"})}static \u0275fac=function(a){return new(a||i)(t.rXU(U.nX),t.rXU(U.Ix),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-attackmodifier-standalone"]],viewQuery:function(a,n){if(1&a&&t.GBs(Lq,5),2&a){let o;t.mGM(o=t.lsd())&&(n.header=o.first)}},standalone:!1,decls:14,vars:13,consts:[["header",""],["ghs-keyboard-shortcuts","",1,"attackmodifier-standalone",3,"ngClass"],[3,"standalone"],[1,"decks"],[1,"deck",3,"click","ngClass"],["ghs-pointer-input","",1,"deck",3,"ngClass"],[1,"add-character",3,"click"],["src","./assets/images/plus.svg"],[3,"deck","numeration","standalone","fullscreen","vertical","ally","character","battleGoals"],[1,"menu"],["ghs-pointer-input","",1,"deck",3,"singleClick","doubleClick","ngClass"],[3,"src"],[3,"before","after","deck","numeration","standalone","fullscreen","vertical","ally","character","battleGoals"],[1,"character"],[1,"next",3,"click"],[3,"ghs-label"],[1,"character",3,"click"],[1,"title"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",1),t.nrm(1,"ghs-header",2,0),t.j41(3,"div",3)(4,"span",4),t.bIt("click",function(){return t.eBV(o),t.Njj(n.selectMonsterDeck())}),t.EFF(5,"m"),t.k0s(),t.j41(6,"span",4),t.bIt("click",function(){return t.eBV(o),t.Njj(n.selectAllyDeck())}),t.EFF(7,"A"),t.k0s(),t.Z7z(8,Hq,2,4,"span",5,qq),t.j41(10,"a",6),t.bIt("click",function(){return t.eBV(o),t.Njj(n.addCharacter())}),t.nrm(11,"img",7),t.k0s()(),t.nVh(12,Kq,1,8,"ghs-attackmodifier-deck",8),t.nVh(13,Jq,4,2,"div",9),t.k0s()}2&a&&(t.Y8G("ngClass",t.l_i(6,Uq,n.vertical(),"modern"==n.settingsManager.settings.theme)),t.R7$(),t.Y8G("standalone",!0),t.R7$(3),t.Y8G("ngClass",t.eq3(9,ro,-1==n.activeDeckIndex)),t.R7$(2),t.Y8G("ngClass",t.eq3(11,ro,0==n.activeDeckIndex)),t.R7$(2),t.Dyx(n.characters),t.R7$(4),t.vxM(n.init?12:-1),t.R7$(),t.vxM(n.init?13:-1))},dependencies:[N.YU,yn,tt,ge,Vi,rt],styles:[".attackmodifier-standalone[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100vw;height:100vh}.attackmodifier-standalone[_ngcontent-%COMP%]   ghs-header[_ngcontent-%COMP%]{z-index:2}.attackmodifier-standalone[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:calc(var(--ghs-unit) * 1) 0}.attackmodifier-standalone[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);display:flex;justify-content:center;z-index:2;width:calc(var(--ghs-unit) * 5);height:calc(var(--ghs-unit) * 5);color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 3.5);line-height:calc(var(--ghs-unit) * 4.5);background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(am-character-icon.83c1ab396221d56b.png);margin:calc(var(--ghs-unit) * 1);cursor:pointer}.attackmodifier-standalone[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * .8);filter:grayscale(100%) brightness(100) contrast(100%);height:70%;width:auto}.attackmodifier-standalone[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]:hover{filter:brightness(.7)}.attackmodifier-standalone[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .deck.active[_ngcontent-%COMP%]{cursor:initial;filter:grayscale(.5) brightness(.5)}.attackmodifier-standalone[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .add-character[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 5);height:calc(var(--ghs-unit) * 5);margin:calc(var(--ghs-unit) * 1)}.attackmodifier-standalone[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .add-character[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5);height:auto;filter:var(--ghs-filter-grayscale)}.attackmodifier-standalone[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .add-character[_ngcontent-%COMP%]:hover{opacity:.7}.attackmodifier-standalone[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{display:flex;width:calc(var(--ghs-unit) * 80);height:calc(var(--ghs-unit) * 21);z-index:1;margin-top:calc(var(--ghs-unit) * 5);margin-left:calc(var(--ghs-unit) * 7)}.attackmodifier-standalone[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 5);display:flex;justify-content:flex-start;align-items:center}.attackmodifier-standalone[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 4);margin:calc(var(--ghs-unit) * 1);color:var(--ghs-color-darkgray)}.attackmodifier-standalone[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}.attackmodifier-standalone[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:nth-child(1){margin-right:calc(var(--ghs-unit) * 4)}.attackmodifier-standalone[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4.5);width:auto;margin-right:calc(var(--ghs-unit) * 1)}.attackmodifier-standalone[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:brightness(1.3)}.attackmodifier-standalone.vertical[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden}.attackmodifier-standalone.vertical[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 10);height:calc(var(--ghs-unit) * 10);font-size:calc(var(--ghs-unit) * 7);line-height:calc(var(--ghs-unit) * 9)}.attackmodifier-standalone.vertical[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .deck[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1.5)}.attackmodifier-standalone.vertical[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .add-character[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 10);height:calc(var(--ghs-unit) * 10)}.attackmodifier-standalone.vertical[_ngcontent-%COMP%]   .decks[_ngcontent-%COMP%]   .add-character[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 7)}.attackmodifier-standalone.vertical[_ngcontent-%COMP%]   ghs-attackmodifier-deck[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 94);margin-left:calc(var(--ghs-unit) * 1);margin-right:calc(var(--ghs-unit) * 5);height:0;max-height:initial;transform:none}.attackmodifier-standalone.vertical[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{flex-direction:column;align-items:end}.attackmodifier-standalone.vertical[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 5)}.attackmodifier-standalone.vertical[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:nth-child(1){margin-right:calc(var(--ghs-unit) * 1)}.attackmodifier-standalone.vertical[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 5.5)}.attackmodifier-standalone.modern[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--ghs-color-gray)}"]})}return i})();const Qq=(i,r,e)=>({vertical:i,fh:r,modern:e}),tH=(i,r)=>({error:i,warn:r}),eH=()=>[1,2,3,4,5,6,7,8,9],co=i=>({active:i}),nH=(i,r)=>r.edition+"-"+r.name;function iH(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1,"\xa0("),t.nrm(2,"span",19),t.EFF(3,")"),t.k0s()),2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","data.character."+e.character.edition+"."+e.character.name)}}function aH(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function oH(i,r){if(1&i&&(t.j41(0,"span",12),t.nVh(1,aH,2,0,"span"),t.j41(2,"span"),t.EFF(3),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(),t.vxM(e.character.initiative<10?1:-1),t.R7$(2),t.JRh(e.character.initiative)}}function sH(i,r){1&i&&(t.j41(0,"span",12),t.EFF(1," ?? "),t.k0s())}function rH(i,r){1&i&&(t.j41(0,"span",12),t.EFF(1," -- "),t.k0s())}function cH(i,r){1&i&&t.nrm(0,"img",13)}function lH(i,r){if(1&i){const e=t.RV6();t.nrm(0,"span",20),t.j41(1,"span",21),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.setLongRest())}),t.nrm(2,"img",13)(3,"span",19),t.k0s()}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(2,co,e.longRest)),t.R7$(2),t.Y8G("ghs-label","game.figure.longRest"+(e.longRest?"Off":""))}}function gH(i,r){1&i&&t.nrm(0,"img",13)}function dH(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",16),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.pickNumber(n))}),t.j41(1,"span",17),t.EFF(2),t.k0s()()}if(2&i){const e=r.$implicit;t.R7$(2),t.JRh(e)}}function hH(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",21),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.setLongRest())}),t.nrm(1,"img",13)(2,"span",19),t.k0s()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(2,co,e.longRest)),t.R7$(2),t.Y8G("ghs-label","game.figure.longRest"+(e.longRest?"Off":""))}}function _H(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",4)(1,"div",7)(2,"div",8)(3,"span",9),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openCharacterSheet())}),t.nrm(4,"img",10),t.EFF(5),t.nVh(6,iH,4,1,"span"),t.k0s(),t.j41(7,"div",11),t.nVh(8,oH,4,2,"span",12),t.nVh(9,sH,2,0,"span",12),t.nVh(10,rH,2,0,"span",12),t.nVh(11,cH,1,0,"img",13),t.k0s(),t.nVh(12,lH,4,4),t.k0s(),t.j41(13,"div",14),t.nrm(14,"span"),t.j41(15,"span",12),t.EFF(16),t.nVh(17,gH,1,0,"img",13),t.k0s(),t.nrm(18,"span"),t.Z7z(19,dH,3,1,"span",15,t.fX1),t.j41(21,"span",16),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.value="__")}),t.j41(22,"span",17),t.EFF(23,"*"),t.k0s()(),t.j41(24,"span",16),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.pickNumber(0))}),t.j41(25,"span",17),t.EFF(26,"0"),t.k0s()(),t.j41(27,"span",16),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.setCurrentValue())}),t.j41(28,"span",17),t.EFF(29,"#"),t.k0s()()(),t.nVh(30,hH,3,4,"span",18),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(4),t.Y8G("src",e.character.iconUrl,t.B4B),t.R7$(),t.SpI(" ",e.gameManager.characterManager.characterName(e.character)," "),t.R7$(),t.vxM(e.character.title?6:-1),t.R7$(),t.Y8G("ngClass",t.l_i(12,tH,200!=e.statusCode&&403!=e.statusCode,403==e.statusCode)),t.R7$(),t.vxM(e.character.initiative&&(e.character.initiativeVisible||"next"==e.gameManager.game.state)?8:-1),t.R7$(),t.vxM(e.character.initiative&&!e.character.initiativeVisible&&"next"!=e.gameManager.game.state?9:-1),t.R7$(),t.vxM(e.character.initiative?-1:10),t.R7$(),t.vxM(e.character.initiativeVisible&&99==e.character.initiative&&e.character.longRest?11:-1),t.R7$(),t.vxM(e.vertical()?-1:12),t.R7$(4),t.SpI("",e.value," "),t.R7$(),t.vxM(e.longRest?17:-1),t.R7$(2),t.Dyx(t.lJ4(15,eH)),t.R7$(11),t.vxM(e.vertical()?30:-1)}}function mH(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",22),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.selectCharacter(n))}),t.nrm(1,"img",23),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(2,co,a.character==e)),t.R7$(),t.Y8G("src",e.iconUrl,t.B4B)}}function pH(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",24),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.settingsManager.toggle("standaloneInitiativeAutomatic"))}),t.k0s(),t.nrm(2,"span",19),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("checked",e.settingsManager.settings.standaloneInitiativeAutomatic),t.R7$(),t.Y8G("ghs-label","Automatic")}}let uH=(()=>{class i{dialog;gameManager=s.E;settingsManager=m.f;characters=[];character;value="__";longRest=!1;statusCode=200;constructor(e){this.dialog=e}ngOnInit(){var e=this;return(0,X.A)(function*(){try{yield w.n.init()}catch{}yield m.f.init(!1),yield s.E.stateManager.init(!0),e.update(),s.E.uiChange.emit(),e.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>e.update()}),window.addEventListener("focus",a=>{m.f.settings.serverAutoconnect&&s.E.stateManager.wsState()!=WebSocket.OPEN&&s.E.stateManager.connect()})})()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.characters=s.E.game.figures.filter(e=>e instanceof q.K).map(e=>e),this.character=this.characters.find(e=>e.fullview)||this.characters.length&&this.characters[0]||void 0,this.statusCode=200}vertical(){return window.innerWidth<800}selectCharacter(e){this.character==e?this.openCharacterSheet():(this.characters.forEach(a=>a.fullview=!1),this.character=e,this.character.fullview=!0,s.E.stateManager.saveLocal())}onKeyPress(e){m.f.settings.keyboardShortcuts&&(0,V.bb)(e)&&0==this.dialog.openDialogs.length&&e.key in["0","1","2","3","4","5","6","7","8","9"]&&(this.pickNumber(+e.key),e.preventDefault(),e.stopPropagation())}pickNumber(e){-1==this.value.indexOf("_")&&(this.value="__",this.longRest=!1),"__"==this.value?(this.value=e+"_",this.longRest=!1):(this.value=this.value[0]+e,m.f.settings.standaloneInitiativeAutomatic&&this.updateInitiative(+this.value))}updateInitiative(e){this.character&&(this.character.initiative!=e||this.longRest!=this.character.longRest)&&(e>=0&&e<100?this.setInitiative(e):s.E.game.state==T.mk.draw&&(this.character.initiative=0))}setInitiative(e){var a=this;return(0,X.A)(function*(){if(a.character&&((s.E.game.state==T.mk.draw||!m.f.settings.initiativeRequired)&&e>=0||e>=0)&&e<100&&(e!=a.character.initiative||a.longRest!=a.character.longRest)){if(a.statusCode=200,s.E.stateManager.wsState()==WebSocket.OPEN&&m.f.settings.serverUrl){let n=m.f.settings.serverWss?"https://":"http://";const o=m.f.settings.serverUrl.split("/");n+=o[0],(m.f.settings.serverWss&&443!=m.f.settings.serverPort||!m.f.settings.serverWss&&80!=m.f.settings.serverPort)&&(n+=":"+m.f.settings.serverPort),o.length>1&&(n+="/"+o.slice(1).join("/")),n+="/game/initiative";const g=yield fetch(n,{method:"POST",body:JSON.stringify({playerNumber:a.character.number,initiative:e,longRest:a.longRest}),headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:m.f.settings.serverCode||""}});a.statusCode=g.status}200==a.statusCode&&(a.character.initiativeVisible=!0,a.character.initiative=e,a.character.longRest=a.longRest,99!=a.character.initiative&&(a.character.longRest=!1),a.value="__",a.longRest=!1,s.E.stateManager.saveLocal())}})()}setLongRest(){this.character&&(this.longRest=!this.longRest,this.value="99",m.f.settings.standaloneInitiativeAutomatic&&this.updateInitiative(+this.value))}openCharacterSheet(){this.character&&(s.E.stateManager.updatePermissions(),this.dialog.open(Re,{panelClass:["dialog-invert"],data:{character:this.character}}))}setCurrentValue(){this.value=this.value.replaceAll("_",""),this.setInitiative(this.value&&+this.value||0)}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-initiative-standalone"]],hostBindings:function(a,n){1&a&&t.bIt("keydown",function(g){return n.onKeyPress(g)},t.EBC)},standalone:!1,decls:9,vars:9,consts:[["header",""],["ghs-keyboard-shortcuts","",1,"initiative-standalone",3,"ngClass"],[3,"standalone","connection"],[1,"scroll-container"],[1,"dialog"],[1,"characters"],[1,"character",3,"ngClass"],[1,"dialog-container","initiative-dialog"],[1,"title"],[1,"character",3,"click"],[1,"icon",3,"src"],[1,"initiative",3,"ngClass"],[1,"value"],["src","./assets/images/long-rest.svg",1,"ghs-svg"],[1,"number-container"],[1,"number-button"],[1,"number-button",3,"click"],[1,"number"],[1,"long-rest-button",3,"ngClass"],[3,"ghs-label"],[1,"spacer"],[1,"long-rest-button",3,"click","ngClass"],[1,"character",3,"click","ngClass"],[3,"src"],["type","checkbox",3,"change","checked"]],template:function(a,n){1&a&&(t.j41(0,"div",1),t.nrm(1,"ghs-header",2,0),t.j41(3,"div",3),t.nVh(4,_H,31,16,"div",4),t.j41(5,"div",5),t.Z7z(6,mH,2,4,"span",6,nH),t.nVh(8,pH,3,2,"label"),t.k0s()()()),2&a&&(t.Y8G("ngClass",t.sMw(5,Qq,n.vertical(),"fh"==n.settingsManager.settings.theme,"modern"==n.settingsManager.settings.theme)),t.R7$(),t.Y8G("standalone",!0)("connection",!0),t.R7$(3),t.vxM(n.character?4:-1),t.R7$(2),t.Dyx(n.characters),t.R7$(2),t.vxM(n.character?8:-1))},dependencies:[N.YU,tt,ge,Vi],styles:[".initiative-standalone[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100vw;height:100vh}.initiative-standalone[_ngcontent-%COMP%]   ghs-header[_ngcontent-%COMP%]{z-index:2}.initiative-standalone[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.initiative-standalone[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:calc(var(--ghs-unit) * 1) 0}.initiative-standalone[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);display:flex;justify-content:center;z-index:2;width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));color:var(--ghs-color-white);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));line-height:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor));background-position:center;background-size:100% auto;background-repeat:no-repeat;background-image:url(token.d1b1e1243b98d66e.png);margin:calc(var(--ghs-unit) * 1);cursor:pointer;filter:grayscale(.5) brightness(.5)}.initiative-standalone[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * .8);height:70%;width:auto}.initiative-standalone[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]:hover{filter:brightness(.7)}.initiative-standalone[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character.active[_ngcontent-%COMP%]{filter:none}.initiative-standalone[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor))}.initiative-standalone[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{border-color:var(--ghs-color-black)}.initiative-standalone[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before{color:var(--ghs-color-black);background-color:var(--ghs-color-black)}.initiative-standalone[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover:before{background-color:var(--ghs-color-darkgray)}.initiative-standalone[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 50 * var(--ghs-dialog-factor));max-width:calc(50vw - var(--ghs-unit) * 4);margin:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.initiative-standalone[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.initiative-standalone[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 32 * var(--ghs-dialog-factor))}.initiative-standalone[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{cursor:pointer;margin-top:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.initiative-standalone[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]{display:flex;align-items:center}.initiative-standalone[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-gh-title);font-size:calc(var(--ghs-unit) * 4.5 * var(--ghs-dialog-factor))}.initiative-standalone[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .initiative[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white);height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:auto;margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.initiative-standalone[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .long-rest-button[_ngcontent-%COMP%]{margin-top:auto}.initiative-standalone[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]   .number-container[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:flex;align-items:center}.initiative-standalone[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]   .number-container[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white);height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));width:auto;margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.initiative-standalone.vertical[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden}.initiative-standalone.vertical[_ngcontent-%COMP%]   .scroll-container[_ngcontent-%COMP%]{flex-direction:column}.initiative-standalone.vertical[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 40 * var(--ghs-dialog-factor));max-width:calc(100vw - var(--ghs-unit) * 4)}.initiative-standalone.vertical[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]{flex-direction:column}.initiative-standalone.vertical[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{height:auto}.initiative-standalone.vertical[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]   .initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{margin-top:initial}.initiative-standalone.vertical[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 10 * var(--ghs-text-factor));height:calc(var(--ghs-unit) * 10 * var(--ghs-text-factor));font-size:calc(var(--ghs-unit) * 7 * var(--ghs-text-factor));line-height:calc(var(--ghs-unit) * 9 * var(--ghs-text-factor))}.initiative-standalone.vertical[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1.5)}.initiative-standalone.modern[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--ghs-color-gray)}.initiative-standalone.fh[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{background-image:url(token.9002cdeea8845c1f.png)}.initiative-standalone.fh[_ngcontent-%COMP%]   .characters[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:brightness(1.3)}",".initiative-dialog[_ngcontent-%COMP%]{position:relative}.initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white)}.initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray)}.initiative-dialog[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .character[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));width:auto;margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.initiative-dialog[_ngcontent-%COMP%]   .number-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor) * var(--ghs-text-factor)))}.initiative-dialog[_ngcontent-%COMP%]   .number-container[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor) * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.initiative-dialog[_ngcontent-%COMP%]   .number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor) * var(--ghs-text-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor) * var(--ghs-text-factor));cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor) * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline)}.initiative-dialog[_ngcontent-%COMP%]   .number-container[_ngcontent-%COMP%]   .number-button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray);margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button.active[_ngcontent-%COMP%]{color:var(--ghs-color-white)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button.active[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button.active[_ngcontent-%COMP%]:hover{color:var(--ghs-color-darkgray)}.initiative-dialog[_ngcontent-%COMP%]   .long-rest-button.active[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)}"]})}return i})();const fH=i=>({vertical:i});let CH=(()=>{class i{gameManager=s.E;configuration=!1;ngOnInit(){var e=this;return(0,X.A)(function*(){try{yield w.n.init()}catch{}yield m.f.init(!1),yield s.E.stateManager.init(!0),s.E.uiChange.emit(),s.E.game.state!=T.mk.next&&s.E.roundManager.nextGameState(!0),0==s.E.game.lootDeck.cards.length&&(e.configuration=!0)})()}vertical(){return window.innerWidth<800}beforeLootDeck(e){s.E.stateManager.before(e.type,...e.values)}afterLootDeck(e){s.E.game.lootDeck=e.deck,s.E.stateManager.after()}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-loot-deck-standalone"]],standalone:!1,decls:3,vars:9,consts:[["ghs-keyboard-shortcuts","",1,"loot-deck-standalone",3,"ngClass"],[3,"standalone"],[3,"before","after","deck","fullscreen","standalone","vertical","characters"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nrm(1,"ghs-header",1),t.j41(2,"ghs-loot-deck",2),t.bIt("before",function(g){return n.beforeLootDeck(g)})("after",function(g){return n.afterLootDeck(g)}),t.k0s()()),2&a&&(t.Y8G("ngClass",t.eq3(7,fH,n.vertical())),t.R7$(),t.Y8G("standalone",!0),t.R7$(),t.Y8G("deck",n.gameManager.game.lootDeck)("fullscreen",!1)("standalone",!0)("vertical",n.vertical())("characters",!1))},dependencies:[N.YU,ge,Vi,Sa],styles:[".loot-deck-standalone[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100vw;height:100vh}.loot-deck-standalone[_ngcontent-%COMP%]   ghs-header[_ngcontent-%COMP%]{z-index:2;width:100%}.loot-deck-standalone[_ngcontent-%COMP%]   ghs-loot-deck[_ngcontent-%COMP%]{display:flex;width:99vw;max-width:600px;height:100vw;max-height:420px;z-index:1;margin-top:2em}.loot-deck-standalone.vertical[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden}.loot-deck-standalone.vertical[_ngcontent-%COMP%]   ghs-loot-deck[_ngcontent-%COMP%]{width:98vw;margin-right:1%;height:132vw;max-height:800px;transform:none}"]})}return i})();function MH(i,r){if(1&i&&(t.j41(0,"option",5),t.nrm(1,"span",3),t.k0s()),2&i){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ghs-label","data.edition."+e)}}function vH(i,r){if(1&i&&(t.j41(0,"div",7)(1,"span",8),t.EFF(2),t.k0s(),t.nrm(3,"ghs-treasure-label",9),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(2),t.JRh(e.index),t.R7$(),t.Y8G("treasure",e)("edition",a.edition)}}function OH(i,r){if(1&i&&(t.j41(0,"div",6),t.Z7z(1,vH,4,3,"div",7,t.fX1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.treasures)}}const PH=[{path:"editor/edition",component:hq},{path:"editor/deck",component:ao},{path:"editor/monster",component:$q},{path:"editor/character",component:iq},{path:"tools/attackmodifier",component:gU},{path:"tools/decks",component:yU},{path:"tools/events",component:Fq},{path:"tools/treasures",component:(()=>{class i{route;router;gameManager=s.E;treasures=[];edition;constructor(e,a){this.route=e,this.router=a}ngOnInit(){var e=this;return(0,X.A)(function*(){yield m.f.init(!1),s.E.stateManager.init(!0),e.edition=s.E.editions(!0)[0],e.update(),e.route.queryParams.subscribe({next:a=>{a.edition&&(e.edition=a.edition,e.edition&&s.E.editions(!0).indexOf(e.edition),e.update())}})})()}update(){this.treasures=[];const e=s.E.editionData.find(a=>a.edition==this.edition);e&&e.treasures&&e.treasures.forEach((a,n)=>{this.treasures.push(new Ct.Ah(a,n+1+(e.treasureOffset||0)))})}updateQueryParams(){this.router.navigate([],{relativeTo:this.route,queryParams:{edition:this.edition||void 0},queryParamsHandling:"merge"})}static \u0275fac=function(a){return new(a||i)(t.rXU(U.nX),t.rXU(U.Ix))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-treasures-tool"]],standalone:!1,decls:9,vars:4,consts:[[1,"container"],[3,"standalone"],[1,"menu"],[3,"ghs-label"],[3,"ngModelChange","change","ngModel"],[3,"value"],[1,"treasures"],[1,"treasure"],[1,"index"],[1,"placeholder","text-white",3,"treasure","edition"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nrm(1,"ghs-header",1),t.j41(2,"div",2)(3,"label"),t.nrm(4,"span",3),t.j41(5,"select",4),t.mxI("ngModelChange",function(g){return t.DH7(n.edition,g)||(n.edition=g),g}),t.bIt("change",function(){return n.update(),n.updateQueryParams()}),t.Z7z(6,MH,2,2,"option",5,t.fX1),t.k0s()()(),t.nVh(8,OH,3,0,"div",6),t.k0s()),2&a&&(t.R7$(),t.Y8G("standalone",!0),t.R7$(3),t.Y8G("ghs-label","settings.edition"),t.R7$(),t.R50("ngModel",n.edition),t.R7$(),t.Dyx(n.gameManager.editions(!0)),t.R7$(2),t.vxM(n.edition?8:-1))},dependencies:[O.xH,O.y7,O.wz,O.BC,O.vS,tt,ge,Pn],styles:[".container[_ngcontent-%COMP%]{width:100vw;height:100vh;display:flex;flex-direction:column}.container[_ngcontent-%COMP%]   ghs-header[_ngcontent-%COMP%]{z-index:2}.treasures[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;overflow:auto}.treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]{display:flex;margin:10px;padding:10px;background-color:var(--ghs-color-darkgray);color:var(--ghs-color-white);font-size:2em}.treasures[_ngcontent-%COMP%]   .treasure[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{margin-right:5px}"]})}return i})()},{path:"tools/random-monster-cards",component:zq},{path:"loot",component:CH},{path:"am",component:Zq},{path:"initiative",component:uH},{path:"**",component:aU}];let bH=(()=>{class i{static \u0275fac=function(a){return new(a||i)};static \u0275mod=t.$C({type:i});static \u0275inj=t.G2t({imports:[U.iI.forRoot(PH,{}),U.iI]})}return i})(),kH=(()=>{class i{meta;dialog;title="gloomhavensecretariat";theme="";locale="";constructor(e,a){this.meta=e,this.dialog=a,this.dialog.afterOpened.subscribe({next:n=>{if(n.overlayRef.backdropElement&&a.openDialogs.length>1&&!n.overlayRef.backdropElement.classList.contains("fullscreen-backdrop")&&(n.overlayRef.backdropElement.style.opacity="0"),!n.disableClose){let o=document.createElement("img");o.src="./assets/images/close_dialog.svg";let g=document.createElement("a");g.classList.add("dialog-close-button"),g.appendChild(o),g.addEventListener("pointerdown",()=>{(0,V.co)(n)}),g.title=m.f.getLabel("close"),n.overlayRef.hostElement&&n.overlayRef.hostElement.appendChild(g),n.overlayRef.backdropElement&&(n.disableClose=!0,n.overlayRef.backdropElement.addEventListener("pointerdown",()=>{(0,V.co)(n)})),n.keydownEvents.subscribe(_=>{m.f.settings.keyboardShortcuts&&!_.ctrlKey&&!_.shiftKey&&!_.altKey&&"Escape"===_.key&&(0,V.co)(n)})}}})}ngOnInit(){this.applyStyle(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.applyStyle(),this.applyAnimations()}});const e=a=>a.preventDefault();document.addEventListener("gesturestart",e),document.addEventListener("gesturechange",e),document.addEventListener("gestureend",e)}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}applyStyle(){this.theme=m.f.settings.theme,"fh"==this.theme?(document.body.classList.remove("modern"),document.body.classList.remove("bb"),document.body.classList.add("fh"),this.meta.updateTag({name:"theme-color",content:"#a2bbd1"})):"modern"==this.theme?(document.body.classList.remove("fh"),document.body.classList.remove("bb"),document.body.classList.add("modern"),this.meta.updateTag({name:"theme-color",content:"#0e1f1f"})):"bb"==this.theme?(document.body.classList.remove("modern"),document.body.classList.remove("fh"),document.body.classList.add("bb"),this.meta.updateTag({name:"theme-color",content:"#0e1f1f"})):(document.body.classList.remove("fh"),document.body.classList.remove("modern"),document.body.classList.remove("bb"),this.meta.updateTag({name:"theme-color",content:"#936658"})),m.f.settings.portraitMode?document.body.classList.add("portrait-mode"):document.body.classList.remove("portrait-mode"),this.isAppDevMode()||m.f.settings.debugRightClick?document.body.classList.contains("disable-context-menu-touch")&&document.body.classList.remove("disable-context-menu-touch"):document.body.classList.contains("disable-context-menu-touch")||document.body.classList.add("disable-context-menu-touch"),this.locale=m.f.settings.locale;for(let e=document.body.classList.length-1;e>=0;e--){const a=document.body.classList[e];a.startsWith("locale-")&&document.body.classList.remove(a)}document.body.classList.add("locale-"+this.locale)}applyAnimations(){m.f.settings.animations?document.body.classList.remove("no-animations"):document.body.classList.add("no-animations")}isAppDevMode(){return(0,t.naY)()}onRightClick(){return!(!this.isAppDevMode()&&!m.f.settings.debugRightClick)}static \u0275fac=function(a){return new(a||i)(t.rXU(C.W8),t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["app-root"]],standalone:!1,decls:2,vars:1,consts:[[1,"container",3,"contextmenu","ngClass"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.bIt("contextmenu",function(){return n.onRightClick()}),t.nrm(1,"router-outlet"),t.k0s()),2&a&&t.Y8G("ngClass",n.theme)},dependencies:[N.YU,U.n3],styles:[".container[_ngcontent-%COMP%]{position:relative;width:100vw;max-width:100vw;height:100vh;max-height:100vh;background-image:url(bg.21a3b4d9cc4773f5.jpg);background-size:cover;overflow:auto}.container.fh[_ngcontent-%COMP%]{background-image:url(bg.b402b1d465a94b7a.jpg)}.container.modern[_ngcontent-%COMP%]{background-image:url(bg.cca7e4a6587b5386.jpg)}.container.bb[_ngcontent-%COMP%]{background-image:url(bg.e816b4b333daa495.jpg)}"]})}return i})();const yH=(i,r)=>({edit:i,fh:r}),xH=i=>({enhance:i}),EH=(i,r)=>r+i;function wH(i,r){if(1&i&&t.nrm(0,"img",3),2&i){const e=t.XpG().$implicit,a=t.XpG();t.Y8G("src",a.gameManager.enhancementsManager.fh&&"any"!=e?"./assets/images/fh/character/abilities/enhancements/"+e+".svg":"./assets/images/character/abilities/enhancements/circle.svg",t.B4B)}}function RH(i,r){1&i&&(t.j41(0,"span",5),t.EFF(1,"+1"),t.k0s())}function jH(i,r){1&i&&(t.j41(0,"span",6),t.nrm(1,"img",10),t.k0s())}function GH(i,r){1&i&&(t.j41(0,"span",7),t.nrm(1,"span",11),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","%game.actionIcon.jump%"))}function TH(i,r){if(1&i&&(t.j41(0,"span",8),t.nrm(1,"span",12),t.k0s()),2&i){const e=t.XpG(2).$index,a=t.XpG();t.R7$(),t.Y8G("ghs-label","%game.element."+a.enhancements[null!=a.slotIndex?a.slotIndex:e]+"%")}}function SH(i,r){if(1&i&&(t.j41(0,"span",9),t.nrm(1,"span",12),t.k0s()),2&i){const e=t.XpG(2).$index,a=t.XpG();t.R7$(),t.Y8G("ghs-label","%game.conditionIcon."+a.enhancements[null!=a.slotIndex?a.slotIndex:e]+"%")}}function $H(i,r){if(1&i&&(t.j41(0,"span",4),t.nVh(1,RH,2,0,"span",5),t.nVh(2,jH,2,0,"span",6),t.nVh(3,GH,2,1,"span",7),t.nVh(4,TH,2,1,"span",8),t.nVh(5,SH,2,1,"span",9),t.k0s()),2&i){const e=t.XpG().$index,a=t.XpG();t.R7$(),t.vxM("plus1"==a.enhancements[null!=a.slotIndex?a.slotIndex:e]?1:-1),t.R7$(),t.vxM("hex"==a.enhancements[null!=a.slotIndex?a.slotIndex:e]?2:-1),t.R7$(),t.vxM("jump"==a.enhancements[null!=a.slotIndex?a.slotIndex:e]?3:-1),t.R7$(),t.vxM(-1!=a.Elements.indexOf(a.enhancements[null!=a.slotIndex?a.slotIndex:e])?4:-1),t.R7$(),t.vxM(-1!=a.Conditions.indexOf(a.enhancements[null!=a.slotIndex?a.slotIndex:e])?5:-1)}}function DH(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",2),t.bIt("singleClick",function(n){const o=t.eBV(e).$index,g=t.XpG();return t.Njj(g.enhance(null!=g.slotIndex?g.slotIndex:o,n))})("doubleClick",function(n){const o=t.eBV(e).$index,g=t.XpG();return t.Njj(g.removeEnhancement(g.slotIndex?g.slotIndex:o,n))}),t.nVh(1,wH,1,1,"img",3),t.nVh(2,$H,6,5,"span",4),t.k0s()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG();t.HbH(t.VkB("slot ",e)),t.Y8G("ngClass",t.eq3(7,xH,!n.enhancements[null!=n.slotIndex?n.slotIndex:a]))("ghs-tooltip",n.edit&&"character.abilities.enhancements.hint.enhance"+(n.enhancements[null!=n.slotIndex?n.slotIndex:a]?"d":n.wipSpecialIndex?".wipSpecial":"")||""),t.R7$(),t.vxM(n.enhancements[null!=n.slotIndex?n.slotIndex:a]?-1:1),t.R7$(),t.vxM(n.enhancements[null!=n.slotIndex?n.slotIndex:a]?2:-1)}}let lo=(()=>{class i{dialog;action;actionIndex="";cardId;character;slotIndex;summon;Elements=Object.values(yt.Hg);Conditions=Object.values(j.r5);slots=[];enhancements=[];wipSpecialIndex="";edit=!1;gameManager=s.E;settingsManager=m.f;constructor(e){this.dialog=e}ngOnInit(){this.update(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.update()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}update(){this.slots=[],this.action.enhancementTypes&&(this.slots=null!=this.slotIndex?[this.action.enhancementTypes[this.slotIndex]]:[...this.action.enhancementTypes],this.wipSpecialIndex=this.slots[0]==jt.J.any?-1==this.actionIndex.indexOf("bottom")?"custom":"custom-bottom":"",this.enhancements=[],this.character&&this.cardId&&this.character.progress&&this.character.progress.enhancements&&this.character.progress.enhancements.filter(e=>e.cardId==this.cardId&&(!this.wipSpecialIndex&&e.actionIndex==this.actionIndex||this.wipSpecialIndex&&e.actionIndex==this.wipSpecialIndex)).forEach(e=>{this.enhancements[e.index]=e.action,this.wipSpecialIndex&&(this.slots[e.index]=jt.J.any)}),this.wipSpecialIndex&&this.enhancements.length>0&&(this.slots[this.enhancements.length]=jt.J.any)),this.edit=this.character&&-1!=this.character.tags.indexOf("edit-abilities")||!1}enhance(e,a){this.edit&&(this.enhancements[null!=this.slotIndex?this.slotIndex:e]||this.dialog.open(Pa,{panelClass:["dialog"],data:{action:this.action,actionIndex:this.wipSpecialIndex||this.actionIndex,cardId:this.cardId,enhancementIndex:e,character:this.character,summon:this.summon}}),a.stopPropagation(),a.preventDefault())}removeEnhancement(e,a){if(this.edit){if(this.character&&this.cardId&&this.enhancements[null!=this.slotIndex?this.slotIndex:e]){const n=this.character.progress.enhancements.find(o=>o.cardId==this.cardId&&(!this.wipSpecialIndex&&o.actionIndex==this.actionIndex||this.wipSpecialIndex&&o.actionIndex==this.wipSpecialIndex)&&o.index==e);n&&!n.inherited&&(s.E.stateManager.before("removeEnhancement",s.E.characterManager.characterName(this.character),this.cardId),this.character.progress.enhancements=this.character.progress.enhancements.filter(o=>o!=n),s.E.stateManager.after())}else this.wipSpecialIndex&&this.slots.push(jt.J.any);a.stopPropagation(),a.preventDefault()}}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-action-enhancements"]],inputs:{action:"action",actionIndex:[0,"index","actionIndex"],cardId:"cardId",character:"character",slotIndex:[0,"slot","slotIndex"],summon:"summon"},standalone:!1,decls:3,vars:4,consts:[[1,"enhancements",3,"ngClass"],["ghs-pointer-input","",3,"class","ngClass","ghs-tooltip"],["ghs-pointer-input","",3,"singleClick","doubleClick","ngClass","ghs-tooltip"],[1,"type",3,"src"],[1,"enhancement"],[1,"plus1"],[1,"hex"],[1,"jump"],[1,"element"],[1,"condition"],["src","./assets/images/action/hex/target.svg"],[1,"text-white",3,"ghs-label"],[3,"ghs-label"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.Z7z(1,DH,3,9,"div",1,EH),t.k0s()),2&a&&(t.Y8G("ngClass",t.l_i(1,yH,n.edit,n.settingsManager.settings.fhStyle)),t.R7$(),t.Dyx(n.slots))},dependencies:[N.YU,tt,ft,rt],styles:[".enhancements[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;margin-top:-.1em}.enhancements[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]{position:relative;display:block;width:.7em;height:.7em;margin-left:.3em;margin-right:.1em}.enhancements[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], .enhancements[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;position:absolute;top:0;left:0;height:100%;filter:none;box-shadow:none}.enhancements[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .plus1[_ngcontent-%COMP%], .enhancements[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .jump[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:.7em;display:flex;justify-content:center;align-items:center;width:1.4em;height:1.4em;border:.1em solid var(--ghs-color-white);border-radius:100%;background-color:var(--ghs-color-black)}.enhancements[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .plus1.jump[_ngcontent-%COMP%]   .text-white[_ngcontent-%COMP%], .enhancements[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .jump.jump[_ngcontent-%COMP%]   .text-white[_ngcontent-%COMP%]{font-size:.8em;display:flex;margin-left:-.3em}.enhancements[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .hex[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.enhancements[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .hex[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:1em;height:auto}.enhancements[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{font-size:1em;margin-left:-.5em;filter:brightness(1.1)}.enhancements[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%]{font-size:1.1em;filter:brightness(1.1);margin-top:-.4em;margin-left:-.1em}.enhancements.edit[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]{cursor:initial}.enhancements.edit[_ngcontent-%COMP%]   .slot.enhance[_ngcontent-%COMP%]{cursor:pointer}.enhancements.edit[_ngcontent-%COMP%]   .slot.enhance[_ngcontent-%COMP%]:hover{transform:scale(1.7);transform-origin:center center}.enhancements.edit[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]:hover{transform:scale(1.3);transform-origin:center center}.enhancements.fh[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .plus1[_ngcontent-%COMP%], .enhancements.fh[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .jump[_ngcontent-%COMP%]{font-size:.6em;border-radius:10%;align-items:center}.enhancements.fh[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{font-size:.8em;margin-top:.1em}.enhancements.fh[_ngcontent-%COMP%]   .slot[_ngcontent-%COMP%]   .enhancement[_ngcontent-%COMP%]   .element[_ngcontent-%COMP%]{font-size:.9em;margin-top:0}"]})}return i})();const IH=()=>["<a href='https://cephalofair.com' target='_blank'>Cephalofair Games</a>"],AH=()=>["<a href='https://github.com/Lurkars/gloomhavensecretariat/blob/main/LICENSE'  target='_blank'> AGPL3</a>"],VH=(i,r)=>[i,r];function FH(i,r){1&i&&(t.j41(0,"span",6),t.nrm(1,"span",13),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","about.version.unknown"))}function XH(i,r){1&i&&(t.j41(0,"span",7),t.nrm(1,"span",13),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","about.version.latest"))}function BH(i,r){if(1&i&&(t.j41(0,"span",8),t.nrm(1,"span",2),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ghs-label","about.version.update")("ghs-label-args",t.l_i(2,VH,e.updateVersion.version,e.updateVersion.url))}}function YH(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",15),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.forceUpdate())}),t.nrm(1,"span",13),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","about.forceUpdate"))}let NH=(()=>{class i{swUpdate;close=new t.bkB;version="0.133.0";updateVersion;constructor(e){this.swUpdate=e}ngOnInit(){var e=this;return(0,X.A)(function*(){yield fetch("https://api.github.com/repos/lurkars/gloomhavensecretariat/releases/latest").then(a=>{if(!a.ok)throw Error();return a.json()}).then(a=>{e.updateVersion={latest:a.tag_name==e.version||a.tag_name=="v"+e.version,version:a.tag_name,url:a.html_url}})})()}forceUpdate(){this.swUpdate.isEnabled?this.swUpdate.activateUpdate().then(()=>{this.clearAndRefresh()}):this.clearAndRefresh()}clearAndRefresh(){return(0,X.A)(function*(){if("caches"in window){const e=yield caches.keys();yield Promise.all(e.map(function(){var a=(0,X.A)(function*(n){return yield caches.delete(n)});return function(n){return a.apply(this,arguments)}}()))}window.location.reload()})()}static \u0275fac=function(a){return new(a||i)(t.rXU(E.EI))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-about-menu"]],outputs:{close:"close"},standalone:!1,decls:23,vars:14,consts:[[1,"menu-container","about"],[1,"line"],[3,"ghs-label","ghs-label-args"],[1,"line","version"],["target","_blank",3,"href"],[1,"version-info"],[1,"unknown"],[1,"latest"],[1,"update"],[1,"force"],[1,"columns"],[1,"column"],["href","https://ko-fi.com/lurkars","target","_blank"],[3,"ghs-label"],["href","https://github.com/Lurkars/gloomhavensecretariat","target","_blank"],[1,"force",3,"click"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"p",2),t.k0s(),t.j41(3,"div",3)(4,"a",4),t.EFF(5),t.k0s(),t.j41(6,"div",5),t.nVh(7,FH,2,1,"span",6),t.nVh(8,XH,2,1,"span",7),t.nVh(9,BH,2,5,"span",8),t.nVh(10,YH,2,1,"a",9),t.k0s()(),t.j41(11,"div",1)(12,"div",10)(13,"div",11)(14,"p")(15,"a",12),t.nrm(16,"span",13),t.k0s()()(),t.j41(17,"div",11)(18,"p")(19,"a",14),t.nrm(20,"span",13),t.k0s()()(),t.j41(21,"div",11),t.nrm(22,"p",2),t.k0s()()()()),2&a&&(t.R7$(2),t.Y8G("ghs-label","about.ip")("ghs-label-args",t.lJ4(12,IH)),t.R7$(2),t.Y8G("href","https://github.com/Lurkars/gloomhavensecretariat/releases/tag/v"+n.version,t.B4B),t.R7$(),t.SpI("Gloomhaven Secretariat v",n.version),t.R7$(2),t.vxM(n.updateVersion?-1:7),t.R7$(),t.vxM(n.updateVersion&&n.updateVersion.latest?8:-1),t.R7$(),t.vxM(n.updateVersion&&!n.updateVersion.latest?9:-1),t.R7$(),t.vxM(n.updateVersion&&n.updateVersion.latest?-1:10),t.R7$(6),t.Y8G("ghs-label","about.support"),t.R7$(4),t.Y8G("ghs-label","about.sourceCode"),t.R7$(2),t.Y8G("ghs-label","about.license")("ghs-label-args",t.lJ4(13,AH)))},dependencies:[tt],styles:['[_nghost-%COMP%]{position:relative;z-index:9999}.hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:break-spaces}.back[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled[_ngcontent-%COMP%]{pointer-events:none}.back.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container[_ngcontent-%COMP%]{z-index:1}.menu-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.no-grow[_ngcontent-%COMP%]{flex-grow:0}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container.inline[_ngcontent-%COMP%]{width:initial;margin-right:1em}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex-wrap:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-gray)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{filter:grayscale(1)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm-delete[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]{align-items:flex-start}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]   .undo-text[_ngcontent-%COMP%]{display:flex;align-items:center}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.redo[_ngcontent-%COMP%]{align-items:flex-end}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]:hover{opacity:.7}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover{cursor:pointer}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog.disabled[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)!important}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]{border-bottom:none;margin-bottom:0}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container[_ngcontent-%COMP%]   .line.sticky.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container[_ngcontent-%COMP%]   .line.sticky.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .add[_ngcontent-%COMP%]{display:inherit}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%] ~ .spoiler[_ngcontent-%COMP%]{margin-top:0;border-top:none}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]{display:flex;cursor:pointer}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]   .span-xs[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns.columns-break[_ngcontent-%COMP%]{flex-wrap:wrap}}',".version-info[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.version-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.version-info[_ngcontent-%COMP%]   span.unknown[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));color:var(--ghs-color-darkgray)}.version-info[_ngcontent-%COMP%]   span.latest[_ngcontent-%COMP%]{color:var(--ghs-color-darkgreen)}.version-info[_ngcontent-%COMP%]   span.update[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.version-info[_ngcontent-%COMP%]   .force[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}"]})}return i})();const qe=i=>({disabled:i}),oc=(i,r)=>({disabled:i,confirm:r}),sc=(i,r)=>({disabled:i,active:r}),zH=i=>[i],rc=(i,r)=>r.name,LH=(i,r)=>r.edition+"-"+r.name;function UH(i,r){1&i&&(t.j41(0,"div",17),t.nrm(1,"div",18),t.k0s())}function qH(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",5)(1,"label",2)(2,"input",3),t.bIt("change",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.setEdition(n))}),t.k0s(),t.nrm(3,"span",4),t.k0s(),t.nVh(4,UH,2,0,"div",17),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(4,qe,a.gameManager.game.edition==e||a.gameManager.stateManager.permissions&&!a.gameManager.stateManager.permissions.party)),t.R7$(),t.Y8G("checked",a.gameManager.game.edition==e),t.R7$(),t.Y8G("ghs-label","data.edition."+e),t.R7$(),t.vxM("fh"==e&&a.gameManager.game.edition==e?4:-1)}}function HH(i,r){1&i&&(t.j41(0,"div",7)(1,"label"),t.nrm(2,"span",4),t.k0s()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","campaign"))}function KH(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",5)(1,"a",8),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openPartySheet())}),t.k0s()()}2&i&&(t.R7$(),t.Y8G("ghs-label","campaign.party"))}function WH(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",5)(1,"a",8),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openResources())}),t.k0s()()}2&i&&(t.R7$(),t.Y8G("ghs-label","campaign.resources"))}function JH(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",5)(1,"a",8),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openCampaignSheet())}),t.k0s()()}2&i&&(t.R7$(),t.Y8G("ghs-label","campaign.sheet"))}function ZH(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",5)(1,"a",8),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openMap())}),t.k0s()()}2&i&&(t.R7$(),t.Y8G("ghs-label","campaign.map"))}function QH(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",5)(1,"a",8),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openItems())}),t.k0s()()}2&i&&(t.R7$(),t.Y8G("ghs-label","campaign.items"))}function tK(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",9)(1,"a",8),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openBattleGoalsSetup())}),t.k0s()()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(2,qe,e.gameManager.stateManager.permissions&&!e.gameManager.stateManager.permissions.party)),t.R7$(),t.Y8G("ghs-label","campaign.battleGoals")}}function eK(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",5)(1,"a",8),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openEventDeckSetup())}),t.k0s()()}2&i&&(t.R7$(),t.Y8G("ghs-label","game.events.deck.setup"))}function nK(i,r){1&i&&(t.j41(0,"div",7)(1,"label"),t.nrm(2,"span",4),t.k0s()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","campaign.character"))}function iK(i,r){if(1&i&&(t.j41(0,"span",21),t.EFF(1,"\xa0 "),t.j41(2,"span"),t.EFF(3,"["),t.k0s(),t.nrm(4,"span",4),t.j41(5,"span"),t.EFF(6,"]"),t.k0s()()),2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.R7$(4),t.Y8G("ghs-label","data.edition."+a.gameManager.getEdition(e))}}function aK(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",5)(1,"a",19),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.openCharacterSheet(n))}),t.nrm(2,"img",20),t.j41(3,"span"),t.EFF(4),t.k0s(),t.nVh(5,iK,7,1,"span",21),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(2),t.Y8G("src",e.iconUrl,t.B4B),t.R7$(2),t.JRh(a.gameManager.characterManager.characterName(e,!0)),t.R7$(),t.vxM(a.gameManager.getEdition(e)?5:-1)}}function oK(i,r){if(1&i&&t.Z7z(0,aK,6,3,"div",5,LH),2&i){const e=t.XpG();t.Dyx(e.characters)}}function sK(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",11)(1,"span",22),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.toggleCondition(n.name))}),t.nrm(2,"img",23),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(8,qe,a.gameManager.stateManager.permissions&&!a.gameManager.stateManager.permissions.party)),t.R7$(),t.Y8G("ghs-tooltip","game.condition."+e.name+".hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom")("ngClass",t.l_i(10,sc,-1!=a.editionConditions.indexOf(e.name),-1==a.editionConditions.indexOf(e.name)&&-1!=a.gameManager.game.conditions.indexOf(e.name))),t.R7$(),t.Y8G("src","./assets/images"+(a.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+e.name+".svg",t.B4B)}}function rK(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",11)(1,"span",22),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.toggleCondition(n.name))}),t.nrm(2,"img",23),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(8,qe,a.gameManager.stateManager.permissions&&!a.gameManager.stateManager.permissions.party)),t.R7$(),t.Y8G("ghs-tooltip","game.condition."+e.name+".hint")("originX","center")("overlayX","center")("originY","top")("overlayY","bottom")("ngClass",t.l_i(10,sc,-1!=a.editionConditions.indexOf(e.name),-1==a.editionConditions.indexOf(e.name)&&-1!=a.gameManager.game.conditions.indexOf(e.name))),t.R7$(),t.Y8G("src","./assets/images"+(a.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+e.name+".svg",t.B4B)}}function cK(i,r){1&i&&(t.nrm(0,"img",24),t.j41(1,"span",25),t.nrm(2,"span",26),t.k0s()),2&i&&(t.R7$(2),t.Y8G("ghs-label","campaign.campaignManagement.hint"))}function lK(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2).$implicit;t.R7$(),t.JRh(e.name)}}function gK(i,r){if(1&i&&(t.j41(0,"span"),t.nrm(1,"span",4),t.EFF(2),t.k0s()),2&i){const e=t.XpG(2).$implicit;t.R7$(),t.Y8G("ghs-label","party.campaign"),t.R7$(),t.SpI("\xa0",e.id)}}function dK(i,r){if(1&i){const e=t.RV6();t.j41(0,"label",2)(1,"input",3),t.bIt("change",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.changeParty(n))}),t.k0s(),t.nVh(2,lK,2,1,"span"),t.nVh(3,gK,3,2,"span"),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG();t.Y8G("ngClass",t.eq3(4,qe,1==a.gameManager.game.parties.length||a.gameManager.game.scenario||a.gameManager.stateManager.permissions&&!a.gameManager.stateManager.permissions.party)),t.R7$(),t.Y8G("checked",a.gameManager.game.party==e),t.R7$(),t.vxM(e.name?2:-1),t.R7$(),t.vxM(e.name?-1:3)}}function hK(i,r){if(1&i){const e=t.RV6();t.j41(0,"label"),t.nrm(1,"input",29),t.j41(2,"input",30),t.bIt("change",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.setName(n))}),t.k0s()()}if(2&i){const e=t.XpG().$implicit;t.R7$(2),t.Y8G("value",e.name)("ghs-label","campaign.campaignManagement.name")("ghs-label-args",t.eq3(4,zH,e.id))("ghs-label-attribute","placeholder")}}function _K(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",5),t.nVh(1,dK,4,6,"label",2),t.nVh(2,hK,3,6,"label"),t.nrm(3,"span",27),t.j41(4,"a",28),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.removeParty(n))})("mouseleave",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.cancelRemoveParty())}),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG();t.R7$(),t.vxM(a.gameManager.game.party!=e?1:-1),t.R7$(),t.vxM(a.gameManager.game.party==e?2:-1),t.R7$(2),t.Y8G("ngClass",t.l_i(3,oc,1==a.gameManager.game.parties.length||a.gameManager.game.scenario,a.confirmPartyDelete==e.id))}}let mK=(()=>{class i{dialog;close=new t.bkB;gameManager=s.E;settingsManager=m.f;GameState=T.mk;conditions=[];amConditions=[];editionConditions=[];characters=[];confirmPartyDelete=-1;confirmResetCampaign=!1;worldMap=!1;constructor(e){this.dialog=e}ngOnInit(){this.update()}update(){this.characters=s.E.game.figures.filter(a=>a instanceof q.K).map(a=>a).sort((a,n)=>{const o=s.E.characterManager.characterName(a).toLowerCase(),g=s.E.characterManager.characterName(n).toLowerCase();return o>g?1:o<g?-1:0}),this.conditions=Object.values(j.r5).map(a=>new j.kW(a)).filter(a=>-1==a.types.indexOf(j.GV.hidden)&&-1==a.types.indexOf(j.GV.special)),this.amConditions=Object.values(j.r5).map(a=>new j.kW(a)).filter(a=>-1!=a.types.indexOf(j.GV.amDeck)),this.editionConditions=s.E.conditions(s.E.game.edition,!0).map(a=>a.name),this.worldMap=!1;const e=s.E.editionData.find(a=>a.edition==s.E.game.edition);e&&(e.worldMap||e.extendWorldMap)&&(this.worldMap=!0)}setEdition(e=void 0){s.E.stateManager.before(e?"setEdition":"setEditionAll",e?"data.edition."+e:""),m.f.settings.automaticTheme&&"modern"!=m.f.settings.theme&&(m.f.set("theme","fh"==e||"bb"==e?e:"default"),"gh2e"==e&&m.f.set("fhStyle",!0)),s.E.game.edition=e,s.E.game.party.edition=e,this.update(),s.E.stateManager.after()}toggleCampaignMode(){s.E.stateManager.before(s.E.game.party.campaignMode?"disablePartyCampaignMode":"enablePartyCampaignMode"),s.E.game.party.campaignMode=!s.E.game.party.campaignMode,s.E.stateManager.after()}toggleCondition(e){-1==this.editionConditions.indexOf(e)&&(s.E.stateManager.before(-1==s.E.game.conditions.indexOf(e)?"addGameCondition":"removeGameCondition",e),-1==s.E.game.conditions.indexOf(e)?s.E.game.conditions.push(e):s.E.game.conditions=s.E.game.conditions.filter(a=>e!=a),s.E.stateManager.after())}openCharacterSheet(e){this.dialog.open(Re,{panelClass:["dialog-invert"],data:{character:e}}),this.close.emit()}openPartySheet(){this.dialog.open(Ue,{panelClass:["dialog-invert"],data:{partySheet:!0}}),this.close.emit()}openCampaignSheet(){this.dialog.open(Ue,{panelClass:["dialog-invert"],data:{campaign:!0}}),this.close.emit()}openMap(){this.dialog.open(Zn,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:s.E.game.edition}),this.close.emit()}openFlowChart(){this.dialog.open(Qn,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:{edition:s.E.game.edition}}),this.close.emit()}openEnhancementDialog(){this.dialog.open(Pa,{panelClass:["dialog"]}),this.close.emit()}openEventDeckSetup(){this.dialog.open(Ba,{panelClass:["dialog"],data:{edition:s.E.game.edition}}),this.close.emit()}openBattleGoalsSetup(){this.dialog.open(_i,{panelClass:["dialog"]}),this.close.emit()}openItems(){this.dialog.open(Bn,{panelClass:["dialog"],data:{edition:s.E.game.edition}}),this.close.emit()}openResources(){this.dialog.open(hr,{panelClass:["dialog"]}),this.close.emit()}addParty(){let e=new $i.r,a=0;for(;s.E.game.parties.some(n=>n.id==a);)a++;e.id=a,s.E.stateManager.before("addParty",e.name||"%party% "+e.id),s.E.game.parties.push(e),s.E.changeParty(e),this.update(),s.E.stateManager.after()}changeParty(e){s.E.stateManager.before("changeParty",e.name||"%party% "+e.id),s.E.changeParty(e),this.update(),s.E.stateManager.after()}removeParty(e){s.E.game.parties.length>1&&(this.confirmPartyDelete!=e.id?this.confirmPartyDelete=e.id:(s.E.stateManager.before("removeParty",e.name||"%party% "+e.id),s.E.game.parties.splice(s.E.game.parties.indexOf(e),1),s.E.game.party.id==e.id&&s.E.changeParty(s.E.game.parties[0]),this.update(),s.E.stateManager.after(),this.cancelRemoveParty()))}cancelRemoveParty(){this.confirmPartyDelete=-1}setName(e){s.E.game.party.name!=e.target.value&&(s.E.stateManager.before("setPartyName",e.target.value),s.E.game.party.name=e.target.value,s.E.stateManager.after())}resetCampaign(){this.confirmResetCampaign?(s.E.stateManager.before("resetCampaign"),s.E.resetCampaign(),s.E.stateManager.after(),this.close.emit()):this.confirmResetCampaign=!0}cancelResetCampaign(){this.confirmResetCampaign=!1}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-campaign-menu"]],outputs:{close:"close"},standalone:!1,decls:52,vars:34,consts:[[1,"menu-container","two-column","sheets"],[1,"line","span"],[3,"ngClass"],["tabclick","","type","checkbox",3,"change","checked"],[3,"ghs-label"],[1,"line"],[1,"line","separator"],[1,"line","title","span"],["tabclick","",3,"click","ghs-label"],[1,"line",3,"ngClass"],[1,"conditions"],[1,"item",3,"ngClass"],[1,"hint-container"],[1,"columns","span"],[1,"column"],["tabclick","",3,"click","ghs-label","ngClass"],["tabclick","",3,"click","mouseleave","ghs-label","ngClass"],[1,"fh-second-edition"],["ghs-setting-menu","fhSecondEdition"],["tabclick","",3,"click"],[1,"icon",3,"src"],[1,"edition"],["tabclick","",1,"condition",3,"click","ghs-tooltip","originX","overlayX","originY","overlayY","ngClass"],[3,"src"],["src","./assets/images/hint.svg",1,"hint-trigger","ghs-svg"],[1,"hint"],[1,"text",3,"ghs-label"],[1,"spacer"],["tabclick","",1,"remove",3,"click","mouseleave","ngClass"],["tabclick","","type","checkbox","checked","true","disabled","disabled"],["type","text",3,"change","value","ghs-label","ghs-label-args","ghs-label-attribute"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"label",2)(3,"input",3),t.bIt("change",function(){return n.setEdition()}),t.k0s(),t.EFF(4," <"),t.nrm(5,"span",4),t.EFF(6,"> "),t.k0s()(),t.Z7z(7,qH,5,6,"div",5,t.fX1),t.j41(9,"div",6)(10,"label",2)(11,"input",3),t.bIt("change",function(){return n.toggleCampaignMode()}),t.k0s(),t.nrm(12,"span",4),t.k0s()(),t.nVh(13,HH,3,1,"div",7),t.nVh(14,KH,2,1,"div",5),t.nVh(15,WH,2,1,"div",5),t.nVh(16,JH,2,1,"div",5),t.nVh(17,ZH,2,1,"div",5),t.j41(18,"div",5)(19,"a",8),t.bIt("click",function(){return n.openFlowChart()}),t.k0s()(),t.nVh(20,QH,2,1,"div",5),t.nVh(21,tK,2,4,"div",9),t.nVh(22,eK,2,1,"div",5),t.nVh(23,nK,3,1,"div",7),t.nVh(24,oK,2,0),t.j41(25,"div",1)(26,"a",8),t.bIt("click",function(){return n.openEnhancementDialog()}),t.k0s()(),t.j41(27,"div",7)(28,"label"),t.nrm(29,"span",4),t.k0s()(),t.j41(30,"div",5)(31,"div",10),t.Z7z(32,sK,3,13,"span",11,rc),t.k0s()(),t.j41(34,"div",5)(35,"div",10),t.Z7z(36,rK,3,13,"span",11,rc),t.k0s()(),t.j41(38,"div",7)(39,"div",12)(40,"label"),t.nrm(41,"span",4),t.k0s(),t.nVh(42,cK,3,1),t.k0s()(),t.Z7z(43,_K,5,6,"div",5,t.fX1),t.j41(45,"div",13)(46,"div",14)(47,"div",1)(48,"a",15),t.bIt("click",function(){return n.addParty()}),t.k0s()()(),t.j41(49,"div",14)(50,"div",1)(51,"a",16),t.bIt("click",function(){return n.resetCampaign()})("mouseleave",function(){return n.cancelResetCampaign()}),t.k0s()()()()()),2&a&&(t.R7$(2),t.Y8G("ngClass",t.eq3(25,qe,!n.gameManager.game.edition||n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.party)),t.R7$(),t.Y8G("checked",!n.gameManager.game.edition),t.R7$(2),t.Y8G("ghs-label","edition.all"),t.R7$(2),t.Dyx(n.gameManager.editions()),t.R7$(3),t.Y8G("ngClass",t.eq3(27,qe,n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.party)),t.R7$(),t.Y8G("checked",n.gameManager.game.party.campaignMode),t.R7$(),t.Y8G("ghs-label","party.campaignMode"),t.R7$(),t.vxM(n.settingsManager.settings.partySheet||n.settingsManager.settings.characterSheet||n.settingsManager.settings.characterItems?13:-1),t.R7$(),t.vxM(n.settingsManager.settings.partySheet&&!n.gameManager.bbRules()?14:-1),t.R7$(),t.vxM(n.settingsManager.settings.partySheet&&n.gameManager.fhRules()?15:-1),t.R7$(),t.vxM(n.settingsManager.settings.partySheet&&!n.gameManager.bbRules()?16:-1),t.R7$(),t.vxM(n.worldMap?17:-1),t.R7$(2),t.Y8G("ghs-label","scenario.chart"),t.R7$(),t.vxM(n.settingsManager.settings.characterSheet||n.settingsManager.settings.characterItems?20:-1),t.R7$(),t.vxM(n.settingsManager.settings.battleGoals&&!n.gameManager.bbRules()?21:-1),t.R7$(),t.vxM(n.settingsManager.settings.partySheet&&n.settingsManager.settings.events&&n.gameManager.game.edition&&!n.gameManager.bbRules()?22:-1),t.R7$(),t.vxM(n.characters.length>0&&n.settingsManager.settings.characterSheet&&!n.gameManager.bbRules()?23:-1),t.R7$(),t.vxM(n.settingsManager.settings.characterSheet&&!n.gameManager.bbRules()?24:-1),t.R7$(2),t.Y8G("ghs-label","campaign.enhancements"),t.R7$(3),t.Y8G("ghs-label","edition.conditions"),t.R7$(3),t.Dyx(n.conditions),t.R7$(4),t.Dyx(n.amConditions),t.R7$(5),t.Y8G("ghs-label","campaign.campaignManagement"),t.R7$(),t.vxM(n.gameManager.game.scenario?42:-1),t.R7$(),t.Dyx(n.gameManager.game.parties),t.R7$(5),t.Y8G("ghs-label","campaign.campaignManagement.add")("ngClass",t.eq3(29,qe,n.gameManager.game.scenario||n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.party)),t.R7$(3),t.Y8G("ghs-label","campaign.campaignManagement.reset")("ngClass",t.l_i(31,oc,n.gameManager.game.scenario||n.gameManager.stateManager.permissions&&!n.gameManager.stateManager.permissions.party,n.confirmResetCampaign)))},dependencies:[N.YU,tt,ft,un,At],styles:['[_nghost-%COMP%]{position:relative;z-index:9999}.hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:break-spaces}.back[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled[_ngcontent-%COMP%]{pointer-events:none}.back.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container[_ngcontent-%COMP%]{z-index:1}.menu-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.no-grow[_ngcontent-%COMP%]{flex-grow:0}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container.inline[_ngcontent-%COMP%]{width:initial;margin-right:1em}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex-wrap:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-gray)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{filter:grayscale(1)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm-delete[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]{align-items:flex-start}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]   .undo-text[_ngcontent-%COMP%]{display:flex;align-items:center}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.redo[_ngcontent-%COMP%]{align-items:flex-end}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]:hover{opacity:.7}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover{cursor:pointer}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog.disabled[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)!important}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]{border-bottom:none;margin-bottom:0}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container[_ngcontent-%COMP%]   .line.sticky.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container[_ngcontent-%COMP%]   .line.sticky.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .add[_ngcontent-%COMP%]{display:inherit}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%] ~ .spoiler[_ngcontent-%COMP%]{margin-top:0;border-top:none}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]{display:flex;cursor:pointer}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]   .span-xs[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns.columns-break[_ngcontent-%COMP%]{flex-wrap:wrap}}','.conditions[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(6,calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor)));column-gap:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));row-gap:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));align-items:center;justify-items:center;margin-bottom:auto}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{cursor:initial;position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor))}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{cursor:pointer;display:flex;position:relative;width:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor))}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:after{pointer-events:none;content:" ";height:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor));position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:auto}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);position:absolute;bottom:0;left:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));transform:translate(-50%)}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value.stack[_ngcontent-%COMP%]{left:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));bottom:calc(var(--ghs-unit) * -.5 * var(--ghs-dialog-factor))}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition.disabled[_ngcontent-%COMP%]:after{border:calc(var(--ghs-unit) / 4) var(--ghs-color-darkgray) solid;border-radius:100%}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition.active[_ngcontent-%COMP%]:after{border:calc(var(--ghs-unit) / 5) var(--ghs-color-green) solid;border-radius:100%}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:hover:after{border:calc(var(--ghs-unit) / 5) var(--ghs-color-green) solid;border-radius:100%}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition.active[_ngcontent-%COMP%]:hover:after{border:calc(var(--ghs-unit) / 5) var(--ghs-color-red) solid}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition.disabled[_ngcontent-%COMP%]{pointer-events:initial;cursor:initial}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition.disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{opacity:.7}.conditions[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .condition.disabled[_ngcontent-%COMP%]:hover:after{border:calc(var(--ghs-unit) / 4) var(--ghs-color-darkgray) solid}.remove[_ngcontent-%COMP%]{cursor:pointer!important;display:flex;width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.remove[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 80%,30% 50%,0 20%,20% 0,50% 30%,80% 0,100% 20%,70% 50%,100% 80%,80% 100%,50% 70%,20% 100%);background-color:var(--ghs-color-gray)}.remove[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.remove.confirm[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-red)}.remove.disabled[_ngcontent-%COMP%]{pointer-events:none}.remove.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-darkgray)!important}.fh-second-edition[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:1 span}.conditions[_ngcontent-%COMP%]{grid-template-columns:repeat(4,calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor)))}}']})}return i})();const pK=(i,r)=>({fh:i,modern:r}),cc=()=>[],uK=i=>({active:i}),fK=(i,r,e)=>({"hide-title":i,fh:r,modern:e}),lc=i=>({confirm:i}),CK=(i,r)=>({disabled:i,spoiler:r}),MK=(i,r)=>r.edition+"-"+r.name;function vK(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",4)(1,"a",8),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.characterLevel=n+1)}),t.EFF(2),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(2,uK,e+1==a.characterLevel)),t.R7$(),t.JRh(e+1)}}function OK(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",9),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return n.allEditions=!n.allEditions,t.Njj(n.update())}),t.k0s(),t.nrm(2,"span",10),t.k0s()}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("checked",e.allEditions),t.R7$(),t.Y8G("ghs-label","character.filter.allEditions")}}function PK(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",1)(1,"span",4),t.nrm(2,"img",5),t.k0s(),t.Z7z(3,vK,3,4,"span",4,t.fX1),t.nI1(5,"ghsRange"),t.j41(6,"div",6)(7,"input",7),t.mxI("ngModelChange",function(n){t.eBV(e);const o=t.XpG();return t.DH7(o.filter,n)||(o.filter=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.update())})("keyup",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.update())}),t.k0s(),t.nVh(8,OK,3,2,"label"),t.k0s()()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.l_i(8,pK,"fh"==e.settingsManager.settings.theme,"modern"==e.settingsManager.settings.theme)),t.R7$(3),t.Dyx(t.i5U(5,5,t.lJ4(11,cc),9)),t.R7$(4),t.R50("ngModel",e.filter),t.Y8G("ghs-label","character.filter")("ghs-label-attribute","placeholder"),t.R7$(),t.vxM(e.gameManager.game.edition?8:-1)}}function bK(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",13)(1,"a",15),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2).$implicit,o=t.XpG();return t.Njj(o.unlockAll(n))})("mouseleave",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.cancelConfirm())}),t.nrm(2,"span",10),t.k0s()()}if(2&i){const e=t.XpG(2).$implicit,a=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(2,lc,a.confirm=="confirm-all-"+e)),t.R7$(),t.Y8G("ghs-label",a.confirm=="confirm-all-"+e?"character.unlockAll.confirm":"character.unlockAll")}}function kK(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",18),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(3);return t.Njj(o.addCharacter(n))}),t.nrm(1,"img",19)(2,"span",10),t.k0s()}if(2&i){const e=t.XpG().$implicit;t.R7$(),t.Y8G("src",e.iconUrl,t.B4B),t.R7$(),t.Y8G("ghs-label","data.character."+e.edition+"."+e.name)}}function yK(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",20),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(3);return t.Njj(o.unlock(n))})("mouseleave",function(){t.eBV(e);const n=t.XpG(4);return t.Njj(n.cancelConfirm())}),t.nrm(1,"img",21),t.j41(2,"span",22),t.nrm(3,"span",10),t.k0s(),t.nrm(4,"span",23),t.k0s()}if(2&i){const e=t.XpG().$implicit,a=t.XpG(3);t.Y8G("ngClass",t.eq3(4,lc,a.confirm==e.name)),t.R7$(),t.Y8G("src",e.iconUrl,t.B4B),t.R7$(2),t.Y8G("ghs-label","spoiler.placeholder"),t.R7$(),t.Y8G("ghs-label",a.confirm==e.name?"character.unlock.confirm":"character.unlock")}}function xK(i,r){if(1&i&&(t.j41(0,"div",14),t.nVh(1,kK,3,2,"a",16),t.nVh(2,yK,5,6,"a",17),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(3);t.Y8G("ngClass",t.l_i(3,CK,a.hasCharacter(e)&&a.unlocked(e),e.spoiler)),t.R7$(),t.vxM(a.unlocked(e)?1:-1),t.R7$(),t.vxM(a.unlocked(e)?-1:2)}}function EK(i,r){if(1&i&&(t.j41(0,"div",11)(1,"div",12)(2,"label"),t.nrm(3,"span",10),t.k0s()(),t.nVh(4,bK,3,4,"div",13),t.Z7z(5,xK,3,6,"div",14,MK),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(),t.Y8G("ngClass",t.sMw(3,fK,!a.allEditions&&1==a.gameManager.currentEditions().length,"fh"==a.settingsManager.settings.theme,"modern"==a.settingsManager.settings.theme)),t.R7$(2),t.Y8G("ghs-label","data.edition."+e),t.R7$(),t.vxM(a.locked(e)?4:-1),t.R7$(),t.Dyx(a.characterData[e]||t.lJ4(7,cc))}}function wK(i,r){if(1&i&&t.nVh(0,EK,7,8,"div",11),2&i){const e=r.$implicit,a=t.XpG();t.vxM(a.characterData[e]&&a.characterData[e].length>0?0:-1)}}function RK(i,r){1&i&&(t.j41(0,"div",3)(1,"div",24)(2,"label"),t.nrm(3,"span",10),t.k0s()()()),2&i&&(t.R7$(3),t.Y8G("ghs-label","character.filter.noResult"))}let jK=(()=>{class i{close=new t.bkB;gameManager=s.E;settingsManager=m.f;characterLevel=1;filter="";allEditions=!1;newUnlocks=[];confirm="";characterData={};ngOnInit(){this.characterLevel=s.E.fhRules()?Math.ceil(s.E.prosperityLevel()/2):s.E.prosperityLevel(),this.update()}update(){this.characterData={},(this.allEditions?s.E.editions(!0,!0):s.E.currentEditions(!0)).forEach(e=>{this.characterData[e]=this.getCharacterData(this.filter,e)})}getCharacterData(e,a){return s.E.charactersData(a).filter(n=>(!n.locked||this.unlocked(n))&&((0,V.oB)(n.name,e)||this.unlocked(n)&&(0,V.oB)(m.f.getLabel("data.character."+n.edition+"."+n.name),e))||n.locked&&(0,V.oB)(m.f.getLabel("data.character."+n.edition+"."+n.name),e,!0)).sort((n,o)=>{const g=m.f.getLabel("data.character."+n.edition+"."+n.name).toLowerCase(),_=m.f.getLabel("data.character."+o.edition+"."+o.name).toLowerCase();if(n.spoiler&&!o.spoiler)return 1;if(!n.spoiler&&o.spoiler)return-1;if(n.spoiler&&o.spoiler){if(!this.unlocked(n)&&this.unlocked(o)&&-1==this.newUnlocks.indexOf(o.name))return 1;if(this.unlocked(n)&&-1==this.newUnlocks.indexOf(n.name)&&!this.unlocked(o))return-1;if(this.unlocked(n)&&-1!=this.newUnlocks.indexOf(n.name)&&this.unlocked(o)&&-1==this.newUnlocks.indexOf(o.name))return 1;if(this.unlocked(n)&&-1==this.newUnlocks.indexOf(n.name)&&this.unlocked(o)&&-1!=this.newUnlocks.indexOf(n.name))return-1;if(!this.unlocked(n)&&!this.unlocked(o))return o.name>n.name?-1:1}return _>g?-1:1})}unlocked(e){return!e.spoiler||-1!=s.E.game.unlockedCharacters.indexOf(e.edition+":"+e.name)}locked(e){return this.characterData[e]&&this.characterData[e].some(a=>a.spoiler&&!this.unlocked(a))}unlock(e){-1==s.E.game.unlockedCharacters.indexOf(e.edition+":"+e.name)&&(this.confirm==e.name?(s.E.stateManager.before("unlockChar","data.character."+e.edition+"."+e.name),s.E.game.unlockedCharacters.push(e.edition+":"+e.name),this.newUnlocks.push(e.name),m.f.settings.events&&e.unlockEvent&&e.unlockEvent.split("|").forEach(a=>{a.split(":").length>1?s.E.eventCardManager.addEvent(a.split(":")[0],a.split(":")[1],!0):(s.E.eventCardManager.addEvent("city",a,!0),s.E.eventCardManager.addEvent("road",a,!0))}),s.E.stateManager.after()):this.confirm=e.name)}cancelConfirm(){this.confirm=""}unlockAll(e){const a=s.E.charactersData(e).filter(n=>n.spoiler&&!this.unlocked(n)).map(n=>n.name);a.length>0&&(this.confirm=="confirm-all-"+e?(s.E.stateManager.before("unlockAllCharacters","data.edition."+e),s.E.game.unlockedCharacters.push(...a.map(n=>e+":"+n)),m.f.settings.events&&a.map(n=>s.E.getCharacterData(n,e)).forEach(n=>{n.unlockEvent&&n.unlockEvent.split("|").forEach(o=>{o.split(":").length>1?s.E.eventCardManager.addEvent(o.split(":")[0],o.split(":")[1],!0):(s.E.eventCardManager.addEvent("city",o,!0),s.E.eventCardManager.addEvent("road",o,!0))})}),s.E.stateManager.after()):this.confirm="confirm-all-"+e)}noResults(){return(this.allEditions?s.E.editions(!0,!0):s.E.currentEditions(!0)).every(a=>!this.characterData[a]||0==this.characterData[a].length)}addCharacter(e){s.E.stateManager.before("addChar","data.character."+e.edition+"."+e.name),s.E.characterManager.addCharacter(e,this.characterLevel),s.E.stateManager.after(),s.E.bbRules()&&this.close.emit()}hasCharacter(e){return s.E.game.figures.some(a=>a instanceof q.K&&e.name==a.name&&e.edition==a.edition)||s.E.game.party.availableCharacters&&s.E.game.party.availableCharacters.some(a=>e.name==a.name&&e.edition==a.edition)}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-character-menu"]],outputs:{close:"close"},standalone:!1,decls:6,vars:2,consts:[[1,"menu-container","character-add"],[1,"level-container",3,"ngClass"],[1,"columns"],[1,"column"],[1,"item"],["src","./assets/images/status/level.svg"],[1,"line","search"],["type","text",3,"ngModelChange","change","keyup","ngModel","ghs-label","ghs-label-attribute"],["tabclick","",1,"level",3,"click","ngClass"],["tabclick","","type","checkbox",3,"change","checked"],[3,"ghs-label"],[1,"column","spoilers"],[1,"line","title","sticky",3,"ngClass"],[1,"line","separator","reveal-all"],[1,"line",3,"ngClass"],[3,"click","mouseleave","ngClass"],["tabclick",""],["tabclick","",3,"ngClass"],["tabclick","",3,"click"],[1,"icon",3,"src"],["tabclick","",3,"click","mouseleave","ngClass"],[1,"icon","spoiler",3,"src"],[1,"name"],[1,"add",3,"ghs-label"],[1,"line"]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.nVh(1,PK,9,12,"div",1),t.j41(2,"div",2),t.Z7z(3,wK,1,1,null,null,t.fX1),t.nVh(5,RK,4,1,"div",3),t.k0s()()),2&a&&(t.R7$(),t.vxM(n.gameManager.bbRules()?-1:1),t.R7$(2),t.Dyx(n.allEditions?n.gameManager.editions(!0,!0):n.gameManager.currentEditions(!0)),t.R7$(2),t.vxM(n.filter&&n.noResults()?5:-1))},dependencies:[N.YU,O.me,O.BC,O.vS,tt,At,Tt],styles:['[_nghost-%COMP%]{position:relative;z-index:9999}.hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:break-spaces}.back[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled[_ngcontent-%COMP%]{pointer-events:none}.back.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container[_ngcontent-%COMP%]{z-index:1}.menu-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.no-grow[_ngcontent-%COMP%]{flex-grow:0}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container.inline[_ngcontent-%COMP%]{width:initial;margin-right:1em}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex-wrap:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-gray)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{filter:grayscale(1)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm-delete[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]{align-items:flex-start}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]   .undo-text[_ngcontent-%COMP%]{display:flex;align-items:center}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.redo[_ngcontent-%COMP%]{align-items:flex-end}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]:hover{opacity:.7}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover{cursor:pointer}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog.disabled[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)!important}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]{border-bottom:none;margin-bottom:0}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container[_ngcontent-%COMP%]   .line.sticky.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container[_ngcontent-%COMP%]   .line.sticky.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .add[_ngcontent-%COMP%]{display:inherit}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%] ~ .spoiler[_ngcontent-%COMP%]{margin-top:0;border-top:none}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]{display:flex;cursor:pointer}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]   .span-xs[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns.columns-break[_ngcontent-%COMP%]{flex-wrap:wrap}}',".character-add[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 45 * var(--ghs-dialog-factor))}.level-container[_ngcontent-%COMP%]{position:fixed;top:0;display:grid;grid-template-columns:repeat(5,calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor)));margin:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:2}.level-container.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.level-container.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.level-container[_ngcontent-%COMP%]   span.item[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor))}.level-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:calc(var(--ghs-unit) * 4 * var(--ghs-dialog-factor));width:auto}.level-container[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));cursor:pointer;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);text-shadow:var(--ghs-outline)}.level-container[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;border-radius:100%}.level-container[_ngcontent-%COMP%]   .level.active[_ngcontent-%COMP%]{pointer-events:none;border:calc(var(--ghs-unit) / 4) var(--ghs-color-white) solid;border-radius:100%}.level-container[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{grid-column:5 span}.level-container[_ngcontent-%COMP%] + .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%], .level-container[_ngcontent-%COMP%] + .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]:not(sticky):first-child{padding-top:calc(var(--ghs-unit) * 20.5 * var(--ghs-dialog-factor))}.reveal-all[_ngcontent-%COMP%]{position:absolute;bottom:0;border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)!important;width:auto!important}.spoilers[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]:nth-child(2), .spoilers[_ngcontent-%COMP%]   .reveal-all[_ngcontent-%COMP%] + .line[_ngcontent-%COMP%]{border-top:none!important}.spoilers[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]:last-child{margin-bottom:calc(var(--ghs-unit) * 6 * var(--ghs-dialog-factor))}"]})}return i})();var gc=M(30706);const go=(i,r)=>({fh:i,modern:r}),Yi=i=>({disabled:i}),ai=i=>({"confirm-delete":i}),oi=i=>({hidden:i}),GK=i=>[i],TK=(i,r)=>r.edition;function SK(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",16)(1,"div",26)(2,"label",33),t.nrm(3,"span",15),t.j41(4,"input",34,1),t.bIt("keyup",function(){return t.eBV(e),t.Njj(0)})("change",function(){t.eBV(e);const n=t.sdS(5),o=t.XpG(2);return t.Njj(o.settingsManager.set("autoBackup",+n.value))}),t.k0s()(),t.nrm(6,"img",29),t.j41(7,"div",30)(8,"div",35),t.nrm(9,"div",15),t.k0s()()()(),t.j41(10,"div",16)(11,"label")(12,"input",32),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.settingsManager.setAutoBackupFinish(!n.settingsManager.settings.autoBackupFinish))}),t.k0s(),t.nrm(13,"span",15),t.k0s()(),t.j41(14,"div",16)(15,"div",36)(16,"label",33),t.nrm(17,"span",15),t.k0s(),t.j41(18,"input",37,2),t.bIt("keyup",function(){return t.eBV(e),t.Njj(0)})("change",function(){t.eBV(e);const n=t.sdS(19),o=t.sdS(29),g=t.sdS(44),_=t.sdS(55),y=t.sdS(65),B=t.sdS(75),nt=t.XpG(2);return t.Njj(nt.settingsManager.setAutoBackupUrl({url:n.value,method:o.value,fileUpload:g.checked,username:y.value,password:B.value,authorization:_.value}))}),t.k0s(),t.nrm(20,"img",29),t.j41(21,"div",30)(22,"div",35),t.nrm(23,"div",15),t.k0s()()()(),t.j41(24,"div",38)(25,"div",36)(26,"label",33),t.nrm(27,"span",15),t.k0s(),t.j41(28,"select",39,3),t.bIt("change",function(){t.eBV(e);const n=t.sdS(19),o=t.sdS(29),g=t.sdS(44),_=t.sdS(55),y=t.sdS(65),B=t.sdS(75),nt=t.XpG(2);return t.Njj(nt.settingsManager.setAutoBackupUrl({url:n.value,method:o.value,fileUpload:g.checked,username:y.value,password:B.value,authorization:_.value}))}),t.j41(30,"option",40),t.nrm(31,"span",15),t.k0s(),t.j41(32,"option",41),t.nrm(33,"span",15),t.k0s(),t.j41(34,"option",42),t.nrm(35,"span",15),t.k0s()(),t.nrm(36,"img",29),t.j41(37,"div",30)(38,"div",35),t.nrm(39,"div",15),t.k0s()()()(),t.j41(40,"div",38)(41,"div",36)(42,"label",33)(43,"input",32,4),t.bIt("change",function(){t.eBV(e);const n=t.sdS(19),o=t.sdS(29),g=t.sdS(44),_=t.sdS(55),y=t.sdS(65),B=t.sdS(75),nt=t.XpG(2);return t.Njj(nt.settingsManager.setAutoBackupUrl({url:n.value,method:o.value,fileUpload:g.checked,username:y.value,password:B.value,authorization:_.value}))}),t.k0s(),t.nrm(45,"span",15),t.k0s(),t.nrm(46,"img",29),t.j41(47,"div",30)(48,"div",35),t.nrm(49,"div",15),t.k0s()()()(),t.j41(50,"div",38)(51,"div",36)(52,"label",33),t.nrm(53,"span",15),t.k0s(),t.j41(54,"input",37,5),t.bIt("keyup",function(){return t.eBV(e),t.Njj(0)})("change",function(){t.eBV(e);const n=t.sdS(19),o=t.sdS(29),g=t.sdS(44),_=t.sdS(55),y=t.sdS(65),B=t.sdS(75),nt=t.XpG(2);return t.Njj(nt.settingsManager.setAutoBackupUrl({url:n.value,method:o.value,fileUpload:g.checked,username:y.value,password:B.value,authorization:_.value}))}),t.k0s(),t.nrm(56,"img",29),t.j41(57,"div",30)(58,"div",35),t.nrm(59,"div",15),t.k0s()()()(),t.j41(60,"div",38)(61,"div",36)(62,"label",33),t.nrm(63,"span",15),t.k0s(),t.j41(64,"input",37,6),t.bIt("keyup",function(){return t.eBV(e),t.Njj(0)})("change",function(){t.eBV(e);const n=t.sdS(19),o=t.sdS(29),g=t.sdS(44),_=t.sdS(55),y=t.sdS(65),B=t.sdS(75),nt=t.XpG(2);return t.Njj(nt.settingsManager.setAutoBackupUrl({url:n.value,method:o.value,fileUpload:g.checked,username:y.value,password:B.value,authorization:_.value}))}),t.k0s(),t.nrm(66,"img",29),t.j41(67,"div",30)(68,"div",35),t.nrm(69,"div",15),t.k0s()()()(),t.j41(70,"div",38)(71,"div",36)(72,"label",33),t.nrm(73,"span",15),t.k0s(),t.j41(74,"input",37,7),t.bIt("keyup",function(){return t.eBV(e),t.Njj(0)})("change",function(){t.eBV(e);const n=t.sdS(19),o=t.sdS(29),g=t.sdS(44),_=t.sdS(55),y=t.sdS(65),B=t.sdS(75),nt=t.XpG(2);return t.Njj(nt.settingsManager.setAutoBackupUrl({url:n.value,method:o.value,fileUpload:g.checked,username:y.value,password:B.value,authorization:_.value}))}),t.k0s(),t.nrm(76,"img",29),t.j41(77,"div",30)(78,"div",35),t.nrm(79,"div",15),t.k0s()()()()}if(2&i){const e=t.sdS(5),a=t.sdS(19),n=t.XpG(2);t.R7$(3),t.Y8G("ghs-label","datamanagement.backup.auto.count"),t.R7$(),t.Y8G("value",n.settingsManager.settings.autoBackup)("size",e.value.length)("ghs-label","datamanagement.backup.auto.count")("ghs-label-attribute","placeholder"),t.R7$(5),t.Y8G("ghs-label","datamanagement.backup.auto.countHint"),t.R7$(3),t.Y8G("checked",n.settingsManager.settings.autoBackupFinish),t.R7$(),t.Y8G("ghs-label","datamanagement.backup.auto.onFinish"),t.R7$(4),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrl"),t.R7$(),t.Y8G("value",null==n.settingsManager.settings.autoBackupUrl?null:n.settingsManager.settings.autoBackupUrl.url)("ghs-label","datamanagement.backup.auto.uploadUrl")("ghs-label-attribute","placeholder"),t.R7$(5),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrl.hint"),t.R7$(),t.Y8G("ngClass",t.eq3(42,oi,!a.value)),t.R7$(3),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlMethod"),t.R7$(),t.Y8G("value",null==n.settingsManager.settings.autoBackupUrl?null:n.settingsManager.settings.autoBackupUrl.method),t.R7$(3),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlMethod.post"),t.R7$(2),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlMethod.put"),t.R7$(2),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlMethod.get"),t.R7$(4),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlMethod.hint"),t.R7$(),t.Y8G("ngClass",t.eq3(44,oi,!a.value)),t.R7$(3),t.Y8G("checked",null==n.settingsManager.settings.autoBackupUrl?null:n.settingsManager.settings.autoBackupUrl.fileUpload),t.R7$(2),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlFileUpload"),t.R7$(4),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlFileUpload.hint"),t.R7$(),t.Y8G("ngClass",t.eq3(46,oi,!a.value)),t.R7$(3),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlAuthorization"),t.R7$(),t.Y8G("value",null==n.settingsManager.settings.autoBackupUrl?null:n.settingsManager.settings.autoBackupUrl.authorization)("ghs-label","datamanagement.backup.auto.uploadUrlAuthorization")("ghs-label-attribute","placeholder"),t.R7$(5),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlAuthorization.hint"),t.R7$(),t.Y8G("ngClass",t.eq3(48,oi,!a.value)),t.R7$(3),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlUsername"),t.R7$(),t.Y8G("value",null==n.settingsManager.settings.autoBackupUrl?null:n.settingsManager.settings.autoBackupUrl.username)("ghs-label","datamanagement.backup.auto.uploadUrlUsername")("ghs-label-attribute","placeholder"),t.R7$(5),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlUsername.hint"),t.R7$(),t.Y8G("ngClass",t.eq3(50,oi,!a.value)),t.R7$(3),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlPassword"),t.R7$(),t.Y8G("value",null==n.settingsManager.settings.autoBackupUrl?null:n.settingsManager.settings.autoBackupUrl.password)("ghs-label","datamanagement.backup.auto.uploadUrlPassword")("ghs-label-attribute","placeholder"),t.R7$(5),t.Y8G("ghs-label","datamanagement.backup.auto.uploadUrlPassword.hint")}}function $K(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",11)(1,"div",13)(2,"div",16)(3,"a",24),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.exportGame())}),t.nrm(4,"span",15),t.k0s()(),t.j41(5,"div",16)(6,"a",25),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.resetGame())})("mouseleave",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.cancelConfirm())}),t.EFF(7,"<"),t.nrm(8,"span",15),t.EFF(9,"(!)>"),t.k0s()(),t.j41(10,"div",16)(11,"div",26)(12,"label",27),t.bIt("click",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.importFileCheck(n))})("mouseleave",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.cancelConfirm())}),t.j41(13,"input",28),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.importFile(n))}),t.k0s(),t.EFF(14," <"),t.nrm(15,"span",15),t.EFF(16,"(!)> "),t.k0s(),t.nrm(17,"img",29),t.j41(18,"span",30),t.nrm(19,"span",31),t.k0s()()()(),t.j41(20,"div",13)(21,"div",16)(22,"a",24),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.exportSettings())}),t.nrm(23,"span",15),t.k0s()(),t.j41(24,"div",16)(25,"a",25),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.resetSettings())})("mouseleave",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.cancelConfirm())}),t.EFF(26,"<"),t.nrm(27,"span",15),t.EFF(28,"(!)>"),t.k0s()()(),t.j41(29,"div",13)(30,"div",16)(31,"a",24),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.exportDataDump())}),t.nrm(32,"span",15),t.k0s()(),t.j41(33,"div",16)(34,"a",25),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.clearAllData())})("mouseleave",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.cancelConfirm())}),t.EFF(35,"<"),t.nrm(36,"span",15),t.EFF(37,"(!)>"),t.k0s()(),t.j41(38,"div",16)(39,"label")(40,"input",32),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.settingsManager.settings.autoBackup=-1==n.settingsManager.settings.autoBackup?25:-1)}),t.k0s(),t.nrm(41,"span",15),t.k0s()(),t.nVh(42,SK,80,52),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(4),t.Y8G("ghs-label","datamanagement.exportGame"),t.R7$(2),t.Y8G("ngClass",t.eq3(17,ai,"resetGame"==e.confirm)),t.R7$(2),t.Y8G("ghs-label","datamanagement.resetGame"),t.R7$(4),t.Y8G("ngClass",t.eq3(19,ai,"importFile"==e.confirm)),t.R7$(),t.Y8G("ngClass",t.eq3(21,Yi,"importFile"!=e.confirm))("disabled","importFile"!=e.confirm),t.R7$(2),t.Y8G("ghs-label","datamanagement.importFile"),t.R7$(4),t.Y8G("ghs-label","datamanagement.importFile.hint"),t.R7$(4),t.Y8G("ghs-label","datamanagement.exportSettings"),t.R7$(2),t.Y8G("ngClass",t.eq3(23,ai,"resetSettings"==e.confirm)),t.R7$(2),t.Y8G("ghs-label","datamanagement.resetSettings"),t.R7$(5),t.Y8G("ghs-label","datamanagement.exportDataDump"),t.R7$(2),t.Y8G("ngClass",t.eq3(25,ai,"clearAllData"==e.confirm)),t.R7$(2),t.Y8G("ghs-label","datamanagement.clearAll"),t.R7$(4),t.Y8G("checked",-1!=e.settingsManager.settings.autoBackup),t.R7$(),t.Y8G("ghs-label","datamanagement.backup.auto"),t.R7$(),t.vxM(-1!=e.settingsManager.settings.autoBackup?42:-1)}}function DK(i,r){1&i&&t.nrm(0,"div",12)}function IK(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",44),t.EFF(1),t.nrm(2,"span",22),t.j41(3,"span",45),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.removeUnlock(n))}),t.k0s()()}if(2&i){const e=r.$implicit;t.R7$(),t.SpI(" ",e," "),t.R7$(2),t.Y8G("ghs-label","datamanagement.removeUnlock")("ghs-label-attribute","title")}}function AK(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",23)(1,"a",24),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.removeAllUnlocks())}),t.nrm(2,"span",15),t.k0s()()}2&i&&(t.R7$(2),t.Y8G("ghs-label","datamanagement.removeAllUnlocks"))}function VK(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",44),t.EFF(1),t.nrm(2,"span",22),t.j41(3,"span",45),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.removeSpoiler(n))}),t.k0s()()}if(2&i){const e=r.$implicit;t.R7$(),t.SpI(" ",e," "),t.R7$(2),t.Y8G("ghs-label","datamanagement.removeSpoiler")("ghs-label-attribute","title")}}function FK(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",23)(1,"a",24),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.settingsManager.removeAllSpoilers())}),t.nrm(2,"span",15),t.k0s()()}2&i&&(t.R7$(2),t.Y8G("ghs-label","datamanagement.removeAllSpoilers"))}function XK(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",13)(1,"div",14)(2,"label"),t.nrm(3,"span",15),t.k0s()(),t.j41(4,"div",16)(5,"span",17)(6,"input",18,8),t.bIt("keyup.enter",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.addUnlock(n.target))})("keyup",function(){t.eBV(e);const n=t.sdS(7);return t.Njj(n.classList.remove("error"))}),t.k0s(),t.j41(8,"span",19),t.bIt("click",function(){t.eBV(e);const n=t.sdS(7),o=t.XpG();return t.Njj(o.addUnlock(n))}),t.k0s()()(),t.j41(9,"div",43),t.Z7z(10,IK,4,3,"a",44,t.fX1),t.k0s(),t.nrm(12,"div",22),t.nVh(13,AK,3,1,"div",23),t.j41(14,"div",14)(15,"label"),t.nrm(16,"span",15),t.k0s()(),t.j41(17,"div",16)(18,"span",17)(19,"input",18,9),t.bIt("keyup.enter",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.addSpoiler(n.target))})("keyup",function(){return t.eBV(e),t.Njj(0)}),t.k0s(),t.j41(21,"span",19),t.bIt("click",function(){t.eBV(e);const n=t.sdS(20),o=t.XpG();return t.Njj(o.addSpoiler(n))}),t.k0s()()(),t.j41(22,"div",43),t.Z7z(23,VK,4,3,"a",44,t.fX1),t.k0s(),t.nrm(25,"div",22),t.nVh(26,FK,3,1,"div",23),t.k0s()}if(2&i){const e=t.sdS(7),a=t.sdS(20),n=t.XpG();t.R7$(),t.Y8G("ngClass",t.l_i(12,go,"fh"==n.settingsManager.settings.theme,"modern"==n.settingsManager.settings.theme)),t.R7$(2),t.Y8G("ghs-label","datamanagement.unlocks"),t.R7$(3),t.Y8G("ghs-label","datamanagement.addUnlock")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ngClass",t.eq3(15,Yi,!e.value)),t.R7$(2),t.Dyx(n.gameManager.game.unlockedCharacters),t.R7$(3),t.vxM(n.gameManager.game.unlockedCharacters.length>0?13:-1),t.R7$(),t.Y8G("ngClass",t.l_i(17,go,"fh"==n.settingsManager.settings.theme,"modern"==n.settingsManager.settings.theme)),t.R7$(2),t.Y8G("ghs-label","datamanagement.spoilers"),t.R7$(3),t.Y8G("ghs-label","datamanagement.addSpoiler")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ngClass",t.eq3(20,Yi,!a.value)),t.R7$(2),t.Dyx(n.settingsManager.settings.spoilers),t.R7$(3),t.vxM(n.settingsManager.settings.spoilers.length>0?26:-1)}}function BK(i,r){if(1&i&&(t.j41(0,"span",47),t.nrm(1,"img",49),t.j41(2,"span",50),t.EFF(3),t.k0s()()),2&i){const e=t.XpG().$implicit;t.Y8G("ghs-label","datamanagement.editionDataUrls.custom")("ghs-label-attribute","title"),t.R7$(3),t.JRh(e.url)}}function YK(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",21)(1,"label",46)(2,"input",32),t.bIt("change",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.toggleEdition(n))}),t.k0s(),t.nrm(3,"span",15),t.k0s(),t.nVh(4,BK,4,3,"span",47),t.nrm(5,"span",22),t.j41(6,"span",48),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.removeEditionDataUrl(n.url))}),t.k0s()()}if(2&i){const e=r.$implicit,a=t.XpG();t.R7$(),t.Y8G("ghs-label",-1!=a.settingsManager.settings.editions.indexOf(e.edition)?"datamanagement.editionDataUrls.disable":"datamanagement.editionDataUrls.enable")("ghs-label-attribute","title"),t.R7$(),t.Y8G("checked",-1!=a.settingsManager.settings.editions.indexOf(e.edition)),t.R7$(),t.Y8G("ghs-label","data.edition."+e.edition),t.R7$(),t.vxM(-1==a.settingsManager.defaultEditionDataUrls.indexOf(e.url)?4:-1),t.R7$(2),t.Y8G("ghs-label","datamanagement.editionDataUrls.remove")("ghs-label-attribute","title")}}function NK(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",23)(1,"a",24),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.settingsManager.restoreDefaultEditionDataUrls())}),t.nrm(2,"span",15),t.k0s()()}2&i&&(t.R7$(2),t.Y8G("ghs-label","datamanagement.restoreEditionDataUrls"))}function zK(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",16)(1,"a",24),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.exportAllBackups())}),t.nrm(2,"span",52),t.k0s()()}if(2&i){const e=t.XpG(3);t.R7$(2),t.Y8G("ghs-label","datamanagement.backup.all")("ghs-label-args",t.eq3(2,GK,e.backups))}}function LK(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",51)(1,"label"),t.nrm(2,"span",15),t.k0s()(),t.j41(3,"div",16)(4,"a",24),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.exportLatestBackup())}),t.nrm(5,"span",15),t.k0s()(),t.nVh(6,zK,3,4,"div",16),t.j41(7,"div",16)(8,"a",25),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.deleteBackups())})("mouseleave",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.cancelConfirm())}),t.EFF(9,"<"),t.nrm(10,"span",15),t.EFF(11,"(!)>"),t.k0s()()}if(2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","datamanagement.backup"),t.R7$(3),t.Y8G("ghs-label","datamanagement.backup.latest"),t.R7$(),t.vxM(e.backups>1?6:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(5,ai,"deleteBackups"==e.confirm)),t.R7$(2),t.Y8G("ghs-label","datamanagement.backup.delete")}}function UK(i,r){if(1&i&&(t.j41(0,"div",13),t.nVh(1,LK,12,7),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.vxM(e.backups>0?1:-1)}}let qK=(()=>{class i{editionsOnly=!1;settingsManager=m.f;gameManager=s.E;backups=0;ghsInputFullScreenCheck=V.It;confirm="";working="";ngOnInit(){var e=this;return(0,X.A)(function*(){try{const a=yield w.n.readAll("game-backup");a&&a.length>0&&(e.backups=a.length)}catch{e.backups=0}})()}addEditionDataUrl(e){var a=this;return(0,X.A)(function*(){if(e.value){e.classList.remove("error"),e.disabled=!0;const n=yield m.f.addEditionDataUrl(e.value);n?(e.value="",e.disabled=!1,a.settingsManager.addEdition(n.edition)):setTimeout(()=>{e.classList.add("error"),e.disabled=!1},1)}})()}removeEditionDataUrl(e){e&&m.f.removeEditionDataUrl(e)}toggleEdition(e){var a=this;return(0,X.A)(function*(){-1!=a.settingsManager.settings.editions.indexOf(e.edition)?a.settingsManager.removeEdition(e.edition):(a.settingsManager.addEdition(e.edition),yield a.settingsManager.loadEditionData(e.url,!0),s.E.uiChange.emit())})()}drop(e){(0,D.HD)(m.f.settings.editionDataUrls,e.previousIndex,e.currentIndex),(0,D.HD)(s.E.editionData,e.previousIndex,e.currentIndex),m.f.storeSettings()}hasDefaultEditionData(){return this.settingsManager.defaultEditionDataUrls.every(e=>-1!=m.f.settings.editionDataUrls.indexOf(e))}addSpoiler(e){e.value&&(m.f.addSpoiler(e.value),e.value="")}removeSpoiler(e){e&&m.f.removeSpoiler(e)}addUnlock(e){if(e.value){let a=e.value,n="";-1!=a.indexOf(":")&&(n=e.value.split(":")[0],a=e.value.split(":")[1]),e.classList.remove("error"),e.disabled=!0;let o=s.E.getCharacterData(a,n||s.E.currentEdition());o||(o=s.E.getCharacterData(a)),o&&-1==s.E.game.unlockedCharacters.indexOf(o.edition+":"+o.name)?(s.E.stateManager.before("unlockChar","data.character."+o.edition+"."+o.name),s.E.game.unlockedCharacters.push(o.edition+":"+o.name),m.f.settings.events&&o.unlockEvent&&o.unlockEvent.split("|").forEach(g=>{g.split(":").length>1?s.E.eventCardManager.addEvent(g.split(":")[0],g.split(":")[1],!0):(s.E.eventCardManager.addEvent("city",g,!0),s.E.eventCardManager.addEvent("road",g,!0))}),s.E.stateManager.after(),e.value="",e.disabled=!1):setTimeout(()=>{e.classList.add("error"),e.disabled=!1},1)}}removeUnlock(e){if(e.split(":").length>1){const a=s.E.getCharacterData(e.split(":")[1],e.split(":")[0]);e&&-1!=s.E.game.unlockedCharacters.indexOf(e)&&a&&(s.E.stateManager.before("unlockChar","data.character."+a.edition+"."+a.name),s.E.game.unlockedCharacters.splice(s.E.game.unlockedCharacters.indexOf(e),1),s.E.stateManager.after())}}removeAllUnlocks(){s.E.stateManager.before("removeAllUnlocks"),s.E.game.unlockedCharacters=[],s.E.stateManager.after()}cancelConfirm(){this.confirm=""}exportGame(){return(0,X.A)(function*(){try{const e=yield w.n.readGameModel();if(e){const a=document.createElement("a");a.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e))),a.setAttribute("download","ghs-game"+(e.party.name?"_"+e.party.name:"")+".json"),document.body.appendChild(a),a.click(),document.body.removeChild(a)}}catch{console.warn("No game found")}})()}exportLatestBackup(){return(0,X.A)(function*(){try{const e=yield w.n.readAll("game-backup");if(e&&e.length>0){const a=e[e.length-1],n=document.createElement("a");n.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(a))),n.setAttribute("download","ghs-game"+(a.party.name?"_"+a.party.name:"")+"-rev"+a.revision+".json"),document.body.appendChild(n),n.click(),document.body.removeChild(n)}}catch{console.warn("No backup found")}})()}exportAllBackups(){return(0,X.A)(function*(){try{const e=yield w.n.readAll("game-backup");e&&e.length>0&&e.forEach(a=>{const n=document.createElement("a");n.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(a))),n.setAttribute("download","ghs-game"+(a.party.name?"_"+a.party.name:"")+"-rev"+a.revision+".json"),document.body.appendChild(n),n.click(),document.body.removeChild(n)})}catch{console.warn("No backups found")}})()}deleteBackups(){"deleteBackups"!=this.confirm?this.confirm="deleteBackups":(w.n.clear("game-backup"),this.backups=0)}importFileCheck(e){e.target.classList.remove("warning"),e.target.parentElement.classList.remove("warning"),"importFile"!=this.confirm?setTimeout(()=>{this.confirm="importFile"},100):(0,V.It)()}importFile(e){var a=this;this.working="importFile",e.target.parentElement.classList.remove("warning");const n=new FileReader;try{n.addEventListener("load",function(){var o=(0,X.A)(function*(g){const _=JSON.parse(g.target.result);_.revision&&"number"==typeof _.revision?a.importGame(Object.assign(new T.u8,_)):_.zoom&&"number"==typeof _.zoom?a.importSettings(Object.assign(new gc.w,_)):_.game&&_.settings||"object"==typeof _&&_["ghs-game"]&&_["ghs-settings"]?a.importDataDump(_):e.target.parentElement.classList.add("warning"),a.working=""});return function(g){return o.apply(this,arguments)}}()),e.target.files.length>0&&(n.readAsText(e.target.files[0]),e.target.value="")}catch(o){console.warn(o),e.target.parentElement.classList.add("warning"),this.working=""}}importGame(e){s.E.stateManager.before("loadGameFromFile"),e.revision<s.E.game.revision&&(w.n.addBackup(s.E.game.toModel()),e.revision=s.E.game.revision,e.revisionOffset=s.E.game.revisionOffset),s.E.game.fromModel(e),s.E.stateManager.after()}resetGame(){"resetGame"!=this.confirm?this.confirm="resetGame":(s.E.stateManager.reset(),s.E.stateManager.after(),window.location.reload())}exportSettings(){return(0,X.A)(function*(){try{const e=yield w.n.read("settings","default");if(e){const a=document.createElement("a");a.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e))),a.setAttribute("download","ghs-settings.json"),document.body.appendChild(a),a.click(),document.body.removeChild(a)}}catch{console.warn("No settings found")}})()}importSettings(e){return(0,X.A)(function*(){m.f.settings=e,yield w.n.write("settings","default",m.f.settings)})()}resetSettings(){"resetSettings"!=this.confirm?this.confirm="resetSettings":(m.f.reset(),window.location.reload())}exportDataDump(){return(0,X.A)(function*(){yield s.E.stateManager.autoBackup("ghs-data-dump-"+(new Date).toISOString()+".json",!0)})()}importDataDump(e){return(0,X.A)(function*(){s.E.stateManager.errorLog=e.errorLog||[];const a=Object.keys(e);let n=!1;for(let o=0;o<a.length;o++){const g=a[o],_=g.startsWith("ghs-")?g.replace("ghs-",""):g;"game"===_?(yield w.n.write("game","default",e[g]),n=!0):"settings"===_?yield w.n.write("settings","default",Object.assign(new gc.w,e[g])):"undo"===_?yield w.n.writeArray("undo",e[g]):"redo"===_?yield w.n.writeArray("redo",e[g]):"undo-infos"===_?yield w.n.writeArray("undo-infos",e[g]):"game-backup"===_&&(yield w.n.writeArray("game-backup",e[g]))}n&&window.location.reload()})()}clearAllData(){var e=this;return(0,X.A)(function*(){if("clearAllData"!=e.confirm)e.confirm="clearAllData";else try{console.warn("clear storage"),yield w.n.clear(),s.E.stateManager.storageBlocked=!0,console.info("Reload..."),window.location.reload()}catch{console.error("Could clear storage")}})()}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-datamanagement-menu"]],inputs:{editionsOnly:"editionsOnly"},standalone:!1,decls:20,vars:15,consts:[["inputEditionDataUrl",""],["autoBackup",""],["autoBackupuploadUrl",""],["autoBackupPostMethod",""],["autoBackupPostFileUpload",""],["autoBackupPostAuthorization",""],["autoBackupPostUsername",""],["autoBackupPostPassword",""],["inputUnlock",""],["inputSpoiler",""],[1,"menu-container","data"],[1,"columns","columns-break"],[1,"separator"],[1,"column"],[1,"line","title","sticky",3,"ngClass"],[3,"ghs-label"],[1,"line"],[1,"input-button"],["tabclick","","type","text",3,"keyup.enter","keyup","ghs-label","ghs-label-attribute"],[1,"add-button",3,"click","ngClass"],["cdkDropList","",1,"line","editions",3,"cdkDropListDropped"],["cdkDrag","",1,"edition"],[1,"spacer"],[1,"line","separator"],["tabclick","",3,"click"],["tabclick","",3,"click","mouseleave","ngClass"],[1,"hint-container"],["tabclick","",1,"input-file","hint-trigger",3,"click","mouseleave","ngClass"],["type","file","accept","application/json",3,"change","ngClass","disabled"],["src","./assets/images/hint.svg",1,"hint-trigger","ghs-svg"],[1,"hint"],[1,"text",3,"ghs-label"],["tabclick","","type","checkbox",3,"change","checked"],[1,"label"],["tabclick","","type","number","min","0",3,"keyup","change","value","size","ghs-label","ghs-label-attribute"],[1,"text"],[1,"hint-container","input-container"],["tabclick","","type","text",3,"keyup","change","value","ghs-label","ghs-label-attribute"],[1,"line",3,"ngClass"],["tabclick","",3,"change","value"],["value","POST"],["value","PUT"],["value","GET"],[1,"line","spoilers"],[1,"spoiler-item"],["tabclick","",1,"remove",3,"click","ghs-label","ghs-label-attribute"],[3,"ghs-label","ghs-label-attribute"],[1,"custom",3,"ghs-label","ghs-label-attribute"],[1,"remove",3,"click","ghs-label","ghs-label-attribute"],["src","./assets/images/hint.svg"],[1,"url"],[1,"line","title"],[3,"ghs-label","ghs-label-args"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",10),t.nVh(1,$K,43,27,"div",11),t.nVh(2,DK,1,0,"div",12),t.j41(3,"div",11),t.nVh(4,XK,27,22,"div",13),t.j41(5,"div",13)(6,"div",14)(7,"label"),t.nrm(8,"span",15),t.k0s()(),t.j41(9,"div",16)(10,"span",17)(11,"input",18,0),t.bIt("keyup.enter",function(_){return t.eBV(o),t.Njj(n.addEditionDataUrl(_.target))})("keyup",function(){t.eBV(o);const _=t.sdS(12);return t.Njj(_.classList.remove("error"))}),t.k0s(),t.j41(13,"span",19),t.bIt("click",function(){t.eBV(o);const _=t.sdS(12);return t.Njj(n.addEditionDataUrl(_))}),t.k0s()()(),t.j41(14,"div",20),t.bIt("cdkDropListDropped",function(_){return t.eBV(o),t.Njj(n.drop(_))}),t.Z7z(15,YK,7,7,"a",21,TK),t.k0s(),t.nrm(17,"div",22),t.nVh(18,NK,3,1,"div",23),t.k0s(),t.nVh(19,UK,2,1,"div",13),t.k0s()()}if(2&a){const o=t.sdS(12);t.R7$(),t.vxM(n.editionsOnly?-1:1),t.R7$(),t.vxM(n.editionsOnly?-1:2),t.R7$(2),t.vxM(n.editionsOnly?-1:4),t.R7$(2),t.Y8G("ngClass",t.l_i(10,go,"fh"==n.settingsManager.settings.theme,"modern"==n.settingsManager.settings.theme)),t.R7$(2),t.Y8G("ghs-label","datamanagement.editionDataUrls"),t.R7$(3),t.Y8G("ghs-label","datamanagement.addEditionDataUrl")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ngClass",t.eq3(13,Yi,!o.value)),t.R7$(2),t.Dyx(n.gameManager.editionData),t.R7$(3),t.vxM(n.hasDefaultEditionData()?-1:18),t.R7$(),t.vxM(n.editionsOnly?-1:19)}},dependencies:[N.YU,O.xH,O.y7,D.O7,D.T1,tt,At],styles:['[_nghost-%COMP%]{position:relative;z-index:9999}.hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:break-spaces}.back[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled[_ngcontent-%COMP%]{pointer-events:none}.back.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container[_ngcontent-%COMP%]{z-index:1}.menu-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.no-grow[_ngcontent-%COMP%]{flex-grow:0}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container.inline[_ngcontent-%COMP%]{width:initial;margin-right:1em}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex-wrap:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-gray)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{filter:grayscale(1)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm-delete[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]{align-items:flex-start}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]   .undo-text[_ngcontent-%COMP%]{display:flex;align-items:center}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.redo[_ngcontent-%COMP%]{align-items:flex-end}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]:hover{opacity:.7}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover{cursor:pointer}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog.disabled[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)!important}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]{border-bottom:none;margin-bottom:0}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container[_ngcontent-%COMP%]   .line.sticky.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container[_ngcontent-%COMP%]   .line.sticky.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .add[_ngcontent-%COMP%]{display:inherit}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%] ~ .spoiler[_ngcontent-%COMP%]{margin-top:0;border-top:none}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]{display:flex;cursor:pointer}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]   .span-xs[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns.columns-break[_ngcontent-%COMP%]{flex-wrap:wrap}}','.editions[_ngcontent-%COMP%], .spoilers[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start!important;justify-content:center!important}.edition[_ngcontent-%COMP%], .spoiler-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) 0;width:100%}.edition[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%], .spoiler-item[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]{cursor:pointer!important;display:flex;width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor))}.edition[_ngcontent-%COMP%]:hover   .remove[_ngcontent-%COMP%]:after, .spoiler-item[_ngcontent-%COMP%]:hover   .remove[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 80%,30% 50%,0 20%,20% 0,50% 30%,80% 0,100% 20%,70% 50%,100% 80%,80% 100%,50% 70%,20% 100%);background-color:var(--ghs-color-white)}.spoiler-item[_ngcontent-%COMP%]{cursor:initial!important}.working[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray);animation:ghs-spinning calc(var(--ghs-animation-speed) * 1.5s) linear infinite;margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.edition[_ngcontent-%COMP%]{cursor:grab!important;padding:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor)) 0}.edition[_ngcontent-%COMP%]   .custom[_ngcontent-%COMP%]{display:flex;align-items:center;filter:var(--ghs-filter-gray) var(--ghs-filter-shadow);margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.edition[_ngcontent-%COMP%]   .custom[_ngcontent-%COMP%]   .url[_ngcontent-%COMP%]{display:none;font-family:var(--ghs-font-normal);align-self:flex-end;font-size:.8em;margin:0 calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));flex:1 1 auto;text-shadow:none}.edition[_ngcontent-%COMP%]:hover   .custom[_ngcontent-%COMP%]   .url[_ngcontent-%COMP%]{display:inline-block}.line[_ngcontent-%COMP%]   .input-file[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{width:0;height:0;margin:0;padding:0;visibility:hidden}.line[_ngcontent-%COMP%]   .input-file[_ngcontent-%COMP%]   input[type=file].disabled[_ngcontent-%COMP%]{pointer-events:none}.line[_ngcontent-%COMP%]   .input-file.error[_ngcontent-%COMP%]{animation:shake calc(var(--ghs-animation-speed) * .5s) linear;color:var(--ghs-color-red)!important}.line[_ngcontent-%COMP%]   .input-file.warning[_ngcontent-%COMP%]{animation:shake calc(var(--ghs-animation-speed) * .5s) linear;color:var(--ghs-color-yellow)!important}.line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   label.hint-trigger[_ngcontent-%COMP%]{margin-left:0}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:1 span}}']})}return i})(),HK=(()=>{class i{settingsManager=m.f;close=new t.bkB;setServerPing(e){m.f.settings.serverPing=e.target.value,m.f.storeSettings()}clearFeedbackErrors(){m.f.settings.feedbackErrorsIgnore=[],m.f.storeSettings(),this.close.emit()}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-debug-menu"]],outputs:{close:"close"},standalone:!1,decls:51,vars:26,consts:[["serverPing",""],[1,"menu-container","debug"],[1,"line"],["tabclick","","type","checkbox",3,"change","checked"],[3,"ghs-label"],[1,"separator"],[1,"line","ping"],[1,"label"],["type","number",3,"keyup","change","value","ghs-label","ghs-label-attribute"],["tabclick","",3,"click"],[1,"line","title","span"],["tabclick","",3,"routerLink"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"label")(3,"input",3),t.bIt("change",function(){return t.eBV(o),t.Njj(n.settingsManager.toggle("debugRightClick"))}),t.k0s(),t.nrm(4,"span",4),t.k0s()(),t.nrm(5,"div",5),t.j41(6,"div",2)(7,"label")(8,"input",3),t.bIt("change",function(){return t.eBV(o),t.Njj(n.settingsManager.toggle("logServerMessages"))}),t.k0s(),t.nrm(9,"span",4),t.k0s()(),t.j41(10,"div",6)(11,"label",7),t.nrm(12,"span",4),t.k0s(),t.j41(13,"input",8,0),t.bIt("keyup",function(){return t.eBV(o),t.Njj(0)})("change",function(_){return t.eBV(o),t.Njj(n.setServerPing(_))}),t.k0s()(),t.nrm(15,"div",5),t.j41(16,"div",2)(17,"a",9),t.bIt("click",function(){return t.eBV(o),t.Njj(n.clearFeedbackErrors())}),t.nrm(18,"span",4),t.k0s()(),t.j41(19,"div",10)(20,"label"),t.nrm(21,"span",4),t.k0s()(),t.j41(22,"div",2)(23,"a",11),t.nrm(24,"span",4),t.k0s()(),t.j41(25,"div",2)(26,"a",11),t.nrm(27,"span",4),t.k0s()(),t.j41(28,"div",2)(29,"a",11),t.nrm(30,"span",4),t.k0s()(),t.j41(31,"div",2)(32,"a",11),t.nrm(33,"span",4),t.k0s()(),t.j41(34,"div",10)(35,"label"),t.nrm(36,"span",4),t.k0s()(),t.j41(37,"div",2)(38,"a",11),t.nrm(39,"span",4),t.k0s()(),t.j41(40,"div",2)(41,"a",11),t.nrm(42,"span",4),t.k0s()(),t.nrm(43,"div",5),t.j41(44,"div",2)(45,"a",9),t.bIt("click",function(){return t.eBV(o),t.Njj(n.settingsManager.validateEditionData())}),t.nrm(46,"span",4),t.k0s()(),t.nrm(47,"div",5),t.j41(48,"div",2)(49,"a",11),t.nrm(50,"span",4),t.k0s()()()}2&a&&(t.R7$(3),t.Y8G("checked",n.settingsManager.settings.debugRightClick),t.R7$(),t.Y8G("ghs-label","settings.debug.rightClick"),t.R7$(4),t.Y8G("checked",n.settingsManager.settings.logServerMessages),t.R7$(),t.Y8G("ghs-label","settings.debug.logServerMessages"),t.R7$(3),t.Y8G("ghs-label","server.ping"),t.R7$(),t.Y8G("value",n.settingsManager.settings.serverPing||"0")("ghs-label","server.ping")("ghs-label-attribute","placeholder"),t.R7$(5),t.Y8G("ghs-label","settings.feedbackErrors.clear"),t.R7$(3),t.Y8G("ghs-label","editor"),t.R7$(2),t.Y8G("routerLink","/editor/monster"),t.R7$(),t.Y8G("ghs-label","editor.monster"),t.R7$(2),t.Y8G("routerLink","/editor/character"),t.R7$(),t.Y8G("ghs-label","editor.character"),t.R7$(2),t.Y8G("routerLink","/editor/deck"),t.R7$(),t.Y8G("ghs-label","editor.deck"),t.R7$(2),t.Y8G("routerLink","/editor/edition"),t.R7$(),t.Y8G("ghs-label","editor.edition"),t.R7$(3),t.Y8G("ghs-label","tools"),t.R7$(2),t.Y8G("routerLink","/tools/decks"),t.R7$(),t.Y8G("ghs-label","tools.decks"),t.R7$(2),t.Y8G("routerLink","/tools/attackmodifier"),t.R7$(),t.Y8G("ghs-label","tools.attackModifier"),t.R7$(4),t.Y8G("ghs-label","tools.validateEditionData"),t.R7$(3),t.Y8G("routerLink","/"),t.R7$(),t.Y8G("ghs-label","tools.backToGhs"))},dependencies:[U.Wk,tt,At],styles:['[_nghost-%COMP%]{position:relative;z-index:9999}.hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:break-spaces}.back[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled[_ngcontent-%COMP%]{pointer-events:none}.back.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container[_ngcontent-%COMP%]{z-index:1}.menu-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.no-grow[_ngcontent-%COMP%]{flex-grow:0}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container.inline[_ngcontent-%COMP%]{width:initial;margin-right:1em}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex-wrap:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-gray)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{filter:grayscale(1)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm-delete[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]{align-items:flex-start}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]   .undo-text[_ngcontent-%COMP%]{display:flex;align-items:center}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.redo[_ngcontent-%COMP%]{align-items:flex-end}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]:hover{opacity:.7}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover{cursor:pointer}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog.disabled[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)!important}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]{border-bottom:none;margin-bottom:0}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container[_ngcontent-%COMP%]   .line.sticky.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container[_ngcontent-%COMP%]   .line.sticky.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .add[_ngcontent-%COMP%]{display:inherit}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%] ~ .spoiler[_ngcontent-%COMP%]{margin-top:0;border-top:none}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]{display:flex;cursor:pointer}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]   .span-xs[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns.columns-break[_ngcontent-%COMP%]{flex-wrap:wrap}}']})}return i})();const KK=(i,r,e)=>({fh:i,modern:r,"all-editions":e}),dc=i=>({disabled:i}),WK=(i,r,e)=>({"hide-title":i,fh:r,modern:e}),JK=(i,r,e,a)=>({disabled:i,spoiler:r,boss:e,"hidden-monster":a}),ZK=(i,r)=>r.edition+"-"+r.name;function QK(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",4),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.allEditions=!n.allEditions)}),t.k0s(),t.nrm(2,"span",5),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("checked",e.allEditions),t.R7$(),t.Y8G("ghs-label","character.filter.allEditions")}}function tW(i,r){1&i&&(t.j41(0,"span",14),t.nrm(1,"img",16),t.k0s())}function eW(i,r){1&i&&t.nrm(0,"img",15)}function nW(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",13),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(3);return t.Njj(o.addMonster(n))}),t.nVh(1,tW,2,0,"span",14),t.nrm(2,"span",5),t.nVh(3,eW,1,0,"img",15),t.k0s()}if(2&i){const e=t.XpG().$implicit;t.R7$(),t.vxM(e.boss?1:-1),t.R7$(),t.Y8G("ghs-label","data.monster."+e.name),t.R7$(),t.vxM(e.hidden?3:-1)}}function iW(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",13),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(3);return t.Njj(o.settingsManager.addSpoiler(n.name))}),t.j41(1,"span",17),t.nrm(2,"span",5),t.k0s(),t.j41(3,"span",18),t.nrm(4,"span",5),t.k0s()()}2&i&&(t.R7$(2),t.Y8G("ghs-label","spoiler.placeholder"),t.R7$(2),t.Y8G("ghs-label","spoiler.add"))}function aW(i,r){if(1&i&&(t.j41(0,"div",11),t.nVh(1,nW,4,3,"a",12),t.nVh(2,iW,5,2,"a",12),t.k0s()),2&i){const e=r.$implicit,a=t.XpG(3);t.Y8G("ngClass",t.ziG(3,JK,a.hasMonster(e),e.spoiler,e.boss,e.hidden)),t.R7$(),t.vxM(a.isSpoiled(e)?1:-1),t.R7$(),t.vxM(a.isSpoiled(e)?-1:2)}}function oW(i,r){if(1&i&&(t.j41(0,"div",9)(1,"div",10)(2,"label"),t.nrm(3,"span",5),t.k0s()(),t.Z7z(4,aW,3,8,"div",11,ZK),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(),t.Y8G("ngClass",t.sMw(2,WK,!a.allEditions&&1==a.gameManager.currentEditions().length,"fh"==a.settingsManager.settings.theme,"modern"==a.settingsManager.settings.theme)),t.R7$(2),t.Y8G("ghs-label","data.edition."+e),t.R7$(),t.Dyx(a.monsterData(e,a.filter))}}function sW(i,r){if(1&i&&t.nVh(0,oW,6,6,"div",9),2&i){const e=r.$implicit,a=t.XpG();t.vxM(a.monsterData(e,a.filter).length>0?0:-1)}}function rW(i,r){1&i&&(t.j41(0,"div",7)(1,"div",8)(2,"label"),t.nrm(3,"span",5),t.k0s()()()),2&i&&(t.R7$(3),t.Y8G("ghs-label","monster.filter.noResult"))}function cW(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",8)(1,"a",13),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.settingsManager.addSpoilers(n.notSpoiled(n.monsterData())))}),t.nrm(2,"span",5),t.k0s()()}2&i&&(t.R7$(2),t.Y8G("ghs-label","spoiler.all"))}let lW=(()=>{class i{gameManager=s.E;settingsManager=m.f;hasSpoilers=V.KZ;isSpoiled=V.DJ;notSpoiled=V.gP;filter="";allEditions=!1;hasMonster(e){return s.E.game.figures.some(a=>a instanceof P.R&&e.name==a.name&&e.edition==a.edition)}hasBossMonster(){return s.E.currentEditions().some(e=>s.E.monstersData(e).some(a=>a.boss))}hasHiddenMonster(){return s.E.currentEditions().some(e=>s.E.monstersData(e).some(a=>a.hidden))}monsterData(e=void 0,a=""){return s.E.monstersData(e).filter(n=>(!n.boss||n.boss==m.f.settings.showBossMonster)&&(!n.hidden||n.hidden==m.f.settings.showHiddenMonster)&&(!a||(0,V.oB)(n.name,a)||(0,V.oB)(m.f.getLabel("data.monster."+n.name),a))).sort((n,o)=>{const g=m.f.getLabel("data.monster."+n.name).toLowerCase(),_=m.f.getLabel("data.monster."+o.name).toLowerCase();if(n.spoiler&&!o.spoiler)return 1;if(!n.spoiler&&o.spoiler)return-1;if(n.boss&&!o.boss)return 1;if(!n.boss&&o.boss)return-1;if(n.hidden&&!o.hidden)return 1;if(!n.hidden&&o.hidden)return-1;if(n.spoiler&&o.spoiler){if(!this.isSpoiled(n)&&this.isSpoiled(o))return 1;if(this.isSpoiled(n)&&!this.isSpoiled(o))return-1}return g>_?1:g<_?-1:0})}addMonster(e){s.E.stateManager.before("addMonster","data.monster."+e.name),s.E.monsterManager.addMonster(e,s.E.game.level).tags.push("addedManually"),s.E.stateManager.after()}noResults(){return s.E.currentEditions().every(e=>0==this.monsterData(e,this.filter).length)}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-monster-menu"]],standalone:!1,decls:15,vars:21,consts:[[1,"menu-container","monster-add"],[1,"line","filter-monster-menu",3,"ngClass"],["type","text",3,"ngModelChange","ngModel","ghs-label","ghs-label-attribute"],[3,"ngClass"],["tabclick","","type","checkbox",3,"change","checked"],[3,"ghs-label"],[1,"columns"],[1,"column"],[1,"line"],[1,"column","spoilers","bosses"],[1,"line","title","sticky",3,"ngClass"],[1,"line",3,"ngClass"],["tabclick",""],["tabclick","",3,"click"],[1,"boss-icon"],["src","./assets/images/hidden.svg",1,"ghs-svg","hidden-icon"],["src","./assets/images/monster/enemy.png"],[1,"name"],[1,"add"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"input",2),t.mxI("ngModelChange",function(g){return t.DH7(n.filter,g)||(n.filter=g),g}),t.k0s(),t.nVh(3,QK,3,2,"label"),t.j41(4,"label",3)(5,"input",4),t.bIt("change",function(){return n.settingsManager.toggle("showBossMonster")}),t.k0s(),t.nrm(6,"span",5),t.k0s(),t.j41(7,"label",3)(8,"input",4),t.bIt("change",function(){return n.settingsManager.toggle("showHiddenMonster")}),t.k0s(),t.nrm(9,"span",5),t.k0s()(),t.j41(10,"div",6),t.Z7z(11,sW,1,1,null,null,t.fX1),t.nVh(13,rW,4,1,"div",7),t.k0s(),t.nVh(14,cW,3,1,"div",8),t.k0s()),2&a&&(t.R7$(),t.Y8G("ngClass",t.sMw(13,KK,"fh"==n.settingsManager.settings.theme,"modern"==n.settingsManager.settings.theme,n.gameManager.game.edition)),t.R7$(),t.R50("ngModel",n.filter),t.Y8G("ghs-label","monster.filter")("ghs-label-attribute","placeholder"),t.R7$(),t.vxM(n.gameManager.game.edition?3:-1),t.R7$(),t.Y8G("ngClass",t.eq3(17,dc,!n.hasBossMonster())),t.R7$(),t.Y8G("checked",n.settingsManager.settings.showBossMonster),t.R7$(),t.Y8G("ghs-label","monster.showBoss"),t.R7$(),t.Y8G("ngClass",t.eq3(19,dc,!n.hasHiddenMonster())),t.R7$(),t.Y8G("checked",n.settingsManager.settings.showHiddenMonster),t.R7$(),t.Y8G("ghs-label","monster.showHidden"),t.R7$(2),t.Dyx(n.allEditions?n.gameManager.editions(!0,!0):n.gameManager.currentEditions()),t.R7$(2),t.vxM(n.filter&&n.noResults()?13:-1),t.R7$(),t.vxM(n.hasSpoilers(n.monsterData())?14:-1))},dependencies:[N.YU,O.me,O.BC,O.vS,tt,At],styles:['[_nghost-%COMP%]{position:relative;z-index:9999}.hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:break-spaces}.back[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled[_ngcontent-%COMP%]{pointer-events:none}.back.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container[_ngcontent-%COMP%]{z-index:1}.menu-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.no-grow[_ngcontent-%COMP%]{flex-grow:0}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container.inline[_ngcontent-%COMP%]{width:initial;margin-right:1em}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex-wrap:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-gray)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{filter:grayscale(1)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm-delete[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]{align-items:flex-start}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]   .undo-text[_ngcontent-%COMP%]{display:flex;align-items:center}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.redo[_ngcontent-%COMP%]{align-items:flex-end}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]:hover{opacity:.7}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover{cursor:pointer}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog.disabled[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)!important}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]{border-bottom:none;margin-bottom:0}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container[_ngcontent-%COMP%]   .line.sticky.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container[_ngcontent-%COMP%]   .line.sticky.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .add[_ngcontent-%COMP%]{display:inherit}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%] ~ .spoiler[_ngcontent-%COMP%]{margin-top:0;border-top:none}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]{display:flex;cursor:pointer}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]   .span-xs[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns.columns-break[_ngcontent-%COMP%]{flex-wrap:wrap}}',".monster-add[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 70 * var(--ghs-dialog-factor))}.monster-add[_ngcontent-%COMP%]   .filter-monster-menu[_ngcontent-%COMP%]{position:fixed;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:2;width:inherit;display:flex;flex-direction:column;align-items:flex-start}.monster-add[_ngcontent-%COMP%]   .filter-monster-menu.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.monster-add[_ngcontent-%COMP%]   .filter-monster-menu.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.monster-add[_ngcontent-%COMP%]   .filter-monster-menu[_ngcontent-%COMP%] + .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%], .monster-add[_ngcontent-%COMP%]   .filter-monster-menu[_ngcontent-%COMP%] + .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]:not(sticky):first-child{padding-top:calc(var(--ghs-unit) * 14 * var(--ghs-dialog-factor))}.monster-add[_ngcontent-%COMP%]   .filter-monster-menu.all-editions[_ngcontent-%COMP%] + .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%], .monster-add[_ngcontent-%COMP%]   .filter-monster-menu.all-editions[_ngcontent-%COMP%] + .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]:not(sticky):first-child{padding-top:calc(var(--ghs-unit) * 17 * var(--ghs-dialog-factor))}.monster-add[_ngcontent-%COMP%]   .bosses[_ngcontent-%COMP%] > .boss[_ngcontent-%COMP%]:not(:nth-child(2)){margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1 * var(--ghs-dialog-factor)) solid var(--ghs-color-gray)}.monster-add[_ngcontent-%COMP%]   .bosses[_ngcontent-%COMP%] > .boss[_ngcontent-%COMP%] ~ .boss[_ngcontent-%COMP%]{margin-top:0;border-top:none}.monster-add[_ngcontent-%COMP%]   .bosses[_ngcontent-%COMP%]   .boss-icon[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));background-color:var(--ghs-color-darkred);border:2px solid var(--ghs-color-gray);border-radius:100%;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.monster-add[_ngcontent-%COMP%]   .bosses[_ngcontent-%COMP%]   .boss-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));height:auto}.monster-add[_ngcontent-%COMP%]   .bosses[_ngcontent-%COMP%]   .hidden-icon[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));filter:var(--ghs-filter-gray)}.monster-add[_ngcontent-%COMP%]   .hidden-monster[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-style:italic;font-size:calc(var(--ghs-unit) * 2.7 * var(--ghs-dialog-factor))}"]})}return i})();class hc{name;spoiler=!0;constructor(r){this.name=r}}const gW=(i,r,e)=>({current:i,blocked:r,locked:e}),dW=i=>[i],_c=()=>[],hW=i=>({disabled:i}),_W=(i,r)=>r.edition+"-"+r.index;function mW(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",8)(1,"input",17),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.customScenarioName(n))}),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("value",e.gameManager.game.scenario.name)("ghs-label","scenario.title")("ghs-label-attribute","placeholder")}}function pW(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",9)(1,"div",8)(2,"a",18),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.resetScenario())}),t.EFF(3,"<"),t.nrm(4,"span",7),t.EFF(5,"!>"),t.k0s()()()}2&i&&(t.R7$(4),t.Y8G("ghs-label","scenario.reset"))}function uW(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",19),t.bIt("change",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.setEdition(n))}),t.k0s(),t.nrm(2,"span",7),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.R7$(),t.Y8G("value",e)("checked",a.edition==e),t.R7$(),t.Y8G("ghs-label","data.edition."+e)}}function fW(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",6),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.settingsManager.toggle("showOnlyUnfinishedScenarios"))}),t.k0s(),t.nrm(2,"span",7),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("checked",e.settingsManager.settings.showOnlyUnfinishedScenarios),t.R7$(),t.Y8G("ghs-label","scenario.filterSuccess")}}function CW(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",20),t.nrm(1,"label",7),t.j41(2,"a",13),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.scenarioChart(n))}),t.nrm(3,"img",14),t.k0s()()}if(2&i){const e=t.XpG().$implicit;t.R7$(),t.Y8G("ghs-label","data.scenario.group."+e),t.R7$(),t.Y8G("ghs-tooltip","scenario.chart")}}function MW(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function vW(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function OW(i,r){if(1&i&&(t.nVh(0,MW,2,0,"span"),t.nVh(1,vW,2,0,"span"),t.j41(2,"span",29),t.EFF(3),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG().$implicit,n=t.XpG();t.vxM(n.maxScenario(a)>2&&e.index.length<3?0:-1),t.R7$(),t.vxM(n.maxScenario(a)>1&&e.index.length<2?1:-1),t.R7$(2),t.JRh(e.index)}}function PW(i,r){1&i&&t.nrm(0,"img",30)}function bW(i,r){1&i&&t.nrm(0,"img",31)}function kW(i,r){if(1&i&&(t.j41(0,"span",24),t.Z7z(1,PW,1,0,"img",30,t.fX1),t.nI1(3,"ghsRange"),t.Z7z(4,bW,1,0,"img",31,t.fX1),t.nI1(6,"ghsRange"),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.Dyx(t.i5U(3,0,t.lJ4(6,_c),e.complexity)),t.R7$(3),t.Dyx(t.i5U(6,3,t.lJ4(7,_c),3-e.complexity))}}function yW(i,r){if(1&i&&t.nrm(0,"img",25),2&i){const e=t.XpG().$implicit,a=t.XpG(2);t.Y8G("src",a.gameManager.characterManager.characterIcon(e.solo),t.B4B)}}function xW(i,r){1&i&&(t.j41(0,"span",26),t.nrm(1,"img",32),t.k0s())}function EW(i,r){1&i&&(t.j41(0,"span",27),t.nrm(1,"img",33),t.k0s())}function wW(i,r){1&i&&(t.j41(0,"span",28),t.nrm(1,"img",33),t.k0s())}function RW(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",23),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.setScenario(n))}),t.nVh(1,OW,4,3),t.nVh(2,kW,7,8,"span",24),t.nVh(3,yW,1,1,"img",25),t.nVh(4,xW,2,0,"span",26),t.nVh(5,EW,2,0,"span",27),t.nVh(6,wW,2,0,"span",28),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(2);t.Y8G("ngClass",t.sMw(9,gW,a.gameManager.scenarioManager.isCurrent(e),e.isBlocked,e.isLocked))("ghs-tooltip","scenario.tooltip"+(e.isBlocked?".blocked":e.isLocked?".locked":""))("ghs-label-args",t.eq3(13,dW,a.gameManager.scenarioManager.scenarioTitle(e))),t.R7$(),t.vxM(e.solo?-1:1),t.R7$(),t.vxM(e.complexity?2:-1),t.R7$(),t.vxM(e.solo?3:-1),t.R7$(),t.vxM(a.gameManager.scenarioManager.isSuccess(e)?4:-1),t.R7$(),t.vxM(e.isBlocked?5:-1),t.R7$(),t.vxM(!e.isBlocked&&e.isLocked?6:-1)}}function jW(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",8)(1,"a",18),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.settingsManager.addSpoilers(o.notSpoiled(n)))}),t.nrm(2,"span",7),t.k0s()()}2&i&&(t.R7$(2),t.Y8G("ghs-label","spoiler.all"))}function GW(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",34)(1,"label"),t.nrm(2,"span",7),t.k0s()(),t.j41(3,"div",8)(4,"span",35)(5,"input",36,1),t.bIt("keyup",function(){t.eBV(e);const n=t.sdS(6);return t.Njj(n.classList.remove("error"))})("keyup.enter",function(){t.eBV(e);const n=t.sdS(6),o=t.XpG().$implicit,g=t.XpG();return t.Njj(g.manualScenario(n,o))}),t.k0s(),t.j41(7,"span",37),t.bIt("click",function(){t.eBV(e);const n=t.sdS(6),o=t.XpG().$implicit,g=t.XpG();return t.Njj(g.manualScenario(n,o))}),t.k0s()()()}if(2&i){const e=t.sdS(6);t.R7$(2),t.Y8G("ghs-label","scenario.manual.add"),t.R7$(3),t.Y8G("ghs-label","scenario.manual.index")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-label","scenario.manual.add")("ghs-label-attribute","title")("ngClass",t.eq3(6,hW,!e.value||e.classList.contains("error")))}}function TW(i,r){if(1&i&&(t.nVh(0,CW,4,2,"div",20),t.j41(1,"div",21),t.Z7z(2,RW,7,15,"span",22,_W),t.nI1(4,"ghsScenarioSearch"),t.k0s(),t.nVh(5,jW,3,1,"div",8),t.nVh(6,GW,8,8)),2&i){const e=r.$implicit,a=t.XpG(),n=t.sdS(16);t.vxM(e?0:-1),t.R7$(2),t.Dyx(t.i5U(4,3,a.scenarios(e,a.gameManager.game.party.campaignMode&&a.settingsManager.settings.showOnlyUnfinishedScenarios),n.value)),t.R7$(3),t.vxM(a.hasSpoilers(e)?5:-1),t.R7$(),t.vxM(a.gameManager.game.party.campaignMode&&a.scenarios(e).length<a.scenarios(e,!1,!0,!0).length?6:-1)}}let SW=(()=>{class i{dialog;close=new t.bkB;gameManager=s.E;settingsManager=m.f;GameState=T.mk;edition="";editions=[];groups=[];hasRandom=!1;constructor(e){this.dialog=e}scenarioCache=[];ngOnInit(){this.edition=s.E.game.scenario&&!s.E.game.scenario.custom&&s.E.game.scenario.edition||!s.E.game.edition&&(!s.E.game.scenario||!s.E.game.scenario.custom)&&s.E.game.party.scenarios.length>0&&s.E.game.party.scenarios[s.E.game.party.scenarios.length-1].edition||s.E.currentEdition(),this.updateGroups(),this.setEditions(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.scenarioCache=[],this.setEditions()}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}setEditions(){this.editions=s.E.game.edition?[s.E.game.edition,...s.E.editionExtensions(s.E.game.edition),...s.E.editionScenarioExtensions(s.E.game.edition)]:s.E.editionData.filter(e=>e.scenarios&&e.scenarios.filter(a=>a.edition==e.edition&&-1!=m.f.settings.editions.indexOf(a.edition)).length>0).map(e=>e.edition),this.hasRandom=this.edition&&null!=s.E.sectionData(this.edition).find(e=>"randomMonsterCard"==e.group)||!1}setEdition(e){this.edition=e,this.updateGroups(),this.setEditions()}updateGroups(){this.edition||(this.groups=[]);const e=s.E.scenarioManager.scenarioData(this.edition,!0).map(a=>a.group).filter((a,n,o)=>a&&o.indexOf(a)===n).sort((a,n)=>a&&n&&(a.toLowerCase()<n.toLowerCase()?-1:1)||0);this.groups=[void 0,...e]}scenarios(e=void 0,a=!1,n=!1,o=!1){if(!this.edition)return[];let g=this.scenarioCache.find(_=>_.edition==this.edition&&_.group==e&&_.filterSuccess==a&&_.includeSpoiler==n&&_.all==o);return g||(g={edition:this.edition,group:e,filterSuccess:a,includeSpoiler:n,all:o,scenarios:[]},g.scenarios=s.E.scenarioManager.scenarioData(this.edition,o).filter(_=>_.group==e&&(n||!_.spoiler||-1!=s.E.game.unlockedCharacters.indexOf(_.edition+":"+_.name)||_.solo&&-1!=s.E.game.unlockedCharacters.indexOf(_.edition+":"+_.solo))&&(!a||!s.E.scenarioManager.isSuccess(_)&&!s.E.scenarioManager.isBlocked(_))).sort(s.E.scenarioManager.sortScenarios).map(_=>new ht.jW(_,s.E.scenarioManager.isSuccess(_),s.E.scenarioManager.isBlocked(_),s.E.scenarioManager.isLocked(_))),this.scenarioCache.push(g)),g.scenarios}maxScenario(e){return Math.max(...this.scenarios(e).map(a=>a.index.length))}setScenario(e){s.E.scenarioManager.isCurrent(e)||(s.E.scenarioManager.isLocked(e)?this.dialog.open(Mi,{panelClass:["dialog"],data:{scenarioData:e}}):(s.E.stateManager.before("setScenario",...s.E.scenarioManager.scenarioUndoArgs(new ht.Nz(e))),s.E.scenarioManager.setScenario(e),s.E.stateManager.after()),this.close.emit())}resetScenario(){s.E.game.scenario&&(s.E.stateManager.before("resetScenario",...s.E.scenarioManager.scenarioUndoArgs()),s.E.roundManager.resetScenario(),s.E.scenarioManager.setScenario(s.E.game.scenario),this.close.emit(),s.E.stateManager.after())}customScenario(){s.E.game.scenario&&s.E.game.scenario.custom?(s.E.stateManager.before("unsetCustomScenario"),s.E.scenarioManager.setScenario(void 0),this.edition=s.E.game.edition||s.E.editions()[0],s.E.stateManager.after()):(s.E.stateManager.before("setCustomScenario"),s.E.scenarioManager.setScenario(s.E.scenarioManager.createScenario()),s.E.stateManager.after())}customScenarioName(e){s.E.game.scenario&&s.E.game.scenario.custom&&(s.E.stateManager.before("changeCustomScenario",e.target.value),s.E.game.scenario.name=e.target.value,s.E.stateManager.after())}randomScenario(){const e=(0,V.Z)(s.E.sectionData(this.edition).filter(n=>"randomMonsterCard"==n.group));if(e.length<3)return;s.E.stateManager.before("setRandomScenario");const a=s.E.scenarioManager.createScenario();a.name="%scenario.random%",a.additionalSections=e.slice(0,3).map(n=>n.index),s.E.scenarioManager.setScenario(void 0),s.E.scenarioManager.setScenario(a),s.E.scenarioManager.addSection(e[0]),s.E.stateManager.after()}manualScenario(e,a){e.classList.add("error");const n=s.E.scenarioData(this.edition).filter(g=>g.group==a);let o=e.value.split(",");o.forEach(g=>g.trim()),e.value.split(",").forEach(g=>{const _=n.find(y=>y.index==g.trim()&&y.group==a);_?(this.scenarios(a).find(y=>y.edition==_.edition&&y.group==_.group&&y.index==_.index)||(s.E.stateManager.before("addManualScenario",...s.E.scenarioManager.scenarioUndoArgs(new ht.Nz(_))),s.E.game.party.manualScenarios.push(new ht.Ag(_.index,_.edition,_.group)),s.E.stateManager.after()),o=o.filter(y=>y.trim()!=g)):n.find(y=>y.index.substring(0,y.index.length-1)==g.trim()&&y.index.substring(y.index.length-1).match(/[A-B]/)&&y.group==a)&&(n.filter(y=>y.index.substring(0,y.index.length-1)==g.trim()&&y.index.substring(y.index.length-1).match(/[A-B]/)&&y.group==a).forEach(y=>{this.scenarios(a).find(B=>B.edition==y.edition&&B.group==y.group&&B.index==y.index)||(s.E.stateManager.before("addManualScenario",...s.E.scenarioManager.scenarioUndoArgs(new ht.Nz(y))),s.E.game.party.manualScenarios.push(new ht.Ag(y.index,y.edition,y.group)),s.E.stateManager.after())}),o=o.filter(y=>y.trim()!=g))}),0==o.length?(e.classList.remove("error"),e.value=""):e.value=o.join(","),this.scenarioCache=[]}hasSpoilers(e){return this.scenarios(e,!0).some(a=>a.spoiler&&(!a.solo&&-1==s.E.game.unlockedCharacters.indexOf(a.edition+":"+a.name)||a.solo&&-1==s.E.game.unlockedCharacters.indexOf(a.edition+":"+a.solo)))}notSpoiled(e){return this.scenarios(e,!0).filter(a=>a.spoiler&&(-1==s.E.game.unlockedCharacters.indexOf(a.edition+":"+a.name)||a.solo&&-1==s.E.game.unlockedCharacters.indexOf(a.edition+":"+a.solo))).map(a=>a.solo&&new hc(a.solo)||new hc(a.name))}toggleCampaignMode(){s.E.stateManager.before(s.E.game.party.campaignMode?"disablePartyCampaignMode":"enablePartyCampaignMode"),s.E.game.party.campaignMode=!s.E.game.party.campaignMode,this.scenarioCache=[],s.E.stateManager.after()}scenarioChart(e=void 0){this.dialog.open(Qn,{panelClass:["fullscreen-panel"],backdropClass:["fullscreen-backdrop"],data:{edition:this.edition,group:e}}),this.close.emit()}static \u0275fac=function(a){return new(a||i)(t.rXU(v.lG))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-scenario-menu"]],outputs:{close:"close"},standalone:!1,decls:26,vars:10,consts:[["search",""],["manualScenarioIndex",""],[1,"menu-container","scenario"],[1,"columns"],[1,"column","custom-container"],[1,"line","custom-check"],["tabclick","","type","checkbox",3,"change","checked"],[3,"ghs-label"],[1,"line"],[1,"column"],[1,"line","editions"],[1,"line","search"],["type","text",3,"ghs-label","ghs-label-attribute"],[3,"click","ghs-tooltip"],["src","./assets/images/chart.svg",1,"ghs-svg"],[1,"line","campaign"],["type","checkbox",3,"change","checked"],["type","text",3,"change","value","ghs-label","ghs-label-attribute"],["tabclick","",3,"click"],["tabclick","","type","radio","name","radio",3,"change","value","checked"],[1,"line","title","group"],[1,"line","scenarios"],["tabclick","",1,"scenario",3,"ngClass","ghs-tooltip","ghs-label-args"],["tabclick","",1,"scenario",3,"click","ngClass","ghs-tooltip","ghs-label-args"],[1,"complexity"],[1,"ghs-svg","solo",3,"src"],[1,"state","success"],[1,"state","blocked"],[1,"state","locked"],[1,"index"],["src","./assets/images/scenario/complexity-full.svg"],["src","./assets/images/scenario/complexity.svg"],["src","./assets/images/check.svg"],["src","./assets/images/close.svg"],[1,"line","title"],[1,"input-button"],["tabclick","","type","text",3,"keyup","keyup.enter","ghs-label","ghs-label-attribute"],["tabclick","",1,"add-button",3,"click","ghs-label","ghs-label-attribute","ngClass"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"label")(5,"input",6),t.bIt("change",function(){return t.eBV(o),t.Njj(n.customScenario())}),t.k0s(),t.EFF(6," <"),t.nrm(7,"span",7),t.EFF(8,"> "),t.k0s()(),t.nVh(9,mW,2,3,"div",8),t.k0s(),t.nVh(10,pW,6,1,"div",9),t.k0s(),t.j41(11,"div",10),t.Z7z(12,uW,3,3,"label",null,t.fX1),t.k0s(),t.j41(14,"div",11),t.nrm(15,"input",12,0),t.j41(17,"a",13),t.bIt("click",function(){return t.eBV(o),t.Njj(n.scenarioChart())}),t.nrm(18,"img",14),t.k0s()(),t.j41(19,"div",15),t.nVh(20,fW,3,2,"label"),t.j41(21,"label")(22,"input",16),t.bIt("change",function(){return t.eBV(o),t.Njj(n.toggleCampaignMode())}),t.k0s(),t.nrm(23,"span",7),t.k0s()(),t.Z7z(24,TW,7,6,null,null,t.fX1),t.k0s()}2&a&&(t.R7$(5),t.Y8G("checked",!!n.gameManager.game.scenario&&n.gameManager.game.scenario.custom),t.R7$(2),t.Y8G("ghs-label","scenario.custom"),t.R7$(2),t.vxM(n.gameManager.game.scenario&&n.gameManager.game.scenario.custom?9:-1),t.R7$(),t.vxM(n.gameManager.game.scenario&&!n.gameManager.game.scenario.custom?10:-1),t.R7$(2),t.Dyx(n.editions),t.R7$(3),t.Y8G("ghs-label","scenario.filter")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ghs-tooltip","scenario.chart"),t.R7$(3),t.vxM(n.gameManager.game.party.campaignMode?20:-1),t.R7$(2),t.Y8G("checked",n.gameManager.game.party.campaignMode),t.R7$(),t.Y8G("ghs-label","party.campaignMode"),t.R7$(),t.Dyx(n.groups))},dependencies:[N.YU,tt,ft,At,Tt,hh],styles:['[_nghost-%COMP%]{position:relative;z-index:9999}.hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:break-spaces}.back[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled[_ngcontent-%COMP%]{pointer-events:none}.back.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container[_ngcontent-%COMP%]{z-index:1}.menu-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.no-grow[_ngcontent-%COMP%]{flex-grow:0}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container.inline[_ngcontent-%COMP%]{width:initial;margin-right:1em}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex-wrap:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-gray)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{filter:grayscale(1)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm-delete[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]{align-items:flex-start}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]   .undo-text[_ngcontent-%COMP%]{display:flex;align-items:center}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.redo[_ngcontent-%COMP%]{align-items:flex-end}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]:hover{opacity:.7}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover{cursor:pointer}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog.disabled[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)!important}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]{border-bottom:none;margin-bottom:0}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container[_ngcontent-%COMP%]   .line.sticky.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container[_ngcontent-%COMP%]   .line.sticky.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .add[_ngcontent-%COMP%]{display:inherit}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%] ~ .spoiler[_ngcontent-%COMP%]{margin-top:0;border-top:none}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]{display:flex;cursor:pointer}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]   .span-xs[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns.columns-break[_ngcontent-%COMP%]{flex-wrap:wrap}}',".custom-container[_ngcontent-%COMP%]{display:flex}.custom-container[_ngcontent-%COMP%]   .custom-check[_ngcontent-%COMP%]{flex-basis:0}.editions[_ngcontent-%COMP%]{display:grid!important;grid-template-columns:1fr 1fr}.line.campaign[_ngcontent-%COMP%]{display:flex}.line.campaign[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor))}.line.search[_ngcontent-%COMP%], .line.title.group[_ngcontent-%COMP%]{justify-content:space-between!important}.line.search[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%], .line.title.group[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray)}.line.search[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%], .line.title.group[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)}.scenarios[_ngcontent-%COMP%]{display:grid!important;grid-template-columns:repeat(6,1fr);column-gap:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));row-gap:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]{cursor:pointer;position:relative;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);border-radius:100%;border:calc(var(--ghs-unit) / 5) transparent solid}.scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-white) solid;color:var(--ghs-color-white)}.scenarios[_ngcontent-%COMP%]   .scenario.current[_ngcontent-%COMP%]{cursor:initial;border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;color:var(--ghs-color-disabled)}.scenarios[_ngcontent-%COMP%]   .scenario.blocked[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.scenarios[_ngcontent-%COMP%]   .scenario.blocked[_ngcontent-%COMP%]:hover{border-color:var(--ghs-color-darkred)}.scenarios[_ngcontent-%COMP%]   .scenario.locked[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.scenarios[_ngcontent-%COMP%]   .scenario.locked[_ngcontent-%COMP%]:hover{border-color:var(--ghs-color-yellow)}.scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   img.solo[_ngcontent-%COMP%]{filter:none}.scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;position:absolute;top:50%;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));transform:translateY(-50%)}.scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .state.success[_ngcontent-%COMP%]{left:0;filter:var(--ghs-filter-green) var(--ghs-filter-shadow)}.scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .state.blocked[_ngcontent-%COMP%]{right:0;filter:var(--ghs-filter-red) var(--ghs-filter-shadow)}.scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .state.locked[_ngcontent-%COMP%]{right:0;filter:var(--ghs-filter-yellow) var(--ghs-filter-shadow)}.scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .complexity[_ngcontent-%COMP%]{position:absolute;display:flex;justify-content:center;align-items:center;bottom:calc(var(--ghs-unit) * .3 * var(--ghs-dialog-factor))}.scenarios[_ngcontent-%COMP%]   .scenario[_ngcontent-%COMP%]   .complexity[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));filter:var(--ghs-filter-gray)}.input-button[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}@media (max-width: 600px),(orientation: portrait){.editions[_ngcontent-%COMP%]{grid-template-columns:1fr}.scenarios[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}}"]})}return i})();const $W=(i,r)=>({disabled:i,available:r}),DW=i=>[i],IW=(i,r)=>r.edition+"-"+r.index;function AW(i,r){if(1&i){const e=t.RV6();t.j41(0,"label")(1,"input",6),t.bIt("change",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.edition=n)}),t.k0s(),t.nrm(2,"span",4),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG();t.R7$(),t.Y8G("value",e)("checked",a.edition==e),t.R7$(),t.Y8G("ghs-label","data.edition."+e)}}function VW(i,r){if(1&i&&(t.j41(0,"div",7),t.nrm(1,"label",4),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.Y8G("ghs-label","data.scenario.group."+e)}}function FW(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function XW(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"0"),t.k0s())}function BW(i,r){if(1&i){const e=t.RV6();t.j41(0,"span",10),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.addSection(n))}),t.nVh(1,FW,2,0,"span"),t.nVh(2,XW,2,0,"span"),t.EFF(3),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(3);t.Y8G("ngClass",t.l_i(6,$W,e.isLocked,a.settingsManager.settings.showAllSections&&e.parent&&!!a.gameManager.game.scenario&&e.parent==a.gameManager.game.scenario.index&&e.group==a.gameManager.game.scenario.group&&e.edition==a.gameManager.game.scenario.edition))("ghs-tooltip","scenario.tooltip")("ghs-label-args",t.eq3(9,DW,a.gameManager.scenarioManager.scenarioTitle(e,!0))),t.R7$(),t.vxM(a.maxSection()>2&&e.index.length<3?1:-1),t.R7$(),t.vxM(a.maxSection()>1&&e.index.length<2?2:-1),t.R7$(),t.SpI(" ",e.index," ")}}function YW(i,r){if(1&i&&(t.j41(0,"div",8),t.Z7z(1,BW,4,11,"span",9,IW),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG();t.R7$(),t.Dyx(a.sections(e))}}function NW(i,r){if(1&i&&(t.nVh(0,VW,2,1,"div",7),t.nVh(1,YW,3,0,"div",8)),2&i){const e=r.$implicit,a=t.XpG();t.vxM(e&&a.sections(e).length>0?0:-1),t.R7$(),t.vxM(a.sections(e).length>0?1:-1)}}function zW(i,r){1&i&&(t.j41(0,"div",5)(1,"label"),t.nrm(2,"span",4),t.k0s()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","monster.filter.noResult"))}let LW=(()=>{class i{gameManager=s.E;settingsManager=m.f;GameState=T.mk;edition="";editions=[];sectionCache=[];ngOnInit(){this.edition=s.E.game.scenario&&!s.E.game.scenario.custom&&s.E.game.scenario.edition||!s.E.game.edition&&(!s.E.game.scenario||!s.E.game.scenario.custom)&&s.E.game.party.scenarios.length>0&&s.E.game.party.scenarios[s.E.game.party.scenarios.length-1].edition||s.E.currentEdition(),this.setEditions(),this.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{this.setEditions(),this.sectionCache=[]}})}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}setEditions(){this.editions=s.E.game.edition?[s.E.game.edition,...s.E.editionExtensions(s.E.game.edition),...s.E.editionScenarioExtensions(s.E.game.edition)]:s.E.editionData.filter(e=>e.sections&&e.sections.filter(a=>a.edition==e.edition&&-1!=m.f.settings.editions.indexOf(a.edition)).length>0).map(e=>e.edition)}groups(){return this.edition?s.E.sectionData().filter(e=>e.edition==this.edition).map(e=>e.group).filter((e,a,n)=>n.indexOf(e)===a):[]}sections(e=void 0){if(!this.edition)return[];let a=this.sectionCache.find(n=>n.edition==this.edition&&n.group==e&&n.all==m.f.settings.showAllSections);return a||(a={edition:this.edition,group:e,all:m.f.settings.showAllSections,sections:[]},a.sections=s.E.sectionData().filter(n=>(m.f.settings.showAllSections||!n.parent&&(!s.E.game.scenario||s.E.game.scenario.custom)||s.E.game.scenario&&-1!=s.E.scenarioManager.availableSections(!1,!0).indexOf(n))&&n.edition==this.edition&&n.group==e&&!n.conclusion).sort(s.E.scenarioManager.sortScenarios).map(n=>new ht.jW(n,!1,!1,this.hasSection(n))),this.sectionCache.push(a)),a.sections}noResults(){return this.sectionCache.filter(e=>e.edition==this.edition).every(e=>0==e.sections.length)}maxSection(){return Math.max(...this.sections().map(e=>e.index.length))}hasSection(e){return s.E.game.sections&&s.E.game.sections.some(a=>a.edition==e.edition&&a.index==e.index&&a.group==e.group)}addSection(e){s.E.stateManager.before("addSection",e.index,s.E.scenarioManager.scenarioTitle(e,!0),"data.edition."+e.edition),s.E.scenarioManager.addSection(e),s.E.stateManager.after()}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-section-menu"]],standalone:!1,decls:11,vars:3,consts:[[1,"menu-container","scenario"],[1,"line","editions"],[1,"line"],["tabclick","","type","checkbox",3,"change","checked"],[3,"ghs-label"],[1,"line","disabled"],["tabclick","","type","radio","name","radio",3,"change","value","checked"],[1,"line","title"],[1,"line","sections"],["tabclick","",1,"section",3,"ngClass","ghs-tooltip","ghs-label-args"],["tabclick","",1,"section",3,"click","ngClass","ghs-tooltip","ghs-label-args"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1),t.Z7z(2,AW,3,3,"label",null,t.fX1),t.k0s(),t.j41(4,"div",2)(5,"label")(6,"input",3),t.bIt("change",function(){return n.settingsManager.toggle("showAllSections")}),t.k0s(),t.nrm(7,"span",4),t.k0s()(),t.Z7z(8,NW,2,2,null,null,t.fX1),t.nVh(10,zW,3,1,"div",5),t.k0s()),2&a&&(t.R7$(2),t.Dyx(n.editions),t.R7$(4),t.Y8G("checked",n.settingsManager.settings.showAllSections),t.R7$(),t.Y8G("ghs-label","scenario.showAllSections"),t.R7$(),t.Dyx(n.groups()),t.R7$(2),t.vxM(n.noResults()?10:-1))},dependencies:[N.YU,tt,ft,At],styles:['[_nghost-%COMP%]{position:relative;z-index:9999}.hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:break-spaces}.back[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled[_ngcontent-%COMP%]{pointer-events:none}.back.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container[_ngcontent-%COMP%]{z-index:1}.menu-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.no-grow[_ngcontent-%COMP%]{flex-grow:0}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container.inline[_ngcontent-%COMP%]{width:initial;margin-right:1em}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex-wrap:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-gray)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{filter:grayscale(1)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm-delete[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]{align-items:flex-start}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]   .undo-text[_ngcontent-%COMP%]{display:flex;align-items:center}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.redo[_ngcontent-%COMP%]{align-items:flex-end}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]:hover{opacity:.7}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover{cursor:pointer}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog.disabled[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)!important}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]{border-bottom:none;margin-bottom:0}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container[_ngcontent-%COMP%]   .line.sticky.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container[_ngcontent-%COMP%]   .line.sticky.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .add[_ngcontent-%COMP%]{display:inherit}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%] ~ .spoiler[_ngcontent-%COMP%]{margin-top:0;border-top:none}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]{display:flex;cursor:pointer}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]   .span-xs[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns.columns-break[_ngcontent-%COMP%]{flex-wrap:wrap}}',".custom-container[_ngcontent-%COMP%]{display:flex}.custom-container[_ngcontent-%COMP%]   .custom-check[_ngcontent-%COMP%]{flex-basis:0}.editions[_ngcontent-%COMP%]{display:grid!important;grid-template-columns:1fr 1fr}.sections[_ngcontent-%COMP%]{display:grid!important;grid-template-columns:repeat(6,1fr);column-gap:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));row-gap:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;justify-content:center;height:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 7 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);border-radius:100%}.sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:hover{border:calc(var(--ghs-unit) / 5) var(--ghs-color-white) solid;color:var(--ghs-color-white)}.sections[_ngcontent-%COMP%]   .section.available[_ngcontent-%COMP%]{border:calc(var(--ghs-unit) / 5) var(--ghs-color-disabled) solid}.sections[_ngcontent-%COMP%]   .section.disabled[_ngcontent-%COMP%]{pointer-events:none;border:calc(var(--ghs-unit) / 5) var(--ghs-color-gray) solid;color:var(--ghs-color-disabled)}@media (max-width: 600px),(orientation: portrait){.editions[_ngcontent-%COMP%]{grid-template-columns:1fr}.sections[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}}"]})}return i})();var Ni=M(73391);const ho=i=>({hidden:i}),mc=i=>({separator:i}),ce=i=>({disabled:i}),pc=(i,r)=>[i,r],uc=(i,r)=>r.edition+"-"+r.name;function UW(i,r){1&i&&(t.j41(0,"p"),t.nrm(1,"span",9),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","server.connected"))}function qW(i,r){1&i&&(t.j41(0,"p"),t.nrm(1,"span",9),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","server.connecting"))}function HW(i,r){1&i&&(t.j41(0,"p"),t.nrm(1,"span",9),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","server.closing"))}function KW(i,r){1&i&&(t.j41(0,"p"),t.nrm(1,"span",9),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","server.closed"))}function WW(i,r){1&i&&(t.j41(0,"p"),t.nrm(1,"span",9),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","server.disconnected"))}function JW(i,r){1&i&&(t.j41(0,"p"),t.nrm(1,"span",9),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","server.undefined"))}function ZW(i,r){if(1&i&&(t.j41(0,"option",28),t.EFF(1),t.k0s()),2&i){const e=r.$implicit,a=r.$index,n=t.XpG(2);t.Y8G("value",a)("selected",n.selectedServerIndex==a),t.R7$(),t.SpI(" ",e.url," ")}}function QW(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",14)(1,"select",27),t.bIt("change",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.selectServer(n))}),t.j41(2,"option"),t.nrm(3,"span",9),t.k0s(),t.Z7z(4,ZW,2,3,"option",28,t.fX1),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(3),t.Y8G("ghs-label","server.list."+(-1==e.selectedServerIndex?"select":"deselect")),t.R7$(),t.Dyx(e.publicServer)}}function tJ(i,r){if(1&i&&(t.j41(0,"label"),t.nrm(1,"span",9),t.k0s(),t.j41(2,"p")(3,"a",29),t.EFF(4),t.k0s()()),2&i){const e=r.$implicit;t.R7$(),t.Y8G("ghs-label","server.info."+e.key),t.R7$(2),t.Y8G("href",e.value,t.B4B),t.R7$(),t.JRh(e.value.replace("http://","").replace("https://",""))}}function eJ(i,r){1&i&&(t.j41(0,"span",31),t.nrm(1,"span",9),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","server.info.version.unknown"))}function nJ(i,r){1&i&&(t.j41(0,"span",32),t.nrm(1,"span",9),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","server.info.version.latest"))}function iJ(i,r){if(1&i&&(t.j41(0,"span",33),t.nrm(1,"span",34),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("ghs-label","server.info.version.update")("ghs-label-args",t.l_i(2,pc,e.serverUpdateVersion.version,e.serverUpdateVersion.url))}}function aJ(i,r){if(1&i&&(t.j41(0,"label"),t.nrm(1,"span",9),t.k0s(),t.j41(2,"div",30)(3,"span"),t.EFF(4),t.k0s(),t.nVh(5,eJ,2,1,"span",31),t.nVh(6,nJ,2,1,"span",32),t.nVh(7,iJ,2,5,"span",33),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","server.info.version"),t.R7$(3),t.JRh(e.gameManager.stateManager.serverVersion),t.R7$(),t.vxM(e.serverUpdateVersion?-1:5),t.R7$(),t.vxM(e.serverUpdateVersion&&e.serverUpdateVersion.latest?6:-1),t.R7$(),t.vxM(e.serverUpdateVersion&&!e.serverUpdateVersion.latest?7:-1)}}function oJ(i,r){if(1&i&&(t.j41(0,"div",15)(1,"label"),t.nrm(2,"span",9),t.k0s(),t.j41(3,"p"),t.EFF(4),t.k0s(),t.j41(5,"label"),t.nrm(6,"span",9),t.k0s(),t.j41(7,"p"),t.EFF(8),t.k0s(),t.Z7z(9,tJ,5,3,null,null,t.fX1),t.nI1(11,"keyvalue"),t.j41(12,"label"),t.nrm(13,"span",9),t.k0s(),t.j41(14,"p"),t.EFF(15),t.k0s(),t.j41(16,"label"),t.nrm(17,"span",9),t.k0s(),t.j41(18,"p"),t.EFF(19),t.k0s(),t.nVh(20,aJ,8,5),t.k0s()),2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","server.url"),t.R7$(2),t.JRh(e.publicServer[e.selectedServerIndex].url),t.R7$(2),t.Y8G("ghs-label","server.port"),t.R7$(2),t.JRh(e.publicServer[e.selectedServerIndex].port),t.R7$(),t.Dyx(t.bMT(11,9,e.publicServer[e.selectedServerIndex].urls)),t.R7$(4),t.Y8G("ghs-label","server.info.description"),t.R7$(2),t.JRh(e.publicServer[e.selectedServerIndex].description),t.R7$(2),t.Y8G("ghs-label","server.info.location"),t.R7$(2),t.JRh(e.publicServer[e.selectedServerIndex].location),t.R7$(),t.vxM(e.gameManager.stateManager.serverVersion&&e.gameManager.stateManager.wsState()==e.WebSocket.OPEN?20:-1)}}function sJ(i,r){1&i&&(t.j41(0,"div",7)(1,"a",35),t.nrm(2,"span",9),t.k0s()()),2&i&&(t.R7$(2),t.Y8G("ghs-label","server.how-to-run"))}function rJ(i,r){if(1&i){const e=t.RV6();t.j41(0,"a",36),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.createUUID())}),t.nrm(1,"span",9),t.k0s()}2&i&&(t.R7$(),t.Y8G("ghs-label","server.code.uuid"))}function cJ(i,r){if(1&i&&(t.j41(0,"div",5)(1,"div",7)(2,"a",29),t.nrm(3,"span",9),t.k0s()()()),2&i){const e=t.XpG(),a=t.sdS(30),n=t.sdS(35);t.R7$(2),t.Y8G("href",e.gameManager.stateManager.buildWsUrl("https://",a.value,n.value),t.B4B),t.R7$(),t.Y8G("ghs-label","server.wss.accept")}}function lJ(i,r){1&i&&(t.j41(0,"span",31),t.nrm(1,"span",9),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","server.info.version.unknown"))}function gJ(i,r){1&i&&(t.j41(0,"span",32),t.nrm(1,"span",9),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","server.info.version.latest"))}function dJ(i,r){if(1&i&&(t.j41(0,"span",33),t.nrm(1,"span",34),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ghs-label","server.info.version.update")("ghs-label-args",t.l_i(2,pc,e.serverUpdateVersion.version,e.serverUpdateVersion.url))}}function hJ(i,r){if(1&i&&(t.j41(0,"div",15)(1,"label"),t.nrm(2,"span",9),t.k0s(),t.j41(3,"div",30)(4,"span"),t.EFF(5),t.k0s(),t.nVh(6,lJ,2,1,"span",31),t.nVh(7,gJ,2,1,"span",32),t.nVh(8,dJ,2,5,"span",33),t.k0s()()),2&i){const e=t.XpG();t.R7$(2),t.Y8G("ghs-label","server.info.version"),t.R7$(3),t.JRh(e.gameManager.stateManager.serverVersion),t.R7$(),t.vxM(e.serverUpdateVersion?-1:6),t.R7$(),t.vxM(e.serverUpdateVersion&&e.serverUpdateVersion.latest?7:-1),t.R7$(),t.vxM(e.serverUpdateVersion&&!e.serverUpdateVersion.latest?8:-1)}}function _J(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",5)(1,"div",7)(2,"a",37),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.disconnect())}),t.nrm(3,"span",9),t.k0s()()()}2&i&&(t.R7$(3),t.Y8G("ghs-label","server.disconnect"))}function mJ(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",38)(1,"label"),t.nrm(2,"span",9),t.k0s()(),t.j41(3,"div",7)(4,"p"),t.nrm(5,"span",9),t.k0s()(),t.j41(6,"div",7)(7,"a",37),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.createPermissions=!n.createPermissions)}),t.nrm(8,"span",9),t.k0s()()}2&i&&(t.R7$(2),t.Y8G("ghs-label","permissions"),t.R7$(3),t.Y8G("ghs-label","permissions.hasAll"),t.R7$(3),t.Y8G("ghs-label","permissions.create"))}function pJ(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",7)(1,"div",10)(2,"label")(3,"input",8),t.bIt("change",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.permissionsAll(n))}),t.k0s(),t.nrm(4,"span",9),t.k0s(),t.nrm(5,"img",11),t.j41(6,"span",12)(7,"span",39),t.nrm(8,"span",9),t.k0s()()()(),t.j41(9,"div",7)(10,"div",10)(11,"label")(12,"input",8),t.bIt("change",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.permissionsCustom(n))}),t.k0s(),t.nrm(13,"span",9),t.k0s(),t.nrm(14,"img",11),t.j41(15,"span",12)(16,"span",39),t.nrm(17,"span",9),t.k0s()()()()}if(2&i){const e=t.XpG(2);t.R7$(3),t.Y8G("checked",!e.permissions),t.R7$(),t.Y8G("ghs-label","permissions.all"),t.R7$(4),t.Y8G("ghs-label","permissions.all.hint"),t.R7$(4),t.Y8G("checked",e.permissions),t.R7$(),t.Y8G("ghs-label","permissions.custom"),t.R7$(4),t.Y8G("ghs-label","permissions.custom.hint")}}function uJ(i,r){if(1&i&&(t.j41(0,"span",44),t.EFF(1,"\xa0["),t.nrm(2,"span",9),t.EFF(3,"]"),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG(4);t.R7$(2),t.Y8G("ghs-label","data.edition."+a.gameManager.getEdition(e))}}function fJ(i,r){if(1&i){const e=t.RV6();t.j41(0,"label",40)(1,"input",8),t.bIt("change",function(){const n=t.eBV(e).$implicit,o=t.XpG(4);return t.Njj(o.toggleCharacter(n))}),t.k0s(),t.EFF(2),t.nVh(3,uJ,4,1,"span",44),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(4);t.Y8G("ngClass",t.eq3(4,ce,a.gameManager.stateManager.permissions)),t.R7$(),t.Y8G("checked",a.hasCharacter(e)),t.R7$(),t.SpI(" ",a.gameManager.characterManager.characterName(e,!0)," "),t.R7$(),t.vxM(a.gameManager.getEdition(e)?3:-1)}}function CJ(i,r){if(1&i&&(t.j41(0,"div",41),t.Z7z(1,fJ,4,6,"label",40,uc),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.characters())}}function MJ(i,r){1&i&&(t.j41(0,"span",45),t.nrm(1,"span",9),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","game.ally"))}function vJ(i,r){1&i&&(t.j41(0,"span",46),t.nrm(1,"span",9),t.k0s()),2&i&&(t.R7$(),t.Y8G("ghs-label","game.allied"))}function OJ(i,r){if(1&i&&(t.j41(0,"span",44),t.EFF(1,"\xa0["),t.nrm(2,"span",9),t.EFF(3,"]"),t.k0s()),2&i){const e=t.XpG().$implicit,a=t.XpG(4);t.R7$(2),t.Y8G("ghs-label","data.edition."+a.gameManager.getEdition(e))}}function PJ(i,r){if(1&i){const e=t.RV6();t.j41(0,"label",40)(1,"input",8),t.bIt("change",function(){const n=t.eBV(e).$implicit,o=t.XpG(4);return t.Njj(o.toggleMonster(n))}),t.k0s(),t.nrm(2,"span",9),t.nVh(3,MJ,2,1,"span",45),t.nVh(4,vJ,2,1,"span",46),t.nVh(5,OJ,4,1,"span",44),t.k0s()}if(2&i){const e=r.$implicit,a=t.XpG(4);t.Y8G("ngClass",t.eq3(6,ce,a.gameManager.stateManager.permissions)),t.R7$(),t.Y8G("checked",a.hasMonster(e)),t.R7$(),t.Y8G("ghs-label","data.monster."+e.name),t.R7$(),t.vxM(e.isAlly?3:-1),t.R7$(),t.vxM(e.isAllied?4:-1),t.R7$(),t.vxM(a.gameManager.getEdition(e)?5:-1)}}function bJ(i,r){if(1&i&&(t.j41(0,"div",43),t.Z7z(1,PJ,6,8,"label",40,uc),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Dyx(e.monsters())}}function kJ(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",19)(1,"div",10)(2,"label",40)(3,"input",8),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.permissions.characters=!n.permissions.characters)}),t.k0s(),t.nrm(4,"span",9),t.k0s(),t.nrm(5,"img",11),t.j41(6,"span",12)(7,"span",39),t.nrm(8,"span",9),t.k0s()()()(),t.nVh(9,CJ,3,0,"div",41),t.j41(10,"div",7)(11,"div",10)(12,"label",40)(13,"input",42),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.permissions.monsters=!n.permissions.monsters)}),t.k0s(),t.nrm(14,"span",9),t.k0s(),t.nrm(15,"img",11),t.j41(16,"span",12)(17,"span",39),t.nrm(18,"span",9),t.k0s()()()(),t.nVh(19,bJ,3,0,"div",43),t.j41(20,"div",7)(21,"div",10)(22,"label",40)(23,"input",8),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.permissions.scenario=!n.permissions.scenario)}),t.k0s(),t.nrm(24,"span",9),t.k0s(),t.nrm(25,"img",11),t.j41(26,"span",12)(27,"span",39),t.nrm(28,"span",9),t.k0s()()()(),t.j41(29,"div",7)(30,"div",10)(31,"label",40)(32,"input",8),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.permissions.party=!n.permissions.party)}),t.k0s(),t.nrm(33,"span",9),t.k0s(),t.nrm(34,"img",11),t.j41(35,"span",12)(36,"span",39),t.nrm(37,"span",9),t.k0s()()()(),t.j41(38,"div",7)(39,"div",10)(40,"label",40)(41,"input",8),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.permissions.elements=!n.permissions.elements)}),t.k0s(),t.nrm(42,"span",9),t.k0s(),t.nrm(43,"img",11),t.j41(44,"span",12)(45,"span",39),t.nrm(46,"span",9),t.k0s()()()(),t.j41(47,"div",7)(48,"div",10)(49,"label",40)(50,"input",8),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.permissions.round=!n.permissions.round)}),t.k0s(),t.nrm(51,"span",9),t.k0s(),t.nrm(52,"img",11),t.j41(53,"span",12)(54,"span",39),t.nrm(55,"span",9),t.k0s()()()(),t.j41(56,"div",7)(57,"div",10)(58,"label",40)(59,"input",8),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.permissions.level=!n.permissions.level)}),t.k0s(),t.nrm(60,"span",9),t.k0s(),t.nrm(61,"img",11),t.j41(62,"span",12)(63,"span",39),t.nrm(64,"span",9),t.k0s()()()(),t.j41(65,"div",7)(66,"div",10)(67,"label",40)(68,"input",8),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.permissions.attackModifiers=!n.permissions.attackModifiers)}),t.k0s(),t.nrm(69,"span",9),t.k0s(),t.nrm(70,"img",11),t.j41(71,"span",12)(72,"span",39),t.nrm(73,"span",9),t.k0s()()()(),t.j41(74,"div",7)(75,"div",10)(76,"label",40)(77,"input",8),t.bIt("change",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.permissions.lootDeck=!n.permissions.lootDeck)}),t.k0s(),t.nrm(78,"span",9),t.k0s(),t.nrm(79,"img",11),t.j41(80,"span",12)(81,"span",39),t.nrm(82,"span",9),t.k0s()()()()}if(2&i){const e=t.XpG(2);t.Y8G("ngClass",t.eq3(39,mc,!e.gameManager.stateManager.permissions)),t.R7$(2),t.Y8G("ngClass",t.eq3(41,ce,e.gameManager.stateManager.permissions)),t.R7$(),t.Y8G("checked",e.permissions.characters),t.R7$(),t.Y8G("ghs-label","permissions.characters"),t.R7$(4),t.Y8G("ghs-label","permissions.characters.hint"),t.R7$(),t.vxM(e.permissions.characters?-1:9),t.R7$(3),t.Y8G("ngClass",t.eq3(43,ce,e.gameManager.stateManager.permissions)),t.R7$(),t.Y8G("checked",e.permissions.monsters),t.R7$(),t.Y8G("ghs-label","permissions.monsters"),t.R7$(4),t.Y8G("ghs-label","permissions.monsters.hint"),t.R7$(),t.vxM(e.permissions.monsters?-1:19),t.R7$(3),t.Y8G("ngClass",t.eq3(45,ce,e.gameManager.stateManager.permissions)),t.R7$(),t.Y8G("checked",e.permissions.scenario),t.R7$(),t.Y8G("ghs-label","permissions.scenario"),t.R7$(4),t.Y8G("ghs-label","permissions.scenario.hint"),t.R7$(3),t.Y8G("ngClass",t.eq3(47,ce,e.gameManager.stateManager.permissions)),t.R7$(),t.Y8G("checked",e.permissions.party),t.R7$(),t.Y8G("ghs-label","permissions.party"),t.R7$(4),t.Y8G("ghs-label","permissions.party.hint"),t.R7$(3),t.Y8G("ngClass",t.eq3(49,ce,e.gameManager.stateManager.permissions)),t.R7$(),t.Y8G("checked",e.permissions.elements),t.R7$(),t.Y8G("ghs-label","permissions.elements"),t.R7$(4),t.Y8G("ghs-label","permissions.elements.hint"),t.R7$(3),t.Y8G("ngClass",t.eq3(51,ce,e.gameManager.stateManager.permissions)),t.R7$(),t.Y8G("checked",e.permissions.round),t.R7$(),t.Y8G("ghs-label","permissions.round"),t.R7$(4),t.Y8G("ghs-label","permissions.round.hint"),t.R7$(3),t.Y8G("ngClass",t.eq3(53,ce,e.gameManager.stateManager.permissions)),t.R7$(),t.Y8G("checked",e.permissions.level),t.R7$(),t.Y8G("ghs-label","permissions.level"),t.R7$(4),t.Y8G("ghs-label","permissions.level.hint"),t.R7$(3),t.Y8G("ngClass",t.eq3(55,ce,e.gameManager.stateManager.permissions)),t.R7$(),t.Y8G("checked",e.permissions.attackModifiers),t.R7$(),t.Y8G("ghs-label","permissions.attackModifiers"),t.R7$(4),t.Y8G("ghs-label","permissions.attackModifiers.hint"),t.R7$(3),t.Y8G("ngClass",t.eq3(57,ce,e.gameManager.stateManager.permissions)),t.R7$(),t.Y8G("checked",e.permissions.lootDeck),t.R7$(),t.Y8G("ghs-label","permissions.lootDeck"),t.R7$(4),t.Y8G("ghs-label","permissions.lootDeck.hint")}}function yJ(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",7)(1,"label",17),t.nrm(2,"span",9),t.k0s(),t.j41(3,"input",47),t.bIt("keyup",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.setPermissionsCode(n))})("change",function(n){t.eBV(e);const o=t.XpG(2);return t.Njj(o.setPermissionsCode(n))}),t.k0s()(),t.j41(4,"div",7)(5,"a",26),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.savePermissions())}),t.nrm(6,"span",9),t.k0s()()}if(2&i){const e=t.XpG(2);t.R7$(2),t.Y8G("ghs-label","permissions.code"),t.R7$(),t.Y8G("value",e.code)("ghs-label","permissions.code")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ngClass",t.eq3(6,ce,!e.code)),t.R7$(),t.Y8G("ghs-label","permissions.save")}}function xJ(i,r){if(1&i&&(t.j41(0,"div",5)(1,"div",38)(2,"label"),t.nrm(3,"span",9),t.k0s()(),t.nVh(4,pJ,18,6),t.nVh(5,kJ,83,59),t.nVh(6,yJ,7,8),t.k0s()),2&i){const e=t.XpG();t.R7$(3),t.Y8G("ghs-label",e.gameManager.stateManager.permissions?"permissions":"permissions.create"),t.R7$(),t.vxM(e.gameManager.stateManager.permissions?-1:4),t.R7$(),t.vxM(e.getPermissions()&&e.permissions?5:-1),t.R7$(),t.vxM(e.gameManager.stateManager.permissions?-1:6)}}let EJ=(()=>{class i{gameManager=s.E;settingsManager=m.f;tryConnect=!1;WebSocket=WebSocket;permissions=new Ni.x;publicServer=[];selectedServerIndex=-1;code="";createPermissions=!1;serverUpdateVersion;ngOnInit(){var e=this;return(0,X.A)(function*(){try{yield fetch("./assets/server.json").then(a=>{if(!a.ok)throw Error();return a.json()}).then(a=>{e.publicServer=a})}catch{e.publicServer=[]}e.updateServer(),e.checkServerVersion(),e.uiChangeSubscription=s.E.uiChange.subscribe({next:()=>{e.checkServerVersion()}})})()}uiChangeSubscription;ngOnDestroy(){this.uiChangeSubscription&&this.uiChangeSubscription.unsubscribe()}connect(e,a,n){e&&!isNaN(+a)&&n&&(m.f.setServer(e,+a,n),s.E.stateManager.connect(),this.tryConnect=!0)}getPermissions(){return s.E.stateManager.permissions&&(this.permissions=s.E.stateManager.permissions),this.permissions}createUUID(){m.f.settings.serverCode=(0,fa.v4)()}disconnect(){s.E.stateManager.disconnect(),this.permissions=s.E.stateManager.permissions}reconnect(){this.disconnect(),s.E.stateManager.connect(),this.tryConnect=!0}selectServer(e){if(this.selectedServerIndex=-1,!isNaN(+e.target.value)&&(s.E.stateManager.serverVersion="",this.selectedServerIndex=+e.target.value,this.selectedServerIndex>-1&&this.selectedServerIndex<this.publicServer.length)){const a=this.publicServer[this.selectedServerIndex];m.f.settings.serverUrl=a.url,m.f.settings.serverPort=a.port,m.f.settings.serverWss=a.secure}}updateServer(){this.selectedServerIndex=-1,this.publicServer.forEach((e,a)=>{m.f.settings.serverUrl!=e.url||m.f.settings.serverPort!=e.port||m.f.settings.serverWss!=e.secure||(this.selectedServerIndex=a)})}checkServerVersion(){var e=this;return(0,X.A)(function*(){e.serverUpdateVersion=void 0,s.E.stateManager.serverVersion&&(yield fetch("https://api.github.com/repos/lurkars/ghs-server/releases/latest").then(a=>{if(!a.ok)throw Error();return a.json()}).then(a=>{e.serverUpdateVersion={latest:a.tag_name==s.E.stateManager.serverVersion||a.tag_name=="v"+s.E.stateManager.serverVersion,version:a.tag_name,url:a.html_url}}))})()}setServerUrl(e){this.tryConnect=!1,m.f.settings.serverUrl=e.target.value,m.f.storeSettings(),this.updateServer()}setServerPort(e){this.tryConnect=!1,m.f.settings.serverPort=e.target.value,m.f.storeSettings(),this.updateServer()}setServerCode(e){this.tryConnect=!1,m.f.settings.serverCode=e.target.value,m.f.storeSettings(),this.updateServer()}permissionsAll(e){this.permissions=e.target.checked?void 0:new Ni.x}permissionsCustom(e){this.permissions=e.target.checked?new Ni.x:void 0}characters(){return s.E.game.figures.filter(e=>e instanceof q.K).map(e=>e)}hasCharacter(e){return null!=this.permissions&&this.permissions.character.some(a=>a.name==e.name&&a.edition==e.edition)}toggleCharacter(e){if(this.permissions){const a=this.permissions.character.find(n=>n.name==e.name&&n.edition==e.edition);a?this.permissions.character.splice(this.permissions.character.indexOf(a,1)):this.permissions.character.push(new vt.gw(e.name,e.edition))}}monsters(){return s.E.game.figures.filter(e=>e instanceof P.R).map(e=>e)}hasMonster(e){return null!=this.permissions&&this.permissions.monster.some(a=>a.name==e.name&&a.edition==e.edition)}toggleMonster(e){if(this.permissions){const a=this.permissions.monster.find(n=>n.name==e.name&&n.edition==e.edition);a?this.permissions.monster.splice(this.permissions.monster.indexOf(a,1)):this.permissions.monster.push(new vt.gw(e.name,e.edition))}}setPermissionsCode(e){this.code=e.target.value}savePermissions(){s.E.stateManager.savePermissions(this.code,this.permissions),this.code="",this.permissions=new Ni.x}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-server-menu"]],standalone:!1,decls:65,vars:46,consts:[["serverFrom",""],["serverUrl",""],["serverPort",""],["serverCode",""],[1,"menu-container","two-column","server"],[1,"column"],[3,"ngSubmit"],[1,"line"],["tabclick","","type","checkbox",3,"change","checked"],[3,"ghs-label"],[1,"hint-container"],["src","./assets/images/hint.svg",1,"hint-trigger","ghs-svg"],[1,"hint"],[1,"text",3,"ghs-label"],[1,"line","separator"],[1,"server-info"],[1,"line","separator",3,"ngClass"],[1,"label"],["type","text",3,"keyup","change","value","ghs-label","ghs-label-attribute"],[1,"line",3,"ngClass"],["type","number",3,"keyup","change","value","ghs-label","ghs-label-attribute"],[1,"code-container"],[1,"spacer"],["type","text",3,"keyup","keydown.enter","change","value","ghs-label","ghs-label-attribute"],[1,"columns",3,"ngClass"],[1,"columns"],["tabclick","",3,"click","ngClass"],["tabclick","",3,"change"],[3,"value","selected"],["tabclick","","target","_blank",3,"href"],[1,"server-version"],[1,"unknown"],[1,"latest"],[1,"update"],[3,"ghs-label","ghs-label-args"],["href","https://github.com/Lurkars/ghs-server#how-to-run","target","_blank",1,"server-run"],[3,"click"],["tabclick","",3,"click"],[1,"line","title"],[1,"text"],[3,"ngClass"],[1,"line","characters"],["type","checkbox",3,"change","checked"],[1,"line","monsters"],[1,"edition"],[1,"ally"],[1,"allied"],["tabclick","","type","text",3,"keyup","change","value","ghs-label","ghs-label-attribute"]],template:function(a,n){if(1&a){const o=t.RV6();t.j41(0,"div",4)(1,"div",5)(2,"form",6,0),t.bIt("ngSubmit",function(){t.eBV(o);const _=t.sdS(30),y=t.sdS(35),B=t.sdS(45);return t.Njj(n.connect(_.value,y.value,B.value))}),t.j41(4,"div",7)(5,"label")(6,"input",8),t.bIt("change",function(){return t.eBV(o),t.Njj(n.settingsManager.toggle("serverAutoconnect"))}),t.k0s(),t.nrm(7,"span",9),t.k0s()(),t.j41(8,"div",7)(9,"label")(10,"div",10)(11,"input",8),t.bIt("change",function(){return t.eBV(o),t.Njj(n.settingsManager.setServerSettings(!n.settingsManager.settings.serverSettings))}),t.k0s(),t.nrm(12,"span",9)(13,"img",11),t.j41(14,"span",12),t.nrm(15,"span",13),t.k0s()()()(),t.j41(16,"div",7),t.nVh(17,UW,2,1,"p")(18,qW,2,1,"p")(19,HW,2,1,"p")(20,KW,2,1,"p")(21,WW,2,1,"p")(22,JW,2,1,"p"),t.k0s(),t.nVh(23,QW,6,1,"div",14),t.nVh(24,oJ,21,11,"div",15),t.nVh(25,sJ,3,1,"div",7),t.j41(26,"div",16)(27,"label",17),t.nrm(28,"span",9),t.k0s(),t.j41(29,"input",18,1),t.bIt("keyup",function(){return t.eBV(o),t.Njj(0)})("change",function(_){return t.eBV(o),t.Njj(n.setServerUrl(_))}),t.k0s()(),t.j41(31,"div",19)(32,"label",17),t.nrm(33,"span",9),t.k0s(),t.j41(34,"input",20,2),t.bIt("keyup",function(){return t.eBV(o),t.Njj(0)})("change",function(_){return t.eBV(o),t.Njj(n.setServerPort(_))}),t.k0s()(),t.j41(36,"div",19)(37,"div",21)(38,"label",17),t.nrm(39,"span",9),t.k0s(),t.nrm(40,"span",22),t.nVh(41,rJ,2,1,"a"),t.k0s()(),t.j41(42,"div",7)(43,"div",10)(44,"input",23,3),t.bIt("keyup",function(){return t.eBV(o),t.Njj(0)})("keydown.enter",function(){t.eBV(o);const _=t.sdS(3);return t.Njj(_.submit())})("change",function(_){return t.eBV(o),t.Njj(n.setServerCode(_))}),t.k0s(),t.nrm(46,"img",11),t.j41(47,"span",12),t.nrm(48,"span",13),t.k0s()()(),t.j41(49,"div",24)(50,"div",5)(51,"div",7)(52,"label")(53,"input",8),t.bIt("change",function(){return t.eBV(o),n.settingsManager.toggle("serverWss"),t.Njj(n.updateServer())}),t.k0s(),t.nrm(54,"span",9),t.k0s()()(),t.nVh(55,cJ,4,2,"div",5),t.k0s(),t.nVh(56,hJ,9,5,"div",15),t.j41(57,"div",25)(58,"div",5)(59,"div",7)(60,"a",26),t.bIt("click",function(){return t.eBV(o),t.Njj(n.reconnect())}),t.nrm(61,"span",9),t.k0s()()(),t.nVh(62,_J,4,1,"div",5),t.k0s()(),t.nVh(63,mJ,9,3),t.k0s(),t.nVh(64,xJ,7,4,"div",5),t.k0s()}if(2&a){let o;const g=t.sdS(30),_=t.sdS(35),y=t.sdS(45);t.R7$(6),t.Y8G("checked",n.settingsManager.settings.serverAutoconnect),t.R7$(),t.Y8G("ghs-label","server.autoconnect"),t.R7$(4),t.Y8G("checked",n.settingsManager.settings.serverSettings),t.R7$(),t.Y8G("ghs-label","server.settings"),t.R7$(3),t.Y8G("ghs-label","server.settings.hint"),t.R7$(2),t.vxM((o=n.gameManager.stateManager.wsState())===n.WebSocket.OPEN?17:o===n.WebSocket.CONNECTING?18:o===n.WebSocket.CLOSING?19:o===n.WebSocket.CLOSED?20:-1===o?21:22),t.R7$(6),t.vxM(n.publicServer?23:-1),t.R7$(),t.vxM(-1!=n.selectedServerIndex?24:-1),t.R7$(),t.vxM(-1!=n.selectedServerIndex||n.gameManager.stateManager.wsState()!=n.WebSocket.OPEN&&n.gameManager.stateManager.wsState()==n.WebSocket.CONNECTING?25:-1),t.R7$(),t.Y8G("ngClass",t.eq3(36,ho,-1!=n.selectedServerIndex)),t.R7$(2),t.Y8G("ghs-label","server.url"),t.R7$(),t.Y8G("value",n.settingsManager.settings.serverUrl||"")("ghs-label","server.url")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ngClass",t.eq3(38,ho,-1!=n.selectedServerIndex)),t.R7$(2),t.Y8G("ghs-label","server.port"),t.R7$(),t.Y8G("value",n.settingsManager.settings.serverPort||"")("ghs-label","server.port")("ghs-label-attribute","placeholder"),t.R7$(2),t.Y8G("ngClass",t.eq3(40,mc,-1!=n.selectedServerIndex)),t.R7$(3),t.Y8G("ghs-label","server.code"),t.R7$(2),t.vxM(n.settingsManager.settings.serverCode?-1:41),t.R7$(3),t.Y8G("value",n.settingsManager.settings.serverCode||"")("ghs-label","server.code")("ghs-label-attribute","placeholder"),t.R7$(4),t.Y8G("ghs-label","server.code.hint"),t.R7$(),t.Y8G("ngClass",t.eq3(42,ho,-1!=n.selectedServerIndex)),t.R7$(4),t.Y8G("checked",n.settingsManager.settings.serverWss),t.R7$(),t.Y8G("ghs-label","server.wss"),t.R7$(),t.vxM(n.settingsManager.settings.serverWss&&g.value&&_.value&&y.value&&n.tryConnect&&n.gameManager.stateManager.wsState()!=n.WebSocket.OPEN?55:-1),t.R7$(),t.vxM(-1==n.selectedServerIndex&&n.gameManager.stateManager.serverVersion&&n.gameManager.stateManager.wsState()==n.WebSocket.OPEN?56:-1),t.R7$(4),t.Y8G("ngClass",t.eq3(44,ce,!g.value||!_.value||!y.value)),t.R7$(),t.Y8G("ghs-label",n.gameManager.stateManager.wsState()==n.WebSocket.OPEN?"server.reconnect":"server.connect"),t.R7$(),t.vxM(n.gameManager.stateManager.wsState()==n.WebSocket.OPEN?62:-1),t.R7$(),t.vxM(n.gameManager.stateManager.wsState()!=n.WebSocket.OPEN||n.gameManager.stateManager.permissions?-1:63),t.R7$(),t.vxM(n.createPermissions||n.gameManager.stateManager.permissions?64:-1)}},dependencies:[N.YU,O.qT,O.xH,O.y7,O.cb,O.cV,tt,At,N.lG],styles:['[_nghost-%COMP%]{position:relative;z-index:9999}.hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:break-spaces}.back[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled[_ngcontent-%COMP%]{pointer-events:none}.back.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container[_ngcontent-%COMP%]{z-index:1}.menu-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.no-grow[_ngcontent-%COMP%]{flex-grow:0}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container.inline[_ngcontent-%COMP%]{width:initial;margin-right:1em}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex-wrap:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-gray)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{filter:grayscale(1)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm-delete[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]{align-items:flex-start}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]   .undo-text[_ngcontent-%COMP%]{display:flex;align-items:center}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.redo[_ngcontent-%COMP%]{align-items:flex-end}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]:hover{opacity:.7}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover{cursor:pointer}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog.disabled[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)!important}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]{border-bottom:none;margin-bottom:0}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container[_ngcontent-%COMP%]   .line.sticky.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container[_ngcontent-%COMP%]   .line.sticky.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .add[_ngcontent-%COMP%]{display:inherit}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%] ~ .spoiler[_ngcontent-%COMP%]{margin-top:0;border-top:none}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]{display:flex;cursor:pointer}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]   .span-xs[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns.columns-break[_ngcontent-%COMP%]{flex-wrap:wrap}}',".server[_ngcontent-%COMP%]   .server-info[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;row-gap:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));column-gap:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.server[_ngcontent-%COMP%]   .server-info[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled);align-self:center;padding:0;margin:0;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.server[_ngcontent-%COMP%]   .server-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ghs-color-gray);align-self:center;padding:0;margin:0}.server[_ngcontent-%COMP%]   .server-info[_ngcontent-%COMP%]   .server-version[_ngcontent-%COMP%]{color:var(--ghs-color-gray);align-self:center;padding:0;margin:0;display:flex}.server[_ngcontent-%COMP%]   .server-info[_ngcontent-%COMP%]   .server-version[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-right:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.server[_ngcontent-%COMP%]   .server-info[_ngcontent-%COMP%]   .server-version[_ngcontent-%COMP%]   span.unknown[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));color:var(--ghs-color-darkgray)}.server[_ngcontent-%COMP%]   .server-info[_ngcontent-%COMP%]   .server-version[_ngcontent-%COMP%]   span.latest[_ngcontent-%COMP%]{color:var(--ghs-color-darkgreen)}.server[_ngcontent-%COMP%]   .server-info[_ngcontent-%COMP%]   .server-version[_ngcontent-%COMP%]   span.update[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.server[_ngcontent-%COMP%]   .server-info[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:underline;color:var(--ghs-color-gray);align-self:center;justify-self:center;padding:0;margin:0}.server[_ngcontent-%COMP%]   .server-info[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.server[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)!important;pointer-events:none}.server[_ngcontent-%COMP%]   .line.characters[_ngcontent-%COMP%], .server[_ngcontent-%COMP%]   .line.monsters[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));flex-direction:column;align-items:flex-start}.server[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .server-run[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.server[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .code-container[_ngcontent-%COMP%]{display:flex;width:100%}.server[_ngcontent-%COMP%]   .hidden[_ngcontent-%COMP%]{display:none!important}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:1 span}}"]})}return i})();var wJ=M(17699);const RJ=i=>({connected:i}),jJ=()=>["scenarioRooms"],GJ=()=>["partySheet"],_o=()=>["characterSheet"],TJ=()=>["scenarioRooms","treasures"],fc=()=>["scenarioRooms","treasures","treasuresLoot"],Cc=()=>["characterItems"],SJ=()=>["characterIdentities"],$J=()=>["scenarioRewards"],mo=()=>["battleGoals"],Gn=()=>["standees"],DJ=()=>["standees","scenarioRooms"],Mc=i=>({disabled:i}),IJ=()=>["applyConditions"],vc=()=>["lootDeck"],AJ=()=>["lootDeck","applyLoot","characterItems"],VJ=()=>["lootDeck","applyLoot"],FJ=()=>["characterItems","characterSheet"],XJ=()=>["amAdvantage"],BJ=()=>["expireConditions","applyConditions"],YJ=()=>["scenarioRules"],Oc=()=>["events","partySheet"],NJ=()=>["portraitMode"],zJ=()=>["!eventDraw"],Pc=()=>["characterSheet","characterAttackModifierDeck"],LJ=()=>["characterSheet","characterAttackModifierDeck","characterAttackModifierDeckPermanent"],UJ=()=>["characterItems","characterItemsPermanent"],bc=()=>["gameClock"],qJ=()=>["gameClock","automaticGameClock"],HJ=()=>["animations"],KJ=()=>["initiativeRequired"],WJ=()=>["columns"],JJ=()=>["default","fh","modern","bb"],Tn=()=>["abilities"],kc=()=>["abilities","calculateStats"],ZJ=()=>["abilities","interactiveAbilities"],QJ=()=>["abilities","!showExpandedAbilityCard"],tZ=()=>["stats"],eZ=()=>["standees","scenarioRooms","automaticStandees","!randomStandees"],nZ=i=>({immunity:i}),po=i=>({right:i}),yc=(i,r)=>({immunity:i,disabled:r}),iZ=()=>["amAdvantage","alwaysFhAdvantage"],aZ=()=>["fhChallenges"],oZ=()=>["fhTrials"],sZ=()=>["monsterAttackModifierDeck"],rZ=()=>["!initiativeRequired"],uo=(i,r)=>r.name;function cZ(i,r){if(1&i&&(t.j41(0,"div",4),t.nrm(1,"div",140)(2,"div",141)(3,"div",142)(4,"div",143)(5,"div",144)(6,"div",145)(7,"div",146)(8,"div",147),t.k0s(),t.j41(9,"div",4),t.nrm(10,"div",148)(11,"div",149)(12,"div",150)(13,"div",151)(14,"div",152)(15,"div",153)(16,"div",154),t.k0s()),2&i){const e=t.XpG();t.R7$(2),t.Y8G("requires",t.lJ4(12,Tn)),t.R7$(),t.Y8G("requires",t.lJ4(13,Tn)),t.R7$(),t.Y8G("requires",t.lJ4(14,kc)),t.R7$(),t.Y8G("requires",t.lJ4(15,kc)),t.R7$(),t.Y8G("requires",t.lJ4(16,Tn)),t.R7$(4),t.Y8G("requires",t.lJ4(17,Tn)),t.R7$(),t.Y8G("requires",t.lJ4(18,ZJ)),t.R7$(),t.Y8G("requires",t.lJ4(19,Tn)),t.R7$(),t.Y8G("requires",t.lJ4(20,Tn)),t.R7$(),t.Y8G("requires",t.lJ4(21,QJ))("checked",e.settingsManager.settings.showExpandedAbilityCard),t.R7$(2),t.Y8G("requires",t.lJ4(22,tZ))}}function lZ(i,r){1&i&&t.nrm(0,"div",37),2&i&&t.Y8G("requires",t.lJ4(1,Gn))}function gZ(i,r){1&i&&(t.j41(0,"div",4),t.nrm(1,"div",155)(2,"div",156)(3,"div",157)(4,"div",158),t.k0s()),2&i&&(t.R7$(),t.Y8G("requires",t.lJ4(3,eZ)),t.R7$(),t.Y8G("requires",t.lJ4(4,Gn)),t.R7$(2),t.Y8G("requires",t.lJ4(5,Gn)))}function dZ(i,r){1&i&&(t.j41(0,"span",161),t.EFF(1,"X"),t.k0s())}function hZ(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",46)(1,"div",159),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.toggleApplyConditionsExclude(n.name))}),t.nrm(2,"img",160),t.nVh(3,dZ,2,0,"span",161),t.k0s(),t.nrm(4,"img",162),t.j41(5,"span",163),t.nrm(6,"span",164),t.k0s()()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(5,nZ,-1!=n.settingsManager.settings.applyConditionsExcludes.indexOf(e.name))),t.R7$(),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+e.name+".svg",t.B4B),t.R7$(),t.vxM(-1!=e.types.indexOf(n.ConditionType.value)?3:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(7,po,a>2)),t.R7$(),t.Y8G("ghs-label","settings.applyConditions.hint."+e.name)}}function _Z(i,r){1&i&&(t.j41(0,"span",161),t.EFF(1,"X"),t.k0s())}function mZ(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",46)(1,"div",159),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG();return t.Njj(o.toggleActiveApplyConditionsExclude(n.name))}),t.nrm(2,"img",160),t.nVh(3,_Z,2,0,"span",161),t.k0s(),t.nrm(4,"img",162),t.j41(5,"span",163),t.nrm(6,"span",164),t.k0s()()}if(2&i){const e=r.$implicit,a=r.$index,n=t.XpG();t.R7$(),t.Y8G("ngClass",t.l_i(5,yc,-1!=n.settingsManager.settings.activeApplyConditionsExcludes.indexOf(e.name),!n.settingsManager.settings.applyConditions||!n.settingsManager.settings.activeApplyConditions)),t.R7$(),t.Y8G("src","./assets/images"+(n.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+e.name+".svg",t.B4B),t.R7$(),t.vxM(-1!=e.types.indexOf(n.ConditionType.value)?3:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(8,po,a>2)),t.R7$(),t.Y8G("ghs-label","settings.activeApplyConditions.hint."+e.name)}}function pZ(i,r){1&i&&(t.j41(0,"span",161),t.EFF(1,"X"),t.k0s())}function uZ(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",46)(1,"div",159),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,o=t.XpG(2);return t.Njj(o.toggleActiveApplyConditionsAuto(n.name))}),t.nrm(2,"img",160),t.nVh(3,pZ,2,0,"span",161),t.k0s(),t.nrm(4,"img",162),t.j41(5,"span",163),t.nrm(6,"span",164),t.k0s()()}if(2&i){const e=t.XpG(),a=e.$implicit,n=e.$index,o=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.l_i(5,yc,-1==o.settingsManager.settings.activeApplyConditionsAuto.indexOf(a.name)||-1!=o.settingsManager.settings.activeApplyConditionsExcludes.indexOf(a.name),-1!=o.settingsManager.settings.activeApplyConditionsExcludes.indexOf(a.name))),t.R7$(),t.Y8G("src","./assets/images"+(o.settingsManager.settings.fhStyle?"/fh":"")+"/condition/"+a.name+".svg",t.B4B),t.R7$(),t.vxM(-1!=a.types.indexOf(o.ConditionType.value)?3:-1),t.R7$(2),t.Y8G("ngClass",t.eq3(8,po,n>2)),t.R7$(),t.Y8G("ghs-label","settings.activeApplyConditions.auto.hint."+a.name)}}function fZ(i,r){if(1&i&&t.nVh(0,uZ,7,10,"div",46),2&i){const e=r.$implicit,a=t.XpG(2);t.vxM(-1==a.settingsManager.settings.activeApplyConditionsExcludes.indexOf(e.name)?0:-1)}}function CZ(i,r){if(1&i&&(t.j41(0,"div",4)(1,"div",44)(2,"div",165),t.nrm(3,"label",104)(4,"img",162),t.j41(5,"span",166),t.nrm(6,"span",164),t.k0s()(),t.j41(7,"div",45),t.Z7z(8,fZ,1,1,null,null,uo),t.k0s()()()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(3,Mc,!e.settingsManager.settings.applyConditions||!e.settingsManager.settings.activeApplyConditions)),t.R7$(2),t.Y8G("ghs-label","settings.activeApplyConditions.auto"),t.R7$(3),t.Y8G("ghs-label","settings.activeApplyConditions.auto.hint"),t.R7$(2),t.Dyx(e.activeApplyConditionsAuto)}}function MZ(i,r){if(1&i&&t.nrm(0,"div",59),2&i){const e=t.XpG();t.Y8G("disabled",!e.gameManager.fhRules())}}function vZ(i,r){if(1&i&&t.nrm(0,"div",60),2&i){const e=t.XpG();t.Y8G("disabled",!e.gameManager.fhRules())("labelSuffix",e.gameManager.trialsManager.favorsAvailable?"favors":"")}}function OZ(i,r){if(1&i&&t.nrm(0,"div",61),2&i){const e=t.XpG();t.Y8G("disabled",!e.gameManager.fhRules())}}function PZ(i,r){1&i&&t.nrm(0,"div",68),2&i&&t.Y8G("requires",t.lJ4(1,iZ))}function bZ(i,r){if(1&i&&t.nrm(0,"div",69),2&i){const e=t.XpG();t.Y8G("disabled",!e.gameManager.fhRules())("requires",t.lJ4(2,aZ))}}function kZ(i,r){if(1&i&&t.nrm(0,"div",70),2&i){const e=t.XpG();t.Y8G("disabled",!e.gameManager.fhRules()||!e.gameManager.trialsManager.trialsEnabled&&!e.gameManager.trialsManager.favorsEnabled)("requires",t.lJ4(3,oZ))("labelSuffix",e.gameManager.trialsManager.favorsAvailable?"favors":"")}}function yZ(i,r){1&i&&t.nrm(0,"div",168)}function xZ(i,r){if(1&i&&(t.nrm(0,"div",50)(1,"div",167),t.j41(2,"div",4),t.nVh(3,yZ,1,0,"div",168),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("sync",!0),t.R7$(2),t.vxM(e.gameManager.imbuementManager.available?3:-1)}}function EZ(i,r){1&i&&(t.nrm(0,"div",50)(1,"div",169),t.j41(2,"div",4),t.nrm(3,"div",170)(4,"div",171),t.k0s(),t.j41(5,"div",4),t.nrm(6,"div",172),t.k0s()),2&i&&(t.R7$(),t.Y8G("sync",!0),t.R7$(3),t.Y8G("requires",t.lJ4(3,sZ)),t.R7$(2),t.Y8G("requires",t.lJ4(4,Gn)))}function wZ(i,r){1&i&&t.nrm(0,"div",73),2&i&&t.Y8G("requires",t.lJ4(1,rZ))}function RZ(i,r){1&i&&t.nrm(0,"div",123)}let jZ=(()=>{class i{platform;settingMenus;setMenu=new t.bkB;gameManager=s.E;settingsManager=m.f;storageManager=w.n;GameState=T.mk;SubMenu=we;wakeLock;applyConditionsExcludes=[];activeApplyConditionsAuto=[];activeApplyConditionsExcludes=[];WebSocket=WebSocket;ConditionType=j.GV;filter="";constructor(e){this.platform=e,this.wakeLock="wakeLock"in navigator,Object.keys(j.r5).forEach(a=>{const n=new j.kW(a);(!s.E.game.edition||-1!=s.E.conditions(s.E.game.edition).map(o=>o.name).indexOf(n.name)||-1!=n.types.indexOf(j.GV.hidden))&&((-1!=n.types.indexOf(j.GV.turn)||-1!=n.types.indexOf(j.GV.afterTurn)||-1!=n.types.indexOf(j.GV.autoApply)&&-1==n.types.indexOf(j.GV.apply))&&this.applyConditionsExcludes.push(n),-1!=n.types.indexOf(j.GV.autoApply)&&this.activeApplyConditionsAuto.push(n),-1!=n.types.indexOf(j.GV.apply)&&this.activeApplyConditionsExcludes.push(n))})}updateFilter(){this.settingMenus.forEach(e=>{this.filter?(0,V.oB)(e.setting,this.filter)||(0,V.oB)(m.f.getLabel("settings."+e.setting),this.filter)||(0,V.oB)(m.f.getLabel("settings."+e.setting+".hint"),this.filter)?e.elementRef.nativeElement.classList.remove("hidden"):e.elementRef.nativeElement.classList.add("hidden"):e.elementRef.nativeElement.classList.remove("hidden")})}doubleClick=null;toggleApplyConditionsExclude(e){let a=m.f.settings.applyConditionsExcludes.indexOf(e);-1==a?m.f.settings.applyConditionsExcludes.push(e):m.f.settings.applyConditionsExcludes.splice(a,1),m.f.storeSettings()}toggleActiveApplyConditionsAuto(e){let a=m.f.settings.activeApplyConditionsAuto.indexOf(e);-1==a?m.f.settings.activeApplyConditionsAuto.push(e):m.f.settings.activeApplyConditionsAuto.splice(a,1),m.f.storeSettings()}toggleActiveApplyConditionsExclude(e){let a=m.f.settings.activeApplyConditionsExcludes.indexOf(e);-1==a?m.f.settings.activeApplyConditionsExcludes.push(e):m.f.settings.activeApplyConditionsExcludes.splice(a,1),m.f.storeSettings()}zoomOut(e=!1){this.zoom(5,e)}zoomIn(e=!1){this.zoom(-5,e)}zoom(e,a){let n=+window.getComputedStyle(document.body).getPropertyValue("--ghs-factor");n+=e,this.setZoom(n,e,a)}setZoom(e,a,n){if(m.f.settings.zoom!=e){if(document.body.style.setProperty("--ghs-factor",e+""),!n){const o=+window.getComputedStyle(document.body).getPropertyValue("min-width").replace("px","");a<0&&o>=window.innerWidth&&(e-=a,document.body.style.setProperty("--ghs-factor",e+""))}m.f.setZoom(e)}}resetZoom(){this.setZoom(100,0,!0)}setTheme(e){m.f.set("theme",e.target.value)}helperDefaults(){m.f.settings.abilityNumbers=!1,m.f.settings.activeApplyConditions=!1,m.f.settings.activeStandees=!1,m.f.settings.activeSummons=!1,m.f.settings.applyConditions=!1,m.f.settings.applyLongRest=!1,m.f.settings.allyAttackModifierDeck=!1,m.f.settings.automaticUnlocking=!1,m.f.settings.automaticStandees=!1,m.f.settings.autoscroll=!1,m.f.settings.battleGoals=!1,m.f.settings.calculate=!0,m.f.settings.calculateStats=!1,m.f.settings.characterAttackModifierDeck=!1,m.f.settings.characterIdentities=!1,m.f.settings.characterItems=!1,m.f.settings.characterHandSize=!1,m.f.settings.characterSheet=!1,m.f.settings.disabledTurnConfirmation=!0,m.f.settings.disableStandees=!1,m.f.settings.dragValues=!0,m.f.settings.eliteFirst=!0,m.f.settings.expireConditions=!1,m.f.settings.fhStyle=!1,m.f.settings.hideAbsent=!1,m.f.settings.hideStats=!0,m.f.settings.hints=!0,m.f.settings.initiativeRequired=!0,m.f.settings.interactiveAbilities=!0,m.f.settings.lootDeck=!1,m.f.settings.moveElements=!0,m.f.settings.partySheet=!1,m.f.settings.randomStandees=!1,m.f.settings.scenarioRewards=!1,m.f.settings.scenarioRooms=!1,m.f.settings.scenarioRules=!1,m.f.settings.standees=!0,m.f.settings.standeeStats=!1,m.f.settings.treasures=!1,m.f.settings.treasuresLoot=!1,m.f.settings.turnConfirmation=!1,m.f.settings.theme="default",m.f.storeSettings()}xhaDefaults(){m.f.settings.abilityNumbers=!0,m.f.settings.activeApplyConditions=!1,m.f.settings.activeStandees=!1,m.f.settings.activeSummons=!1,m.f.settings.applyConditions=!1,m.f.settings.applyLongRest=!1,m.f.settings.allyAttackModifierDeck=!0,m.f.settings.automaticUnlocking=!1,m.f.settings.automaticStandees=!0,m.f.settings.automaticStandeesDialog=!0,m.f.settings.autoscroll=!0,m.f.settings.battleGoals=!1,m.f.settings.calculate=!0,m.f.settings.calculateStats=!0,m.f.settings.characterAttackModifierDeck=!1,m.f.settings.characterIdentities=!1,m.f.settings.characterItems=!1,m.f.settings.characterHandSize=!1,m.f.settings.characterSheet=!1,m.f.settings.disabledTurnConfirmation=!0,m.f.settings.disableStandees=!1,m.f.settings.dragValues=!0,m.f.settings.eliteFirst=!0,m.f.settings.expireConditions=!1,m.f.settings.fhStyle=!0,m.f.settings.hideAbsent=!1,m.f.settings.hideCharacterLoot=!0,m.f.settings.hideStats=!0,m.f.settings.hints=!0,m.f.settings.initiativeRequired=!0,m.f.settings.interactiveAbilities=!1,m.f.settings.lootDeck=!1,m.f.settings.moveElements=!0,m.f.settings.partySheet=!1,m.f.settings.randomStandees=!1,m.f.settings.scenarioRewards=!1,m.f.settings.scenarioRooms=!0,m.f.settings.scenarioRules=!0,m.f.settings.showFullAbilityCard=!0,m.f.settings.standees=!0,m.f.settings.standeeStats=!1,m.f.settings.statAnimations=!0,m.f.settings.treasures=!1,m.f.settings.treasuresLoot=!1,m.f.settings.turnConfirmation=!1,m.f.settings.theme="fh",m.f.storeSettings()}lurkarsDefaults(){m.f.settings.abilities=!0,m.f.settings.abilityNumbers=!0,m.f.settings.abilityReveal=!0,m.f.settings.activeApplyConditions=!0,m.f.settings.activeApplyConditionsExcludes=[j.r5.shield,j.r5.poison,j.r5.poison_x],m.f.settings.activeStandees=!1,m.f.settings.activeSummons=!0,m.f.settings.addAllMonsters=!1,m.f.settings.allyAttackModifierDeck=!0,m.f.settings.alwaysAllyAttackModifierDeck=!1,m.f.settings.alwaysFhAdvantage=!0,m.f.settings.alwaysFhSolo=!1,m.f.settings.alwaysHazardousTerrain=!1,m.f.settings.alwaysLootApplyDialog=!1,m.f.settings.alwaysLootDeck=!1,m.f.settings.amAdvantage=!0,m.f.settings.amAdvantageHouseRule=!0,m.f.settings.animations=!0,m.f.settings.applyBuildingRewards=!0,m.f.settings.applyConditions=!0,m.f.settings.applyConditionsExcludes=[j.r5.shield],m.f.settings.applyLongRest=!0,m.f.settings.applyLoot=!0,m.f.settings.applyLootRandomItem=!0,m.f.settings.applyRetirement=!0,m.f.settings.artwork=!0,m.f.settings.automaticAttackModifierFullscreen=!1,m.f.settings.automaticGameClock=!0,m.f.settings.automaticGameClockFocus=!1,m.f.settings.automaticPassTime=!0,m.f.settings.automaticStandees=!0,m.f.settings.automaticStandeesDialog=!1,m.f.settings.automaticTheme=!0,m.f.settings.automaticUnlocking=!0,m.f.settings.backupHint=!1,m.f.settings.battleGoals=!0,m.f.settings.battleGoalsCharacter=!1,m.f.settings.battleGoalsFh=!1,m.f.settings.battleGoalsReminder=!0,m.f.settings.calculate=!0,m.f.settings.calculateStats=!0,m.f.settings.calculateShieldStats=!1,m.f.settings.characterAttackModifierAnimate=!0,m.f.settings.characterAttackModifierDeck=!0,m.f.settings.characterAttackModifierDeckPermanent=!0,m.f.settings.characterAttackModifierDeckPermanentActive=!1,m.f.settings.characterCompact=!1,m.f.settings.characterHandSize=!0,m.f.settings.characterIdentities=!0,m.f.settings.characterIdentityHint=!0,m.f.settings.characterItems=!0,m.f.settings.characterItemsApply=!0,m.f.settings.characterItemsPermanent=!1,m.f.settings.characterSheet=!0,m.f.settings.characterSheetCompact=!1,m.f.settings.characterShieldRetaliate=!0,m.f.settings.characterTraits=!0,m.f.settings.columns=!0,m.f.settings.columnsForce=!0,m.f.settings.combineInteractiveAbilities=!1,m.f.settings.combineSummonAction=!0,m.f.settings.dragFigures=!0,m.f.settings.dragValues=!0,m.f.settings.eliteFirst=!0,m.f.settings.errata=!0,m.f.settings.expireConditions=!0,m.f.settings.fhGhItems=!0,m.f.settings.fhStyle=!1,m.f.settings.hideCharacterHP=!1,m.f.settings.hideCharacterLoot=!1,m.f.settings.hideCharacterXP=!1,m.f.settings.hideStats=!1,m.f.settings.initiativeRequired=!0,m.f.settings.interactiveAbilities=!0,m.f.settings.lootDeck=!0,m.f.settings.portraitMode=!0,m.f.settings.monsters=!0,m.f.settings.monsterAttackModifierDeck=!0,m.f.settings.moveElements=!0,m.f.settings.partySheet=!0,m.f.settings.pinchZoom=!0,m.f.settings.pressDoubleClick=!0,m.f.settings.randomStandees=!0,m.f.settings.removeUnusedMonster=!0,m.f.settings.scenarioRewards=!0,m.f.settings.scenarioRewardsItems=!0,m.f.settings.scenarioRooms=!0,m.f.settings.scenarioRules=!0,m.f.settings.showExpandedAbilityCard=!0,m.f.settings.showFullAbilityCard=!1,m.f.settings.sortFigures=!0,m.f.settings.standees=!0,m.f.settings.standeeStats=!0,m.f.settings.statAnimations=!1,m.f.settings.stats=!0,m.f.settings.summons=!0,m.f.settings.tooltips=!0,m.f.settings.treasures=!0,m.f.settings.treasuresLoot=!0,m.f.settings.treasuresLootItem=!0,m.f.settings.treasuresLootScenario=!0,m.f.settings.turnConfirmation=!1,m.f.settings.unlockEnvelopeBuildings=!0}static \u0275fac=function(a){return new(a||i)(t.rXU(wJ.OD))};static \u0275cmp=t.VBU({type:i,selectors:[["ghs-settings-menu"]],viewQuery:function(a,n){if(1&a&&t.GBs(un,5),2&a){let o;t.mGM(o=t.lsd())&&(n.settingMenus=o)}},outputs:{setMenu:"setMenu"},standalone:!1,decls:196,vars:155,consts:[[1,"menu-container","two-column","settings",3,"ngClass"],[1,"line","hidden"],["type","text",3,"ngModelChange","change","keyup","ngModel","ghs-label","ghs-label-attribute"],["ghs-setting-title-menu","gameplay",1,"line","title","span",3,"sync"],[1,"column"],["ghs-setting-menu","scenarioRooms",1,"line"],["ghs-setting-menu","treasures",1,"line",3,"requires"],["ghs-setting-menu","scenarioRules",1,"line"],["ghs-setting-menu","battleGoals",1,"line"],["ghs-setting-menu","events",1,"line",3,"requires"],["ghs-setting-menu","partySheet",1,"line"],["ghs-setting-menu","characterSheet",1,"line"],["ghs-setting-menu","characterAttackModifierDeck",1,"line",3,"requires"],["ghs-setting-menu","characterItems",1,"line"],["ghs-setting-title-menu","character",1,"line","title","span",3,"sync"],["ghs-setting-menu","initiativeRequired",1,"line"],["ghs-setting-menu","hideAbsent",1,"line"],["ghs-setting-menu","treasuresLoot",1,"line",3,"requires"],["ghs-setting-menu","treasuresLootItem",1,"line",3,"requires"],["ghs-setting-menu","treasuresLootScenario",1,"line",3,"requires"],["ghs-setting-menu","applyLongRest",1,"line"],["ghs-setting-menu","applyRetirement",1,"line",3,"requires"],["ghs-setting-menu","characterItemsApply",1,"line",3,"requires"],["ghs-setting-menu","characterShieldRetaliate",1,"line"],["ghs-setting-menu","characterSortIndex",1,"line"],["ghs-setting-menu","activeSummons",1,"line"],["ghs-setting-menu","characterIdentities",1,"line"],["ghs-setting-menu","characterIdentityHint",1,"line",3,"requires"],["ghs-setting-menu","scenarioRewards",1,"line"],["ghs-setting-menu","scenarioRewardsItems",1,"line",3,"requires"],["ghs-setting-menu","battleGoalsReminder",1,"line",3,"requires"],["ghs-setting-menu","battleGoalsCharacter",1,"line",3,"requires"],["ghs-setting-menu","characterHandSize",1,"line"],["ghs-setting-menu","characterTraits",1,"line"],["ghs-setting-menu","scenarioStats",1,"line"],["ghs-setting-title-menu","monsters",1,"line","title","span",3,"sync"],["ghs-setting-title-menu","standees",1,"line","title","span",3,"sync"],["ghs-setting-menu","eliteFirst",1,"line",3,"requires"],["ghs-setting-menu","activeStandees",1,"line",3,"requires"],["ghs-setting-menu","automaticStandees",1,"line",3,"requires"],["ghs-setting-menu","standeeStats",1,"line",3,"requires"],["ghs-setting-title-menu","conditions",1,"line","title","span",3,"sync"],["ghs-setting-menu","expireConditions",1,"line"],["ghs-setting-menu","applyConditions",1,"line"],[1,"line",3,"ngClass"],[1,"condition-list"],[1,"hint-container"],["ghs-setting-menu","moveElements",1,"line"],["ghs-setting-menu","activeApplyConditions",1,"line",3,"requires"],[1,"line"],[1,"separator"],["ghs-setting-title-menu","fhRules",1,"line","title","span",3,"sync"],["ghs-setting-menu","applyLoot",1,"line",3,"requires"],["ghs-setting-menu","applyLootRandomItem",1,"line",3,"requires"],["ghs-setting-menu","alwaysLootApplyDialog",1,"line",3,"requires"],["ghs-setting-menu","automaticPassTime",1,"line",3,"disabled"],["ghs-setting-menu","applyBuildingRewards",1,"line",3,"disabled"],["ghs-setting-menu","unlockEnvelopeBuildings",1,"line",3,"disabled"],["ghs-setting-menu","fhGhItems",1,"line",3,"disabled","requiresOne"],["ghs-setting-menu","fhChallenges",1,"line",3,"disabled"],["ghs-setting-menu","fhTrials",1,"line",3,"disabled","labelSuffix"],["ghs-setting-menu","fhPets",1,"line",3,"disabled"],["ghs-setting-menu","alwaysLootDeck",1,"line",3,"disabled","requires","checked"],["ghs-setting-menu","battleGoalsFh",1,"line",3,"disabled","requires","checked"],["ghs-setting-menu","alwaysAllyAttackModifierDeck",1,"line",3,"disabled"],["ghs-setting-menu","alwaysHazardousTerrain",1,"line",3,"disabled","checked"],["ghs-setting-menu","alwaysFhSolo",1,"line",3,"disabled","checked"],["ghs-setting-menu","alwaysFhAdvantage",1,"line",3,"disabled","requires","checked"],["ghs-setting-menu","amAdvantageHouseRule",1,"line",3,"requires"],["ghs-setting-menu","fhChallengesApply",1,"line",3,"disabled","requires"],["ghs-setting-menu","fhTrialsApply",1,"line",3,"disabled","requires","labelSuffix"],["ghs-setting-title-menu","additional",1,"line","title","span",3,"sync"],["ghs-setting-menu","turnConfirmation",1,"line",3,"requiresOne"],["ghs-setting-menu","automaticFirstFigure",1,"line",3,"requires"],["ghs-setting-menu","scenarioRulesAutoapply",1,"line",3,"requires"],["ghs-setting-menu","automaticUnlocking",1,"line"],["ghs-setting-menu","summons",1,"line"],["ghs-setting-menu","eventsApply",1,"line",3,"requires"],["ghs-setting-menu","eventsDraw",1,"line",3,"requires"],["ghs-setting-menu","lootDeck",1,"line"],["ghs-setting-menu","allyAttackModifierDeck",1,"line"],["ghs-setting-menu","monsters",1,"line"],["ghs-setting-menu","monsterAttackModifierDeck",1,"line"],["ghs-setting-menu","amAdvantage",1,"line"],["ghs-setting-menu","damageHP",1,"line"],["ghs-setting-title-menu","interface",1,"line","title","span"],["ghs-setting-menu","fhStyle",1,"line"],["ghs-setting-menu","dragValues",1,"line"],["ghs-setting-menu","pressDoubleClick",1,"line"],["ghs-setting-menu","dragFigures",1,"line"],["ghs-setting-menu","automaticAttackModifierFullscreen",1,"line",3,"requires"],["ghs-setting-menu","characterSheetCompact",1,"line",3,"requires"],["ghs-setting-menu","eventsDrawReminder",1,"line",3,"requires"],["ghs-setting-menu","characterAttackModifierAnimate",1,"line",3,"requires"],["ghs-setting-menu","characterAttackModifierDeckPermanent",1,"line",3,"requires"],["ghs-setting-menu","characterAttackModifierDeckPermanentActive",1,"line",3,"requires"],["ghs-setting-menu","characterItemsPermanent",1,"line",3,"requires"],["ghs-setting-menu","characterItemsPermanentActive",1,"line",3,"requires"],["ghs-setting-menu","damageHPToggle",1,"line"],["ghs-setting-menu","gameClock",1,"line"],["ghs-setting-menu","gameClockMerge",1,"line",3,"requires"],["ghs-setting-menu","automaticGameClock",1,"line",3,"requires"],["ghs-setting-menu","automaticGameClockFocus",1,"line",3,"requires"],["ghs-pointer-input","",3,"singleClick","doubleClick"],[3,"ghs-label"],[3,"click"],["ghs-setting-menu","pinchZoom",1,"line"],["ghs-setting-menu","fullscreen",1,"line"],["ghs-setting-menu","autoscroll",1,"line"],["ghs-setting-menu","portraitMode",1,"line"],["ghs-setting-menu","animations",1,"line"],["ghs-setting-menu","statAnimations",1,"line"],["ghs-setting-menu","animationSpeed","type","range",1,"line",3,"min","max","requires"],["ghs-setting-menu","barsize","type","range",1,"line",3,"min","max"],["ghs-setting-menu","fontsize","type","range",1,"line",3,"min","max"],["ghs-setting-menu","hints",1,"line"],["ghs-setting-menu","tooltips",1,"line"],["ghs-setting-menu","backupHint",1,"line"],["ghs-setting-menu","initiativeRoundConfirm",1,"line",3,"requires"],["ghs-setting-menu","errata",1,"line"],["ghs-setting-menu","columns",1,"line"],["ghs-setting-menu","columnsForce",1,"line",3,"requires"],["ghs-setting-menu","artwork",1,"line"],["ghs-setting-menu","wakeLock",1,"line"],["ghs-setting-menu","maxUndo","type","number",1,"line",3,"min","max","hint","additionalHint"],["ghs-setting-menu","browserNavigation",1,"line",3,"disabled","hint"],["ghs-setting-title-menu","locale",1,"line","title",3,"sync"],["ghs-setting-menu","locale",3,"values"],["href","https://translate.gloomhaven-secretariat.de/","target","_blank",3,"ghs-tooltip","originY","overlayY"],["src","./assets/images/hint.svg",1,"ghs-svg"],["ghs-setting-title-menu","theme",1,"line","title"],["ghs-setting-menu","theme",3,"values"],["ghs-setting-menu","automaticTheme",1,"line"],["ghs-setting-menu","characterFullView",1,"line"],["ghs-setting-menu","characterCompact",1,"line",3,"disabled"],["ghs-setting-menu","playerNumber",1,"line"],["ghs-setting-menu","hideCharacterHP",1,"line"],["ghs-setting-menu","hideCharacterLoot",1,"line"],["ghs-setting-menu","hideCharacterXP",1,"line"],["tabclick","",3,"click"],["ghs-setting-menu","abilities",1,"line"],["ghs-setting-menu","calculate",1,"line",3,"requires"],["ghs-setting-menu","calculateStats",1,"line",3,"requires"],["ghs-setting-menu","calculateShieldStats",1,"line",3,"requires"],["ghs-setting-menu","calculateAdvantageStats",1,"line",3,"requires"],["ghs-setting-menu","abilityReveal",1,"line",3,"requires"],["ghs-setting-menu","removeUnusedMonster",1,"line"],["ghs-setting-menu","addAllMonsters",1,"line"],["ghs-setting-menu","interactiveAbilities",1,"line",3,"requires"],["ghs-setting-menu","combineInteractiveAbilities",1,"line",3,"requires"],["ghs-setting-menu","abilityNumbers",1,"line",3,"requires"],["ghs-setting-menu","showExpandedAbilityCard",1,"line",3,"requires"],["ghs-setting-menu","showFullAbilityCard",1,"line",3,"requires","checked"],["ghs-setting-menu","stats",1,"line"],["ghs-setting-menu","hideStats",1,"line",3,"requires"],["ghs-setting-menu","automaticStandeesDialog",1,"line",3,"requires"],["ghs-setting-menu","randomStandees",1,"line",3,"requires"],["ghs-setting-menu","standees",1,"line"],["ghs-setting-menu","standeeShieldRetaliate",1,"line",3,"requires"],["tabclick","",1,"condition",3,"click","ngClass"],[3,"src"],[1,"value"],["src","./assets/images/hint.svg",1,"hint-trigger","ghs-svg"],[1,"hint",3,"ngClass"],[1,"text",3,"ghs-label"],[1,"hint-container","inline"],[1,"hint"],["ghs-setting-title-menu","gh2eRules",1,"line","title","span",3,"sync"],["ghs-setting-menu","gh2eImbuement",1,"line"],["ghs-setting-title-menu","bbRules",1,"line","title","span",3,"sync"],["ghs-setting-menu","bbChars",1,"line"],["ghs-setting-menu","bbAm",1,"line",3,"requires"],["ghs-setting-menu","bbStandeeLimit",1,"line",3,"requires"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"input",2),t.mxI("ngModelChange",function(g){return t.DH7(n.filter,g)||(n.filter=g),g}),t.bIt("change",function(){return n.updateFilter()})("keyup",function(){return n.updateFilter()}),t.k0s()(),t.nrm(3,"div",3),t.j41(4,"div",4),t.nrm(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),t.k0s(),t.j41(10,"div",4),t.nrm(11,"div",10)(12,"div",11)(13,"div",12)(14,"div",13),t.k0s(),t.nrm(15,"div",14),t.j41(16,"div",4),t.nrm(17,"div",15)(18,"div",16)(19,"div",17)(20,"div",18)(21,"div",19)(22,"div",20)(23,"div",21)(24,"div",22)(25,"div",23)(26,"div",24),t.k0s(),t.j41(27,"div",4),t.nrm(28,"div",25)(29,"div",26)(30,"div",27)(31,"div",28)(32,"div",29)(33,"div",30)(34,"div",31)(35,"div",32)(36,"div",33)(37,"div",34),t.k0s(),t.nrm(38,"div",35),t.nVh(39,cZ,17,23),t.nrm(40,"div",36),t.j41(41,"div",4),t.nVh(42,lZ,1,2,"div",37),t.nrm(43,"div",38)(44,"div",39)(45,"div",40),t.k0s(),t.nVh(46,gZ,5,6,"div",4),t.nrm(47,"div",41),t.j41(48,"div",4),t.nrm(49,"div",42)(50,"div",43),t.j41(51,"div",4)(52,"div",44)(53,"div",45),t.Z7z(54,hZ,7,9,"div",46,uo),t.k0s()()()(),t.j41(56,"div",4),t.nrm(57,"div",47)(58,"div",48),t.j41(59,"div",4)(60,"div",49)(61,"div",45),t.Z7z(62,mZ,7,10,"div",46,uo),t.k0s()()(),t.nVh(64,CZ,10,5,"div",4),t.k0s(),t.nrm(65,"div",50)(66,"div",51),t.j41(67,"div",4),t.nrm(68,"div",52)(69,"div",53)(70,"div",54)(71,"div",55)(72,"div",56)(73,"div",57)(74,"div",58),t.nVh(75,MZ,1,1,"div",59),t.nVh(76,vZ,1,2,"div",60),t.nVh(77,OZ,1,1,"div",61),t.k0s(),t.j41(78,"div",4),t.nrm(79,"div",62)(80,"div",63)(81,"div",64)(82,"div",65)(83,"div",66)(84,"div",67),t.nVh(85,PZ,1,2,"div",68),t.nVh(86,bZ,1,3,"div",69),t.nVh(87,kZ,1,4,"div",70),t.k0s(),t.nVh(88,xZ,4,2),t.nVh(89,EZ,7,5),t.nrm(90,"div",50)(91,"div",71),t.j41(92,"div",4),t.nrm(93,"div",72),t.nVh(94,wZ,1,2,"div",73),t.nrm(95,"div",74)(96,"div",75)(97,"div",76)(98,"div",77)(99,"div",78),t.k0s(),t.j41(100,"div",4),t.nrm(101,"div",79)(102,"div",80)(103,"div",81)(104,"div",82)(105,"div",83)(106,"div",84),t.k0s(),t.nrm(107,"div",85),t.j41(108,"div",4),t.nrm(109,"div",86)(110,"div",87)(111,"div",88)(112,"div",89)(113,"div",90)(114,"div",91)(115,"div",92),t.k0s(),t.j41(116,"div",4),t.nrm(117,"div",93)(118,"div",94)(119,"div",95)(120,"div",96)(121,"div",97)(122,"div",98),t.k0s(),t.nrm(123,"div",50),t.j41(124,"div",4),t.nrm(125,"div",99)(126,"div",100),t.k0s(),t.j41(127,"div",4),t.nrm(128,"div",101)(129,"div",102),t.k0s(),t.nrm(130,"div",50),t.j41(131,"div",4)(132,"div",49)(133,"a",103),t.bIt("singleClick",function(){return n.zoomOut()})("doubleClick",function(){return n.zoomOut(!0)}),t.nrm(134,"span",104),t.k0s()(),t.j41(135,"div",49)(136,"a",103),t.bIt("singleClick",function(){return n.zoomIn()})("doubleClick",function(){return n.zoomIn(!0)}),t.nrm(137,"span",104),t.k0s()(),t.j41(138,"div",49)(139,"a",105),t.bIt("click",function(){return n.resetZoom()}),t.nrm(140,"span",104),t.k0s()(),t.nrm(141,"div",106)(142,"div",107)(143,"div",108)(144,"div",109)(145,"div",110)(146,"div",111)(147,"div",112)(148,"div",113)(149,"div",114),t.k0s(),t.j41(150,"div",4),t.nrm(151,"div",115)(152,"div",116)(153,"div",117)(154,"div",118)(155,"div",119)(156,"div",120)(157,"div",121)(158,"div",122),t.nVh(159,RZ,1,0,"div",123),t.k0s(),t.nrm(160,"div",50)(161,"div",124)(162,"div",125),t.j41(163,"div",4),t.nrm(164,"div",126)(165,"div",127),t.j41(166,"div",49)(167,"a",128),t.nrm(168,"img",129),t.EFF(169,"\xa0 "),t.nrm(170,"span",104),t.k0s()()(),t.j41(171,"div",4),t.nrm(172,"div",130)(173,"div",131)(174,"div",50)(175,"div",132)(176,"div",133)(177,"div",134)(178,"div",135)(179,"div",136)(180,"div",137)(181,"div",138),t.k0s(),t.nrm(182,"div",50),t.j41(183,"div",49)(184,"a",139),t.bIt("click",function(){return n.helperDefaults()}),t.nrm(185,"span",104),t.k0s()(),t.j41(186,"div",49)(187,"a",139),t.bIt("click",function(){return n.lurkarsDefaults()}),t.nrm(188,"span",104),t.k0s()(),t.j41(189,"div",49)(190,"a",139),t.bIt("click",function(){return n.xhaDefaults()}),t.nrm(191,"span",104),t.k0s()(),t.nrm(192,"div",50),t.j41(193,"div",49)(194,"a",139),t.bIt("click",function(){return n.setMenu.emit(n.SubMenu.debug)}),t.nrm(195,"span",104),t.k0s()()()),2&a&&(t.Y8G("ngClass",t.eq3(109,RJ,n.gameManager.stateManager.wsState()==n.WebSocket.OPEN)),t.R7$(2),t.R50("ngModel",n.filter),t.Y8G("ghs-label","settings.filter")("ghs-label-attribute","placeholder"),t.R7$(),t.Y8G("sync",!0),t.R7$(3),t.Y8G("requires",t.lJ4(111,jJ)),t.R7$(3),t.Y8G("requires",t.lJ4(112,GJ)),t.R7$(4),t.Y8G("requires",t.lJ4(113,_o)),t.R7$(2),t.Y8G("sync",!0),t.R7$(4),t.Y8G("requires",t.lJ4(114,TJ)),t.R7$(),t.Y8G("requires",t.lJ4(115,fc)),t.R7$(),t.Y8G("requires",t.lJ4(116,fc)),t.R7$(2),t.Y8G("requires",t.lJ4(117,_o)),t.R7$(),t.Y8G("requires",t.lJ4(118,Cc)),t.R7$(6),t.Y8G("requires",t.lJ4(119,SJ)),t.R7$(2),t.Y8G("requires",t.lJ4(120,$J)),t.R7$(),t.Y8G("requires",t.lJ4(121,mo)),t.R7$(),t.Y8G("requires",t.lJ4(122,mo)),t.R7$(4),t.Y8G("sync",!0),t.R7$(),t.vxM(n.settingsManager.settings.monsters?39:-1),t.R7$(),t.Y8G("sync",!0),t.R7$(2),t.vxM(n.settingsManager.settings.monsters?42:-1),t.R7$(),t.Y8G("requires",t.lJ4(123,Gn)),t.R7$(),t.Y8G("requires",t.lJ4(124,DJ)),t.R7$(),t.Y8G("requires",t.lJ4(125,Gn)),t.R7$(),t.vxM(n.settingsManager.settings.monsters?46:-1),t.R7$(),t.Y8G("sync",!0),t.R7$(5),t.Y8G("ngClass",t.eq3(126,Mc,!n.settingsManager.settings.applyConditions)),t.R7$(2),t.Dyx(n.applyConditionsExcludes),t.R7$(4),t.Y8G("requires",t.lJ4(128,IJ)),t.R7$(4),t.Dyx(n.activeApplyConditionsExcludes),t.R7$(2),t.vxM(n.settingsManager.settings.applyConditions&&n.settingsManager.settings.activeApplyConditions?64:-1),t.R7$(2),t.Y8G("sync",!0),t.R7$(2),t.Y8G("requires",t.lJ4(129,vc)),t.R7$(),t.Y8G("requires",t.lJ4(130,AJ)),t.R7$(),t.Y8G("requires",t.lJ4(131,VJ)),t.R7$(),t.Y8G("disabled",!n.gameManager.fhRules()),t.R7$(),t.Y8G("disabled",!n.gameManager.fhRules()),t.R7$(),t.Y8G("disabled",!n.gameManager.fhRules()),t.R7$(),t.Y8G("disabled",!n.gameManager.fhRules())("requiresOne",t.lJ4(132,FJ)),t.R7$(),t.vxM(n.gameManager.challengesManager.available?75:-1),t.R7$(),t.vxM(n.gameManager.trialsManager.available?76:-1),t.R7$(),t.vxM(n.gameManager.buildingsManager.petsAvailable?77:-1),t.R7$(2),t.Y8G("disabled",n.gameManager.fhRules())("requires",t.lJ4(133,vc))("checked",n.settingsManager.settings.lootDeck&&n.gameManager.fhRules()),t.R7$(),t.Y8G("disabled",n.gameManager.fhRules())("requires",t.lJ4(134,mo))("checked",n.settingsManager.settings.battleGoals&&n.gameManager.fhRules()),t.R7$(),t.Y8G("disabled",!n.settingsManager.settings.allyAttackModifierDeck),t.R7$(),t.Y8G("disabled",n.gameManager.fhRules())("checked",n.gameManager.fhRules()),t.R7$(),t.Y8G("disabled",n.gameManager.fhRules())("checked",n.gameManager.fhRules()),t.R7$(),t.Y8G("disabled",n.gameManager.fhRules())("requires",t.lJ4(135,XJ))("checked",n.settingsManager.settings.amAdvantage&&n.gameManager.fhRules()),t.R7$(),t.vxM(n.settingsManager.settings.amAdvantage?85:-1),t.R7$(),t.vxM(n.gameManager.challengesManager.available?86:-1),t.R7$(),t.vxM(n.gameManager.trialsManager.available?87:-1),t.R7$(),t.vxM(n.gameManager.gh2eRules()&&n.gameManager.imbuementManager.available?88:-1),t.R7$(),t.vxM(n.gameManager.bbRules()?89:-1),t.R7$(2),t.Y8G("sync",!0),t.R7$(2),t.Y8G("requiresOne",t.lJ4(136,BJ)),t.R7$(),t.vxM(n.settingsManager.settings.initiativeRequired?-1:94),t.R7$(),t.Y8G("requires",t.lJ4(137,YJ)),t.R7$(3),t.Y8G("requires",t.lJ4(138,Oc)),t.R7$(),t.Y8G("requires",t.lJ4(139,Oc)),t.R7$(14),t.Y8G("requires",t.lJ4(140,NJ)),t.R7$(),t.Y8G("requires",t.lJ4(141,_o)),t.R7$(),t.Y8G("requires",t.lJ4(142,zJ)),t.R7$(2),t.Y8G("requires",t.lJ4(143,Pc)),t.R7$(),t.Y8G("requires",t.lJ4(144,Pc)),t.R7$(),t.Y8G("requires",t.lJ4(145,LJ)),t.R7$(),t.Y8G("requires",t.lJ4(146,Cc)),t.R7$(),t.Y8G("requires",t.lJ4(147,UJ)),t.R7$(5),t.Y8G("requires",t.lJ4(148,bc)),t.R7$(2),t.Y8G("requires",t.lJ4(149,bc)),t.R7$(),t.Y8G("requires",t.lJ4(150,qJ)),t.R7$(5),t.Y8G("ghs-label","settings.zoom.out"),t.R7$(3),t.Y8G("ghs-label","settings.zoom.in"),t.R7$(3),t.Y8G("ghs-label","settings.zoom.reset"),t.R7$(7),t.Y8G("min",.3)("max",2)("requires",t.lJ4(151,HJ)),t.R7$(),t.Y8G("min",.1)("max",2),t.R7$(),t.Y8G("min",.1)("max",2),t.R7$(5),t.Y8G("requires",t.lJ4(152,KJ)),t.R7$(3),t.Y8G("requires",t.lJ4(153,WJ)),t.R7$(2),t.vxM(n.wakeLock?159:-1),t.R7$(2),t.Y8G("min",0)("max",n.storageManager.db?"":50)("hint",!n.storageManager.db)("additionalHint",n.platform.FIREFOX?"settings.maxUndo.hint.firefox":""),t.R7$(),t.Y8G("disabled",!0)("hint",!1),t.R7$(2),t.Y8G("sync",!0),t.R7$(),t.Y8G("values",n.settingsManager.locales),t.R7$(2),t.Y8G("ghs-tooltip","settings.locale.help.hint")("originY","top")("overlayY","bottom"),t.R7$(3),t.Y8G("ghs-label","settings.locale.help"),t.R7$(3),t.Y8G("values",t.lJ4(154,JJ)),t.R7$(4),t.Y8G("disabled","modern"==n.settingsManager.settings.theme),t.R7$(8),t.Y8G("ghs-label","settings.helperDefaults"),t.R7$(3),t.Y8G("ghs-label","settings.lurkarsDefaults"),t.R7$(3),t.Y8G("ghs-label","settings.xhaDefaults"),t.R7$(4),t.Y8G("ghs-label","settings.debug"))},dependencies:[N.YU,O.me,O.BC,O.vS,tt,ft,rt,un,Ng,At],styles:['[_nghost-%COMP%]{position:relative;z-index:9999}.hint-container[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:break-spaces}.back[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:calc(var(--ghs-unit) * 2);left:0;width:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));z-index:2}.back[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-gray) var(--ghs-filter-shadow)!important}.back[_ngcontent-%COMP%]:hover   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white) var(--ghs-filter-shadow)!important}.back.disabled[_ngcontent-%COMP%]{pointer-events:none}.back.disabled[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray) var(--ghs-filter-shadow)!important}.scroll-container[_ngcontent-%COMP%]{z-index:1}.menu-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;margin-left:calc(var(--ghs-unit) * 1.5 * var(--ghs-dialog-factor));padding-bottom:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));z-index:1}.menu-container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%;padding-right:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));flex-grow:1}.menu-container[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]   .column.no-grow[_ngcontent-%COMP%]{flex-grow:0}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:100%;padding:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0 calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor));font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);word-wrap:break-word;white-space:wrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg[_ngcontent-%COMP%]{width:1em;height:auto;filter:var(--ghs-filter-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;box-shadow:none;outline:none;background-color:transparent}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .hint-container.inline[_ngcontent-%COMP%]{width:initial;margin-right:1em}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex-wrap:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));color:var(--ghs-color-gray);text-shadow:var(--ghs-outline);white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover, .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 5 * var(--ghs-dialog-factor));margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));height:auto}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img.icon.spoiler[_ngcontent-%COMP%]{filter:brightness(0) var(--ghs-filter-gray)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{filter:grayscale(1)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm[_ngcontent-%COMP%]{color:var(--ghs-color-yellow)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label.confirm-delete[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button.confirm-delete[_ngcontent-%COMP%]{color:var(--ghs-color-red)}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ input[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] ~ select[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]{align-items:flex-start}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.undo[_ngcontent-%COMP%]   .undo-text[_ngcontent-%COMP%]{display:flex;align-items:center}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.redo[_ngcontent-%COMP%]{align-items:flex-end}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .state.disabled[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;font-family:var(--ghs-font-normal);font-size:calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor));color:var(--ghs-color-red);cursor:zoom-out}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--ghs-filter-red);height:.8em;width:auto;margin-right:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]:hover{opacity:.7}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 calc(var(--ghs-unit) * 2.5 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:auto;filter:var(--ghs-filter-gray)!important;opacity:.8}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover{cursor:pointer}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog[_ngcontent-%COMP%]:hover   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-white)!important;opacity:1}.menu-container[_ngcontent-%COMP%]   .line.state-container[_ngcontent-%COMP%]   .undo-dialog.disabled[_ngcontent-%COMP%]   img.ghs-svg[_ngcontent-%COMP%]{filter:var(--ghs-filter-darkgray)!important}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]{cursor:initial;border-bottom:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray);margin-bottom:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));white-space:nowrap}.menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .line.title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:initial;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]{border-bottom:none;margin-bottom:0}.menu-container[_ngcontent-%COMP%]   .line.title.hide-title[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line.sticky[_ngcontent-%COMP%]{position:sticky;top:0;background-image:url(dialog_background.fa4ff388462f6a00.png);z-index:1}.menu-container[_ngcontent-%COMP%]   .line.sticky.fh[_ngcontent-%COMP%]{background-image:url(dialog_background_fh.4617186f03975edf.png)}.menu-container[_ngcontent-%COMP%]   .line.sticky.modern[_ngcontent-%COMP%]{background-image:url(dialog_background_modern.c233015926c13e5e.png)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before, .menu-container[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:before{background-color:var(--ghs-color-disabled)!important}.menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]   .denied[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   .objective-marker[_ngcontent-%COMP%]{font-size:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]{margin-top:calc(var(--ghs-unit) * 1 * var(--ghs-dialog-factor));border-top:calc(var(--ghs-unit) * .1) solid var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%]:hover   .add[_ngcontent-%COMP%]{display:inherit}.menu-container[_ngcontent-%COMP%]   .spoilers[_ngcontent-%COMP%] > .spoiler[_ngcontent-%COMP%] ~ .spoiler[_ngcontent-%COMP%]{margin-top:0;border-top:none}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]{display:flex;cursor:pointer}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:after{content:" ";position:relative;display:block;left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));top:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor));width:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));clip-path:polygon(0 35%,35% 35%,35% 0%,65% 0%,65% 35%,100% 35%,100% 65%,65% 65%,65% 100%,35% 100%,35% 65%,0 65%);background-color:var(--ghs-color-gray)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover:after{background-color:var(--ghs-color-white)}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:not-allowed}.menu-container[_ngcontent-%COMP%]   .input-button[_ngcontent-%COMP%]   .add-button.disabled[_ngcontent-%COMP%]:after{background-color:var(--ghs-color-disabled)}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:calc(var(--ghs-unit) * 8 * var(--ghs-dialog-factor));margin:0;color:var(--ghs-color-white);background-color:var(--form-background);border-width:calc(var(--ghs-unit) * .1);border-style:solid;border-color:var(--ghs-color-gray);font-family:var(--ghs-font-text);font-size:calc(var(--ghs-unit) * 3 * var(--ghs-dialog-factor));appearance:none;-webkit-appearance:none;-moz-appearance:none}.menu-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;color:var(--ghs-color-white);background-color:var(--ghs-color-darkgray)}@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]   .span-xs[_ngcontent-%COMP%]{grid-column:2 span}.menu-container[_ngcontent-%COMP%]   .columns.columns-break[_ngcontent-%COMP%]{flex-wrap:wrap}}',"@media (max-width: 600px),(orientation: portrait){.menu-container.two-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto;column-gap:calc(var(--ghs-unit) * 2 * var(--ghs-dialog-factor))}.menu-container.two-column[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .menu-container.two-column[_ngcontent-%COMP%]   .span[_ngcontent-%COMP%]{grid-column:1 span}}.line[_ngcontent-%COMP%]   .condition-list[_ngcontent-%COMP%]{display:flex;align-items:center}.line[_ngcontent-%COMP%]   .condition-list[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]{margin:calc(var(--ghs-unit) * .25 * var(--ghs-dialog-factor)) calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.line[_ngcontent-%COMP%]   .condition-list[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{cursor:pointer;width:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));height:calc(var(--ghs-unit) * 3.5 * var(--ghs-dialog-factor));position:relative;display:flex}.line[_ngcontent-%COMP%]   .condition-list[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   .condition.immunity[_ngcontent-%COMP%]{opacity:.7;filter:grayscale(.3)}.line[_ngcontent-%COMP%]   .condition-list[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]:hover{opacity:.6;filter:none}.line[_ngcontent-%COMP%]   .condition-list[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.line[_ngcontent-%COMP%]   .condition-list[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:var(--ghs-font-title);font-size:calc(var(--ghs-unit) * 1.3 * var(--ghs-dialog-factor));color:var(--ghs-color-white);position:absolute;bottom:0;left:calc(var(--ghs-unit) * 1.8 * var(--ghs-dialog-factor));transform:translate(-50%)}.line[_ngcontent-%COMP%]   .condition-list[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   .condition.disabled[_ngcontent-%COMP%]{filter:grayscale(.6);pointer-events:none}.line[_ngcontent-%COMP%]   .condition-list[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   .hint-trigger[_ngcontent-%COMP%]{margin-left:calc(var(--ghs-unit) * .5 * var(--ghs-dialog-factor))}.line[_ngcontent-%COMP%]   .condition-list[_ngcontent-%COMP%]   .hint-container[_ngcontent-%COMP%]   .hint.right[_ngcontent-%COMP%]{transform:translate(-50%)}.line.hidden[_ngcontent-%COMP%]{display:none}.menu-container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg.sync-settings[_ngcontent-%COMP%]{height:2em;width:auto;filter:var(--ghs-filter-disabled) var(--ghs-filter-outline-thin-black)}.menu-container.connected[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .ghs-svg.sync-settings[_ngcontent-%COMP%]{filter:var(--ghs-filter-green) var(--ghs-filter-outline-thin-black)}"]})}return i})();const GZ=["Failed to execute 'setItem' on 'Storage'","NG0100","Failed to execute 'transaction' on 'IDBDatabase': The database connection is closing"];let TZ=(()=>{class i extends t.zcH{dialog;constructor(e){super(),this.dialog=e}handleError(e){if(s.E.stateManager.errorLog.push(e),super.handleError(e),window.document.body.classList.contains("working")||window.document.body.classList.contains("server-sync")){window.document.body.classList.remove("working"),window.document.body.classList.remove("server-sync");const a=e.message+(e.stack?e.stack.split("\n")[0]:"");e.message&&e.message.trim()&&-1==e.message.toLowerCase().indexOf("leaflet")&&!GZ.some(n=>e.message.startsWith(n))&&(!m.f.settings.feedbackErrorsIgnore||-1==m.f.settings.feedbackErrorsIgnore.indexOf(a))&&this.dialog.open(ko,{panelClass:["dialog"],data:e})}}static \u0275fac=function(a){return new(a||i)(t.KVO(v.lG))};static \u0275prov=t.jDH({token:i,factory:i.\u0275fac})}return i})(),SZ=(()=>{class i{static \u0275fac=function(a){return new(a||i)};static \u0275mod=t.$C({type:i,bootstrap:[kH]});static \u0275inj=t.G2t({providers:[{provide:v.Aq,useValue:{autoFocus:"dialog",hasBackdrop:!0}},{provide:t.zcH,useClass:TZ}],imports:[C.Bb,A.wb,bH,O.YN,D.ad,v.Ph,R.Q5,E.WJ.register("ngsw-worker.js",{enabled:true,registrationStrategy:"registerImmediately"})]})}return i})();t.wjB(ae,function(){return[N.YU,ae,lo,Oi,us,vn,tt,ft,rt,Ut]},function(){return[N.P9,Tt]}),t.wjB(Oi,function(){return[N.YU,lo]},[]),t.wjB(na,function(){return[N.YU,yn,tt]},[]),t.wjB(Ks,function(){return[N.YU,Ws]},[]),t.wjB(Re,function(){return[N.YU,Us,ft,rt]},[]),t.wjB(tr,function(){return[N.YU,Sa]},[]),t.wjB(So,function(){return[N.YU,U.Wk,NH,mK,jK,qK,tt,ft,lW,SW,LW,EJ,HK,jZ,At]},function(){return[N.P9]}),t.wjB(qa,function(){return[N.YU,jn]},[]),t.wjB(ur,function(){return[N.YU,vn,tt,jn,Fn]},[]),t.wjB(Or,function(){return[O.qT,O.cb,O.cV,jr,tt]},[]),t.wjB(Ua,function(){return[N.YU,en,tt,jn,rt]},[]),t.wjB(Ma,function(){return[N.YU,ae,lo,tt,Ut]},[]),(0,t.SmG)(),C.sG().bootstrapModule(SZ).catch(i=>console.error(i))},34786:(p,k,M)=>{M.d(k,{H:()=>C,h:()=>t});var C=function(v){return v.deck="deck",v.monsterEdition="monsterEdition",v.monsterType="monsterType",v.stat="stat",v.unknown="unknown",v}(C||{});class t{type;args;constructor(D,...O){this.type=D,this.args=O}}},34933:(p,k,M)=>{M.d(k,{$e:()=>v,ZM:()=>O});var C=M(58317),t=M(56719);class v{uuid;marker="";title="";escort=!1;entities=[];amDeck;noThumbnail=!0;summonColor="";name="";level=0;off=!1;active=!1;edition="";health=7;initiative=99;type="objectiveContainer";objectiveId;constructor(E,R=void 0){this.uuid=E,this.objectiveId=R}getInitiative(){let E=.9;if(this.objectiveId){const R=C.E.objectiveManager.objectiveDataByObjectiveIdentifier(this.objectiveId);if(R&&R.initiativeShare&&R.initiativeShare.split(":").length>1){if(this.initiative<1)return 100;E=+R.initiativeShare.split(":")[1]}}return this.initiative+E}toModel(){return new D(this.uuid,this.marker,this.title,this.name,this.escort,this.entities.map(E=>E.toModel()),this.level,this.off,this.active,this.health,this.initiative,this.objectiveId&&"scenario"in this.objectiveId?this.objectiveId:void 0,this.objectiveId&&!("scenario"in this.objectiveId)?this.objectiveId:void 0,this.amDeck)}fromModel(E){this.marker=E.marker,this.title=E.title,this.name=E.name,this.escort=E.escort,this.edition=E.escort?"escort":"objective",this.entities=this.entities.filter(R=>E.entities.some(I=>I.uuid==R.uuid)),E.entities.forEach((R,I)=>{let U=this.entities.find(X=>R.uuid==X.uuid);U?I!=this.entities.indexOf(U)&&(this.entities.splice(this.entities.indexOf(U),1),this.entities.splice(I,0,U)):(U=new t.X(R.uuid,R.number,this,this.marker),this.entities.splice(I,0,U)),U.fromModel(R)}),this.entities.sort((R,I)=>E.entities.map(U=>U.uuid).indexOf(R.uuid)-E.entities.map(U=>U.uuid).indexOf(I.uuid)),this.level=E.level,this.off=E.off,this.active=E.active,this.health=E.health,this.initiative=E.initiative,this.objectiveId=E.additionalObjectiveId||E.objectiveId,this.amDeck=E.amDeck||void 0}}class D{uuid;marker;title;name;escort;entities;level;off;active;health;initiative;objectiveId;additionalObjectiveId;amDeck;constructor(E,R,I,U,X,s,T,m,w,q,P,S,$,V){this.uuid=E,this.marker=R,this.title=I,this.name=U,this.escort=X,this.entities=s,this.level=T,this.off=m,this.active=w,this.health=q,this.initiative=P,this.objectiveId=S&&JSON.parse(JSON.stringify(S))||void 0,this.additionalObjectiveId=$&&JSON.parse(JSON.stringify($))||void 0,this.amDeck=V}}const O=["","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","A","B","C","D","E","F","G","H","I","J","K","L","M"]},35385:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{a:()=>MonsterManager});var src_app_game_model_data_Action__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(40840),src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(34786),src_app_ui_helper_Static__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(14670),_model_Entity__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(13812),_model_Game__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(29765),_model_Monster__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(42065),_model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(76066),_model_Summon__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(78164),_model_data_Condition__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(42357),_model_data_MonsterData__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(73018),_model_data_MonsterStat__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(40392),_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(16538),_GameManager__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(58317),_SettingsManager__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(31619);class MonsterManager{game;constructor(p){this.game=p}monsterThumbnail(p){if(p.thumbnailUrl)return p.thumbnailUrl;if(!p.thumbnail&&p.standeeShare){const k=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monstersData(p.standeeShareEdition||p.edition).find(M=>M.name==p.standeeShare);k&&(this.monsterThumbnail(k),k.thumbnail&&(p.thumbnail=k.thumbnail))}return p.thumbnail||(p.thumbnail=p.edition+"-"+p.name),"./assets/images/monster/thumbnail/"+p.thumbnail+".png"}monsterArtwork(p){return p.noArtwork?this.monsterThumbnail(p):(this.monsterThumbnail(p),"./assets/artwork/monster/"+p.thumbnail+".png")}getStat(p,k){let M=p.stats.find(C=>C.level==p.level&&C.type==k);if(p.bb&&(M=k==_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_11__.N.elite&&p.stats[0]&&p.stats[0].type==_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_11__.N.elite?p.stats[0]:Object.assign(new _model_data_MonsterStat__WEBPACK_IMPORTED_MODULE_10__.f(k),p.baseStat)),M||(p.errors=p.errors||[],!p.errors.find(C=>C.type==src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__.H.unknown)&&!p.errors.find(C=>C.type==src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__.H.stat)&&(console.error("Could not find '"+k+"' stats for monster: "+p.name+" level: "+p.level),p.errors.push(new src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__.h(src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__.H.stat,"monster",p.name,p.edition,k,""+p.level))),M=new _model_data_MonsterStat__WEBPACK_IMPORTED_MODULE_10__.f(k,p.level)),M=JSON.parse(JSON.stringify(M)),p.statEffect){let C=new _model_data_MonsterStat__WEBPACK_IMPORTED_MODULE_10__.M;C.name=p.statEffect.name;const t=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(M.health,p.level);C.health="string"==typeof p.statEffect.health?p.statEffect.health.replaceAll("H",""+M.health).replace("[","").replace("]",""):p.statEffect.health,C.movement="string"==typeof p.statEffect.movement?p.statEffect.movement.replaceAll("M",""+M.movement).replace("[","").replace("]",""):p.statEffect.movement,C.attack="string"==typeof p.statEffect.attack?p.statEffect.attack.replaceAll("A",""+M.attack).replace("[","").replace("]",""):p.statEffect.attack,C.range="string"==typeof p.statEffect.range?p.statEffect.range.replaceAll("R",""+M.range).replace("[","").replace("]",""):p.statEffect.range,C.initiative=p.statEffect.initiative,C.flying=p.statEffect.flying,C.actions=p.statEffect.actions,C.special=p.statEffect.special,C.immunities=p.statEffect.immunities,C.absolute=p.statEffect.absolute,C.note=p.statEffect.note,C.absolute?(C.health&&(M.health="["+C.health+"]"),C.movement&&(M.movement="["+C.movement+"]"),C.attack&&(M.attack="["+C.attack+"]"),C.range&&(M.range="["+C.range+"]"),C.actions&&(M.actions=C.actions),C.special&&(M.special=C.special),C.immunities&&(M.immunities=C.immunities)):(C.health&&(M.health="["+M.health+"+"+C.health+"]"),C.movement&&(M.movement="["+M.movement+"+"+C.movement+"]"),C.attack&&(M.attack="["+M.attack+"+"+C.attack+"]"),C.range&&(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(M.range)&&(M.range="["+M.range+"+"+C.range+"]"),C.actions&&(M.actions=M.actions||[],M.actions=[...M.actions,...C.actions]),C.immunities&&(M.immunities=M.immunities||[],M.immunities=[...M.immunities,...C.immunities])),C.health&&p.entities.forEach(v=>{M&&v.type==k&&v.maxHealth!=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(M.health,p.level)&&(v.maxHealth=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(M.health,p.level),(v.health==t||v.health>v.maxHealth)&&(v.health=v.maxHealth))})}return M}getSpawnMonsters(p){let k=[];return p.forEach(M=>{this.getMonsterSpawns(M).forEach(C=>{-1==k.indexOf(C)&&k.push(C)})}),k}getMonsterSpawns(p){let k=[];const M=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(new _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R(p));return M&&M.abilities&&M.abilities.forEach(C=>{C.actions.forEach(t=>{this.getActionSpawns(t,p.edition).forEach(D=>{-1==k.indexOf(D)&&k.push(D)})})}),p.baseStat.special&&p.baseStat.special.forEach(C=>{C.forEach(t=>{this.getActionSpawns(t,p.edition).forEach(D=>{-1==k.indexOf(D)&&k.push(D)})})}),p.stats&&p.stats.forEach(C=>{C.special&&C.special.forEach(t=>{t.forEach(v=>{this.getActionSpawns(v,p.edition).forEach(O=>{-1==k.indexOf(O)&&k.push(O)})})})}),k}getActionSpawns(p,k){if(p.type==src_app_game_model_data_Action__WEBPACK_IMPORTED_MODULE_0__.X2.summon||p.type==src_app_game_model_data_Action__WEBPACK_IMPORTED_MODULE_0__.X2.spawn)if("summonData"!=p.value&&"monsterStandee"!=p.value){const M=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monstersData(k).find(C=>C.name==(""+p.value).split(":")[0]);if(M)return[M]}else if("monsterStandee"==p.value&&p.valueObject){let M=[];return p.valueObject.forEach(C=>{const t=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monstersData(k).find(v=>v.name==C.monster.name);t&&M.push(t)}),M}return p.subActions?p.subActions.map(M=>this.getActionSpawns(M,k)).flat():[]}addMonsterByName(name,edition){let level=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.level;-1!=name.indexOf(":")&&(level=eval(_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.level+name.split(":")[1]),level<0?level=0:level>7&&(level=7),name=name.split(":")[0]);let monsterData=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monstersData().find(p=>p.name==name&&(p.edition==edition||-1!=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.editionExtensions(edition).indexOf(p.edition)));if(monsterData||(console.warn("Monster not found: '"+name+"' for edition :"+edition),monsterData=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monstersData().find(p=>p.name==name),monsterData&&(monsterData.errors=monsterData.errors||[],monsterData.errors.find(p=>p.type==src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__.H.monsterEdition)||monsterData.errors.push(new src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__.h(src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__.H.monsterEdition,"monster",monsterData.name,edition,monsterData.edition)))),monsterData)return this.addMonster(monsterData,level);console.error("Monster not found: '"+name+"'")}addMonster(p,k){this.game.scenario||_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.scenarioManager.setScenario(_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.scenarioManager.createScenario());let M=this.game.figures.find(C=>C instanceof _model_data_MonsterData__WEBPACK_IMPORTED_MODULE_9__.f&&C.name==p.name&&C.edition==p.edition);return M?k!=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.level&&M.level!=k&&this.setLevel(M,k):(M=new _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R(p),this.applySameDeck(M),this.setLevel(M,k),M.off=!0,this.resetMonsterAbilities(M),this.game.figures.push(M)),_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.state==_model_Game__WEBPACK_IMPORTED_MODULE_4__.mk.next&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.sortFigures(M),M}resetMonsterAbilities(p){if(!this.applySameDeck(p)){if(!p.abilities||0==p.abilities.length){const k=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.abilities(p);p.abilities=k.map(M=>k.indexOf(M)).filter(M=>!k[M].level||isNaN(+k[M].level)||(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(k[M].level)<=p.level)}this.shuffleAbilities(p)}}removeMonster(p){p.entities=[],this.game.figures.splice(this.game.figures.indexOf(p),1),p.drawExtra||this.game.figures.forEach(k=>{k instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&k.drawExtra&&(k.name!=p.name||k.edition!=p.edition)&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(k).name==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(p).name&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(k).edition==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(p).edition&&(this.getSameDeckMonster(k)||(k.drawExtra=!1))})}monsterEntityCount(p,k=!1,M=void 0){return p.entities.filter(C=>(_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.entityManager.isAlive(C,k)||C.dormant)&&(!k||C.number>0)&&(!M||C.type==M)).length}monsterEntityCountIdentifier(p,k){return"all"!=k.type&&(k.name!=p.name||k.edition!=p.edition)||"monster"!=k.type?0:p.entities.filter(M=>_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.entityManager.isAlive(M)&&(!k.marker||k.marker==M.marker)&&(!k.tags||0==k.tags.length||k.tags.every(C=>-1!=M.tags.indexOf(C)))).length}monsterEntityCountAll(p){return _GameManager__WEBPACK_IMPORTED_MODULE_12__.E.entityManager.entities(p).length}monsterStandeeShared(p,k){return p.bb?(this.game.figures.forEach(C=>{C instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&C.bb&&-1==k.indexOf(C)&&k.push(C)}),k):(-1==k.indexOf(p)&&k.push(p),p.standeeShare&&this.game.figures.filter(t=>t instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&p.standeeShare&&t.name==p.standeeShare&&t.edition==(p.standeeShareEdition||p.edition)).map(t=>t).forEach(t=>{-1==k.indexOf(t)&&(k.push(t),this.monsterStandeeShared(t,k))}),this.game.figures.filter(C=>C instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&C.standeeShare&&p.name==C.standeeShare&&p.edition==(C.standeeShareEdition||C.edition)).map(C=>C).forEach(C=>{-1==k.indexOf(C)&&(k.push(C),this.monsterStandeeShared(C,k))}),k)}monsterStandeeUsed(p,k){return this.monsterStandeeShared(p,[]).map(M=>M.entities).flat().find(M=>(_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.entityManager.isAlive(M)||M.dormant)&&M.number==k)}monsterStandeeCount(p,k=!0){return this.monsterStandeeShared(p,[]).map(M=>M.entities).flat().filter(M=>(_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.entityManager.isAlive(M)||M.dormant)&&(k||M.number>0)).length}monsterStandeeMax(p){if(p.bb&&!_SettingsManager__WEBPACK_IMPORTED_MODULE_13__.f.settings.bbStandeeLimit)return 10;let k=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(p.standeeCount||p.count||0,p.level);if((!k||!p.standeeCount)&&p.standeeShare){const M=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monstersData(p.standeeShareEdition||p.edition).find(C=>C.name==p.standeeShare);M&&(k=(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(M.standeeCount||M.count,p.level))}return k}monsterRandomStandee(p){let k=-1;const M=this.monsterStandeeMax(p);if([...Array(M).keys()].every(t=>_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monsterManager.monsterStandeeUsed(p,t+1)))return console.error("This should not happen: monsterRandomStandee called with all standees used already!"),k;const C=p.randomCount?(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(p.randomCount):0;if(C&&C<M&&[...Array(C).keys()].some(t=>!_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monsterManager.monsterStandeeUsed(p,t+1)))for(k=Math.floor(Math.random()*C)+1;_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monsterManager.monsterStandeeUsed(p,k);)k=Math.floor(Math.random()*C)+1;else for(k=Math.floor(Math.random()*M)+1;_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monsterManager.monsterStandeeUsed(p,k);)k=Math.floor(Math.random()*M)+1;return k}addMonsterEntity(p,k,M,C=!1){if(p.bb&&!p.baseStat||!p.bb&&!p.stats.some(v=>v.type==M))return p.errors=p.errors||[],void(!p.errors.find(v=>v.type==src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__.H.unknown)&&!p.errors.find(v=>v.type==src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__.H.monsterType)&&(console.error("Missing type '"+M+"' for "+p.name),p.errors.push(new src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__.h(src_app_game_model_data_FigureError__WEBPACK_IMPORTED_MODULE_1__.H.monsterType,"monster",p.name,p.edition,M))));let t=new _model_MonsterEntity__WEBPACK_IMPORTED_MODULE_6__.I(k,M,p);if(p.entities=p.entities.filter(v=>v.number!=k),p.entities.push(t),_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.addEntityCount(p,t),-1!=p.tags.indexOf("addedManually")&&(p.tags=p.tags.filter(v=>"addedManually"!=v)),C&&(t.summon=_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.new),!C||_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.fhRules()){if(this.game.state==_model_Game__WEBPACK_IMPORTED_MODULE_4__.mk.next&&(-1==p.ability?this.applySameDeck(p)?-1==p.ability&&(p.ability=0,p.lastDraw=this.game.round):(p.ability=0,p.lastDraw=this.game.round):1==p.entities.length&&!this.applySameDeck(p)&&p.lastDraw<this.game.round&&(p.ability=p.ability+1+this.game.figures.filter(v=>v instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&(v.name!=p.name||v.edition!=p.edition)&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(v).name==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(p).name&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(v).edition==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(p).edition&&v.drawExtra&&v.ability>-1).length,p.lastDraw=this.game.round,p.ability>=p.abilities.length&&this.shuffleAbilities(p))),this.game.state==_model_Game__WEBPACK_IMPORTED_MODULE_4__.mk.next&&1==this.monsterEntityCount(p)){let v=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.figures.indexOf(p);const D=this.getSameDeckMonster(p);for(D&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.gameplayFigure(D)&&this.applySameDeck(p);_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.figures.some((O,A)=>!O.off&&A<v&&(O.getInitiative()>p.getInitiative()||O.getInitiative()==p.getInitiative()&&O instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&O.name.toLowerCase()>p.name.toLowerCase()));)_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.figures.splice(v,1),v--,_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.figures.splice(v,0,p)}!C&&p.off?p.off=!1:C&&p.entities.every(v=>!_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.entityManager.isAlive(v)||v.summon==_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.new)&&(p.off=!0),this.game.state==_model_Game__WEBPACK_IMPORTED_MODULE_4__.mk.next&&t.summon!=_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.new&&(t.active=p.active||_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.figures.some((v,D,O)=>v.active&&D>O.indexOf(p)))}return t}spawnMonsterEntity(p,k,M=!1,C=!1,t=!1,v=!1){p.isAlly=M,p.isAllied=C,p.drawExtra=t;const D=this.monsterStandeeMax(p);if(_SettingsManager__WEBPACK_IMPORTED_MODULE_13__.f.settings.automaticStandees&&this.monsterStandeeCount(p)<D){let O=-1;for(;this.monsterStandeeUsed(p,O);)O-=1;if(_SettingsManager__WEBPACK_IMPORTED_MODULE_13__.f.settings.randomStandees)O=this.monsterRandomStandee(p);else if(this.monsterStandeeCount(p,!1)==D-1)for(O=1;_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monsterManager.monsterStandeeUsed(p,O);)O++;else 0==this.monsterStandeeCount(p,!1)&&this.monsterStandeeCount(p,!0)==D-1&&p.entities.every(E=>(_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.entityManager.isAlive(E)||E.dormant)&&E.type==k)&&(p.entities.forEach((E,R)=>{E.number=R+1}),O=D);p.boss&&(k=_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_11__.N.boss);const A=this.addMonsterEntity(p,O,k,v);return A&&(A.revealed=!0),A}}removeMonsterEntity(p,k){p.entities.splice(p.entities.indexOf(k),1),(0==p.entities.length||p.entities.every(M=>!_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.entityManager.isAlive(M)&&!M.dormant))&&(!p.off&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.state==_model_Game__WEBPACK_IMPORTED_MODULE_4__.mk.next&&p.active?_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.roundManager.toggleFigure(p):p.off=!0,_SettingsManager__WEBPACK_IMPORTED_MODULE_13__.f.settings.removeUnusedMonster&&0==p.entities.length&&this.removeMonster(p)),_SettingsManager__WEBPACK_IMPORTED_MODULE_13__.f.settings.scenarioStats&&k.dead&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.scenarioStatsManager.killMonsterEntity(k)}setLevel(p,k){p.level=k,this.resetMonsterAbilities(p),p.entities.forEach(M=>{let t,C=this.getStat(p,M.type);M.level=p.level,t="number"==typeof C.health?C.health:(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(C.health),M.health==M.maxHealth&&(M.health=t),M.maxHealth=t,M.health>M.maxHealth&&(M.health=M.maxHealth)})}toggleActive(p,k){this.game.state==_model_Game__WEBPACK_IMPORTED_MODULE_4__.mk.next&&(p.active?(k.active=!k.active,p.entities.every(M=>M.dead||M.health<=0||!M.active)&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.roundManager.toggleFigure(p)):k.active?(k.active=!1,p.entities.every(M=>M.dead||M.health<=0||!M.active||M.summon==_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.new)&&(p.off=!0)):(p.off=!1,k.active=!0),k.active?(k.off=!1,!p.active&&this.game.figures.every(M=>!M.active)&&(p.active=!0)):k.off=!0)}getSameDeckMonster(p){return this.game.figures.find(k=>k instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&(k.name!=p.name||k.edition!=p.edition)&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(k).name==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(p).name&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(k).edition==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(p).edition&&!k.drawExtra)}applySameDeck(p){const k=this.getSameDeckMonster(p);return!!k&&(p.abilities=JSON.parse(JSON.stringify(k.abilities)),p.ability=k.ability,p.lastDraw=this.game.round,p.drawExtra&&this.drawExtra(p),!0)}drawExtra(p){if(p.drawExtra){p.ability=-1;const k=this.getSameDeckMonster(p);if(!k)return console.error("Draw extra for '"+p.name+"' ("+p.deck+" not possible, not same deck monster found!"),void(p.drawExtra=!1);p.ability=k.ability+1+this.game.figures.filter(M=>M instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&(M.name!=p.name||M.edition!=p.edition)&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(M).name==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(p).name&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(M).edition==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(p).edition&&M.drawExtra&&M.ability>k.ability).length,p.ability>=p.abilities.length&&this.shuffleAbilities(p),p.lastDraw=this.game.round}else this.applySameDeck(p)}next(){this.game.figures.forEach(p=>{if(p instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R){let k=this.getAbility(p);if(k){if(this.hasBottomActions(p)){const M=k;if(k=this.getAbility(p,!0),k&&("bottom"==p.firstActiveAction&&k.bottomLost||"top"==p.firstActiveAction&&k.lost)){const C=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.abilities(p).indexOf(k);p.abilities=p.abilities.filter(t=>t!=C),p.ability-=1}if(M&&("bottom"==p.firstActiveAction&&M.lost||"top"==p.firstActiveAction&&M.bottomLost)){const C=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.abilities(p).indexOf(M);p.abilities=p.abilities.filter(t=>t!=C),p.ability-=1}}this.hasBottomActions(p)&&p.firstActiveAction&&p.ability>=p.abilities.length+(p.abilities.length%2==0?-1:-2)?(p.abilities.splice(0,1),this.shuffleAbilities(p)):(k&&k.shuffle||p.ability>=p.abilities.length)&&this.shuffleAbilities(p)}p.entities=p.entities.filter(M=>_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.entityManager.isAlive(M)||M.dormant),p.entities.forEach(M=>{M.tags&&(M.tags=M.tags.filter(C=>!C.startsWith("roundAction-"))),M.summon==_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.new&&(M.summon=_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.true),M.entityConditions.forEach(C=>{-1!=C.types.indexOf(_model_data_Condition__WEBPACK_IMPORTED_MODULE_8__.GV.expire)&&C.state==_model_data_Condition__WEBPACK_IMPORTED_MODULE_8__.mg.normal&&(C.lastState=C.state,C.state=_model_data_Condition__WEBPACK_IMPORTED_MODULE_8__.mg.expire)})}),p.tags=p.tags.filter(M=>!M.startsWith("roundAction-")),p.off=0==p.entities.length}})}draw(){this.game.figures.filter(p=>p instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&!p.drawExtra).forEach(p=>{if(p instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.gameplayFigure(p)&&(p.ability=p.ability+1+this.game.figures.filter(k=>k instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&(k.name!=p.name||k.edition!=p.edition)&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(k).name==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(p).name&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(k).edition==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(p).edition&&k.drawExtra&&k.ability>-1).length,p.lastDraw=this.game.round,this.hasBottomActions(p)&&(p.ability+=1),p.ability>=p.abilities.length&&this.shuffleAbilities(p),p.bb&&-1!=p.tags.indexOf("bb-elite"))){let k=p.ability+1;k>=p.abilities.length&&(k=0);const M=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(p).abilities;if(M[p.abilities[k]].initiative<M[p.abilities[p.ability]].initiative){const C=p.abilities[p.ability];p.abilities[p.ability]=p.abilities[k],p.abilities[k]=C}}}),this.game.figures.filter(p=>p instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&p.drawExtra).forEach(p=>{p instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&(this.drawExtra(p),p.ability>=p.abilities.length&&this.shuffleAbilities(p))})}removeAbility(p,k){const M=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(p);this.game.figures.filter(C=>{if(C instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R){const t=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(C);return M.name==t.name&&M.edition==t.edition}return!1}).map(C=>C).forEach(C=>{C.abilities.splice(k,1)})}restoreAbility(p,k){const M=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(p);this.game.figures.filter(C=>{if(C instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R){const t=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(C);return M.name==t.name&&M.edition==t.edition}return!1}).map(C=>C).forEach(C=>{C.abilities.unshift(M.abilities.indexOf(k))})}restoreDefaultAbilities(p){const k=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(p);this.game.figures.filter(M=>{if(M instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R){const C=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(M);return k.name==C.name&&k.edition==C.edition}return!1}).map(M=>M).forEach(M=>{M.abilities=k.abilities.map((C,t)=>t).filter(C=>!k.abilities[C].level||isNaN(+k.abilities[C].level)||(0,_model_Entity__WEBPACK_IMPORTED_MODULE_3__.hZ)(k.abilities[C].level)<=p.level),M.ability=-1})}shuffleAbilities(p,k=!1){if(k||(p.ability=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.state==_model_Game__WEBPACK_IMPORTED_MODULE_4__.mk.draw||0==p.entities.length?-1:0),p.drawExtra){const v=this.getSameDeckMonster(p);return v?void this.shuffleAbilities(v,k):(console.error("Shuffle for '"+p.name+"' ("+p.deck+" not possible, not same deck monster found!"),p.drawExtra=!1,void this.shuffleAbilities(p,k))}const M=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(p),C=this.game.figures.filter(v=>{if(v instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R){const D=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(v);return M.name==D.name&&M.edition==D.edition}return!1}).map(v=>v);let t=k&&p.ability>-1?p.abilities.splice(0,p.ability+1+C.filter(v=>v.drawExtra).length):[];(0,src_app_ui_helper_Static__WEBPACK_IMPORTED_MODULE_2__.Z)(p.abilities),k&&p.abilities.unshift(...t),C.forEach(v=>{v.abilities=JSON.parse(JSON.stringify(p.abilities)),_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.state==_model_Game__WEBPACK_IMPORTED_MODULE_4__.mk.draw?v.ability=-1:(v.ability=p.ability,v.drawExtra&&this.drawExtra(v))})}drawAbility(p){if(p.drawExtra){const k=this.getSameDeckMonster(p);return k?void this.drawAbility(k):(console.error("Draw for '"+p.name+"' ("+p.deck+" not possible, not same deck monster found!"),p.drawExtra=!1,void this.drawAbility(p))}p.ability+=1,this.hasBottomActions(p)&&(p.ability+=1),this.game.figures.forEach(k=>{k instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&this.getSameDeckMonster(k)&&(k.ability=p.ability,k.drawExtra&&this.drawExtra(k))})}drawnAbilities(p){let k=0;p.ability>=0&&(k=p.ability+1);let M=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.figures.find(C=>C instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&(C.name!=p.name||C.edition!=p.edition)&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(C).name==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(p).name&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(C).edition==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(p).edition&&C.ability>=k);for(;M instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R;)k=M.ability+1,M=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.game.figures.find(C=>C instanceof _model_Monster__WEBPACK_IMPORTED_MODULE_5__.R&&(C.name!=p.name||C.edition!=p.edition)&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(C).name==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(p).name&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(C).edition==_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.deckData(p).edition&&C.ability>=k);return k}getAbility(p,k=!1){if(p.ability<0||p.ability>=p.abilities.length||!_SettingsManager__WEBPACK_IMPORTED_MODULE_13__.f.settings.abilities)return;const M=_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.abilities(p);return M?M[p.abilities[p.ability+(k?p.ability>0?-1:1:0)]]:void 0}hasBottomActions(p){return _GameManager__WEBPACK_IMPORTED_MODULE_12__.E.abilities(p).length>0&&_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.abilities(p).every(k=>_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.hasBottomAbility(k))}sortEntities(p,k){return p.type==_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_11__.N.elite&&k.type==_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_11__.N.normal?-1:p.type==_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_11__.N.normal&&k.type==_model_data_MonsterType__WEBPACK_IMPORTED_MODULE_11__.N.elite?1:_GameManager__WEBPACK_IMPORTED_MODULE_12__.E.monsterManager.sortEntitiesByNumber(p,k)}sortEntitiesByNumber(p,k){return p.summon==_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.new&&k.summon!=_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.new?1:p.summon!=_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.new&&k.summon==_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.new?-1:p.summon==_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.new&&k.summon==_model_Summon__WEBPACK_IMPORTED_MODULE_7__.N5.new?0:p.number<0&&k.number>=0?1:k.number<0&&p.number>=0||p.number<k.number?-1:1}}},37017:(p,k,M)=>{M.d(k,{s:()=>C});class C{level;health;constructor(D,O){this.level=D,this.health=O}}},40392:(p,k,M)=>{M.d(k,{M:()=>t,f:()=>C});class C{type;level;health;movement;attack;range;actions;immunities;special;note;constructor(D,O=0,A=0,E=0,R=0,I=0,U=[],X=[],s=[],T=""){this.type=D,this.level=O,this.health=A,this.movement=E,this.attack=R,this.range=I,this.actions=U||[],this.immunities=X||[],this.special=s||[],this.note=T}}class t{name;health=0;movement=0;attack=0;range=0;initiative=0;flying=!1;actions=void 0;immunities=void 0;special=[];deck=void 0;absolute=!1;note=""}},40840:(p,k,M)=>{M.d(k,{Uc:()=>A,X2:()=>t,di:()=>O,iQ:()=>v,lB:()=>D,rc:()=>C});class C{type;value;valueObject;valueType;subActions;small;hidden;enhancementTypes;constructor(R,I="",U=v.fixed,X=[],s=!1,T=!1){this.type=R,this.value=I,this.valueType=U,this.subActions=X||[],this.small=s,this.hidden=T}}var t=function(E){return E.area="area",E.attack="attack",E.box="box",E.boxFhSubActions="boxFhSubActions",E.card="card",E.concatenation="concatenation",E.concatenationSpacer="concatenationSpacer",E.condition="condition",E.custom="custom",E.damage="damage",E.element="element",E.elementHalf="elementHalf",E.fly="fly",E.forceBox="forceBox",E.grant="grant",E.grid="grid",E.heal="heal",E.hint="hint",E.jump="jump",E.loot="loot",E.monsterType="monsterType",E.move="move",E.nonCalc="nonCalc",E.pierce="pierce",E.pull="pull",E.push="push",E.range="range",E.retaliate="retaliate",E.round="round",E.shield="shield",E.spawn="spawn",E.special="special",E.specialTarget="specialTarget",E.sufferDamage="sufferDamage",E.summon="summon",E.swing="swing",E.switchType="switchType",E.target="target",E.teleport="teleport",E.trigger="trigger",E}(t||{}),v=function(E){return E.plus="plus",E.minus="minus",E.add="add",E.subtract="subtract",E.fixed="fixed",E}(v||{}),D=function(E){return E.all="all",E.allCharacters="allCharacters",E.allies="allies",E.alliesAdjacent="alliesAdjacent",E.alliesAdjacentAffect="alliesAdjacentAffect",E.alliesAffect="alliesAffect",E.alliesEnemies="alliesEnemies",E.alliesRange="alliesRange",E.alliesRangeAffect="alliesRangeAffect",E.ally="ally",E.allyAdjacent="allyAdjacent",E.allyAffect="allyAffect",E.allyAffectAdjacent="allyAffectAdjacent",E.allyAffectRange="allyAffectRange",E.allyShort="allyShort",E.enemies="enemies",E.enemiesAdjacent="enemiesAdjacent",E.enemiesMovedThrough="enemiesMovedThrough",E.enemiesMovedThroughAdjacent="enemiesMovedThroughAdjacent",E.enemiesRange="enemiesRange",E.enemiesRangeAffect="enemiesRangeAffect",E.enemiesRangeAffectExact="enemiesRangeAffectExact",E.enemiesRangeExact="enemiesRangeExact",E.enemy="enemy",E.enemyAdjacent="enemyAdjacent",E.enemyAllyRange="enemyAllyRange",E.enemyOneAll="enemyOneAll",E.enemyRange="enemyRange",E.figures="figures",E.figuresAdjacent="figuresAdjacent",E.figuresRange="figuresRange",E.focusEnemyFarthest="focusEnemyFarthest",E.self="self",E.selfAllies="selfAllies",E.selfAlliesAdjacentAffect="selfAlliesAdjacentAffect",E.selfAlliesAffect="selfAlliesAffect",E.selfAlliesAffectRange="selfAlliesAffectRange",E.selfAlliesRange="selfAlliesRange",E.selfOrAlly="selfOrAlly",E.targets="targets",E}(D||{}),O=function(E){return E.experience="experience",E.lost="lost",E.persistent="persistent",E.recover="recover",E.refresh="refresh",E.round="round",E.slot="slot",E.slotXp="slotXp",E}(O||{});class A{type;value;range;additionalRange=!1;constructor(R,I,U=0){this.type=R,this.value=I,this.range=U}}},42065:(p,k,M)=>{M.d(k,{R:()=>A});var C=M(58317),t=M(13812),v=M(76066),D=M(78164),O=M(73018);class A extends O.f{summonColor=D.rX.blue;statEffect;level;off=!1;active=!1;drawExtra=!1;lastDraw=0;type="monster";getInitiative(){const I=C.E.monsterManager.getAbility(this,C.E.monsterManager.hasBottomActions(this));let U=C.E.gameplayFigure(this)&&I&&I.initiative||100;return this.statEffect&&this.statEffect.initiative&&(U=this.statEffect.absolute?(0,t.hZ)(this.statEffect.initiative):U+(0,t.hZ)(this.statEffect.initiative)),C.E.challengesManager.apply&&C.E.challengesManager.isActive(1501,"fh")&&!this.isAlly&&(U-=10),Math.min(Math.max(U,1),100)}ability=-1;abilities=[];entities=[];isAlly=!1;isAllied=!1;tags=[];constructor(I,U=1){if(super(I),this.errors=I.errors,this.level=U,this.tags=[],I.baseStat&&I.stats)for(let X of I.stats){if(!X.health&&0!=X.health&&(X.health=I.baseStat.health||0),!X.movement&&0!=X.movement&&(X.movement=I.baseStat.movement||0),!X.attack&&0!=X.attack&&(X.attack=I.baseStat.attack||0),!X.range&&0!=X.range&&(X.range=I.baseStat.range||0),X.actions||(X.actions=Object.assign([],I.baseStat.actions)),X.immunities||(X.immunities=Object.assign([],I.baseStat.immunities)),!X.special&&(X.special=[],I.baseStat.special))for(let s of I.baseStat.special)X.special.push(Object.assign([],s));X.note||(X.note=I.baseStat.note),X.type||(X.type=I.baseStat.type)}}toModel(){return new E(this.name,this.edition,this.level,this.off,this.active,this.drawExtra,this.lastDraw,this.ability,this.abilities,this.entities.map(I=>I.toModel()),this.isAlly,this.isAllied,this.tags)}fromModel(I){if(this.edition=I.edition,!this.edition){const U=C.E.monstersData().find(X=>X.name==I.name);this.edition=U?U.edition:""}this.level=I.level,this.off=I.off,this.active=I.active,this.drawExtra=I.drawExtra,this.lastDraw=I.lastDraw,this.abilities=I.abilities&&I.abilities.length>0&&I.abilities||C.E.abilities(this)&&C.E.abilities(this).map((U,X)=>X)||[],this.ability=I.ability,this.entities=this.entities.filter(U=>I.entities.find(X=>X.number==U.number&&X.type==U.type)),I.entities.forEach((U,X)=>{let s=this.entities.find(T=>T.number==U.number&&T.type==U.type);s?X!=this.entities.indexOf(s)&&(this.entities.splice(this.entities.indexOf(s),1),this.entities.splice(X,0,s)):(s=new v.I(U.number,U.type,this),this.entities.splice(X,0,s)),s.fromModel(U)}),this.isAlly=I.isAlly,this.isAllied=I.isAllied,this.statEffect=void 0,this.tags=I.tags||[]}}class E{name;edition;level;off;active;drawExtra;lastDraw;ability;abilities;entities;isAlly;isAllied;tags;constructor(I,U,X,s,T,m,w,q,P,S,$,V,N){this.name=I,this.edition=U,this.level=X,this.off=s,this.active=T,this.drawExtra=m,this.lastDraw=w,this.ability=q,this.abilities=JSON.parse(JSON.stringify(P)),this.entities=JSON.parse(JSON.stringify(S)),this.isAlly=$,this.isAllied=V,this.tags=JSON.parse(JSON.stringify(N))}}},42357:(p,k,M)=>{M.d(k,{BR:()=>O,GV:()=>t,Xo:()=>E,kW:()=>D,mg:()=>v,r5:()=>C});var C=function(R){return R.stun="stun",R.immobilize="immobilize",R.disarm="disarm",R.wound="wound",R.muddle="muddle",R.poison="poison",R.strengthen="strengthen",R.invisible="invisible",R.curse="curse",R.bless="bless",R.regenerate="regenerate",R.ward="ward",R.bane="bane",R.brittle="brittle",R.impair="impair",R.chill="chill",R.infect="infect",R.rupture="rupture",R.dodge="dodge",R.empower="empower",R.enfeeble="enfeeble",R.poison_x="poison_x",R.wound_x="wound_x",R.heal="heal",R.shield="shield",R.retaliate="retaliate",R.safeguard="safeguard",R.plague="plague",R.invalid="invalid",R}(C||{}),t=function(R){return R.action="action",R.standard="standard",R.entity="entity",R.character="character",R.monster="monster",R.objective="objective",R.upgrade="upgrade",R.stack="stack",R.stackable="stackable",R.turn="turn",R.afterTurn="afterTurn",R.expire="expire",R.value="value",R.clearHeal="clearHeal",R.preventHeal="preventHeal",R.apply="apply",R.autoApply="autoApply",R.positive="positive",R.negative="negative",R.neutral="neutral",R.double="double",R.expiredIndicator="expiredIndicator",R.hidden="hidden",R.amDeck="amDeck",R.highlightOnly="highlightOnly",R.special="special",R}(t||{}),v=function(R){return R.new="new",R.normal="normal",R.expire="expire",R.removed="removed",R.turn="turn",R}(v||{});class D{name;types=[];value=1;constructor(I,U=1){"string"==typeof I&&-1==Object.keys(C).indexOf(I)?(console.warn("Invalid condition name: "+I),this.name=C.invalid):this.name=I,this.value=U,this.types.push(t.action),-1!=[C.stun,C.immobilize,C.disarm,C.wound,C.muddle,C.poison,C.invisible,C.strengthen,C.regenerate,C.infect,C.bane,C.brittle,C.chill,C.ward,C.rupture,C.poison_x,C.wound_x,C.safeguard].indexOf(this.name)&&this.types.push(t.entity),-1!=[C.stun,C.immobilize,C.disarm,C.wound,C.muddle,C.poison,C.invisible,C.strengthen,C.regenerate,C.infect,C.bane,C.brittle,C.impair,C.rupture,C.ward,C.dodge,C.safeguard].indexOf(this.name)&&this.types.push(t.standard),(-1!=this.types.indexOf(t.entity)||-1!=[C.impair,C.dodge].indexOf(this.name))&&this.types.push(t.character),(-1!=this.types.indexOf(t.entity)||-1!=[C.plague].indexOf(this.name))&&this.types.push(t.monster),-1!=[C.poison_x,C.wound_x].indexOf(this.name)&&(this.types.push(t.upgrade),this.types.push(t.value)),-1!=[C.chill,C.plague].indexOf(this.name)&&this.types.push(t.stack),-1!=[C.chill,C.plague,C.bless,C.curse,C.enfeeble,C.empower].indexOf(this.name)&&this.types.push(t.stackable),-1!=[C.wound,C.wound_x,C.regenerate].indexOf(this.name)&&this.types.push(t.turn),-1!=[C.bane].indexOf(this.name)&&this.types.push(t.afterTurn),-1!=[C.wound,C.wound_x,C.poison,C.poison_x,C.bane,C.brittle,C.infect,C.rupture].indexOf(this.name)&&this.types.push(t.clearHeal),-1!=[C.poison,C.poison_x,C.ward,C.brittle,C.heal,C.shield].indexOf(this.name)&&this.types.push(t.apply),-1!=[C.ward,C.brittle,C.heal,C.shield,C.safeguard].indexOf(this.name)&&this.types.push(t.autoApply),-1!=[C.poison,C.poison_x].indexOf(this.name)&&this.types.push(t.double),-1!=[C.poison,C.poison_x,C.infect].indexOf(this.name)&&this.types.push(t.preventHeal),-1!=[C.stun,C.immobilize,C.disarm,C.muddle,C.invisible,C.strengthen,C.impair].indexOf(this.name)&&this.types.push(t.expire),-1!=[C.regenerate,C.ward,C.invisible,C.strengthen,C.bless,C.dodge,C.safeguard].indexOf(this.name)&&this.types.push(t.positive),-1!=[C.stun].indexOf(this.name)&&this.types.push(t.expiredIndicator),-1!=[C.heal,C.shield,C.retaliate].indexOf(this.name)&&(this.types.push(t.positive),this.types.push(t.hidden),this.types.push(t.value)),-1!=[C.bless,C.curse,C.empower,C.enfeeble].indexOf(this.name)&&(this.types.push(t.hidden),this.types.push(t.amDeck)),-1!=[C.retaliate].indexOf(this.name)&&this.types.push(t.highlightOnly),-1!=[C.invalid].indexOf(this.name)&&this.types.push(t.hidden),-1!=[C.plague].indexOf(this.name)&&(this.types.push(t.neutral),this.types.push(t.objective),this.types.push(t.special)),-1==this.types.indexOf(t.positive)&&-1==this.types.indexOf(t.neutral)&&this.types.push(t.negative)}}class O extends D{state;lastState;permanent=!1;expired=!1;highlight=!1;constructor(I,U=1){super(I,U),this.state=v.normal,this.lastState=v.new}toModel(){return new A(this.name,this.value,this.state,this.lastState,this.permanent,this.expired,this.highlight)}fromModel(I){this.name=I.name,this.value=I.value,this.state=I.state,this.lastState=I.lastState,this.permanent=I.permanent,this.expired=I.expired,this.highlight=I.highlight}}class A{name;value;state;lastState;permanent;expired;highlight=!1;constructor(I,U,X,s,T,m,w){this.name=I,this.value=U,this.state=X,this.lastState=s,this.permanent=T,this.expired=m,this.highlight=w}}const E=Object.values(C).map(R=>new D(R))},48374:(p,k,M)=>{M.d(k,{T:()=>C});class C{cardId;name;initiative;level=0;shuffle;actions;lost=!1;round=!1;persistent=!1;loss=!1;xp=0;bottomActions;bottomLost=!1;bottomRound=!1;bottomPersistent=!1;bottomLoss=!1;bottomXp=0;bottomShuffle=!1;revealed=!1;replace=!1;constructor(v=void 0,D=void 0,O=0,A=[],E=!1,R=[],I=0){this.cardId=v,this.name=D,this.initiative=O,this.actions=A,this.shuffle=E,this.bottomActions=R,this.level=I}}},49819:(p,k,M)=>{M.d(k,{F3:()=>t,lv:()=>C,yn:()=>v});class C{experience=0;gold=0;loot={};itemNotes="";items=[];equippedItems=[];personalQuest="";personalQuestProgress=[];battleGoals=0;notes="";retired=!1;retirements=0;extraPerks=0;perks=[];masteries=[];donations=0;scenarioStats=[];trial;deck=[];enhancements=[]}class t{dealtDamage=0;monsterDamage=0;otherDamage=0;healedDamage=0;heals=0;normalKills=0;eliteKills=0;bossKills=0;exhausts=0;maxDealtDamage=0;maxDamage=0}class v extends t{scenario;success=!1;level=0;difficulty=0;gold=0;xp=0;treasures=0;loot={};summons=new t}},51571:(p,k,M)=>{M.d(k,{j:()=>t,k:()=>C});class C{name;level;state;attacked;constructor(D="",O=1,A="normal"){this.name=D,this.level=O,this.state=A}}class t{flipped=!1;automated=!0;plots=[]}},51604:(p,k,M)=>{M.d(k,{Di:()=>U,G8:()=>s,Pr:()=>D,hM:()=>C,hV:()=>R,mn:()=>E,r6:()=>t,rz:()=>A,s$:()=>O,yX:()=>X});var C=function(T){return T.money="money",T.material_resources="material_resources",T.herb_resources="herb_resources",T.random_item="random_item",T.special="special",T}(C||{}),t=function(T){return T.money="money",T.lumber="lumber",T.metal="metal",T.hide="hide",T.arrowvine="arrowvine",T.axenut="axenut",T.corpsecap="corpsecap",T.flamefruit="flamefruit",T.rockroot="rockroot",T.snowthistle="snowthistle",T.random_item="random_item",T.special1="special1",T.special2="special2",T}(t||{});const D=[t.arrowvine,t.axenut,t.corpsecap,t.flamefruit,t.rockroot,t.snowthistle],O=[t.lumber,t.metal,t.hide,...D],A=[...O,t.money],E=[...A,t.special1,t.special2,t.random_item];function R(T){return T==t.money?C.money:T==t.random_item?C.random_item:T==t.special1||T==t.special2?C.special:-1!=[t.lumber,t.metal,t.hide].indexOf(T)?C.material_resources:C.herb_resources}class I{type;value4P;value3P;value2P;enhancements=0;cardId;value;constructor(m,w,q,P=-1,S=-1,$=void 0){this.type=m,this.cardId=w,this.value4P=q,this.value3P=q,this.value2P=q,-1!=P&&(this.value3P=P),-1!=S&&(this.value2P=S),this.value=$}}const U=[new I(t.money,1361,1),new I(t.money,1362,1),new I(t.money,1363,1),new I(t.money,1364,1),new I(t.money,1365,1),new I(t.money,1366,1),new I(t.money,1367,1),new I(t.money,1368,1),new I(t.money,1369,1),new I(t.money,1370,1),new I(t.money,1371,1),new I(t.money,1372,1),new I(t.money,1373,2),new I(t.money,1374,2),new I(t.money,1375,2),new I(t.money,1376,2),new I(t.money,1377,2),new I(t.money,1378,2),new I(t.money,1379,3),new I(t.money,1380,3),new I(t.arrowvine,1381,1),new I(t.arrowvine,1382,1),new I(t.axenut,1383,1),new I(t.axenut,1384,1),new I(t.corpsecap,1385,1),new I(t.corpsecap,1386,1),new I(t.flamefruit,1387,1),new I(t.flamefruit,1388,1),new I(t.rockroot,1389,1),new I(t.rockroot,1390,1),new I(t.snowthistle,1391,1),new I(t.snowthistle,1392,1),new I(t.hide,1393,1,2,2),new I(t.hide,1394,1,2,2),new I(t.hide,1395,1,2,2),new I(t.hide,1396,1,1,2),new I(t.hide,1397,1,1,2),new I(t.hide,1398,1,1,2),new I(t.hide,1399,1),new I(t.hide,1400,1),new I(t.lumber,1401,1,2,2),new I(t.lumber,1402,1,2,2),new I(t.lumber,1403,1,2,2),new I(t.lumber,1404,1,1,2),new I(t.lumber,1405,1,1,2),new I(t.lumber,1406,1,1,2),new I(t.lumber,1407,1),new I(t.lumber,1408,1),new I(t.metal,1408,1,2,2),new I(t.metal,1410,1,2,2),new I(t.metal,1411,1,2,2),new I(t.metal,1412,1,1,2),new I(t.metal,1413,1,1,2),new I(t.metal,1414,1,1,2),new I(t.metal,1415,1),new I(t.metal,1416,1),new I(t.random_item,1417,1),new I(t.special1,1418,1,-1,-1,"43.4|133.4|177.3|165.3|168.1|130.4|174.5|106.3|13.2|16.2"),new I(t.special2,1419,1,-1,-1,"36.4|29.1|188.2|182.3|85.1|11.1|128.5|153.4|193.5|9.3")];class X{current=-1;cards=[];active=!1;fromModel(m){this.current=m.current,this.cards=m.cards,s(this.cards),this.active=m.active}}function s(T){T.forEach((m,w,q)=>{if(!m.cardId){const P=U.find(S=>S.type==m.type&&S.value2P==m.value2P&&S.value3P==m.value3P&&S.value4P==m.value4P&&!q.find($=>$.cardId==S.cardId));P?m.cardId=P.cardId:console.warn("Cannot map cardId for loot:",m)}})}},51824:(p,k,M)=>{M.d(k,{K:()=>I});var C=M(58317),t=M(49819),v=M(73219),D=M(98635),O=M(37017),A=M(42357),E=M(34786),R=M(78164);class I extends D.qS{title="";initiative=0;experience=0;loot=0;lootCards=[];treasures=[];exhausted=!1;stat;summons=[];identity=0;progress;donations=0;scenarioStats=new t.yn;initiativeVisible=!1;attackModifierDeckVisible=!1;lootCardsVisible=!1;itemsVisible=!1;fullview=!1;attackModifierDeck;token=0;tokenValues=[];absent=!1;longRest=!1;battleGoals=[];battleGoal=!1;shield;shieldPersistent;retaliate=[];retaliatePersistent=[];level;off=!1;active=!1;type="character";health;maxHealth;entityConditions=[];immunities=[];number=0;markers=[];tags=[];getInitiative(){return this.absent?200:this.exhausted||this.longRest&&("prism"!=this.name||-1==this.tags.indexOf("long_rest"))||this.health<=0?100:C.E.challengesManager.apply&&C.E.challengesManager.isActive(1505,"fh")?this.initiative<90?this.initiative+10:99:this.initiative-.9}constructor(s,T){super(s),this.errors=s.errors||[],T<1?T=1:T>9&&(T=9);const m=this.stats.find(w=>w.level==T);m?(this.stat=m,this.level=T,this.maxHealth=this.stat.health):(!this.errors.find(w=>w.type==E.H.unknown)&&!this.errors.find(w=>w.type==E.H.stat)&&(console.error("No character stat found for level: "+T),this.errors.push(new E.h(E.H.stat,"character",s.name,s.edition,"",""+T))),this.stat=new O.s(T,0),this.level=0,this.maxHealth=0),this.health=this.maxHealth,this.progress=new t.lv,this.attackModifierDeck=C.E.attackModifierManager.buildCharacterAttackModifierDeck(this),this.tokens.forEach((w,q)=>{this.tokenValues[q]=this.tokenValues[q]||0}),this.availableSummons.forEach(w=>w.edition=this.edition)}toModel(){return new U(this.name,this.edition,this.marker,this.title,this.initiative,this.experience,this.loot,this.lootCards||[],this.treasures&&this.treasures.map(s=>""+s)||[],this.exhausted,this.level,this.off,this.active,this.health,this.maxHealth,this.entityConditions.map(s=>s.toModel()),this.immunities,this.markers,this.tags||[],this.identity,this.summons.map(s=>s.toModel()),this.progress,this.scenarioStats,this.initiativeVisible,this.attackModifierDeckVisible,this.lootCardsVisible,this.itemsVisible,this.number,this.attackModifierDeck.toModel(),this.donations,this.token,this.tokenValues,this.absent,this.longRest,this.battleGoals,this.battleGoal,this.shield,this.shieldPersistent,this.retaliate,this.retaliatePersistent,this.fullview)}fromModel(s){if(this.edition=s.edition,!this.edition){const m=C.E.charactersData().find(w=>w.name==s.name);this.edition=m?m.edition:""}if(this.marker=s.marker||this.marker,this.title=s.title,(!this.initiativeVisible||s.initiative<=0||this.initiative!=s.initiative)&&(this.initiativeVisible=s.initiativeVisible),s.number)this.number=s.number;else for(this.number=1;C.E.game.figures.some(m=>m instanceof I&&(m.name!=this.name||m.edition!=this.edition)&&m.number==this.number);)this.number++;this.initiative=s.initiative,this.experience=s.experience,this.loot=s.loot,this.lootCards=s.lootCards||[],this.treasures=s.treasures&&s.treasures.map(m=>isNaN(+m)?m:+m)||[],this.exhausted=s.exhausted,this.level=s.level,this.off=s.off,this.active=s.active,this.health=s.health,this.maxHealth=s.maxHealth,this.entityConditions=[],s.entityConditions&&(this.entityConditions=s.entityConditions.map(m=>{let w=new A.BR(m.name,m.value);return w.fromModel(m),w})),this.immunities=s.immunities||[],this.markers=s.markers||this.markers,this.tags=s.tags||this.tags,this.identity=s.identity||0,this.summons=this.summons.filter(m=>s.summons.some(w=>w.uuid&&w.uuid==m.uuid)),s.summons.forEach((m,w)=>{let q=this.summons.find(P=>m.uuid==P.uuid);q||(q=new R.up(m.uuid,m.name,m.cardId,m.level,m.number,m.color),this.summons.splice(w,0,q)),q.fromModel(m)}),this.summons.sort((m,w)=>s.summons.map(q=>q.uuid).indexOf(m.uuid)-s.summons.map(q=>q.uuid).indexOf(w.uuid)),this.progress=new t.lv,s.progress&&(this.progress=Object.assign(new t.lv,s.progress),this.progress.enhancements&&(Array.isArray(this.progress.enhancements)||(this.progress.enhancements=[])),C.E.characterManager.previousEnhancements(this,C.E.enhancementsManager.temporary)),this.scenarioStats=new t.yn,s.scenarioStats&&(this.scenarioStats=Object.assign(new t.yn,s.scenarioStats));let T=C.E.attackModifierManager.buildCharacterAttackModifierDeck(this);s.attackModifierDeck&&C.E.attackModifierManager.fromModel(T,s.attackModifierDeck),this.mergeAttackModifierDeck(T),s.attackModifierDeckVisible&&(this.attackModifierDeckVisible=!0),s.lootCardsVisible&&(this.lootCardsVisible=!0),s.itemsVisible&&(this.itemsVisible=!0),this.donations=s.donations||0,this.token=s.token||0,this.tokenValues=s.tokenValues||[],this.tokens.forEach((m,w)=>{this.tokenValues[w]=this.tokenValues[w]||0}),this.absent=s.absent,this.longRest=s.longRest,this.battleGoals=s.battleGoals||[],this.battleGoal=s.battleGoal,this.shield=s.shield?JSON.parse(s.shield):void 0,this.shieldPersistent=s.shieldPersistent?JSON.parse(s.shieldPersistent):void 0,this.retaliate=(s.retaliate||[]).map(m=>JSON.parse(m)),this.retaliatePersistent=(s.retaliatePersistent||[]).map(m=>JSON.parse(m)),s.fullView&&(this.fullview=s.fullView)}mergeAttackModifierDeck(s){let T=!1;return this.attackModifierDeck||(this.attackModifierDeck=new v.J,T=!0),(s.discarded.length!=this.attackModifierDeck.discarded.length||!s.discarded.every((m,w)=>this.attackModifierDeck.discarded.indexOf(m)==w))&&(this.attackModifierDeck.discarded=s.discarded,T=!0),this.attackModifierDeck.current!=s.current&&(this.attackModifierDeck.current=s.current,T=!0),this.attackModifierDeck.lastVisible!=s.lastVisible&&(this.attackModifierDeck.lastVisible=s.lastVisible,T=!0),this.attackModifierDeck.state!=s.state&&(this.attackModifierDeck.state=s.state,T=!0),(this.attackModifierDeck.attackModifiers.length!=s.attackModifiers.length||!this.attackModifierDeck.attackModifiers.map(m=>m.id).every((m,w)=>s.attackModifiers[w].id==m))&&(this.attackModifierDeck.attackModifiers=s.attackModifiers,T=!0),(this.attackModifierDeck.cards.length!=s.cards.length||!this.attackModifierDeck.cards.map(m=>m.id).every((m,w)=>s.cards[w].id==m))&&(this.attackModifierDeck.cards=s.cards,T=!0),T}}class U{name;edition;marker;title;initiative;experience;loot;lootCards;treasures;exhausted;level;off;active;health;maxHealth;entityConditions;immunities=[];markers;tags;identity;summons;progress;scenarioStats;initiativeVisible;attackModifierDeckVisible;lootCardsVisible;itemsVisible;number;attackModifierDeck;donations;token;tokenValues;absent;longRest;battleGoals;battleGoal;shield;shieldPersistent;retaliate;retaliatePersistent;fullView;constructor(s,T,m,w,q,P,S,$,V,N,K,Y,j,G,Lt,Jt,Ut,ee,pe,Vt,qt,ue,ne,he,_e,ye,xe,kt,J,ut,He,Ke,We,Ot,dt,Gt,Ae,Ve,Je,Ze,Fe){this.name=s,this.edition=T,this.marker=m,this.title=w,this.initiative=q,this.experience=P,this.loot=S,this.lootCards=JSON.parse(JSON.stringify($)),this.treasures=JSON.parse(JSON.stringify(V)),this.exhausted=N,this.level=K,this.off=Y,this.active=j,this.health=G,this.maxHealth=Lt,this.entityConditions=JSON.parse(JSON.stringify(Jt)),this.immunities=JSON.parse(JSON.stringify(Ut)),this.markers=JSON.parse(JSON.stringify(ee)),this.tags=JSON.parse(JSON.stringify(pe)),this.identity=Vt,this.summons=qt,this.progress=JSON.parse(JSON.stringify(ue)),this.scenarioStats=JSON.parse(JSON.stringify(ne)),this.initiativeVisible=he,this.attackModifierDeckVisible=_e,this.lootCardsVisible=ye,this.itemsVisible=xe,this.number=kt,this.attackModifierDeck=J,this.donations=ut,this.token=He,this.tokenValues=JSON.parse(JSON.stringify(Ke)),this.absent=We,this.longRest=Ot,this.battleGoals=JSON.parse(JSON.stringify(dt)),this.battleGoal=Gt,this.shield=Ae?JSON.stringify(Ae):"",this.shieldPersistent=Ve?JSON.stringify(Ve):"",this.retaliate=Je.map(Ee=>JSON.stringify(Ee)),this.retaliatePersistent=Ze.map(Ee=>JSON.stringify(Ee)),this.fullView=Fe}}},56719:(p,k,M)=>{M.d(k,{X:()=>v});var C=M(42357),t=M(13812);class v{uuid;marker="";dead=!1;dormant=!1;revealed=!1;active=!1;off=!1;level=-1;health;maxHealth;entityConditions=[];immunities=[];number;markers=[];tags=[];shield;shieldPersistent;retaliate=[];retaliatePersistent=[];constructor(A,E,R,I){this.uuid=A,this.number=E,this.marker=I||"",this.maxHealth=(0,t.hZ)(R.health),this.health=this.maxHealth}toModel(){return new D(this.uuid,this.number,this.marker,this.dead,this.active,this.dormant,this.health,this.maxHealth,this.entityConditions.map(A=>A.toModel()),this.immunities,this.markers,this.tags||[],this.shield,this.shieldPersistent,this.retaliate,this.retaliatePersistent)}fromModel(A){this.marker=A.marker,this.dead=A.dead,this.active=A.active,this.dormant=A.dormant,this.health=A.health,this.maxHealth=A.maxHealth,this.entityConditions=[],A.entityConditions&&(this.entityConditions=A.entityConditions.map(E=>{let R=new C.BR(E.name,E.value);return R.fromModel(E),R})),this.immunities=A.immunities||[],this.markers=A.markers||[],this.tags=A.tags||[],this.shield=A.shield?JSON.parse(A.shield):void 0,this.shieldPersistent=A.shieldPersistent?JSON.parse(A.shieldPersistent):void 0,this.retaliate=(A.retaliate||[]).map(E=>JSON.parse(E)),this.retaliatePersistent=(A.retaliatePersistent||[]).map(E=>JSON.parse(E))}}class D{uuid;number;marker;dead;active;dormant;health;maxHealth;entityConditions;immunities;markers;tags;shield;shieldPersistent;retaliate;retaliatePersistent;constructor(A,E,R,I,U,X,s,T,m,w,q,P,S,$,V,N){this.uuid=A,this.number=E,this.marker=R,this.dead=I,this.active=U,this.dormant=X,this.health=s,this.maxHealth=T,this.entityConditions=JSON.parse(JSON.stringify(m)),this.immunities=JSON.parse(JSON.stringify(w)),this.markers=JSON.parse(JSON.stringify(q)),this.tags=JSON.parse(JSON.stringify(P)),this.shield=S?JSON.stringify(S):"",this.shieldPersistent=$?JSON.stringify($):"",this.retaliate=V.map(K=>JSON.stringify(K)),this.retaliatePersistent=N.map(K=>JSON.stringify(K))}}},58317:(p,k,M)=>{M.d(k,{E:()=>f});var C=M(1115),t=M(34786),v=M(60057),D=M(14670),O=M(51824),A=M(29765),E=M(42065),R=M(76066),I=M(34933),U=M(56719),X=M(78164),s=M(48374),T=M(40840),m=M(98635),w=M(42357),q=M(79039),P=M(88826),S=M(25532),$=M(73018),V=M(82e3),N=M(13812),K=M(73219),Y=M(16538),j=M(31619);class G{getValues(c){return c.value&&"string"==typeof c.value?c.value.split(":"):[]}calcActionHints(c,l){let d=[];if(c instanceof E.R&&l instanceof R.I&&d.push(...this.calcMonsterActionHints(c,l)),l instanceof X.up){if(l.action&&l.action.type==T.X2.shield){const h=d.find(u=>u.type==T.X2.shield);h?h.value+=(0,N.hZ)(l.action.value):d.push(new T.Uc(T.X2.shield,(0,N.hZ)(l.action.value)))}if(l.additionalAction&&l.additionalAction.type==T.X2.shield){const h=d.find(u=>u.type==T.X2.shield);h?h.value+=(0,N.hZ)(l.additionalAction.value):d.push(new T.Uc(T.X2.shield,(0,N.hZ)(l.additionalAction.value)))}if(l.action&&l.action.type==T.X2.retaliate){let h=l.action.subActions&&l.action.subActions.find(b=>b.type==T.X2.range);const u=d.find(b=>h&&(1!=(0,N.hZ)(h.value)||b.range&&1!=b.range)?b.type==T.X2.retaliate&&b.range==(0,N.hZ)(h.value):b.type==T.X2.retaliate);u?u.value+=(0,N.hZ)(l.action.value):d.push(new T.Uc(T.X2.retaliate,(0,N.hZ)(l.action.value),h?(0,N.hZ)(h.value):0))}if(l.additionalAction&&l.additionalAction.type==T.X2.retaliate){let h=l.additionalAction.subActions&&l.additionalAction.subActions.find(b=>b.type==T.X2.range);const u=d.find(b=>h&&(1!=(0,N.hZ)(h.value)||b.range&&1!=b.range)?b.type==T.X2.retaliate&&b.range==(0,N.hZ)(h.value):b.type==T.X2.retaliate);u?u.value+=(0,N.hZ)(l.additionalAction.value):d.push(new T.Uc(T.X2.retaliate,(0,N.hZ)(l.additionalAction.value),h?(0,N.hZ)(h.value):0))}}if(l.shield){const h=d.find(u=>u.type==T.X2.shield);h?h.value+=(0,N.hZ)(l.shield.value):d.push(new T.Uc(T.X2.shield,(0,N.hZ)(l.shield.value)))}if(l.shieldPersistent){const h=d.find(u=>u.type==T.X2.shield);h?h.value+=(0,N.hZ)(l.shieldPersistent.value):d.push(new T.Uc(T.X2.shield,(0,N.hZ)(l.shieldPersistent.value)))}return l.retaliate&&l.retaliate.forEach(h=>{let u=h.subActions.find(x=>x.type==T.X2.range);const b=d.find(x=>u&&(1!=(0,N.hZ)(u.value)||x.range&&1!=x.range)?x.type==T.X2.retaliate&&x.range==(0,N.hZ)(u.value):x.type==T.X2.retaliate);b?b.value+=(0,N.hZ)(h.value):d.push(new T.Uc(T.X2.retaliate,(0,N.hZ)(h.value),u?(0,N.hZ)(u.value):0))}),l.retaliatePersistent&&l.retaliatePersistent.forEach(h=>{let u=h.subActions.find(x=>x.type==T.X2.range);const b=d.find(x=>u&&(1!=(0,N.hZ)(u.value)||x.range&&1!=x.range)?x.type==T.X2.retaliate&&x.range==(0,N.hZ)(u.value):x.type==T.X2.retaliate);b?b.value+=(0,N.hZ)(h.value):d.push(new T.Uc(T.X2.retaliate,(0,N.hZ)(h.value),u?(0,N.hZ)(u.value):0))}),d.sort((h,u)=>h.type==T.X2.shield&&u.type!=T.X2.shield?-1:u.type==T.X2.shield&&h.type!=T.X2.shield?1:h.range-u.range)}calcMonsterActionHints(c,l){let d=[];const h=f.monsterManager.getStat(c,l.type);if(this.calcMonsterActionHint(c,l.type,T.X2.shield,h.actions,d),this.calcMonsterActionHint(c,l.type,T.X2.retaliate,h.actions,d),f.entityManager.isAlive(l,!0)&&(!l.active||c.active)){const u=f.game.figures.find(b=>b.active);if(c.active||f.game.state==A.mk.next&&(!u||f.game.figures.indexOf(u)>f.game.figures.indexOf(c))){let b=f.monsterManager.getAbility(c);if(f.monsterManager.hasBottomActions(c)&&c.firstActiveAction){const x=b;b=f.monsterManager.getAbility(c,!0),b&&(this.calcMonsterActionHint(c,l.type,T.X2.shield,"bottom"==c.firstActiveAction?b.bottomActions:b.actions,d),this.calcMonsterActionHint(c,l.type,T.X2.retaliate,"bottom"==c.firstActiveAction?b.bottomActions:b.actions,d)),x&&(this.calcMonsterActionHint(c,l.type,T.X2.shield,"bottom"==c.firstActiveAction?x.actions:x.bottomActions,d),this.calcMonsterActionHint(c,l.type,T.X2.retaliate,"bottom"==c.firstActiveAction?x.actions:x.bottomActions,d))}else b&&(this.calcMonsterActionHint(c,l.type,T.X2.shield,b.actions,d),this.calcMonsterActionHint(c,l.type,T.X2.retaliate,b.actions,d),b.bottomActions&&(this.calcMonsterActionHint(c,l.type,T.X2.shield,b.bottomActions,d,"bottom"),this.calcMonsterActionHint(c,l.type,T.X2.retaliate,b.bottomActions,d,"bottom")))}}return d}calcMonsterActionHint(c,l,d,h,u,b=""){h.forEach((x,F)=>{const z=(b?b+"-":"")+F;if(x.type==d&&"X"!=x.value){let H=new T.Uc(d,(0,N.hZ)(x.value));if(x.subActions&&x.subActions.length>0){let at=x.subActions.find(ct=>ct.type==T.X2.range);if(at)if(at.valueType&&at.valueType!=T.iQ.fixed){const ct=f.monsterManager.getStat(c,l);ct&&at.valueType==T.iQ.plus?H.range=(0,N.hZ)(ct.range)+(0,N.hZ)(at.value):ct&&at.valueType==T.iQ.minus?H.range=(0,N.hZ)(ct.range)-(0,N.hZ)(at.value):(at.valueType==T.iQ.add||at.valueType==T.iQ.subtract)&&(H.additionalRange=at.valueType==T.iQ.add?"add":"substract",H.range=(0,N.hZ)(at.value))}else H.range=(0,N.hZ)(at.value)}let Q=u.find(at=>at.type==H.type&&(!H.additionalRange&&at.range==H.range||at.range&&H.additionalRange));Q?(Q.range&&H.additionalRange&&("add"==H.additionalRange?Q.range+=H.range:Q.range-=H.range),Q.value+=H.value):u.push(H)}else if(x.type==T.X2.monsterType&&x.value==l||x.type==T.X2.concatenation||x.type==T.X2.grid)this.calcMonsterActionHint(c,l,d,x.subActions,u,z);else if(x.type==T.X2.element&&x.valueType==T.iQ.minus&&c.entities.find(H=>H.tags.find(Q=>Q==this.roundTag(x,z))))this.calcMonsterActionHint(c,l,d,x.subActions,u,z);else if(x.type==T.X2.special){const H=c.stats.find(Q=>Q.level==c.level&&Q.type==l);H&&this.calcMonsterActionHint(c,l,d,H.special[(0,N.hZ)(x.value)-1],u,z)}})}roundTag(c,l){return"roundAction-"+(l?l+"-":"")+c.type}isInteractiveAction(c){const l=c.subActions&&c.subActions.find(h=>h.type==T.X2.specialTarget&&(""+h.value).startsWith("self")),d=null!=l;switch(c.type){case T.X2.heal:return d&&c.subActions.every(h=>h==l||h.type==T.X2.condition);case T.X2.condition:return d&&1==c.subActions.length;case T.X2.sufferDamage:return!c.subActions||0==c.subActions.length||d&&1==c.subActions.length;case T.X2.switchType:case T.X2.element:return!0;case T.X2.spawn:case T.X2.summon:return this.getMonsterSpawnData(c).length>0||this.getObjectiveSpawnData(c).length>0}return!1}isInteractiveApplicableAction(c,l,d){if(!this.isInteractiveAction(l)||!f.entityManager.isAlive(c,!0)||-1!=c.tags.indexOf(this.roundTag(l,d)))return!1;switch(l.type){case T.X2.heal:return c.health>0&&c.health<(0,N.hZ)(c.maxHealth);case T.X2.condition:return!f.entityManager.hasCondition(c,new w.kW(""+l.value));case T.X2.switchType:return c instanceof R.I&&(c.type==Y.N.elite||c.type==Y.N.normal);case T.X2.element:const h=this.getValues(l);return l.valueType&&l.valueType!=T.iQ.plus&&l.valueType!=T.iQ.fixed?l.valueType==T.iQ.minus&&this.getElementsToConsume(l).length==h.length&&(!l.subActions||l.subActions.every(b=>!this.isInteractiveAction(b))||l.subActions.some((b,x)=>this.isInteractiveApplicableAction(c,b,(d?d+"-":"")+x))):f.game.elementBoard.some(u=>!(l.value!=S.Hg.wild&&-1==h.indexOf(u.type)||u.state!=S.e_.inert&&u.state!=S.e_.waning&&u.state!=S.e_.consumed&&u.state!=S.e_.partlyConsumed));case T.X2.sufferDamage:case T.X2.spawn:case T.X2.summon:return!0}return!1}getInteractiveActions(c,l,d,h){let u=[];return f.entityManager.isAlive(c,!0)?(d.forEach((b,x)=>{const F=(h?h+"-":"")+x,z=this.roundTag(b,F),H=-1!=c.tags.indexOf(z);if(this.isInteractiveApplicableAction(c,b,F)&&!H&&u.push({action:b,index:F}),b.subActions&&(b.type!=T.X2.monsterType&&!this.isInteractiveAction(b)||H||this.subactionElement(b,c,F)||this.subactionsMonsterType(b,c))&&u.push(...this.getInteractiveActions(c,l,b.subActions,F)),b.type==T.X2.special&&c instanceof R.I&&l instanceof E.R){const Q=l.stats.find(at=>at.level==l.level&&at.type==c.type);Q&&u.push(...this.getInteractiveActions(c,l,Q.special[(0,N.hZ)(b.value)-1],F))}}),u):[]}getAllInteractiveActions(c,l,d){let h=[];return(c instanceof E.R||c instanceof I.$e)&&c.entities.forEach(u=>{f.actionsManager.getInteractiveActions(u,c,l,d).forEach(b=>{null==h.find(x=>x.index==b.index)&&h.push(b)})}),h}subactionElement(c,l,d){return c.type==T.X2.element&&(c.valueType!=T.iQ.minus||this.isInteractiveApplicableAction(l,c,d))}subactionsMonsterType(c,l){return c.type==T.X2.monsterType&&l instanceof R.I&&l.type==c.value}isMultiTarget(c,l=!0){return c.type==T.X2.target&&(0,N.hZ)(c.value)>1||this.isMultiTargetSpecial(c)||l&&c.type==T.X2.area||c.subActions&&c.subActions.some(h=>this.isMultiTarget(h,l))}isMultiTargetSpecial(c){return c.type==T.X2.specialTarget&&"string"==typeof c.value&&(-1!=c.value.toLowerCase().indexOf("allies")||-1!=c.value.toLowerCase().indexOf("enemies")||-1!=c.value.toLowerCase().indexOf("figures")||-1!=c.value.toLowerCase().indexOf("targets")||"all"==c.value)}applyInteractiveAction(c,l,d,h=[],u=!1){const b=d.action,x=d.index;if(!this.isInteractiveApplicableAction(c,b,x)&&!u)return;const F=this.roundTag(b,x);if(-1==c.tags.indexOf(F)){switch(b.type){case T.X2.heal:const z=(0,N.hZ)(b.value,l.level);c.health+=z,f.entityManager.addCondition(c,l,new w.kW(w.r5.heal,z)),b.subActions&&b.subActions.filter(at=>at.type==T.X2.condition).forEach(at=>{f.entityManager.addCondition(c,l,new w.kW(""+at.value))}),f.entityManager.applyCondition(c,l,w.r5.heal,!0);break;case T.X2.condition:if("bless"==b.value||"curse"==b.value){const at=l instanceof E.R?j.f.settings.allyAttackModifierDeck&&(f.fhRules()||j.f.settings.alwaysAllyAttackModifierDeck)&&(l.isAlly||l.isAllied)?f.game.allyAttackModifierDeck:f.game.monsterAttackModifierDeck:l instanceof O.K?l.attackModifierDeck:void 0;at&&f.attackModifierManager.addModifier(at,new K.uU("bless"==b.value?K.Yn.bless:K.Yn.curse))}else f.entityManager.addCondition(c,l,new w.kW(""+b.value));break;case T.X2.sufferDamage:c.health-=(0,N.hZ)(b.value,l.level),c.health<=0&&(c.health=0),(l instanceof E.R&&c instanceof R.I&&c.health<=0||l instanceof I.$e&&c instanceof U.X&&c.health<=0)&&(c.dead=!0);break;case T.X2.switchType:if(l instanceof E.R&&c instanceof R.I){const at=l.stats.find(gt=>gt.level==l.level&&gt.type==Y.N.normal),ct=l.stats.find(gt=>gt.level==l.level&&gt.type==Y.N.elite);at&&ct&&(c.type=c.type==Y.N.elite?Y.N.normal:Y.N.elite,c.maxHealth=(0,N.hZ)(c.type==Y.N.normal?at.health:ct.health,l.level),(c.health>c.maxHealth||c.health<c.maxHealth&&c.health==(0,N.hZ)(c.type==Y.N.normal?ct.health:at.health,c.level))&&(c.health=c.maxHealth))}break;case T.X2.element:if(l instanceof E.R&&l.entities.forEach(at=>{at!=c&&at.tags.push(F)}),b.valueType==T.iQ.minus){let at=this.getValues(b).map(gt=>gt),ct=this.getElementsToConsume(b).map(gt=>gt.type);at=at.map(gt=>gt==S.Hg.wild?h.shift()||ct.shift():(ct.shift(),gt)).map(gt=>gt),at.forEach(gt=>{f.game.elementBoard.forEach(wt=>{if(wt.type==gt&&(wt.state==S.e_.strong||wt.state==S.e_.waning))if(wt.state=S.e_.partlyConsumed,l instanceof E.R&&c instanceof R.I){const Ft=l.entities.filter(ie=>this.isInteractiveApplicableAction(ie,b,x));Ft.length&&Ft.indexOf(c)==Ft.length-1&&(wt.state=S.e_.consumed)}else if(l instanceof I.$e&&c instanceof U.X){const Ft=l.entities.filter(ie=>this.isInteractiveApplicableAction(ie,b,x));Ft.length&&Ft.indexOf(c)==Ft.length-1&&(wt.state=S.e_.consumed)}else wt.state=S.e_.consumed})})}else this.getValues(b).forEach((at,ct)=>{const gt=h[ct]?h[ct]:at;f.game.elementBoard.forEach(wt=>{wt.type==gt&&wt.state!=S.e_.always&&(wt.state=S.e_.new)})});break;case T.X2.spawn:case T.X2.summon:const H=this.getMonsterSpawnData(b);for(let at of H)if(at.monster&&at.monster.type){const ct=l instanceof E.R?l.edition:f.game.scenario?f.game.scenario.edition:f.currentEdition(),gt=f.monsterManager.addMonsterByName(at.monster.name,ct);if(gt){const wt="string"==typeof at.count?(0,N.hZ)(at.count.replaceAll("HP",""+c.health).replaceAll("H",""+(0,N.hZ)(c.maxHealth)),c.level):at.count||1,Ft=Math.min(f.monsterManager.monsterStandeeMax(gt)-f.monsterManager.monsterStandeeCount(gt),wt);for(let ie=0;ie<Ft;ie++){const le=f.monsterManager.spawnMonsterEntity(gt,at.monster.type,gt.isAlly,gt.isAllied,gt.drawExtra,b.type==T.X2.summon);if(le){if(at.monster.marker&&(le.marker=at.monster.marker),at.monster.health){let _n=at.monster.health;"string"==typeof _n&&(_n=_n.replaceAll("H",""+c.health)),le.health=(0,N.hZ)(_n),le.health>le.maxHealth&&(le.health=le.maxHealth)}(le.marker||le.tags.length>0)&&f.addEntityCount(gt,le)}}}}const Q=this.getObjectiveSpawnData(b);for(let at of Q)if(l instanceof E.R){const ct=at.count?(0,N.hZ)(at.count):1,gt=f.game.figures.find(wt=>wt instanceof I.$e&&f.additionalIdentifier(l).equals(wt.objectiveId))||f.objectiveManager.addObjective(at.objective,at.objective.name,f.additionalIdentifier(l));if(ct>1)for(let wt=0;wt<ct;wt++){const Ft=f.objectiveManager.addObjectiveEntity(gt);if(Ft){if(at.objective.marker&&(Ft.marker=at.objective.marker),at.objective.health){let ie=at.objective.health;"string"==typeof ie&&(ie=ie.replaceAll("H",""+c.health)),Ft.health=(0,N.hZ)(ie),Ft.health>Ft.maxHealth&&(Ft.health=Ft.maxHealth)}(Ft.marker||Ft.tags.length>0)&&f.addEntityCount(gt,Ft)}}}}c.tags.push(F)}}getMonsterSpawnData(c){let l=[];if(c.type!=T.X2.spawn&&c.type!=T.X2.summon)return l;if("monsterStandee"==c.value){l=JSON.parse(JSON.stringify(c.valueObject)).map(h=>h);const d=Math.max(2,f.characterManager.characterCount());l=l.filter(h=>!!(h.monster.type||d<3&&h.monster.player2||3==d&&h.monster.player3||d>3&&h.monster.player4)||!j.f.settings.calculate),l.forEach(h=>{h.monster.type||(d<3&&h.monster.player2?h.monster.type=h.monster.player2:3==d&&h.monster.player3?h.monster.type=h.monster.player3:d>3&&h.monster.player4&&(h.monster.type=h.monster.player4))})}return l}getObjectiveSpawnData(c){let l=[];return c.type!=T.X2.spawn&&c.type!=T.X2.summon||"objectiveSpawn"==c.value&&(l=JSON.parse(JSON.stringify(c.valueObject)).map(d=>d),l=l.filter(d=>!d.count||(0,N.hZ)(d.count)>0)),l}getElementsToConsume(c){let l=[];return c.type==T.X2.element&&c.valueType==T.iQ.minus&&this.getValues(c).forEach((h,u,b)=>{const x=f.game.elementBoard.find(F=>(F.type==h||h==S.Hg.wild&&-1==b.indexOf(F.type))&&F.state!=S.e_.inert&&F.state!=S.e_.new&&F.state!=S.e_.consumed&&-1==l.indexOf(F));x&&l.push(x)}),l}}var Lt=M(18102);class Jt{game;constructor(c){this.game=c}getBattleGoalEditions(){return f.editionData.filter(c=>-1!=j.f.settings.editions.indexOf(c.edition)&&c.battleGoals&&c.battleGoals.length>0).map(c=>c.edition)}getBattleGoals(c=!0,l=!1){return f.editionData.filter(d=>-1!=j.f.settings.editions.indexOf(d.edition)&&(f.game.edition&&f.editionRules(d.edition)||-1!=f.game.battleGoalEditions.indexOf(d.edition))).flatMap(d=>d.battleGoals.filter(h=>!c||!this.game.filteredBattleGoals||0==this.game.filteredBattleGoals.length||!this.game.filteredBattleGoals.find(u=>h.edition==u.edition&&h.name==u.name))).filter((d,h,u)=>l||!d.alias||!u.find(b=>d.alias&&b.edition==d.alias.edition&&b.name==d.alias.name))}getUnrevealedBattleGoals(c=void 0){return this.getBattleGoals().filter(l=>!this.game.figures.find(d=>d instanceof O.K&&(!c||d!=c)&&d.battleGoals&&d.battleGoals.find(h=>l.edition==h.edition&&l.name==h.name)))}getBattleGoalsForEdition(c){return f.editionData.filter(l=>l.edition==c||-1!=f.editionExtensions(c).indexOf(c)).flatMap(l=>l.battleGoals)}getBattleGoal(c){return this.getBattleGoals(void 0,!0).find(l=>l.edition==c.edition&&l.name==c.name)}drawBattleGoal(c,l=!1){let d=this.getUnrevealedBattleGoals();if(f.trialsManager.apply&&f.trialsManager.activeTrial("fh",360)&&(d=d.filter(h=>2==h.checks)),d.length){let h=d[Math.floor(Math.random()*d.length)];c.battleGoals=c.battleGoals||[],l&&c.battleGoals.length>2?c.battleGoals.splice(c.battleGoals.length-2,0,new v.gw(h.name,h.edition)):c.battleGoals.push(new v.gw(h.name,h.edition))}}}var Ut=M(51571);class ee{game;petsAvailable=!1;petsEnabled=!1;gardenAvailable=!1;gardenEnabled=!1;distillAvailable=!1;constructor(c){this.game=c}update(){this.petsAvailable=f.fhRules()&&null!=f.game.party.buildings.find(c=>"stables"==c.name&&c.level),this.petsEnabled=this.petsAvailable&&j.f.settings.fhPets,this.gardenAvailable=f.fhRules()&&null!=f.game.party.buildings.find(c=>"garden"==c.name&&c.level),this.gardenEnabled=this.gardenAvailable&&j.f.settings.fhGarden,this.distillAvailable=(j.f.settings.characterItems||j.f.settings.characterSheet)&&f.fhRules()&&null!=f.game.party.buildings.find(c=>"alchemist"==c.name&&c.level>1&&"wrecked"!=c.state)}applyRewards(c){if(c.defense&&(this.game.party.defense+=c.defense),c.loseMorale&&(this.game.party.morale-=c.loseMorale,this.game.party.morale<0&&(this.game.party.morale=0)),c.prosperity&&(this.game.party.prosperity+=c.prosperity),c.soldiers){this.game.party.soldiers+=c.soldiers;const l=this.game.party.buildings.find(d=>"barracks"==d.name);if(l){let d=0;1==l.level?d=4:2==l.level?d=6:3==l.level?d=8:4==l.level&&(d=10),this.game.party.soldiers>d&&(this.game.party.soldiers=d)}}}rewardSection(c){if(f.game.party.conclusions.find(d=>d.edition==c.edition&&d.index==c.index&&d.group==c.group))return c;const l=f.sectionData(c.edition).filter(d=>d.conclusion&&!d.parent&&d.parentSections&&d.parentSections.find(h=>1==h.length&&-1!=h.indexOf(c.index)));if(0!=l.length){let d;return l.forEach(h=>{d||(d=this.rewardSection(h))}),d}}initialBuilding(c){return 0==c.costs.prosperity&&0==c.costs.lumber&&0==c.costs.metal&&0==c.costs.hide&&0==c.costs.gold}availableBuilding(c){return c.prosperityUnlock&&c.costs.prosperity<=f.prosperityLevel()&&!f.game.party.buildings.find(l=>c.name==l.name&&l.level)&&(!c.requires||null!=f.game.party.buildings.find(l=>l.name==c.requires&&l.level))}nextWeek(){if(this.gardenEnabled){const c=this.game.party.buildings.find(l=>"garden"==l.name&&l.level);this.game.party.garden=this.game.party.garden||new Ut.j,c&&(this.game.party.garden.flipped=c.level<3&&!this.game.party.garden.flipped,this.game.party.garden.automated&&(c.level>2||this.game.party.garden.flipped)&&this.game.party.garden.plots.forEach(l=>{this.game.party.loot[l]=(this.game.party.loot[l]||0)+1}))}}}var pe=M(83492);class Vt{game;available=!1;enabled=!1;apply=!1;constructor(c){this.game=c}drawCard(c){c.current++,c.current>=c.cards.length&&(c.current=c.cards.length-1)}shuffleDeck(c,l=!1){const d=c.current,h=c.finished;let u=l&&d>-1?c.cards.splice(0,d+1):[];c.current=-1,c.finished=-1,c.keep=[],(0,D.Z)(c.cards),l&&(c.current=d,c.finished=h,c.cards.unshift(...u))}getChallengeCard(c){return f.challengesData(c.edition).find(l=>l.cardId==+c.name)}clearDrawn(c,l=!1){let d=[];if(l&&c.keep.forEach(h=>{d.push(c.cards[h])}),c.current>=0){for(let h=c.current;h>c.finished;h--)if(!l||-1==c.keep.indexOf(h)){const u=c.cards.splice(h,1);u.length&&c.cards.push(u[0])}c.keep=l?d.map(h=>c.cards.indexOf(h)):[],c.current=c.finished+(l?c.keep.length:0)}}toggleKeep(c,l,d){-1==c.keep.indexOf(l)?(c.keep.length==d&&c.keep.splice(0,1),c.keep.push(l)):c.keep.splice(c.keep.indexOf(l),1)}update(){if(this.available=f.fhRules()&&null!=this.game.party.buildings.find(c=>"town-hall"==c.name&&c.level),this.enabled=j.f.settings.fhChallenges&&f.fhRules()&&null!=this.game.party.buildings.find(c=>"town-hall"==c.name&&c.level&&"wrecked"!=c.state),this.apply=j.f.settings.fhChallengesApply&&this.enabled,this.available&&this.game.edition){const c=f.challengesData(this.game.edition);c.length&&(!this.game.challengeDeck||!this.game.challengeDeck.cards.length)&&(this.game.challengeDeck=new pe.lV,this.game.challengeDeck.cards=c.map(l=>{const d=new pe.W2;return d.cardId=l.cardId,d.edition=l.edition,d}),this.game.challengeDeck.current=-1,this.shuffleDeck(this.game.challengeDeck))}this.apply&&this.applyCardsAlways()}activeCards(c=void 0,l=!1){return this.available&&this.game.challengeDeck.cards.length&&this.game.challengeDeck.current>this.game.challengeDeck.finished&&(l||!f.roundManager.firstRound)||this.game.state==A.mk.next?this.game.challengeDeck.cards.slice(this.game.challengeDeck.finished+1,this.game.challengeDeck.current+1).filter(d=>!c||d.edition==c||-1!=f.editionExtensions(c).indexOf(d.edition)):[]}activeCardIds(c=void 0){return this.activeCards(c).map(l=>l.cardId)}isActive(c,l=void 0){return-1!=this.activeCardIds(l).indexOf(c)}applyCardsStart(){this.activeCards(void 0,!0).forEach(c=>{this.applyCardStart(c)})}applyCardStart(c){if("fh"==c.edition)switch(c.cardId){case 1486:for(let d=0;d<3;d++)f.attackModifierManager.addModifier(this.game.monsterAttackModifierDeck,new K.uU(K.Yn.bless));break;case 1496:this.game.monsterAttackModifierDeck.cards=this.game.monsterAttackModifierDeck.cards.filter(d=>d.type!=K.Yn.plus0);break;case 1503:const l=f.charactersData("fh").filter(d=>!(d.spoiler&&-1==this.game.unlockedCharacters.indexOf(d.edition+":"+d.name)||this.game.figures.find(h=>h instanceof O.K&&h.edition==d.edition&&h.name==d.name)));if(l.length){const d=l[Math.floor(Math.random()*l.length)];let h=f.attackModifierManager.perkCards(d);h.forEach((u,b)=>{u.id="challenge-fh-1503-"+d.name+"-"+b,u.character=!0});for(let u=0;u<5;u++){let b=h.splice(Math.floor(Math.random()*h.length),1)[0];this.game.monsterAttackModifierDeck.cards.push(b)}f.attackModifierManager.shuffleModifiers(this.game.monsterAttackModifierDeck)}}}applyCardsAlways(){this.activeCards().forEach(c=>{this.applyCardAlways(c),this.game.figures.forEach(l=>{l instanceof E.R&&this.applyCardStatEffect(l,c)})})}applyCardAlways(c){if("fh"==c.edition)switch(c.cardId){case 1484:this.game.monsterAttackModifierDeck.cards.forEach(l=>{(!l.effects||0==l.effects.length)&&(l.type==K.Yn.minus1||l.type==K.Yn.minus2||l.type==K.Yn.null)&&(l.effects=[],l.effects.push(new K.hM(K.hY.changeType,K.Yn.plus0)))});break;case 1485:this.game.monsterAttackModifierDeck.cards.forEach(l=>{(!l.effects||0==l.effects.length)&&l.type==K.Yn.minus2&&(l.effects=[],l.effects.push(new K.hM(K.hY.changeType,K.Yn.double)))});break;case 1523:if(2==this.game.round&&this.game.state==A.mk.draw){let l=this.game.figures.find(d=>d instanceof E.R&&"fh"==d.edition&&"hound"==d.name);if(!l||-1==l.tags.indexOf("challenge-fh-1523")){if(!l){const d=f.monstersData("fh").find(h=>"hound"==h.name);d?l=f.monsterManager.addMonster(d,this.game.level):console.error("Unknown state: Monster Data for hound missing apply FH Challenge 1523!")}if(l){l.tags.push("challenge-fh-1523");for(let d=0;d<f.characterManager.characterCount();d++)f.monsterManager.spawnMonsterEntity(l,Y.N.normal)}}}}}applyCardsTrigger(c){this.activeCards().forEach(l=>{l.cardId==c&&this.applyCardTrigger(l)})}applyCardTrigger(c){if("fh"==c.edition&&1526===c.cardId){const l=this.game.figures.filter(d=>d instanceof E.R).map(d=>d.entities.filter(h=>f.entityManager.isAlive(h)).length);l.length&&l.reduce((d,h)=>d+h)<f.characterManager.characterCount()&&this.game.figures.forEach(d=>{d instanceof E.R&&d.entities.forEach(h=>{f.entityManager.isAlive(h)&&f.entityManager.addCondition(h,d,new w.kW(w.r5.ward))})})}}applyCardStatEffect(c,l){"fh"==l.edition&&c.entities.forEach(d=>{if(f.entityManager.isAlive(d))switch(l.cardId){case 1492:if(d.health!=d.maxHealth||d.tags&&-1!=d.tags.indexOf("challenge-fh-1492")){if(d.health<d.maxHealth&&d.tags&&-1!=d.tags.indexOf("challenge-fh-1492")){const b=d.retaliatePersistent.find(x=>!(x.type!=T.X2.retaliate||2!=x.value||x.valueType!=T.iQ.fixed||x.subActions&&x.subActions.length));b&&d.retaliatePersistent.splice(d.retaliatePersistent.indexOf(b),1),d.tags.splice(d.tags.indexOf("challenge-fh-1492"))}}else d.tags=d.tags||[],d.tags.push("challenge-fh-1492"),d.retaliatePersistent.push(new T.rc(T.X2.retaliate,2));break;case 1493:(!d.tags||-1==d.tags.indexOf("challenge-fh-1493"))&&(d.tags=d.tags||[],d.tags.push("challenge-fh-1493"),d.maxHealth+=Math.ceil(this.game.level/2),d.health+=Math.ceil(this.game.level/2));break;case 1496:(!d.immunities||-1==d.immunities.indexOf(w.r5.curse))&&(!d.tags||-1==d.tags.indexOf("challenge-fh-1496"))&&(d.tags=d.tags||[],d.tags.push("challenge-fh-1496"),d.immunities.push(w.r5.curse));break;case 1515:const h=c.entities.find(b=>b.type==Y.N.elite&&f.entityManager.isAlive(b));!h||d.type!=Y.N.normal||d.tags&&-1!=d.tags.indexOf("challenge-fh-1515")?!h&&d.tags&&-1!=d.tags.indexOf("challenge-fh-1515")&&(d.shieldPersistent&&(1==d.shieldPersistent.value?d.shieldPersistent=void 0:d.shieldPersistent.value=(0,N.hZ)(d.shieldPersistent.value)-1),d.tags.splice(d.tags.indexOf("challenge-fh-1515"))):(d.tags=d.tags||[],d.tags.push("challenge-fh-1515"),d.shieldPersistent?d.shieldPersistent.value=(0,N.hZ)(d.shieldPersistent.value)+1:d.shieldPersistent=new T.rc(T.X2.shield,1));break;case 1524:const u=d.entityConditions.filter(b=>-1!=b.types.indexOf(w.GV.negative)&&b.state!=w.mg.removed&&!b.expired);u.length||d.tags&&-1!=d.tags.indexOf("challenge-fh-1524")?u.length&&d.tags&&-1!=d.tags.indexOf("challenge-fh-1524")&&(d.shieldPersistent&&(1==d.shieldPersistent.value?d.shieldPersistent=void 0:d.shieldPersistent.value=(0,N.hZ)(d.shieldPersistent.value)-1),d.tags.splice(d.tags.indexOf("challenge-fh-1524"))):(d.tags=d.tags||[],d.tags.push("challenge-fh-1524"),d.shieldPersistent?d.shieldPersistent.value=(0,N.hZ)(d.shieldPersistent.value)+1:d.shieldPersistent=new T.rc(T.X2.shield,1))}})}}var qt=M(58167),ue=M(37017),ne=M(24074);class he{game;xpMap=[0,45,95,150,210,275,345,420,500];constructor(c){this.game=c}characterIcon(c){let l;return l=c instanceof m.qS?c:f.getCharacterData(c),l.iconUrl?l.iconUrl:l.icon?"./assets/images/character/icons/"+l.icon+".svg":"./assets/images/character/icons/"+l.edition+"-"+l.name+".svg"}characterIdentityIcon(c,l){const d=f.getCharacterData(c);return d.identities&&0!=d.identities.length?"./assets/images/character/icons/"+d.edition+"-"+d.name+"-"+d.identities[l]+".svg":this.characterIcon(c)}characterName(c,l=!1,d=!1,h=!0){let u=j.f.getLabel("data.character."+c.edition+"."+c.name),b=!1;return h&&c.identities.length>0&&j.f.settings.characterIdentities?c.title&&c.title.split("|")[c.identity]&&c.title.split("|")[c.identity]?(u=c.title.split("|")[c.identity],b=!0):j.f.settings.characterIdentityHint&&!l&&(u+=" ("+j.f.getLabel("data.character."+c.edition+"."+c.name+"."+c.identities[c.identity])+")"):c.title&&(u=c.title,b=!0),l&&b&&(u+=" ("+j.f.getLabel("data.character."+c.edition+"."+c.name)+")"),d&&(u="%game.characterIconColored."+c.name+"%"+u),this.game.figures.find(x=>x instanceof O.K&&x.name==c.name&&x.edition!=c.edition)&&(u+=" ["+j.f.getLabel("data.edition."+c.edition)+"]"),u}characterColor(c){let l;return l=c instanceof m.qS?c:f.getCharacterData(c),l.color}characterThumbnail(c){return c.thumbnailUrl?c.thumbnailUrl:c.thumbnail?"./assets/images/character/thumbnail/"+c.thumbnail+".png":"./assets/images/character/thumbnail/"+c.edition+"-"+c.name+".png"}characterCount(c=!1){return!c&&this.game.playerCount>0?this.game.playerCount:this.game.figures.filter(l=>l instanceof O.K&&!l.absent).length}addCharacter(c,l){if(!this.game.figures.some(d=>d instanceof O.K&&d.name==c.name&&d.edition==c.edition)){let d=new O.K(c,l);for(d.availableSummons.filter(h=>h.special).forEach(h=>this.createSpecialSummon(d,h)),d.number=1;f.game.figures.some(h=>h instanceof O.K&&h.number==d.number);)d.number++;this.game.party.retirements&&this.game.party.retirements.forEach(h=>{h.number==d.number&&d.progress.retirements++}),0==d.progress.gold&&(f.fhRules()?d.progress.gold=10*f.prosperityLevel()+20:f.editionRules("jotl")||(d.progress.gold=15*(d.level+1))),d.tags.push("new-character"),this.game.figures.push(d),f.addEntityCount(d),this.previousEnhancements(d,f.enhancementsManager.temporary),this.game.state==A.mk.next&&f.attackModifierManager.shuffleModifiers(d.attackModifierDeck),f.sortFigures(d)}this.game.levelCalculation&&f.levelManager.calculateScenarioLevel(),f.trialsManager.applyTrialCards()}removeCharacter(c,l=!1){const d=this.game.figures.indexOf(c);if(-1!=d){if(this.game.figures.splice(d,1),l&&j.f.settings.applyRetirement&&(f.game.party.prosperity+=f.fhRules(!0)?2:1,j.f.settings.events&&c.retireEvent&&c.retireEvent.split("|").forEach(h=>{h.split(":").length>1?f.eventCardManager.addEvent(h.split(":")[0],h.split(":")[1],!0):(f.eventCardManager.addEvent("city",h,!0),f.eventCardManager.addEvent("road",h,!0))})),c.marker){const h=c.edition+"-"+c.name;this.game.figures.forEach(u=>{u instanceof O.K?(u.markers.splice(u.markers.indexOf(h),1),u.summons&&u.summons.forEach(b=>{b.markers.splice(b.markers.indexOf(h),1)})):(u instanceof E.R||u instanceof I.$e)&&u.entities.forEach(b=>{b.markers.splice(b.markers.indexOf(h),1)})})}this.game.levelCalculation&&f.levelManager.calculateScenarioLevel()}}addSummon(c,l){c.summons=c.summons.filter(d=>d.name!=l.name||d.number!=l.number||d.color!=l.color),"cs"==c.edition&&"skull"==c.name&&l.cardId&&c.availableSummons.find(d=>d.cardId==l.cardId)&&(l.tags.push("cs-skull-spirit"),l.state=X.N5.true),c.summons.push(l),"boneshaper"==c.name&&(-1!=c.tags.indexOf("solid-bones")||-1!=c.tags.indexOf("unholy-prowess"))&&"shambling-skeleton"===l.name&&(l.maxHealth+=1,l.health==l.maxHealth-1&&(l.health=l.maxHealth),-1!=c.tags.indexOf("solid-bones")&&(l.movement+=1,l.action=new T.rc(T.X2.pierce,1))),"astral"==c.name&&-1!=c.tags.indexOf("veil-of-protection")&&(l.health+=3,l.maxHealth+=3)}removeSummon(c,l){if(c.summons.splice(c.summons.indexOf(l),1),"astral"==c.name&&-1!=c.tags.indexOf("imbue-with-life")&&"animated-claymore"==l.name){let d=c.entityConditions.find(h=>h.name==w.r5.disarm);c.tags=c.tags.filter(h=>"imbue-with-life"!=h),d&&(d.permanent=!1,d.state=w.mg.expire)}}addXP(c,l,d=!0){c.progress.experience+=l,d&&this.setLevel(c,this.levelForXp(c.progress.experience))}levelForXp(c){let l=0;return this.xpMap.forEach((d,h)=>{c>=d&&(l=h+1)}),l}setLevel(c,l){const d=c.stats.find(u=>u.level==l);d?c.stat=d:(c.errors=c.errors||[],!c.errors.find(u=>u.type==t.H.unknown)&&!c.errors.find(u=>u.type==t.H.stat)&&(console.error("No character stat found for level: "+l),c.errors.push(new t.h(t.H.stat,"character",c.name,c.edition,"",""+l))),c.stat=new ue.s(l,0)),c.level=l;const h=c.health==c.maxHealth;c.maxHealth=c.stat.health,"shackles"==c.name&&"fh"==c.edition&&2==c.progress.perks[11]&&(c.maxHealth+=5),"astral"==c.name&&-1!=c.tags.indexOf("veil-of-protection")&&(c.maxHealth+=3),c.progress.equippedItems.find(u=>"fh"==u.edition&&"3"==u.name)&&(c.maxHealth+=1,c.health+=1),(c.health>c.maxHealth||h)&&(c.health=c.maxHealth),c.availableSummons.filter(u=>u.special).forEach(u=>this.createSpecialSummon(c,u)),(c.progress.experience<f.characterManager.xpMap[l-1]||c.progress.experience>=f.characterManager.xpMap[l])&&(c.progress.experience=f.characterManager.xpMap[l-1]),this.game.levelCalculation&&f.levelManager.calculateScenarioLevel(),c.bb&&(c.attackModifierDeck=f.attackModifierManager.buildCharacterAttackModifierDeck(c))}createSpecialSummon(c,l){if(c.summons=c.summons.filter(d=>d.name!=l.name||0!=d.number||d.color!=X.rX.custom),!l.level||l.level<=c.level){let d=new X.up((0,qt.v4)(),l.name,l.cardId,c.level,0,X.rX.custom,l);d.state=X.N5.true,d.init=!1,this.addSummon(c,d)}}ignoreNegativeItemEffects(c){let l=c.perks.find(d=>d.custom&&(-1!=d.custom.indexOf("%game.custom.perks.ignoreNegativeItem%")||-1!=d.custom.indexOf("%game.custom.perks.ignoreNegativeItemFh%")));if(l){const d=c.perks.indexOf(l);return c.progress.perks[d]&&l.combined?c.progress.perks[d]==l.count:c.progress.perks[d]>0}return!1}ignoreNegativeScenarioffects(c){let l=c.perks.find(d=>d.custom&&(-1!=d.custom.indexOf("%game.custom.perks.ignoreNegativeScenario%")||-1!=d.custom.indexOf("%game.custom.perks.ignoreScenario%")));if(l){const d=c.perks.indexOf(l);return c.progress.perks[d]&&l.combined?c.progress.perks[d]==l.count:c.progress.perks[d]>0}return!1}itemEffect(c){return"gh"==c.edition?"number"==typeof c.id&&-1!=[16,38,52,101,103,108].indexOf(c.id):"cs"==c.edition?"number"==typeof c.id&&-1!=[157,71].indexOf(c.id):"toa"==c.edition?"number"==typeof c.id&&-1!=[101,107].indexOf(c.id):"fh"==c.edition&&"number"==typeof c.id&&-1!=[3,11,41,60,132,138,178].indexOf(c.id)}applyDonations(c){for(let l=0;l<c.donations;l++)if(f.editionRules("cs")){const d=K.bx.filter(u=>!u.rolling&&!this.game.figures.find(b=>b instanceof O.K&&b.attackModifierDeck.cards.find(x=>x.id==u.id))),h=K.bx.filter(u=>u.rolling&&!this.game.figures.find(b=>b instanceof O.K&&b.attackModifierDeck.cards.find(x=>x.id==u.id)));d.length>0&&f.attackModifierManager.addModifier(c.attackModifierDeck,d[Math.floor(Math.random()*d.length)]),h.length>0&&f.attackModifierManager.addModifier(c.attackModifierDeck,h[Math.floor(Math.random()*h.length)])}else f.attackModifierManager.addModifier(c.attackModifierDeck,new K.uU(K.Yn.bless)),f.attackModifierManager.addModifier(c.attackModifierDeck,new K.uU(K.Yn.bless));c.donations=0}next(){this.game.figures.forEach(c=>{c instanceof O.K&&(c.initiative=0,c.initiativeVisible=!1,c.off=!1,j.f.settings.characterAttackModifierDeckPermanent||(c.attackModifierDeckVisible=!1),c.lootCardsVisible=!1,c.longRest=!1,c.summons=c.summons.filter(l=>f.entityManager.isAlive(l)),c.summons.forEach(l=>{l.state==X.N5.new&&(l.state=X.N5.true)}),c instanceof O.K&&"blinkblade"==c.name&&c.tags.find(l=>"time_tokens"===l)&&0==c.primaryToken&&(c.identity=0),c.progress.equippedItems.find(l=>"cs"==l.edition&&"57"==l.name)&&f.entityManager.hasCondition(c,new w.kW(w.r5.wound))&&!f.entityManager.hasCondition(c,new w.kW(w.r5.regenerate))&&f.entityManager.addCondition(c,c,new w.kW(w.r5.regenerate)),c.tags&&(c.tags=c.tags.filter(l=>!l.startsWith("roundAction-"))),f.trialsManager.apply&&f.trialsManager.trialsEnabled&&j.f.settings.battleGoals&&c.progress.trial&&"fh"==c.progress.trial.edition&&"356"==c.progress.trial.name&&-1!=c.tags.indexOf("trial-fh-356")&&(c.tags.splice(c.tags.indexOf("trial-fh-356"),1),f.battleGoalManager.drawBattleGoal(c,!0)))})}draw(){this.game.figures.forEach(c=>{c instanceof O.K&&(1==this.game.round&&(this.applyDonations(c),c.initiativeVisible=!0),f.entityManager.isAlive(c)&&!c.absent&&(c.off=!1),"blinkblade"==c.name&&c.tags.find(l=>"time_tokens"===l)&&0==c.primaryToken&&(0==c.identity&&c.tokenValues[0]<2?c.tokenValues[0]+=1:1==c.identity&&(c.tokenValues[0]>0?c.tokenValues[0]-=1:(c.identity=0,c.tokenValues[0]=1))),f.trialsManager.apply&&f.trialsManager.trialsEnabled&&j.f.settings.battleGoals&&c.progress.trial&&"fh"==c.progress.trial.edition&&"356"==c.progress.trial.name&&-1!=c.tags.indexOf("trial-fh-356")&&c.tags.splice(c.tags.indexOf("trial-fh-356"),1))})}personalQuestByCard(c,l){return f.editionData.filter(d=>d.edition==c||-1!=f.editionExtensions(c).indexOf(d.edition)).flatMap(d=>d.personalQuests).find(d=>d.cardId==l||d.altId==l||d.altId=="0"+l)}previousEnhancements(c,l){c.progress.enhancements=c.progress.enhancements?c.progress.enhancements.filter(d=>!d.inherited):[],l||(f.game.party.retirements.filter(h=>h.edition==c.edition&&h.name==c.name).forEach(h=>{h&&h.progress&&h.progress.enhancements&&c.progress.enhancements.push(...h.progress.enhancements.filter(u=>!u.inherited).map(u=>new ne.V(u.cardId,u.actionIndex,u.index,u.action,!0)))}),c.progress.enhancements=c.progress.enhancements.filter((h,u,b)=>{const x=b.find(F=>F.cardId==h.cardId&&F.actionIndex==h.actionIndex&&F.index==h.index);return!x||u===b.indexOf(x)})),c.progress.enhancements.filter(d=>-1!=d.actionIndex.indexOf("custom")).forEach(d=>{const h=f.deckData(c).abilities.find(u=>u.cardId==d.cardId);if(h){const u=this.enhancementMapping(-1==d.actionIndex.indexOf("bottom")?h.actions:h.bottomActions||[],-1==d.actionIndex.indexOf("bottom")?"":"bottom");u.length&&u[d.index]&&(d.actionIndex=u[d.index],d.index=d.index-u.indexOf(d.actionIndex))}})}enhancementMapping(c,l){let d=[];return c.forEach((h,u)=>{if(h.type!=T.X2.custom||"%character.abilities.wip%"!=h.value){const b=(l?l+"-":"")+u;h.enhancementTypes&&h.enhancementTypes.forEach(x=>{d.push(b)}),h.subActions&&d.push(...this.enhancementMapping(h.subActions,b))}}),d}getActiveCharacters(){return this.game.figures.filter(c=>c instanceof O.K&&f.gameplayFigure(c)&&!c.absent).map(c=>c)}}var _e=M(12120);class ye{game;fh=!1;temporary=!1;enhancerLevel=0;squareActions=[T.X2.move,T.X2.attack,T.X2.range,T.X2.shield,T.X2.push,T.X2.pull,T.X2.pierce,T.X2.retaliate,T.X2.heal,T.X2.target,T.X2.teleport];circleActions=[T.X2.move,T.X2.attack,T.X2.range,T.X2.shield,T.X2.push,T.X2.pull,T.X2.pierce,T.X2.retaliate,T.X2.heal,T.X2.target,T.X2.teleport];diamondActions=[T.X2.attack,T.X2.condition,T.X2.push,T.X2.pull];diamondPlusActions=[T.X2.heal,T.X2.condition,T.X2.shield,T.X2.retaliate];hexActions=[T.X2.area];summonActions=[T.X2.move,T.X2.attack,T.X2.range,T.X2.heal];diamondConditions=[w.r5.poison,w.r5.wound,w.r5.muddle,w.r5.immobilize,w.r5.disarm,w.r5.curse];diamondPlusConditions=[w.r5.strengthen,w.r5.bless,w.r5.regenerate];constructor(c){this.game=c}update(){this.fh=f.fhRules(!0)||j.f.settings.alwaysFhEnhancements,this.temporary=j.f.settings.temporaryEnhancements,this.enhancerLevel=this.fh&&this.game.party.buildings.find(c=>"enhancer"==c.name&&c.level&&"wrecked"!=c.state)?.level||0,this.fh?(this.diamondConditions=[w.r5.poison,w.r5.wound,w.r5.muddle,w.r5.immobilize,w.r5.curse],this.diamondPlusConditions=[w.r5.strengthen,w.r5.bless,w.r5.regenerate,w.r5.ward]):(this.diamondConditions=[w.r5.poison,w.r5.wound,w.r5.muddle,w.r5.immobilize,w.r5.disarm,w.r5.curse],this.diamondPlusConditions=[w.r5.strengthen,w.r5.bless,w.r5.regenerate])}calculateCosts(c,l=1,d,h,u=!1){let b=0;return b+=this.calculateBaseCosts(c,d),b>0&&(f.actionsManager.isMultiTarget(c)&&(b*=2),this.fh&&"lost"==d&&(b/=2),this.fh&&!f.gh2eRules()&&"persistent"==d&&(b*=3),b+=this.levelCosts(l),b+=this.enhancementCosts(h),this.fh&&this.temporary&&(h&&(b-=20),u||(b=Math.ceil(.8*b))),this.enhancerLevel>1&&!u&&(b-=10)),b}calculateBaseCosts(c,l=void 0){let d=0;if("summon"==l)switch(c.type){case T.X2.move:d+=this.fh?60:this.temporary?40:100;break;case T.X2.attack:d+=!this.fh&&this.temporary?60:100;break;case T.X2.range:d+=!this.fh&&this.temporary?40:50;break;case T.X2.heal:d+=this.fh?40:this.temporary?30:50}else switch(c.type){case T.X2.move:d+=!this.fh&&this.temporary?20:30;break;case T.X2.attack:d+=!this.fh&&this.temporary?35:50;break;case T.X2.range:d+=!this.fh&&this.temporary?20:30;break;case T.X2.target:d+=this.fh?75:this.temporary?40:50;break;case T.X2.shield:d+=this.fh?80:this.temporary?60:100;break;case T.X2.retaliate:d+=this.fh?60:this.temporary?40:100;break;case T.X2.pierce:d+=!this.fh&&this.temporary?15:30;break;case T.X2.heal:case T.X2.push:d+=!this.fh&&this.temporary?20:30;break;case T.X2.pull:d+=this.fh?20:this.temporary?15:30;break;case T.X2.teleport:d+=this.fh?50:40;break;case T.X2.jump:d+=this.fh?60:this.temporary?35:50;break;case T.X2.element:d+=c.value!=S.Hg.wild?!this.fh&&this.temporary?60:100:!this.fh&&this.temporary?90:150;break;case T.X2.condition:switch(c.value){case w.r5.poison:d+=this.fh?50:this.temporary?30:75;break;case w.r5.wound:d+=!this.fh&&this.temporary?45:75;break;case w.r5.muddle:d+=this.fh?40:this.temporary?25:50;break;case w.r5.immobilize:d+=this.fh?150:100;break;case w.r5.disarm:d+=this.fh?0:150;break;case w.r5.curse:d+=this.fh?150:this.temporary?100:75;break;case w.r5.strengthen:d+=this.fh||this.temporary?100:50;break;case w.r5.bless:d+=this.fh?75:50;break;case w.r5.regenerate:d+=this.fh?40:50;break;case w.r5.ward:d+=this.fh?75:0}break;case T.X2.area:{const h=(""+c.value).split("|").map(u=>(0,_e.dy)(u)).filter(u=>u).map(u=>u);d+=Math.ceil(200/(h.filter(u=>u.type==_e.Gq.target).length||1));break}}return d}levelCosts(c){return c<1?c=1:c>9&&(c=9),(c-1)*(!this.fh&&this.temporary?10:this.enhancerLevel>2?15:25)}enhancementCosts(c){return c<0&&(c=0),c*(!this.fh&&this.temporary?20:this.enhancerLevel>3?50:75)}}class xe{game;constructor(c){this.game=c}entities(c,l=!1){let d=[];return c instanceof O.K?this.isAlive(c,l)&&d.push(c):(c instanceof E.R||c instanceof I.$e)&&(d=c.entities.filter(h=>this.isAlive(h,l)||!l&&h.dormant)),d}entitiesAll(c,l=!0,d=!1){let h=[];return c instanceof O.K&&(!l||this.isAlive(c,d))?(h.push(c),h.push(...c.summons.filter(u=>!l||this.isAlive(u,d)))):(c instanceof E.R||c instanceof I.$e)&&h.push(...c.entities.filter(u=>!l||this.isAlive(u,d))),h}getIndexedEntities(c=!1){let l=[];return Object.assign([],this.game.figures).sort((h,u)=>c?f.sortFiguresByTypeAndName(h,u):0).forEach(h=>{h instanceof O.K?(l.push({entity:h,figure:h}),h.summons.forEach(u=>{l.push({entity:u,figure:h})})):(h instanceof E.R||h instanceof I.$e)&&h.entities.forEach(u=>{l.push({entity:u,figure:h})})}),l}getIndexForEntity(c,l=!1){let d=-1;return this.getIndexedEntities(l).forEach((h,u)=>{h.entity!=c||(d=u)}),d}isAlive(c,l=!1){return!(c.health<=0&&(0,N.hZ)(c.maxHealth)>0&&!c.entityConditions.find(d=>d.highlight&&-1!=d.types.indexOf(w.GV.apply))||l&&c.entityConditions.find(d=>d.name==w.r5.stun&&d.state!=w.mg.new&&d.lastState!=w.mg.new&&d.state!=w.mg.removed)||(c instanceof O.K?c.exhausted||c.absent:c instanceof R.I?c.dead||c.dormant||l&&c.summon==X.N5.new:c instanceof X.up?c.dead||c.dormant||l&&c.state==X.N5.new:!(c instanceof U.X)||c.dead||c.dormant))}checkHealth(c,l){let d=(0,N.hZ)(c.maxHealth);c instanceof O.K&&"lightning"==c.name&&c.tags.find(h=>"unbridled-power"===h)&&(d=Math.max(d,26)),d>0&&c.health>d&&(c.health=d),d>0&&c.health<=0&&!c.entityConditions.find(h=>j.f.settings.applyConditions&&j.f.settings.activeApplyConditions&&h.highlight&&-1!=h.types.indexOf(w.GV.apply)&&-1==j.f.settings.activeApplyConditionsExcludes.indexOf(h.name)&&-1==j.f.settings.activeApplyConditionsAuto.indexOf(h.name))?!(c instanceof O.K)||c.off&&c.exhausted?(c instanceof R.I||c instanceof X.up||c instanceof U.X)&&!c.dead&&(c.dead=!0,setTimeout(()=>{f.uiChange.emit()},j.f.settings.animations?1500*j.f.settings.animationSpeed:0)):(c.off=!0,c.exhausted=!0):c.health<0&&(c.health=0),c.health>0&&(c instanceof O.K&&c.exhausted?(c.off=!1,c.exhausted=!1):(c instanceof R.I||c instanceof X.up||c instanceof U.X)&&c.dead&&(c.dead=!1))}changeHealth(c,l,d,h=!1){this.changeHealthHighlightConditions(c,l,d,h),c.health+=d,this.checkHealth(c,l),j.f.settings.scenarioStats&&0!=d&&(d>0?f.scenarioStatsManager.applyHeal(c,l,d):f.scenarioStatsManager.applyDamage(c,l,-1*d)),d<1&&c instanceof O.K&&f.trialsManager.apply&&f.trialsManager.trialsEnabled&&c.progress.trial&&"fh"==c.progress.trial.edition&&"356"==c.progress.trial.name&&-1==c.tags.indexOf("trial-fh-356")&&c.tags.push("trial-fh-356")}changeHealthHighlightConditions(c,l,d,h=!1){if(j.f.settings.applyConditions){const u=c.entityConditions.find(b=>!b.expired&&b.state!=w.mg.new&&!b.permanent&&b.name==w.r5.regenerate&&!this.isImmune(c,l,b.name)&&-1==j.f.settings.applyConditionsExcludes.indexOf(b.name));if(u&&d<0&&(u.expired=!0),this.sufferDamageHighlightConditions(c,l,d,h),u&&c.entityConditions.find(b=>!b.expired&&b.state!=w.mg.new&&b.name==w.r5.ward&&b.highlight&&!this.isImmune(c,l,b.name))&&(u.expired=!1),c.health+d>c.health){const b=c.entityConditions.find(F=>-1!=F.types.indexOf(w.GV.clearHeal)&&!F.expired&&!this.isImmune(c,l,F.name));let x=c.entityConditions.find(F=>F.name==w.r5.heal);b&&(!x||x.expired||!x.highlight)&&(x||(x=new w.BR(w.r5.heal,d),c.entityConditions.push(x)),x.expired=!1,x.highlight=!0,x.value=d,j.f.settings.applyConditions&&j.f.settings.activeApplyConditions&&-1!=j.f.settings.activeApplyConditionsAuto.indexOf(w.r5.heal)&&this.applyCondition(c,l,w.r5.heal,!0))}}}sufferDamageHighlightConditions(c,l,d,h=!1){if(j.f.settings.applyConditions){if(d<0&&!h){let F=0;[w.r5.retaliate,w.r5.shield].forEach(z=>{let H=c.entityConditions.find(Q=>Q.name==z);if(!H||H.expired||!H.highlight)if(H||(H=new w.BR(z,0),c.entityConditions.push(H)),H.value=0,f.actionsManager.calcActionHints(l,c).forEach(at=>{H&&(z==w.r5.shield&&at.type==T.X2.shield||z==w.r5.retaliate&&at.type==T.X2.retaliate)&&(H.value+=at.value)}),z==w.r5.shield&&H.value&&c.health+d+H.value>0){if(H.expired=!1,H.highlight=!0,F=H.value,j.f.settings.applyConditions&&j.f.settings.activeApplyConditions&&-1!=j.f.settings.activeApplyConditionsAuto.indexOf(z))return this.applyCondition(c,l,z,!0,!0),void this.sufferDamageHighlightConditions(c,l,d+H.value,!0)}else if(z==w.r5.retaliate&&H.value)return H.expired=!1,H.highlight=!0,this.applyCondition(c,l,z,!0,!0),void this.sufferDamageHighlightConditions(c,l,d+H.value,!0)}),c.entityConditions.filter(z=>z.name==w.r5.poison||z.name==w.r5.poison_x).forEach(z=>{z.highlight=d<0&&!z.expired&&z.state!=w.mg.new&&c.health+d>-F&&!this.isImmune(c,l,z.name)})}const u=c.entityConditions.find(F=>!F.expired&&F.state!=w.mg.new&&F.name==w.r5.ward&&!this.isImmune(c,l,F.name)),b=c.entityConditions.find(F=>!F.expired&&F.state!=w.mg.new&&F.name==w.r5.brittle&&!this.isImmune(c,l,F.name));let x=!(c.entityConditions.find(F=>!F.expired&&F.state!=w.mg.new&&F.name==w.r5.poison&&!this.isImmune(c,l,F.name))&&-1==j.f.settings.applyConditionsExcludes.indexOf(w.r5.poison)||c.entityConditions.find(F=>!F.expired&&F.state!=w.mg.new&&F.name==w.r5.poison_x&&!this.isImmune(c,l,F.name))&&-1==j.f.settings.applyConditionsExcludes.indexOf(w.r5.poison_x));d<0&&u&&!b&&c.health+d-Math.floor(d/2)>0?(u.value=-1*d,u.highlight=!0,j.f.settings.applyConditions&&j.f.settings.activeApplyConditions&&-1!=j.f.settings.activeApplyConditionsAuto.indexOf(w.r5.ward)&&x&&this.applyCondition(c,l,w.r5.ward,!0,!0)):u&&(u.highlight=!1),b&&!u&&d<0&&c.health+d>0?(b.value=-1*d,b.highlight=!0,j.f.settings.applyConditions&&j.f.settings.activeApplyConditions&&-1!=j.f.settings.activeApplyConditionsAuto.indexOf(w.r5.brittle)&&x&&this.applyCondition(c,l,w.r5.brittle,!0,!0)):b&&(b.highlight=!1),b&&u&&(b.highlight=!1,u.highlight=!1,d<0&&(b.expired=!0,u.expired=!0))}if(d<0&&!h&&j.f.settings.calculateAdvantageStats&&j.f.settings.animations&&this.game.figures.find(u=>u instanceof O.K&&u.active)&&l instanceof E.R&&c instanceof R.I){const u=this.game.figures.find(F=>F instanceof O.K&&F.active),b=u.entityConditions.find(F=>F.name==w.r5.muddle&&!F.expired),x=u.entityConditions.find(F=>F.name==w.r5.strengthen&&!F.expired);if(b||f.monsterManager.getStat(l,c.type).actions&&f.monsterManager.getStat(l,c.type).actions.find(F=>"%game.custom.disadvantage%"==F.value)){if(!x){const F=b||new w.BR(w.r5.muddle);F.highlight=!0,b||(F.types.push(w.GV.hidden),u.entityConditions.push(F)),setTimeout(()=>{F.highlight=!1,b||u.entityConditions.splice(u.entityConditions.indexOf(F),1),f.uiChange.emit()},1e3*j.f.settings.animationSpeed)}}else x&&!b&&(x.highlight=!0,setTimeout(()=>{x.highlight=!1,f.uiChange.emit()},1e3*j.f.settings.animationSpeed))}}hasCondition(c,l,d=!1){return c.entityConditions.some(h=>h.name==l.name&&h.state!=w.mg.removed&&!h.expired&&(!d||h.permanent))}activeConditions(c,l=!1,d=!1){return c.entityConditions.filter(h=>(!h.expired||l&&-1!=h.types.indexOf(w.GV.expiredIndicator))&&(d||-1==h.types.indexOf(w.GV.hidden)))}isImmune(c,l,d,h=!1){let u=!1;if(c.immunities&&-1!=c.immunities.indexOf(d)&&!h)return!0;if(l instanceof E.R&&c instanceof R.I){const b=f.monsterManager.getStat(l,c.type);u=null!=b&&null!=b.immunities&&-1!=b.immunities.indexOf(d)}else if(c instanceof O.K){let b=[];c.progress.equippedItems.find(x=>"gh"==x.edition&&"38"==x.name)&&b.push(w.r5.stun,w.r5.muddle),c.progress.equippedItems.find(x=>"gh"==x.edition&&"52"==x.name)&&b.push(w.r5.poison,w.r5.wound),c.progress.equippedItems.find(x=>"gh"==x.edition&&"103"==x.name)&&b.push(w.r5.poison,w.r5.wound),c.progress.equippedItems.find(x=>"cs"==x.edition&&"57"==x.name)&&b.push(w.r5.muddle),c.progress.equippedItems.find(x=>"fh"==x.edition&&"138"==x.name)&&b.push(w.r5.disarm,w.r5.stun,w.r5.muddle),"blinkblade"==c.name&&"fh"==c.edition&&c.progress.perks[10]?b.push(w.r5.immobilize):"coral"==c.name&&"fh"==c.edition&&c.progress.perks[7]?b.push(w.r5.impair):"prism"==c.name&&"fh"==c.edition&&c.progress.perks[9]&&b.push(w.r5.wound),u=-1!=b.indexOf(d)}else if(c instanceof X.up&&l instanceof O.K&&"prism"==l.name&&-1!=c.tags.indexOf("prism_mode"))return!0;if(!u){if(d==w.r5.wound_x)return this.isImmune(c,l,w.r5.wound,h);if(d==w.r5.poison_x)return this.isImmune(c,l,w.r5.poison,h);if(d==w.r5.rupture)return this.isImmune(c,l,w.r5.wound,h);if(d==w.r5.infect)return this.isImmune(c,l,w.r5.poison,h);if(d==w.r5.chill)return this.isImmune(c,l,w.r5.immobilize,h)||this.isImmune(c,l,w.r5.muddle,h)}return u}addCondition(c,l,d,h=!1){let u=c.entityConditions.find(b=>b.name==d.name);u?(u.expired=!1,u.lastState=u.state,u.state=w.mg.normal):(u=new w.BR(d.name,d.value),c.entityConditions.push(u)),l.active||-1==u.types.indexOf(w.GV.expire)?l.active&&-1!=u.types.indexOf(w.GV.turn)?(u.lastState=u.state,u.state=w.mg.turn):l.active&&-1!=u.types.indexOf(w.GV.afterTurn)?u.state=w.mg.new:!l.active&&-1!=u.types.indexOf(w.GV.afterTurn)&&(u.lastState=w.mg.normal):(!l.off&&!l.active&&(u.lastState=u.state),u.state=w.mg.expire),l.off&&-1!=u.types.indexOf(w.GV.turn)&&(u.lastState=u.state,u.state=w.mg.expire),u.permanent=h,u.highlight=!1,f.challengesManager.apply&&f.challengesManager.isActive(1487,"fh")&&-1!=u.types.indexOf(w.GV.negative)&&u.name!=w.r5.wound&&c instanceof O.K&&!this.isImmune(c,c,w.r5.wound)&&this.addCondition(c,l,new w.kW(w.r5.wound)),j.f.settings.applyConditions&&-1==j.f.settings.applyConditionsExcludes.indexOf(w.r5.safeguard)&&this.hasCondition(c,new w.kW(w.r5.safeguard))&&-1!=u.types.indexOf(w.GV.negative)&&(this.removeCondition(c,l,u),this.removeCondition(c,l,new w.kW(w.r5.safeguard)))}removeCondition(c,l,d,h=!1){c.entityConditions=c.entityConditions.filter(u=>u.name!=d.name||u.permanent!=h),f.challengesManager.apply&&f.challengesManager.isActive(1525,"fh")&&-1!=d.types.indexOf(w.GV.negative)&&c instanceof R.I&&this.addCondition(c,l,new w.kW(w.r5.strengthen))}applyCondition(c,l,d,h=!1,u=!1){const b=c.entityConditions.find(x=>x.name==d&&!x.expired&&(-1!=x.types.indexOf(w.GV.apply)||-1!=x.types.indexOf(w.GV.highlightOnly)));if(b&&!this.isImmune(c,l,b.name)){if(b.name==w.r5.poison||b.name==w.r5.poison_x){c.health-=b.value;const x=c.entityConditions.find(z=>!z.expired&&z.state!=w.mg.new&&z.name==w.r5.ward&&!this.isImmune(c,l,z.name)),F=c.entityConditions.find(z=>!z.expired&&z.state!=w.mg.new&&z.name==w.r5.brittle&&!this.isImmune(c,l,z.name));x&&!F&&(x.value+=b.value),F&&!x&&(F.value+=b.value),this.checkHealth(c,l)}if(b.name==w.r5.ward){const x=Math.floor(b.value/2);if(u)c.health+=b.value-x;else if(c.health+=b.value,!u){this.checkHealth(c,l),c.health-=x;const F=c.entityConditions.find(z=>!z.expired&&z.state!=w.mg.new&&!z.permanent&&z.name==w.r5.regenerate&&!this.isImmune(c,l,z.name)&&-1==j.f.settings.applyConditionsExcludes.indexOf(z.name));F&&x>0&&(F.expired=!0),this.checkHealth(c,l)}b.value=1,b.expired=!0}if(b.name==w.r5.brittle&&(u?c.health-=b.value:(c.health+=b.value,this.checkHealth(c,l),c.health-=2*b.value,this.checkHealth(c,l)),b.value=1,b.expired=!0),b.name==w.r5.shield){c.health+=b.value,u||this.checkHealth(c,l),b.expired=!0;const x=c.entityConditions.find(z=>!z.expired&&z.state!=w.mg.new&&z.name==w.r5.ward&&!this.isImmune(c,l,z.name));x&&x.highlight&&(x.value-=b.value);const F=c.entityConditions.find(z=>!z.expired&&z.state!=w.mg.new&&z.name==w.r5.brittle&&!this.isImmune(c,l,z.name));F&&F.highlight&&(F.value-=b.value)}if(b.name==w.r5.retaliate&&(b.expired=!0),b.name==w.r5.heal){const x=c.entityConditions.find(z=>-1!=z.types.indexOf(w.GV.preventHeal)&&z.state!=w.mg.expire&&!z.expired&&!this.isImmune(c,l,z.name));x&&(c.health-=b.value);let F=c.entityConditions.find(z=>-1!=z.types.indexOf(w.GV.clearHeal)&&!z.permanent&&!z.expired);for(;F;)F.lastState=F.state,F.state=w.mg.expire,F.expired=!0,F=c.entityConditions.find(z=>-1!=z.types.indexOf(w.GV.clearHeal)&&!z.permanent&&!z.expired);!x&&c.health-b.value>=(0,N.hZ)(c.maxHealth)&&(b.highlight=!1),this.checkHealth(c,l),b.expired=!0}h&&j.f.settings.animations?(b.highlight=!0,setTimeout(()=>{b.highlight=!1,f.uiChange.emit()},1e3*j.f.settings.animationSpeed)):b.highlight=!1,b.permanent&&(b.expired=!1)}}declineApplyCondition(c,l,d){const h=c.entityConditions.find(u=>u.name==d&&!u.expired&&-1!=u.types.indexOf(w.GV.apply));h&&(h.highlight=!1,h.permanent||(h.name==w.r5.heal&&(h.expired=!0),h.name==w.r5.shield&&(h.expired=!0)))}restoreConditions(c){c.entityConditions.forEach(l=>{l.name==w.r5.chill&&(l.expired?l.expired=!1:l.value++),-1!=l.types.indexOf(w.GV.expire)&&l.expired&&(l.expired=!1)})}expireConditions(c,l){c.entityConditions.forEach(h=>{h.name==w.r5.chill&&(1!=h.value||h.permanent?h.value--:h.expired=!0)});let d=!1;c.entityConditions.forEach(h=>{-1!=h.types.indexOf(w.GV.expire)&&h.state==w.mg.expire&&!h.permanent&&(h.expired=!0,-1!=h.types.indexOf(w.GV.negative)&&(d=!0))}),f.challengesManager.apply&&d&&l instanceof E.R&&!l.isAlly&&c instanceof R.I&&(f.challengesManager.isActive(1524,"fh")&&this.changeHealth(c,l,-1,!0),f.challengesManager.isActive(1525,"fh")&&this.addCondition(c,l,new w.kW(w.r5.strengthen)))}applyConditionsTurn(c,l){const d=c.entityConditions.find(h=>!h.expired&&h.state==w.mg.normal&&h.name==w.r5.regenerate&&!this.isImmune(c,l,h.name)&&-1==j.f.settings.applyConditionsExcludes.indexOf(h.name));if(d){const h=(0,N.hZ)(c.maxHealth),u=c.entityConditions.every(b=>b.expired||-1==b.types.indexOf(w.GV.preventHeal)||this.isImmune(c,l,b.name))&&c.health<h;if(c.entityConditions.filter(b=>!b.expired&&-1!=b.types.indexOf(w.GV.clearHeal)&&!b.permanent).forEach(b=>{b.expired=!0,b.lastState=b.state,b.state=w.mg.removed}),u){let b=c.entityConditions.find(x=>-1!=x.types.indexOf(w.GV.clearHeal)&&x.state!=w.mg.expire&&x.state!=w.mg.new&&!x.permanent&&!x.expired);for(;b;)b.lastState=b.state,b.state=w.mg.expire,b.expired=!0,b=c.entityConditions.find(x=>-1!=x.types.indexOf(w.GV.clearHeal)&&x.state!=w.mg.expire&&x.state!=w.mg.new&&!x.permanent&&!x.expired);d.lastState=d.state,d.state=w.mg.expire,c.health+=d.value,this.checkHealth(c,l)}d.highlight=!0,setTimeout(()=>{d.highlight=!1},1e3*j.f.settings.animationSpeed)}c instanceof O.K&&c.progress.equippedItems.find(h=>"fh"==h.edition&&"178"==h.name)&&c.initiative>=60&&!c.longRest&&(c.health=c.health+1,c.entityConditions.push(new w.BR(w.r5.heal,1)),this.applyCondition(c,l,w.r5.heal,!0)),c.entityConditions.filter(h=>!h.expired&&h.state==w.mg.normal&&-1!=h.types.indexOf(w.GV.turn)).forEach(h=>{!this.isImmune(c,l,h.name)&&-1==j.f.settings.applyConditionsExcludes.indexOf(h.name)&&(h.lastState=h.state,h.state=w.mg.turn,(h.name==w.r5.wound||h.name==w.r5.wound_x)&&(c.health=c.health-h.value,c instanceof O.K&&c.progress.equippedItems.find(u=>"cs"==u.edition&&"71"==u.name)&&(c.health=c.health+h.value+1,c.entityConditions.push(new w.BR(w.r5.heal,1)),this.applyCondition(c,l,w.r5.heal,!0)),this.checkHealth(c,l),h.highlight=!0,setTimeout(()=>{h.highlight=!1,(!(c instanceof O.K)||!c.progress.equippedItems.find(u=>"cs"==u.edition&&"71"==u.name))&&(this.sufferDamageHighlightConditions(c,l,-h.value,!0),this.checkHealth(c,l))},1e3*j.f.settings.animationSpeed)))}),c.entityConditions.filter(h=>!h.expired&&-1!=h.types.indexOf(w.GV.afterTurn)&&!h.permanent).forEach(h=>{h.state==w.mg.normal?(h.lastState=h.state,h.state=w.mg.turn):h.state==w.mg.new&&h.lastState!=w.mg.new&&(h.lastState=h.state,h.state=w.mg.normal)}),c.entityConditions.filter(h=>!h.expired&&-1!=h.types.indexOf(w.GV.expire)&&!h.permanent).forEach(h=>{h.state==w.mg.expire&&h.lastState==w.mg.new&&(h.lastState=w.mg.normal)})}unapplyConditionsTurn(c,l){c.entityConditions.filter(h=>h.state==w.mg.turn&&-1!=h.types.indexOf(w.GV.turn)&&-1==j.f.settings.applyConditionsExcludes.indexOf(h.name)).forEach(h=>{h.expired?h.expired=!1:(h.lastState=h.state,h.state=w.mg.normal,(h.name==w.r5.wound||h.name==w.r5.wound_x)&&(c.health=c.health+h.value,this.checkHealth(c,l)))});const d=c.entityConditions.find(h=>h.name==w.r5.regenerate&&-1==j.f.settings.applyConditionsExcludes.indexOf(h.name));if(d){const h=c.entityConditions.every(u=>-1==u.types.indexOf(w.GV.preventHeal))&&d.state==w.mg.expire;c.entityConditions.filter(u=>u.expired&&-1!=u.types.indexOf(w.GV.clearHeal)).forEach(u=>u.expired=!1),h&&(d.lastState=d.state,d.state=w.mg.normal,c.health-=d.value,this.checkHealth(c,l))}c instanceof O.K&&c.progress.equippedItems.find(h=>"fh"==h.edition&&"178"==h.name)&&c.initiative>=60&&!c.longRest&&c.entityConditions.find(h=>h.name==w.r5.heal&&1==h.value&&h.expired)&&(c.entityConditions=c.entityConditions.filter(h=>h.name!=w.r5.heal||1!=h.value||!h.expired),c.health=c.health-1)}applyConditionsAfter(c,l){c.entityConditions.filter(d=>!d.expired&&-1!=d.types.indexOf(w.GV.afterTurn)).forEach(d=>{!this.isImmune(c,l,d.name)&&-1==j.f.settings.applyConditionsExcludes.indexOf(d.name)&&(d.state==w.mg.turn?d.name==w.r5.bane&&(this.changeHealth(c,l,-10,!0),d.expired=!0,d.highlight=!0,setTimeout(()=>{d.highlight=!1},1e3*j.f.settings.animationSpeed)):d.state==w.mg.normal?(d.lastState=d.state,d.state=w.mg.turn):d.state==w.mg.new&&d.lastState!=w.mg.new?(d.lastState=d.state,d.state=w.mg.normal):d.state==w.mg.new&&d.lastState==w.mg.new&&(d.lastState=w.mg.new,d.state=w.mg.normal))})}unapplyConditionsAfter(c,l){c.entityConditions.filter(d=>d.state!=w.mg.removed&&-1!=d.types.indexOf(w.GV.afterTurn)&&-1==j.f.settings.applyConditionsExcludes.indexOf(d.name)).forEach(d=>{d.expired?(d.name==w.r5.bane&&(c.health=c.health+10,this.checkHealth(c,l)),d.highlight=!1,d.expired=!1):d.state==w.mg.normal&&d.lastState==w.mg.new?d.state=w.mg.new:d.state==w.mg.new&&d.lastState!=w.mg.new&&(d.lastState=d.state)})}highlightedConditions(c){return c.entityConditions.filter(l=>l.highlight).sort((l,d)=>d.types.indexOf(w.GV.double)-l.types.indexOf(w.GV.double))}hasMarker(c,l){return c.markers&&-1!=c.markers.indexOf(l)}toggleMarker(c,l){this.hasMarker(c,l)?c.markers.splice(c.markers.indexOf(l),1):c.markers.push(l)}toggleActive(c,l){this.game.state==A.mk.next&&(c.active?(l.active=!l.active,this.entities(c).every(d=>!this.isAlive(d)||!d.active)&&f.roundManager.toggleFigure(c)):l.active?(l.active=!1,this.entities(c).every(d=>!this.isAlive(d,!0)||!d.active)&&(c.off=!0)):(c.off=!1,l.active=!0),l.active?(l.off=!1,!c.active&&this.game.figures.every(d=>!d.active)&&(c.active=!0)):l.off=!0)}undoInfos(c,l,d){let h=[];return c instanceof O.K&&l instanceof O.K?h.push(d+".char",f.characterManager.characterName(c)):c instanceof X.up&&l instanceof O.K?h.push(d+".summon",f.characterManager.characterName(l),"data.summon."+c.name):l instanceof I.$e&&c instanceof U.X?h.push(d+".objectiveContainer",l.title||l.name||l.escort?"escort":"objective",""+c.number):l instanceof E.R&&c instanceof R.I?h.push(d+".monster","data.monster."+l.name,""+c.number):l instanceof E.R&&h.push(d+".monsterEntities","data.monster."+l.name),h}next(){this.game.figures.forEach(c=>{this.entitiesAll(c).forEach(l=>{j.f.settings.expireConditions&&(l.entityConditions=l.entityConditions.filter(d=>!d.expired),l.entityConditions.forEach(d=>{-1!=d.types.indexOf(w.GV.expire)&&!d.permanent&&d.state==w.mg.normal&&(d.lastState=d.state,d.state=w.mg.expire)})),j.f.settings.applyConditions&&l.entityConditions.filter(d=>-1!=d.types.indexOf(w.GV.turn)||-1!=d.types.indexOf(w.GV.afterTurn)&&!this.isImmune(l,c,d.name)).forEach(d=>{d.lastState=d.state,d.state=w.mg.normal}),l.shield=void 0,l.retaliate=[]})})}}var kt=M(9733),J=M(67114),ut=M(67165);const He=[J.Yj.additionally,J.Yj.and,J.Yj.battleGoal,J.Yj.campaignSticker,J.Yj.campaignStickerMap,J.Yj.campaignStickerReplace,J.Yj.drawAnotherEvent,J.Yj.drawEvent,J.Yj.event,J.Yj.eventReturn,J.Yj.eventsToTop,J.Yj.experience,J.Yj.globalAchievement,J.Yj.gold,J.Yj.goldAdditional,J.Yj.inspiration,J.Yj.loseBattleGoal,J.Yj.loseGold,J.Yj.loseMorale,J.Yj.loseProsperity,J.Yj.loseReputation,J.Yj.morale,J.Yj.partyAchievement,J.Yj.prosperity,J.Yj.removeEvent,J.Yj.reputation,J.Yj.reputationAdditional,J.Yj.resource,J.Yj.scenarioCondition,J.Yj.scenarioDamage,J.Yj.scenarioSingleMinus1,J.Yj.sectionWeek,J.Yj.sectionWeeks,J.Yj.sectionWeekSeasonFinal,J.Yj.sectionWeeksSeason,J.Yj.soldier,J.Yj.soldiers,J.Yj.townGuardDeckCard,J.Yj.townGuardDeckCardRemove,J.Yj.townGuardDeckCardRemovePermanently,J.Yj.townGuardDeckCards,J.Yj.unlockEnvelope,J.Yj.unlockScenario,J.Yj.unlockScenarioGroup,J.Yj.upgradeBuilding,J.Yj.wreckBuilding];class Ke{game;constructor(c){this.game=c}getEventTypesForEdition(c,l=!0){return f.editionData.filter(d=>d.edition==c||l&&-1!=f.editionExtensions(c).indexOf(d.edition)).flatMap(d=>d.events).flatMap(d=>d.type).filter((d,h,u)=>h==u.indexOf(d))}getEventCardsForEdition(c,l,d=!0){return f.editionData.filter(h=>h.edition==c||d&&-1!=f.editionExtensions(c).indexOf(h.edition)).flatMap(h=>h.events).filter(h=>h.type==l)}getEventCardForEdition(c,l,d){return f.editionData.filter(h=>h.edition==c||-1!=f.editionExtensions(c).indexOf(h.edition)).flatMap(h=>h.events).find(h=>h.type==l&&h.cardId==d)}buildPartyDeck(c,l){const d=f.campaignData(c);d&&d.events&&d.events[l]&&this.buildEventDeck(l,d.events[l])}buildPartyDeckMigration(c){if(!this.game.party.eventDecks||!Object.keys(this.game.party.eventDecks).length){const l=f.campaignData(c);if(l.events&&(Object.keys(l.events).forEach(d=>{l.events[d]&&l.events[d].length&&(this.buildPartyDeck(c||f.currentEdition(),d),console.debug("Build "+d+" Event Deck"))}),this.game.party.eventDecks&&Object.keys(this.game.party.eventDecks).length)){this.game.party.scenarios.filter(h=>h.edition==c||-1!=f.editionExtensions(c).indexOf(h.edition)).map(h=>f.scenarioManager.getScenario(h.index,h.edition,h.group)).forEach(h=>this.buildPartyDeckMigrationScenarioHelper(h)),this.game.party.conclusions.filter(h=>h.edition==c||-1!=f.editionExtensions(c).indexOf(h.edition)).map(h=>f.scenarioManager.getSection(h.index,h.edition,h.group,!0)).forEach(h=>this.buildPartyDeckMigrationScenarioHelper(h)),this.game.unlockedCharacters.map(h=>f.getCharacterData(h.split(":")[1],h.split(":")[0])).forEach(h=>{h.unlockEvent&&h.unlockEvent.split("|").forEach(u=>{u.split(":").length>1?this.addEvent(u.split(":")[0],u.split(":")[1],!0):(this.addEvent("city",u,!0),this.addEvent("road",u,!0))})}),this.game.party.retirements.map(h=>f.getCharacterData(h.name,h.edition)).forEach(h=>{h.retireEvent&&h.retireEvent.split("|").forEach(u=>{u.split(":").length>1?this.addEvent(u.split(":")[0],u.split(":")[1],!0):(this.addEvent("city",u,!0),this.addEvent("road",u,!0))})});let d=f.editionData.filter(h=>h.treasures&&h.edition==c||-1!=f.editionExtensions(c).indexOf(h.edition)).flatMap(h=>h.treasures.map((u,b)=>new ut.Ah(u,b+1+h.treasureOffset||0)));this.game.party.treasures.forEach(h=>{if(h.edition==c||-1!=f.editionExtensions(c).indexOf(h.edition)){const u=d.find(b=>b.index==+h.name);u&&u.rewards&&u.rewards.forEach(b=>{b.type==ut.lb.event&&"string"==typeof b.value&&b.value.split("-").length>1&&this.addEvent(b.value.split("-")[0],b.value.split("-")[1],!0)})}}),console.debug("Migrated event decks")}}}buildPartyDeckMigrationScenarioHelper(c){c&&c.rewards&&(c.rewards.events&&c.rewards.events.forEach(l=>{l.split(":").length>1&&this.addEvent(l.split(":")[0],l.split(":")[1],!0)}),c.rewards.eventDecks&&c.rewards.eventDecks.forEach(l=>{const d=l.split(":")[0],h=f.eventCardManager.getEventCardsForEdition(c.edition,d),u=h.find(x=>c.rewards&&x.cardId==l.split(":")[1].split("|")[0]),b=h.find(x=>c.rewards&&x.cardId==l.split(":")[1].split("|")[1]);u&&b?f.eventCardManager.buildEventDeck(d,h.slice(h.indexOf(u),h.indexOf(b)+1).map(x=>x.cardId)):console.warn("Could not find start and end for: "+l)}))}buildEventDeck(c,l){l.forEach(d=>this.addEvent(c,d))}shuffleEvents(c){(0,D.Z)(this.game.party.eventDecks[c]||[])}addEvent(c,l,d=!1){const h=this.game.edition||f.currentEdition();null!=this.getEventCardForEdition(h,c,l)?(this.game.party.eventDecks[c]||(this.game.party.eventDecks[c]=[]),-1==this.game.party.eventDecks[c].indexOf(l)&&(!d||!this.game.party.eventCards.find(u=>u.type==c&&u.cardId==l&&u.edition==h))&&(this.game.party.eventDecks[c].push(l),this.shuffleEvents(c))):console.warn("Could not find "+c+" Event "+l+"for Edition "+h)}returnEvent(c,l){this.game.party.eventDecks[c]||(this.game.party.eventDecks[c]=[]),this.removeEvent(c,l),this.game.party.eventDecks[c].push(l)}removeEvent(c,l){this.game.party.eventDecks[c]||(this.game.party.eventDecks[c]=[]);const d=this.game.party.eventDecks[c].indexOf(l);-1!=d&&this.game.party.eventDecks[c].splice(d,1)}applyEvent(c,l,d,h,u,b,x){let F=[];const z=c.options[l];let H=!1,Q=-1!=["fh","jotl"].indexOf(c.edition);return z&&(z.removeFromDeck?Q=!0:z.returnToDeck?H=!0:z.outcomes&&d&&d.forEach(at=>{const ct=z.outcomes[at];ct&&(ct.removeFromDeck?Q=!0:ct.returnToDeck&&(H=!0))}),j.f.settings.eventsApply&&x&&(F.push(...this.applyEventOutcomes(c,l,d,!1)),u&&F.push(...this.applyEventOutcomes(c,l,d,!0)),b&&c.options.filter(at=>!at.label&&at.outcomes).forEach(at=>{at.outcomes.forEach(ct=>{ct.attack&&(F.push(ct.attack),ct.attack.effects&&F.push(...this.applyEffects(c,ct.attack.effects,u)))})}))),!H&&-1!=["fh"].indexOf(c.edition)&&(H=c.options.some(at=>!at.label&&at.returnToDeck)),H||Q?H?this.returnEvent(c.type,c.cardId):this.removeEvent(c.type,c.cardId):console.warn(x&&!z?"Apply event without valid selection":"No remove or return for event",c,l,d),this.game.party.eventCards.push(new J.Qc(c.cardId,c.edition,c.type,l,d,h,b,!u)),F}applyEventOutcomes(c,l,d=[],h=!1){let u=[];const b=c.options[l];return b&&b.outcomes&&b.outcomes.forEach((x,F)=>{if(!x.condition||d&&-1!=d.indexOf(F)){if(x.condition){const z=this.applyCondition(x.condition);z&&u.push(z)}x.effects&&u.push(...this.applyEffects(c,x.effects,h))}}),u}applicableEffect(c){return-1!=He.indexOf(c.type)}applyEffects(c,l,d){let h=[];return l.forEach(u=>{if("string"==typeof u)h.push(new J.Az(J.Yj.custom,[u]));else if(!this.applicableEffect(u)||u.condition&&!this.resolvableCondition(u.condition))u.type!=J.Yj.noEffect&&(d||h.push(u),u.type!=J.Yj.outpostAttack&&u.type!=J.Yj.outpostTarget&&console.warn("Missing implementation for applying effect",u,d));else{let b=f.characterManager.getActiveCharacters();if(u.condition){const x=this.applyCondition(u.condition);x&&h.push(x),"string"!=typeof u.condition&&u.condition.type==J.iH.character&&(b=b.filter(F=>-1!=u.condition.values.indexOf(F.name)))}if(u.type==J.Yj.and||u.type==J.Yj.additionally)h.push(...this.applyEffects(c,u.values.filter(x=>"number"!=typeof x&&"string"!=typeof x),d));else if(d)switch(u.type){case J.Yj.scenarioCondition:u.values&&u.values.filter(z=>"string"==typeof z).forEach(z=>{const H=z.split(":")[0];if(H!=w.r5.bless&&H!=w.r5.curse)b.forEach(Q=>{f.entityManager.addCondition(Q,Q,new w.kW(H))});else if(H==w.r5.curse){const Q=z.split(":")[1]?+z.split(":")[1]:1;for(let at=0;at<Q;at++)b.forEach(ct=>{f.attackModifierManager.countUpcomingCurses(!1)<10&&f.attackModifierManager.addModifierByType(ct.attackModifierDeck,K.Yn.curse)})}else if(H==w.r5.bless){const Q=z.split(":")[1]?+z.split(":")[1]:1;for(let at=0;at<Q;at++)b.forEach(ct=>{f.attackModifierManager.countUpcomingBlesses()<10&&f.attackModifierManager.addModifierByType(ct.attackModifierDeck,K.Yn.bless)})}});break;case J.Yj.scenarioDamage:const x=+u.values[0];x&&b.forEach(z=>{f.entityManager.changeHealth(z,z,-x,!0)});break;case J.Yj.scenarioSingleMinus1:const F=+u.values[0];if(F)for(let z=0;z<F;z++)b.forEach(H=>{f.attackModifierManager.countExtraMinus1()<15&&f.attackModifierManager.addModifierByType(H.attackModifierDeck,K.Yn.minus1extra)})}else switch(u.type){case J.Yj.battleGoal:b.forEach(x=>{x.progress.battleGoals+=+u.values[0]});break;case J.Yj.campaignSticker:this.game.party.campaignStickers.push(...u.values.filter(x=>"string"==typeof x));break;case J.Yj.campaignStickerMap:{const x=f.scenarioManager.getSection(u.values[0],c.edition,void 0,!0);x&&this.game.party.conclusions.push(new kt.Ag(x.index,x.edition,x.group));break}case J.Yj.campaignStickerReplace:this.game.party.campaignStickers.splice(this.game.party.campaignStickers.indexOf(u.values[1],1)),this.game.party.campaignStickers.push(u.values[0]);break;case J.Yj.drawAnotherEvent:case J.Yj.drawEvent:this.game.eventDraw=u.values[0];break;case J.Yj.event:case J.Yj.eventReturn:this.addEvent(u.values[0],u.values[1]);break;case J.Yj.eventsToTop:{const x=this.game.party.eventDecks[u.values[0]],F=x?x.find(z=>-1!=u.values.indexOf(z)):void 0;if(x&&F){const z=x.indexOf(F);x.splice(z,1),x.unshift(F)}break}case J.Yj.experience:b.forEach(x=>{x.progress.experience+=+u.values[0]});break;case J.Yj.globalAchievement:this.game.party.globalAchievementsList.push(...u.values.filter(x=>"string"==typeof x));break;case J.Yj.gold:case J.Yj.goldAdditional:b.forEach(x=>{x.progress.gold+=+u.values[0]});break;case J.Yj.inspiration:this.game.party.inspiration+=+u.values[0];break;case J.Yj.loseBattleGoal:b.forEach(x=>{x.progress.battleGoals-=+u.values[0],x.progress.battleGoals<0&&(x.progress.battleGoals=0)});break;case J.Yj.loseExperience:b.forEach(x=>{x.progress.experience-=+u.values[0],x.progress.experience<0&&(x.progress.experience=0)});break;case J.Yj.loseGold:b.forEach(x=>{x.progress.gold-=+u.values[0],x.progress.gold<0&&(x.progress.gold=0)});break;case J.Yj.loseMorale:this.game.party.morale-=+u.values[0],this.game.party.morale<0&&(this.game.party.morale=0);break;case J.Yj.loseProsperity:this.game.party.prosperity-=+u.values[0],this.game.party.prosperity<0&&(this.game.party.prosperity=0);break;case J.Yj.loseReputation:this.game.party.reputation-=u.values[0],this.game.party.reputation<-20&&(this.game.party.reputation=-20);break;case J.Yj.morale:this.game.party.morale+=+u.values[0],this.game.party.morale>20&&(this.game.party.morale=20);break;case J.Yj.removeEvent:this.removeEvent(u.values[0],u.values[1]);break;case J.Yj.reputation:case J.Yj.reputationAdditional:this.game.party.reputation+=u.values[0],this.game.party.reputation>20&&(this.game.party.reputation=20);break;case J.Yj.resource:b.forEach(x=>{x.progress.loot[u.values[1]]=(x.progress.loot[u.values[1]]||0)+ +u.values[0]});break;case J.Yj.partyAchievement:this.game.party.achievementsList.push(...u.values.filter(x=>"string"==typeof x));break;case J.Yj.prosperity:this.game.party.prosperity+=+u.values[0];break;case J.Yj.scenarioCondition:case J.Yj.scenarioDamage:case J.Yj.scenarioSingleMinus1:break;case J.Yj.sectionWeek:case J.Yj.sectionWeeks:{const x=this.game.party.weeks+(u.values[1]?+u.values[1]:1);this.game.party.weekSections[x]=[...f.game.party.weekSections[x]||[],u.values[0]];break}case J.Yj.sectionWeekSeasonFinal:{const x=u.values[0],F=u.values[1];let H=0;H=Math.max(this.game.party.weeks-1,0)%20<10?Math.floor(this.game.party.weeks/10)+("summer"==F?3:2):Math.floor(this.game.party.weeks/10)+("winter"==F?3:2),this.game.party.weekSections[10*H]=[...f.game.party.weekSections[10*H]||[],x];break}case J.Yj.sectionWeeksSeason:{const x=u.values[0],F=u.values[2];let z=this.game.party.weeks+(u.values[1]?+u.values[1]:1);const H=Math.max(z-1,0)%20<10;(H&&"summer"==F||!H&&"winter"==F)&&(z=z-Math.max(z-1,0)%20+ +u.values[3]+19),this.game.party.weekSections[z]=[...f.game.party.weekSections[z]||[],x];break}case J.Yj.soldier:case J.Yj.soldiers:this.game.party.soldiers+=+(u.values[0]||1),this.game.party.soldiers>10&&(this.game.party.soldiers=10);break;case J.Yj.townGuardDeckCard:case J.Yj.townGuardDeckCards:if(this.game.party.townGuardDeck){const x=u.values[1]?+u.values[1]:1;for(let F=0;F<x;F++)this.game.party.townGuardDeck.cards.push(u.values[0]),this.game.party.townGuardDeck.current=-1,(0,D.Z)(this.game.party.townGuardDeck.cards)}break;case J.Yj.townGuardDeckCardRemove:case J.Yj.townGuardDeckCardRemovePermanently:if(this.game.party.townGuardDeck){const x=this.game.party.townGuardDeck.cards.find(F=>F==u.values[0]);x&&this.game.party.townGuardDeck.cards.splice(this.game.party.townGuardDeck.cards.indexOf(x),1)}break;case J.Yj.unlockEnvelope:if("fh"==c.edition){const x=f.campaignData(c.edition).buildings.find(F=>F.id==u.values[0]);x?null==this.game.party.buildings.find(F=>F.name==x.name)&&this.game.party.buildings.push(new Ut.k(x.name,0)):(console.warn("Building not found to apply event effect",u,d),h.push(u))}else console.warn("Building not found to apply event effect",u,d),h.push(u);break;case J.Yj.unlockScenario:case J.Yj.unlockScenarioGroup:this.game.party.manualScenarios.push(new kt.Ag(u.values[0],c.edition,u.values[1]?u.values[1]:""));break;case J.Yj.upgradeBuilding:{const x=this.game.party.buildings.find(F=>F.name==u.values[0]);x?x.level>=+u.values[1]?this.game.party.morale+=+u.values[2]:x.level+=1:(console.warn("Building not found to apply event effect",u,d),h.push(u));break}case J.Yj.wreckBuilding:{const x=u.values[0],F=this.game.party.buildings.find(z=>z.name==x);F&&(F.state="wrecked");break}default:h.push(u)}}}),h}applyCondition(c){if("string"!=typeof c)switch(c.type){case J.iH.and:return c.values.filter(l=>"number"!=typeof l).forEach(l=>{this.applyCondition(l)}),c;case J.iH.building:case J.iH.campaignSticker:case J.iH.character:case J.iH.moraleGT:case J.iH.moraleLT:case J.iH.otherwise:case J.iH.reputationGT:case J.iH.reputationLT:case J.iH.season:case J.iH.seasonLT:case J.iH.traits:break;default:return console.warn("Missing implementation for applying condition",c),c}}resolvableCondition(c){if("string"==typeof c)return!0;let l=f.characterManager.getActiveCharacters();switch(c.type){case J.iH.and:return c.values&&c.values.every(d=>"number"!=typeof d&&this.resolvableCondition(d));case J.iH.building:return c.values&&c.values.every(d=>"string"==typeof d&&this.game.party.buildings&&this.game.party.buildings.find(h=>h.level&&h.name==d));case J.iH.campaignSticker:return-1!=this.game.party.campaignStickers.indexOf(c.values[0]);case J.iH.character:return c.values&&l.some(d=>-1!=c.values.indexOf(d.name));case J.iH.class:return c.values&&l.some(d=>-1!=c.values.indexOf(d.characterClass));case J.iH.moraleGT:return c.values&&"number"==typeof c.values[0]&&this.game.party.morale>c.values[0];case J.iH.moraleLT:return c.values&&"number"==typeof c.values[0]&&this.game.party.morale<c.values[0];case J.iH.otherwise:return!0;case J.iH.reputationGT:return c.values&&"number"==typeof c.values[0]&&this.game.party.reputation>c.values[0];case J.iH.reputationLT:return c.values&&"number"==typeof c.values[0]&&this.game.party.reputation<c.values[0];case J.iH.season:return Math.max(this.game.party.weeks-1,0)%20<10?"summer"==c.values[0]:"winter"==c.values[0];case J.iH.seasonLT:return"summer"==c.values[0]?Math.max(this.game.party.weeks+ +c.values[1]-1,0)%20<10:"winter"==c.values[0]&&Math.max(this.game.party.weeks+ +c.values[1]-1,0)%20>=10;case J.iH.traits:return c.values&&l.some(d=>d.traits.some(h=>-1!=c.values.indexOf(h))||-1!=c.values.indexOf(d.characterClass));case J.iH.payGold:return c.values&&l.every(d=>"number"==typeof c.values[0]&&d.progress.gold>=c.values[0]);case J.iH.payCollectiveGold:return c.values&&"number"==typeof c.values[0]&&l.length>0&&l.map(d=>d.progress.gold).reduce((d,h)=>d+h)>=c.values[0];case J.iH.payCollectiveGoldConditional:return c.values&&c.values.some(d=>"number"!=typeof d&&this.resolvableCondition(d));case J.iH.payCollectiveGoldReputationGT:return c.values&&"number"==typeof c.values[0]&&"number"==typeof c.values[1]&&l.length>0&&l.map(d=>d.progress.gold).reduce((d,h)=>d+h)>=c.values[0]&&this.game.party.reputation>c.values[1];case J.iH.payCollectiveGoldReputationLT:return c.values&&"number"==typeof c.values[0]&&"number"==typeof c.values[1]&&l.length>0&&l.map(d=>d.progress.gold).reduce((d,h)=>d+h)>=c.values[0]&&this.game.party.reputation<c.values[1];default:return!1}}}class We{game;enabled=!1;available=!1;imbuement=!1;constructor(c){this.game=c}update(){this.available=f.gh2eRules()&&f.game.party.conclusions.some(c=>"gh2e"==c.edition&&"48.2"==c.index)&&(!f.game.party.conclusions.some(c=>"gh2e"==c.edition&&"16.5"==c.index)||"advanced"),!this.available&&!j.f.settings.partySheet&&(this.available="advanced"),this.enabled=this.available&&j.f.settings.gh2eImbuement,this.imbuement=null!=f.game.monsterAttackModifierDeck.cards.find(c=>c.type==K.Yn.imbue),this.imbuement&&null!=f.game.monsterAttackModifierDeck.cards.find(c=>c.type==K.Yn.advancedImbue)&&(this.imbuement="advanced")}disable(c){c.cards=c.cards.filter(l=>l.type!=K.Yn.imbue&&l.type!=K.Yn.advancedImbue),f.attackModifierManager.shuffleModifiers(c),"advanced"==this.imbuement?(f.attackModifierManager.addModifierByType(c,K.Yn.minus2),f.attackModifierManager.addModifierByType(c,K.Yn.minus1),f.attackModifierManager.addModifierByType(c,K.Yn.minus1),f.attackModifierManager.addModifierByType(c,K.Yn.minus1),f.attackModifierManager.addModifierByType(c,K.Yn.plus0),f.attackModifierManager.addModifierByType(c,K.Yn.plus0)):(f.attackModifierManager.addModifierByType(c,K.Yn.minus1),f.attackModifierManager.addModifierByType(c,K.Yn.minus1),f.attackModifierManager.addModifierByType(c,K.Yn.minus1)),this.imbuement=!1}enable(c){f.attackModifierManager.removeModifierByType(c,K.Yn.minus1),f.attackModifierManager.removeModifierByType(c,K.Yn.minus1),f.attackModifierManager.removeModifierByType(c,K.Yn.minus1),K.iy.forEach(l=>{f.attackModifierManager.addModifier(c,l)}),this.imbuement=!0}advanced(c){f.attackModifierManager.removeModifierByType(c,K.Yn.minus2),f.attackModifierManager.removeModifierByType(c,K.Yn.minus1),f.attackModifierManager.removeModifierByType(c,K.Yn.minus1),f.attackModifierManager.removeModifierByType(c,K.Yn.minus1),f.attackModifierManager.removeModifierByType(c,K.Yn.plus0),f.attackModifierManager.removeModifierByType(c,K.Yn.plus0),K.iy.forEach(l=>{f.attackModifierManager.addModifier(c,l)}),K.u3.forEach(l=>{f.attackModifierManager.addModifier(c,l)}),this.imbuement="advanced"}}var Ot=M(72941),dt=M(51604);class Gt{game;constructor(c){this.game=c}itemEditions(c=void 0){return f.editionData.filter(l=>-1!=j.f.settings.editions.indexOf(l.edition)&&(!c||c==l.edition||-1!=f.editionExtensions(c).indexOf(l.edition)||"fh"==c&&"gh"==l.edition)&&l.items&&l.items.length>0).flatMap(l=>l.edition)}getItems(c,l=!1){return f.itemData().filter(d=>l&&(!c||d.edition==c)||this.isItemAvailable(d,c))}isItemAvailable(c,l,d=!0){if(!this.game.party.campaignMode)return!l||c.edition==l||-1!=f.editionExtensions(l).indexOf(c.edition);if(l&&(c.edition==l||-1!=f.editionExtensions(l).indexOf(c.edition))&&(d&&this.game.party.unlockedItems.find(h=>h.name==""+c.id&&h.edition==c.edition)||c.unlockProsperity>0&&c.unlockProsperity<=f.prosperityLevel()||c.unlockScenario&&this.game.party.scenarios.find(h=>c.unlockScenario&&h.index==c.unlockScenario.name&&h.edition==c.unlockScenario.edition)||!c.blueprint&&!c.random&&c.requiredBuilding&&"alchemist"!=c.requiredBuilding&&this.game.party.buildings&&this.game.party.buildings.find(h=>h.name==c.requiredBuilding&&h.level>=c.requiredBuildingLevel)))return!0;if(j.f.settings.fhGhItems&&f.fhRules()){if("gh"==c.edition){const h=this.game.party.buildings&&this.game.party.buildings.find(u=>"trading-post"==u.name&&"wrecked"!=u.state);if(h){if("number"==typeof c.id&&h.level>=2&&-1!=[21,37,53,93,94,106,115].indexOf(c.id))return!0;if("number"==typeof c.id&&h.level>=3&&-1!=[46,83,84,85,86,87,88,102,110,111,120,121,122,123,126,128].indexOf(c.id))return!0;if("number"==typeof c.id&&h.level>=4&&-1!=[17,35,47,51,62,74,77,78,79,80,81,82,117,118,119,127,129,131].indexOf(c.id))return!0}return"number"==typeof c.id&&-1!=[10,25,72,105,109,116].indexOf(c.id)}if("fc"==c.edition){let h=[];this.game.party.scenarios.find(u=>"fh"==u.edition&&"82"==u.index&&!u.group)&&h.push(153,159,161),this.game.party.buildings&&this.game.party.buildings.find(u=>"enhancer"==u.name&&4==u.level&&"wrecked"!=u.state)&&h.push(154,155,157,163)}}return!1}getItem(c,l,d){return isNaN(+c)||(c=+c),f.itemData().find(h=>h&&h.id==c&&h.edition==l&&(d||this.isItemAvailable(h,l)))}maxItemIndex(c){return Math.max(...this.getItems(c,!0).filter(l=>"number"==typeof l.id).map(l=>+l.id))}pricerModifier(){return this.game.party.reputation>=0?-1*Math.ceil((f.game.party.reputation-2)/4):-1*Math.floor((f.game.party.reputation+2)/4)}assigned(c){return this.game.figures.filter(l=>l instanceof O.K&&l.progress&&l.progress.items).map(l=>l).map(l=>l.progress&&l.progress.items).reduce((l,d)=>l&&d&&l.concat(d)).filter(l=>c&&l.name==""+c.id&&l.edition==c.edition).length}owned(c,l){return null!=l.progress.items.find(d=>c&&d.name==""+c.id&&d.edition==c.edition)}canAdd(c,l){return c.count&&this.countAvailable(c)>0&&!l.progress.items.find(d=>c&&d.name==""+c.id&&d.edition==c.edition)&&(!c.solo||c.edition==l.edition&&c.solo==l.name)||!1}canBuy(c,l,d=0){return(-1!=l.tags.indexOf("new-character")||!this.buyingDisabled())&&(c.cost&&c.cost+this.pricerModifier()+d<=l.progress.gold&&this.canAdd(c,l)||!1)}buyingDisabled(){return f.fhRules()&&f.game.party.campaignMode&&null!=f.game.party.buildings.find(c=>"trading-post"==c.name&&c.level>0&&"wrecked"==c.state)}canCraft(c,l,d={}){if(this.craftingDisabled())return!1;let h=!1,u=!0;return c.resources&&Object.keys(c.resources).forEach(b=>{const x=b,F=(c.resources[x]||0)+(d[x]||0);F>0&&(h=!0),u=(0,dt.hV)(x)==dt.hM.herb_resources?u&&((l.progress.loot[x]||0)>=F||(f.game.party.loot[x]||0)>=F):u&&(l.progress.loot[x]||0)>=F}),c.requiredItems&&c.requiredItems.forEach(b=>{if(b!=c.id){const x=this.getItem(b,c.edition,!0);x?(h=!0,this.owned(x,l)||(u=u&&(this.canCraft(x,l,c.resources||{})||this.canBuy(x,l,c.cost)))):console.error("Missing required item '"+b+"' for item '"+c.id+"' ("+c.name+")")}}),u&&h}canDistill(c){if(f.buildingsManager.distillAvailable){if(c.resourcesAny&&c.resourcesAny.length)return c.resourcesAny.every(l=>l.herb_resources);if(c.resources&&c.resources)return Object.keys(c.resources).map(d=>d).every(d=>-1!=dt.Pr.indexOf(d))}return!1}craftingDisabled(){return f.fhRules()&&f.game.party.campaignMode&&null!=f.game.party.buildings.find(c=>"craftsman"==c.name&&c.level>0&&"wrecked"==c.state)}brewingDisabled(){return f.fhRules()&&f.game.party.campaignMode&&null!=f.game.party.buildings.find(c=>"alchemist"==c.name&&c.level>0&&"wrecked"==c.state)}itemUsable(c){return!("alchemist"==c.requiredBuilding&&this.brewingDisabled())}itemSellValue(c){if(c.cost)return Math.floor(c.cost/2);{let l=0;return c.resourcesAny&&(l+=c.resourcesAny.length),c.resources&&Object.keys(c.resources).forEach(d=>{l+=2*(c.resources[d]||0)}),c.requiredItems&&c.requiredItems.forEach(()=>{l+=2}),l}}addItem(c,l){l.progress.items.push(new v.gw(c.id+"",c.edition))}buyItem(c,l){l.progress.gold-=c.cost+this.pricerModifier(),l.progress.items.push(new v.gw(c.id+"",c.edition))}craftItemResources(c,l){c.resources&&Object.keys(c.resources).forEach(d=>{const h=d,u=c.resources[h]||0;(0,dt.hV)(h)==dt.hM.herb_resources?(l.progress.loot[h]||0)>=u?l.progress.loot[h]=(l.progress.loot[h]||0)-u:this.game.party.loot[h]=(this.game.party.loot[h]||0)-u:l.progress.loot[h]=(l.progress.loot[h]||0)-u}),c.requiredItems&&c.requiredItems.forEach(d=>{if(d!=c.id){const h=this.getItem(d,c.edition,!0);if(h){if(h){const u=l.progress.items.find(b=>b.name==""+h.id&&b.edition==h.edition);if(u){const b=l.progress.items.indexOf(u);l.progress.items.splice(b,1),l.progress.equippedItems=l.progress.equippedItems.filter(x=>x.name!=""+h.id||x.edition!=h.edition)}else this.canBuy(h,l)?l.progress.gold-=c.cost+this.pricerModifier():this.craftItemResources(h,l)}}else console.error("Missing required item '"+d+"' for item '"+c.id+"' ("+c.name+")")}})}craftItem(c,l){this.craftItemResources(c,l),l.progress.items.push(new v.gw(c.id+"",c.edition))}removeItem(c,l){const d=l.progress.items.find(h=>h.name==""+c.id&&h.edition==c.edition);if(d){const h=l.progress.items.indexOf(d);l.progress.items.splice(h,1),l.progress.equippedItems=l.progress.equippedItems.filter(u=>u.name!=""+c.id||u.edition!=c.edition)}}sellItem(c,l){const d=l.progress.items.find(h=>h.name==""+c.id&&h.edition==c.edition);if(d&&this.itemSellValue(c)){const h=l.progress.items.indexOf(d);l.progress.gold+=this.itemSellValue(c),l.progress.items.splice(h,1),l.progress.equippedItems=l.progress.equippedItems.filter(u=>u.name!=""+c.id||u.edition!=c.edition)}}addItemCount(c){if(this.game.party.campaignMode){const l=f.itemManager.assigned(c);if(f.itemManager.countAvailable(c)+l<c.count){const h=f.game.party.unlockedItems.find(u=>+u.name==c.id&&u.edition==c.edition);h?(h.count+=1,h.count==c.count&&(h.count=-1)):f.game.party.unlockedItems.push(new v.VP(""+c.id,c.edition,1))}}}countAvailable(c){const l=this.assigned(c);if(!this.isItemAvailable(c,c.edition,!1)){const d=f.game.party.unlockedItems.find(h=>+h.name==c.id&&h.edition==c.edition);if(d&&d.count>0)return d.count-l<0&&console.warn("More items assigend than available:",c),d.count-l;if(!d)return-1}return c.count-l<0&&console.warn("More items assigend than available:",c),c.count-l}isEquipped(c,l){return null!=l.progress.equippedItems.find(d=>d.name==""+c.id&&d.edition==c.edition)}toggleEquippedItem(c,l,d=!1){let h=l.progress.equippedItems.map(b=>this.getItem(b.name,b.edition,!0)).filter(b=>b).map(b=>b);const u=h.indexOf(c);if(d&&-1==u)h.push(c);else if(d)h.splice(u,1);else if(-1!=u){h.splice(u,1);const b=Math.ceil(l.level/2),x=h.filter(F=>F.slot==Ot.o8.small).length;if(16==c.id&&"gh"==c.edition&&x>=b)for(let F=0;F<x-b;F++){const z=h.find(H=>H.slot==Ot.o8.small);z&&h.splice(h.indexOf(z),1)}}else{const b="drifter"==l.name&&"fh"==l.edition&&l.progress.perks[11];if(c.slot==Ot.o8.small){let x=Math.ceil(l.level/2);if(h.find(F=>16==F.id&&"gh"==F.edition||60==F.id&&"fh"==F.edition)&&(x+=2),h.find(F=>132==F.id&&"fh"==F.edition)&&(x+=1),f.trialsManager.favorsEnabled&&f.trialsManager.apply&&(x+=f.trialsManager.activeFavor("fh","capacity")),h.filter(F=>F.slot==c.slot).length>=x){const F=h.find(z=>z.slot==c.slot);F&&h.splice(h.indexOf(F),1)}}else if(c.slot==Ot.o8.onehand){const x=h.find(F=>F.slot==Ot.o8.twohand);if(x&&!b&&(h=h.filter(F=>F.slot!=Ot.o8.twohand)),h.filter(F=>F.slot==c.slot).length>(b?x?0:2:1)){const F=h.find(z=>z.slot==c.slot);F&&h.splice(h.indexOf(F),1)}}else if(c.slot==Ot.o8.twohand)if(h=h.filter(x=>x.slot!=c.slot),b)for(;h.filter(x=>x.slot==Ot.o8.onehand).length>1;){const x=h.find(F=>F.slot==Ot.o8.onehand);x&&h.splice(h.indexOf(x),1)}else h=h.filter(x=>x.slot!=Ot.o8.onehand);else h.filter(x=>x.slot==c.slot).forEach(x=>this.toggleEquippedItem(x,l)),h=h.filter(x=>x.slot!=c.slot);h.push(c)}l.progress.equippedItems=h.map(b=>new v.h5(b.id+"",b.edition)),c.minusOne&&!f.characterManager.ignoreNegativeItemEffects(l)&&(l.attackModifierDeck=f.attackModifierManager.buildCharacterAttackModifierDeck(l),f.attackModifierManager.shuffleModifiers(l.attackModifierDeck)),3==c.id&&"fh"==c.edition&&(-1==u?l.maxHealth+=1:l.maxHealth-=1,l.health=l.maxHealth)}drawRandomItem(c,l=!1,d=-1,h=-1){let b,u=this.getItems(void 0,!0).filter(x=>(!l&&x.random||l&&x.blueprint&&(!x.requiredBuilding||f.game.party.buildings.find(F=>F.name==x.requiredBuilding&&F.level>=x.requiredBuildingLevel)))&&(-1==d||"number"==typeof x.id&&x.id>=d)&&(-1==h||"number"==typeof x.id&&x.id<=h)&&!f.game.party.unlockedItems.find(F=>F.name==""+x.id&&F.edition==x.edition)&&(x.edition==c||-1!=f.editionExtensions(c).indexOf(x.edition)));return u.length>0&&(b=u[Math.floor(Math.random()*u.length)]),b}applyEquippedItemEffects(c){c.immunities=[],c.progress.equippedItems.forEach(l=>{const d=f.itemManager.getItem(l.name,l.edition,!0);d&&f.itemManager.applyItemEffects(c,d)})}applyItemEffects(c,l,d=!1){if(l.effects&&l.effects.forEach(h=>{(!l.spent&&!l.consumed||d||h.always)&&this.applyItemEffect(c,h)}),d&&l.summon){let h=new X.up((0,qt.v4)(),l.summon.name,l.summon.cardId,c.level,1,X.rX.blue,l.summon);h.init=!1,f.characterManager.addSummon(c,h)}j.f.settings.characterItemsApply&&"fh"==l.edition&&258==l.id&&c.health<c.maxHealth/2&&(c.health+=7,f.attackModifierManager.addModifier(c.attackModifierDeck,new K.uU(K.Yn.curse)))}applyItemEffect(c,l){switch(l.type){case Ot.TQ.heal:const d=(0,N.hZ)(l.value);c.health+=d,f.entityManager.addCondition(c,c,new w.kW(w.r5.heal,d)),f.entityManager.applyCondition(c,c,w.r5.heal,!0);break;case Ot.TQ.damage:const h=(0,N.hZ)(l.value);f.entityManager.changeHealth(c,c,-h,!0);break;case Ot.TQ.condition:const u=(""+l.value).split(":")[0];let b=(""+l.value).split(":").length>1?+(""+l.value).split(":")[1]:1;if(u==w.r5.bless)for(let H=0;H<b;H++)f.attackModifierManager.countUpcomingBlesses()<10&&f.attackModifierManager.addModifier(c.attackModifierDeck,new K.uU(K.Yn.bless));else if(u==w.r5.curse)for(let H=0;H<b;H++)f.attackModifierManager.countUpcomingCurses(!1)<10&&f.attackModifierManager.addModifier(c.attackModifierDeck,new K.uU(K.Yn.curse));else f.entityManager.addCondition(c,c,new w.kW(u,b));break;case Ot.TQ.immune:const x=""+l.value;-1==c.immunities.indexOf(x)&&c.immunities.push(x);break;case Ot.TQ.element:const F=""+l.value;F!=S.Hg.wild&&f.game.elementBoard.forEach(H=>{H.type==F&&(H.state=S.e_.new)});break;case Ot.TQ.initiative:c.initiative+=(0,N.hZ)(l.value),c.initiative<1?c.initiative=1:c.initiative>99&&(c.initiative=99);break;case Ot.TQ.refreshSpent:c.progress.equippedItems.forEach(H=>{H.tags&&-1!=H.tags.indexOf(Ot.Tr.spent)&&(H.tags=H.tags.filter(Q=>Q!=Ot.Tr.spent))});break;case Ot.TQ.removeNegativeConditions:const z=f.conditionsForTypes(w.GV.negative,w.GV.character).map(H=>H.name);c.entityConditions=c.entityConditions.filter(H=>-1==z.indexOf(H.name))}}sortItems(c,l){return"number"==typeof c.id&&"number"==typeof l.id?c.id-l.id:"number"==typeof c.id?-1:"number"==typeof l.id?1:c.id<l.id?-1:1}}class Ae{game;constructor(c){this.game=c}ge5PlayerOffset(){if(!this.game.ge5Player)return 0;const c=f.characterManager.characterCount();return c<=4?0:c-3}adjustedLevel(){const c=this.game.level-this.ge5PlayerOffset()-(!this.game.solo||f.fhRules(!0)||j.f.settings.alwaysFhSolo?0:1)+this.game.bonusAdjustment;return c<0?0:c>7?7:c}trap(c=-1){return(c<0||c>7)&&(c=this.game.level),2+c}experience(c=-1){return(c<0||c>7)&&(c=this.adjustedLevel()),4+2*c}loot(c=-1){(c<0||c>7)&&(c=this.adjustedLevel());let l=2+Math.floor(c/2);return c>=7&&(l=6),l}terrain(c=-1){return j.f.settings.alwaysHazardousTerrain||f.fhRules(!0)?((c<0||c>7)&&(c=this.game.level),1+Math.ceil(c/3)):Math.floor(this.trap(c)/2)}bbMonsterDifficutly(){let c=2+f.game.levelAdjustment;return c<0?c=0:c>4&&(c=4),c}scenarioLevel(){const c=f.characterManager.characterCount();if(0==c)return 1;const l=this.game.figures.some(d=>d instanceof O.K)?this.game.figures.filter(d=>d instanceof O.K&&!d.absent).map(d=>d.level).reduce((d,h)=>d+h):1;return Math.ceil((l/c+(this.game.solo&&(f.fhRules(!0)||j.f.settings.alwaysFhSolo)?1:0))/2)+(!this.game.solo||f.fhRules(!0)||j.f.settings.alwaysFhSolo?0:1)+this.ge5PlayerOffset()}calculateScenarioLevel(){this.game.levelAdjustment>6?this.game.levelAdjustment=6:this.game.levelAdjustment<-6&&(this.game.levelAdjustment=-6);let c=this.scenarioLevel()+this.game.levelAdjustment;c>7?c=7:c<0&&(c=0),this.setLevel(c)}setLevel(c){if(this.game.level!=c){const l=c-this.game.level;this.game.level=c,this.game.figures.forEach(d=>{d instanceof E.R?(d.level+=l,d.level>7?d.level=7:d.level<0&&(d.level=0),f.monsterManager.setLevel(d,d.level)):d instanceof I.$e&&d.entities.forEach(h=>{h.health>(0,N.hZ)(d.health)&&(d.health=(0,N.hZ)(d.health))})})}}}class Ve{game;constructor(c){this.game=c}drawCard(c,l=void 0){let d;c.current++,c.current>=c.cards.length&&(c.current=c.cards.length-1);const h=c.cards[c.current];return h&&(j.f.settings.applyLoot&&l&&(d=this.applyLoot(h,l,c.current)),h.type==dt.r6.random_item&&this.game.scenario&&this.game.party.campaignMode&&this.game.party.randomItemLooted.push(new kt.Ag(this.game.scenario.index,this.game.scenario.edition,this.game.scenario.group))),d}applyLoot(c,l,d){let h;if(l.lootCards=l.lootCards||[],c.type==dt.r6.money||c.type==dt.r6.special1||c.type==dt.r6.special2?l.loot+=this.getValue(c):c.type==dt.r6.random_item&&this.game.scenario&&this.game.party.campaignMode&&j.f.settings.characterItems&&j.f.settings.applyLootRandomItem&&(h=f.itemManager.drawRandomItem(this.game.scenario.edition),h||(l.loot+=3)),l.lootCards.push(d),f.trialsManager.apply&&f.trialsManager.trialsEnabled){const u=this.game.figures.find(b=>b instanceof O.K&&b!=l&&b.progress.trial&&"fh"==b.progress.trial.edition&&"351"==b.progress.trial.name);u&&f.entityManager.changeHealth(u,u,-Math.ceil(this.game.level/3),!0)}return h}shuffleDeck(c,l=!1){const d=c.current;let h=l&&d>-1?c.cards.splice(0,d+1):[];c.current=-1,(0,D.Z)(c.cards),l&&(c.current=d,c.cards.unshift(...h))}getTotal(c,l){const d=c.cards.filter(h=>h.type==l);return 0==d.length?0:d.map(h=>this.getValue(h)).reduce((h,u)=>h+u)}addCharacterLoot(c,l){const d=this.getValue(l);if(l.type==dt.r6.money||l.type==dt.r6.special1||l.type==dt.r6.special2)c.loot+=d;else if(-1!=dt.mn.indexOf(l.type)){const h=c.progress.loot[l.type]||0;h+d>=0&&(c.progress.loot[l.type]=h+d)}}lootTreasure(c,l,d){let h=[];const u=f.editionData.find(b=>b.edition==d);if(u&&u.treasures)if((l=l<0?l:l-(u.treasureOffset||0))>=0&&l<u.treasures.length){const x=new ut.Ah(u.treasures[l],l);x.rewards&&x.rewards.forEach(F=>{h.push(this.applyTreasureReward(c,F,d))})}else if(l<0&&u.treasures.length+l+1>0){const x=new ut.Ah(u.treasures[u.treasures.length+l+1],l);x.rewards&&x.rewards.forEach(F=>{h.push(this.applyTreasureReward(c,F,d))})}else console.warn("Invalid treasure index: '"+l+"' for Edition "+d);return h}hasTreasure(c,l,d){return c.treasures.some(h=>h==l||"string"==typeof h&&(h.startsWith(l+":")||"G"==l&&h=="G-"+d))}applyTreasureReward(c,l,d){let h=[];switch(l.type){case ut.lb.gold:case ut.lb.goldFh:"number"==typeof l.value&&(c.progress.gold+=l.value);break;case ut.lb.experience:case ut.lb.experienceFh:"number"==typeof l.value&&(c.progress.experience+=l.value);break;case ut.lb.battleGoal:"number"==typeof l.value&&(c.progress.battleGoals+=l.value);break;case ut.lb.damage:"number"==typeof l.value?c.health-=l.value:"terrain"==l.value&&(c.health-=f.levelManager.terrain()),c.health<=0&&(c.exhausted=!0,c.off=!0,c.active=!1);break;case ut.lb.heal:"number"==typeof l.value&&(c.health+=l.value,c.health>c.maxHealth&&(c.health=c.maxHealth));break;case ut.lb.loot:"number"==typeof l.value&&(c.loot+=l.value);break;case ut.lb.resource:"string"==typeof l.value&&l.value.split("+").forEach(u=>{const b=u.split("-")[0],x=+u.split("-")[1];c.progress.loot[b]=(c.progress.loot[b]||0)+x});break;case ut.lb.condition:"string"==typeof l.value&&l.value.split("+").forEach(u=>{f.entityManager.hasCondition(c,new w.kW(u))||f.entityManager.addCondition(c,c,new w.kW(u))});break;case ut.lb.item:case ut.lb.itemDesign:case ut.lb.itemBlueprint:case ut.lb.itemFh:l.value&&(""+l.value).split("+").forEach(u=>{let b=d,x=-1;isNaN(+u)?(x=+u.split("-")[0],b=u.split("-")[1]):x=+u;const F=f.itemManager.getItem(x,b,!0);if(F){const z=new v.VP(""+F.id,F.edition);l.type==ut.lb.item||l.type==ut.lb.itemFh?((j.f.settings.characterItems||j.f.settings.characterSheet)&&(c.progress.items.find(H=>H.name==z.name&&H.edition==z.edition)?c.progress.gold+=f.itemManager.itemSellValue(F):c.progress.items.push(z)),f.itemManager.addItemCount(F)):f.game.party.unlockedItems.push(z)}});break;case ut.lb.calendarSection:if(l.value&&"string"==typeof l.value&&l.value.split("-").length>1){const u=l.value.split("-")[0],b=f.game.party.weeks+ +l.value.split("-")[1];f.game.party.weekSections[b]=[...f.game.party.weekSections[b]||[],u]}break;case ut.lb.campaignSticker:l.value&&"string"==typeof l.value&&f.game.party.campaignStickers.push(l.value);break;case ut.lb.partyAchievement:l.value&&"string"==typeof l.value&&f.game.party.achievementsList.push(l.value);break;case ut.lb.lootCards:if("number"==typeof l.value){f.game.lootDeck.active=!0;for(let u=0;u<l.value;u++)this.drawCard(f.game.lootDeck);f.uiChange.emit()}break;case ut.lb.scenario:if(l.value){const u=new kt.Ag(""+l.value,d);!f.game.party.manualScenarios.find(b=>b.index==u.index&&b.edition==u.edition&&b.group==u.group&&!b.custom)&&!f.game.party.scenarios.find(b=>b.index==u.index&&b.edition==u.edition&&b.group==u.group&&!b.custom)&&f.game.party.manualScenarios.push(u)}break;case ut.lb.randomScenario:if(j.f.settings.treasuresLootScenario){let u=f.scenarioManager.drawRandomScenario(d);u&&(f.game.party.manualScenarios.push(new kt.Ag(""+u.index,u.edition,u.group)),h.push(u.index,f.scenarioManager.scenarioTitle(u)))}break;case ut.lb.randomScenarioFh:if(j.f.settings.treasuresLootScenario){let u=f.scenarioManager.drawRandomScenarioSection(d);u&&(f.game.party.conclusions.push(new kt.Ag(""+u.index,u.edition,u.group)),h.push(u.index,f.scenarioManager.scenarioTitle(u,!0),u.unlocks?u.unlocks.map(b=>"%data.scenarioNumber:"+b+"%").join(", "):""))}break;case ut.lb.randomItem:case ut.lb.randomItemDesign:case ut.lb.randomItemBlueprint:if(j.f.settings.treasuresLootItem){let u=-1,b=-1;"string"==typeof l.value&&-1!=l.value.indexOf("-")&&(u=+l.value.split("-")[0],b=+l.value.split("-")[1]);let x=f.itemManager.drawRandomItem(d,l.type==ut.lb.randomItemBlueprint,u,b);x?(l.type==ut.lb.randomItem?c.progress.items.push(new v.gw(""+x.id,x.edition)):f.game.party.unlockedItems.push(new v.VP(""+x.id,x.edition)),h.push(""+x.id,"data.items."+x.name,x.edition)):f.game.party.inspiration+=1}}return h}getValue(c,l=!0){const d=f.characterManager.characterCount();let h=c.value4P;return d<=2?h=c.value2P:3==d&&(h=c.value3P),l&&(h+=c.enhancements),h}firstRound(){this.shuffleDeck(this.game.lootDeck)}fullLootDeck(){let c=JSON.parse(JSON.stringify(dt.Di));return this.game.lootDeckEnhancements.forEach(l=>{if(l.enhancements>0){const d=c.find(h=>h.type==l.type&&h.value2P==l.value2P&&h.value3P==l.value3P&&h.value4P==l.value4P&&0==h.enhancements);if(!d)return void console.warn("Enhancement of non-available loot card: "+l.type+":"+l.value4P+":"+l.value3P+":"+l.value2P);c.splice(c.indexOf(d),1,JSON.parse(JSON.stringify(l)))}}),c}apply(c,l={}){c.cards=[],Object.values(dt.r6).forEach(d=>{const h=(0,D.Z)(this.fullLootDeck().filter(b=>b.type==d)),u=Math.min(Math.max(l[d]||0),h.length);if(d!=dt.r6.special1&&d!=dt.r6.special2)for(let b=0;b<u;b++){const x=h[b];(d!=dt.r6.random_item||!this.randomItemLooted())&&c.cards.push(x)}else if(u>0){const b=h[0];c.cards.push(b),-1==this.game.lootDeckFixed.indexOf(b.type)&&(d!=dt.r6.special2||!this.game.party.conclusions.find(x=>"fh"==x.edition&&"128.5"==x.index))&&(d!=dt.r6.special1||!this.game.party.conclusions.find(x=>"fh"==x.edition&&"133.4"==x.index))&&this.game.lootDeckFixed.push(b.type)}else this.game.lootDeckFixed=this.game.lootDeckFixed.filter(b=>b!=d),c.cards=c.cards.filter(b=>b.type!=d)}),this.shuffleDeck(c)}randomItemLooted(){return null!=f.game.party.randomItemLooted.find(c=>this.game.scenario&&c.index==this.game.scenario.index&&c.edition==this.game.scenario.edition&&c.group==this.game.scenario.group)}valueLabel(c){return c.value4P==c.value3P&&c.value3P==c.value2P?""+(c.value4P>0?c.value4P:""):c.value4P==c.value3P&&c.value3P!=c.value2P?"%game.loot.player.3-4% +"+c.value4P+"/%game.loot.player.2% +"+c.value2P:c.value4P!=c.value3P&&c.value3P==c.value2P?"%game.loot.player.4% +"+c.value4P+"/%game.loot.player.2-3% +"+c.value2P:"%game.loot.player.4% +"+c.value4P+"/%game.loot.player.3% +"+c.value3P+"/%game.loot.player.2% +"+c.value2P}applySelectResources(c){c.characters.forEach((l,d)=>{c.characterSpent[d].gold&&(l.progress.gold-=c.characterSpent[d].gold),c.characterSpent[d].hide&&(l.progress.loot[dt.r6.hide]=(l.progress.loot[dt.r6.hide]||0)-c.characterSpent[d].hide),c.characterSpent[d].lumber&&(l.progress.loot[dt.r6.lumber]=(l.progress.loot[dt.r6.lumber]||0)-c.characterSpent[d].lumber),c.characterSpent[d].metal&&(l.progress.loot[dt.r6.metal]=(l.progress.loot[dt.r6.metal]||0)-c.characterSpent[d].metal)}),c.fhSupportSpent.hide&&(f.game.party.loot[dt.r6.hide]=(f.game.party.loot[dt.r6.hide]||0)-c.fhSupportSpent.hide),c.fhSupportSpent.lumber&&(f.game.party.loot[dt.r6.lumber]=(f.game.party.loot[dt.r6.lumber]||0)-c.fhSupportSpent.lumber),c.fhSupportSpent.metal&&(f.game.party.loot[dt.r6.metal]=(f.game.party.loot[dt.r6.metal]||0)-c.fhSupportSpent.metal)}}var Je=M(35385);class Ze{game;constructor(c){this.game=c}objectiveName(c){return c.title||c.name||c.escort?"escort":"objective"}addObjective(c=void 0,l=void 0,d=void 0){let h=f.game.figures.find(u=>u instanceof I.$e&&(!d&&c&&!u.objectiveId&&u.name==c.name&&u.health==(0,N.hZ)(""+c.health)&&u.escort==c.escort&&u.initiative==(c.initiative||99)||d&&u.objectiveId&&this.objectiveDataByObjectiveIdentifier(d)==this.objectiveDataByObjectiveIdentifier(u.objectiveId)));return h||(h=new I.$e((0,qt.v4)(),d),c&&(h.marker=c.marker,h.name=c.name,l&&(h.name=l),h.health=(0,N.hZ)(""+c.health),h.escort=c.escort,c.initiative&&(h.initiative=c.initiative)),h.edition=h.escort?"escort":"objective",this.game.figures.push(h)),f.addEntityCount(h),this.setInitiativeShare(h),f.sortFigures(h),h}removeObjective(c){const l=this.game.figures.indexOf(c);-1!=l&&this.game.figures.splice(l,1)}addObjectiveEntity(c,l=void 0,d=void 0,h=""){if(!l||c.entities.find(b=>b.number==l)){const b=c.entities.filter(x=>f.entityManager.isAlive(x)).length;if(l=b%12,b<12)for(;c.entities.find(x=>x.number-1==l);)l++}let u=new U.X((0,qt.v4)(),l+1,c,h||d&&d.marker||c.marker);return d&&(u.tags=d.tags),c.entities.push(u),c.off&&(c.off=!1),u}removeObjectiveEntity(c,l){c.entities.splice(c.entities.indexOf(l),1),(0==c.entities.length||c.entities.every(d=>!f.entityManager.isAlive(d)))&&(c.off||f.game.state!=A.mk.next?this.removeObjective(c):c.active?f.roundManager.toggleFigure(c):this.removeObjective(c))}objectiveEntityCountIdentifier(c,l){return"all"!=l.type&&(l.name!=c.name||l.edition!=c.edition)||"objective"!=l.type?0:c.entities.filter(d=>f.entityManager.isAlive(d)&&(!l.marker||l.marker==d.marker)&&(!l.tags||0==l.tags.length||l.tags.every(h=>-1!=d.tags.indexOf(h)))).length}skipObjective(c){if(c instanceof I.$e&&!c.escort){if(!c.objectiveId)return!0;{const l=this.objectiveDataByObjectiveIdentifier(c.objectiveId);if(!l||!l.actions||0==l.actions.length)return!0}}return!1}objectiveDataByObjectiveIdentifier(c){if("scenario"in c){const l=c.section?f.sectionData(c.edition).find(d=>d.index==c.scenario&&d.group==c.group):f.scenarioData(c.edition).find(d=>d.index==c.scenario&&d.group==c.group);if(l)if(c.section&&!l.objectives){const d=f.scenarioData(c.edition).find(h=>h.index==l.parent&&h.group==l.group);if(d&&d.objectives&&d.objectives.length>c.index)return d.objectives[c.index]}else if(l.objectives.length>c.index)return l.objectives[c.index]}else{const l=f.figuresByIdentifier(c);if(1==l.length){let d;const h=l[0];return h instanceof E.R&&h.boss&&f.monsterManager.getStat(h,Y.N.boss).special.forEach(b=>{b.forEach(x=>{!d&&(x.type==T.X2.summon||x.type==T.X2.spawn)&&"objectiveSpawn"==x.value&&(d=x.valueObject[0].objective)})}),d}}}next(){this.game.figures.forEach(c=>{c instanceof I.$e&&(c.off=!1,this.setInitiativeShare(c))})}setInitiativeShare(c){if(c.objectiveId){const l=f.objectiveManager.objectiveDataByObjectiveIdentifier(c.objectiveId);if(l&&l.initiativeShare){let d=0;const h=l.initiativeShare.split(":")[0];l.initiativeShare.split(":").length>0&&(d=+l.initiativeShare.split(":")[1]);const u=f.game.figures.find(b=>b instanceof E.R&&b.name==h);u&&(c.initiative=f.game.state==A.mk.next&&u.getInitiative()&&u.getInitiative()<100?d<0?Math.ceil(u.getInitiative()+d):Math.floor(u.getInitiative()+d):0)}}}draw(){this.game.figures.forEach(c=>{c instanceof I.$e&&(c.entities.some(l=>f.entityManager.isAlive(l))&&(c.off=!1),this.setInitiativeShare(c))})}}var Fe=M(49819);class Ee{game;working=!1;firstRound=!1;constructor(c){this.game=c}drawAvailable(){return this.game.figures.length>0&&(this.game.state==A.mk.next||this.game.figures.every(c=>c instanceof E.R||c instanceof I.$e&&(c.getInitiative()>0||!j.f.settings.initiativeRequired)||c instanceof O.K&&(c.getInitiative()>0||c.exhausted||c.absent||!j.f.settings.initiativeRequired)))}nextGameState(c=!1){if(this.working=!0,this.game.totalSeconds+=this.game.playSeconds,this.game.playSeconds=0,j.f.settings.scenarioRules&&f.scenarioRulesManager.addScenarioRules(),this.game.state==A.mk.next)this.game.state=A.mk.draw,f.entityManager.next(),f.characterManager.next(),f.monsterManager.next(),f.objectiveManager.next(),f.attackModifierManager.next(),j.f.settings.moveElements&&this.game.elementBoard.forEach(l=>{l.state!=S.e_.always&&(f.bbRules()?l.state=S.e_.inert:l.state==S.e_.strong||l.state==S.e_.new?(-1==[S.Hg.fire,S.Hg.ice,S.Hg.air,S.Hg.earth].indexOf(l.type)||!this.game.figures.find(d=>d instanceof O.K&&"triangles"==d.name&&d.tags.find(h=>"element_waning"===h)))&&(l.state=S.e_.waning):l.state==S.e_.waning&&(l.state=S.e_.inert))}),f.sortFigures(),this.game.figures.forEach(l=>{l.active=!1});else if(this.drawAvailable()||c){if(this.firstRound){f.attackModifierManager.firstRound(),f.lootManager.firstRound(),f.challengesManager.enabled&&(f.challengesManager.clearDrawn(this.game.challengeDeck,!0),f.challengesManager.applyCardsStart()),f.trialsManager.favorsEnabled&&f.trialsManager.apply&&f.trialsManager.applyFavorPoints(),this.game.challengeDeck.active=!1;let l=new kt.Nz(new V.tB,[],[],!0);this.game.scenario?l=this.game.scenario:this.game.scenario=l,this.game.figures.forEach(d=>{d instanceof O.K&&(f.game.scenario&&j.f.settings.characterItemsApply&&f.itemManager.applyEquippedItemEffects(d),j.f.settings.scenarioStats&&(d.scenarioStats=new Fe.yn))})}if(this.game.state=A.mk.next,this.game.round++,f.characterManager.draw(),f.monsterManager.draw(),f.objectiveManager.draw(),j.f.settings.moveElements&&this.game.elementBoard.forEach(l=>{l.state==S.e_.new&&(l.state=S.e_.strong)}),f.sortFigures(),f.challengesManager.apply&&f.challengesManager.isActive(1526,"fh")&&f.challengesManager.applyCardsTrigger(1526),this.game.figures.length>0&&(j.f.settings.initiativeRequired||j.f.settings.automaticFirstFigure)){let l=0,d=this.game.figures.find((h,u)=>u==l&&f.gameplayFigure(h));for(;!d&&l<this.game.figures.length-1;)l++,d=this.game.figures.find((h,u)=>u==l&&f.gameplayFigure(h));d&&this.toggleFigure(d,!0)}}j.f.settings.removeUnusedMonster&&this.game.figures.filter(l=>l instanceof E.R&&l.off&&0==l.entities.length&&-1==l.tags.indexOf("addedManually")).forEach(l=>{f.monsterManager.removeMonster(l)}),f.uiChange.emit(),setTimeout(()=>this.working=!1,1)}toggleFigure(c,l=!1){const d=this.game.figures;let h=d.indexOf(c),u=d.find(H=>H.active),b=u?d.indexOf(u):-1;if(!u&&d.every(H=>H.off))for(b=d.length-1,u=d[b];u&&!f.gameplayFigure(u);)b--,u=-1==b?void 0:d[b];const x=c.active||!f.objectiveManager.skipObjective(c)||l;if(-1==h)return void console.error("Invalid figure");let F=c,z=c.active;if(j.f.settings.activeSummons&&c instanceof O.K){const H=c.summons.find(at=>at.active||-1!=at.tags.indexOf("cs-skull-spirit-turn")),Q=c.summons.filter(at=>-1!=at.tags.indexOf("cs-skull-spirit"));H&&(-1==Q.indexOf(H)||!H.active||Q.indexOf(H)<Q.length-1)&&(z=!1)}if(z&&(this.afterTurn(c),F=d.find((H,Q)=>f.gameplayFigure(H)&&!H.off&&Q!=h),!c.off&&c instanceof E.R&&c.bb&&-1!=c.tags.indexOf("bb-elite")&&((!F||F.getInitiative()>c.getInitiative())&&(F=c),f.sortFigures())),x)for(;F&&f.objectiveManager.skipObjective(F);)h=d.indexOf(F),this.turn(F),this.afterTurn(F),F=d.find((H,Q)=>f.gameplayFigure(H)&&!H.off&&Q!=h);if(F){h=d.indexOf(F);for(let H=0;H<d.length;H++){const Q=d[H];f.gameplayFigure(Q)&&(H<h&&H>=b&&!Q.off?(H>b&&(this.beforeTurn(Q),this.turn(Q,!0)),this.afterTurn(Q)):H==h?(Q.active||this.beforeTurn(Q),this.turn(Q)):!z&&H>h&&H<=b&&this.beforeTurn(Q))}}}beforeTurn(c){if(c.off||c.active?(c.off=!1,c instanceof E.R&&c.entities.forEach(l=>{l.active=c.active&&!l.off}),f.entityManager.entitiesAll(c,!1).forEach(l=>{if(j.f.settings.applyConditions){const d=(l instanceof R.I||l instanceof X.up)&&l.dead;if(f.entityManager.unapplyConditionsTurn(l,c),f.entityManager.unapplyConditionsAfter(l,c),d&&!l.dead){const h=f.additionalIdentifier(c,l);let u=f.entityCounter(h);u&&u.killed--}}}),f.entityManager.entitiesAll(c).forEach(l=>{j.f.settings.expireConditions&&f.entityManager.restoreConditions(l)}),c instanceof O.K&&("music-note"==c.name&&-1!=c.tags.indexOf("song_active")&&(c.experience-=1),!c.active&&"skull"==c.name&&c.tags.find(l=>"spirits"===l)&&c.summons.filter(l=>-1!=l.tags.indexOf("cs-skull-spirit")).forEach(l=>{l.maxHealth&&(l.health+=1,f.entityManager.checkHealth(l,c))}))):c instanceof E.R&&!c.entities.find(l=>l.active)&&c.entities.forEach(l=>{l.active=c.active,l.off=!1}),c instanceof O.K&&j.f.settings.activeSummons&&c.summons.forEach(l=>{l.active&&(l.active=!1)}),c instanceof O.K&&c.longRest&&j.f.settings.applyLongRest){const l=c.entityConditions.find(d=>d.name==w.r5.heal&&d.value&&d.expired);l&&(c.entityConditions=c.entityConditions.filter(d=>d!=l)),j.f.settings.characterItems&&c.progress.equippedItems.forEach(d=>{if(d.tags){const h=f.itemManager.getItem(d.name,d.edition,!0);d.tags=d.tags.filter(u=>u!=Ot.Tr.spent),h&&h.spent&&(d.tags=d.tags.filter(u=>u!=Ot.Tr.slot&&u!=Ot.Tr.slotBack))}})}c.off&&f.entityManager.entities(c).length>0&&(c.off=!1),c.active=!1}turn(c,l=!1){if(c.active=!0,f.scenarioRulesManager.addActiveFigureRule(c),c instanceof E.R&&!c.entities.find(d=>d.active)&&c.entities.forEach(d=>{!c.off&&d.summon!=X.N5.new&&f.entityManager.isAlive(d)&&(d.active=!0)}),c instanceof O.K&&f.entityManager.isAlive(c))if(!l&&j.f.settings.activeSummons){const d=c.summons.find(u=>f.entityManager.isAlive(u,!0)&&u.active),h=c.summons.find((u,b,x)=>(!d||b>x.indexOf(d))&&f.entityManager.isAlive(u,!0)&&-1==u.tags.indexOf("prism_mode")&&((!d||-1==d.tags.indexOf("cs-skull-spirit"))&&-1==u.tags.indexOf("cs-skull-spirit")||-1!=u.tags.indexOf("cs-skull-spirit-turn")));c.summons.slice(d?c.summons.indexOf(d):0,h?c.summons.indexOf(h):c.summons.length).forEach((u,b,x)=>{u.active=!1,u.tags=u.tags.filter(F=>"cs-skull-spirit-turn"!=F),j.f.settings.expireConditions&&f.entityManager.expireConditions(u,c),j.f.settings.scenarioRules&&f.scenarioRulesManager.applyScenarioRulesTurn(u,!0),j.f.settings.applyConditions&&(!d||b>0)&&(f.entityManager.applyConditionsTurn(u,c),f.entityManager.applyConditionsAfter(u,c))}),h?(h.active=!0,j.f.settings.applyConditions&&f.entityManager.applyConditionsTurn(h,c),j.f.settings.scenarioRules&&f.scenarioRulesManager.applyScenarioRulesTurn(h),h.dead&&this.turn(c)):(this.game.elementBoard.forEach(u=>{u.state==S.e_.new&&(u.state=S.e_.strong)}),c.summons.forEach(u=>{u.active&&(u.active=!1)}),"lightning"==c.name&&-1!=c.tags.indexOf("blood-pact")&&(c.health-=1,f.entityManager.checkHealth(c,c)))}else c.summons.forEach(d=>{d.active=!1,j.f.settings.applyConditions&&f.entityManager.applyConditionsTurn(d,c),j.f.settings.scenarioRules&&f.scenarioRulesManager.applyScenarioRulesTurn(d)}),"lightning"==c.name&&-1!=c.tags.indexOf("blood-pact")&&(c.health-=1,f.entityManager.checkHealth(c,c));if(this.game.elementBoard.forEach(d=>{d.state==S.e_.new&&(d.state=S.e_.strong)}),c instanceof O.K&&!l?!l&&!c.summons.some(d=>d.active)&&(j.f.settings.applyConditions&&f.entityManager.applyConditionsTurn(c,c),j.f.settings.scenarioRules&&f.scenarioRulesManager.applyScenarioRulesTurn(c)):f.entityManager.entitiesAll(c).forEach(d=>{j.f.settings.applyConditions&&f.entityManager.applyConditionsTurn(d,c),j.f.settings.scenarioRules&&f.scenarioRulesManager.applyScenarioRulesTurn(d)}),c instanceof O.K&&(l||!c.summons.some(d=>d.active))&&("music-note"==c.name&&-1!=c.tags.indexOf("song_active")&&(c.experience+=1),"prism"==c.name&&(-1!=c.tags.indexOf("repair_mode")&&-1==c.tags.indexOf("roundAction-repair_mode")&&(c.health+=2,f.entityManager.addCondition(c,c,new w.kW(w.r5.heal,2)),f.entityManager.applyCondition(c,c,w.r5.heal,!0),c.tags.push("roundAction-repair_mode")),-1!=c.tags.indexOf("spider_mode")&&-1==c.tags.indexOf("roundAction-spider_mode")&&(f.entityManager.addCondition(c,c,new w.kW(w.r5.ward)),c.tags.push("roundAction-spider_mode")))),c instanceof O.K&&j.f.settings.applyLongRest&&c.longRest&&(l||!c.summons.some(d=>d.active))&&(c.health<c.maxHealth||c.entityConditions.find(d=>!d.expired&&-1!=d.types.indexOf(w.GV.clearHeal)&&!d.permanent))){let d=2;("lightning"==c.name&&"fh-crossover"==c.edition&&c.tags.find(h=>"rapid_recovery"===h)||"lightning"==c.name&&"gh2e"==c.edition&&c.tags.find(h=>"long_rest_heal"===h))&&(d+=1),c.health+=d,f.entityManager.addCondition(c,c,new w.kW(w.r5.heal,d)),f.entityManager.applyCondition(c,c,w.r5.heal,!0)}(c instanceof O.K&&!f.entityManager.isAlive(c)||c instanceof E.R&&c.entities.every(d=>!f.entityManager.isAlive(d))||c instanceof I.$e&&c.entities.every(d=>!f.entityManager.isAlive(d)))&&this.toggleFigure(c)}afterTurn(c){if(!c.off){if(f.scenarioRulesManager.addActiveFigureRule(c,!0),c instanceof E.R&&c.entities.forEach(l=>{l.active=!1,l.off=!0}),j.f.settings.activeSummons&&c instanceof O.K){let l=c.summons.find(d=>f.entityManager.isAlive(d,!0)&&d.active);for(;l;)this.turn(c),l=c.summons.find(d=>f.entityManager.isAlive(d,!0)&&d.active)}if(c instanceof O.K&&(c.summons.forEach(l=>{j.f.settings.activeSummons||(l.active=!1,f.entityManager.isAlive(l)&&(j.f.settings.expireConditions&&f.entityManager.expireConditions(l,c),j.f.settings.applyConditions&&f.entityManager.applyConditionsAfter(l,c),j.f.settings.scenarioRules&&f.scenarioRulesManager.applyScenarioRulesTurn(l,!0)))}),"skull"==c.name&&c.tags.find(l=>"spirits"===l)&&c.summons.filter(l=>-1!=l.tags.indexOf("cs-skull-spirit")).forEach(l=>{l.maxHealth&&(l.health-=1,f.entityManager.checkHealth(l,c))})),c instanceof O.K&&"fist"==c.name&&-1!=c.tags.indexOf("gift-of-the-mountain")&&(c.health<(0,N.hZ)(c.maxHealth,c.level)||c.entityConditions.find(l=>-1!=l.types.indexOf(w.GV.clearHeal)&&!l.permanent&&!l.expired))){let l=c.entityConditions.find(d=>d.name==w.r5.heal);l||(l=new w.BR(w.r5.heal,2),c.entityConditions.push(l)),l.value=2,l.expired=!1,l.state=w.mg.normal,c.health+=2,f.entityManager.applyCondition(c,c,w.r5.heal,!0)}c instanceof O.K&&"shards"==c.name&&-1!=c.tags.indexOf("resonance_tokens")&&c.tokenValues[0]<5&&(c.tokenValues[0]+=1),c instanceof O.K?(j.f.settings.expireConditions&&f.entityManager.expireConditions(c,c),j.f.settings.applyConditions&&f.entityManager.applyConditionsAfter(c,c),j.f.settings.scenarioRules&&f.scenarioRulesManager.applyScenarioRulesTurn(c,!0)):f.entityManager.entitiesAll(c).forEach(l=>{j.f.settings.expireConditions&&f.entityManager.expireConditions(l,c),j.f.settings.applyConditions&&f.entityManager.applyConditionsAfter(l,c),j.f.settings.scenarioRules&&f.scenarioRulesManager.applyScenarioRulesTurn(l,!0)})}this.game.elementBoard.forEach(l=>{l.state==S.e_.new&&(l.state=S.e_.strong),(l.state==S.e_.consumed||l.state==S.e_.partlyConsumed)&&(l.state=S.e_.inert)}),c.off=!0,c.active=!1,c instanceof E.R&&c.bb&&-1!=c.tags.indexOf("bb-elite")&&-1==c.tags.indexOf("roundAction-bb-elite")&&(c.tags.push("roundAction-bb-elite"),c.ability+=1,c.ability>=c.abilities.length&&(c.ability=0),c.off=!1)}resetScenario(){if(this.game.playSeconds=0,this.game.sections=[],this.game.scenario&&(this.game.scenario.revealedRooms=[],this.game.scenario.additionalSections=[]),this.game.scenarioRules=[],this.game.appliedScenarioRules=[],this.game.discardedScenarioRules=[],this.game.round=0,this.game.roundResets=[],this.game.roundResetsHidden=[],this.game.eventDraw=void 0,this.game.state=A.mk.draw,this.game.elementBoard.forEach(l=>l.state=S.e_.inert),f.attackModifierManager.fromModel(this.game.monsterAttackModifierDeck,(new K.J).toModel()),f.attackModifierManager.fromModel(this.game.allyAttackModifierDeck,(new K.J).toModel()),f.bbRules()){const l=f.editionData.find(d=>"bb"==d.edition&&d.monsterAmTables&&d.monsterAmTables.length);if(l){const d=f.levelManager.bbMonsterDifficutly();this.game.monsterAttackModifierDeck=new K.J(l.monsterAmTables[d].map(h=>new K.uU(h)),j.f.settings.bbAm)}}this.game.figures=this.game.figures.filter(l=>l instanceof O.K||this.game.scenario&&this.game.scenario.custom),this.game.entitiesCounter=[],this.game.lootDeck.fromModel(new dt.yX),this.game.challengeDeck.active=!1,this.game.challengeDeck.cards.length&&f.challengesManager.clearDrawn(this.game.challengeDeck),this.game.keepFavors||(this.game.favors=[],this.game.favorPoints=[]),this.game.figures.forEach(l=>{if(l.active=!1,l.off=!1,l instanceof O.K){if("demolitionist"==l.name&&l.tags.find(d=>"mech"===d)){const d=l.stats.find(h=>h.level==l.level);d&&(l.maxHealth=d.health)}if("astral"==l.name&&l.tags.find(d=>"veil-of-protection"===d)){const d=l.stats.find(h=>h.level==l.level);d&&(l.maxHealth=d.health)}l.health=l.maxHealth,l.loot=0,l.lootCards=[],l.treasures=[],l.experience=0,l.entityConditions=[],l.immunities=[],l.summons=[],l.initiative=0,l.exhausted=!1,l.longRest=!1,l.token=0,l.tokenValues[l.primaryToken]=0,l.battleGoal=!1,l.battleGoals=[],l.shield=void 0,l.shieldPersistent=void 0,l.retaliate=[],l.retaliatePersistent=[],l.scenarioStats=new Fe.yn,f.fhRules()&&-1!=l.tags.indexOf("new-character")&&(l.progress.gold=0),l.tags=l.tags.filter(d=>"new-character"!=d&&!l.specialActions.find(h=>h.name==d&&h.expire)),null!=l.defaultIdentity&&(l.identity=l.defaultIdentity),"blinkblade"==l.name&&l.tags.find(d=>"time_tokens"===d)&&0==l.primaryToken&&(l.tokenValues[0]+=1),"kelp"==l.name&&l.tags.find(d=>"trophy_tokens"===d)&&0==l.primaryToken&&(l.tokenValues[0]+=2),"shards"==l.name&&l.tags.find(d=>"resonance_tokens"===d)&&0==l.primaryToken&&(l.tokenValues[0]+=1),"shards"==l.name&&l.tags.find(d=>"extra_resonance_tokens"===d)&&0==l.primaryToken&&(l.tokenValues[0]+=2,f.entityManager.addCondition(l,l,new w.kW(w.r5.brittle))),l.availableSummons.filter(d=>d.special).forEach(d=>f.characterManager.createSpecialSummon(l,d)),l.attackModifierDeck=f.attackModifierManager.buildCharacterAttackModifierDeck(l),l.lootCardsVisible=!1,l.progress.equippedItems=l.progress.equippedItems.filter(d=>"loot-random-item"!=d.marker),l.progress.equippedItems.forEach(d=>d.tags=[]),f.characterManager.applyDonations(l)}else l instanceof E.R?(l.entities=[],l.ability=-1,l.abilities=[],f.monsterManager.resetMonsterAbilities(l)):l instanceof I.$e&&(l.entities=[])});const c=f.campaignData();if(this.game.party.townGuardDeck&&c.townGuardPerks){const l=f.attackModifierManager.buildTownGuardAttackModifierDeck(this.game.party,c);f.attackModifierManager.shuffleModifiers(l),l.active=!1,this.game.party.townGuardDeck=l.toModel()}this.game.party.pets&&this.game.party.pets.forEach(l=>{l.lost=!1}),f.trialsManager.applyTrialCards(),f.stateManager.standeeDialogCanceled=!1,f.uiChange.emit()}}var Sn=M(58503);class $n{game;constructor(c){this.game=c}createScenario(){return new kt.Nz(new V.tB,[],[],!0)}getScenario(c,l,d){return f.scenarioData(l).find(h=>h.index==c&&h.edition==l&&h.group==d)}getSection(c,l,d,h=!1){return f.sectionData(l).find(u=>u.index==c&&u.edition==l&&u.group==d&&(!h||u.conclusion))}setScenario(c,l=!1){if(this.game.scenario=c?new kt.Nz(c,c.revealedRooms,c.additionalSections,c.custom):void 0,c&&!c.custom){const d=f.scenarioData().find(h=>h.index==c.index&&h.edition==c.edition&&h.group==c.group);if(!d)return void console.error("Could not find scenario data!");f.roundManager.resetScenario(),this.applyScenarioData(d,!1,l),j.f.settings.scenarioRules&&f.scenarioRulesManager.addScenarioRules(!0)}else c||f.roundManager.resetScenario();f.stateManager.standeeDialogCanceled=!1}finishScenario(c,l=!0,d,h=!1,u=!1,b=!0,x=!0,F=!1){if(f.game.finish=void 0,c){let z=c.rewards?Object.assign(new V.$v,c.rewards):void 0;if(d&&d.rewards&&(z?Object.assign(z,d.rewards):z=Object.assign(new V.$v,d.rewards)),!F&&b&&j.f.settings.scenarioStats&&this.game.figures.forEach(H=>{H instanceof O.K&&!H.absent&&(H.progress.scenarioStats=H.progress.scenarioStats||[],f.scenarioStatsManager.applyScenarioStats(H,c,l),H.progress.scenarioStats.push(H.scenarioStats))}),!F&&b&&j.f.settings.characterSheet&&this.game.figures.forEach(H=>{if(H instanceof O.K&&!H.absent){const Q=!l||z&&z.ignoredBonus&&-1!=z.ignoredBonus.indexOf("experience")?0:f.levelManager.experience();f.characterManager.addXP(H,Q+H.experience,!h&&!u),(!z||!z.ignoredBonus||-1==z.ignoredBonus.indexOf("gold"))&&(H.progress.gold+=H.loot*f.levelManager.loot(),!h&&H.lootCards&&H.lootCards.forEach(at=>{f.lootManager.addCharacterLoot(H,this.game.lootDeck.cards[at])}))}}),l&&(z&&x&&(z.valueMapping&&Object.keys(z.valueMapping).forEach(H=>{if(z&&z.valueMapping&&z.valueMapping[H]){const Q=z.valueMapping[H],at=f.scenarioRulesManager.presentEntitiesByFigureRule(Q,void 0).length,ct=Q.value;z&&"string"==typeof z[ct]&&(z[ct]=z[ct].replaceAll(H,""+at))}}),!F&&j.f.settings.characterSheet&&this.game.figures.forEach(H=>{z&&H instanceof O.K&&!H.absent&&j.f.settings.scenarioRewards&&(z.experience&&f.characterManager.addXP(H,z.experience,!h&&!u),z.gold&&(H.progress.gold+=z.gold),z.perks&&(H.progress.extraPerks+=z.perks,H.progress.extraPerks<0&&(H.progress.extraPerks=0)),z.battleGoals&&(H.progress.battleGoals+=z.battleGoals,H.progress.battleGoals>18?H.progress.battleGoals=18:H.progress.battleGoals<0&&(H.progress.battleGoals=0)),z.resources&&z.resources.forEach(Q=>{H.progress.loot[Q.type]=(H.progress.loot[Q.type]||0)+(0,N.hZ)(Q.value),(H.progress.loot[Q.type]||0)<0&&(H.progress.loot[Q.type]=0)}))}),z.globalAchievements&&this.game.party.globalAchievementsList.push(...z.globalAchievements),z.partyAchievements&&this.game.party.achievementsList.push(...z.partyAchievements),z.lostPartyAchievements&&(this.game.party.achievementsList=this.game.party.achievementsList.filter(H=>z&&-1==z.lostPartyAchievements.indexOf(H))),z.campaignSticker&&this.game.party.campaignStickers.push(...z.campaignSticker.map(H=>H.toLowerCase().replaceAll(" ","-"))),z.eventDecks&&z.eventDecks.forEach(H=>{const Q=H.split(":")[0],at=f.eventCardManager.getEventCardsForEdition(c.edition,Q),ct=at.find(wt=>wt.cardId==H.split(":")[1].split("|")[0]),gt=at.find(wt=>wt.cardId==H.split(":")[1].split("|")[1]);ct&&gt?f.eventCardManager.buildEventDeck(Q,at.slice(at.indexOf(ct),at.indexOf(gt)+1).map(wt=>wt.cardId)):console.warn("Could not find start and end for: "+H)}),j.f.settings.partySheet&&(z.reputation&&(this.game.party.reputation+=z.reputation,this.game.party.reputation>20?this.game.party.reputation=20:this.game.party.reputation<-20&&(this.game.party.reputation=-20)),z.reputationFactions&&z.reputationFactions.forEach(H=>{const Q=H.split(":")[0],at=+H.split(":")[1];this.game.party.factionReputation[Q]=(this.game.party.factionReputation[Q]||0)+at,this.game.party.factionReputation[Q]>20?this.game.party.factionReputation[Q]=20:this.game.party.factionReputation[Q]<-10&&(this.game.party.factionReputation[Q]=-10)}),z.prosperity&&(this.game.party.prosperity+=z.prosperity,this.game.party.prosperity>(f.fhRules()?132:64)?this.game.party.prosperity=f.fhRules()?132:64:this.game.party.prosperity<0&&(this.game.party.prosperity=0)),z.morale&&(this.game.party.morale+=(0,N.hZ)(z.morale),this.game.party.morale>20?this.game.party.morale=20:this.game.party.morale<0&&(this.game.party.morale=0)),z.inspiration&&(this.game.party.inspiration+=(0,N.hZ)(z.inspiration),this.game.party.inspiration<0&&(this.game.party.inspiration=0)),z.itemDesigns&&z.itemDesigns.forEach(H=>{if(-1!=H.indexOf("-")){const Q=+H.split("-")[0],at=+H.split("-")[1];for(let ct=Q;ct<=at;ct++){const gt=f.itemManager.getItem(ct,c.edition,!0);gt&&(!gt.unlockScenario||gt.unlockScenario.edition!=c.edition||gt.unlockScenario.name!=c.index)&&this.game.party.unlockedItems.push(new v.VP(gt.id+"",c.edition))}}else{let Q=c.edition;-1!=H.indexOf(":")&&(Q=H.split(":")[1]);const at=f.itemManager.getItem(H.split(":")[0],Q,!0);at&&(!at.unlockScenario||at.unlockScenario.edition!=c.edition||at.unlockScenario.name!=c.index)&&this.game.party.unlockedItems.push(new v.VP(at.id+"",at.edition))}}),z.itemBlueprints&&z.itemBlueprints.forEach(H=>{if(-1!=H.indexOf("-")){const Q=+H.split("-")[0],at=+H.split("-")[1];for(let ct=Q;ct<=at;ct++)this.game.party.unlockedItems.push(new v.VP(ct+"",c.edition))}else{let Q=c.edition;-1!=H.indexOf(":")&&(Q=H.split(":")[1]),this.game.party.unlockedItems.push(new v.VP(H,Q))}}),z.calendarSection&&z.calendarSection.forEach(H=>{if(H.split("-").length>1){const Q=H.split("-")[0];let at=-1;if(isNaN(+H.split("-")[1])){if(H.split("-")[1].length>1){const ct=H.split("-")[1].split(":")[0],gt=+H.split("-")[1].split(":")[1];at=Math.max(f.game.party.weeks-1,0)-Math.max(f.game.party.weeks-1,0)%20+("summer"==ct?20:10)+gt}}else at=f.game.party.weeks+ +H.split("-")[1];-1!=at&&(f.game.party.weekSections[at]=[...f.game.party.weekSections[at]||[],Q])}}),z.pet&&null==f.game.party.pets.find(H=>H.edition==c.edition&&H.name==z.pet)&&f.game.party.pets.push(new Sn.j(z.pet,c.edition)),z.events&&j.f.settings.events&&z.events.forEach(H=>{H.split(":").length>1&&f.eventCardManager.addEvent(H.split(":")[0],H.split(":")[1],!0)})),j.f.settings.automaticUnlocking&&z.unlockCharacter&&-1==this.game.unlockedCharacters.indexOf(c.edition+":"+z.unlockCharacter)&&this.game.unlockedCharacters.push(c.edition+":"+z.unlockCharacter),z.lootDeckCards&&z.lootDeckCards.forEach(H=>{const Q=dt.Di.find(at=>at.cardId==H);Q&&(Q.type!=dt.r6.special1&&Q.type!=dt.r6.special2||-1==f.game.lootDeckFixed.indexOf(Q.type))&&f.game.lootDeckFixed.push(Q.type)})),f.characterManager.characterCount()<4&&!F&&!c.solo&&x&&(!z||!z.ignoredBonus||-1==z.ignoredBonus.indexOf("inspiration"))&&(this.game.party.inspiration+=4-f.characterManager.characterCount()),d&&!d.repeatable&&!this.game.party.conclusions.find(H=>H.index==d.index&&H.edition==d.edition&&H.group==d.group)&&this.game.party.conclusions.push(new kt.Ag(d.index,d.edition,d.group)),f.game.party.campaignMode&&x)){c.conclusion?!c.repeatable&&!this.game.party.conclusions.find(Q=>Q.index==c.index&&Q.edition==c.edition&&Q.group==c.group)&&this.game.party.conclusions.push(new kt.Ag(c.index,c.edition,c.group)):!c.hideIndex&&(!z||!z.repeatScenario)&&this.game.party.scenarios.push(new kt.Ag(c.index,c.edition,c.group,c.custom,c.custom?c.name:"",c.revealedRooms)),f.imbuementManager.imbuement&&(this.game.party.imbuement+="advanced"==f.imbuementManager.imbuement?2:1);const H=f.campaignData();if(z&&j.f.settings.partySheet&&z.townGuardAm&&z.townGuardAm.length>0&&H.townGuardPerks){const Q=f.attackModifierManager.buildTownGuardAttackModifierDeck(this.game.party,H);f.attackModifierManager.shuffleModifiers(Q),Q.active=!1,this.game.party.townGuardDeck=Q.toModel()}}if(h)f.scenarioManager.setScenario(c);else{if(c&&!c.conclusion&&(!z||!z.calendarIgnore)&&f.fhRules()&&!u&&j.f.settings.automaticPassTime&&!c.solo&&j.f.settings.partySheet&&!F&&x){this.game.party.weeks++,f.buildingsManager.nextWeek();const H=f.editionData.find(at=>at.edition==c.edition);let Q=[];H&&H.campaign&&Q.push(...H.campaign.weeks&&H.campaign.weeks[this.game.party.weeks]||[]),Q.push(...this.game.party.weekSections[this.game.party.weeks]||[]),Q.forEach(at=>{const ct=f.sectionData(c.edition).find(gt=>gt.index==at&&gt.group==c.group&&gt.conclusion);if(ct){const gt=new kt.Nz(ct);this.finishScenario(gt,!0,gt,!1,void 0,!1,x,!0)}})}l&&!c.hideIndex&&(!f.game.party.campaignMode||!x&&!d)&&this.game.party.casualScenarios.push(new kt.Ag(c.index,c.edition,c.group,c.custom,c.custom?c.name:"",c.revealedRooms)),F||(this.game.scenario=void 0,this.game.sections=[],f.roundManager.resetScenario())}}}addSection(c){this.game.sections.some(l=>l.edition==c.edition&&l.index==c.index&&l.group==c.group)||(this.applyScenarioData(c,!0),j.f.settings.scenarioRules&&c.rules&&(c.rules.forEach((l,d)=>{l.always&&f.scenarioRulesManager.addScenarioRule(c,l,d,!0)}),f.scenarioRulesManager.filterDisabledScenarioRules()),this.game.sections.push(new kt.Nz(c,[])),f.stateManager.standeeDialogCanceled=!1)}applyScenarioData(c,l=!1,d=!1){if(f.stateManager.standeeDialogCanceled=!0,j.f.settings.scenarioRooms&&c.rooms&&0!=c.rooms.length){if(c.rooms.filter(h=>h.initial).forEach(h=>{this.openRoom(h,c,l)}),c.monsters){let h=f.game.figures.filter(u=>u instanceof E.R).map(u=>u);c.monsters.forEach(u=>{const b=u.split(":")[0],x=f.monstersData(c.edition).find(F=>F.name==b);x&&!h.find(F=>F.name==x.name)&&h.push(new E.R(x))}),c.monsters.forEach(u=>{const b=u.split(":")[0],x=j.f.settings.automaticStandees&&c.rooms&&c.rooms.some(Q=>Q.monster&&Q.monster.some(at=>at.name.split(":")[0]==b)),F=f.monsterManager.getSpawnMonsters(h),z=j.f.settings.interactiveAbilities&&F.find(Q=>Q.name==b),H=j.f.settings.scenarioRules&&this.getRuleMonster(new kt.Nz(c)).find(Q=>Q.name==b);if(!x&&!z&&!H){let Q=f.monsterManager.addMonsterByName(u,c.edition);Q&&(Q.isAlly=c.allies&&-1!=c.allies.indexOf(b)||l&&f.game.scenario&&f.game.scenario.allies&&-1!=f.game.scenario.allies.indexOf(b)||!1,Q.isAllied=c.allied&&-1!=c.allied.indexOf(b)||l&&f.game.scenario&&f.game.scenario.allied&&-1!=f.game.scenario.allied.indexOf(b)||!1,Q.drawExtra=c.drawExtra&&-1!=c.drawExtra.indexOf(b)||l&&f.game.scenario&&f.game.scenario.drawExtra&&-1!=f.game.scenario.drawExtra.indexOf(b)||!1)}})}}else c.monsters&&c.monsters.forEach(h=>{const u=h.split(":")[0];let b=f.monsterManager.addMonsterByName(h,c.edition);b&&(b.isAlly=c.allies&&-1!=c.allies.indexOf(u)||l&&f.game.scenario&&f.game.scenario.allies&&-1!=f.game.scenario.allies.indexOf(u)||!1,b.isAllied=c.allied&&-1!=c.allied.indexOf(u)||l&&f.game.scenario&&f.game.scenario.allied&&-1!=f.game.scenario.allied.indexOf(u)||!1,b.drawExtra=c.drawExtra&&-1!=c.drawExtra.indexOf(u)||l&&f.game.scenario&&f.game.scenario.drawExtra&&-1!=f.game.scenario.drawExtra.indexOf(u)||!1)}),c.objectives&&c.objectives.forEach((h,u)=>{const x=f.objectiveManager.addObjective(h,void 0,{edition:c.edition,scenario:c.index,group:c.group,section:l,index:u});f.objectiveManager.addObjectiveEntity(x)});if(j.f.settings.addAllMonsters&&this.getMonsters(new kt.Nz(c),!0).forEach(h=>{this.game.figures.find(u=>u instanceof $.f&&u.name==h.name&&u.edition==h.edition)||f.monsterManager.addMonster(h,this.game.level)}),c.solo&&(f.game.figures.forEach(h=>{h instanceof O.K&&(h.absent=h.name!=c.solo||h.edition!=c.edition)}),!f.game.figures.some(h=>h instanceof O.K&&h.name==c.solo&&h.edition==c.edition))){const h=f.charactersData().find(u=>u.name==c.solo&&u.edition==c.edition);h?f.characterManager.addCharacter(h,5):console.error("Solo Scenario Character not found: '"+c.solo+"' ("+c.name+")")}if(c.lootDeckConfig){let h=JSON.parse(JSON.stringify(c.lootDeckConfig));this.game.lootDeckFixed.forEach(u=>{h[u]=1}),f.lootManager.apply(this.game.lootDeck,h)}if(c.resetRound){const h=c.resetRound.endsWith("Keep")&&(this.game.state==A.mk.next&&this.game.round%2==0||this.game.state==A.mk.draw&&this.game.round%2==1)?1:0;"visible"==c.resetRound||"visibleKeep"==c.resetRound?this.game.roundResets.push(this.game.round+(this.game.state==A.mk.draw?0:-1)-h):this.game.roundResetsHidden.push(this.game.round+(this.game.state==A.mk.draw?0:-1)-h),this.game.round=(this.game.state==A.mk.draw?0:1)+h}if(f.bbRules()&&c.level&&f.game.figures.forEach(h=>{h instanceof O.K&&c.level&&f.characterManager.setLevel(h,c.level)}),j.f.settings.partySheet&&j.f.settings.events&&c.eventType&&!d){let h=c.eventType;"fh"==c.edition&&("road"==h||"outpost"==h)&&(h=(Math.max(f.game.party.weeks-1,0)%20<10?"summer-":"winter-")+h),f.game.eventDraw=h}j.f.settings.partySheet&&j.f.settings.events&&j.f.settings.eventsApply&&f.game.party.eventCards&&f.game.party.eventCards.filter(h=>h.scenarioApply).forEach(h=>{const u=f.eventCardManager.getEventCardForEdition(h.edition,h.type,h.cardId);if(u&&-1!=h.selected){const b=u.options[h.selected];if(b&&b.outcomes&&b.outcomes.forEach((x,F)=>{x.effects&&(!h.subSelections||0==h.subSelections.length||-1!=h.subSelections.indexOf(F))&&f.eventCardManager.applyEffects(u,x.effects.filter(z=>"string"!=typeof z),!0)}),h.attack){const x=u.options.find(F=>!!F.outcomes&&F.outcomes.some(z=>!!z.attack&&!!z.attack.effects));if(x){const F=x.outcomes.find(z=>!!z.attack&&!!z.attack.effects);F&&F.attack&&f.eventCardManager.applyEffects(u,F.attack.effects.filter(z=>"string"!=typeof z),!0)}}}h.scenarioApply=!1}),j.f.settings.removeUnusedMonster&&this.game.figures.filter(h=>h instanceof E.R&&h.off&&0==h.entities.length&&-1==h.tags.indexOf("addedManually")).forEach(h=>{f.monsterManager.removeMonster(h)})}openRoom(c,l,d){if(this.game.scenario&&(this.game.scenario.revealedRooms=this.game.scenario.revealedRooms||[],this.game.scenario.revealedRooms.push(c.roomNumber)),c.monster){let h=[];c.monster.forEach(u=>{let b=u.type;if(!b){const x=f.characterManager.characterCount();b=x<3?u.player2:3==x?u.player3:u.player4}!b&&!u.player2&&!u.player3&&!u.player4&&(b=Y.N.normal),(b==Y.N.boss||b==Y.N.elite)&&h.push(...this.applyRoomSpawn(l,u,b,d))}),c.monster.forEach(u=>{let b=u.type;if(!b){const x=f.characterManager.characterCount();b=x<3?u.player2:3==x?u.player3:u.player4}!b&&!u.player2&&!u.player3&&!u.player4&&(b=Y.N.normal),b==Y.N.normal&&h.push(...this.applyRoomSpawn(l,u,b,d))}),this.game.state==A.mk.next&&this.game.figures.forEach(u=>{u instanceof E.R&&(u.edition==l.edition||-1!=f.editionExtensions(l.edition).indexOf(u.edition))&&u.entities.some(b=>-1!=h.indexOf(b))&&(u.active=u.active||!this.game.figures.some(b=>b.active),u.entities.forEach(b=>{-1!=h.indexOf(b)&&(b.active=u.active||f.game.figures.some((x,F,z)=>x.active&&F>z.indexOf(u)),b.revealed=!0)}))}),this.game.figures.find(u=>u instanceof O.K&&"snowflake"==u.name&&-1!=u.tags.indexOf("muddle-monster"))&&this.game.figures.forEach(u=>{u instanceof E.R&&u.entities.forEach(b=>{-1!=h.indexOf(b)&&!f.entityManager.isImmune(b,u,w.r5.muddle)&&f.entityManager.addCondition(b,u,new w.kW(w.r5.muddle))})})}c.objectives&&c.objectives.forEach(h=>{if("number"==typeof h&&h>0){const u={edition:l.edition,scenario:l.index,group:l.group,section:d,index:h-1},b=f.objectiveManager.objectiveDataByObjectiveIdentifier(u);if(b){const x=f.objectiveManager.addObjective(b,void 0,u);f.objectiveManager.addObjectiveEntity(x)}}else if("string"==typeof h&&-1!=h.indexOf(":")){let u=h.split(":");const b=+u.splice(0,1),x=(0,N.hZ)(u.join(":"));if(b>0&&x>0){const F={edition:l.edition,scenario:l.index,group:l.group,section:d,index:b-1},z=f.objectiveManager.objectiveDataByObjectiveIdentifier(F);if(z){const H=f.objectiveManager.addObjective(z,void 0,F);for(let Q=0;Q<x;Q++)f.objectiveManager.addObjectiveEntity(H)}}}else if("string"==typeof h&&-1!=h.indexOf("-")){let u=h.split("-");const b=+u[0],x=u[1];if(b>0&&x){const F={edition:l.edition,scenario:l.index,group:l.group,section:d,index:b-1},z=f.objectiveManager.objectiveDataByObjectiveIdentifier(F);if(z){const H=f.objectiveManager.addObjective(z,void 0,F);f.objectiveManager.addObjectiveEntity(H,void 0,void 0,x)}}}})}applyRoomSpawn(c,l,d,h){let u=[];const b=l.name.split(":")[0],x=c.allies&&-1!=c.allies.indexOf(b)||h&&f.game.scenario&&f.game.scenario.allies&&-1!=f.game.scenario.allies.indexOf(b)||!1,F=c.allied&&-1!=c.allied.indexOf(b)||h&&f.game.scenario&&f.game.scenario.allied&&-1!=f.game.scenario.allied.indexOf(b)||!1,z=c.drawExtra&&-1!=c.drawExtra.indexOf(b)||h&&f.game.scenario&&f.game.scenario.drawExtra&&-1!=f.game.scenario.drawExtra.indexOf(b)||!1,H=f.monsterManager.addMonsterByName(l.name,c.edition);if(H&&(j.f.settings.standees||!H.entities.find(Q=>Q.type==d))){const Q=f.monsterManager.spawnMonsterEntity(H,d,x,F,z);Q&&(l.marker&&(Q.marker=l.marker),l.tags&&(Q.tags=l.tags),l.health&&(Q.health=(0,N.hZ)(l.health)),l.number&&(Q.number=l.number),u.push(Q),(Q.marker||Q.tags.length>0)&&f.addEntityCount(H,Q))}return H&&H.bb&&(u.length&&u.every(Q=>Q.type==Y.N.elite)&&-1==H.tags.indexOf("bb-elite")?H.tags.push("bb-elite"):H.tags=H.tags.filter(Q=>"bb-elite"!=Q)),u}scenarioData(c,l=!1){const d=f.editionData.filter(h=>-1!=j.f.settings.editions.indexOf(h.edition)).map(h=>h.scenarios).flat();return c?!l&&this.game.party.campaignMode&&d.some(h=>h.initial)?d.filter(h=>{if(h.edition!=c)return!1;if(this.isSuccess(h)||this.game.party.manualScenarios.find(x=>h.index==x.index&&h.edition==x.edition&&h.group==x.group))return!0;let u=!1,b=!h.requires||0==h.requires.length;return this.game.party.scenarios.forEach(x=>{const F=d.find(z=>z.index==x.index&&z.edition==x.edition&&z.group==x.group);F&&F.edition==h.edition&&F.group==h.group&&F.unlocks&&-1!=F.unlocks.indexOf(h.index)&&(u=!0)}),this.game.party.conclusions.forEach(x=>{const F=f.sectionData(x.edition).find(z=>z.index==x.index&&z.edition==x.edition&&z.group==x.group);F&&F.edition==h.edition&&F.group==h.group&&F.unlocks&&-1!=F.unlocks.indexOf(h.index)&&(u=!0)}),b||(b=h.requires.some(x=>x.every(F=>{let z=this.game.party.scenarios.filter(H=>H.index==F&&(H.edition==h.edition||-1!=f.editionExtensions(h.edition).indexOf(H.edition)));return z.length>1&&z.filter(H=>H.group==h.group),z.length>1&&z.filter(H=>H.edition==h.edition),z.length>0}))),(u||h.initial)&&b}):d.filter(h=>h.edition==c):d}isCurrent(c){return null!=f.game.scenario&&f.game.scenario.edition==c.edition&&f.game.scenario.index==c.index&&f.game.scenario.group==c.group&&f.game.scenario.solo==c.solo}isSuccess(c){return f.game.party.scenarios&&null!=f.game.party.scenarios.find(l=>l.edition==c.edition&&l.group==c.group&&l.index==c.index)}isBlocked(c){let l=!1,d=f.scenarioData().filter(h=>(c.edition==h.edition||-1!=f.editionExtensions(c.edition).indexOf(h.edition))&&h.group==c.group&&h.blocks&&-1!=h.blocks.indexOf(c.index)&&this.isSuccess(h));return d.length>1&&d.filter(h=>h.group==c.group),d.length>1&&d.filter(h=>h.edition==c.edition),l=d.length>0,l&&this.game.party.campaignMode}isLocked(c){return this.game.party.campaignMode&&c.requirements&&c.requirements.length>0&&c.requirements.every(l=>l.global&&l.global.some(d=>{if(d.startsWith("!"))return this.game.party.globalAchievementsList.find(h=>h.toLowerCase().trim()==d.substring(1,d.length).toLowerCase().trim());if(-1==d.indexOf(":")||isNaN(+d.split(":")[1]))return!this.game.party.globalAchievementsList.find(h=>h.toLowerCase().trim()==d.toLowerCase().trim());{let h=+d.split(":")[1];return this.game.party.globalAchievementsList.forEach(u=>{u.toLowerCase().trim()==d.split(":")[0].toLowerCase().trim()&&h--}),h>0}})||l.party&&l.party.some(d=>{if(d.startsWith("!"))return this.game.party.achievementsList.find(h=>h.toLowerCase().trim()==d.substring(1,d.length).toLowerCase().trim());if(-1==d.indexOf(":")||isNaN(+d.split(":")[1]))return!this.game.party.achievementsList.find(h=>h.toLowerCase().trim()==d.toLowerCase().trim());{let h=+d.split(":")[1];return this.game.party.achievementsList.forEach(u=>{u.toLowerCase().trim()==d.split(":")[0].toLowerCase().trim()&&h--}),h>0}})||l.campaignSticker&&l.campaignSticker.some(d=>{if(d.startsWith("!"))return this.game.party.campaignStickers.find(h=>h.toLowerCase().replaceAll(" ","-").trim()==d.substring(1,d.length).toLowerCase().trim());if(-1==d.indexOf(":")||isNaN(+d.split(":")[1]))return!this.game.party.campaignStickers.find(h=>h.toLowerCase().replaceAll(" ","-").trim()==d.toLowerCase().trim());{let h=+d.split(":")[1];return this.game.party.campaignStickers.forEach(u=>{u.toLowerCase().replaceAll(" ","-").trim()==d.split(":")[0].toLowerCase().trim()&&h--}),h>0}})||l.buildings&&l.buildings.some(d=>{if(d.startsWith("!"))return this.game.party.buildings.find(h=>h.name.toLowerCase().trim()==d.substring(1,d.length).toLowerCase().trim()&&h.level>0);if(-1==d.indexOf(":")||isNaN(+d.split(":")[1]))return!this.game.party.buildings.find(h=>h.name.toLowerCase().trim()==d.toLowerCase().trim()&&h.level>0);{let h=+d.split(":")[1];return!this.game.party.buildings.find(u=>u.name.toLowerCase().trim()==d.substring(1,d.length).toLowerCase().trim()&&u.level>=h)}})||l.characters&&l.characters.some(d=>d.startsWith("!")?f.game.figures.find(h=>h instanceof O.K&&h.name.toLowerCase().trim()==d.substring(1,d.length).toLowerCase().trim()):!f.game.figures.find(h=>h instanceof O.K&&h.name.toLowerCase().trim()==d.toLowerCase().trim()))||l.scenarios&&l.scenarios.every(d=>d.some(h=>null==this.game.party.scenarios.find(u=>u.index==h&&u.edition==c.edition&&u.group==c.group))))||c.solo&&!this.game.figures.find(l=>l instanceof O.K&&l.name==c.solo&&(f.bbRules()||l.level>=5))||!1}getRequirements(c,l=!1){let d=[];return c.requirements&&c.requirements.forEach(h=>{let u=!1,b=new kt.Pl;if(h.global&&h.global.forEach(x=>{if(x.startsWith("!"))x=x.substring(1,x.length),(l||f.game.party.globalAchievementsList.find(F=>F.toLowerCase().trim()==x.toLowerCase().trim()))&&(b.globalAchievementsMissing.push(x),u=!0);else if(-1==x.indexOf(":")||isNaN(+x.split(":")[1]))(l||!f.game.party.globalAchievementsList.find(F=>F.toLowerCase().trim()==x.toLowerCase().trim()))&&(b.globalAchievements.push(x),u=!0);else{let F=+x.split(":")[1];f.game.party.globalAchievementsList.forEach(z=>{z.toLowerCase().trim()==x.split(":")[0].toLowerCase().trim()&&F--}),(l||F>0)&&(b.globalAchievementsCount.push({name:x.split(":")[0],count:F,required:+x.split(":")[1]}),u=!0)}}),h.party&&h.party.forEach(x=>{if(x.startsWith("!"))x=x.substring(1,x.length),(l||f.game.party.achievementsList.find(F=>F.toLowerCase().trim()==x.toLowerCase().trim()))&&(b.partyAchievementsMissing.push(x),u=!0);else if(-1==x.indexOf(":")||isNaN(+x.split(":")[1]))(l||!f.game.party.achievementsList.find(F=>F.toLowerCase().trim()==x.toLowerCase().trim()))&&(b.partyAchievements.push(x),u=!0);else{let F=+x.split(":")[1];f.game.party.achievementsList.forEach(z=>{z.toLowerCase().trim()==x.split(":")[0].toLowerCase().trim()&&F--}),F>0&&(b.partyAchievementsCount.push({name:x.split(":")[0],count:F,required:+x.split(":")[1]}),u=!0)}}),h.campaignSticker&&h.campaignSticker.forEach(x=>{if(x.startsWith("!"))x=x.substring(1,x.length),(l||f.game.party.campaignStickers.find(F=>F.toLowerCase().trim()==x.toLowerCase().trim()))&&(b.campaignStickersMissing.push(x),u=!0);else if(-1==x.indexOf(":")||isNaN(+x.split(":")[1]))(l||!f.game.party.campaignStickers.find(F=>F.toLowerCase().trim()==x.toLowerCase().trim()))&&(b.campaignStickers.push(x),u=!0);else{let F=+x.split(":")[1];f.game.party.campaignStickers.forEach(z=>{z.toLowerCase().trim()==x.split(":")[0].toLowerCase().trim()&&F--}),F>0&&(b.campaignStickersCount.push({name:x.split(":")[0],count:F,required:+x.split(":")[1]}),u=!0)}}),h.buildings&&h.buildings.forEach(x=>{if(x.startsWith("!"))if(-1!=(x=x.substring(1,x.length)).indexOf(":")){let F=+x.split(":")[1];(l||f.game.party.buildings.find(z=>z.name.toLowerCase().trim()==x.split(":")[0].toLowerCase().trim()&&z.level>=F))&&(b.buildingsLevel.push({name:x.split(":")[0],level:F}),u=!0)}else(l||f.game.party.buildings.find(F=>F.name.toLowerCase().trim()==x.toLowerCase().trim()&&F.level>0))&&(b.buildingsMissing.push(x),u=!0);else if(-1!=x.indexOf(":")){let F=+x.split(":")[1];(l||!f.game.party.buildings.find(z=>z.name.toLowerCase().trim()==x.split(":")[0].toLowerCase().trim()&&z.level>=F))&&(b.buildingsLevel.push({name:x.split(":")[0],level:F}),u=!0)}else(l||!f.game.party.buildings.find(F=>F.name.toLowerCase().trim()==x.toLowerCase().trim()&&F.level>0))&&(b.buildings.push(x),u=!0)}),h.characters&&h.characters.forEach(x=>{x.startsWith("!")?(x=x.substring(1,x.length),(l||f.game.figures.find(F=>F instanceof O.K&&F.name.toLowerCase().trim()==x.toLowerCase().trim()))&&(b.charactersMissing.push(x),u=!0)):(l||!f.game.figures.find(F=>F instanceof O.K&&F.name.toLowerCase().trim()==x.toLowerCase().trim()))&&(b.characters.push(x),u=!0)}),h.scenarios&&h.scenarios.length){let x=[];h.scenarios.forEach((F,z)=>{F.forEach(H=>{(null==this.game.party.scenarios.find(Q=>Q.index==H&&Q.edition==c.edition&&Q.group==c.group)||l)&&(x[z]=x[z]||[],x[z].push(H))})}),(l||x.length==c.requires.length&&x.every(F=>F.length))&&(b.scenarios=x,u=!0)}u&&d.push(b)}),d}getSections(c){return f.sectionData().filter(l=>l.edition==c.edition&&l.parent==c.index&&l.group==c.group)}availableSections(c=!1,l=!1){if(!this.game.scenario)return[];const d=this.getSections(this.game.scenario).filter(u=>(!u.conclusion||c)&&(l||!this.game.sections.find(b=>b.edition==u.edition&&b.index==u.index&&b.parent==u.parent))&&(!u.parentSections||u.parentSections.some(b=>b.every(x=>this.game.sections.find(F=>F.index==x))))&&!this.game.sections.find(b=>b.edition==u.edition&&u.blockedSections&&-1!=u.blockedSections.indexOf(b.index))).sort(this.sortScenarios);return[...this.game.scenario.additionalSections.map(u=>this.game.scenario&&f.sectionData(this.game.scenario.edition,!0).find(b=>"randomMonsterCard"==b.group&&b.index==u)).filter(u=>u&&!this.game.sections.find(b=>b.edition==u.edition&&b.index==u.index)).map(u=>u),...d]}getTreasures(c,l,d=!1,h=!1){let u=[];return c.rooms&&(h?c.rooms.forEach(b=>{b.treasures&&u.push(...b.treasures)}):c.revealedRooms&&c.revealedRooms.forEach(b=>{const x=c.rooms.find(F=>F.roomNumber==b);x&&x.treasures&&u.push(...x.treasures)})),l.forEach(b=>{b.rooms&&(h?b.rooms.forEach(x=>{x.treasures&&u.push(...x.treasures)}):b.revealedRooms&&b.revealedRooms.forEach(x=>{const F=b.rooms.find(z=>z.roomNumber==x);F&&F.treasures&&u.push(...F.treasures)}))}),u=u.filter((b,x)=>!d||!f.game.figures.some(F=>F instanceof O.K&&f.lootManager.hasTreasure(F,b,x))),d&&(u=u.filter(b=>!f.game.party.treasures.find(x=>x.name==""+b&&x.edition==c.edition))),u}getAllTreasures(c){let l=[];return c.rooms&&c.rooms.forEach(d=>{d.treasures&&l.push(...d.treasures)}),this.getSections(c).forEach(d=>{d.rooms&&d.rooms.forEach(h=>{h.treasures&&l.push(...h.treasures)})}),l}treasureRewardsFromString(c){return c.split(":").length<2?[]:c.split(":").slice(1).join(":").split("|").map(l=>l.split("+"))}getMonsters(c,l=!1,d=!1){let h=[];return d?h.push(...f.game.figures.filter(u=>u instanceof E.R).map(u=>new $.f(u))):(h.push(...this.getScenarioMonster(c,l)),h.push(...this.getRuleMonster(c,l))),h.push(...f.monsterManager.getSpawnMonsters(h)),h}getScenarioMonster(c,l=!1){let d=[];d.push(c),d.push(...f.sectionData(c.edition).filter(u=>u.group==c.group&&u.parent==c.index&&(l||null!=this.game.sections.find(b=>b.edition==u.edition&&b.group==u.group&&b.index==u.index)))),c.additionalSections&&d.push(...f.sectionData(c.edition,!0).filter(u=>-1!=c.additionalSections.indexOf(u.index)&&(l||null!=this.game.sections.find(b=>b.edition==u.edition&&b.group==u.group&&b.index==u.index))));let h=[];return d.forEach(u=>{u.monsters&&u.monsters.forEach(b=>{const x=f.monstersData().find(F=>F.name==b.split(":")[0]&&(F.edition==u.edition||-1!=f.editionExtensions(u.edition).indexOf(F.edition)));x&&-1==h.indexOf(x)&&h.push(x)})}),h}getRuleMonster(c,l=!1){let d=[];d.push(c),l&&(d.push(...f.sectionData(c.edition).filter(u=>u.group==c.group&&u.parent==c.index)),c.additionalSections&&d.push(...f.sectionData(c.edition,!0).filter(u=>-1!=c.additionalSections.indexOf(u.index))));let h=[];return d.forEach(u=>{u.rules&&u.rules.forEach(b=>{b.spawns&&b.spawns.forEach(x=>{const F=f.monstersData().find(z=>z.name==x.monster.name.split(":")[0]&&(z.edition==u.edition||-1!=f.editionExtensions(u.edition).indexOf(z.edition)));F&&-1==h.indexOf(F)&&h.push(F)})})}),h}sortScenarios(c,l){if(c.conclusion!=l.conclusion)return c.conclusion?1:-1;if(!isNaN(+c.index)&&!isNaN(+l.index))return+c.index-+l.index;const d=c.index.match(/(\d+)/),h=l.index.match(/(\d+)/);return d&&h?+d[0]-+h[0]:c.index.toLowerCase()<l.index.toLowerCase()?-1:1}openRooms(c=!1){return this.game.scenario&&this.game.scenario.rooms?this.game.scenario.rooms.filter(l=>this.game.scenario&&-1!=this.game.scenario.revealedRooms.indexOf(l.roomNumber)&&(c||!l.initial)):[]}closedRooms(){return this.game.scenario&&this.game.scenario.rooms?this.game.scenario.rooms.filter(c=>this.game.scenario&&-1==this.game.scenario.revealedRooms.indexOf(c.roomNumber)&&this.openRooms(!0).some(l=>l.rooms&&-1!=l.rooms.indexOf(c.roomNumber))):[]}drawRandomScenario(c){let d,l=f.scenarioData(c).filter(h=>h.random&&!f.game.party.manualScenarios.find(u=>u.index==h.index&&u.edition==h.edition&&u.group==h.group&&!u.custom)&&!this.isSuccess(h));return l.length>0&&(d=l[Math.floor(Math.random()*l.length)]),d}drawRandomScenarioSection(c){let d,l=f.sectionData(c).filter(h=>h.conclusion&&h.random&&!f.game.party.conclusions.find(u=>u.index==h.index&&u.edition==h.edition&&u.group==h.group&&!u.custom)&&!f.game.party.scenarios.find(u=>u.index==h.index&&u.edition==h.edition&&u.group==h.group&&!u.custom));return l.length>0&&(d=l[Math.floor(Math.random()*l.length)]),d}scenarioUndoArgs(c=void 0){return(c=c||f.game.scenario)?[c.index,this.scenarioTitle(c),c.custom?"scenario.custom":"data.edition."+c.edition]:["","",""]}scenarioTitle(c,l=!1){return c?"data."+(l?"section.title.":"scenario.title.")+c.edition+"."+(c.group?c.group+"-":"")+c.index.replaceAll(".","-"):l?"section":"scenario"}scenarioDataForModel(c){if(c.isCustom){const d=new V.tB;return d.name=c.custom,d}const l=f.scenarioData().find(d=>d.index==c.index&&d.edition==c.edition&&d.group==c.group);if(l)return JSON.parse(JSON.stringify(l));console.warn("Invalid scenario data:",c)}sectionDataForModel(c){const l=f.sectionData().find(d=>d.index==c.index&&d.edition==c.edition&&d.group==c.group);if(l)return JSON.parse(JSON.stringify(l));console.warn("Invalid section data:",c)}toModel(c,l,d,h=!1,u=""){return new kt.Ag(c.index,c.edition,c.group,h,u,JSON.parse(JSON.stringify(l)),JSON.parse(JSON.stringify(d)))}}var Dn=M(740);class cn{game;constructor(c){this.game=c}applyDamage(c,l,d){const h=this.game.figures.find(u=>u.active);if(l instanceof O.K)c instanceof O.K?(h&&h instanceof E.R?c.scenarioStats.monsterDamage+=d:c.scenarioStats.otherDamage+=d,c.exhausted&&(c.scenarioStats.exhausts+=1),c.scenarioStats.maxDamage=Math.max(c.scenarioStats.maxDamage,d)):c instanceof X.up&&(h&&h instanceof E.R?l.scenarioStats.summons.monsterDamage+=d:l.scenarioStats.summons.otherDamage+=d,c.dead&&(l.scenarioStats.summons.exhausts+=1),l.scenarioStats.summons.maxDamage=Math.max(l.scenarioStats.summons.maxDamage,d));else if(h instanceof O.K)if(h.summons.find(u=>u.active)){if(h.scenarioStats.summons.dealtDamage+=d,h.scenarioStats.summons.maxDealtDamage=Math.max(h.scenarioStats.summons.maxDealtDamage,d),c instanceof R.I&&c.dead)switch(c.type){case Y.N.normal:h.scenarioStats.summons.normalKills+=1;break;case Y.N.elite:h.scenarioStats.summons.eliteKills+=1;break;case Y.N.boss:h.scenarioStats.summons.bossKills+=1}}else if(h.scenarioStats.dealtDamage+=d,h.scenarioStats.maxDealtDamage=Math.max(h.scenarioStats.maxDealtDamage,d),c instanceof R.I&&c.dead)switch(c.type){case Y.N.normal:h.scenarioStats.normalKills+=1;break;case Y.N.elite:h.scenarioStats.eliteKills+=1;break;case Y.N.boss:h.scenarioStats.bossKills+=1}}applyHeal(c,l,d){const h=this.game.figures.find(u=>u.active);l instanceof O.K&&h instanceof O.K&&(c instanceof O.K?c.scenarioStats.healedDamage+=d:c instanceof X.up&&(l.scenarioStats.summons.healedDamage+=d),h.summons.find(u=>u.active)?h.scenarioStats.summons.heals+=d:h.scenarioStats.heals+=d)}killMonsterEntity(c){const l=this.game.figures.find(d=>d.active);if(l instanceof O.K)if(l.summons.find(d=>d.active)){if(c instanceof R.I&&c.dead)switch(c.type){case Y.N.normal:l.scenarioStats.summons.normalKills+=1;break;case Y.N.elite:l.scenarioStats.summons.eliteKills+=1;break;case Y.N.boss:l.scenarioStats.summons.bossKills+=1}}else if(c instanceof R.I&&c.dead)switch(c.type){case Y.N.normal:l.scenarioStats.normalKills+=1;break;case Y.N.elite:l.scenarioStats.eliteKills+=1;break;case Y.N.boss:l.scenarioStats.bossKills+=1}}applyScenarioStats(c,l,d){c.scenarioStats.scenario=new kt.Ag(l.index,l.edition,l.group),c.scenarioStats.success=d,c.scenarioStats.level=c.level,c.scenarioStats.difficulty=this.game.level,c.scenarioStats.gold=c.loot,c.scenarioStats.xp=c.experience,c.scenarioStats.treasures=c.treasures.length,c.lootCards&&c.lootCards.forEach(h=>{const u=this.game.lootDeck.cards[h];if(u){let b=u.type;(b==dt.r6.special1||b==dt.r6.special2)&&(b=dt.r6.money),c.scenarioStats.loot[b]=f.lootManager.getValue(u)}})}}var fe=M(89204);class Ce{parameters;constructor(...c){this.parameters=c}checkParameters(){for(let c=0;c<this.requiredParameters;c++)if(null==this.parameters[c])throw new dn(c);if(!this.validParameters(...this.parameters))throw new hn(this.parameters)}execute(){this.checkParameters(),this.executeWithParameters(...this.parameters)}executionError(c){throw new gn(this.id,this.parameters,c)}before(){return["command."+this.id,...this.parameters]}toString(){return JSON.stringify([this.id,...this.parameters])}fromString(c){const l=JSON.parse(c);this.id=l[0],this.parameters=l.slice(1)}}class ln extends Error{id;constructor(c,l,d){super(l,d),this.id=c}}class gn extends Error{id;parameters;constructor(c,l,d,h){super(d,h),this.id=c,this.parameters=l}}class dn extends Error{parameter;constructor(c,l,d){super(l,d),this.parameter=c}}class hn extends Error{parameters;constructor(c,l,d){super(l,d),this.parameters=c}}class Xe extends Ce{id="attackModifierDeck.draw";requiredParameters=1;validParameters(c,l){return!("m"!=c&&"a"!=c&&null==f.game.figures.find(d=>d instanceof O.K&&d.number==c)||l&&"advantage"!=l&&"disadvantage"!=l)}executeWithParameters(c,l){let d;switch(f.game.state!=A.mk.next&&this.executionError("invalid game state"),c){case"m":d=f.game.monsterAttackModifierDeck;break;case"a":d=f.game.allyAttackModifierDeck;break;default:const h=f.game.figures.find(u=>u instanceof O.K&&u.number==c);h&&(d=h.attackModifierDeck)}d?f.attackModifierManager.drawModifier(d,"advantage"==l||"disadvantage"==l?l:void 0):this.executionError("deck not found")}}class In extends Ce{id="character.add";requiredParameters=3;validParameters(c,l,d){return c&&l&&d&&d<10&&null!=f.charactersData(c).find(h=>h.name==l)||!1}executeWithParameters(c,l,d){const h=f.charactersData(c).find(u=>u.name==l);h?f.characterManager.addCharacter(h,d):this.executionError("character not found")}}class Li extends Ce{id="character.initiative";requiredParameters=2;validParameters(c,l,d){return l>=0&&l<=99&&(!d||99==l)&&null!=f.game.figures.find(h=>h instanceof O.K&&h.number==c)||!1}executeWithParameters(c,l,d){d&&99!=l&&this.executionError("invalid long rest");const h=f.game.figures.find(u=>u instanceof O.K&&u.number==c);h?(h.initiative=l,h.longRest=d):this.executionError("character not found")}before(){const c=f.game.figures.find(l=>l instanceof O.K&&l.number==this.parameters[0]);return c?["command."+this.id,f.characterManager.characterName(c,!0,!0,!1)]:["command.invalid."+this.id,...this.parameters]}}class Ui extends Ce{id="figure.next";requiredParameters=0;validParameters(){return!0}executeWithParameters(c){f.game.state!=A.mk.next&&this.executionError("invalid game state");const l=f.game.figures.filter(h=>f.gameplayFigure(h));let d=l.find(h=>h.active);if(d){if(d&&c&&l.indexOf(d)>0)if(d instanceof O.K){const h=d.summons.filter(b=>f.entityManager.isAlive(b)&&b.state!=X.N5.new);let u=h.find(b=>b.active);(!u||u&&0==h.indexOf(u))&&(d.summons.forEach(b=>b.active=!1),d=l[l.indexOf(d)-1])}else d=l[l.indexOf(d)-1]}else d=c?l[l.length-1]:l.find(h=>!h.off);if(d)if(d instanceof O.K){const h=d.summons.find(b=>b.active),u=d.summons.filter(b=>-1!=b.tags.indexOf("cs-skull-spirit"));j.f.settings.activeSummons&&!h&&d.active&&u.length&&!u.find(b=>b.active)&&u.forEach(b=>b.tags.push("cs-skull-spirit-turn")),f.roundManager.toggleFigure(d)}else if(d instanceof E.R){let h=!0;const u=d.entities.filter(b=>f.entityManager.isAlive(b)&&b.summon!=X.N5.new);if(j.f.settings.activeStandees){let b=u.find(x=>x.active);!b&&u.length>0&&c&&d.active?(b=u[u.length-1],f.monsterManager.toggleActive(d,b),b.active=!0,h=!1):b&&!c&&(f.monsterManager.toggleActive(d,b),u.indexOf(b)<u.length-1&&(u[u.indexOf(b)+1].active=!0),h=!1)}h&&(c&&!d.active&&j.f.settings.activeStandees&&d.entities.forEach(b=>{f.entityManager.isAlive(b)&&(b.active=!0,b.off=!1)}),f.roundManager.toggleFigure(d))}else d instanceof I.$e&&f.roundManager.toggleFigure(d)}}class qi extends Ce{id="lootDeck.draw";requiredParameters=0;validParameters(){return!0}executeWithParameters(){f.game.state!=A.mk.next&&this.executionError("invalid game state");const c=f.game.figures.find(l=>l instanceof O.K&&l.active);f.lootManager.drawCard(f.game.lootDeck,c)}}class Hi extends Ce{id="round.state";requiredParameters=0;validParameters(){return!0}executeWithParameters(){f.roundManager.nextGameState()}before(){return["command."+this.id+(f.game.state==A.mk.next?".next":".draw")]}}const si=new class Ki{commandsMap={"attackModifierDeck.draw":Xe,"character.add":In,"character.initiative":Li,"figure.next":Ui,"lootDeck.draw":qi,"round.state":Hi};history=[];execute(c,...l){try{if(!this.commandsMap[c])throw new ln(c);const d=new this.commandsMap[c](...l);f.stateManager.before(...d.before());try{d.execute(),this.history.push(d),f.stateManager.after()}catch(h){if(f.stateManager.revertLastUndo(),h instanceof gn)console.error(h,h.id,h.parameters,h.message);else if(h instanceof dn)console.error("Missing Parameter",c,h.parameter);else{if(!(h instanceof hn))throw h;console.error("Invalid Parameters",c,h.parameters)}}}catch(d){if(!(d instanceof ln))throw d;console.error("Unkown Command",c,d.message)}}};window.commandManager=si;var An=M(73391),ri=M(30706),Bt=M(26484);class Wi{game;permissions;ws;undos=[];redos=[];undoInfos=[];lastSaveTimestamp;hasUpdate=!1;installPrompt=null;lastAction="update";updateBlocked=!1;serverError="";errorLog=[];backupError;permissionBackup;connectionTries=0;gameOffsetWarning=!0;standeeDialogCanceled=!1;keyboardSelecting=!1;keyboardSelect=-1;undoPermission=!1;redoPermission=!1;characterPermissions={};monsterPermissions={};wakeLock=null;scenarioSummary=!1;serverVersion="";storageBlocked=!1;autoBackupTimeout=null;constructor(c){this.game=c,this.lastSaveTimestamp=(new Date).getTime()}init(){var c=this;return(0,fe.A)(function*(l=!1){try{const h=yield Bt.n.readGameModel();h.server=!1,c.game.fromModel(h)}catch{l||Bt.n.writeGameModel(c.game.toModel())}c.updateBlocked=!1,j.f.settings.serverUrl&&j.f.settings.serverPort&&j.f.settings.serverCode&&(j.f.settings.serverAutoconnect?c.connect():(f.stateManager.updateBlocked=!0,f.stateManager.permissions=new An.x,c.updatePermissions())),yield c.loadStorage();const d=c.undos.length+c.redos.length-c.undoInfos.length;for(let h=0;h<d;h++)c.undoInfos.unshift([]);f.uiChange.subscribe({next:()=>{(!j.f.settings.serverUrl||!j.f.settings.serverPort||!j.f.settings.serverCode)&&(c.permissions=void 0,c.updateBlocked=!1),c.updatePermissions()}}),f.uiChange.emit()}).apply(this,arguments)}install(){var c=this;return(0,fe.A)(function*(){c.installPrompt&&(c.installPrompt.prompt(),yield f.stateManager.installPrompt.userChoice,c.installPrompt=null)})()}loadStorage(){var c=this;return(0,fe.A)(function*(){try{c.undos=yield Bt.n.readAll("undo"),c.redos=yield Bt.n.readAll("redo"),c.undoInfos=yield Bt.n.readAll("undo-infos"),c.updatePermissions()}catch{c.updatePermissions()}})()}saveStorage(){var c=this;return(0,fe.A)(function*(){c.storageBlocked||(c.storageBlocked=!0,yield Bt.n.writeArray("undo",c.undos),yield Bt.n.writeArray("redo",c.redos),yield Bt.n.writeArray("undo-infos",c.undoInfos),c.storageBlocked=!1)})()}buildWsUrl(c,l,d){let h=l.split("/");const u=h[0];let b="";return h.length>1&&(b="/"+h.splice(1,h.length+1).join("/")),b=c+u+":"+d+b,b}connect(){if(j.f.settings.serverUrl&&j.f.settings.serverPort&&j.f.settings.serverCode){this.disconnect(),this.connectionTries++;const l=this.buildWsUrl(j.f.settings.serverWss?"wss://":"ws://",j.f.settings.serverUrl,j.f.settings.serverPort);j.f.settings.logServerMessages&&console.debug("WS preparing "+l),this.ws=new WebSocket(l),this.ws.onmessage=this.onMessage,this.ws.onopen=this.onOpen,this.ws.onclose=this.onClose,this.ws.onerror=this.onError}}disconnect(){this.permissions=void 0,this.updatePermissions(),this.ws&&this.ws.readyState!=WebSocket.CLOSED&&(j.f.settings.logServerMessages&&console.debug("WS closing"),this.ws.close())}onMessage(c){try{const l=JSON.parse(c.data);switch(f.stateManager.updateBlocked=!1,l.serverVersion&&(f.stateManager.serverVersion=l.serverVersion),j.f.settings.logServerMessages&&console.debug("WS received "+l.type,c),l.type){case"game":window.document.body.classList.add("working"),window.document.body.classList.add("server-sync");let d=l.payload;f.game.revision>d.revision&&(f.stateManager.before(),Bt.n.addBackup(f.game.toModel()),console.warn("An older revision was loaded from server, created a backup of previous state."),f.stateManager.saveLocal(),f.stateManager.before("serverSyncEmpty"));const h=l.undoinfo;h&&(h.length>0&&"serverSync"==h[0]?f.stateManager.before("serverSync",...h.slice(1)):f.game.revision-(f.game.revisionOffset||0)<d.revision-(d.revisionOffset||0)&&f.stateManager.before("serverSync",...h)),f.game.fromModel(d,!0),f.stateManager.saveLocal(),f.uiChange.emit(!0),setTimeout(()=>{window.document.body.classList.remove("working"),window.document.body.classList.remove("server-sync")},1),f.stateManager.serverError="";break;case"game-undo":window.document.body.classList.add("working"),window.document.body.classList.add("server-sync");let u=l.payload;if(null!=l.revision){const F=l.revision||0;let z=0,H=f.stateManager.undos.splice(f.stateManager.undos.length-1,1)[0];for(H&&H.revision-(H.revisionOffset||0)>F&&(f.stateManager.redos.push(H),z++);H&&H.revision-(H.revisionOffset||0)>F;)H=f.stateManager.undos.splice(f.stateManager.undos.length-1,1)[0],H&&H.revision-(H.revisionOffset||0)>F&&(f.stateManager.redos.push(H),z++);(!H||H.revision-(H.revisionOffset||0)!=F)&&f.stateManager.undoInfos.splice(f.stateManager.undos.length-f.stateManager.redos.length,0,l.undoinfo?"serverSync"==l.undoinfo[0]?l.undoinfo:["serverSync",...l.undoinfo]:["serverSync"]),f.stateManager.redos.splice(f.stateManager.redos.length-z,0,f.game.toModel())}else{f.stateManager.redos.push(f.game.toModel());const F=f.stateManager.undos[f.stateManager.undos.length-1];F&&F.revision-F.revisionOffset==f.game.revision-f.game.revisionOffset-1?f.stateManager.undos.splice(f.stateManager.undos.length-1,1):f.stateManager.undoInfos.splice(f.stateManager.undoInfos.length-f.stateManager.redos.length,0,l.undoinfo?["serverSync",...l.undoinfo]:["serverSync"])}f.game.fromModel(u),f.stateManager.saveLocal(),f.stateManager.saveStorage(),f.uiChange.emit(!0),setTimeout(()=>{window.document.body.classList.remove("working"),window.document.body.classList.remove("server-sync")},1),f.stateManager.serverError="";break;case"game-redo":window.document.body.classList.add("working"),window.document.body.classList.add("server-sync");let b=l.payload;if(null!=l.revision){const F=l.revision||0;let z=0,H=f.stateManager.redos.splice(f.stateManager.redos.length-1,1)[0];for(H&&H.revision-(H.revisionOffset||0)<F?(f.stateManager.undos.push(H),z++):H&&H.revision-(H.revisionOffset||0)>F&&f.stateManager.redos.push(H);H&&H.revision-(H.revisionOffset||0)<F;)H=f.stateManager.redos.splice(f.stateManager.redos.length-1,1)[0],H&&H.revision-(H.revisionOffset||0)<F&&(f.stateManager.undos.push(H),z++);(!H||H.revision-(H.revisionOffset||0)!=F)&&f.stateManager.undoInfos.splice(f.stateManager.undos.length+z,0,l.undoinfo?"serverSync"==l.undoinfo[0]?l.undoinfo:["serverSync",...l.undoinfo]:["serverSync"]),f.stateManager.undos.splice(f.stateManager.undos.length-z,0,f.game.toModel())}else{f.stateManager.undos.push(f.game.toModel());const F=f.stateManager.redos.length>0?f.stateManager.redos[f.stateManager.redos.length-1]:void 0;F&&F.revision-F.revisionOffset==f.game.revision-f.game.revisionOffset+1?f.stateManager.redos.splice(f.stateManager.redos.length-1,1):f.stateManager.undoInfos.splice(f.stateManager.undoInfos.length-f.stateManager.redos.length,0,l.undoinfo&&["serverSync",...l.undoinfo]||["serverSync"])}f.game.fromModel(b),f.stateManager.saveLocal(),f.stateManager.saveStorage(),f.uiChange.emit(!0),setTimeout(()=>{window.document.body.classList.remove("working"),window.document.body.classList.remove("server-sync")},1),f.stateManager.serverError="";break;case"game-update":window.document.body.classList.add("working"),window.document.body.classList.add("server-sync");let x=l.payload;f.game.revision==x.revision&&(f.game.playSeconds=x.playSeconds,f.game.server=x.server,f.stateManager.saveLocal(),f.uiChange.emit(!0),setTimeout(()=>{window.document.body.classList.remove("working"),window.document.body.classList.remove("server-sync")},1),f.stateManager.serverError="");break;case"requestUpdate":f.stateManager.after(1,!1,0,"game-update"),f.stateManager.serverError="";break;case"settings":if(window.document.body.classList.add("server-sync"),j.f.settings.serverSettings)if(l.payload){let F=l.payload;ri.f.forEach(z=>{F[z]=j.f.settings[z]}),F.serverCode=j.f.settings.serverCode||j.f.settings.serverPassword,F.serverPassword=void 0,j.f.setSettings(Object.assign(new ri.w,F)),Bt.n.write("settings","default",j.f.settings)}else f.stateManager.saveSettings();setTimeout(()=>{window.document.body.classList.remove("server-sync")},1),f.stateManager.serverError="";break;case"permissions":f.stateManager.permissions=l.payload||void 0,f.stateManager.permissionBackup=f.stateManager.permissions&&JSON.parse(JSON.stringify(f.stateManager.permissions))||void 0,f.stateManager.updatePermissions(),f.stateManager.serverError="";break;case"ping":console.debug("Received ping answer...");break;case"remoteCommand":l.payload&&(f.game.server||l.payload.force)&&(console.debug("remoteCommand:",l.payload),si.execute(l.payload.id,...l.payload.parameters||[]));break;case"error":if("No enum constant de.champonthis.ghs.server.socket.model.MessageType.PING"==l.message){console.debug("Received ping answer...");break}console.warn("[GHS] Error: ",l),(l.message.startsWith("Permission(s) missing")||l.message.startsWith("invalid revision"))&&("redo"==f.stateManager.lastAction||"update"==f.stateManager.lastAction?f.stateManager.undo(!1):"undo"==f.stateManager.lastAction&&f.stateManager.redo(!1)),l.message&&(l.message.startsWith("Invalid password")||l.message.startsWith("Invalid game code"))&&(console.warn("Disconnect..."),c.target?.close()),f.stateManager.serverError="string"==typeof l?l:JSON.stringify(l),window.document.body.classList.remove("working"),window.document.body.classList.remove("server-sync");break;default:f.uiChange.emit()}}catch(l){f.stateManager.errorLog.push(c.data),f.stateManager.serverError=c.data,console.error("[GHS] "+c.data,l),window.document.body.classList.remove("working"),window.document.body.classList.remove("server-sync")}}onOpen(c){j.f.settings.logServerMessages&&console.debug("WS opened",c);const l=c.target;if(l&&l.readyState==WebSocket.OPEN&&j.f.settings.serverCode){f.stateManager.connectionTries=0,f.stateManager.updateBlocked=!1,f.stateManager.permissions=f.stateManager.permissionBackup;let d={code:j.f.settings.serverCode,password:j.f.settings.serverCode,type:"request-game",payload:f.game.toModel()};if(j.f.settings.logServerMessages&&console.debug("WS sending request-game"),l.send(JSON.stringify(d)),j.f.settings.serverSettings){let h={code:j.f.settings.serverCode,password:j.f.settings.serverCode,type:"request-settings","allow-empty":!0};j.f.settings.logServerMessages&&console.debug("WS sending request-settings"),l.send(JSON.stringify(h))}f.stateManager.updatePermissions(),f.uiChange.emit()}}onClose(c){j.f.settings.logServerMessages&&console.debug("WS closed",c),f.game.server=!1,f.stateManager.updateBlocked=!0,f.stateManager.serverVersion="",f.stateManager.permissions=new An.x,f.stateManager.updatePermissions(),f.uiChange.emit()}onError(c){j.f.settings.logServerMessages&&console.debug("WS error",c),f.game.server=!1,f.stateManager.updateBlocked=!0,f.stateManager.serverVersion="",f.stateManager.permissions=new An.x,f.stateManager.updatePermissions(),f.uiChange.emit()}forceUpdateState(){f.stateManager.updateBlocked=!1,f.stateManager.permissions=f.stateManager.permissionBackup,f.stateManager.updatePermissions(),f.uiChange.emit()}requestSettings(){if(this.ws&&this.ws.readyState==WebSocket.OPEN&&j.f.settings.serverCode&&j.f.settings.serverSettings){let c={code:j.f.settings.serverCode,password:j.f.settings.serverCode,type:"request-settings","allow-empty":!0};j.f.settings.logServerMessages&&console.debug("WS sending request-settings"),this.ws.send(JSON.stringify(c))}}sendPing(){if(j.f.settings.serverUrl&&j.f.settings.serverPort&&j.f.settings.serverCode)if(this.ws&&this.ws.readyState==WebSocket.OPEN){let c={code:j.f.settings.serverCode,type:"ping"};j.f.settings.logServerMessages&&console.debug("WS sending ping"),this.ws.send(JSON.stringify(c))}else this.connect()}wsState(){return j.f.settings.serverUrl&&j.f.settings.serverPort&&j.f.settings.serverCode?this.ws&&this.ws.readyState||-1:-99}reset(){Bt.n.addBackup(f.game.toModel());const c=this.game.revision;this.game=new A.Zt,this.game.revision=c,Bt.n.clear("game"),Bt.n.clear("undo"),Bt.n.clear("redo"),Bt.n.clear("undo-infos")}saveLocal(){Bt.n.writeGameModel(this.game.toModel()),this.lastSaveTimestamp=(new Date).getTime()}saveSettings(){if(this.ws&&this.ws.readyState==WebSocket.OPEN&&j.f.settings.serverCode&&j.f.settings.serverSettings){let c={code:j.f.settings.serverCode,password:j.f.settings.serverCode,type:"settings",payload:j.f.settings};j.f.settings.logServerMessages&&console.debug("WS sending settings"),this.ws.send(JSON.stringify(c))}}updatePermissions(){this.undoPermission=this.hasUndo()&&(!this.permissions||!this.updateBlocked),this.redoPermission=this.hasRedo()&&(!this.permissions||!this.updateBlocked),this.characterPermissions={},f.game.figures.forEach(c=>{c instanceof O.K&&(this.characterPermissions[c.name+"|"+c.edition]=!this.permissions||this.permissions&&(this.permissions.characters||this.permissions.character.some(l=>l.name==c.name&&l.edition==c.edition)))}),f.game.party.retirements&&f.game.party.retirements.forEach(c=>{this.characterPermissions[c.name+"|"+c.edition]=!this.permissions||this.permissions&&(this.permissions.characters||this.permissions.character.some(l=>l.name==c.name&&l.edition==c.edition))}),this.monsterPermissions={},f.game.figures.forEach(c=>{c instanceof E.R&&(this.monsterPermissions[c.name+"|"+c.edition]=!this.permissions||this.permissions&&(this.permissions.monsters||this.permissions.monster.some(l=>l.name==c.name&&l.edition==c.edition)))})}before(...c){window.document.body.classList.add("working"),this.addToUndo(c&&c.map(l=>""+l)||[])}after(){var c=this;return(0,fe.A)(function*(l=1,d=!1,h=1,u="game",b=0,x=1){if(c.game.revision+=h,c.saveLocal(),c.ws&&c.ws.readyState==WebSocket.OPEN&&j.f.settings.serverCode){window.document.body.classList.add("server-sync");let F=c.undoInfos[c.undos.length-1];"game-undo"==u&&(F=c.undoInfos[c.undos.length+x-1]);let z={code:j.f.settings.serverCode,password:j.f.settings.serverCode,type:u,payload:c.game.toModel(),undoinfo:F,revision:b,undolength:x};j.f.settings.logServerMessages&&console.debug("WS sending "+u),c.ws.send(JSON.stringify(z))}(d||j.f.settings.autoBackup>0&&(c.game.revision+c.game.revisionOffset)%j.f.settings.autoBackup==0)&&(yield c.autoBackup()),l&&j.f.settings.animations?setTimeout(()=>{c.lastAction="update",f.uiChange.emit(),window.document.body.classList.remove("working"),window.document.body.classList.remove("server-sync")},l*j.f.settings.animationSpeed):(c.lastAction="update",f.uiChange.emit(),window.document.body.classList.remove("working"),window.document.body.classList.remove("server-sync"))}).apply(this,arguments)}autoBackup(){var c=this;return(0,fe.A)(function*(l="",d=!1){if(!c.autoBackupTimeout)if(c.storageBlocked)c.autoBackupTimeout=setTimeout(()=>{c.autoBackupTimeout=null,c.autoBackup()},100);else{window.document.body.classList.add("working"),window.document.body.classList.add("server-sync");try{let h=yield Bt.n.datadump();if(l||(l="ghs-autobackup-"+(new Date).toISOString()+".json"),!d&&j.f.settings.autoBackupUrl&&j.f.settings.autoBackupUrl.url)try{c.backupError=void 0;let u=new XMLHttpRequest,b=j.f.settings.autoBackupUrl.url;b=b.replaceAll("{FILENAME}",l);const x=l.replace(/[\\/:*?"<>|]/g,"_");b=b.replaceAll("{WINDOWS_FILENAME}",x),u.open(j.f.settings.autoBackupUrl.method,b,!0,j.f.settings.autoBackupUrl.username,j.f.settings.autoBackupUrl.password);let F=JSON.stringify(h);j.f.settings.autoBackupUrl.fileUpload?(F=new FormData,F.append(l,new File([JSON.stringify(h)],l,{type:"application/json"}))):u.setRequestHeader("Content-Type","application/json"),j.f.settings.autoBackupUrl.authorization&&u.setRequestHeader("Authorization",j.f.settings.autoBackupUrl.authorization),u.send(F),u.addEventListener("error",z=>{c.backupError=-1,console.warn("Could not post autobackup",j.f.settings.autoBackupUrl,z)}),u.addEventListener("readystatechange",z=>{u.readyState===XMLHttpRequest.DONE&&u.status>=400&&(c.backupError=u.status,console.warn("Could not post autobackup",j.f.settings.autoBackupUrl,u.status,u.responseText))})}catch(u){c.backupError=-1,console.warn("Could not post autobackup",j.f.settings.autoBackupUrl,u)}else{let u=document.createElement("a");u.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(h))),u.setAttribute("download",l),document.body.appendChild(u),u.click(),document.body.removeChild(u)}}catch{console.warn("Could not create autobackup")}window.document.body.classList.remove("working"),window.document.body.classList.remove("server-sync")}}).apply(this,arguments)}addToUndo(c){if(this.game.toModel()!=this.undos[this.undos.length-1]){this.undos.push(this.game.toModel());const l=Bt.n.db?j.f.settings.maxUndo:Math.min(j.f.settings.maxUndo,50);this.undos.length>l&&this.undos.splice(0,this.undos.length-l),this.undoInfos.splice(this.undoInfos.length-this.redos.length,this.redos.length),this.undoInfos.push(c),this.undoInfos.length>this.undos.length&&this.undoInfos.splice(0,this.undoInfos.length-this.undos.length),this.redos.length>5&&Bt.n.addBackup(this.redos[0]),this.redos=[],this.saveStorage()}}revertLastUndo(){this.undos.splice(this.undos.length-1,1),this.undoInfos.splice(this.undoInfos.length-1,1),window.document.body.classList.remove("working"),window.document.body.classList.remove("server-sync"),this.saveStorage(),f.uiChange.emit()}hasUndo(){return this.undos.length>0}undo(c=!0){this.fixedUndo(1,c)}fixedUndo(c,l=!0){if(c>0&&c<=this.undos.length){window.document.body.classList.add("working"),this.redos.push(this.game.toModel());const d=f.game.revision,h=f.game.revisionOffset+c-1,u=this.undos.splice(this.undos.length-c,c);for(let x=u.length-1;x>0;x--)this.redos.push(u[x]);this.game.fromModel(u[0]),this.game.revision=d,this.game.revisionOffset=h+2,this.saveStorage(),l?this.after(1,!1,1,"game-undo",u[0].revision-(u[0].revisionOffset||0),c):f.uiChange.emit(),this.lastAction="undo"}}hasRedo(){return this.redos.length>0}redo(c=!0){this.fixedRedo(1,c)}fixedRedo(c,l=!0){if(c>0&&c<=this.redos.length){window.document.body.classList.add("working"),this.undos.push(this.game.toModel());const d=f.game.revision,h=f.game.revisionOffset-c+1,u=this.redos.splice(this.redos.length-c,c);for(let x=u.length-1;x>0;x--)this.undos.push(u[x]);this.game.fromModel(u[0]),this.game.revision=d,this.game.revisionOffset=h,this.saveStorage(),l?this.after(1,!1,1,"game-redo",u[0].revision-(u[0].revisionOffset||0),c):f.uiChange.emit(),this.lastAction="undo"}}clearUndos(){this.undoInfos.splice(0,this.undoInfos.length-this.redos.length),this.undos=[],this.saveStorage()}clearRedos(){this.undoInfos.splice(this.undos.length,this.undoInfos.length),this.redos=[],this.saveStorage()}savePermissions(c,l){if(this.ws&&this.ws.readyState==WebSocket.OPEN&&j.f.settings.serverCode){let d={code:j.f.settings.serverCode,password:j.f.settings.serverCode,type:"permissions",payload:{permissions:l,code:c,password:c}};j.f.settings.logServerMessages&&console.debug("WS sending permissions"),this.ws.send(JSON.stringify(d))}}}class Ji{game;available=!1;trialsAvailable=!1;favorsAvailable=!1;trialsEnabled=!1;favorsEnabled=!1;apply=!1;constructor(c){this.game=c}update(){const c=f.fhRules()&&this.game.party.buildings.find(l=>"hall-of-revelry"==l.name&&l.level&&"wrecked"!=l.state);this.available=!1,this.trialsEnabled=!1,this.favorsEnabled=!1,f.fhRules()&&c&&(this.available=!0,this.trialsAvailable=1==c.level,this.favorsAvailable=2==c.level,j.f.settings.fhTrials&&(this.trialsEnabled=this.trialsAvailable,this.favorsEnabled=this.favorsAvailable,this.apply=j.f.settings.fhTrialsApply))}applyTrialCards(){if(this.trialsEnabled){const c=f.editionData.find(l=>l.edition==f.currentEdition()&&l.trials&&l.trials.length);this.game.party.trials=this.game.party.trials||-1,c&&this.game.figures.forEach(l=>{if(l instanceof O.K&&!l.progress.trial){let d=this.game.party.retirements.find(h=>h.number==l.number&&h.progress&&h.progress.trial);if(d&&d.progress&&d.progress.trial)l.progress.trial=d.progress.trial,d.progress.trial=void 0;else if(this.game.party.trials<c.trials.length-1){this.game.party.trials++;const h=c.trials[this.game.party.trials];l.progress.trial=new v.gw(""+h.cardId,h.edition)}}})}else f.fhRules()&&this.game.party.buildings.find(l=>"hall-of-revelry"==l.name&&1==l.level)||(this.game.party.trials=-1,this.game.figures.forEach(l=>{l instanceof O.K&&l.progress.trial&&(l.progress.trial=void 0)}))}activeTrial(c,l){return this.trialsEnabled&&null!=this.game.figures.find(d=>d instanceof O.K&&d.progress.trial&&d.progress.trial.edition==c&&d.progress.trial.name==""+l)}applyFavorPoints(){this.game.favorPoints.forEach(c=>{const l=this.game.monsterAttackModifierDeck.cards.find(d=>1==c?d.type==K.Yn.minus1:d.type==K.Yn.minus2);l&&this.game.monsterAttackModifierDeck.cards.splice(this.game.monsterAttackModifierDeck.cards.indexOf(l),1)})}activeFavor(c,l){return this.game.favors.filter(d=>d.edition==c&&d.name==l).length}cardIdSecondPrinting(c){return 708-c}}const f=new class Zi{game=new A.Zt;editionData=[];editionMapping={};editionMappingAll={};editionScenarioMapping={};editionScenarioMappingAll={};stateManager;entityManager;characterManager;monsterManager;objectiveManager;attackModifierManager;actionsManager;levelManager;scenarioManager;scenarioRulesManager;roundManager;lootManager;itemManager;battleGoalManager;eventCardManager;buildingsManager;challengesManager;scenarioStatsManager;trialsManager;enhancementsManager;imbuementManager;uiChange=new C.bkB;constructor(){this.stateManager=new Wi(this.game),this.entityManager=new xe(this.game),this.characterManager=new he(this.game),this.monsterManager=new Je.a(this.game),this.objectiveManager=new Ze(this.game),this.attackModifierManager=new Lt.Z(this.game),this.actionsManager=new G,this.levelManager=new Ae(this.game),this.scenarioManager=new $n(this.game),this.scenarioRulesManager=new Dn.H(this.game),this.roundManager=new Ee(this.game),this.itemManager=new Gt(this.game),this.lootManager=new Ve(this.game),this.battleGoalManager=new Jt(this.game),this.eventCardManager=new Ke(this.game),this.buildingsManager=new ee(this.game),this.challengesManager=new Vt(this.game),this.scenarioStatsManager=new cn(this.game),this.trialsManager=new Ji(this.game),this.enhancementsManager=new ye(this.game),this.imbuementManager=new We(this.game),this.uiChange.subscribe({next:()=>{this.checkEntitiesKilled(),this.game.levelCalculation&&this.levelManager.calculateScenarioLevel(),j.f.settings.scenarioRules&&(this.scenarioRulesManager.addScenarioRulesAlways(),this.scenarioRulesManager.applyScenarioRulesAlways()),this.roundManager.firstRound=0==this.game.round&&0==this.game.roundResets.length&&0==this.game.roundResetsHidden.length,this.buildingsManager.update(),this.challengesManager.update(),this.trialsManager.update(),this.enhancementsManager.update(),this.imbuementManager.update()}})}editions(c=!1,l=!1){return this.editionData.filter(d=>(c||-1!=j.f.settings.editions.indexOf(d.edition))&&(l||!d.additional)).map(d=>d.edition)}editionsData(c=!1,l=!1){const d=this.editions(c,l);return this.editionData.filter(h=>-1!=d.indexOf(h.edition))}editionLogo(c){const l=this.editionData.find(d=>d.edition==c);return l&&l.logoUrl?l.logoUrl:""}currentEditions(c=!1){return this.game.edition?[this.game.edition,...this.editionExtensions(this.game.edition)]:this.editions(!1,c)}currentEdition(c=void 0){if(this.game.edition)return this.game.edition;if(this.game.scenario&&this.game.scenario.edition)return this.game.scenario.edition;const l=f.game.figures.filter(d=>d instanceof O.K).map(d=>d.edition);return l.length>0&&l.every((d,h,u)=>0==h||u[h-1]==d)?l[0]:c??this.editions()[0]}editionExtensions(c,l=!1){if(l&&this.editionMappingAll[c])return this.editionMappingAll[c];if(!l&&this.editionMapping[c])return this.editionMapping[c];const d=this.editionData.find(u=>u.edition==c);let h=[];return d&&d.extensions&&d.extensions.forEach(u=>{-1==h.indexOf(u)&&-1!=this.editions(l,!0).indexOf(u)&&h.push(u),this.editionExtensions(u,l).forEach(b=>{-1==h.indexOf(b)&&-1!=this.editions(l,!0).indexOf(u)&&h.push(b)})}),l?this.editionMappingAll[c]=h:this.editionMapping[c]=h,h}editionScenarioExtensions(c,l=!1){if(l&&this.editionScenarioMappingAll[c])return this.editionScenarioMappingAll[c];if(!l&&this.editionScenarioMapping[c])return this.editionScenarioMapping[c];const d=this.editionData.filter(h=>(l||-1!=j.f.settings.editions.indexOf(h.edition))&&h.additional&&h.scenarios&&h.scenarios.length&&h.scenarios.some(u=>u.edition==h.edition)&&-1!=h.extensions.indexOf(c)).map(h=>h.edition);return l?this.editionScenarioMappingAll[c]=d:this.editionScenarioMapping[c]=d,d}resetEditionMapping(){this.editionMapping={},this.editionMappingAll={},this.editionScenarioMapping={},this.editionScenarioMappingAll={}}newAmStyle(c){const l=this.editionData.find(d=>d.edition==c);return!(!l||!(l.newAmStyle||l.extensions&&l.extensions.some(d=>this.newAmStyle(d))))}charactersData(c=void 0){const l=this.editionData.filter(h=>!(c&&-1==j.f.settings.editions.indexOf(h.edition)||c&&h.edition!=c&&-1==this.editionExtensions(h.edition).indexOf(c))).flatMap(h=>h.characters),d=l.filter(h=>h.merge);return l.filter(h=>(!c||h.edition==c)&&!h.merge&&(h.replace||!h.replace&&!l.find(u=>u.replace&&u.name===h.name&&u.edition===h.edition))).map(h=>{const u=d.find(b=>b.name===h.name&&b.edition===h.edition);return u?Object.assign(new m.qS(h),u):new m.qS(h)})}monstersData(c=void 0){return this.editionData.filter(l=>!(c&&-1==j.f.settings.editions.indexOf(l.edition)||c&&l.edition!=c&&-1==this.editionExtensions(l.edition).indexOf(c))).flatMap(l=>l.monsters).filter((l,d,h)=>(!c||l.edition==c)&&(l.replace||!l.replace&&!h.find(u=>u.replace&&u.name==l.name&&u.edition==l.edition)))}decksData(c=void 0){const l=this.editionData.filter(h=>!(c&&-1==j.f.settings.editions.indexOf(h.edition)||c&&h.edition!=c&&-1==this.editionExtensions(h.edition).indexOf(c))).flatMap(h=>h.decks),d=l.filter(h=>h.abilities.some(u=>u.replace));return l.filter(h=>-1==d.indexOf(h)).map(h=>{const u=d.find(x=>x.edition==h.edition&&x.name==h.name);if(!u)return h;let b=new q.m(h.edition,h.name,h.character);return b.abilities=h.abilities.map(x=>Object.assign(new s.T,u.abilities.find(F=>F.cardId==x.cardId&&F.replace)||x)),b})}scenarioData(c=void 0){return this.editionData.filter(l=>!(c&&-1==j.f.settings.editions.indexOf(l.edition)||c&&l.edition!=c&&-1==this.editionExtensions(l.edition).indexOf(c))).flatMap(l=>l.scenarios).filter(l=>!c||l.edition==c)}sectionData(c=void 0,l=!1){return this.editionData.filter(d=>(!c||-1!=j.f.settings.editions.indexOf(d.edition))&&(!c||d.edition==c||d.additional&&-1!=this.editionExtensions(d.edition).indexOf(c)||l&&-1!=this.editionExtensions(c).indexOf(d.edition))).flatMap(d=>d.sections).filter(d=>!c||d.edition==c||l).map(d=>{if(!j.f.settings.fhSecondEdition||"fh"!=d.edition)return d;if("6.2"==d.index){let h=new V.tB(d);return h.index="60.2",h}if("60.2"==d.index){let h=new V.tB(d);return h.index="6.2",h}return d})}itemData(c=void 0,l=!1){return this.editionData.filter(d=>(l||-1!=j.f.settings.editions.indexOf(d.edition))&&(!c||d.edition==c||-1!=this.editionExtensions(d.edition,!0).indexOf(c))).flatMap(d=>d.items).filter((d,h,u)=>d.replace||!d.replace&&!u.find(b=>b.replace&&b.id==d.id&&b.edition==d.edition))}challengesData(c=void 0,l=!1){return this.editionData.filter(d=>(l||-1!=j.f.settings.editions.indexOf(d.edition))&&(!c||d.edition==c||-1!=this.editionExtensions(d.edition,!0).indexOf(c))).flatMap(d=>d.challenges)}conditions(c=void 0,l=!1){let d=[],h=[];return c?(h=this.editionData.filter(u=>(u.edition==c||-1!=this.editionExtensions(c).indexOf(u.edition))&&u.conditions&&u.conditions.length>0).flatMap(u=>u.conditions),!l&&this.game.conditions&&h.push(...this.game.conditions),d.push(...h.map(u=>u.split(":").length>1?new w.kW(u.split(":")[0],+u.split(":")[1]):new w.kW(u)))):d=w.Xo,d=d.filter(u=>-1==u.types.indexOf(w.GV.special)),l||this.game.figures.filter(u=>u instanceof O.K&&u.specialConditions&&u.specialConditions.length&&!u.absent&&f.gameplayFigure(u)).forEach(u=>u.specialConditions.forEach(b=>d.push(new w.kW(b)))),d.filter((u,b,x)=>x.map(F=>F.name).indexOf(u.name)==b)}figureConditions(c,l=void 0){let d=[];if(c instanceof O.K)c.summons&&c.summons.forEach(h=>{h.action&&this.actionConditions(h.action).forEach(u=>{d.find(b=>b==u)||d.push(u)}),h.additionalAction&&this.actionConditions(h.additionalAction).forEach(u=>{d.find(b=>b==u)||d.push(u)})});else if(c instanceof E.R&&l instanceof R.I){const h=f.monsterManager.getStat(c,l.type),u=f.monsterManager.getAbility(c);u&&u.actions.forEach(b=>{this.actionConditions(b,h).forEach(x=>{d.find(F=>F==x)||d.push(x)})})}return d}actionConditions(c,l=void 0){let d=[];return c.type==T.X2.condition?d.push(c.value):l&&c.type==T.X2.attack&&l.actions&&l.actions.forEach(h=>{h.type==T.X2.condition&&d.push(h.value)}),c.subActions&&c.subActions.forEach(h=>{d.push(...this.actionConditions(h,l))}),d}conditionsForTypes(...c){return this.conditions(this.game.edition).filter(l=>c.every(d=>-1!=l.types.indexOf(d)))}allConditionsForTypes(...c){return this.conditions().filter(l=>c.every(d=>-1!=l.types.indexOf(d)))}markers(){return this.game.figures.filter(c=>c instanceof O.K&&!c.absent&&(c.marker||this.game.state==A.mk.next&&c.active)).map(c=>c).sort((c,l)=>c.marker&&!l.marker?-1:!c.marker&&l.marker?1:0).map(c=>c.edition+"-"+c.name)}sortFigures(c=void 0){this.game.figures.sort((l,d)=>j.f.settings.sortFigures?this.game.state==A.mk.draw?this.sortFiguresByTypeAndName(l,d):c&&c!=l&&c!=d?0:j.f.settings.initiativeRequired||l.getInitiative()>0&&d.getInitiative()>0?l.getInitiative()==d.getInitiative()?this.sortFiguresByTypeAndName(l,d):f.challengesManager.apply&&f.challengesManager.isActive(1491,"fh")?d.getInitiative()-l.getInitiative():l.getInitiative()-d.getInitiative():0:0)}sortFiguresByTypeAndName(c,l){if(c.off&&!l.off)return 1;if(!c.off&&l.off)return-1;let d=c.name.toLowerCase();c instanceof O.K?d=f.characterManager.characterName(c).toLowerCase():c instanceof E.R?d=j.f.getLabel("data.monster."+c.name).toLowerCase():c instanceof I.$e&&(d=c.title?c.title:j.f.getLabel(c.name?"data.objective."+c.name:c.escort?"escort":"objective").toLowerCase());let h=l.name.toLowerCase();if(l instanceof O.K?h=f.characterManager.characterName(l).toLowerCase():l instanceof E.R?h=j.f.getLabel("data.monster."+l.name).toLowerCase():l instanceof I.$e&&(h=l.title?l.title:j.f.getLabel(l.name?"data.objective."+l.name:l.escort?"escort":"objective").toLowerCase()),c instanceof O.K&&l instanceof E.R)return-1;if(c instanceof E.R&&l instanceof O.K)return 1;if(c instanceof O.K&&l instanceof I.$e)return-1;if(c instanceof I.$e&&l instanceof O.K)return 1;if(c instanceof E.R&&l instanceof I.$e)return-1;if(c instanceof I.$e&&l instanceof E.R)return 1;if(c instanceof E.R&&l instanceof E.R)return 0;if(c instanceof I.$e&&l instanceof I.$e&&d==h){if(c.marker&&l.marker)return c.marker<l.marker?-1:1;if(c.marker)return 1;if(l.marker)return-1}return c instanceof O.K&&l instanceof O.K&&j.f.settings.characterSortIndex?c.number-l.number:d<h?-1:1}deckData(c,l=!1){let d;return c instanceof E.R&&c.statEffect&&c.statEffect.deck&&(d=this.decksData().find(h=>c instanceof E.R&&c.statEffect&&c.statEffect.deck&&c.statEffect.deck==h.name&&(h.edition==c.edition||h.edition==f.currentEdition()||-1!=this.editionExtensions(h.edition).indexOf(f.currentEdition(c.edition)))),d&&c.abilities.length!=d.abilities.length&&(c.abilities=d.abilities.filter(h=>isNaN(+h.level)||+h.level<=(c&&c.level||0)).map(h=>d?d.abilities.indexOf(h):-1),(0,D.Z)(c.abilities),this.game.state==A.mk.next&&(c.ability=0))),d||(d=this.decksData(c.edition).find(h=>h.name==c.deck||h.name==c.name)),d||(d=this.decksData().find(h=>(h.name==c.deck||h.name==c.name)&&-1!=this.editionExtensions(c.edition).indexOf(h.edition))),d||(d=this.decksData().find(h=>(h.name==c.deck||h.name==c.name)&&h.edition==c.edition)),d||(c.errors=c.errors||[],!l&&!c.errors.find(h=>h.type==t.H.unknown)&&!c.errors.find(h=>h.type==t.H.deck)&&(console.error("Unknwon deck: "+c.name+(c.deck?"["+c.deck+"]":"")+" for "+c.edition),c.errors.push(new t.h(t.H.deck,c instanceof O.K?"character":"monster",c.name,c.edition,c.deck))),new q.m)}abilities(c){return this.deckData(c).abilities||[]}hasBottomAbility(c){return c&&c.bottomActions&&c.bottomActions.length>0||!1}getCharacterData(c,l=""){let d=this.charactersData().find(h=>h.name==c&&(!l||h.edition==l));if(!d){if(d=this.charactersData().find(h=>h.name==c),!d&&!l)for(l=c.split("-")[0],c=c.split("-").slice(1).join("-"),d=this.charactersData().find(h=>h.name==c&&h.edition==l);c&&!d;)l=l+"-"+c.split("-")[0],c=c.split("-").slice(1).join("-"),d=this.charactersData().find(h=>h.name==c&&h.edition==l);return d||(d=new m.qS,d.name=c,d.edition=l,d.errors=d.errors||[],d.errors.find(h=>h.type==t.H.unknown)||(console.error("unknown character '"+c+"' for edition '"+l+"'"),d.errors.push(new t.h(t.H.unknown,"character",c,l)))),d}return d}isCharacter(c){return c instanceof O.K}isMonster(c){return c instanceof E.R}isMonsterEntity(c){return c instanceof R.I}isSummon(c){return c instanceof X.up}isObjectiveContainer(c){return c instanceof I.$e}isObjectiveEntity(c){return c instanceof U.X}toCharacter(c){return c}toMonster(c){return c}toMonsterEntity(c){return c}toSummon(c){return c}toObjectiveContainer(c){return c}toObjectiveEntity(c){return c}getEdition(c,l=""){const d=this.currentEdition(l);return c.edition!=d&&-1==this.editionExtensions(d).indexOf(c.edition)?c.edition:""}gameplayFigure(c){return(c instanceof E.R||c instanceof I.$e)&&this.entityManager.entitiesAll(c,!0).length>0||c instanceof O.K&&f.entityManager.isAlive(c)}figuresByIdentifier(c,l=!1,d=[]){if(0==d.length&&(d=this.game.figures),c&&c.type){const h=c.type;if("all"==h)return l?d.filter(u=>!(u instanceof O.K&&this.characterManager.ignoreNegativeScenarioffects(u))):d;if(c.name){const u=c.edition,b=new RegExp("^"+c.name+"$");switch(h){case"monster":return d.filter(x=>x instanceof E.R&&(!u||x.edition==u)&&x.name.match(b)&&(!c.marker||x.entities.some(F=>F.marker==c.marker))&&(!c.tags||0==c.tags.length||x.entities.some(F=>c.tags&&c.tags.every(z=>F.tags&&-1!=F.tags.indexOf(z)))));case"character":case"characterWithSummon":return d.filter(x=>!(!(x instanceof O.K)||x.absent||u&&x.edition!=u||!x.name.match(b)||!(!c.tags||0==c.tags.length||c.tags&&c.tags.every(F=>x.tags&&-1!=x.tags.indexOf(F)))||l&&this.characterManager.ignoreNegativeScenarioffects(x)));case"objective":return this.game.figures.filter(x=>x instanceof I.$e&&x.name.match(b)&&("escort"!=u||x.escort)&&(!c.marker||x.entities.some(F=>F.marker==c.marker))&&(!c.tags||0==c.tags.length||x.entities.some(F=>c.tags&&c.tags.every(z=>F.tags&&-1!=F.tags.indexOf(z)))))}}}return[]}entitiesByIdentifier(c,l){return this.figuresByIdentifier(c,l).map(h=>h instanceof E.R||h instanceof I.$e?h.entities:h instanceof O.K?c&&"characterWithSummon"==c.type?[h,...h.summons]:h:void 0).flat().filter(h=>null!=h).map(h=>h).filter(h=>!c||(!c.marker||!(h instanceof R.I)||h.marker==c.marker)&&(!c.tags||0==c.tags.length||c.tags.every(u=>-1!=h.tags.indexOf(u))))}getMonsterData(c,l){let d=this.monstersData().find(h=>h.name==c&&h.edition==l);return d||(d=this.monstersData().find(h=>h.name==c),d||(d=new $.f,d.errors=d.errors||[],d.name=c,d.edition=l,d.errors.find(h=>h.type==t.H.unknown)||(console.error("unknown monster '"+c+"' for edition '"+l+"'"),d.errors.push(new t.h(t.H.unknown,"monster",c,l)))),d)}prosperityLevel(){let c=1,l=P.yF;return this.fhRules()?l=P.b9:this.gh2eRules()&&(l=P.fH),l.forEach(d=>{this.prosperityTicks()>d&&c++}),c}prosperityTicks(){let c=this.game.party.prosperity;return this.game.party.envelopeB&&this.editionRules("gh")?(c+=1,this.game.party.donations>10&&(c+=Math.floor(Math.min(this.game.party.donations-10,30)/5)),this.game.party.donations>40&&(c+=Math.floor((this.game.party.donations-40)/10))):this.gh2eRules()&&(c+=Math.floor(Math.min(this.game.party.donations,100)/5),c+=Math.floor(Math.min(this.game.party.imbuement+5,80)/10)),c}fhRules(c=!1){return this.editionRules("fh")||c&&this.gh2eRules()}gh2eRules(){return this.editionRules("gh2e")}bbRules(){return this.editionRules("bb")}editionRules(c,l=!0){const d=l?this.currentEdition():this.game.edition;return d&&(d==c||-1!=this.editionExtensions(d).indexOf(c))||!1}additionalIdentifier(c,l=void 0){return c instanceof O.K?new v.h5(c.name,c.edition,"character",void 0,c.tags):c instanceof E.R?l instanceof R.I?new v.h5(c.name,c.edition,"monster",l.marker,l.tags):new v.h5(c.name,c.edition,"monster",void 0,c.tags):c instanceof I.$e?l instanceof U.X?new v.h5(c.name,c.escort?"escort":"objective","objective",l.marker,l.tags):new v.h5(c.name,c.escort?"escort":"objective","objective",void 0,[]):new v.h5(c.name,c.edition,void 0,void 0,l&&l.tags||[])}entityCounter(c){return this.entityCounters(c)[0]||void 0}entityCounters(c){const l=new RegExp("^"+c.name+"$");return this.game.entitiesCounter.filter(d=>(!c.type||c.type==d.identifier.type)&&d.identifier.name.match(l)&&(!c.edition||c.edition==d.identifier.edition)&&(!c.marker||c.marker==d.identifier.marker)&&(!c.tags||0==c.tags.length||c.tags.every(h=>d.identifier.tags&&-1!=d.identifier.tags.indexOf(h))))}addEntityCount(c,l=void 0){const d=this.additionalIdentifier(c,l);let h=this.entityCounter(d);h||(h={identifier:d,total:0,killed:0},this.game.entitiesCounter.push(h)),h.total++}checkEntitiesKilled(){this.game.figures.forEach(c=>{c instanceof O.K?this.entityCounter(this.additionalIdentifier(c))||this.addEntityCount(c):(c instanceof E.R||c instanceof I.$e)&&c.entities.forEach(l=>{this.entityManager.isAlive(l)&&!this.entityCounter(this.additionalIdentifier(c,l))&&this.addEntityCount(c,l)})}),this.game.entitiesCounter.forEach(c=>{let l=this.figuresByIdentifier(c.identifier);if(0==l.length&&c.total>c.killed)c.killed=c.total;else if(l.every(d=>d instanceof O.K))l=l.filter(d=>d instanceof O.K&&this.entityManager.isAlive(d)),l.length+c.killed<c.total?c.killed=c.total-l.length:l.length+c.killed>c.total&&(console.warn("More killed then figures counted",c.identifier,"total: "+c.total,"killed: "+c.killed,"current: "+l.length),c.total=l.length+c.killed);else if(l.every(d=>d instanceof E.R)){const d=l.map(h=>this.monsterManager.monsterEntityCountIdentifier(h,c.identifier)).reduce((h,u)=>h+u);d+c.killed<c.total?c.killed=c.total-d:d+c.killed>c.total&&(console.warn("More killed then figures counted",c.identifier,"total: "+c.total,"killed: "+c.killed,"current: "+d),c.total=d+c.killed)}else if(l.every(d=>d instanceof I.$e)){const d=l.map(h=>this.objectiveManager.objectiveEntityCountIdentifier(h,c.identifier)).reduce((h,u)=>h+u);d+c.killed<c.total?c.killed=c.total-d:d+c.killed>c.total&&(console.warn("More killed then figures counted",c.identifier,"total: "+c.total,"killed: "+c.killed,"current: "+d),c.total=d+c.killed)}})}nextElementState(c,l=!1,d=!1){if(f.bbRules())return c.state!=S.e_.strong?S.e_.strong:S.e_.inert;if(f.game.state==A.mk.draw||d){if(c.state==S.e_.new&&!l)return S.e_.strong;if(c.state!=S.e_.new&&c.state!=S.e_.strong)return c.state==S.e_.waning?S.e_.inert:l?S.e_.waning:S.e_.new;if(!l)return S.e_.waning}else{if(c.state==S.e_.new&&!l)return S.e_.strong;if(c.state==S.e_.strong){if(l)return S.e_.waning}else{if(c.state!=S.e_.waning)return l?S.e_.waning:S.e_.new;if(l)return S.e_.new}}return S.e_.inert}campaignData(c=void 0){c=c||this.currentEdition();const l=this.editionData.find(h=>h.edition==c);if(l&&l.campaign)return Object.assign(new P.Np,l.campaign);const d=this.editionExtensions(c).map(h=>this.editionData.find(u=>u.edition==h)).map(h=>h?h.campaign:void 0).find(h=>h);return d?Object.assign(new P.Np,d):new P.Np}changeParty(c){j.f.settings.automaticTheme&&("fh"!=this.game.edition&&"fh"==c.edition||"gh2e"!=this.game.edition&&"gh2e"==c.edition?j.f.set("fhStyle",!0):"fh"==this.game.edition&&"fh"!=c.edition&&j.f.set("fhStyle",!1)),this.game.party.characters=this.game.figures.filter(l=>l instanceof O.K).map(l=>l.toModel()),this.game.party.edition=this.game.edition,this.game.party.conditions=this.game.conditions,this.game.party.battleGoalEditions=this.game.battleGoalEditions,this.game.party.filteredBattleGoals=this.game.filteredBattleGoals,this.game.party.unlockedCharacters=this.game.unlockedCharacters,this.game.party.level=this.game.level,this.game.party.levelCalculation=this.game.levelCalculation,this.game.party.levelAdjustment=this.game.levelAdjustment,this.game.party.bonusAdjustment=this.game.bonusAdjustment,this.game.party.ge5Player=this.game.ge5Player,this.game.party.playerCount=this.game.playerCount,this.game.party.solo=this.game.solo,this.game.party.lootDeckEnhancements=this.game.lootDeckEnhancements,this.game.party.lootDeckFixed=this.game.lootDeckFixed,this.game.party.lootDeckSections=this.game.lootDeckSections,this.game.party=c,this.game.edition=this.game.party.edition,this.game.conditions=this.game.party.conditions||[],this.game.battleGoalEditions=this.game.party.battleGoalEditions||[],this.game.filteredBattleGoals=this.game.party.filteredBattleGoals||[],this.game.unlockedCharacters=this.game.party.unlockedCharacters||[],this.game.level=0==this.game.party.level?0:this.game.party.level||this.game.level,this.game.levelCalculation=0!=this.game.party.levelCalculation&&(this.game.party.levelCalculation||this.game.levelCalculation),this.game.levelAdjustment=0==this.game.party.levelAdjustment?0:this.game.party.levelAdjustment||this.game.levelAdjustment,this.game.bonusAdjustment=0==this.game.party.bonusAdjustment?0:this.game.party.bonusAdjustment||this.game.bonusAdjustment,this.game.ge5Player=0!=this.game.party.ge5Player&&(this.game.party.ge5Player||this.game.ge5Player),this.game.playerCount=this.game.party.playerCount||this.game.playerCount,this.game.solo=0!=this.game.party.solo&&(this.game.party.solo||this.game.solo),this.game.lootDeckEnhancements=this.game.party.lootDeckEnhancements||[],this.game.lootDeckFixed=this.game.party.lootDeckFixed||[],this.game.lootDeckSections=this.game.party.lootDeckSections||[],this.game.figures=this.game.figures.filter(l=>!(l instanceof O.K)),this.scenarioManager.setScenario(void 0),c.characters.forEach(l=>{let d=new O.K(this.getCharacterData(l.name,l.edition),l.level);d.fromModel(l),this.game.figures.push(d)})}resetCampaign(){this.game.figures=[],this.game.party.characters=[],this.game.party.location="",this.game.party.achievements="",this.game.party.achievementsList=[],this.game.party.reputation=0,this.game.party.prosperity=0,this.game.party.scenarios=[],this.game.party.conclusions=[],this.game.party.casualScenarios=[],this.game.party.manualScenarios=[],this.game.party.globalAchievements="",this.game.party.globalAchievementsList=[],this.game.party.treasures=[],this.game.party.donations=0,this.game.party.retirements=[],this.game.party.unlockedItems=[],this.game.party.unlockedCharacters=[],this.game.party.envelopeB=!1,this.game.party.weeks=0,this.game.party.weekSections=[],this.game.party.loot={},this.game.party.randomItemLooted=[],this.game.party.inspiration=0,this.game.party.defense=0,this.game.party.soldiers=0,this.game.party.morale=0,this.game.party.townGuardPerks=0,this.game.party.townGuardPerkSections=[],this.game.party.campaignStickers=[],this.game.party.townGuardDeck=void 0,this.game.party.buildings=[],this.game.party.lootDeckEnhancements=[],this.game.party.lootDeckFixed=[],this.game.party.lootDeckSections=[]}toggleGameClock(){this.game.gameClock=this.game.gameClock||[];let c=this.game.gameClock.length?this.game.gameClock[0]:void 0;c&&(c.clockIn?c.clockOut?c=void 0:c.clockOut=(new Date).getTime():(console.warn("Timestamp with invalid clock:",c),c.clockIn=(new Date).getTime())),c||this.game.gameClock.unshift(new A.bt((new Date).getTime())),this.stateManager.saveLocal()}mergeGameClocks(c,l){let d=[];return c.forEach(h=>{const u=l.find(b=>b.clockIn<=h.clockIn&&(b.clockOut&&h.clockOut&&b.clockOut>=h.clockOut||!b.clockOut));d.push(u||h)}),l.forEach(h=>{d.find(u=>u.clockIn<=h.clockIn&&(u.clockOut&&h.clockOut&&u.clockOut>=h.clockOut||!u.clockOut))||d.push(h)}),d.sort((h,u)=>u.clockIn-h.clockIn)}};window.gameManager=f},58503:(p,k,M)=>{M.d(k,{j:()=>v});var C=M(60057);class v extends C.gw{petname;active;lost;constructor(O,A,E="",R=!1,I=!1){super(O,A),this.petname=E,this.active=R,this.lost=I}}},60057:(p,k,M)=>{M.d(k,{VP:()=>t,gw:()=>C,h5:()=>v});class C{name="";edition="";constructor(O,A){this.name=O,this.edition=A}}class t extends C{count;constructor(O,A,E=-1){super(O,A),this.count=E}}class v extends C{type;marker;tags;constructor(O,A,E=void 0,R=void 0,I=void 0){super(O,A),this.type=E,this.marker=R,this.tags=I}equals(O){return this.edition==O.edition&&this.marker==O.marker&&this.name==O.name&&this.type==O.type}}},67114:(p,k,M)=>{M.d(k,{Az:()=>E,Qc:()=>t,TH:()=>I,Yj:()=>A,iH:()=>O});class t{cardId;edition;type;selected;subSelections;checks;scenarioApply;attack;constructor(s,T,m,w,q,P,S,$){this.cardId=s,this.edition=T,this.type=m,this.selected=w,this.subSelections=q,this.checks=P,this.scenarioApply=$,this.attack=S}}var O=function(X){return X.and="and",X.building="building",X.campaignSticker="campaignSticker",X.character="character",X.class="class",X.loseCollectiveResource="loseCollectiveResource",X.loseCollectiveResourceType="loseCollectiveResourceType",X.loseResource="loseResource",X.loseResourceType="loseResourceType",X.moraleGT="moraleGT",X.moraleLT="moraleLT",X.otherwise="otherwise",X.payGold="payGold",X.payCollectiveGold="payCollectiveGold",X.payCollectiveGoldConditional="payCollectiveGoldConditional",X.payCollectiveGoldReputationGT="payCollectiveGoldReputationGT",X.payCollectiveGoldReputationLT="payCollectiveGoldReputationLT",X.payCollectiveItem="payCollectiveItem",X.reputationGT="reputationGT",X.reputationLT="reputationLT",X.season="season",X.seasonLT="seasonLT",X.traits="traits",X}(O||{}),A=function(X){return X.additionally="additionally",X.and="and",X.battleGoal="battleGoal",X.campaignSticker="campaignSticker",X.campaignStickerMap="campaignStickerMap",X.campaignStickerReplace="campaignStickerReplace",X.checkbox="checkbox",X.choose="choose",X.collectiveGold="collectiveGold",X.collectiveGoldAdditional="collectiveGoldAdditional",X.collectiveGoldOther="collectiveGoldOther",X.collectiveItem="collectiveItem",X.collectiveResource="collectiveResource",X.collectiveResourceType="collectiveResourceType",X.consumeItem="consumeItem",X.consumeCollectiveItem="consumeCollectiveItem",X.custom="custom",X.discard="discard",X.discardOne="discardOne",X.drawAnotherEvent="drawAnotherEvent",X.drawEvent="drawEvent",X.event="event",X.eventReturn="eventReturn",X.eventsToTop="eventsToTop",X.experience="experience",X.globalAchievement="globalAchievement",X.gold="gold",X.goldAdditional="goldAdditional",X.inspiration="inspiration",X.item="item",X.itemCollective="itemCollective",X.itemDesign="itemDesign",X.loseBattleGoal="loseBattleGoal",X.loseCollectiveExperience="loseCollectiveExperience",X.loseCollectiveGold="loseCollectiveGold",X.loseCollectiveResource="loseCollectiveResource",X.loseCollectiveResourceAny="loseCollectiveResourceAny",X.loseCollectiveResourceType="loseCollectiveResourceType",X.loseExperience="loseExperience",X.loseGold="loseGold",X.loseGoldOne="loseGoldOne",X.loseMorale="loseMorale",X.loseProsperity="loseProsperity",X.loseReputation="loseReputation",X.loseResource="loseResource",X.morale="morale",X.noEffect="noEffect",X.outcome="outcome",X.outcomes="outcomes",X.outcomeSelect="outcomeSelect",X.outpostAttack="outpostAttack",X.outpostTarget="outpostTarget",X.randomItem="randomItem",X.randomItemBlueprint="randomItemBlueprint",X.randomItemDesign="randomItemDesign",X.randomScenario="randomScenario",X.removeEvent="removeEvent",X.reputation="reputation",X.reputationAdditional="reputationAdditional",X.resource="resource",X.resourceType="resourceType",X.partyAchievement="partyAchievement",X.prosperity="prosperity",X.scenarioCondition="scenarioCondition",X.scenarioDamage="scenarioDamage",X.scenarioSingleMinus1="scenarioSingleMinus1",X.sectionWeek="sectionWeek",X.sectionWeeks="sectionWeeks",X.sectionWeekSeasonFinal="sectionWeekSeasonFinal",X.sectionWeeksSeason="sectionWeeksSeason",X.skipThreat="skipThreat",X.soldier="soldier",X.soldiers="soldiers",X.townGuardDeckCard="townGuardDeckCard",X.townGuardDeckCardRemove="townGuardDeckCardRemove",X.townGuardDeckCardRemovePermanently="townGuardDeckCardRemovePermanently",X.townGuardDeckCards="townGuardDeckCards",X.unlockEnvelope="unlockEnvelope",X.unlockScenario="unlockScenario",X.unlockScenarioGroup="unlockScenarioGroup",X.upgradeBuilding="upgradeBuilding",X.wreckBuilding="wreckBuilding",X}(A||{});class E{condition;type=A.noEffect;values=[];alt=!1;constructor(s,T=[]){this.type=s,this.values=T}}class I{attackValue;targetNumber;targetDescription;narrative;effects;constructor(s,T,m,w,q){this.attackValue=s,this.targetNumber=T,this.targetDescription=m,this.narrative=w,this.effects=q}}},67165:(p,k,M)=>{M.d(k,{Ah:()=>v,lb:()=>D});class v{index=0;goal=!1;rewards=[];constructor(E,R=-1){if(this.index=R,"G"==E)this.goal=!0;else{let I=E.split("|");for(let U of I)this.rewards.push(new O(U))}}}var D=function(A){return A.custom="custom",A.gold="gold",A.goldFh="goldFh",A.experience="experience",A.experienceFh="experienceFh",A.battleGoal="battleGoal",A.damage="damage",A.condition="condition",A.heal="heal",A.item="item",A.itemFh="itemFh",A.itemDesign="itemDesign",A.randomItem="randomItem",A.randomItemDesign="randomItemDesign",A.itemBlueprint="itemBlueprint",A.randomItemBlueprint="randomItemBlueprint",A.scenario="scenario",A.randomScenario="randomScenario",A.randomScenarioFh="randomScenarioFh",A.partyAchievement="partyAchievement",A.event="event",A.loot="loot",A.lootCards="lootCards",A.resource="resource",A.campaignSticker="campaignSticker",A.calendarSection="calendarSection",A}(D||{});class O{type;value;constructor(E){let R=E.split(":");try{this.type=R[0],R.length>1&&(this.value=isNaN(+R[1])?R[1]:+R[1])}catch{this.type=D.custom,console.error("Invalid treasure reward string: '"+E+"'")}}}},71891:(p,k,M)=>{M.d(k,{r:()=>D});var C=M(58317),t=M(31619),v=M(9733);class D{id=0;name="";edition;conditions=[];battleGoalEditions=[];filteredBattleGoals=[];location="";notes="";achievements="";achievementsList=[];reputation=0;prosperity=0;scenarios=[];conclusions=[];casualScenarios=[];manualScenarios=[];campaignMode=!1;globalAchievements="";globalAchievementsList=[];treasures=[];donations=0;players=[];characters=[];availableCharacters=[];retirements=[];unlockedItems=[];unlockedCharacters=[];level=1;levelCalculation=!0;levelAdjustment=0;bonusAdjustment=0;ge5Player=!0;playerCount=-1;solo=!1;envelopeB=!1;eventDecks={};eventCards=[];weeks=0;weekSections={};loot={};randomItemLooted=[];inspiration=0;defense=0;soldiers=0;morale=0;townGuardPerks=0;townGuardPerkSections=[];campaignStickers=[];townGuardDeck;buildings=[];pets=[];lootDeckEnhancements=[];lootDeckFixed=[];lootDeckSections=[];trials=-1;garden;factionReputation={};imbuement=0;migrate(){if(this.achievementsList){const A=t.f.label.data.partyAchievements;let E=t.f.label.data.globalAchievements;t.f.settings.locale!=t.f.defaultLocale&&(E=C.E.editionData.map(R=>R.label[t.f.defaultLocale]&&R.label[t.f.defaultLocale].globalAchievements||{}).reduce((R,I)=>Object.assign(R,I))),this.achievementsList=this.achievementsList.filter(R=>R),this.achievementsList=this.achievementsList.map(R=>{let I=R;return R.startsWith("!")&&(I=I.slice(1,I.length)),Object.keys(A).forEach(U=>{(A[U].toLowerCase()==I.toLowerCase()||E[U]&&E[U].toLowerCase()==I.toLowerCase())&&(I=U)}),R.startsWith("!")&&(I="!"+I),I})}if(this.globalAchievementsList){const A=t.f.label.data.globalAchievements;let E=t.f.label.data.globalAchievements;t.f.settings.locale!=t.f.defaultLocale&&(E=C.E.editionData.map(R=>R.label[t.f.defaultLocale]&&R.label[t.f.defaultLocale].globalAchievements||{}).reduce((R,I)=>Object.assign(R,I))),this.globalAchievementsList=this.globalAchievementsList.filter(R=>R),this.globalAchievementsList=this.globalAchievementsList.map(R=>{let I=R;return R.startsWith("!")&&(I=I.slice(1,I.length)),Object.keys(A).forEach(U=>{(A[U].toLowerCase()==I.toLowerCase()||E[U]&&E[U].toLowerCase()==I.toLowerCase())&&(I=U)}),R.startsWith("!")&&(I="!"+I),I})}if(this.campaignStickers&&(this.campaignStickers=this.campaignStickers.filter(A=>A).map(A=>{let E=A;return Object.keys(t.f.label.data.campaignSticker).forEach(R=>{t.f.label.data.campaignSticker[R]!=E||(E=R)}),E})),this.manualScenarios){let A=[];this.manualScenarios.forEach(E=>{if("fh"==E.edition&&!E.group&&!E.custom){const R=C.E.sectionData("fh").find(I=>I.random&&I.unlocks&&-1!=I.unlocks.indexOf(E.index));R&&(this.conclusions.find(I=>I.edition==R.edition&&I.group==R.group&&I.index==R.index)||(this.conclusions.push(new v.Ag(""+R.index,R.edition,R.group)),A.push(E)))}}),this.manualScenarios=this.manualScenarios.filter(E=>-1==A.indexOf(E))}this.players=this.players||[],this.casualScenarios=this.casualScenarios||[],this.pets=this.pets||[],this.eventDecks=this.eventDecks||{},this.eventCards=this.eventCards||[],this.campaignMode&&t.f.settings.events&&C.E.eventCardManager.buildPartyDeckMigration(this.edition||C.E.currentEdition()),this.eventCards.forEach(A=>{if(-1==Object.keys(A).indexOf("attack")){const E=C.E.eventCardManager.getEventCardForEdition(A.edition,A.type,A.cardId);A.attack=E&&E.options&&E.options.some(R=>R.outcomes&&R.outcomes.some(I=>I.attack))||!1}})}}},72941:(p,k,M)=>{M.d(k,{TQ:()=>v,Tr:()=>O,o8:()=>t});var t=function(A){return A.head="head",A.body="body",A.legs="legs",A.onehand="onehand",A.twohand="twohand",A.small="small",A}(t||{}),v=function(A){return A.condition="condition",A.immune="immune",A.heal="heal",A.damage="damage",A.element="element",A.initiative="initiative",A.refreshSpent="refreshSpent",A.removeNegativeConditions="removeNegativeConditions",A}(v||{}),O=function(A){return A.spent="spent",A.consumed="consumed",A.flipped="flipped",A.persistent="persistent",A.slot="slot",A.slotBack="slotBack",A}(O||{})},73018:(p,k,M)=>{M.d(k,{f:()=>v});var C=M(40392),t=M(16538);class v{name="";count=0;randomCount=0;standeeCount;standeeShare;standeeShareEdition;baseStat=new C.f(t.N.normal);stats=[];deck="";boss=!1;bb=!1;flying=!1;immortal=!1;thumbnail;thumbnailUrl;noThumbnail=!1;noArtwork=!1;pet="";firstActiveAction=!1;edition="";spoiler=!1;errors=[];hidden=!1;replace=!1;constructor(O=void 0){O&&(this.name=O.name,this.count=O.count,this.randomCount=O.randomCount,this.standeeCount=O.standeeCount,this.standeeShare=O.standeeShare,this.standeeShareEdition=O.standeeShareEdition,this.baseStat=O.baseStat,this.stats=O.stats||[],this.deck=O.deck,this.boss=O.boss,this.bb=O.bb,this.flying=O.flying,this.immortal=O.immortal,this.thumbnail=O.thumbnail,this.thumbnailUrl=O.thumbnailUrl,this.noThumbnail=O.noThumbnail,this.noArtwork=O.noArtwork,this.pet=O.pet,this.firstActiveAction=O.firstActiveAction,this.edition=O.edition,this.spoiler=O.spoiler,this.errors=O.errors||[],this.hidden=O.hidden,this.replace=O.replace)}}},73219:(p,k,M)=>{M.d(k,{IK:()=>I,J:()=>m,Yn:()=>C,_v:()=>R,bx:()=>T,hM:()=>O,hY:()=>D,iy:()=>X,oz:()=>A,qM:()=>w,qq:()=>U,tW:()=>t,u3:()=>s,uU:()=>v,zs:()=>E});var C=function(q){return q.plus="plus",q.plus0="plus0",q.plus1="plus1",q.plus2="plus2",q.plus3="plus3",q.plus4="plus4",q.plusX="plusX",q.minus="minus",q.minus1="minus1",q.minus2="minus2",q.null="null",q.double="double",q.bless="bless",q.curse="curse",q.minus1extra="minus1extra",q.empower="empower",q.enfeeble="enfeeble",q.invalid="invalid",q.townguard="townguard",q.wreck="wreck",q.success="success",q.imbue="imbue",q.advancedImbue="advancedImbue",q}(C||{}),t=function(q){return q.default="default",q.plus="plus",q.minus="minus",q.multiply="multiply",q}(t||{});class v{id;type;value=0;valueType;shuffle=!1;effects;rolling;active;revealed=!1;character=!1;constructor(P,S=0,$=t.plus,V=void 0,N=[],K=!1,Y=!1,j=void 0){switch(this.type=P,this.value=S,this.valueType=$,this.id=V||(P==C.townguard?"tg-"+$+S:P==C.wreck||P==C.success?"tg-"+P:P!=C.plus&&P!=C.minus?P:P+S),this.effects=N,this.rolling=K,this.active=Y,this.shuffle=j||!1,P){case C.plus0:this.value=0;break;case C.plus1:this.value=1;break;case C.plus2:this.value=2;break;case C.plus3:this.value=3;break;case C.plus4:this.value=4;break;case C.minus:this.valueType=t.minus;break;case C.minus1:this.valueType=t.minus,this.value=1;break;case C.minus2:this.valueType=t.minus,this.value=2;break;case C.null:this.valueType=t.multiply,this.value=0,null==j&&(this.shuffle=!0);break;case C.double:this.valueType=t.multiply,this.value=2,null==j&&(this.shuffle=!0);break;case C.bless:this.valueType=t.multiply,this.value=2;break;case C.curse:this.valueType=t.multiply,this.value=0;break;case C.minus1extra:this.valueType=t.minus,this.value=1;break;case C.wreck:this.valueType=t.minus,this.value=0;break;case C.success:this.value=0}}clone(){return new v(this.type,this.value,this.valueType,this.id,this.effects?JSON.parse(JSON.stringify(this.effects)):[],this.rolling,this.active)}}var D=function(q){return q.area="area",q.changeType="changeType",q.condition="condition",q.custom="custom",q.element="element",q.elementConsume="elementConsume",q.elementHalf="elementHalf",q.heal="heal",q.pierce="pierce",q.pull="pull",q.push="push",q.range="range",q.recoverRandomDiscard="recoverRandomDiscard",q.refreshItem="refreshItem",q.refreshSpentItem="refreshSpentItem",q.required="required",q.retaliate="retaliate",q.shield="shield",q.specialTarget="specialTarget",q.summon="summon",q.swing="swing",q.target="target",q.attack="attack",q.or="or",q}(D||{});class O{type;value;hint;effects;icon=!1;constructor(P,S="",$="",V=[],N=!1){this.type=P,this.value=S,this.hint=$,this.effects=V,this.icon=N}}class A{index;chooseOffset;state;attack;stringified;result;effects;constructor(P,S,$,V,N,K,Y){this.index=P,this.chooseOffset=S,this.state=$,this.attack=V,this.stringified=N,this.result=K,this.effects=Y}}const E=[new v(C.plus0),new v(C.plus1),new v(C.minus1),new v(C.plus2),new v(C.minus2),new v(C.double),new v(C.null),new v(C.bless),new v(C.curse),new v(C.minus1extra)],R=[C.plus0,C.plus0,C.plus0,C.plus0,C.plus0,C.plus0,C.plus1,C.plus1,C.plus1,C.plus1,C.plus1,C.minus1,C.minus1,C.minus1,C.minus1,C.minus1,C.plus2,C.minus2,C.double,C.null],I=[new v(C.townguard,0,t.default),new v(C.townguard,0,t.default),new v(C.townguard,0,t.default),new v(C.townguard,0,t.default),new v(C.townguard,0,t.default),new v(C.townguard,0,t.default),new v(C.townguard,10),new v(C.townguard,10),new v(C.townguard,10),new v(C.townguard,10),new v(C.townguard,10),new v(C.townguard,20),new v(C.townguard,10,t.minus),new v(C.townguard,10,t.minus),new v(C.townguard,10,t.minus),new v(C.townguard,10,t.minus),new v(C.townguard,10,t.minus),new v(C.townguard,20,t.minus),new v(C.wreck),new v(C.success)],U=[new v(C.townguard,0,t.default,"fh-tg-add-plus0"),new v(C.townguard,10,t.plus,"fh-tg-add-plus10"),new v(C.townguard,10,t.minus,"fh-tg-add-minus10"),new v(C.townguard,20,t.plus,"fh-tg-add-plus20"),new v(C.townguard,20,t.minus,"fh-tg-add-minus20"),new v(C.townguard,30,t.plus,"fh-tg-add-plus30"),new v(C.townguard,50,t.plus,"fh-tg-add-plus50"),new v(C.wreck,0,t.default,"fh-tg-add-wreck"),new v(C.success,0,t.default,"fh-tg-add-success"),new v(C.townguard,10,t.plus,"fh-tg-add-plus10-soldier",[new O(D.custom,"fh-soldier","",[],!0)],!0),new v(C.townguard,20,t.plus,"fh-tg-add-plus20-soldier",[new O(D.custom,"fh-soldier","",[],!0)]),new v(C.townguard,30,t.plus,"fh-tg-add-plus30-soldier",[new O(D.custom,"fh-soldier","",[],!0)]),new v(C.townguard,10,t.plus,"fh-tg-add-plus10-rolling",[],!0),new v(C.townguard,10,t.plus,"fh-tg-add-plus10-advantage",[new O(D.custom,"game.custom.advantage")],!0),new v(C.townguard,20,t.minus,"fh-tg-add-minus20-resource",[new O(D.custom,"+2 material resource")]),new v(C.townguard,0,t.default,"fh-tg-add-resource-hide",[new O(D.custom,"+1%game.resource.hide%","Gain one Hide")]),new v(C.townguard,0,t.default,"fh-tg-add-resource-lumber",[new O(D.custom,"+1%game.resource.lumber%","Gain one Lumber")]),new v(C.townguard,0,t.default,"fh-tg-add-resource-metal",[new O(D.custom,"+1%game.resource.metal%","Gain one Metal")]),new v(C.townguard,50,t.plus,"fh-tg-add-plus50-algox",[new O(D.custom,"fh-algox","",[],!0)]),new v(C.townguard,50,t.plus,"fh-tg-add-plus50-unfettered",[new O(D.custom,"fh-unfettered","",[],!0)]),new v(C.townguard,50,t.plus,"fh-tg-add-plus50-lurkers",[new O(D.custom,"fh-lurkers","",[],!0)])],X=[new v(C.imbue,1,t.plus,"gh2e-imbue-1"),new v(C.imbue,1,t.plus,"gh2e-imbue-2"),new v(C.imbue,1,t.plus,"gh2e-imbue-3"),new v(C.imbue,0,t.plus,"gh2e-imbue-4",[new O(D.condition,"poison")]),new v(C.imbue,2,t.plus,"gh2e-imbue-5",[new O(D.condition,"muddle")])],s=[new v(C.advancedImbue,3,t.plus,"gh2e-advancedImbue-1"),new v(C.advancedImbue,0,t.plus,"gh2e-advancedImbue-2",[new O(D.condition,"wound")]),new v(C.advancedImbue,1,t.plus,"gh2e-advancedImbue-3",[new O(D.condition,"curse")]),new v(C.advancedImbue,1,t.plus,"gh2e-advancedImbue-4",[new O(D.heal,"1","",[new O(D.specialTarget,"self")])]),new v(C.advancedImbue,1,t.plus,"gh2e-advancedImbue-5",[new O(D.heal,"1","",[new O(D.specialTarget,"self")])])],T=[new v(C.double,2,t.multiply,"cs-oak-527",[new O(D.condition,"bless","",[new O(D.specialTarget,"allyShort")])]),new v(C.double,2,t.multiply,"cs-oak-528",[new O(D.condition,"bless","",[new O(D.specialTarget,"allyShort")])]),new v(C.double,2,t.multiply,"cs-oak-529",[new O(D.heal,"2","",[new O(D.range,"2")])]),new v(C.double,2,t.multiply,"cs-oak-530",[new O(D.heal,"2","",[new O(D.range,"2")])]),new v(C.double,2,t.multiply,"cs-oak-531",[new O(D.element,"wild")]),new v(C.double,2,t.multiply,"cs-oak-532",[new O(D.element,"wild")]),new v(C.double,2,t.multiply,"cs-oak-533",[new O(D.custom,"All enemies adjacent to the target suffer %game.damage:1%")]),new v(C.double,2,t.multiply,"cs-oak-534",[new O(D.custom,"All enemies adjacent to the target suffer %game.damage:1%")]),new v(C.plus1,1,t.plus,"cs-oak-535",[new O(D.push,"2")],!0),new v(C.plus1,1,t.plus,"cs-oak-536",[new O(D.push,"2")],!0),new v(C.plus1,1,t.plus,"cs-oak-537",[new O(D.heal,"1","",[new O(D.range,"2")])],!0),new v(C.plus1,1,t.plus,"cs-oak-538",[new O(D.heal,"1","",[new O(D.range,"2")])],!0),new v(C.plus0,0,t.plus,"cs-oak-539",[new O(D.condition,"wound"),new O(D.condition,"muddle")],!0),new v(C.plus0,0,t.plus,"cs-oak-540",[new O(D.condition,"wound"),new O(D.condition,"muddle")],!0),new v(C.plus1,1,t.plus,"cs-oak-541",[new O(D.pierce,"3")],!0),new v(C.plus1,1,t.plus,"cs-oak-542",[new O(D.pierce,"3")],!0)];class m{attackModifiers;current;cards;discarded=[];active=!0;lastVisible=0;state;bb;constructor(P=void 0,S=!1){this.bb=S,this.attackModifiers=JSON.parse(JSON.stringify(P?P.filter(($,V,N)=>this.bb||N.indexOf($)==V):E)),this.current=-1,this.cards=P?JSON.parse(JSON.stringify(P)):R.map($=>E.find(V=>V.id==$)||new v(C.invalid,0,t.default,$))}toModel(){return new w(this.current,this.cards.map(P=>P&&P.id),this.discarded,this.active,this.lastVisible,this.state,this.bb)}merge(P){this.attackModifiers=P.attackModifiers,this.current=P.current,this.cards=P.cards,this.discarded=P.discarded,this.lastVisible=P.lastVisible,this.state=P.state,this.bb=P.bb}}class w{current;cards;discarded;active;lastVisible;state;bb;disgarded;constructor(P,S,$,V,N=0,K=void 0,Y=!1){this.current=P,this.cards=S,this.discarded=JSON.parse(JSON.stringify($)),this.active=V,this.lastVisible=N,this.state=K,this.bb=Y,this.disgarded=JSON.parse(JSON.stringify($))}}},73391:(p,k,M)=>{M.d(k,{x:()=>C});class C{characters=!1;character=[];monsters=!1;monster=[];scenario=!1;elements=!1;round=!1;level=!1;attackModifiers=!1;lootDeck=!1;party=!1}},76066:(p,k,M)=>{M.d(k,{I:()=>E});var C=M(58317),t=M(13812),v=M(78164),D=M(42357),O=M(34786),A=M(40392);class E{number;marker="";type;stat;dead=!1;summon=v.N5.false;dormant=!1;revealed=!1;active=!1;off=!1;level;health;maxHealth;entityConditions=[];immunities=[];markers=[];tags=[];shield;shieldPersistent;retaliate=[];retaliatePersistent=[];constructor(U,X,s){this.number=U,this.type=X;const T=C.E.monsterManager.getStat(s,X);T?this.stat=T:(this.stat=new A.f(X,s.level),s.errors=s.errors||[],!s.errors.find(m=>m.type==O.H.unknown)&&!s.errors.find(m=>m.type==O.H.stat)&&(console.error("Could not find '"+X+"' stats for monster: "+s.name+" level: "+s.level),s.errors.push(new O.h(O.H.stat,"monster",s.name,s.edition,X,""+s.level)))),this.maxHealth=(0,t.hZ)(this.stat.health,s.level),this.health=this.maxHealth,0==this.health&&(this.health=1),this.level=s.level}toModel(){return new R(this.number,this.marker,this.type,this.dead,this.summon,this.active,this.off,this.revealed,this.dormant,this.health,this.maxHealth,this.entityConditions.map(U=>U.toModel()),this.immunities,this.markers,this.tags||[],this.shield,this.shieldPersistent,this.retaliate,this.retaliatePersistent)}fromModel(U){this.marker=U.marker,this.dead=U.dead,this.summon=U.summon,this.active=U.active,this.off=U.off,this.revealed=U.revealed,this.dormant=U.dormant,this.health=U.health,this.maxHealth=U.maxHealth,this.entityConditions=[],U.entityConditions&&(this.entityConditions=U.entityConditions.map(X=>{let s=new D.BR(X.name,X.value);return s.fromModel(X),s})),this.immunities=U.immunities||[],this.markers=U.markers||[],this.tags=U.tags||[],this.shield=U.shield?JSON.parse(U.shield):void 0,this.shieldPersistent=U.shieldPersistent?JSON.parse(U.shieldPersistent):void 0,this.retaliate=(U.retaliate||[]).map(X=>JSON.parse(X)),this.retaliatePersistent=(U.retaliatePersistent||[]).map(X=>JSON.parse(X))}}class R{number;marker;type;dead;summon;revealed;dormant;active;off;health;maxHealth;entityConditions;immunities;markers;tags;shield;shieldPersistent;retaliate;retaliatePersistent;constructor(U,X,s,T,m,w,q,P,S,$,V,N,K,Y,j,G,Lt,Jt,Ut){this.number=U,this.marker=X,this.type=s,this.dead=T,this.summon=m,this.active=w,this.off=q,this.revealed=P,this.dormant=S,this.health=$,this.maxHealth=V,this.entityConditions=JSON.parse(JSON.stringify(N)),this.immunities=JSON.parse(JSON.stringify(K)),this.markers=JSON.parse(JSON.stringify(Y)),this.tags=JSON.parse(JSON.stringify(j)),this.shield=G?JSON.stringify(G):"",this.shieldPersistent=Lt?JSON.stringify(Lt):"",this.retaliate=Jt.map(ee=>JSON.stringify(ee)),this.retaliatePersistent=Ut.map(ee=>JSON.stringify(ee))}}},78164:(p,k,M)=>{M.d(k,{N5:()=>D,rX:()=>O,up:()=>A});var C=M(42357),t=M(13812),v=M(58167),D=function(R){return R.new="new",R.true="true",R.false="false",R}(D||{}),O=function(R){return R.blue="blue",R.green="green",R.yellow="yellow",R.orange="orange",R.white="white",R.purple="purple",R.pink="pink",R.red="red",R.custom="custom",R.fh="fh",R}(O||{});class A{uuid;name;title;cardId;number;color;attack=0;movement=0;range=0;flying=!1;dead=!1;state=D.new;init=!0;action;additionalAction;thumbnail;thumbnailUrl;noThumbnail=!1;dormant=!1;revealed=!1;active=!1;off=!1;level;health=2;maxHealth=2;entityConditions=[];immunities=[];markers=[];tags=[];shield;shieldPersistent;retaliate=[];retaliatePersistent=[];constructor(I,U,X,s,T,m,w=void 0){this.uuid=I||(0,v.v4)(),this.name=U,this.title="",this.cardId=X,this.level=s,this.number=T,this.color=m,w&&(this.maxHealth=(0,t.hZ)(w.health,s),this.health=this.maxHealth,this.attack=w.attack||0,this.movement=(0,t.hZ)(w.movement,s),this.range=(0,t.hZ)(w.range,s),this.flying=w.flying,this.action=w.action?JSON.parse(JSON.stringify(w.action)):void 0,this.additionalAction=w.additionalAction?JSON.parse(JSON.stringify(w.additionalAction)):void 0,w.thumbnail&&(this.thumbnail=w.edition+"-"+w.name),this.thumbnailUrl=w.thumbnailUrl,this.noThumbnail=w.noThumbnail),this.health=this.maxHealth}toModel(){return new E(this.uuid||(0,v.v4)(),this.name,this.title,this.cardId,this.number,this.color,this.attack&&this.attack+""||"0",this.movement,this.range,this.flying,this.dead,this.state,this.level,this.health,this.maxHealth,this.entityConditions.map(I=>I.toModel()),this.immunities,this.markers,this.tags||[],this.action?JSON.stringify(this.action):void 0,this.additionalAction?JSON.stringify(this.additionalAction):void 0,this.active,this.dormant,this.thumbnail,this.thumbnailUrl,this.noThumbnail,this.shield,this.shieldPersistent,this.retaliate,this.retaliatePersistent)}fromModel(I){this.uuid=I.uuid||(0,v.v4)(),this.name=I.name||"",this.title=I.title||"",this.cardId=I.cardId||"",this.number=I.number,this.color=I.color,this.attack=I.attack&&!isNaN(+I.attack)?+I.attack:I.attack||0,this.movement=I.movement,this.range=I.range,this.flying=I.flying,this.dead=I.dead,this.state=I.state,this.level=I.level,this.health=I.health,this.maxHealth=I.maxHealth,this.entityConditions=[],I.entityConditions&&(this.entityConditions=I.entityConditions.map(U=>{let X=new C.BR(U.name,U.value);return X.fromModel(U),X})),this.immunities=I.immunities||[],I.action&&(this.action=JSON.parse(I.action)),I.additionalAction&&(this.additionalAction=JSON.parse(I.additionalAction)),this.active=I.active,this.dormant=I.dormant,this.thumbnail=I.thumbnail,this.thumbnailUrl=I.thumbnailUrl,this.noThumbnail=I.noThumbnail,this.markers=I.markers||this.markers,this.tags=I.tags||this.tags,this.init=!1,this.shield=I.shield?JSON.parse(I.shield):void 0,this.shieldPersistent=I.shieldPersistent?JSON.parse(I.shieldPersistent):void 0,this.retaliate=(I.retaliate||[]).map(U=>JSON.parse(U)),this.retaliatePersistent=(I.retaliatePersistent||[]).map(U=>JSON.parse(U))}}class E{uuid;name;title;cardId;number;color;attack;movement;range;flying;dead;state;level;health;maxHealth;entityConditions;immunities;markers;tags;action;additionalAction;active=!1;dormant;thumbnail;thumbnailUrl;noThumbnail;shield;shieldPersistent;retaliate;retaliatePersistent;constructor(I,U,X,s,T,m,w,q,P,S,$,V,N,K,Y,j,G,Lt,Jt,Ut,ee,pe,Vt,qt,ue,ne,he,_e,ye,xe){this.uuid=I,this.name=U,this.title=X,this.cardId=s,this.number=T,this.color=m,this.attack=w,this.movement=q,this.range=P,this.flying=S,this.dead=$,this.state=V,this.level=N,this.health=K,this.maxHealth=Y,this.entityConditions=JSON.parse(JSON.stringify(j)),this.immunities=JSON.parse(JSON.stringify(G)),this.markers=JSON.parse(JSON.stringify(Lt)),this.tags=JSON.parse(JSON.stringify(Jt)),this.action=Ut,this.additionalAction=ee,this.active=pe,this.dormant=Vt,this.thumbnail=qt,this.thumbnailUrl=ue,this.noThumbnail=ne,this.shield=he?JSON.stringify(he):"",this.shieldPersistent=_e?JSON.stringify(_e):"",this.retaliate=ye.map(kt=>JSON.stringify(kt)),this.retaliatePersistent=xe.map(kt=>JSON.stringify(kt))}}},79039:(p,k,M)=>{M.d(k,{m:()=>C});class C{name;character;abilities;edition;constructor(v="",D="",O=!1,A=[]){this.name=D,this.abilities=A,this.edition=v,this.character=O}}},82e3:(p,k,M)=>{M.d(k,{$v:()=>v,Af:()=>O,tB:()=>C});class C{name="";index="";errata="";coordinates;unlocks=[];blocks=[];requires=[];requirements=[];links=[];forcedLinks=[];group;flowChartGroup;monsters=[];allies=[];allied=[];drawExtra=[];objectives=[];rooms=[]=[];marker="";rules=[];initial=!1;random=!1;solo;allyDeck=!1;eventType;lootDeckConfig={};parent;parentSections=[];blockedSections=[];resetRound;rewards;retirement="";conclusion=!1;repeatable=!1;named=!1;hideIndex=!1;complexity=0;level;overlays=[];edition="";spoiler=!1;constructor(R=void 0){R&&(this.name=R.name,this.errata=R.errata,this.index=R.index,this.unlocks=R.unlocks,this.blocks=R.blocks,this.requires=R.requires,this.requirements=R.requirements||[],this.links=R.links,this.forcedLinks=R.forcedLinks,this.group=R.group,this.flowChartGroup=R.flowChartGroup,this.monsters=R.monsters,this.allies=R.allies,this.allied=R.allied,this.drawExtra=R.drawExtra,this.objectives=R.objectives,this.rooms=R.rooms,this.marker=R.marker,this.rules=R.rules,this.initial=R.initial,this.random=R.random,this.solo=R.solo,this.allyDeck=R.allyDeck,this.lootDeckConfig=R.lootDeckConfig,this.parent=R.parent,this.parentSections=R.parentSections,this.blockedSections=R.blockedSections,this.resetRound=R.resetRound,this.rewards=R.rewards,this.retirement=R.retirement,this.conclusion=R.conclusion,this.repeatable=R.repeatable,this.edition=R.edition,this.spoiler=R.spoiler,this.named=R.named,this.hideIndex=R.hideIndex,this.complexity=R.complexity,this.level=R.level,this.overlays=R.overlays)}}class v{globalAchievements=[];partyAchievements=[];lostPartyAchievements=[];campaignSticker=[];envelopes=[];gold=0;experience=0;collectiveGold=0;reputation=0;prosperity=0;perks=0;battleGoals=0;items=[];chooseItem=[];chooseLocation=[];itemDesigns=[];events=[];eventDecks=[];removeEvents=[];itemBlueprints=[];randomItemBlueprint=0;randomItemBlueprints="";randomItem="";randomItems="";morale="";inspiration="";resources=[];collectiveResources=[];calendarSection=[];calendarSectionConditional=[];calendarSectionManual=[];calendarIgnore=!1;lootDeckCards=[];removeLootDeckCards=[];townGuardAm=[];unlockCharacter="";chooseUnlockCharacter=[];lootingGold=void 0;custom="";ignoredBonus=[];overlaySticker=void 0;overlayCampaignSticker=void 0;pet=void 0;repeatScenario=!1;reputationFactions=[];factionUnlock="";randomSideScenario=0;hints=void 0;valueMapping=void 0}class O{conclusion;success=!1;battleGoals=[];collectiveGold=[];collectiveResources=[];items=[];chooseLocation;chooseUnlockCharacter;challenges=0;calendarSectionConditional=[];calenderSectionManual=[];calendarSectionManual=[];randomItem=void 0;randomItemIndex=-1;randomItems=[];randomItemBlueprints=[];trials=[]}},83414:(p,k,M)=>{M.d(k,{_K:()=>v,lS:()=>t,uh:()=>A}),M(60057);class t{round;start=!1;always=!1;alwaysApply=!1;alwaysApplyTurn=!1;once=!1;requiredRooms=[];requiredRules=[];disablingRules=[];requiredScenarios=[];note="";noteTop="";rooms=[];sections=[];figures=[];spawns=[];objectiveSpawns=[];elements=[];disableRules=[];treasures=[];randomDungeon;statEffects=[];finish=void 0;constructor(s){this.round=s}}class v{monster;count;marker;summon;manual;manualMin;manualMax;constructor(s){this.monster=s.monster,this.count=s.count||1,this.marker=s.marker||"",this.summon=s.summon||!1,this.manual=s.manual||!1,this.manualMin=s.manualMin||0,this.manualMax=s.manualMax||0}}const A=["present","dead","killed","initiative","onTurn","afterTurn"]},83492:(p,k,M)=>{M.d(k,{U2:()=>O,W2:()=>v,lV:()=>D});var C=M(58317),t=M(60057);class v{cardId=0;edition="";automation}class D{current=-1;finished=-1;keep=[];cards=[];active=!1;fromModel(E){this.current=E.current,this.finished=E.finished,this.keep=E.keep||[],this.cards=E.cards?E.cards.map(R=>C.E.challengesManager.getChallengeCard(R)).filter(R=>R).map(R=>R):[],this.active=E.active}toModel(){let E=new O;return E.current=this.current,E.finished=this.finished,E.keep=this.keep&&JSON.parse(JSON.stringify(this.keep))||[],E.cards=this.cards.map(R=>new t.gw(""+R.cardId,R.edition)),E.active=this.active,E}}class O{current=-1;finished=-1;keep=[];cards=[];active=!1}},88826:(p,k,M)=>{M.d(k,{Np:()=>O,b9:()=>t,fH:()=>v,le:()=>D,yF:()=>C});const C=[3,8,14,21,29,38,49,63],t=[5,14,26,41,59,80,104,131],v=[4,11,21,32,44,58,73,88];class D{edition;characters;monsters;decks;scenarios;sections;items;conditions=[];battleGoals=[];events=[];personalQuests=[];challenges=[];trials=[];favors=[];pets=[];worldMap;extendWorldMap;label={};labelSpoiler={};url="";logoUrl="";additional=!1;extensions=[];newAmStyle=!1;campaign;treasures=[];treasureOffset=0;monsterAmTables=[];constructor(E,R,I,U,X,s,T,m=void 0,w=[],q=[],P=[],S=!1,$=[]){this.edition=E,this.characters=R,this.monsters=I,this.decks=U,this.scenarios=X,this.sections=s,this.items=T,m&&(this.conditions=m),this.battleGoals=w,this.events=q,this.personalQuests=P,this.additional=S,this.extensions=$}}class O{events={};campaignStickers=[];buildings=[];highMorale=[];lowMorale=[];lootSpecial1Sections=[];lootSpecial2Sections=[];townGuardPerks=[];weeks={};factions=[];imbuementSections={};reputationSections=[];prosperitySections={}}},93417:(p,k,M)=>{M.d(k,{RU:()=>D}),M(73219);var D=function(O){return O.add="add",O.remove="remove",O.replace="replace",O.custom="custom",O}(D||{})},98635:(p,k,M)=>{M.d(k,{iq:()=>C,qS:()=>v});var C=function(D){return D.algox="algox",D.aesther="aesther",D.harrower="harrower",D.human="human",D.inox="inox",D.lurker="lurker",D.orchid="orchid",D.quatryl="quatryl",D.savvas="savvas",D.unfettered="unfettered",D.valrath="valrath",D.vermling="vermling",D}(C||{}),t=function(D){return D.male="m",D.female="f",D.unknown="",D}(t||{});class v{name="";stats=[];characterClass;gender=t.unknown;identities=[];defaultIdentity=void 0;tokens=[];primaryToken=-1;handSize=0;unlockEvent="";retireEvent="";traits=[];availableSummons=[];specialActions=[];specialConditions=[];icon="";iconUrl="";thumbnail;thumbnailUrl;color="#aaaaaa";noThumbnail=!1;marker=!1;deck="";perkWarning=!1;perks=[];additionalModifier=[];masteries=[];bb=!1;amTables=[];edition="";spoiler=!1;locked=!1;errors;replace=!1;merge=!1;constructor(O=void 0){O&&(this.errors=O.errors||[],this.name=O.name,this.stats=O.stats||[],this.characterClass=O.characterClass||void 0,this.gender=O.gender||t.unknown,this.identities=O.identities||[],this.defaultIdentity=O.defaultIdentity,this.tokens=O.tokens||[],this.primaryToken=O.primaryToken>=0?O.primaryToken:-1,this.handSize=O.handSize||0,this.unlockEvent=O.unlockEvent||"",this.retireEvent=O.retireEvent||"",this.traits=O.traits||[],this.availableSummons=O.availableSummons||[],this.edition=O.edition||"",this.icon=O.icon||O.edition+"-"+O.name,this.iconUrl=O.iconUrl||"./assets/images/character/icons/"+this.icon+".svg",this.thumbnail=O.thumbnail||void 0,this.thumbnailUrl=O.thumbnailUrl||void 0,this.noThumbnail=O.noThumbnail,this.color=O.color||"#aaaaaa",this.marker=O.marker||!1,this.spoiler=O.spoiler||!1,this.specialActions=O.specialActions||[],this.specialConditions=O.specialConditions||[],this.locked=O.locked||!1,this.deck=O.deck||"",this.perkWarning=O.perkWarning,this.perks=O.perks||[],this.additionalModifier=O.additionalModifier||[],this.masteries=O.masteries||[],this.replace=O.replace||!1,this.merge=O.merge||!1,this.bb=O.bb||!1,this.amTables=O.amTables||[])}}}},p=>{p.O(0,[502],()=>p(p.s=31932)),p.O()}]);
//# sourceMappingURL=main.e52dcce6924e03ea.js.map